<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article article-type="research-article" dtd-version="1.1d3" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-17-01478</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1006342</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Physics</subject><subj-group><subject>Thermodynamics</subject><subj-group><subject>Free energy</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Chemistry</subject><subj-group><subject>Physical chemistry</subject><subj-group><subject>Chemical bonding</subject><subj-group><subject>Hydrogen bonding</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Chemistry</subject><subj-group><subject>Computational chemistry</subject><subj-group><subject>Molecular dynamics</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Biochemical simulations</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Biochemical simulations</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Physics</subject><subj-group><subject>Thermodynamics</subject><subj-group><subject>Entropy</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Molecular biology</subject><subj-group><subject>Macromolecular structure analysis</subject><subj-group><subject>Protein structure</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Proteins</subject><subj-group><subject>Protein structure</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Proteins</subject><subj-group><subject>Protein interactions</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Accurate calculation of side chain packing and free energy with applications to protein molecular dynamics</article-title>
<alt-title alt-title-type="running-head">Accurate calculation of side chain packing and free energy with applications to MD</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Jumper</surname> <given-names>John M.</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="fn" rid="currentaff001"><sup>¤</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-3687-7114</contrib-id>
<name name-style="western">
<surname>Faruk</surname> <given-names>Nabil F.</given-names></name>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Freed</surname> <given-names>Karl F.</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-2871-7244</contrib-id>
<name name-style="western">
<surname>Sosnick</surname> <given-names>Tobin R.</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Department of Biochemistry and Molecular Biology, University of Chicago, Chicago, Illinois, United States of America</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Department of Chemistry, and The James Franck Institute, University of Chicago, Chicago, Illinois, United States of America</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>Graduate Program in Biophysical Sciences, University of Chicago, Chicago, Illinois, United States of America</addr-line>
</aff>
<aff id="aff004">
<label>4</label>
<addr-line>Institute for Biophysical Dynamics, University of Chicago, Chicago, Illinois, United States of America</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Dunbrack</surname>
<given-names>Roland L.</given-names>
<suffix>Jr.</suffix>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Fox Chase Cancer Center, UNITED STATES</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="current-aff" id="currentaff001">
<label>¤</label>
<p>Current address: DeepMind, London, United Kingdom</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">trsosnic@uchicago.edu</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>12</month>
<year>2018</year>
</pub-date>
<pub-date pub-type="epub">
<day>27</day>
<month>12</month>
<year>2018</year>
</pub-date>
<volume>14</volume>
<issue>12</issue>
<elocation-id>e1006342</elocation-id>
<history>
<date date-type="received">
<day>1</day>
<month>9</month>
<year>2017</year>
</date>
<date date-type="accepted">
<day>21</day>
<month>6</month>
<year>2018</year>
</date>
</history>
<permissions>
<copyright-year>2018</copyright-year>
<copyright-holder>Jumper et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1006342"/>
<related-article ext-link-type="uri" id="related001" related-article-type="companion" xlink:href="info:doi/10.1371/journal.pcbi.1006578" xlink:type="simple">
<article-title>Trajectory-based training enables protein simulations with accurate folding and Boltzmann ensembles in cpu-hours</article-title>
</related-article>
<abstract>
<p>To address the large gap between time scales that can be easily reached by molecular simulations and those required to understand protein dynamics, we present a rapid self-consistent approximation of the side chain free energy at every integration step. In analogy with the adiabatic Born-Oppenheimer approximation for electronic structure, the protein backbone dynamics are simulated as preceding according to the dictates of the free energy of an instantaneously-equilibrated side chain potential. The side chain free energy is computed on the fly, allowing the protein backbone dynamics to traverse a greatly smoothed energetic landscape. This computation results in extremely rapid equilibration and sampling of the Boltzmann distribution. Our method, termed <italic>Upside</italic>, employs a reduced model involving the three backbone atoms, along with the carbonyl oxygen and amide proton, and a single (oriented) side chain bead having multiple locations reflecting the conformational diversity of the side chain’s rotameric states. We also introduce a novel, maximum-likelihood method to parameterize the side chain interactions using protein structures. We demonstrate state-of-the-art accuracy for predicting <italic>χ</italic><sub>1</sub> rotamer states while consuming only milliseconds of CPU time. Our method enables rapidly equilibrating coarse-grained simulations that can nonetheless contain significant molecular detail. We also show that the resulting free energies of the side chains are sufficiently accurate for <italic>de novo</italic> folding of some proteins.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>To address the large gap between time scales that can be easily reached by molecular simulations and those required to understand protein dynamics, we propose a new methodology that computes a self-consistent approximation of the side chain free energy at every integration step. As a result, the method largely eliminates side chain friction, a factor that greatly slows all atom approaches. With this speed-up, our method is capable of folding some proteins in CPU-hours. We also demonstrate state-of-the-art accuracy for predicting <italic>χ</italic><sub>1</sub> rotamer states with a 100-fold speedup. Because conformational space can be rapidly explored with our inexpensive method, it is an excellent starting point for studying protein dynamics involving large conformational transitions.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000057</institution-id>
<institution>National Institute of General Medical Sciences</institution>
</institution-wrap>
</funding-source>
<award-id>GM055694</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-2871-7244</contrib-id>
<name name-style="western">
<surname>Sosnick</surname> <given-names>Tobin Roy</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution>National Institute of General Medical Sciences (US)</institution>
</funding-source>
<award-id>GM008720</award-id>
</award-group>
<award-group id="award003">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000001</institution-id>
<institution>National Science Foundation</institution>
</institution-wrap>
</funding-source>
<award-id>CHE-1363012</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Freed</surname> <given-names>Karl F</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award004">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000076</institution-id>
<institution>Directorate for Biological Sciences</institution>
</institution-wrap>
</funding-source>
<award-id>MCB-1517221</award-id>
</award-group>
<award-group id="award005">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100002790</institution-id>
<institution>Canadian Network for Research and Innovation in Machining Technology, Natural Sciences and Engineering Research Council of Canada</institution>
</institution-wrap>
</funding-source>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-3687-7114</contrib-id>
<name name-style="western">
<surname>Faruk</surname> <given-names>Nabil F</given-names></name>
</principal-award-recipient>
</award-group>
<funding-statement>This research is supported by the National Science Foundation Grants CHE-1363012 (KFF) and MCB-1517221 (B. Roux), and the National Institutes of Health General Medical Sciences grants GM55694 (TRS, KFF), and T32GM008720 (J. Piccirilli). NFF thanks NSERC for a Postgraduate Scholarship. This work was completed in part with resources provided by the University of Chicago Research Computing Center. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="9"/>
<table-count count="2"/>
<page-count count="25"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant data are within the paper.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Two major challenges must be overcome in order to accurately simulate protein dynamics. The first is the necessity of balancing the large and competing sources of energy and entropy whose sum determines both the thermodynamics and the native conformation of the protein. The second challenge involves the intensive sampling required to obtain a Boltzmann ensemble of conformations. The sampling challenge is addressed here by integrating out the side chain degrees of freedom to produce a coarse-grained configuration defined just in terms of the backbone N, C<sub><italic>α</italic></sub>, and C atoms. Consequently, backbone motions evolve on a smoother free energy surface with greatly reduced side chain rattling (molecular friction) compared to that for standard all-atom molecular dynamics simulations.</p>
<p>The uncertainty in the position of coarse-grain interactions heightens the difficulty of accurately parameterizing a coarse-grained model. We do not follow the customary process of matching the energies of the coarse-grained model to approximate the already inexact energies of atomistic force fields or try to interpret raw statistics for the distribution of interatomic distances in the Protein Data Bank (PDB) [<xref ref-type="bibr" rid="pcbi.1006342.ref001">1</xref>] along with a reference state [<xref ref-type="bibr" rid="pcbi.1006342.ref002">2</xref>]. Instead, our side chain interaction energies are determined as those that best reproduce the side chain conformations observed in the PDB, given the native-state backbone configurations. That is, we search for an energy function that assigns on average the highest probability to the native <italic>χ</italic><sub>1</sub> rotamer.</p>
<p>This maximum-likelihood approach has key advantages: 1. It directly provides an interpretation of the structural information as a sample from the statistical mechanical ensemble of side chain packing, and 2. it can be evaluated quickly since we show that approximating the Boltzmann distribution for the side chains in a fixed backbone configuration does not require laborious Monte Carlo sampling of the <italic>χ</italic> angles in the side chain.</p>
<p>Using our side chain ensembles, we are able to predict <italic>χ</italic><sub>1</sub> rotamer configurations with similar accuracy as SCWRL4 [<xref ref-type="bibr" rid="pcbi.1006342.ref003">3</xref>] and OSCAR [<xref ref-type="bibr" rid="pcbi.1006342.ref004">4</xref>] [<xref ref-type="bibr" rid="pcbi.1006342.ref005">5</xref>], yet our predictions take less than 1% of the computational time. We are also exceed the speed of the rapid side chain packing algorithm RASP [<xref ref-type="bibr" rid="pcbi.1006342.ref006">6</xref>] by more than an order of magnitude. The accuracy of our side chain rotamer predictions validates that our side chain interaction potential captures much of the important physics of side chain interactions, suggesting suitability for molecular dynamics.</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Methods</title>
<sec id="sec003">
<title><italic>Upside</italic> model</title>
<p>The strategy in our <italic>Upside</italic> model is to perform dynamics simulations for just the N, C<sub><italic>α</italic></sub>, and C atoms that define the backbone trace, while still including sufficient structural detail (side chain structures and free energies, etc.) necessary to compute realistic forces. <xref ref-type="fig" rid="pcbi.1006342.g001">Fig 1</xref> presents an overview of the six step computational cycle used for molecular (Langevin) dynamics simulations. While the overarching goal of our work is extremely rapid molecular dynamics, our new interaction model gives very accurate and rapid predictions of side chain <italic>χ</italic><sub>1</sub> angles. The inclusion of the side chain free energy, rather than the side chains themselves, greatly smooths the potential governing the dynamics of the backbone trace, especially because of the reduction of steric rattling. The parameters used in the energy calculation are trained to maximize the probability of the average side chain having the native <italic>χ</italic><sub>1</sub>. The major computational steps are:</p>
<list list-type="simple">
<list-item><label>Step 1</label><p>The loop begins (upper left corner) with each residue in the protein being represented with 3 backbone atoms, the N, C<sub><italic>α</italic></sub> and C. Based on the position of these atoms, the carbonyl oxygen, O, and amide proton, H, are deterministically placed.</p></list-item>
<list-item><label>Step 2</label><p>Each side chain, represented by a single oriented bead, is assigned an initial probability for being in 1–6 states, depending on the residue type (<xref ref-type="fig" rid="pcbi.1006342.g002">Fig 2</xref>) and the average frequency observed in the PDB. The state of the bead is defined by its position and an orientation, (x,y,z,v), where v is a unit vector relative to the peptide plane. The position and orientation of the bead define the interaction graph (<xref ref-type="fig" rid="pcbi.1006342.g003">Fig 3</xref>).</p></list-item>
<list-item><label>Step 3</label><p>The pair-wise state probabilities of all side chains are simultaneously and rapidly calculated using belief propagation to produce the lowest system free energy satisfying <xref ref-type="disp-formula" rid="pcbi.1006342.e042">Eq 7</xref>.</p></list-item>
<list-item><label>Step 4</label><p>Forces on the 3 backbone atoms, as well as on the O, H and side chain beads are calculated from the derivative of the free energy.</p></list-item>
<list-item><label>Step 5</label><p>Forces on the O, H and beads are “pulled back” and added to the forces on the 3 backbone atoms by reversing the placement process via <xref ref-type="disp-formula" rid="pcbi.1006342.e059">Eq 16</xref>.</p></list-item>
<list-item><label>Step 6</label><p>Langevin dynamics (implicit solvent with friction) are run on the 3 backbone atoms using the forces calculated in Steps 4 and 5.</p></list-item>
</list>
<fig id="pcbi.1006342.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006342.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Six step inner loop of <italic>Upside</italic> calculation.</title>
<p>The side chain potential enters into the integration step simply as a complicated, many-body energy function that may be treated with standard techniques of molecular simulations.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006342.g001" xlink:type="simple"/>
</fig>
<fig id="pcbi.1006342.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006342.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Error in the position as a function of the number of side chain states, resulting from a decomposition of rotamer states into coarse-grained states.</title>
<p>The table summarizes the number of states chosen for each amino acid type. The relative uncertainty is the positional uncertainty for each number of states divided by the accuracy at three states. One, three, or six rotamer states are used, depending on the residue type. For residues without a rotatable <italic>χ</italic><sub>2</sub>, such as valine, only three states are needed. The time to compute the pairwise interactions and solve for the free energy scales roughly as the number of coarse rotamer states squared, so the use of fewer coarse states is preferred. Ile, Leu and Lys are the three residues with rotatable <italic>χ</italic><sub>2</sub> where only 3 states are assigned.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006342.g002" xlink:type="simple"/>
</fig>
<fig id="pcbi.1006342.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006342.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Fragment of protein G with associated interaction graph (<italic>R</italic><sub>cutoff</sub> = 7Å).</title>
<p>A pair of residues is assigned a connection whenever their side chain beads are within <italic>R</italic><sub>cutoff</sub> for any side chain states.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006342.g003" xlink:type="simple"/>
</fig>
<p>Below we describe the steps in detail.</p>
</sec>
<sec id="sec004">
<title>Side chain free energy evaluation</title>
<p>One can consider a representation of the protein in terms of the coordinates ({<italic>b</italic><sub><italic>i</italic></sub>}, {<italic>χ</italic><sub><italic>i</italic></sub>}) where <italic>b</italic><sub><italic>i</italic></sub> represents the positions of the backbone N, C<sub><italic>α</italic></sub>, and C atoms on the <italic>i</italic>-th residue and <italic>χ</italic><sub><italic>i</italic></sub> represents the side chain <italic>χ</italic>-angles on the <italic>i</italic>-th residue. Because bond lengths and angles are relatively constant, the positions of the atoms can be reconstructed with high accuracy from the ({<italic>b</italic><sub><italic>i</italic></sub>}, {<italic>χ</italic><sub><italic>i</italic></sub>}) coordinates (Step 1). Given a potential energy <italic>V</italic>({<italic>b</italic><sub><italic>i</italic></sub>}, {<italic>χ</italic><sub><italic>i</italic></sub>}), we calculate the free energy as a function of the backbone configuration, from the logarithm of the partition function
<disp-formula id="pcbi.1006342.e001"><alternatives><graphic id="pcbi.1006342.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e001" xlink:type="simple"/><mml:math display="block" id="M1"><mml:mrow><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:msub><mml:mi>b</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>}</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mtext>log</mml:mtext> <mml:mo>∫</mml:mo> <mml:mi>d</mml:mi> <mml:msub><mml:mi>χ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mspace width="0.166667em"/><mml:mo>⋯</mml:mo> <mml:msub><mml:mi>χ</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mspace width="0.166667em"/><mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>V</mml:mi> <mml:mo>(</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:msub><mml:mi>b</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>}</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:msub><mml:mi>χ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>}</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(1)</label></disp-formula>
Natural energy units are used with <italic>k</italic><sub>B</sub><italic>T</italic> = 1. An intermediate step of this derivation requires a discrete approximation <inline-formula id="pcbi.1006342.e002"><alternatives><graphic id="pcbi.1006342.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:mrow><mml:mo>{</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> for our <italic>χ</italic>-angles and a discrete approximation <inline-formula id="pcbi.1006342.e003"><alternatives><graphic id="pcbi.1006342.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:mrow><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:msub><mml:mi>b</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>}</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>}</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> for the potential.</p>
<p>Rather than directly calculate <xref ref-type="disp-formula" rid="pcbi.1006342.e001">Eq 1</xref>, we define an intermediate discrete approximation to <inline-formula id="pcbi.1006342.e004"><alternatives><graphic id="pcbi.1006342.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula> where the side chain bead positions and orientations are defined to be in up to six discrete positions that are amenable to approximation techniques (Step 2). This discretization process is accomplished using a discrete coarse-graining function <italic>g</italic> which maps the continuous side chain rotamers <italic>χ</italic><sub><italic>i</italic></sub>: <inline-formula id="pcbi.1006342.e005"><alternatives><graphic id="pcbi.1006342.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi>g</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>χ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, where <inline-formula id="pcbi.1006342.e006"><alternatives><graphic id="pcbi.1006342.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula> is a state label (<inline-formula id="pcbi.1006342.e007"><alternatives><graphic id="pcbi.1006342.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>∈</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:mn>6</mml:mn> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> as each side chain is represented by a bead located at one of up to 6 positions). The coarse-grain potential <inline-formula id="pcbi.1006342.e008"><alternatives><graphic id="pcbi.1006342.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e008" xlink:type="simple"/><mml:math display="inline" id="M8"><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is defined so that
<disp-formula id="pcbi.1006342.e009"><alternatives><graphic id="pcbi.1006342.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e009" xlink:type="simple"/><mml:math display="block" id="M9"><mml:mrow><mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:msub><mml:mi>b</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>}</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>}</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup> <mml:mo>≈</mml:mo> <mml:mo>∫</mml:mo> <mml:mi>d</mml:mi> <mml:msub><mml:mi>χ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mspace width="0.166667em"/><mml:mo>⋯</mml:mo> <mml:msub><mml:mi>χ</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mspace width="0.166667em"/><mml:mo>(</mml:mo> <mml:munder><mml:mo>∏</mml:mo> <mml:mi>i</mml:mi></mml:munder> <mml:msub><mml:mi>δ</mml:mi> <mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mi>g</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>χ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msub> <mml:mo>)</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>V</mml:mi> <mml:mo>(</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:msub><mml:mi>b</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>}</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:msub><mml:mi>χ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>}</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(2)</label></disp-formula>
In principle, any coarse-grain function for the side chains may be used. The discrete form <inline-formula id="pcbi.1006342.e010"><alternatives><graphic id="pcbi.1006342.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> of the potential provides an accurate approximation as the distribution of <italic>χ</italic>-angles is sharply peaked (in the true potential <italic>V</italic>) within each discrete state <inline-formula id="pcbi.1006342.e011"><alternatives><graphic id="pcbi.1006342.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e011" xlink:type="simple"/><mml:math display="inline" id="M11"><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula>. <xref ref-type="fig" rid="pcbi.1006342.g004">Fig 4</xref> provides an example of a function while Subsection <bold>Optimized mapping to coarse states</bold> shows how the optimized function <italic>g</italic> is derived.</p>
<fig id="pcbi.1006342.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006342.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Example of optimized coarse states for arginine overlaid on the PDB distribution of the rotamer angles <italic>χ</italic><sub>1</sub> and <italic>χ</italic><sub>2</sub>.</title>
<p>Each of the six coarse states contains only a single fine state that has high probability, so that the variance of dihedral angles within each coarse state is small.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006342.g004" xlink:type="simple"/>
</fig>
<p>We make the following assumptions on the form of <inline-formula id="pcbi.1006342.e012"><alternatives><graphic id="pcbi.1006342.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e012" xlink:type="simple"/><mml:math display="inline" id="M12"><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula>. First, we assume an explicit function <inline-formula id="pcbi.1006342.e013"><alternatives><graphic id="pcbi.1006342.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e013" xlink:type="simple"/><mml:math display="inline" id="M13"><mml:mrow><mml:msub><mml:mi>y</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>b</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> exists for the side chain coordinates based only on the backbone coordinates and side chain state for residue <italic>i</italic>. We may relax the requirement to consider a single residue’s backbone position, but it is required that <italic>y</italic><sub><italic>i</italic></sub> depend on only a single side chain <italic>state</italic> <inline-formula id="pcbi.1006342.e014"><alternatives><graphic id="pcbi.1006342.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e014" xlink:type="simple"/><mml:math display="inline" id="M14"><mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula>. These directed coordinates are approximately the side chain centers of mass with direction given by the C<sub><italic>β</italic></sub>−C<sub><italic>γ</italic></sub> bond vector.</p>
<p>The <inline-formula id="pcbi.1006342.e015"><alternatives><graphic id="pcbi.1006342.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e015" xlink:type="simple"/><mml:math display="inline" id="M15"><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> are expressed as the sum of a backbone term involving dihedral angle preferences, side chain-backbone interactions (including hydrogen bonding), and pairwise interactions involving the side chains,
<disp-formula id="pcbi.1006342.e016"><alternatives><graphic id="pcbi.1006342.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e016" xlink:type="simple"/><mml:math display="block" id="M16"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:msub><mml:mi>b</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>}</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>}</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msup><mml:mi>V</mml:mi> <mml:mtext>backbone</mml:mtext></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:msub><mml:mi>b</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>}</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:munder><mml:mo>∑</mml:mo> <mml:mi>i</mml:mi></mml:munder> <mml:msubsup><mml:mi>V</mml:mi> <mml:mi>i</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:msub><mml:mi>b</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>}</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>b</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:munder> <mml:msubsup><mml:mi>V</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>b</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>b</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(3)</label></disp-formula>
The pair interaction <inline-formula id="pcbi.1006342.e017"><alternatives><graphic id="pcbi.1006342.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e017" xlink:type="simple"/><mml:math display="inline" id="M17"><mml:mrow><mml:msubsup><mml:mi>V</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> for the side chain is taken to vanish beyond a cutoff <italic>R</italic><sub>cutoff</sub>. The dependence of the potential on the backbone is completely general, but the potential is assumed to contain at most a pairwise dependence on the discrete rotamer states <inline-formula id="pcbi.1006342.e018"><alternatives><graphic id="pcbi.1006342.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e018" xlink:type="simple"/><mml:math display="inline" id="M18"><mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula>. Explicit parameterizations for <italic>y</italic><sub><italic>i</italic></sub> and <inline-formula id="pcbi.1006342.e019"><alternatives><graphic id="pcbi.1006342.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e019" xlink:type="simple"/><mml:math display="inline" id="M19"><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> are defined in the <bold>Subsection Bead locations and interactions</bold> using the principle of maximum likelihood.</p>
<p>One can simulate the Boltzmann ensemble for <inline-formula id="pcbi.1006342.e020"><alternatives><graphic id="pcbi.1006342.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e020" xlink:type="simple"/><mml:math display="inline" id="M20"><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> using molecular dynamics for the backbone {<italic>b</italic><sub><italic>i</italic></sub>} and Monte Carlo moves for the side chain states <inline-formula id="pcbi.1006342.e021"><alternatives><graphic id="pcbi.1006342.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e021" xlink:type="simple"/><mml:math display="inline" id="M21"><mml:mrow><mml:mo>{</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. But the strong steric interactions are likely to lead to slow equilibration and dynamics for both the side chains and backbone. Because we are predominantly interested in backbone motions, we return to the free energy <inline-formula id="pcbi.1006342.e022"><alternatives><graphic id="pcbi.1006342.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e022" xlink:type="simple"/><mml:math display="inline" id="M22"><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula> in <xref ref-type="disp-formula" rid="pcbi.1006342.e001">Eq 1</xref>, now summing over discrete side chain states instead of integrating over continuous side chain angles,
<disp-formula id="pcbi.1006342.e023"><alternatives><graphic id="pcbi.1006342.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e023" xlink:type="simple"/><mml:math display="block" id="M23"><mml:mrow><mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:msub><mml:mi>b</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>}</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup> <mml:mo>≈</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>N</mml:mi></mml:msub></mml:mrow></mml:munder> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:msub><mml:mi>b</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>}</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>}</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(4)</label></disp-formula>
The potential <inline-formula id="pcbi.1006342.e024"><alternatives><graphic id="pcbi.1006342.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e024" xlink:type="simple"/><mml:math display="inline" id="M24"><mml:mrow><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:msub><mml:mi>b</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>}</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> represents a further coarse-graining of the system by completely replacing the influence of the side chains with a potential describing their adiabatic free energy for a given fixed backbone conformation. Because <inline-formula id="pcbi.1006342.e025"><alternatives><graphic id="pcbi.1006342.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e025" xlink:type="simple"/><mml:math display="inline" id="M25"><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula> depends only on the (continuous) backbone coordinates, this choice of <inline-formula id="pcbi.1006342.e026"><alternatives><graphic id="pcbi.1006342.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e026" xlink:type="simple"/><mml:math display="inline" id="M26"><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula> enables running standard molecular dynamics simulations instead of a hybrid of Monte Carlo and molecular dynamics.</p>
<p>Importantly, the potential <inline-formula id="pcbi.1006342.e027"><alternatives><graphic id="pcbi.1006342.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e027" xlink:type="simple"/><mml:math display="inline" id="M27"><mml:mrow><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:msub><mml:mi>b</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>}</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is a much smoother function of the backbone coordinates than the original <italic>V</italic>({<italic>b</italic><sub><italic>i</italic></sub>}, {<italic>χ</italic><sub><italic>i</italic></sub>}) because the replacement of the side chain degrees of freedom with the approximate free energy of the side chains greatly reduces steric rattling and molecular friction. The reduction of the ruggedness of the energy landscape enhances diffusion within conformational basins but preserves the overall structure and barriers that define the conformational ensemble.</p>
</sec>
<sec id="sec005">
<title>Approximating the side chain free energies</title>
<p>The benefits of running dynamics with our coarse grained <inline-formula id="pcbi.1006342.e028"><alternatives><graphic id="pcbi.1006342.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e028" xlink:type="simple"/><mml:math display="inline" id="M28"><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula> could enter at great cost because using even with three coarse-grained states per side chain, there are over 3<sup><italic>N</italic></sup> <inline-formula id="pcbi.1006342.e029"><alternatives><graphic id="pcbi.1006342.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e029" xlink:type="simple"/><mml:math display="inline" id="M29"><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula>-states in <xref ref-type="disp-formula" rid="pcbi.1006342.e023">Eq 4</xref>. However, the vast majority of those 3<sup><italic>N</italic></sup> states have steric clashes or other large energies and, therefore, contribute little to the side chain free energy. In this section, we describe how we take advantage of this potentially huge reduction in relevant states to calculate an approximate side chain free energy.</p>
<p>To approximate the free energy of the side chains <inline-formula id="pcbi.1006342.e030"><alternatives><graphic id="pcbi.1006342.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e030" xlink:type="simple"/><mml:math display="inline" id="M30"><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, we express the problem in the language of Ising models so that we can apply standard techniques developed in that context. For a fixed backbone configuration {<italic>b</italic><sub><italic>i</italic></sub>},
<disp-formula id="pcbi.1006342.e031"><alternatives><graphic id="pcbi.1006342.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e031" xlink:type="simple"/><mml:math display="block" id="M31"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:msub><mml:mi>b</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>}</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>}</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mover accent="true"><mml:mi>v</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>}</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>i</mml:mi></mml:munder> <mml:msubsup><mml:mi>v</mml:mi> <mml:mi>i</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext>neighbors</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:munder> <mml:msubsup><mml:mi>v</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(5)</label></disp-formula>
where the potentials <inline-formula id="pcbi.1006342.e032"><alternatives><graphic id="pcbi.1006342.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e032" xlink:type="simple"/><mml:math display="inline" id="M32"><mml:mover accent="true"><mml:mi>v</mml:mi> <mml:mo>¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula> are written in lowercase to indicate suppression of the dependence on the fixed backbone coordinates {<italic>b</italic><sub><italic>i</italic></sub>} in order to focus on the side chain contribution. Notice that with the backbone positions fixed, each single-residue potential <inline-formula id="pcbi.1006342.e033"><alternatives><graphic id="pcbi.1006342.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e033" xlink:type="simple"/><mml:math display="inline" id="M33"><mml:msubsup><mml:mi>v</mml:mi> <mml:mi>i</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> is simply a vector with as many components as the number of possible states for <inline-formula id="pcbi.1006342.e034"><alternatives><graphic id="pcbi.1006342.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e034" xlink:type="simple"/><mml:math display="inline" id="M34"><mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula> (e.g. length-6 vectors). Similarly, each of the pair potentials <inline-formula id="pcbi.1006342.e035"><alternatives><graphic id="pcbi.1006342.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e035" xlink:type="simple"/><mml:math display="inline" id="M35"><mml:msubsup><mml:mi>v</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> is a small 6x6 matrix of potential energies to cover a maximum of 36 possibilities. These single and pair potentials are calculated only once before evaluating the free energy as described in Subsection <bold>Bead locations and interactions</bold>. Moreover, the pair summation in <xref ref-type="disp-formula" rid="pcbi.1006342.e031">Eq 5</xref> only applies for residues pairs <italic>i</italic> and <italic>j</italic> that are neighbors spatially. A pair of residues (<italic>i</italic>, <italic>j</italic>) are neighbors if inter-residue distance <inline-formula id="pcbi.1006342.e036"><alternatives><graphic id="pcbi.1006342.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e036" xlink:type="simple"/><mml:math display="inline" id="M36"><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi>y</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is less than a cutoff <italic>R</italic><sub>cutoff</sub> for any of their possible discrete states <inline-formula id="pcbi.1006342.e037"><alternatives><graphic id="pcbi.1006342.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e037" xlink:type="simple"/><mml:math display="inline" id="M37"><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. In this work, we use <italic>R</italic><sub>cutoff</sub> = 7 Å for side chain-side chain interactions and <italic>R</italic><sub>cutoff</sub> = 5 Å for side chain-backbone interactions.</p>
<p>The potential <inline-formula id="pcbi.1006342.e038"><alternatives><graphic id="pcbi.1006342.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e038" xlink:type="simple"/><mml:math display="inline" id="M38"><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> may be visualized as an energy function on a graph with one discrete site per amino acid. The graph has a connection between any two residues that are within the cutoff separation <italic>R</italic><sub>cutoff</sub> (<xref ref-type="fig" rid="pcbi.1006342.g003">Fig 3</xref>). The structure of this graph varies dynamically over the course of a simulation because the definition of neighboring residues depends on the backbone configuration {<italic>b</italic><sub><italic>i</italic></sub>}. The potential varies smoothly as the backbone moves so long as the pairwise potential functions are continuous in the backbone coordinates. The potential <inline-formula id="pcbi.1006342.e039"><alternatives><graphic id="pcbi.1006342.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e039" xlink:type="simple"/><mml:math display="inline" id="M39"><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is continuous despite the changing connections of the graph because the strength of the potential for each interaction approaches zero at <italic>R</italic><sub>cutoff</sub> just before the connection is eliminated from the graph. Problems such as this, with discrete potentials on an arbitrary graph, are extensively studied in both statistical mechanics (as variants of the Ising model) and machine learning (as undirected graphical models or Markov random fields) [<xref ref-type="bibr" rid="pcbi.1006342.ref007">7</xref>]. Below we adopt some well studied approximations from these fields to provide accurate and tractable methods for computing our coarse-grain potential <inline-formula id="pcbi.1006342.e040"><alternatives><graphic id="pcbi.1006342.e040g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e040" xlink:type="simple"/><mml:math display="inline" id="M40"><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula>.</p>
<p>Two approximations [<xref ref-type="bibr" rid="pcbi.1006342.ref007">7</xref>] are invoked to compute the free energy according to
<disp-formula id="pcbi.1006342.e041"><alternatives><graphic id="pcbi.1006342.e041g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e041" xlink:type="simple"/><mml:math display="block" id="M41"><mml:mrow><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:msup><mml:mi>G</mml:mi> <mml:mtext>SC</mml:mtext></mml:msup> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mtext>log</mml:mtext> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>N</mml:mi></mml:msub></mml:mrow></mml:munder> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>v</mml:mi> <mml:mo>(</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>}</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(6)</label></disp-formula>
The first approximation is to express the free energy <italic>G</italic><sup>SC</sup> in terms of the entropy and average energy of the Boltzmann ensemble where the entropy has been replaced by a mutual information approximation that ignores 3-residue and higher correlations,
<disp-formula id="pcbi.1006342.e042"><alternatives><graphic id="pcbi.1006342.e042g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e042" xlink:type="simple"/><mml:math display="block" id="M42"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msup><mml:mi>G</mml:mi> <mml:mtext>SC</mml:mtext></mml:msup></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mo>⟨</mml:mo> <mml:mover accent="true"><mml:mi>v</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>⟩</mml:mo> <mml:mo>-</mml:mo> <mml:mi>S</mml:mi></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>≈</mml:mo> <mml:mrow><mml:mo>⟨</mml:mo> <mml:mover accent="true"><mml:mi>v</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>⟩</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msup><mml:mi>S</mml:mi> <mml:mtext>approx</mml:mtext></mml:msup> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(7)</label></disp-formula>
where <inline-formula id="pcbi.1006342.e043"><alternatives><graphic id="pcbi.1006342.e043g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e043" xlink:type="simple"/><mml:math display="inline" id="M43"><mml:mrow><mml:mo>〈</mml:mo> <mml:mover accent="true"><mml:mi>v</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>〉</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and <italic>S</italic><sup>approx</sup> are defined in Eqs <xref ref-type="disp-formula" rid="pcbi.1006342.e048">8</xref> and <xref ref-type="disp-formula" rid="pcbi.1006342.e049">9</xref>. We express the average energy and approximate entropy using the single-residue probabilities <inline-formula id="pcbi.1006342.e044"><alternatives><graphic id="pcbi.1006342.e044g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e044" xlink:type="simple"/><mml:math display="inline" id="M44"><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> that residue <italic>i</italic> is in state <inline-formula id="pcbi.1006342.e045"><alternatives><graphic id="pcbi.1006342.e045g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e045" xlink:type="simple"/><mml:math display="inline" id="M45"><mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula> in the Boltzmann ensemble of <inline-formula id="pcbi.1006342.e046"><alternatives><graphic id="pcbi.1006342.e046g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e046" xlink:type="simple"/><mml:math display="inline" id="M46"><mml:mover accent="true"><mml:mi>v</mml:mi> <mml:mo>¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula> and similarly for the joint probabilities <inline-formula id="pcbi.1006342.e047"><alternatives><graphic id="pcbi.1006342.e047g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e047" xlink:type="simple"/><mml:math display="inline" id="M47"><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Using <italic>p</italic><sub><italic>i</italic></sub> and <italic>p</italic><sub><italic>ij</italic></sub>, the approximate energy and entropy are
<disp-formula id="pcbi.1006342.e048"><alternatives><graphic id="pcbi.1006342.e048g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e048" xlink:type="simple"/><mml:math display="block" id="M48"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>⟨</mml:mo> <mml:mover accent="true"><mml:mi>v</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>⟩</mml:mo> <mml:mo>=</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:munder><mml:mo>∑</mml:mo> <mml:mi>i</mml:mi></mml:munder> <mml:munder><mml:mo>∑</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub></mml:munder> <mml:msub><mml:mi>p</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msubsup><mml:mi>v</mml:mi> <mml:mi>i</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext>neighbors</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:munder> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:munder> <mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msubsup><mml:mi>v</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(8)</label></disp-formula>
<disp-formula id="pcbi.1006342.e049"><alternatives><graphic id="pcbi.1006342.e049g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e049" xlink:type="simple"/><mml:math display="block" id="M49"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi>S</mml:mi> <mml:mtext>approx</mml:mtext></mml:msup> <mml:mo>=</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:munder><mml:mo>∑</mml:mo> <mml:mi>i</mml:mi></mml:munder> <mml:munder><mml:mo>∑</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub></mml:munder> <mml:msub><mml:mi>p</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>-</mml:mo> <mml:mtext>log</mml:mtext><mml:mspace width="4pt"/><mml:msub><mml:mi>p</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mtext>neighbors</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:munder> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:munder> <mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mtext>log</mml:mtext> <mml:mfrac><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(9)</label></disp-formula></p>
<p>We intend to minimize the approximate free energy in <xref ref-type="disp-formula" rid="pcbi.1006342.e042">Eq 7</xref> over all putative Boltzmann probability distributions for the side chain states <inline-formula id="pcbi.1006342.e050"><alternatives><graphic id="pcbi.1006342.e050g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e050" xlink:type="simple"/><mml:math display="inline" id="M50"><mml:mrow><mml:mo>{</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> (Step 3). Notice that only the single side chain probabilities <italic>p</italic><sub><italic>i</italic></sub> and joint side chain probabilities <italic>p</italic><sub><italic>ij</italic></sub> are required to compute the average energy and approximate entropy; we do not need the more complicated full joint probability distribution of the <inline-formula id="pcbi.1006342.e051"><alternatives><graphic id="pcbi.1006342.e051g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e051" xlink:type="simple"/><mml:math display="inline" id="M51"><mml:mrow><mml:mo>{</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> states for all side chains. In addition to the mutual information approximation of the entropy, we assume that any pair probability <italic>p</italic><sub><italic>ij</italic></sub> represents possible pair probabilities from a Boltzmann distribution, so that the only task is to minimize the free energy with respect to the pair probabilities. The only constraints imposed are that they must satisfy the obvious consistency conditions for probabilities,
<disp-formula id="pcbi.1006342.e052"><alternatives><graphic id="pcbi.1006342.e052g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e052" xlink:type="simple"/><mml:math display="block" id="M52"><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub></mml:munder> <mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub></mml:munder> <mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(10)</label></disp-formula>
<disp-formula id="pcbi.1006342.e053"><alternatives><graphic id="pcbi.1006342.e053g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e053" xlink:type="simple"/><mml:math display="block" id="M53"><mml:mrow><mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:munder> <mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives> <label>(11)</label></disp-formula>
<disp-formula id="pcbi.1006342.e054"><alternatives><graphic id="pcbi.1006342.e054g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e054" xlink:type="simple"/><mml:math display="block" id="M54"><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(12)</label></disp-formula>
However, the use of only conditions in Eqs <xref ref-type="disp-formula" rid="pcbi.1006342.e052">10</xref>–<xref ref-type="disp-formula" rid="pcbi.1006342.e054">12</xref> is insufficient to ensure that a joint probability distribution exists for all the variables consistent with the choices of <italic>p</italic><sub><italic>i</italic></sub> and <italic>p</italic><sub><italic>ij</italic></sub>. As an explicit example,
<disp-formula id="pcbi.1006342.e055"><alternatives><graphic id="pcbi.1006342.e055g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e055" xlink:type="simple"/><mml:math display="block" id="M55"><mml:msub><mml:mi>p</mml:mi> <mml:mn>12</mml:mn></mml:msub> <mml:mrow><mml:mo>=</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:mn>23</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mo>(</mml:mo> <mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mn>3</mml:mn></mml:mrow></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mrow><mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mn>3</mml:mn></mml:mrow></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mrow><mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mn>3</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives> <label>(13)</label></disp-formula>
<disp-formula id="pcbi.1006342.e056"><alternatives><graphic id="pcbi.1006342.e056g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e056" xlink:type="simple"/><mml:math display="block" id="M56"><mml:msub><mml:mi>p</mml:mi> <mml:mn>13</mml:mn></mml:msub> <mml:mrow><mml:mo>=</mml:mo> <mml:mo>(</mml:mo> <mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mn>9</mml:mn></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mn>9</mml:mn></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mn>9</mml:mn></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mn>9</mml:mn></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mn>9</mml:mn></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mn>9</mml:mn></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mn>9</mml:mn></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mn>9</mml:mn></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mn>9</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives> <label>(14)</label></disp-formula>
obeys conditions Eqs <xref ref-type="disp-formula" rid="pcbi.1006342.e052">10</xref>–<xref ref-type="disp-formula" rid="pcbi.1006342.e054">12</xref> but is not representable by any probability distribution for the three residues. This aspect is a result of residue 1 being completely correlated to residue 2, and residue 2 being completely correlated to residue 3, but residues 1 and 3 being independent, which is mathematically impossible.</p>
<p>The issues of the approximation of the entropy and non-representability are potential concerns. However, we expect that they typically are not a large source of error given the comparable accuracy in predicting side chain rotamers as models employing full side chains. One limitation of these approximations is that the model cannot consider fully correlated side chain distributions. This limitation could be an issue for an allosteric switch which couples many side chain rearrangements with no accompanying backbone motion. As we represent the side chain with up to 6 possibly conformations, we are likely to capture a significant fraction of the conformation entropy for all but the longest side chains. Even then, each rotamer only contributes about 0.15 kcal/mol [<xref ref-type="bibr" rid="pcbi.1006342.ref008">8</xref>].</p>
<p>Accepting the two approximations for entropy and representability, the free energy becomes
<disp-formula id="pcbi.1006342.e057"><alternatives><graphic id="pcbi.1006342.e057g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e057" xlink:type="simple"/><mml:math display="block" id="M57"><mml:mrow><mml:msup><mml:mi>G</mml:mi> <mml:mtext>SC</mml:mtext></mml:msup> <mml:mo>≈</mml:mo> <mml:munder><mml:mtext>min</mml:mtext> <mml:mrow><mml:mrow><mml:mo>{</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>}</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:munder> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mo>⟨</mml:mo> <mml:mover accent="true"><mml:mi>v</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>⟩</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msup><mml:mi>S</mml:mi> <mml:mtext>approx</mml:mtext></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(15)</label></disp-formula>
Thus, we now have a tractable approximation to free energy of the side chain. We can minimize that free energy using a self-consistent iteration technique called belief propagation (see Subsection <bold>Belief propagation</bold>). The iteration typically converges rapidly, often in 10-20 steps, to produce an approximation of the side chain free energy.</p>
</sec>
<sec id="sec006">
<title>Molecular dynamics simulations using the side chain free energy</title>
<p>In <italic>Upside</italic>, molecular dynamics simulations require calculations of the forces on the three backbone atoms (Step 4). The forces on all atoms are obtained from the derivatives of the potential computed according to <inline-formula id="pcbi.1006342.e058"><alternatives><graphic id="pcbi.1006342.e058g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e058" xlink:type="simple"/><mml:math display="inline" id="M58"><mml:mrow><mml:mo>-</mml:mo> <mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>¯</mml:mo></mml:mover></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>b</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>. The forces on the O, H and bead are “pulled back” onto the three backbone atoms using the chain rule (Step 5). We take advantage of several terms being zero because the pair probabilities minimize the free energy,
<disp-formula id="pcbi.1006342.e059"><alternatives><graphic id="pcbi.1006342.e059g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e059" xlink:type="simple"/><mml:math display="block" id="M59"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msup><mml:mi>G</mml:mi> <mml:mtext>SC</mml:mtext></mml:msup></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>b</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:msup><mml:mi>G</mml:mi> <mml:mtext>SC</mml:mtext></mml:msup></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>b</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfrac> <mml:mo>+</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>i</mml:mi></mml:munder> <mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:msup><mml:mi>G</mml:mi> <mml:mtext>SC</mml:mtext></mml:msup></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>p</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac> <mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>p</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>b</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfrac> <mml:mo>+</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext>neighbors</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:munder> <mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:msup><mml:mi>G</mml:mi> <mml:mtext>SC</mml:mtext></mml:msup></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac> <mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>b</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:msup><mml:mi>G</mml:mi> <mml:mtext>SC</mml:mtext></mml:msup></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>b</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:mo>⟨</mml:mo> <mml:mover accent="true"><mml:mi>v</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>⟩</mml:mo></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>b</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo> <mml:mo>⟨</mml:mo> <mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:mover accent="true"><mml:mi>v</mml:mi> <mml:mo>¯</mml:mo></mml:mover></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>b</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfrac> <mml:mo>⟩</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>i</mml:mi></mml:munder> <mml:munder><mml:mo>∑</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub></mml:munder> <mml:msub><mml:mi>p</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:msubsup><mml:mi>v</mml:mi> <mml:mi>i</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>b</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext>neighbors</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:munder> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:munder> <mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:msubsup><mml:mi>v</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>b</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(16)</label></disp-formula>
where <inline-formula id="pcbi.1006342.e060"><alternatives><graphic id="pcbi.1006342.e060g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e060" xlink:type="simple"/><mml:math display="inline" id="M60"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:msup><mml:mi>G</mml:mi> <mml:mtext>SC</mml:mtext></mml:msup></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>p</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:msup><mml:mi>G</mml:mi> <mml:mtext>SC</mml:mtext></mml:msup></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> because <italic>p</italic><sub><italic>i</italic></sub> and <italic>p</italic><sub><italic>ij</italic></sub> are chosen to minimize <italic>G</italic><sup>SC</sup>. The remaining simplifications occur because the partial derivative of <italic>S</italic><sup>approx</sup> with respect to the backbone coordinates <italic>b</italic><sub><italic>k</italic></sub> is zero (even though the total derivative <inline-formula id="pcbi.1006342.e061"><alternatives><graphic id="pcbi.1006342.e061g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e061" xlink:type="simple"/><mml:math display="inline" id="M61"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>S</mml:mi> <mml:mtext>approx</mml:mtext></mml:msub></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>b</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula> is nonzero). While the underlying side chain interactions are pairwise additive and vanish outside the cutoff radius <italic>R</italic><sub>cutoff</sub>, the free energy in <xref ref-type="disp-formula" rid="pcbi.1006342.e042">Eq 7</xref> is a many-body potential that can interact over arbitrary distances.</p>
<p>Since the approximate free energy due to the side chains is not a convex function of the probabilities, local minima may arise and impair the self-consistent iteration from finding the global minimum. To reduce the danger posed by the presence of local minima, calculations are begun from a carefully initialized state (see Subsection <bold>Belief propagation</bold> for details). Other self-consistent approximations exist for the side group free energy, such as tree-reweighted belief propagation [<xref ref-type="bibr" rid="pcbi.1006342.ref009">9</xref>], that are typically less accurate but always converge to the global minimum of their approximate free energy. Another limitation of the present approximation scheme arises when a bi-stable or multi-stable energy landscape is possible for the rotamer states. If well-separated and equally important minima are present for a single backbone configuration in the rotamer free energy surface, the probabilities only converge to a single minimum and thus underestimate the entropy of the side chains. While this does not appear to occur near the native well, we have not extensively searched for special backbone configurations that would result in bi-stable rotamer energies. The characterization of such problematic configurations, likely near free energy barriers, is left to future work.</p>
</sec>
<sec id="sec007">
<title>Bead locations and interactions</title>
<p>Paralleling the necessity of coarse-graining the rotamer states, side chain atoms themselves also require coarse-graining in order to obtain an inexpensive side chain model (Step 2). This reduction in the number of degrees of freedom is further justified since the atomic positions of the side chains are uncertain due to the discretization and aggregation of the rotamer states, meaning that there is little value in assigning precise positions for all atoms. We instead use a single oriented bead (3 spatial and 2 orientation coordinates) to represent each side chain (note that the direction is independent of the positions of the side chain atoms, e.g. in aromatic residues it could be the unit vector normal to the ring). The locations and directions of the side chain beads are updated during the optimization of the potential. The improvement in prediction accuracy from using optimized side chain positions rather than the static positions (e.g., side chain center-of-mass for different rotameric states) is surprisingly substantial.</p>
<p>We use a combination of isotropic and directional interactions for each pair of interacting side chain or backbone (<xref ref-type="fig" rid="pcbi.1006342.g005">Fig 5</xref>). The isotropic interactions are primarily responsible for enforcing excluded volume, while the directional interactions typically reflect specific chemical interactions such as from polar groups or aromatic rings. Concretely, each interaction pair is described by positions <italic>y</italic><sub>1</sub> and <italic>y</italic><sub>2</sub> and directions <italic>n</italic><sub>1</sub> and <italic>n</italic><sub>2</sub>. The separation <italic>r</italic><sub>12</sub> = |<italic>y</italic><sub>1</sub> − <italic>y</italic><sub>2</sub>| and displacement unit vector <italic>n</italic><sub>12</sub> = (<italic>y</italic><sub>1</sub> − <italic>y</italic><sub>2</sub>)/<italic>r</italic><sub>12</sub> are calculated. The form of the interaction is given by
<disp-formula id="pcbi.1006342.e062"><alternatives><graphic id="pcbi.1006342.e062g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e062" xlink:type="simple"/><mml:math display="block" id="M62"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>V</mml:mi> <mml:mo>=</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mi>κ</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>V</mml:mi> <mml:mtext>radial</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>r</mml:mi> <mml:mn>12</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:msub><mml:mtext>ang</mml:mtext> <mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo> <mml:mo>-</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>·</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mn>12</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mtext>ang</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>·</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mn>12</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>V</mml:mi> <mml:mtext>angular</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>r</mml:mi> <mml:mn>12</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>)</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(17)</label></disp-formula>
where <italic>V</italic><sub>radial</sub>, ang<sub>1</sub>, ang<sub>2</sub>, and <italic>V</italic><sub>angular</sub> are smooth curves represented by cubic splines for increased flexibility (62 parameters total), rather than fixed functional forms such as a van der Waals 6-12 potential.</p>
<fig id="pcbi.1006342.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006342.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Coordinates and potentials used for side chain interactions.</title>
<p><bold>Top</bold>. For each residue, a reference backbone structure is aligned to the N, C<sub><italic>α</italic></sub>, and C atomic coordinates. This alignment creates a reference frame to establish the position and direction of the side chain bead. The two side chain beads <italic>x</italic><sub>1</sub> and <italic>x</italic><sub>2</sub> for a pair of residues establishes three coordinates, the distance <italic>r</italic> and angles <italic>θ</italic><sub>1</sub> and <italic>θ</italic><sub>2</sub>. <bold>Bottom</bold>. Example of distance-dependent potential, unif(<italic>r</italic><sub>12</sub>), after training, between the side chain and backbone residues. These interactions cutoff at 5 Å while the side chain-side chain interactions cutoff at 7 Å. The thin lines describe the <italic>V</italic><sub>radial</sub> of oxygen (red) and hydrogen (blue), and the thick lines describe <italic>V</italic><sub>radial</sub> + <italic>V</italic><sub>angular</sub> for the same interactions.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006342.g005" xlink:type="simple"/>
</fig>
<p>For side chain-side chain interactions, the <italic>κ</italic> prefactor is 1. But for side chain-backbone interactions, <italic>κ</italic> depends on the hydrogen bonding state of the backbone residue. This distinction reflects the observation that the presence of one hydrogen bond inhibits the formation of another due to competition for the single lone pair of electrons on the carbonyl oxygen that is available for hydrogen bonding. Specifically, the interaction between an amide proton or oxygen is given a hydrogen bond confidence score <italic>f</italic>, which is a number typically close to 0 for non-hydrogen bonded and 1 for hydrogen bonded residues. We set <italic>κ</italic> = 1 − <italic>f</italic> so that the interaction is only turned on for hydrogens or oxygens that are not already participating in a backbone-backbone hydrogen bond. The physical motivation is that the directional interaction primarily describes the effects of the dipole interactions, and the sum of the C = O and N–H dipoles have a vanishing dipole moment. While it is theoretically possible for the algorithm to carefully balance hydrogen and oxygen interactions that themselves cancel out on hydrogen bonded pairs, it is much easier to achieve a physically reasonable model if we enforce the zeroing of directional interactions with already hydrogen bonded pairs. The hydrogen bond distance and angular criteria are detailed in Subsection <bold>Simulation details</bold>.</p>
<p>The side chain-backbone interactions are needed to describe helix capping, where a side chain atom forms a hydrogen bond with an otherwise unsatisfied donor or acceptor at the end of helix. We have observed that a proper description of these capping effects is required to avoid helix fraying and inordinately long helices. Harper and Rose [<xref ref-type="bibr" rid="pcbi.1006342.ref010">10</xref>] have observed that N-terminal capping of a helix by side chains is more likely to be observed than is C-terminal capping by the side chain. This finding is consistent with our maximum-likelihood training (below), where side chain-amide hydrogen interactions are fit with stronger potentials (i.e., with higher confidence) than side chain-oxygen interactions. Harper and Rose also noted that hydrophobic residues play a strong role in helix capping by covering the exposed protein backbone at the ends of helices. To provide our model with the freedom to describe this effect, an additional side chain-backbone interaction is added with three beads, which could represent the possible hydrophobic character of the backbone. The location of the three beads are initialized from the reference position of N, C<sub><italic>α</italic></sub>, and C and are optimized with the rest of the parameters. For this interaction, <italic>κ</italic> = 1.</p>
<p>We have chosen to use 1- and 2-body potentials and have not employed 3- or 4-body potentials, in part due to difficulty of parameterizing the vast number of additional parameters. Similarly, higher order side chain entropy corrections would lead to a large increase in the computational cost of calculating the free energy, reducing the sampling ability and applicability to dynamics simulations. An alternative approach for introducing many-body effects and still maintaining the computational tractability, is to allow the pair interactions to depend on discrete parameters, such as the rotomer index used in the present study.</p>
</sec>
<sec id="sec008">
<title>Maximum-likelihood training</title>
<p>The side chain model is trained by the maximum-likelihood principle. Specifically, we determine the set of parameters that maximizes the log probability of the true side chain states <inline-formula id="pcbi.1006342.e063"><alternatives><graphic id="pcbi.1006342.e063g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e063" xlink:type="simple"/><mml:math display="inline" id="M63"><mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>p</mml:mi></mml:msub></mml:math></alternatives></inline-formula> in the Boltzmann ensemble of all possible side chain states <inline-formula id="pcbi.1006342.e064"><alternatives><graphic id="pcbi.1006342.e064g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e064" xlink:type="simple"/><mml:math display="inline" id="M64"><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> for the fixed backbone positions <italic>X</italic><sub><italic>p</italic></sub> for each protein <italic>p</italic>.
<disp-formula id="pcbi.1006342.e065"><alternatives><graphic id="pcbi.1006342.e065g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e065" xlink:type="simple"/><mml:math display="block" id="M65"><mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>p</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>=</mml:mo> <mml:mfrac><mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>V</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>p</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mrow><mml:msub><mml:mo>∑</mml:mo> <mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:msub> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>V</mml:mi> <mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives> <label>(18)</label></disp-formula>
<disp-formula id="pcbi.1006342.e066"><alternatives><graphic id="pcbi.1006342.e066g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e066" xlink:type="simple"/><mml:math display="block" id="M66"><mml:mrow><mml:mo>-</mml:mo> <mml:mtext>log</mml:mtext><mml:mspace width="4pt"/><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>p</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>=</mml:mo> <mml:mi>V</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>p</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mtext>log</mml:mtext> <mml:mo>(</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:munder> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>V</mml:mi> <mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives> <label>(19)</label></disp-formula>
<disp-formula id="pcbi.1006342.e067"><alternatives><graphic id="pcbi.1006342.e067g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e067" xlink:type="simple"/><mml:math display="block" id="M67"><mml:mrow><mml:mo>=</mml:mo> <mml:mi>V</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>p</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msup><mml:mi>G</mml:mi> <mml:mtext>SC</mml:mtext></mml:msup></mml:mrow></mml:math></alternatives> <label>(20)</label></disp-formula>
<disp-formula id="pcbi.1006342.e068"><alternatives><graphic id="pcbi.1006342.e068g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e068" xlink:type="simple"/><mml:math display="block" id="M68"><mml:mrow><mml:mo>=</mml:mo> <mml:msub><mml:mi>E</mml:mi> <mml:mtext>gap</mml:mtext></mml:msub> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(21)</label></disp-formula>
The evaluation of <italic>E</italic><sub>gap</sub> requires the evaluation of the free energy of the side chains, a quantity that is intractable to calculate exactly. Fortunately, our side chain energy <xref ref-type="disp-formula" rid="pcbi.1006342.e057">Eq 15</xref> approximates the true side chain free energy <italic>G</italic><sup>SC</sup> that appears in <xref ref-type="disp-formula" rid="pcbi.1006342.e067">Eq 20</xref>. Furthermore, the expression for the parametric derivative <xref ref-type="disp-formula" rid="pcbi.1006342.e059">Eq 16</xref> allows for gradient descent optimization to minimize the average gap energy.</p>
</sec>
<sec id="sec009">
<title>Training set</title>
<p>The side chain packing interaction is trained using a large, non-redundant collection of crystal structures from the PDB with 50–500 residues and resolution less than 2.2 Å. From a training set of protein structures, we extract the sequences <italic>s</italic><sub><italic>p</italic></sub>, backbone trace positions <italic>X</italic><sub><italic>p</italic></sub>, and true coarse-grained side chain states <inline-formula id="pcbi.1006342.e069"><alternatives><graphic id="pcbi.1006342.e069g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e069" xlink:type="simple"/><mml:math display="inline" id="M69"><mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>p</mml:mi></mml:msub></mml:math></alternatives></inline-formula> for each protein <italic>p</italic>. The proteins are further filtered using PISCES [<xref ref-type="bibr" rid="pcbi.1006342.ref011">11</xref>] so that all pairs of proteins have sequence similarity less than 30%. Non-globular structures in the dataset are removed, as we suspect that the side chain packing of these structures is more strongly influenced by other chains in the crystal structures. We define non-globular structures as outliers in the linear relationship between log(<italic>N</italic><sub>res</sub>) and log(<italic>R</italic><sub><italic>g</italic></sub>); the outliers are identified using the RANSAC algorithm [<xref ref-type="bibr" rid="pcbi.1006342.ref012">12</xref>]. After filtering, 6255 chains remained, containing approximately 1.4 million residues.</p>
</sec>
<sec id="sec010">
<title>Belief propagation</title>
<p>This subsection contains a brief description of the equations used to implement belief propagation for the side chain free energies. Given 1-residue energies <inline-formula id="pcbi.1006342.e070"><alternatives><graphic id="pcbi.1006342.e070g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e070" xlink:type="simple"/><mml:math display="inline" id="M70"><mml:mrow><mml:msub><mml:mi>v</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and 2-residue energies <inline-formula id="pcbi.1006342.e071"><alternatives><graphic id="pcbi.1006342.e071g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e071" xlink:type="simple"/><mml:math display="inline" id="M71"><mml:mrow><mml:msub><mml:mi>v</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, we seek probabilities <inline-formula id="pcbi.1006342.e072"><alternatives><graphic id="pcbi.1006342.e072g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e072" xlink:type="simple"/><mml:math display="inline" id="M72"><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006342.e073"><alternatives><graphic id="pcbi.1006342.e073g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e073" xlink:type="simple"/><mml:math display="inline" id="M73"><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> to minimize the free energy in <xref ref-type="disp-formula" rid="pcbi.1006342.e057">Eq 15</xref>.</p>
<p>It is helpful to first understand the intuition behind the belief propagation process. We seek a consistent set of 1- and 2-side chain probabilities for the residues compatible with the interaction potential <xref ref-type="disp-formula" rid="pcbi.1006342.e031">Eq 5</xref>. The probability of each residue state <inline-formula id="pcbi.1006342.e074"><alternatives><graphic id="pcbi.1006342.e074g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e074" xlink:type="simple"/><mml:math display="inline" id="M74"><mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula> for residue <italic>i</italic> is determined by two factors. The first factor is the 1-residue energy <inline-formula id="pcbi.1006342.e075"><alternatives><graphic id="pcbi.1006342.e075g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e075" xlink:type="simple"/><mml:math display="inline" id="M75"><mml:mrow><mml:msub><mml:mi>v</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> that would determine the probabilities exactly in the absence of interactions. The second factor is consistency with the side chain states of the residues in contact with residue <italic>i</italic>, where consistency is determined by the potentials <inline-formula id="pcbi.1006342.e076"><alternatives><graphic id="pcbi.1006342.e076g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e076" xlink:type="simple"/><mml:math display="inline" id="M76"><mml:mrow><mml:msub><mml:mi>v</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Belief propagation optimizes these factors to minimize the approximate free energy <xref ref-type="disp-formula" rid="pcbi.1006342.e057">Eq 15</xref> as derived in reference [<xref ref-type="bibr" rid="pcbi.1006342.ref013">13</xref>]. The iteration is described more formally below, including a damping term λ to suppress oscillations during the self-consistent iteration.</p>
<p>For 1-residue beliefs, we define <inline-formula id="pcbi.1006342.e077"><alternatives><graphic id="pcbi.1006342.e077g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e077" xlink:type="simple"/><mml:math display="inline" id="M77"><mml:mrow><mml:msubsup><mml:mi>b</mml:mi> <mml:mi>i</mml:mi> <mml:mi>r</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> to be the round <italic>r</italic> “belief” that the <italic>i</italic>-th residue is in state <inline-formula id="pcbi.1006342.e078"><alternatives><graphic id="pcbi.1006342.e078g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e078" xlink:type="simple"/><mml:math display="inline" id="M78"><mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula>. For the 2-residue beliefs, we have two beliefs for each pair of interacting residues (i.e. any pair of residues that interact in any rotamer states). Define <inline-formula id="pcbi.1006342.e079"><alternatives><graphic id="pcbi.1006342.e079g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e079" xlink:type="simple"/><mml:math display="inline" id="M79"><mml:mrow><mml:msubsup><mml:mi>b</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>r</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> to be the round <italic>r</italic> belief for the residue pair (<italic>i</italic>,<italic>j</italic>) that residue <italic>j</italic> is in state <inline-formula id="pcbi.1006342.e080"><alternatives><graphic id="pcbi.1006342.e080g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e080" xlink:type="simple"/><mml:math display="inline" id="M80"><mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub></mml:math></alternatives></inline-formula>. The belief <inline-formula id="pcbi.1006342.e081"><alternatives><graphic id="pcbi.1006342.e081g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e081" xlink:type="simple"/><mml:math display="inline" id="M81"><mml:mrow><mml:msubsup><mml:mi>b</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mi>i</mml:mi></mml:mrow> <mml:mi>r</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is defined similarly.</p>
<p>To initialize the algorithm at round 0, we take
<disp-formula id="pcbi.1006342.e082"><alternatives><graphic id="pcbi.1006342.e082g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e082" xlink:type="simple"/><mml:math display="block" id="M82"><mml:mrow><mml:msubsup><mml:mi>b</mml:mi> <mml:mi>i</mml:mi> <mml:mn>0</mml:mn></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mo>=</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:msub><mml:mi>v</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives> <label>(22)</label></disp-formula>
<disp-formula id="pcbi.1006342.e083"><alternatives><graphic id="pcbi.1006342.e083g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e083" xlink:type="simple"/><mml:math display="block" id="M83"><mml:mrow><mml:msubsup><mml:mi>b</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mi>i</mml:mi></mml:mrow> <mml:mn>0</mml:mn></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub></mml:munder> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:msub><mml:mi>v</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup> <mml:msubsup><mml:mi>b</mml:mi> <mml:mi>j</mml:mi> <mml:mn>0</mml:mn></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(23)</label></disp-formula>
We compute the round <italic>r</italic> + 1 beliefs from the round <italic>r</italic> beliefs according to the following equations.
<disp-formula id="pcbi.1006342.e084"><alternatives><graphic id="pcbi.1006342.e084g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e084" xlink:type="simple"/><mml:math display="block" id="M84"><mml:mrow><mml:msubsup><mml:mi>b</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mi>r</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub></mml:munder> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:msub><mml:mi>v</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup> <mml:mfrac><mml:mrow><mml:msubsup><mml:mi>b</mml:mi> <mml:mi>j</mml:mi> <mml:mi>r</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msubsup><mml:mi>b</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>r</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives> <label>(24)</label></disp-formula>
<disp-formula id="pcbi.1006342.e085"><alternatives><graphic id="pcbi.1006342.e085g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e085" xlink:type="simple"/><mml:math display="block" id="M85"><mml:mrow><mml:msubsup><mml:mi>b</mml:mi> <mml:mi>i</mml:mi> <mml:mrow><mml:mi>r</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mo>=</mml:mo> <mml:mo>λ</mml:mo> <mml:msubsup><mml:mi>b</mml:mi> <mml:mi>i</mml:mi> <mml:mi>r</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mo>λ</mml:mo> <mml:mo>)</mml:mo></mml:mrow> <mml:mfrac><mml:mrow><mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:msub><mml:mi>v</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup> <mml:msub><mml:mo>∏</mml:mo> <mml:mi>j</mml:mi></mml:msub> <mml:msubsup><mml:mi>b</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mi>r</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msub><mml:mo>∑</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub></mml:msub> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:msub><mml:mi>v</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup> <mml:msub><mml:mo>∏</mml:mo> <mml:mi>j</mml:mi></mml:msub> <mml:msubsup><mml:mi>b</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mi>r</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives> <label>(25)</label></disp-formula>
The products in <xref ref-type="disp-formula" rid="pcbi.1006342.e085">Eq 25</xref> should be understood as taken only over residues <italic>j</italic> that interact with residue <italic>i</italic>. The damping constant λ suppresses oscillatory behavior that hinders convergence (λ = 0.4 is used in the present work). The equations are iterated until <inline-formula id="pcbi.1006342.e086"><alternatives><graphic id="pcbi.1006342.e086g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e086" xlink:type="simple"/><mml:math display="inline" id="M86"><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msubsup><mml:mi>b</mml:mi> <mml:mi>i</mml:mi> <mml:mrow><mml:mi>r</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>b</mml:mi> <mml:mi>i</mml:mi> <mml:mi>r</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>|</mml:mo> <mml:mo>&lt;</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>001</mml:mn></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> for all residues <italic>i</italic> and states <inline-formula id="pcbi.1006342.e087"><alternatives><graphic id="pcbi.1006342.e087g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e087" xlink:type="simple"/><mml:math display="inline" id="M87"><mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula>.</p>
<p>From the converged beliefs <inline-formula id="pcbi.1006342.e088"><alternatives><graphic id="pcbi.1006342.e088g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e088" xlink:type="simple"/><mml:math display="inline" id="M88"><mml:mrow><mml:msub><mml:mi>b</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006342.e089"><alternatives><graphic id="pcbi.1006342.e089g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e089" xlink:type="simple"/><mml:math display="inline" id="M89"><mml:mrow><mml:msub><mml:mi>b</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, we can compute the marginal probabilities
<disp-formula id="pcbi.1006342.e090"><alternatives><graphic id="pcbi.1006342.e090g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e090" xlink:type="simple"/><mml:math display="block" id="M90"><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mo>=</mml:mo> <mml:msub><mml:mi>b</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(26)</label></disp-formula>
<disp-formula id="pcbi.1006342.e091"><alternatives><graphic id="pcbi.1006342.e091g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e091" xlink:type="simple"/><mml:math display="block" id="M91"><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>b</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msub><mml:mi>b</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:msub><mml:mi>v</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup> <mml:mfrac><mml:mrow><mml:msub><mml:mi>b</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msub><mml:mi>b</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow> <mml:mrow><mml:msub><mml:mo>∑</mml:mo> <mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub> <mml:mfrac><mml:mrow><mml:msub><mml:mi>b</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msub><mml:mi>b</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:msub><mml:mi>v</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup> <mml:mfrac><mml:mrow><mml:msub><mml:mi>b</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msub><mml:mi>b</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(27)</label></disp-formula>
The free energy of the model is obtained by using the marginal probabilities above in <xref ref-type="disp-formula" rid="pcbi.1006342.e057">Eq 15</xref>.</p>
</sec>
<sec id="sec011">
<title>Simulation details</title>
<p>The simulations are run with <italic>Upside</italic>. The replica exchange temperatures are 0.500, 0.532, 0.566, 0.600, 0.636, 0.672, 0.709, 0.748, 0.787, 0.828, 0.869, 0.912, 0.955, and 1.000. The Ramachandran potential uses the NDRD TCB coil library [<xref ref-type="bibr" rid="pcbi.1006342.ref014">14</xref>]. The backbone hydrogen bond interaction uses both distance and angle criteria to determine hydrogen bonds. The H-O bond distance interaction starts at approximately 1.4 Å and ends at 2.5 Å. Both the N-H-O and H-O-C criteria half-heights are at approximately 47 degrees off of co-linear.</p>
<p>We use Verlet integration with a time step of 0.009 units. We use the random number generator Random123 [<xref ref-type="bibr" rid="pcbi.1006342.ref015">15</xref>] to implement the Langevin dynamics with a thermalization time scale of 0.135 time units. The thermalization time scale (related to Langevin friction) is chosen to maximize the effective diffusion rate of chains while effectively controlling simulation temperature. As Langevin dynamics with any friction coefficient produces the same Boltzmann ensemble, we chose to maximize equilibration of our system rather than attempt to match a solvent viscosity.</p>
<p>The cutoff radius for side chain-side chain interactions is 7Å, and the cutoff radius for side chain-backbone interactions is 5Å. The distance splines are zero-derivative-clamped cubic splines with a knot spacing of 0.5Å. The angular splines have a knot spacing of 0.167 in cos<italic>θ</italic>, which ranges over [−1, 1].</p>
</sec>
<sec id="sec012">
<title>Optimization details</title>
<p>The Adam optimizer [<xref ref-type="bibr" rid="pcbi.1006342.ref016">16</xref>], a popular algorithm to optimize noisy objective functions, is used to minimize the energy gap. This optimizer is convenient because it automatically adjusts the gradient descent step size for each parameter according to the typical scale of the gradient in that dimension. This rescaling is important because spline coefficients at large radii tend to have much larger gradient magnitudes than parameters at small radii.</p>
<p>We use the following settings for the Adam optimizer: minibatch size of 256 proteins, <italic>α</italic> = 0.03, <italic>β</italic><sub>1</sub> = 0.90, <italic>β</italic><sub>2</sub> = 0.96, <italic>ϵ</italic> = 10<sup>−6</sup>. Positivity constraints on the angular coefficients are enforced by a exponential transform. The regularization integrals over all space are approximated by sums at the knot locations of the radial and angular splines.</p>
<p>A regularization penalty is added to the maximum-likelihood optimization that encourages smoothness of the potential. This penalty also reduces the validation error of the training. The regularization penalties chosen are
<disp-formula id="pcbi.1006342.e092"><alternatives><graphic id="pcbi.1006342.e092g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e092" xlink:type="simple"/><mml:math display="block" id="M92"><mml:mrow><mml:munder><mml:mo>∑</mml:mo> <mml:mi>i</mml:mi></mml:munder> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:msubsup><mml:mi>c</mml:mi> <mml:mi>i</mml:mi> <mml:mtext>unif</mml:mtext></mml:msubsup> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>c</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mtext>unif</mml:mtext></mml:msubsup> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>c</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mtext>unif</mml:mtext></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></alternatives> <label>(28)</label></disp-formula>
<disp-formula id="pcbi.1006342.e093"><alternatives><graphic id="pcbi.1006342.e093g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e093" xlink:type="simple"/><mml:math display="block" id="M93"><mml:mrow><mml:munder><mml:mo>∑</mml:mo> <mml:mi>i</mml:mi></mml:munder> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>c</mml:mi> <mml:mi>i</mml:mi> <mml:mtext>dir</mml:mtext></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></alternatives> <label>(29)</label></disp-formula>
<disp-formula id="pcbi.1006342.e094"><alternatives><graphic id="pcbi.1006342.e094g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e094" xlink:type="simple"/><mml:math display="block" id="M94"><mml:mrow><mml:munder><mml:mo>∑</mml:mo> <mml:mi>i</mml:mi></mml:munder> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>c</mml:mi> <mml:mn>0</mml:mn> <mml:mtext>unif</mml:mtext></mml:msubsup> <mml:mo>-</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>5</mml:mn> <mml:mspace width="0.166667em"/><mml:msub><mml:mi>k</mml:mi> <mml:mtext>B</mml:mtext></mml:msub> <mml:mi>T</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></alternatives> <label>(30)</label></disp-formula>
The penalty <xref ref-type="disp-formula" rid="pcbi.1006342.e092">Eq 28</xref> encourages a small second derivative for the isotropic (unif) term, while the penalty <xref ref-type="disp-formula" rid="pcbi.1006342.e093">Eq 29</xref> minimizes the size of the directional interactions. Finally, the penalty <xref ref-type="disp-formula" rid="pcbi.1006342.e094">Eq 30</xref> ensures a strong steric core for interactions.</p>
<p>The derivative calculations needed for regularization and coordinate transforms are handled with the Tensorflow framework [<xref ref-type="bibr" rid="pcbi.1006342.ref017">17</xref>].</p>
</sec>
<sec id="sec013">
<title>Optimized mapping to coarse states</title>
<p>The <italic>χ</italic>-angles for the side chains are partitioned into discrete states in an optimized manner (<xref ref-type="fig" rid="pcbi.1006342.g004">Fig 4</xref>). The NDRD rotamer library [<xref ref-type="bibr" rid="pcbi.1006342.ref018">18</xref>] provides a set of approximate discrete states for each residue type according to their frequencies of occurrence in a non-redundant set of high resolution protein structures in the PDB. However, the number of rotamer states in the NDRD library can be quite large. For instance, naively using all 81 rotamers for each arginine means that computing the pair interaction <italic>v</italic><sub><italic>i</italic>, <italic>j</italic></sub> for two arginines would require computing 81<sup>2</sup> = 6561 energy values. Consequently, instead of using all possible rotamer states, several NDRD rotamer states are combined into 3–6 coarse-grained rotamer states for the sake of manageable computational cost.</p>
<p>We choose to aggregate the rotamer states of the side chain to minimize the positional uncertainty of side chain atoms in each state. A search over all possible aggregations is conducted to find the aggregation that provides the smallest possible error. More formally, the NDRD rotamer library [<xref ref-type="bibr" rid="pcbi.1006342.ref018">18</xref>] is used to define the atomic positions <inline-formula id="pcbi.1006342.e095"><alternatives><graphic id="pcbi.1006342.e095g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e095" xlink:type="simple"/><mml:math display="inline" id="M95"><mml:mrow><mml:msubsup><mml:mi>x</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>f</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo>,</mml:mo> <mml:mi>ψ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, where <italic>i</italic> is the atom (such as C<sub><italic>β</italic></sub>), <italic>j</italic> is the coordinate (<italic>x</italic>, <italic>y</italic>, or <italic>z</italic>), and <italic>f</italic> is the fine-grained rotamer state. Each rotamer state has a probability <italic>p</italic><sup><italic>f</italic></sup>(<italic>ϕ</italic>, <italic>ψ</italic>) specified in the NDRD library from frequencies in the PDB for each fine-grained rotamer state as a function of the backbone dihedral angles (<italic>ϕ</italic>, <italic>ψ</italic>). Each fine-grained state <italic>f</italic> may belong to exactly one coarse-grained state <italic>c</italic> (i.e. the <italic>c</italic> states form a partition of the <italic>f</italic> states). Given the choice of a coarse-grained state <italic>c</italic>, an average is performed over the fine-grained atomic positions, and sum is taken over the probabilities of all fine-grained states <italic>f</italic> grouped into <italic>c</italic> according to the prescription,
<disp-formula id="pcbi.1006342.e096"><alternatives><graphic id="pcbi.1006342.e096g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e096" xlink:type="simple"/><mml:math display="block" id="M96"><mml:mrow><mml:msup><mml:mi>q</mml:mi> <mml:mi>c</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo>,</mml:mo> <mml:mi>ψ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>f</mml:mi> <mml:mo>∈</mml:mo> <mml:mi>c</mml:mi></mml:mrow></mml:munder> <mml:msup><mml:mi>p</mml:mi> <mml:mi>f</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo>,</mml:mo> <mml:mi>ψ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(31)</label></disp-formula>
<disp-formula id="pcbi.1006342.e097"><alternatives><graphic id="pcbi.1006342.e097g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e097" xlink:type="simple"/><mml:math display="block" id="M97"><mml:mrow><mml:msubsup><mml:mi>y</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>c</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo>,</mml:mo> <mml:mi>ψ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:msup><mml:mi>q</mml:mi> <mml:mi>c</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo>,</mml:mo> <mml:mi>ψ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>f</mml:mi> <mml:mo>∈</mml:mo> <mml:mi>c</mml:mi></mml:mrow></mml:munder> <mml:msubsup><mml:mi>p</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>f</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo>,</mml:mo> <mml:mi>ψ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:msubsup><mml:mi>x</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>f</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo>,</mml:mo> <mml:mi>ψ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(32)</label></disp-formula>
where <italic>q</italic><sup><italic>c</italic></sup> is the coarse-grained probability and <inline-formula id="pcbi.1006342.e098"><alternatives><graphic id="pcbi.1006342.e098g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e098" xlink:type="simple"/><mml:math display="inline" id="M98"><mml:msubsup><mml:mi>y</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>c</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> is the coarse-grained atomic position.</p>
<p>The error incurred by coarse-graining is defined as the variance of the atom positions within each coarse-grained state, weighted by the frequency of occurrence of the coarse-grained state in the PDB. Specifically, the error <italic>σ</italic><sup>2</sup>(<italic>ϕ</italic>, <italic>ψ</italic>) is defined as,
<disp-formula id="pcbi.1006342.e099"><alternatives><graphic id="pcbi.1006342.e099g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e099" xlink:type="simple"/><mml:math display="block" id="M99"><mml:mrow><mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo>,</mml:mo> <mml:mi>ψ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>f</mml:mi></mml:munder> <mml:mfrac><mml:mrow><mml:msup><mml:mi>p</mml:mi> <mml:mi>f</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo>,</mml:mo> <mml:mi>ψ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:msub><mml:mi>N</mml:mi> <mml:mtext>atom</mml:mtext></mml:msub></mml:mfrac> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:munder> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>x</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>f</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo>,</mml:mo> <mml:mi>ψ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>y</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mrow><mml:mi>c</mml:mi> <mml:mo>(</mml:mo> <mml:mi>f</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo>,</mml:mo> <mml:mi>ψ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(33)</label></disp-formula>
where <italic>N</italic><sub>atom</sub> is the number of atoms in the side chain and <italic>c</italic>(<italic>f</italic>) is the coarse-grained state <italic>c</italic> that contains the fine-grained state <italic>f</italic>. The error depends implicitly on the state decomposition <italic>c</italic>(<italic>f</italic>) and measures the deviation of the atoms within each state. This error favors the fine-grained states <italic>f</italic> that occur with higher frequency in the PDB.</p>
<p>The division of fine-grained states into coarse-grained states is restricted for simplicity to be independent of the Ramachandran angles for the residue,
<disp-formula id="pcbi.1006342.e100"><alternatives><graphic id="pcbi.1006342.e100g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e100" xlink:type="simple"/><mml:math display="block" id="M100"><mml:mrow><mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>=</mml:mo> <mml:mo>∫</mml:mo> <mml:msup><mml:mi>p</mml:mi> <mml:mtext>Rama</mml:mtext></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo>,</mml:mo> <mml:mi>ψ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo>,</mml:mo> <mml:mi>ψ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mi>d</mml:mi> <mml:mi>ϕ</mml:mi> <mml:mspace width="0.166667em"/><mml:mi>d</mml:mi> <mml:mi>ψ</mml:mi> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(34)</label></disp-formula>
where <italic>p</italic><sup>Rama</sup>(<italic>ϕ</italic>, <italic>ψ</italic>) is the frequency of each Ramachandran angle taken from the PDB coil library. Note that this error term depends implicitly on the decomposition <italic>c</italic>(<italic>f</italic>) and weights for the (<italic>ϕ</italic>, <italic>ψ</italic>) pairs according to their frequencies in the coil library.</p>
<p>An optimal coarse-grained representation of the side chain rotamer states is obtained by minimizing <italic>σ</italic><sup>2</sup> for each residue type over all partitions <italic>c</italic>(<italic>f</italic>). We force the coarse-graining <italic>c</italic>(<italic>f</italic>) to obey a few conditions, essentially to make sure that <italic>c</italic>(<italic>f</italic>) is easily interpretable in terms of <italic>χ</italic><sub>1</sub> and <italic>χ</italic><sub>2</sub> as well as limiting the number of possibilities that must be checked by the brute-force minimization. In particular, the mapping from coarse states back to <italic>χ</italic><sub>1</sub> rotamer states is unambiguous because no single coarse state contains two different <italic>χ</italic><sub>1</sub> rotamer states. We impose the following conditions:</p>
<list list-type="order">
<list-item>
<p><italic>c</italic>(<italic>f</italic>) depends only on the <italic>χ</italic><sub>1</sub> and <italic>χ</italic><sub>2</sub> rotamer states of <italic>f</italic> (i.e. if <italic>f</italic><sub>1</sub> and <italic>f</italic><sub>2</sub> states differ only in their <italic>χ</italic><sub>3</sub> or <italic>χ</italic><sub>4</sub> states, then <italic>c</italic>(<italic>f</italic><sub>1</sub>) = <italic>c</italic>(<italic>f</italic><sub>2</sub>)).</p>
</list-item>
<list-item>
<p>Each coarse state <italic>c</italic> must contain only a single <italic>χ</italic><sub>1</sub> state but may contain multiple distinct <italic>χ</italic><sub>2</sub> states for that <italic>χ</italic><sub>1</sub> state.</p>
</list-item>
<list-item>
<p>Each coarse state <italic>c</italic> must contain a contiguous range of <italic>χ</italic><sub>2</sub> values. This greatly reduces the number of possible coarse-grainings for residues with non-rotameric <italic>χ</italic><sub>2</sub> angles like asparagine.</p>
</list-item>
</list>
<p>We optimize the decomposition of the coarse-grained state <italic>c</italic>(<italic>f</italic>) by completely enumerating all possible decompositions into coarse-grained states that satisfy the three conditions above and contain no more than six coarse states.</p>
</sec>
<sec id="sec014">
<title>Backbone parameters</title>
<p>The backbone atoms interact with a soft-sphere repulsion at approximately 3 Å interatomic distance. The equilibrium distances of the N–C<sub><italic>α</italic></sub>, C<sub><italic>α</italic></sub>–C, and C–N bonds are 1.453 Å, 1.526 Å, and 1.300 Å, respectively. The backbone angles are restrained at their ideal values (109.5° and 120°).</p>
</sec>
</sec>
<sec id="sec015" sec-type="results">
<title>Results</title>
<sec id="sec016">
<title>Packing accuracy</title>
<p>The accuracy of the results are computed in two ways. The first measure computes the accuracy of the one-residue probabilities at predicting the <italic>χ</italic><sub>1</sub> states of the protein. This quantity is the traditional accuracy measure for side chain packing algorithms. The second measure is the quality of the ensemble, obtained by computing the difference (<italic>E</italic><sub>gap</sub>) between the free energy of the side chain system and the potential energy of the crystallographic rotamer configuration (<xref ref-type="disp-formula" rid="pcbi.1006342.e067">Eq 20</xref>). For a highly accurate side chain ensemble, we would expect that the crystal configuration would be a high probability state in the ensemble and thus the <italic>E</italic><sub>gap</sub> would be small. This energy gap is minimized by the maximum-likelihood training. The two accuracy measures are typically linearly related for the side chain models we consider.</p>
<p>To compare to modern side chain prediction methods, we benchmark against SCWRL4 [<xref ref-type="bibr" rid="pcbi.1006342.ref003">3</xref>] on its training and validation set of side chains conformations (<xref ref-type="fig" rid="pcbi.1006342.g006">Fig 6</xref>), as well as the RASP algorithm [<xref ref-type="bibr" rid="pcbi.1006342.ref006">6</xref>] for rapid side chain packing (<xref ref-type="fig" rid="pcbi.1006342.g007">Fig 7</xref>). Since the <italic>Upside</italic> model lacks full side chains, we use the most likely <italic>χ</italic><sub>1</sub> rotamer state according to the 1-residue marginal distributions <inline-formula id="pcbi.1006342.e101"><alternatives><graphic id="pcbi.1006342.e101g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e101" xlink:type="simple"/><mml:math display="inline" id="M101"><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. As per SCWRL4’s validation procedure, the lowest confidence side chains are excluded (bottom 25<sup>th</sup> percentile in electron density). To avoid biasing the comparison toward <italic>Upside</italic>, the SCWRL4 training set is split so that 20% of the proteins are withheld for measuring accuracy, while the rest are used for maximum-likelihood training. The accuracy metric chosen is to calculate the fraction of side chains for which the <italic>Upside</italic> or SCWRL4 predicted <italic>χ</italic><sub>1</sub> rotamer state agrees with the crystallographic conformation. The residues alanine, glycine, and proline are excluded from the comparison.</p>
<fig id="pcbi.1006342.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006342.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Comparison of <italic>χ</italic><sub>1</sub> prediction accuracy for <italic>Upside</italic> and SCWRL4, ordered by <italic>Upside</italic> accuracy.</title>
<p>The “PDB <italic>χ</italic><sub>1</sub> frequency” line represents the accuracy of the NDRD rotamer library without any interactions; this library is used in both <italic>Upside</italic> and SCWRL4.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006342.g006" xlink:type="simple"/>
</fig>
<fig id="pcbi.1006342.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006342.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Comparison of the accuracy of predicting side chains as well as cpu running time.</title>
<p>For all programs, time spent reading the protein structure and writing the results is excluded from the running time to focus on the cost of solving for the side chain positions. For Upside (10 Å cutoff), all side chain interactions with backbone or other side chains are cutoff at 10 Å.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006342.g007" xlink:type="simple"/>
</fig>
<p>Comparison of <italic>χ</italic><sub>1</sub> prediction accuracy for <italic>Upside</italic> and SCWRL4, ordered by <italic>Upside</italic> accuracy. The “PDB <italic>χ</italic><sub>1</sub> frequency” line represents the accuracy of the NDRD rotamer library without any interactions; this library is used in both <italic>Upside</italic> and SCWRL4. <italic>Upside</italic> is accurate, predicting the correct <italic>χ</italic><sub>1</sub> rotamer 91.0% of the time using 10 Å cutoffs, which is better than SCWRL4 [<xref ref-type="bibr" rid="pcbi.1006342.ref003">3</xref>] or RASP [<xref ref-type="bibr" rid="pcbi.1006342.ref006">6</xref>]’s values of 89.5 and 86.5%, respectively (Figs <xref ref-type="fig" rid="pcbi.1006342.g006">6</xref> and <xref ref-type="fig" rid="pcbi.1006342.g007">7</xref>). Additionally, <italic>Upside</italic> predicts side chains 16 times faster than the speed-optimized RASP and 300 times faster than accuracy-optimized SCWRL4. This very fast calculation enables <italic>Upside</italic>’s side chain model to be viable in the inner loop of molecular dynamics simulations, as discussed in the next section.</p>
<p>We examined the importance of various interactions in <italic>Upside</italic> by recalculating the change in accuracy upon their removal. For example in <xref ref-type="table" rid="pcbi.1006342.t001">Table 1</xref>, we calculated the decrease in performance after retraining our parameters on the PDB-based test set after removing one or more energy terms. One can see that using only repulsive interactions causes a 3.8% drop in side chain prediction accuracy compared to the full model, which quantifies the importance of the attractive interactions.</p>
<table-wrap id="pcbi.1006342.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006342.t001</object-id>
<label>Table 1</label>
<caption>
<title>Accuracy of predicting <italic>χ</italic><sub>1</sub> for the SCWRL4 data set.</title>
</caption>
<alternatives>
<graphic id="pcbi.1006342.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006342.t001" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left">Energy terms used</th>
<th align="left">Accuracy change (%)</th>
<th align="left">Δ<italic>E</italic><sub>gap</sub> (<italic>k</italic><sub>B</sub><italic>T</italic>)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">10Å cutoffs</td>
<td align="char" char=".">+0.7</td>
<td align="char" char=".">-0.028</td>
</tr>
<tr>
<td align="left">Full model</td>
<td align="char" char=".">0.0</td>
<td align="char" char=".">0.000</td>
</tr>
<tr>
<td align="left">No H/O interactions</td>
<td align="char" char=".">-0.6</td>
<td align="char" char=".">0.013</td>
</tr>
<tr>
<td align="left">No N,C<sub><italic>α</italic></sub>,C beads</td>
<td align="char" char=".">-2.3</td>
<td align="char" char=".">0.040</td>
</tr>
<tr>
<td align="left"><italic>ϕ</italic>, <italic>ψ</italic>-independent <italic>V</italic>(<italic>χ</italic>)</td>
<td align="char" char=".">-3.3</td>
<td align="char" char=".">0.004</td>
</tr>
<tr>
<td align="left">Isotropic only</td>
<td align="char" char=".">-3.5</td>
<td align="char" char=".">0.080</td>
</tr>
<tr>
<td align="left">Repulsive only</td>
<td align="char" char=".">-3.8</td>
<td align="char" char=".">0.060</td>
</tr>
<tr>
<td align="left">Side chain—side chain only</td>
<td align="char" char=".">-3.8</td>
<td align="char" char=".">0.067</td>
</tr>
<tr>
<td align="left">Side chain—backbone only</td>
<td align="char" char=".">-6.1</td>
<td align="char" char=".">0.125</td>
</tr>
<tr>
<td align="left">No interactions</td>
<td align="char" char=".">-13.7</td>
<td align="char" char=".">0.435</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t001fn001">
<p>The significance of various components of the model reflect the decrease in accuracy for their removal and retraining on the entire training set. The parameters are separately optimized for each row of the table so that each <italic>E</italic><sub>gap</sub> represents the best achievable for the indicated functional form. Training was redone for each energy function and the ensuing accuracy was reevaluated. Results shown are for 20% of the SCWRL4 data set withheld for testing purposes. Note that these predictions are based on single-chain structures, so they differ slightly in accuracy from the predictions on all-chain structures reported in <xref ref-type="fig" rid="pcbi.1006342.g006">Fig 6</xref>.</p>
</fn>
</table-wrap-foot>
</table-wrap>
</sec>
<sec id="sec017">
<title>Molecular dynamics simulations</title>
<p>To test the suitability of adapting the side chain packing model to study protein dynamics, Langiven dynamics folding simulations were run on small, fast-folding proteins (<xref ref-type="table" rid="pcbi.1006342.t002">Table 2</xref>) using a standard Verlet algorithm that obeys detailed balance and conserves energy. The parameters obtained from the maximum-likelihood training are optimized for side chain packing for a set of fixed, native backbones, which is not the situation during the simulations where the backbone moves. In the limit that the model is flexible enough to describe the true side chain interactions and there are unlimited training data, the maximum-likelihood method should recover the true side chain interactions. Even without having the true form of the side chain interaction, the maximum-likelihood parameters assign high probability to the observed rotamer states, thereby providing evidence that it includes a significant portion of the underlying physics, and thus may be viable for use in molecular dynamics simulations.</p>
<table-wrap id="pcbi.1006342.t002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006342.t002</object-id>
<label>Table 2</label>
<caption>
<title>Sequences of proteins for molecular dynamics simulations.</title>
</caption>
<alternatives>
<graphic id="pcbi.1006342.t002g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006342.t002" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center">Name</th>
<th align="center">PDB ID</th>
<th align="center">Length</th>
<th align="left">Sequence</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">alpha3d</td>
<td align="center">2a3d</td>
<td align="center">73</td>
<td align="left">MGSWAEFKQRLAAIKTRLQALGGSEAELAA<break/>FEKEIAAFESELQAYKGKGNPEVEALRKEA<break/>AAIRDELQAYRHN</td>
</tr>
<tr>
<td align="center">BBL</td>
<td align="center">2wxc</td>
<td align="center">47</td>
<td align="left">GSQNNDALSPAIRRLLAEWNLDASAIKGTG<break/>VGGRLTREDVEKHLAKA</td>
</tr>
<tr>
<td align="center">homeodomain</td>
<td align="center">2p6j</td>
<td align="center">52</td>
<td align="left">MKQWSENVEEKLKEFVKRHQRITQEELHQY<break/>AQRLGLNEEAIRQFFEEFEQRK</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>Since the maximum likely-hood training was conducted on proteins with fixed backbones, to create a reasonable model for dynamics, a basic Ramachandran potential, backbone springs and sterics, and a hydrogen bond energy, are added to the side chain model (see Subsection <bold>Simulation details</bold>). The Ramachandran nearest-neighbor dependent potential is derived from a coil library [<xref ref-type="bibr" rid="pcbi.1006342.ref014">14</xref>] as a statistical potential. The hydrogen bond enthalpy is varied to find the maximum accuracy. Note that because alanine and glycine have no side chain rotamer states, and hence no training to match the native <italic>χ</italic>-angles is feasible, the ALA-ALA, ALA-GLY, and GLY-GLY potentials are completely determined by the regularization. Interactions of ALA and GLY with other residue types are optimized, however, as rotamer states of the other residues provide information on the ALA-X and GLY-X interactions.</p>
<p>The hydrogen bond term does not play an explicit role in the packing optimization as the backbone and associated hydrogen bonds remain fixed during side chain placement. Hence, this term is not trained during the maximum likelihood procedure for the side chain positions. To assign an energy to the hydrogen bond term, it was manually varied for the best simulation accuracy. This term is the only parameter manually optimized for simulation accuracy.</p>
<p>Simulations were run on four small proteins. We obtained commendable results on three, alpha3D, BBA and a homeo domain, but not on a WW domain. We manually scanned through different hydrogen bond strengths to find an optimal for folding accuracy (<xref ref-type="fig" rid="pcbi.1006342.g008">Fig 8</xref>). For the three successful proteins, sub-3 Å structures were obtained in under two cpu-days (lowest C<sub><italic>α</italic></sub>-RMSD, <xref ref-type="fig" rid="pcbi.1006342.g009">Fig 9</xref>). Although performance depended on hydrogen bond strength, a single value of -1.8 units produced near-optimal results across the three proteins. The removal of side chain-backbone hydrogen bonds had a surprisingly small and sometimes even a positive effect on accuracy. Evidently for these proteins, helix capping signals are not important. More proteins and better training procedures are needed to investigate the generality of this finding. Overall, these results demonstrate that our model has the capability of folding proteins on the cpu-day time-scale. In the companion paper, we investigate the models potential for folding proteins when the energy function is trained for this purpose.</p>
<fig id="pcbi.1006342.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006342.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Accuracy of MD simulations for three proteins at variable backbone hydrogen bond strength.</title>
<p>Results with and without side chain-backbone interactions are presented.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006342.g008" xlink:type="simple"/>
</fig>
<fig id="pcbi.1006342.g009" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006342.g009</object-id>
<label>Fig 9</label>
<caption>
<title>Closest structure to native protein (lowest C<sub><italic>α</italic></sub>-RMSD) at optimal hydrogen bonding strength, with and without backbone-side chain hydrogen bonds.</title>
<p>For alpha3D, BBA and homeodomain with backbone-side chain hydrogen bonds, the optimal hydrogen bond strength and lowest C<sub><italic>α</italic></sub>-RMSD are -2.0, -2.0 and -1.9 RT, and 3.6, 1.7 and 3 Å, respectively. Without these hydrogen bonds, the corresponding values are -2.0, -1.8 and -1.6 RT; and 2.7, 1.8, and 2.5 Å. Blue is the native structure and red is the simulation.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006342.g009" xlink:type="simple"/>
</fig>
</sec>
</sec>
<sec id="sec018" sec-type="conclusions">
<title>Discussion</title>
<p>We have demonstrated a fast, principled method to coarse-grain discrete side chain states and create a smooth backbone potential. This procedure results in a considerable decrease in computational time as it removes the side chain rattling and friction normally associated with a polypeptide chain moving in a condensed state. This tracking and instantaneous equilibration of the side chains is analogous to the instantaneously-equilibrated electronic degrees of freedom with respect to the nuclear motions employed in the adiabatic Born-Oppenheimer approximation [<xref ref-type="bibr" rid="pcbi.1006342.ref019">19</xref>]. Motions are calculated only for three heavy backbone atoms, yet the model contains considerable structural detail including hydrogen bonds involving both the backbone and side chains. Further, we have presented both a maximum likelihood procedure to obtain a physically-reasonable potential from the side chain packing of X-ray structures and a tunable discretization of the rotamer states. The resulting method is capable of rapid molecular dynamics of protein structures with comendable accuracy considering the computational speed.</p>
<p><italic>Upside</italic> is a coarse-grain model, and hence, certain details will be approximate especially for the unfolded state. However, our side chain energies include a rotameric term reflecting the intrinsic <italic>χ</italic><sub>1</sub> preference so we anticipate that our predicted <italic>χ</italic><sub>1</sub> distribution will be reasonable, especially for side chains typically found on the surface.</p>
<sec id="sec019">
<title>Comparison to previous work</title>
<p>We highlight several works related to the major features of our model, including molecular dynamics on three atoms but with a dynamic ensemble of side chains, optimized discretization of the side chain states to best represent the protein interactions in the coarse-grained model, a potential with optimized and state-dependent bead locations and orientations, training a protein interaction model for folding using side chain packing accuracy, and a side chain model with an explicit side chain entropy.</p>
<p>A large body of work, exemplified by SCWRL4 [<xref ref-type="bibr" rid="pcbi.1006342.ref003">3</xref>], has studied the prediction of side chain configurations by discrete rotamer states (Figs <xref ref-type="fig" rid="pcbi.1006342.g006">6</xref> and <xref ref-type="fig" rid="pcbi.1006342.g007">7</xref>). SCWRL4 achieves approximately 90% <italic>χ</italic><sub>1</sub> accuracy for predicting the most likely rotamer states by minimizing the energy that combines observed rotamer state frequencies and an atomic interaction model [<xref ref-type="bibr" rid="pcbi.1006342.ref003">3</xref>]. A variety of algorithms have been developed to solve for the highest probability side chain states given the pair interaction values [<xref ref-type="bibr" rid="pcbi.1006342.ref020">20</xref>, <xref ref-type="bibr" rid="pcbi.1006342.ref021">21</xref>]. Kamisetty et al.[<xref ref-type="bibr" rid="pcbi.1006342.ref022">22</xref>] have worked on scoring protein interaction complexes using a self-consistent approximation to the side chain interactions. Earlier simulation work by Koehl and Delarue [<xref ref-type="bibr" rid="pcbi.1006342.ref023">23</xref>] use 1-residue mean field techniques to approximate ensembles of side chain conformations but fail to account for the pairwise correlations of the side chain rotamer states. All of these works use atomically-detailed descriptions of the side chains paired with simple or molecular dynamics interaction terms. Their highly detailed side chains with many <italic>χ</italic>-angles for each residue make it difficult to perform calculations sufficiently fast for folding simulations, and the use of existing interactions (instead of a newly-trained interaction model) makes it difficult to reduce detail to increase the computational speed. There has also been extensive work in reconstructing backbone positions from side chain beads [<xref ref-type="bibr" rid="pcbi.1006342.ref024">24</xref>] in lattice models, but these models do not perform a proper summation over possible rotamer states.</p>
<p>RASP [<xref ref-type="bibr" rid="pcbi.1006342.ref006">6</xref>] is side chain modeling program designed to significantly improve the speed of side chain packing while achieving comparable accuracy. The authors use careful selection of the most important energy terms as well as employing clash-detection to guide the optimization of the side chain conformations. A recent method, OSCAR-o [<xref ref-type="bibr" rid="pcbi.1006342.ref004">4</xref>], employs a genetic algorithm for swapping low energy side chain conformations. Oscar utilizes a distance- and orientational dependent energy function that is optimized for side chain packing accuracy [<xref ref-type="bibr" rid="pcbi.1006342.ref005">5</xref>], similar to <italic>Upside</italic>’s side chain potential.</p>
<p>Kihara and coworkers [<xref ref-type="bibr" rid="pcbi.1006342.ref025">25</xref>] conducted a thorough study of side chain accuracy in different environments. They found that OSCAR-o and the speed optimized OSCAR-star performed better than the other methods including SCWRL4, RASP and Rosetta, having a mean prediction accuracy of 88% versus 85, 85 and 83% accuracy, respectively, on their monomeric test set. Since <italic>Upside</italic>’s accuracy is very similar to SCWRL4, we infer that <italic>Upside</italic>’s performance does not quite match the OSCAR methods. However, the timing comparison presented indicates that <italic>Upside</italic> should be 4 and 2.5 orders of magnitude faster than OSCAR-o and OSCAR-star, respectively.</p>
<p>There have also been a large number of coarse-grained techniques that use a variety of non-isotropic potentials for reduced side chain interactions. One of the most successful is the coarse-grained united residue model (UNRES) [<xref ref-type="bibr" rid="pcbi.1006342.ref026">26</xref>]. The model also uses statistical frequencies to determine the positions of the side chains but it emphasizes the parameterization of the coarse-grained model from physics-based calculations instead of statistical information. Though the potential form (Gay-Berne) used in UNRES is quite different from our work, UNRES also uses non-isotropic side chain potentials [<xref ref-type="bibr" rid="pcbi.1006342.ref027">27</xref>].</p>
<p>Similar to our work, Dama, Sinitskiy, et al. [<xref ref-type="bibr" rid="pcbi.1006342.ref028">28</xref>] investigate mixed continuous-discrete dynamics, where the states of molecules jump according to a discrete Hamiltonian. Their method differs from our work in a number of important ways: the authors use discrete jumps in state instead of a free energy summation over all states that we employ; they do not optimize the rotamer states as we do; and they train parameters from force matching of molecular dynamics trajectories rather than from the statistical analysis of experimental data as we employ.</p>
</sec>
<sec id="sec020">
<title>Combination of <italic>Upside</italic> with other methodologies</title>
<p>The reason that <italic>Upside</italic> is both faster and has similar accuracy than competing methods at side chain packing is that <italic>Upside</italic> shifts the complexity of the <italic>χ</italic><sub>1</sub>-prediction problem. Traditional side chain prediction uses a detailed configuration space of all rotamers and side chain atoms but simple interaction forms with few parameters. <italic>Upside</italic> uses a coarse configuration space with only a single directional bead per residue but a complex and well-optimized set of parameters consisting of over 10,000 jointly-optimized parameters (trained on approximately 500,000 residues). <italic>Upside</italic> demonstrates that <italic>χ</italic><sub>1</sub> rotamers can be predicted with state-of-the-art accuracy without needing to examine fine-grained atomic packing. Additionally, the side chains in <italic>Upside</italic> are represented as a Boltzmann ensemble whose 1-residue marginal probabilities are used to predict <italic>χ</italic><sub>1</sub> instead of predicting <italic>χ</italic><sub>1</sub> using the lowest energy configuration. This approach allows for the natural consideration of side chain entropy and conformational variability. Creating a Boltzmann ensemble over rotamer states also allows exact, continuous forces to be defined for the approximate ensemble, enabling molecular dynamics using potential energies already validated to represent the physics of side chain packing.</p>
<p>A natural question is whether the strengths of SCWRL4 and this algorithm may be combined. There are two reasons to believe that such a combination would be fruitful. The first reason is that when <italic>Upside</italic> and SCWRL4 predict the same <italic>χ</italic><sub>1</sub> rotamer, the prediction is 95.4% accurate, substantially more accurate than either program alone. This suggests <italic>Upside</italic> and SCWRL4 provide independent information about the side chain conformations and hence, combining both approaches should produce a substantially better packing model. The second reason that <italic>Upside</italic> and SCWRL4 may be combined is that <italic>Upside</italic> provides probability functions as its outputs, rather than just the minimum energy conformation as in SCWRL4. The underlying SCWRL4 single-rotamer energies could be augmented with <inline-formula id="pcbi.1006342.e102"><alternatives><graphic id="pcbi.1006342.e102g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006342.e102" xlink:type="simple"/><mml:math display="inline" id="M102"><mml:mrow><mml:mo>-</mml:mo> <mml:mo>λ</mml:mo> <mml:mtext>log</mml:mtext><mml:mspace width="2pt"/><mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>U</mml:mi><mml:mi>p</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>d</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. For an appropriately determined λ, this should incorporate some of <italic>Upside</italic>’s information directly into SCWRL4, increasing SCWRL4’s accuracy. Alternatively, SCWRL4’s detailed but simple energy function could be augmented by an <italic>Upside</italic>-style coarse-grained function, possibly with additional maximum-likelihood tuning.</p>
</sec>
<sec id="sec021">
<title>Conclusion</title>
<p>For side chain packing applications, <italic>Upside</italic> accurately and rapidly predicts of <italic>χ</italic><sub>1</sub> rotamer states and their probabilities. <italic>Upside</italic> takes advantage of these two features for dynamics applications, and it shows considerable promise as a route to accurate and inexpensive molecular simulation. New training techniques are being developed to directly optimize the backbone accuracy of the <italic>Upside</italic> model. In the companion paper, we present results using new training methods that indicate that we are able to achieve dramatic improvements in the accuracy of <italic>de novo</italic> folding while preserving the rapid folding properties for a variety of proteins. We expect that our belief-propagated side chains will serve as an excellent basis for new methods in protein simulations.</p>
<p>Source code for side chain packing and molecular simulations can be obtained from <ext-link ext-link-type="uri" xlink:href="https://github.com/sosnicklab/upside-md" xlink:type="simple">https://github.com/sosnicklab/upside-md</ext-link>, and the results of this paper can be reproduced using the version tagged <monospace>sidechain_paper</monospace>.</p>
</sec>
</sec>
</body>
<back>
<ack>
<p>We would like to thank Sheng Wang and Jinbo Xu for helpful discussions during this research. Zhichao Miao kindly provided a modified version of RASP to measure only the side chain packing time. We thank Carolyn Jumper for proofreading and editorial assistance.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1006342.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Berman</surname> <given-names>HM</given-names></name>, <name name-style="western"><surname>Westbrook</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Feng</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Gilliland</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Bhat</surname> <given-names>TN</given-names></name>, <name name-style="western"><surname>Weissig</surname> <given-names>H</given-names></name>, <etal>et al</etal>. <article-title>The protein data bank</article-title>. <source>Nucleic acids research</source>. <year>2000</year>;<volume>28</volume>(<issue>1</issue>):<fpage>235</fpage>–<lpage>242</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/28.1.235" xlink:type="simple">10.1093/nar/28.1.235</ext-link></comment> <object-id pub-id-type="pmid">10592235</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006342.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hamelryck</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Borg</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Paluszewski</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Paulsen</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Frellsen</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Andreetta</surname> <given-names>C</given-names></name>, <etal>et al</etal>. <article-title>Potentials of mean force for protein structure prediction vindicated, formalized and generalized</article-title>. <source>PloS one</source>. <year>2010</year>;<volume>5</volume>(<issue>11</issue>):<fpage>e13714</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0013714" xlink:type="simple">10.1371/journal.pone.0013714</ext-link></comment> <object-id pub-id-type="pmid">21103041</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006342.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Krivov</surname> <given-names>GG</given-names></name>, <name name-style="western"><surname>Shapovalov</surname> <given-names>MV</given-names></name>, <name name-style="western"><surname>Dunbrack</surname> <given-names>RL</given-names></name>. <article-title>Improved prediction of protein side-chain conformations with SCWRL4</article-title>. <source>Proteins: Structure, Function, and Bioinformatics</source>. <year>2009</year>;<volume>77</volume>(<issue>4</issue>):<fpage>778</fpage>–<lpage>795</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/prot.22488" xlink:type="simple">10.1002/prot.22488</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006342.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Liang</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Zheng</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Standley</surname> <given-names>DM</given-names></name>. <article-title>Fast and accurate prediction of protein side-chain conformations</article-title>. <source>Bioinformatics</source>. <year>2011</year>;<volume>27</volume>(<issue>20</issue>):<fpage>2913</fpage>–<lpage>2914</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btr482" xlink:type="simple">10.1093/bioinformatics/btr482</ext-link></comment> <object-id pub-id-type="pmid">21873640</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006342.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Liang</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Zhou</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Grishin</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Standley</surname> <given-names>DM</given-names></name>. <article-title>Protein side chain modeling with orientation-dependent atomic force fields derived by series expansions</article-title>. <source>Journal of computational chemistry</source>. <year>2011</year>;<volume>32</volume>(<issue>8</issue>):<fpage>1680</fpage>–<lpage>1686</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/jcc.21747" xlink:type="simple">10.1002/jcc.21747</ext-link></comment> <object-id pub-id-type="pmid">21374632</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006342.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Miao</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Cao</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Jiang</surname> <given-names>T</given-names></name>. <article-title>RASP: rapid modeling of protein side chain conformations</article-title>. <source>Bioinformatics</source>. <year>2011</year>;<volume>27</volume>(<issue>22</issue>):<fpage>3117</fpage>–<lpage>3122</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btr538" xlink:type="simple">10.1093/bioinformatics/btr538</ext-link></comment> <object-id pub-id-type="pmid">21949272</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006342.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wainwright</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Jordan</surname> <given-names>MI</given-names></name>. <article-title>Graphical models, exponential families, and variational inference</article-title>. <source>Foundations and Trends in Machine Learning</source>. <year>2008</year>;<volume>1</volume>(<issue>1-2</issue>):<fpage>1</fpage>–<lpage>305</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006342.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Baxa</surname> <given-names>MC</given-names></name>, <name name-style="western"><surname>Haddadian</surname> <given-names>EJ</given-names></name>, <name name-style="western"><surname>Jumper</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Freed</surname> <given-names>KF</given-names></name>, <name name-style="western"><surname>Sosnick</surname> <given-names>TR</given-names></name>. <article-title>Loss of conformational entropy in protein folding calculated using realistic ensembles and its implications for NMR-based calculations</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2014</year>;<volume>111</volume>(<issue>43</issue>):<fpage>15396</fpage>–<lpage>15401</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1407768111" xlink:type="simple">10.1073/pnas.1407768111</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006342.ref009">
<label>9</label>
<mixed-citation publication-type="other" xlink:type="simple">Wainwright MJ, Jaakkola TS, Willsky AS. Tree-reweighted belief propagation algorithms and approximate ML estimation by pseudo-moment matching. In: AISTATS; 2003.</mixed-citation>
</ref>
<ref id="pcbi.1006342.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Harper</surname> <given-names>ET</given-names></name>, <name name-style="western"><surname>Rose</surname> <given-names>GD</given-names></name>. <article-title>Helix stop signals in proteins and peptides: the capping box</article-title>. <source>Biochemistry</source>. <year>1993</year>;<volume>32</volume>(<issue>30</issue>):<fpage>7605</fpage>–<lpage>7609</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1021/bi00081a001" xlink:type="simple">10.1021/bi00081a001</ext-link></comment> <object-id pub-id-type="pmid">8347570</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006342.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wang</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Dunbrack</surname> <given-names>RL</given-names></name>. <article-title>PISCES: a protein sequence culling server</article-title>. <source>Bioinformatics</source>. <year>2003</year>;<volume>19</volume>(<issue>12</issue>):<fpage>1589</fpage>–<lpage>1591</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btg224" xlink:type="simple">10.1093/bioinformatics/btg224</ext-link></comment> <object-id pub-id-type="pmid">12912846</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006342.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Fischler</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Bolles</surname> <given-names>RC</given-names></name>. <article-title>Random sample consensus: a paradigm for model fitting with applications to image analysis and automated cartography</article-title>. <source>Communications of the ACM</source>. <year>1981</year>;<volume>24</volume>(<issue>6</issue>):<fpage>381</fpage>–<lpage>395</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1145/358669.358692" xlink:type="simple">10.1145/358669.358692</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006342.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yedidia</surname> <given-names>JS</given-names></name>, <name name-style="western"><surname>Freeman</surname> <given-names>WT</given-names></name>, <name name-style="western"><surname>Weiss</surname> <given-names>Y</given-names></name>. <article-title>Understanding belief propagation and its generalizations</article-title>. <source>Exploring artificial intelligence in the new millennium</source>. <year>2003</year>;<volume>8</volume>:<fpage>236</fpage>–<lpage>239</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006342.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ting</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Shapovalov</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Mitra</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Jordan</surname> <given-names>MI</given-names></name>, <name name-style="western"><surname>Dunbrack</surname> <given-names>RL</given-names> <suffix>Jr</suffix></name>. <article-title>Neighbor-dependent Ramachandran probability distributions of amino acids developed from a hierarchical Dirichlet process model</article-title>. <source>PLoS Comput Biol</source>. <year>2010</year>;<volume>6</volume>(<issue>4</issue>):<fpage>e1000763</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1000763" xlink:type="simple">10.1371/journal.pcbi.1000763</ext-link></comment> <object-id pub-id-type="pmid">20442867</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006342.ref015">
<label>15</label>
<mixed-citation publication-type="other" xlink:type="simple">Salmon JK, Moraes MA, Dror RO, Shaw DE. Parallel random numbers: as easy as 1, 2, 3. In: 2011 International Conference for High Performance Computing, Networking, Storage and Analysis (SC). IEEE; 2011. p. 1–12.</mixed-citation>
</ref>
<ref id="pcbi.1006342.ref016">
<label>16</label>
<mixed-citation publication-type="other" xlink:type="simple">Kingma D, Ba J. Adam: A method for stochastic optimization. arXiv preprint arXiv:14126980. 2014;.</mixed-citation>
</ref>
<ref id="pcbi.1006342.ref017">
<label>17</label>
<mixed-citation publication-type="other" xlink:type="simple">Abadi M, Agarwal A, Barham P, Brevdo E, Chen Z, Citro C, et al. TensorFlow: Large-Scale Machine Learning on Heterogeneous Systems; 2015. Available from: <ext-link ext-link-type="uri" xlink:href="http://tensorflow.org/" xlink:type="simple">http://tensorflow.org/</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006342.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Shapovalov</surname> <given-names>MV</given-names></name>, <name name-style="western"><surname>Dunbrack</surname> <given-names>RL</given-names></name>. <article-title>A smoothed backbone-dependent rotamer library for proteins derived from adaptive kernel density estimates and regressions</article-title>. <source>Structure</source>. <year>2011</year>;<volume>19</volume>(<issue>6</issue>):<fpage>844</fpage>–<lpage>858</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.str.2011.03.019" xlink:type="simple">10.1016/j.str.2011.03.019</ext-link></comment> <object-id pub-id-type="pmid">21645855</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006342.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Born</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Oppenheimer</surname> <given-names>R</given-names></name>. <article-title>Zur quantentheorie der molekeln</article-title>. <source>Annalen der Physik</source>. <year>1927</year>;<volume>389</volume>(<issue>20</issue>):<fpage>457</fpage>–<lpage>484</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/andp.19273892002" xlink:type="simple">10.1002/andp.19273892002</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006342.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Desmet</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Maeyer</surname> <given-names>MD</given-names></name>, <name name-style="western"><surname>Hazes</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Lasters</surname> <given-names>I</given-names></name>. <article-title>The dead-end elimination theorem and its use in protein side-chain positioning</article-title>. <source>Nature</source>. <year>1992</year>;<volume>356</volume>(<issue>6369</issue>):<fpage>539</fpage>–<lpage>542</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/356539a0" xlink:type="simple">10.1038/356539a0</ext-link></comment> <object-id pub-id-type="pmid">21488406</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006342.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Xu</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Berger</surname> <given-names>B</given-names></name>. <article-title>Fast and accurate algorithms for protein side-chain packing</article-title>. <source>Journal of the ACM (JACM)</source>. <year>2006</year>;<volume>53</volume>(<issue>4</issue>):<fpage>533</fpage>–<lpage>557</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1145/1162349.1162350" xlink:type="simple">10.1145/1162349.1162350</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006342.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kamisetty</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Xing</surname> <given-names>EP</given-names></name>, <name name-style="western"><surname>Langmead</surname> <given-names>CJ</given-names></name>. <article-title>Free energy estimates of all-atom protein structures using generalized belief propagation</article-title>. <source>Journal of Computational Biology</source>. <year>2008</year>;<volume>15</volume>(<issue>7</issue>):<fpage>755</fpage>–<lpage>766</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1089/cmb.2007.0131" xlink:type="simple">10.1089/cmb.2007.0131</ext-link></comment> <object-id pub-id-type="pmid">18662103</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006342.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Koehl</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Delarue</surname> <given-names>M</given-names></name>. <article-title>Application of a self-consistent mean field theory to predict protein side-chains conformation and estimate their conformational entropy</article-title>. <source>Journal of molecular biology</source>. <year>1994</year>;<volume>239</volume>(<issue>2</issue>):<fpage>249</fpage>–<lpage>275</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1006/jmbi.1994.1366" xlink:type="simple">10.1006/jmbi.1994.1366</ext-link></comment> <object-id pub-id-type="pmid">8196057</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006342.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Feig</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Rotkiewicz</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Kolinski</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Skolnick</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Brooks</surname> <given-names>CL</given-names></name>. <article-title>Accurate reconstruction of all-atom protein representations from side-chain-based low-resolution models</article-title>. <source>Proteins: Structure, Function, and Bioinformatics</source>. <year>2000</year>;<volume>41</volume>(<issue>1</issue>):<fpage>86</fpage>–<lpage>97</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/1097-0134(20001001)41:1%3C86::AID-PROT110%3E3.0.CO;2-Y" xlink:type="simple">10.1002/1097-0134(20001001)41:1%3C86::AID-PROT110%3E3.0.CO;2-Y</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006342.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Peterson</surname> <given-names>LX</given-names></name>, <name name-style="western"><surname>Kang</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Kihara</surname> <given-names>D</given-names></name>. <article-title>Assessment of protein side-chain conformation prediction methods in different residue environments</article-title>. <source>Proteins: Structure, Function, and Bioinformatics</source>. <year>2014</year>;<volume>82</volume>(<issue>9</issue>):<fpage>1971</fpage>–<lpage>1984</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/prot.24552" xlink:type="simple">10.1002/prot.24552</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006342.ref026">
<label>26</label>
<mixed-citation publication-type="other" xlink:type="simple">Liwo A, Pillardy J, Czaplewski C, Lee J, Ripoll DR, Groth M, et al. UNRES: a united-residue force field for energy-based prediction of protein structure?orgin and significance of multibody terms. In: Proceedings of the fourth annual international conference on Computational molecular biology. ACM; 2000. p. 193–200.</mixed-citation>
</ref>
<ref id="pcbi.1006342.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sieradzan</surname> <given-names>AK</given-names></name>, <name name-style="western"><surname>Krupa</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Scheraga</surname> <given-names>HA</given-names></name>, <name name-style="western"><surname>Liwo</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Czaplewski</surname> <given-names>C</given-names></name>. <article-title>Physics-based potentials for the coupling between backbone-and side-chain-local conformational states in the united residue (UNRES) force field for protein simulations</article-title>. <source>Journal of chemical theory and computation</source>. <year>2015</year>;<volume>11</volume>(<issue>2</issue>):<fpage>817</fpage>–<lpage>831</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1021/ct500736a" xlink:type="simple">10.1021/ct500736a</ext-link></comment> <object-id pub-id-type="pmid">25691834</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006342.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dama</surname> <given-names>JF</given-names></name>, <name name-style="western"><surname>Sinitskiy</surname> <given-names>AV</given-names></name>, <name name-style="western"><surname>McCullagh</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Weare</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Roux</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Dinner</surname> <given-names>AR</given-names></name>, <etal>et al</etal>. <article-title>The theory of ultra-coarse-graining. 1. General principles</article-title>. <source>Journal of Chemical Theory and Computation</source>. <year>2013</year>;<volume>9</volume>(<issue>5</issue>):<fpage>2466</fpage>–<lpage>2480</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1021/ct4000444" xlink:type="simple">10.1021/ct4000444</ext-link></comment> <object-id pub-id-type="pmid">26583735</object-id></mixed-citation>
</ref>
</ref-list>
</back>
</article>