<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1005335</article-id>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-16-00562</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Gene expression</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Chemistry</subject><subj-group><subject>Chemical compounds</subject><subj-group><subject>Cluster compounds</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Data visualization</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Neural networks</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neural networks</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Signal transduction</subject><subj-group><subject>Cell signaling</subject><subj-group><subject>Signaling cascades</subject><subj-group><subject>MAPK signaling cascades</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Optimization</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Discrete mathematics</subject><subj-group><subject>Combinatorics</subject><subj-group><subject>Permutation</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Phenotypes</subject></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Representing high throughput expression profiles via perturbation barcodes reveals compound targets</article-title>
<alt-title alt-title-type="running-head">High throughput gene expression barcodes</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-9276-9279</contrib-id>
<name name-style="western">
<surname>Filzen</surname>
<given-names>Tracey M.</given-names>
</name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Kutchukian</surname>
<given-names>Peter S.</given-names>
</name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-7360-8322</contrib-id>
<name name-style="western">
<surname>Hermes</surname>
<given-names>Jeffrey D.</given-names>
</name>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Li</surname>
<given-names>Jing</given-names>
</name>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Tudor</surname>
<given-names>Matthew</given-names>
</name>
<xref ref-type="aff" rid="aff005"><sup>5</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001"><label>1</label> <addr-line>Medical Writing, Merck Research Laboratories, Upper Gwynedd, Pennsylvania, United States of America</addr-line></aff>
<aff id="aff002"><label>2</label> <addr-line>Informatics, Merck Research Laboratories, Boston, Massachusetts, United States of America</addr-line></aff>
<aff id="aff003"><label>3</label> <addr-line>Screening &amp; Protein Sciences, Merck Research Laboratories, North Wales, Pennsylvania, United States of America</addr-line></aff>
<aff id="aff004"><label>4</label> <addr-line>Screening and Compound Profiling, Merck Research Laboratories, Kenilworth, New Jersey, United States of America</addr-line></aff>
<aff id="aff005"><label>5</label> <addr-line>Informatics, Merck Research Laboratories, West Point, Pennsylvania, United States of America</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Gursoy</surname>
<given-names>Attila</given-names>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1"><addr-line>Koc Universitesi, TURKEY</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>At the time of submission, all of the authors were paid employees of Merck &amp; Co., Inc. (Kenilworth, NJ).</p>
</fn>
<fn fn-type="con">
<p><list list-type="simple"><list-item><p><bold>Conceptualization:</bold> MT.</p></list-item> <list-item><p><bold>Formal analysis:</bold> MT.</p></list-item> <list-item><p><bold>Investigation:</bold> TMF MT.</p></list-item> <list-item><p><bold>Methodology:</bold> MT PSK.</p></list-item> <list-item><p><bold>Software:</bold> MT PSK.</p></list-item> <list-item><p><bold>Supervision:</bold> JDH JL.</p></list-item> <list-item><p><bold>Validation:</bold> PSK.</p></list-item> <list-item><p><bold>Writing – original draft:</bold> MT PSK.</p></list-item> <list-item><p><bold>Writing – review &amp; editing:</bold> MT PSK TMF JL JDH.</p></list-item></list>
</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">matthew_tudor@merck.com</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<day>9</day>
<month>2</month>
<year>2017</year>
</pub-date>
<pub-date pub-type="collection">
<month>2</month>
<year>2017</year>
</pub-date>
<volume>13</volume>
<issue>2</issue>
<elocation-id>e1005335</elocation-id>
<history>
<date date-type="received">
<day>6</day>
<month>4</month>
<year>2016</year>
</date>
<date date-type="accepted">
<day>26</day>
<month>12</month>
<year>2016</year>
</date>
</history>
<permissions>
<copyright-year>2017</copyright-year>
<copyright-holder>Filzen et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1005335"/>
<abstract>
<p>High throughput mRNA expression profiling can be used to characterize the response of cell culture models to perturbations such as pharmacologic modulators and genetic perturbations. As profiling campaigns expand in scope, it is important to homogenize, summarize, and analyze the resulting data in a manner that captures significant biological signals in spite of various noise sources such as batch effects and stochastic variation. We used the L1000 platform for large-scale profiling of 978 representative genes across thousands of compound treatments. Here, a method is described that uses deep learning techniques to convert the expression changes of the landmark genes into a perturbation barcode that reveals important features of the underlying data, performing better than the raw data in revealing important biological insights. The barcode captures compound structure and target information, and predicts a compound’s high throughput screening promiscuity, to a higher degree than the original data measurements, indicating that the approach uncovers underlying factors of the expression data that are otherwise entangled or masked by noise. Furthermore, we demonstrate that visualizations derived from the perturbation barcode can be used to more sensitively assign functions to unknown compounds through a guilt-by-association approach, which we use to predict and experimentally validate the activity of compounds on the MAPK pathway. The demonstrated application of deep metric learning to large-scale chemical genetics projects highlights the utility of this and related approaches to the extraction of insights and testable hypotheses from big, sometimes noisy data.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>The effects of small molecules or biologics can be measured via their effect on cells’ gene expression profiles. Such experiments have been performed with small, focused sample sets for decades. Technological advances now permit this approach to be used on the scale of tens of thousands of samples per year. As datasets increase in size, their analysis becomes qualitatively more difficult due to experimental and biological noise and the fact that phenotypes are not distinct. We demonstrate that using tools developed for deep learning it is possible to generate ‘barcodes’ for expression experiments that can be used to simply, efficiently, and reproducibly represent the phenotypic effects of cell treatments as a string of 100 ones and zeroes. We find that this barcode does a better job of capturing the underlying biology than the original gene expression levels, and go on to show that it can be used to identify the targets of uncharacterized molecules.</p>
</abstract>
<funding-group>
<funding-statement>This work was funded by the authors' employer, Merck &amp; Co. The funder had no role in study design, data collection and analysis, or preparation of the manuscript. The decision to publish was reviewed via an internal peer and legal evaluation.</funding-statement>
</funding-group>
<counts>
<fig-count count="3"/>
<table-count count="2"/>
<page-count count="19"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>Profile data and annotations of proprietary compounds are not provided. Software and demonstration on publicly available data are provided at: <ext-link ext-link-type="uri" xlink:href="https://github.com/matudor/siamese" xlink:type="simple">https://github.com/matudor/siamese</ext-link></meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<disp-quote>
<p>This is a <italic>PLOS Computational Biology</italic> Methods Paper.</p>
</disp-quote>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Pharmacology is generally explored in a linear and iterative manner, starting from the observation of an activity, that is then optimized for selectivity and potency via various methods, and subsequently tested in preclinical and randomized controlled clinical studies for safety and efficacy. In general, the activity of compounds on targets other than the intended one(s) is limited, though such ‘off-target’ activities may lead to adverse events. The detection of polypharmacology is desired and could be facilitated by comprehensive profiling of drug candidates on a general phenotyping platform, i.e. a consistent method to broadly assess the phenotypic effects of compound treatment. Such a platform could be used in order to uncover unexpected phenotypic signals beyond the originally identified mechanism-based phenotype. The inference of mode of action or mode of toxicity from gene expression changes has been extensively studied in the past [<xref ref-type="bibr" rid="pcbi.1005335.ref001">1</xref>–<xref ref-type="bibr" rid="pcbi.1005335.ref003">3</xref>]. Different methods using only gene expression, or expression in the context of prior biological knowledge, have shown success in identifying the efficacy and toxicity targets of compounds [<xref ref-type="bibr" rid="pcbi.1005335.ref004">4</xref>, <xref ref-type="bibr" rid="pcbi.1005335.ref005">5</xref>].</p>
<p>Phenotypic screening is considered by some to be a return to pharmacology’s roots [<xref ref-type="bibr" rid="pcbi.1005335.ref006">6</xref>], and by others a new discipline, that will need to prove itself over the coming decades [<xref ref-type="bibr" rid="pcbi.1005335.ref007">7</xref>]. In either case, there is increased interest in applying cell-based pathway or phenotype screens to identify unknown/unexpected targets along with tool compounds that can be used for target validation, and potentially as starting points for drug discovery. One major hurdle in phenotypic screening approach <italic>versus</italic> a target-based approach lies in the identification of the target(s) of molecules that show an activity in cell-based (or organismal) assays [<xref ref-type="bibr" rid="pcbi.1005335.ref008">8</xref>]. A general phenotyping platform could be used to infer mode of action of unknown compounds based on induced expression profiles’ similarity to those of annotated compounds. Such data can also in some cases be used to propose new indications for known molecules [<xref ref-type="bibr" rid="pcbi.1005335.ref001">1</xref>].</p>
<p>Lastly, a general phenotyping platform will allow one to monitor compounds through their maturation and optimization in order to prioritize series based on selectivity and to quickly identify potential polypharmacology and safety warning signals [<xref ref-type="bibr" rid="pcbi.1005335.ref009">9</xref>].</p>
<p>We suggest that mRNA is a promising analyte for a general phenotyping platform, although the domain of applicability remains to be fully understood. Whereas gene expression changes are often distal to signaling and metabolic pathways that drug discovery aims to modulate, most perturbations of cellular pathways eventually lead to the nucleus [<xref ref-type="bibr" rid="pcbi.1005335.ref010">10</xref>], and to transcriptional changes that propagate, amplify, or compensate for the immediate effects of a perturbation [<xref ref-type="bibr" rid="pcbi.1005335.ref011">11</xref>]. mRNA also has the beneficial property that its measurement is fairly easy to generalize, such that any set of target sequences can be measured quantitatively and in parallel [<xref ref-type="bibr" rid="pcbi.1005335.ref012">12</xref>]. Thus, a potentially broadly useful general phenotyping platform would quantitate mRNA, be medium to high throughput, be affordable to apply to thousands of samples, and produce highly reproducible data.</p>
<p>The L1000 platform [<xref ref-type="bibr" rid="pcbi.1005335.ref013">13</xref>] has the potential to be just such a general phenotyping platform, one that can be used in various stages of drug discovery, including target identification and validation, hit-to-lead, lead optimization, as well as safety assessment and repurposing. 978 genes were selected to be representative of the expression of the remainder of the transcriptome [<xref ref-type="bibr" rid="pcbi.1005335.ref014">14</xref>], and the platform is used to capture the transcriptional phenotypes using this reduced set of ‘landmark’ genes. The high throughput and relatively low cost of the bead array based implementation permits comprehensive application to large numbers of perturbations, be they different compounds, different cellular contexts, titrations, compound series, etc.</p>
<p>However, if such a platform is applied for large sets of perturbations, spanning years of different project stages and various programs, then data analysis, and particularly homogenization, become important. Large scale expression profiling projects such as the Connectivity Map [<xref ref-type="bibr" rid="pcbi.1005335.ref001">1</xref>] and applications presented herein have to contend with day-to-day variation in cellular responses. Indeed, batch effects were previously considered a nuisance that was dealt with using robust rank-based statistics (connectivity score, [<xref ref-type="bibr" rid="pcbi.1005335.ref001">1</xref>]), and via use of biologically motivated data summaries such as Gene Set Enrichment Analysis [<xref ref-type="bibr" rid="pcbi.1005335.ref015">15</xref>, <xref ref-type="bibr" rid="pcbi.1005335.ref016">16</xref>]. It is not clear that such nonparametric approaches, which depend on prior knowledge (biological pathways or previous expression experiments), yield the highest possible sensitivity and specificity for downstream analyses.</p>
<p>Herein we present a novel method of representing the expression profiles of the L1000 platform as a short binary barcode. The approach starts by training a deep model that learns to distinguish replicate from nonreplicate profiles. The internal state of the model thus learned demonstrated properties previously ascribed to deep neural network models, namely a hierarchical representation that captures the regularities and underlying structure of the input data [<xref ref-type="bibr" rid="pcbi.1005335.ref017">17</xref>, <xref ref-type="bibr" rid="pcbi.1005335.ref018">18</xref>]. The internal state represents a robust, abstracted representation of the data, one that captures inherent aspects of the biology such as similarity of compound targets and pleiotropy. We go on to apply this framework to prospectively predict the targets of compounds based on the transformation of their induced expression profiles.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<sec id="sec003">
<title>Transforming gene expression profiles</title>
<p>We first introduce the data generation process and highlight the need for improved analyses. The disparity between replicate profiles motivates the development of a metric learning approach that improves upon the current state of the art for this type of data analysis.</p>
</sec>
<sec id="sec004">
<title>High throughput expression profiling</title>
<p>The experimental approach used in this work is depicted in <xref ref-type="fig" rid="pcbi.1005335.g001">Fig 1A</xref>. Cells can be treated, lysed, and measured in medium throughput (384-well) formats. The use of commodity consumables, reagents, and technology permits relatively low cost profiling of hundreds to thousands of compound-treated samples at a time [<xref ref-type="bibr" rid="pcbi.1005335.ref013">13</xref>]. Reader intensity measurements are normalized using control samples and genes. Next, each perturbation’s expression is compared to an internal (within-batch) negative control. Twelve to sixteen vehicle (DMSO) controls are measured on each 384-well assay plate, and the expression of the remainder of samples is standardized to the average (median), and scale of variation (median absolute deviation), of these vehicle controls to yield robust z-scores, henceforth referred to as z-scores for brevity.</p>
<fig id="pcbi.1005335.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005335.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Experimental setup and architecture of the deep model used.</title>
<p><bold>(A)</bold> Cells treated with compounds in 384-well plates. <bold>(B)</bold> Cell lysate used for ligation mediated PCR with gene-specific probe pairs, and the gene expression measured using an optically addressed bead array technology. <bold>(C)</bold> Raw intensity is normalized and converted to relative expression changes versus control (z-scores) on a plate-wise basis. Variability is observed between biological replicates.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005335.g001" xlink:type="simple"/>
</fig>
<p>Large scale gene expression profiling is known to have significant ‘batch’ effects that confound interpretation [<xref ref-type="bibr" rid="pcbi.1005335.ref019">19</xref>]. These effects are a result of differences in cell response from day to day. The effects can be controlled for by performing replicate experiments, but the level of replication required to eliminate the batch effects is not practical for high throughput experimentation, which requires knowledge to be extracted from 1–2 replicates. Additional approaches to reduce the influence of experimental batch include normalization of data within a batch such that all perturbations are compared to an internal negative control in the same batch. In spite of measures to control batch effects, it is nevertheless observed that there is variability in cell response that makes it difficult to interpret data obtained on different days [<xref ref-type="bibr" rid="pcbi.1005335.ref020">20</xref>]. As an example, for the dataset described below, we can assess the similarity of biological replicates’ gene expression profiles using Euclidean distance of the normalized expression changes <italic>versus</italic> control. Looking at the similarity of each sample profile to every other in the dataset, the median rank of a sample’s biological replicate is approximately the 3<sup>rd</sup> percentile. While this ranking can be considered an enrichment (versus a null hypothesis of ~50<sup>th</sup> percentile), the 3<sup>rd</sup> percentile in our dataset nevertheless implies that &gt;200 treatment profiles are more similar to a given treatment than a sample that was treated identically on a different day.</p>
<p>As mentioned above, the z-score data is confounded by batch effects that reduce the apparent similarity of expression responses deriving from identical treatments. In order to improve on the performance of the z-scores, another strategy that was explored is that of gene set enrichment analysis (GSEA, [<xref ref-type="bibr" rid="pcbi.1005335.ref016">16</xref>]). GSEA is a technique used to extract interpretable information from expression profiles, and is useful for placing the up- and down-regulation of genes into a biological context (e.g. biological pathway, disease state). In addition, GSEA profiles (i.e. enrichment scores of a sample across many different gene sets), can be thought of as a means of averaging, and potentially making more robust, the expression profiles by using biological context as a prior. Thus, it might be expected [<xref ref-type="bibr" rid="pcbi.1005335.ref021">21</xref>] that GSEA profiles might be more reproducible, and more predictive, than raw expression data. Indeed, when one looks at the correlation of pairs of samples treated with the same compound, one sees that GSEA profiles show higher concordance than z-score profiles day-to-day and cell-to-cell (Fig A in <xref ref-type="supplementary-material" rid="pcbi.1005335.s001">S1 Text</xref>). In the previously mentioned measure of average rank of replicates, GSEA yields a median rank of ~1%, with ~70 profiles more similar to a given sample than its biological replicate.</p>
</sec>
<sec id="sec005">
<title>Deep metric learning</title>
<p>Since there is room for improvement over both of the previously described methods, we sought to evaluate alternate strategies to increase the sensitivity and specificity of interpretations and predictions derived from relatively large data sets that we are currently generating on the L1000 platform. In particular, as a first step, we sought to increase the concordance of samples that should exhibit the same phenotypic response, while separating them from those that should be distinct. Using the similarity of biological replicates as a gold standard, the goal was to recast the data in a way that maximizes the similarity of replicates in contrast to non-replicate samples. This can be thought of as a metric learning problem, whereby one learns a new measure of distance or similarity between points, one that distinguished replicates from non-replicates. Initial experimentation with linear and kernel methods [<xref ref-type="bibr" rid="pcbi.1005335.ref022">22</xref>] failed to yield significant improvements over the raw data, thus deep neural network models were next evaluated.</p>
<p>Deep learning is an extension of decades-old artificial neural networks, and has recently shown impressive performance on a number of image and speech recognition tasks [<xref ref-type="bibr" rid="pcbi.1005335.ref023">23</xref>, <xref ref-type="bibr" rid="pcbi.1005335.ref024">24</xref>]. As the properties and capabilities of these models have begun to be elucidated, it is becoming more feasible and reproducible to create highly accurate multilayer neural network models. In addition, advances in model design have been complemented by increased computational power and larger datasets that enable the training of comprehensive, expressive models, whose generalization performance is facilitated by regularization [<xref ref-type="bibr" rid="pcbi.1005335.ref017">17</xref>, <xref ref-type="bibr" rid="pcbi.1005335.ref018">18</xref>]. In addition to providing a flexible model that is able to fit complicated datasets, deep networks have the additional advantage of learning a hierarchical representation of the data, whereby lower layers of the model learn to represent the fine-grained detail of the input data, and higher layers represent increasing layers of abstraction. Thus, inspecting the higher layers of a model has the potential of revealing the underlying high-level structure of the data, with reduced sensitivity to noise and contextual details. We thus explored a multilayered network with the dual goal of developing a suitable distance metric, and also developing a robust data representation for downstream analyses.</p>
<p>Most machine learning methods consider a single input sample at a time, though each sample is generally represented by multiple variables, or features. The goal of this effort was to learn not about individual samples, but about the comparison of pairs of inputs in order to learn a new metric that better captures what is known about the data. Thus, a method was chosen that permits comparative learning in a neural network framework. We implemented a version of a siamese neural network [<xref ref-type="bibr" rid="pcbi.1005335.ref025">25</xref>, <xref ref-type="bibr" rid="pcbi.1005335.ref026">26</xref>] to perform metric learning on a dataset of L1000 data (<xref ref-type="fig" rid="pcbi.1005335.g002">Fig 2</xref>).</p>
<fig id="pcbi.1005335.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005335.g002</object-id>
<label>Fig 2</label>
<caption>
<title/>
<p><bold>(A)</bold> Metric learning network: a pair of 978-element z-score vectors is input to the network as adjacent vectors. Data is transformed through two layers (400 followed by 100 units), of nonlinearities (noisy sigmoid activation functions). The activations of the second hidden layer (H2(x<sub>1</sub>) and H2(x<sub>2</sub>)) are combined in the output layer by calculating a Euclidean distance between the two representations. The margin cost is calculated based on the -1/1 (non-replicate/replicate indicator) target and the squared distance. <bold>(B)</bold> Once the model is trained, expression profiles are converted to barcodes by passing them through the first two (now noisless sigmoid) hidden layers and thresholding the activation of the second hidden layer to yield perturbation barcodes.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005335.g002" xlink:type="simple"/>
</fig>
<p>A number of model architecture properties (also known as hyperparameters) need to be set prior to the optimization of model weights of a neural network by gradient descent. These include number of layers, layer sizes, activations of layers, regularization types and weights, and cost type and any parameters. We undertook a greedy manual search of hyperparemters, optimizing the validation set accuracy for predicting replicate vs. nonreplicate pairs. Significantly, other characteristics of the model and its representation, such as those described below and in <xref ref-type="table" rid="pcbi.1005335.t001">Table 1</xref> (rows 2–5), were not measured during the model selection process, and only replicate identification accuracy was used to select a final model. Among over 60 models tested, we settled on the architecture described below since it provided the best classification accuracy of replicates/nonreplicates on validation data.</p>
<table-wrap id="pcbi.1005335.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005335.t001</object-id>
<label>Table 1</label> <caption><title>Performance of learned perturbation barcodes compared to z-scores and GSEA scores.</title></caption>
<alternatives>
<graphic id="pcbi.1005335.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005335.t001" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left">metric</th>
<th align="right">z-score</th>
<th align="right">GSEA</th>
<th align="right">perturbation barcode</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><bold>Median rank of replicates (of 7573)</bold></td>
<td align="right">225</td>
<td align="right">72</td>
<td align="right"><bold>24</bold></td>
</tr>
<tr>
<td align="left"><bold>Distance by shared target, t statistic</bold></td>
<td align="right">-1</td>
<td align="right">-38</td>
<td align="right"><bold>-43</bold></td>
</tr>
<tr>
<td align="left"><bold>Structural clustering overlap with expression clustering</bold></td>
<td align="right">0.01</td>
<td align="right">0.03</td>
<td align="right"><bold>0.17</bold></td>
</tr>
<tr>
<td align="left"><bold>Correlation of HTS profiles with expression</bold></td>
<td align="right">0.04</td>
<td align="right">0.02</td>
<td align="right"><bold>0.12</bold></td>
</tr>
<tr>
<td align="left"><bold>Promiscuity prediction by SVR, R<sup>2</sup></bold></td>
<td align="right">0.21</td>
<td align="right">0.16</td>
<td align="right"><bold>0.34</bold></td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t001fn001"><p><bold>(Row 1)</bold> For each sample with replicates in the dataset, profiles are ranked based on Euclidean distances calculated from the various representations, and the median value of the replicates’ ranks across samples is reported. <bold>(Row 2)</bold> Distance of pairs of profiles of compounds that share a target annotation compared to those that do not. Significance of difference in mean distance measured with a t statistic. For reference, a permutation analysis of the target labels in the barcode dataset yielded a minimum t statistic of -5.8 from 100 random permutations (p&lt;0.01). <bold>(Row 3)</bold> Compounds clustered based on structure and on the expression profiles they induce. The overlap of the structural and expression clustering is measured by the Adjusted Rand Index on a 0–1 scale. For reference, a permutation analysis of the cluster labels in the barcode dataset yielded a maximum ARI of 0.002 from 100 random permutations (p&lt;0.01). <bold>(Row 4)</bold> Similarity of phenotypic profiles measured either by activity across HTS assays, or by induced expression changes. The correlation of each expression measure to the HTS fingerprint data is shown. For reference, a permutation analysis of the sample labels in the barcode dataset yielded a maximum correlation of 0.001 from 100 random permutations (p&lt;0.01). <bold>(Row 5)</bold> A support vector regression model was trained using the various expression features to predict compound promiscuity (fraction HTS screens in which a compound is active). Crossvalidation performance is measured using R<sup>2</sup> of predicted <italic>vs</italic>. observed promiscuity. The standard error of barcode R<sup>2</sup> values was 0.06 (p&lt;0.01).</p></fn>
</table-wrap-foot>
</table-wrap>
<p>The final model that emerged from optimization of the neural network architecture performs the following: a pair of 978-dimensional z-score vectors representing two different expression profiles is given to the network as input, the data is transformed by two layers of noisy sigmoid layers, and then the representations of the members of the pair are compared to each other by calculating a Euclidean distance. A margin loss is calculated based on the distance <italic>versus</italic> the known target status of the pair (i.e. replicates or not replicates). The cost is used to train the network via backpropagation of the cost gradients [<xref ref-type="bibr" rid="pcbi.1005335.ref027">27</xref>]. While siamese networks have been previously depicted as a linked pair of networks transforming the pair of inputs for comparison (see [<xref ref-type="bibr" rid="pcbi.1005335.ref025">25</xref>, <xref ref-type="bibr" rid="pcbi.1005335.ref026">26</xref>]), in practice we found it simpler to implement the siamese network model as a single network that processes pairs of samples as adjacent inputs (<xref ref-type="fig" rid="pcbi.1005335.g002">Fig 2</xref>). In this architecture, the paired input is provided as two consecutive vectors to one network that processes the elements of the pair through the aforementioned hidden layers and then calculates the cost.</p>
<p>The network was trained on 80% of the compounds, using a validation held-out set of 10% to select model architecture and detailed configuration (hyperparameters), and a final test set of 10% was used to estimate generalization performance of the selected model. The trained model was able to correctly categorize 97% of test pairs as replicates/non-replicates (F<sub>1</sub> = 0.87, [<xref ref-type="bibr" rid="pcbi.1005335.ref028">28</xref>]). As a baseline, a model that randomly samples from the empirical distribution of replicates/non-replicates has an accuracy of 56% (F<sub>1</sub> = 0.33). A nontrivial reference for comparison would be a model that thresholds the gene expression changes for each sample to generate a binary 978-dimensional representation. Depending on whether the threshold is shared among all genes or is gene specific, and on whether the threshold is applied to raw expression changes or absolute changes, a variety of models can be created. The best performance in terms of accuracy on the validation data was observed for a model that uses gene-specific thresholding on the original scale, with thresholds learned from the training data set, this model gave a test set accuracy of 67% (F<sub>1</sub> = 0.66). Another nontrivial model one could apply would use random projections of the data as is done in locality sensitive hashing [<xref ref-type="bibr" rid="pcbi.1005335.ref029">29</xref>]. Such a model, using 100 random projections, showed an accuracy of 33% (F<sub>1</sub> = 0.50). Optimizing the projections to maximize training set discrimination yields a linear model. A 100-dimensional linear model yielded an accuracy of 71% (F<sub>1</sub> = 0.47). These results show that the learned deep model is superior in classification accuracy to trivial and nontrivial comparator models.</p>
<p>Having demonstrated that it is possible to recast the data in a way that captures the similarity of identically treated samples, we set out to determine if the learned model can be used to improve interpretability of large scale expression profiling campaigns. Since the model can separate replicates from nonreplicates, and since the model output is a function of a simple Euclidean distance calculated on the internal representation (hidden layer activations), we reasoned that this internal representation captures the discriminatory power learned by the model. We explored whether this internal representation has additional useful properties, as for example do the internal word representations of skip-gram language models [<xref ref-type="bibr" rid="pcbi.1005335.ref030">30</xref>] to represent semantic and syntactic relationships. The internal representation was extracted from the learned model by using the activation of 100-dimensional second hidden layer as the learned feature vector of each data point (<xref ref-type="fig" rid="pcbi.1005335.g002">Fig 2B</xref>). This representation is a short, fixed-length, almost binary representation that captures expression profile changes. In order to facilitate computation of similarities and hash-based lookup, the almost-binary representation (~95% of activations &gt;0.9 or &lt; 0.1), was thresholded to be exactly binary (i.e. values ≥ 0.5 were set to 1, rest to 0). This binary representation of cellular gene expression profile changes in response to treatments is referred to as a ‘perturbation barcode.’</p>
<p>Thus the model yields a new encoding of the original data, a representation that was designed only to increase the similarity of biological replicates relative to non-replicates. Information is necessarily lost in reducing 978-dimensional continuous data to 100-dimensional binary representations. The question that remains is whether biologically interesting aspects of the data are retained in the simplified encoding.</p>
<p>Thus, we evaluated whether the model described herein learns useful, generalizable aspects related to compound effects on cells as a byproduct of learning to identify replicates. The perturbation barcodes were assessed for their ability to identify similarities between compounds in a variety of contexts (<xref ref-type="table" rid="pcbi.1005335.t001">Table 1</xref>). Furthermore, we directly compared the performance of the barcodes to the minimally processed z-score data and the gene set enrichment score profiles.</p>
<p>The median rank (out of 7573) of each sample’s biological replicate is shown in <xref ref-type="table" rid="pcbi.1005335.t001">Table 1</xref>. For each sample, the similarity of all other samples’ profiles is ranked, and the median rank across samples of the biological replicate is reported. For the z-score data this value is 225, indicating that, on average, there are 223 profiles more similar to a given sample (itself ranked #1), than the sample’s biological replicate. The median rank for GSEA score data is 72, and for perturbation barcodes it is 24. The result on the perturbation barcodes demonstrates that the training objective was met: samples that are replicates are more similar under the features derived from the metric learning than they are in the original data space.</p>
<sec id="sec006">
<title>1. Comparison of perturbation barcode with state of the art</title>
<p>Next, one might ask whether a model trained to recognize samples treated with the same compound would also retain additional relationships related to biological function and chemical similarity. In order to avoid re-discovering the similarity of replicates, for this and subsequent comparisons, replicates were resolved to a single representation by averaging the hidden layer activations of the replicate samples before thresholding to barcodes, and analogously, z-scores and GSEA results represent the average of replicates.</p>
<p>We tested the ability of the different representations to recognize different compounds targeting the same cellular factor as having similar profiles. Due to compound-specific polypharmacologies, one shouldn’t expect any pair of distinct compounds to have identical profiles, but one should expect compounds sharing a target to have profiles that are more similar, on average, than pairs of compounds not sharing a molecular target. We looked at those compounds for which target annotation was available (1297 compounds having annotated targets modulated with potency &lt; 1μM), and asked if compounds that share a target are more similar to each other in induced gene expression profiles than compounds that do not. Using a t statistic for the difference of mean distances of shared <italic>versus</italic> unshared targets, the comparison on the z-score data is not significant, with a t statistic of -1. The GSEA-summarized data is more significant with t~-38, while the barcode data shows the highest preferential similarity of profiles of compounds sharing a target annotation: t~-43. This indicates that the latter two methods are able to encode the expression profiles of compounds in a way that emphasizes biological similarity.</p>
<p>A well-studied approach to categorize compounds is by similarity of chemical structure, with one underlying assumption being that similarity of structure is related to similarity in function. Thus molecules are clustered using descriptors designed to allow molecules considered similar by a chemist to be grouped together, to the exclusion of dissimilar molecules [<xref ref-type="bibr" rid="pcbi.1005335.ref031">31</xref>]. Analogously, expression profiles can be clustered to find sets of genes or of samples that are more similar to each other than to other instances, in an attempt to identify cohesive functional groupings [<xref ref-type="bibr" rid="pcbi.1005335.ref032">32</xref>]. One might expect a significant but imperfect overlap between compound structural clusters and those derived from expression profiling. The expectation of significant overlap comes from the fact that compounds with shared scaffolds or similarly arranged functional groups would be more likely to target the same cellular factors and thus yield similar expression profiles. Imperfect overlap would be expected because small changes in structure can lead to significant changes in activity, a phenomenon studied in structure-activity relationships of chemical series [<xref ref-type="bibr" rid="pcbi.1005335.ref033">33</xref>]. In order to compare overlap of structure and phenotype, a comparison of the clusterings of the two types of data was performed. Compound structures were clustered using hierarchical clustering of fragment-based descriptors with a minimum similarity criterion to define clusters. Expression data was clustered using hierarchical clustering followed by a dynamic tree cutting [<xref ref-type="bibr" rid="pcbi.1005335.ref034">34</xref>] approach to generate discrete, well separated-clusters. The overlap of clusterings is measured with the Adjusted Rand Index [<xref ref-type="bibr" rid="pcbi.1005335.ref035">35</xref>] which varies from 1.0 for perfect overlap, to 0 for overlap expected by chance. The z-score data shows little overlap of expression clustering with the structural clusters (1%, <xref ref-type="table" rid="pcbi.1005335.t001">Table 1</xref>), and the GSEA-based clusters modesty better (3%). In contrast, the perturbation barcode clusters have significantly higher overlap with structural clusters than z-scores (17%). These results are not sensitive to the clustering algorithm nor to compound structural descriptors, as similar observations were obtained with affinity propagation clustering and atom pair descriptors [<xref ref-type="bibr" rid="pcbi.1005335.ref036">36</xref>].</p>
<p>Next we set out to determine whether the barcode reveals insight into biological function. In order to compare two different measures of biological activity, the profile of 3471 compounds across multiple High Throughput Screens (HTS) was compared to the L1000 expression profiles. The activity profiles across HTS assays could be thought of a biological fingerprint, as it represents the activity of the compound in a multitude of disparate assays, both cell-based and biochemical. Such profiles do not evenly span all potential biological responses since they opportunistically derived, depending on the history of each compound and the organization performing the HTS campaigns. However, in some ways the HTS profiles are more relevant to drug discovery since many of the constituent assays directly measure the molecular activities of interest rather than induced transcriptional programs. The correlation matrix of HTS fingerprints (HTS-FP, [<xref ref-type="bibr" rid="pcbi.1005335.ref037">37</xref>]) of the compounds was compared to the correlation matrices of z-scores, GSEA scores, and perturbation barcodes. The correlation of the triangular correlation matrices (Mantel statistic) was used as a measure of how similar the HTS activity profiles are to z-score, GSEA, and perturbation barcodes. The perturbation barcodes show more than three times the similarity to HTS profiles compared the other two scores (<xref ref-type="table" rid="pcbi.1005335.t001">Table 1</xref>).</p>
<p>Finally, it was of interest to explore if there is a difference in the ability of the three data representations to predict a high-level property of compounds, namely their promiscuity. The promiscuity of a compound is defined here as the fraction of the HTS assays in which the compound was scored as active, ranging from 0 to 0.5 in our dataset (median 0.04, 3836 compounds with data). Promiscuity of compounds is of interest in drug discovery, wherein modulators that are both potent and specific (i.e. non-promiscuous) are generally sought. One way to ascertain if promiscuity information is present in the different expression profile representations is to assess the ability of each representation to generate a model that can quantitatively predict this property for samples not in the training set. Predictive support vector regression models were trained on each data representation, and the average cross-validation coefficient of determination (R<sup>2</sup>) was used as measure of the ability of the models to predict properties of compounds on the basis of the profiling data (<xref ref-type="table" rid="pcbi.1005335.t001">Table 1</xref>). Given that the perturbation barcodes are derived solely from the z-score data, and that they are in some ways a more impoverished representation of the original data (978 dimensional real values to 100-dimensional binary values), it was surprising to find that models trained on the barcodes are able to explain ~60% more promiscuity compared to the z-scores.</p>
<p>To test whether the feature mapping can be applied to other datasets, we trained an identical model architecture on a sample of L1000 data generated by the LINCS consortium [<xref ref-type="bibr" rid="pcbi.1005335.ref014">14</xref>]. For the comparisons we could make, we found the same benefits of the perturbation barcode versus the raw data. <xref ref-type="table" rid="pcbi.1005335.t002">Table 2</xref> shows that the learned barcode brought biological replicates closer to each other (median in top 1% most similar profiles <italic>versus</italic> top 27% for z scores). Furthermore, average profiles of distinct compounds sharing a target are significantly closer to each other in the perturbation barcode space than in the original space: for each annotated target of compounds in the dataset, the distances of compounds sharing <italic>versus</italic> not sharing the target were compared via a t-statistic, and the mean of these statistics was found to be non-significantly higher (+1) for the z-score data but significantly smaller (-37) for the barcodes (<xref ref-type="table" rid="pcbi.1005335.t002">Table 2</xref>). Finally, although this dataset contained a relatively small number of structurally distinct compounds, we could still detect a greater than 2-fold increase in correspondence between clustering of transcriptional profiles and structural descriptors in the perturbation barcodes versus the z-scores (<xref ref-type="table" rid="pcbi.1005335.t002">Table 2</xref>).</p>
<table-wrap id="pcbi.1005335.t002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005335.t002</object-id>
<label>Table 2</label> <caption><title>Performance of perturbation barcodes on public LINCS data.</title> <p>Analyses correspond to Rows 1–3 of <xref ref-type="table" rid="pcbi.1005335.t001">Table 1</xref>.</p></caption>
<alternatives>
<graphic id="pcbi.1005335.t002g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005335.t002" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left">metric</th>
<th align="left">z-score</th>
<th align="left">perturbation barcode</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><bold>Median rank of replicates (of 79890)</bold></td>
<td align="left">21496</td>
<td align="left"><bold>649</bold></td>
</tr>
<tr>
<td align="left"><bold>Distance by shared target, mean t statistic</bold></td>
<td align="left">1</td>
<td align="left"><bold>-37</bold></td>
</tr>
<tr>
<td align="left"><bold>Structural clustering overlap with expression clustering</bold></td>
<td align="left">0.004</td>
<td align="left"><bold>0.010</bold></td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
</sec>
<sec id="sec007">
<title>2. Prospective activity prediction</title>
<p>In order to compare the ability of the learned features to capture the biological activity of tested perturbations in an exploratory setting, the predictive ability of the perturbation barcodes was tested. We compared the ability of the perturbation barcodes and z-scores to retrieve molecules with similar targets in both a two-dimensional visualization, and by nearest neighbor searches in the respective native data spaces. t-SNE [<xref ref-type="bibr" rid="pcbi.1005335.ref038">38</xref>] is a dimensionality reduction technique used for visualization in large datasets. The transformation provided by t-SNE is not quantitative and does not preserve all aspects of the original data space, but in a 100-1000-dimensional data space, t-SNE is the best system we have found for exploring such data sets. Large-scale themes as well as local clustering of biological mechanisms can be seen in the t-SNE map. For example, compounds derived from different profiling projects occupy different domains of the map, and compounds targeting some protein families are seen to cluster on the map (Fig B in <xref ref-type="supplementary-material" rid="pcbi.1005335.s001">S1 Text</xref>). It is important to note that while some protein families are tightly clustered (e.g., histone deacetylases), there are a number of areas in the t-SNE map where multiple families overlap. This suggests that while in some cases target families may offer distinct profiles, in other cases a number of different mechansims may share induced expression profiles.</p>
<p>The predictive fidelity of the t-SNE map derived from expression z-scores was compared to that of a t-SNE map derived from the perturbation barcodes in order to ascertain how much information one can hope to glean by studying the visualization of a large dataset (<xref ref-type="fig" rid="pcbi.1005335.g003">Fig 3A–3C</xref>). This use case was studied because it is representative of a common query one may want to pose of a dataset: given knowledge about the molecular mechanism of action of some compounds, can we expect compounds nearby to them in a visualization to share similar mechanisms? Three known inhibitors of the EGF/MAPK pathway that were tightly clustered in both maps were chosen as seeds, and 31 unknown compounds found nearby the known MAPK pathway actives in either or both t-SNE maps were tested for their ability to block signaling from EGF to AP1 using a reporter gene assay. The compounds selected in this way were structurally diverse, with only two of the compounds sharing the same structural cluster. <xref ref-type="fig" rid="pcbi.1005335.g003">Fig 3E</xref> shows that there were two unknown compounds that were identified in the z-score t-SNE maps and were confirmed to be active in MAPK signaling. By comparison, the barcode map revealed the same two and also four additional novel unknowns (<xref ref-type="fig" rid="pcbi.1005335.g003">Fig 3F</xref>). Negative control compounds selected to be far away from the MAPK tools in both maps showed no specific AP-1 reporter activity (Fig C in <xref ref-type="supplementary-material" rid="pcbi.1005335.s001">S1 Text</xref>). One compound that was a known pathway inhibitor did not confirm in this assay as it showed high potency (IC<sub>50</sub>~35nM), but low efficacy (E<sub>max</sub>~41%), thus not meeting the activity threshold. The additional actives discovered only in the barcode map demonstrate that the visualization derived from the barcodes has increased sensitivity to capture biological activities <italic>versus</italic> the raw data-derived visualization. Significantly, none of the newly identified AP-1 reporter inhibitors were structurally similar to the known actives (Dice similarity less than 0.6).</p>
<fig id="pcbi.1005335.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005335.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Visualizations of the data based on z-scores or perturbation barcodes were examined to select candidate compounds in the phenotypic neighborhood of a series of known MAPK pathway inhibitors.</title>
<p><bold>(A–D)</bold> t-SNE maps of the data, z-scores on top, perturbation barcode maps on the bottom. <bold>(A, B)</bold> the entire dataset is shown with the tested compounds in dark blue. <bold>(C,D)</bold> The neighborhood of the query MAPK pathway inhibitor compounds (orange) is shown. Common MAPK tools used for nearest neighbor analysis are circled. <bold>(E,F)</bold> Results of AP-1 reporter assays. Known MAPK actives are distinguished from unknowns predicted to be active in (C,D). <bold>(G,H)</bold> Rather than selecting neighbors of seed MAPK tool compounds in the t-SNE map, nearest neighbors in the native datasets were selected and tested in the AP-1 reporter assay. Key as in (E,F). See Fig C in <xref ref-type="supplementary-material" rid="pcbi.1005335.s001">S1 Text</xref> for breakdown by categories, including overlaps.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005335.g003" xlink:type="simple"/>
</fig>
<p>Finally, we looked at the neighborhood of the same known MAPK actives in the original data space for both the z-scores (978-dimensional) and the barcodes (100-dimensional) rather than the reduced 2-dimensional t-SNE space. Nearest neighbors were chosen by Euclidean distance and tested in the reporter assay as above. <xref ref-type="fig" rid="pcbi.1005335.g003">Fig 3G &amp; 3H</xref> show that a larger number and fraction of unknowns identified as candidates from the barcode data were confirmed to have AP-1 reporter activity compared to the z-scores.</p>
</sec>
</sec>
</sec>
<sec id="sec008" sec-type="conclusions">
<title>Discussion</title>
<p>We present here a straightforward way to extract features from gene expression data that are in many ways more expressive and robust than the original gene expression changes. While training of a deep network is a somewhat specialized process, once an adequate model is trained, additional samples can efficiently be converted to perturbation barcodes with no (or little), further optimization needed, as evidenced by the simple transfer of the model to external (LINCS) data.</p>
<p>Others have proposed novel methods for analyzing L1000 data. In particular, Liu et al [<xref ref-type="bibr" rid="pcbi.1005335.ref039">39</xref>] presented a pipeline that incorporates raw intensity processing and gene assignment through gene set enrichment and production of features informed by protein interaction data. While this type of biological annotation is potentially useful, our proposed perturbation barcode is self-contained, and does not rely on noisy and incomplete biological databases for utility. In addition, the improvements in performance of the learned features compares favorably with other approaches used in the field, including GSEA. Finally, it was shown that the perturbation barcodes can be used to meaningfully predict pathway modulation activity of compounds prospectively. This ability is of value in uncovering unknown modes of action (either primary or secondary) of compounds of interest, and the fact that it can be read directly from a visualization, shows the potential of the approach to simplify and enhance hypothesis generation from big data.</p>
<p>We demonstrate that similarity in the barcode space is indicative of more similarity in compound target and compound structure, activity across biological assays, and predictivity of biological action. It should be pointed out that even with the improved data representation, the level of concordance between the gene expression data and reference data (compound structural features, target annotation), remains imperfect. There are a number of potential explanations for this. Firstly, the gene expression experiments were conducted in one or two cell lines per compound, and for some compounds the (known or unkown) efficacy targets are not expressed, thus limiting the potential correlation to target annotation. Additionally, many compounds were unoptimized screening hits or lightly characterized tools, and thus likely have significant polypharmacology, only some of which is known, and only some of which is consistent within chemotypes due to ‘activity cliffs.’ Next, target annotation is incomplete, so an apparent false positive association between a compound and an activity may in fact be a genuine connection that has not yet been discovered. Lastly, there is little doubt that obtaining higher data density (more doses, replicates, time points, cell lines, structural neighbors), would complement the sparse dataset explored herein, and in doing so, possibly tie more compounds to benchmark annotations than was possible with the current data.</p>
<p>We made the somewhat unexpected observation that models of general compound properties like promiscuity can be better built using the learned features than the data that the features were learned from, indicating that there are positive side effects of the compressive data encoding. We attribute this phenomenon to the denoising property of the learned features, or equivalently, extraction of robust underlying biological factors from the corrupted versions observed in experimentation (due to measurement error, batch effects, and stochastic variation in response).</p>
<p>We anticipate that elaborations of approaches such as this one will be fruitful for other applications in biological and chemical domains, as they have been in artificial intelligence. A more ambitious goal of algorithmic design of molecules may be based on the combination of phenotypic information, quantitative structure-activity relationships, and pharmacokinetic/pharmacodynamic models with generative models for chemical structures. In the meantime, the direct application of the described metric learning-based representation technique to other high volume, high dimensional data has the potential to significantly reduce the effects of noise and to improve interpretability and the quality of generated hypotheses.</p>
</sec>
<sec id="sec009" sec-type="materials|methods">
<title>Methods</title>
<sec id="sec010">
<title>L1000 data generation</title>
<p>Doses for treatment were chosen using the following hierarchy of approaches: for compounds with known biological activity and toxicity, the dose with the highest therapeutic window was selected. For compounds with only biological activity, the EC<sub>80</sub> was used. For compounds without relevant cell-based assay activity, the highest non-toxic dose was used, up to 20μM. Two cell lines were used: PC3 and ME180. A number of compounds were profiled in both cell lines, the rest were profiled in just one of the two. Most compounds were profiled as biological replicates by performing identical treatments and lysis on separate days, some compounds were only represented by a single instance. Compound treatment time was 6 hours, after which cells were lysed, frozen, and shipped to Genometry for processing. A total of 3699 compounds were screened. Compounds were selected based on being tool bioactive compounds, active compounds for ongoing phenotypic screening programs, and compounds of interest for particular compound optimization programs. Compound profiling was performed in four independent campaigns over the course of 14 months.</p>
</sec>
<sec id="sec011">
<title>Data processing</title>
<p>Initial data processing was conducted by Genometry using a standard pipeline. Briefly, Luminex intensity measurements were assessed for consistency of relative expression of control genes. Samples passing well and plate level thresholds were summarized by conversion of intensity data to calculated log<sub>2</sub> Genechip-equivalent intensities and normalized based on control gene intensities. Finally, the data on each plate was standardized based on the median and median absolute deviation of the vehicle control samples to calculate z-scores for each gene. These z-scores were the input for the deep metric learning, and were also analyzed directly as a baseline for data interpretation.</p>
</sec>
<sec id="sec012">
<title>Deep metric learning</title>
<p>A metric learning cost module that takes consecutive pairs of training examples and calculates a distance between them, and thereby a cost, was implemented using the Pylearn2 framework [<xref ref-type="bibr" rid="pcbi.1005335.ref040">40</xref>]. Internal data representing L1000 data as z-scores of 7573 profiles of 3699 compounds was used. Train/validation/test datasets were made from the initial data by selecting respectively 80, 10, and 10% of the initial 3.7k compounds. Within a dataset, a sample of pairs of profiles representing biological replicates was used for positive examples (n = 40k), and in addition a sample of twice the number of pairs of samples that were not biological replicates was used as negative examples. Hyperparameters (number and type of layers, regularization, dropout), were tuned manually based on replicate/non-replicate prediction accuracy of the model on the validation dataset, and the model depicted in <xref ref-type="fig" rid="pcbi.1005335.g002">Fig 2</xref> emerged as the best performing. In order to build a model that facilitates application to large scale profiling datasets, it was of interest to bias the model to produce a representation that could be used akin to locality sensitive hashing [<xref ref-type="bibr" rid="pcbi.1005335.ref041">41</xref>], or semantic hashing [<xref ref-type="bibr" rid="pcbi.1005335.ref042">42</xref>], whereby large collections of profiles can be queried for similar expression profiles without performing global similarity calculations (which become prohibitive as datasets increase in size). Hashing of L1000 data is the subject of ongoing work, and is not explored further here. Nevertheless, it was found a model designed to facilitate hash-based lookup (i.e. having saturated, nearly binary internal representations), gave a higher validation set accuracy than other models tested, so this is the model that was used for downstream analyses.</p>
<p>The model uses an input layer of 978 z-scores, followed by two hidden layers of 400 and 100 units, using a noisy sigmoid nonlinearity:
<disp-formula id="pcbi.1005335.e001">
<alternatives>
<graphic id="pcbi.1005335.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005335.e001" xlink:type="simple"/>
<mml:math display="block" id="M1">
<mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn mathvariant="bold">0</mml:mn><mml:mo>,</mml:mo><mml:mn>0.25</mml:mn><mml:mi mathvariant="bold-italic">I</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(1)</label>
</disp-formula>
<disp-formula id="pcbi.1005335.e002">
<alternatives>
<graphic id="pcbi.1005335.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005335.e002" xlink:type="simple"/>
<mml:math display="block" id="M2">
<mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn mathvariant="bold">1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn mathvariant="bold">1</mml:mn></mml:mrow></mml:msup></mml:mrow>
</mml:math>
</alternatives>
<label>(2)</label>
</disp-formula></p>
<p>Independent Gaussian noise with mean 0 and variance 0.25 <inline-formula id="pcbi.1005335.e003"><alternatives><graphic id="pcbi.1005335.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005335.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn mathvariant="bold">0</mml:mn><mml:mo>,</mml:mo><mml:mn>0.25</mml:mn><mml:mi mathvariant="bold-italic">I</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, is added to the weighted sum of inputs plus bias (<bold><italic>Wx</italic></bold> + <bold><italic>b</italic></bold>) before applying sigmoid nonlinearity σ. Noise was added to favor saturated (0/1) activations. Dropout [<xref ref-type="bibr" rid="pcbi.1005335.ref043">43</xref>] (<italic>p</italic> = 0.5) and L1 weight decay (λ = 10<sup>−5</sup>–10<sup>−6</sup>) are also used in hidden layers for regularization. Finally, the cost layer uses a rectified loss function with a squared distance margin of 5:
<disp-formula id="pcbi.1005335.e004">
<alternatives>
<graphic id="pcbi.1005335.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005335.e004" xlink:type="simple"/>
<mml:math display="block" id="M4">
<mml:mrow><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mi>s</mml:mi><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mi>t</mml:mi><mml:mi>p</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>y</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(3)</label>
</disp-formula>
<disp-formula id="pcbi.1005335.e005">
<alternatives>
<graphic id="pcbi.1005335.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005335.e005" xlink:type="simple"/>
<mml:math display="block" id="M5">
<mml:mrow><mml:mi>s</mml:mi><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mi>t</mml:mi><mml:mi>p</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>l</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mi>x</mml:mi></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(4)</label>
</disp-formula>
<disp-formula id="pcbi.1005335.e006">
<alternatives>
<graphic id="pcbi.1005335.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005335.e006" xlink:type="simple"/>
<mml:math display="block" id="M6">
<mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mtext> if pair are replicates</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo> </mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mtext> if pair are non-replicates</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow>
</mml:math>
</alternatives>
<label>(5)</label>
</disp-formula></p>
<p>Here <italic>c</italic> is the cost, <italic>m</italic> is the margin, <italic>y</italic> is the training target (-1 for non-replicate, +1 for replicate), <italic>d</italic><sup><italic>2</italic></sup> is the squared Euclidean distance between hidden vectors. Theano [<xref ref-type="bibr" rid="pcbi.1005335.ref044">44</xref>] automatic differentiation is used to backpropagate the cost to the model weights (including regularization) via the pylearn2 [<xref ref-type="bibr" rid="pcbi.1005335.ref040">40</xref>] framework. The model parameters are optimized using the RMSprop [<xref ref-type="bibr" rid="pcbi.1005335.ref045">45</xref>] algorithm for adaptive minibatch stochastic gradient descent. The model described herein can be trained on the dataset described (120K pairs) in approximately 1 hour on a laptop computer with a 2.5 GHz CPU. While the approach has not yet been applied to transcirptome-wide profiling, the nature of the stochastic gradient descent learning method allow it to be computationally tractable for such data, the only requirement is a large enough corpus (thousands of samples), of homogeneous full-transcriptome profiles.</p>
<p>After training the model, the weights were extracted and used to generate the activation state of the last hidden layer for each input sample. While noise was added during training to regularize the model and encourage saturation, no noise was added during barcode generation in order to yield a deterministic transformation. Perturbation barcodes are generated by thresholding activations of the last hidden layer to create a binary representation. See ‘Availability of supporting material’ for software.</p>
<p>For comparison, several baseline models were created to compare replicate recognition accuracy to that of the neural network model. A model that randomly emits 1/-1 with probabilities 0.33/0.67 is a naïve model that predicts replicates independent of input with a frequency that matches that of replicate pairs in the training data. A series of models that threshold the gene expression data to generate binary representations (978 dimensional) can also be made. The thesholding was applied to the original scale (marking those with expression greater than the threshold as 1, 0 otherwise), or on the absolute value scale (where either upregulation or downregulation greater than the threshold result in 1, 0 otherwise). The thresholds were either set to be equal for all genes or were selected separately for each gene. Some hashing approaches use random projections of the data, in order to determine if the learned neural model is superior to this approach, a 100 random projection model was tested for classification of pairs as replicates vs. nonreplicates. Finally, the random projections can be replaced with learned linear projections optimized to minimize classification error, also known as a linear model. The above models with tunable parameters (thresholds, projections), were learned using gradient descent, minimizing margin error on the training set, and tested on the test set.</p>
</sec>
<sec id="sec013">
<title>Gene set enrichment analysis</title>
<p>GSEA was conducted using 6034 gene sets derived from experimental gene signatures of up- and down-regulated genes curated by Nextbio (Santa Clara, CA). Enrichment was measured using a Wilcoxon test, and the resulting rank sum test z statistic was used as a score for a given gene set’s enrichment in a sample.</p>
</sec>
<sec id="sec014">
<title>LINCS consortium data</title>
<p>Data downloaded from the NCBI GEO repository, accession GSE70138. The file GSE70138_Broad_LINCS_Level4_ZSVCINF_mlr12k_n78980x22268_2015-06-30.gct.gz was downloaded in December 2015. This dataset represents 273 compounds tested in 6-point dose response at two time points in 15 cell lines. The level 4 (z-score vs. vehicle control) data was utilized. The first 978 landmark (i.e. measured) gene measurements of the data matrix were analyzed. In order to train the perturbation barcode model on the LINCS data, a subset of the data was selected: 10 and 1 μM treatments at 24 hours. 80% of the data was used for training, and 20% for validation, and the same hyperparameters were used for the model (see section Deep Metric Learning). After the model was trained, the entire dataset was encoded with the perturbation barcodes learned from the training set. Targets for 149 of the compounds were found to be annotated in Chembl [<xref ref-type="bibr" rid="pcbi.1005335.ref046">46</xref>] or Metabase [<xref ref-type="bibr" rid="pcbi.1005335.ref047">47</xref>] databases, only those targets affected with potencies &lt;1μM were considered. For each target, distances between profiles derived from distinct compounds sharing the target were compared to a sample not sharing the target via a t statistic. Compound structures were clustered by hierarchical clustering of ECFP4 fingerprints, and gene expression profiles were clustered by the clara [<xref ref-type="bibr" rid="pcbi.1005335.ref048">48</xref>] algorithm using cluster numbers (k) determined from optimal cuts of hierarchical clustering trees of samples of the datasets. The clusterings were compared via the Adjusted Rand Index.</p>
</sec>
<sec id="sec015">
<title>Other analyses</title>
<p>Crossvalidated support vector regression was performed with the caret package [<xref ref-type="bibr" rid="pcbi.1005335.ref049">49</xref>], clustering, and correlation analyses were performed in R [<xref ref-type="bibr" rid="pcbi.1005335.ref050">50</xref>].</p>
<p>For visualization, data, either z-scores or barcodes, were reduced to two dimensions using the t-distributed stochastic neighbor embedding (t-SNE [<xref ref-type="bibr" rid="pcbi.1005335.ref038">38</xref>]) algorithm (implemented in tsne [<xref ref-type="bibr" rid="pcbi.1005335.ref051">51</xref>] package for R). Data was visualized by plotting the t-SNE features in Spotfire (Tibco).</p>
<p>Compound structures were clustered using in-house fragment-based descriptors [<xref ref-type="bibr" rid="pcbi.1005335.ref052">52</xref>], and hierarchical clustering with a threshold of Dice similarity&gt;0.6. Promiscuity was defined based on the frequency with which each compound was considered a ‘hit’ across HTS assays. Project-specific hit calling was used for each assay.</p>
</sec>
<sec id="sec016">
<title>Known target annotation</title>
<p>Merck’s chemogenomic database, the Chemical Genetic Interaction Enterprise (CHEMGENIE) was used to annotate compounds with their known targets. CHEMGENIE contains harmonized data from external (e.g., ChEMBL, Metabase, and PDB) sources as well as internal sources (e.g., project team data, kinase profile panels, counterscreen panels, etc.) where compounds are represented as desalted InChIKeys and targets are represented with their Entrez Gene ID and/or UniProt Accession. All target-based dose response data was added to each compound, and the highest affinity target was selected as a representative target for each compound.</p>
</sec>
<sec id="sec017">
<title>High Throughput Screening Fingerprints (HTS-FP)</title>
<p>HTS fingerprints were constructed as described in the past [<xref ref-type="bibr" rid="pcbi.1005335.ref037">37</xref>]. Briefly, the z-scores of primary HTS screens at Merck were calculated for all screens where &gt; 1e6 compounds had been screened (344 total screens). The z-score for each screen was then stored as a vector for each compound. Any z-scores &gt; 20 or &lt;-20 was assigned a value of 20 or -20, respectively, so that artifactual values would not impact Pearson correlation calculations as significantly. The Pearson correlation of HTS-FPs was calculated between pairs of compounds by calculated the correlation of z-scores for assays that were in common between them (all other z-scores were ignored). 3471 compounds possessed HTS-FPs and were used in this analysis.</p>
</sec>
<sec id="sec018">
<title>Activity prediction</title>
<p>t-SNE visualizations of z-scores representing the normalized L1000 data, and also of the 100-dimensional (nonthresholded) perturbation barcodes derived from the metric learning network were generated. The locations of known EGFR/MEK/MAPK inhibitors on these maps were plotted, and points (i.e. representing compound treatments), that were surrounded by these known actives were selected for testing from each of the two maps. Separately, in order to select actives from the full 978-dimensional z-score or 100-dimensional barcode space, the ten nearest neighbors (by Euclidean distance) of each of the seed compounds were identified, and available compounds were tested for activity. Compounds were tested in dose titration assay in 1536 well plate format using a previously optimized reporter gene assay. Cells (CellSensor ME-180 AP-1-bla, Life Technologies) were plated in the manufacturer’s recommended assay medium at 3000 cells/well in 9μl in black/clear tissue culture treated 1536 well plates (Greiner), and allowed to adhere overnight. Compounds were added from DMSO serial dilution plates (50μM maximum assay concentration, 8-point, 3-fold dilutions), using a 50nl pintool (GNF Systems), and the cells incubated 30 min in a tissue culture incubator. The cells were then stimulated with Epidermal Growth Factor (EGF, Life Technologies) at 10ng/ml final concentration by adding 1μl 10x stock, and allowed to respond for 5 hours in a tissue culture incubator. Beta-lactamase detection reagents (ToxBlazer, Life Technologies), were added per manufacturer’s instructions (2μl 6x mix), plates were incubated 2 hours at room temperature, and read using a bottom-reading multimode reader (Pherastar, BMG). Data was normalized to no-stimulation (100% inhibition), and stimulation + DMSO (0% inhibition), controls, and percent inhibition was plotted along with logistic regression curve fits using Spotfire (Tibco). Compounds were classified as active if they exceeded 50% inhibition of reporter activity without toxicity at concentrations below 10μM.</p>
</sec>
</sec>
<sec id="sec019">
<title>Availability of supporting materials</title>
<p>Code for performing deep metric learning and a demonstration of the analysis on the LINCS data are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/matudor/siamese" xlink:type="simple">https://github.com/matudor/siamese</ext-link>.</p>
</sec>
<sec id="sec020">
<title>Supporting information</title>
<supplementary-material id="pcbi.1005335.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005335.s001" xlink:type="simple">
<label>S1 Text</label>
<caption>
<title>Additional figures.</title>
<p>Figures showing sample correlation, sample space depiction, and details of prospective prediction results.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="pcbi.1005335.ref001"><label>1</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lamb</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Crawford</surname> <given-names>ED</given-names></name>, <name name-style="western"><surname>Peck</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Modell</surname> <given-names>JW</given-names></name>, <name name-style="western"><surname>Blat</surname> <given-names>IC</given-names></name>, <name name-style="western"><surname>Wrobel</surname> <given-names>MJ</given-names></name>, <etal>et al</etal>. <article-title>The Connectivity Map: using gene-expression signatures to connect small molecules, genes, and disease</article-title>. <source>Science (New York, NY</source>. <year>2006</year>;<volume>313</volume>(<issue>5795</issue>):<fpage>1929</fpage>–<lpage>35</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005335.ref002"><label>2</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nigsch</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Hutz</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Cornett</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Selinger</surname> <given-names>DW</given-names></name>, <name name-style="western"><surname>McAllister</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Bandyopadhyay</surname> <given-names>S</given-names></name>, <etal>et al</etal>. <article-title>Determination of minimal transcriptional signatures of compounds for target prediction</article-title>. <source>EURASIP J Bioinform Syst Biol</source>. <year>2012</year>;<volume>2012</volume>(<issue>1</issue>):<fpage>2</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1687-4153-2012-2" xlink:type="simple">10.1186/1687-4153-2012-2</ext-link></comment> <object-id pub-id-type="pmid">22574917</object-id></mixed-citation></ref>
<ref id="pcbi.1005335.ref003"><label>3</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Waring</surname> <given-names>JF</given-names></name>, <name name-style="western"><surname>Ciurlionis</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Jolly</surname> <given-names>RA</given-names></name>, <name name-style="western"><surname>Heindel</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Ulrich</surname> <given-names>RG</given-names></name>. <article-title>Microarray analysis of hepatotoxins in vitro reveals a correlation between gene expression profiles and mechanisms of toxicity</article-title>. <source>Toxicol Lett</source>. <year>2001</year>;<volume>120</volume>(<issue>1–3</issue>):<fpage>359</fpage>–<lpage>68</lpage>. <object-id pub-id-type="pmid">11323195</object-id></mixed-citation></ref>
<ref id="pcbi.1005335.ref004"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gao</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Weisman</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Lan</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Gou</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Gu</surname> <given-names>AZ</given-names></name>. <article-title>Toxicity mechanisms identification via gene set enrichment analysis of time-series toxicogenomics data: impact of time and concentration</article-title>. <source>Environ Sci Technol</source>. <year>2015</year>;<volume>49</volume>(<issue>7</issue>):<fpage>4618</fpage>–<lpage>26</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1021/es505199f" xlink:type="simple">10.1021/es505199f</ext-link></comment> <object-id pub-id-type="pmid">25785649</object-id></mixed-citation></ref>
<ref id="pcbi.1005335.ref005"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Iorio</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Bosotti</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Scacheri</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Belcastro</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Mithbaokar</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Ferriero</surname> <given-names>R</given-names></name>, <etal>et al</etal>. <article-title>Discovery of drug mode of action and drug repositioning from transcriptional responses</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source>. <year>2010</year>;<volume>107</volume>(<issue>33</issue>):<fpage>14621</fpage>–<lpage>6</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1000138107" xlink:type="simple">10.1073/pnas.1000138107</ext-link></comment> <object-id pub-id-type="pmid">20679242</object-id></mixed-citation></ref>
<ref id="pcbi.1005335.ref006"><label>6</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Swinney</surname> <given-names>DC</given-names></name>, <name name-style="western"><surname>Anthony</surname> <given-names>J</given-names></name>. <article-title>How were new medicines discovered?</article-title> <source>Nature reviews</source>. <year>2011</year>;<volume>10</volume>(<issue>7</issue>):<fpage>507</fpage>–<lpage>19</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nrd3480" xlink:type="simple">10.1038/nrd3480</ext-link></comment> <object-id pub-id-type="pmid">21701501</object-id></mixed-citation></ref>
<ref id="pcbi.1005335.ref007"><label>7</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Eder</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Sedrani</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Wiesmann</surname> <given-names>C</given-names></name>. <article-title>The discovery of first-in-class drugs: origins and evolution</article-title>. <source>Nature reviews</source>. <year>2014</year>;<volume>13</volume>(<issue>8</issue>):<fpage>577</fpage>–<lpage>87</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nrd4336" xlink:type="simple">10.1038/nrd4336</ext-link></comment> <object-id pub-id-type="pmid">25033734</object-id></mixed-citation></ref>
<ref id="pcbi.1005335.ref008"><label>8</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schenone</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Dancik</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Wagner</surname> <given-names>BK</given-names></name>, <name name-style="western"><surname>Clemons</surname> <given-names>PA</given-names></name>. <article-title>Target identification and mechanism of action in chemical biology and drug discovery</article-title>. <source>Nat Chem Biol</source>. <year>2013</year>;<volume>9</volume>(<issue>4</issue>):<fpage>232</fpage>–<lpage>40</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nchembio.1199" xlink:type="simple">10.1038/nchembio.1199</ext-link></comment> <object-id pub-id-type="pmid">23508189</object-id></mixed-citation></ref>
<ref id="pcbi.1005335.ref009"><label>9</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Verbist</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Klambauer</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Vervoort</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Talloen</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Shkedy</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Thas</surname> <given-names>O</given-names></name>, <etal>et al</etal>. <article-title>Using transcriptomics to guide lead optimization in drug discovery projects: Lessons learned from the QSTAR project</article-title>. <source>Drug discovery today</source>. <volume>20</volume>(<issue>5</issue>):<fpage>505</fpage>–<lpage>13</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.drudis.2014.12.014" xlink:type="simple">10.1016/j.drudis.2014.12.014</ext-link></comment> <object-id pub-id-type="pmid">25582842</object-id></mixed-citation></ref>
<ref id="pcbi.1005335.ref010"><label>10</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Cooper</surname> <given-names>GM</given-names></name>. <source>Pathways of intracellular signal transduction</source>. <edition>2 ed</edition>: <publisher-name>Sinauer Associates</publisher-name>; <year>2000</year>.</mixed-citation></ref>
<ref id="pcbi.1005335.ref011"><label>11</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Uda</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Saito</surname> <given-names>TH</given-names></name>, <name name-style="western"><surname>Kudo</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Kokaji</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Tsuchiya</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Kubota</surname> <given-names>H</given-names></name>, <etal>et al</etal>. <article-title>Robustness and compensation of information transmission of signaling pathways</article-title>. <source>Science (New York, NY</source>. <year>2013</year>;<volume>341</volume>(<issue>6145</issue>):<fpage>558</fpage>–<lpage>61</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005335.ref012"><label>12</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schena</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Shalon</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Davis</surname> <given-names>RW</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>PO</given-names></name>. <article-title>Quantitative monitoring of gene expression patterns with a complementary DNA microarray</article-title>. <source>Science (New York, NY</source>. <year>1995</year>;<volume>270</volume>(<issue>5235</issue>):<fpage>467</fpage>–<lpage>70</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005335.ref013"><label>13</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Peck</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Crawford</surname> <given-names>ED</given-names></name>, <name name-style="western"><surname>Ross</surname> <given-names>KN</given-names></name>, <name name-style="western"><surname>Stegmaier</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Golub</surname> <given-names>TR</given-names></name>, <name name-style="western"><surname>Lamb</surname> <given-names>J</given-names></name>. <article-title>A method for high-throughput gene expression signature analysis</article-title>. <source>Genome biology</source>. <year>2006</year>;<volume>7</volume>(<issue>7</issue>):<fpage>R61</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/gb-2006-7-7-r61" xlink:type="simple">10.1186/gb-2006-7-7-r61</ext-link></comment> <object-id pub-id-type="pmid">16859521</object-id></mixed-citation></ref>
<ref id="pcbi.1005335.ref014"><label>14</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Duan</surname> <given-names>Q</given-names></name>, <name name-style="western"><surname>Flynn</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Niepel</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Hafner</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Muhlich</surname> <given-names>JL</given-names></name>, <name name-style="western"><surname>Fernandez</surname> <given-names>NF</given-names></name>, <etal>et al</etal>. <article-title>LINCS Canvas Browser: interactive web app to query, browse and interrogate LINCS L1000 gene expression signatures</article-title>. <source>Nucleic acids research</source>. <year>2014</year>;<volume>42</volume>(<issue>Web Server issue</issue>):<fpage>W449</fpage>–<lpage>60</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gku476" xlink:type="simple">10.1093/nar/gku476</ext-link></comment> <object-id pub-id-type="pmid">24906883</object-id></mixed-citation></ref>
<ref id="pcbi.1005335.ref015"><label>15</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mootha</surname> <given-names>VK</given-names></name>, <name name-style="western"><surname>Lindgren</surname> <given-names>CM</given-names></name>, <name name-style="western"><surname>Eriksson</surname> <given-names>KF</given-names></name>, <name name-style="western"><surname>Subramanian</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Sihag</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Lehar</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>PGC-1alpha-responsive genes involved in oxidative phosphorylation are coordinately downregulated in human diabetes</article-title>. <source>Nature genetics</source>. <year>2003</year>;<volume>34</volume>(<issue>3</issue>):<fpage>267</fpage>–<lpage>73</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/ng1180" xlink:type="simple">10.1038/ng1180</ext-link></comment> <object-id pub-id-type="pmid">12808457</object-id></mixed-citation></ref>
<ref id="pcbi.1005335.ref016"><label>16</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Subramanian</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Tamayo</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Mootha</surname> <given-names>VK</given-names></name>, <name name-style="western"><surname>Mukherjee</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Ebert</surname> <given-names>BL</given-names></name>, <name name-style="western"><surname>Gillette</surname> <given-names>MA</given-names></name>, <etal>et al</etal>. <article-title>Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source>. <year>2005</year>;<volume>102</volume>(<issue>43</issue>):<fpage>15545</fpage>–<lpage>50</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.0506580102" xlink:type="simple">10.1073/pnas.0506580102</ext-link></comment> <object-id pub-id-type="pmid">16199517</object-id></mixed-citation></ref>
<ref id="pcbi.1005335.ref017"><label>17</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Bengio</surname> <given-names>Y</given-names></name>. <chapter-title>Deep Learning of Representations: Looking Forward</chapter-title>. In: <name name-style="western"><surname>Dediu</surname> <given-names>A-H</given-names></name>, <name name-style="western"><surname>Martin-Vide</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Mitkov</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Truthe</surname> <given-names>B</given-names></name>, editors. <source>Statistical Language and Speech Processing. Lecture Notes in Computer Science</source>. <volume>7978</volume>: <publisher-name>Springer</publisher-name> <publisher-loc>Berlin Heidelberg</publisher-loc>; <year>2013</year>. p. <fpage>1</fpage>–<lpage>37</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005335.ref018"><label>18</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Bengio</surname> <given-names>Y</given-names></name>. <article-title>Practical recommendations for gradient-based training of deep architectures</article-title>. <source>Neural Networks: Tricks of the Trade</source>: <publisher-name>Springer</publisher-name>; <year>2012</year>. p. <fpage>437</fpage>–<lpage>78</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005335.ref019"><label>19</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Leek</surname> <given-names>JT</given-names></name>, <name name-style="western"><surname>Scharpf</surname> <given-names>RB</given-names></name>, <name name-style="western"><surname>Bravo</surname> <given-names>HC</given-names></name>, <name name-style="western"><surname>Simcha</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Langmead</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Johnson</surname> <given-names>WE</given-names></name>, <etal>et al</etal>. <article-title>Tackling the widespread and critical impact of batch effects in high-throughput data</article-title>. <source>Nat Rev Genet</source>. <year>2010</year>;<volume>11</volume>(<issue>10</issue>):<fpage>733</fpage>–<lpage>9</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nrg2825" xlink:type="simple">10.1038/nrg2825</ext-link></comment> <object-id pub-id-type="pmid">20838408</object-id></mixed-citation></ref>
<ref id="pcbi.1005335.ref020"><label>20</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Leek</surname> <given-names>JT</given-names></name>, <name name-style="western"><surname>Scharpf</surname> <given-names>RB</given-names></name>, <name name-style="western"><surname>Bravo</surname> <given-names>HC</given-names></name>, <name name-style="western"><surname>Simcha</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Langmead</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Johnson</surname> <given-names>WE</given-names></name>, <etal>et al</etal>. <article-title>Tackling the widespread and critical impact of batch effects in high-throughput data</article-title>. <source>Nature reviews</source>. <volume>11</volume>(<issue>10</issue>):<fpage>733</fpage>–<lpage>9</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005335.ref021"><label>21</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Edelman</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Porrello</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Guinney</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Balakumaran</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Bild</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Febbo</surname> <given-names>PG</given-names></name>, <etal>et al</etal>. <article-title>Analysis of sample set enrichment scores: assaying the enrichment of sets of genes for individual samples in genome-wide expression profiles</article-title>. <source>Bioinformatics</source>. <year>2006</year>;<volume>22</volume>(<issue>14</issue>):<fpage>e108</fpage>–<lpage>16</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btl231" xlink:type="simple">10.1093/bioinformatics/btl231</ext-link></comment> <object-id pub-id-type="pmid">16873460</object-id></mixed-citation></ref>
<ref id="pcbi.1005335.ref022"><label>22</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bellet</surname> <given-names>Al</given-names></name>, <name name-style="western"><surname>Habrard</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Sebban</surname> <given-names>M</given-names></name>. <article-title>A survey on metric learning for feature vectors and structured data</article-title>. <source>arXiv preprint [Internet]</source>. <year>2013</year>.</mixed-citation></ref>
<ref id="pcbi.1005335.ref023"><label>23</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hinton</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Deng</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Yu</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Dahl</surname> <given-names>GE</given-names></name>, <name name-style="western"><surname>Mohamed</surname> <given-names>A-R</given-names></name>, <name name-style="western"><surname>Jaitly</surname> <given-names>N</given-names></name>, <etal>et al</etal>. <article-title>Deep neural networks for acoustic modeling in speech recognition: The shared views of four research groups</article-title>. <source>Signal Processing Magazine</source>. <year>2012</year>;<volume>29</volume>(<issue>6</issue>):<fpage>82</fpage>–<lpage>97</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005335.ref024"><label>24</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Krizhevsky</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Sutskever</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Hinton</surname> <given-names>GE</given-names></name>, editors. <article-title>ImageNet Classification with Deep Convolutional Neural Networks</article-title>. <source>Advances in Neural Information Processing Systems 25</source>; <year>2012</year>: <publisher-name>Curran Associates, Inc</publisher-name>.</mixed-citation></ref>
<ref id="pcbi.1005335.ref025"><label>25</label><mixed-citation publication-type="other" xlink:type="simple">Hu J, Lu J, Tan Y-P. Discriminative deep metric learning for face verification in the wild. Computer Vision and Pattern Recognition (CVPR), 2014 IEEE Conference on: IEEE; 2014. p. 1875–82.</mixed-citation></ref>
<ref id="pcbi.1005335.ref026"><label>26</label><mixed-citation publication-type="other" xlink:type="simple">Liu C. Probabilistic Siamese Network for Learning Representations: University of Toronto; 2013.</mixed-citation></ref>
<ref id="pcbi.1005335.ref027"><label>27</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rumelhart</surname> <given-names>DE</given-names></name>, <name name-style="western"><surname>Hinton</surname> <given-names>GE</given-names></name>, <name name-style="western"><surname>Williams</surname> <given-names>RJ</given-names></name>. <article-title>Learning representations by back-propagating errors</article-title>. <source>Cognitive Modeling</source>. <volume>5</volume> <year>1988</year>. p. <fpage>3</fpage>.</mixed-citation></ref>
<ref id="pcbi.1005335.ref028"><label>28</label><mixed-citation publication-type="other" xlink:type="simple">Van Rijsbergen CJ. Information Retrieval. Dept. of Computer Science, University of Glasgow1979.</mixed-citation></ref>
<ref id="pcbi.1005335.ref029"><label>29</label><mixed-citation publication-type="other" xlink:type="simple">Charikar MS, editor Similarity estimation techniques from rounding algorithms. Proceedings of the thiry-fourth annual ACM symposium on Theory of computing; 2002: ACM.</mixed-citation></ref>
<ref id="pcbi.1005335.ref030"><label>30</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mikolov</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Corrado</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Dean</surname> <given-names>J</given-names></name>. <article-title>Efficient estimation of word representations in vector space</article-title>. <source>arXiv preprint arXiv:13013781</source>. <year>2013</year>.</mixed-citation></ref>
<ref id="pcbi.1005335.ref031"><label>31</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Brown</surname> <given-names>RD</given-names></name>, <name name-style="western"><surname>Martin</surname> <given-names>YC</given-names></name>. <article-title>Use of structure-activity data to compare structure-based clustering methods and descriptors for use in compound selection</article-title>. <source>Journal of Chemical Information and Computer Sciences</source>. <year>1996</year>;<volume>36</volume>(<issue>3</issue>):<fpage>572</fpage>–<lpage>84</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005335.ref032"><label>32</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Alizadeh</surname> <given-names>AA</given-names></name>, <name name-style="western"><surname>Eisen</surname> <given-names>MB</given-names></name>, <name name-style="western"><surname>Davis</surname> <given-names>RE</given-names></name>, <name name-style="western"><surname>Ma</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Lossos</surname> <given-names>IS</given-names></name>, <name name-style="western"><surname>Rosenwald</surname> <given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Distinct types of diffuse large B-cell lymphoma identified by gene expression profiling</article-title>. <source>Nature</source>. <year>2000</year>;<volume>403</volume>(<issue>6769</issue>):<fpage>503</fpage>–<lpage>11</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/35000501" xlink:type="simple">10.1038/35000501</ext-link></comment> <object-id pub-id-type="pmid">10676951</object-id></mixed-citation></ref>
<ref id="pcbi.1005335.ref033"><label>33</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Stumpfe</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Bajorath</surname> <given-names>J</given-names></name>. <article-title>Exploring activity cliffs in medicinal chemistry</article-title>. <source>Journal of medicinal chemistry</source>. <year>2012</year>;<volume>55</volume>(<issue>7</issue>):<fpage>2932</fpage>–<lpage>42</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1021/jm201706b" xlink:type="simple">10.1021/jm201706b</ext-link></comment> <object-id pub-id-type="pmid">22236250</object-id></mixed-citation></ref>
<ref id="pcbi.1005335.ref034"><label>34</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Langfelder</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Horvath</surname> <given-names>S</given-names></name>. <article-title>Defining clusters from a hierarchical cluster tree: the Dynamic Tree Cut package for R</article-title>. <source>Bioinformatics</source>. <year>2008</year>;<volume>24</volume>(<issue>5</issue>):<fpage>719</fpage>–<lpage>20</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btm563" xlink:type="simple">10.1093/bioinformatics/btm563</ext-link></comment> <object-id pub-id-type="pmid">18024473</object-id></mixed-citation></ref>
<ref id="pcbi.1005335.ref035"><label>35</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hubert</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Arabie</surname> <given-names>P</given-names></name>. <article-title>Comparing partitions</article-title>. <source>Journal of classification</source>. <year>1985</year>;<volume>2</volume>(<issue>1</issue>):<fpage>193</fpage>–<lpage>218</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005335.ref036"><label>36</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sheridan</surname> <given-names>RP</given-names></name>, <name name-style="western"><surname>Miller</surname> <given-names>MD</given-names></name>, <name name-style="western"><surname>Underwood</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>Kearsley</surname> <given-names>SK</given-names></name>. <article-title>Chemical similarity using geometric atom pair descriptors</article-title>. <source>Journal of Chemical Information and Computer Sciences</source>. <year>1996</year>;<volume>36</volume>(<issue>1</issue>):<fpage>128</fpage>–<lpage>36</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005335.ref037"><label>37</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Petrone</surname> <given-names>PM</given-names></name>, <name name-style="western"><surname>Simms</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Nigsch</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Lounkine</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Kutchukian</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Cornett</surname> <given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Rethinking molecular similarity: comparing compounds on the basis of biological activity</article-title>. <source>ACS chemical biology</source>. <year>2012</year>;<volume>7</volume>(<issue>8</issue>):<fpage>1399</fpage>–<lpage>409</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1021/cb3001028" xlink:type="simple">10.1021/cb3001028</ext-link></comment> <object-id pub-id-type="pmid">22594495</object-id></mixed-citation></ref>
<ref id="pcbi.1005335.ref038"><label>38</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Van der Maaten</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Hinton</surname> <given-names>G</given-names></name>. <article-title>Visualizing data using t-SNE</article-title>. <source>Journal of Machine Learning</source>. <year>2008</year>;<volume>9</volume>(<issue>2579–2605</issue>):<fpage>85</fpage>.</mixed-citation></ref>
<ref id="pcbi.1005335.ref039"><label>39</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Liu</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Su</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Yang</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Wei</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Ma</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Zhou</surname> <given-names>X</given-names></name>. <article-title>Compound signature detection on LINCS L1000 big data</article-title>. <source>Molecualr BioSystems</source>. <year>2015</year>;<volume>11</volume>(<issue>3</issue>):<fpage>714</fpage>–<lpage>22</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005335.ref040"><label>40</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Goodfellow</surname> <given-names>IJ</given-names></name>, <name name-style="western"><surname>Warde-Farley</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Lamblin</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Dumoulin</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Mirza</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Pascanu</surname> <given-names>R</given-names></name>, <etal>et al</etal>. <article-title>Pylearn2: a machine learning research library</article-title>. <source>arXiv preprint [Internet]</source>. <year>2013</year>.</mixed-citation></ref>
<ref id="pcbi.1005335.ref041"><label>41</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Masci</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Bronstein</surname> <given-names>MM</given-names></name>, <name name-style="western"><surname>Bronstein</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Schmidhuber</surname> <given-names>J</given-names></name>. <article-title>Multimodal similarity-preserving hashing</article-title>. <source>Pattern Analysis and Machine Intelligence, IEEE Transactions on</source>. <year>2014</year>;<volume>36</volume>(<issue>4</issue>):<fpage>824</fpage>–<lpage>30</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005335.ref042"><label>42</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Salakhutdinov</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Hinton</surname> <given-names>G</given-names></name>. <article-title>Semantic hashing</article-title>. <source>International Journal of Approximate Reasoning</source>. <year>2009</year>;<volume>50</volume>(<issue>7</issue>):<fpage>969</fpage>–<lpage>78</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005335.ref043"><label>43</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Srivastava</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Hinton</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Krizhevsky</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Sutskever</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Salakhutdinov</surname> <given-names>R</given-names></name>. <article-title>Dropout: A simple way to prevent neural networks from overfitting</article-title>. <source>J Mach Learn Res</source>. <year>2014</year>;<volume>15</volume>(<issue>1</issue>):<fpage>1929</fpage>–<lpage>58</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005335.ref044"><label>44</label><mixed-citation publication-type="other" xlink:type="simple">Bastien F, Lamblin P, Pascanu R, Bergstra J, Goodfellow I, Bergeron A, et al. Theano: new features and speed improvements. NIPS 2012 deep learning workshop2012.</mixed-citation></ref>
<ref id="pcbi.1005335.ref045"><label>45</label><mixed-citation publication-type="other" xlink:type="simple">Tieleman TH. rmsprop2012.</mixed-citation></ref>
<ref id="pcbi.1005335.ref046"><label>46</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gaulton</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Bellis</surname> <given-names>LJ</given-names></name>, <name name-style="western"><surname>Bento</surname> <given-names>AP</given-names></name>, <name name-style="western"><surname>Chambers</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Davies</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Hersey</surname> <given-names>A</given-names></name>, <etal>et al</etal>. <article-title>ChEMBL: a large-scale bioactivity database for drug discovery</article-title>. <source>Nucleic acids research</source>. <year>2012</year>;<volume>40</volume>(<issue>D1</issue>):<fpage>D1100</fpage>–<lpage>D7</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005335.ref047"><label>47</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ekins</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Bugrim</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Nikolsky</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Nikolskaya</surname> <given-names>T</given-names></name>. <article-title>Systems biology: applications in drug discovery</article-title>. <source>Pharmaceutical Sciences Encyclopedis</source>. <year>2005</year>.</mixed-citation></ref>
<ref id="pcbi.1005335.ref048"><label>48</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Kaufman</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Rousseeuw</surname> <given-names>PJ</given-names></name>. <source>Finding groups in data: an introduction to cluster analysis</source>: <publisher-name>John Wiley &amp; Sons</publisher-name>; <year>2009</year>.</mixed-citation></ref>
<ref id="pcbi.1005335.ref049"><label>49</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kuhn</surname> <given-names>M</given-names></name>. <article-title>Building predictive models in R using the caret package</article-title>. <source>Journal of Statistical Software</source>. <year>2008</year>;<volume>28</volume>(<issue>5</issue>):<fpage>1</fpage>–<lpage>26</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005335.ref050"><label>50</label><mixed-citation publication-type="book" xlink:type="simple"><collab>Team RC</collab>. <source>R R Development Core Team: A language and environment for statistical computing</source>. <publisher-name>R Foundation for Statistical Computing</publisher-name>. ISBN 3-900051-07-0; <year>2012</year>.</mixed-citation></ref>
<ref id="pcbi.1005335.ref051"><label>51</label><mixed-citation publication-type="other" xlink:type="simple">Donaldson J. tsne: T-distributed Stochastic Neighbor Embedding for R (t-SNE). R package version 0.1–2 ed2012.</mixed-citation></ref>
<ref id="pcbi.1005335.ref052"><label>52</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Clark</surname> <given-names>M</given-names></name>. <article-title>Generalized fragment-substructure based property prediction method</article-title>. <source>Journal of chemical information and modeling</source>. <year>2005</year>;<volume>45</volume>(<issue>1</issue>):<fpage>30</fpage>–<lpage>8</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1021/ci049744c" xlink:type="simple">10.1021/ci049744c</ext-link></comment> <object-id pub-id-type="pmid">15667126</object-id></mixed-citation></ref>
</ref-list>
</back>
</article>