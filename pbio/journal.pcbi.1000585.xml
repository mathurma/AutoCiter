<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN">
<front>
<journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher></journal-meta>
<article-meta><article-id pub-id-type="publisher-id">09-PLCB-RA-0521R3</article-id><article-id pub-id-type="doi">10.1371/journal.pcbi.1000585</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline"><subject>Computational Biology</subject><subject>Computational Biology/Macromolecular Sequence Analysis</subject><subject>Computational Biology/Macromolecular Structure Analysis</subject><subject>Computer Science</subject><subject>Molecular Biology/Bioinformatics</subject></subj-group></article-categories><title-group><article-title>Predicting Protein Ligand Binding Sites by Combining Evolutionary Sequence Conservation and 3D Structure</article-title><alt-title alt-title-type="running-head">Ligand Binding Site Prediction with <italic>ConCavity</italic></alt-title></title-group><contrib-group>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Capra</surname><given-names>John A.</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Laskowski</surname><given-names>Roman A.</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Thornton</surname><given-names>Janet M.</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Singh</surname><given-names>Mona</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Funkhouser</surname><given-names>Thomas A.</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
</contrib-group><aff id="aff1"><label>1</label><addr-line>Department of Computer Science, Princeton University, Princeton, New Jersey, United States of America</addr-line>       </aff><aff id="aff2"><label>2</label><addr-line>Lewis-Sigler Institute for Integrative Genomics, Princeton University, Princeton, New Jersey, United States of America</addr-line>       </aff><aff id="aff3"><label>3</label><addr-line>European Bioinformatics Institute, Wellcome Trust Genome Campus, Hinxton, Cambridge, United Kingdom</addr-line>       </aff><contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Lengauer</surname><given-names>Thomas</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group><aff id="edit1">Max-Planck-Institut für Informatik, Germany</aff><author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">mona@cs.princeton.edu</email> (MS); <email xlink:type="simple">funk@cs.princeton.edu</email> (TAF)</corresp>
<fn fn-type="con"><p>Conceived and designed the experiments: JAC MS TAF. Performed the experiments: JAC TAF. Analyzed the data: JAC MS TAF. Wrote the paper: JAC MS TAF. Provided methodological input: RAL JMT.</p></fn>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn></author-notes><pub-date pub-type="collection"><month>12</month><year>2009</year></pub-date><pub-date pub-type="epub"><day>4</day><month>12</month><year>2009</year></pub-date><volume>5</volume><issue>12</issue><elocation-id>e1000585</elocation-id><history>
<date date-type="received"><day>11</day><month>5</month><year>2009</year></date>
<date date-type="accepted"><day>30</day><month>10</month><year>2009</year></date>
</history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2009</copyright-year><copyright-holder>Capra et al</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract>
<p>Identifying a protein's functional sites is an important step towards characterizing its molecular function. Numerous structure- and sequence-based methods have been developed for this problem. Here we introduce <italic>ConCavity</italic>, a small molecule binding site prediction algorithm that integrates evolutionary sequence conservation estimates with structure-based methods for identifying protein surface cavities. In large-scale testing on a diverse set of single- and multi-chain protein structures, we show that <italic>ConCavity</italic> substantially outperforms existing methods for identifying both 3D ligand binding pockets and individual ligand binding residues. As part of our testing, we perform one of the first direct comparisons of conservation-based and structure-based methods. We find that the two approaches provide largely complementary information, which can be combined to improve upon either approach alone. We also demonstrate that <italic>ConCavity</italic> has state-of-the-art performance in predicting catalytic sites and drug binding pockets. Overall, the algorithms and analysis presented here significantly improve our ability to identify ligand binding sites and further advance our understanding of the relationship between evolutionary sequence conservation and structural and functional attributes of proteins. Data, source code, and prediction visualizations are available on the <italic>ConCavity</italic> web site (<ext-link ext-link-type="uri" xlink:href="http://compbio.cs.princeton.edu/concavity/" xlink:type="simple">http://compbio.cs.princeton.edu/concavity/</ext-link>).</p>
</abstract><abstract abstract-type="summary"><title>Author Summary</title>
<p>Protein molecules are ubiquitous in the cell; they perform thousands of functions crucial for life. Proteins accomplish nearly all of these functions by interacting with other molecules. These interactions are mediated by specific amino acid positions in the proteins. Knowledge of these “functional sites” is crucial for understanding the molecular mechanisms by which proteins carry out their functions; however, functional sites have not been identified in the vast majority of proteins. Here, we present <italic>ConCavity</italic>, a computational method that predicts small molecule binding sites in proteins by combining analysis of evolutionary sequence conservation and protein 3D structure. <italic>ConCavity</italic> provides significant improvement over previous approaches, especially on large, multi-chain proteins. In contrast to earlier methods which only predict entire binding sites, <italic>ConCavity</italic> makes specific predictions of positions in space that are likely to overlap ligand atoms and of residues that are likely to contact bound ligands. These predictions can be used to aid computational function prediction, to guide experimental protein analysis, and to focus computationally intensive techniques used in drug discovery.</p>
</abstract><funding-group><funding-statement>JAC has been supported by the Quantitative and Computational Biology Program NIH grant T32 HG003284. MS thanks the NSF for grant PECASE MCB-0093399, and the NIH for grant GM076275. MS and TAF thank the NSF for grant IIS-0612231. This research has also been supported by the NIH Center of Excellence grant P50 GM071508 and NIH grant CA041086. TAF also thanks the Leverhulme Trust and the BBSRC for funding his sabbatical at EBI. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="18"/></counts></article-meta>
</front>
<body><sec id="s1">
<title>Introduction</title>
<p>Proteins' functions are determined to a large degree by their interactions with other molecules. Identifying which residues participate in these interactions is an important component of functionally characterizing a protein. Many computational approaches based on analysis of protein sequences or structures have been developed to predict a variety of protein functional sites, including ligand binding sites <xref ref-type="bibr" rid="pcbi.1000585-Huang1">[1]</xref>–<xref ref-type="bibr" rid="pcbi.1000585-Lopez1">[3]</xref>, DNA-binding sites <xref ref-type="bibr" rid="pcbi.1000585-Kuznetsov1">[4]</xref>, catalytic sites <xref ref-type="bibr" rid="pcbi.1000585-Capra1">[2]</xref>,<xref ref-type="bibr" rid="pcbi.1000585-Youn1">[5]</xref>, protein-protein interaction interfaces (PPIs) <xref ref-type="bibr" rid="pcbi.1000585-Ofran1">[6]</xref>,<xref ref-type="bibr" rid="pcbi.1000585-Zhou1">[7]</xref> and specificity determining positions <xref ref-type="bibr" rid="pcbi.1000585-Hannenhalli1">[8]</xref>–<xref ref-type="bibr" rid="pcbi.1000585-Capra2">[12]</xref>. In this paper, we focus on the task of predicting small molecule binding sites from protein sequences and structures. In addition to aiding in the functional characterization of proteins, knowledge of these binding sites can guide the design of inhibitors and antagonists and provide a scaffold for targeted mutations. Over the past 15 years, a large number of methods for predicting small molecule binding sites have been developed. Structural approaches have used geometric and energetic criteria to find concave regions on the protein surface that likely bind ligands <xref ref-type="bibr" rid="pcbi.1000585-Huang1">[1]</xref>, <xref ref-type="bibr" rid="pcbi.1000585-Levitt1">[13]</xref>–<xref ref-type="bibr" rid="pcbi.1000585-Weisel1">[21]</xref>. Sequence-based approaches, on the other hand, have largely exploited sequence conservation, or the tendency of functionally or structurally important sites to accept fewer mutations relative to the rest of the protein <xref ref-type="bibr" rid="pcbi.1000585-Valdar1">[22]</xref>.</p>
<p>We introduce <italic>ConCavity</italic>, a new approach for predicting 3D ligand binding pockets and individual ligand binding residues. The <italic>ConCavity</italic> algorithm directly integrates evolutionary sequence conservation estimates with structure-based surface pocket prediction in a modular three step pipeline. In the first step, we score a grid of points surrounding the protein surface by combining the output of a structure-based pocket finding algorithm (e.g., <italic>Ligsite</italic> <xref ref-type="bibr" rid="pcbi.1000585-Hendlich1">[16]</xref>, <italic>Surfnet</italic> <xref ref-type="bibr" rid="pcbi.1000585-Laskowski1">[14]</xref>, or <italic>PocketFinder</italic> <xref ref-type="bibr" rid="pcbi.1000585-An1">[23]</xref>) with the sequence conservation values of nearby residues. In the second step, we extract coherent pockets from the grid using 3D shape analysis algorithms to ensure that the predicted pockets have biologically reasonable shapes and volumes. In the final step, we map from the predicted pockets to nearby residues by assigning high scores to residues near high scoring pocket grid points. Using this pipeline, <italic>ConCavity</italic> is able to make predictions of both regions in space that are likely to contain ligand atoms as well as protein residues likely to contact bound ligands.</p>
<p>We demonstrate <italic>ConCavity</italic>'s excellent performance via extensive testing and analysis. First, we show that <italic>ConCavity</italic>, by integrating conservation and structure, provides significant improvement in identifying ligand binding pockets and residues over approaches that use either conservation alone or structure alone; this testing is performed on the diverse, non-redundant LigASite database of biologically relevant binding sites <xref ref-type="bibr" rid="pcbi.1000585-Dessailly1">[24]</xref>. We find that <italic>ConCavity</italic>'s top predicted residue is in contact with a ligand nearly 80% of the time, while the top prediction of the tested structure-alone and conservation-alone methods is correct in 67% and 57% of proteins respectively. The notable improvement of <italic>ConCavity</italic> over the conservation-alone approach demonstrates that there is significant added benefit to considering structural information when it is available. Second, we demonstrate that <italic>ConCavity</italic> significantly outperforms current publicly available methods <xref ref-type="bibr" rid="pcbi.1000585-Huang1">[1]</xref>,<xref ref-type="bibr" rid="pcbi.1000585-Dundas1">[19]</xref>,<xref ref-type="bibr" rid="pcbi.1000585-Laurie1">[25]</xref> that identify ligand binding sites based on pocket finding. Third, we show that <italic>ConCavity</italic> performs similarly when using a variety of pocket detection algorithms <xref ref-type="bibr" rid="pcbi.1000585-Laskowski1">[14]</xref>,<xref ref-type="bibr" rid="pcbi.1000585-Hendlich1">[16]</xref>,<xref ref-type="bibr" rid="pcbi.1000585-An1">[23]</xref> or sequence conservation measures <xref ref-type="bibr" rid="pcbi.1000585-Capra1">[2]</xref>,<xref ref-type="bibr" rid="pcbi.1000585-Mayrose1">[26]</xref>. Fourth, we characterize <italic>ConCavity</italic> in a range of situations, and compare its performance in identifying ligand binding sites from apo vs. holo structures as well as in enzymes vs. non-enzymes. Fifth, we test how well <italic>ConCavity</italic> can identify catalytic sites and drug binding sites. Sixth, we examine problematic cases for our approaches, and highlight the difficulty that multi-chain proteins pose for structure-based methods for identifying ligand binding sites. Finally, we demonstrate that our methodological improvements in pocket extraction and residue mapping give our implementations of existing methods a significant gain in performance over the previous versions. In fact, without these improvements, the previous structural approaches do not outperform a simple sequence conservation approach when identifying ligand binding residues. Overall, <italic>ConCavity</italic> significantly advances the state-of-the-art in uncovering ligand binding sites. Our detailed analysis reveals much about the relationship between sequence conservation, structure, and function, and shows that sequence conservation and structure-based attributes provide complementary information about functional importance.</p>
<sec id="s1a">
<title>Further related work</title>
<p>Sequence-based functional site prediction has been dominated by the search for residue positions that show evidence of evolutionary constraint. Amino acid conservation in the columns of a multiple sequence alignment of homologs is the most common source of such estimates (see <xref ref-type="bibr" rid="pcbi.1000585-Valdar1">[22]</xref> for a review). Recent approaches that compare alignment column amino acid distributions to a background amino acid distribution outperform many existing conservation measures <xref ref-type="bibr" rid="pcbi.1000585-Capra1">[2]</xref>,<xref ref-type="bibr" rid="pcbi.1000585-Wang1">[27]</xref>. However, the success of conservation-based prediction varies based on the type of functional residue sought; sequence conservation has been shown to be strongly correlated with ligand binding and catalytic sites, but less so with residues in protein-protein interfaces (PPIs) <xref ref-type="bibr" rid="pcbi.1000585-Capra1">[2]</xref>. A variety of techniques have been used to incorporate phylogenetic information into sequence-based functional site prediction, e.g., traversing phylogenetic trees <xref ref-type="bibr" rid="pcbi.1000585-Mihalek1">[28]</xref>,<xref ref-type="bibr" rid="pcbi.1000585-Sankararaman1">[29]</xref>, statistical rate inference <xref ref-type="bibr" rid="pcbi.1000585-Mayrose1">[26]</xref>, analysis of functional subfamilies <xref ref-type="bibr" rid="pcbi.1000585-delSolMesa1">[9]</xref>,<xref ref-type="bibr" rid="pcbi.1000585-Capra2">[12]</xref>, and phylogenetic motifs <xref ref-type="bibr" rid="pcbi.1000585-Bahadur1">[30]</xref>. Recently, evolutionary conservation has been combined with other properties predicted from sequence, e.g., secondary structure and relative solvent accessibility, to identify functional sites <xref ref-type="bibr" rid="pcbi.1000585-Fischer1">[31]</xref>.</p>
<p>Structure-based methods for functional site prediction seek to identify protein surface regions favorable for interactions. Ligand binding pockets and residues have been a major focus of these methods <xref ref-type="bibr" rid="pcbi.1000585-Huang1">[1]</xref>, <xref ref-type="bibr" rid="pcbi.1000585-Levitt1">[13]</xref>–<xref ref-type="bibr" rid="pcbi.1000585-Weisel1">[21]</xref>. <italic>Ligsite</italic> <xref ref-type="bibr" rid="pcbi.1000585-Hendlich1">[16]</xref> and <italic>Surfnet</italic> <xref ref-type="bibr" rid="pcbi.1000585-Laskowski1">[14]</xref> identify pockets by seeking points near the protein surface that are surrounded in most directions by the protein. <italic>CASTp</italic> <xref ref-type="bibr" rid="pcbi.1000585-Liang1">[17]</xref>,<xref ref-type="bibr" rid="pcbi.1000585-Dundas1">[19]</xref> applies alpha shape theory from computational geometry to detect and measure cavities. In contrast to these geometric approaches, other methods use models of energetics to identify potential binding sites <xref ref-type="bibr" rid="pcbi.1000585-An1">[23]</xref>, <xref ref-type="bibr" rid="pcbi.1000585-Laurie1">[25]</xref>, <xref ref-type="bibr" rid="pcbi.1000585-Elcock1">[32]</xref>–<xref ref-type="bibr" rid="pcbi.1000585-Hernandez1">[34]</xref>. Recent algorithms have focused on van der Waals energetics to create grid potential maps around the surface of the protein. <italic>PocketFinder</italic> <xref ref-type="bibr" rid="pcbi.1000585-An1">[23]</xref> uses an aliphatic carbon as the probe, and <italic>Q-SiteFinder</italic> <xref ref-type="bibr" rid="pcbi.1000585-Laurie1">[25]</xref> uses a methyl group. Our work builds upon geometry and energetics based approaches to ligand binding pocket prediction, but it should be noted that there are other structure-based approaches that do no fit in these categories (e.g., Theoretical Microscopic Titration Curves (THEMATICS) <xref ref-type="bibr" rid="pcbi.1000585-Ko1">[35]</xref>, binding site similarity <xref ref-type="bibr" rid="pcbi.1000585-Brylinski1">[36]</xref>, phage display libraries <xref ref-type="bibr" rid="pcbi.1000585-Halperin1">[37]</xref>, and residue interaction graphs <xref ref-type="bibr" rid="pcbi.1000585-Amitai1">[38]</xref>). In contrast to sequence-based predictions, structure-based methods often can make predictions both at the level of residues and regions in space that are likely to contain ligands.</p>
<p>Several previous binding site prediction algorithms have considered both sequence and structure. ConSurf <xref ref-type="bibr" rid="pcbi.1000585-Landau1">[39]</xref> provides a visualization of sequence conservation values on the surface of a protein structure, and the recent <italic>PatchFinder</italic> <xref ref-type="bibr" rid="pcbi.1000585-Nimrod1">[40]</xref> method automates the prediction of functional surface patches from ConSurf. Spatially clustered residues with high Evolutionary Trace values were found to overlap with functional sites <xref ref-type="bibr" rid="pcbi.1000585-Yao1">[41]</xref>, and Panchenko et al. <xref ref-type="bibr" rid="pcbi.1000585-Panchenko1">[42]</xref> found that averaging sequence conservation across spatially clustered positions provides improvement in functional site identification in certain settings. Several groups have attempted to identify and separate structural and functional constraints on residues <xref ref-type="bibr" rid="pcbi.1000585-Chelliah1">[43]</xref>,<xref ref-type="bibr" rid="pcbi.1000585-Cheng1">[44]</xref>. Wang et al. <xref ref-type="bibr" rid="pcbi.1000585-Wang2">[45]</xref> perform logistic regression on three sequence-based properties and predict functional sites by estimating the effect on structural stability of mutations at each position. Though these approaches make use of protein structures, they do not explicitly consider the surface geometry of the protein in prediction. Geometric, chemical, and evolutionary criteria have been used together to define motifs that represent known binding sites for use in protein function prediction <xref ref-type="bibr" rid="pcbi.1000585-Chen1">[46]</xref>. Machine learning algorithms have been applied to features based on sequence and structure <xref ref-type="bibr" rid="pcbi.1000585-Burgoyne1">[47]</xref>,<xref ref-type="bibr" rid="pcbi.1000585-Yoon1">[48]</xref> to predict catalytic sites <xref ref-type="bibr" rid="pcbi.1000585-Youn1">[5]</xref>, <xref ref-type="bibr" rid="pcbi.1000585-Gutteridge1">[49]</xref>–<xref ref-type="bibr" rid="pcbi.1000585-Tong1">[51]</xref> and recently to predict drug targets <xref ref-type="bibr" rid="pcbi.1000585-Nayal1">[52]</xref> and a limited set of ligand and ion binding sites <xref ref-type="bibr" rid="pcbi.1000585-Wei1">[53]</xref>–<xref ref-type="bibr" rid="pcbi.1000585-Ebert1">[55]</xref>. Sequence conservation has been found to be a dominant predictor in these contexts.</p>
<p>Most similar to <italic>ConCavity</italic> are two recent approaches to ligand binding site identification that have used evolutionary conservation in a post-processing step to rerank <xref ref-type="bibr" rid="pcbi.1000585-Huang1">[1]</xref> or refine <xref ref-type="bibr" rid="pcbi.1000585-Glaser1">[56]</xref> geometry based pocket predictions. In contrast, <italic>ConCavity</italic> integrates conservation directly into the search for pockets. This allows it to identify pockets that are not found when considering structure alone, and enables straightforward analysis of the relationship between sequence conservation, structural patterns, and functional importance.</p>
</sec></sec><sec id="s2">
<title>Results</title>
<sec id="s2a">
<title>Preliminaries</title>
<p>For simplicity of exposition, we begin by comparing <italic>ConCavity</italic>'s performance to a representative structural method and a representative conservation method. We use <italic>Ligsite<sup>+</sup></italic> as the representative structure-based method, and refer to it as “<italic>Structure</italic>”. <italic>Ligsite<sup>+</sup></italic> is our implementation (as indicated by superscript “+”) of a popular geometry based surface pocket identification algorithm. We demonstrate in the <xref ref-type="sec" rid="s4">Methods</xref> section that <italic>Ligsite<sup>+</sup></italic> provides a fair representation of these methods. We choose <italic>Jensen-Shannon divergence</italic> (<italic>JSD</italic>) to represent conservation methods and refer to it as “<italic>Conservation</italic>.” <italic>JSD</italic> has been previously shown to provide state-of-the-art performance in identifying catalytic sites and ligand binding sites <xref ref-type="bibr" rid="pcbi.1000585-Capra1">[2]</xref>. We have developed three versions of <italic>ConCavity</italic> that integrate evolutionary conservation into different surface pocket prediction algorithms (<italic>Ligsite</italic> <xref ref-type="bibr" rid="pcbi.1000585-Hendlich1">[16]</xref>, <italic>Surfnet</italic> <xref ref-type="bibr" rid="pcbi.1000585-Laskowski1">[14]</xref>, or <italic>PocketFinder</italic> <xref ref-type="bibr" rid="pcbi.1000585-An1">[23]</xref>). When the underlying algorithm is relevant, we refer to these versions as <italic>ConCavity<sup>L</sup></italic>, <italic>ConCavity<sup>S</sup></italic>, and <italic>ConCavity<sup>P</sup></italic>. However, for simplicity, we will use <italic>ConCavity<sup>L</sup></italic> as representative of these approaches and call it “<italic>ConCavity</italic>.”</p>
<p><italic>ConCavity</italic> and <italic>Structure</italic> produce predictions of ligand binding pockets and residues. The pocket predictions are given as non-zero values on a regular 3D grid that surrounds the protein; the score associated with each grid point represents an estimated likelihood that it overlaps a bound ligand atom. Similarly, each residue in the protein sequence is assigned a score that represents its likelihood of contacting a bound ligand. <italic>Conservation</italic> only makes residue-level predictions, because it does not consider protein structure. All methods are evaluated on 332 proteins from the non-redundant LigASite 7.0 dataset <xref ref-type="bibr" rid="pcbi.1000585-Dessailly1">[24]</xref>. To evaluate pocket identification performance, we predict ligand locations on the the holo version of the dataset, in order to use the bound ligands' locations as positives. When evaluating residue predictions, we predict ligand binding residues on the apo structures, and the residues annotated as ligand binding (as derived from the holo structures) are used as positives.</p>
<p>We quantify the overall performance of each method's predictions in two ways. First, for both pocket and residue prediction, we generate precision-recall (PR) curves that reflect the ability of each method's grid and residue scores to identify ligand atoms and ligand binding residues, respectively. (Just as residues are assigned a range of ligand binding scores, grid points in predicted pockets get a range of scores, since there may be more evidence that a ligand is bound in one part of a pocket than another.) Second, for each set of predicted pockets (corresponding to groups of non-zero values in the 3D grid), we consider how well they overlap known ligands via the Jaccard coefficient. The Jaccard coefficient captures the tradeoff between precision and recall by taking the ratio of the intersection of the predicted pocket and the actual ligand over their union. The Jaccard coefficient ranges between zero and one, and a high value implies that the prediction covers the ligand well and has a similar volume. We assess the significance of the difference in performance of methods on the dataset with respect to a given statistic via the Wilcoxon rank-sum test.</p>
</sec><sec id="s2b">
<title>Integrating evolutionary sequence conservation and structure-based pocket finding to predict ligand-binding sites improves on either approach alone</title>
<p><xref ref-type="fig" rid="pcbi-1000585-g001">Figure 1</xref> compares <italic>ConCavity</italic> with its constituent structure and conservation based components. <xref ref-type="fig" rid="pcbi-1000585-g001">Figure 1A</xref> shows that, within predicted pockets, grid points with higher scores are more likely to overlap the ligand, and that the significant improvement of <italic>ConCavity</italic> over <italic>Structure</italic> (p&lt;2.2e−16) exists across the range of score thresholds. <xref ref-type="fig" rid="pcbi-1000585-g001">Figure 1B</xref> demonstrates that the superior performance of <italic>ConCavity</italic> holds when predicting ligand binding residues as well (p = 6.80e−13). <italic>ConCavity</italic>'s ability to identify ligand binding residues is striking: across this diverse dataset, the first residue prediction of <italic>ConCavity</italic> will be in contact with a ligand in nearly 80% of proteins. <italic>ConCavity</italic> also maintains high precision across the full recall range: precision of 65% at 50% recall and better than 30% when all ligand-binding residues have been identified. As mentioned above, this large improvement exists when predicting ligand locations as well; however, the PR curves illustrate that fully identifying a ligand's position is more difficult for each of the methods than finding all contacting residues.</p>
<fig id="pcbi-1000585-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000585.g001</object-id><label>Figure 1</label><caption>
<title>Ligand binding site prediction performance.</title>
<p>(A) PR curves for prediction of the spatial location of biologically relevant bound ligands. (B) PR curves for ligand binding residue prediction. Our <italic>ConCavity</italic> algorithm, which combines sequence conservation with structure-based predictors, significantly outperforms either of the constituent methods at both tasks. Prediction based on structural information alone outperforms considering sequence conservation alone. Comparing (A) and (B), we see that accurately predicting the location of all ligand atoms is harder for the methods than finding all the contacting residues. <italic>Random</italic> gives the expected performance of a method that randomly ranks grid points and residues. <italic>Conservation</italic> could not be included in (A), because it only predicts at the residue level. The curves are based on binding sites in 332 proteins from the non-redundant LigASite 7.0 dataset.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000585.g001" xlink:type="simple"/></fig>
<p>The ligand overlap statistics presented in <xref ref-type="table" rid="pcbi-1000585-t001">Table 1</xref> also demonstrate the superior performance of <italic>ConCavity</italic>. In nearly 95% of structures, <italic>ConCavity</italic>'s predictions overlap with a bound ligand. <italic>Structure</italic>'s predictions overlap ligands in nearly 92% of the proteins considered. The differences between the methods become more stark when we examine the magnitude of these overlaps. Both <italic>ConCavity</italic> and <italic>Structure</italic> predict pockets with total volume (Prediction Vol.) similar to that of all relevant ligands (Ligand Vol.), but <italic>ConCavity</italic>'s pockets overlap a larger fraction of the ligand volume. Thus <italic>ConCavity</italic> has a significantly higher Jaccard coefficient (p&lt;2.2e−16). This suggests that the integration of sequence conservation with structural pocket identification results in more accurate pockets than when using structural features alone.</p>
<table-wrap id="pcbi-1000585-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000585.t001</object-id><label>Table 1</label><caption>
<title>The overlap between predicted pockets and bound ligands in holo protein structures from the LigASite database.</title>
</caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1000585-t001-1" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000585.t001" xlink:type="simple"/><table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" colspan="1" rowspan="1">Method</td>
<td align="left" colspan="1" rowspan="1">Fraction with Ligand Overlap</td>
<td align="left" colspan="1" rowspan="1">Prediction Vol. (Å<sup>3</sup>)</td>
<td align="left" colspan="1" rowspan="1">Ligand Vol. (Å<sup>3</sup>)</td>
<td align="left" colspan="1" rowspan="1">Prediction <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000585.e001" xlink:type="simple"/></inline-formula> Ligand (Å<sup>3</sup>)</td>
<td align="left" colspan="1" rowspan="1">Prediction <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000585.e002" xlink:type="simple"/></inline-formula> Ligand (Å<sup>3</sup>)</td>
<td align="left" colspan="1" rowspan="1">Jaccard coefficient</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" colspan="1" rowspan="1"><italic>Structure</italic></td>
<td align="left" colspan="1" rowspan="1">0.92</td>
<td align="left" colspan="1" rowspan="1">1806.8</td>
<td align="left" colspan="1" rowspan="1">1977.2</td>
<td align="left" colspan="1" rowspan="1">426.9</td>
<td align="left" colspan="1" rowspan="1">3357.1</td>
<td align="left" colspan="1" rowspan="1">0.197</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><italic>ConCavity</italic></td>
<td align="left" colspan="1" rowspan="1">0.95</td>
<td align="left" colspan="1" rowspan="1">1806.9</td>
<td align="left" colspan="1" rowspan="1">1977.2</td>
<td align="left" colspan="1" rowspan="1">647.6</td>
<td align="left" colspan="1" rowspan="1">3136.5</td>
<td align="left" colspan="1" rowspan="1">0.257</td>
</tr>
</tbody>
</table></alternatives><table-wrap-foot><fn id="nt101"><label/><p>The first column gives the fraction of proteins for which a method's predictions overlap a ligand. The second column (Prediction Vol.) lists the average volume of the predicted pockets for each protein, while the third column (Ligand Vol.) lists the average volume of ligands observed in the structure. The next columns give the average volumes of the Intersection and Union of the predictions and ligands and the Jaccard coefficient (Intersection/Union). <italic>ConCavity</italic> and <italic>Structure</italic> predict pockets of similar sizes---both use a similar pocket volume threshold---but <italic>ConCavity</italic>'s predictions overlap more of the bound ligands. <italic>ConCavity</italic>'s higher Jaccard coefficient demonstrates that it better manages the tradeoff between precision and recall.</p></fn></table-wrap-foot></table-wrap>
<p><xref ref-type="fig" rid="pcbi-1000585-g001">Figure 1B</xref> also provides a direct comparison of ligand binding site prediction methods based on sequence conservation with those based on structural features. <italic>Structure</italic> outperforms <italic>Conservation</italic>, a state-of-the-art method for estimating sequence conservation. Protein residues can be evolutionarily conserved for a number of reasons, so it is not surprising that <italic>Conservation</italic> identifies many non-ligand-binding residues, and thus, does not perform as well as <italic>Structure</italic>.</p>
</sec><sec id="s2c">
<title><italic>ConCavity</italic>'s improvement comes from integrating complementary information from evolutionary sequence conservation and structure-based pocket identification</title>
<p><xref ref-type="fig" rid="pcbi-1000585-g002">Figures 2</xref> and <xref ref-type="fig" rid="pcbi-1000585-g003">3</xref> present pocket and residue predictions of <italic>Conservation</italic>, <italic>Structure</italic>, and <italic>ConCavity</italic> on three example proteins. In general, different types of positions are predicted by <italic>Conservation</italic> and <italic>Structure</italic>. If we consider the number of known ligand binding residues for each protein in the dataset, and take this number of top predictions for the <italic>Structure</italic> and <italic>Conservation</italic> methods, the overlap is only 26%. The residues predicted by sequence conservation are spread throughout the protein (<xref ref-type="fig" rid="pcbi-1000585-g002">Figure 2</xref>); ligand-binding residues are often very conserved, but many other positions are highly conserved as well due to other functional constraints. In contrast, the structure-based predictions are strongly clustered around surface pockets (<xref ref-type="fig" rid="pcbi-1000585-g003">Figure 3</xref>, left column); many of these residues near pockets are not evolutionarily conserved. However, these features provide largely complementary information about importance for ligand binding. Over the entire dataset, 68% of residues predicted by both <italic>Conservation</italic> and <italic>Structure</italic> are in contact with ligands, while only 16% and 43% of those predicted by only conservation or structure respectively are ligand binding. <italic>ConCavity</italic> takes advantage of this complementarity to achieve its dramatic improvement; it gives high scores to positions that show evidence of both being in a well-formed pocket and being evolutionarily conserved.</p>
<fig id="pcbi-1000585-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000585.g002</object-id><label>Figure 2</label><caption>
<title>Evolutionary sequence conservation mapped to the surface of three example proteins.</title>
<p>(A) Cellular retinoic acid-binding protein II (PDB: 3CWK). (B) Delta1-piperideine-2-carboxylate reductase (PDB: 2CWH). (C) Thiamin phosphate synthase (PDB: 1G6C). Warmer colors indicate greater evolutionary conservation; the most conserved residues are colored dark red, and the least conserved are colored dark blue. Ligands are rendered with yellow sticks, and protein backbone atoms are shown as spheres. In general, <italic>Conservation</italic> gives the highest scores to residues near ligands, but high scoring residues are found throughout each structure. The predictions of <italic>Structure</italic> and <italic>ConCavity</italic> for these proteins are given in <xref ref-type="fig" rid="pcbi-1000585-g003">Figure 3</xref>.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000585.g002" xlink:type="simple"/></fig><fig id="pcbi-1000585-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000585.g003</object-id><label>Figure 3</label><caption>
<title>Comparison of the binding site predictions of <italic>Structure</italic> and <italic>ConCavity</italic> on three example proteins.</title>
<p>The three proteins presented here correspond to those shown in <xref ref-type="fig" rid="pcbi-1000585-g002">Figure 2</xref>. In each pane, ligand binding residue scores have been mapped to the protein surface. Warmer colors indicate a higher binding score. Pocket predictions are shown as green meshes. (A) PDB: 3CWK. Both methods identify the binding site, but by considering conservation information (<xref ref-type="fig" rid="pcbi-1000585-g002">Figure 2A</xref>), <italic>ConCavity</italic> more accurately traces the ligand. (B) PDB: 2CWH. <italic>Structure</italic> significantly overpredicts the extent of the ligand in the bottom left corner as well as predicting an additional pocket on the reverse of the protein. <italic>ConCavity</italic> predicts only the two ligand binding pockets. (C) PDB: 1G6C. In order to visualize the predictions more clearly, only the secondary structure diagram of the protein is shown. This example illustrates the difficulty presented by multichain proteins; there are many cavities in the structure, but not all bind ligands. <italic>Structure</italic> identifies some of the relevant pockets, but focuses on the large, non-binding central cavity formed between the chains. Referring to this protein's conservation profile (<xref ref-type="fig" rid="pcbi-1000585-g002">Figure 2C</xref>), we see that the ligand binding pockets exhibit high conservation while the non-binding pockets do not. As a result, <italic>ConCavity</italic> selects only the relevant binding pockets. In each example, <italic>ConCavity</italic> selects the binding pocket(s) out of all potential pockets and more accurately traces the ligands' locations in these pockets.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000585.g003" xlink:type="simple"/></fig>
<p>The examples of <xref ref-type="fig" rid="pcbi-1000585-g002">Figures 2</xref> and <xref ref-type="fig" rid="pcbi-1000585-g003">3</xref> illustrate this and highlight several common patterns in <italic>ConCavity</italic>'s improved predictions. For 3CWK, a cellular retinoic acid-binding protein, <italic>Structure</italic> and <italic>ConCavity</italic>'s residue predictions center on the main ligand binding pocket (<xref ref-type="fig" rid="pcbi-1000585-g003">Figure 3A</xref>), while <italic>Conservation</italic> gives high scores to some positions in the binding site, but also to some unrelated residues (<xref ref-type="fig" rid="pcbi-1000585-g002">Figure 2A</xref>). Looking at the ligand location predictions (green meshes in <xref ref-type="fig" rid="pcbi-1000585-g003">Figure 3A</xref>), <italic>Structure</italic> and <italic>ConCavity</italic> both find the pocket, but the signal from conservation enables <italic>ConCavity</italic> to more accurately trace the ligand's location. This illustrates how the pattern of functional conservation observed at the protein surface influences the shape of the predicted pocket. Ligands often do not completely fill surface pockets; if the contacting residues are conserved, our approach can suggest a more accurate shape.</p>
<p>The results for 2CWH (<xref ref-type="fig" rid="pcbi-1000585-g003">Figure 3B</xref>) and 1G6C (<xref ref-type="fig" rid="pcbi-1000585-g003">Figure 3C</xref>) demonstrate that <italic>ConCavity</italic> can predict dramatically different sets of pockets than are obtained when considering structure alone. In 2CWH, both methods identify the ligands, but <italic>Structure</italic> over-predicts the bottom left binding pocket and predicts an additional pocket that does not have a ligand bound. <italic>ConCavity</italic> traces the ligands more closely and does not predict any additional pockets. <italic>Structure</italic> performs quite poorly on the tetramer 1G6C: it predicts several pockets that do not bind ligands; it fails to completely identify several ligands; and it misses one ligand entirely. In stark contrast, <italic>ConCavity</italic>'s four predicted pockets each accurately trace a ligand. The incorporation of conservation resulted in the accurate prediction of a pocket in a region where no pocket was predicted using structure alone. Images of predictions for all methods on all proteins in the dataset are available in the <xref ref-type="supplementary-material" rid="pcbi.1000585.s001">Text S1</xref> file, and <italic>ConCavity</italic>'s predictions for all structures in the Protein Quaternary Structure (PQS) database are available online.</p>
</sec><sec id="s2d">
<title><italic>ConCavity</italic> significantly outperforms available prediction servers</title>
<p>We now compare the performance of <italic>ConCavity</italic> to several existing ligand binding site identification methods with publicly available web servers. <italic>LigsiteCS</italic> <xref ref-type="bibr" rid="pcbi.1000585-Huang1">[1]</xref> is an updated version of geometry-based <italic>Ligsite</italic>, and <italic>LigsiteCSC</italic> <xref ref-type="bibr" rid="pcbi.1000585-Huang1">[1]</xref> is a similar structural method that considers evolutionary conservation information. <italic>Q-SiteFinder</italic> <xref ref-type="bibr" rid="pcbi.1000585-Laurie1">[25]</xref> estimates van der Waals interactions between the protein and a probe in a fashion similar to <italic>PocketFinder. CASTp</italic> <xref ref-type="bibr" rid="pcbi.1000585-Dundas1">[19]</xref> is a geometry-based algorithm for finding pockets based on analysis of the protein's alpha shape. Each of the servers produces a list of predicted pockets represented by sets of residues; however, none of them provide a full 3D representation of a predicted pocket. As a result, we assess their ability to predict ligand binding residues. See the <xref ref-type="sec" rid="s4">Methods</xref> section for more information on the generation and processing of the servers' predictions. In brief, the residues predicted by each server are ranked according to the highest ranking pocket to which they are assigned, i.e., all residues from the first predicted pocket are given a higher score than those from the second and so on. We re-implemented the conservation component of <italic>LigsiteCSC</italic>, because the conservation-based re-ranking option on the web server did not work for many of the proteins in our dataset. We used <italic>JSD</italic> as the conservation scoring method.</p>
<p><xref ref-type="fig" rid="pcbi-1000585-g004">Figure 4</xref> presents the ligand binding residue PR-curves for each of these methods. <italic>ConCavity</italic> significantly outperforms <italic>LigsiteCS</italic>, <italic>LigsiteCSC<sup>+</sup></italic>, <italic>Q-SiteFinder</italic>, and <italic>CASTp</italic> (p&lt;2.2e−16 for each). Surprisingly, <italic>Conservation</italic> is competitive with these structure-based approaches. Several of the servers did not produce predictions for a small subset of the proteins in the database, e.g., the <italic>Q-SiteFinder</italic> server does not accept proteins with more than 10,000 atoms. <xref ref-type="fig" rid="pcbi-1000585-g004">Figure 4</xref> is based on 234 proteins from the LigASite dataset for which were able to obtain and evaluate predictions for all methods. Thus the curve for <italic>ConCavity</italic> is slightly different than those found in the other figures, but its performance does not change significantly.</p>
<fig id="pcbi-1000585-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000585.g004</object-id><label>Figure 4</label><caption>
<title>Comparison of <italic>ConCavity</italic> with publicly available ligand binding site prediction servers.</title>
<p><italic>ConCavity</italic> significantly outperforms each previous method at the prediction of ligand binding residues. The existing servers focus on the task of pocket prediction, and return sets of residues that represent binding pocket predictions. They do not give different scores to these individual residues. In contrast, <italic>ConCavity</italic> assigns each residue a likelihood of binding, and thus residues in the same predicted pocket can have different scores. This ability and the direct integration of sequence conservation are the major sources of <italic>ConCavity</italic>'s improvement. <italic>Conservation</italic>, the method based solely on sequence conservation, is competitive with these previous structural approaches. This figure is based on 234 proteins from the LigASite apo dataset for which we were able to obtain predictions from all methods.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000585.g004" xlink:type="simple"/></fig>
<p><italic>LigsiteCSC<sup>+</sup></italic> is the previous method most similar to <italic>ConCavity</italic>; it uses sequence conservation to rerank the pockets predicted by <italic>LigsiteCS</italic>. <italic>LigsiteCSC<sup>+</sup></italic> provides slight improvement over <italic>LigsiteCS</italic>, but the improvement is dwarfed by that of <italic>ConCavity</italic> over <italic>Structure</italic> (<xref ref-type="fig" rid="pcbi-1000585-g001">Figure 1</xref>). This illustrates the benefit of incorporating conservation information directly into the search for pockets in contrast to using conservation information to post-process predicted pockets.</p>
<p>The poor performance of these previous methods at identifying ligand binding residues is due in part to the fact that they do not distinguish among the residues near a predicted binding pocket. The entire pocket is a useful starting place for analysis, but many residues in a binding pocket will not actually contact the ligand. Knowledge of the specific ligand binding residues is of most interest to researchers. The predictions of our methods reflect this---residues within the same pocket can receive different ligand binding scores. The inability of previous methods to differentiate residues in a pocket from one another is one reason why we elect to use our own implementations of previous structure-based methods as representatives of these approaches in all other comparisons. See the <xref ref-type="sec" rid="s4">Methods</xref> section for more details.</p>
<p>We tested an additional approach for combining sequence conservation with structural information that was suggested by the observation that clusters of conserved residues in 3D often overlap with binding sites <xref ref-type="bibr" rid="pcbi.1000585-Yao1">[41]</xref>,<xref ref-type="bibr" rid="pcbi.1000585-Panchenko1">[42]</xref>. Briefly, the method performs a 3D Gaussian blur of the conservation scores of each residue, and assigns each residue the maximum overlapping value. Thus residues nearby in space to other conserved residues get high scores. This approach improved on considering conservation alone, but was not competitive with <italic>ConCavity</italic> (<xref ref-type="supplementary-material" rid="pcbi.1000585.s001">Text S1</xref>). We also considered the clusters of conserved residues generated by the <italic>Evolutionary Trace (ET) Viewer</italic> <xref ref-type="bibr" rid="pcbi.1000585-Morgan1">[57]</xref>. The clusters defined at 25% protein coverage were ranked by size, and residues within the clusters were ranked by their raw <italic>ET</italic> score. This approach did not perform as well as the above clustering algorithm (data not shown), and was limited to single chain proteins, because <italic>ET</italic> returns predictions for only one chain of multi-chain proteins.</p>
</sec><sec id="s2e">
<title><italic>ConCavity</italic> performs similarly for geometry and energetics based grid creation methods</title>
<p>In the previous sections, we used <italic>ConCavity<sup>L</sup></italic>, which integrates evolutionary sequence conservation estimates from the Jensen-Shannon divergence (JSD) into <italic>Ligsite<sup>+</sup></italic>, to represent the performance of the <italic>ConCavity</italic> approach. However, our strategy for combining sequence conservation with structural predictions is general; it can be used with a variety of grid-based surface pocket identification algorithms and conservation estimation methods.</p>
<p><xref ref-type="fig" rid="pcbi-1000585-g005">Figure 5</xref> gives PR-curves that demonstrate that <italic>ConCavity</italic> provides excellent performance whether the structural approaches are based on geometric properties (<italic>Ligsite<sup>+</sup></italic>, <italic>Surfnet<sup>+</sup></italic>) or energetics (<italic>PocketFinder<sup>+</sup></italic>). The significant improvement holds for predicting both ligand locations in space (p&lt;2.2e−16 for each pair) (<xref ref-type="fig" rid="pcbi-1000585-g005">Figure 5A</xref>) and ligand binding residues (p = 6.802e−13 for <italic>Ligsite<sup>+</sup></italic>, p&lt;2.2e−16 for <italic>PocketFinder<sup>+</sup></italic>, p&lt;2.2e−16 for <italic>Surfnet<sup>+</sup></italic>) (<xref ref-type="fig" rid="pcbi-1000585-g005">Figure 5B</xref>). The three <italic>ConCavity</italic> versions perform similarly despite the variation in performance between <italic>Ligiste<sup>+</sup></italic>, <italic>Surfnet<sup>+</sup></italic>, and <italic>Pocketfinder<sup>+</sup></italic>. In the following sections we will include performance statistics for all three methods when space and clarity allow. When not presented here, results for all methods are available in the supplementary file <xref ref-type="supplementary-material" rid="pcbi.1000585.s001">Text S1</xref>.</p>
<fig id="pcbi-1000585-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000585.g005</object-id><label>Figure 5</label><caption>
<title>Comparison of different versions of <italic>ConCavity.</italic></title>
<p><italic>ConCavity</italic> provides a general framework for binding site prediction. We use <italic>Ligsite<sup>+</sup></italic> -based <italic>ConCavity</italic> as representative, but it is possible to use other algorithms in <italic>ConCavity</italic>. This figure compares the PR curves for three versions (<italic>ConCavity<sup>L</sup></italic>, <italic>ConCavity<sup>P</sup></italic>, <italic>ConCavity<sup>S</sup></italic> )---each based on integrating sequence conservation with a different grid creation strategy (<italic>Ligsite<sup>+</sup></italic>, <italic>PocketFinder<sup>+</sup></italic>, or <italic>Surfnet<sup>+</sup>)</italic>. All three versions perform similarly, and all significantly outperform the methods based on structure analysis alone (dashed lines). These conclusions hold for both ligand binding pocket (A) and ligand binding residue (B) prediction.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000585.g005" xlink:type="simple"/></fig>
<p>We have also found that <italic>ConCavity</italic> achieves similar performance when a different state-of-the-art method <xref ref-type="bibr" rid="pcbi.1000585-Mayrose1">[26]</xref> is used to score evolutionary sequence conservation (<xref ref-type="supplementary-material" rid="pcbi.1000585.s001">Text S1</xref>).</p>
</sec><sec id="s2f">
<title>Structure-based methods have difficulty with multi-chain proteins</title>
<p>Proteins consisting of multiple subunits generally have more pockets than single-chain proteins due to the gaps that often form between chains. To investigate the effect of structural complexity on performance, we partitioned the dataset according to the number of chains present in the structure predicted by the Protein Quaternary Structure (PQS) server <xref ref-type="bibr" rid="pcbi.1000585-Henrick1">[58]</xref> and performed our previous evaluations on the partitioned sets. <xref ref-type="fig" rid="pcbi-1000585-g006">Figure 6</xref> gives these statistics for <italic>ConCavity</italic>, <italic>Structure</italic>, and <italic>Conservation</italic>. To enable side-by-side comparison, we report the area under the PR curves (PR-AUC) rather than giving the full curves.</p>
<fig id="pcbi-1000585-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000585.g006</object-id><label>Figure 6</label><caption>
<title>Ligand-binding site identification performance by number of chains in structure.</title>
<p>(A) The average area under the precision-recall curve (PR-AUC) for predicting ligand binding residues on each set of structures. (B) The average PR-AUC for ligand binding pocket identification. (C) The average Jaccard coefficient of the overlap of the predicted pockets with bound ligands. Methods based on structure alone have an increasingly difficult time distinguishing among ligand-binding pockets and non-ligand-binding gaps between chains as the number of chains in the protein increases. This trend is clear in each evaluation. <italic>Conservation</italic>'s performance does not exhibit this effect (A). In fact, <italic>Conservation</italic> outperforms <italic>Structure</italic> on proteins with five or more chains. The integration of sequence conservation and pocket prediction in <italic>ConCavity</italic> improves performance in each chain based partition in each evaluation, and <italic>ConCavity</italic> sees only a modest decrease in performance on proteins with multiple chains. <italic>Conservation</italic> alone could not be included in (B) and (C), because it does not make pocket predictions. Note that the y-axes in the figures do not all have the same scale. The number of structures per chain group: 1 chain: 143, 2 chains: 112, 3 chains: 18, 4 chains: 35, 5 or more chains: 24.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000585.g006" xlink:type="simple"/></fig>
<p>As the number of chains in the structure increases, there is a substantial decrease in the performance of <italic>Structure</italic>. The pattern is seen both when predicting ligand binding residues (<xref ref-type="fig" rid="pcbi-1000585-g006">Figure 6A</xref>) and pockets (<xref ref-type="fig" rid="pcbi-1000585-g006">Figure 6B, C</xref>). This effect is so large that, for proteins with five or more chains, <italic>Conservation</italic> outperforms <italic>Structure</italic>. The number of chains in the protein has little effect on <italic>Conservation</italic>'s performance. The performance of <italic>Random</italic> on proteins with a small number of chains is slightly worse than on proteins with many chains (e.g., Residue PR-AUC for 1 chain: 0.097, 2 chains: 0.110, 3 chains: 0.127, 4 chains: 0.119, 5+ chains: 0.142), so the drop in <italic>Structure</italic>'s performance is not the result of the proportion of positives in each set. These observations emphasize the importance of including multi-chain proteins in the evaluation.</p>
<p>The homo-tetramer 1G6C in <xref ref-type="fig" rid="pcbi-1000585-g003">Figure 3C</xref> provides an illustrative example of the failure of <italic>Structure</italic> on multi-chain proteins. There is a large gap between the chains in the center of the structure, and several additional pockets are formed at the interface of pairs of contacting chains. As seen in the figure, the large central cavity does not bind a ligand; however, it is the largest pocket predicted by <italic>Structure</italic>. This is frequently observed among the predictions. While some pockets between protein chains are involved in ligand binding, many of them are not. As the number of chains increases, so does the number of such potentially misleading pockets.</p>
<p>By incorporating sequence conservation information, <italic>ConCavity</italic> accurately identifies ligand binding pockets in multi-chain proteins. The conservation profile on the surface of 1G6C provides a clear example of this; the pockets that exhibit sequence conservation are those that bind ligands (<xref ref-type="fig" rid="pcbi-1000585-g002">Figure 2C</xref>). 1G6C is not an exception. <italic>ConCavity</italic> provides significant performance improvement for each partition of the dataset in all three evaluations, and greatly reduces the effect of the large number of non-ligand-binding pockets in multi-chain proteins on performance. <italic>ConCavity</italic> also provides improvement over <italic>Structure</italic> on the set of one chain proteins. This is notable because these proteins do not have between-chain gaps, so the improvement comes from tracing ligands and selecting among intra-chain pockets more accurately than using structural information alone (as in <xref ref-type="fig" rid="pcbi-1000585-g003">Figure 3A</xref>).</p>
</sec><sec id="s2g">
<title><italic>ConCavity</italic> performs well on both apo and holo structures</title>
<p>The binding of a ligand induces conformational changes to a protein <xref ref-type="bibr" rid="pcbi.1000585-Najmanovich1">[59]</xref>. As a result, the 3D structure of the binding site can differ between structures of the same protein with a ligand bound (holo) and not bound (apo). In the holo structures, the relevant side-chains are in conformations that contact the ligand, and this often defines the binding pocket more clearly than in apo structures. To investigate the effect of the additional information provided in holo structures on performance, we evaluated the methods on both sets (<xref ref-type="table" rid="pcbi-1000585-t002">Table 2</xref>).</p>
<table-wrap id="pcbi-1000585-t002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000585.t002</object-id><label>Table 2</label><caption>
<title>Area under the Precision-Recall curve (PR-AUC) for ligand-binding residue prediction methods on apo (unbound) and holo (bound) versions of LigASite.</title>
</caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1000585-t002-2" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000585.t002" xlink:type="simple"/><table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="center" colspan="2" rowspan="1">Residue PR-AUC</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">Method</td>
<td align="left" colspan="1" rowspan="1">apo</td>
<td align="left" colspan="1" rowspan="1">holo</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" colspan="1" rowspan="1"><italic>ConCavity<sup>L</sup></italic></td>
<td align="left" colspan="1" rowspan="1">0.608</td>
<td align="left" colspan="1" rowspan="1">0.657</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><italic>ConCavity<sup>P</sup></italic></td>
<td align="left" colspan="1" rowspan="1">0.601</td>
<td align="left" colspan="1" rowspan="1">0.646</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><italic>ConCavity<sup>S</sup></italic></td>
<td align="left" colspan="1" rowspan="1">0.586</td>
<td align="left" colspan="1" rowspan="1">0.648</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><italic>Ligsite<sup>+</sup></italic></td>
<td align="left" colspan="1" rowspan="1">0.519</td>
<td align="left" colspan="1" rowspan="1">0.552</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><italic>PocketFinder<sup>+</sup></italic></td>
<td align="left" colspan="1" rowspan="1">0.472</td>
<td align="left" colspan="1" rowspan="1">0.514</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><italic>Surfnet<sup>+</sup></italic></td>
<td align="left" colspan="1" rowspan="1">0.416</td>
<td align="left" colspan="1" rowspan="1">0.481</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><italic>Random</italic></td>
<td align="left" colspan="1" rowspan="1">0.109</td>
<td align="left" colspan="1" rowspan="1">0.095</td>
</tr>
</tbody>
</table></alternatives><table-wrap-foot><fn id="nt102"><label/><p>All methods perform better on holo structures than apo structures, but the drop in performance is not dramatic, and the relative ranking of the methods is the same across both datasets.</p></fn></table-wrap-foot></table-wrap>
<p>As expected, all methods performed better on the holo (bound) structures than the corresponding apo (unbound) structures. However, all previous conclusions hold whether considering apo structures or holo structures; the ranking of the methods is consistent, and the improvement provided by considering conservation is similarly large. PR curves for this comparison are given in the supplementary file <xref ref-type="supplementary-material" rid="pcbi.1000585.s001">Text S1</xref>. We will continue to report residue prediction results computed using the apo structures when possible in order to accurately assess the performance of the algorithms in the situation faced by ligand binding site prediction methods in the real world.</p>
</sec><sec id="s2h">
<title>The methods better identify ligand binding sites in enzymes than non-enzymes</title>
<p>The LigASite apo dataset contains protein molecules that carry out a range of different functions. Enzymes are by far the most common; they make up 254 of the 332 proteins in the dataset. The remaining 78 non-enzyme ligand binding proteins are involved in a wide variety of functions, e.g., transport, signaling, nucleic acid binding, and immune system response.</p>
<p><xref ref-type="table" rid="pcbi-1000585-t003">Table 3</xref> compares the performance of the ligand binding site prediction methods on enzymes and non-enzymes. There is more variation within each method's performance on non-enzyme proteins, and all methods perform significantly better on the enzymes (e.g., p = 3.336e−4 for <italic>ConCavity<sup>L</sup></italic> ). Active sites in enzymes are usually found in large clefts on the protein surface and consistently exhibit evolutionary sequence conservation <xref ref-type="bibr" rid="pcbi.1000585-Laskowski2">[60]</xref>,<xref ref-type="bibr" rid="pcbi.1000585-Bartlett1">[61]</xref>, so even though enzymes bind a wide array of substrates, these common features may simplify prediction when compared to the variety of binding mechanisms found in other proteins.</p>
<table-wrap id="pcbi-1000585-t003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000585.t003</object-id><label>Table 3</label><caption>
<title>Ligand binding residue identification in enzymes and non-enzymes (LigASite apo).</title>
</caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1000585-t003-3" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000585.t003" xlink:type="simple"/><table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="center" colspan="2" rowspan="1">Residue PR-AUC</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">Method</td>
<td align="left" colspan="1" rowspan="1">Enzyme</td>
<td align="left" colspan="1" rowspan="1">Non-enzyme</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" colspan="1" rowspan="1"><italic>ConCavity<sup>L</sup></italic></td>
<td align="left" colspan="1" rowspan="1">0.647</td>
<td align="left" colspan="1" rowspan="1">0.480</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><italic>ConCavity<sup>P</sup></italic></td>
<td align="left" colspan="1" rowspan="1">0.642</td>
<td align="left" colspan="1" rowspan="1">0.466</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><italic>ConCavity<sup>S</sup></italic></td>
<td align="left" colspan="1" rowspan="1">0.624</td>
<td align="left" colspan="1" rowspan="1">0.461</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><italic>Ligsite<sup>+</sup></italic></td>
<td align="left" colspan="1" rowspan="1">0.541</td>
<td align="left" colspan="1" rowspan="1">0.451</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><italic>PocketFinder<sup>+</sup></italic></td>
<td align="left" colspan="1" rowspan="1">0.494</td>
<td align="left" colspan="1" rowspan="1">0.399</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><italic>Surfnet<sup>+</sup></italic></td>
<td align="left" colspan="1" rowspan="1">0.430</td>
<td align="left" colspan="1" rowspan="1">0.370</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><italic>Conservation</italic></td>
<td align="left" colspan="1" rowspan="1">0.318</td>
<td align="left" colspan="1" rowspan="1">0.216</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><italic>Random</italic></td>
<td align="left" colspan="1" rowspan="1">0.104</td>
<td align="left" colspan="1" rowspan="1">0.123</td>
</tr>
</tbody>
</table></alternatives><table-wrap-foot><fn id="nt103"><label/><p>All methods are better at identifying binding residues in enzymes than in non-enzymes. The <italic>ConCavity</italic> methods achieve the best performance on both datasets, but incorporating conservation information provides less improvement in non-enzymes.</p></fn></table-wrap-foot></table-wrap>
<p>Despite the drop in performance on non-enzyme proteins, the main conclusions from the earlier sections still hold. However, the improvement provided by <italic>ConCavity</italic> is not as great on the non-enzymes. This could be the result of the more complex patterns of conservation found in non-enzyme proteins, and the comparatively poor performance of <italic>Conservation</italic> in this setting. It is also possible that <italic>Ligsite<sup>+</sup></italic>'s approach is particularly well suited to identifying binding sites in non-enzymes. Overall, these results highlight the importance of using a diverse dataset to evaluate functional site predictions.</p>
</sec><sec id="s2i">
<title><italic>ConCavity</italic> improves identification of drug binding sites</title>
<p>Knowledge of small molecule binding sites is of considerable use in drug discovery and design. Many of the techniques used to screen potential targets, e.g., docking and virtual screening, are computationally intensive and feasible only when focused on a specific region of the protein surface. Structure based surface cavity identification algorithms can guide analysis in such situations <xref ref-type="bibr" rid="pcbi.1000585-Nayal1">[52]</xref>.</p>
<p>To test <italic>ConCavity</italic>'s ability to identify drug binding sites, we evaluated it on a set of 98 protein-drug complexes <xref ref-type="bibr" rid="pcbi.1000585-Perola1">[62]</xref>. The superior performance provided by <italic>ConCavity</italic> over <italic>Structure</italic> on the diverse set of proteins considered above suggests that <italic>ConCavity</italic> would likely be useful in the drug screening pipeline. <xref ref-type="table" rid="pcbi-1000585-t004">Table 4</xref> compares the ligand overlap PR-AUC and Jaccard coefficient for the three versions of <italic>ConCavity</italic> and their structure-based analogs. Each <italic>ConCavity</italic> method significantly improves on the methods that only consider structural features (e.g., p = 1.25e−6 on overlap PR-AUC and p = 2.06e−6 on Jaccard for <italic>ConCavity<sup>L</sup></italic>). While the improvement is not quite as large on this dataset as that seen on the more diverse LigASite dataset, it is still significant. It is possible that this is due to the fact that drug compounds are not the proteins' natural ligands; the evolutionary conservation of the residues in binding pockets may reflect the pressures related to binding the actual ligands rather than the drugs.</p>
<table-wrap id="pcbi-1000585-t004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000585.t004</object-id><label>Table 4</label><caption>
<title>Drug binding site identification.</title>
</caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1000585-t004-4" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000585.t004" xlink:type="simple"/><table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" colspan="1" rowspan="1">Method</td>
<td align="left" colspan="1" rowspan="1">Grid Value PR-AUC</td>
<td align="left" colspan="1" rowspan="1">Jaccard coefficient</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" colspan="1" rowspan="1"><italic>ConCavity<sup>L</sup></italic></td>
<td align="left" colspan="1" rowspan="1">0.271</td>
<td align="left" colspan="1" rowspan="1">0.240</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><italic>ConCavity<sup>P</sup></italic></td>
<td align="left" colspan="1" rowspan="1">0.263</td>
<td align="left" colspan="1" rowspan="1">0.222</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><italic>ConCavity<sup>S</sup></italic></td>
<td align="left" colspan="1" rowspan="1">0.278</td>
<td align="left" colspan="1" rowspan="1">0.236</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><italic>Ligsite<sup>+</sup></italic></td>
<td align="left" colspan="1" rowspan="1">0.217</td>
<td align="left" colspan="1" rowspan="1">0.207</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><italic>PocketFinder<sup>+</sup></italic></td>
<td align="left" colspan="1" rowspan="1">0.195</td>
<td align="left" colspan="1" rowspan="1">0.191</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><italic>Surfnet<sup>+</sup></italic></td>
<td align="left" colspan="1" rowspan="1">0.170</td>
<td align="left" colspan="1" rowspan="1">0.183</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><italic>Random</italic></td>
<td align="left" colspan="1" rowspan="1">0.006</td>
<td align="left" colspan="1" rowspan="1">N/A</td>
</tr>
</tbody>
</table></alternatives><table-wrap-foot><fn id="nt104"><label/><p>This table compares the average grid value precision-recall AUC and the average Jaccard coefficient of prediction-ligand overlap for <italic>ConCavity</italic> and methods based on structural analysis alone on a set of 98 protein-drug complexes. Integrating sequence conservation and structure-based pocket finding improves the identification of drug binding sites. <italic>Conservation</italic> is not included in this evaluation, because it does not make pocket-level predictions.</p></fn></table-wrap-foot></table-wrap></sec><sec id="s2j">
<title>Examples of difficult structures</title>
<p>While ConCavity signficantly outperforms previous approaches, its performance is not flawless. In <xref ref-type="fig" rid="pcbi-1000585-g007">Figure 7</xref>, we give three example structures that illustrate patterns observed when <italic>ConCavity</italic> performs poorly. Handling these cases is likely to be important for further improvements in ligand binding site prediction.</p>
<fig id="pcbi-1000585-g007" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000585.g007</object-id><label>Figure 7</label><caption>
<title>Examples of difficult structures.</title>
<p>For each structure, evolutionary sequence conservation has been mapped to the surface of the protein backbone (all atoms in pane (C)) with warmer colors indicating greater conservation. Bound ligands are shown in yellow, and the pocket predictions of <italic>ConCavity</italic> are represented by green meshes. (A) The ActR protein (PDB: 3B6A) contains both a ligand-binding (bottom half) and a more conserved DNA-binding domain (top half). (B) The ring-shaped pentameric B-subunit of a shiga-like toxin (PDB: 1CQF) binds globotriaosylceramide (Gb3) via a relatively flat interface that surrounds the center of the ring. (C) The carbohydrate binding sites of the CBM29 protein (PDB: 1GWL) are too long and flat to be detected by <italic>ConCavity</italic> in the presence of a concave pocket between the chains. As illustrated here, <italic>ConCavity</italic>'s inaccurate predictions are often the result of misleading evolutionary sequence conservation information (A) or ligands that bind partially or entirely outside of well-defined concave surface pockets (B, C). In (A) and (B), <italic>ConCavity</italic> misses the ligands, but identifies functionally relevant binding sites for other types of interactions (DNA and protein).</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000585.g007" xlink:type="simple"/></fig>
<p>The first pattern common among these difficult cases is evolutionary sequence conservation information leading predictions away from actual ligand binding sites. <xref ref-type="fig" rid="pcbi-1000585-g007">Figure 7A</xref> provides an example in which the ligand binding site is less conserved than other parts of the protein. The ActR protein from <italic>Streptomyces coelicolor</italic> (PDB: 3B6A) contains both a small molecule ligand-binding and a DNA-binding domain <xref ref-type="bibr" rid="pcbi.1000585-Willems1">[63]</xref>. The ligand-binding domain is in the bottom, less-conserved half of the structure. The DNA-binding domain is found in the more conserved top half of the given structure. The greater conservation of this domain causes <italic>ConCavity</italic> to focus on the DNA-binding site over the ligand binding site. In other cases, conservation information is uninformative due to a lack of homologous sequences. Conservation estimates based on low quality sequence alignments may harm performance for some structures, but we have found that they still provide a net performance gain overall (<xref ref-type="supplementary-material" rid="pcbi.1000585.s001">Text S1</xref>).</p>
<p><xref ref-type="fig" rid="pcbi-1000585-g007">Figure 7</xref> also provides two examples of another difficult case: ligands bound outside of clearly defined, concave surface pockets. In <xref ref-type="fig" rid="pcbi-1000585-g007">Figure 7B</xref>, <italic>ConCavity</italic> identifies the center of the ring-shaped structure of the pentameric B-subunit of a shiga-like toxin (PDB: 1CQF) as the binding site. This protein binds to glycolipids, like the globotriaosylceramide (Gb3) shown, via a relatively flat interface that surrounds the center of the ring <xref ref-type="bibr" rid="pcbi.1000585-Ling1">[64]</xref>. The center cavity (<italic>ConCavity</italic>'s prediction) is filled by a portion of the A-subunit of the toxin (not included in the structure) which after binding breaks off and enters the host cell. <xref ref-type="fig" rid="pcbi-1000585-g007">Figure 7C</xref> shows the structure of a dimeric noncatalytic carbohydrate binding module (CBM29) from <italic>Piromyces equi</italic> complexed with mannohexaose (PDB: 1GWL). The carbohydrate ligands bind in long flat clefts on the protein surface <xref ref-type="bibr" rid="pcbi.1000585-Charnock1">[65]</xref>. Even though these sites exhibit significant evolutionary conservation, their geometry prevents them from being predicted. Instead, a less conserved pocket formed between the chains is highlighted by <italic>ConCavity</italic>.</p>
<p>Overall, cases such as these are rare; <italic>ConCavity</italic>'s predictions fail to overlap a ligand in only 5% of structures. In addition, some of these “incorrect” predictions are actually functionally relevant binding sites for other types of interactions as illustrated in <xref ref-type="fig" rid="pcbi-1000585-g007">Figure 7</xref>.</p>
</sec><sec id="s2k">
<title>Integrating conservation and structure improves prediction of catalytic sites</title>
<p>Ligand-binding sites are not the only type of functional site of interest to biologists. A large amount of attention has been given to the problem of identifying catalytic sites. As noted above, the majority of enzyme active sites are found in large clefts on the protein surface, so even though the structural methods considered in this paper were not intended to identify catalytic sites, they could perform well at this task.</p>
<p><xref ref-type="table" rid="pcbi-1000585-t005">Table 5</xref> gives the results of an evaluation of the methods' ability to predict catalytic sites (defined by the Catalytic Site Atlas <xref ref-type="bibr" rid="pcbi.1000585-Porter1">[66]</xref>) in the LigASite apo dataset. Compared to ligand binding site prediction, the relative performance of the methods is different in this context. The <italic>ConCavity</italic> approach still significantly outperforms the others (p&lt;2.2e−16 for <italic>Structure</italic>, p = 8.223e−4 for <italic>Conservation</italic>). Most surprisingly, <italic>Conservation</italic> significantly outperforms methods based on structure alone (p = 9.863e−3 <italic>Ligsite<sup>+</sup></italic>, p = 4.694e−6 <italic>Pocketfinder<sup>+</sup></italic>, p = 1.171e−6 <italic>Surfnet<sup>+</sup></italic>). All the methods have lower PR-AUC when predicting catalytic sites than predicting ligand-binding residues (e.g., <italic>ConCavity<sup>L</sup></italic> has PR-AUC of 0.315 versus 0.608); this is due in large part to the considerably smaller number of catalytic residues than ligand-binding residues per protein sequences.</p>
<table-wrap id="pcbi-1000585-t005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000585.t005</object-id><label>Table 5</label><caption>
<title>Catalytic residue identification (LigASite apo).</title>
</caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1000585-t005-5" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000585.t005" xlink:type="simple"/><table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" colspan="1" rowspan="1">Method</td>
<td align="left" colspan="1" rowspan="1">PR-AUC</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" colspan="1" rowspan="1"><italic>ConCavity<sup>L</sup></italic></td>
<td align="left" colspan="1" rowspan="1">0.315</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><italic>ConCavity<sup>P</sup></italic></td>
<td align="left" colspan="1" rowspan="1">0.301</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><italic>ConCavity<sup>S</sup></italic></td>
<td align="left" colspan="1" rowspan="1">0.288</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><italic>Conservation</italic></td>
<td align="left" colspan="1" rowspan="1">0.249</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><italic>Ligsite<sup>+</sup></italic></td>
<td align="left" colspan="1" rowspan="1">0.190</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><italic>PocketFinder<sup>+</sup></italic></td>
<td align="left" colspan="1" rowspan="1">0.149</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><italic>Surfnet<sup>+</sup></italic></td>
<td align="left" colspan="1" rowspan="1">0.142</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><italic>Random</italic></td>
<td align="left" colspan="1" rowspan="1">0.012</td>
</tr>
</tbody>
</table></alternatives><table-wrap-foot><fn id="nt105"><label/><p><italic>ConCavity</italic> identifies more catalytic sites than other methods. However, in contrast to ligand binding residue prediction, <italic>Conservation</italic> outperforms the structure-based approaches at detecting catalytic sites.</p></fn></table-wrap-foot></table-wrap>
<p>These results imply that being very evolutionarily conserved is more indicative of a role in catalysis than being found in a surface pocket. Though catalytic sites are usually found in pockets near bound ligands, there are many fewer catalytic sites per protein than ligand-binding residues. As a result simply searching for residues in pockets identifies many non-catalytic residues. This is consistent with earlier machine learning studies that found conservation to be a dominant predictive feature <xref ref-type="bibr" rid="pcbi.1000585-Youn1">[5]</xref>,<xref ref-type="bibr" rid="pcbi.1000585-Gutteridge1">[49]</xref>,<xref ref-type="bibr" rid="pcbi.1000585-Petrova1">[50]</xref>, and it suggests that new structural patterns should be sought to improve the identification of catalytic sites.</p>
<p>Several previous methods have combined sequence conservation and structural properties in machine learning frameworks to predict catalytic sites <xref ref-type="bibr" rid="pcbi.1000585-Youn1">[5]</xref>,<xref ref-type="bibr" rid="pcbi.1000585-Petrova1">[50]</xref>,<xref ref-type="bibr" rid="pcbi.1000585-Tong1">[51]</xref>. Direct comparison with these methods is difficult because most datasets and algorithms are not readily available. Tong et al. <xref ref-type="bibr" rid="pcbi.1000585-Tong1">[51]</xref> compared the precision and recall of several machine learning methods on different datasets in an attempt to develop a qualitative understanding of their relative performance. While it is not prudent to draw conclusions based on cross-dataset comparisons, we note for completeness that <italic>ConCavity</italic>'s catalytic site predictions the diverse LigASite dataset achieve higher precision (23.8%) at full recall than the maximum precision (over all recall levels) reported for methods in their comparisons.</p>
</sec></sec><sec id="s3">
<title>Discussion</title>
<p>Evolutionary sequence conservation and protein 3D structures have commonly been used to identify functionally important sites; here, we integrate these two approaches in <italic>ConCavity</italic>, a new algorithm for ligand binding site prediction. By evaluating a range of conservation and structure-based prediction strategies on a large, diverse dataset of ligand binding sites, we establish that structural approaches generally outperform sequence conservation, and that by combining the two, <italic>ConCavity</italic> outperforms conservation-alone and structure-alone on about 95% and 70% of structures respectively. Overall, <italic>ConCavity</italic>'s first predicted residue contacts a ligand in nearly 80% of the apo structures examined, and it maintains high precision across all recall levels. These results hold for the three variants of <italic>ConCavity</italic> we considered, each of which uses a different underlying structure-based component. In addition, <italic>ConCavity</italic>'s integrated approach provides significant improvement over conservation and structure-based approaches on the common task of identifying drug binding sites.</p>
<p>Combining sequence conservation-based methods with structure information is especially powerful in the case of multi-meric proteins. Our analysis has shown that the performance of structural approaches for identifying ligand binding sites dramatically decreases as the number of chains in the structure increases; conservation alone outperforms structure-based approaches on proteins with five or more chains. It is difficult to determine from structural attributes alone if a pocket formed at a chain interface binds a ligand or not. However, ligand binding pockets usually exhibit high evolutionary sequence conservation. <italic>ConCavity</italic>, which takes advantage of this complementary information, performs very well on multi-chain proteins; the presence of many non-ligand binding pockets between chains has little effect on its performance.</p>
<p>While <italic>ConCavity</italic> outperforms previous approaches, we have found two main causes of poor results: misleading evolutionary sequence conservation information and ligands that bind partially or entirely outside of well-defined concave surface pockets. Ligand binding sites may lack strong conservation for a number of reasons: the underlying sequence alignment may be of low quality, there may be other more conserved functional regions in the protein, and some sites are hypervariable for functional reasons <xref ref-type="bibr" rid="pcbi.1000585-Magliery1">[67]</xref>. The alignment quality issue will become less relevant as sequence data coverage and conservation estimation methods improve. The second two cases may require the integration of additional features to better distinguish different types of functional sites. Similarly, finding biologically relevant ligands that bind outside of concave surface pockets will likely require the development of additional structural descriptors. Missing or incomplete ligands also affect the apparent performance of the methods, but such issues are unavoidable due to the nature of the structural data.</p>
<p>In implementing and evaluating previous 3D grid-based ligand binding site prediction approaches, we have found that the methods used both to aggregate grid values into coherent pockets as well as to map these pockets onto surface residues can have a large effect on performance. In order to focus on the improvement provided by considering evolutionary sequence conservation, the results for previous structure-based methods presented above use our new algorithms for these steps. We describe the details of our approaches in the <xref ref-type="sec" rid="s4">Methods</xref> section. On a high level, the new methodologies we propose provide significant improvement by predicting a flexible number of well-formed pockets for each structure and by assigning each residue a likelihood of binding a ligand based on its local environment rather than on the rank of the entire pocket. We have used morphological properties of ligands to guide pocket creation, but the most appropriate algorithms for these steps depend strongly on the nature of the prediction task. These steps have received considerably less attention than computing grid values; our results suggest that they should be given careful consideration in the future.</p>
<p>We have focused on the prediction of ligand binding sites, but the direct synthesis of conservation and structure information is likely to be beneficial for predicting other types of functionally important sites. Our application of <italic>ConCavity</italic> to catalytic site prediction illustrates the promise and challenges of such an approach. Catalytic sites are usually found in surface pockets, but considering structural evidence alone performs quite poorly---worse than sequence conservation. Combining structure with evolutionary conservation provides a modest gain in performance over conservation alone. Protein-protein interface residues are another appealing target for prediction; much can be learned about a protein by characterizing its interactions with other proteins. However, protein-protein interaction sites provide additional challenges; they are usually large, flat, and often poorly conserved <xref ref-type="bibr" rid="pcbi.1000585-Caffrey1">[68]</xref>. <italic>ConCavity</italic> is not appropriate for this task. Other types of functional sites also lack simple attributes that correlate strongly with functional importance. Analysis of these sites' geometries, physical properties, and functional roles will produce more accurate predictors, and may also lead to new insights about the general mechanisms by which proteins accomplish their molecular functions.</p>
<p>In summary, this article significantly advances the state-of-the-art in ligand binding site identification by improving the philosophy, methodology, and evaluation of prediction methods. It also increases our understanding of the relationship between evolutionary sequence conservation, structural attributes of proteins, and functional importance. By making our source code and predictions available online, we hope to establish a platform from which the prediction of functional sites and the integration of sequence and structure data can be investigated further.</p>
</sec><sec id="s4">
<title>Methods</title>
<sec id="s4a">
<title><italic>ConCavity</italic></title>
<p>This section describes the components of the <italic>ConCavity</italic> algorithm for predicting ligand binding residues from protein 3D structures and evolutionary sequence conservation.</p>
<p><italic>ConCavity</italic> proceeds in three conceptual steps: grid creation, pocket extraction, and residue mapping (<xref ref-type="fig" rid="pcbi-1000585-g008">Figure 8</xref>). First, the structural and evolutionary properties of a given protein are used to create a regular 3D grid surrounding the protein in which the score associated with each grid point represents an estimated likelihood that it overlaps a bound ligand atom (<xref ref-type="fig" rid="pcbi-1000585-g008">Figure 8A</xref>). Second, groups of contiguous, high-scoring grid points are clustered to extract pockets that adhere to given shape and size constraints (<xref ref-type="fig" rid="pcbi-1000585-g008">Figure 8B</xref>). Finally, every protein residue is scored with an estimate of how likely it is to bind to a ligand based on its proximity to extracted pockets (<xref ref-type="fig" rid="pcbi-1000585-g008">Figure 8C</xref>).</p>
<fig id="pcbi-1000585-g008" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000585.g008</object-id><label>Figure 8</label><caption>
<title><italic>ConCavity</italic> prediction pipeline.</title>
<p>The large gray shape represents a protein 3D structure; the triangles represent surface residues; and the gray gradient symbolizes the varying sequence conservation values in the protein. Darker shades of each color indicate higher values. (A) The initial grid values come from the combination of evolutionary sequence conservation information and a structural predictor, in this example <italic>Ligsite</italic>. The algorithm proceeds similarly for <italic>PocketFinder</italic> and <italic>Surfnet</italic>. (B) The grid generated in (A) is thresholded based on morphological criteria so that only well-formed pockets have non-zero values. For simplicity, only grid values near the pockets are shown. (C) Finally, the grid representing the pocket predictions is mapped to the surface of the protein. We perform a 3D Gaussian blur (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000585.e003" xlink:type="simple"/></inline-formula>) of the pockets, and assign each residue the highest overlapping grid value. Residues near regions of space with very high grid values receive the highest scores.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000585.g008" xlink:type="simple"/></fig>
<p>Grid-based strategies have been employed by several previous systems for ligand binding site prediction (e.g., <xref ref-type="bibr" rid="pcbi.1000585-Laskowski1">[14]</xref>,<xref ref-type="bibr" rid="pcbi.1000585-Hendlich1">[16]</xref>,<xref ref-type="bibr" rid="pcbi.1000585-An1">[23]</xref>). However, our adaptations to the three steps significantly affect the quality of predictions. First, we demonstrate how to integrate evolutionary information directly into the grid creation step for three different grid-based pocket prediction algorithms. Second, we introduce a method that employs mathematical morphology operators to extract well-shaped pockets from a grid. Third, we provide a robust method for mapping grid-based ligand binding predictions to protein residues based on Gaussian blurring. The details of these three methods and an evaluation of their impacts on ligand-binding predictions are described in the following subsections.</p>
<sec id="s4a1">
<title>Grid creation</title>
<p>The first step of our process is to construct a 3D regular grid covering the free-space surrounding a protein. The goal is to produce grid values that correlate with the likelihoods of finding a bound ligand at each grid point.</p>
<p>Several methods have been proposed to produce grids of this type. For example, <italic>Ligsite</italic> <xref ref-type="bibr" rid="pcbi.1000585-Hendlich1">[16]</xref> produces a grid with values between 0 and 7 by scanning for the protein surface along the three axes and the four cubic diagonals. For each grid point outside of the protein, the number of scans that hit the protein surface in both directions---so-called protein-solvent-protein (PSP) events---is the value given to that point. A large number of PSP events indicate that the grid point is surrounded by protein in many directions and thus likely to be in a pocket.</p>
<p><italic>Surfnet</italic> <xref ref-type="bibr" rid="pcbi.1000585-Laskowski1">[14]</xref> assigns values to the grid by constructing spheres that fill the space between pairs of protein atoms without overlapping any other atoms. These sets of spheres are constructed for all pairs of protein surface atoms within 10 Å of each other. Spheres with a radius smaller than 1.5 Å are ignored, and spheres are allowed to have a maximum radius of 4 Å. This procedure results in a set of overlapping spheres that fill cavities and clefts in the protein. Extending the original algorithm slightly, we assign the value for each grid point to be the number of spheres that overlap it (rather than simply one for overlap and zero for no overlap as in the original algorithm). Thus, higher values are generally associated with the positions in the “center” of a pocket.</p>
<p><italic>PocketFinder</italic> <xref ref-type="bibr" rid="pcbi.1000585-An1">[23]</xref> assigns values to grid points by calculating the van der Waals interaction potential of an atomic probe with the protein. The Lennard-Jones function is used to estimate the interaction potential between the protein and a carbon atom placed at each grid point. The potential at a grid point <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000585.e004" xlink:type="simple"/></inline-formula> is: <disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000585.e005" xlink:type="simple"/><label>(1)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000585.e006" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000585.e007" xlink:type="simple"/></inline-formula> are constants (taken from AutoDock <xref ref-type="bibr" rid="pcbi.1000585-Morris1">[69]</xref>) that shape the Lennard-Jones function according to the interaction energy between the carbon probe atom and protein atom <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000585.e008" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000585.e009" xlink:type="simple"/></inline-formula> is the distance between the grid point <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000585.e010" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000585.e011" xlink:type="simple"/></inline-formula> (interactions over distances greater than 10 Å are ignored).</p>
<p>Other grid creation methods have been proposed as well, but these three (<italic>Ligsite</italic>, <italic>Surfnet</italic>, and <italic>PocketFinder</italic>) provide a representative set for our study.</p>
<p>We augment these algorithms by integrating evolutionary information into the grid creation process. Our methodology is based on the observation that these (and other) grid creation algorithms operate by accumulating evidence (“votes”) for ligand binding at grid points according to spatial relationships to nearby protein atoms. For <italic>PocketFinder</italic>, each protein atom casts a “vote” for nearby grid points with magnitude equal to the (opposite of the) van der Waals potential. In <italic>Ligsite</italic>, every pair of protein atoms “votes” for solvent-accessible grid points on line segments between them. In our implementation of <italic>Surfnet</italic>, pairs of atoms “vote” for all the grid points overlapping a sphere covering the solvent accessible region between them.</p>
<p>Based on this observation, we weight the “votes” as the grid is created by an estimate of sequence conservation of the residue(s) associated with the atom(s) that generate the votes. We tested several schemes for scaling votes. If <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000585.e012" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000585.e013" xlink:type="simple"/></inline-formula> are estimated conservation scores associated with the relevant atoms (e.g., derived from their residues' conservation in multiple sequence alignments), we scaled the structure-based component by the product (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000585.e014" xlink:type="simple"/></inline-formula>), the arithmetic mean (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000585.e015" xlink:type="simple"/></inline-formula>), the geometric mean (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000585.e016" xlink:type="simple"/></inline-formula>), the product of exponentials (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000585.e017" xlink:type="simple"/></inline-formula>), and the product of exponentials of transformed conservation values (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000585.e018" xlink:type="simple"/></inline-formula>). Each of these schemes provides improvement for all methods, but due to method specific differences, no single weighting scheme is best for all methods. Specifically, for <italic>PocketFinder</italic>, which has only one atom associated with each vote, we scale the vote (van der Waal's potential) of each atom linearly by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000585.e019" xlink:type="simple"/></inline-formula>. For <italic>Ligsite</italic> we scale the votes by arithmetic mean of the conservation values and for <italic>Surfnet</italic> by the product of the exponentials of the transformed conservation values.</p>
<p>In our study, conservation scores are calculated by the Jensen-Shannon divergence (JSD) with sequence weighting and a gap penalty <xref ref-type="bibr" rid="pcbi.1000585-Capra1">[2]</xref>; however, any sequence conservation measure that produces residue scores (which are then mapped to atoms within the residues) could be incorporated.</p>
<p><italic>Performance</italic>. The superior performance of our <italic>ConCavity</italic> grid creation method at predicting ligand binding pockets and residues is demonstrated in <xref ref-type="fig" rid="pcbi-1000585-g005">Figure 5</xref> of the <xref ref-type="sec" rid="s2">Results</xref> section. The only difference between the <italic>ConCavity</italic> methods (<italic>ConCavity<sup>L</sup></italic>, <italic>ConCavity<sup>S</sup></italic>, <italic>ConCavity<sup>P</sup></italic>) and their counterparts based on structure alone (<italic>Ligsite<sup>+</sup></italic>, <italic>Surfnet<sup>+</sup></italic>, <italic>PocketFinder<sup>+</sup>)</italic> is the use of sequence conservation in the grid creation step. For each grid creation strategy, considering evolutionary conservation yields significant improvement.</p>
</sec><sec id="s4a2">
<title>Pocket extraction</title>
<p>The second step of our process is to cluster groups of contiguous, high-scoring grid points into <italic>pockets</italic> that most likely contain bound ligands.</p>
<p>Several methods have been previously proposed to address this problem. The simplest is to apply a fixed threshold to the grid, i.e., eliminate all grid points below some given value. Then, the remaining grid points can be clustered into pockets (e.g., connected components), and small pockets can be discarded. This method, which we call “<italic>Threshold</italic>”, has been used in previous versions of <italic>Ligsite</italic> <xref ref-type="bibr" rid="pcbi.1000585-Huang1">[1]</xref>,<xref ref-type="bibr" rid="pcbi.1000585-Hendlich1">[16]</xref>. A problem with this approach is that the threshold is set to the same value for all proteins, which provides no control over the total number and size of pockets predicted by the algorithm. In the worst case, when every grid value is below the threshold, then the algorithm will predict no pockets. On the other hand, if the threshold is too low, then there will be many large pockets. Different proteins have different types of pockets, so no one threshold can extract appropriately sized and shaped pockets for all of them.</p>
<p>A slightly more adaptive method is used in <italic>PocketFinder</italic> <xref ref-type="bibr" rid="pcbi.1000585-An1">[23]</xref>. In “<italic>StdDev</italic>” the mean and standard deviation of values in the grid are used to determine a different threshold for every protein. Specifically, the grid is blurred with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000585.e020" xlink:type="simple"/></inline-formula>, and then the threshold is set to be 4.6 standard deviations above the mean of the grid values. This approach is problematic because the threshold depends on the parameters of the grid; any change to how the protein is embedded in the grid (e.g., orienting the protein differently, changing the distance between the protein and the grid boundary, etc.) will affect the mean and standard deviation of the grid values, which in turn will affect the threshold chosen to extract pockets. For example, simply making the extent of the grid 10% greater will include a large number of near-zero values in the grid, which will bring the threshold down and make the extracted pockets larger. Also, no control is provided over the number and size of pockets; it is possible that for some proteins no grid values are 4.6 standard deviations above the mean, in which case no pockets will be predicted.</p>
<p>It is difficult to control the number, sizes, and shapes of extracted pockets with <italic>Threshold</italic> and <italic>StdDev</italic>. In both methods a threshold is applied to every grid point independently and clusters are formed only on the basis of geometric proximity between grid points, so it is possible to extract a set of pockets that have biologically implausible shapes. For example, there is no way to guarantee that the algorithm won't extract one very large pocket that covers a significant fraction of the protein surface, or many small pockets distributed across the protein surface, and/or pockets that contain long, thin regions where the cross-sectional diameter is too small to fit a bound ligand. Of course, it is possible to trim/discard such pockets after they have been extracted according to geometric criteria using post-processing algorithms <xref ref-type="bibr" rid="pcbi.1000585-Huang1">[1]</xref>,<xref ref-type="bibr" rid="pcbi.1000585-An1">[23]</xref>,<xref ref-type="bibr" rid="pcbi.1000585-Glaser1">[56]</xref>. However, unless there is feedback between the method used to select a grid threshold and the method used to cull pockets, then there is no way to guarantee that a biologicaly plausible set of pockets is output, i.e., it is possible that none of the pockets extracted with the chosen grid threshold meet the culling criteria.</p>
<p>In <italic>ConCavity</italic>, we integrate extraction and culling of pockets into a single framework. We perform a binary search for the grid threshold that produces a culled set of pockets that have specified properties (maximum number of pockets, total volume of all pockets, minimum volume for any pocket, minimum cross-sectional radius for any pocket, and maximum distance from protein surface). Specifically, for each step of the binary search, we select a grid threshold, extract a set of pockets (connected components of grid points having values above the threshold), and then apply a sequence of culling algorithms to trim/discard pockets based their sizes and shapes. The algorithm iterates, adjusting the threshold up or down, if the set of pockets resulting from the culling operations does not meet the specified global properties. The binary search terminates when it has found a set of pockets meeting all of the specified properties or determines that none is possible. We call this method “<italic>Search</italic>”.</p>
<p>Specifically, the culling steps are implemented with a series of grid-based filters, each of which runs in compute time that grows linearly with the size of the grid. Given a current guess for the grid threshold, the first filter simply zeroes all grid points whose value is below the threshold value.</p>
<p>The second filter zeroes grid points whose distance from the van der Waal's surface of the protein exceeds a given threshold, <italic>max_protein_offset</italic>. This filter is computed by first rasterizing a sphere for all atoms of the protein into a grid, setting every grid point within the van der Waal's radius of any protein atom to one and the others to zero. Then, the square of the distance from each grid point to the closest point on the van der Waal's surface is computed with three linear-time sweeps, and the resulting squared distances are used to zero grid points of the original grid if the squared distance is greater than <italic>max_protein_offset</italic><sup>2</sup>.</p>
<p>The third filter ensures that no part of a pocket has cross-sectional radius less than a given threshold, <italic>min_pocket_radius</italic>. This filter is implemented with an “opening” operator from mathematical morphology. Intuitively, the boundary of every pocket (non-zero values of the grid) is “eroded” by <italic>min_pocket_radius</italic> and then “dilated” by the same amount, causing regions with cross-sectional radius less than the threshold to be removed, while the others are unchanged. This operator is implemented with two computations of the squared distances from pocket boundaries, each of which takes linear time in the size of the grid.</p>
<p>The fourth filter constructs connected components of the grid and then zeros out grid points within components whose volume is less than a given threshold, <italic>min_pocket_volume</italic>. Connected components are computed with a series of depth-first traversals of neighboring non-zero grid points, which take linear time all together, and pockets are sorted by volume using quicksort, which takes <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000585.e021" xlink:type="simple"/></inline-formula> time for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000585.e022" xlink:type="simple"/></inline-formula> pockets.</p>
<p>After these filters are executed for each iteration, the total volume of all remaining pockets is computed and compared to a given target volume, <italic>total_pocket_volume</italic>. If the total volume is greater (less) than the target, the grid threshold is increased (decreased) to a value half-way between the current threshold and the maximum (minimum) possible threshold---initially the largest (smallest) value in the grid---and the minimum (maximum) is set to the current threshold. The process is repeated with the new threshold until the total volume of all pockets is within <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000585.e023" xlink:type="simple"/></inline-formula> of the given <italic>total_pocket_volume</italic>. Note that we perform a 1 Å Gaussian blur on the <italic>Ligsite</italic> grid before beginning this search to provide finer control over the predicted pockets than is provided by the <italic>Ligsite</italic> integer grid values.</p>
<p>We set the parameters for these filters empirically. In previous studies, it has been observed that the vast majority of bound ligand atoms reside within 5 Å of the protein's van der Waal's surface, thus we set <italic>max_protein_offset</italic> to 5 Å. In order to target binding sites for biologically relevant ligands, we set <italic>min_pocket_radius</italic> to 1 Å and <italic>min_pocket_volume</italic> to 100 Å<sup>3</sup>. Based on the observation that the total volume of all bound ligands is roughly proportional to the total volume of the protein <xref ref-type="bibr" rid="pcbi.1000585-Liang1">[17]</xref>, we set <italic>total_pocket_volume</italic> to a given fraction of the total protein volume---2% in our studies (<xref ref-type="supplementary-material" rid="pcbi.1000585.s001">Text S1</xref>). Finally, we set the grid resolution to 1 Å and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000585.e024" xlink:type="simple"/></inline-formula> to 1 Å<sup>3</sup>.</p>
<p><italic>Performance</italic>. To assess the impact of different pocket extraction strategies on the precison and accuracy of binding site detection, we implemented several alternative methods and compared how well the pockets they predict overlap with ligands in holo structures from the LigASite dataset. <xref ref-type="table" rid="pcbi-1000585-t006">Table 6</xref> shows the results of several pocket extraction algorithms (second column) on three different grids types (first column). In addition to <italic>Thresh</italic> and <italic>StdDev</italic>, <italic>Largest(N)</italic> refers to zeroing all grid entries not in the largest N pockets (connected components).</p>
<table-wrap id="pcbi-1000585-t006" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000585.t006</object-id><label>Table 6</label><caption>
<title>Comparison of pocket extraction methods.</title>
</caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1000585-t006-6" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000585.t006" xlink:type="simple"/><table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" colspan="1" rowspan="1">Grid Generation</td>
<td align="left" colspan="1" rowspan="1">Pocket Extraction</td>
<td align="left" colspan="1" rowspan="1">Prediction Vol. (Å<sup>3</sup>)</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000585.e025" xlink:type="simple"/></inline-formula> w/Lig. (Å<sup>3</sup>)</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000585.e026" xlink:type="simple"/></inline-formula> w/Lig. (Å<sup>3</sup>)</td>
<td align="left" colspan="1" rowspan="1">Prediction/Ligand</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000585.e027" xlink:type="simple"/></inline-formula>/Prediction</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000585.e028" xlink:type="simple"/></inline-formula>/Ligand</td>
<td align="left" colspan="1" rowspan="1">Jaccard coeff.</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" colspan="1" rowspan="1">Ligsite<sup>+</sup></td>
<td align="left" colspan="1" rowspan="1">Thresh(6)</td>
<td align="left" colspan="1" rowspan="1">9385.9</td>
<td align="left" colspan="1" rowspan="1">767.3</td>
<td align="left" colspan="1" rowspan="1">10595.8</td>
<td align="left" colspan="1" rowspan="1">4.577</td>
<td align="left" colspan="1" rowspan="1">0.106</td>
<td align="left" colspan="1" rowspan="1">0.360</td>
<td align="left" colspan="1" rowspan="1">0.085</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">Ligsite<sup>+</sup></td>
<td align="left" colspan="1" rowspan="1">Thresh(6), Largest(3)</td>
<td align="left" colspan="1" rowspan="1">5919.7</td>
<td align="left" colspan="1" rowspan="1">674.8</td>
<td align="left" colspan="1" rowspan="1">7222.1</td>
<td align="left" colspan="1" rowspan="1">2.281</td>
<td align="left" colspan="1" rowspan="1">0.200</td>
<td align="left" colspan="1" rowspan="1">0.322</td>
<td align="left" colspan="1" rowspan="1">0.129</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">Ligsite<sup>+</sup></td>
<td align="left" colspan="1" rowspan="1">Search</td>
<td align="left" colspan="1" rowspan="1">1806.8</td>
<td align="left" colspan="1" rowspan="1">426.9</td>
<td align="left" colspan="1" rowspan="1">3357.1</td>
<td align="left" colspan="1" rowspan="1">1.250</td>
<td align="left" colspan="1" rowspan="1">0.332</td>
<td align="left" colspan="1" rowspan="1">0.338</td>
<td align="left" colspan="1" rowspan="1"><bold>0.197</bold></td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">Surfnet<sup>+</sup></td>
<td align="left" colspan="1" rowspan="1">-</td>
<td align="left" colspan="1" rowspan="1">44242.4</td>
<td align="left" colspan="1" rowspan="1">1729.3</td>
<td align="left" colspan="1" rowspan="1">44490.3</td>
<td align="left" colspan="1" rowspan="1">29.003</td>
<td align="left" colspan="1" rowspan="1">0.045</td>
<td align="left" colspan="1" rowspan="1">0.896</td>
<td align="left" colspan="1" rowspan="1">0.044</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">Surfnet<sup>+</sup></td>
<td align="left" colspan="1" rowspan="1">Search</td>
<td align="left" colspan="1" rowspan="1">1766.3</td>
<td align="left" colspan="1" rowspan="1">426.3</td>
<td align="left" colspan="1" rowspan="1">3317.2</td>
<td align="left" colspan="1" rowspan="1">1.218</td>
<td align="left" colspan="1" rowspan="1">0.300</td>
<td align="left" colspan="1" rowspan="1">0.287</td>
<td align="left" colspan="1" rowspan="1"><bold>0.166</bold></td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">Pocketfinder<sup>+</sup></td>
<td align="left" colspan="1" rowspan="1">StdDev(<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000585.e029" xlink:type="simple"/></inline-formula>)</td>
<td align="left" colspan="1" rowspan="1">69477.5</td>
<td align="left" colspan="1" rowspan="1">1742.1</td>
<td align="left" colspan="1" rowspan="1">69712.6</td>
<td align="left" colspan="1" rowspan="1">49.250</td>
<td align="left" colspan="1" rowspan="1">0.028</td>
<td align="left" colspan="1" rowspan="1">0.900</td>
<td align="left" colspan="1" rowspan="1">0.028</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">Pocketfinder<sup>+</sup></td>
<td align="left" colspan="1" rowspan="1">StdDev(<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000585.e030" xlink:type="simple"/></inline-formula>)</td>
<td align="left" colspan="1" rowspan="1">18317.1</td>
<td align="left" colspan="1" rowspan="1">1218.4</td>
<td align="left" colspan="1" rowspan="1">19075.9</td>
<td align="left" colspan="1" rowspan="1">12.026</td>
<td align="left" colspan="1" rowspan="1">0.094</td>
<td align="left" colspan="1" rowspan="1">0.652</td>
<td align="left" colspan="1" rowspan="1">0.085</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">Pocketfinder<sup>+</sup></td>
<td align="left" colspan="1" rowspan="1">StdDev(<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000585.e031" xlink:type="simple"/></inline-formula>)</td>
<td align="left" colspan="1" rowspan="1">8303.7</td>
<td align="left" colspan="1" rowspan="1">896.4</td>
<td align="left" colspan="1" rowspan="1">9384.4</td>
<td align="left" colspan="1" rowspan="1">5.117</td>
<td align="left" colspan="1" rowspan="1">0.170</td>
<td align="left" colspan="1" rowspan="1">0.489</td>
<td align="left" colspan="1" rowspan="1">0.130</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">Pocketfinder<sup>+</sup></td>
<td align="left" colspan="1" rowspan="1">StdDev(<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000585.e032" xlink:type="simple"/></inline-formula>)</td>
<td align="left" colspan="1" rowspan="1">3703.0</td>
<td align="left" colspan="1" rowspan="1">591.3</td>
<td align="left" colspan="1" rowspan="1">5088.8</td>
<td align="left" colspan="1" rowspan="1">2.150</td>
<td align="left" colspan="1" rowspan="1">0.270</td>
<td align="left" colspan="1" rowspan="1">0.326</td>
<td align="left" colspan="1" rowspan="1">0.148</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">Pocketfinder<sup>+</sup></td>
<td align="left" colspan="1" rowspan="1">Search</td>
<td align="left" colspan="1" rowspan="1">1807.0</td>
<td align="left" colspan="1" rowspan="1">436.0</td>
<td align="left" colspan="1" rowspan="1">3348.2</td>
<td align="left" colspan="1" rowspan="1">1.250</td>
<td align="left" colspan="1" rowspan="1">0.303</td>
<td align="left" colspan="1" rowspan="1">0.292</td>
<td align="left" colspan="1" rowspan="1"><bold>0.167</bold></td>
</tr>
</tbody>
</table></alternatives><table-wrap-foot><fn id="nt106"><label/><p>For three types of grids (first column), we ran different pocket extraction algorithms (second column) and compared how well the pockets overlap bound ligands in holo PQS structures. The third column (“Prediction Vol.”) lists the average volume of all predicted pockets over each protein. For reference, the average volume of all ligands observed in the PQS files (“Ligand”) is 1977.2 Å<sup>3</sup>. The next two columns list the average volumes of the Intersection (Ligand <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000585.e033" xlink:type="simple"/></inline-formula> Prediction) and Union (Ligand <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000585.e034" xlink:type="simple"/></inline-formula> Prediction) of the Prediction and Ligand grids. Finally, the rightmost four columns list the average over-prediction factor (Prediction/Ligand), precision (Intersection/Prediction), recall (Intersection/Ligand), and Jaccard coefficient (Intersection/Union). For the last three columns, values range between zero and one, and higher values represent better performance. Comparing the average volume of the pockets predicted by each method, we see that <italic>Search</italic>'s pockets are closest to the actual ligand volumes. Moreover, <italic>Search</italic>'s high Jaccard coefficient for each grid type indicates that it provides the best tradeoff between recall and precision among the methods tested.</p></fn></table-wrap-foot></table-wrap>
<p>The statistics presented in <xref ref-type="table" rid="pcbi-1000585-t006">Table 6</xref> reflect various attributes of the pockets predicted by each extraction technique. The Jaccard coefficient (Intersection/Union) ranges between zero and one and takes into account the natural tradeoff between recall and precision by rewarding predictions that overlap the known ligands (large Intersection) and penalizing methods that predict very large pockets (large Union). Thus, it is a suitable measure for comparing the overall performance of the pocket extraction methods. For example, though the pockets of <italic>PocketFinder<sup>+</sup></italic> with the <italic>StdDev</italic> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000585.e035" xlink:type="simple"/></inline-formula>) extraction method have very high recall (0.900), its Jaccard coefficient is very low, because the predicted pockets have a very large average volume (49x more than the ligands). For each grid type, our <italic>Search</italic> pocket extraction method predicts pockets with volumes close to the actual ligand volume and obtains the best Jaccard coefficient. As a result, we use <italic>Search</italic> in <italic>ConCavity</italic> and our implementations of previous grid based methods.</p>
</sec><sec id="s4a3">
<title>Residue mapping</title>
<p>The third step of our pipeline uses the extracted set of pockets to generate ligand-binding predictions for residues. Our goal is to score every residue based on its relationship to the extracted pockets such that residues with higher scores are more likely to bind ligands. This goal is more ambitious than that of previous residue mapping approaches which have sought only to identify the residues associated with predicted pockets.</p>
<p>Perhaps the simplest and most common previous method is to mark all residues within some distance threshold, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000585.e036" xlink:type="simple"/></inline-formula>, of any pocket as binding (e.g., score  = 1) and the rest as not binding (e.g., score  = 0) <xref ref-type="bibr" rid="pcbi.1000585-Laurie1">[25]</xref>. We call this method “<italic>Dist-01</italic>.” Both the pocket surface and geometric center have been taken as the reference point previously; we use the pocket surface in <italic>Dist-01</italic>. This approach ignores all local information about the predicted pockets. Two related methods have incorporated attributes of predicted pockets into <italic>Dist-01</italic>. The first assigns residues near pockets scores that reflect the size of the closest pocket (“<italic>Dist-Size</italic>”) <xref ref-type="bibr" rid="pcbi.1000585-Huang1">[1]</xref>; residues near the largest pocket receive the highest score and so on. A similar approach uses the average conservation of all residues near the pocket (“<italic>Dist-Cons</italic>”) <xref ref-type="bibr" rid="pcbi.1000585-Huang1">[1]</xref> to rank the pockets and assign rank-based scores to residues.</p>
<p>In <italic>ConCavity</italic>, our goal is to assign scores to residues based on their likelihood of binding a ligand. We use the original grid values (which reflect the predicted likelihood of a ligand at every point in space) to weight the scores assigned to nearby residues. Starting with the grid values within the set of extracted pockets, we blur this grid with a Gaussian filter (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000585.e037" xlink:type="simple"/></inline-formula>), and then assign to every residue the maximum grid value evaluated at the location of any of its atoms. This method, which we call “<italic>Blur</italic>,” assigns residues in the same pocket different scores, since some residues are in the middle of a binding site, next to the part of a pocket with highest grid values, while others are at the fringe of a site, near marginal grid values. The score assigned by <italic>Blur</italic> reflects these differences in the likelihood that an individual residue is ligand binding.</p>
<p>In contrast to <italic>Blur</italic>, none of the previous residue extraction methods give different scores to residues in the same pocket. For comparison, we developed a version of the <italic>Dist</italic> strategy that (like <italic>Blur)</italic> considers the original grid values. <italic>Dist-Raw</italic> simply assigns to each residue within <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000585.e038" xlink:type="simple"/></inline-formula> of a pocket, the value of the nearest pocket grid point.</p>
<p><italic>Performance</italic>. We analyze the performance of these residue mapping approaches by comparing their PR-AUC on the task of predicting ligand binding residues as defined in the LigASite apo dataset. In each case we start with the same grid of extracted pockets and apply a different residue mapping algorithm. We consider all residue mapping strategies on three different pocket grids: <italic>ConCavity<sup>L</sup></italic>, <italic>ConCavity<sup>S</sup></italic>, and <italic>ConCavity<sup>P</sup></italic>. For all <italic>Dist</italic> approaches, we set <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000585.e039" xlink:type="simple"/></inline-formula> to 5 Å, and for <italic>Dist-Cons</italic> we consider the conservation of all residues within 8 Å of the pocket (as in <xref ref-type="bibr" rid="pcbi.1000585-Huang1">[1]</xref>).</p>
<p>The results presented in <xref ref-type="table" rid="pcbi-1000585-t007">Table 7</xref> demonstrate that <italic>Blur</italic> provides better performance for each grid type than all versions of previous residue mapping approaches. Thus, we use <italic>Blur</italic> in <italic>ConCavity</italic> and our implementations of previous ligand binding site prediction algorithms. The two methods that assign residues scores based on the values of nearby grid points (<italic>Blur</italic> and <italic>Dist-Raw)</italic> provide better performance in each case than those that assign all residues in a pocket the same score based on a global property of the pocket (<italic>Dist-Size</italic> and <italic>Dist-Cons)</italic>. This suggests that the local environment around residues should be considered when predicting binding sites.</p>
<table-wrap id="pcbi-1000585-t007" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000585.t007</object-id><label>Table 7</label><caption>
<title>Comparison of residue mapping strategies.</title>
</caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1000585-t007-7" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000585.t007" xlink:type="simple"/><table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="center" colspan="3" rowspan="1">Pocket Grid Source</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">Mapping Method</td>
<td align="left" colspan="1" rowspan="1"><italic>ConCavity<sup>L</sup></italic></td>
<td align="left" colspan="1" rowspan="1"><italic>ConCavity<sup>P</sup></italic></td>
<td align="left" colspan="1" rowspan="1"><italic>ConCavity<sup>S</sup></italic></td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" colspan="1" rowspan="1"><italic>Blur</italic></td>
<td align="left" colspan="1" rowspan="1"><bold>0.608</bold></td>
<td align="left" colspan="1" rowspan="1"><bold>0.602</bold></td>
<td align="left" colspan="1" rowspan="1"><bold>0.587</bold></td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><italic>Dist-Raw</italic></td>
<td align="left" colspan="1" rowspan="1">0.477</td>
<td align="left" colspan="1" rowspan="1">0.553</td>
<td align="left" colspan="1" rowspan="1">0.509</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><italic>Dist-Size</italic></td>
<td align="left" colspan="1" rowspan="1">0.442</td>
<td align="left" colspan="1" rowspan="1">0.486</td>
<td align="left" colspan="1" rowspan="1">0.474</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><italic>Dist-Cons</italic></td>
<td align="left" colspan="1" rowspan="1">0.426</td>
<td align="left" colspan="1" rowspan="1">0.473</td>
<td align="left" colspan="1" rowspan="1">0.437</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><italic>Dist-01</italic></td>
<td align="left" colspan="1" rowspan="1">0.404</td>
<td align="left" colspan="1" rowspan="1">0.455</td>
<td align="left" colspan="1" rowspan="1">0.414</td>
</tr>
</tbody>
</table></alternatives><table-wrap-foot><fn id="nt107"><label/><p>We applied five residue mapping algorithms to three grids of predicted pockets (<italic>ConCavity<sup>L</sup></italic>, <italic>ConCavity<sup>P</sup></italic>, <italic>ConCavity<sup>S</sup></italic> ). This table lists the PR-AUC for identifying ligand binding residues in the LigASite apo dataset for each combination. Our <italic>Blur</italic> algorithm achieves the best performance for each grid type.</p></fn></table-wrap-foot></table-wrap></sec></sec><sec id="s4b">
<title>Previous methods</title>
<p>We have compared <italic>ConCavity</italic> to several methods for ligand binding site prediction. Many of these methods lack publicly accessible implementations, and those that are available output different representations of predicted pockets and residues. In this section, we describe of how we generate predictions for all previous methods considered in our evaluations. In some cases we have completely reimplemented strategies and in others we have post-processed the output of existing implementations. <xref ref-type="table" rid="pcbi-1000585-t008">Table 8</xref> provides a summary of these details. As mentioned earlier, a “+” appended to the method name indicates that it is (at least in part) our implementation, e.g., <italic>Ligsite<sup>+</sup></italic>.</p>
<table-wrap id="pcbi-1000585-t008" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000585.t008</object-id><label>Table 8</label><caption>
<title>Implementation Details of Evaluated Methods.</title>
</caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1000585-t008-8" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000585.t008" xlink:type="simple"/><table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="center" colspan="3" rowspan="1">Prediction Algorithm Steps</td>
<td align="left" colspan="1" rowspan="1"/>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">Name</td>
<td align="left" colspan="1" rowspan="1">Grid Creation</td>
<td align="left" colspan="1" rowspan="1">Pocket Extraction</td>
<td align="left" colspan="1" rowspan="1">Residue Mapping</td>
<td align="left" colspan="1" rowspan="1">Post-processing</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" colspan="1" rowspan="1"><italic>ConCavity<sup>L</sup></italic></td>
<td align="left" colspan="1" rowspan="1"><italic>Ligsite+Cons</italic></td>
<td align="left" colspan="1" rowspan="1"><italic>Search</italic></td>
<td align="left" colspan="1" rowspan="1"><italic>Blur</italic></td>
<td align="left" colspan="1" rowspan="1">-</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><italic>ConCavity<sup>P</sup></italic></td>
<td align="left" colspan="1" rowspan="1"><italic>PocketFinder+Cons</italic></td>
<td align="left" colspan="1" rowspan="1"><italic>Search</italic></td>
<td align="left" colspan="1" rowspan="1"><italic>Blur</italic></td>
<td align="left" colspan="1" rowspan="1">-</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><italic>ConCavity<sup>S</sup></italic></td>
<td align="left" colspan="1" rowspan="1"><italic>Surfnet+Cons</italic></td>
<td align="left" colspan="1" rowspan="1"><italic>Search</italic></td>
<td align="left" colspan="1" rowspan="1"><italic>Blur</italic></td>
<td align="left" colspan="1" rowspan="1">-</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><italic>Ligsite<sup>+</sup></italic></td>
<td align="left" colspan="1" rowspan="1"><italic>Ligsite</italic></td>
<td align="left" colspan="1" rowspan="1"><italic>Search</italic></td>
<td align="left" colspan="1" rowspan="1"><italic>Blur</italic></td>
<td align="left" colspan="1" rowspan="1">-</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><italic>PocketFinder<sup>+</sup></italic></td>
<td align="left" colspan="1" rowspan="1"><italic>PocketFinder</italic></td>
<td align="left" colspan="1" rowspan="1"><italic>Search</italic></td>
<td align="left" colspan="1" rowspan="1"><italic>Blur</italic></td>
<td align="left" colspan="1" rowspan="1">-</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><italic>Surfnet<sup>+</sup></italic></td>
<td align="left" colspan="1" rowspan="1"><italic>Surfnet</italic></td>
<td align="left" colspan="1" rowspan="1"><italic>Search</italic></td>
<td align="left" colspan="1" rowspan="1"><italic>Blur</italic></td>
<td align="left" colspan="1" rowspan="1">-</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><italic>LigsiteCS</italic></td>
<td align="left" colspan="3" rowspan="1"><ext-link ext-link-type="uri" xlink:href="http://gopubmed2.biotec.tu-dresden.de/pocket/" xlink:type="simple">http://gopubmed2.biotec.tu-dresden.de/pocket/</ext-link></td>
<td align="left" colspan="1" rowspan="1">Residues Ranked by Pocket Rank</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><italic>Q-SiteFinder</italic></td>
<td align="left" colspan="3" rowspan="1"><ext-link ext-link-type="uri" xlink:href="http://www.modelling.leeds.ac.uk/qsitefinder/" xlink:type="simple">http://www.modelling.leeds.ac.uk/qsitefinder/</ext-link></td>
<td align="left" colspan="1" rowspan="1"/>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><italic>CASTp</italic></td>
<td align="left" colspan="3" rowspan="1"><ext-link ext-link-type="uri" xlink:href="http://sts-fw.bioengr.uic.edu/castp/" xlink:type="simple">http://sts-fw.bioengr.uic.edu/castp/</ext-link></td>
<td align="left" colspan="1" rowspan="1"/>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><italic>LigsiteCSC<sup>+</sup></italic></td>
<td align="left" colspan="3" rowspan="1"><ext-link ext-link-type="uri" xlink:href="http://gopubmed2.biotec.tu-dresden.de/pocket/" xlink:type="simple">http://gopubmed2.biotec.tu-dresden.de/pocket/</ext-link></td>
<td align="left" colspan="1" rowspan="1">Residues Ranked by Pocket Conservation</td>
</tr>
</tbody>
</table></alternatives><table-wrap-foot><fn id="nt108"><label/><p>This table summarizes the details of each step of the ligand binding site prediction process for the methods we evaluate. The new <italic>ConCavity</italic> methods are based entirely on our code. We also developed new implementations (<italic>Ligsite<sup>+</sup></italic>, <italic>PocketFinder<sup>+</sup></italic>, and <italic>Surfnet<sup>+</sup>)</italic> of three previous methods. Predictions for the other previous methods were obtained from the listed publicly accessible web servers. These servers output sets of residues associated with predicted binding pockets. For inclusion in the residue prediction evaluation, the output of these servers was post-processed as specified. This step is not necessary for our methods, because <italic>Blur</italic> outputs ranked residue predictions. A “+” appended to the method name indicates that it is based (at least in part) on our code. Implementation details of each algorithm are given in the text, and code for our implementations is available online.</p></fn></table-wrap-foot></table-wrap><sec id="s4b1">
<title><italic>Ligsite<sup>+</sup>, Surfnet<sup>+</sup>, and Pocketfinder<sup>+</sup></italic></title>
<p>We developed new implementations of the <italic>Ligsite</italic>, <italic>Surfnet</italic>, and <italic>Pocketfinder</italic> methods for grid generation. This was necessary to allow us to fully integrate sequence conservation with these methods. However, it also enabled us to investigate the the effect of different pocket extraction and residue mapping algorithms on overall performance.</p>
<p>By default, we use <italic>Search</italic> to extract pockets and <italic>Blur</italic> to map to residues for <italic>Ligsite<sup>+</sup></italic>, <italic>Surfnet<sup>+</sup></italic>, and <italic>Pocketfinder<sup>+</sup></italic>, because as was shown above, these approaches yield the best performance. Our implementations output representations of the predicted ligand binding pockets and ranked lists of contacting residues, so they can be included in both pocket and residue-based evaluations.</p>
</sec><sec id="s4b2">
<title><italic>LigsiteCS, Q-SiteFinder, and CASTp</italic></title>
<p>For our experiments, we generate binding site predictions using three publicly available web servers: <italic>LigsiteCS</italic> <xref ref-type="bibr" rid="pcbi.1000585-Huang1">[1]</xref>, <italic>QSiteFinder</italic> <xref ref-type="bibr" rid="pcbi.1000585-Laurie1">[25]</xref>, and <italic>CASTp</italic> <xref ref-type="bibr" rid="pcbi.1000585-Dundas1">[19]</xref>. Each of these servers produces a list of predicted pockets represented by sets of residues. In each case, the residues do not have scores associated with them. Thus to include these methods in the ligand binding residue prediction evaluation, we must assign scores to the residues. We tried two approaches. The first assigns all predicted residues a score of one and all others a score of zero. The second ranks the residues by the highest ranking pocket to which they are assigned, i.e., all residues from the first predicted pocket are given a higher score than those from the second and so on. These approaches are similar to the residue mapping algorithms discussed in the <italic>ConCavity</italic> section above; however, those exact algorithms could not be applied here because the web servers do not provide representations of the full extent of predicted pockets. We found that residue ranking produces better results (data not shown), so we use this approach. We consider the default number of pockets predicted by each method: <italic>LigsiteCS</italic> returns three pockets; <italic>Q-SiteFinder</italic> returns ten pockets; and <italic>CASTp</italic> returns a variable number. The <italic>Q-SiteFinder</italic> web server would not accept proteins with more than 10,000 atoms.</p>
<p><italic>LigsiteCS</italic>, <italic>Q-SiteFinder</italic>, and <italic>CASTp</italic> do not provide a representation of each predicted pocket's full extent, so they could not be included in the ligand location prediction evaluation.</p>
</sec><sec id="s4b3">
<title><italic>LigsiteCSC<sup>+</sup></italic></title>
<p>The <italic>LigsiteCSC</italic> method is an extension of <italic>LigsiteCS</italic> that uses the evolutionary sequence conservation of residues surrounding predicted pockets to reorder the pocket predictions. This feature on the <italic>LigsiteCS</italic> prediction server did not work for many PQS structures in our dataset, so we implemented our own version on top of the <italic>LigsiteCS</italic> results. For each pocket, we calculate the average conservation of all residues within 8 Å of the pocket center. The JSD method on the HSSP alignments is used to produce the conservation scores. The top three pockets in terms of size are then ranked in terms of average conservation. This implementation follows the published description of <italic>LigsiteCSC</italic>, except for the use of JSD for conservation instead of ConSurf.</p>
</sec><sec id="s4b4">
<title><italic>Jensen-Shannon Divergence</italic></title>
<p>The Jensen-Shannon divergence (JSD) is used to represent the performance of evolutionary sequence conservation; it was recently shown to provide state-of-the-art performance on a range of functional site prediction tasks <xref ref-type="bibr" rid="pcbi.1000585-Capra1">[2]</xref>. It compares the amino acid distribution observed in columns of a multiple sequence alignment of homologs to a background distribution. JSD scores range between zero and one. The code provided in Capra and Singh <xref ref-type="bibr" rid="pcbi.1000585-Capra1">[2]</xref> with the default sequence weighting and gap penalty was used to score all alignments.</p>
</sec></sec><sec id="s4c">
<title>Data</title>
<p>The prediction methods described in this paper take protein 3D structures and/or multiple sequence alignments as input. Protein structures were downloaded from the Protein Quaternary Structure (PQS) server <xref ref-type="bibr" rid="pcbi.1000585-Henrick1">[58]</xref>. Predicted quaternary structures were used (rather than the tertiary structures provided in PDB files) so as to consider pockets and protein-ligand contacts for proteins in their biologically active states. All alignments come from the Homology-derived Secondary Structure of Proteins (HSSP) database <xref ref-type="bibr" rid="pcbi.1000585-Dodge1">[70]</xref>. All images of 3D structures were rendered with PyMol <xref ref-type="bibr" rid="pcbi.1000585-DeLano1">[71]</xref>.</p>
<p>Ligand binding sites as defined by the non-redundant version of the LigASite dataset (v7.0) <xref ref-type="bibr" rid="pcbi.1000585-Dessailly1">[24]</xref> were used to evaluate method predictions. This set consists of 337 proteins with apo (unbound) structures, each having less than 25% sequence identity with any other protein in the set. Five of the 337 structures were left out of the evaluation: 1P5T, 1YJG, and 3DL3 lacked holo ligand information in the database, and 2PCY and 3EZM, because their corresponding holo structures are not in PQS or HSSP. Each apo structure has at least one associated holo (bound) structure in which biologically relevant ligands are identified in order to define ligand binding residues and map them to the apo structure. If multiple holo structures are available for the protein, the sets of contacting residues are combined to define the binding residues for the apo structure. We select the structures for our LigASite holo evaluation set by taking the holo structure with the most ligand contacting residues for each apo structure. The average number of holo structures for each apo structure is 2.58, and the maximum for any single structure is 32. The average chain length is 276 residues with a minimum of 59 and a maximum of 1023. The average number of positives---sites contacting a biologically relevant ligand---per chain is 25 residues (about 11% of the chain). The apo dataset includes many proteins with multiple chains; the average number of chains per protein is 2.22. The chain distribution is: 1 chain: 143, 2 chains: 112, 3 chains: 18, 4 chains: 35, 5 or more chains: 24.</p>
<p>The drug dataset comes from a set of 100 non-redundant 3D structures selected by <xref ref-type="bibr" rid="pcbi.1000585-Perola1">[62]</xref>. This set contains a diverse set of high-quality structures (resolution &lt;3 Å) with drug or drug-like molecules (molecular weight between 200 and 600, and 1−12 rotatable bonds) bound. Structure 1LY7 has been removed from the PDB, and 1R09 could not be parsed. We consider the 98 remaining structures.</p>
<p>The catalytic site annotations were taken from version 2.2.9 of the Catalytic Site Atlas <xref ref-type="bibr" rid="pcbi.1000585-Porter1">[66]</xref>. There are 153 proteins in the LigASite apo dataset with entries in the Catalytic Site Atlas. These proteins have an average of 3.2 catalytic sites per chain (just over 1% of all residues in the chain).</p>
</sec><sec id="s4d">
<title>Evaluation</title>
<p>Predictions of ligand binding pockets are represented by non-zero values in a regular 3D grid around the protein. These represent regions in space thought to contain ligands. These predictions are evaluated in two ways: on the pocket level by computing their overlap with known ligands, and on the grid level by analyzing how well the grid scores rank grid points that overlap ligand atoms. We use a grid with rasterized van der Waals spheres for ligand atoms from the PQS structure as the “positive” set of grid points. From this, we calculate the intersection and union of the actual ligand atoms and the predictions. We compare methods using the over-prediction factor (Prediction Volume/Ligand Volume), precision (Intersection Volume/Prediction Volume), recall (Intersection Volume/Ligand Volume), and Jaccard coefficient (Intersection Volume/Union Volume).</p>
<p>We also create precision-recall (PR) curves, which compare precision (TP/(TP + FP)) on the y-axis with recall (TP/(TP + FN)) on the x-axis, to evaluate the ability of each method to predict whether a ligand atom is present at a grid point. We consider grid points that overlap a ligand atom as positives. To construct the PR curve, we calculate the precision and recall at each cutoff of the grid values in the pocket prediction grid. To summarize the performance of each method, we construct a composite PR curve <xref ref-type="bibr" rid="pcbi.1000585-Manning1">[72]</xref> by averaging the precision at each recall level for each structure in the dataset. As a reference point, we include the performance of a random classifier averaged over all the structures as well. The expected performance of a random method is the number of positives over the number of all grid points. The method and code of Davis and Goadrich <xref ref-type="bibr" rid="pcbi.1000585-Davis1">[73]</xref> is used to calculate the area under the PR curve (PR-AUC). The significance of the difference between methods is assessed using the Wilcoxon signed-rank test over paired performance statistics for all structures in the dataset. The significance of the difference in performance of a single method on different datasets is calculated with the Wilcoxon rank-sum test.</p>
<p>For the residue-based evaluation, we consider how well each method's residue scores identify ligand binding residues. Positives are those residues in contact with a ligand as defined by LigASite database. PR curves were made by calculating, for each chain, the precision and recall at each position on the ranked list of residue scores. Composite PR curves were computed as described for the grid point evaluation, but curves were first averaged over the chains in a structure and then over structures. PR curves were constructed similarly for the catalytic site analysis, but positives were defined as those residues listed in the Catalytic Site Atlas.</p>
</sec></sec><sec id="s5">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1000585.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000585.s001" xlink:type="simple"><label>Text S1</label><caption>
<p>Supplementary text, results, and analysis.</p>
<p>(0.39 MB PDF)</p>
</caption></supplementary-material></sec></body>
<back><ref-list>
<title>References</title>
<ref id="pcbi.1000585-Huang1"><label>1</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Huang</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Schroeder</surname><given-names>M</given-names></name>
</person-group>             <year>2006</year>             <article-title>LIGSITEcsc: predicting ligand binding sites using the Connolly surface and degree of conservation.</article-title>             <source>BMC Struct Bio</source>             <volume>6</volume>             <fpage>19</fpage>          </element-citation></ref>
<ref id="pcbi.1000585-Capra1"><label>2</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Capra</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Singh</surname><given-names>M</given-names></name>
</person-group>             <year>2007</year>             <article-title>Predicting functionally important residues from sequence conservation.</article-title>             <source>Bioinf</source>             <volume>23</volume>             <fpage>1875</fpage>             <lpage>1882</lpage>          </element-citation></ref>
<ref id="pcbi.1000585-Lopez1"><label>3</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Lopez</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Valencia</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Tress</surname><given-names>M</given-names></name>
</person-group>             <year>2007</year>             <article-title>firestar---prediction of functionally important residues using structural templates and alignment reliability.</article-title>             <source>Nucleic Acids Res</source>             <volume>35</volume>             <fpage>W573</fpage>             <lpage>W577</lpage>          </element-citation></ref>
<ref id="pcbi.1000585-Kuznetsov1"><label>4</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Kuznetsov</surname><given-names>I</given-names></name>
<name name-style="western"><surname>Gou</surname><given-names>Z</given-names></name>
<name name-style="western"><surname>Li</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Hwang</surname><given-names>S</given-names></name>
</person-group>             <year>2006</year>             <article-title>Using evolutionary and structural information to predict DNA-binding sites on DNA-binding proteins.</article-title>             <source>Proteins: Stuct, Func, and Bioinf</source>             <volume>64</volume>             <fpage>19</fpage>             <lpage>27</lpage>          </element-citation></ref>
<ref id="pcbi.1000585-Youn1"><label>5</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Youn</surname><given-names>E</given-names></name>
<name name-style="western"><surname>Peters</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Radivojac</surname><given-names>P</given-names></name>
<name name-style="western"><surname>Mooney</surname><given-names>S</given-names></name>
</person-group>             <year>2007</year>             <article-title>Evaluation of features for catalytic residue prediction in novel folds.</article-title>             <source>Prot Sci</source>             <volume>16</volume>             <fpage>216</fpage>             <lpage>226</lpage>          </element-citation></ref>
<ref id="pcbi.1000585-Ofran1"><label>6</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Ofran</surname><given-names>Y</given-names></name>
<name name-style="western"><surname>Rost</surname><given-names>B</given-names></name>
</person-group>             <year>2007</year>             <article-title>Protein-protein interaction hotspots carved into sequences.</article-title>             <source>PLoS Comput Biol</source>             <volume>3</volume>             <fpage>e119</fpage>          </element-citation></ref>
<ref id="pcbi.1000585-Zhou1"><label>7</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Zhou</surname><given-names>H</given-names></name>
<name name-style="western"><surname>Qin</surname><given-names>S</given-names></name>
</person-group>             <year>2007</year>             <article-title>Interaction-site prediction for protein complexes: a critical assessment.</article-title>             <source>Bioinf</source>             <volume>23</volume>             <fpage>2203</fpage>             <lpage>2209</lpage>          </element-citation></ref>
<ref id="pcbi.1000585-Hannenhalli1"><label>8</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Hannenhalli</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Russell</surname><given-names>R</given-names></name>
</person-group>             <year>2000</year>             <article-title>Analysis and prediction of functional sub-types from protein sequence alignments.</article-title>             <source>J Mol Biol</source>             <volume>303</volume>             <fpage>61</fpage>             <lpage>76</lpage>          </element-citation></ref>
<ref id="pcbi.1000585-delSolMesa1"><label>9</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>del Sol Mesa</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Pazos</surname><given-names>F</given-names></name>
<name name-style="western"><surname>Valencia</surname><given-names>A</given-names></name>
</person-group>             <year>2003</year>             <article-title>Automatic methods for predicting functionally important residues.</article-title>             <source>J Mol Biol</source>             <volume>326</volume>             <fpage>1289</fpage>             <lpage>1302</lpage>          </element-citation></ref>
<ref id="pcbi.1000585-Kalinina1"><label>10</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Kalinina</surname><given-names>O</given-names></name>
<name name-style="western"><surname>Mironov</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Gelfand</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Rakhmaninova</surname><given-names>A</given-names></name>
</person-group>             <year>2004</year>             <article-title>Automated selection of positions determining functional specificity of proteins by comparative analysis of orthologous groups in protein families.</article-title>             <source>Prot Sci</source>             <volume>13</volume>             <fpage>443</fpage>             <lpage>456</lpage>          </element-citation></ref>
<ref id="pcbi.1000585-Chakrabarti1"><label>11</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Chakrabarti</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Bryant</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Panchenko</surname><given-names>A</given-names></name>
</person-group>             <year>2007</year>             <article-title>Functional specificity lies within the properties and evolutionary changes of amino acids.</article-title>             <source>J Mol Biol</source>             <volume>373</volume>             <fpage>801</fpage>             <lpage>10</lpage>          </element-citation></ref>
<ref id="pcbi.1000585-Capra2"><label>12</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Capra</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Singh</surname><given-names>M</given-names></name>
</person-group>             <year>2008</year>             <article-title>Characterization and prediction of residues determining protein functional specificity.</article-title>             <source>Bioinf</source>             <volume>24</volume>             <fpage>1473</fpage>             <lpage>1480</lpage>          </element-citation></ref>
<ref id="pcbi.1000585-Levitt1"><label>13</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Levitt</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Banaszak</surname><given-names>L</given-names></name>
</person-group>             <year>1992</year>             <article-title>Pocket: A computer graphics method for identifying and displaying protein cavities and their surrounding amino acids.</article-title>             <source>J Mol Graphics</source>             <volume>10</volume>             <fpage>229</fpage>             <lpage>234</lpage>          </element-citation></ref>
<ref id="pcbi.1000585-Laskowski1"><label>14</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Laskowski</surname><given-names>R</given-names></name>
</person-group>             <year>1995</year>             <article-title>Surfnet: a program for visualizing molecular surfaces, cavities, and intermolecular interactions.</article-title>             <source>J Mol Graph</source>             <volume>12</volume>             <fpage>323</fpage>             <lpage>330</lpage>          </element-citation></ref>
<ref id="pcbi.1000585-Peters1"><label>15</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Peters</surname><given-names>K</given-names></name>
<name name-style="western"><surname>Fauck</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Frömmel</surname><given-names>C</given-names></name>
</person-group>             <year>1996</year>             <article-title>The automatic search for ligand binding sites in proteins of known three-dimensional structure using only geometric criteria.</article-title>             <source>J Mol Biol</source>             <volume>256</volume>             <fpage>201</fpage>             <lpage>213</lpage>          </element-citation></ref>
<ref id="pcbi.1000585-Hendlich1"><label>16</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Hendlich</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Rippman</surname><given-names>F</given-names></name>
<name name-style="western"><surname>Barnickel</surname><given-names>G</given-names></name>
</person-group>             <year>1997</year>             <article-title>LIGSITE: automatic and efficient detection of potential small molecule-binding sites in proteins.</article-title>             <source>J Mol Graph Model</source>             <volume>15</volume>             <fpage>359</fpage>             <lpage>363</lpage>          </element-citation></ref>
<ref id="pcbi.1000585-Liang1"><label>17</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Liang</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Edelsbrunner</surname><given-names>H</given-names></name>
<name name-style="western"><surname>Woodward</surname><given-names>C</given-names></name>
</person-group>             <year>1998</year>             <article-title>Anatomy of protein pockets and cavities: Measurement of binding site geometry and implications for ligand design.</article-title>             <source>Prot Sci</source>             <volume>7</volume>             <fpage>1884</fpage>             <lpage>1897</lpage>          </element-citation></ref>
<ref id="pcbi.1000585-Brady1"><label>18</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Brady</surname><given-names>G</given-names><suffix>Jr</suffix></name>
<name name-style="western"><surname>Stouten</surname><given-names>P</given-names></name>
</person-group>             <year>2000</year>             <article-title>Fast prediction and visualization of protein binding pockets with PASS.</article-title>             <source>J Comp-Aided Mol Design</source>             <volume>14</volume>             <fpage>383</fpage>             <lpage>401</lpage>          </element-citation></ref>
<ref id="pcbi.1000585-Dundas1"><label>19</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Dundas</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Ouyang</surname><given-names>Z</given-names></name>
<name name-style="western"><surname>Tseng</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Binkowski</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Turpaz</surname><given-names>Y</given-names></name>
<etal/></person-group>             <year>2006</year>             <article-title>CASTp: computed atlas of surface topography of proteins with structural and topographical mapping of functionally annotated residues.</article-title>             <source>Nucleic Acids Res</source>             <volume>34</volume>             <fpage>W116</fpage>             <lpage>W118</lpage>          </element-citation></ref>
<ref id="pcbi.1000585-Xie1"><label>20</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Xie</surname><given-names>L</given-names></name>
<name name-style="western"><surname>Bourne</surname><given-names>P</given-names></name>
</person-group>             <year>2007</year>             <article-title>A robust and efficient algorithm for the shape description of protein structures and its application in predicting ligand binding sites.</article-title>             <source>BMC Bioinf</source>             <volume>8</volume>             <fpage>S9</fpage>          </element-citation></ref>
<ref id="pcbi.1000585-Weisel1"><label>21</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Weisel</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Proschak</surname><given-names>E</given-names></name>
<name name-style="western"><surname>Schneider</surname><given-names>G</given-names></name>
</person-group>             <year>2007</year>             <article-title>PocketPicker: analysis of ligand binding-sites with shape descriptors.</article-title>             <source>Chem Cen J</source>             <volume>1</volume>             <fpage>7</fpage>          </element-citation></ref>
<ref id="pcbi.1000585-Valdar1"><label>22</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Valdar</surname><given-names>W</given-names></name>
</person-group>             <year>2002</year>             <article-title>Scoring residue conservation.</article-title>             <source>Proteins: Structure, Function, and Genetics</source>             <volume>48</volume>             <fpage>227</fpage>             <lpage>241</lpage>          </element-citation></ref>
<ref id="pcbi.1000585-An1"><label>23</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>An</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Totrov</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Abagyan</surname><given-names>R</given-names></name>
</person-group>             <year>2005</year>             <article-title>Pocketome via comprehensive identification and classification of ligand binding envelopes.</article-title>             <source>Mol Cell Prot</source>             <volume>4</volume>             <fpage>752</fpage>             <lpage>761</lpage>          </element-citation></ref>
<ref id="pcbi.1000585-Dessailly1"><label>24</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Dessailly</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Lensink</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Orengo</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Wodak</surname><given-names>S</given-names></name>
</person-group>             <year>2008</year>             <article-title>LigASite: a database of biologically relevant binding sites in proteins with known apo-structures.</article-title>             <source>Nucleic Acids Res</source>             <volume>36</volume>             <fpage>D667</fpage>             <lpage>673</lpage>          </element-citation></ref>
<ref id="pcbi.1000585-Laurie1"><label>25</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Laurie</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Jackson</surname><given-names>R</given-names></name>
</person-group>             <year>2005</year>             <article-title>Q-SiteFinder: an energy-based method for the prediction of protein–ligand binding sites.</article-title>             <source>Bioinf</source>             <volume>21</volume>             <fpage>1908</fpage>             <lpage>1916</lpage>          </element-citation></ref>
<ref id="pcbi.1000585-Mayrose1"><label>26</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Mayrose</surname><given-names>I</given-names></name>
<name name-style="western"><surname>Graur</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Ben-Tal</surname><given-names>N</given-names></name>
<name name-style="western"><surname>Pupko</surname><given-names>T</given-names></name>
</person-group>             <year>2004</year>             <article-title>Comparison of site-specific rate-inference methods: Bayesian methods are superior.</article-title>             <source>Mol Biol Evol</source>             <volume>21</volume>             <fpage>1781</fpage>             <lpage>1791</lpage>          </element-citation></ref>
<ref id="pcbi.1000585-Wang1"><label>27</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Wang</surname><given-names>K</given-names></name>
<name name-style="western"><surname>Samudrala</surname><given-names>R</given-names></name>
</person-group>             <year>2006</year>             <article-title>Incorporating background frequency improves entropy-based residue conservation measures.</article-title>             <source>BMC Bioinf</source>             <volume>7</volume>             <fpage>385</fpage>          </element-citation></ref>
<ref id="pcbi.1000585-Mihalek1"><label>28</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Mihalek</surname><given-names>I</given-names></name>
<name name-style="western"><surname>Res</surname><given-names>I</given-names></name>
<name name-style="western"><surname>Lichtarge</surname><given-names>O</given-names></name>
</person-group>             <year>2004</year>             <article-title>A family of evolution–entropy hybrid methods for ranking protein residues by importance.</article-title>             <source>J Mol Biol</source>             <volume>336</volume>             <fpage>1265</fpage>             <lpage>1282</lpage>          </element-citation></ref>
<ref id="pcbi.1000585-Sankararaman1"><label>29</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Sankararaman</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Sjolander</surname><given-names>K</given-names></name>
</person-group>             <year>2008</year>             <article-title>Intrepid–information-theoretic tree traversal for protein functional site identificantion.</article-title>             <source>Bioinf</source>             <volume>24</volume>             <fpage>2445</fpage>             <lpage>2452</lpage>          </element-citation></ref>
<ref id="pcbi.1000585-Bahadur1"><label>30</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Bahadur</surname><given-names>KD</given-names></name>
<name name-style="western"><surname>Livesay</surname><given-names>D</given-names></name>
</person-group>             <year>2008</year>             <article-title>Improving position specific predictions of protein functional sites using phylogenetic motifs.</article-title>             <source>Bioinf</source>             <volume>24</volume>             <fpage>2308</fpage>             <lpage>2316</lpage>          </element-citation></ref>
<ref id="pcbi.1000585-Fischer1"><label>31</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Fischer</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Mayer</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Soeding</surname><given-names>J</given-names></name>
</person-group>             <year>2008</year>             <article-title>Prediction of protein functional residues from sequence by probability density estimation.</article-title>             <source>Bioinf</source>             <volume>24</volume>             <fpage>613</fpage>             <lpage>620</lpage>          </element-citation></ref>
<ref id="pcbi.1000585-Elcock1"><label>32</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Elcock</surname><given-names>A</given-names></name>
</person-group>             <year>2001</year>             <article-title>Prediction of functionally important residues based solely on the computed energetics of protein structure.</article-title>             <source>J Mol Biol</source>             <volume>312</volume>             <fpage>885</fpage>             <lpage>896</lpage>          </element-citation></ref>
<ref id="pcbi.1000585-Bate1"><label>33</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Bate</surname><given-names>P</given-names></name>
<name name-style="western"><surname>Warwicker</surname><given-names>J</given-names></name>
</person-group>             <year>2004</year>             <article-title>Enzyme/non-enzyme discrimination and prediction of enzyme active site location using charge-based methods.</article-title>             <source>J Mol Biol</source>             <volume>340</volume>             <fpage>263</fpage>             <lpage>276</lpage>          </element-citation></ref>
<ref id="pcbi.1000585-Hernandez1"><label>34</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Hernandez</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Ghersi</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Sanchez</surname><given-names>R</given-names></name>
</person-group>             <year>2009</year>             <article-title>SITEHOUND-web: a server for ligand binding site identification in protein structures.</article-title>             <source>Nucleic Acids Res</source>             <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkp281" xlink:type="simple">10.1093/nar/gkp281</ext-link></comment>          </element-citation></ref>
<ref id="pcbi.1000585-Ko1"><label>35</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Ko</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Murga</surname><given-names>L</given-names></name>
<name name-style="western"><surname>Andre</surname><given-names>P</given-names></name>
<name name-style="western"><surname>Yang</surname><given-names>H</given-names></name>
<name name-style="western"><surname>Ondrechen</surname><given-names>M</given-names></name>
<etal/></person-group>             <year>2005</year>             <article-title>Statistical criteria for the identification of protein active sites using theoretical microscopic titration curves.</article-title>             <source>Proteins: Stuct, Func, and Bioinf</source>             <volume>59</volume>             <fpage>193</fpage>             <lpage>195</lpage>          </element-citation></ref>
<ref id="pcbi.1000585-Brylinski1"><label>36</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Brylinski</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Skolnick</surname><given-names>J</given-names></name>
</person-group>             <year>2008</year>             <article-title>A threading-based method (FINDSITE) for ligand-binding site prediction and functional annotation.</article-title>             <source>Proc Natl Acad Sci</source>             <volume>105</volume>             <fpage>129</fpage>             <lpage>134</lpage>          </element-citation></ref>
<ref id="pcbi.1000585-Halperin1"><label>37</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Halperin</surname><given-names>I</given-names></name>
<name name-style="western"><surname>Wolfson</surname><given-names>H</given-names></name>
<name name-style="western"><surname>Nussinov</surname><given-names>R</given-names></name>
</person-group>             <year>2003</year>             <article-title>SiteLight: binding-site prediction using phage display libraries.</article-title>             <source>Prot Sci</source>             <volume>12</volume>             <fpage>1344</fpage>             <lpage>1359</lpage>          </element-citation></ref>
<ref id="pcbi.1000585-Amitai1"><label>38</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Amitai</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Shemesh</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Sitbon</surname><given-names>E</given-names></name>
<name name-style="western"><surname>Shklar</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Netanely</surname><given-names>D</given-names></name>
<etal/></person-group>             <year>2004</year>             <article-title>Network analysis of protein structures identifies functional residues.</article-title>             <source>J Mol Biol</source>             <volume>344</volume>             <fpage>1135</fpage>             <lpage>1146</lpage>          </element-citation></ref>
<ref id="pcbi.1000585-Landau1"><label>39</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Landau</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Mayrose</surname><given-names>I</given-names></name>
<name name-style="western"><surname>Rosenberg</surname><given-names>Y</given-names></name>
<name name-style="western"><surname>Glaser</surname><given-names>Y</given-names></name>
<name name-style="western"><surname>Martz</surname><given-names>E</given-names></name>
<etal/></person-group>             <year>2005</year>             <article-title>ConSurf 2005: the projection of evolutionary conservation scores of residues on protein structures.</article-title>             <source>Nucleic Acids Res</source>             <volume>33</volume>             <fpage>W299</fpage>             <lpage>W302</lpage>          </element-citation></ref>
<ref id="pcbi.1000585-Nimrod1"><label>40</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Nimrod</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Schushan</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Steinberg</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Ben-Tal</surname><given-names>N</given-names></name>
</person-group>             <year>2008</year>             <article-title>Detection of functionally important regions in “hypothetical proteins” of known structure.</article-title>             <source>Structure</source>             <volume>16</volume>             <fpage>1755</fpage>             <lpage>1763</lpage>          </element-citation></ref>
<ref id="pcbi.1000585-Yao1"><label>41</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Yao</surname><given-names>H</given-names></name>
<name name-style="western"><surname>Kristensen</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Mihalek</surname><given-names>I</given-names></name>
<name name-style="western"><surname>Sowa</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Shaw</surname><given-names>C</given-names></name>
<etal/></person-group>             <year>2003</year>             <article-title>An accurate, sensitive, and scalable method to identify functional sites in protein structures.</article-title>             <source>J Mol Biol</source>             <volume>326</volume>             <fpage>255</fpage>             <lpage>261</lpage>          </element-citation></ref>
<ref id="pcbi.1000585-Panchenko1"><label>42</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Panchenko</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Konrashov</surname><given-names>F</given-names></name>
<name name-style="western"><surname>Bryant</surname><given-names>S</given-names></name>
</person-group>             <year>2004</year>             <article-title>Prediction of functional sites by analysis of sequence and structure conservation.</article-title>             <source>Prot Sci</source>             <volume>13</volume>             <fpage>884</fpage>             <lpage>892</lpage>          </element-citation></ref>
<ref id="pcbi.1000585-Chelliah1"><label>43</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Chelliah</surname><given-names>V</given-names></name>
<name name-style="western"><surname>Chen</surname><given-names>L</given-names></name>
<name name-style="western"><surname>Blundell</surname><given-names>T</given-names></name>
<name name-style="western"><surname>Lovell</surname><given-names>S</given-names></name>
</person-group>             <year>2004</year>             <article-title>Distinguishing structural and functional restraints in evolution in order to identify interaction sites.</article-title>             <source>J Mol Biol</source>             <volume>342</volume>             <fpage>1487</fpage>             <lpage>1504</lpage>          </element-citation></ref>
<ref id="pcbi.1000585-Cheng1"><label>44</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Cheng</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Qian</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Samudrala</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Baker</surname><given-names>D</given-names></name>
</person-group>             <year>2005</year>             <article-title>Improvement in protein functional site prediction by distinguishing structural and functional constraints on protein family evolution using computational design.</article-title>             <source>Nucleic Acids Res</source>             <volume>33</volume>             <fpage>5861</fpage>             <lpage>5867</lpage>          </element-citation></ref>
<ref id="pcbi.1000585-Wang2"><label>45</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Wang</surname><given-names>K</given-names></name>
<name name-style="western"><surname>Horst</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Cheng</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Nickle</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Samudrala</surname><given-names>R</given-names></name>
</person-group>             <year>2008</year>             <article-title>Protein meta-functional signatures from combining sequence, structure, evolution, and amino acid property information.</article-title>             <source>PLoS Comput Biol</source>             <volume>4</volume>             <fpage>9</fpage>          </element-citation></ref>
<ref id="pcbi.1000585-Chen1"><label>46</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Chen</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Fofanov</surname><given-names>V</given-names></name>
<name name-style="western"><surname>Bryant</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Dodson</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Kristensen</surname><given-names>D</given-names></name>
<etal/></person-group>             <year>2007</year>             <article-title>The mash pipeline for protein function prediction and an algorithm for the geometric refinement of 3D motifs.</article-title>             <source>J Comp Biol</source>             <volume>14</volume>             <fpage>791</fpage>             <lpage>816</lpage>          </element-citation></ref>
<ref id="pcbi.1000585-Burgoyne1"><label>47</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Burgoyne</surname><given-names>N</given-names></name>
<name name-style="western"><surname>Jackson</surname><given-names>R</given-names></name>
</person-group>             <year>2006</year>             <article-title>Predicting protein interaction sites: binding hot-spots in protein-protein and protein-ligand interfaces.</article-title>             <source>Bioinf</source>             <volume>22</volume>             <fpage>1335</fpage>             <lpage>1342</lpage>          </element-citation></ref>
<ref id="pcbi.1000585-Yoon1"><label>48</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Yoon</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Ebert</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Chung</surname><given-names>E</given-names></name>
<name name-style="western"><surname>DeMicheli</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Altman</surname><given-names>R</given-names></name>
</person-group>             <year>2007</year>             <article-title>Clustering protein environments for function prediction: finding PROSITE motifs in 3D.</article-title>             <source>BMC Bioinf</source>             <volume>8</volume>             <supplement>Suppl 4</supplement>             <fpage>S10</fpage>          </element-citation></ref>
<ref id="pcbi.1000585-Gutteridge1"><label>49</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Gutteridge</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Bartlett</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Thornton</surname><given-names>J</given-names></name>
</person-group>             <year>2003</year>             <article-title>Using a neural network and spatial clustering to predict the location of active sites in enzymes.</article-title>             <source>J Mol Biol</source>             <volume>330</volume>             <fpage>719</fpage>             <lpage>734</lpage>          </element-citation></ref>
<ref id="pcbi.1000585-Petrova1"><label>50</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Petrova</surname><given-names>N</given-names></name>
<name name-style="western"><surname>Wu</surname><given-names>C</given-names></name>
</person-group>             <year>2006</year>             <article-title>Prediction of catalytic residues using support vector machines with selected protein sequence and structural properties.</article-title>             <source>BMC Bioinf</source>             <volume>7</volume>             <fpage>312</fpage>          </element-citation></ref>
<ref id="pcbi.1000585-Tong1"><label>51</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Tong</surname><given-names>W</given-names></name>
<name name-style="western"><surname>Wei</surname><given-names>Y</given-names></name>
<name name-style="western"><surname>Murga</surname><given-names>L</given-names></name>
<name name-style="western"><surname>Ondrechen</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Williams</surname><given-names>R</given-names></name>
</person-group>             <year>2009</year>             <article-title>Partial order optimum likelihood (POOL): Maximum likelihood prediction of protein active site residues using 3D structure and sequence properties.</article-title>             <source>PLoS Comput Biol</source>             <volume>5</volume>             <fpage>1</fpage>          </element-citation></ref>
<ref id="pcbi.1000585-Nayal1"><label>52</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Nayal</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Honig</surname><given-names>B</given-names></name>
</person-group>             <year>2006</year>             <article-title>On the nature of cavities on protein surfaces: Application to the identification of drug-binding sites.</article-title>             <source>Proteins: Stuct, Func, and Bioinf</source>             <volume>63</volume>             <fpage>892</fpage>             <lpage>906</lpage>          </element-citation></ref>
<ref id="pcbi.1000585-Wei1"><label>53</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Wei</surname><given-names>L</given-names></name>
<name name-style="western"><surname>Altman</surname><given-names>R</given-names></name>
</person-group>             <year>2003</year>             <article-title>Recognizing complex, asymmetric functional sites in protein structures using a bayesian scoring function.</article-title>             <source>J Bioinform Comput Biol</source>             <volume>1</volume>             <fpage>119</fpage>             <lpage>138</lpage>          </element-citation></ref>
<ref id="pcbi.1000585-Bordner1"><label>54</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Bordner</surname><given-names>A</given-names></name>
</person-group>             <year>2008</year>             <article-title>Predicting small ligand binding sites in proteins using backbone structure.</article-title>             <source>Bioinf</source>             <volume>24</volume>             <fpage>2865</fpage>             <lpage>2871</lpage>          </element-citation></ref>
<ref id="pcbi.1000585-Ebert1"><label>55</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Ebert</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Altman</surname><given-names>R</given-names></name>
</person-group>             <year>2008</year>             <article-title>Robust recognition of zinc binding sites in proteins.</article-title>             <source>Prot Sci</source>             <volume>17</volume>             <fpage>54</fpage>             <lpage>65</lpage>          </element-citation></ref>
<ref id="pcbi.1000585-Glaser1"><label>56</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Glaser</surname><given-names>F</given-names></name>
<name name-style="western"><surname>Morris</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Najmanovich</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Laskowski</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Thornton</surname><given-names>J</given-names></name>
</person-group>             <year>2006</year>             <article-title>A method for localizing ligand binding pockets in protein structures.</article-title>             <source>Proteins: Stuct, Func, and Bioinf</source>             <volume>62</volume>             <fpage>479</fpage>             <lpage>488</lpage>          </element-citation></ref>
<ref id="pcbi.1000585-Morgan1"><label>57</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Morgan</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Kristensen</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Mittleman</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Lichtarge</surname><given-names>O</given-names></name>
</person-group>             <year>2006</year>             <article-title>ET Viewer: An application for predicting and visualizing functional sites in protein structures.</article-title>             <source>Bioinf</source>             <volume>22</volume>             <fpage>2049</fpage>             <lpage>2050</lpage>          </element-citation></ref>
<ref id="pcbi.1000585-Henrick1"><label>58</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Henrick</surname><given-names>K</given-names></name>
<name name-style="western"><surname>Thornton</surname><given-names>J</given-names></name>
</person-group>             <year>1998</year>             <article-title>PQS: a protein quaternary structure file server.</article-title>             <source>Trends Biochem Sci</source>             <volume>23</volume>             <fpage>358</fpage>             <lpage>361</lpage>          </element-citation></ref>
<ref id="pcbi.1000585-Najmanovich1"><label>59</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Najmanovich</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Kuttner</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Sobolev</surname><given-names>V</given-names></name>
<name name-style="western"><surname>Edelman</surname><given-names>M</given-names></name>
</person-group>             <year>2000</year>             <article-title>Side-chain flexibility in proteins upon ligand binding.</article-title>             <source>Proteins: Structure, Function, and Genetics</source>             <volume>39</volume>             <fpage>261</fpage>             <lpage>268</lpage>          </element-citation></ref>
<ref id="pcbi.1000585-Laskowski2"><label>60</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Laskowski</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Luscombe</surname><given-names>N</given-names></name>
<name name-style="western"><surname>Swindells</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Thornton</surname><given-names>J</given-names></name>
</person-group>             <year>1996</year>             <article-title>Protein clefts in molecular recognition and function.</article-title>             <source>Prot Sci</source>             <volume>5</volume>             <fpage>2438</fpage>             <lpage>2452</lpage>          </element-citation></ref>
<ref id="pcbi.1000585-Bartlett1"><label>61</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Bartlett</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Porter</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Borkakoti</surname><given-names>N</given-names></name>
<name name-style="western"><surname>Thornton</surname><given-names>J</given-names></name>
</person-group>             <year>2002</year>             <article-title>Analysis of catalytic residues in enzyme active sites.</article-title>             <source>J Mol Biol</source>             <volume>324</volume>             <fpage>105</fpage>             <lpage>121</lpage>          </element-citation></ref>
<ref id="pcbi.1000585-Perola1"><label>62</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Perola</surname><given-names>E</given-names></name>
<name name-style="western"><surname>Walters</surname><given-names>W</given-names></name>
<name name-style="western"><surname>Charifson</surname><given-names>P</given-names></name>
</person-group>             <year>2004</year>             <article-title>A detailed comparison of current docking and scoring methods on systems of pharmaceutical relevance.</article-title>             <source>Proteins: Stuct, Func, and Bioinf</source>             <volume>56</volume>             <fpage>235</fpage>             <lpage>249</lpage>          </element-citation></ref>
<ref id="pcbi.1000585-Willems1"><label>63</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Willems</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Tahlan</surname><given-names>K</given-names></name>
<name name-style="western"><surname>Taguchi</surname><given-names>T</given-names></name>
<name name-style="western"><surname>Zhang</surname><given-names>K</given-names></name>
<name name-style="western"><surname>Lee</surname><given-names>Z</given-names></name>
<etal/></person-group>             <year>2008</year>             <article-title>Crystal structures of the Streptomyces coelicolor TetR-like protein ActR alone and in complex with actinorhodin or the actinorhodin biosynthetic precursor (S)-DNPA.</article-title>             <source>J Mol Biol</source>             <volume>376</volume>             <fpage>1377</fpage>             <lpage>1387</lpage>          </element-citation></ref>
<ref id="pcbi.1000585-Ling1"><label>64</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Ling</surname><given-names>H</given-names></name>
<name name-style="western"><surname>Boodhoo</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Hazes</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Cummings</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Armstrong</surname><given-names>G</given-names></name>
<etal/></person-group>             <year>1998</year>             <article-title>Structure of the shiga-like toxin I B-pentamer complexed with an analogue of its receptor Gb3.</article-title>             <source>Biochem</source>             <volume>37</volume>             <fpage>1777</fpage>             <lpage>1788</lpage>          </element-citation></ref>
<ref id="pcbi.1000585-Charnock1"><label>65</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Charnock</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Bolam</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Nurizzo</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Szabó</surname><given-names>L</given-names></name>
<name name-style="western"><surname>McKie</surname><given-names>V</given-names></name>
<etal/></person-group>             <year>2002</year>             <article-title>Promiscuity in ligand-binding: The three-dimensional structure of a piromyces carbohydrate-binding module, cbm29-2, in complex with cello- and mannohexaose.</article-title>             <source>Proc Natl Acad Sci</source>             <volume>99</volume>             <fpage>14077</fpage>             <lpage>14082</lpage>          </element-citation></ref>
<ref id="pcbi.1000585-Porter1"><label>66</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Porter</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Bartlett</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Thornton</surname><given-names>J</given-names></name>
</person-group>             <year>2004</year>             <article-title>The catalytic site atlas: a resource of catalytic sites and residues identified in enzymes using structural data.</article-title>             <source>Nucleic Acids Res</source>             <volume>32</volume>             <fpage>D129</fpage>             <lpage>D133</lpage>          </element-citation></ref>
<ref id="pcbi.1000585-Magliery1"><label>67</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Magliery</surname><given-names>T</given-names></name>
<name name-style="western"><surname>Regan</surname><given-names>L</given-names></name>
</person-group>             <year>2005</year>             <article-title>Sequence variation in ligand binding sites in proteins.</article-title>             <source>BMC Bioinf</source>             <volume>6</volume>             <fpage>240</fpage>          </element-citation></ref>
<ref id="pcbi.1000585-Caffrey1"><label>68</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Caffrey</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Somaroo</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Hughes</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Mintseris</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Huang</surname><given-names>E</given-names></name>
</person-group>             <year>2004</year>             <article-title>Are protein-protein interfaces more conserved in sequence than the rest of the protein surface?</article-title>             <source>Prot Sci</source>             <volume>13</volume>             <fpage>190</fpage>             <lpage>202</lpage>          </element-citation></ref>
<ref id="pcbi.1000585-Morris1"><label>69</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Morris</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Goodsell</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Halliday</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Huey</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Hart</surname><given-names>W</given-names></name>
<etal/></person-group>             <year>1998</year>             <article-title>Automated docking using a Lamarckian genetic algorithm and an empirical binding free energy function.</article-title>             <source>J Comp Chem</source>             <volume>19</volume>             <fpage>1639</fpage>             <lpage>1662</lpage>          </element-citation></ref>
<ref id="pcbi.1000585-Dodge1"><label>70</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Dodge</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Schneider</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Sander</surname><given-names>C</given-names></name>
</person-group>             <year>1998</year>             <article-title>The HSSP database of protein structure-sequence alignments and family profiles.</article-title>             <source>Nucleic Acids Res</source>             <volume>26</volume>             <fpage>313</fpage>             <lpage>315</lpage>          </element-citation></ref>
<ref id="pcbi.1000585-DeLano1"><label>71</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>DeLano</surname><given-names>W</given-names></name>
</person-group>             <year>2002</year>             <article-title>The PyMOL User's Manual.</article-title>             <comment>DeLano Scientific, Palo Alto, CA, USA. <ext-link ext-link-type="uri" xlink:href="http://www.pymol.org" xlink:type="simple">http://www.pymol.org</ext-link>.</comment>          </element-citation></ref>
<ref id="pcbi.1000585-Manning1"><label>72</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Manning</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Raghavan</surname><given-names>P</given-names></name>
<name name-style="western"><surname>Schütze</surname><given-names>H</given-names></name>
</person-group>             <year>2008</year>             <article-title>Introduction to Information Retrieval.</article-title>             <publisher-name>Cambridge University Press</publisher-name>             <fpage>158</fpage>             <lpage>163</lpage>          </element-citation></ref>
<ref id="pcbi.1000585-Davis1"><label>73</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Davis</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Goadrich</surname><given-names>M</given-names></name>
</person-group>             <year>2006</year>             <article-title>The relationship between precision-recall and ROC curves.</article-title>             <source>Proc 23rd Int Conf on Machine Learning</source>             <volume>23</volume>             <fpage>233</fpage>             <lpage>240</lpage>          </element-citation></ref>
</ref-list>

</back>
</article>