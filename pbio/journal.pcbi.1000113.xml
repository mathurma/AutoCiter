<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN">
<front>
<journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher></journal-meta>
<article-meta><article-id pub-id-type="publisher-id">08-PLCB-RA-0117R2</article-id><article-id pub-id-type="doi">10.1371/journal.pcbi.1000113</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline"><subject>Computational Biology/Genomics</subject><subject>Computational Biology/Macromolecular Sequence Analysis</subject></subj-group></article-categories><title-group><article-title>Decoding of Superimposed Traces Produced by Direct Sequencing of Heterozygous Indels</article-title><alt-title alt-title-type="running-head">Decoding Heterozygous Indels</alt-title></title-group><contrib-group>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Dmitriev</surname><given-names>Dmitry A.</given-names></name><xref ref-type="aff" rid="aff1"/><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Rakitov</surname><given-names>Roman A.</given-names></name><xref ref-type="aff" rid="aff1"/></contrib>
</contrib-group><aff id="aff1">          <addr-line>Illinois Natural History Survey, Champaign, Illinois, United States of America</addr-line>       </aff><contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Stormo</surname><given-names>Gary</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group><aff id="edit1">Washington University, United States of America</aff><author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">dmitriev@inhs.uiuc.edu</email></corresp>
<fn fn-type="con"><p>Conceived and designed the experiments: DD RR. Performed the experiments: DD RR. Analyzed the data: DD RR. Contributed reagents/materials/analysis tools: DD RR. Wrote the paper: DD RR.</p></fn>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn></author-notes><pub-date pub-type="collection"><month>7</month><year>2008</year></pub-date><pub-date pub-type="epub"><day>25</day><month>7</month><year>2008</year></pub-date><volume>4</volume><issue>7</issue><elocation-id>e1000113</elocation-id><history>
<date date-type="received"><day>19</day><month>2</month><year>2008</year></date>
<date date-type="accepted"><day>4</day><month>6</month><year>2008</year></date>
</history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2008</copyright-year><copyright-holder>Dmitriev, Rakitov</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract>
<p>Direct Sanger sequencing of a diploid template containing a heterozygous insertion or deletion results in a difficult-to-interpret mixed trace formed by two allelic traces superimposed onto each other. Existing computational methods for deconvolution of such traces require knowledge of a reference sequence or the availability of both direct and reverse mixed sequences of the same template. We describe a simple yet accurate method, which uses dynamic programming optimization to predict superimposed allelic sequences solely from a string of letters representing peaks within an individual mixed trace. We used the method to decode 104 human traces (mean length 294 bp) containing heterozygous indels 5 to 30 bp with a mean of 99.1% bases per allelic sequence reconstructed correctly and unambiguously. Simulations with artificial sequences have demonstrated that the method yields accurate reconstructions when (1) the allelic sequences forming the mixed trace are sufficiently similar, (2) the analyzed fragment is significantly longer than the indel, and (3) multiple indels, if present, are well-spaced. Because these conditions occur in most encountered DNA sequences, the method is widely applicable. It is available as a free Web application Indelligent at <ext-link ext-link-type="uri" xlink:href="http://ctap.inhs.uiuc.edu/dmitriev/indel.asp" xlink:type="simple">http://ctap.inhs.uiuc.edu/dmitriev/indel.asp</ext-link>.</p>
</abstract><abstract abstract-type="summary"><title>Author Summary</title>
<p>In DNA, information is encoded as a sequence of four types of building blocks–nucleotides. The most common technique for determining such sequences, the Sanger method, outputs a single consensus for a pool of DNA molecules in the analyzed sample. When these are identical, each site in the output contains a single nucleotide call. Yet, samples from organisms with two sets of chromosomes generally contain two types of DNA molecules (alleles), each derived from one parent. If, due to insertion or deletion (indel) mutations, one allele contains extra nucleotides, most sites in the sequencing output beyond the mutation site will contain pairs of nucleotide calls. While signaling the presence of a potentially important mutation, such output cannot be read directly and often gets discarded. Here we describe an algorithmic method which accurately reconstructs the pair of allelic sequences from the observed complex pattern of calls. Unlike most existing computational approaches to the problem, our method does not require knowledge of one of the involved sequences to use as a reference, nor any other additional information. Therefore, it can facilitate sequencing of indel-rich regions of genomes and speed up discovery and characterization of indel mutations, including those causing diseases in humans.</p>
</abstract><funding-group><funding-statement>The study has been partially supported by the National Science Foundation grants DEB 0344405, DEB 0315373, DEB 050529679, and DEB 0715499.</funding-statement></funding-group><counts><page-count count="10"/></counts></article-meta>
</front>
<body><sec id="s1">
<title>Introduction</title>
<p>Direct fluorescent sequencing of two dissimilar templates produces a mixed trace, which appears as if the traces obtained for each template separately were superimposed onto each other. Simultaneous sequencing of completely unrelated templates occurs during sequencing of RT-PCR products containing alternative splicing sites and during screening of random insertional mutagenesis libraries <xref ref-type="bibr" rid="pcbi.1000113-Tenney1">[1]</xref>. More often mixed traces occur as a result of direct sequencing of diploid alleles containing heterozygous insertions/deletions. In this case, the mixed trace downstream of the indel is formed by two allelic traces superimposed onto each other with a phase shift <xref ref-type="bibr" rid="pcbi.1000113-Tenney1">[1]</xref>–<xref ref-type="bibr" rid="pcbi.1000113-Flot1">[5]</xref> (<xref ref-type="fig" rid="pcbi-1000113-g001">Figure 1</xref>). Mixed traces are often discarded as uninterpretable. New sequencing technologies, such as pyrosequencing, avoid the problem by working from single DNA molecules <xref ref-type="bibr" rid="pcbi.1000113-Mardis1">[6]</xref>, but these emerging methods still have limited application <xref ref-type="bibr" rid="pcbi.1000113-Pop1">[7]</xref>. In traditional capillary electrophoresis sequencing, the problem can be avoided by separating the templates prior to sequencing via cloning into a vector or by selectively amplifying one allele using allele-specific primers. Because these solutions are costly, several computational methods have been developed to extract information from mixed traces.</p>
<fig id="pcbi-1000113-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000113.g001</object-id><label>Figure 1</label><caption>
<title>A pair of allelic sequences properly aligned (A), unaligned (B), and translated into a consensus (C).</title>
<p>The trace resulted from direct sequencing of the pair is shown in (D). The one-base insertion is shown in bold face. Links between the allelic strings represent positional homologies. The bases forming mixed trace are highlighted with grey. The standard IUPAC symbols for 2-fold degenerate DNA bases are enclosed in the box.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000113.g001" xlink:type="simple"/></fig>
<p>Most of these methods require knowledge of a reference sequence, <italic>i.e.</italic>, a sequence believed to be identical to one of the two mixed templates <xref ref-type="bibr" rid="pcbi.1000113-SousaSantos1">[2]</xref>–<xref ref-type="bibr" rid="pcbi.1000113-Bhangale2">[4]</xref>. Algorithms for “subtracting” from the mixed sequence a reference sequence, supplied by the user, have been incorporated into several software packages, including PolyPhred <xref ref-type="bibr" rid="pcbi.1000113-Bhangale2">[4]</xref>, STADEN package <xref ref-type="bibr" rid="pcbi.1000113-Staden1">[8]</xref>, CodonCode Aligner (CodonCode Corp., Dedham, MA, USA), Mutation Surveyor (SoftGenetics), novoSNP <xref ref-type="bibr" rid="pcbi.1000113-Weckx1">[9]</xref>, InSNP <xref ref-type="bibr" rid="pcbi.1000113-Manaster1">[10]</xref>, PolyScan <xref ref-type="bibr" rid="pcbi.1000113-Chen1">[11]</xref>, and AutoCSA <xref ref-type="bibr" rid="pcbi.1000113-Dicks1">[12]</xref>. This approach has been used to detect and characterize sequence variants in clinical applications, such as detecting somatic heterozygous variants in primary cancers <xref ref-type="bibr" rid="pcbi.1000113-Dicks1">[12]</xref>, and to discover rare indel polymorphisms in large-scale resequencing projects <xref ref-type="bibr" rid="pcbi.1000113-Bhangale1">[3]</xref>. A similar algorithm has been recently developed, which uses as a reference the best matching genomic sequence obtained by aligning the mixed sequence to the appropriate genomic database <xref ref-type="bibr" rid="pcbi.1000113-Tenney1">[1]</xref>. The reference-based methods decode mixed traces formed by related (allelic) as well as completely unrelated templates, but the requirement of a reference restricts their use mostly to extensively sequenced organisms and loci. Moreover, the assumption that the chosen reference sequence should be identical to one of the unknown templates comprising the mixed trace may not always hold true, potentially leading to errors in reconstruction (<xref ref-type="fig" rid="pcbi-1000113-g002">Figure 2</xref>).</p>
<fig id="pcbi-1000113-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000113.g002</object-id><label>Figure 2</label><caption>
<title>Examples of situations when the reference-based approach results in incomplete or incorrect reconstructions of a mixed sequence.</title>
<p>Links between bases of the actual allelic strings (top) indicate positional homologies. The chosen reference sequences each differ from the top allelic string at one site (bold letters). Subtraction of Reference 1 results in one site in each reconstructed allelic string remaining unknown (red letters). Subtraction of Reference 2 results in one incorrectly reconstructed site in each allelic string (red letters). Note that, in the last case, the reconstructed fragment is heterozygous at two sites (dashed homology links). For the meanings of the IUPAC symbols see <xref ref-type="fig" rid="pcbi-1000113-g001">Figure 1</xref>.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000113.g002" xlink:type="simple"/></fig>
<p>A different approach is used by the proprietary algorithm in SeqScape and Variant Reporter (both Applied Biosystems Inc., Foster City, CA, USA), which detects and decodes single heterozygous indels without a reference sequence, but only when mixed traces produced by both direct and reverse sequencing of the same template are available (<xref ref-type="bibr" rid="pcbi.1000113-Sorenson1">[13]</xref> and a personal communication of an AB employee). Recently, Flot et al. <xref ref-type="bibr" rid="pcbi.1000113-Flot1">[5]</xref> developed an elegant method for deconvolution of mixed traces, which also uses the direct and reverse sequences of the same template. Implemented as the web software Champuru <xref ref-type="bibr" rid="pcbi.1000113-Flot2">[14]</xref>, the method is based on the observation that, as long as two templates differ in length, the direct and reverse sequences of their mixture provide complementary information, which can be combined to fully restore the original template sequences even if these were unrelated.</p>
<p>To our knowledge, the only tool developed so far to extract superimposed sequences from an individual mixed trace is the web application ShiftDetector <xref ref-type="bibr" rid="pcbi.1000113-Seroussi1">[15]</xref> (While this manuscript was in production, the authors became aware that a proprietary algorithm capable of decoding individual mixed traces resulted from single indels up to 25 bp had been recently included in CodonCode Aligner Version 2.0 by CodonCode Corp., Dedham, MA, USA). To detect heterozygous indels, the program processes a trace file and estimates for each site the probability that peaks at the next 10 sites have resulted from a phase shift between 0 and 25 bp by recording how many of these peaks are repeated at the corresponding distance downstream in the trace. Instead of a pair of allelic sequences, the program reconstructs a single consensus sequence, beginning at variable distances downstream of the indel, which itself remains undecoded. Moreover, in this study we found that under ideal conditions ShiftDetector decodes only 56.0 to 85.5% of the ambiguous sites present in the input trace. Apparently due to these shortcomings, the method has found only limited use <xref ref-type="bibr" rid="pcbi.1000113-Seroussi2">[16]</xref>.</p>
<p>Similarly to ShiftDetector, the method we describe here decodes superimposed allelic sequences solely from the complex pattern of calls within an individual mixed trace. Unlike the former program, it produces highly complete reconstructions and, therefore, has a potential for wide application. The new method, implemented as a free web application Indelligent (<ext-link ext-link-type="uri" xlink:href="http://ctap.inhs.uiuc.edu/dmitriev/indel.asp" xlink:type="simple">http://ctap.inhs.uiuc.edu/dmitriev/indel.asp</ext-link>), employs dynamic programming optimization to estimate the pair of maximally similar strings that can be superimposed to produce the observed mixed sequence. We report the performance of the program on simulated mixed sequences, generated from pairs of superimposed strings containing single or multiple heterozygous indels and variable amounts of SNPs. We also describe results of validation tests, in which the program was used to decode 104 human traces, previously reported to contain heterozygous indels 5 to 30 bp <xref ref-type="bibr" rid="pcbi.1000113-Bhangale1">[3]</xref>, with a mean of 99.1% bases per allelic sequence reconstructed correctly and unambiguously. Additionally, we demonstrate that under ideal conditions the percentage of input ambiguous sites decoded by our program approaches 100%, which significantly exceeds the performance of ShiftDetector. Finally, we discuss limitations and potential applications of the new method.</p>
</sec><sec id="s2">
<title>Materials and Methods</title>
<sec id="s2a">
<title>Algorithms</title>
<sec id="s2a1">
<title>Model and definitions</title>
<p>The essence of the problem is illustrated in <xref ref-type="fig" rid="pcbi-1000113-g001">Figure 1</xref>, which shows two allelic sequences, containing a heterozygous indel, properly aligned (A) and then misaligned due to removal of the gap (B). The consensus of the two misaligned strings (C), written using standard IUPAC symbols for degenerate nucleotide bases, represents all the information contained in the mixed trace (D). The goal, therefore, is to reconstruct (A) based on (C). At each ambiguous site, either of the two superimposed bases potentially can be placed into the upper or into the lower string. Because homologous allelic sequences are generally highly similar, our method arranges the superimposed bases in such a way as to obtain two strings with the maximum alignment score.</p>
<p>Let F = <italic>a</italic><sub>1</sub><italic>a</italic><sub>2</sub>…<italic>a</italic><sub>n</sub>, be a string of letters representing successive peaks in a mixed trace. The letters representing superimposed identical peaks are A, C, G, or T, and other letters are IUPAC ambiguity symbols for 2-fold degenerate nucleotide bases: K, M, R, S, W, and Y (<xref ref-type="fig" rid="pcbi-1000113-g001">Figure 1, box</xref>). All the letters are called <italic>bases</italic>, and their positions 1≤<italic>i</italic>≤<italic>n</italic> are called <italic>sites</italic>. Define a <italic>solution</italic> as a pair of strings, the upper U = <italic>u</italic><sub>1</sub><italic>u</italic><sub>2</sub>…<italic>u</italic><sub>n</sub> and the lower L = <italic>l</italic><sub>1</sub><italic>l</italic><sub>2</sub>…<italic>l</italic><sub>n</sub>, that contain no ambiguous bases and yield F if superimposed onto each other. Each ordered pair of bases <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000113.e001" xlink:type="simple"/></inline-formula> is called a <italic>configuration</italic>. If <italic>a<sub>i</sub></italic> is an ambiguous base, the two corresponding alternative configurations are arbitrarily labeled with indexes <italic>z<sub>i</sub></italic> = 1 and <italic>z<sub>i</sub></italic> = 2. For example, for <italic>a<sub>i</sub></italic> = R, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000113.e002" xlink:type="simple"/></inline-formula> can be labeled as <italic>z<sub>i</sub></italic> = 1 and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000113.e003" xlink:type="simple"/></inline-formula> as <italic>z<sub>i</sub></italic> = 2. For unambiguous bases the single possible configuration, where <italic>u<sub>i</sub></italic> = <italic>l<sub>i</sub></italic>, is labeled as <italic>z<sub>i</sub></italic> = 1. The upper and the lower base in a configuration are denoted <italic>u</italic>(<italic>i</italic>, <italic>z<sub>i</sub></italic>) and <italic>l</italic>(<italic>i</italic>, <italic>z<sub>i</sub></italic>), respectively.</p>
<p>A solution in which pairwise relationships indicating positional homologies between bases of U and L have been established is called an <italic>aligned solution</italic>. Such a relationship between two identical bases is called a <italic>match</italic>, and between two different bases a <italic>mismatch</italic>. An aligned solution is diagrammatically illustrated by <xref ref-type="fig" rid="pcbi-1000113-g003">Figure 3A</xref>, in which vertical columns represent successive configurations at sites <italic>i</italic> from 1 to <italic>n</italic>. <xref ref-type="fig" rid="pcbi-1000113-g003">Figure 3B</xref> is a customary representation of the same alignment, where the vertical columns contain pairs of positional homologs, and gaps are inserted opposite to bases having no homologs. Observe that the two leftmost bases of L and one rightmost base in U can have homologs outside of F (<xref ref-type="fig" rid="pcbi-1000113-g003">Figure 3B</xref>, question marks). In contrast, the bases at site 8 in L, and sites 13 and 14 in U, according to this particular alignment, cannot have homologs. We use the term <italic>inserted base</italic> only for bases of the latter type. One or several consecutive inserted bases are called an <italic>insertion</italic>. For simplicity, we assume that all indels are insertions. For each <italic>i</italic> in an aligned solution (<xref ref-type="fig" rid="pcbi-1000113-g003">Figure 3A</xref>), we define <italic>phase shift k<sub>i</sub></italic> as the horizontal distance between <italic>u<sub>i</sub></italic> and <italic>l<sub>i</sub></italic> after insertion of gaps (<xref ref-type="fig" rid="pcbi-1000113-g003">Figure 3B</xref>). If the mixed trace has resulted from a single insertion, at all <italic>i</italic> downstream of it, <italic>k<sub>i</sub></italic> equals the number of inserted bases. In the more general case, <italic>k<sub>i</sub></italic> is determined at each <italic>i</italic> by summation of all the insertions upstream of <italic>i</italic>. Insertions into opposite allelic strings can result in the mixed trace containing phase shifts of opposite directions. However, to simplify computation, we assume that all phase shifts have the same sign and that insertion of gaps always shifts <italic>u<sub>i</sub></italic> right with respect to <italic>l<sub>i</sub></italic> (<xref ref-type="fig" rid="pcbi-1000113-g003">Figure 3 A,B</xref>). The consequences of this simplification will be discussed below. In order to specify an aligned solution of F it is sufficient to specify values <italic>z<sub>i</sub></italic> and <italic>k<sub>i</sub></italic> for each <italic>i</italic>. A configuration for which the phase shift has been specified is called the <italic>aligned configuration</italic>, denoted <italic>λ</italic>(<italic>i</italic>, <italic>z<sub>i</sub></italic>, <italic>k</italic><sub>i</sub>).</p>
<fig id="pcbi-1000113-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000113.g003</object-id><label>Figure 3</label><caption>
<title>Two renderings of the same alignment, illustrating the concept of phase shift.</title>
<p>Circles represent bases and links represent positional homologies: solid links–matches, and dashed links–mismatches. Black closed circles represent bases that have no positional homologs. In (A) vertical columns represent successive configurations of an aligned solution. The pairs of bases at sites 3, 6, and 16 are colored. Curly brackets mark segments aligned with different phase shifts. In (B) vertical columns contain pairs of positional homologs, and gaps are inserted opposite to bases having no homologs; external gaps are shown as question marks. The horizontal distances between the bases of each colored configuration (arrows) represent the corresponding phase shifts <italic>k<sub>i</sub></italic>.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000113.g003" xlink:type="simple"/></fig></sec><sec id="s2a2">
<title>Optimality criterion</title>
<p>We define the <italic>alignment score</italic> of an aligned solution as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000113.e004" xlink:type="simple"/></disp-formula>where <italic>W<sub>m</sub></italic>, <italic>W<sub>ms</sub></italic>, <italic>W<sub>i</sub></italic>, and <italic>W<sub>ib</sub></italic> are the weights of a match, mismatch, insertion, and inserted base, correspondingly. Multiplying <italic>W<sub>m</sub></italic> by <italic>n</italic> instead of the actual number of matches, which would be more intuitive, makes it possible to obtain comparable scores at each site for every putative phase shift in our dynamic programming algorithm. The <italic>optimal solution</italic> is the one that can be aligned with the maximum <italic>V</italic>. Application of this criterion alone cannot guarantee biologically meaningful results for the following reasons. When the only indel is at the beginning or upstream of F, the solutions contain no insertions. Then the optimal solution is the one which has the minimum number of mismatches. For a given <italic>n</italic>, solutions with large <italic>k<sub>i</sub></italic> always contain few mismatches simply because of the small overlap between the strings. Therefore, the chances of a solution being optimal due to pure chance increase as <italic>k<sub>i</sub></italic>/<italic>n</italic> increases. On the other hand, consider a solution with an insertion of length <italic>k<sub>i</sub></italic> and 0 mismatches and an alternative solution with a shorter insertion and <italic>x</italic>&gt;0 mismatches. The first solution is better justified biologically because it explains F with fewer mutation events. However, because insertions are penalized in proportion to their length, the second solution can be optimal. It is easy to show that in this case, too, the chances of the second solution being optimal increase as <italic>k<sub>i</sub></italic>/<italic>n</italic> increases. Therefore, to augment chances of selecting biologically meaningful optimal solutions, for each analyzed F we set an upper limit to the magnitude of putative phase shifts, denoted <italic>K<sub>max</sub></italic>. Because our method relies exclusively on the information contained in the mixed trace, it is clear that reconstruction of a large heterozygous indel must require an adequately long input sequence. Our simulations, described below, have indicated that setting <italic>K<sub>max</sub></italic> under <italic>n</italic>/10 is appropriate in many situations.</p>
</sec><sec id="s2a3">
<title>Computations</title>
<p>The goal is, therefore, to determine for each <italic>i</italic> from 1 to <italic>n</italic> such <italic>λ</italic>(<italic>i</italic>, <italic>z<sub>i</sub></italic>, <italic>k<sub>i</sub></italic>), where <italic>z<sub>i</sub></italic> = 1 or 2 and 0≤<italic>k<sub>i</sub></italic>≤<italic>K<sub>max</sub></italic>, that the resulting solution has the maximum <italic>V</italic>. In order to do it, we estimate for each <italic>λ</italic>(<italic>i</italic>, <italic>z<sub>i</sub></italic>, <italic>k</italic><sub>i</sub>) the maximum <italic>V</italic> of all the solutions containing that configuration. For any <italic>a<sub>i</sub></italic> in F consider strings F′ = <italic>a</italic><sub>1</sub><italic>a</italic><sub>2</sub>…<italic>a<sub>i</sub></italic> and F″ = <italic>a<sub>i</sub>a<sub>i</sub></italic><sub>+1</sub>…<italic>a<sub>n</sub></italic>. For each <italic>λ</italic>(<italic>i</italic>, <italic>z<sub>i</sub></italic>, <italic>k<sub>i</sub></italic>) denote the maximum <italic>V</italic> of all the aligned solutions of F′ that end with <italic>λ</italic>(<italic>i</italic>, <italic>z<sub>i</sub></italic>, <italic>k<sub>i</sub></italic>) as <italic>P</italic>(<italic>i</italic>, <italic>z<sub>i</sub></italic>, <italic>k<sub>i</sub></italic>). Denote the maximum <italic>V</italic> of all the aligned solutions of F″ that begin with <italic>λ</italic>(<italic>i</italic>, <italic>z<sub>i</sub></italic>, <italic>k<sub>i</sub></italic>) as <italic>Q</italic>(<italic>i</italic>, <italic>z<sub>i</sub></italic>, <italic>k<sub>i</sub></italic>). Let for a particular <italic>λ</italic>(<italic>i</italic>, <italic>z<sub>i</sub></italic>, <italic>k<sub>i</sub></italic>) the sum of the corresponding <italic>P</italic> and <italic>Q</italic> be the maximum of all aligned configurations at <italic>i</italic>. In that case, the maximum <italic>V</italic> of all the solutions of F containing <italic>λ</italic>(<italic>i</italic>, <italic>z<sub>i</sub></italic>, <italic>k<sub>i</sub></italic>) equals the maximum <italic>V</italic> of any solutions of F.</p>
<p>We use dynamic programming to compute for each <italic>λ</italic>(<italic>i</italic>, <italic>z<sub>i</sub></italic>, <italic>k</italic><sub>i</sub>), where <italic>z<sub>i</sub></italic> = 1 or 2 and 0≤<italic>k</italic><sub>i</sub>≤<italic>K<sub>max</sub></italic>, estimates of the corresponding <italic>P</italic> and <italic>Q</italic>, denoted respectively <italic>p</italic>(<italic>i</italic>, <italic>z<sub>i</sub></italic>, <italic>k</italic><sub>i</sub>) and <italic>q</italic>(<italic>i</italic>, <italic>z<sub>i</sub></italic>, <italic>k</italic><sub>i</sub>). The difference of these scores from <italic>P</italic> and <italic>Q</italic> will be made clear below. Because estimation of <italic>P</italic> requires information only about sites 1 to <italic>i</italic> and that of <italic>Q</italic> requires information only about sites <italic>i</italic> to <italic>n</italic>, the matrix of <italic>p</italic>(<italic>i</italic>, <italic>z<sub>i</sub></italic>, <italic>k<sub>i</sub></italic>) is computed successively from <italic>i</italic> = 1 to <italic>i</italic> = <italic>n</italic>, and the matrix of <italic>q</italic>(<italic>i</italic>, <italic>z<sub>i</sub></italic>, <italic>k<sub>i</sub></italic>) in the opposite direction. Except for the execution order, the calculations are identical for both scores. Thus, only the computation of <italic>p</italic> is explained here in detail. The initial conditions follow from the definition of <italic>V</italic>:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000113.e005" xlink:type="simple"/></disp-formula></p>
<p>An insertion results in the magnitudes of phase shift being different between two successive sites (<italic>k<sub>i</sub></italic><sub>−1</sub>≠<italic>k<sub>i</sub></italic>). Therefore, to accommodate potential insertions, for each <italic>i</italic>&gt;<italic>k<sub>i</sub></italic>, we first compute scores <italic>p</italic>′(<italic>i</italic>, <italic>z<sub>i</sub></italic>, <italic>k<sub>i</sub></italic>, <italic>k<sub>i</sub></italic><sub>−1</sub>), defined as estimates of the maximum score <italic>V</italic> of all the solutions of F′ which end with <italic>λ</italic>(<italic>i</italic>, <italic>z<sub>i</sub></italic>, <italic>k</italic><sub>i</sub>) and in which the preceding site is aligned with <italic>k<sub>i</sub></italic><sub>−1</sub>, where 0≤<italic>k<sub>i</sub></italic><sub>−1</sub>≤<italic>K<sub>max</sub></italic>. Then <italic>p</italic>(<italic>i</italic>, <italic>z<sub>i</sub></italic>, <italic>k<sub>i</sub></italic>) is given by the maximum of these scores. Therefore, for <italic>i</italic>&gt;<italic>k<sub>i</sub></italic>,<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000113.e006" xlink:type="simple"/></disp-formula>where<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000113.e007" xlink:type="simple"/></disp-formula>where<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000113.e008" xlink:type="simple"/></disp-formula>Each value <italic>p</italic>′(<italic>i</italic>, <italic>z<sub>i</sub></italic>, <italic>k<sub>i</sub></italic>, <italic>k<sub>i</sub></italic><sub>−1</sub>) is computed from the maximum value <italic>p</italic> obtained at the preceding site by adding <italic>W<sub>m</sub></italic> and, if mismatches are introduced or a new phase shift is initiated, subtracting appropriate penalties as follows:</p>
<list list-type="order"><list-item>
<p>If <italic>k<sub>i</sub></italic> = <italic>k<sub>i</sub></italic><sub>−1</sub>&gt;0, <italic>W<sub>ms</sub></italic> is subtracted when the aligned configuration <italic>λ</italic>(<italic>i</italic>, <italic>z<sub>i</sub></italic>, <italic>k</italic><sub>i</sub>) introduces a mismatch. This occurs when its lower base does not match the upper base of that configuration at the site <italic>i</italic>−<italic>k<sub>i</sub></italic> which has yielded the maximum <italic>p</italic>(<italic>i</italic>−<italic>k<sub>i</sub></italic>, <italic>z<sub>i</sub></italic>, <italic>k</italic><sub>i</sub>). This condition is identified above as <italic>M</italic> = <italic>false</italic>. Scoring for <italic>k<sub>i</sub></italic> = <italic>k<sub>i</sub></italic><sub>−1</sub> = 0 is straightforward.</p>
</list-item><list-item>
<p>If 0&lt;<italic>k<sub>i</sub></italic>&lt;<italic>k<sub>i</sub></italic><sub>−1</sub>, <italic>W<sub>ms</sub></italic> is subtracted when <italic>λ</italic>(<italic>i</italic>, <italic>z<sub>i</sub></italic>, <italic>k</italic><sub>i</sub>)introduces a mismatch, as explained above. Additionally, the affine penalty for insertion, <italic>W<sub>in</sub></italic>+<italic>W<sub>ib</sub></italic>|<italic>k<sub>i</sub></italic><sub>−1</sub>−<italic>k<sub>i</sub></italic>|, is subtracted. Note that the number of inserted bases is given by the difference between the phase shift magnitudes.</p>
</list-item><list-item>
<p>If <italic>k<sub>i</sub></italic>&gt;<italic>k<sub>i</sub></italic><sub>−1</sub>, the affine penalty for insertion is subtracted as above. However, the penalty for mismatch is not subtracted even if the lower base of <italic>λ</italic>(<italic>i</italic>, <italic>z<sub>i</sub></italic>, <italic>k</italic><sub>i</sub>) introduces a mismatch. This point is explained by the following consideration. If a solution contains a transition from a smaller to a larger phase shift in the left to right direction, some bases in the lower string will be inserted bases (<xref ref-type="fig" rid="pcbi-1000113-g003">Figure 3</xref>). Scoring mismatches with such bases, which in fact have no homologs, will lead to spurious scores. We avoid this error by not evaluating the lower base of the configuration for mismatches in all cases when <italic>k<sub>i</sub></italic>&gt;<italic>k<sub>i</sub></italic><sub>−1</sub> is hypothesized. As a result, both alternative configurations <italic>z<sub>i</sub></italic> receive equal scores <italic>p</italic>. Therefore, for selected configurations, scores <italic>p</italic> may overestimate the true <italic>P</italic>. This approach may result in some of the sites remaining undecoded by the algorithm (for an additional mechanism attempting to reconstruct these sites see below), but not in errors. Computation of <italic>q</italic> includes a similar provision for the cases when <italic>k<sub>i</sub></italic>&gt;<italic>k<sub>i</sub></italic><sub>+1</sub> is hypothesized, which allows to avoid scoring spurious mismatches with inserted bases in the upper string.</p>
</list-item></list>
<p>For each <italic>i</italic>, the aligned configuration <italic>λ</italic>(<italic>i</italic>, <italic>z<sub>i</sub></italic>, <italic>k<sub>i</sub></italic>) which has yielded the maximum<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000113.e009" xlink:type="simple"/></disp-formula>is selected to include in the estimate of the optimal solution. However, if <italic>K<sub>max</sub></italic> is set too high, at a small number of consecutive sites, configurations aligned with large <italic>k<sub>i</sub></italic> can receive maximum <italic>ω</italic> simply due to the large magnitude of the hypothesized phase shift (see above about the imperfection of the optimality criterion). These results in reconstructions containing a large insertion compensated for after just a few sites by an equally large deletion. To minimize the risk of this error, any <italic>k<sub>i</sub></italic> which does not yield maximum <italic>ω</italic> in at least <italic>k<sub>i</sub></italic>+1 consecutive sites is ignored, in which case the configurations yielding the next highest <italic>ω</italic> are selected. If two alternative configurations <italic>z<sub>i</sub></italic> yield equal <italic>ω</italic>, with the same or with different phase shifts, the site remains ambiguous. This initial part of the decoding process is illustrated in <xref ref-type="fig" rid="pcbi-1000113-g004">Figure 4(A–G)</xref>. The dynamic programming algorithm runs in space proportional to <italic>n</italic>(<italic>K<sub>max</sub></italic>+1) and in time proportional to <italic>n</italic>(<italic>K<sub>max</sub></italic>+1)<sup>2</sup>. The web server implementation of the algorithm requires approximately 3 sec to process a 500 bp input fragment when <italic>K<sub>max</sub></italic> is set to 15 bp.</p>
<p>As a result of the conservative approach to scoring inserted bases, explained above, both alternative configurations in the vicinity of an indel may receive equal scores <italic>ω</italic>. An additional, post-processing algorithm attempts to reconstruct such ambiguous sites by considering consequences of each configuration being aligned with either of the two phase shifts reconstructed in the adjacent regions at the previous step. Aligned configurations that introduce minimum mismatches are incorporated in the output solution. For example, in <xref ref-type="fig" rid="pcbi-1000113-g004">Figure 4E</xref> both configurations at <italic>i</italic> = 8 have received equal <italic>ω</italic>. It is easy to see that only <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000113.e010" xlink:type="simple"/></inline-formula> can be incorporated without creating a mismatch (<xref ref-type="fig" rid="pcbi-1000113-g004">Figure 4H</xref>), and therefore it is included in the final reconstruction (<xref ref-type="fig" rid="pcbi-1000113-g004">Figure 4I</xref>).</p>
<fig id="pcbi-1000113-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000113.g004</object-id><label>Figure 4</label><caption>
<title>Main steps in decoding of a mixed trace.</title>
<p>For the purpose of illustration, <italic>K<sub>max</sub></italic> is set to 2, and the weights <italic>W<sub>m</sub></italic>, <italic>W<sub>ms</sub></italic>, <italic>W<sub>in</sub></italic>, and <italic>W<sub>ib</sub></italic> are all set to 1. Alternative configurations for each site of the input fragment F (A) are stored in the matrix (B). For each <italic>k<sub>i</sub></italic> considered, 0, 1, and 2, a separate matrix is computed for <italic>p</italic> (C) and for <italic>q</italic> (D). Matrices for <italic>k<sub>i</sub></italic>&gt;0 are initialized with basal values at each <italic>i</italic>≤<italic>k<sub>i</sub></italic>, shown in the grey cells. The remaining cells in the <italic>p</italic> matrices are filled out successively left to right and in the <italic>q</italic> matrices right to left. Each column has to be computed in all three matrices (one for each <italic>k<sub>i</sub></italic>) before proceeding to the next site. For <italic>i</italic>&gt;<italic>k<sub>i</sub></italic>, computing each <italic>p</italic> and <italic>q</italic> requires first computing three <italic>p</italic>′ and <italic>q</italic>′ scores, correspondingly, one for each possible phase shift at the, respectively, preceding or following site. These calculations are omitted for space reasons, except for <italic>p</italic>(6, 2, 1), included as an example. The matrix of <italic>ω</italic>(<italic>i</italic>, <italic>z<sub>i</sub></italic>, <italic>k<sub>i</sub></italic>) is obtained by summation of <italic>p</italic> and <italic>q</italic> matrices; for each <italic>i</italic> the maximum values <italic>ω</italic> are highlighted (E). The configurations that received the maximum <italic>ω</italic>, and the corresponding <italic>k<sub>i</sub></italic> are selected (F) to form the aligned solution (G). The site 7 remains ambiguous because both corresponding alternative configurations have yielded equal <italic>ω</italic>. The post-processing algorithm determines that only one of these can be incorporated without mismatches (H). The optimal aligned solution is output in the customary form (I). Symbols and conventions are as in <xref ref-type="fig" rid="pcbi-1000113-g003">Figure 3</xref>, except the bases having no homologs are shown on a black background.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000113.g004" xlink:type="simple"/></fig>
<p>When both alternative configurations yield optimal reconstructions, the site remains ambiguous in the output. This occurs when multiple cooptimal solutions of F objectively exist (<xref ref-type="fig" rid="pcbi-1000113-g005">Figure 5</xref>). In that case the output represents the consensus of cooptimal solutions.</p>
<fig id="pcbi-1000113-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000113.g005</object-id><label>Figure 5</label><caption>
<title>Examples of four main situations in which a mixed sequence fragment can have multiple cooptimal solutions.</title>
<p>The fragments are shown on top of each panel, with their aligned optimal solutions and consensuses of these (on a yellow background) shown below. Solid links represent matches and dashed links mismatches, letters on a grey background represent bases with no positional homologs, blue letters represent ambiguous bases, and red letters mismatching bases. Configurations yielding equal maximum scores <italic>ω</italic> in (B), (C), and (D) are boxed. For the meanings of the IUPAC symbols see <xref ref-type="fig" rid="pcbi-1000113-g001">Figure 1</xref>. (A) A fully periodic fragment. Only three of 11 cooptimal solutions with different single phase shifts are shown. The consensus of these solutions is identical to the mixed fragment itself. (B) A fragment containing an ambiguous base (here “K”) repeated throughout the length of the fragment at regular intervals coinciding with the magnitude of the phase shift. The corresponding sites remain ambiguous in the consensus. Cooptimal solutions of this type are found mostly among fragments that are short with respect to the indel. (C) A fragment having cooptimal solutions with the same number but different locations of mismatches. Note that mismatches can either represent SNPs or result from basecalling errors. (D) A fragment containing an insertion that can be variably positioned. At one site, both alternative configurations yield maximum <italic>ω</italic>, each with a different phase shift.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000113.g005" xlink:type="simple"/></fig>
<p>At the sites in the vicinity of an indel the same <italic>z<sub>i</sub></italic> can yield the maximum <italic>ω</italic> when aligned with two different phase shifts <italic>k<sub>i</sub></italic>. This occurs when multiple alignments of the same optimal solution, with alternative placements of the gap, are possible. Such floating gaps occur when an insertion begins or ends with the base identical to the base following or preceding the insertion, respectively. In these cases, the most likely position of the gap can sometimes be determined from structural considerations <xref ref-type="bibr" rid="pcbi.1000113-Mller1">[17]</xref>.</p>
<p>Decoding mixed traces resulting from multiple indels presents a special difficulty because any change in the phase shift, except changes from or to <italic>k<sub>i</sub></italic> = 0, can be explained alternatively by a short or a long insertion placed in the opposite strings (<xref ref-type="fig" rid="pcbi-1000113-g006">Figure 6A and 6B</xref>). Either variant can be optimal, depending on the weighting scheme. However, because the scores are computed under the assumption that all phase shifts have the same direction, only the short variant is reconstructed (<xref ref-type="fig" rid="pcbi-1000113-g006">Figure 6B</xref>). For a practical solution, which allows to visualize alternative reconstructions of an indel, see the next section. The problem can be avoided by analyzing both direct and reverse sequences of the same template. Note that decoding of sequences resulting from a single indel does not involve an uncertainty of this kind.</p>
<fig id="pcbi-1000113-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000113.g006</object-id><label>Figure 6</label><caption>
<title>Two aligned solutions of the same mixed fragment, representing the transition between the phase shifts <italic>k<sub>i</sub></italic> = 2 and <italic>k<sub>i</sub></italic> = 3, alternatively, as a “long” insertion (A) or a “short” insertion (B).</title>
<p>Bases corresponding to the lower allelic string in (A) are highlighted with grey. Note that one solution can be obtained from another by swapping the parts of the allelic strings between sites 8 and 16 (orange box).</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000113.g006" xlink:type="simple"/></fig>
<p>In practice, traces occasionally contain sites with more than two superimposed peaks. Therefore, we have modified the above algorithm to additionally handle IUPAC symbols for 3-fold degenerate bases (B, H, D, V) and unknown bases (N). For a site containing one of these symbols, a single configuration, where <italic>u<sub>i</sub></italic> = <italic>l<sub>i</sub></italic>, is considered. Therefore, the site remains ambiguous until the alignment of the optimal solution is produced. Then, if two homologous symbols represent, respectively, sets of bases <italic>X</italic> and <italic>Y</italic>, the intersection <italic>X</italic> ∩ <italic>Y</italic> is written into both strings.</p>
</sec></sec><sec id="s2b">
<title>Implementation</title>
<p>The method has been implemented as a free web application Indelligent (<ext-link ext-link-type="uri" xlink:href="http://ctap.inhs.uiuc.edu/dmitriev/indel.asp" xlink:type="simple">http://ctap.inhs.uiuc.edu/dmitriev/indel.asp</ext-link>). The program takes as input a sequence of IUPAC symbols representing non-degenerate and degenerate nucleotide bases. Such sequences are output by customary autosequencer software, such as PHRED <xref ref-type="bibr" rid="pcbi.1000113-Ewing1">[18]</xref> or KBBasecaller (Applied Biosystems). In the trace files output by other basecallers, the sites containing superimposed peaks can be recalled with IUPAC symbols using Sequencher (Gene Codes Corp., Ann Arbor, MI). The default weighting scheme is <italic>W<sub>m</sub></italic>, <italic>W<sub>ms</sub></italic>, <italic>W<sub>ib</sub></italic> = 1, and <italic>W<sub>in</sub></italic> = 2. Because of the prevalence of short indels, in order to speed up computations, the default <italic>K<sub>max</sub></italic> is 15 bp. The user can change <italic>W<sub>in</sub></italic> to any positive integer, and <italic>K<sub>max</sub></italic> to any positive integer up to half length of the input sequence. The program outputs a pair of aligned reconstructed allelic sequences. Floating gaps can be aligned, alternatively, left or right. Additionally, the <italic>Display “long” indels</italic> option swaps parts of the predicted allelic sequences to display the alternative, long reconstruction of the indel (<xref ref-type="fig" rid="pcbi-1000113-g006">Figure 6</xref>). The source code, free for non-commercial users, is available at the Indelligent web site.</p>
</sec><sec id="s2c">
<title>Validation tests</title>
<sec id="s2c1">
<title>Simulations</title>
<p>Pairs of identical strings composed of random bases A, C, G, and T, selected with equal probability, were generated and shifted with respect to each other by inserting additional bases into one or both strings. To simulate single nucleotide polymorphisms (SNPs), point differences between the strings were introduced at randomly chosen sites in the overlapping parts of the strings. The consensus of the strings, except the overhanging parts at the beginning and end, was input for analysis. For each combination of tested parameters (see below) 1,000 sequence fragments were generated and analyzed with the default weighting scheme. For each fragment, the upper output string was compared to the upper generated string and the number of positions reconstructed correctly and unambiguously, ambiguously, or incorrectly, was recorded. We also recorded whether the correct phase shifts were detected. Three sets of experiments were conducted:</p>
<p><italic>One phase shift: 5 bp</italic>. 50, 75, and 100 bp fragments were generated from string pairs containing an extra 5 bp at the origin of one string. This corresponds to the practical situation when one attempts to unscramble the mixed trace downstream of a single insertion. Seven levels of divergence between alleles, from 0 to 20%, were set by varying the number of point differences; exact divergencies varied between lengths. The maximum divergence tested exceeded the record average nucleotide heterozygosity observed in nature <xref ref-type="bibr" rid="pcbi.1000113-Small1">[19]</xref> more than four times. The analyses were run with <italic>K<sub>max</sub></italic> = 15 bp.</p>
<p><italic>Two phase shifts: 0 bp and x&gt;0 bp</italic>. Because, in real applications, a mixed trace usually follows an unambiguous trace (<xref ref-type="fig" rid="pcbi-1000113-g001">Figure 1</xref>), we simulated fragments containing such a transition. 100 bp fragments were generated from string pairs containing a single insertion of 1, 7, 10, 12, or 14 bp in the middle of one string. The tested size range accommodated the vast majority of indel sizes encountered in nature <xref ref-type="bibr" rid="pcbi.1000113-Small1">[19]</xref>–<xref ref-type="bibr" rid="pcbi.1000113-Mills1">[24]</xref>. The analyses were run with <italic>K<sub>max</sub></italic> = 25 bp.</p>
<p><italic>Two phase shifts: x, y&gt;0 bp</italic>. To assess how the program handles mixed fragments resulting from multiple indels, 100 bp fragments were generated from string pairs containing an extra 3, 5, or 8 bp at the origin of one string and an 8 bp insertion in the middle of the same or the opposite strings. No SNPs were simulated in this experiment. The analyses were run with <italic>K<sub>max</sub></italic> = 25.</p>
</sec><sec id="s2c2">
<title>Human traces</title>
<p>198 mixed human traces in which Bhangale et al. <xref ref-type="bibr" rid="pcbi.1000113-Bhangale1">[3]</xref> discovered heterozygous indels between 5 and 30 bp, were obtained from NCBI Trace Archive (<ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/Traces/trace.cgi" xlink:type="simple">http://www.ncbi.nlm.nih.gov/Traces/trace.cgi</ext-link>). Because large indels are harder to reconstruct, we did not test the program on the traces containing short indels, reported in the same study. The Sequencher Ver 4.6 (Gene Codes Corp., Ann Arbor, MI) program was used to call secondary peaks at least 20% as high as the primary peaks in each trace. The traces were then inspected and basecalling errors were corrected manually to the degree possible. For each trace, the fragment to analyze was determined as follows. Because in areas of repeated sequence the entire indel or a part of it can be located upstream of the first double peak observed, 100 sites upstream of the first double peak or as many as available were included. To account for deterioration of signal toward the end of each trace, we marked the position where the first 3-fold degenerate site was encountered that could not be confidently recoded as a 2-fold degenerate site as the end of the potentially interpretable fragment. Traces of low quality and those yielding less than 100 bp of potentially interpretable mixed trace were excluded. The remaining 104 fragments, containing 103–677 bp (mean 294±126, SD) of mixed trace, were analyzed with <italic>K<sub>max</sub></italic> = 30 bp, <italic>W<sub>m</sub></italic>, <italic>W<sub>ms</sub></italic>, <italic>W<sub>ib</sub></italic> = 1, and <italic>W<sub>in</sub></italic> = 2. Floating gaps were aligned in the extreme left position. For each fragment analyzed, the reconstructed insertion plus the strict consensus of two aligned reconstructed allelic sequences downstream of it were aligned with 50 best matching human sequences in NCBI Trace Archive database using BLASTN 2.2.17 (<ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/BLAST/" xlink:type="simple">http://www.ncbi.nlm.nih.gov/BLAST/</ext-link>) <xref ref-type="bibr" rid="pcbi.1000113-Altschul1">[25]</xref> with default parameters and no filtering of low-complexity regions. We assumed that most polymorphisms in the analyzed mixed traces must be represented among sequences in the database. Therefore, an unambiguously reconstructed site was scored as an error if none of the matching database sequences contained the same base, and as correct otherwise. An ambiguous site was scored as a putative SNP if it represented two bases and each was present in at least one of the database sequences, as an error if neither was present, and as ambiguous otherwise. Finally, we reexamined the traces to determine whether the erroneous reconstructions have resulted from basecalling errors.</p>
</sec></sec><sec id="s2d">
<title>Indelligent <italic>vs.</italic> ShiftDetector</title>
<p>We used human traces also to compare the proportions of ambiguous sites decoded by ShiftDetector <xref ref-type="bibr" rid="pcbi.1000113-Seroussi1">[15]</xref> and by Indelligent. Because the first program takes as input raw chromatogram files and the second takes sequences, in order to minimize the effect of this difference on the results we manually selected among the trace files listed by Bhangale et al. <xref ref-type="bibr" rid="pcbi.1000113-Bhangale1">[3]</xref> 55 chromatograms containing 4 or 5 bp heterozygous indels, each with at least 100 bp of high-quality mixed trace (<italic>i.e.</italic>, with primary and secondary peaks well aligned, and no tertiary peaks or background noise). For details on the chromatograms see <xref ref-type="supplementary-material" rid="pcbi.1000113.s005">Table S5</xref>. Secondary peaks were called using Sequencher as described above, and the resulting sequences were input to Indelligent without prior editing. The raw files were processed with ShiftDetector. For each trace, we determined the number of ambiguous sites in the first 100 bp following the indel, as decoded by each program. For Indelligent, we scored ambiguities in the strict consensus of two reconstructed allelic sequences, which is equivalent to the single sequence output by ShiftDetector.</p>
</sec></sec><sec id="s3">
<title>Results</title>
<p>In the experiments on simulated fragments with a single 5 bp phase shift, the proportion of 50 bp fragments reconstructed with the single correct phase shifts was 100% up to 6.7% divergence and progressively decreased at larger divergences. For both 75 bp and 100 bp fragments, no false phase shifts were found up to 11.4% and 15.8% divergencies, respectively. For divergencies up to 4%, the mean number of incorrect bases per decoded string was 0.1–0.4% (SD&lt;0.7%) for all fragment lengths tested (<xref ref-type="fig" rid="pcbi-1000113-g007">Figure 7A</xref>). The proportion of errors increased with increasing divergence. In 50 bp fragments it grew markedly faster after ca. 10% divergence as a consequence of the increased number of reconstructed false phase shifts 10–15 bp long. The mean proportion of ambiguous bases per reconstructed string increased as approximately 0.7(<italic>divergence between alleles</italic>) regardless of the length of the fragment (<xref ref-type="fig" rid="pcbi-1000113-g007">Figure 7B</xref>). For detailed results see <xref ref-type="supplementary-material" rid="pcbi.1000113.s001">Table S1</xref>.</p>
<fig id="pcbi-1000113-g007" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000113.g007</object-id><label>Figure 7</label><caption>
<title>Accuracy of decoding of simulated mixed fragments formed by 5 bp shift at the origin of one of two allelic strings.</title>
<p>The horizontal axis represents divergence between the allelic strings forming each fragment. (A) Mean percent of erroneous bases per reconstructed string. (B) Mean percent of ambiguous bases per reconstructed string. Each point represents the mean of 1,000 runs. For SD and additional statistics, see <xref ref-type="supplementary-material" rid="pcbi.1000113.s001">Table S1</xref>.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000113.g007" xlink:type="simple"/></fig>
<p>In the tests simulating a transition between the unambiguous and mixed parts of a trace, the accuracy of reconstruction dropped sharply for indels above 10 bp (<xref ref-type="fig" rid="pcbi-1000113-g008">Figure 8A</xref>) due to the increased number of fragments reconstructed with incorrect, shorter phase shifts (<xref ref-type="fig" rid="pcbi-1000113-g008">Figure 8B</xref>). For smaller indels, the mean number of errors did not exceed 1.2% per string for allelic divergencies up to 4.4% (<xref ref-type="supplementary-material" rid="pcbi.1000113.s002">Table S2</xref>).</p>
<fig id="pcbi-1000113-g008" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000113.g008</object-id><label>Figure 8</label><caption>
<title>Accuracy of decoding of simulated 100 bp mixed fragments containing a single insertion of variable size in the middle.</title>
<p>(A) Mean percent of erroneous bases per reconstructed string. (B) Percent of fragments reconstructed with incorrect indels. Each point represents 1,000 runs. For SD and additional statistics, see <xref ref-type="supplementary-material" rid="pcbi.1000113.s002">Table S2</xref>.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000113.g008" xlink:type="simple"/></fig>
<p>100 bp fragments resulting from two indels were decoded with a mean of 1.4% of errors per string or less, except in the experiment with a 8 bp shift at the origin and additional 8 bp inserted in the middle of the same string, in which the accuracy of decoding was lower (<xref ref-type="supplementary-material" rid="pcbi.1000113.s003">Table S3</xref>).</p>
<p>102 human mixed sequences were reconstructed with a single indel and two sequences with two indels. 67 fragments were reconstructed without errors, 31 with 1–2 errors, and six with 3–7 errors. The mean number of erroneously reconstructed bases per fragment was 0.66 (SD = 1.21). Because no correlation was found between the fragment length and the number of errors (P = 0.572), the error rate per base is not reported. Half of the fragments were reconstructed without ambiguities and half with 1–10 ambiguous bases. The mean number of bases reconstructed correctly and unambiguously per fragment was 99.1% (SD = 1.25, minimum 92.5, median 99.6). Reexamination of traces revealed that at least 41 (59.4%) errors resulted from incorrect basecalling, mostly in low-quality trace regions. Details on the results are given in <xref ref-type="supplementary-material" rid="pcbi.1000113.s004">Table S4</xref>.</p>
<p>In our comparisons, Indelligent decoded 92.8 to 100.0% of ambiguous sites (mean 98.9±1.95%, SD, median 100%), while ShiftDetector decoded only 56.0 to 85.5% of ambiguous sites (mean 72.5±6.47%, SD, median 73.0%). The details are given in <xref ref-type="supplementary-material" rid="pcbi.1000113.s005">Table S5</xref>.</p>
</sec><sec id="s4">
<title>Discussion</title>
<p>We have demonstrated that an individual mixed trace formed by single or multiple heterozygous indels can be deconvoluted with a high degree of accuracy in the absence of additional information. Because the method estimates optimal solutions as pairs of maximally similar strings, it is expected to produce errors in proportion to the degree of divergence between the superimposed allelic sequences (<xref ref-type="fig" rid="pcbi-1000113-g007">Figure 7A</xref> and <xref ref-type="fig" rid="pcbi-1000113-g008">8A</xref>). While errors can occur even if phase shifts are determined correctly (when the optimal solution contains less mismatches than was actually present between the superimposed allelic sequences), their number increases dramatically when false phase shifts are found. To minimize the chance of reconstructing false phase shifts, <italic>K<sub>max</sub></italic> should be set appropriately low with respect to the fragment length. In experiments with the 100 bp fragments simulating a transition between unambiguous and mixed traces, the accuracy dropped for <italic>k<sub>i</sub></italic>&gt;10 bp (<xref ref-type="fig" rid="pcbi-1000113-g008">Figure 8A</xref>). For larger indels, both lowering <italic>K<sub>max</sub></italic> or increasing the length of the analyzed fragment can improve results.</p>
<p>Experiments with fragments of variable length demonstrated that, if <italic>K<sub>max</sub></italic> is set appropriately, the accuracy is similar for different fragment lengths (75 and 100 bp fragments, <xref ref-type="fig" rid="pcbi-1000113-g007">Figure 7A and 7B</xref>). Therefore, although our simulation tests were conducted on relatively short fragments, the results can be extrapolated to longer sequences.</p>
<p>The highest accuracy of reconstruction is achieved when the analyzed fragment is significantly larger than the indel (ca. 10 times with the default weighting scheme) and when it is formed by highly similar allelic sequences. These conditions occur in the vast majority of cases when heterozygous indels are encountered. Indels between 1 and 10 bp in size account for the majority of indels in the genomes of man (92.3%, calculated from data in <xref ref-type="bibr" rid="pcbi.1000113-Mills1">[24]</xref>) and other eukaryotes <xref ref-type="bibr" rid="pcbi.1000113-Small1">[19]</xref>–<xref ref-type="bibr" rid="pcbi.1000113-Cooper1">[23]</xref>. Therefore, in most cases the length of the available mixed sequence is sufficient for its decoding. The average divergence between two sequences randomly drawn from a population does not exceed 0.1% for human noncoding DNA <xref ref-type="bibr" rid="pcbi.1000113-Zhao1">[26]</xref>, 1–2% for fruit fly noncoding DNA <xref ref-type="bibr" rid="pcbi.1000113-Moriyama1">[27]</xref>, with the overall record of 4.5% measured for the genomic DNA of sea squirts <xref ref-type="bibr" rid="pcbi.1000113-Small1">[19]</xref>. Our simulations indicated that, within this range of within-individual allelic divergence, the average number of erroneously reconstructed bases per fragment is expected to be between 0 and 1.2% if the weighting scheme and <italic>K<sub>max</sub></italic> are properly chosen. In practice, however, the accuracy of reconstruction is affected by basecalling errors, which are particularly frequent in calling superimposed peaks. In our tests, reexamination of the human traces revealed that ca. 60% of the erroneously reconstructed sites were due to basecalling errors missed during the initial inspection of the recalled trace. Other base predictions scored as errors are likely to represent rare polymorphisms absent in the database. Therefore, the reported mean of 0.66 errors per reconstructed fragment must considerably underestimate the potential accuracy of the method.</p>
<p>The method is capable of reconstructing mixed traces resulting from multiple indels. Yet, when the distance between two adjacent indels is small, the cost of an additional insertion can be higher than the cost of mismatches in the alternative solution. Therefore, the success of decoding depends on the particular weighting scheme and how widely the adjacent indels are spaced. Failed reconstructions generally result in a large number of mismatches and ambiguities in the output. This allows adjusting parameters iteratively until a satisfactory reconstruction is obtained. Incorporating a test of the statistical significance of reconstructed optimal solutions in the future would give the method additional robustness.</p>
<p>Indelligent outperforms ShiftDetector <xref ref-type="bibr" rid="pcbi.1000113-Seroussi1">[15]</xref> by producing a complete, biallelic reconstruction for the entire input fragment, including single or multiple indels. Even more importantly, it decodes all or nearly all input ambiguous sites, extracting all the information that can be extracted from an individual mixed trace. The method can find application in all situations where mixed traces formed by heterozygous indels are encountered, including situations where neither a suitable reference, nor a reverse trace are available, or when speed is crucial. It can be easily bundled with tools for chromatogram processing, sequence editing, and mutation discovery. In addition to applications aimed at detection and characterization of nucleotide polymorphisms, unscrambling of mixed traces is crucial in situations where the obscured sequence downstream of the indel is of primary interest. In particular, the new method can be used in the molecular phylogenetic studies of introns and intergenic regions, which provide fast-evolving nuclear markers for estimating relationships between recently diverged taxa, but often are hard to sequence directly because of the high frequency of indels <xref ref-type="bibr" rid="pcbi.1000113-Creer1">[28]</xref>. In such projects, the method can serve as a cost-efficient alternative to expensive cloning. For example, we successfully used Indelligent to decode mixed traces obtained by direct sequencing of an indel-rich intron region of the elongation factor-1 alpha gene for a phylogenetic study of the little-studied leafhopper genus <italic>Cuerna</italic> (Insecta, Hemiptera, Cicadellidae), for which no sequences were available to use as a reference. The results of this study will be published separately.</p>
</sec><sec id="s5">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1000113.s001" mimetype="application/msword" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000113.s001" xlink:type="simple"><label>Table S1</label><caption>
<p>Accuracy of decoding of simulated mixed fragments formed by 5 bp shift at the origin of one of two allelic strings. Each row summarizes analyses of 1,000 fragments. For details on the experiments see <xref ref-type="sec" rid="s2">Materials and Methods</xref>.</p>
<p>(0.06 MB DOC)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000113.s002" mimetype="application/msword" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000113.s002" xlink:type="simple"><label>Table S2</label><caption>
<p>Accuracy of decoding of simulated mixed 100 bp fragments formed by inserting variable number of bases in the middle of one of two allelic strings. Each row summarizes analyses of 1,000 fragments. For details on the experiments see <xref ref-type="sec" rid="s2">Materials and Methods</xref>.</p>
<p>(0.09 MB DOC)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000113.s003" mimetype="application/msword" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000113.s003" xlink:type="simple"><label>Table S3</label><caption>
<p>Accuracy of decoding of simulated 100 bp fragments resulted from two indel events: shifting the origin of one of two allelic strings x bp and insertion of y bp in the middle of the same (location indicated as “+”) or the opposite (“−”) strings. Each row summarizes analyses of 1,000 fragments. For details on the experiments see <xref ref-type="sec" rid="s2">Materials and Methods</xref>.</p>
<p>(0.04 MB DOC)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000113.s004" mimetype="application/msword" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000113.s004" xlink:type="simple"><label>Table S4</label><caption>
<p>Decoded mixed human traces, and the number of errors, putative SNPs, and other ambiguous bases in the consensus reconstructions as revealed by BLASTN comparisons with sequences in the NCBI Trace Archive database.</p>
<p>(0.21 MB DOC)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000113.s005" mimetype="application/msword" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000113.s005" xlink:type="simple"><label>Table S5</label><caption>
<p>Completeness of reconstruction by ShiftDetector and by Indelligent, measured as the percentage of the input ambiguous sites decoded by each program.</p>
<p>(0.08 MB DOC)</p>
</caption></supplementary-material></sec></body>
<back>
<ack>
<p>The authors thank Saurabh Sinha for valuable discussion and, particularly, for suggesting the dynamic programming approach to the problem, Tushar Bhangale for providing information which enabled us to obtain human traces for testing the program, Chris Dietrich for helpful comments and support, and Yevgenya Movshovich for advice on describing the algorithm. Two anonymous reviewers provided insightful comments, which helped improve the quality of the text.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1000113-Tenney1"><label>1</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Tenney</surname><given-names>AE</given-names></name>
<name name-style="western"><surname>Wu</surname><given-names>JQ</given-names></name>
<name name-style="western"><surname>Langton</surname><given-names>L</given-names></name>
<name name-style="western"><surname>Klueh</surname><given-names>P</given-names></name>
<name name-style="western"><surname>Quatrano</surname><given-names>R</given-names></name>
<etal/></person-group>             <year>2007</year>             <article-title>A tale of two templates: Automatically resolving double traces has many applications, including efficient PCR-based elucidation of alternative splices.</article-title>             <source>Genome Res</source>             <volume>17</volume>             <fpage>212</fpage>             <lpage>218</lpage>          </element-citation></ref>
<ref id="pcbi.1000113-SousaSantos1"><label>2</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Sousa-Santos</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Robalo</surname><given-names>JI</given-names></name>
<name name-style="western"><surname>Collares-Pereira</surname><given-names>MJ</given-names></name>
<name name-style="western"><surname>Almada</surname><given-names>VC</given-names></name>
</person-group>             <year>2005</year>             <article-title>Heterozygous indels as useful tools in the reconstruction of DNA sequences and in the assessment of ploidy level and genomic constitution of hybrid organisms.</article-title>             <source>DNA Seq</source>             <volume>16</volume>             <fpage>462</fpage>             <lpage>467</lpage>          </element-citation></ref>
<ref id="pcbi.1000113-Bhangale1"><label>3</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Bhangale</surname><given-names>TR</given-names></name>
<name name-style="western"><surname>Rieder</surname><given-names>MJ</given-names></name>
<name name-style="western"><surname>Livingston</surname><given-names>RJ</given-names></name>
<name name-style="western"><surname>Nickerson</surname><given-names>DA</given-names></name>
</person-group>             <year>2005</year>             <article-title>Comprehensive identification and characterization of diallelic insertion-deletion polymorphisms in 330 human candidate genes.</article-title>             <source>Hum Mol Genet</source>             <volume>14</volume>             <fpage>59</fpage>             <lpage>69</lpage>          </element-citation></ref>
<ref id="pcbi.1000113-Bhangale2"><label>4</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Bhangale</surname><given-names>T</given-names></name>
<name name-style="western"><surname>Stephens</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Nickerson</surname><given-names>D</given-names></name>
</person-group>             <year>2006</year>             <article-title>Automating resequencing-based detection of insertion-deletion polymorphisms.</article-title>             <source>Nat Genet</source>             <volume>38</volume>             <fpage>1457</fpage>             <lpage>1462</lpage>          </element-citation></ref>
<ref id="pcbi.1000113-Flot1"><label>5</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Flot</surname><given-names>J-F</given-names></name>
<name name-style="western"><surname>Tillier</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Samadi</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Tillier</surname><given-names>S</given-names></name>
</person-group>             <year>2006</year>             <article-title>Phase determination from direct sequencing of length-variable DNA regions.</article-title>             <source>Mol Ecology Notes</source>             <volume>6</volume>             <fpage>627</fpage>             <lpage>630</lpage>          </element-citation></ref>
<ref id="pcbi.1000113-Mardis1"><label>6</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Mardis</surname><given-names>ER</given-names></name>
</person-group>             <year>2008</year>             <article-title>The impact of next-generation sequencing technology on genetics.</article-title>             <source>Trends Genet</source>             <volume>24</volume>             <fpage>133</fpage>             <lpage>141</lpage>          </element-citation></ref>
<ref id="pcbi.1000113-Pop1"><label>7</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Pop</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Salzberg</surname><given-names>SL</given-names></name>
</person-group>             <year>2008</year>             <article-title>Bioinformatics challenges of new sequencing technology.</article-title>             <source>Trends Genet</source>             <volume>24</volume>             <fpage>142</fpage>             <lpage>149</lpage>          </element-citation></ref>
<ref id="pcbi.1000113-Staden1"><label>8</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Staden</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Beal</surname><given-names>KF</given-names></name>
<name name-style="western"><surname>Bonfield</surname><given-names>JK</given-names></name>
</person-group>             <year>2000</year>             <article-title>The Staden package, 1998.</article-title>             <source>Methods Mol Biol</source>             <volume>132</volume>             <fpage>115</fpage>             <lpage>130</lpage>          </element-citation></ref>
<ref id="pcbi.1000113-Weckx1"><label>9</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Weckx</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Del-Favero</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Rademakers</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Claes</surname><given-names>L</given-names></name>
<name name-style="western"><surname>Cruts</surname><given-names>M</given-names></name>
<etal/></person-group>             <year>2005</year>             <article-title>novoSNP, a novel computational tool for sequence variation discovery.</article-title>             <source>Genome Res</source>             <volume>15</volume>             <fpage>436</fpage>             <lpage>442</lpage>          </element-citation></ref>
<ref id="pcbi.1000113-Manaster1"><label>10</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Manaster</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Zheng</surname><given-names>W</given-names></name>
<name name-style="western"><surname>Teuber</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Wächter</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Döring</surname><given-names>F</given-names></name>
<etal/></person-group>             <year>2005</year>             <article-title>InSNP: A tool for automated detection and visualization of SNPs and InDels.</article-title>             <source>Human Mutation</source>             <volume>26</volume>             <fpage>11</fpage>             <lpage>19</lpage>          </element-citation></ref>
<ref id="pcbi.1000113-Chen1"><label>11</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Chen</surname><given-names>K</given-names></name>
<name name-style="western"><surname>McLellan</surname><given-names>MD</given-names></name>
<name name-style="western"><surname>Ding</surname><given-names>L</given-names></name>
<name name-style="western"><surname>Wendl</surname><given-names>MC</given-names></name>
<name name-style="western"><surname>Kasai</surname><given-names>Y</given-names></name>
<etal/></person-group>             <year>2007</year>             <article-title>PolyScan: an automatic indel and SNP detection approach to the analysis of human resequencing data.</article-title>             <source>Genome Res</source>             <volume>17</volume>             <fpage>659</fpage>             <lpage>666</lpage>          </element-citation></ref>
<ref id="pcbi.1000113-Dicks1"><label>12</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Dicks</surname><given-names>E</given-names></name>
<name name-style="western"><surname>Teague</surname><given-names>JW</given-names></name>
<name name-style="western"><surname>Stephens</surname><given-names>P</given-names></name>
<name name-style="western"><surname>Raine</surname><given-names>K</given-names></name>
<name name-style="western"><surname>Yates</surname><given-names>A</given-names></name>
<etal/></person-group>             <year>2007</year>             <article-title>AutoCSA, an algorithm for high throughput DNA sequence variant detection in cancer genomes.</article-title>             <source>Bioinformatics</source>             <volume>13</volume>             <fpage>1689</fpage>             <lpage>1691</lpage>          </element-citation></ref>
<ref id="pcbi.1000113-Sorenson1"><label>13</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Sorenson</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Pradhan</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Vijaychander</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Sangari</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Fang</surname><given-names>S</given-names></name>
<etal/></person-group>             <year>2004</year>             <article-title>Accurate detection and classification of heterozygous indels by direct sequencing.</article-title>             <comment><ext-link ext-link-type="uri" xlink:href="http://www3.appliedbiosystems.com/cms/groups/mcb_marketing/documents/generaldocuments/cms_040569.pdf" xlink:type="simple">http://www3.appliedbiosystems.com/cms/groups/mcb_marketing/documents/generaldocuments/cms_040569.pdf</ext-link></comment>          </element-citation></ref>
<ref id="pcbi.1000113-Flot2"><label>14</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Flot</surname><given-names>J-F</given-names></name>
</person-group>             <year>2007</year>             <article-title>CHAMPURU 1.0: a computer software for unraveling mixtures of two DNA sequences of unequal lengths.</article-title>             <source>Mol Ecology Notes</source>             <volume>7</volume>             <fpage>974</fpage>             <lpage>977</lpage>          </element-citation></ref>
<ref id="pcbi.1000113-Seroussi1"><label>15</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Seroussi</surname><given-names>E</given-names></name>
<name name-style="western"><surname>Ron</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Kedra</surname><given-names>D</given-names></name>
</person-group>             <year>2002</year>             <article-title>ShiftDetector: detection of shift mutations.</article-title>             <source>Bioinformatics</source>             <volume>18</volume>             <fpage>1137</fpage>             <lpage>1138</lpage>          </element-citation></ref>
<ref id="pcbi.1000113-Seroussi2"><label>16</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Seroussi</surname><given-names>Y</given-names></name>
<name name-style="western"><surname>Seroussi</surname><given-names>E</given-names></name>
</person-group>             <year>2007</year>             <article-title>TraceHaplotyper: using direct sequencing to determine the phase of an indel followed by biallelic SNPs.</article-title>             <source>Biotechniques</source>             <volume>43</volume>             <fpage>452</fpage>             <lpage>456</lpage>          </element-citation></ref>
<ref id="pcbi.1000113-Mller1"><label>17</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Müller</surname><given-names>K</given-names></name>
</person-group>             <year>2006</year>             <article-title>Incorporating information from length-mutational events into phylogenetic analysis.</article-title>             <source>Mol Phyl Evol</source>             <volume>38</volume>             <fpage>667</fpage>             <lpage>676</lpage>          </element-citation></ref>
<ref id="pcbi.1000113-Ewing1"><label>18</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Ewing</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Hillier</surname><given-names>LD</given-names></name>
<name name-style="western"><surname>Wendl</surname><given-names>MC</given-names></name>
<name name-style="western"><surname>Green</surname><given-names>P</given-names></name>
</person-group>             <year>1998</year>             <article-title>Base-calling of automated sequencer traces using Phred. I. Accuracy assessment.</article-title>             <source>Genome Res</source>             <volume>8</volume>             <fpage>175</fpage>             <lpage>185</lpage>          </element-citation></ref>
<ref id="pcbi.1000113-Small1"><label>19</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Small</surname><given-names>KS</given-names></name>
<name name-style="western"><surname>Brudno</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Hill</surname><given-names>MM</given-names></name>
<name name-style="western"><surname>Sidow</surname><given-names>A</given-names></name>
</person-group>             <year>2007</year>             <article-title>Extreme genomic variation in a natural population.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>104</volume>             <fpage>5698</fpage>             <lpage>5703</lpage>          </element-citation></ref>
<ref id="pcbi.1000113-Bhattramakki1"><label>20</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Bhattramakki</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Dolan</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Hanafey</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Wineland</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Vaske</surname><given-names>D</given-names></name>
<etal/></person-group>             <year>2002</year>             <article-title>Insertion-deletion polymorphisms in 3′ regions of maize genes occur frequently and can be used as highly informative genetic markers.</article-title>             <source>Plant Mol Biol</source>             <volume>48</volume>             <fpage>539</fpage>             <lpage>547</lpage>          </element-citation></ref>
<ref id="pcbi.1000113-Parsch1"><label>21</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Parsch</surname><given-names>J</given-names></name>
</person-group>             <year>2003</year>             <article-title>Selective constraints on intron evolution in <italic>Drosophila</italic>.</article-title>             <source>Genetics</source>             <volume>165</volume>             <fpage>1843</fpage>             <lpage>1851</lpage>          </element-citation></ref>
<ref id="pcbi.1000113-Brown1"><label>22</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Brown</surname><given-names>GR</given-names></name>
<name name-style="western"><surname>Gill</surname><given-names>GP</given-names></name>
<name name-style="western"><surname>Kuntz</surname><given-names>RJ</given-names></name>
<name name-style="western"><surname>Langley</surname><given-names>CH</given-names></name>
<name name-style="western"><surname>Neale</surname><given-names>DB</given-names></name>
</person-group>             <year>2004</year>             <article-title>Nucleotide diversity and linkage disequilibrium in loblolly pine.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>101</volume>             <fpage>15255</fpage>             <lpage>15260</lpage>          </element-citation></ref>
<ref id="pcbi.1000113-Cooper1"><label>23</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Cooper</surname><given-names>GM</given-names></name>
<name name-style="western"><surname>Brudno</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Stone</surname><given-names>EA</given-names></name>
<name name-style="western"><surname>Dubchak</surname><given-names>I</given-names></name>
<name name-style="western"><surname>Batzoglou</surname><given-names>S</given-names></name>
</person-group>             <year>2004</year>             <article-title>Characterization of evolutionary rates and constraints in three Mammalian genomes.</article-title>             <source>Genome Res</source>             <volume>14</volume>             <fpage>539</fpage>             <lpage>548</lpage>          </element-citation></ref>
<ref id="pcbi.1000113-Mills1"><label>24</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Mills</surname><given-names>RE</given-names></name>
<name name-style="western"><surname>Luttig</surname><given-names>CT</given-names></name>
<name name-style="western"><surname>Larkins</surname><given-names>CE</given-names></name>
<name name-style="western"><surname>Beauchamp</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Tsui</surname><given-names>C</given-names></name>
<etal/></person-group>             <year>2006</year>             <article-title>An initial map of insertion and deletion (INDEL) variation in the human genome.</article-title>             <source>Genome Res</source>             <volume>16</volume>             <fpage>1182</fpage>             <lpage>1190</lpage>          </element-citation></ref>
<ref id="pcbi.1000113-Altschul1"><label>25</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Altschul</surname><given-names>SF</given-names></name>
<name name-style="western"><surname>Madden</surname><given-names>TL</given-names></name>
<name name-style="western"><surname>Schäffer</surname><given-names>AA</given-names></name>
<name name-style="western"><surname>Zhang</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Zhang</surname><given-names>Z</given-names></name>
<etal/></person-group>             <year>1997</year>             <article-title>Gapped BLAST and PSI-BLAST: a new generation of protein database search programs,</article-title>             <source>Nucleic Acids Res</source>             <volume>25</volume>             <fpage>3389</fpage>             <lpage>3402</lpage>          </element-citation></ref>
<ref id="pcbi.1000113-Zhao1"><label>26</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Zhao</surname><given-names>Z</given-names></name>
<name name-style="western"><surname>Yu</surname><given-names>N</given-names></name>
<name name-style="western"><surname>Fu</surname><given-names>Y-X</given-names></name>
<name name-style="western"><surname>Li</surname><given-names>WH</given-names></name>
</person-group>             <year>2006</year>             <article-title>Nucleotide variation and haplotype diversity in a 10-kb noncoding region in three continental human populations.</article-title>             <source>Genetics</source>             <volume>174</volume>             <fpage>399</fpage>             <lpage>409</lpage>          </element-citation></ref>
<ref id="pcbi.1000113-Moriyama1"><label>27</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Moriyama</surname><given-names>EN</given-names></name>
<name name-style="western"><surname>Powell</surname><given-names>JR</given-names></name>
</person-group>             <year>1996</year>             <article-title>Intraspecific nuclear DNA variation in <italic>Drosophila</italic>.</article-title>             <source>Mol Biol Evol</source>             <volume>13</volume>             <fpage>261</fpage>             <lpage>277</lpage>          </element-citation></ref>
<ref id="pcbi.1000113-Creer1"><label>28</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Creer</surname><given-names>S</given-names></name>
</person-group>             <year>2007</year>             <article-title>Choosing and using introns in molecular phylogenetics.</article-title>             <source>Evol Bioinformatics</source>             <volume>3</volume>             <fpage>99</fpage>             <lpage>108</lpage>          </element-citation></ref>
</ref-list>

</back>
</article>