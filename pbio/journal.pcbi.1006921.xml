<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-18-01917</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1006921</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Molecular biology</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Artificial gene amplification and extension</subject><subj-group><subject>Polymerase chain reaction</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Artificial gene amplification and extension</subject><subj-group><subject>Polymerase chain reaction</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Database and informatics methods</subject><subj-group><subject>Bioinformatics</subject><subj-group><subject>Sequence analysis</subject><subj-group><subject>Sequence motif analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Chromosome biology</subject><subj-group><subject>Chromatin</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Epigenetics</subject><subj-group><subject>Chromatin</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Gene expression</subject><subj-group><subject>Chromatin</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Database and informatics methods</subject><subj-group><subject>Biological databases</subject><subj-group><subject>Sequence databases</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Database and informatics methods</subject><subj-group><subject>Bioinformatics</subject><subj-group><subject>Sequence analysis</subject><subj-group><subject>Sequence databases</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Probability theory</subject><subj-group><subject>Probability distribution</subject><subj-group><subject>Normal distribution</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Biochemical simulations</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Biochemical simulations</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Genome analysis</subject><subj-group><subject>Genomic libraries</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Genomics</subject><subj-group><subject>Genome analysis</subject><subj-group><subject>Genomic libraries</subject></subj-group></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>ChIPulate: A comprehensive ChIP-seq simulation pipeline</article-title>
<alt-title alt-title-type="running-head">ChIPulate: A comprehensive ChIP-seq simulation pipeline</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-5582-3130</contrib-id>
<name name-style="western">
<surname>Datta</surname> <given-names>Vishaka</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Hannenhalli</surname> <given-names>Sridhar</given-names></name>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Siddharthan</surname> <given-names>Rahul</given-names></name>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Simons Centre for the Study of Living Machines, National Centre for Biological Sciences, TIFR, Bengaluru, Karnataka, India</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Center for Bioinformatics and Computational Biology, University of Maryland, College Park, Maryland, United States of America</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>The Institute of Mathematical Sciences/HBNI, Taramani, Chennai, India</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Ioshikhes</surname> <given-names>Ilya</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Ottawa University, CANADA</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">vishakadatta@gmail.com</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>3</month>
<year>2019</year>
</pub-date>
<pub-date pub-type="epub">
<day>21</day>
<month>3</month>
<year>2019</year>
</pub-date>
<volume>15</volume>
<issue>3</issue>
<elocation-id>e1006921</elocation-id>
<history>
<date date-type="received">
<day>12</day>
<month>11</month>
<year>2018</year>
</date>
<date date-type="accepted">
<day>4</day>
<month>3</month>
<year>2019</year>
</date>
</history>
<permissions>
<copyright-year>2019</copyright-year>
<copyright-holder>Datta et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1006921"/>
<abstract>
<p>ChIP-seq (Chromatin Immunoprecipitation followed by sequencing) is a high-throughput technique to identify genomic regions that are bound <italic>in vivo</italic> by a particular protein, e.g., a transcription factor (TF). Biological factors, such as chromatin state, indirect and cooperative binding, as well as experimental factors, such as antibody quality, cross-linking, and PCR biases, are known to affect the outcome of ChIP-seq experiments. However, the relative impact of these factors on inferences made from ChIP-seq data is not entirely clear. Here, via a detailed ChIP-seq simulation pipeline, ChIPulate, we assess the impact of various biological and experimental sources of variation on several outcomes of a ChIP-seq experiment, viz., the recoverability of the TF binding motif, accuracy of TF-DNA binding detection, the sensitivity of inferred TF-DNA binding strength, and number of replicates needed to confidently infer binding strength. We find that the TF motif can be recovered despite poor and non-uniform extraction and PCR amplification efficiencies. The recovery of the motif is, however, affected to a larger extent by the fraction of sites that are either cooperatively or indirectly bound. Importantly, our simulations reveal that the number of ChIP-seq replicates needed to accurately measure <italic>in vivo</italic> occupancy at high-affinity sites is larger than the recommended community standards. Our results establish statistical limits on the accuracy of inferences of protein-DNA binding from ChIP-seq and suggest that increasing the mean extraction efficiency, rather than amplification efficiency, would better improve sensitivity. The source code and instructions for running ChIPulate can be found at <ext-link ext-link-type="uri" xlink:href="https://github.com/vishakad/chipulate" xlink:type="simple">https://github.com/vishakad/chipulate</ext-link>.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>DNA-binding proteins perform many key roles in biology, such as transcriptional regulation of gene expression and chromatin modification. ChIP-seq (Chromatin immunoprecipitation followed by high-throughput sequencing) is a widely used experimental technique to identify DNA-binding sites of specific proteins of interest, within cells, genome-wide. DNA fragments from genomic regions that are bound by a protein of interest, often a transcription factor (TF), are selectively extracted using specific antibodies, amplified using PCR, and sequenced. The sequences are mapped to the reference genome. Regions where many sequences map, called “peaks”, are used to infer the location of TF-bound loci (peaks), <italic>in vivo</italic> occupancy at those loci, and the sequence pattern (motif) to which the TF shows a binding affinity. But measurements of TF occupancy and motif inference are vulnerable to several biological and experimental sources of variation that are poorly understood and difficult to assess directly. Here, we simulate key steps of the ChIP-seq protocol with the aim of estimating the relative effects of various sources of variations on motif inference and binding affinity estimations. Besides providing specific insights and recommendations, we provide a general framework to simulate sequence reads in a ChIP-seq experiment, which should considerably aid in the development of software aimed at analyzing ChIP-seq data.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution>Simons Foundation (US)</institution>
</funding-source>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-5582-3130</contrib-id>
<name name-style="western">
<surname>Datta</surname> <given-names>Vishaka</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution>National Science Foundation (US)</institution>
</funding-source>
<award-id>1564785</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Hannenhalli</surname> <given-names>Sridhar</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award003">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001502</institution-id>
<institution>Department of Atomic Energy, Government of India</institution>
</institution-wrap>
</funding-source>
<award-id>PRISM 12th Plan Project</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Siddharthan</surname> <given-names>Rahul</given-names></name>
</principal-award-recipient>
</award-group>
<funding-statement>SH was funded in part by NSF award 1564785. VD was supported by the Simons Foundation. RS was supported by the PRISM 12th plan project at the Institute of Mathematical Sciences, funded by Department of Atomic Energy, Government of India. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="6"/>
<table-count count="0"/>
<page-count count="32"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2019-04-02</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All code and data necessary to reproduce the results in the manuscript are described in <ext-link ext-link-type="uri" xlink:href="https://github.com/vishakad/chipulate/blob/master/paper/Manuscript.ipynb" xlink:type="simple">https://github.com/vishakad/chipulate/blob/master/paper/Manuscript.ipynb</ext-link>. Instructions to run the code are provided in the README file at <ext-link ext-link-type="uri" xlink:href="https://github.com/vishakad/chipulate/" xlink:type="simple">https://github.com/vishakad/chipulate/</ext-link>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>ChIP-seq (Chromatin Immunoprecipitation and sequencing) is a popular high-throughput experimental technique to find locations that are bound <italic>in vivo</italic> by a single transcription factor (TF) [<xref ref-type="bibr" rid="pcbi.1006921.ref001">1</xref>]. Upon mapping of the DNA fragments bound by the TF to the reference genome, the genomic loci bound by the TF are identified as high density mapped regions or <italic>peaks</italic>, where each peak is associated with an <italic>intensity</italic> based on the number of sequenced fragments arising from it. The intensity reflects the <italic>in vivo</italic> occupancy of the TF at that locus.</p>
<p>Several studies of ChIP-seq data have focussed on the biological factors distinguishing the loci bound by the TF. It has been shown that in addition to the affinities of binding sites present at a locus, nucleosome positioning is a strong determinant of TF binding <italic>in vivo</italic> [<xref ref-type="bibr" rid="pcbi.1006921.ref002">2</xref>–<xref ref-type="bibr" rid="pcbi.1006921.ref005">5</xref>]. Other studies have shown that the concentration of the target TF [<xref ref-type="bibr" rid="pcbi.1006921.ref006">6</xref>, <xref ref-type="bibr" rid="pcbi.1006921.ref007">7</xref>], short-range cooperative interactions between the target TF and other TFs [<xref ref-type="bibr" rid="pcbi.1006921.ref008">8</xref>], and variation in chromatin accessibility [<xref ref-type="bibr" rid="pcbi.1006921.ref005">5</xref>, <xref ref-type="bibr" rid="pcbi.1006921.ref007">7</xref>] explain the variation in intensities across peaks. Some of the variation can arise due to indirect binding, where the target TF binds DNA indirectly via a second DNA-bound TF [<xref ref-type="bibr" rid="pcbi.1006921.ref009">9</xref>–<xref ref-type="bibr" rid="pcbi.1006921.ref011">11</xref>]. The intensity of such peaks is then no longer directly dependent on the affinity of the target TF to sequence at the bound locus.</p>
<p>Since the distribution of ChIP-seq peaks and their intensities depend on factors other than the affinity of the target TF towards sequence at a locus, it impacts two kinds of inferences often made from ChIP-seq data. First, the highest intensity peaks are used to infer position weight matrix (PWM) or motif models of the target TF [<xref ref-type="bibr" rid="pcbi.1006921.ref012">12</xref>]. While it is known that changes in the concentration of the target TF can distort the inferred PWM [<xref ref-type="bibr" rid="pcbi.1006921.ref013">13</xref>, <xref ref-type="bibr" rid="pcbi.1006921.ref014">14</xref>], the extent to which cooperative and indirect interactions distort the PWM is unclear. Second, along with variations in chromatin accessibility, these interactions weaken the statistical dependence of peak intensity on target TF binding site affinity, which means that a peak with a higher intensity need not necessarily contain a higher affinity target TF binding site.</p>
<p>In addition to these biological factors, ChIP-seq peaks are affected by purely experimental sources of noise. The ChIP-seq protocol broadly consists of three key steps [<xref ref-type="bibr" rid="pcbi.1006921.ref001">1</xref>, <xref ref-type="bibr" rid="pcbi.1006921.ref015">15</xref>, <xref ref-type="bibr" rid="pcbi.1006921.ref016">16</xref>]—(i) the extraction of fragments that are bound by the target TF (ii) PCR amplification of these extracted fragments, and (iii) sequencing of these fragments. It is known that fragments can be extracted more easily at some genomic regions than others due to differences in chromatin structure and cross-linking efficiency across the genome [<xref ref-type="bibr" rid="pcbi.1006921.ref017">17</xref>–<xref ref-type="bibr" rid="pcbi.1006921.ref019">19</xref>]. Similarly, certain fragments are more efficiently amplified by PCR than others due to differences in GC content or the presence of nucleotide repeats [<xref ref-type="bibr" rid="pcbi.1006921.ref020">20</xref>–<xref ref-type="bibr" rid="pcbi.1006921.ref022">22</xref>]. The extent to which these factors distort peak intensities and make otherwise identical genomic regions appear differentially occupied has not been quantified. Multiple biological replicates of ChIP-seq are recommended [<xref ref-type="bibr" rid="pcbi.1006921.ref023">23</xref>] to overcome these issues, but the quantitative improvement in accuracy as more replicates are performed has not been ascertained.</p>
<p>To evaluate the influence of the aforementioned biological and experimental sources of variation on ChIP-seq peak intensities, we have developed a comprehensive pipeline to simulate a ChIP-seq experiment called ChIPulate. In particular, we simulate genome-wide TF-DNA binding based on established biophysical models of binding and also simulate the extraction, amplification and sequencing steps of the ChIP-seq protocol. Our simulation thus associates a set of read counts at each genomic locus with its occupancy by the target TF. Whereas existing statistical models [<xref ref-type="bibr" rid="pcbi.1006921.ref014">14</xref>, <xref ref-type="bibr" rid="pcbi.1006921.ref024">24</xref>–<xref ref-type="bibr" rid="pcbi.1006921.ref026">26</xref>] assume that read counts follow a prescribed probability distribution and treat the ChIP-seq protocol as a black box, we explicitly model key steps of the ChIP-seq protocol. Our approach allows us to individually evaluate the impact of variation in extraction and PCR amplification efficiencies, as well as chromatin accessibility, indirect binding, and cooperative binding, on peak intensities and PWM inference. We are also able to quantify the extent to which additional replicates of ChIP-seq improve its ability to robustly measure the occupancy of a genomic region.</p>
<p>We find that biological factors such as indirectly and cooperatively bound sequences distort inferred PWMs more than experimental sources of variation. Variations in extraction efficiency across the genome distort peak intensities and lower their ability to distinguish between occupied loci. Poor extraction efficiency also increases the number of false positive peaks, which are peak calls that do not contain a binding site for the target TF. In contrast to the effect of variations in extraction efficiency, even drastic variations in PCR amplification efficiency have little impact on peak intensities, and hence do not affect the inferred PWM or increase the number of false positive peaks. Finally, we found that at least two biological replicates of ChIP-seq read counts are necessary to reliably infer the binding energy of a genomic region.</p>
<p>Our work provides a general framework and a software tool for simulating ChIP-seq read counts through a realistic model of TF-DNA binding and the steps of the ChIP-seq protocol. Improvements in the protocol to lower variation in extraction efficiency, rather than PCR amplification efficiency, are more likely to improve our ability to distinguish between genomic regions of differing occupancy. Further, changes in the protocol that allow multiple biological ChIP-seq replicates to be performed, or computational approaches that can reliably combine read counts from ChIP-seq experiments, would allow more accurate inferences of TF-DNA occupancy, especially in regions containing multiple binding sites.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<sec id="sec003">
<title>A framework to simulate read counts from TF binding sites in a ChIP-seq experiment</title>
<p>A schematic of our ChIP-seq simulation framework is shown in <xref ref-type="fig" rid="pcbi.1006921.g001">Fig 1A</xref>, with details in Methods. Broadly, the goal of our simulation is to take as an input the occupancy of a TF at multiple locations across a genome and output a set of read counts in both ChIP and input experiments at each location. A single TF’s occupancy at a genomic location is determined by its site-specific binding energy, and its chemical potential, which depends on the logarithm of the concentration of the TF [<xref ref-type="bibr" rid="pcbi.1006921.ref027">27</xref>].</p>
<fig id="pcbi.1006921.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006921.g001</object-id>
<label>Fig 1</label>
<caption>
<title>ChIP-seq simulation procedure.</title>
<p>(A) Procedure overview. Each of <italic>n</italic> genomic regions contains a binding site with a binding energy <italic>ϵ</italic><sup>(<italic>i</italic>)</sup> (in units of <italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic>), where a lower value represents a higher affinity binding site. In the ChIP sample, the binding energy at the i-th location, and the chemical potential, set the probability of occupancy (<inline-formula id="pcbi.1006921.e001"><alternatives><graphic id="pcbi.1006921.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e001" xlink:type="simple"/><mml:math display="inline" id="M1"><mml:msubsup><mml:mi>p</mml:mi> <mml:mi>b</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>) of the target TF. The probability of occupancy determines the number of cells (out of a total of <italic>C</italic> cells) where the i-th location is bound. In Step 1 of the simulation, a total of <inline-formula id="pcbi.1006921.e002"><alternatives><graphic id="pcbi.1006921.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:msubsup><mml:mi>F</mml:mi> <mml:mi>e</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> fragments are extracted at the i-th location from a binomial distribution with mean <inline-formula id="pcbi.1006921.e003"><alternatives><graphic id="pcbi.1006921.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:mrow><mml:mi>C</mml:mi> <mml:msubsup><mml:mi>p</mml:mi> <mml:mi>e</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>. <inline-formula id="pcbi.1006921.e004"><alternatives><graphic id="pcbi.1006921.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:msubsup><mml:mi>p</mml:mi> <mml:mi>e</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> is the extraction efficiency that represents the probability of successfully extracting a bound fragment. All of these fragments are unique (in red) since each fragment originates from a different cell. In Step 2, the extracted fragments are amplified through <italic>n</italic><sub><italic>cy</italic></sub> cycles of PCR to give <inline-formula id="pcbi.1006921.e005"><alternatives><graphic id="pcbi.1006921.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:msubsup><mml:mi>F</mml:mi> <mml:mi>a</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> amplified fragments (duplicate fragments in black) with the probability of amplification of each fragment, or PCR efficiency, being <inline-formula id="pcbi.1006921.e006"><alternatives><graphic id="pcbi.1006921.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:msubsup><mml:mi>p</mml:mi> <mml:mi>a</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> in every cycle. The average number of amplified fragments <italic>A</italic> obtained from each extracted fragment is <inline-formula id="pcbi.1006921.e007"><alternatives><graphic id="pcbi.1006921.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:mrow><mml:mi>A</mml:mi> <mml:mo>=</mml:mo> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi>p</mml:mi> <mml:mi>a</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, which we refer to as the amplification ratio. In Step 3, <italic>r</italic><sub><italic>i</italic></sub> reads are obtained from the i-th location after sampling <italic>r</italic> = <italic>cn</italic> fragments from all <inline-formula id="pcbi.1006921.e008"><alternatives><graphic id="pcbi.1006921.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e008" xlink:type="simple"/><mml:math display="inline" id="M8"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:msubsup> <mml:msubsup><mml:mi>F</mml:mi> <mml:mi>a</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> amplified fragments, where <italic>r</italic> is the total read count and <italic>c</italic> is the sequencing depth. The number of unique reads at each location is the final output of the simulation. For the control input sample, read counts are simulated as for the foreground ChIP sample, except that the probability of occupancy is assumed to be constant at all <italic>n</italic> locations and the number of cells is assumed to be 0.1<italic>C</italic>. (B) Sample output from the simulation. The top panel shows the distribution of binding energies employed in the simulation, which by default is a truncated power law between 0 and 10<italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic> with an exponent of 0.5. The middle panel shows the number of unique reads from each genomic region in the ChIP (black) and input (gray) experiments. The bottom panel is the read count ratio between the ChIP and input samples at each location. The simulation parameters are <italic>n</italic> = 1000, <italic>μ</italic> = 3<italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic>, <italic>ϵ</italic><sub><italic>bg</italic></sub> = 1<italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic>, <italic>C</italic> = 10<sup>5</sup>, <italic>n</italic><sub><italic>cy</italic></sub> = 15, and <italic>A</italic> = 1000. The extraction efficiencies in the ChIP and input samples follow a truncated normal distribution between 0 and 1, with a mean of 0.5 and standard deviation of 0.05 across the genome.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006921.g001" xlink:type="simple"/>
</fig>
<p>Each genomic location is associated with two experimental parameters—its extraction efficiency and PCR efficiency. The extraction efficiency, which determines how many bound fragments are successfully extracted in Step 1 in <xref ref-type="fig" rid="pcbi.1006921.g001">Fig 1A</xref>, can vary between different genomic locations. The extracted fragments are then subjected to a number of PCR amplification cycles in Step 2. The average number of amplified fragments obtained at each location depends on the PCR efficiency associated with the locus, which can also vary between different locations. Step 3 represents the sequencing step where the amplified fragments from all locations are sequenced. The number of sequenced fragments is the total read count of the experiment. Since unique and duplicate fragments (red and black in <xref ref-type="fig" rid="pcbi.1006921.g001">Fig 1A</xref>) are tracked through the simulation, the exact number of unique reads at each location is known.</p>
<p>In addition to the ChIP experiment, we simulate the sequencing of a genomic control input sample. This simulation differs from the ChIP experiment in two ways. First, the background binding energy (<italic>ϵ</italic><sub><italic>bg</italic></sub>) at each occupied genomic locus is set to a fixed value of 1<italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic> for all locations (see <xref ref-type="sec" rid="sec011">Methods</xref> for justification). Second, we set the number of cells to be only 10% of the number of cells employed in the ChIP simulation. A larger number of cells are used in the ChIP simulation since, in practice, DNA is less efficiently extracted in the ChIP sample due to the use of an antibody whereas no antibody is used in the input sample. Thus, to extract a given amount of DNA, fewer cells are employed in the input sample than in the ChIP sample. In the event that the number of extracted fragments in the input is more than the number of extracted fragments in the ChIP sample, we down-sample the input fragments such that the total number of extracted fragments is identical in both ChIP and input samples before the PCR amplification step. Similarly, we down-sample the ChIP fragments if the number of extracted fragments in the ChIP sample is more than than that in the input sample. At each locus, the extraction and PCR efficiencies in the input are kept identical to the values used in the ChIP simulation.</p>
<p>After simulating both ChIP and input experiments, we compute the ratio of the read counts obtained from the ChIP sample to that of the input sample at each genomic locus. The read count ratio at a location is equivalent to peak intensity computed by commonly used peak callers from ChIP-seq reads [<xref ref-type="bibr" rid="pcbi.1006921.ref024">24</xref>]. The read counts obtained from our simulations are shown in <xref ref-type="fig" rid="pcbi.1006921.g001">Fig 1B</xref> with the values of the simulation parameters set to the default values described in Methods.</p>
</sec>
<sec id="sec004">
<title>Key assumptions</title>
<p>When simulating genome-wide TF-DNA binding before Step 1 in <xref ref-type="fig" rid="pcbi.1006921.g001">Fig 1A</xref>, we assume that there is a single TF and a single binding site in each genomic region. We relax this assumption in later sections when simulating indirect and cooperative binding. We assume that binding in different genomic locations are independent of each other.</p>
<p>The extraction efficiency parameter in Step 1 aggregates the effect of the many steps of fragmentation, cross-linking, pull-down and size selection that occur in a ChIP-seq experimental protocol. We show in Methods that this parameter takes all these steps into account when modeling the extraction of DNA fragments from cells. In the PCR amplification step, we assume the amplification process to be in the exponential phase of amplification [<xref ref-type="bibr" rid="pcbi.1006921.ref028">28</xref>] where increasing the number of PCR cycles exponentially increases the number of amplified fragments. We assume that any potential PCR mutational errors do not change the amplification ratio at any genomic location. In the sequencing step (Step 3), we assume that the sequencing and mapping are error-free, i.e., reads are uniquely and correctly mapped, and they can be perfectly de-duplicated at each location.</p>
</sec>
<sec id="sec005">
<title>Motif inference is not affected by extraction and PCR efficiency whereas fidelity at locations with low read count ratios is affected by a low extraction efficiency</title>
<p>We evaluated the impact of heterogeneity in extraction and PCR efficiencies on two outcomes of ChIP-seq. One is the recoverability of TF motif based on the top genomic locations in terms of their read count ratios. The second is fidelity, defined as the probability (frequency) with which a site X with a read count ratio that is at least 10% higher than site Y in fact contains a sequence with a higher affinity (or lower binding energy).</p>
<p>We simulated the process of inferring the motif of an arbitrarily chosen <italic>S. cerevisiae</italic> transcription factor (Tye7) from ChIP-seq (<xref ref-type="fig" rid="pcbi.1006921.g002">Fig 2A</xref>). We assigned binding energies for 1000 genomic regions from our default binding energy distribution, which is a power law distribution (with an exponent of 0.5) between 0 and 10<italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic> (see <xref ref-type="sec" rid="sec011">Methods</xref>). By using the Tye7 binding energy matrix estimated by BEEML from protein binding microarray measurements [<xref ref-type="bibr" rid="pcbi.1006921.ref013">13</xref>, <xref ref-type="bibr" rid="pcbi.1006921.ref029">29</xref>], we found the 10 bp sequence whose binding energy was closest to this assigned value, and virtually planted it at each location. We simulated a ChIP-seq experiment with a fixed extraction and PCR efficiency across the genome, following which we selected sites having the top 100 read count ratios and constructed the PWM of Tye7. This PWM, which we refer to as the <italic>baseline PWM</italic>, is used to compute the extent to which heterogeneity in extraction and PCR efficiency changes the derived PWM.</p>
<fig id="pcbi.1006921.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006921.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Impact of genome-wide heterogeneity in extraction and PCR efficiency on motif inference and ChIP-seq fidelity.</title>
<p>(A) To simulate motif inference, 1000 binding energies were sampled from the default binding energy distribution. A binding site sequence of transcription factor Tye7 was assigned to each binding energy (<xref ref-type="sec" rid="sec011">Methods</xref>). After simulating ChIP-seq in the absence of extraction and amplification ratio heterogeneity, binding sites from locations with the 100 highest read count ratios were used to construct a baseline PWM of Tye7 (shown inset). (B) The mean K-L distance between the baseline PWM and the motif inferred in the presence of heterogeneity in extraction efficiency (right) and amplification ratio (left). The heterogeneity in extraction efficiency and amplification ratio is assumed to follow a truncated normal distribution, with the mean increasing from left to right on the x-axis in both panels. The coefficient of variation of the truncated normal varies from 0 (no variation, in blue) to 0.5 (green) and 1.0 (brown). The error bars are the standard deviation in the mean K-L distance computed after PWM was estimated in 10 replicates of ChIP-seq for each mean and coefficient of variation. (C) ChIP-seq fidelity captures the monotonicity of the relationship between read count ratio and binding energy. Fidelity is defined as the probability that if a location <italic>i</italic> has a read count ratio at least 10% higher than location <italic>j</italic>, then it implies that <italic>i</italic> has a lower binding energy than <italic>j</italic>. Fidelity is calculated by sampling 1000 pairs of locations, where each pair could be from anywhere in the genome or top 25th, 25-50th, 50-75th, or bottom 25th percentiles of the read count ratio. Read count ratios falling in each percentile bin are marked in different colors in the scatter plot. The fidelity values in each of these bins is shown in the plot legend, along with the fidelity computed across all regions. (D) Variation in ChIP-seq fidelity with heterogeneity in extraction efficiency (right) and PCR amplification ratio (left). The x-axis and the three plot colors are defined identically to B. The error bars are the standard deviation in the estimate of fidelity, which are computed from 10 replicates of simulation for a given mean and coefficient of variation.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006921.g002" xlink:type="simple"/>
</fig>
<p>Ideally, one would use a PWM of Tye7 published in a database as the baseline motif against which to make these comparisons. However, these motifs can differ between databases due to differences not only in the experimental assay used to measure TF-DNA binding but also the underlying binding energy distribution of the bound sequences. This means that the baseline Tye7 PWM derived from the simulation may differ from that present in the ScerTF database [<xref ref-type="bibr" rid="pcbi.1006921.ref030">30</xref>]. However, our goal is to specifically assess the effect of extraction and PCR amplification heterogeneity on motif recoverability. For this purpose, it suffices to compare the motif derived in the presence of heterogeneity with the baseline motif derived in the absence of heterogeneity.</p>
<p>
<xref ref-type="fig" rid="pcbi.1006921.g002">Fig 2B</xref> shows the difference between the baseline PWM and the Tye7 PWM that is derived in the presence of extraction or PCR amplification heterogeneity, respectively, when the efficiencies follow a truncated normal distribution. This difference is measured in terms of the mean Kullback-Leibler (K-L) distance, measured in bits (<xref ref-type="sec" rid="sec011">Methods</xref>), between the two PWMs. The impact of heterogeneity in these parameters on the inferred motif is small as the highest K-L distance from the baseline motif is about 0.08 bits. The effect of PCR amplification and extraction heterogeneity on motif inference is more pronounced when the heterogeneity follows a power law distribution (<xref ref-type="supplementary-material" rid="pcbi.1006921.s001">S1A Fig</xref>) than when it follows a truncated normal distribution. The distortion of the PWM is still relatively low, however, with the highest K-L distance from the baseline motif being less than 0.1 bits per position. We also evaluated the impact of varying the chemical potential between 1<italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic> and 6<italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic> on the inferred motif when the baseline motif is derived at <italic>μ</italic> = 3<italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic>. Examples of the effect of a different chemical potential on the read count ratios obtained across the genome are shown in <xref ref-type="supplementary-material" rid="pcbi.1006921.s002">S2A Fig</xref>. We found that the inferred motif deviates up to 0.08 bits per position from the baseline motif (<xref ref-type="supplementary-material" rid="pcbi.1006921.s002">S2B Fig</xref>). This is within the same order of magnitude as the effect of a low mean extraction efficiency on the inferred motif.</p>
<p>We checked the extent to which the trends in <xref ref-type="fig" rid="pcbi.1006921.g002">Fig 2B</xref> depended on our choice of TF. We selected 21 TFs that possessed different DNA binding domains [<xref ref-type="bibr" rid="pcbi.1006921.ref031">31</xref>] (<xref ref-type="supplementary-material" rid="pcbi.1006921.s007">S1 Table</xref>), and for each TF, we simulated motif inference when there is heterogeneity in extraction efficiency (<xref ref-type="supplementary-material" rid="pcbi.1006921.s003">S3 Fig</xref>) or the PCR amplification ratio (<xref ref-type="supplementary-material" rid="pcbi.1006921.s004">S4 Fig</xref>) across the genome. The binding energy distribution of each TF, along with all other parameters of ChIPulate, was kept at their default values. We found that motif inference in each of these TFs was affected in a manner similar to Tye7, where a low mean extraction efficiency distorted the inferred motif more than a low mean amplification ratio. However, we found that the extent of motif distortion due to extraction heterogeneity was significantly correlated (<italic>R</italic><sup>2</sup> = −0.67, <italic>p</italic> &lt; 10<sup>−3</sup>) with the baseline motif information content of each TF (<xref ref-type="supplementary-material" rid="pcbi.1006921.s003">S3A Fig</xref>), while there was no such correlation in the presence of amplification heterogeneity (<xref ref-type="supplementary-material" rid="pcbi.1006921.s004">S4A Fig</xref>, <italic>R</italic><sup>2</sup> = −0.36, <italic>p</italic> = 0.1). Finally, we found a weak dependence of the extent of motif distortion on the length of the motif, where a low mean extraction efficiency distorted a 6 bp motif upto nearly 0.1 bits per position with a lower magnitude of distortion for longer motifs (<xref ref-type="supplementary-material" rid="pcbi.1006921.s005">S5A Fig</xref>). There was no such dependence of motif distortion on motif length when the amplification ratio varied across the genome (<xref ref-type="supplementary-material" rid="pcbi.1006921.s005">S5B Fig</xref>).</p>
<p>Results shown in <xref ref-type="fig" rid="pcbi.1006921.g002">Fig 2C</xref> show that ChIP-seq fidelity is generally higher for sites with intermediate read count ratios (50th percentile to 75th percentile) and deteriorates at lower and higher read count ratios. This is partly due to the value of the chemical potential of 3<italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic> employed in our simulation. When the chemical potential is varied between 1<italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic> and 6<italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic>, the fidelity amongst the top 25th percentile of read count ratios noticeably decreases and reaches close to 0.5 at <italic>μ</italic> = 6<italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic> (<xref ref-type="supplementary-material" rid="pcbi.1006921.s002">S2C Fig</xref>). The fidelity amongst read count ratios of the bottom 25%, however, increases over the same range of the chemical potential. This is due to the fact that the occupancy of locations whose binding energies are much lower than the chemical potential are close to 1 while locations with binding energies above the chemical potential are close to zero. As the chemical potential increases, the increase in occupancy at locations with high binding energies is sufficiently large for their read count ratios to differ from one another. On the other hand, the occupancies of locations with low binding energies rapidly tend to one, which results in similar read count ratios between sites that possess different binding energies.</p>
<p>
<xref ref-type="fig" rid="pcbi.1006921.g002">Fig 2D</xref> shows the impact of heterogeneity in extraction efficiency and PCR amplification ratio on fidelity. The fidelity is highest when computed across all binding site pairs, than amongst pairs in the top 25% of read count ratios. This is because the expected difference between the binding energies of sites in each pair is larger when the pairs are selected from the entire range. Changes in the mean and variance in the amplification ratio have little impact on fidelity, both overall as well as in each read count ratio bin. The fidelity across all regions is also not substantially affected by the mean and variance in extraction efficiency, but the fidelity is markedly lowered for sites with the lowest read count ratios. When PCR amplification heterogeneity is power-law distributed, its impact on fidelity is still quite low (<xref ref-type="supplementary-material" rid="pcbi.1006921.s001">S1B Fig</xref>). In contrast, when the extraction efficiency is power-law distributed across the genome, its impact on fidelity is more drastic than when it is normally distributed.</p>
</sec>
<sec id="sec006">
<title>A low mean extraction efficiency increases the probability of false positive peak calls but the PCR efficiency has no impact</title>
<p>We tested the effect of heterogeneity in extraction and PCR efficiency on the ability of ChIP-seq to distinguish peak calls that contain a binding site for the target TF (true positive) from those peak calls that do not contain a binding site for the target TF (false positive). <xref ref-type="fig" rid="pcbi.1006921.g003">Fig 3A</xref> shows a simulation where genomic locations that do not harbor a binding site for the target TF give rise to sequence reads. We refer to such locations as false positive peaks. This differs from indirectly bound peaks, where the target TF is part of the complex of TFs that binds DNA. In practice, a false positive peak can arise due to poor antibody quality, where the antibody binds epitopes on TFs other than the target TF. We assign binding energies to these false positive locations from a truncated power law such that the mean occupancy ratio between true and false positive sites are fixed while the variance in binding energies amongst false positive sites and true positive sites are equal. <xref ref-type="fig" rid="pcbi.1006921.g003">Fig 3B</xref> shows the receiver operating characteristic (ROC) curve for the simulation shown in <xref ref-type="fig" rid="pcbi.1006921.g003">Fig 3A</xref>. The ROC curve shows the change in the number of true positives and false positives when the read count ratio threshold at which a location is declared as a peak is changed. The area under the ROC curve (auROC) provides an overall measure of the accuracy of using ChIP-seq read count ratios in distinguishing between locations with target TF binding sites from those without these sites.</p>
<fig id="pcbi.1006921.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006921.g003</object-id>
<label>Fig 3</label>
<caption>
<title>The impact of experimental and biological sources of variation on the sensitivity of ChIP-seq.</title>
<p>(A) Simulating false positive binding sites. The binding energies of false positive genomic locations, which do not contain a target TF binding site, are distributed according to a truncated power law with exponent 0.76 in the range [0, 6.78<italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic>]. Binding energies of true positive genomic locations, which contain a target TF binding site, are sampled from a truncated power law with exponent 0.5 in the range [0, 6<italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic>]. (B) Receiver operating characteristic (ROC) curve corresponding to the simulation shown in A. (C,D) Variation in auROC with the extraction efficiency and PCR amplification ratio. The mean extraction efficiency in (C) and the mean amplification ratio (after 15 cycles of PCR) in (D) increases along the x-axis. The efficiencies vary according to a truncated normal distribution with the blue, green and brown lines corresponding to a coefficient of variation of 0, 0.5 and 1.0, respectively. The solid and dashed lines are the auROC when the ratio of the mean occupancy of true positive binding sites to the mean occupancy of false positive binding sites is 2 (solid) and 10 (dashed) lines. (E) Variation in auROC with the ratio of mean occupancy between true positive and false positive binding sites. (F) Variation in auROC with sequencing depth. The ratio of the mean occupancy of true positive binding sites to the mean occupancy of false positive binding sites is set at 2 (solid line) and 10 (dashed line). In (C)-(F), the error bars are the standard deviation computed from ten replicates.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006921.g003" xlink:type="simple"/>
</fig>
<p>
<xref ref-type="fig" rid="pcbi.1006921.g003">Fig 3C and 3D</xref> show the impact of heterogeneity in extraction efficiency and PCR efficiency, respectively, on the auROC of ChIP-seq read count ratios. We found that increases in the mean PCR efficiency did not appreciably increase the auROC. Similarly, an increase in the heterogeneity of PCR efficiency, in terms of its coefficient of variation across the genome, did not decrease the auROC. In contrast, an increase in the mean extraction efficiency, and a decrease in its heterogeneity, led to a higher auROC. Thus, much like in the case of ChIP-seq fidelity and motif inference, extraction efficiency has a greater impact on the auROC of ChIP-seq read count ratios than PCR efficiency.</p>
<p>
<xref ref-type="fig" rid="pcbi.1006921.g003">Fig 3E</xref> shows that as expected, the auROC increases with the ratio of the mean occupancy of true and false positive binding sites. We illustrate in Methods that this mean occupancy ratio can be considered as a proxy for the specificity of the ChIP antibody used, where a higher mean occupancy ratio translates to a higher antibody specificity. A mean occupancy ratio of ∼10 gives an auROC of around 0.9, which translates to a true positive rate of 0.8 at a false positive rate of 0.07. For a fixed mean occupancy ratio, an increase in the sequencing depth of both ChIP and input samples leads to an increase in the auROC (<xref ref-type="fig" rid="pcbi.1006921.g003">Fig 3F</xref>).</p>
<p>We further evaluated the impact of variation in chromatin accessibility across true and false positive binding sites. Our model of TF-DNA binding in the presence of chromatin assumes that TFs occupy a genomic location only when chromatin is accessible, i.e., the probability of occupancy depends on the energy of the binding site present and the probability that chromatin is accessible at that location (<xref ref-type="disp-formula" rid="pcbi.1006921.e051">Eq (8)</xref>). We found that chromatin accessibility had a low impact on the auROC when the mean accessibility was at least 0.2 (<xref ref-type="supplementary-material" rid="pcbi.1006921.s006">S6 Fig</xref>). We note that <xref ref-type="disp-formula" rid="pcbi.1006921.e051">Eq (8)</xref> implicitly assumes that the probability of occupancy at a genomic location is zero in cells where chromatin is inaccessible. This does not hold for TFs such as pioneer TFs [<xref ref-type="bibr" rid="pcbi.1006921.ref032">32</xref>], which are capable of binding inaccessible chromatin and opening it up for further binding by other TFs. For these TFs, our model under-estimates the occupancy probability at a given genomic location, with the result that the auROC that we obtain in our simulation represents a lower bound.</p>
</sec>
<sec id="sec007">
<title>Indirect binding affects motif inference and lowers sensitivity more than cooperative binding</title>
<p>The target TF (say, A) of a ChIP-seq experiment is said to be indirectly bound to DNA if it does not bind DNA directly but instead binds a second TF (say, B) that in turn directly binds DNA. Thus, an indirectly bound locus lacks a binding site for the target TF, and the number of reads mapped to this location do not depend on the binding energy of A. This can be seen in the top panel of <xref ref-type="fig" rid="pcbi.1006921.g004">Fig 4A</xref>, where the read count ratios of locations directly bound by A depend on the binding energy of A (<italic>R</italic><sup>2</sup> = −0.73, <italic>p</italic> &lt; 10<sup>−115</sup>) whereas the read counts from indirectly bound regions do not (<italic>R</italic><sup>2</sup> = 0.004, <italic>p</italic> = 0.933).</p>
<fig id="pcbi.1006921.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006921.g004</object-id>
<label>Fig 4</label>
<caption>
<title>The relative impact of the inclusion of indirectly bound and cooperatively bound locations on motif inference and ChIP-seq fidelity.</title>
<p>(A) Indirect binding and cooperative binding between TFs A and B are simulated as described in Methods. The scatter plots show the read counts from simulations where 30% of genomic locations are indirectly bound (top panel) or cooperatively bound (bottom panel, interaction energy (Δ) set to −6<italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic>). In the top panel, the binding energy of A shown on the x-axis refers to the energy with which A would bind a location if it were in direct contact with DNA. The binding energies of A and B are sampled from a power law (with exponent 0.5) over a range of [0, 10<italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic>]. (B) Inclusion of indirectly bound locations [left] distorts the inferred motif more than the inclusion of cooperatively bound locations [right panel]. The change in the average K-L distance per base between the baseline motif and inferred motif (y-axis) is plotted against the fraction of indirectly bound regions [left] or cooperatively bound regions [right] on the x-axis. In the right panel, the cooperative interaction energy with the second TF is varied between −6<italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic> (black) and −2<italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic> (blue) (orange). The error bars are the standard deviation obtained from ten replicates of simulation. (C) Indirect binding has a greater impact on ChIP-seq fidelity than cooperative binding. The variation with fidelity and the fraction of indirectly bound [left] or cooperatively bound [right] locations is shown. The fidelity is calculated across all genomic locations (black), the top 25th percentile (blue) and the bottom 25th percentile (orange) of binding sites. The error bars are the standard deviation obtained from ten replicates of simulation.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006921.g004" xlink:type="simple"/>
</fig>
<p>In contrast to indirect binding, genomic locations that are cooperatively bound by the target TF and the second TF contain a binding site for each TF. The magnitude of the cooperative effect is represented by the interaction energy (Δ, in units of <italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic>). Lower (negative) values of Δ represent a larger cooperative effect, with Δ = 0 representing independent binding (see <xref ref-type="disp-formula" rid="pcbi.1006921.e037">Eq (4)</xref>). In the bottom panel of <xref ref-type="fig" rid="pcbi.1006921.g004">Fig 4A</xref>, read count ratios of some cooperatively bound locations (Δ = −6<italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic>) are higher than independently bound regions. Unlike in the case of indirect binding, however, read count ratios from cooperatively bound regions depend on the binding energy of the target TF (<italic>R</italic><sup>2</sup> = −0.66, <italic>p</italic> &lt; 10<sup>−38</sup>), in addition to depending on the binding energy of the second TF and the interaction energy between both TFs.</p>
<p>In <xref ref-type="fig" rid="pcbi.1006921.g004">Fig 4B</xref>, we separately evaluated the impact of indirect and cooperative binding on the inferred PWM of the target TF. A detailed description of PWM inference in the presence of indirect and cooperative binding is given in Methods. The baseline PWM of the TF Tye7 is first computed with direct binding alone. We then computed the mean K-L distance between this baseline PWM and the PWM inferred in the presence of either cooperative binding or indirect binding with a second TF. We found that the inclusion of a given fraction of indirectly bound sequences distorted the inferred PWM more than the inclusion of the same fraction of cooperatively bound sequences. The divergence of the inferred PWM from the baseline depended both on the binding energy range of the indirectly or cooperatively binding second TF, as well as the strength of the cooperative effect.</p>
<p>Similarly, we found that a given fraction of indirectly bound locations had a greater impact on ChIP-seq fidelity than the same fraction of cooperatively bound locations (<xref ref-type="fig" rid="pcbi.1006921.g004">Fig 4C</xref>). This was true even though the cooperativity is high (Δ = −6<italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic>). Indirect and cooperative binding particularly affected the fidelity of read count ratios from the strongest binding sites (the top 25th percentile of read count ratios).</p>
</sec>
<sec id="sec008">
<title>More than two ChIP-seq replicates are needed to reliably estimate binding energies of low affinity sites from read counts</title>
<p>Next, we assessed the accuracy with which the binding energy at a locus can be estimated using ChIP-seq read count ratios, and the impact of replicates on this accuracy. If we denote the true binding energy of the i-th locus as <italic>ϵ</italic><sup>(<italic>i</italic>)</sup> and the estimate of the binding energy as <inline-formula id="pcbi.1006921.e009"><alternatives><graphic id="pcbi.1006921.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:msup><mml:mover><mml:mi>ϵ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>, we expect <inline-formula id="pcbi.1006921.e010"><alternatives><graphic id="pcbi.1006921.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:msup><mml:mover><mml:mi>ϵ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:math></alternatives></inline-formula> to move closer to <italic>ϵ</italic><sup>(<italic>i</italic>)</sup>, on average, as more replicates of ChIP-seq are performed. The first step to quantifying the accuracy of <inline-formula id="pcbi.1006921.e011"><alternatives><graphic id="pcbi.1006921.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e011" xlink:type="simple"/><mml:math display="inline" id="M11"><mml:msup><mml:mover><mml:mi>ϵ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:math></alternatives></inline-formula> is to compute its posterior probability after having observed read count ratios <italic>R</italic><sup>(1)</sup>, <italic>R</italic><sup>(2)</sup>, …, <italic>R</italic><sup>(<italic>n</italic>)</sup> from <italic>n</italic> biological replicates, which is the conditional probability <inline-formula id="pcbi.1006921.e012"><alternatives><graphic id="pcbi.1006921.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e012" xlink:type="simple"/><mml:math display="inline" id="M12"><mml:mrow><mml:mi>P</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mover><mml:mi>ϵ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>=</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mo>|</mml:mo> <mml:msup><mml:mi>R</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mi>R</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msup><mml:mi>R</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. We define the absolute uncertainty or uncertainty of the binding energy estimate to be the 95% Bayesian credible interval of this posterior distribution [<xref ref-type="bibr" rid="pcbi.1006921.ref033">33</xref>], which we take to be the difference between its 97.5th and 2.5th quantiles. The posterior probability, and hence, the uncertainty of <inline-formula id="pcbi.1006921.e013"><alternatives><graphic id="pcbi.1006921.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e013" xlink:type="simple"/><mml:math display="inline" id="M13"><mml:msup><mml:mover><mml:mi>ϵ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:math></alternatives></inline-formula> after <italic>n</italic> + 1 replicates are performed, can be computed from <inline-formula id="pcbi.1006921.e014"><alternatives><graphic id="pcbi.1006921.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e014" xlink:type="simple"/><mml:math display="inline" id="M14"><mml:mrow><mml:mi>P</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mover><mml:mi>ϵ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>=</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mo>|</mml:mo> <mml:msup><mml:mi>R</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mi>R</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msup><mml:mi>R</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> using Bayes’ rule, as shown in Methods.</p>
<p>The expected decrease in the uncertainty of <inline-formula id="pcbi.1006921.e015"><alternatives><graphic id="pcbi.1006921.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e015" xlink:type="simple"/><mml:math display="inline" id="M15"><mml:msup><mml:mover><mml:mi>ϵ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:math></alternatives></inline-formula> as more replicates are performed can be seen in <xref ref-type="fig" rid="pcbi.1006921.g005">Fig 5A</xref>, where the area under posterior probability of <inline-formula id="pcbi.1006921.e016"><alternatives><graphic id="pcbi.1006921.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e016" xlink:type="simple"/><mml:math display="inline" id="M16"><mml:msup><mml:mover><mml:mi>ϵ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:math></alternatives></inline-formula> becomes more concentrated around <italic>ϵ</italic><sup>(<italic>i</italic>)</sup> with each additional replicate. We repeated this procedure to calculate the reduction in uncertainty at locations with binding energies between 2<italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic> and 6<italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic> in <xref ref-type="fig" rid="pcbi.1006921.g005">Fig 5B</xref>, and found that the uncertainty is high at sites with the lowest binding energies even after five replicates are performed. At the lowest binding energies, we also checked if the uncertainty after five replicates sufficed to distinguish between two binding sites that differ by one base pair from each other. From an analysis of binding energy matrices of 368 TFs in the BEEML database [<xref ref-type="bibr" rid="pcbi.1006921.ref013">13</xref>], we estimated that 75% of single mutations change the binding energy of a site by at least 0.24<italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic>, while 50% of single mutations change the energy by at least 0.71<italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic>. Thus, even three replicates of ChIP-seq would allow us to distinguish between two binding sites that are a single mutation apart with a probability between 50% and 75% at only relatively low energy binding sites.</p>
<fig id="pcbi.1006921.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006921.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Impact of multiple biological replicates on uncertainty in binding energy estimates.</title>
<p>(A) Posterior estimate of the binding energy at a single genomic locus after 1-4 replicates. The true binding energy of the locus is 2<italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic>, indicated by the vertical dashed line. Four replicates of ChIP-seq were simulated, with the posterior density after each replicate, with the prior distribution set to be the default binding energy distribution employed in all our simulations (<xref ref-type="sec" rid="sec011">Methods</xref>). The blue lines indicate the absolute uncertainty of the binding energy estimate, which we define as the 95% Bayesian credible interval of the binding energy. This is calculated as the difference between the 2.5th and 97.5th quantiles of the posterior density. (B) The reduction in absolute uncertainty of posterior binding energy estimates of five locations, each with a different binding energy, after five replicates of ChIP-seq. The error bars are the standard deviation in estimates of the absolute uncertainty calculated after 100 trials; the filled circles represent the mean absolute uncertainty from these trials. The dashed red lines represent the values of absolute uncertainty required to distinguish between binding sites sequences that are a single mutation apart at least 50% of the time (upper,0.71<italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic>) and at least 75% of the time (lower,0.24<italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic>).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006921.g005" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec009">
<title>Simulating FASTQ reads using ChIPulate</title>
<p>In addition to simulating read counts from ChIP and control samples as described so far, ChIPulate can output single-end and paired-end reads for each genomic location if its chromosome coordinates are specified.</p>
<p>
<xref ref-type="fig" rid="pcbi.1006921.g006">Fig 6A</xref> illustrates the working of ChIPulate when it is run in FASTQ generation mode. To generate sequence reads, a set of <italic>n</italic> genomic intervals (<italic>b</italic><sub>1</sub>, <italic>e</italic><sub>1</sub>), (<italic>b</italic><sub>2</sub>, <italic>e</italic><sub>2</sub>), …, (<italic>b</italic><sub><italic>n</italic></sub>, <italic>e</italic><sub><italic>n</italic></sub>), along with a set of “summits” <italic>s</italic><sub>1</sub>, <italic>s</italic><sub>2</sub>, …, <italic>s</italic><sub><italic>n</italic></sub> is input to ChIPulate. These summits can be thought of as the physical location of TF-DNA binding in each interval. The total and unique read counts (<italic>r</italic><sub><italic>i</italic></sub> and <italic>u</italic><sub><italic>i</italic></sub>, respectively) at each interval are computed as described in Methods based on the binding energy (or energies) associated with each interval. Fragments that are PCR duplicates are tracked and the reads arising from duplicate fragments are named appropriately to reflect their status as a PCR duplicate. In the ChIP sample, the start positions of fragments in the i-th interval are sampled from a Gaussian distribution with mean <italic>s</italic><sub><italic>i</italic></sub> − <italic>d</italic>/2 and standard deviation <italic>j</italic>, where <italic>d</italic> is the fragment length and <italic>j</italic> is referred to as the fragment jitter. This captures the notion that a genomic position close to a TF-DNA binding event is more likely to give rise to a fragment in the ChIP sample than a genomic position that is far away. In the control sample, each position in an interval is assumed to be equally likely to give rise to a fragment. This corresponds to the Poisson background model assumed by peak callers such as MACS2 [<xref ref-type="bibr" rid="pcbi.1006921.ref024">24</xref>]. Thus, in the control sample, ChIPulate samples start positions in the i-th genomic interval from a Uniform(<italic>b</italic><sub><italic>i</italic></sub>, <italic>e</italic><sub><italic>i</italic></sub>) distribution. The <italic>l</italic> base pairs at the ends of each fragment in both ChIP and control samples represents the read length. Though <xref ref-type="fig" rid="pcbi.1006921.g006">Fig 6A</xref> illustrates the simulation of paired-end reads, ChIPulate can simulate both single-end reads and paired-end libraries, where the sequence of each read is assumed to be error-free.</p>
<fig id="pcbi.1006921.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006921.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Example of simulating sequence reads using ChIPulate.</title>
<p>(A) Illustration of ChIPulate’s read generation method. The i-th genomic location is a genomic interval (<italic>b</italic><sub><italic>i</italic></sub>, <italic>e</italic><sub><italic>i</italic></sub>), with the “summit” of the interval located at <italic>s</italic><sub><italic>i</italic></sub>. The total read count (<italic>r</italic><sub><italic>i</italic></sub>) and unique read count (<italic>u</italic><sub><italic>i</italic></sub>) at the i-th interval in the ChIP and control samples are calculated as described in <xref ref-type="fig" rid="pcbi.1006921.g001">Fig 1</xref>. The starting positions of fragments in the ChIP sample are drawn from a Gaussian distribution with mean <italic>s</italic><sub><italic>i</italic></sub> − <italic>d</italic>/2 and standard deviation <italic>j</italic>, where <italic>d</italic> is the fragment length and <italic>j</italic> is the fragment jitter. In the control sample, fragment start positions are drawn from a Uniform(<italic>b</italic><sub><italic>i</italic></sub>, <italic>e</italic><sub><italic>i</italic></sub>) distribution. The Phred-33 quality value of every base is set to be 75, which corresponds to a base-calling error probability of 10<sup>−42</sup>. The read length is set to <italic>l</italic> bp, and both paired and single end reads can be simulated. (B) Paired-end reads simulated from genomic intervals containing an experimentally determined GCN4 binding site. The genomic intervals containing GCN4 binding sites were taken from an earlier publication [<xref ref-type="bibr" rid="pcbi.1006921.ref034">34</xref>]. Paired-end reads of 50 bp in length were simulated using ChIPulate, with the fragment jitter set at 50 bp and the fragment length set at 200 bp. The binding energy of the highest affinity GCN4 binding site in each interval was computed using the GCN4 binding energy matrix from the BEEML database. The remaining ChIPulate parameters were set at their default values.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006921.g006" xlink:type="simple"/>
</fig>
<p>
<xref ref-type="fig" rid="pcbi.1006921.g006">Fig 6B</xref> is an IGV (Integrated Genomics Viewer) [<xref ref-type="bibr" rid="pcbi.1006921.ref035">35</xref>] snapshot of paired-end reads simulated from a genomic interval containing a GCN4 binding site in the <italic>S. cerevisiae</italic> genome. In this example, we chose a set of 549 genomic regions that were found to be bound by GCN4 in an earlier publication [<xref ref-type="bibr" rid="pcbi.1006921.ref034">34</xref>], and computed the binding energy of GCN4 in each region using its binding energy matrix from the BEEML database. The starting position of the lowest energy binding site was set to be the summit of each region. We then generated the start positions of fragments (200 bp in length) in the ChIP sample by setting the fragment jitter to 50 bp. The read length for the paired-end reads were set at 50 bp at a sequencing depth of 100. The sequence of each read was assigned based on the sequence of the S288C R64-2-1 reference of the <italic>S. cerevisiae</italic> genome [<xref ref-type="bibr" rid="pcbi.1006921.ref036">36</xref>] from the <italic>Saccharomyces</italic> Genome Database [<xref ref-type="bibr" rid="pcbi.1006921.ref037">37</xref>]. The reads generated were aligned to this genome reference using the BWA aligner [<xref ref-type="bibr" rid="pcbi.1006921.ref038">38</xref>].</p>
</sec>
</sec>
<sec id="sec010" sec-type="conclusions">
<title>Discussion</title>
<p>ChIPulate substantially and qualitatively extends previous statistical models of read counts obtained in a ChIP-seq experiment. Early work by Zhang et. al assumed a distribution of binding affinities across the genome and computed occupancy using a similar biophysical model to ours [<xref ref-type="bibr" rid="pcbi.1006921.ref024">24</xref>], but did not simulate extraction and amplification. Bao et. al explicitly accounted for the effect of extraction efficiency on read counts [<xref ref-type="bibr" rid="pcbi.1006921.ref026">26</xref>], but did not model the underlying biophysical occupancy of genomic loci based on their binding energies. More recent work by Ruan et. al, accounted for the effect of chemical potential on TF-DNA occupancy and its impact on motif inference [<xref ref-type="bibr" rid="pcbi.1006921.ref014">14</xref>]. However, the authors evaluated the impact of experimental noise by adding Gaussian noise to the energies of binding sites rather than modeling the downstream processes of the ChIP-seq protocol.</p>
<p>Our pipeline combines a biophysical model of TF-DNA binding with a detailed simulation of fragment extraction, amplification and sequencing. This allows us to analyze the impact of heterogeneity in fragment extraction and PCR amplification on the motif inferred from bound genomic loci, and the fidelity of read count ratios in discriminating relatively close binding energies. We also evaluated how these factors, along with chromatin accessibility and sequencing depth, affect the false positive peak detection rate. The role of biological factors such as indirect binding and cooperative binding, which are frequent occurrences in ChIP-seq datasets, were also evaluated for their impact on motif inference and fidelity. Finally, we measured the accuracy of using read count ratios to infer the energy of a binding site and calculated the improvement in this accuracy after several biological replicates are performed.</p>
<p>In our simulations, fragment extraction encapsulates multiple steps in the ChIP-seq protocol, namely, cross-linking TF-DNA bound complexes, antibody-mediated pull down of fragments bound by the TF, and the removal of cross-links. In addition to the mean extraction efficiency, the nature of the extraction heterogeneity dictates the magnitude of its impact on motif inference and fidelity, with power law distributions having a greater impact than normally distributed heterogeneity. The effect of extraction heterogeneity on motif inference also depended on the structural class of the TF, where we found that a low mean extraction efficiency distorted motifs with a lower information content much more than those with high information content. However, for a given TF, it is unclear as to whether a normal or power law distribution better capture experimental variation in extraction efficiency across the genome. Previous reports suggest that variation in chromatin accessibility alone imposes a power-law distribution on extraction efficiency variation [<xref ref-type="bibr" rid="pcbi.1006921.ref018">18</xref>]. The development of alternate protocols that reduce the number of extraction steps [<xref ref-type="bibr" rid="pcbi.1006921.ref039">39</xref>–<xref ref-type="bibr" rid="pcbi.1006921.ref041">41</xref>] would improve the fidelity of read count ratios and reduce the number of false positive peak calls. In contrast to extraction efficiency, variation in PCR amplification ratio had a much lower impact on motif inference and the fidelity of read count ratios. However, in the presence of sequencing errors during amplification (which our model does not currently include) and imperfect mappability, a large mean amplification ratio in practice would increase false positive peak calls [<xref ref-type="bibr" rid="pcbi.1006921.ref042">42</xref>] and likely affects fidelity more than indicated by our simulations.</p>
<p>Though we explicitly modelled TF-DNA binding here, our conclusion on the impact of extraction and amplification ratio on fidelity also likely holds for the ChIP-seq of histone marks. Though the occupancy of histones in nucleosomal complexes would have to be modelled in a very different manner to that of TFs [<xref ref-type="bibr" rid="pcbi.1006921.ref043">43</xref>–<xref ref-type="bibr" rid="pcbi.1006921.ref046">46</xref>], this only affects the calculation of <inline-formula id="pcbi.1006921.e017"><alternatives><graphic id="pcbi.1006921.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e017" xlink:type="simple"/><mml:math display="inline" id="M17"><mml:msubsup><mml:mi>p</mml:mi> <mml:mi>b</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>. The remaining steps of extraction, PCR amplification and sequencing that are carried out in the ChIP-seq of a histone mark are identical to those that are simulated here. An issue of interest in a histone ChIP-seq dataset is the method employed to process the control sample [<xref ref-type="bibr" rid="pcbi.1006921.ref047">47</xref>, <xref ref-type="bibr" rid="pcbi.1006921.ref048">48</xref>], where employing an antibody against the histone H3 in the control sample provides a better estimate of <italic>p</italic><sub><italic>ext</italic></sub> than an input sample [<xref ref-type="bibr" rid="pcbi.1006921.ref047">47</xref>]. Our simulations suggest that this would be true only if the mean extraction efficiency of fragments with these methods is not too much lower than using an input sample. This is because a low mean value of <italic>p</italic><sub><italic>ext</italic></sub> in the control sample would poorly sample any potential variation in extraction between genomic regions in the ChIP sample.</p>
<p>Extraction of DNA fragments due to indirect binding is believed to be frequent in ChIP-seq experiments [<xref ref-type="bibr" rid="pcbi.1006921.ref010">10</xref>, <xref ref-type="bibr" rid="pcbi.1006921.ref049">49</xref>]. We find that the inclusion of indirectly bound regions has a more adverse effect on motif inference and fidelity than even strongly cooperatively bound regions. The extent of indirect binding in a dataset depends both on antibody quality [<xref ref-type="bibr" rid="pcbi.1006921.ref011">11</xref>, <xref ref-type="bibr" rid="pcbi.1006921.ref023">23</xref>] and the cross-linking protocol employed [<xref ref-type="bibr" rid="pcbi.1006921.ref050">50</xref>] except when the ChIP-seq target protein is a co-factor which, by definition, is always indirectly bound. When antibody quality leads to indirect binding, we note that indirectly bound peaks and false positive peaks are hard to distinguish. Our work suggests that minimizing the extent of indirect binding and developing computational methods to detect them may provide a potent avenue to improving the fidelity of ChIP-seq experiments. For instance, protocols such as ChIP-exo [<xref ref-type="bibr" rid="pcbi.1006921.ref011">11</xref>, <xref ref-type="bibr" rid="pcbi.1006921.ref051">51</xref>, <xref ref-type="bibr" rid="pcbi.1006921.ref052">52</xref>] allow indirectly bound regions to be more easily detected through the peak shapes obtained after alignment and represent an important direction for further improvement of the ChIP-seq protocol.</p>
<p>Our results shows that several replicates of ChIP-seq are required if the energy of a binding site is to be inferred through read count ratios within a certain confidence interval. Since our simulation assumes a single site per peak, it should be noted that a single replicate of ChIP-seq can suffice to accurately infer a PWM for the TF [<xref ref-type="bibr" rid="pcbi.1006921.ref053">53</xref>], which in turn reliably estimates the energy of the binding site [<xref ref-type="bibr" rid="pcbi.1006921.ref054">54</xref>–<xref ref-type="bibr" rid="pcbi.1006921.ref056">56</xref>]. However, in the more general case where a peak may harbor multiple TF binding sites, the mapping between the binding energies of sites and the read count ratios in such a region is far more complex than in our simulation. This means that reliably inferring the occupancy at such a locus through read count ratios is likely to involve more replicates than we have estimated here. Since our simulations in this calculation assumed relatively low heterogeneity in extraction and PCR efficiency, further improvement in these steps of the protocol may not be the most effective avenue to reduce the number of replicates required to infer occupancy. Instead, reduction in sequencing cost to obtain multiple biological replicates of ChIP-seq will yield an accurate inference of <italic>in vivo</italic> occupancy at a genomic locus.</p>
<p>There is considerable scope for extending ChIPulate. We assumed that amplified fragments can be de-duplicated after sequencing in our simulation, which is possible with paired-end sequencing and unique molecular identifier (UMI) based methods of PCR amplification [<xref ref-type="bibr" rid="pcbi.1006921.ref057">57</xref>–<xref ref-type="bibr" rid="pcbi.1006921.ref059">59</xref>]. Most ChIP-seq libraries are, however, subjected to single-end sequencing. It might be of interest to investigate the effect of imperfect de-duplication with single read sequencing. Furthermore, we did not take into account differences in mappability across the genome or sequencing errors, which can cause reads originating from a genomic locus to not map back to the same region [<xref ref-type="bibr" rid="pcbi.1006921.ref060">60</xref>]. These are relatively easy to account for in our simulation since it keeps track of individual fragments when they are extracted, amplified and sequenced. Finally, the FASTQ generation mode of ChIPulate can be used to comprehensively benchmark ChIP-seq peak callers and other computational pipelines that process ChIP-seq data.</p>
<p>Overall we have presented a detailed ChIP-seq simulation model and software pipeline that can be extended in various ways, including other bulk and single-cell sequencing protocols.</p>
</sec>
<sec id="sec011" sec-type="materials|methods">
<title>Methods</title>
<sec id="sec012">
<title>ChIP-seq simulation framework</title>
<sec id="sec013">
<title>Genome-wide TF-DNA binding model</title>
<p>In the most basic version of our simulation, we consider the genome to be a set of <italic>n</italic> locations. Each of these locations contains a single binding site for the ChIP-seq target TF. We follow an approach similar to [<xref ref-type="bibr" rid="pcbi.1006921.ref027">27</xref>], where, at a given point in time, the i-th locus can be in one of two states—bound by the target TF or unbound. We assign a binding energy <italic>ϵ</italic><sub><italic>u</italic></sub> to the unbound state and a binding energy <italic>ϵ</italic><sup>(<italic>i</italic>)</sup> to the bound state. The Boltzmann weights of both these states are then exp(−<italic>ϵ</italic><sub><italic>u</italic></sub>/<italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic>) and exp(−(<italic>ϵ</italic><sup>(<italic>i</italic>)</sup> − <italic>μ</italic>)/<italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic>), respectively. <italic>k</italic><sub><italic>B</italic></sub> is the Boltzmann constant, <italic>T</italic> is the temperature at which the binding occurs, and <italic>μ</italic> is the chemical potential of the TF, which is proportional to the logarithm of the concentration of the TF [<xref ref-type="bibr" rid="pcbi.1006921.ref027">27</xref>]. The probability of finding the i-th locus in the bound state is then
<disp-formula id="pcbi.1006921.e018"><alternatives><graphic id="pcbi.1006921.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e018" xlink:type="simple"/><mml:math display="block" id="M18"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi> <mml:mi>b</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mo form="prefix">exp</mml:mo> <mml:mo>(</mml:mo> <mml:mo>-</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>ϵ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>-</mml:mo> <mml:mi>μ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mi>B</mml:mi></mml:msub> <mml:mi>T</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>Z</mml:mi></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula>
where <italic>Z</italic> = exp(−(<italic>ϵ</italic><sup>(<italic>i</italic>)</sup> − <italic>μ</italic>)/<italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic>) + exp(−<italic>ϵ</italic><sub><italic>u</italic></sub>/<italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic>). This can be re-written as
<disp-formula id="pcbi.1006921.e019"><alternatives><graphic id="pcbi.1006921.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e019" xlink:type="simple"/><mml:math display="block" id="M19"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi> <mml:mi>b</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mo>(</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>ϵ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>-</mml:mo> <mml:msub><mml:mi>ϵ</mml:mi> <mml:mi>u</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:mi>μ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mi>B</mml:mi></mml:msub> <mml:mi>T</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2)</label></disp-formula></p>
<p>Thus, the occupancy at a location is determined by the three quantities <italic>ϵ</italic><sup>(<italic>i</italic>)</sup>, <italic>ϵ</italic><sub><italic>u</italic></sub>, <italic>μ</italic>. In the convention followed in this paper, the scale of <italic>ϵ</italic><sup>(<italic>i</italic>)</sup> is chosen such that the highest affinity binding site has a binding energy of 0, with more positive values representing weaker binding sites. We set <italic>μ</italic> = 3<italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic>, which is within the range of values suggested by an earlier calculation in [<xref ref-type="bibr" rid="pcbi.1006921.ref027">27</xref>]. Finally, we set <italic>ϵ</italic><sub><italic>u</italic></sub> = 1.59<italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic>, which ensures that at the location with the highest affinity site i.e., when <italic>ϵ</italic><sup>(<italic>i</italic>)</sup> = 0, the occupancy probability <inline-formula id="pcbi.1006921.e020"><alternatives><graphic id="pcbi.1006921.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e020" xlink:type="simple"/><mml:math display="inline" id="M20"><mml:msubsup><mml:mi>p</mml:mi> <mml:mi>b</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> is 0.99.</p>
<p><italic>ϵ</italic><sup>(<italic>i</italic>)</sup> can be thought of as a mismatch binding energy, where mutations that change the binding site sequence away from the highest affinity sequence increase its energy and thus lower the probability that it is occupied. This is in line with the convention followed in the binding energy matrices in the BEEML database.</p>
<p>To compute the probabilities of binding at all <italic>n</italic> locations, <inline-formula id="pcbi.1006921.e021"><alternatives><graphic id="pcbi.1006921.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e021" xlink:type="simple"/><mml:math display="inline" id="M21"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi> <mml:mi>b</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>p</mml:mi> <mml:mi>b</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>p</mml:mi> <mml:mi>b</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, using <xref ref-type="disp-formula" rid="pcbi.1006921.e018">Eq (1)</xref>, we assign a binding energy to each locus. We sample binding energies from a power law that is truncated to a specified range. We define the probability density function <italic>f</italic> of this truncated power law, with parameters 1 &gt; <italic>α</italic> &gt; 0, <italic>E</italic><sub><italic>max</italic></sub> &gt; 0, as
<disp-formula id="pcbi.1006921.e022"><alternatives><graphic id="pcbi.1006921.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e022" xlink:type="simple"/><mml:math display="block" id="M22"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>{</mml:mo> <mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mi>α</mml:mi></mml:mrow> <mml:msubsup><mml:mi>E</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mi>α</mml:mi></mml:mrow></mml:msubsup></mml:mfrac> <mml:mfrac><mml:mn>1</mml:mn> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>E</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>α</mml:mi></mml:msup></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="right"><mml:mrow><mml:mn>0</mml:mn> <mml:mo>&lt;</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mo>&lt;</mml:mo> <mml:msub><mml:mi>E</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="right"><mml:mrow><mml:mtext>otherwise</mml:mtext> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable> <mml:mo/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(3)</label></disp-formula></p>
<p>Our choice of such a power law is motivated by the analysis of binding energies of sites that are occupied by the TFs CRP and FNR in the <italic>E. coli</italic> genome [<xref ref-type="bibr" rid="pcbi.1006921.ref061">61</xref>]. Unless stated otherwise, we set <italic>α</italic> = 0.5 and <italic>E</italic><sub><italic>max</italic></sub> = 10<italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic>. This corresponds to a situation where most of the binding sites in the genome have a low affinity (or high energy) for the target TF. <italic>E</italic><sub><italic>max</italic></sub> = 10<italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic> typically corresponds to a binding site that is 3-4 mutations away from the strongest binding site, since each mutation to the strongest sequence typically adds an energy 1 − 3<italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic> to it for most TFs [<xref ref-type="bibr" rid="pcbi.1006921.ref027">27</xref>]. We set the chemical potential of the target TF, <italic>μ</italic>, to be 3<italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic> by default in all our simulations in the main text.</p>
<p>In a population of <italic>C</italic> cells, when the i-th locus has a probability <inline-formula id="pcbi.1006921.e023"><alternatives><graphic id="pcbi.1006921.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e023" xlink:type="simple"/><mml:math display="inline" id="M23"><mml:msubsup><mml:mi>p</mml:mi> <mml:mi>b</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> of being bound, then the number of bound fragments extracted from the i-th locus, denoted <inline-formula id="pcbi.1006921.e024"><alternatives><graphic id="pcbi.1006921.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e024" xlink:type="simple"/><mml:math display="inline" id="M24"><mml:msubsup><mml:mi>F</mml:mi> <mml:mi>b</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>, follows a <inline-formula id="pcbi.1006921.e025"><alternatives><graphic id="pcbi.1006921.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e025" xlink:type="simple"/><mml:math display="inline" id="M25"><mml:mrow><mml:mtext>Binomial</mml:mtext><mml:mo>(</mml:mo> <mml:mi>C</mml:mi> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>p</mml:mi> <mml:mi>b</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> distribution, where the mean number of bound fragments is <inline-formula id="pcbi.1006921.e026"><alternatives><graphic id="pcbi.1006921.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e026" xlink:type="simple"/><mml:math display="inline" id="M26"><mml:mrow><mml:mi>C</mml:mi> <mml:msubsup><mml:mi>p</mml:mi> <mml:mi>b</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p>In most ChIP-seq experiments, a small number of cells are used to carry out a control, or input, experiment where fragments from cells are extracted without the use of antibody specific to the target TF. The read counts obtained in the input experiment are used to normalize, in a region or locus-specific manner, the read counts obtained from the ChIP sample. The input sample helps take into account heterogeneity that may arise in the extraction, amplification and sequencing of fragments from different genomic locations. The difference between the input and ChIP samples is in the number of cells employed and the probability of occupancy employed for each location. We assume that 10% of the number of cells used in the ChIP experiment are used in the input sample. The occupancy of genomic regions in the background sample consists of the non-specific binding of all the TFs in the cell, along with different sets of TFs that may be specifically bound at each genomic location. We phenomenologically model this scenario by assigning a fixed background binding energy <inline-formula id="pcbi.1006921.e027"><alternatives><graphic id="pcbi.1006921.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e027" xlink:type="simple"/><mml:math display="inline" id="M27"><mml:msub><mml:mover><mml:mi>ϵ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mi>b</mml:mi> <mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> to each of the <italic>n</italic> genomic locations, from which we use <xref ref-type="disp-formula" rid="pcbi.1006921.e018">Eq (1)</xref> to compute the probability of occupancy <inline-formula id="pcbi.1006921.e028"><alternatives><graphic id="pcbi.1006921.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e028" xlink:type="simple"/><mml:math display="inline" id="M28"><mml:mover accent="true"><mml:msub><mml:mi>p</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mo>¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula>. We set <italic>μ</italic> = 0 in <xref ref-type="disp-formula" rid="pcbi.1006921.e018">Eq (1)</xref> for the input sample and keep <italic>ϵ</italic><sub><italic>u</italic></sub> = 1.59<italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic>.</p>
<p>If the number of cells used in the input sample is <italic>C</italic>′, then the number of bound fragments at each location follows a <inline-formula id="pcbi.1006921.e029"><alternatives><graphic id="pcbi.1006921.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e029" xlink:type="simple"/><mml:math display="inline" id="M29"><mml:mrow><mml:mtext>Binomial</mml:mtext><mml:mo>(</mml:mo> <mml:mrow><mml:msup><mml:mi>C</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:msub><mml:mi>p</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mo>¯</mml:mo></mml:mover></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> distribution. Unless stated otherwise, we set <inline-formula id="pcbi.1006921.e030"><alternatives><graphic id="pcbi.1006921.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e030" xlink:type="simple"/><mml:math display="inline" id="M30"><mml:msub><mml:mover><mml:mi>ϵ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mi>b</mml:mi> <mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> to 1<italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic> in simulations where we do not model false positive binding sites in the ChIP sample. When we simulate false positive binding sites, we set <inline-formula id="pcbi.1006921.e031"><alternatives><graphic id="pcbi.1006921.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e031" xlink:type="simple"/><mml:math display="inline" id="M31"><mml:msub><mml:mover><mml:mi>ϵ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mi>b</mml:mi> <mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> to a value where the ratio between the mean probability of occupancy in the ChIP sample to the mean probability of occupancy in the input sample is 10.</p>
<p>Aside from these differences in the TF-DNA binding model in the input and ChIP samples, the simulation procedures used in the description of the extraction, amplification and sequencing steps are common to both samples.</p>
</sec>
<sec id="sec014">
<title>Cooperative binding</title>
<p>Consider TFs A and B, where A is the target of the ChIP-seq experiment, however, its binding depends on nearby binding of TF B. To simulate such cooperative binding between A and B, we have each of the <italic>n</italic> genomic locations in our simulation to contain a single binding site each for A and B, with binding energies <inline-formula id="pcbi.1006921.e032"><alternatives><graphic id="pcbi.1006921.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e032" xlink:type="simple"/><mml:math display="inline" id="M32"><mml:msubsup><mml:mi>ϵ</mml:mi> <mml:mi>A</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006921.e033"><alternatives><graphic id="pcbi.1006921.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e033" xlink:type="simple"/><mml:math display="inline" id="M33"><mml:msubsup><mml:mi>ϵ</mml:mi> <mml:mi>B</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and an interaction energy Δ between them.</p>
<p>A given genomic locus can be in one of four states—unbound, bound by A, bound by B, or bound by both A and B. The probabilities of the locus being in each of these four states is [<xref ref-type="bibr" rid="pcbi.1006921.ref062">62</xref>]
<disp-formula id="pcbi.1006921.e034"><alternatives><graphic id="pcbi.1006921.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e034" xlink:type="simple"/><mml:math display="block" id="M34"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="normal">P</mml:mi> <mml:mo>(</mml:mo> <mml:mtext>unbound</mml:mtext> <mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mo>(</mml:mo> <mml:mo>-</mml:mo> <mml:msub><mml:mi>ϵ</mml:mi> <mml:mi>u</mml:mi></mml:msub> <mml:mo>/</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mi>B</mml:mi></mml:msub> <mml:mi>T</mml:mi> <mml:mo>)</mml:mo> <mml:mo>/</mml:mo> <mml:mi>Z</mml:mi> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="normal">P</mml:mi> <mml:mo>(</mml:mo> <mml:mtext>bound</mml:mtext><mml:mspace width="4pt"/><mml:mtext>by</mml:mtext><mml:mspace width="4pt"/><mml:mtext>A</mml:mtext> <mml:mspace width="4pt"/><mml:mtext>only</mml:mtext><mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mo>(</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>ϵ</mml:mi> <mml:mi>A</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>+</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>A</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mi>B</mml:mi></mml:msub> <mml:mi>T</mml:mi> <mml:mo>)</mml:mo> <mml:mo>/</mml:mo> <mml:mi>Z</mml:mi> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="normal">P</mml:mi> <mml:mo>(</mml:mo> <mml:mtext>bound</mml:mtext><mml:mspace width="4pt"/><mml:mtext>by</mml:mtext><mml:mspace width="4pt"/><mml:mtext>B</mml:mtext> <mml:mspace width="4pt"/><mml:mtext>only</mml:mtext><mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mo>(</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>ϵ</mml:mi> <mml:mi>B</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>+</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>B</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mi>B</mml:mi></mml:msub> <mml:mi>T</mml:mi> <mml:mo>)</mml:mo> <mml:mo>/</mml:mo> <mml:mi>Z</mml:mi> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="normal">P</mml:mi> <mml:mo>(</mml:mo> <mml:mtext>bound</mml:mtext><mml:mspace width="4pt"/><mml:mtext>by</mml:mtext><mml:mspace width="4pt"/><mml:mtext>A</mml:mtext> <mml:mspace width="4pt"/><mml:mtext>and</mml:mtext><mml:mspace width="4pt"/><mml:mtext>B</mml:mtext> <mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mo>(</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>ϵ</mml:mi> <mml:mi>A</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>ϵ</mml:mi> <mml:mi>B</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>+</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>A</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>B</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:mo>Δ</mml:mo> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mi>B</mml:mi></mml:msub> <mml:mi>T</mml:mi> <mml:mo>)</mml:mo> <mml:mo>/</mml:mo> <mml:mi>Z</mml:mi> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <inline-formula id="pcbi.1006921.e035"><alternatives><graphic id="pcbi.1006921.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e035" xlink:type="simple"/><mml:math display="inline" id="M35"><mml:mrow><mml:mi>Z</mml:mi> <mml:mo>=</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>-</mml:mo> <mml:msub><mml:mi>ϵ</mml:mi> <mml:mi>u</mml:mi></mml:msub> <mml:mo>/</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mi>B</mml:mi></mml:msub> <mml:mi>T</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>ϵ</mml:mi> <mml:mi>A</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>+</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>A</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mi>B</mml:mi></mml:msub> <mml:mi>T</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>ϵ</mml:mi> <mml:mi>B</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>+</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>B</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mi>B</mml:mi></mml:msub> <mml:mi>T</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>ϵ</mml:mi> <mml:mi>A</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>ϵ</mml:mi> <mml:mi>B</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>-</mml:mo> <mml:mo>Δ</mml:mo> <mml:mo>+</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>A</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>B</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mi>B</mml:mi></mml:msub> <mml:mi>T</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Δ = 0 corresponds to independent binding between A and B, Δ &lt; 0 corresponds to cooperative binding between A and B and Δ &gt; 0 represents competitive binding between A and B.</p>
<p>Since the ChIP experiment involves extracting fragments that are bound by A, the probability of a location being bound by A is the sum of the probability of the location being bound only by A and the probability of being bound by A and B. Thus, the occupancy probability of the i-th location, <inline-formula id="pcbi.1006921.e036"><alternatives><graphic id="pcbi.1006921.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e036" xlink:type="simple"/><mml:math display="inline" id="M36"><mml:msubsup><mml:mi>p</mml:mi> <mml:mi>b</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>, as seen in the ChIP-seq of A is:
<disp-formula id="pcbi.1006921.e037"><alternatives><graphic id="pcbi.1006921.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e037" xlink:type="simple"/><mml:math display="block" id="M37"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi> <mml:mi>b</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo><mml:mo>*</mml:mo><mml:mo form="prefix">exp</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>ϵ</mml:mi> <mml:mi>A</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>+</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>A</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mi>B</mml:mi></mml:msub> <mml:mi>T</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>ϵ</mml:mi> <mml:mi>A</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>ϵ</mml:mi> <mml:mi>B</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>-</mml:mo> <mml:mo>Δ</mml:mo> <mml:mo>+</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>A</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>B</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mi>B</mml:mi></mml:msub> <mml:mi>T</mml:mi> <mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo> <mml:mi>Z</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(4)</label></disp-formula></p>
<p>We assume here that the binding site of A is not occupied by B, and vice versa. Further, we assume that there is no cooperativity between two distinct genomic locations <italic>i</italic> and <italic>j</italic>.</p>
</sec>
<sec id="sec015">
<title>Indirect binding</title>
<p>Consider TFs A and B, where A is the target of the ChIP-seq experiment. We say that A indirectly binds DNA if A binds to B which in turn binds DNA. To simulate indirect binding, we assume that the probability of occupancy <inline-formula id="pcbi.1006921.e038"><alternatives><graphic id="pcbi.1006921.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e038" xlink:type="simple"/><mml:math display="inline" id="M38"><mml:msubsup><mml:mi>p</mml:mi> <mml:mi>b</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> is proportional to the binding energy of B at the i-th location, <inline-formula id="pcbi.1006921.e039"><alternatives><graphic id="pcbi.1006921.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e039" xlink:type="simple"/><mml:math display="inline" id="M39"><mml:msubsup><mml:mi>ϵ</mml:mi> <mml:mi>B</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> as
<disp-formula id="pcbi.1006921.e040"><alternatives><graphic id="pcbi.1006921.e040g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e040" xlink:type="simple"/><mml:math display="block" id="M40"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi> <mml:mi>b</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mo>(</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>ϵ</mml:mi> <mml:mi>B</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>-</mml:mo> <mml:msub><mml:mi>ϵ</mml:mi> <mml:mi>u</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>B</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mi>B</mml:mi></mml:msub> <mml:mi>T</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(5)</label></disp-formula></p>
<p>On the other hand, at locations directly bound by A, <inline-formula id="pcbi.1006921.e041"><alternatives><graphic id="pcbi.1006921.e041g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e041" xlink:type="simple"/><mml:math display="inline" id="M41"><mml:msubsup><mml:mi>p</mml:mi> <mml:mi>b</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> is dependent on <inline-formula id="pcbi.1006921.e042"><alternatives><graphic id="pcbi.1006921.e042g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e042" xlink:type="simple"/><mml:math display="inline" id="M42"><mml:msubsup><mml:mi>ϵ</mml:mi> <mml:mi>A</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> according to <xref ref-type="disp-formula" rid="pcbi.1006921.e018">Eq (1)</xref>. We further assume that B cannot occupy binding sites of A, and <italic>vice versa</italic>.</p>
</sec>
<sec id="sec016">
<title>False positive binding sites</title>
<p>We consider a detected binding site to be false positive if it is bound by a TF (or TFs) other than the target TF of a ChIP-seq, or not bound by any TF at all, but fragments from which are nonetheless extracted in Step 2 of simulation. This differs from indirect binding, where the target TF is part of the complex of TFs that is bound to DNA. False positives reflect antibody quality or specificity.</p>
<p>In our simulations of false positive binding sites in <xref ref-type="fig" rid="pcbi.1006921.g003">Fig 3</xref>, we set the number of false positive binding sites to be equal to the number of true positive binding sites. We note that the area under the ROC curve is independent of the number of false positive binding sites simulated.</p>
<p>We set the binding energy distribution of true positive binding sites to be a power law between 0 and 6<italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic> with <italic>α</italic> = 0.5. This differs from the default power law distribution employed for true positive binding energies in our other simulations. This was because we found that binding sites with energies in the range 7 − 10<italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic> had read count ratios that were very close to each other. Thus, when we computed the ROC curve with binding sites in this energy range, we saw that the true positive rate showed an abrupt jump as the threshold on the read count ratio was lowered below a point. Such jumps in the true positive rate make it difficult to compare ROC curves. By restricting the energy range of true positive binding sites to between 0 and 6<italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic>, we ensured that the true positive rate did not display this jump-like behaviour, which in turn allowed us to use the auROC as an accurate measure of detection performance.</p>
<p>We set the binding energies of the false positive sites to follow a power law distribution where the minimum binding site energy was 0<italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic>. The maximum binding energy (<inline-formula id="pcbi.1006921.e043"><alternatives><graphic id="pcbi.1006921.e043g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e043" xlink:type="simple"/><mml:math display="inline" id="M43"><mml:msubsup><mml:mi>E</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow> <mml:mrow><mml:mi>f</mml:mi> <mml:mi>p</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>) and <italic>α</italic><sub><italic>fp</italic></sub> was set such that the ratio of the means of true and false positive binding energies could be fixed at a constant value while the variances were kept equal. Suppose the true positive binding energy distribution follows a power law over the energy range <inline-formula id="pcbi.1006921.e044"><alternatives><graphic id="pcbi.1006921.e044g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e044" xlink:type="simple"/><mml:math display="inline" id="M44"><mml:mrow><mml:mo>[</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>E</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow> <mml:mrow><mml:mi>t</mml:mi> <mml:mi>p</mml:mi></mml:mrow></mml:msubsup> <mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and exponent <italic>α</italic><sub><italic>tp</italic></sub> such that its mean is <italic>m</italic> and variance is <italic>v</italic>. Then, setting <italic>α</italic><sub><italic>fp</italic></sub> and <inline-formula id="pcbi.1006921.e045"><alternatives><graphic id="pcbi.1006921.e045g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e045" xlink:type="simple"/><mml:math display="inline" id="M45"><mml:msubsup><mml:mi>E</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow> <mml:mrow><mml:mi>f</mml:mi> <mml:mi>p</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> as
<disp-formula id="pcbi.1006921.e046"><alternatives><graphic id="pcbi.1006921.e046g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e046" xlink:type="simple"/><mml:math display="block" id="M46"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msup><mml:mi>α</mml:mi> <mml:mrow><mml:mi>f</mml:mi> <mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mn>3</mml:mn> <mml:mo>+</mml:mo> <mml:mn>2</mml:mn> <mml:mo>/</mml:mo> <mml:mo>(</mml:mo> <mml:mi>r</mml:mi> <mml:mo>-</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:msubsup><mml:mi>E</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow> <mml:mrow><mml:mi>f</mml:mi> <mml:mi>p</mml:mi></mml:mrow></mml:msubsup></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mi>f</mml:mi> <mml:mi>m</mml:mi> <mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>-</mml:mo> <mml:msup><mml:mi>α</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mi>p</mml:mi></mml:mrow></mml:msup> <mml:mo>)</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(6)</label></disp-formula>
where <italic>r</italic> = <italic>v</italic>/(<italic>g</italic><sup>2</sup> <italic>m</italic><sup>2</sup>) + 1, sets the mean false positive binding energy to be <italic>fm</italic> while the variance remains at <italic>v</italic>.</p>
<p>Once the true and false positive binding energies are sampled, we compute the ratio between the mean occupancy of the true positive sites to that of the false positive binding sites. This is calculated as
<disp-formula id="pcbi.1006921.e047"><alternatives><graphic id="pcbi.1006921.e047g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e047" xlink:type="simple"/><mml:math display="block" id="M47"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>m</mml:mi> <mml:mrow><mml:mi>o</mml:mi> <mml:mi>c</mml:mi> <mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:msub><mml:mi>N</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:msubsup> <mml:msubsup><mml:mi>p</mml:mi> <mml:mrow><mml:mi>b</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mi>p</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>/</mml:mo> <mml:msub><mml:mi>N</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:msub><mml:mi>N</mml:mi> <mml:mrow><mml:mi>f</mml:mi> <mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:msubsup> <mml:msubsup><mml:mi>p</mml:mi> <mml:mrow><mml:mi>b</mml:mi> <mml:mo>,</mml:mo> <mml:mi>f</mml:mi> <mml:mi>p</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>/</mml:mo> <mml:msub><mml:mi>N</mml:mi> <mml:mrow><mml:mi>f</mml:mi> <mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(7)</label></disp-formula>
where <italic>N</italic><sub><italic>fp</italic></sub> and <italic>N</italic><sub><italic>tp</italic></sub> are the number of false and true positive binding sites, respectively, and <inline-formula id="pcbi.1006921.e048"><alternatives><graphic id="pcbi.1006921.e048g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e048" xlink:type="simple"/><mml:math display="inline" id="M48"><mml:msubsup><mml:mi>p</mml:mi> <mml:mrow><mml:mi>b</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mi>p</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006921.e049"><alternatives><graphic id="pcbi.1006921.e049g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e049" xlink:type="simple"/><mml:math display="inline" id="M49"><mml:msubsup><mml:mi>p</mml:mi> <mml:mrow><mml:mi>b</mml:mi> <mml:mo>,</mml:mo> <mml:mi>f</mml:mi> <mml:mi>p</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> are occupancies at true and false binding sites respectively.</p>
<p>In <xref ref-type="fig" rid="pcbi.1006921.g003">Fig 3</xref>, we set <italic>α</italic><sub><italic>fp</italic></sub> = 0.76 and <inline-formula id="pcbi.1006921.e050"><alternatives><graphic id="pcbi.1006921.e050g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e050" xlink:type="simple"/><mml:math display="inline" id="M50"><mml:mrow><mml:msubsup><mml:mi>E</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow> <mml:mrow><mml:mi>f</mml:mi> <mml:mi>p</mml:mi></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>6</mml:mn> <mml:mo>.</mml:mo> <mml:mn>78</mml:mn> <mml:msub><mml:mi>k</mml:mi> <mml:mi>B</mml:mi></mml:msub> <mml:mi>T</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, which corresponds to a mean occupancy ratio of ∼2. This is in line with the antibody recommendations of the ENCODE consortium [<xref ref-type="bibr" rid="pcbi.1006921.ref023">23</xref>], whose recommendation for antibody quality is that the primary reactive band should be at least 50% of the signal on the blot, which we interpret to represent a mean occupancy ratio between true positive and false positive sites in the ChIP sample to be at least 2.</p>
<p>Finally, we set the background binding energy, which determines the occupancy of fragments in the input sample, to a value of 4.96<italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic>. This sets the ratio of the mean occupancy of true positive sites in the ChIP sample to the mean occupancy of the same sites in the input sample to 10. This is in line with the 5− to 13− fold-enrichment observed in read counts of ChIP-seq peaks between the ChIP and input samples in the ENCODE project [<xref ref-type="bibr" rid="pcbi.1006921.ref023">23</xref>].</p>
</sec>
<sec id="sec017">
<title>Chromatin accessibility</title>
<p>We modeled chromatin accessibility using a sigmoidal prior based on DNAse-seq hypersensitivity data following [<xref ref-type="bibr" rid="pcbi.1006921.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1006921.ref063">63</xref>]. Briefly, the occupancy probability calculated based on the binding energies in <xref ref-type="disp-formula" rid="pcbi.1006921.e018">Eq (1)</xref> is multiplied by the sigmoidal function—
<disp-formula id="pcbi.1006921.e051"><alternatives><graphic id="pcbi.1006921.e051g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e051" xlink:type="simple"/><mml:math display="block" id="M51"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>c</mml:mi> <mml:mi>c</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mo>(</mml:mo> <mml:mo>-</mml:mo> <mml:mi>β</mml:mi> <mml:mi>d</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(8)</label></disp-formula>
where <italic>d</italic> is the DNAse-seq read count density, which is average per-base DNASe-seq read coverage within a 150 bp window.</p>
<p>Thus, for a genomic locus whose occupancy probability is <italic>p</italic><sub><italic>b</italic></sub>, the probability that it is bound in Step 1 of our simulation is the product <italic>p</italic><sub><italic>b</italic></sub> <italic>p</italic><sub><italic>acc</italic></sub>. Thus, the occupancy probability essentially provides a scaling factor for binding probability.</p>
<p>Instead of simulating a profile of DNAse-seq read counts across the genome, we used read counts from DNAse-seq data of the <italic>M. musculus</italic> DBA/2 cell line (accession number ENCFF871YIT, lab of John Stamatoyannopoulos), available from the ENCODE Consortium [<xref ref-type="bibr" rid="pcbi.1006921.ref064">64</xref>, <xref ref-type="bibr" rid="pcbi.1006921.ref065">65</xref>]. We used the filtered binary alignment map (BAM) files, which were aligned to the mm10 genome assembly using the ENCODE data processing pipeline. We chose the DNAseq-seq profile of this cell line as a reference DNAse-seq profile since it cleared all quality audit error categories laid out by the ENCODE Consortium for DNAse-seq data.</p>
<p>In order to consider only regions with accessible chromatin, we counted the number of reads falling into non-overlapping 100 kb windows of the genome and retained the top 10% of windows that had the highest read counts. We finally counted the reads falling into non-overlapping 150 bp windows and stored these read counts. In each ChIP-seq simulation, we uniformly sampled read counts of <italic>n</italic> of these regions, where <italic>n</italic> is the number of binding locations being simulated, and plugged them into <xref ref-type="disp-formula" rid="pcbi.1006921.e051">Eq (8)</xref> (after dividing the counts by 150) to compute chromatin accessibility.</p>
</sec>
</sec>
<sec id="sec018">
<title>The extraction process</title>
<p>Given the number of bound fragments <inline-formula id="pcbi.1006921.e052"><alternatives><graphic id="pcbi.1006921.e052g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e052" xlink:type="simple"/><mml:math display="inline" id="M52"><mml:mrow><mml:msubsup><mml:mi>F</mml:mi> <mml:mi>b</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>F</mml:mi> <mml:mi>b</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, each fragment needs to be extracted from the cell population. This extraction process involves several steps that include the lysing of cells to extract DNA, cross-linking of bound proteins to DNA, the size selection of sheared fragments, etc. After each of these steps, the number of bound fragments either stays the same or reduces. Our model of fragment loss during these steps tracks the reduction in fragment numbers prior to PCR amplification step.</p>
<p>We assume that the number of extracted fragments from the i-th genomic locus, denoted <inline-formula id="pcbi.1006921.e053"><alternatives><graphic id="pcbi.1006921.e053g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e053" xlink:type="simple"/><mml:math display="inline" id="M53"><mml:msubsup><mml:mi>F</mml:mi> <mml:mi>e</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>, follows a <inline-formula id="pcbi.1006921.e054"><alternatives><graphic id="pcbi.1006921.e054g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e054" xlink:type="simple"/><mml:math display="inline" id="M54"><mml:mrow><mml:mtext>Binomial</mml:mtext><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>F</mml:mi> <mml:mi>b</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>p</mml:mi> <mml:mi>e</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> distribution. <inline-formula id="pcbi.1006921.e055"><alternatives><graphic id="pcbi.1006921.e055g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e055" xlink:type="simple"/><mml:math display="inline" id="M55"><mml:msubsup><mml:mi>p</mml:mi> <mml:mi>e</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> is the probability of a bound fragment from the i-th region being successfully extracted and present in the pre-PCR fragment pool. <italic>p</italic><sub><italic>e</italic></sub> can vary across the genome [<xref ref-type="bibr" rid="pcbi.1006921.ref066">66</xref>, <xref ref-type="bibr" rid="pcbi.1006921.ref067">67</xref>] and is also dependent on the extraction procedure employed [<xref ref-type="bibr" rid="pcbi.1006921.ref068">68</xref>]. Unless stated otherwise, we assume that <italic>p</italic><sub><italic>e</italic></sub> follows a normal distribution truncated to lie between 0 and 1, with a mean of 0.5 and a standard deviation of 0.05.</p>
<p>Since we assume that <inline-formula id="pcbi.1006921.e056"><alternatives><graphic id="pcbi.1006921.e056g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e056" xlink:type="simple"/><mml:math display="inline" id="M56"><mml:msubsup><mml:mi>F</mml:mi> <mml:mi>e</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> is a binomial sample of <inline-formula id="pcbi.1006921.e057"><alternatives><graphic id="pcbi.1006921.e057g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e057" xlink:type="simple"/><mml:math display="inline" id="M57"><mml:msubsup><mml:mi>F</mml:mi> <mml:mi>b</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> fragments, the addition of more extraction steps into the simulation only changes the value of <inline-formula id="pcbi.1006921.e058"><alternatives><graphic id="pcbi.1006921.e058g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e058" xlink:type="simple"/><mml:math display="inline" id="M58"><mml:msubsup><mml:mi>p</mml:mi> <mml:mi>e</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> without necessarily violating the binomial assumption. Suppose we add an additional extraction step with efficiency <italic>e</italic><sub><italic>i</italic></sub> into the simulation such that <inline-formula id="pcbi.1006921.e059"><alternatives><graphic id="pcbi.1006921.e059g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e059" xlink:type="simple"/><mml:math display="inline" id="M59"><mml:mrow><mml:msubsup><mml:mi>F</mml:mi> <mml:mi>e</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>∼</mml:mo> <mml:mtext>Binomial</mml:mtext><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>X</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, where <inline-formula id="pcbi.1006921.e060"><alternatives><graphic id="pcbi.1006921.e060g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e060" xlink:type="simple"/><mml:math display="inline" id="M60"><mml:mrow><mml:msub><mml:mi>X</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>∼</mml:mo> <mml:mtext>Binomial</mml:mtext><mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>F</mml:mi> <mml:mi>b</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>p</mml:mi> <mml:mi>e</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Then, by the laws of total variance and total expectation, the mean of <inline-formula id="pcbi.1006921.e061"><alternatives><graphic id="pcbi.1006921.e061g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e061" xlink:type="simple"/><mml:math display="inline" id="M61"><mml:msubsup><mml:mi>F</mml:mi> <mml:mi>e</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>, for a fixed value of <inline-formula id="pcbi.1006921.e062"><alternatives><graphic id="pcbi.1006921.e062g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e062" xlink:type="simple"/><mml:math display="inline" id="M62"><mml:msubsup><mml:mi>F</mml:mi> <mml:mi>b</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>, is <inline-formula id="pcbi.1006921.e063"><alternatives><graphic id="pcbi.1006921.e063g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e063" xlink:type="simple"/><mml:math display="inline" id="M63"><mml:mrow><mml:msubsup><mml:mi>F</mml:mi> <mml:mi>b</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:msubsup><mml:mi>p</mml:mi> <mml:mi>e</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:msub><mml:mi>e</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> and its variance is <inline-formula id="pcbi.1006921.e064"><alternatives><graphic id="pcbi.1006921.e064g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e064" xlink:type="simple"/><mml:math display="inline" id="M64"><mml:mrow><mml:msubsup><mml:mi>F</mml:mi> <mml:mi>b</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:msubsup><mml:mi>p</mml:mi> <mml:mi>e</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:msub><mml:mi>e</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>p</mml:mi> <mml:mi>e</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:msub><mml:mi>e</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. By setting <inline-formula id="pcbi.1006921.e065"><alternatives><graphic id="pcbi.1006921.e065g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e065" xlink:type="simple"/><mml:math display="inline" id="M65"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi> <mml:mi>i</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>p</mml:mi> <mml:mi>e</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:msub><mml:mi>e</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, we see that <inline-formula id="pcbi.1006921.e066"><alternatives><graphic id="pcbi.1006921.e066g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e066" xlink:type="simple"/><mml:math display="inline" id="M66"><mml:msubsup><mml:mi>F</mml:mi> <mml:mi>e</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> (conditioned on <inline-formula id="pcbi.1006921.e067"><alternatives><graphic id="pcbi.1006921.e067g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e067" xlink:type="simple"/><mml:math display="inline" id="M67"><mml:msubsup><mml:mi>F</mml:mi> <mml:mi>b</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>) follows a <inline-formula id="pcbi.1006921.e068"><alternatives><graphic id="pcbi.1006921.e068g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e068" xlink:type="simple"/><mml:math display="inline" id="M68"><mml:mrow><mml:mtext>Binomial</mml:mtext> <mml:mo>(</mml:mo> <mml:msubsup><mml:mi>F</mml:mi> <mml:mi>b</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>p</mml:mi> <mml:mi>i</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> distribution up to the first two moments. Thus, the parameter <inline-formula id="pcbi.1006921.e069"><alternatives><graphic id="pcbi.1006921.e069g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e069" xlink:type="simple"/><mml:math display="inline" id="M69"><mml:msubsup><mml:mi>p</mml:mi> <mml:mi>e</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> can be thought to implicitly take into account a variety of steps employed in the extraction process.</p>
<p>As stated in the previous section, we employ the same values of <inline-formula id="pcbi.1006921.e070"><alternatives><graphic id="pcbi.1006921.e070g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e070" xlink:type="simple"/><mml:math display="inline" id="M70"><mml:msubsup><mml:mi>p</mml:mi> <mml:mi>e</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> in both ChIP and input samples. In a single run of the simulation, it can happen that the number of fragments extracted in the ChIP sample exceeds that of the input sample, or vice versa. In practice, since fragments are typically more efficiently extracted in the input sample than in the ChIP sample, DNA extracted from the input library is diluted such that the number of fragments in both ChIP and input samples are equalized before amplification.</p>
<p>In our simulation, we compute a down-sampling factor <inline-formula id="pcbi.1006921.e071"><alternatives><graphic id="pcbi.1006921.e071g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e071" xlink:type="simple"/><mml:math display="inline" id="M71"><mml:mrow><mml:mi>D</mml:mi> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:msubsup> <mml:msubsup><mml:mi>F</mml:mi> <mml:mi>e</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mtext>ChIP</mml:mtext><mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>/</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:msubsup> <mml:msubsup><mml:mi>F</mml:mi> <mml:mi>e</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi> <mml:mi>p</mml:mi> <mml:mi>u</mml:mi> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, which is the ratio of the total number of extracted fragments in the ChIP sample to that in the input sample. If <italic>D</italic> &lt; 1, we down-sample extracted fragments in the input sample by replacing <inline-formula id="pcbi.1006921.e072"><alternatives><graphic id="pcbi.1006921.e072g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e072" xlink:type="simple"/><mml:math display="inline" id="M72"><mml:msubsup><mml:mi>F</mml:mi> <mml:mi>e</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi> <mml:mi>p</mml:mi> <mml:mi>u</mml:mi> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> with the sample <inline-formula id="pcbi.1006921.e073"><alternatives><graphic id="pcbi.1006921.e073g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e073" xlink:type="simple"/><mml:math display="inline" id="M73"><mml:mrow><mml:msub><mml:mi>X</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>∼</mml:mo> <mml:mtext>Binomial</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>F</mml:mi> <mml:mi>e</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi> <mml:mi>p</mml:mi> <mml:mi>u</mml:mi> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:mi>D</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. If <italic>D</italic> &gt; 1, we similarly down-sample the fragments from the ChIP sample instead of the input sample.</p>
<sec id="sec019">
<title>Mean occupancy ratio as a measure of antibody specificity</title>
<p>In <xref ref-type="disp-formula" rid="pcbi.1006921.e047">Eq (7)</xref>, we defined the mean occupancy ratio as the ratio between the mean occupancy of true positive binding sites to that of false positive binding sites. This ratio can also be interpreted as a measure of antibody specificity in the following way.</p>
<p>Consider a genome with <italic>n</italic> true positive binding sites and <italic>m</italic> false positive binding sites. Suppose the extraction efficiency is <inline-formula id="pcbi.1006921.e074"><alternatives><graphic id="pcbi.1006921.e074g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e074" xlink:type="simple"/><mml:math display="inline" id="M74"><mml:mrow><mml:msubsup><mml:mi>t</mml:mi> <mml:mrow><mml:mi>e</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>t</mml:mi> <mml:mi>e</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> at true positive binding sites and <inline-formula id="pcbi.1006921.e075"><alternatives><graphic id="pcbi.1006921.e075g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e075" xlink:type="simple"/><mml:math display="inline" id="M75"><mml:mrow><mml:msubsup><mml:mi>f</mml:mi> <mml:mi>e</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>f</mml:mi> <mml:mi>e</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> at false positive binding sites. Then, the average number of fragments extracted from the i-th true positive binding site in the ChIP sample is <inline-formula id="pcbi.1006921.e076"><alternatives><graphic id="pcbi.1006921.e076g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e076" xlink:type="simple"/><mml:math display="inline" id="M76"><mml:mrow><mml:mi>C</mml:mi> <mml:msubsup><mml:mi>p</mml:mi> <mml:mi>b</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:msubsup><mml:mi>t</mml:mi> <mml:mi>e</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, and the average number extracted from the j-th false positive binding site is <inline-formula id="pcbi.1006921.e077"><alternatives><graphic id="pcbi.1006921.e077g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e077" xlink:type="simple"/><mml:math display="inline" id="M77"><mml:mrow><mml:mi>C</mml:mi> <mml:msubsup><mml:mi>p</mml:mi> <mml:mi>b</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:msubsup><mml:mi>f</mml:mi> <mml:mi>e</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, where <inline-formula id="pcbi.1006921.e078"><alternatives><graphic id="pcbi.1006921.e078g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e078" xlink:type="simple"/><mml:math display="inline" id="M78"><mml:mrow><mml:mo>{</mml:mo> <mml:msubsup><mml:mi>p</mml:mi> <mml:mi>b</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> are occupancies at each location. The ratio (<italic>r</italic><sub><italic>e</italic></sub>) between the average number of fragments extracted from true positive binding sites to that from false positive binding sites is then
<disp-formula id="pcbi.1006921.e079"><alternatives><graphic id="pcbi.1006921.e079g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e079" xlink:type="simple"/><mml:math display="block" id="M79"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>r</mml:mi> <mml:mi>e</mml:mi></mml:msub></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mi>C</mml:mi> <mml:mi>m</mml:mi> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:msubsup> <mml:msubsup><mml:mi>p</mml:mi> <mml:mi>b</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:msubsup><mml:mi>t</mml:mi> <mml:mi>e</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow> <mml:mrow><mml:mi>C</mml:mi> <mml:mi>n</mml:mi> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>m</mml:mi></mml:msubsup> <mml:msubsup><mml:mi>p</mml:mi> <mml:mi>b</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:msubsup><mml:mi>f</mml:mi> <mml:mi>e</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
<p>This is the ratio that determines the accuracy of ChIP-seq in distinguishing between true and false positive binding sites. If <italic>r</italic><sub><italic>e</italic></sub> is large, true positive binding sites will give rise to more fragments than false positive binding sites, leading to true positive sites having larger read count ratios. A high value of <italic>r</italic><sub><italic>e</italic></sub> is achieved if, for <inline-formula id="pcbi.1006921.e080"><alternatives><graphic id="pcbi.1006921.e080g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e080" xlink:type="simple"/><mml:math display="inline" id="M80"><mml:mrow><mml:msubsup><mml:mi>t</mml:mi> <mml:mi>e</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>f</mml:mi> <mml:mi>e</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:mi>e</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> across the genome, true positive sites have a larger mean occupancy than at false positive sites. Setting <inline-formula id="pcbi.1006921.e081"><alternatives><graphic id="pcbi.1006921.e081g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e081" xlink:type="simple"/><mml:math display="inline" id="M81"><mml:mrow><mml:msubsup><mml:mi>t</mml:mi> <mml:mi>e</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>f</mml:mi> <mml:mi>e</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:mi>e</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> in the above equation reduces <italic>r</italic><sub><italic>e</italic></sub> to the mean occupancy ratio defined in <xref ref-type="disp-formula" rid="pcbi.1006921.e047">Eq (7)</xref>.</p>
<p>Conversely, if <inline-formula id="pcbi.1006921.e082"><alternatives><graphic id="pcbi.1006921.e082g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e082" xlink:type="simple"/><mml:math display="inline" id="M82"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi> <mml:mi>b</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>p</mml:mi> <mml:mi>b</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>p</mml:mi> <mml:mi>b</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>n</mml:mi> <mml:mo>+</mml:mo> <mml:mi>m</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> across the genome, then <italic>r</italic><sub><italic>e</italic></sub> reduces to the ratio
<disp-formula id="pcbi.1006921.e083"><alternatives><graphic id="pcbi.1006921.e083g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e083" xlink:type="simple"/><mml:math display="block" id="M83"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>r</mml:mi> <mml:mi>e</mml:mi></mml:msub></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mi>m</mml:mi> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:msubsup> <mml:msubsup><mml:mi>t</mml:mi> <mml:mi>e</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow> <mml:mrow><mml:mi>n</mml:mi> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>m</mml:mi></mml:msubsup> <mml:msubsup><mml:mi>f</mml:mi> <mml:mi>e</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
which is merely the ratio between the mean extraction efficiency at true positive binding sites to that at false positive binding sites. This constitutes a measure of the specificity of the antibody employed against the target TF of the ChIP-seq. Thus, ensuring that the average extraction efficiency at true positive sites is higher than at false positive sites ensures that the former give rise to higher read count ratios.</p>
</sec>
</sec>
<sec id="sec020">
<title>PCR amplification</title>
<p>We simulate PCR amplification using the model in [<xref ref-type="bibr" rid="pcbi.1006921.ref069">69</xref>] which we briefly explain below. In this model, each DNA fragment has a probability <italic>p</italic><sub><italic>a</italic></sub> of being amplified in a cycle of PCR and gives rise to two fragments. The fragment fails to undergo amplification and remains as a single fragment with probability 1 − <italic>p</italic><sub><italic>a</italic></sub>.</p>
<p>Suppose <inline-formula id="pcbi.1006921.e084"><alternatives><graphic id="pcbi.1006921.e084g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e084" xlink:type="simple"/><mml:math display="inline" id="M84"><mml:msub><mml:mi>S</mml:mi> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:msub></mml:math></alternatives></inline-formula> is a random variable that represents the number of amplified fragments after <italic>n</italic><sub><italic>cy</italic></sub> cycles of PCR. <inline-formula id="pcbi.1006921.e085"><alternatives><graphic id="pcbi.1006921.e085g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e085" xlink:type="simple"/><mml:math display="inline" id="M85"><mml:msub><mml:mi>S</mml:mi> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:msub></mml:math></alternatives></inline-formula> can assume values between 1 and <inline-formula id="pcbi.1006921.e086"><alternatives><graphic id="pcbi.1006921.e086g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e086" xlink:type="simple"/><mml:math display="inline" id="M86"><mml:msup><mml:mn>2</mml:mn> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:msup></mml:math></alternatives></inline-formula>.
<disp-formula id="pcbi.1006921.e087"><alternatives><graphic id="pcbi.1006921.e087g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e087" xlink:type="simple"/><mml:math display="block" id="M87"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>S</mml:mi> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:mi>X</mml:mi> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(9)</label></disp-formula>
where <inline-formula id="pcbi.1006921.e088"><alternatives><graphic id="pcbi.1006921.e088g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e088" xlink:type="simple"/><mml:math display="inline" id="M88"><mml:mrow><mml:mi>X</mml:mi> <mml:mo>~</mml:mo><mml:mtext>Binomial</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:mi>a</mml:mi></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. If we represent <inline-formula id="pcbi.1006921.e089"><alternatives><graphic id="pcbi.1006921.e089g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e089" xlink:type="simple"/><mml:math display="inline" id="M89"><mml:mrow><mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> as a vector of length <inline-formula id="pcbi.1006921.e090"><alternatives><graphic id="pcbi.1006921.e090g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e090" xlink:type="simple"/><mml:math display="inline" id="M90"><mml:mrow><mml:msup><mml:mn>2</mml:mn> <mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, the probability distribution of <inline-formula id="pcbi.1006921.e091"><alternatives><graphic id="pcbi.1006921.e091g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e091" xlink:type="simple"/><mml:math display="inline" id="M91"><mml:msub><mml:mi>S</mml:mi> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:msub></mml:math></alternatives></inline-formula> can then be calculated from <inline-formula id="pcbi.1006921.e092"><alternatives><graphic id="pcbi.1006921.e092g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e092" xlink:type="simple"/><mml:math display="inline" id="M92"><mml:mrow><mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> in terms of an updating matrix <inline-formula id="pcbi.1006921.e093"><alternatives><graphic id="pcbi.1006921.e093g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e093" xlink:type="simple"/><mml:math display="inline" id="M93"><mml:mrow><mml:msup><mml:mi>M</mml:mi> <mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> (of dimension <inline-formula id="pcbi.1006921.e094"><alternatives><graphic id="pcbi.1006921.e094g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e094" xlink:type="simple"/><mml:math display="inline" id="M94"><mml:mrow><mml:msup><mml:mn>2</mml:mn> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:msup> <mml:mo>×</mml:mo> <mml:msup><mml:mn>2</mml:mn> <mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>) by setting <inline-formula id="pcbi.1006921.e095"><alternatives><graphic id="pcbi.1006921.e095g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e095" xlink:type="simple"/><mml:math display="inline" id="M95"><mml:mrow><mml:msub><mml:mi>S</mml:mi> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:msub> <mml:mo>=</mml:mo> <mml:msup><mml:mi>M</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> where
<disp-formula id="pcbi.1006921.e096"><alternatives><graphic id="pcbi.1006921.e096g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e096" xlink:type="simple"/><mml:math display="block" id="M96"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>M</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:mo>(</mml:mo> <mml:mfrac linethickness="0pt"><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mfrac> <mml:mo>)</mml:mo> <mml:msubsup><mml:mi>p</mml:mi> <mml:mi>a</mml:mi> <mml:mi>j</mml:mi></mml:msubsup> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msup> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(10)</label></disp-formula></p>
<p>Thus, for a given value of <italic>p</italic><sub><italic>a</italic></sub>, the distribution of <inline-formula id="pcbi.1006921.e097"><alternatives><graphic id="pcbi.1006921.e097g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e097" xlink:type="simple"/><mml:math display="inline" id="M97"><mml:msub><mml:mi>S</mml:mi> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:msub></mml:math></alternatives></inline-formula> can be computed recursively from <inline-formula id="pcbi.1006921.e098"><alternatives><graphic id="pcbi.1006921.e098g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e098" xlink:type="simple"/><mml:math display="inline" id="M98"><mml:mrow><mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub> <mml:mo>−</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> when we start from a single DNA fragment. For computational efficiency, for values of <italic>n</italic><sub><italic>cy</italic></sub> between 10 and 15, we pre-computed and stored the distributions of <inline-formula id="pcbi.1006921.e099"><alternatives><graphic id="pcbi.1006921.e099g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e099" xlink:type="simple"/><mml:math display="inline" id="M99"><mml:msub><mml:mi>S</mml:mi> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:msub></mml:math></alternatives></inline-formula> for values of <italic>p</italic><sub><italic>a</italic></sub> between 0.01 and 0.99 in steps of 0.01. In order to simulate <italic>n</italic><sub><italic>cy</italic></sub> cycles of PCR amplification for <inline-formula id="pcbi.1006921.e100"><alternatives><graphic id="pcbi.1006921.e100g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e100" xlink:type="simple"/><mml:math display="inline" id="M100"><mml:msubsup><mml:mi>F</mml:mi> <mml:mi>e</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> fragments, we draw <inline-formula id="pcbi.1006921.e101"><alternatives><graphic id="pcbi.1006921.e101g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e101" xlink:type="simple"/><mml:math display="inline" id="M101"><mml:mrow><mml:mi>F</mml:mi> <mml:mo>≡</mml:mo> <mml:msubsup><mml:mi>F</mml:mi> <mml:mi>e</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> samples <inline-formula id="pcbi.1006921.e102"><alternatives><graphic id="pcbi.1006921.e102g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e102" xlink:type="simple"/><mml:math display="inline" id="M102"><mml:mrow><mml:msubsup><mml:mi>S</mml:mi> <mml:mn>1</mml:mn> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>S</mml:mi> <mml:mn>2</mml:mn> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>S</mml:mi> <mml:mi>F</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> from the distribution <inline-formula id="pcbi.1006921.e103"><alternatives><graphic id="pcbi.1006921.e103g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e103" xlink:type="simple"/><mml:math display="inline" id="M103"><mml:msub><mml:mi>S</mml:mi> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:msub></mml:math></alternatives></inline-formula> corresponding to the value of <inline-formula id="pcbi.1006921.e104"><alternatives><graphic id="pcbi.1006921.e104g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e104" xlink:type="simple"/><mml:math display="inline" id="M104"><mml:msubsup><mml:mi>p</mml:mi> <mml:mi>a</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> at that locus.</p>
<p>The mean and variance in the number of amplified fragments, <inline-formula id="pcbi.1006921.e105"><alternatives><graphic id="pcbi.1006921.e105g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e105" xlink:type="simple"/><mml:math display="inline" id="M105"><mml:msubsup><mml:mi>F</mml:mi> <mml:mi>a</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>, starting with a single fragment at the first cycle and an amplification efficiency of <italic>p</italic><sub><italic>a</italic></sub>, can be calculated from branching process theory [<xref ref-type="bibr" rid="pcbi.1006921.ref070">70</xref>]. After a single cycle of PCR, the mean (<italic>m</italic><sub>1</sub>) and variance (<italic>v</italic><sub>1</sub>) are
<disp-formula id="pcbi.1006921.e106"><alternatives><graphic id="pcbi.1006921.e106g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e106" xlink:type="simple"/><mml:math display="block" id="M106"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>m</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:msub><mml:mi>p</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>v</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:mn>3</mml:mn> <mml:msub><mml:mi>p</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>m</mml:mi> <mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>=</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
<p>After <italic>n</italic><sub><italic>cy</italic></sub> cycles of amplification, <inline-formula id="pcbi.1006921.e107"><alternatives><graphic id="pcbi.1006921.e107g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e107" xlink:type="simple"/><mml:math display="inline" id="M107"><mml:msub><mml:mi>m</mml:mi> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006921.e108"><alternatives><graphic id="pcbi.1006921.e108g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e108" xlink:type="simple"/><mml:math display="inline" id="M108"><mml:msub><mml:mi>v</mml:mi> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:msub></mml:math></alternatives></inline-formula> are given by —
<disp-formula id="pcbi.1006921.e109"><alternatives><graphic id="pcbi.1006921.e109g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e109" xlink:type="simple"/><mml:math display="block" id="M109"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>m</mml:mi> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:msub></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:msubsup><mml:mi>m</mml:mi> <mml:mn>1</mml:mn> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:msubsup></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>v</mml:mi> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:msub></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>v</mml:mi> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:msub> <mml:msubsup><mml:mi>m</mml:mi> <mml:mn>1</mml:mn> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>m</mml:mi> <mml:mn>1</mml:mn> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msub><mml:mi>m</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mi>m</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:mspace width="0.166667em"/><mml:mspace width="0.166667em"/><mml:mspace width="0.166667em"/><mml:mspace width="0.166667em"/><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>m</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>≠</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
<p>Substituting the expressions for <italic>m</italic><sub>1</sub> and <italic>v</italic><sub>1</sub> into the above equation, we have
<disp-formula id="pcbi.1006921.e110"><alternatives><graphic id="pcbi.1006921.e110g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e110" xlink:type="simple"/><mml:math display="block" id="M110"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>m</mml:mi> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:msub></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:msup></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>v</mml:mi> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:msub></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>(</mml:mo> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:msup> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(11)</label></disp-formula></p>
<p>We refer to <inline-formula id="pcbi.1006921.e111"><alternatives><graphic id="pcbi.1006921.e111g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e111" xlink:type="simple"/><mml:math display="inline" id="M111"><mml:mrow><mml:mi>A</mml:mi> <mml:mo>≡</mml:mo> <mml:msub><mml:mi>m</mml:mi> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:msub> <mml:mo>=</mml:mo> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> as amplification ratio of PCR at that location.</p>
<p>We assume that the PCR efficiency at a locus remains constant across all cycles of amplification. We also assume that the number of amplified fragments obtained from each starting DNA fragment is statistically independent of amplifications at other fragments. This implies that starting with <inline-formula id="pcbi.1006921.e112"><alternatives><graphic id="pcbi.1006921.e112g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e112" xlink:type="simple"/><mml:math display="inline" id="M112"><mml:msubsup><mml:mi>F</mml:mi> <mml:mi>e</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> fragments, the mean number of amplified fragments after <italic>n</italic><sub><italic>cy</italic></sub> cycles of PCR is <inline-formula id="pcbi.1006921.e113"><alternatives><graphic id="pcbi.1006921.e113g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e113" xlink:type="simple"/><mml:math display="inline" id="M113"><mml:mrow><mml:mi>A</mml:mi> <mml:msubsup><mml:mi>F</mml:mi> <mml:mi>e</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>. The expressions in <xref ref-type="disp-formula" rid="pcbi.1006921.e110">Eq (11)</xref> are valid only when PCR has not yet reached a saturation of amplification where the concentration of PCR primers, polymerase, etc. relative to the concentration of the amplified fragments is enough to ensure that <italic>p</italic><sub><italic>a</italic></sub> does not decrease as <italic>n</italic><sub><italic>cy</italic></sub> is increased.</p>
<p>By default, we set <italic>A</italic> = 1000 and <italic>n</italic><sub><italic>cy</italic></sub> = 15 across the genome in all our simulations unless stated otherwise. This corresponds to a value of <italic>p</italic><sub><italic>a</italic></sub> ≈ 0.58.</p>
</sec>
<sec id="sec021">
<title>Sequencing</title>
<p>At the end of the PCR amplification step, there are <inline-formula id="pcbi.1006921.e114"><alternatives><graphic id="pcbi.1006921.e114g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e114" xlink:type="simple"/><mml:math display="inline" id="M114"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:msubsup> <mml:msubsup><mml:mi>F</mml:mi> <mml:mi>a</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> amplified fragments from all <italic>n</italic> genomic locations. In this set of amplified fragments, there are <inline-formula id="pcbi.1006921.e115"><alternatives><graphic id="pcbi.1006921.e115g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e115" xlink:type="simple"/><mml:math display="inline" id="M115"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:msubsup> <mml:msubsup><mml:mi>F</mml:mi> <mml:mi>e</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> unique fragments, each of which come from different cells, and the remaining <inline-formula id="pcbi.1006921.e116"><alternatives><graphic id="pcbi.1006921.e116g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e116" xlink:type="simple"/><mml:math display="inline" id="M116"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:msubsup> <mml:mo>(</mml:mo> <mml:msubsup><mml:mi>F</mml:mi> <mml:mi>a</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>F</mml:mi> <mml:mi>e</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> fragments are duplicates obtained through PCR. During the sequencing step, a total of <italic>r</italic> = <italic>cn</italic> fragments are sampled from this amplified pool and sequenced. <italic>r</italic> denotes the total read count of the experiment and <italic>c</italic> is the sequencing depth.</p>
<p>Since each fragment has an equal probability of being sampled, the read count sample <italic>r</italic><sub>1</sub>, <italic>r</italic><sub>2</sub>, …, <italic>r</italic><sub><italic>n</italic></sub> from amplified fragment pools <inline-formula id="pcbi.1006921.e117"><alternatives><graphic id="pcbi.1006921.e117g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e117" xlink:type="simple"/><mml:math display="inline" id="M117"><mml:mrow><mml:msubsup><mml:mi>F</mml:mi> <mml:mi>a</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>F</mml:mi> <mml:mi>a</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>F</mml:mi> <mml:mi>a</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, where <inline-formula id="pcbi.1006921.e118"><alternatives><graphic id="pcbi.1006921.e118g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e118" xlink:type="simple"/><mml:math display="inline" id="M118"><mml:mrow><mml:mi>r</mml:mi> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:msubsup> <mml:msub><mml:mi>r</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, follows a multivariate hyper-geometric distribution. To draw a sample from this distribution, we implemented the following procedure [<xref ref-type="bibr" rid="pcbi.1006921.ref071">71</xref>]—</p>
<p>Given two pools of fragments of pool sizes <italic>A</italic> and <italic>B</italic> from which <italic>r</italic> reads are to be sampled, the probability that <italic>k</italic> reads come from the first pool is
<disp-formula id="pcbi.1006921.e119"><alternatives><graphic id="pcbi.1006921.e119g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e119" xlink:type="simple"/><mml:math display="block" id="M119"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>(</mml:mo> <mml:mfrac linethickness="0pt"><mml:mi>A</mml:mi> <mml:mi>k</mml:mi></mml:mfrac> <mml:mo>)</mml:mo> <mml:mo>(</mml:mo> <mml:mfrac linethickness="0pt"><mml:mi>B</mml:mi> <mml:mrow><mml:mi>r</mml:mi> <mml:mo>-</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:mfrac> <mml:mo>)</mml:mo> <mml:mo>/</mml:mo> <mml:mo>(</mml:mo> <mml:mfrac linethickness="0pt"><mml:mrow><mml:mi>A</mml:mi> <mml:mo>+</mml:mo> <mml:mi>B</mml:mi></mml:mrow> <mml:mi>r</mml:mi></mml:mfrac> <mml:mo>)</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives></disp-formula></p>
<p>We extend this distribution to sampling from <italic>n</italic> pools of fragments, each of size <inline-formula id="pcbi.1006921.e120"><alternatives><graphic id="pcbi.1006921.e120g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e120" xlink:type="simple"/><mml:math display="inline" id="M120"><mml:mrow><mml:msubsup><mml:mi>F</mml:mi> <mml:mi>a</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>F</mml:mi> <mml:mi>a</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>F</mml:mi> <mml:mi>a</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> by first drawing <italic>r</italic> reads from two pools of size <inline-formula id="pcbi.1006921.e121"><alternatives><graphic id="pcbi.1006921.e121g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e121" xlink:type="simple"/><mml:math display="inline" id="M121"><mml:mrow><mml:msub><mml:mi>A</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>F</mml:mi> <mml:mi>a</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006921.e122"><alternatives><graphic id="pcbi.1006921.e122g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e122" xlink:type="simple"/><mml:math display="inline" id="M122"><mml:mrow><mml:msub><mml:mi>B</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>2</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:msubsup> <mml:msubsup><mml:mi>F</mml:mi> <mml:mi>a</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>. The probability of observing <italic>r</italic><sub>1</sub> reads from the first locus (i.e. pool <italic>A</italic><sub>1</sub>) is
<disp-formula id="pcbi.1006921.e123"><alternatives><graphic id="pcbi.1006921.e123g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e123" xlink:type="simple"/><mml:math display="block" id="M123"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>r</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>(</mml:mo> <mml:mfrac linethickness="0pt"><mml:msub><mml:mi>A</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:msub><mml:mi>r</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mfrac> <mml:mo>)</mml:mo> <mml:mo>(</mml:mo> <mml:mfrac linethickness="0pt"><mml:msub><mml:mi>B</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mi>r</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>r</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mfrac> <mml:mo>)</mml:mo> <mml:mo>/</mml:mo> <mml:mo>(</mml:mo> <mml:mfrac linethickness="0pt"><mml:mrow><mml:msub><mml:mi>A</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>B</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow> <mml:mi>r</mml:mi></mml:mfrac> <mml:mo>)</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(12)</label></disp-formula></p>
<p>To draw reads for the second locus, we draw a sample of size <italic>r</italic> − <italic>r</italic><sub>1</sub> from two pools of size <inline-formula id="pcbi.1006921.e124"><alternatives><graphic id="pcbi.1006921.e124g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e124" xlink:type="simple"/><mml:math display="inline" id="M124"><mml:mrow><mml:msub><mml:mi>A</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>F</mml:mi> <mml:mi>a</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006921.e125"><alternatives><graphic id="pcbi.1006921.e125g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e125" xlink:type="simple"/><mml:math display="inline" id="M125"><mml:mrow><mml:msub><mml:mi>B</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>3</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:msubsup> <mml:msubsup><mml:mi>F</mml:mi> <mml:mi>a</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>.
<disp-formula id="pcbi.1006921.e126"><alternatives><graphic id="pcbi.1006921.e126g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e126" xlink:type="simple"/><mml:math display="block" id="M126"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>r</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>(</mml:mo> <mml:mfrac linethickness="0pt"><mml:msub><mml:mi>A</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:msub><mml:mi>r</mml:mi> <mml:mn>2</mml:mn></mml:msub></mml:mfrac> <mml:mo>)</mml:mo> <mml:mo>(</mml:mo> <mml:mfrac linethickness="0pt"><mml:msub><mml:mi>B</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mrow><mml:mi>r</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>r</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>r</mml:mi> <mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mfrac> <mml:mo>)</mml:mo> <mml:mo>/</mml:mo> <mml:mo>(</mml:mo> <mml:mfrac linethickness="0pt"><mml:mrow><mml:msub><mml:mi>A</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>B</mml:mi> <mml:mn>2</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:mi>r</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>r</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mfrac> <mml:mo>)</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(13)</label></disp-formula></p>
<p>We continue this sampling process till all <italic>r</italic> reads have been sampled.</p>
<p>The read count at the i-th location, <italic>r</italic><sub><italic>i</italic></sub>, consists of a mixture of <italic>u</italic><sub><italic>i</italic></sub> unique reads and <italic>d</italic><sub><italic>i</italic></sub> duplicate reads such that <italic>r</italic><sub><italic>i</italic></sub> = <italic>u</italic><sub><italic>i</italic></sub> + <italic>d</italic><sub><italic>i</italic></sub>. We keep track of the fragments that were obtained via amplification versus those obtained in extraction step, and therefore, by simulation design, the <italic>u</italic><sub><italic>i</italic></sub> reads can be perfectly separated out from the <italic>d</italic><sub><italic>i</italic></sub> reads, which is detailed below.</p>
<p>As stated in the earlier section, <inline-formula id="pcbi.1006921.e127"><alternatives><graphic id="pcbi.1006921.e127g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e127" xlink:type="simple"/><mml:math display="inline" id="M127"><mml:mrow><mml:mi>F</mml:mi> <mml:mo>≡</mml:mo> <mml:msubsup><mml:mi>F</mml:mi> <mml:mi>e</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> fragments extracted from the i-th location undergo PCR amplification to give <inline-formula id="pcbi.1006921.e128"><alternatives><graphic id="pcbi.1006921.e128g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e128" xlink:type="simple"/><mml:math display="inline" id="M128"><mml:mrow><mml:msubsup><mml:mi>F</mml:mi> <mml:mi>a</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>F</mml:mi></mml:msubsup> <mml:msubsup><mml:mi>S</mml:mi> <mml:mi>j</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> fragments, where <inline-formula id="pcbi.1006921.e129"><alternatives><graphic id="pcbi.1006921.e129g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e129" xlink:type="simple"/><mml:math display="inline" id="M129"><mml:mrow><mml:msubsup><mml:mi>S</mml:mi> <mml:mn>1</mml:mn> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>S</mml:mi> <mml:mn>2</mml:mn> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>S</mml:mi> <mml:mi>F</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> are the number of amplified fragments obtained from each of the <inline-formula id="pcbi.1006921.e130"><alternatives><graphic id="pcbi.1006921.e130g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e130" xlink:type="simple"/><mml:math display="inline" id="M130"><mml:msubsup><mml:mi>F</mml:mi> <mml:mi>e</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> fragments. To sample <italic>u</italic><sub><italic>i</italic></sub> we first draw samples <inline-formula id="pcbi.1006921.e131"><alternatives><graphic id="pcbi.1006921.e131g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e131" xlink:type="simple"/><mml:math display="inline" id="M131"><mml:mrow><mml:msubsup><mml:mi>r</mml:mi> <mml:mn>1</mml:mn> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>r</mml:mi> <mml:mn>2</mml:mn> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>r</mml:mi> <mml:mi>F</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> from the fragments pools <inline-formula id="pcbi.1006921.e132"><alternatives><graphic id="pcbi.1006921.e132g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e132" xlink:type="simple"/><mml:math display="inline" id="M132"><mml:mrow><mml:msubsup><mml:mi>S</mml:mi> <mml:mn>1</mml:mn> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>S</mml:mi> <mml:mn>2</mml:mn> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>S</mml:mi> <mml:mi>F</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> such that <inline-formula id="pcbi.1006921.e133"><alternatives><graphic id="pcbi.1006921.e133g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e133" xlink:type="simple"/><mml:math display="inline" id="M133"><mml:mrow><mml:msub><mml:mi>r</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>F</mml:mi></mml:msubsup> <mml:msubsup><mml:mi>r</mml:mi> <mml:mi>j</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>. We can write <inline-formula id="pcbi.1006921.e134"><alternatives><graphic id="pcbi.1006921.e134g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e134" xlink:type="simple"/><mml:math display="inline" id="M134"><mml:mrow><mml:msubsup><mml:mi>r</mml:mi> <mml:mi>j</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>u</mml:mi> <mml:mi>j</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi>d</mml:mi> <mml:mi>j</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, where <inline-formula id="pcbi.1006921.e135"><alternatives><graphic id="pcbi.1006921.e135g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e135" xlink:type="simple"/><mml:math display="inline" id="M135"><mml:msubsup><mml:mi>u</mml:mi> <mml:mi>j</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006921.e136"><alternatives><graphic id="pcbi.1006921.e136g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e136" xlink:type="simple"/><mml:math display="inline" id="M136"><mml:msubsup><mml:mi>d</mml:mi> <mml:mi>j</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> are the numbers of unique and duplicate fragments sampled from <inline-formula id="pcbi.1006921.e137"><alternatives><graphic id="pcbi.1006921.e137g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e137" xlink:type="simple"/><mml:math display="inline" id="M137"><mml:msubsup><mml:mi>S</mml:mi> <mml:mi>j</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>. Since we assume that each of the <inline-formula id="pcbi.1006921.e138"><alternatives><graphic id="pcbi.1006921.e138g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e138" xlink:type="simple"/><mml:math display="inline" id="M138"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>F</mml:mi></mml:msubsup> <mml:msubsup><mml:mi>S</mml:mi> <mml:mi>j</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> fragments has an equal probability of being sampled, <inline-formula id="pcbi.1006921.e139"><alternatives><graphic id="pcbi.1006921.e139g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e139" xlink:type="simple"/><mml:math display="inline" id="M139"><mml:mrow><mml:msubsup><mml:mi>r</mml:mi> <mml:mn>1</mml:mn> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>r</mml:mi> <mml:mn>2</mml:mn> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>r</mml:mi> <mml:mi>F</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> is a multivariate hyper-geometric sample of <inline-formula id="pcbi.1006921.e140"><alternatives><graphic id="pcbi.1006921.e140g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e140" xlink:type="simple"/><mml:math display="inline" id="M140"><mml:mrow><mml:msubsup><mml:mi>S</mml:mi> <mml:mn>1</mml:mn> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>S</mml:mi> <mml:mn>2</mml:mn> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>S</mml:mi> <mml:mi>j</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, which we generate using the same procedure outlined for sampling <italic>r</italic><sub>1</sub>, <italic>r</italic><sub>2</sub>, …, <italic>r</italic><sub><italic>n</italic></sub> reads from <inline-formula id="pcbi.1006921.e141"><alternatives><graphic id="pcbi.1006921.e141g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e141" xlink:type="simple"/><mml:math display="inline" id="M141"><mml:mrow><mml:msubsup><mml:mi>F</mml:mi> <mml:mi>a</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>F</mml:mi> <mml:mi>a</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>F</mml:mi> <mml:mi>a</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> fragments.</p>
<p>We then compute <italic>u</italic><sub><italic>i</italic></sub> for each location as follows. If <inline-formula id="pcbi.1006921.e142"><alternatives><graphic id="pcbi.1006921.e142g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e142" xlink:type="simple"/><mml:math display="inline" id="M142"><mml:mrow><mml:msubsup><mml:mi>r</mml:mi> <mml:mi>j</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, then <inline-formula id="pcbi.1006921.e143"><alternatives><graphic id="pcbi.1006921.e143g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e143" xlink:type="simple"/><mml:math display="inline" id="M143"><mml:mrow><mml:msubsup><mml:mi>u</mml:mi> <mml:mi>j</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006921.e144"><alternatives><graphic id="pcbi.1006921.e144g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e144" xlink:type="simple"/><mml:math display="inline" id="M144"><mml:mrow><mml:msubsup><mml:mi>d</mml:mi> <mml:mi>j</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>. Since only one fragment in <inline-formula id="pcbi.1006921.e145"><alternatives><graphic id="pcbi.1006921.e145g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e145" xlink:type="simple"/><mml:math display="inline" id="M145"><mml:msubsup><mml:mi>S</mml:mi> <mml:mi>j</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> is unique, <inline-formula id="pcbi.1006921.e146"><alternatives><graphic id="pcbi.1006921.e146g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e146" xlink:type="simple"/><mml:math display="inline" id="M146"><mml:msubsup><mml:mi>u</mml:mi> <mml:mi>j</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> cannot exceed 1, which means that if <inline-formula id="pcbi.1006921.e147"><alternatives><graphic id="pcbi.1006921.e147g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e147" xlink:type="simple"/><mml:math display="inline" id="M147"><mml:mrow><mml:msubsup><mml:mi>r</mml:mi> <mml:mi>j</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>&gt;</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, then, <inline-formula id="pcbi.1006921.e148"><alternatives><graphic id="pcbi.1006921.e148g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e148" xlink:type="simple"/><mml:math display="inline" id="M148"><mml:mrow><mml:msubsup><mml:mi>u</mml:mi> <mml:mi>j</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006921.e149"><alternatives><graphic id="pcbi.1006921.e149g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e149" xlink:type="simple"/><mml:math display="inline" id="M149"><mml:mrow><mml:msubsup><mml:mi>d</mml:mi> <mml:mi>j</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>r</mml:mi> <mml:mi>j</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>. We can then obtain <italic>u</italic><sub><italic>i</italic></sub> by setting <inline-formula id="pcbi.1006921.e150"><alternatives><graphic id="pcbi.1006921.e150g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e150" xlink:type="simple"/><mml:math display="inline" id="M150"><mml:mrow><mml:msub><mml:mi>u</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>F</mml:mi></mml:msubsup> <mml:msubsup><mml:mi>u</mml:mi> <mml:mi>j</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p>In the process of simulating read counts, We do not account for mutations than can cause alignment errors in actual ChIP-seq reads, which in turn can change read counts at a genomic locus.</p>
</sec>
<sec id="sec022">
<title>FASTQ read generation</title>
<p>To generate sequence reads, a set of genomic <italic>n</italic> intervals (<italic>b</italic><sub>1</sub>, <italic>e</italic><sub>1</sub>), (<italic>b</italic><sub>2</sub>, <italic>e</italic><sub>2</sub>), …, (<italic>b</italic><sub><italic>n</italic></sub>, <italic>e</italic><sub><italic>n</italic></sub>), along with a set of “summits” <italic>s</italic><sub>1</sub>, <italic>s</italic><sub>2</sub>, …, <italic>s</italic><sub><italic>n</italic></sub> need to be input to ChIPulate. These summits can be thought of as the physical location of TF-DNA binding in each interval. The total and unique read counts (<italic>r</italic><sub><italic>i</italic></sub> and <italic>u</italic><sub><italic>i</italic></sub>, respectively) at the i-th interval are computed as described above, based on the binding energy (or energies) associated with each interval.</p>
<p>In the ChIP sample, after <italic>r</italic><sub><italic>i</italic></sub> and <italic>u</italic><sub><italic>i</italic></sub> are computed, <italic>u</italic><sub><italic>i</italic></sub> fragment start positions <inline-formula id="pcbi.1006921.e151"><alternatives><graphic id="pcbi.1006921.e151g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e151" xlink:type="simple"/><mml:math display="inline" id="M151"><mml:mrow><mml:mo>{</mml:mo> <mml:msubsup><mml:mi>a</mml:mi> <mml:mn>1</mml:mn> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>a</mml:mi> <mml:mn>2</mml:mn> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>a</mml:mi> <mml:mrow><mml:msub><mml:mi>u</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> are sampled from a Gaussian distribution with mean <italic>s</italic><sub><italic>i</italic></sub> − <italic>d</italic>/2 and standard deviation <italic>j</italic>, where <italic>d</italic> is the fragment length and <italic>j</italic> is referred to as the fragment jitter. Suppose the copy number of each of the <italic>u</italic><sub><italic>i</italic></sub> fragments is <inline-formula id="pcbi.1006921.e152"><alternatives><graphic id="pcbi.1006921.e152g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e152" xlink:type="simple"/><mml:math display="inline" id="M152"><mml:mrow><mml:msub><mml:mi>c</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:msub><mml:mi>u</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, such that <inline-formula id="pcbi.1006921.e153"><alternatives><graphic id="pcbi.1006921.e153g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e153" xlink:type="simple"/><mml:math display="inline" id="M153"><mml:mrow><mml:msub><mml:mi>c</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:mo>…</mml:mo> <mml:mo>+</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:msub><mml:mi>u</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>r</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, where <italic>c</italic><sub><italic>i</italic></sub> ≥ 1. Then, a set of <italic>r</italic><sub><italic>i</italic></sub> fragment start positions can be obtained by repeating the j-th unique fragment start position <italic>c</italic><sub><italic>j</italic></sub> times to give the set <inline-formula id="pcbi.1006921.e154"><alternatives><graphic id="pcbi.1006921.e154g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e154" xlink:type="simple"/><mml:math display="inline" id="M154"><mml:mrow><mml:mo>{</mml:mo> <mml:msub><mml:mi>a</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mi>a</mml:mi> <mml:msub><mml:mi>c</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>a</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:msub><mml:mi>a</mml:mi> <mml:msub><mml:mi>c</mml:mi> <mml:mn>2</mml:mn></mml:msub></mml:msub> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mi>a</mml:mi> <mml:msub><mml:mi>u</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:msub> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mi>a</mml:mi> <mml:msub><mml:mi>c</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:msub> <mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. The fragment jitter parameter <italic>j</italic> controls the dispersion of the fragment start positions from the position <italic>s</italic><sub><italic>i</italic></sub>.</p>
<p>The fragment start positions are simulated differently in the control sample. Here, given a unique read count <italic>u</italic><sub><italic>i</italic></sub> and total read count <italic>r</italic><sub><italic>i</italic></sub> at the i-th genomic interval, unique fragment start positions <inline-formula id="pcbi.1006921.e155"><alternatives><graphic id="pcbi.1006921.e155g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e155" xlink:type="simple"/><mml:math display="inline" id="M155"><mml:mrow><mml:mo>{</mml:mo> <mml:msub><mml:mi>a</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>a</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mi>a</mml:mi> <mml:msub><mml:mi>u</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:msub> <mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> are sampled from a Uniform(<italic>b</italic><sub><italic>i</italic></sub>, <italic>e</italic><sub><italic>i</italic></sub>) distribution. Given this set of unique fragment positions, the set of <italic>r</italic><sub><italic>i</italic></sub> fragment positions is constructed in the same way as in the ChIP sample, with the j-th unique fragment’s starting position <italic>a</italic><sub><italic>j</italic></sub> being repeated <italic>c</italic><sub><italic>j</italic></sub> times.</p>
<p>Suppose the read length being simulated is <italic>l</italic> base pairs. At the end of the previous step, we have a total of <italic>r</italic> = <italic>cn</italic> fragment start positions each in the ChIP and control samples, where <italic>c</italic> is the sequencing depth and <italic>r</italic> is the total read count. Suppose the the start position of the i-th read is <italic>a</italic><sub><italic>i</italic></sub> and the genome is a <italic>N</italic> letter sequence <italic>g</italic><sub>1</sub> <italic>g</italic><sub>2</sub>…<italic>g</italic><sub><italic>N</italic></sub>, with the reverse complement sequence denoted <inline-formula id="pcbi.1006921.e156"><alternatives><graphic id="pcbi.1006921.e156g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e156" xlink:type="simple"/><mml:math display="inline" id="M156"><mml:mrow><mml:msubsup><mml:mi>g</mml:mi> <mml:mn>1</mml:mn> <mml:mo>′</mml:mo></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>g</mml:mi> <mml:mn>2</mml:mn> <mml:mo>′</mml:mo></mml:msubsup> <mml:mo>…</mml:mo> <mml:msubsup><mml:mi>g</mml:mi> <mml:mi>N</mml:mi> <mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>. Then, if single-end sequencing is being simulated, we assign the sequence read to begin from the positive strand or the negative strand with equal probability. If the strand assigned to the read is positive, we assign the sequence <inline-formula id="pcbi.1006921.e157"><alternatives><graphic id="pcbi.1006921.e157g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e157" xlink:type="simple"/><mml:math display="inline" id="M157"><mml:mrow><mml:msub><mml:mi>g</mml:mi> <mml:msub><mml:mi>a</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:msub> <mml:msub><mml:mi>g</mml:mi> <mml:mrow><mml:msub><mml:mi>a</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>…</mml:mo> <mml:msub><mml:mi>g</mml:mi> <mml:mrow><mml:msub><mml:mi>a</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> to the i-th read. If the strand assigned to the read is negative, we assign the sequence <inline-formula id="pcbi.1006921.e158"><alternatives><graphic id="pcbi.1006921.e158g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e158" xlink:type="simple"/><mml:math display="inline" id="M158"><mml:mrow><mml:msubsup><mml:mi>g</mml:mi> <mml:mrow><mml:msub><mml:mi>a</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mi>d</mml:mi> <mml:mo>-</mml:mo> <mml:mi>l</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup> <mml:msubsup><mml:mi>g</mml:mi> <mml:mrow><mml:msub><mml:mi>a</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mi>d</mml:mi> <mml:mo>-</mml:mo> <mml:mi>l</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup> <mml:mo>…</mml:mo> <mml:msubsup><mml:mi>g</mml:mi> <mml:mrow><mml:msub><mml:mi>a</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mi>d</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>. If paired-end sequencing is being simulated, we generate <italic>r</italic> read pairs, i.e., 2<italic>r</italic> reads in total, where each fragment gives rise to one read from the positive strand with the sequence <inline-formula id="pcbi.1006921.e159"><alternatives><graphic id="pcbi.1006921.e159g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e159" xlink:type="simple"/><mml:math display="inline" id="M159"><mml:mrow><mml:msub><mml:mi>g</mml:mi> <mml:msub><mml:mi>a</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:msub> <mml:msub><mml:mi>g</mml:mi> <mml:mrow><mml:msub><mml:mi>a</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>…</mml:mo> <mml:msub><mml:mi>g</mml:mi> <mml:mrow><mml:msub><mml:mi>a</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> and one read from the negative strand with the sequence <inline-formula id="pcbi.1006921.e160"><alternatives><graphic id="pcbi.1006921.e160g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e160" xlink:type="simple"/><mml:math display="inline" id="M160"><mml:mrow><mml:msubsup><mml:mi>g</mml:mi> <mml:mrow><mml:msub><mml:mi>a</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mi>d</mml:mi> <mml:mo>-</mml:mo> <mml:mi>l</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup> <mml:msubsup><mml:mi>g</mml:mi> <mml:mrow><mml:msub><mml:mi>a</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mi>d</mml:mi> <mml:mo>-</mml:mo> <mml:mi>l</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup> <mml:mo>…</mml:mo> <mml:msup><mml:mi>g</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mrow><mml:msub><mml:mi>a</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mi>d</mml:mi></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. ChIPulate uses the <monospace>getfasta</monospace> subcommand of <monospace>pybedtools</monospace> from the input genome FASTA file to extract these sequences [<xref ref-type="bibr" rid="pcbi.1006921.ref072">72</xref>, <xref ref-type="bibr" rid="pcbi.1006921.ref073">73</xref>].</p>
<p>The quality of each base call in every sequence read is set to be K, the maximum possible value on the Illumina Phred-33 quality scale. This corresponds to a base call error probability of 10<sup>−42</sup> [<xref ref-type="bibr" rid="pcbi.1006921.ref074">74</xref>].</p>
<sec id="sec023">
<title>Default values</title>
<p>Unless stated otherwise, we use the following values by default—</p>
<list list-type="simple">
<list-item><p>Genome-wide TF-DNA binding model: <italic>n</italic> = 1000, <italic>ϵ</italic><sub>1</sub>, …, <italic>ϵ</italic><sub><italic>n</italic></sub> are sampled from a power law (with <italic>α</italic> = 0.5) between 0 and 10<italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic>, <inline-formula id="pcbi.1006921.e161"><alternatives><graphic id="pcbi.1006921.e161g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e161" xlink:type="simple"/><mml:math display="inline" id="M161"><mml:mrow><mml:msub><mml:mover><mml:mi>ϵ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mi>b</mml:mi> <mml:mi>g</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:msub><mml:mi>k</mml:mi> <mml:mi>B</mml:mi></mml:msub> <mml:mi>T</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, <italic>C</italic> = 10<sup>5</sup>(ChIP sample), <italic>μ</italic> = 3<italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic>, <italic>C</italic> = 10<sup>4</sup>(input sample)</p></list-item>
<list-item><p>Extraction process: <inline-formula id="pcbi.1006921.e162"><alternatives><graphic id="pcbi.1006921.e162g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e162" xlink:type="simple"/><mml:math display="inline" id="M162"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi> <mml:mi>e</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>p</mml:mi> <mml:mi>e</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> are sampled from a <italic>N</italic>(0.5, 0.025) distribution that is truncated to lie in [0, 1]. Further, at each location, the extraction efficiency is set to be the same in both ChIP and input samples.</p></list-item>
<list-item><p>Amplification process: <italic>A</italic> = 1000, <italic>n</italic><sub><italic>cy</italic></sub> = 15</p></list-item>
<list-item><p>Sequencing: <italic>c</italic> = 100</p></list-item>
</list>
</sec>
</sec>
<sec id="sec024">
<title>Motif estimation</title>
<p>To simulate motif estimation, we first sample binding energies <italic>ϵ</italic><sub>1</sub>, <italic>ϵ</italic><sub>2</sub>, …, <italic>ϵ</italic><sub><italic>n</italic></sub> from a binding energy distribution. We associate each binding energy <italic>ϵ</italic><sup>(<italic>i</italic>)</sup> with a binding site sequence of the target TF whose energy <inline-formula id="pcbi.1006921.e163"><alternatives><graphic id="pcbi.1006921.e163g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e163" xlink:type="simple"/><mml:math display="inline" id="M163"><mml:msubsup><mml:mi>ϵ</mml:mi> <mml:mi>i</mml:mi> <mml:mo>′</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> is closest to this assigned value. The sampled energy <italic>ϵ</italic><sup>(<italic>i</italic>)</sup> is then replaced with <inline-formula id="pcbi.1006921.e164"><alternatives><graphic id="pcbi.1006921.e164g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e164" xlink:type="simple"/><mml:math display="inline" id="M164"><mml:msubsup><mml:mi>ϵ</mml:mi> <mml:mi>i</mml:mi> <mml:mo>′</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula>, and the set of energies <inline-formula id="pcbi.1006921.e165"><alternatives><graphic id="pcbi.1006921.e165g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e165" xlink:type="simple"/><mml:math display="inline" id="M165"><mml:mrow><mml:msubsup><mml:mi>ϵ</mml:mi> <mml:mn>1</mml:mn> <mml:mo>′</mml:mo></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>ϵ</mml:mi> <mml:mn>2</mml:mn> <mml:mo>′</mml:mo></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>ϵ</mml:mi> <mml:mi>n</mml:mi> <mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> are used for all occupancy calculations in the TF-DNA binding simulation. In the simulations shown here, the energies <inline-formula id="pcbi.1006921.e166"><alternatives><graphic id="pcbi.1006921.e166g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e166" xlink:type="simple"/><mml:math display="inline" id="M166"><mml:msubsup><mml:mi>ϵ</mml:mi> <mml:mi>i</mml:mi> <mml:mo>′</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> for each binding site sequence were taken from BEEML binding energy matrices (BEMs) that were fit to <italic>in vitro</italic> protein-binding microarray affinity measurements of different TFs [<xref ref-type="bibr" rid="pcbi.1006921.ref013">13</xref>].</p>
<p>Once ChIP-seq is simulated based on these binding energies, the top 10% of locations based on their read count ratios are chosen and the binding sites in each of them are used to construct the PWM of the target TF of the ChIP-seq. Since the BEMs we employed were for 10 bp long sequences, the PWMs we estimated were also 10 base pairs in length. Each term of the <bold>W</bold> was computed using the formula [<xref ref-type="bibr" rid="pcbi.1006921.ref075">75</xref>]
<disp-formula id="pcbi.1006921.e167"><alternatives><graphic id="pcbi.1006921.e167g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e167" xlink:type="simple"/><mml:math display="block" id="M167"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="bold">W</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mo form="prefix">log</mml:mo> <mml:mn>2</mml:mn></mml:msub> <mml:mo>(</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>N</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>b</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:msub><mml:mi>b</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>N</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:mo>)</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(14)</label></disp-formula>
where <italic>N</italic><sub><italic>ij</italic></sub> is the number of sequences with the i-th base at the j-th position, <italic>b</italic><sub><italic>i</italic></sub> is the background frequency of the i-th sequence and <italic>N</italic> is the number of sequences used to estimated <bold>W</bold>. The background frequencies are added as pseudo-counts to deal with positions where <italic>N</italic><sub><italic>ij</italic></sub> is 0.</p>
</sec>
<sec id="sec025">
<title>Motif estimation in the presence of indirect binding and cooperative binding</title>
<p>As stated earlier, in indirect binding, a fraction of genomic locations are bound by the ChIP target TF A while the remaining locations are bound by a second TF B, which is in turn bound to A. The binding site sequences of A are assigned to each genomic locus based on the BEM of A but we do not utilize any BEM of B to assign a binding site sequence for it. Instead, we associate with each binding energy of B a 10 bp sequence generated from a dinucleotide model of the <italic>S. cerevisiae</italic> genome. We chose a dinucleotide model to generate indirectly bound sequences since this has been shown to closely approximate background genomic DNA that is not bound by the target TF [<xref ref-type="bibr" rid="pcbi.1006921.ref061">61</xref>].</p>
<p>After ChIP-seq is simulated in the presence of indirect binding, the top 10% of genomic locations are chosen according to their read count ratio to estimate the PWM of A. The sequences used for PWM estimation are the binding sites of A from directly bound locations that fall in the top 10% and the randomly generated binding site sequences of B from the remaining indirectly bound locations.</p>
<p>In the case of cooperative binding, a fraction of locations is bound cooperatively by A and B while the remaining locations are independently bound by both TFs. At each genomic locus, binding sites of A and B are associated with the binding energies of each location based on their respective BEMs. When the top 10% of locations are chosen for PWM estimation, the binding sites of A from both cooperatively and independently bound locations are chosen.</p>
</sec>
<sec id="sec026">
<title>Posterior density estimation</title>
<p>We drew samples from the posterior binding energy distribution <inline-formula id="pcbi.1006921.e168"><alternatives><graphic id="pcbi.1006921.e168g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e168" xlink:type="simple"/><mml:math display="inline" id="M168"><mml:mrow><mml:mi>P</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mover><mml:mi>ϵ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mo>|</mml:mo> <mml:msup><mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msup><mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> using a combination of kernel density estimation and the Metropolis-Hastings algorithm [<xref ref-type="bibr" rid="pcbi.1006921.ref076">76</xref>]. Here, <italic>r</italic><sup>(1)</sup>, <italic>r</italic><sup>(2)</sup>, …, <italic>r</italic><sup>(<italic>k</italic>)</sup> are read count ratios observed in <italic>k</italic> sequential replicates from a genomic locus whose true binding energy is <italic>ϵ</italic><sub><italic>T</italic></sub>.</p>
<p>We first compute the posterior distribution when <italic>k</italic> = 1. From Bayes’ rule, we have
<disp-formula id="pcbi.1006921.e169"><alternatives><graphic id="pcbi.1006921.e169g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e169" xlink:type="simple"/><mml:math display="block" id="M169"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover><mml:mi>ϵ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mo>|</mml:mo> <mml:msup><mml:mi>R</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>=</mml:mo> <mml:msup><mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>R</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>=</mml:mo> <mml:msup><mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>|</mml:mo> <mml:msub><mml:mover><mml:mi>ϵ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>π</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover><mml:mi>ϵ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:msub><mml:mi>C</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(15)</label></disp-formula>
where <italic>C</italic><sub>1</sub> is the normalization constant <inline-formula id="pcbi.1006921.e170"><alternatives><graphic id="pcbi.1006921.e170g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e170" xlink:type="simple"/><mml:math display="inline" id="M170"><mml:mrow><mml:msub><mml:mi>C</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mo>∫</mml:mo> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>R</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>=</mml:mo> <mml:msup><mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>|</mml:mo> <mml:msub><mml:mover><mml:mi>ϵ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>π</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover><mml:mi>ϵ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>d</mml:mi> <mml:mi>ϵ</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> and <italic>π</italic> is a prior distribution, which we set to be the default binding energy distribution.</p>
<p>
<inline-formula id="pcbi.1006921.e171">
<alternatives>
<graphic id="pcbi.1006921.e171g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e171" xlink:type="simple"/>
<mml:math display="inline" id="M171">
<mml:mrow>
<mml:mi>P</mml:mi>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msup>
<mml:mi>R</mml:mi>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:msup>
<mml:mo>=</mml:mo>
<mml:msup>
<mml:mi>r</mml:mi>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:msup>
<mml:mo>|</mml:mo>
<mml:msub>
<mml:mover>
<mml:mi>ϵ</mml:mi>
<mml:mo>¯</mml:mo>
</mml:mover>
<mml:mn>1</mml:mn>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mi>ϵ</mml:mi>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>≡</mml:mo>
<mml:mi>p</mml:mi>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msub>
<mml:mi>ϵ</mml:mi>
<mml:mn>1</mml:mn>
</mml:msub>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:math>
</alternatives>
</inline-formula> represents the probability density of read count ratios from a locus containing a single binding site with energy <italic>ϵ</italic>. To compute this distribution, we simulated 10<sup>3</sup> replicates of ChIP-seq across <italic>n</italic> = 1000 locations whose binding energies <italic>ϵ</italic><sub>1</sub>, <italic>ϵ</italic><sub>2</sub>, …, <italic>ϵ</italic><sub><italic>n</italic></sub> were sampled from the default binding energy distribution. The remaining simulation parameters of the ChIP-seq were set to their default values. This gave us 10<sup>3</sup> replicates of read count ratios for each of the binding energies <italic>ϵ</italic><sub>1</sub>, <italic>ϵ</italic><sub>2</sub>, …, <italic>ϵ</italic><sub><italic>n</italic></sub>. We used these read count ratios to compute Gaussian kernel density estimators (KDE) of <italic>p</italic>(<italic>ϵ</italic><sub>1</sub>), <italic>p</italic>(<italic>ϵ</italic><sub>2</sub>), …, <italic>p</italic>(<italic>ϵ</italic><sub><italic>n</italic></sub>), which we denote as <inline-formula id="pcbi.1006921.e172"><alternatives><graphic id="pcbi.1006921.e172g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e172" xlink:type="simple"/><mml:math display="inline" id="M172"><mml:mrow><mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>ϵ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>ϵ</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>ϵ</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. The KDE estimators were computed using the <monospace>gaussian_kde</monospace> method in the Python scipy library (v0.19.1) [<xref ref-type="bibr" rid="pcbi.1006921.ref077">77</xref>]. Given this set of KDE estimators, we can compute <inline-formula id="pcbi.1006921.e173"><alternatives><graphic id="pcbi.1006921.e173g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e173" xlink:type="simple"/><mml:math display="inline" id="M173"><mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> at any arbitrary <italic>ϵ</italic> in the range [min <italic>ϵ</italic><sup>(<italic>i</italic>)</sup>, max <italic>ϵ</italic><sup>(<italic>i</italic>)</sup>] using a linear interpolation between values <italic>ϵ</italic><sub><italic>j</italic></sub> and <italic>ϵ</italic><sub><italic>j</italic>+1</sub> as
<disp-formula id="pcbi.1006921.e174"><alternatives><graphic id="pcbi.1006921.e174g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e174" xlink:type="simple"/><mml:math display="block" id="M174"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>λ</mml:mo> <mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>ϵ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mo>λ</mml:mo> <mml:mo>)</mml:mo></mml:mrow> <mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>ϵ</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(16)</label></disp-formula>
where <italic>ϵ</italic><sub><italic>j</italic></sub> &lt; <italic>ϵ</italic> &lt; <italic>ϵ</italic><sub><italic>j</italic>+1</sub> and λ = (<italic>ϵ</italic> − <italic>ϵ</italic><sub><italic>j</italic></sub>)/(<italic>ϵ</italic><sub><italic>j</italic>+1</sub> − <italic>ϵ</italic><sub><italic>j</italic></sub>). Substituting this into <xref ref-type="disp-formula" rid="pcbi.1006921.e169">Eq (15)</xref>, we get
<disp-formula id="pcbi.1006921.e175"><alternatives><graphic id="pcbi.1006921.e175g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e175" xlink:type="simple"/><mml:math display="block" id="M175"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover><mml:mi>ϵ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mo>|</mml:mo> <mml:msup><mml:mi>R</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>=</mml:mo> <mml:msup><mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≈</mml:mo> <mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>ϵ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>π</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover><mml:mi>ϵ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:msub><mml:mi>C</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(17)</label></disp-formula>
where <inline-formula id="pcbi.1006921.e176"><alternatives><graphic id="pcbi.1006921.e176g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e176" xlink:type="simple"/><mml:math display="inline" id="M176"><mml:mrow><mml:msub><mml:mi>C</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mo>∫</mml:mo> <mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>ϵ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>π</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover><mml:mi>ϵ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>d</mml:mi> <mml:mi>ϵ</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>. To sample from <inline-formula id="pcbi.1006921.e177"><alternatives><graphic id="pcbi.1006921.e177g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e177" xlink:type="simple"/><mml:math display="inline" id="M177"><mml:mrow><mml:mi>P</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mover><mml:mi>ϵ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mo>|</mml:mo> <mml:msup><mml:mi>R</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>=</mml:mo> <mml:msup><mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, we implemented the Metropolis-Hastings algorithm [<xref ref-type="bibr" rid="pcbi.1006921.ref076">76</xref>], which is an algorithm that draws samples from a Markov chain whose stationary distribution is the posterior density from which we wish to sample.</p>
<p>Using the same ChIP-seq simulation parameters as used in generating the 10<sup>3</sup> replicates, but with the binding energy of the first locus <italic>ϵ</italic><sub>1</sub> set to <italic>ϵ</italic><sub><italic>T</italic></sub>, we simulated <italic>k</italic> replicates of ChIP-seq and store the sequence of read count ratios <italic>r</italic><sup>(1)</sup>, <italic>r</italic><sup>(2)</sup>, …<italic>r</italic><sup>(<italic>k</italic>)</sup> from the first locus. These are the read count ratios that are used to sequentially update the posterior binding energy estimate in <xref ref-type="disp-formula" rid="pcbi.1006921.e169">Eq (15)</xref>.</p>
</sec>
<sec id="sec027">
<title>Metropolis-Hastings algorithm</title>
<p>The output of the Metropolis-Hastings algorithm is a set of samples <inline-formula id="pcbi.1006921.e178"><alternatives><graphic id="pcbi.1006921.e178g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e178" xlink:type="simple"/><mml:math display="inline" id="M178"><mml:mrow><mml:msubsup><mml:mi>ϵ</mml:mi> <mml:mi>k</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>ϵ</mml:mi> <mml:mi>k</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>ϵ</mml:mi> <mml:mi>k</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> that follows a target distribution, which in this case is the posterior distribution <inline-formula id="pcbi.1006921.e179"><alternatives><graphic id="pcbi.1006921.e179g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e179" xlink:type="simple"/><mml:math display="inline" id="M179"><mml:mrow><mml:mi>P</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mover><mml:mi>ϵ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mo>|</mml:mo> <mml:msup><mml:mi>R</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>=</mml:mo> <mml:msup><mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mi>R</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>=</mml:mo> <mml:msup><mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msup><mml:mi>R</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>=</mml:mo> <mml:msup><mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. We explain the algorithm for the case when <italic>k</italic> = 1.</p>
<p>We first sample <italic>ϵ</italic> from a Uniform[0, 10] distribution and set <inline-formula id="pcbi.1006921.e180"><alternatives><graphic id="pcbi.1006921.e180g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e180" xlink:type="simple"/><mml:math display="inline" id="M180"><mml:mrow><mml:msubsup><mml:mi>ϵ</mml:mi> <mml:mn>1</mml:mn> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:mi>ϵ</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, and compute <inline-formula id="pcbi.1006921.e181"><alternatives><graphic id="pcbi.1006921.e181g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e181" xlink:type="simple"/><mml:math display="inline" id="M181"><mml:mrow><mml:mi>f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>ϵ</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≡</mml:mo> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>ϵ</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>|</mml:mo> <mml:msup><mml:mi>R</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>=</mml:mo> <mml:msup><mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo><mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>^</mml:mo></mml:mover><mml:mo>(</mml:mo><mml:mi>ϵ</mml:mi><mml:mo>)</mml:mo><mml:mi>π</mml:mi> <mml:mrow><mml:mo>(</mml:mo><mml:mi>ϵ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. <inline-formula id="pcbi.1006921.e182"><alternatives><graphic id="pcbi.1006921.e182g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e182" xlink:type="simple"/><mml:math display="inline" id="M182"><mml:msubsup><mml:mi>ϵ</mml:mi> <mml:mn>1</mml:mn> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> is the initial state of the Markov chain. We then sample <italic>ϵ</italic>′ from a proposal distribution, which we denote as <inline-formula id="pcbi.1006921.e183"><alternatives><graphic id="pcbi.1006921.e183g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e183" xlink:type="simple"/><mml:math display="inline" id="M183"><mml:mrow><mml:mi>g</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mi>ϵ</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>|</mml:mo> <mml:msubsup><mml:mi>ϵ</mml:mi> <mml:mn>1</mml:mn> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, and then compute <inline-formula id="pcbi.1006921.e184"><alternatives><graphic id="pcbi.1006921.e184g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e184" xlink:type="simple"/><mml:math display="inline" id="M184"><mml:mrow><mml:mi>f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>ϵ</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>ϵ</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>π</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mover><mml:mi>ϵ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> using <xref ref-type="disp-formula" rid="pcbi.1006921.e174">Eq (16)</xref>. If <inline-formula id="pcbi.1006921.e185"><alternatives><graphic id="pcbi.1006921.e185g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e185" xlink:type="simple"/><mml:math display="inline" id="M185"><mml:mrow><mml:mi>f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>ϵ</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>&gt;</mml:mo> <mml:mi>f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>ϵ</mml:mi> <mml:mn>1</mml:mn> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, we update the current state of the sampler to <inline-formula id="pcbi.1006921.e186"><alternatives><graphic id="pcbi.1006921.e186g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e186" xlink:type="simple"/><mml:math display="inline" id="M186"><mml:mrow><mml:msubsup><mml:mi>ϵ</mml:mi> <mml:mn>1</mml:mn> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:msup><mml:mi>ϵ</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>. If <inline-formula id="pcbi.1006921.e187"><alternatives><graphic id="pcbi.1006921.e187g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e187" xlink:type="simple"/><mml:math display="inline" id="M187"><mml:mrow><mml:mi>f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>ϵ</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>&lt;</mml:mo> <mml:mi>f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>ϵ</mml:mi> <mml:mn>1</mml:mn> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, we compute a ratio
<disp-formula id="pcbi.1006921.e188"><alternatives><graphic id="pcbi.1006921.e188g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e188" xlink:type="simple"/><mml:math display="block" id="M188"><mml:mrow><mml:mi>r</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mi>f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>ϵ</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>g</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>ϵ</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>|</mml:mo> <mml:msubsup><mml:mi>ϵ</mml:mi> <mml:mn>1</mml:mn> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mi>f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>ϵ</mml:mi> <mml:mn>1</mml:mn> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>g</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>ϵ</mml:mi> <mml:mn>1</mml:mn> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>|</mml:mo> <mml:msup><mml:mi>ϵ</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(18)</label></disp-formula>
and sample a number <italic>u</italic> from a Uniform[0, 1] distribution. If <italic>u</italic> &lt; <italic>r</italic>, we set the current state of the sampler to <inline-formula id="pcbi.1006921.e189"><alternatives><graphic id="pcbi.1006921.e189g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e189" xlink:type="simple"/><mml:math display="inline" id="M189"><mml:mrow><mml:msubsup><mml:mi>ϵ</mml:mi> <mml:mn>1</mml:mn> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:msup><mml:mi>ϵ</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> or leave it unchanged at <inline-formula id="pcbi.1006921.e190"><alternatives><graphic id="pcbi.1006921.e190g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e190" xlink:type="simple"/><mml:math display="inline" id="M190"><mml:msubsup><mml:mi>ϵ</mml:mi> <mml:mn>1</mml:mn> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> if <italic>u</italic> &gt; <italic>r</italic>. If <inline-formula id="pcbi.1006921.e191"><alternatives><graphic id="pcbi.1006921.e191g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e191" xlink:type="simple"/><mml:math display="inline" id="M191"><mml:msubsup><mml:mi>ϵ</mml:mi> <mml:mn>1</mml:mn> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> takes on values close to the values 0 or 10<italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic>, then the probability density <inline-formula id="pcbi.1006921.e192"><alternatives><graphic id="pcbi.1006921.e192g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e192" xlink:type="simple"/><mml:math display="inline" id="M192"><mml:mrow><mml:mi>g</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mi>ϵ</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>|</mml:mo> <mml:msubsup><mml:mi>ϵ</mml:mi> <mml:mn>1</mml:mn> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> must be 0 when <italic>ϵ</italic>′ &lt; 0 and <italic>ϵ</italic>′ &gt; 10<italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic>. Thus, the choice of <italic>g</italic> which we use for the proposal distribution is a truncated normal distribution. The forward proposal distribution <inline-formula id="pcbi.1006921.e193"><alternatives><graphic id="pcbi.1006921.e193g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e193" xlink:type="simple"/><mml:math display="inline" id="M193"><mml:mrow><mml:mi>g</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mi>ϵ</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>|</mml:mo> <mml:msubsup><mml:mi>ϵ</mml:mi> <mml:mn>1</mml:mn> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, where <inline-formula id="pcbi.1006921.e194"><alternatives><graphic id="pcbi.1006921.e194g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e194" xlink:type="simple"/><mml:math display="inline" id="M194"><mml:msubsup><mml:mi>ϵ</mml:mi> <mml:mn>1</mml:mn> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> is the i-th sample drawn, is a normal distribution with mean <inline-formula id="pcbi.1006921.e195"><alternatives><graphic id="pcbi.1006921.e195g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e195" xlink:type="simple"/><mml:math display="inline" id="M195"><mml:msubsup><mml:mi>ϵ</mml:mi> <mml:mn>1</mml:mn> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and standard deviation <inline-formula id="pcbi.1006921.e196"><alternatives><graphic id="pcbi.1006921.e196g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e196" xlink:type="simple"/><mml:math display="inline" id="M196"><mml:mrow><mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>02</mml:mn> <mml:msubsup><mml:mi>ϵ</mml:mi> <mml:mn>1</mml:mn> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> that is truncated to lie within [0, 10<italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic>]. The backward proposal distribution, <inline-formula id="pcbi.1006921.e197"><alternatives><graphic id="pcbi.1006921.e197g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e197" xlink:type="simple"/><mml:math display="inline" id="M197"><mml:mrow><mml:mi>g</mml:mi> <mml:mo>(</mml:mo> <mml:msubsup><mml:mi>ϵ</mml:mi> <mml:mn>1</mml:mn> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>|</mml:mo> <mml:msup><mml:mi>ϵ</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is a normal distribution with mean <italic>ϵ</italic>′ and standard deviation 0.2<italic>ϵ</italic>′ that is truncated to lie within [0, 10<italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic>].</p>
<p>We repeat this process and store the states of the sampler <inline-formula id="pcbi.1006921.e198"><alternatives><graphic id="pcbi.1006921.e198g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e198" xlink:type="simple"/><mml:math display="inline" id="M198"><mml:mrow><mml:msubsup><mml:mi>ϵ</mml:mi> <mml:mn>1</mml:mn> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>ϵ</mml:mi> <mml:mn>1</mml:mn> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>ϵ</mml:mi> <mml:mn>1</mml:mn> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>b</mml:mi> <mml:mo>+</mml:mo> <mml:mi>t</mml:mi> <mml:mi>m</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, where <italic>t</italic> is a thinning factor that we fix at 100, <italic>b</italic> is the burn-in period that is set to 10000 and <italic>m</italic> is the number of samples to be retained, which we set at 10000. We then retain only every t-th sample beginning from the b-th sample i.e. <inline-formula id="pcbi.1006921.e199"><alternatives><graphic id="pcbi.1006921.e199g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e199" xlink:type="simple"/><mml:math display="inline" id="M199"><mml:mrow><mml:msubsup><mml:mi>ϵ</mml:mi> <mml:mi>b</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>ϵ</mml:mi> <mml:mrow><mml:mi>b</mml:mi> <mml:mo>+</mml:mo> <mml:mi>t</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mi>ϵ</mml:mi> <mml:mrow><mml:mi>b</mml:mi> <mml:mo>+</mml:mo> <mml:mi>t</mml:mi> <mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, and use it to construct a Gaussian kernel density estimator of <inline-formula id="pcbi.1006921.e200"><alternatives><graphic id="pcbi.1006921.e200g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e200" xlink:type="simple"/><mml:math display="inline" id="M200"><mml:mrow><mml:mi>P</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mover><mml:mi>ϵ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mo>|</mml:mo> <mml:msup><mml:mi>R</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>=</mml:mo> <mml:msup><mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, which we denote as <inline-formula id="pcbi.1006921.e201"><alternatives><graphic id="pcbi.1006921.e201g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e201" xlink:type="simple"/><mml:math display="inline" id="M201"><mml:mrow><mml:mover accent="true"><mml:mi>P</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover><mml:mi>ϵ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mo>|</mml:mo> <mml:msup><mml:mi>R</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>=</mml:mo> <mml:msup><mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Note that in this process, the normalization constant <italic>C</italic><sub>1</sub> in <xref ref-type="disp-formula" rid="pcbi.1006921.e169">Eq (15)</xref> need not be computed.</p>
<p>When the read count ratio <italic>r</italic><sup>(2)</sup> is observed after the second replicate of ChIP-seq, we substitute <inline-formula id="pcbi.1006921.e202"><alternatives><graphic id="pcbi.1006921.e202g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e202" xlink:type="simple"/><mml:math display="inline" id="M202"><mml:mrow><mml:mover accent="true"><mml:mi>P</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover><mml:mi>ϵ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mo>|</mml:mo> <mml:msup><mml:mi>R</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>=</mml:mo> <mml:msup><mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> in place of the prior <italic>π</italic> in <xref ref-type="disp-formula" rid="pcbi.1006921.e169">Eq (15)</xref> and update the posterior <inline-formula id="pcbi.1006921.e203"><alternatives><graphic id="pcbi.1006921.e203g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e203" xlink:type="simple"/><mml:math display="inline" id="M203"><mml:mrow><mml:mi>P</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mover><mml:mi>ϵ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:mo>|</mml:mo> <mml:msup><mml:mi>R</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>=</mml:mo> <mml:msup><mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mi>R</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>=</mml:mo> <mml:msup><mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>—
<disp-formula id="pcbi.1006921.e204"><alternatives><graphic id="pcbi.1006921.e204g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e204" xlink:type="simple"/><mml:math display="block" id="M204"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mover><mml:mi>ϵ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mo>|</mml:mo> <mml:msup><mml:mi>R</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:msup><mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mi>R</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>=</mml:mo> <mml:msup><mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>R</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>=</mml:mo> <mml:msup><mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mi>R</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>=</mml:mo> <mml:msup><mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>|</mml:mo> <mml:msub><mml:mover><mml:mi>ϵ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mover accent="true"><mml:mi>P</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover><mml:mi>ϵ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mo>|</mml:mo> <mml:msup><mml:mi>R</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>=</mml:mo> <mml:msup><mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:msub><mml:mi>C</mml:mi> <mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>R</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>=</mml:mo> <mml:msup><mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>|</mml:mo> <mml:msub><mml:mover><mml:mi>ϵ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>R</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>=</mml:mo> <mml:msup><mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>|</mml:mo> <mml:msub><mml:mover><mml:mi>ϵ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mover accent="true"><mml:mi>P</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover><mml:mi>ϵ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mo>|</mml:mo> <mml:msup><mml:mi>R</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>=</mml:mo> <mml:msup><mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:msub><mml:mi>C</mml:mi> <mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>≈</mml:mo> <mml:mover accent="true"><mml:mi>P</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>R</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>=</mml:mo> <mml:msup><mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>|</mml:mo> <mml:msub><mml:mover><mml:mi>ϵ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mover accent="true"><mml:mi>P</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>R</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>=</mml:mo> <mml:msup><mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>|</mml:mo> <mml:msub><mml:mover><mml:mi>ϵ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mover accent="true"><mml:mi>P</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover><mml:mi>ϵ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mo>|</mml:mo> <mml:msup><mml:mi>R</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>=</mml:mo> <mml:msup><mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:msub><mml:mi>C</mml:mi> <mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <italic>C</italic><sub>2</sub> is a normalization constant. This process is repeated <italic>k</italic> times in order to sample from the posterior binding energy distributions <inline-formula id="pcbi.1006921.e205"><alternatives><graphic id="pcbi.1006921.e205g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006921.e205" xlink:type="simple"/><mml:math display="inline" id="M205"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover><mml:mi>ϵ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mo>|</mml:mo> <mml:msup><mml:mi>R</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>=</mml:mo> <mml:msup><mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover><mml:mi>ϵ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mo>|</mml:mo> <mml:msup><mml:mi>R</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>=</mml:mo> <mml:msup><mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msup><mml:mi>R</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>=</mml:mo> <mml:msup><mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>.</p>
</sec>
<sec id="sec028">
<title>Change in binding energy due to a single nucleotide change in a binding site</title>
<p>We obtained BEM models of 368 TFs from the BEEML database (<ext-link ext-link-type="uri" xlink:href="http://stormo.wustl.edu/beeml/" xlink:type="simple">http://stormo.wustl.edu/beeml/</ext-link>) [<xref ref-type="bibr" rid="pcbi.1006921.ref013">13</xref>]. These matrices follow the convention where the highest affinity sequence is assigned an energy of 0, with all other sequences being assigned a positive binding energy. The matrices in this database were calculated by fits of binding energy models to protein binding microarray data [<xref ref-type="bibr" rid="pcbi.1006921.ref013">13</xref>] which measured the affinity of TFs for different 10 bp long sequences. For each TF, there were two BEMs (each of dimension 4 × 10) available since the matrices were fit individually to replicates of microarray measurements, with the quality of the fit being determined by the <italic>R</italic><sup>2</sup> value of predictions from the matrix with measurements. For each TF, we chose the BEM that had the higher <italic>R</italic><sup>2</sup> value for further analysis.</p>
<p>For each TF, we picked the sequence whose energy was closest in value to a baseline energy that were in the range 2 − 6<italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic> in steps of 1<italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic>. For a given baseline energy, we then computed the binding energy of each of the 30 sequences that were a single mutation away from this sequence and stored the absolute values of the energy differences. We repeated this process for every TF in the database and computed the 50-th and 25-th quantiles of binding energy differences. The 50-th quantiles for the baseline energies from 2 − 6<italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic> were (in units of <italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic>) 0.24, 0.24, 0.23, 0.24, 0.24 and the 25-th quantiles were 0.76, 0.72, 0.7, 0.7, 0.71.</p>
</sec>
</sec>
<sec id="sec029">
<title>Supporting information</title>
<supplementary-material id="pcbi.1006921.s001" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006921.s001" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Impact of power-law based genome-wide heterogeneity in extraction and PCR efficiency on motif inference and ChIP-seq fidelity.</title>
<p>(A) Impact of heterogeneity in mean amplification ratio (left panel) and extraction efficiency (right panel) on motif inference. The heterogeneity follows a power law truncated between 0 and 1. The error bars are the standard deviation in the mean K-L distance computed after PWM was estimated in 10 replicates of ChIP-seq for each mean and coefficient of variation. (B) Impact of heterogeneity in mean amplification ratio (left panel) and extraction efficiency (right panel) on fidelity. The fidelity is calculated for all regions (orange), the top 25th percentile (blue) and bottom 25th percentile (black) of read count ratios. The error bars are the standard deviation in the estimate of fidelity, which are computed from 10 replicates of simulation for a given mean and coefficient of variation.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006921.s002" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006921.s002" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Impact of chemical potential (TF concentration) on motif inference and fidelity.</title>
<p>(A) Left panel: Read count ratios from three different ChIP-seq simulations run with parameters set to their default values but with the chemical potential (<italic>μ</italic>) set to 2<italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic> (black), 4<italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic> (blue) and 6<italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic> (orange). 3<italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic> is the default value of the chemical potential used everywhere in the main text. Right panel: The K-L distance of the derived motif of Tye7 from the baseline motif, which is derived when the chemical potential is set to 0, is shown on the y-axis. The chemical potential is varied between 1<italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic> and 6<italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic> on the x-axis. (B) The fidelity of ChIP-seq is shown on the y-axis for all regions (orange), the top 25th percentile (blue) and bottom 25th percentile (black) of read count ratios. The error bars are the standard deviation in mean K-L distance and fidelity obtained after 10 replicates of simulation.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006921.s003" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006921.s003" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>The impact of normally distributed extraction heterogeneity on motif inference for different TFs.</title>
<p>The heterogeneity in the extraction is assumed to follow a truncated normal distribution, with the mean increasing from left to right on the x-axis in both panels. (A) More informative TFs are less distorted by a low mean extraction efficiency. For each TF, the maximum K-L distance between the baseline motif and the motif inferred in the presence of extraction heterogeneity is computed from the curves shown in (B). The information content (in bits) of the baseline motif for each TF is shown on the x-axis. (B) Dependence of K-L distance between the inferred and baseline motifs of each TF at different levels of genome-wide extraction heterogeneity. The coefficient of variation of the truncated normal varies from 0 (no variation, in blue) to 0.5 (green) and 1.0 (brown). The error bars are the standard deviation in the mean K-L distance computed after PWM was estimated in 10 replicates of ChIP-seq for each mean and coefficient of variation. The binding energy matrices of each TF were taken from the BEEML database. The structural class of the DNA binding domains of these TFs is listed in <xref ref-type="supplementary-material" rid="pcbi.1006921.s007">S1 Table</xref>.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006921.s004" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006921.s004" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>The impact of normally distributed amplification ratio heterogeneity on motif inference for different TFs.</title>
<p>The heterogeneity in the amplification ratio is assumed to follow a truncated normal distribution, with the mean increasing from left to right on the x-axis in both panels. (A) More informative TFs are less distorted by a low mean amplification ratio efficiency. For each TF, the maximum K-L distance between the baseline motif and the motif inferred in the presence of amplification ratio heterogeneity is computed from the curves shown in B. The information content (in bits) of the baseline motif for each TF is shown on the x-axis. (B) Dependence of K-L distance between the inferred and baseline motifs of each TF at different levels of genome-wide amplification ratio heterogeneity. The coefficient of variation of the truncated normal varies from 0 (no variation, in blue) to 0.5 (green) and 1.0 (brown). The error bars are the standard deviation in the mean K-L distance computed after PWM was estimated in 10 replicates of ChIP-seq for each mean and coefficient of variation.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006921.s005" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006921.s005" xlink:type="simple">
<label>S5 Fig</label>
<caption>
<title>Distortion of motifs of different lengths due to variation in (A) extraction efficiency, and (B) the amplification ratio.</title>
<p>Motifs of length 6 and 8 bp in length were generated by sub-sampling columns of the 10bp long Tye7 energy matrix, while motifs of length 12, 14 and 16 were generated by first sub-sampling 2, 4, and 6 columns and concatenating them to the Tye7 energy matrix. The motif information content (MIC) of the baseline motif (in bits) is shown in each panel. The extraction and amplification ratio is assumed to be normally distributed with the coefficient of variation set at either 0, 0.5 or 1. The error bars are the standard deviation in the mean K-L distance computed after the PWM was estimated in 10 replicates of ChIP-seq for each mean and coefficient of variation.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006921.s006" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006921.s006" xlink:type="simple">
<label>S6 Fig</label>
<caption>
<title>The impact of chromatin accessibility on the sensitivity of ChIP-seq.</title>
<p>Left panel: The mean chromatin accessibility, as defined in the main text, is varied along the x-axis with the area under the ROC (auROC) on the y-axis. Equal numbers (1000) of true and false positive binding sites is set to be equal to 1000 each. The binding energy distribution of the true positive sites is set to be a power law truncated between 0 and 6<italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic> with an exponent of 0.5, and the false positive site binding energies are distributed as a truncated power law between 0 and 6.78<italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic> with an exponent of 0.76. This corresponds to a mean occupancy ratio of 2 between the true and false positive binding sites. Chromatin accessibility is varied by changing <italic>β</italic> in <xref ref-type="disp-formula" rid="pcbi.1006921.e051">Eq 8</xref> in the main text. Right panel: A Gaussian kernel density estimate of the chromatin accessibility distribution corresponding to <italic>β</italic> = 0.5 (black), <italic>β</italic> = 5.0 (blue), <italic>β</italic> = 10.0 (orange). The mean corresponding to each value is shown in the plot legend.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006921.s007" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006921.s007" xlink:type="simple">
<label>S1 Table</label>
<caption>
<title>The structural class of the motifs of TFs analyzed in <xref ref-type="supplementary-material" rid="pcbi.1006921.s003">S3</xref> and <xref ref-type="supplementary-material" rid="pcbi.1006921.s004">S4</xref> Figs.</title>
<p>Information on the structural class of the TFs was taken from the TransFac database. The binding energy matrices were taken from the BEEML database.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We thank Gautam Menon, Sandeep Krishna, Parul Singh and Aswin Sai Narain Seshasayee, for discussions.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1006921.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Johnson</surname> <given-names>DS</given-names></name>, <name name-style="western"><surname>Mortazavi</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Myers</surname> <given-names>RM</given-names></name>, <name name-style="western"><surname>Wold</surname> <given-names>B</given-names></name>. <article-title>Genome-wide mapping of <italic>in vivo</italic> protein-DNA interactions</article-title>. <source>Science</source>. <year>2007</year>;<volume>316</volume>(<issue>5830</issue>):<fpage>1497</fpage>–<lpage>1502</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.1141319" xlink:type="simple">10.1126/science.1141319</ext-link></comment> <object-id pub-id-type="pmid">17540862</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Li</surname> <given-names>XY</given-names></name>, <name name-style="western"><surname>Thomas</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Sabo</surname> <given-names>PJ</given-names></name>, <name name-style="western"><surname>Eisen</surname> <given-names>MB</given-names></name>, <name name-style="western"><surname>Stamatoyannopoulos</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Biggin</surname> <given-names>MD</given-names></name>. <article-title>The role of chromatin accessibility in directing the widespread, overlapping patterns of Drosophila transcription factor binding</article-title>. <source>Genome biology</source>. <year>2011</year>;<volume>12</volume>(<issue>4</issue>):<fpage>R34</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/gb-2011-12-4-r34" xlink:type="simple">10.1186/gb-2011-12-4-r34</ext-link></comment> <object-id pub-id-type="pmid">21473766</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kaplan</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>XY</given-names></name>, <name name-style="western"><surname>Sabo</surname> <given-names>PJ</given-names></name>, <name name-style="western"><surname>Thomas</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Stamatoyannopoulos</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Biggin</surname> <given-names>MD</given-names></name>, <etal>et al</etal>. <article-title>Quantitative models of the mechanisms that control genome-wide patterns of transcription factor binding during early Drosophila development</article-title>. <source>PLoS genetics</source>. <year>2011</year>;<volume>7</volume>(<issue>2</issue>):<fpage>e1001290</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pgen.1001290" xlink:type="simple">10.1371/journal.pgen.1001290</ext-link></comment> <object-id pub-id-type="pmid">21304941</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>John</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Sabo</surname> <given-names>PJ</given-names></name>, <name name-style="western"><surname>Thurman</surname> <given-names>RE</given-names></name>, <name name-style="western"><surname>Sung</surname> <given-names>MH</given-names></name>, <name name-style="western"><surname>Biddie</surname> <given-names>SC</given-names></name>, <name name-style="western"><surname>Johnson</surname> <given-names>TA</given-names></name>, <etal>et al</etal>. <article-title>Chromatin accessibility pre-determines glucocorticoid receptor binding patterns</article-title>. <source>Nature genetics</source>. <year>2011</year>;<volume>43</volume>(<issue>3</issue>):<fpage>264</fpage>–<lpage>268</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ng.759" xlink:type="simple">10.1038/ng.759</ext-link></comment> <object-id pub-id-type="pmid">21258342</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Guertin</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Martins</surname> <given-names>AL</given-names></name>, <name name-style="western"><surname>Siepel</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Lis</surname> <given-names>JT</given-names></name>. <article-title>Accurate prediction of inducible transcription factor binding intensities in vivo</article-title>. <source>PLoS genetics</source>. <year>2012</year>;<volume>8</volume>(<issue>3</issue>):<fpage>e1002610</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pgen.1002610" xlink:type="simple">10.1371/journal.pgen.1002610</ext-link></comment> <object-id pub-id-type="pmid">22479205</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Roider</surname> <given-names>HG</given-names></name>, <name name-style="western"><surname>Kanhere</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Manke</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Vingron</surname> <given-names>M</given-names></name>. <article-title>Predicting transcription factor affinities to DNA from a biophysical model</article-title>. <source>Bioinformatics</source>. <year>2006</year>;<volume>23</volume>(<issue>2</issue>):<fpage>134</fpage>–<lpage>141</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btl565" xlink:type="simple">10.1093/bioinformatics/btl565</ext-link></comment> <object-id pub-id-type="pmid">17098775</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cheng</surname> <given-names>Q</given-names></name>, <name name-style="western"><surname>Kazemian</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Pham</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Blatti</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Celniker</surname> <given-names>SE</given-names></name>, <name name-style="western"><surname>Wolfe</surname> <given-names>SA</given-names></name>, <etal>et al</etal>. <article-title>Computational identification of diverse mechanisms underlying transcription factor-DNA occupancy</article-title>. <source>PLoS genetics</source>. <year>2013</year>;<volume>9</volume>(<issue>8</issue>):<fpage>e1003571</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pgen.1003571" xlink:type="simple">10.1371/journal.pgen.1003571</ext-link></comment> <object-id pub-id-type="pmid">23935523</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>He</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>CC</given-names></name>, <name name-style="western"><surname>Hong</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Fang</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Sinha</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Ng</surname> <given-names>HH</given-names></name>, <etal>et al</etal>. <article-title>A biophysical model for analysis of transcription factor interaction and binding site arrangement from genome-wide binding data</article-title>. <source>PloS One</source>. <year>2009</year>;<volume>4</volume>(<issue>12</issue>):<fpage>e8155</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0008155" xlink:type="simple">10.1371/journal.pone.0008155</ext-link></comment> <object-id pub-id-type="pmid">19956545</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bailey</surname> <given-names>TL</given-names></name>, <name name-style="western"><surname>Boden</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Buske</surname> <given-names>FA</given-names></name>, <name name-style="western"><surname>Frith</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Grant</surname> <given-names>CE</given-names></name>, <name name-style="western"><surname>Clementi</surname> <given-names>L</given-names></name>, <etal>et al</etal>. <article-title>MEME SUITE: tools for motif discovery and searching</article-title>. <source>Nucleic acids research</source>. <year>2009</year>;<volume>37</volume>(<issue>suppl_2</issue>):<fpage>W202</fpage>–<lpage>W208</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gkp335" xlink:type="simple">10.1093/nar/gkp335</ext-link></comment> <object-id pub-id-type="pmid">19458158</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wang</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Zhuang</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Iyer</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Lin</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Whitfield</surname> <given-names>TW</given-names></name>, <name name-style="western"><surname>Greven</surname> <given-names>MC</given-names></name>, <etal>et al</etal>. <article-title>Sequence features and chromatin structure around the genomic regions bound by 119 human transcription factors</article-title>. <source>Genome research</source>. <year>2012</year>;<volume>22</volume>(<issue>9</issue>):<fpage>1798</fpage>–<lpage>1812</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1101/gr.139105.112" xlink:type="simple">10.1101/gr.139105.112</ext-link></comment> <object-id pub-id-type="pmid">22955990</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Starick</surname> <given-names>SR</given-names></name>, <name name-style="western"><surname>Ibn-Salem</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Jurk</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Hernandez</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Love</surname> <given-names>MI</given-names></name>, <name name-style="western"><surname>Chung</surname> <given-names>HR</given-names></name>, <etal>et al</etal>. <article-title>ChIP-exo signal associated with DNA-binding motifs provides insight into the genomic binding of the glucocorticoid receptor and cooperating transcription factors</article-title>. <source>Genome Research</source>. <year>2015</year>;<volume>25</volume>(<issue>6</issue>):<fpage>825</fpage>–<lpage>835</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1101/gr.185157.114" xlink:type="simple">10.1101/gr.185157.114</ext-link></comment> <object-id pub-id-type="pmid">25720775</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Stormo</surname> <given-names>GD</given-names></name>. <article-title>DNA binding sites: representation and discovery</article-title>. <source>Bioinformatics</source>. <year>2000</year>;<volume>16</volume>(<issue>1</issue>):<fpage>16</fpage>–<lpage>23</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/16.1.16" xlink:type="simple">10.1093/bioinformatics/16.1.16</ext-link></comment> <object-id pub-id-type="pmid">10812473</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zhao</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Stormo</surname> <given-names>GD</given-names></name>. <article-title>Quantitative analysis demonstrates most transcription factors require only simple models of specificity</article-title>. <source>Nature biotechnology</source>. <year>2011</year>;<volume>29</volume>(<issue>6</issue>):<fpage>480</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nbt.1893" xlink:type="simple">10.1038/nbt.1893</ext-link></comment> <object-id pub-id-type="pmid">21654662</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ruan</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Stormo</surname> <given-names>GD</given-names></name>. <article-title>Inherent limitations of probabilistic models for protein-DNA binding specificity</article-title>. <source>PLoS computational biology</source>. <year>2017</year>;<volume>13</volume>(<issue>7</issue>):<fpage>e1005638</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1005638" xlink:type="simple">10.1371/journal.pcbi.1005638</ext-link></comment> <object-id pub-id-type="pmid">28686588</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kharchenko</surname> <given-names>PV</given-names></name>, <name name-style="western"><surname>Tolstorukov</surname> <given-names>MY</given-names></name>, <name name-style="western"><surname>Park</surname> <given-names>PJ</given-names></name>. <article-title>Design and analysis of ChIP-seq experiments for DNA-binding proteins</article-title>. <source>Nature biotechnology</source>. <year>2008</year>;<volume>26</volume>(<issue>12</issue>):<fpage>1351</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nbt.1508" xlink:type="simple">10.1038/nbt.1508</ext-link></comment> <object-id pub-id-type="pmid">19029915</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Park</surname> <given-names>PJ</given-names></name>. <article-title>ChIP–seq: advantages and challenges of a maturing technology</article-title>. <source>Nature Reviews Genetics</source>. <year>2009</year>;<volume>10</volume>(<issue>10</issue>):<fpage>669</fpage>–<lpage>680</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nrg2641" xlink:type="simple">10.1038/nrg2641</ext-link></comment> <object-id pub-id-type="pmid">19736561</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Park</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Bhupindersingh</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Iyer</surname> <given-names>VR</given-names></name>. <article-title>Widespread misinterpretable ChIP-seq bias in yeast</article-title>. <source>PLoS One</source>. <year>2013</year>;<volume>8</volume>(<issue>12</issue>):<fpage>e83506</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0083506" xlink:type="simple">10.1371/journal.pone.0083506</ext-link></comment> <object-id pub-id-type="pmid">24349523</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kazemian</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Pham</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Wolfe</surname> <given-names>SA</given-names></name>, <name name-style="western"><surname>Brodsky</surname> <given-names>MH</given-names></name>, <name name-style="western"><surname>Sinha</surname> <given-names>S</given-names></name>. <article-title>Widespread evidence of cooperative DNA binding by transcription factors in Drosophila development</article-title>. <source>Nucleic Acids Research</source>. <year>2013</year>;<volume>41</volume>(<issue>17</issue>):<fpage>8237</fpage>–<lpage>8252</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gkt598" xlink:type="simple">10.1093/nar/gkt598</ext-link></comment> <object-id pub-id-type="pmid">23847101</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Jain</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Baldi</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Zabel</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Straub</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Becker</surname> <given-names>PB</given-names></name>. <article-title>Active promoters give rise to false positive ‘Phantom Peaks’ in ChIP-seq experiments</article-title>. <source>Nucleic acids research</source>. <year>2015</year>;<volume>43</volume>(<issue>14</issue>):<fpage>6959</fpage>–<lpage>6968</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gkv637" xlink:type="simple">10.1093/nar/gkv637</ext-link></comment> <object-id pub-id-type="pmid">26117547</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Benita</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Oosting</surname> <given-names>RS</given-names></name>, <name name-style="western"><surname>Lok</surname> <given-names>MC</given-names></name>, <name name-style="western"><surname>Wise</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Humphery‐Smith</surname> <given-names>I</given-names></name>. <article-title>Regionalized GC content of template DNA as a predictor of PCR success</article-title>. <source>Nucleic Acids Research</source>. <year>2003</year>;<volume>31</volume>(<issue>16</issue>):<fpage>e99</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gng101" xlink:type="simple">10.1093/nar/gng101</ext-link></comment> <object-id pub-id-type="pmid">12907751</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Aird</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Ross</surname> <given-names>MG</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>WS</given-names></name>, <name name-style="western"><surname>Danielsson</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Fennell</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Russ</surname> <given-names>C</given-names></name>, <etal>et al</etal>. <article-title>Analyzing and minimizing PCR amplification bias in Illumina sequencing libraries</article-title>. <source>Genome biology</source>. <year>2011</year>;<volume>12</volume>(<issue>2</issue>):<fpage>R18</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/gb-2011-12-2-r18" xlink:type="simple">10.1186/gb-2011-12-2-r18</ext-link></comment> <object-id pub-id-type="pmid">21338519</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Best</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Oakes</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Heather</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Shawe-Taylor</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Chain</surname> <given-names>B</given-names></name>. <article-title>Computational analysis of stochastic heterogeneity in PCR amplification efficiency revealed by single molecule barcoding</article-title>. <source>Scientific Reports</source>. <year>2015</year>;<volume>5</volume>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/srep14629" xlink:type="simple">10.1038/srep14629</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Landt</surname> <given-names>SG</given-names></name>, <name name-style="western"><surname>Marinov</surname> <given-names>GK</given-names></name>, <name name-style="western"><surname>Kundaje</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Kheradpour</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Pauli</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Batzoglou</surname> <given-names>S</given-names></name>, <etal>et al</etal>. <article-title>ChIP-seq guidelines and practices of the ENCODE and modENCODE consortia</article-title>. <source>Genome Research</source>. <year>2012</year>;<volume>22</volume>(<issue>9</issue>):<fpage>1813</fpage>–<lpage>1831</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1101/gr.136184.111" xlink:type="simple">10.1101/gr.136184.111</ext-link></comment> <object-id pub-id-type="pmid">22955991</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zhang</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Liu</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Meyer</surname> <given-names>CA</given-names></name>, <name name-style="western"><surname>Eeckhoute</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Johnson</surname> <given-names>DS</given-names></name>, <name name-style="western"><surname>Bernstein</surname> <given-names>BE</given-names></name>, <etal>et al</etal>. <article-title>Model-based analysis of ChIP-Seq (MACS)</article-title>. <source>Genome biology</source>. <year>2008</year>;<volume>9</volume>(<issue>9</issue>):<fpage>R137</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/gb-2008-9-9-r137" xlink:type="simple">10.1186/gb-2008-9-9-r137</ext-link></comment> <object-id pub-id-type="pmid">18798982</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rozowsky</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Euskirchen</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Auerbach</surname> <given-names>RK</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>ZD</given-names></name>, <name name-style="western"><surname>Gibson</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Bjornson</surname> <given-names>R</given-names></name>, <etal>et al</etal>. <article-title>PeakSeq enables systematic scoring of ChIP-seq experiments relative to controls</article-title>. <source>Nature biotechnology</source>. <year>2009</year>;<volume>27</volume>(<issue>1</issue>):<fpage>66</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nbt.1518" xlink:type="simple">10.1038/nbt.1518</ext-link></comment> <object-id pub-id-type="pmid">19122651</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bao</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Vinciotti</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Wit</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>’t Hoen</surname> <given-names>PA</given-names></name>. <article-title>Joint modeling of ChIP-seq data via a Markov random field model</article-title>. <source>Biostatistics</source>. <year>2013</year>;<volume>15</volume>(<issue>2</issue>):<fpage>296</fpage>–<lpage>310</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/biostatistics/kxt047" xlink:type="simple">10.1093/biostatistics/kxt047</ext-link></comment> <object-id pub-id-type="pmid">24178187</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gerland</surname> <given-names>U</given-names></name>, <name name-style="western"><surname>Moroz</surname> <given-names>JD</given-names></name>, <name name-style="western"><surname>Hwa</surname> <given-names>T</given-names></name>. <article-title>Physical constraints and functional characteristics of transcription factor–DNA interaction</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2002</year>;<volume>99</volume>(<issue>19</issue>):<fpage>12015</fpage>–<lpage>12020</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.192693599" xlink:type="simple">10.1073/pnas.192693599</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lalam</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Jacob</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Jagers</surname> <given-names>P</given-names></name>. <article-title>Modelling the PCR amplification process by a size-dependent branching process and estimation of the efficiency</article-title>. <source>Advances in Applied probability</source>. <year>2004</year>;<volume>36</volume>(<issue>2</issue>):<fpage>602</fpage>–<lpage>615</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1239/aap/1086957587" xlink:type="simple">10.1239/aap/1086957587</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zhao</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Granas</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Stormo</surname> <given-names>GD</given-names></name>. <article-title>Inferring binding energies from selected binding sites</article-title>. <source>PLoS computational biology</source>. <year>2009</year>;<volume>5</volume>(<issue>12</issue>):<fpage>e1000590</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1000590" xlink:type="simple">10.1371/journal.pcbi.1000590</ext-link></comment> <object-id pub-id-type="pmid">19997485</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Spivak</surname> <given-names>AT</given-names></name>, <name name-style="western"><surname>Stormo</surname> <given-names>GD</given-names></name>. <article-title>ScerTF: a comprehensive database of benchmarked position weight matrices for Saccharomyces species</article-title>. <source>Nucleic acids research</source>. <year>2011</year>;<volume>40</volume>(<issue>D1</issue>):<fpage>D162</fpage>–<lpage>D168</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gkr1180" xlink:type="simple">10.1093/nar/gkr1180</ext-link></comment> <object-id pub-id-type="pmid">22140105</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Matys</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Kel-Margoulis</surname> <given-names>OV</given-names></name>, <name name-style="western"><surname>Fricke</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Liebich</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Land</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Barre-Dirrie</surname> <given-names>A</given-names></name>, <etal>et al</etal>. <article-title>TRANSFAC<sup>®</sup> and its module TRANSCompel<sup>®</sup>: transcriptional gene regulation in eukaryotes</article-title>. <source>Nucleic acids research</source>. <year>2006</year>;<volume>34</volume>(<issue>suppl_1</issue>):<fpage>D108</fpage>–<lpage>D110</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gkj143" xlink:type="simple">10.1093/nar/gkj143</ext-link></comment> <object-id pub-id-type="pmid">16381825</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zaret</surname> <given-names>KS</given-names></name>, <name name-style="western"><surname>Carroll</surname> <given-names>JS</given-names></name>. <article-title>Pioneer transcription factors: establishing competence for gene expression</article-title>. <source>Genes &amp; development</source>. <year>2011</year>;<volume>25</volume>(<issue>21</issue>):<fpage>2227</fpage>–<lpage>2241</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1101/gad.176826.111" xlink:type="simple">10.1101/gad.176826.111</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref033">
<label>33</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Casella</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Berger</surname> <given-names>RL</given-names></name>. <source>Statistical inference</source>. <volume>vol. 2</volume>. <publisher-name>Duxbury Pacific Grove</publisher-name>, <publisher-loc>CA</publisher-loc>; <year>2002</year>.</mixed-citation>
</ref>
<ref id="pcbi.1006921.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rawal</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Chereji</surname> <given-names>RV</given-names></name>, <name name-style="western"><surname>Valabhoju</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Qiu</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Ocampo</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Clark</surname> <given-names>DJ</given-names></name>, <etal>et al</etal>. <article-title>Gcn4 Binding in Coding Regions Can Activate Internal and Canonical 5’ Promoters in Yeast</article-title>. <source>Molecular cell</source>. <year>2018</year>;<volume>70</volume>(<issue>2</issue>):<fpage>297</fpage>–<lpage>311</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.molcel.2018.03.007" xlink:type="simple">10.1016/j.molcel.2018.03.007</ext-link></comment> <object-id pub-id-type="pmid">29628310</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Robinson</surname> <given-names>JT</given-names></name>, <name name-style="western"><surname>Thorvaldsdóttir</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Winckler</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Guttman</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Lander</surname> <given-names>ES</given-names></name>, <name name-style="western"><surname>Getz</surname> <given-names>G</given-names></name>, <etal>et al</etal>. <article-title>Integrative genomics viewer</article-title>. <source>Nature biotechnology</source>. <year>2011</year>;<volume>29</volume>(<issue>1</issue>):<fpage>24</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nbt.1754" xlink:type="simple">10.1038/nbt.1754</ext-link></comment> <object-id pub-id-type="pmid">21221095</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Engel</surname> <given-names>SR</given-names></name>, <name name-style="western"><surname>Dietrich</surname> <given-names>FS</given-names></name>, <name name-style="western"><surname>Fisk</surname> <given-names>DG</given-names></name>, <name name-style="western"><surname>Binkley</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Balakrishnan</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Costanzo</surname> <given-names>MC</given-names></name>, <etal>et al</etal>. <article-title>The reference genome sequence of Saccharomyces cerevisiae: then and now</article-title>. <source>G3: Genes, Genomes, Genetics</source>. <year>2014</year>;<volume>4</volume>(<issue>3</issue>):<fpage>389</fpage>–<lpage>398</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1534/g3.113.008995" xlink:type="simple">10.1534/g3.113.008995</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref037">
<label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cherry</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Hong</surname> <given-names>EL</given-names></name>, <name name-style="western"><surname>Amundsen</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Balakrishnan</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Binkley</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Chan</surname> <given-names>ET</given-names></name>, <etal>et al</etal>. <article-title>Saccharomyces Genome Database: the genomics resource of budding yeast</article-title>. <source>Nucleic Acids Research</source>. <year>2011</year>; p. gkr1029.</mixed-citation>
</ref>
<ref id="pcbi.1006921.ref038">
<label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Li</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Durbin</surname> <given-names>R</given-names></name>. <article-title>Fast and accurate long-read alignment with Burrows–Wheeler transform</article-title>. <source>Bioinformatics</source>. <year>2010</year>;<volume>26</volume>(<issue>5</issue>):<fpage>589</fpage>–<lpage>595</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btp698" xlink:type="simple">10.1093/bioinformatics/btp698</ext-link></comment> <object-id pub-id-type="pmid">20080505</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref039">
<label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kasinathan</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Orsi</surname> <given-names>GA</given-names></name>, <name name-style="western"><surname>Zentner</surname> <given-names>GE</given-names></name>, <name name-style="western"><surname>Ahmad</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Henikoff</surname> <given-names>S</given-names></name>. <article-title>High-resolution mapping of transcription factor binding sites on native chromatin</article-title>. <source>Nature methods</source>. <year>2014</year>;<volume>11</volume>(<issue>2</issue>):<fpage>203</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nmeth.2766" xlink:type="simple">10.1038/nmeth.2766</ext-link></comment> <object-id pub-id-type="pmid">24336359</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref040">
<label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zentner</surname> <given-names>GE</given-names></name>, <name name-style="western"><surname>Kasinathan</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Xin</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Rohs</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Henikoff</surname> <given-names>S</given-names></name>. <article-title>ChEC-seq kinetics discriminates transcription factor binding sites by DNA sequence and shape in vivo</article-title>. <source>Nature communications</source>. <year>2015</year>;<volume>6</volume>:<fpage>8733</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ncomms9733" xlink:type="simple">10.1038/ncomms9733</ext-link></comment> <object-id pub-id-type="pmid">26490019</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref041">
<label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Skene</surname> <given-names>PJ</given-names></name>, <name name-style="western"><surname>Henikoff</surname> <given-names>S</given-names></name>. <article-title>An efficient targeted nuclease strategy for high-resolution mapping of DNA binding sites</article-title>. <source>Elife</source>. <year>2017</year>;<volume>6</volume>:<fpage>e21856</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.7554/eLife.21856" xlink:type="simple">10.7554/eLife.21856</ext-link></comment> <object-id pub-id-type="pmid">28079019</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref042">
<label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sundaram</surname> <given-names>AY</given-names></name>, <name name-style="western"><surname>Hughes</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Biondi</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Bolduc</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Bowman</surname> <given-names>SK</given-names></name>, <name name-style="western"><surname>Camilli</surname> <given-names>A</given-names></name>, <etal>et al</etal>. <article-title>A comparative study of ChIP-seq sequencing library preparation methods</article-title>. <source>BMC genomics</source>. <year>2016</year>;<volume>17</volume>(<issue>1</issue>):<fpage>816</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/s12864-016-3135-y" xlink:type="simple">10.1186/s12864-016-3135-y</ext-link></comment> <object-id pub-id-type="pmid">27769162</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref043">
<label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Padinhateeri</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Marko</surname> <given-names>JF</given-names></name>. <article-title>Nucleosome positioning in a model of active chromatin remodeling enzymes</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2011</year>;. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1015206108" xlink:type="simple">10.1073/pnas.1015206108</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref044">
<label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Parmar</surname> <given-names>JJ</given-names></name>, <name name-style="western"><surname>Marko</surname> <given-names>JF</given-names></name>, <name name-style="western"><surname>Padinhateeri</surname> <given-names>R</given-names></name>. <article-title>Nucleosome positioning and kinetics near transcription-start-site barriers are controlled by interplay between active remodeling and DNA sequence</article-title>. <source>Nucleic acids research</source>. <year>2013</year>;<volume>42</volume>(<issue>1</issue>):<fpage>128</fpage>–<lpage>136</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gkt854" xlink:type="simple">10.1093/nar/gkt854</ext-link></comment> <object-id pub-id-type="pmid">24068556</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref045">
<label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Osberg</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Nuebler</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Gerland</surname> <given-names>U</given-names></name>. <article-title>Adsorption-desorption kinetics of soft particles</article-title>. <source>Physical review letters</source>. <year>2015</year>;<volume>115</volume>(<issue>8</issue>):<fpage>088301</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1103/PhysRevLett.115.088301" xlink:type="simple">10.1103/PhysRevLett.115.088301</ext-link></comment> <object-id pub-id-type="pmid">26340214</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref046">
<label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Chereji</surname> <given-names>RV</given-names></name>, <name name-style="western"><surname>Clark</surname> <given-names>DJ</given-names></name>. <article-title>Major determinants of nucleosome positioning</article-title>. <source>Biophysical journal</source>. <year>2018</year>;. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.bpj.2018.03.015" xlink:type="simple">10.1016/j.bpj.2018.03.015</ext-link></comment> <object-id pub-id-type="pmid">29628211</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref047">
<label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Flensburg</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Kinkel</surname> <given-names>SA</given-names></name>, <name name-style="western"><surname>Keniry</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Blewitt</surname> <given-names>ME</given-names></name>, <name name-style="western"><surname>Oshlack</surname> <given-names>A</given-names></name>. <article-title>A comparison of control samples for ChIP-seq of histone modifications</article-title>. <source>Frontiers in genetics</source>. <year>2014</year>;<volume>5</volume>:<fpage>329</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3389/fgene.2014.00329" xlink:type="simple">10.3389/fgene.2014.00329</ext-link></comment> <object-id pub-id-type="pmid">25309581</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref048">
<label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Nakato</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Shirahige</surname> <given-names>K</given-names></name>. <article-title>Recent advances in ChIP-seq analysis: from quality management to whole-genome annotation</article-title>. <source>Briefings in bioinformatics</source>. <year>2016</year>;<volume>18</volume>(<issue>2</issue>):<fpage>279</fpage>–<lpage>290</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006921.ref049">
<label>49</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bailey</surname> <given-names>TL</given-names></name>, <name name-style="western"><surname>Machanick</surname> <given-names>P</given-names></name>. <article-title>Inferring direct DNA binding from ChIP-seq</article-title>. <source>Nucleic acids research</source>. <year>2012</year>; p. gks433. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gks433" xlink:type="simple">10.1093/nar/gks433</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref050">
<label>50</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zeng</surname> <given-names>PY</given-names></name>, <name name-style="western"><surname>Vakoc</surname> <given-names>CR</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>ZC</given-names></name>, <name name-style="western"><surname>Blobel</surname> <given-names>GA</given-names></name>, <name name-style="western"><surname>Berger</surname> <given-names>SL</given-names></name>. <article-title>In vivo dual cross-linking for identification of indirect DNA-associated proteins by chromatin immunoprecipitation</article-title>. <source>Biotechniques</source>. <year>2006</year>;<volume>41</volume>(<issue>6</issue>):<fpage>694</fpage>–<lpage>698</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.2144/000112297" xlink:type="simple">10.2144/000112297</ext-link></comment> <object-id pub-id-type="pmid">17191611</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref051">
<label>51</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rhee</surname> <given-names>HS</given-names></name>, <name name-style="western"><surname>Pugh</surname> <given-names>BF</given-names></name>. <article-title>Comprehensive genome-wide protein-DNA interactions detected at single-nucleotide resolution</article-title>. <source>Cell</source>. <year>2011</year>;<volume>147</volume>(<issue>6</issue>):<fpage>1408</fpage>–<lpage>1419</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cell.2011.11.013" xlink:type="simple">10.1016/j.cell.2011.11.013</ext-link></comment> <object-id pub-id-type="pmid">22153082</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref052">
<label>52</label>
<mixed-citation publication-type="other" xlink:type="simple">Yamada N, Lai WK, Farrell N, Pugh BF, Mahony S. Characterizing protein-DNA binding event subtypes in ChIP-exo data. bioRxiv. 2018; p. 266536.</mixed-citation>
</ref>
<ref id="pcbi.1006921.ref053">
<label>53</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kinney</surname> <given-names>JB</given-names></name>, <name name-style="western"><surname>Tkačik</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Callan</surname> <given-names>CG</given-names></name>. <article-title>Precise physical models of protein–DNA interaction from high-throughput data</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2007</year>;<volume>104</volume>(<issue>2</issue>):<fpage>501</fpage>–<lpage>506</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.0609908104" xlink:type="simple">10.1073/pnas.0609908104</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref054">
<label>54</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Berg</surname> <given-names>OG</given-names></name>, <name name-style="western"><surname>von Hippel</surname> <given-names>PH</given-names></name>. <article-title>Selection of DNA binding sites by regulatory proteins: Statistical-mechanical theory and application to operators and promoters</article-title>. <source>Journal of molecular biology</source>. <year>1987</year>;<volume>193</volume>(<issue>4</issue>):<fpage>723</fpage>–<lpage>743</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/0022-2836(87)90354-8" xlink:type="simple">10.1016/0022-2836(87)90354-8</ext-link></comment> <object-id pub-id-type="pmid">3612791</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref055">
<label>55</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Maerkl</surname> <given-names>SJ</given-names></name>, <name name-style="western"><surname>Quake</surname> <given-names>SR</given-names></name>. <article-title>A systems approach to measuring the binding energy landscapes of transcription factors</article-title>. <source>Science</source>. <year>2007</year>;<volume>315</volume>(<issue>5809</issue>):<fpage>233</fpage>–<lpage>237</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.1131007" xlink:type="simple">10.1126/science.1131007</ext-link></comment> <object-id pub-id-type="pmid">17218526</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref056">
<label>56</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ma</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Ezer</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Navarro</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Adryan</surname> <given-names>B</given-names></name>. <article-title>Reliable scaling of position weight matrices for binding strength comparisons between transcription factors</article-title>. <source>BMC bioinformatics</source>. <year>2015</year>;<volume>16</volume>(<issue>1</issue>):<fpage>265</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/s12859-015-0666-1" xlink:type="simple">10.1186/s12859-015-0666-1</ext-link></comment> <object-id pub-id-type="pmid">26289072</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref057">
<label>57</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kivioja</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Vähärautio</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Karlsson</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Bonke</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Enge</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Linnarsson</surname> <given-names>S</given-names></name>, <etal>et al</etal>. <article-title>Counting absolute numbers of molecules using unique molecular identifiers</article-title>. <source>Nature methods</source>. <year>2012</year>;<volume>9</volume>(<issue>1</issue>):<fpage>72</fpage>–<lpage>74</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nmeth.1778" xlink:type="simple">10.1038/nmeth.1778</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref058">
<label>58</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Islam</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Zeisel</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Joost</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>La Manno</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Zajac</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Kasper</surname> <given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Quantitative single-cell RNA-seq with unique molecular identifiers</article-title>. <source>Nature methods</source>. <year>2014</year>;<volume>11</volume>(<issue>2</issue>):<fpage>163</fpage>–<lpage>166</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nmeth.2772" xlink:type="simple">10.1038/nmeth.2772</ext-link></comment> <object-id pub-id-type="pmid">24363023</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref059">
<label>59</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>He</surname> <given-names>Q</given-names></name>, <name name-style="western"><surname>Johnston</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Zeitlinger</surname> <given-names>J</given-names></name>. <article-title>ChIP-nexus enables improved detection of in vivo transcription factor binding footprints</article-title>. <source>Nature Biotechnology</source>. <year>2015</year>;<volume>33</volume>(<issue>4</issue>):<fpage>395</fpage>–<lpage>401</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nbt.3121" xlink:type="simple">10.1038/nbt.3121</ext-link></comment> <object-id pub-id-type="pmid">25751057</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref060">
<label>60</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kuan</surname> <given-names>PF</given-names></name>, <name name-style="western"><surname>Chung</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Pan</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Thomson</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Stewart</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Keleş</surname> <given-names>S</given-names></name>. <article-title>A statistical framework for the analysis of ChIP-Seq data</article-title>. <source>Journal of the American Statistical Association</source>. <year>2011</year>;<volume>106</volume>(<issue>495</issue>):<fpage>891</fpage>–<lpage>903</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1198/jasa.2011.ap09706" xlink:type="simple">10.1198/jasa.2011.ap09706</ext-link></comment> <object-id pub-id-type="pmid">26478641</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref061">
<label>61</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Djordjevic</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Sengupta</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Shraiman</surname> <given-names>BI</given-names></name>. <article-title>A biophysical approach to transcription factor binding site discovery</article-title>. <source>Genome research</source>. <year>2003</year>;<volume>13</volume>(<issue>11</issue>):<fpage>2381</fpage>–<lpage>2390</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1101/gr.1271603" xlink:type="simple">10.1101/gr.1271603</ext-link></comment> <object-id pub-id-type="pmid">14597652</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref062">
<label>62</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Shea</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Ackers</surname> <given-names>GK</given-names></name>. <article-title>The OR control system of bacteriophage lambda: A physical-chemical model for gene regulation</article-title>. <source>Journal of molecular biology</source>. <year>1985</year>;<volume>181</volume>(<issue>2</issue>):<fpage>211</fpage>–<lpage>230</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/0022-2836(85)90086-5" xlink:type="simple">10.1016/0022-2836(85)90086-5</ext-link></comment> <object-id pub-id-type="pmid">3157005</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref063">
<label>63</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pique-Regi</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Degner</surname> <given-names>JF</given-names></name>, <name name-style="western"><surname>Pai</surname> <given-names>AA</given-names></name>, <name name-style="western"><surname>Gaffney</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>Gilad</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Pritchard</surname> <given-names>JK</given-names></name>. <article-title>Accurate inference of transcription factor binding from DNA sequence and chromatin accessibility data</article-title>. <source>Genome research</source>. <year>2010</year>; p. <fpage>gr–112623</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006921.ref064">
<label>64</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Consortium</surname> <given-names>EP</given-names></name>, <etal>et al</etal>. <article-title>An integrated encyclopedia of DNA elements in the human genome</article-title>. <source>Nature</source>. <year>2012</year>;<volume>489</volume>(<issue>7414</issue>):<fpage>57</fpage>–<lpage>74</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature11247" xlink:type="simple">10.1038/nature11247</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref065">
<label>65</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sloan</surname> <given-names>CA</given-names></name>, <name name-style="western"><surname>Chan</surname> <given-names>ET</given-names></name>, <name name-style="western"><surname>Davidson</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Malladi</surname> <given-names>VS</given-names></name>, <name name-style="western"><surname>Strattan</surname> <given-names>JS</given-names></name>, <name name-style="western"><surname>Hitz</surname> <given-names>BC</given-names></name>, <etal>et al</etal>. <article-title>ENCODE data at the ENCODE portal</article-title>. <source>Nucleic acids research</source>. <year>2015</year>;<volume>44</volume>(<issue>D1</issue>):<fpage>D726</fpage>–<lpage>D732</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gkv1160" xlink:type="simple">10.1093/nar/gkv1160</ext-link></comment> <object-id pub-id-type="pmid">26527727</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref066">
<label>66</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Teytelman</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Özaydın</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Zill</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Lefrançois</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Snyder</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Rine</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Impact of chromatin structures on DNA processing for genomic analyses</article-title>. <source>PloS one</source>. <year>2009</year>;<volume>4</volume>(<issue>8</issue>):<fpage>e6700</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0006700" xlink:type="simple">10.1371/journal.pone.0006700</ext-link></comment> <object-id pub-id-type="pmid">19693276</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref067">
<label>67</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Teytelman</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Thurtle</surname> <given-names>DM</given-names></name>, <name name-style="western"><surname>Rine</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>van Oudenaarden</surname> <given-names>A</given-names></name>. <article-title>Highly expressed loci are vulnerable to misleading ChIP localization of multiple unrelated proteins</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2013</year>;<volume>110</volume>(<issue>46</issue>):<fpage>18602</fpage>–<lpage>18607</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1316064110" xlink:type="simple">10.1073/pnas.1316064110</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref068">
<label>68</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Waldminghaus</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Skarstad</surname> <given-names>K</given-names></name>. <article-title>ChIP on Chip: surprising results are often artifacts</article-title>. <source>BMC genomics</source>. <year>2010</year>;<volume>11</volume>(<issue>1</issue>):<fpage>414</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/1471-2164-11-414" xlink:type="simple">10.1186/1471-2164-11-414</ext-link></comment> <object-id pub-id-type="pmid">20602746</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref069">
<label>69</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kebschull</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Zador</surname> <given-names>AM</given-names></name>. <article-title>Sources of PCR-induced distortions in high-throughput sequencing data sets</article-title>. <source>Nucleic Acids Research</source>. <year>2015</year>;<volume>43</volume>(<issue>21</issue>):<fpage>e143</fpage>–<lpage>e143</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gkv717" xlink:type="simple">10.1093/nar/gkv717</ext-link></comment> <object-id pub-id-type="pmid">26187991</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref070">
<label>70</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Harris</surname> <given-names>TE</given-names></name>. <source>The theory of branching processes</source>. <publisher-name>Courier Corporation</publisher-name>; <year>2002</year>.</mixed-citation>
</ref>
<ref id="pcbi.1006921.ref071">
<label>71</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Gentle</surname> <given-names>JE</given-names></name>. <source>Random number generation and Monte Carlo methods</source>. <publisher-name>Springer Science &amp; Business Media</publisher-name>; <year>2006</year>.</mixed-citation>
</ref>
<ref id="pcbi.1006921.ref072">
<label>72</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Quinlan</surname> <given-names>AR</given-names></name>, <name name-style="western"><surname>Hall</surname> <given-names>IM</given-names></name>. <article-title>BEDTools: a flexible suite of utilities for comparing genomic features</article-title>. <source>Bioinformatics</source>. <year>2010</year>;<volume>26</volume>(<issue>6</issue>):<fpage>841</fpage>–<lpage>842</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btq033" xlink:type="simple">10.1093/bioinformatics/btq033</ext-link></comment> <object-id pub-id-type="pmid">20110278</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref073">
<label>73</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dale</surname> <given-names>RK</given-names></name>, <name name-style="western"><surname>Pedersen</surname> <given-names>BS</given-names></name>, <name name-style="western"><surname>Quinlan</surname> <given-names>AR</given-names></name>. <article-title>Pybedtools: a flexible Python library for manipulating genomic datasets and annotations</article-title>. <source>Bioinformatics</source>. <year>2011</year>;<volume>27</volume>(<issue>24</issue>):<fpage>3423</fpage>–<lpage>3424</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btr539" xlink:type="simple">10.1093/bioinformatics/btr539</ext-link></comment> <object-id pub-id-type="pmid">21949271</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref074">
<label>74</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cock</surname> <given-names>PJ</given-names></name>, <name name-style="western"><surname>Fields</surname> <given-names>CJ</given-names></name>, <name name-style="western"><surname>Goto</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Heuer</surname> <given-names>ML</given-names></name>, <name name-style="western"><surname>Rice</surname> <given-names>PM</given-names></name>. <article-title>The Sanger FASTQ file format for sequences with quality scores, and the Solexa/Illumina FASTQ variants</article-title>. <source>Nucleic acids research</source>. <year>2009</year>;<volume>38</volume>(<issue>6</issue>):<fpage>1767</fpage>–<lpage>1771</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gkp1137" xlink:type="simple">10.1093/nar/gkp1137</ext-link></comment> <object-id pub-id-type="pmid">20015970</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref075">
<label>75</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kulakovskiy</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Levitsky</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Oshchepkov</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Bryzgalov</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Vorontsov</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Makeev</surname> <given-names>V</given-names></name>. <article-title>From binding motifs in ChIP-Seq data to improved models of transcription factor binding sites</article-title>. <source>Journal of bioinformatics and computational biology</source>. <year>2013</year>;<volume>11</volume>(<issue>01</issue>):<fpage>1340004</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1142/S0219720013400040" xlink:type="simple">10.1142/S0219720013400040</ext-link></comment> <object-id pub-id-type="pmid">23427986</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006921.ref076">
<label>76</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Gelman</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Carlin</surname> <given-names>JB</given-names></name>, <name name-style="western"><surname>Stern</surname> <given-names>HS</given-names></name>, <name name-style="western"><surname>Rubin</surname> <given-names>DB</given-names></name>. <source>Bayesian data analysis</source>. <volume>vol. 2</volume>. <publisher-name>Chapman &amp; Hall/CRC</publisher-name> <publisher-loc>Boca Raton, FL, USA</publisher-loc>; <year>2014</year>.</mixed-citation>
</ref>
<ref id="pcbi.1006921.ref077">
<label>77</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Jones</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Oliphant</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Peterson</surname> <given-names>P</given-names></name>. <source>SciPy: open source scientific tools for Python</source>. <year>2014</year>.</mixed-citation>
</ref>
</ref-list>
</back>
</article>