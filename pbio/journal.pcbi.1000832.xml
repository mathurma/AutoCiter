<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN">
<front>
<journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher></journal-meta>
<article-meta><article-id pub-id-type="publisher-id">09-PLCB-RA-RD-1138R2</article-id><article-id pub-id-type="doi">10.1371/journal.pcbi.1000832</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline"><subject>Computational Biology/Sequence Motif Analysis</subject><subject>Molecular Biology/RNA-Protein Interactions</subject></subj-group></article-categories><title-group><article-title>RNAcontext: A New Method for Learning the Sequence and Structure Binding Preferences of RNA-Binding Proteins</article-title><alt-title alt-title-type="running-head">RNAcontext</alt-title></title-group><contrib-group>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Kazan</surname><given-names>Hilal</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Ray</surname><given-names>Debashish</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Chan</surname><given-names>Esther T.</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Hughes</surname><given-names>Timothy R.</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff3"><sup>3</sup></xref><xref ref-type="aff" rid="aff4"><sup>4</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Morris</surname><given-names>Quaid</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff3"><sup>3</sup></xref><xref ref-type="aff" rid="aff4"><sup>4</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
</contrib-group><aff id="aff1"><label>1</label><addr-line>Department of Computer Science, University of Toronto, Toronto, Ontario, Canada</addr-line>       </aff><aff id="aff2"><label>2</label><addr-line>Banting and Best Department of Medical Research, University of Toronto, Toronto, Ontario, Canada</addr-line>       </aff><aff id="aff3"><label>3</label><addr-line>Department of Molecular Genetics, University of Toronto, Toronto, Ontario, Canada</addr-line>       </aff><aff id="aff4"><label>4</label><addr-line>Donnelley Centre for Cellular and Biomolecular Research, University of Toronto, Toronto, Ontario, Canada</addr-line>       </aff><contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Sinha</surname><given-names>Saurabh</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group><aff id="edit1">University of Illinois Urbana-Champaign, United States of America</aff><author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">quaid.morris@utoronto.ca</email></corresp>
<fn fn-type="con"><p>Conceived and designed the experiments: HK TRH QM. Performed the experiments: HK ETC QM. Analyzed the data: HK ETC QM. Contributed reagents/materials/analysis tools: HK DR QM. Wrote the paper: HK QM.</p></fn>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn></author-notes><pub-date pub-type="collection"><month>7</month><year>2010</year></pub-date><pub-date pub-type="epub"><day>1</day><month>7</month><year>2010</year></pub-date><volume>6</volume><issue>7</issue><elocation-id>e1000832</elocation-id><history>
<date date-type="received"><day>23</day><month>9</month><year>2009</year></date>
<date date-type="accepted"><day>25</day><month>5</month><year>2010</year></date>
</history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2010</copyright-year><copyright-holder>Kazan et al</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract>
<p>Metazoan genomes encode hundreds of RNA-binding proteins (RBPs). These proteins regulate post-transcriptional gene expression and have critical roles in numerous cellular processes including mRNA splicing, export, stability and translation. Despite their ubiquity and importance, the binding preferences for most RBPs are not well characterized. <italic>In vitro</italic> and <italic>in vivo</italic> studies, using affinity selection-based approaches, have successfully identified RNA sequence associated with specific RBPs; however, it is difficult to infer RBP sequence and structural preferences without specifically designed motif finding methods. In this study, we introduce a new motif-finding method, RNAcontext, designed to elucidate RBP-specific sequence and structural preferences with greater accuracy than existing approaches. We evaluated RNAcontext on recently published <italic>in vitro</italic> and <italic>in vivo</italic> RNA affinity selected data and demonstrate that RNAcontext identifies known binding preferences for several control proteins including HuR, PTB, and Vts1p and predicts new RNA structure preferences for SF2/ASF, RBM4, FUSIP1 and SLM2. The predicted preferences for SF2/ASF are consistent with its recently reported <italic>in vivo</italic> binding sites. RNAcontext is an accurate and efficient motif finding method ideally suited for using large-scale RNA-binding affinity datasets to determine the relative binding preferences of RBPs for a wide range of RNA sequences and structures.</p>
</abstract><abstract abstract-type="summary"><title>Author Summary</title>
<p>Many disease-associated mutations do not change the protein sequence of genes; instead they change the instructions on how a gene's mRNA transcript should be processed. Translating these instructions allows us to better understand the connection between these mutations and disease. RNA-binding proteins (RBP) perform this translation by recognizing particular “phrases” that occupy short regions of the transcript. Recognition occurs by the binding of the RBP to the phrase. The set of phrases bound by a particular RBP is defined by the RNA base content of the binding site as well as the 3D configuration of these bases. Because it is impossible to assess RBP binding to every possible phrase, we have developed a mathematical model called RNAcontext that can be trained by measuring RBP binding strength on one set of phrases. Once trained, this model can then be used to accurately predict binding strength to any possible phrase. Compared to previously described methods, RNAcontext learns a more precise description of the 3D shapes of binding sites. This precision translates into more accurate generalization of RBP binding preferences to new phrases and allows us to make new discoveries about the binding preferences of well-studied RBPs.</p>
</abstract><funding-group><funding-statement>This work was funded by a Canadian Institutes of Health Research operating grant (MOP-93671) to Q.M. and T.R.H. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="10"/></counts></article-meta>
</front>
<body><sec id="s1">
<title>Introduction</title>
<p>RBPs act in the post-transcriptional regulation (PTR) of gene expression by binding to target RNAs to control splicing, stability, localization and translation. Recent draft networks of RBP-transcript physical interaction in yeast <xref ref-type="bibr" rid="pcbi.1000832-Hogan1">[1]</xref>, fruit flies <xref ref-type="bibr" rid="pcbi.1000832-Blanchette1">[2]</xref>, and humans <xref ref-type="bibr" rid="pcbi.1000832-Lukong1">[3]</xref> reveal a complex and combinatorial pattern of RBP targeting and supports an RNA regulon model <xref ref-type="bibr" rid="pcbi.1000832-Keene1">[4]</xref> in which <italic>cis</italic>-regulatory transcript sequence dictates the post-transcriptional fate of an mRNA at multiple, distinct stages of regulation. Deciphering this operon code as well as the role of individual RBPs in post-transcriptional regulation requires the detailed characterization of the binding preferences of RBPs.</p>
<p>We have recently introduced the <italic>RNAcompete</italic> assay <xref ref-type="bibr" rid="pcbi.1000832-Ray1">[5]</xref>, a microarray-based <italic>in vitro</italic> method to estimate the binding affinity of selected RBPs to a defined population of short RNA sequences. RNAcompete, along with <italic>in vivo</italic> methods such as RIP-seq <xref ref-type="bibr" rid="pcbi.1000832-Keene2">[6]</xref> and CLIP-seq <xref ref-type="bibr" rid="pcbi.1000832-Ule1">[7]</xref>, can be used to determine binding preferences of individual RBPs for a large number of RNA sequences. Motif representation generated from these data can be used to scan mRNA transcripts to identify potential RBP binding sites. However, this step can prove challenging because many RBPs show a preference for both specific sequences and secondary structure contexts in their binding sites <xref ref-type="bibr" rid="pcbi.1000832-Hackermuller1">[8]</xref>–<xref ref-type="bibr" rid="pcbi.1000832-Gao1">[12]</xref>.</p>
<p>Despite these structural preferences, motif finding algorithms that ignore RNA secondary structure work surprisingly well for some RBPs. This approach has been successful for both <italic>in vitro</italic> and <italic>in vivo</italic> binding data <xref ref-type="bibr" rid="pcbi.1000832-Hogan1">[1]</xref>, <xref ref-type="bibr" rid="pcbi.1000832-Blanchette1">[2]</xref>, <xref ref-type="bibr" rid="pcbi.1000832-Ray1">[5]</xref>, <xref ref-type="bibr" rid="pcbi.1000832-Sanford1">[13]</xref>, <xref ref-type="bibr" rid="pcbi.1000832-Foat1">[14]</xref>. For example, structure-naive motif finding applied to mRNAs targeted by yeast proteins Puf3p and Puf4p recover sequence preferences confirmed by crystal structures of the RBP-RNA complexes <xref ref-type="bibr" rid="pcbi.1000832-Wang1">[15]</xref>, <xref ref-type="bibr" rid="pcbi.1000832-Wang2">[16]</xref>; and motif models for YB-1, SF2 and PTB fit to <italic>in vitro</italic> binding data from the RNAcompete assay predict their <italic>in vivo</italic> targets with high accuracy <xref ref-type="bibr" rid="pcbi.1000832-Ray1">[5]</xref>.</p>
<p>However, this approach can give misleading results when an RBP has non-trivial structural preferences. For example, Vts1p is a yeast RBP that preferentially binds <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e001" xlink:type="simple"/></inline-formula> loop sequences within RNA hairpins <xref ref-type="bibr" rid="pcbi.1000832-Aviv1">[17]</xref>, however, this binding preference can be difficult to detect without consideration of this structural preference (e.g., <xref ref-type="bibr" rid="pcbi.1000832-Hogan1">[1]</xref>). RBP motif finding can made more reliable by training structure-naive algorithms only on RNA sequence likely to be in the preferred context <xref ref-type="bibr" rid="pcbi.1000832-Hiller1">[9]</xref>, <xref ref-type="bibr" rid="pcbi.1000832-Foat2">[18]</xref>. For example, Foat and Stormo <xref ref-type="bibr" rid="pcbi.1000832-Foat2">[18]</xref> could reliably extract the Vts1p sequence binding preferences from <italic>in vivo</italic> binding data by using only loop sequences (from likely hairpin loops) to train the MatrixREDUCE<xref ref-type="bibr" rid="pcbi.1000832-Foat3">[19]</xref> motif finding algorithm. Similarly, the MEMERIS <xref ref-type="bibr" rid="pcbi.1000832-Hiller1">[9]</xref> algorithm adapts the MEME <xref ref-type="bibr" rid="pcbi.1000832-Bailey1">[20]</xref> motif finding algorithm to search for RNA motifs enriched in single-stranded regions by assessing a prior on each word according to its structural accessibility. MEMERIS predicts binding sites more accurately than MEME for a number of proteins, including the mammalian stem-loop binding RBP U1A. However, applying this strategy only allows a single, pre-defined structural preference to be queried. Ideally, an RBP motif finding method should consider multiple possible structural contexts simultaneously, and detect the relative preferences of a particular RBP for each.</p>
<p>Covariance models (CMs) <xref ref-type="bibr" rid="pcbi.1000832-Eddy1">[21]</xref> are RNA motif models often used for modeling families of ncRNAs (e.g., <xref ref-type="bibr" rid="pcbi.1000832-GriffithsJones1">[22]</xref>) and have the capacity, in theory, to represent both the sequence and (arbitrary) structure preferences of RBPs. However, CMs have a reported tendency to overpredict secondary structure <xref ref-type="bibr" rid="pcbi.1000832-Eddy2">[23]</xref>. Indeed, recent CM-based motif models of Puf3p, Puf4p, and HuR <xref ref-type="bibr" rid="pcbi.1000832-Silanes1">[24]</xref>, <xref ref-type="bibr" rid="pcbi.1000832-Rabani1">[25]</xref> predict they preferentially bind RNA hairpins and contradict structural, <italic>in vitro</italic> and <italic>in vivo</italic> evidence <xref ref-type="bibr" rid="pcbi.1000832-Ray1">[5]</xref>, <xref ref-type="bibr" rid="pcbi.1000832-Gao1">[12]</xref>, <xref ref-type="bibr" rid="pcbi.1000832-Gerber1">[26]</xref>, <xref ref-type="bibr" rid="pcbi.1000832-Miller1">[27]</xref>, that they bind unstructured ssRNA.</p>
<p>We present a new strategy for modeling RBP binding sites that learns both the sequence and structure binding preferences of an RBPs. Our method assumes that the primary role of RNA secondary structure in RBP binding is to establish a structural context (e.g., loop or unstructured) for the RNA sequence recognized by the RBP. As such, we annotate each nucleotide in terms of its secondary structure context (e.g., paired, in a hairpin loop or bulge). Cognizant of the fact that a given RNA sequence can have multiple, distinct stable secondary structures, this annotation takes the form of a distribution over all its possible contexts. These distributions are estimated using computational models of RNA folding. Our new model can be discriminatively trained (as <xref ref-type="bibr" rid="pcbi.1000832-Foat3">[19]</xref>, <xref ref-type="bibr" rid="pcbi.1000832-Segal1">[28]</xref>, <xref ref-type="bibr" rid="pcbi.1000832-Sinha1">[29]</xref>) thus facilitating its use with either binding affinity data or sets of bound sequences.</p>
<p>We apply RNAcontext to several RNA-binding affinity datasets, demonstrating that it can infer the RBP structure and sequence-binding preferences with greater accuracy than other motif-finding methods. RNAcontext recovers previously reported sequence and structure binding preferences for well-charactered RBPs including Vts1p, HuR, and PTB and predicts new structure binding preferences for FUSIP1, SF2/ASF, SLM2, and RBM4.</p>
</sec><sec id="s2" sec-type="methods">
<title>Methods</title>
<p>We now present our approach for discovering RNA sequence and structure binding preferences of RBPs. This section is organized as follows: we first describe how we annotate an RNA sequence in terms of its structural context. Then, we discuss the details and the mathematical formulation of our motif model. Lastly, we describe our procedure for fitting the RNAcontext motif model. Because part of our model is derived from prior work on DNA motif finding, we summarize this work in <xref ref-type="supplementary-material" rid="pcbi.1000832.s001">Protocol S1</xref>. Source code in C++ for RNAcontext is available online at <ext-link ext-link-type="uri" xlink:href="http://morrislab.med.utoronto.ca/software" xlink:type="simple">http://morrislab.med.utoronto.ca/software</ext-link>.</p>
<sec id="s2a">
<title>Structural annotation of RNA sequences</title>
<p>We use computational algorithms to predict RNA secondary structures though our algorithm can use experimentally determined RNA secondary structures when they are available. Instead of focusing on the single minimum free energy structure which is often not representative of the full ensemble of possible structures <xref ref-type="bibr" rid="pcbi.1000832-Ding1">[30]</xref>, we consider the ensemble of secondary structures that the RNA can form.</p>
<p>In the experiments reported here, we used SFOLD <xref ref-type="bibr" rid="pcbi.1000832-Ding1">[30]</xref> to estimate the marginal distribution at each nucleotide over structural contexts (e.g. paired, unpaired, hairpin loop) for each position of the sequence by sampling a large number of structures for the sequence according to the Boltzmann distribution. We annotated each base in each structure using our context annotation alphabet (described below) and then we set the structural context distribution (hereafter called the annotation profile) to be the empirical annotation frequencies for that base across these samples. In all experiments described herein we used 1,000 samples.</p>
<p>Our motif model can use any annotation alphabet. However, in this manuscript, we only use the alphabet P, L, U, M indicating that the nucleotide is paired (P), in a hairpin loop (L), or in an unstructured (or external) region (U). The last annotation, M, stands for miscellaneous because we combine the remaining unpaired contexts (i.e., the nucleotide is in a bulge, internal loop or multiloop). This group of structural contexts are expressive enough to distinguish most known RBP structure preferences.</p>
</sec><sec id="s2b">
<title>Motif model</title>
<p><xref ref-type="fig" rid="pcbi-1000832-g001">Figure 1</xref> shows an overview of our method. A set of sequences together with SFOLD predicted structure annotation profiles serve as input to the model. Each input RNA molecule is scored using the sequence and structure parameters. Formally, let <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e002" xlink:type="simple"/></inline-formula> represent the input set of sequences and let <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e003" xlink:type="simple"/></inline-formula> be a set of real-valued matrices that represent the annotation profiles of the corresponding sequences. We use A to represent the alphabet which is composed of the structure features and associate each annotation in A with one of the rows of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e004" xlink:type="simple"/></inline-formula>. The columns of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e005" xlink:type="simple"/></inline-formula> correspond to the positions in sequence <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e006" xlink:type="simple"/></inline-formula> and are discrete probability distributions over the annotations in the alphabet A.</p>
<fig id="pcbi-1000832-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000832.g001</object-id><label>Figure 1</label><caption>
<title>Overview of RNAcontext method: the input, parameters and motif model.</title>
<p>The input to RNAcontext consists of a set of sequences together with their associated structure annotation profiles (estimated using SFOLD) and RNA-binding affinity estimates for the given RBP. The motif model has sequence parameters (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e007" xlink:type="simple"/></inline-formula>) and structure parameters (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e008" xlink:type="simple"/></inline-formula>) where the former describes the inferred base preferences (as a PWM) and the latter describes the relative structural preferences of the RBP to different structural contexts. Shown is a toy example, where the sequences with highest binding affinities have <italic>AUA</italic> or <italic>CUA</italic> in hairpin loop context and the sequences with lowest binding affinities either lack the sequence motif or contain the sequence motif in another structural context. By learning a motif model that predicts the input affinities, RNAcontext would infer the sequence and RNA structure preferences as shown on the right part of the figure.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000832.g001" xlink:type="simple"/></fig>
<p>Let <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e009" xlink:type="simple"/></inline-formula> represent the model parameters where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e010" xlink:type="simple"/></inline-formula> is the width of the binding site, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e011" xlink:type="simple"/></inline-formula> is a position weight matrix (PWM) of sequence features with dimensions <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e012" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e013" xlink:type="simple"/></inline-formula> is a vector of structure annotation parameters with one element for each letter in the alphabet <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e014" xlink:type="simple"/></inline-formula>. For instance if <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e015" xlink:type="simple"/></inline-formula> = <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e016" xlink:type="simple"/></inline-formula> then <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e017" xlink:type="simple"/></inline-formula> will consist of parameters (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e018" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e019" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e020" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e021" xlink:type="simple"/></inline-formula>) for the structure annotations <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e022" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e023" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e024" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e025" xlink:type="simple"/></inline-formula>, respectively. Lastly, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e026" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e027" xlink:type="simple"/></inline-formula> stands for the bias terms in sequence affinity model and structural context model respectively.</p>
<p>We use <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e028" xlink:type="simple"/></inline-formula> to assign a score, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e029" xlink:type="simple"/></inline-formula>, to a sequence <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e030" xlink:type="simple"/></inline-formula> and its corresponding annotation profile <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e031" xlink:type="simple"/></inline-formula>. For an RBP with a binding site of width <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e032" xlink:type="simple"/></inline-formula>, following <xref ref-type="bibr" rid="pcbi.1000832-Granek1">[31]</xref>, we define <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e033" xlink:type="simple"/></inline-formula> as the probability that at least one of its subsequences of length <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e034" xlink:type="simple"/></inline-formula> (which we call <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e035" xlink:type="simple"/></inline-formula>-mers) is bound by the RBP, that is:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e036" xlink:type="simple"/><label>(1)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e037" xlink:type="simple"/></inline-formula> is an estimate of the probability that the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e038" xlink:type="simple"/></inline-formula>-mer with base content <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e039" xlink:type="simple"/></inline-formula> and with structural context defined by the probability profile matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e040" xlink:type="simple"/></inline-formula> is bound. Here, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e041" xlink:type="simple"/></inline-formula> indicates the subsequence of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e042" xlink:type="simple"/></inline-formula> between <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e043" xlink:type="simple"/></inline-formula>-th element and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e044" xlink:type="simple"/></inline-formula>-th element, inclusive, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e045" xlink:type="simple"/></inline-formula> is a matrix whose columns are the annotation distributions for each of the bases between <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e046" xlink:type="simple"/></inline-formula>-th and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e047" xlink:type="simple"/></inline-formula>-th position. We set <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e048" xlink:type="simple"/></inline-formula> to be the product between a term that depends only its base content, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e049" xlink:type="simple"/></inline-formula>, and one that depends only upon its structural context <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e050" xlink:type="simple"/></inline-formula>, i.e.:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e051" xlink:type="simple"/><label>(2)</label></disp-formula>We interpret the term <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e052" xlink:type="simple"/></inline-formula> as an estimate of the probability that the RBP will bind <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e053" xlink:type="simple"/></inline-formula> in the ideal structural context. We use a standard biophysical model <xref ref-type="bibr" rid="pcbi.1000832-Segal1">[28]</xref>, <xref ref-type="bibr" rid="pcbi.1000832-Granek1">[31]</xref>, <xref ref-type="bibr" rid="pcbi.1000832-Roider1">[32]</xref> to define <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e054" xlink:type="simple"/></inline-formula> (please see <xref ref-type="supplementary-material" rid="pcbi.1000832.s001">Protocol S1</xref> for more details on this model):<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e055" xlink:type="simple"/><label>(3)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e056" xlink:type="simple"/></inline-formula> is the well-known logistic function. The logistic function takes value <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e057" xlink:type="simple"/></inline-formula> at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e058" xlink:type="simple"/></inline-formula> where it is an approximately linear function of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e059" xlink:type="simple"/></inline-formula>, but it quickly saturates toward <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e060" xlink:type="simple"/></inline-formula> for negative <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e061" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e062" xlink:type="simple"/></inline-formula> for positive <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e063" xlink:type="simple"/></inline-formula>. We also model the structural context term using a logistic function of the sum of the structure parameters weighted by corresponding profile values plus a bias term <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e064" xlink:type="simple"/></inline-formula>:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e065" xlink:type="simple"/><label>(4)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e066" xlink:type="simple"/></inline-formula> represents the probability that the base at position <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e067" xlink:type="simple"/></inline-formula> of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e068" xlink:type="simple"/></inline-formula> has structural annotation <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e069" xlink:type="simple"/></inline-formula>. In a preferred structural context, as represented by an annotation <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e070" xlink:type="simple"/></inline-formula> associated with large positive values of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e071" xlink:type="simple"/></inline-formula>, the score <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e072" xlink:type="simple"/></inline-formula> for a <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e073" xlink:type="simple"/></inline-formula>-mer <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e074" xlink:type="simple"/></inline-formula> approximately equals <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e075" xlink:type="simple"/></inline-formula> and is thus determined by the base content <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e076" xlink:type="simple"/></inline-formula>. Whereas in a highly disfavored structural context, as represented by highly negative values of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e077" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e078" xlink:type="simple"/></inline-formula> and therefore the score <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e079" xlink:type="simple"/></inline-formula> regardless of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e080" xlink:type="simple"/></inline-formula> because <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e081" xlink:type="simple"/></inline-formula> is bounded above by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e082" xlink:type="simple"/></inline-formula> for all <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e083" xlink:type="simple"/></inline-formula>. So, the context term licenses binding in favored structured contexts.</p>
<p>In the following section, we describe how to estimate the parameters of our motif model from binding data. However, in theory, our motif model has the flexibility to represent many different modes of RBP binding. For example, the binding preferences of RBPs, like HuR and Vts1p, that bind their preferred sequences within a specific structural context, unstructured (U) <xref ref-type="bibr" rid="pcbi.1000832-Meisner1">[33]</xref> and hairpin (H) <xref ref-type="bibr" rid="pcbi.1000832-Aviv1">[17]</xref> respectively, can be represented by setting <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e084" xlink:type="simple"/></inline-formula> to match their sequence binding preferences and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e085" xlink:type="simple"/></inline-formula> to have negative elements except for the elements of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e086" xlink:type="simple"/></inline-formula> that corresponds to their preferred structural context (either <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e087" xlink:type="simple"/></inline-formula> or <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e088" xlink:type="simple"/></inline-formula> respectively). The binding preferences of RBPs, like U1A, that have multiple preferred contexts (e.g., hairpin loops <xref ref-type="bibr" rid="pcbi.1000832-Tsai1">[34]</xref> or unstructured ssRNA <xref ref-type="bibr" rid="pcbi.1000832-Law1">[35]</xref>) can be captured by setting <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e089" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e090" xlink:type="simple"/></inline-formula> to large positive values. RBPs, like Staufen, that bind dsRNA without obvious sequence preferences <xref ref-type="bibr" rid="pcbi.1000832-Wickham1">[36]</xref>, can be represented by setting the elements of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e091" xlink:type="simple"/></inline-formula> to constant values, and setting <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e092" xlink:type="simple"/></inline-formula> to a large positive value. Similarly, RBPs without strong structure preferences can be represented by setting the elements of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e093" xlink:type="simple"/></inline-formula> to zero and setting <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e094" xlink:type="simple"/></inline-formula> to a large positive value. Our model thus extends previous efforts that model RBP binding preferences <xref ref-type="bibr" rid="pcbi.1000832-Hackermuller1">[8]</xref> by associating each RBP with a single preferred structured context which is required for binding.</p>
<p>In the next section, we describe how we can estimate the sequence and structure preferences of new RBPs by training our model using RBP binding or RBP binding affinity data for short RNA sequences.</p>
</sec><sec id="s2c">
<title>Parameter estimation</title>
<p>We learn <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e095" xlink:type="simple"/></inline-formula> by using our model to attempt to reproduce the observed affinity data <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e096" xlink:type="simple"/></inline-formula> given the associated sequences <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e097" xlink:type="simple"/></inline-formula>. In particular, we model the affinity <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e098" xlink:type="simple"/></inline-formula> of a sequence <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e099" xlink:type="simple"/></inline-formula> as a linear function of the sequence score <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e100" xlink:type="simple"/></inline-formula> with unknown slope <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e101" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e102" xlink:type="simple"/></inline-formula>-intercept <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e103" xlink:type="simple"/></inline-formula> and search for settings of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e104" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e105" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e106" xlink:type="simple"/></inline-formula> that minimize the sum of the squared differences between the measured affinity <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e107" xlink:type="simple"/></inline-formula> and our predicted affinities <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e108" xlink:type="simple"/></inline-formula>. When we only know whether or not a given sequence is bound we use <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e109" xlink:type="simple"/></inline-formula> for all bound sequences and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e110" xlink:type="simple"/></inline-formula> for sequences not bound. This formulation leads to the following least squares cost function, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e111" xlink:type="simple"/></inline-formula>, that we attempt to minimize with respect to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e112" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e113" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e114" xlink:type="simple"/></inline-formula> using the L-BFGS method <xref ref-type="bibr" rid="pcbi.1000832-Byrd1">[37]</xref>:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e115" xlink:type="simple"/><label>(5)</label></disp-formula>Here, we have added a regularization term scaled by a small constant <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e116" xlink:type="simple"/></inline-formula> to avoid indeterminancy thus ensuring a unique global minimum. We use the same value of this constant in all experiments. We use the bound constraints feature of the L-BFGS-B package to constrain <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e117" xlink:type="simple"/></inline-formula> to take positive values so that the estimated affinity increases as a function of the sequence score.</p>
<p>The cost function optimized by RNAcontext is multimodal, so different initializations can generate different results. For the experiments reported here, we used ten different initialization for each motif width. For motif lengths, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e118" xlink:type="simple"/></inline-formula>, longer than the minimum length, two of these initial settings are generated by taking the optimal <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e119" xlink:type="simple"/></inline-formula> matrix learned for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e120" xlink:type="simple"/></inline-formula> and adding a column of zeros to its left and right sides, respectively. The elements of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e121" xlink:type="simple"/></inline-formula> matrix for the other initializations are randomly sampled uniformly between −0.05 and 0.05. In all cases, the other parameters (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e122" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e123" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e124" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e125" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e126" xlink:type="simple"/></inline-formula>) are randomly sampled uniformly between −0.05 and 0.05.</p>
</sec></sec><sec id="s3">
<title>Results</title>
<sec id="s3a">
<title>Dataset</title>
<p>We evaluated our motif model on <italic>RNAcompete</italic>-derived datasets <xref ref-type="bibr" rid="pcbi.1000832-Ray1">[5]</xref> comprised of the measured binding preferences of nine RBPs (i.e., HuR, Vts1p, PTB, FUSIP1, U1A, SF2/ASF, SLM2, RBM4 and YB1) to a pool of 213,130 unique short (29- to 38-nt) RNA sequences (see GEO record GSE15769 and/or Agilent array design: AMADID # 022053 for the array design and data). <italic>RNAcompete</italic> estimates an RBP's binding affinity for each sequence in an RNA pool based on the relative enrichment of that RNA sequence in the bound fraction versus the total RNA pool (as measured by transformed microarray intensity ratios).</p>
<p>The RNA pool can be divided into two separate sets, Set A and Set B, that each individually satisfy the following constraints: (i) each loop of length 3 to 7 (inclusive) is represented on at least one sequence flanked by RNA stems of 10 bases; and (ii) a population of “weakly structured RNAs” wherein each possible 7-mer is represented in at least 64 different sequences that have high folding free energy, and therefore are linear or form weak secondary structures. We call the group satisfying the first constraint the <italic>stem-loop</italic> sequences. This group also contains 60% of the possible length eight loops. We call the sequences satisfying the second constraint the <italic>weakly structured</italic> sequences. There is no overlap between the stem-loop and weakly structured sequences.</p>
<p>So in summary, there are two different groups of stem-loops, one in Set A and one in Set B, and similarly, two different groups of weakly structured sequences. It is important to note two things. First, though we attempted to design these sequences to be linear or hairpins, there are many unintended structures represented in the pool. For example, some of the sequences contain bulge or internal loops and some of the weakly structured sequences contain stem-loops. Second, no two sequences within the pool share a common subsequence more than 12 nt long. The design and properties of these sequences are described in greater detail in <xref ref-type="bibr" rid="pcbi.1000832-Ray1">[5]</xref>.</p>
<p>The division of the RNA sequence pool into Set A and Set B provides a natural strategy for evaluating our motif models using two-fold cross-validation: we train our algorithm on one of the two sets and test its predictive power on the other set. This strategy provides us with two independent measurements of performance on non-overlapping training sets. <xref ref-type="supplementary-material" rid="pcbi.1000832.s004">Table S1</xref> contains more information on the sizes and compositions of the sequences used for training and testing. The categorizations “Positive”, “Negative”, and “Other” that appear in this table are described below. Note due to stringent RNAcompete quality controls, some affinity data is missing for some of the sequences, so the numbers in the table do not add up to 213,130 for each RBP.</p>
</sec><sec id="s3b">
<title>Justification of choice of motif models for comparison</title>
<p>We evaluated RNAcontext against two other motif finding methods: MEMERIS <xref ref-type="bibr" rid="pcbi.1000832-Hiller1">[9]</xref> and MatrixREDUCE <xref ref-type="bibr" rid="pcbi.1000832-Foat3">[19]</xref>. MEMERIS and RNAcontext use similar approaches to model the structural context of an RNA binding site except that MEMERIS only models a single structural context where RNAcontext considers multiple contexts simultaneously. In contrast, MatrixREDUCE does not consider the structural context of RBP binding sites and therefore can help determine the value of considering structural context in RNA motif finding. Additionally, MatrixREDUCE outperforms many standard DNA motif finding algorithms on a similar experimental assay <xref ref-type="bibr" rid="pcbi.1000832-Chen1">[38]</xref> and therefore provides a strong algorithm to benchmark to compare RNAcontext and MEMERIS against. Also, like RNAcontext, MatrixREDUCE learns its motif model by trying to predict RNA sequence affinity whereas MEMERIS searches for motif models enriched in a set of bound sequences.</p>
</sec><sec id="s3c">
<title>Fitting motif models</title>
<p>In this subsection we describe our protocol for using the training data to fit the MEMERIS, MatrixREDUCE and RNAcontext motif models. Note that for all three methods, we fit all parameters, including those of the motif models and any free parameters (like motif width), using the training data. One of the free parameters that we consider for each method is whether it is better to train their motif model on the whole training set, or a defined subset of the training set. All of the free parameters that we consider for each method are described below. For every setting of the free parameters, we fit one motif model. The “best” motif model for each method was selected based on its ability to correctly classify “Positive” and “Negative” RNA sequences in the training set, as defined in the next paragraph. The final result of training is a single motif model for each method that we then evaluate on the test set.</p>
<p>The parameters of some motif models are fit using subsets of the training set because: (i) MatrixREDUCE does not model RNA secondary structure and it is possible that its performance would degrade when trained on stem-loop sequences (most of whose bases are paired); and (ii) MEMERIS takes as input a set of “bound” sequences that contain RBP binding sites. For MEMERIS, “bound” sequences are selected using a manual cutoff that captures the right tail of the distribution of the RNAcompete affinity estimates. We used a different cutoff for each RBP and each training set and the number of bound sequences ranged between 234 and 792 for the RBPs analyzed. Additionally, we used these bound sequence as the “Positive” sequences for Area Under the Precision-Recall Curve (AUC-PR). For the “Negative” sequences required by the AUC-PR calculation, we used those with estimated affinities below the median affinity of the training set. Any sequence not deemed a “Positive” or “Negative” is labeled as “Other” in <xref ref-type="supplementary-material" rid="pcbi.1000832.s004">Table S1</xref>. We score each motif model's performance by using it to estimate RNA-binding affinities for the “Positive” and “Negative” sequences and then evaluating classification accuracy using the AUC-PR. Because each algorithm models RBP binding preferences in a slightly different manner, in this section, we also describe how we estimate RNA-binding affinity for each sequence using the motif models for each algorithm.</p>
<p>For each method, we trained two sets of motif models. One set of models was fit using the full training set which consists of all RNA sequences in the training set for MatrixREDUCE and RNAcontext and all bound RNA sequences in the training set for MEMERIS. The other set of models was fit using only the weakly structured sequences in the training set (i.e., removing the stem-loops).</p>
<p>We consider a wide range of combinations of free parameters for MEMERIS. In particular, we tried all possible combinations of the following free parameter choices: the EF and PU options for measurement of single-strandedness; OOPS, ZOOPS and TCM options for the expected number of motifs per sequence (see <xref ref-type="supplementary-material" rid="pcbi.1000832.s001">Protocol S1</xref> for details on these options); motif lengths between 4 and 12 nts (inclusive); different values for the pseudocount parameter (i.e. 0.1, 1 and 3); and selecting the training set using a permissive cutoff (i.e., the bound sequences) or a stringent cutoff (i.e., the top half of bound sequences). The final option means that we consider four different subsets of the training set for each setting of the other free parameters (i.e. permissive/full, stringent/full, permissive/weak, stringent/weak). In total, we fit 648 different motif models for MEMERIS for each training set. We estimate affinity for each RNA sequence using a MEMERIS Position Frequency Matrix (PFM) motif model by following an approach similar to that used by MotifRegressor <xref ref-type="bibr" rid="pcbi.1000832-Conlon1">[39]</xref>. Namely, we calculated the foreground probability of a K-mer under the product-multinomial distribution defined by the PFM and calculated the background probability using a third-order Markov model trained on either the full training set (or test set, as appropriate). As explained in <xref ref-type="supplementary-material" rid="pcbi.1000832.s001">Protocol S1</xref>, the ratio of the foreground and background probabilities is an estimate of the relative affinity of the RBP for that K-mer. For some RBPs, when it led to a performance increase, we also multiplied this affinity by the probability that the site was accessible, as determined using the optimized settings of the EF/PU and pseudocount parameters for that training set. To estimate the affinity of the entire sequence, we summed its k-mer relative affinities. Note that we also tried MAST <xref ref-type="bibr" rid="pcbi.1000832-Bailey2">[40]</xref> to score the sequences using MEMERIS's motif models but test set performance decreased (data not shown).</p>
<p>We used MatrixREDUCE to generate single motifs with widths ranging from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e127" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e128" xlink:type="simple"/></inline-formula> by setting <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e129" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e130" xlink:type="simple"/></inline-formula>. The MatrixREDUCE program automatically selects the appropriate motif width, so we only needed to choose between two different MatrixREDUCE motifs on each training set (one trained on the full set and the other only on the weakly structured sequences). Note that MatrixREDUCE's PSAM motif model directly estimates relative binding affinity of the RBP for each k-mer, so to estimate RNA sequence affinity, we summed PSAM scores for each constituent k-mer.</p>
<p>We ran RNAcontext with motifs width ranging from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e131" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e132" xlink:type="simple"/></inline-formula>, thus creating 18 motif models per training set, and used equation (1) to score RNA sequences using these models.</p>
<p>For all three methods, for each training set, we used the AUC-PR on training set “Positives” and “Negatives”, to select the best single model among the fitted models. The free parameters settings for the selected models are in <xref ref-type="supplementary-material" rid="pcbi.1000832.s005">Table S2</xref>.</p>
</sec><sec id="s3d">
<title>Performance evaluation</title>
<p>RNAcontext achieved higher average AUC-PR values than MEMERIS and MatrixREDUCE on all of the nine RBPs analyzed (<xref ref-type="table" rid="pcbi-1000832-t001">Table 1</xref>). It also had significantly higher AUC-PRs than either method on 15 of the 18 test sets encompassing seven of the nine RBPs (the largest P-value was <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e133" xlink:type="simple"/></inline-formula>, Wilcoxon's sign-rank test on the AUC-PR values of 1,000 bootstrap samples; See <xref ref-type="supplementary-material" rid="pcbi.1000832.s006">Table S3</xref> for the complete results of bootstrap analysis).</p>
<table-wrap id="pcbi-1000832-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000832.t001</object-id><label>Table 1</label><caption>
<title>Comparison of predictive accuracy of three motif finding models using both weakly structured and stem-loop sequences in the test set.</title>
</caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1000832-t001-1" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000832.t001" xlink:type="simple"/><table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" colspan="1" rowspan="1">Proteins</td>
<td align="left" colspan="1" rowspan="1">RNAcontext</td>
<td align="left" colspan="1" rowspan="1">MEMERIS</td>
<td align="left" colspan="1" rowspan="1">MatrixREDUCE</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" colspan="1" rowspan="1">RBM4</td>
<td align="left" colspan="1" rowspan="1"><bold>0.91</bold></td>
<td align="left" colspan="1" rowspan="1">0.43</td>
<td align="left" colspan="1" rowspan="1">0.63</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">FUSIP1</td>
<td align="left" colspan="1" rowspan="1"><bold>0.53</bold></td>
<td align="left" colspan="1" rowspan="1">0.31</td>
<td align="left" colspan="1" rowspan="1">0.32</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">Vts1p</td>
<td align="left" colspan="1" rowspan="1"><bold>0.65</bold></td>
<td align="left" colspan="1" rowspan="1">0.58</td>
<td align="left" colspan="1" rowspan="1">0.56</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">YB1</td>
<td align="left" colspan="1" rowspan="1"><bold>0.17</bold></td>
<td align="left" colspan="1" rowspan="1">0.07</td>
<td align="left" colspan="1" rowspan="1">0.11</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">SLM2</td>
<td align="left" colspan="1" rowspan="1"><bold>0.81</bold></td>
<td align="left" colspan="1" rowspan="1">0.49</td>
<td align="left" colspan="1" rowspan="1">0.77</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">SF2</td>
<td align="left" colspan="1" rowspan="1"><bold>0.70</bold></td>
<td align="left" colspan="1" rowspan="1">0.50</td>
<td align="left" colspan="1" rowspan="1">0.66</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">U1A</td>
<td align="left" colspan="1" rowspan="1"><bold>0.30</bold></td>
<td align="left" colspan="1" rowspan="1">0.27</td>
<td align="left" colspan="1" rowspan="1">0.21</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">HuR</td>
<td align="left" colspan="1" rowspan="1"><bold>0.96</bold></td>
<td align="left" colspan="1" rowspan="1">0.74</td>
<td align="left" colspan="1" rowspan="1">0.94</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">PTB</td>
<td align="left" colspan="1" rowspan="1"><bold>0.69</bold></td>
<td align="left" colspan="1" rowspan="1">0.26</td>
<td align="left" colspan="1" rowspan="1">0.67</td>
</tr>
</tbody>
</table></alternatives><table-wrap-foot><fn id="nt101"><label/><p>The values show the average AUC-PR across two test sets and bold values indicate the best performing method. Rows are sorted by decreasing relative gain of RNAcontext to the best of MEMERIS &amp; MatrixREDUCE. For all the methods, displayed values were calculated using the single best motif model for each method chosen based on the two training set performance. According to the Wilcoxon's sign rank test performed on paired AUC-PR values across 1,000 bootstrap samples from the test set results of the three methods, all differences between RNAcontext AUC-PR and that of the other algorithms are statistically significant (the largest P-value is <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e134" xlink:type="simple"/></inline-formula>, see <xref ref-type="supplementary-material" rid="pcbi.1000832.s006">Table S3</xref> for the complete results of bootstrap analysis) except for the differences on PTB and U1A.</p></fn></table-wrap-foot></table-wrap>
<p>The improvement in AUC-PR of RNAcontext compared with MatrixREDUCE is largest for proteins whose preferred structural context is less common in the RNA pool, reflecting the fact these are the hardest binding sites for MatrixREDUCE to predict. For example, RNAcontext performs much better than MatrixREDUCE on Vts1p which binds to CNGG in the loop of an RNA stem-loop. This sequence appears frequently outside of a loop context in the RNA pool. We also see large improvements for RBM4 that binds to CG containing sequences in an unpaired context, likely because these sequences often appear in stems. In contrast, HuR's binding site is U-rich and, as such, is rarely paired in either the training or test set. In this circumstance, MatrixREDUCE's lack of a structural model does little harm to its performance.</p>
<p>Although MEMERIS has higher average AUC-PR than MatrixREDUCE for stem-loop binding proteins Vts1p and U1A, reflecting the value of its model of structural context, its average AUC-PR was otherwise worse than that of MatrixREDUCE and always worse than that of RNAcontext. This is likely due to its inability to make use of the affinity data associated with each sequence. One consequence of this is that it can only trained on a small subset of the data. Some of the loss in AUC-PR on the test set may also be due to overfitting because of the large number of parameter combinations that needed to be considered.</p>
</sec><sec id="s3e">
<title>The predictive value of structural context</title>
<p>Having established that RNAcontext can capture RBP binding preferences better than comparable motif models that either do not model RNA secondary structure (MatrixREDUCE), or use a limited representation (MEMERIS), we then attempted to confirm that the added predictive value was due to the incorporation of structural context, rather than differences in how we estimate sequence affinity. To do this, we compared our model based on the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e135" xlink:type="simple"/></inline-formula> structural annotation alphabet to a simplified version of our model whose alphabet only contains a single letter (i.e. all bases have an identical structural annotation). As in previous sections, the two models were fit to the data for each of the nine RBPs using a variety of motif widths (4–12). Also, as before, we used training set AUC-PR to choose the optimal motif width and to choose between the full training set and only the weakly structured sequences. After selecting the single best model for the two methods, we compared RNAcontext against the structure-naive model using AUC-PR on the full test set. To assess the significance of difference in AUC-PR, we used 95% confidence interval of the difference estimated from 1,000 bootstrap samples. <xref ref-type="fig" rid="pcbi-1000832-g002">Figure 2</xref> shows these differences for nine RBPs on the two cross-validation test sets. Using structural context lead to a significant improvement in AUC-PR for eight of the nine RBPs. In some cases, the difference was dramatic, particularly for Vts1p, RBM4, FUSIP1 and U1A.</p>
<fig id="pcbi-1000832-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000832.g002</object-id><label>Figure 2</label><caption>
<title>Change in predictive accuracy of RNAcontext due to the representation of RNA structural context.</title>
<p>Bar graph shows the increase in AUC-PR of RNAcontext with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e136" xlink:type="simple"/></inline-formula> alphabet compared with the model without RNA structural context for each of nine RBPs using the two test sets. Error bars show 95% confidence interval of the difference estimated from 1,000 bootstrap samples of the test set.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000832.g002" xlink:type="simple"/></fig></sec><sec id="s3f">
<title>Position-specific scoring matrices provide good approximations of sequence binding preferences for six RBPs</title>
<p>We then sought to assess the accuracy of position-specific scoring matrix (PSSM) approximations of RNA-sequence binding preferences by comparing the predictive power of inferred 7-mers affinities to that of the three PSSM-based models. We trained a “fully-specified 7-mer model” that estimates the binding affinity of an RBP for every 7-mer by taking a trimmed average of the transformed intensity ratios of the weakly-structured sequences that contain the 7-mer in the training set (see <xref ref-type="bibr" rid="pcbi.1000832-Ray1">[5]</xref> for more details of this model). We then used these estimated affinities to assign a score to RNA sequences longer than seven nucleotides, by taking the mean of the affinities of each 7-mer in each sequence in the test set. We also trained and evaluated RNAcompete, MatrixREDUCE and MEMERIS motif models as previously described except that we always restricted the training and test sets to the weakly-structured sequences. We used only the weakly-structured sequences in this comparison so that we could more readily evaluate the ability of PSSM models to assess sequence binding preferences separately from each method's ability to capture RBP structure binding preferences. <xref ref-type="fig" rid="pcbi-1000832-g003">Figure 3</xref> compares the 7-mer model against the three methods with respect to average AUC-PR on the test sets. PSSM-based motif models perform significantly better than the 7-mer model for every RBP except U1A (and only on test set A), YB1, and SF2/ASF (the Wilcoxon sign-rank P-values for the best PSSM motif model are all less than <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e137" xlink:type="simple"/></inline-formula>). Notice that because MatrixREDUCE performs significantly better than the RNAcompete method for five of the nine RBPs, this performance gain can not be explained by the incorporation of structural context in RNAcontext.</p>
<fig id="pcbi-1000832-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000832.g003</object-id><label>Figure 3</label><caption>
<title>The predictive value of the fully-specified 7-mer model (i.e., the <italic>RNAcompete</italic> model) with respect to the motif models.</title>
<p>This scatter plot compares the performance of the <italic>RNAcompete</italic> model to other motif models where the training and test sets are formed using only weakly structured sequences. The x-axis shows the AUC-PRs of <italic>RNAcompete</italic> and the y-axis shows the AUC-PRs of the three motif models: RNAcontext (blue), MEMERIS (red) and MatrixREDUCE (green). Each point corresponds to the mean AUC-PR of 1,000 bootstrap samples, averaged across the two test sets. The error bars indicate the 95% bootstrap confidence interval.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000832.g003" xlink:type="simple"/></fig></sec><sec id="s3g">
<title>The sequence and structure binding preferences for seven RBPs</title>
<p>Having established that RNAcontext accurately predicts the <italic>in vitro</italic> affinity for seven of the nine RBPs (with the exception of YB-1 and U1A), we applied RNAcontext to the entire dataset to make the best possible prediction for their binding preferences. The results are shown in <xref ref-type="fig" rid="pcbi-1000832-g004">Figure 4</xref> and <xref ref-type="fig" rid="pcbi-1000832-g005">Figure 5</xref>. <xref ref-type="fig" rid="pcbi-1000832-g004">Figure 4</xref> shows the relative structural context preference of each RBP. RNAcontext's predicted structural preferences are consistent with co-crystal structures for Vts1p <xref ref-type="bibr" rid="pcbi.1000832-Aviv1">[17]</xref> (loop) and PTB <xref ref-type="bibr" rid="pcbi.1000832-Oberstrass1">[41]</xref> (ssRNA) and <italic>in vitro</italic> and <italic>in vivo</italic> binding data for HuR <xref ref-type="bibr" rid="pcbi.1000832-Ray1">[5]</xref>, <xref ref-type="bibr" rid="pcbi.1000832-Hackermuller1">[8]</xref>, <xref ref-type="bibr" rid="pcbi.1000832-Gao1">[12]</xref>. RNAcontext also predicts new structural preferences for SLM2, RBM4 and SF2/ASF. Of particular interest, is that RNAcontext predicts that SF2/ASF has a slight preference for RNA binding sites in bulges, internal loops, and/or multiloops (the M annotation). For FUSIP1, we report the motif model trained using only the weakly structured sequences even though the model trained on the full set (shown in <xref ref-type="supplementary-material" rid="pcbi.1000832.s002">Figure S1</xref>) had higher AUC-PR. As mentioned in the legend of <xref ref-type="supplementary-material" rid="pcbi.1000832.s002">Figure S1</xref>, we could not rule out the possibility that this model reflected an artifact of our pool design despite the fact that the two models both suggest that FUSIP1 prefers its binding site to be 5′ to an RNA stem.</p>
<fig id="pcbi-1000832-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000832.g004</object-id><label>Figure 4</label><caption>
<title>Relative RNA structure preferences inferred by RNAcontext.</title>
<p>Y-axis indicates the ratio between the context scale factor <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e138" xlink:type="simple"/></inline-formula> (see equation 4) for a structural context with probability one for the indicated annotation (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e139" xlink:type="simple"/></inline-formula>) for all bases (i.e. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e140" xlink:type="simple"/></inline-formula>) to the context scale factor <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e141" xlink:type="simple"/></inline-formula> for the best possible structural context for the RBP (i.e. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e142" xlink:type="simple"/></inline-formula> where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e143" xlink:type="simple"/></inline-formula>). Displayed are ratios across parameters learned from the training set containing all the sequences (i.e. both Set A and Set B). For Vts1p, the most preferred context was predicted to be hairpin loop and this is consistent with the known binding preferences. SLM2, RBM4, and HuR have similar preferences, and predicted to bind regions that are not paired.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000832.g004" xlink:type="simple"/></fig><fig id="pcbi-1000832-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000832.g005</object-id><label>Figure 5</label><caption>
<title>Inferred sequence and structure binding preferences for seven RBPs.</title>
<p>RNA-binding domains of the proteins are displayed on the second column and previously reported binding sites are displayed on the third column for reference. RNAcontext predicted sequence parameters are shown as a PFM (fourth column). Also, an estimate of the preferred structural context for each base is displayed underneath each of the logos.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000832.g005" xlink:type="simple"/></fig>
<p><xref ref-type="fig" rid="pcbi-1000832-g005">Figure 5</xref> compares the motif logo representations (generated by Enologos software<xref ref-type="bibr" rid="pcbi.1000832-Workman1">[42]</xref>) of RNAcontext's <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e144" xlink:type="simple"/></inline-formula> parameters with previously reported motifs for those RBPs. To derive the energy parameters required by Enologos, we uniformly rescaled the elements of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e145" xlink:type="simple"/></inline-formula> matrix so that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e146" xlink:type="simple"/></inline-formula> of the optimal binding site, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000832.e147" xlink:type="simple"/></inline-formula>, would be 0.5 (as suggested by <xref ref-type="bibr" rid="pcbi.1000832-Granek1">[31]</xref>). Underneath each of the logos for the RNAcontext motifs, we have displayed an estimate of the preferred structural context for each base. In order to identify this context, we found the top 20 best scoring k-mers in the test set under each motif model, averaged the annotation profiles for these 20 k-mers and deemed the annotation with the highest average frequency to be the preferred context for each position in the k-mer. These estimates recover the fact that the Vts1p binding site (CNGG) occurs at the 5′ end of the hairpin loop. Our RNAcontext motifs match previously reported binding sites <xref ref-type="bibr" rid="pcbi.1000832-Gao1">[12]</xref>, <xref ref-type="bibr" rid="pcbi.1000832-Aviv1">[17]</xref>, <xref ref-type="bibr" rid="pcbi.1000832-Tacke1">[43]</xref>–<xref ref-type="bibr" rid="pcbi.1000832-Shin1">[45]</xref> and the motifs that we have previously derived from the <italic>RNAcompete</italic> data<xref ref-type="bibr" rid="pcbi.1000832-Ray1">[5]</xref>.</p>
</sec><sec id="s3h">
<title><italic>In vivo</italic> confirmation of RNAcontext motif for SF2/ASF</title>
<p>In both <xref ref-type="fig" rid="pcbi-1000832-g004">Figure 4</xref> and <xref ref-type="fig" rid="pcbi-1000832-g005">Figure 5</xref>, we observe a preference for the M structural context for the SF2/ASF motif. This preference has not been previously reported for SF2/ASF <xref ref-type="bibr" rid="pcbi.1000832-Tacke1">[43]</xref>. To confirm this unusual preference, we collected data on the <italic>in vivo</italic> targets of SF2/ASF from <xref ref-type="bibr" rid="pcbi.1000832-Sanford1">[13]</xref>. These targets were generated using the CLIP-Seq assay and consist of 296 short RNA fragments that cross-link to the protein in cultured cells which we call “bound”; and 314 transcript sequences not observed to cross-link which we call “unbound”. These data supported our inferred structure preferences for SF2/ASF. In particular, by manual inspection, we discovered a number of cases of the RNAcontext motif within bulge and internal loops within the bound sequences. Also, using our model trained on the RNAcompete data, we were able to distinguish between bound and unbound sequences with higher accuracy using our model (AUC-PR 0.915) compared with the version of our model with a single letter annotation alphabet (AUC-PR 0.898) and MatrixREDUCE (AUC-PR 0.898). Furthermore, when we train our RNAcontext model on the <italic>in vivo</italic> data, assigning bound sequences an affinity of 1 and unbound ones an affinity of −1, we recover the same structural preference for SF2/ASF (<xref ref-type="supplementary-material" rid="pcbi.1000832.s003">Figure S2</xref>).</p>
</sec></sec><sec id="s4">
<title>Discussion</title>
<p>We have demonstrated that RNAcontext represents an advance over existing methods for modeling mRNA-binding protein binding preferences. Motifs learned by RNAcontext more accurately predicted a held out <italic>in vitro</italic> binding dataset for all of the nine RBPs tested. Seven of these differences were statistically significant. As expected, the size of an improvement depends on the relative representation of the preferred binding site in the preferred structural context (or contexts) in the RNAcontext dataset.</p>
<p>RNAcontext motif models reflect previously reported sequence and structure preferences for well-studied RBPs like HuR, Vts1p and PTB and predict new structure binding preferences for SLM2, RBM4 and SF2/ASF. RNAcontext's predictions are supported by <italic>in vivo</italic> binding data for SF2/ASF: the RNAcontext <italic>in vitro</italic> motif model more accurately predicts <italic>in vivo</italic> binding of SF2/ASF, and RNAcontext motif models trained using the <italic>in vivo</italic> data recover the same structural context preference. We expect similar success with our other new predictions because, as we have previously established (in <xref ref-type="bibr" rid="pcbi.1000832-Ray1">[5]</xref>), binding preferences inferred from RNAcompete data are consistent with <italic>in vivo</italic> binding preferences and that more accurate prediction of RNAcompete-measured binding affinity translates into more accurate prediction of <italic>in vivo</italic> binding.</p>
<p>We have also provided evidence that the position-specific scoring matrix (PSSM) motif representation is a better approximation for the RNA binding preferences of RBPs than it is for dsDNA binding preferences of TFs. In particular, in previous work <xref ref-type="bibr" rid="pcbi.1000832-Chen1">[38]</xref>, using a similar evaluation framework, we had found that that a “fully-specified 8-mer model” trained on protein-binding microarray (PBM) <xref ref-type="bibr" rid="pcbi.1000832-Berger1">[46]</xref> data had greater predictive power for 7 of 10 TFs than a set of standard DNA motif-finding algorithms, including MatrixREDUCE, trained on the same data. These observations were consistent with many others (e.g., <xref ref-type="bibr" rid="pcbi.1000832-Benos1">[47]</xref>–<xref ref-type="bibr" rid="pcbi.1000832-Badis1">[49]</xref>) that PSSMs were inaccurate approximations dsDNA binding affinities for the majority of TFs. In <xref ref-type="fig" rid="pcbi-1000832-g003">Figure 3</xref>, we show that the opposite holds for RNA-binding data: PSSM models learned by MatrixREDUCE, which does not consider RNA structure, had greater predictive power than a fully-specified 7-mer model for a majority of RBPs. Although the sample size is small, this result may reflect the increased flexibility of RNA compared with dsDNA which may permit more independent movement and recognition of individual bases. Our observations further suggests that modifications of the basic PSSM model made for TFs that incorporate interactions between bases may not be as indispensible for modeling RBP binding preferences. Note that our conclusions here differ from our previous analyses on the same data <xref ref-type="bibr" rid="pcbi.1000832-Ray1">[5]</xref>. We suspect that this difference is due our use, in the present study, of motif finding methods that take full advantage of the affinity data associated with each sequence. Indeed, MEMERIS, one of the algorithms we also used in <xref ref-type="bibr" rid="pcbi.1000832-Ray1">[5]</xref> performed worse than the fully 7-mer model in <xref ref-type="fig" rid="pcbi-1000832-g003">Figure 3</xref> for eight of the nine RBPs.</p>
<p>In summary, we have introduced a new motif model of RBP binding preferences and a corresponding algorithm for fitting this model to quantitative estimates of RBP binding affinity for short RNA sequences. Our RNAcontext model makes use of a new technique for representing RNA structure based on a structural context alphabet that we use to annotate individual bases of RNA sequence. This representation is particularly amenable to modeling RBP binding preferences. Although we provide a pipeline to annotate RNA sequences according to the PLUM alphabet, our motif finding code does not require a particular structural context annotation alphabet for bases or even a particular RNA structure prediction method. Hence, RNAcontext can easily be expanded to integrate more parsimonious annotations of structural context or improvements in RNA structure prediction methods.</p>
</sec><sec id="s5">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1000832.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000832.s001" xlink:type="simple"><label>Protocol S1</label><caption>
<p>A brief review of DNA motif finding.</p>
<p>(0.16 MB PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000832.s002" mimetype="application/postscript" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000832.s002" xlink:type="simple"><label>Figure S1</label><caption>
<p>Inferred sequence and RNA structure binding preferences for FUSIP1 using all the sequences as the training set. A) Predicted sequence parameters are shown using a sequence logo representation. An estimate of the preferred structural context for each base is displayed underneath the logo. B) The bar graph shows the relative RNA structure preferences of FUSIP1. Note that all sequences in the RNA pool, including the stem-loop sequences, have an unpaired <named-content content-type="gene" xlink:type="simple">5′-AGA</named-content> or <named-content content-type="gene" xlink:type="simple">5′-AGG</named-content> (the initiation sequence for T7 promoter) at their 5′ end. In all stem-loop sequences, this initiation sequence is followed by a G because the bottom base pair of every stem-loop is G-C. Since AG(A/G)G is very similar to previously reported FUSIP1 binding sites <xref ref-type="bibr" rid="pcbi.1000832-Ray1">[5]</xref>, <xref ref-type="bibr" rid="pcbi.1000832-Shin1">[45]</xref>, we were concerned that this artifact of the pool design had an impact on the model of FUSIP1 binding preferences fit to the full training set. However, even in the model fit only to the weakly-structured sequences shown in <xref ref-type="fig" rid="pcbi-1000832-g004">Figure 4</xref>, there is a slight preference for the paired context compared to L and M.</p>
<p>(1.04 MB EPS)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000832.s003" mimetype="application/postscript" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000832.s003" xlink:type="simple"><label>Figure S2</label><caption>
<p>Inferred sequence and RNA structure binding preferences for SF2. RNAcontext is used to infer binding preferences of SF2 from in vivo data <xref ref-type="bibr" rid="pcbi.1000832-Sanford1">[13]</xref> A) Predicted sequence parameters are shown use a sequence logo representation and an estimate of the preferred structural context for each base is displayed underneath the logo. B) The bar graph shows the relative RNA structure preferences of SF2.</p>
<p>(0.90 MB EPS)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000832.s004" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000832.s004" xlink:type="simple"><label>Table S1</label><caption>
<p>Properties of the sequences in the input sets. The composition of Sets A and B in terms of relative proportions of stem-loops and weakly structured sequences among their Positive, Negative and Other groups. The input sets are partitioned into these three groups according to their RNAcompete-measured affinities. The sequences with affinities above a threshold are defined as Positive; the sequences with affinities below the median affinities over all the sequences in the given set are defined as Negative and the remaining sequences are placed in the Other group. Within each group, the number of weakly structured sequences and stem-loops are displayed. For RNAcontext and MatrixREDUCE all the sequences in Positive, Negative and Other categories are used for training whereas when running MEMERIS, only Positive sequences are used for training. The test sets are comprised of all sequences in the Positive and Negative groups.</p>
<p>(0.01 MB PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000832.s005" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000832.s005" xlink:type="simple"><label>Table S2</label><caption>
<p>Details about the chosen models for RNAcontext, MEMERIS and MatrixREDUCE. Optimal free parameter settings for RNAcontext, MEMERIS and MatrixREDUCE. The column Set describes the training set and contains either weak or full where weak indicates that motifs were trained on the weakly structured sequences and full indicates that motifs were trained on the full set of sequences. The columns, MW-A and MW-B, show the selected motif length for the test sets A and B respectively. There is an extra other column for MEMERIS which shows the other free parameters that are chosen. Namely, EF and PU are two different ways to measure single-strandedness of a region; OOPS (exactly one motif occurrence per sequence), ZOOPS (zero or one motif occurrence per sequence), and TCM (zero or more motif occurrence per sequence) are options (-mod) that indicate the expected number of motifs per sequence. The values in the next column (i.e. 0.1 or 1) are the chosen pseudocount parameters among the available values 0.1, 1, 3. The lower the pseudocount value, the more impact the single-strandedness of the binding site has in the model. Two different thresholds were used to define the input to MEMERIS and * indicates that the more stringent threshold was selected. The last three columns contain the selected free parameter settings for MatrixREDUCE.</p>
<p>(0.01 MB PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000832.s006" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000832.s006" xlink:type="simple"><label>Table S3</label><caption>
<p>Result of bootstrap analysis of relative AUC-PRs. Each entry represents the number of times RNAcontext has a larger/smaller AUC-PR value compared to AUC-PR values of MatrixREDUCE &amp; MEMERIS on 1,000 bootstrap samples from the test set results (shown in <xref ref-type="table" rid="pcbi-1000832-t001">Table 1</xref>). * indicates that the difference is not significant according to Wilcoxon's sign rank test.</p>
<p>(0.01 MB PDF)</p>
</caption></supplementary-material></sec></body>
<back><ref-list>
<title>References</title>
<ref id="pcbi.1000832-Hogan1"><label>1</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Hogan</surname><given-names>DJ</given-names></name>
<name name-style="western"><surname>Riordan</surname><given-names>DP</given-names></name>
<name name-style="western"><surname>Gerber</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Herschlag</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Brown</surname><given-names>PO</given-names></name>
</person-group>             <year>2008</year>             <article-title>Diverse RNA-binding proteins interact with functionally related sets of RNAs, suggesting an extensive regulatory system.</article-title>             <source>PLoS Biol</source>             <volume>6(10)</volume>             <fpage>e255</fpage>          </element-citation></ref>
<ref id="pcbi.1000832-Blanchette1"><label>2</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Blanchette</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Green</surname><given-names>RE</given-names></name>
<name name-style="western"><surname>MacArthur</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Brooks</surname><given-names>AN</given-names></name>
<name name-style="western"><surname>Brenner</surname><given-names>SE</given-names></name>
<etal/></person-group>             <year>2009</year>             <article-title>Genome-wide analysis of alternative pre-mRNA splicing and RNA-binding specificities of the Drosophila hnRNP A/B family members.</article-title>             <source>Mol Cell</source>             <volume>33(4)</volume>             <fpage>438</fpage>             <lpage>449</lpage>          </element-citation></ref>
<ref id="pcbi.1000832-Lukong1"><label>3</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Lukong</surname><given-names>KE</given-names></name>
<name name-style="western"><surname>Chang</surname><given-names>KW</given-names></name>
<name name-style="western"><surname>Khandjian</surname><given-names>EW</given-names></name>
<name name-style="western"><surname>Richard</surname><given-names>S</given-names></name>
</person-group>             <year>2008</year>             <article-title>RNA-binding proteins in human genetic disease.</article-title>             <source>Trends Genetics</source>             <volume>24(8)</volume>             <fpage>416</fpage>             <lpage>425</lpage>          </element-citation></ref>
<ref id="pcbi.1000832-Keene1"><label>4</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Keene</surname><given-names>JD</given-names></name>
</person-group>             <year>2007</year>             <article-title>RNA regulons: coordination of post-transcriptional events.</article-title>             <source>Nat Rev Genet</source>             <volume>8</volume>             <fpage>533</fpage>             <lpage>543</lpage>          </element-citation></ref>
<ref id="pcbi.1000832-Ray1"><label>5</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Ray</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Kazan</surname><given-names>H</given-names></name>
<name name-style="western"><surname>Chan</surname><given-names>ET</given-names></name>
<name name-style="western"><surname>Castillo</surname><given-names>LP</given-names></name>
<name name-style="western"><surname>Chaudhry</surname><given-names>S</given-names></name>
<etal/></person-group>             <year>2009</year>             <article-title>Rapid and systematic analysis of the RNA recognition specificities of RNA-binding proteins.</article-title>             <source>Nat Biotechnol</source>             <volume>27(7)</volume>             <fpage>667</fpage>             <lpage>670</lpage>          </element-citation></ref>
<ref id="pcbi.1000832-Keene2"><label>6</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Keene</surname><given-names>JD</given-names></name>
<name name-style="western"><surname>Komisarow</surname><given-names>JM</given-names></name>
<name name-style="western"><surname>Friedersdorf</surname><given-names>MB</given-names></name>
</person-group>             <year>2006</year>             <article-title>RIP-Chip: the isolation and identification of mRNAs, microRNAs and protein components of ribonucleoprotein complexes from cell extracts.</article-title>             <source>Nat Protoc</source>             <volume>1</volume>             <fpage>302</fpage>             <lpage>307</lpage>          </element-citation></ref>
<ref id="pcbi.1000832-Ule1"><label>7</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Ule</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Jensen</surname><given-names>K</given-names></name>
<name name-style="western"><surname>Mele</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Darnell</surname><given-names>RB</given-names></name>
</person-group>             <year>2005</year>             <article-title>CLIP: a method for identifying protein-RNA interaction sites in living cells.</article-title>             <source>Methods</source>             <volume>37</volume>             <fpage>376</fpage>             <lpage>386</lpage>          </element-citation></ref>
<ref id="pcbi.1000832-Hackermuller1"><label>8</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Hackermuller</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Meisner</surname><given-names>NC</given-names></name>
<name name-style="western"><surname>Auer</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Jaritz</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Stadler</surname><given-names>PF</given-names></name>
</person-group>             <year>2005</year>             <article-title>The effect of RNA secondary structure on RNA-ligand binding and the modifier RNA mechanism: a quantitative model.</article-title>             <source>Gene</source>             <volume>345(1)</volume>             <fpage>3</fpage>             <lpage>12</lpage>          </element-citation></ref>
<ref id="pcbi.1000832-Hiller1"><label>9</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Hiller</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Pudimat</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Busch</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Backofen</surname><given-names>R</given-names></name>
</person-group>             <year>2006</year>             <article-title>Using RNA secondary structures to guide sequence motif finding towards single-stranded regions.</article-title>             <source>Nucleic Acids Res</source>             <volume>34(17)</volume>             <fpage>e117</fpage>          </element-citation></ref>
<ref id="pcbi.1000832-Li1"><label>10</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Li</surname><given-names>X</given-names></name>
<name name-style="western"><surname>Quon</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Lipshitz</surname><given-names>H</given-names></name>
<name name-style="western"><surname>Morris</surname><given-names>Q</given-names></name>
</person-group>             <year>2010</year>             <article-title>Predicting <italic>in vivo</italic> binding sites of RNA-binding proteins using mRNA secondary structure.</article-title>             <source>RNA</source>             <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1261/rna.2017210" xlink:type="simple">10.1261/rna.2017210</ext-link></comment>          </element-citation></ref>
<ref id="pcbi.1000832-Buckanovich1"><label>11</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Buckanovich</surname><given-names>RJ</given-names></name>
<name name-style="western"><surname>Darnell</surname><given-names>RB</given-names></name>
</person-group>             <year>1997</year>             <article-title>The neuronal RNA binding protein Nova-1 recognizes specific RNA targets <italic>in vitro</italic> and <italic>in vivo</italic>.</article-title>             <source>Mol Cell Biol</source>             <volume>17(6)</volume>             <fpage>3194</fpage>             <lpage>3201</lpage>          </element-citation></ref>
<ref id="pcbi.1000832-Gao1"><label>12</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Gao</surname><given-names>FB</given-names></name>
<name name-style="western"><surname>Carson</surname><given-names>CC</given-names></name>
<name name-style="western"><surname>Levine</surname><given-names>T</given-names></name>
<name name-style="western"><surname>Keene</surname><given-names>JD</given-names></name>
</person-group>             <year>1994</year>             <article-title>Selection of a subset of mRNAs from combinatorial 3′ untranslated region libraries using neuronal RNA-binding protein Hel-N1.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>91</volume>             <fpage>11207</fpage>             <lpage>11211</lpage>          </element-citation></ref>
<ref id="pcbi.1000832-Sanford1"><label>13</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Sanford</surname><given-names>JR</given-names></name>
<name name-style="western"><surname>Wang</surname><given-names>X</given-names></name>
<name name-style="western"><surname>Mort</surname><given-names>M</given-names></name>
<name name-style="western"><surname>VanDuyn</surname><given-names>N</given-names></name>
<name name-style="western"><surname>Cooper</surname><given-names>DN</given-names></name>
<etal/></person-group>             <year>2008</year>             <article-title>Splicing factor SFRS1 recognizes a functionally diverse landscape of RNA transcripts.</article-title>             <source>Genome Res</source>             <volume>19</volume>             <fpage>381</fpage>             <lpage>394</lpage>          </element-citation></ref>
<ref id="pcbi.1000832-Foat1"><label>14</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Foat</surname><given-names>BC</given-names></name>
<name name-style="western"><surname>Houshmandi</surname><given-names>SS</given-names></name>
<name name-style="western"><surname>Olivas</surname><given-names>WM</given-names></name>
<name name-style="western"><surname>Bussemaker</surname><given-names>HJ</given-names></name>
</person-group>             <year>2005</year>             <article-title>Profiling condition-specific, genome-wide regulation of mRNA stability in yeast.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>102</volume>             <fpage>17675</fpage>             <lpage>17680</lpage>          </element-citation></ref>
<ref id="pcbi.1000832-Wang1"><label>15</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Wang</surname><given-names>X</given-names></name>
<name name-style="western"><surname>Zamore</surname><given-names>PD</given-names></name>
<name name-style="western"><surname>Hall</surname><given-names>TM</given-names></name>
</person-group>             <year>2001</year>             <article-title>Crystal structure of a Pumilio homology domain.</article-title>             <source>Mol Cell</source>             <volume>7</volume>             <fpage>855</fpage>             <lpage>865</lpage>          </element-citation></ref>
<ref id="pcbi.1000832-Wang2"><label>16</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Wang</surname><given-names>Y</given-names></name>
<name name-style="western"><surname>Opperman</surname><given-names>L</given-names></name>
<name name-style="western"><surname>Wickens</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Hall</surname><given-names>TM</given-names></name>
</person-group>             <year>2009</year>             <article-title>Structural basis for specific recognition of multiple mRNA targets by a PUF regulatory protein.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>106(48)</volume>             <fpage>20186</fpage>             <lpage>20191</lpage>          </element-citation></ref>
<ref id="pcbi.1000832-Aviv1"><label>17</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Aviv</surname><given-names>T</given-names></name>
<name name-style="western"><surname>Lin</surname><given-names>Z</given-names></name>
<name name-style="western"><surname>Ben-Ari</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Smibert</surname><given-names>CA</given-names></name>
<name name-style="western"><surname>Sicheri</surname><given-names>F</given-names></name>
</person-group>             <year>2006</year>             <article-title>Sequence-specific recognition of RNA hairpins by the SAM domain of Vts1.</article-title>             <source>Nat Struct Mol Biol</source>             <volume>13</volume>             <fpage>168</fpage>             <lpage>176</lpage>          </element-citation></ref>
<ref id="pcbi.1000832-Foat2"><label>18</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Foat</surname><given-names>BC</given-names></name>
<name name-style="western"><surname>Stormo</surname><given-names>GD</given-names></name>
</person-group>             <year>2009</year>             <article-title>Discovering structural cis-regulatory elements by modeling the behaviors of mRNAs.</article-title>             <source>Mol Systems Biol</source>             <volume>5</volume>             <fpage>268</fpage>          </element-citation></ref>
<ref id="pcbi.1000832-Foat3"><label>19</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Foat</surname><given-names>BC</given-names></name>
<name name-style="western"><surname>Morozov</surname><given-names>AV</given-names></name>
<name name-style="western"><surname>Bussemaker</surname><given-names>HJ</given-names></name>
</person-group>             <year>2006</year>             <article-title>Statistical mechanical modeling of genome-wide transcription factor occupancy data by MatrixREDUCE.</article-title>             <source>Bioinformatics</source>             <volume>22(14)</volume>             <fpage>e141</fpage>             <lpage>e149</lpage>          </element-citation></ref>
<ref id="pcbi.1000832-Bailey1"><label>20</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Bailey</surname><given-names>TL</given-names></name>
<name name-style="western"><surname>Williams</surname><given-names>N</given-names></name>
<name name-style="western"><surname>Misleh</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Li</surname><given-names>WW</given-names></name>
</person-group>             <year>2006</year>             <article-title>MEME: discovering and analyzing DNA and protein sequence motifs.</article-title>             <source>Nucleic Acids Res</source>             <volume>34</volume>             <fpage>W369</fpage>             <lpage>W373</lpage>          </element-citation></ref>
<ref id="pcbi.1000832-Eddy1"><label>21</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Eddy</surname><given-names>SR</given-names></name>
<name name-style="western"><surname>Durbin</surname><given-names>R</given-names></name>
</person-group>             <year>1994</year>             <article-title>RNA sequence analysis using covariance models.</article-title>             <source>Nucleic Acids Res</source>             <volume>22</volume>             <fpage>2079</fpage>             <lpage>2088</lpage>          </element-citation></ref>
<ref id="pcbi.1000832-GriffithsJones1"><label>22</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Griffiths-Jones</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Moxon</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Marshall</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Khanna</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Eddy</surname><given-names>SR</given-names></name>
<etal/></person-group>             <year>2005</year>             <article-title>Rfam: annotating non-coding RNAs in complete genomes.</article-title>             <source>Nucleic Acids Res</source>             <volume>33(Database issue)</volume>             <fpage>D121</fpage>             <lpage>D124</lpage>             <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gki081" xlink:type="simple">10.1093/nar/gki081</ext-link></comment>          </element-citation></ref>
<ref id="pcbi.1000832-Eddy2"><label>23</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Eddy</surname><given-names>SR</given-names></name>
</person-group>             <year>1993</year>             <article-title>User's guide for COVE - covariance models of RNA sequence families.</article-title>             <comment>MRC Lab of Mol Biol, Cambridge, UK [Guide tex in cove-2.4.4.tar.Z]</comment>          </element-citation></ref>
<ref id="pcbi.1000832-Silanes1"><label>24</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Silanes</surname><given-names>IL</given-names></name>
<name name-style="western"><surname>Zhan</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Lal</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Yang</surname><given-names>X</given-names></name>
<name name-style="western"><surname>Gorospe</surname><given-names>M</given-names></name>
</person-group>             <year>2004</year>             <article-title>Identification of a target RNA motif for RNA-binding protein HuR.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>101(9)</volume>             <fpage>2987</fpage>             <lpage>2992</lpage>          </element-citation></ref>
<ref id="pcbi.1000832-Rabani1"><label>25</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Rabani</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Kersetz</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Segal</surname><given-names>E</given-names></name>
</person-group>             <year>2008</year>             <article-title>Computational prediction of RNA structural motifs involved in posttranscriptional regulatory processes.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>105(39)</volume>             <fpage>14885</fpage>             <lpage>14890</lpage>          </element-citation></ref>
<ref id="pcbi.1000832-Gerber1"><label>26</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Gerber</surname><given-names>AP</given-names></name>
<name name-style="western"><surname>Herschlag</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Brown</surname><given-names>PO</given-names></name>
</person-group>             <year>2004</year>             <article-title>Extensive association of functionally and cytotopically related mRNAs with PuF family RNA-binding proteins in yeast.</article-title>             <source>PLoS Biol</source>             <volume>2(3)</volume>             <fpage>e79</fpage>          </element-citation></ref>
<ref id="pcbi.1000832-Miller1"><label>27</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Miller</surname><given-names>MT</given-names></name>
<name name-style="western"><surname>Higgin</surname><given-names>JJ</given-names></name>
<name name-style="western"><surname>Hall</surname><given-names>TM</given-names></name>
</person-group>             <year>2008</year>             <article-title>Basis of altered RNA-binding specificity by PUF proteins revealed by crystal structures of yeast Puf4p.</article-title>             <source>Nat Struct Mol Biol</source>             <volume>15(4)</volume>             <fpage>397</fpage>             <lpage>402</lpage>          </element-citation></ref>
<ref id="pcbi.1000832-Segal1"><label>28</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Segal</surname><given-names>E</given-names></name>
<name name-style="western"><surname>Barash</surname><given-names>Y</given-names></name>
<name name-style="western"><surname>Simon</surname><given-names>I</given-names></name>
<name name-style="western"><surname>Friedman</surname><given-names>N</given-names></name>
<name name-style="western"><surname>Koller</surname><given-names>D</given-names></name>
</person-group>             <year>2002</year>             <article-title>From promoter sequence to expression: a probabilistic framework.</article-title>             <source>In Proc RECOMB</source>             <fpage>263</fpage>             <lpage>272</lpage>          </element-citation></ref>
<ref id="pcbi.1000832-Sinha1"><label>29</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Sinha</surname><given-names>S</given-names></name>
</person-group>             <year>2006</year>             <article-title>On counting position weight matrix matches in a sequence, with application to discriminative motif finding.</article-title>             <source>Bioinformatics</source>             <volume>22(14)</volume>             <fpage>e454</fpage>             <lpage>e463</lpage>          </element-citation></ref>
<ref id="pcbi.1000832-Ding1"><label>30</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Ding</surname><given-names>Y</given-names></name>
<name name-style="western"><surname>Lawrence</surname><given-names>CE</given-names></name>
</person-group>             <year>2003</year>             <article-title>A statistical sampling algorithm for RNA secondary structure prediction.</article-title>             <source>Nucleic Acids Res</source>             <volume>31</volume>             <fpage>7280</fpage>             <lpage>7301</lpage>          </element-citation></ref>
<ref id="pcbi.1000832-Granek1"><label>31</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Granek</surname><given-names>JA</given-names></name>
<name name-style="western"><surname>Clarke</surname><given-names>ND</given-names></name>
</person-group>             <year>2005</year>             <article-title>Explicit equilibrium modeling of transcription-factor binding and gene regulation.</article-title>             <source>Genome Biology</source>             <volume>6</volume>             <fpage>R87</fpage>          </element-citation></ref>
<ref id="pcbi.1000832-Roider1"><label>32</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Roider</surname><given-names>HG</given-names></name>
<name name-style="western"><surname>Kanhere</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Manke</surname><given-names>T</given-names></name>
<name name-style="western"><surname>Vingron</surname><given-names>M</given-names></name>
</person-group>             <year>2007</year>             <article-title>Predicting transcription factor affinities to DNA from a biophysical model.</article-title>             <source>Bioinformatics</source>             <volume>23(2)</volume>             <fpage>134</fpage>             <lpage>141</lpage>          </element-citation></ref>
<ref id="pcbi.1000832-Meisner1"><label>33</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Meisner</surname><given-names>NC</given-names></name>
<name name-style="western"><surname>Hackermuller</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Uhl</surname><given-names>V</given-names></name>
<name name-style="western"><surname>Aszodi</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Jaritz</surname><given-names>M</given-names></name>
<etal/></person-group>             <year>2004</year>             <article-title>mRNA openers and closers: modulating AU-rich element controlled mRNA stability by a molecular switch in mRNA secondary structure.</article-title>             <source>Chembiochem</source>             <volume>5</volume>             <fpage>1432</fpage>             <lpage>1447</lpage>          </element-citation></ref>
<ref id="pcbi.1000832-Tsai1"><label>34</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Tsai</surname><given-names>DE</given-names></name>
<name name-style="western"><surname>Harper</surname><given-names>DS</given-names></name>
<name name-style="western"><surname>Keene</surname><given-names>J</given-names></name>
</person-group>             <year>1991</year>             <article-title>U1-snRNP-A protein selects a ten nucleotide consensus sequence from a degenerate RNA pool presented in various structure contexts.</article-title>             <source>Nucleic Acids Res</source>             <volume>19(18)</volume>             <fpage>4931</fpage>             <lpage>4936</lpage>          </element-citation></ref>
<ref id="pcbi.1000832-Law1"><label>35</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Law</surname><given-names>MJ</given-names></name>
<name name-style="western"><surname>Rice</surname><given-names>AJ</given-names></name>
<name name-style="western"><surname>Lin</surname><given-names>P</given-names></name>
<name name-style="western"><surname>Laird-Offringa</surname><given-names>IA</given-names></name>
</person-group>             <year>2006</year>             <article-title>The role of RNA structure in the interaction of U1A protein with U1 hairpin II RNA.</article-title>             <source>RNA</source>             <volume>12</volume>             <fpage>1168</fpage>             <lpage>1178</lpage>          </element-citation></ref>
<ref id="pcbi.1000832-Wickham1"><label>36</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Wickham</surname><given-names>L</given-names></name>
<name name-style="western"><surname>Duchaine</surname><given-names>T</given-names></name>
<name name-style="western"><surname>Luo</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Nabi</surname><given-names>IR</given-names></name>
<name name-style="western"><surname>DesGroseillers</surname><given-names>L</given-names></name>
</person-group>             <year>1999</year>             <article-title>Mammalian Staufen is a double-stranded-RNA- and tubulin-binding protein which localizes to the rough endoplasmic reticulum.</article-title>             <source>Mol Cell Biol</source>             <volume>19</volume>             <fpage>2220</fpage>             <lpage>2230</lpage>          </element-citation></ref>
<ref id="pcbi.1000832-Byrd1"><label>37</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Byrd</surname><given-names>RH</given-names></name>
<name name-style="western"><surname>Lu</surname><given-names>P</given-names></name>
<name name-style="western"><surname>Nocedal</surname><given-names>J</given-names></name>
</person-group>             <year>1995</year>             <article-title>A limited memory algorithm for bound constrained optimization.</article-title>             <source>SIAM Journal on Scientific and Statistical Computing</source>             <volume>16</volume>             <fpage>1190</fpage>             <lpage>1208</lpage>          </element-citation></ref>
<ref id="pcbi.1000832-Chen1"><label>38</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Chen</surname><given-names>X</given-names></name>
<name name-style="western"><surname>Hughes</surname><given-names>TR</given-names></name>
<name name-style="western"><surname>Morris</surname><given-names>Q</given-names></name>
</person-group>             <year>2006</year>             <article-title>RankMotif++: a motif search algorithm that accounts for relative ranks of k-mers in binding transcription factors.</article-title>             <source>Bionformatics</source>             <volume>23</volume>             <fpage>72</fpage>             <lpage>79</lpage>          </element-citation></ref>
<ref id="pcbi.1000832-Conlon1"><label>39</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Conlon</surname><given-names>EM</given-names></name>
<name name-style="western"><surname>Liu</surname><given-names>XS</given-names></name>
<name name-style="western"><surname>Lieb</surname><given-names>JD</given-names></name>
<name name-style="western"><surname>Liu</surname><given-names>JS</given-names></name>
</person-group>             <year>2003</year>             <article-title>Integrating regulatory motif discovery and genome-wide expression analysis.</article-title>             <source>Genetics</source>             <volume>100(6)</volume>             <fpage>3339</fpage>             <lpage>3344</lpage>          </element-citation></ref>
<ref id="pcbi.1000832-Bailey2"><label>40</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Bailey</surname><given-names>TM</given-names></name>
<name name-style="western"><surname>Gribskov</surname><given-names>M</given-names></name>
</person-group>             <year>1998</year>             <article-title>Combining evidence using p-values: applications to sequence homology searches.</article-title>             <source>Bioinformatics</source>             <volume>14(1)</volume>             <fpage>48</fpage>             <lpage>54</lpage>          </element-citation></ref>
<ref id="pcbi.1000832-Oberstrass1"><label>41</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Oberstrass</surname><given-names>FC</given-names></name>
<name name-style="western"><surname>Auweter</surname><given-names>SD</given-names></name>
<name name-style="western"><surname>Erat</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Hargous</surname><given-names>Y</given-names></name>
<name name-style="western"><surname>Henning</surname><given-names>A</given-names></name>
<etal/></person-group>             <year>2005</year>             <article-title>Structure of PTB bound to RNA: specific binding and implications for splicing regulation.</article-title>             <source>Science</source>             <volume>309</volume>             <fpage>2054</fpage>             <lpage>2057</lpage>          </element-citation></ref>
<ref id="pcbi.1000832-Workman1"><label>42</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Workman</surname><given-names>CT</given-names></name>
<name name-style="western"><surname>Yin</surname><given-names>Y</given-names></name>
<name name-style="western"><surname>Corcoran</surname><given-names>DL</given-names></name>
<name name-style="western"><surname>Ideker</surname><given-names>T</given-names></name>
<name name-style="western"><surname>Stormo</surname><given-names>GD</given-names></name>
<etal/></person-group>             <year>2005</year>             <article-title>enoLOGOS: a versatile web tool for energy normalized sequence logos.</article-title>             <source>Nucleic Acids Res</source>             <volume>33</volume>             <fpage>W389</fpage>             <lpage>W392</lpage>          </element-citation></ref>
<ref id="pcbi.1000832-Tacke1"><label>43</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Tacke</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Manley</surname><given-names>JL</given-names></name>
</person-group>             <year>1995</year>             <article-title>The human splicing factors ASF/SF2 and SC35 possess different, functionally significant RNA binding specificities.</article-title>             <source>EMBO J</source>             <volume>14</volume>             <fpage>3540</fpage>          </element-citation></ref>
<ref id="pcbi.1000832-Perez1"><label>44</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Perez</surname><given-names>I</given-names></name>
<name name-style="western"><surname>Lin</surname><given-names>CH</given-names></name>
<name name-style="western"><surname>McAfee</surname><given-names>JG</given-names></name>
<name name-style="western"><surname>Patton</surname><given-names>JG</given-names></name>
</person-group>             <year>1997</year>             <article-title>Mutation of PTB binding sites causes misregulation of alternative 3′ splice site selection <italic>in vivo</italic>.</article-title>             <source>RNA</source>             <volume>3</volume>             <fpage>764</fpage>             <lpage>778</lpage>          </element-citation></ref>
<ref id="pcbi.1000832-Shin1"><label>45</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Shin</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Manley</surname><given-names>JL</given-names></name>
</person-group>             <year>2002</year>             <article-title>The SR protein SRp38 represses splicing in M phase cells.</article-title>             <source>Cell</source>             <volume>111</volume>             <fpage>407</fpage>             <lpage>417</lpage>          </element-citation></ref>
<ref id="pcbi.1000832-Berger1"><label>46</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Berger</surname><given-names>MF</given-names></name>
<name name-style="western"><surname>Bulyk</surname><given-names>ML</given-names></name>
</person-group>             <year>2006</year>             <article-title>Protein binding microarrays (PBMs) for the rapid, high-throughput characterization of the sequence specificities of DNA binding proteins.</article-title>             <source>Methods Mol Biol</source>             <volume>338</volume>             <fpage>245</fpage>             <lpage>260</lpage>          </element-citation></ref>
<ref id="pcbi.1000832-Benos1"><label>47</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Benos</surname><given-names>P</given-names></name>
<name name-style="western"><surname>Bulyk</surname><given-names>ML</given-names></name>
<name name-style="western"><surname>Stormo</surname><given-names>GD</given-names></name>
</person-group>             <year>2002</year>             <article-title>Additivity in protein-DNA interactions: how good an approximation is it?</article-title>             <source>Nucleic Acids Res</source>             <volume>30(20)</volume>             <fpage>4442</fpage>             <lpage>4451</lpage>          </element-citation></ref>
<ref id="pcbi.1000832-Bulyk1"><label>48</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Bulyk</surname><given-names>ML</given-names></name>
<name name-style="western"><surname>Johnson</surname><given-names>PLF</given-names></name>
<name name-style="western"><surname>Church</surname><given-names>GM</given-names></name>
</person-group>             <year>2002</year>             <article-title>Nucleotides of transcription factor binding sites exert interdependent effects on the binding affinities of transcription factors.</article-title>             <source>Nucleic Acids Res</source>             <volume>30(5)</volume>             <fpage>1255</fpage>             <lpage>1261</lpage>          </element-citation></ref>
<ref id="pcbi.1000832-Badis1"><label>49</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Badis</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Berger</surname><given-names>MF</given-names></name>
<name name-style="western"><surname>Philippakis</surname><given-names>AA</given-names></name>
<name name-style="western"><surname>Talukder</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Gehrke</surname><given-names>AR</given-names></name>
<etal/></person-group>             <year>2009</year>             <article-title>Diversity and complexity in DNA recognition by transcription factors.</article-title>             <source>Science</source>             <volume>324</volume>             <fpage>1720</fpage>             <lpage>1723</lpage>          </element-citation></ref>
</ref-list>

</back>
</article>