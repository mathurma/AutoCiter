<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article article-type="research-article" dtd-version="3.0" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-15-00803</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1004762</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Optimization</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Brain mapping</subject><subj-group><subject>Functional magnetic resonance imaging</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Diagnostic medicine</subject><subj-group><subject>Diagnostic radiology</subject><subj-group><subject>Magnetic resonance imaging</subject><subj-group><subject>Functional magnetic resonance imaging</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Imaging techniques</subject><subj-group><subject>Diagnostic radiology</subject><subj-group><subject>Magnetic resonance imaging</subject><subj-group><subject>Functional magnetic resonance imaging</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Radiology and imaging</subject><subj-group><subject>Diagnostic radiology</subject><subj-group><subject>Magnetic resonance imaging</subject><subj-group><subject>Functional magnetic resonance imaging</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Imaging techniques</subject><subj-group><subject>Neuroimaging</subject><subj-group><subject>Functional magnetic resonance imaging</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neuroimaging</subject><subj-group><subject>Functional magnetic resonance imaging</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Probability theory</subject><subj-group><subject>Random variables</subject><subj-group><subject>Covariance</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Network analysis</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Neural networks</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neural networks</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Hematology</subject><subj-group><subject>Hemodynamics</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Engineering and technology</subject><subj-group><subject>Signal processing</subject><subj-group><subject>Signal filtering</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject></subj-group></subj-group></article-categories>
<title-group>
<article-title>Estimation of Directed Effective Connectivity from fMRI Functional Connectivity Hints at Asymmetries of Cortical Connectome</article-title>
<alt-title alt-title-type="running-head">Inference of Directed EC from fMRI FC Hints at Cortical Asymmetries</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Gilson</surname> <given-names>Matthieu</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Moreno-Bote</surname> <given-names>Ruben</given-names></name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
<xref ref-type="aff" rid="aff005"><sup>5</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Ponce-Alvarez</surname> <given-names>Adrián</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Ritter</surname> <given-names>Petra</given-names></name>
<xref ref-type="aff" rid="aff006"><sup>6</sup></xref>
<xref ref-type="aff" rid="aff007"><sup>7</sup></xref>
<xref ref-type="aff" rid="aff008"><sup>8</sup></xref>
<xref ref-type="aff" rid="aff009"><sup>9</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Deco</surname> <given-names>Gustavo</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff010"><sup>10</sup></xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Center for Brain Cognition, Dept of Technology and Information, Universitat Pompeu Fabra, Barcelona, Spain</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Research Unit, Parc Sanitari Sant Joan de Déu and Universitat de Barcelona, Esplugues de Llobregat, Barcelona, Spain</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>Centro de Investigación Biomédica en Red de Salud Mental (CIBERSAM), Esplugues de Llobregat, Barcelona, Spain</addr-line>
</aff>
<aff id="aff004">
<label>4</label>
<addr-line>Department of Information and Communication Technologies, Universitat Pompeu Fabra, Barcelona, Spain</addr-line>
</aff>
<aff id="aff005">
<label>5</label>
<addr-line>Serra Húnter Fellow Programme, Universitat Pompeu Fabra, Barcelona, Spain</addr-line>
</aff>
<aff id="aff006">
<label>6</label>
<addr-line>Minerva Research Group Brain Modes, Max Planck Institute for Human Cognitive and Brain Sciences, Leipzig, Germany</addr-line>
</aff>
<aff id="aff007">
<label>7</label>
<addr-line>Department of Neurology, Charité - University Medicine, Berlin, Germany</addr-line>
</aff>
<aff id="aff008">
<label>8</label>
<addr-line>Bernstein Focus State Dependencies of Learning &amp; Bernstein Center for Computational Neuroscience, Berlin, Germany</addr-line>
</aff>
<aff id="aff009">
<label>9</label>
<addr-line>Berlin School of Mind and Brain &amp; Mind and Brain Institute, Humboldt University, Berlin, Germany</addr-line>
</aff>
<aff id="aff010">
<label>10</label>
<addr-line>Institució Catalana de la Recerca i Estudis Avançats, Universitat Barcelona, Barcelona, Spain</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Jbabdi</surname> <given-names>Saad</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Oxford University, UNITED KINGDOM</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con" id="contrib001">
<p>Conceived and designed the experiments: MG GD. Performed the experiments: MG. Analyzed the data: MG RMB APA GD PR. Wrote the paper: MG RMB APA PR GD. Provided experimental data: PR.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">matthieu.gilson@upf.edu</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>3</month>
<year>2016</year>
</pub-date>
<pub-date pub-type="epub">
<day>16</day>
<month>3</month>
<year>2016</year>
</pub-date>
<volume>12</volume>
<issue>3</issue>
<elocation-id>e1004762</elocation-id>
<history>
<date date-type="received">
<day>18</day>
<month>5</month>
<year>2015</year>
</date>
<date date-type="accepted">
<day>20</day>
<month>1</month>
<year>2016</year>
</date>
</history>
<permissions>
<copyright-year>2016</copyright-year>
<copyright-holder>Gilson et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1004762"/>
<abstract>
<p>The brain exhibits complex spatio-temporal patterns of activity. This phenomenon is governed by an interplay between the internal neural dynamics of cortical areas and their connectivity. Uncovering this complex relationship has raised much interest, both for theory and the interpretation of experimental data (e.g., fMRI recordings) using dynamical models. Here we focus on the so-called inverse problem: the inference of network parameters in a cortical model to reproduce empirically observed activity. Although it has received a lot of interest, recovering directed connectivity for large networks has been rather unsuccessful so far. The present study specifically addresses this point for a noise-diffusion network model. We develop a Lyapunov optimization that iteratively tunes the network connectivity in order to reproduce second-order moments of the node activity, or functional connectivity. We show theoretically and numerically that the use of covariances with both zero and non-zero time shifts is the key to infer directed connectivity. The first main theoretical finding is that an accurate estimation of the underlying network connectivity requires that the time shift for covariances is matched with the time constant of the dynamical system. In addition to the network connectivity, we also adjust the intrinsic noise received by each network node. The framework is applied to experimental fMRI data recorded for subjects at rest. Diffusion-weighted MRI data provide an estimate of anatomical connections, which is incorporated to constrain the cortical model. The empirical covariance structure is reproduced faithfully, especially its temporal component (i.e., time-shifted covariances) in addition to the spatial component that is usually the focus of studies. We find that the cortical interactions, referred to as effective connectivity, in the tuned model are not reciprocal. In particular, hubs are either receptors or feeders: they do not exhibit both strong incoming and outgoing connections. Our results sets a quantitative ground to explore the propagation of activity in the cortex.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>The study of interactions between different cortical regions at rest or during a task has considerably developed in the past decades thanks to progress in non-invasive imaging techniques, such as fMRI, EEG and MEG. These techniques have revealed that distant cortical areas exhibit specific correlated activity during the resting state, also called functional connectivity (FC). Moreover, recent studies have highlighted the possible role of white-matter projections between cortical regions in shaping these activity patterns. This structural connectivity (SC) can be estimated using MRI, which measures the probability for two areas to be connected via the density of neural fibers. However, this does not provide the strengths of dynamical interactions. Many methods have thus been developed to estimate the connectivity between neural populations in the cortex that is hypothesized to shape FC. The strengths of these dynamical interactions are called effective connectivity (EC). We use a cortical model that combines information from Diffusion-weighted MRI (dwMRI) and fMRI in order to estimate EC. We demonstrate theoretically that directed <italic>C</italic> can be inferred using time-shifted covariances. The key point of our method is the use of temporal information from FC at the scale of the whole network. Applying our model on experimental fMRI data at rest, we estimate the asymmetry of intracortical connectivity. Obtaining an accurate EC estimate is essential to analyze its graph properties, such as hubs. In particular, directed connectivity links to the asymmetry between input and output EC strengths of each node, which characterizes feeder and receiver hubs in the cortical network.</p>
</abstract>
<funding-group>
<funding-statement>MG and GD acknowledge funding from the FP7 FET ICT Flagship Human Brain Project (604102). RMB acknowledges funding from the Ramon y Cajal Spanish Award (RYC-2010-05952), the Marie Curie FP7-PEOPLE-2010-IRG (PIRG08-GA-2010-276795), and the Programa Estatal de Investigacion Cientifica y Tecnica de Excelencia (PSI2013-44811-P). PR acknowledges funding from the James S. McDonnell Foundation(JSMF22002082), the German Ministry of Education and Research (01GQ0971), and the Max-Planck-Gesellschaft (Minerva Program). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="10"/>
<table-count count="3"/>
<page-count count="30"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant information about the model are within the paper. Information about the experimental data (including a link to the data themselves, via the website thevirtualbrain.org) can be found in the following publication referenced in the manuscript: Schirner M, Rothmeier S, Jirsa V, McIntosh A, Ritter P. An automated pipeline for constructing personalised virtual brains from multimodal neuroimaging data. Neuroimage. 2015: 117, 343-357.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Patterns of neural activity at the scale of the whole cortex can be quantified by the correlations between the cortical regions. This so-called functional connectivity (FC) is predicted to some extent by the anatomical synaptic pathways in the white matter, or structural connectivity (SC) [<xref ref-type="bibr" rid="pcbi.1004762.ref001">1</xref>]. However, SC measures the neural fiber density and is not sufficient to fully explain the structure of FC, which also depends on the dynamics of network nodes. The dynamical interactions between cortical areas is captured by the ‘effective connectivity’ (EC), a concept that has emerged over years following progress in imaging techniques and related modeling [<xref ref-type="bibr" rid="pcbi.1004762.ref002">2</xref>–<xref ref-type="bibr" rid="pcbi.1004762.ref005">5</xref>]. In network models, EC is the key to understand the propagation of information, which links the network structure to function. Importantly, EC is model-dependent, which makes the comparison between studies non trivial and has raised much debate recently [<xref ref-type="bibr" rid="pcbi.1004762.ref006">6</xref>–<xref ref-type="bibr" rid="pcbi.1004762.ref008">8</xref>]. On the biological ground, EC accounts for mechanisms that determine the synaptic strength (e.g., types and concentration of neurotransmitters), as well as dynamic properties such as neural excitability that may vary with the local activity level and thus depend on the inputs to the network. This means that EC may differ from the anatomical SC obtained from dwMRI. FC and EC classically relate to data and models related to imaging techniques: fMRI, EEG and MEG. Beyond the analysis of these experimental data, uncovering the relationship between connectivity and activity has attracted much interest recently, with a particular focus for non-trivial connectivity topologies that mimic those observed in the biology [<xref ref-type="bibr" rid="pcbi.1004762.ref009">9</xref>–<xref ref-type="bibr" rid="pcbi.1004762.ref012">12</xref>]. Within this field, the inference of the network connectivity from empirically observed activity is an active line of research [<xref ref-type="bibr" rid="pcbi.1004762.ref001">1</xref>, <xref ref-type="bibr" rid="pcbi.1004762.ref013">13</xref>–<xref ref-type="bibr" rid="pcbi.1004762.ref016">16</xref>] and is the purpose of the present study.</p>
<p>In order to infer the connectivity from empirical observations, one needs to define observables of the activity that the network model has to reproduce. Designing adequate and efficient estimation procedures is as important as the properties of the model itself. Over the past years, many techniques have been developed for various dynamical models: for oscillator networks based on synchrony [<xref ref-type="bibr" rid="pcbi.1004762.ref017">17</xref>] and covariances [<xref ref-type="bibr" rid="pcbi.1004762.ref018">18</xref>, <xref ref-type="bibr" rid="pcbi.1004762.ref019">19</xref>]; structural equation models (SEMs) [<xref ref-type="bibr" rid="pcbi.1004762.ref020">20</xref>, <xref ref-type="bibr" rid="pcbi.1004762.ref021">21</xref>]; statistical methods for generalized linear models (GLMs) [<xref ref-type="bibr" rid="pcbi.1004762.ref013">13</xref>, <xref ref-type="bibr" rid="pcbi.1004762.ref022">22</xref>]; Granger causality in spiking networks with nonlinear dynamics [<xref ref-type="bibr" rid="pcbi.1004762.ref014">14</xref>, <xref ref-type="bibr" rid="pcbi.1004762.ref023">23</xref>]; transfer entropy for an abstract model of neural activity observed via calcium imaging [<xref ref-type="bibr" rid="pcbi.1004762.ref024">24</xref>]; spike-time covariances in networks of Poisson neurons [<xref ref-type="bibr" rid="pcbi.1004762.ref025">25</xref>]; covariances for multivariate Ornstein-Uhlenbeck processes [<xref ref-type="bibr" rid="pcbi.1004762.ref016">16</xref>] with recent developments to estimate directed connectivity [<xref ref-type="bibr" rid="pcbi.1004762.ref026">26</xref>]; for the dynamic causal model (DCM) [<xref ref-type="bibr" rid="pcbi.1004762.ref005">5</xref>, <xref ref-type="bibr" rid="pcbi.1004762.ref015">15</xref>]. As a general rule, three factors limit the accuracy of connectivity estimation: the size of the network, the amount of empirically observed activity and nonlinearities in the mapping between the connectivity and the activity observables. Moreover, the directionality of interactions between nodes is harder to estimate than the existence of an interaction between two nodes.</p>
<p>Here we do not focus on the detection of connections, which often involves statistical tests, but we want to estimate the ranking of individual weights in networks of about a hundred of nodes. In Methods, we develop the theory to recover from observed covariances (taken as FC) the network connectivity as well as the intrinsic variability experienced by individual nodes in a noise-diffusion (ND) network. More precisely, we perform a Lyapunov optimization (LO) during which the network parameters are tuned iteratively such that the network reproduces two covariance matrices set as ‘objectives’, or goals. This allows for the use of constraints on the network parameters, such as enforcing partial connectivity. The model is a multivariate Ornstein-Uhlenbeck process, where the activity fluctuations are caused by the intrinsic noise and shaped by the recurrent connections to generate the spatio-temporal covariance pattern. Compared to previous studies [<xref ref-type="bibr" rid="pcbi.1004762.ref018">18</xref>], we focus on the situation where the network effect is strong, meaning that FC significantly differs from EC: even unconnected or weakly connected nodes can be strongly correlated. This situation was considered for symmetric EC [<xref ref-type="bibr" rid="pcbi.1004762.ref027">27</xref>, <xref ref-type="bibr" rid="pcbi.1004762.ref028">28</xref>]. As reviewed in [<xref ref-type="bibr" rid="pcbi.1004762.ref015">15</xref>] for the DCM model, many methods only consider connections individually for the observables; in contrast, partial correlations and multivariate autoregressive models (MVAR) consider the entire network activity and give the best performance for detecting undirected connections in that study. Our method also relies on the network covariances as a whole to estimate the connectivity. The performance of the estimation procedure for artificial networks is the subject of the first half of Results.</p>
<p>Following previous studies [<xref ref-type="bibr" rid="pcbi.1004762.ref001">1</xref>, <xref ref-type="bibr" rid="pcbi.1004762.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1004762.ref005">5</xref>, <xref ref-type="bibr" rid="pcbi.1004762.ref027">27</xref>, <xref ref-type="bibr" rid="pcbi.1004762.ref029">29</xref>], we apply our theory to the estimation of cortico-cortical connectivity from fMRI data. Obtaining quantitative estimates for the connectivity is important to gain insight on the information flow within the cortex [<xref ref-type="bibr" rid="pcbi.1004762.ref030">30</xref>]. In our ND model, EC coincides with the recurrent connectivity. In many models applied to fMRI data such as the DCM [<xref ref-type="bibr" rid="pcbi.1004762.ref005">5</xref>] and dynamic mean-field (DMF) model [<xref ref-type="bibr" rid="pcbi.1004762.ref001">1</xref>], the hemodynamic response function (HRF) transforms the neural activity into the BOLD signal, introducing nonlinearity in the mapping EC-FC. Our ND model does not explicitly incorporate hemodynamics, so the estimated EC describes the interactions between cortical regions via the proxy of the BOLD signals. Therefore, we test our method on the more elaborate DMF model that incorporates a HRF [<xref ref-type="bibr" rid="pcbi.1004762.ref027">27</xref>]. Specifically, we verify that the spatio-temporal covariances in the DMF model with time shifts of seconds convey information about the underlying neural connectivity, which is required for our method to be successfully applied to fMRI data. Then, we check the agreement of the EC estimated using the ND model coincides with the neural connectivity of the DMF model. Finally we examine the consistency of our results when varying optimization parameters, in particular the time shift for the objective covariance matrices. In several previous models of the whole cortex [<xref ref-type="bibr" rid="pcbi.1004762.ref012">12</xref>, <xref ref-type="bibr" rid="pcbi.1004762.ref027">27</xref>, <xref ref-type="bibr" rid="pcbi.1004762.ref028">28</xref>, <xref ref-type="bibr" rid="pcbi.1004762.ref031">31</xref>], EC corresponds to a scaled version of SC matrix obtained from diffusion tensor imaging, which is quasi symmetric. The corresponding fitting procedures often rely on zero-time-shift correlations, which implies that the directionality of cortical connections can hardly be estimated. In contrast, another direction of research has investigated directed interactions, but only for a small number of cortical areas [<xref ref-type="bibr" rid="pcbi.1004762.ref002">2</xref>–<xref ref-type="bibr" rid="pcbi.1004762.ref005">5</xref>, <xref ref-type="bibr" rid="pcbi.1004762.ref007">7</xref>, <xref ref-type="bibr" rid="pcbi.1004762.ref020">20</xref>, <xref ref-type="bibr" rid="pcbi.1004762.ref032">32</xref>]. By recovering the strengths of individual connections and intrinsic variability for the whole cortex divided in 68 areas, we aim to combine the advantages of those studies.</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Methods</title>
<p>We present the theory used to go back and forth between the network parameters and the observables:</p>
<list list-type="bullet">
<list-item>
<p>the forward problem: calculation of theoretical covariance matrices <italic>Q</italic><sup>0</sup> and <italic>Q</italic><sup><italic>τ</italic></sup> for given matrices for the network connectivity <italic>C</italic> and intrinsic noise Σ;</p>
</list-item>
<list-item>
<p>the inverse problem: estimation of <italic>C</italic> with fixed Σ and estimation of both <italic>C</italic> and Σ when the <italic>Q</italic> matrix(ces) is(are) known.</p>
</list-item>
</list>
<p>The variables of importance are described in <xref ref-type="table" rid="pcbi.1004762.t001">Table 1</xref>.</p>
<table-wrap id="pcbi.1004762.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004762.t001</object-id>
<label>Table 1</label>
<caption>
<title>Table of variables used in Methods and Results.</title>
</caption>
<alternatives>
<graphic id="pcbi.1004762.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004762.t001" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left">Variable name</th>
<th align="center">Symbol</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">node activity</td>
<td align="center">
<inline-formula id="pcbi.1004762.e001">
<alternatives>
<graphic id="pcbi.1004762.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e001" xlink:type="simple"/>
<mml:math display="inline" id="M1">
<mml:msubsup>
<mml:mi>x</mml:mi>
<mml:mi>i</mml:mi>
<mml:mi>t</mml:mi>
</mml:msubsup>
</mml:math>
</alternatives>
</inline-formula>
</td>
</tr>
<tr>
<td align="left">model network connectivity</td>
<td align="center"><italic>C</italic></td>
</tr>
<tr>
<td align="left">noise matrix (intrinsic variability)</td>
<td align="center">Σ</td>
</tr>
<tr>
<td align="left">model zero-time-shift covariances</td>
<td align="center"><italic>Q</italic><sup>0</sup></td>
</tr>
<tr>
<td align="left">model time-shifted covariances</td>
<td align="center"><italic>Q</italic><sup><italic>τ</italic></sup></td>
</tr>
<tr>
<td align="left">objective zero-time-shift covariances</td>
<td align="center">
<inline-formula id="pcbi.1004762.e002">
<alternatives>
<graphic id="pcbi.1004762.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e002" xlink:type="simple"/>
<mml:math display="inline" id="M2">
<mml:msup>
<mml:mover accent="true">
<mml:mi>Q</mml:mi>
<mml:mo>^</mml:mo>
</mml:mover>
<mml:mn>0</mml:mn>
</mml:msup>
</mml:math>
</alternatives>
</inline-formula>
</td>
</tr>
<tr>
<td align="left">objective time-shifted covariances</td>
<td align="center">
<inline-formula id="pcbi.1004762.e003">
<alternatives>
<graphic id="pcbi.1004762.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e003" xlink:type="simple"/>
<mml:math display="inline" id="M3">
<mml:msup>
<mml:mover accent="true">
<mml:mi>Q</mml:mi>
<mml:mo>^</mml:mo>
</mml:mover>
<mml:mi>τ</mml:mi>
</mml:msup>
</mml:math>
</alternatives>
</inline-formula>
</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>We consider a network of interconnected neural populations, as schematized in <xref ref-type="fig" rid="pcbi.1004762.g001">Fig 1A</xref>. The matrix <italic>C</italic> in <xref ref-type="fig" rid="pcbi.1004762.g001">Fig 1B</xref> represents the connection strengths for such a network of size 50. In our model, each node receives noise that propagates due to the recurrent connectivity. The activity in population <italic>i</italic> is described by the variable <inline-formula id="pcbi.1004762.e004"><alternatives><graphic id="pcbi.1004762.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:msubsup><mml:mi>x</mml:mi> <mml:mi>i</mml:mi> <mml:mi>t</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>, where <italic>t</italic> denotes the time. An example for the activity of two nodes is displayed in the left graph of <xref ref-type="fig" rid="pcbi.1004762.g001">Fig 1C</xref>. We analyze the neural dynamics up to the second-order fluctuations, assuming stationarity of the whole stochastic process. The means <inline-formula id="pcbi.1004762.e005"><alternatives><graphic id="pcbi.1004762.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula> and covariances <inline-formula id="pcbi.1004762.e006"><alternatives><graphic id="pcbi.1004762.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:msubsup><mml:mi>Q</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>τ</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> of variables <inline-formula id="pcbi.1004762.e007"><alternatives><graphic id="pcbi.1004762.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:msubsup><mml:mi>x</mml:mi> <mml:mi>i</mml:mi> <mml:mi>t</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> are defined as:
<disp-formula id="pcbi.1004762.e008"><alternatives><graphic id="pcbi.1004762.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e008" xlink:type="simple"/><mml:math display="block" id="M8"><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mo>〈</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo>〉</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mi>Q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>τ</mml:mi></mml:msubsup></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mo>〈</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>〉</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math>
</alternatives> <label>(1)</label></disp-formula>
where the angular brackets correspond to the average over the randomness due to the noise. The empirical covariances are evaluated from the discrete time series <inline-formula id="pcbi.1004762.e009"><alternatives><graphic id="pcbi.1004762.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:msubsup><mml:mi>x</mml:mi> <mml:mi>i</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> with the corresponding time shifts from the activity of <italic>n</italic><sub><italic>sim</italic></sub> simulated sessions with <italic>T</italic> samples each:
<disp-formula id="pcbi.1004762.e010"><alternatives><graphic id="pcbi.1004762.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e010" xlink:type="simple"/><mml:math display="block" id="M10"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>τ</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mtext>sim</mml:mtext></mml:msub> <mml:mi>T</mml:mi></mml:mrow></mml:mfrac> <mml:munder><mml:mo>∑</mml:mo> <mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn> <mml:mo>≤</mml:mo> <mml:mi>n</mml:mi> <mml:mo>≤</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mtext>sim</mml:mtext></mml:msub></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn> <mml:mo>≤</mml:mo> <mml:mi>t</mml:mi> <mml:mo>&lt;</mml:mo> <mml:mi>T</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:munder> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>x</mml:mi> <mml:mi>i</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:msubsup> <mml:mo>-</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>x</mml:mi> <mml:mi>j</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mi>τ</mml:mi></mml:mrow></mml:msubsup> <mml:mo>-</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>j</mml:mi> <mml:mi>n</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(2)</label></disp-formula>
where the means <inline-formula id="pcbi.1004762.e011"><alternatives><graphic id="pcbi.1004762.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e011" xlink:type="simple"/><mml:math display="inline" id="M11"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:msub><mml:mo>∑</mml:mo> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>≤</mml:mo> <mml:mi>t</mml:mi> <mml:mo>&lt;</mml:mo> <mml:mi>T</mml:mi></mml:mrow></mml:msub> <mml:msubsup><mml:mi>x</mml:mi> <mml:mi>i</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:msubsup> <mml:mo>/</mml:mo> <mml:mi>T</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> are evaluated for each session. The stationarity hypothesis implies that averaging <inline-formula id="pcbi.1004762.e012"><alternatives><graphic id="pcbi.1004762.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e012" xlink:type="simple"/><mml:math display="inline" id="M12"><mml:msubsup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>τ</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> over for a sufficiently long period gives the probabilistic mean <inline-formula id="pcbi.1004762.e013"><alternatives><graphic id="pcbi.1004762.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e013" xlink:type="simple"/><mml:math display="inline" id="M13"><mml:msubsup><mml:mi>Q</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>τ</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>. For the time series in <xref ref-type="fig" rid="pcbi.1004762.g001">Fig 1C</xref>, we obtain the <inline-formula id="pcbi.1004762.e014"><alternatives><graphic id="pcbi.1004762.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e014" xlink:type="simple"/><mml:math display="inline" id="M14"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>0</mml:mn></mml:msup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1004762.e015"><alternatives><graphic id="pcbi.1004762.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e015" xlink:type="simple"/><mml:math display="inline" id="M15"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>τ</mml:mi></mml:msup></mml:math></alternatives></inline-formula> matrices in <xref ref-type="fig" rid="pcbi.1004762.g001">Fig 1D</xref>. By definition, the matrix <italic>Q</italic><sup><italic>τ</italic></sup> is symmetric for <italic>τ</italic> = 0, but its asymmetry increases with <italic>τ</italic>, as shown by lighter plotted dots and fitting curves in <xref ref-type="fig" rid="pcbi.1004762.g001">Fig 1F</xref>.</p>
<fig id="pcbi.1004762.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004762.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Network of interacting neural populations.</title>
<p><bold>A</bold> Schematic diagram of the ND model: the neural populations (purple circles) receive noisy inputs as well as recurrent feedback (gray and red connections, respectively). The topology is non-random: 2 groups of interconnected populations (green dashed boxes) are linked by hubs (cyan dashed box), but the hubs are not connected to each other. <bold>B</bold> Connectivity matrix <italic>C</italic> for a network of 50 populations, corresponding to the strengths of the red connections in A. The indices for the two groups are indicated by the green bars, and hubs by the cyan bar. <bold>C</bold> Example time series between two populations in the network, one from the large group in A and a hub. In the right panel, the darker curve is shifted by <italic>τ</italic> = 1 s. <bold>D</bold> Empirical covariance matrices between all neural populations, evaluated from the time series in C with the two time shifts: <italic>τ</italic> = 0 for <inline-formula id="pcbi.1004762.e016"><alternatives><graphic id="pcbi.1004762.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e016" xlink:type="simple"/><mml:math display="inline" id="M16"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>0</mml:mn></mml:msup></mml:math></alternatives></inline-formula> and <italic>τ</italic> = 1 s for <inline-formula id="pcbi.1004762.e017"><alternatives><graphic id="pcbi.1004762.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e017" xlink:type="simple"/><mml:math display="inline" id="M17"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>τ</mml:mi></mml:msup></mml:math></alternatives></inline-formula>; see expression for <italic>Q</italic><sup><italic>τ</italic></sup> in <xref ref-type="disp-formula" rid="pcbi.1004762.e010">Eq (2)</xref>. The color scale is adjusted to focus on off-diagonal elements. <bold>E</bold> Logarithm of autocovariance <inline-formula id="pcbi.1004762.e018"><alternatives><graphic id="pcbi.1004762.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e018" xlink:type="simple"/><mml:math display="inline" id="M18"><mml:msubsup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>i</mml:mi></mml:mrow> <mml:mi>τ</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> for each node <italic>i</italic> as a function of <italic>τ</italic>. The mean over all nodes (blue curve) has a slope close to 1/<italic>τ</italic><sub><italic>x</italic></sub> (black line). <bold>F</bold> Asymmetry of theoretical <italic>Q</italic><sup><italic>τ</italic></sup> as a function of the asymmetry of <italic>C</italic>. The asymmetry index in <xref ref-type="disp-formula" rid="pcbi.1004762.e079">Eq (24)</xref> scales from 0 for symmetric to 1 for antisymmetric matrices. Three time shifts <italic>τ</italic> are displayed (lighter to darker blue), each cross represents a cluster-hub network similar to A and the corresponding line indicates the linear fit. <bold>G</bold> Network effect indicated by the weak match between <italic>C</italic> weights and <italic>Q</italic><sup>0</sup> values over all connections. <bold>H</bold> Schematic representation of a step in the Lyapunov optimization (LO) procedure. The model covariances <italic>Q</italic><sup>0,<italic>τ</italic></sup> are evaluated for the current network parameters <italic>C</italic> and Σ. From the comparison between the model <italic>Q</italic><sup><italic>τ</italic>/0</sup> and their objective counterparts <inline-formula id="pcbi.1004762.e019"><alternatives><graphic id="pcbi.1004762.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e019" xlink:type="simple"/><mml:math display="inline" id="M19"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>τ</mml:mi> <mml:mo>/</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>, the desired updates Δ<italic>C</italic> and ΔΣ for the model parameters are calculated.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004762.g001" xlink:type="simple"/>
</fig>
<sec id="sec003">
<title>Model of interconnected cortical areas</title>
<p>The node activity is governed by the following coupled ordinary differential stochastic equations:
<disp-formula id="pcbi.1004762.e020"><alternatives><graphic id="pcbi.1004762.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e020" xlink:type="simple"/><mml:math display="block" id="M20"><mml:mrow><mml:mi mathvariant="normal">d</mml:mi> <mml:msubsup><mml:mi>x</mml:mi> <mml:mi>i</mml:mi> <mml:mi>t</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:mfenced close="]" open="[" separators=""><mml:mo>-</mml:mo> <mml:mfrac><mml:msubsup><mml:mi>x</mml:mi> <mml:mi>i</mml:mi> <mml:mi>t</mml:mi></mml:msubsup> <mml:msub><mml:mi>τ</mml:mi> <mml:mi>x</mml:mi></mml:msub></mml:mfrac> <mml:mo>+</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>≠</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:munder> <mml:msub><mml:mi>C</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:msubsup><mml:mi>x</mml:mi> <mml:mi>k</mml:mi> <mml:mi>t</mml:mi></mml:msubsup> <mml:mo>+</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mfenced> <mml:mi mathvariant="normal">d</mml:mi> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mi mathvariant="normal">d</mml:mi> <mml:msubsup><mml:mi>B</mml:mi> <mml:mi>i</mml:mi> <mml:mi>t</mml:mi></mml:msubsup> <mml:mspace width="4pt"/><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(3)</label></disp-formula>
Each <inline-formula id="pcbi.1004762.e021"><alternatives><graphic id="pcbi.1004762.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e021" xlink:type="simple"/><mml:math display="inline" id="M21"><mml:msubsup><mml:mi>x</mml:mi> <mml:mi>i</mml:mi> <mml:mi>t</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> experiences an exponential decay with time constant <italic>τ</italic><sub><italic>x</italic></sub> and is excited by other <inline-formula id="pcbi.1004762.e022"><alternatives><graphic id="pcbi.1004762.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e022" xlink:type="simple"/><mml:math display="inline" id="M22"><mml:msubsup><mml:mi>x</mml:mi> <mml:mi>k</mml:mi> <mml:mi>t</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> whose contributions are scaled by the recurrent weights <italic>C</italic><sub><italic>ij</italic></sub>. Fluctuations are generated by the Gaussian white noise <inline-formula id="pcbi.1004762.e023"><alternatives><graphic id="pcbi.1004762.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e023" xlink:type="simple"/><mml:math display="inline" id="M23"><mml:mrow><mml:mi mathvariant="normal">d</mml:mi> <mml:msubsup><mml:mi>B</mml:mi> <mml:mi>i</mml:mi> <mml:mi>t</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> that has variance (<italic>σ</italic><sub><italic>i</italic></sub>)<sup>2</sup>; formally, <inline-formula id="pcbi.1004762.e024"><alternatives><graphic id="pcbi.1004762.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e024" xlink:type="simple"/><mml:math display="inline" id="M24"><mml:msubsup><mml:mi>B</mml:mi> <mml:mi>i</mml:mi> <mml:mi>t</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> is a Wiener process scaled by a factor <italic>σ</italic><sub><italic>i</italic></sub>. We forbid self-connections, i.e., <italic>C</italic><sub><italic>ii</italic></sub> = 0, although this is not crucial. In practice and without loss of generality, the input <italic>e</italic><sub><italic>i</italic></sub> is homogeneous for all nodes.</p>
<p>Following previous work [<xref ref-type="bibr" rid="pcbi.1004762.ref016">16</xref>, <xref ref-type="bibr" rid="pcbi.1004762.ref027">27</xref>, <xref ref-type="bibr" rid="pcbi.1004762.ref033">33</xref>], we derive the well-known self-consistency equations for the mean <inline-formula id="pcbi.1004762.e025"><alternatives><graphic id="pcbi.1004762.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e025" xlink:type="simple"/><mml:math display="inline" id="M25"><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula> and covariances <italic>Q</italic><sup><italic>τ</italic></sup> in <xref ref-type="disp-formula" rid="pcbi.1004762.e008">Eq (1)</xref>, assuming stationarity of the process. When the system has a stable fixed point, it is given by the zeros of the linear matrix system:
<disp-formula id="pcbi.1004762.e026"><alternatives><graphic id="pcbi.1004762.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e026" xlink:type="simple"/><mml:math display="block" id="M26"><mml:mrow><mml:mi>J</mml:mi> <mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>+</mml:mo> <mml:mi>e</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mspace width="4pt"/><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(4)</label></disp-formula>
where <italic>x</italic><sup><italic>t</italic></sup> indicates the activity vector whose entries are <inline-formula id="pcbi.1004762.e027"><alternatives><graphic id="pcbi.1004762.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e027" xlink:type="simple"/><mml:math display="inline" id="M27"><mml:msubsup><mml:mi>x</mml:mi> <mml:mi>i</mml:mi> <mml:mi>t</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> for 1 ≤ <italic>i</italic> ≤ <italic>N</italic>; <italic>e</italic> is the homogeneous vector of inputs <italic>e</italic><sub><italic>i</italic></sub>. We have denoted the Jacobian of <xref ref-type="disp-formula" rid="pcbi.1004762.e020">Eq (3)</xref> by
<disp-formula id="pcbi.1004762.e028"><alternatives><graphic id="pcbi.1004762.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e028" xlink:type="simple"/><mml:math display="block" id="M28"><mml:mrow><mml:msub><mml:mi>J</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mo>-</mml:mo> <mml:msub><mml:mi>δ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:msub><mml:mi>τ</mml:mi> <mml:mi>x</mml:mi></mml:msub></mml:mfrac> <mml:mo>+</mml:mo> <mml:msub><mml:mi>C</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mspace width="4pt"/><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(5)</label></disp-formula>
where the Kronecker delta <italic>δ</italic><sub><italic>ij</italic></sub> = 1 if <italic>i</italic> = <italic>j</italic> and 0 otherwise. The system has a single fixed point provided <italic>J</italic> is invertible.</p>
<p>Using Ito’s formula for the derivation of <inline-formula id="pcbi.1004762.e029"><alternatives><graphic id="pcbi.1004762.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e029" xlink:type="simple"/><mml:math display="inline" id="M29"><mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>x</mml:mi> <mml:mi>i</mml:mi> <mml:mi>t</mml:mi></mml:msubsup> <mml:mo>-</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo> <mml:mo>(</mml:mo> <mml:msubsup><mml:mi>x</mml:mi> <mml:mi>j</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mi>τ</mml:mi></mml:mrow></mml:msubsup> <mml:mo>-</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> with respect to <italic>t</italic>, we obtain the Lyapunov equation for the steady-state of the second-order fluctuations with zero time shift:
<disp-formula id="pcbi.1004762.e030"><alternatives><graphic id="pcbi.1004762.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e030" xlink:type="simple"/><mml:math display="block" id="M30"><mml:mrow><mml:mi>J</mml:mi> <mml:msup><mml:mi>Q</mml:mi> <mml:mn>0</mml:mn></mml:msup> <mml:mo>+</mml:mo> <mml:msup><mml:mi>Q</mml:mi> <mml:mn>0</mml:mn></mml:msup> <mml:msup><mml:mi>J</mml:mi> <mml:mo>†</mml:mo></mml:msup> <mml:mo>+</mml:mo> <mml:mo>Σ</mml:mo> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(6)</label></disp-formula>
The noise matrix Σ is diagonal with terms <inline-formula id="pcbi.1004762.e031"><alternatives><graphic id="pcbi.1004762.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e031" xlink:type="simple"/><mml:math display="inline" id="M31"><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mo>=</mml:mo> <mml:msub><mml:mi>δ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>〈</mml:mo> <mml:mi mathvariant="normal">d</mml:mi> <mml:msubsup><mml:mi>B</mml:mi> <mml:mi>i</mml:mi> <mml:mi>t</mml:mi></mml:msubsup> <mml:mi mathvariant="normal">d</mml:mi> <mml:msubsup><mml:mi>B</mml:mi> <mml:mi>j</mml:mi> <mml:mi>t</mml:mi></mml:msubsup> <mml:mo>〉</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and † is the matrix transpose operator.</p>
<p>As done for the variable <italic>t</italic>, the derivation of <inline-formula id="pcbi.1004762.e032"><alternatives><graphic id="pcbi.1004762.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e032" xlink:type="simple"/><mml:math display="inline" id="M32"><mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>x</mml:mi> <mml:mi>i</mml:mi> <mml:mi>t</mml:mi></mml:msubsup> <mml:mo>-</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo> <mml:mo>(</mml:mo> <mml:msubsup><mml:mi>x</mml:mi> <mml:mi>j</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mi>τ</mml:mi></mml:mrow></mml:msubsup> <mml:mo>-</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> with respect to <italic>τ</italic> yields an equation satisfied by the time-shifted covariance <italic>Q</italic><sup><italic>τ</italic></sup>:
<disp-formula id="pcbi.1004762.e033"><alternatives><graphic id="pcbi.1004762.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e033" xlink:type="simple"/><mml:math display="block" id="M33"><mml:mrow><mml:msup><mml:mi>Q</mml:mi> <mml:mi>τ</mml:mi></mml:msup> <mml:mo>=</mml:mo> <mml:msup><mml:mi>Q</mml:mi> <mml:mn>0</mml:mn></mml:msup> <mml:mspace width="4pt"/><mml:mtext mathvariant="bold">expm</mml:mtext> <mml:mfenced close="]" open="[" separators=""><mml:msup><mml:mi>J</mml:mi> <mml:mo>†</mml:mo></mml:msup> <mml:mi>τ</mml:mi></mml:mfenced> <mml:mspace width="4pt"/><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(7)</label></disp-formula>
where <bold>expm</bold> is the matrix exponential. When <italic>J</italic> is dominated by the diagonal elements, the autocovariances <inline-formula id="pcbi.1004762.e034"><alternatives><graphic id="pcbi.1004762.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e034" xlink:type="simple"/><mml:math display="inline" id="M34"><mml:msubsup><mml:mi>Q</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>i</mml:mi></mml:mrow> <mml:mi>τ</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> are close to an exponential decay with time constant <italic>τ</italic><sub><italic>x</italic></sub>, as illustrated in <xref ref-type="fig" rid="pcbi.1004762.g001">Fig 1E</xref> with a log y-axis by the straight black line that coincices with the mean in blue up to <italic>τ</italic> = 2.5 s.</p>
</sec>
<sec id="sec004">
<title>Evaluating covariances from known network parameters</title>
<p>For a model with given connectivity matrix <italic>C</italic> and intrinsic noise matrix Σ, the theoretical zero-time-shift covariance matrix <italic>Q</italic><sup>0</sup> is the unique solution of <xref ref-type="disp-formula" rid="pcbi.1004762.e030">Eq (6)</xref> and can be evaluated using the long-known Bartels-Stewart algorithm [<xref ref-type="bibr" rid="pcbi.1004762.ref016">16</xref>]. Then, the model <italic>Q</italic><sup><italic>τ</italic></sup> can be calculated from <italic>Q</italic><sup>0</sup> and <italic>J</italic> using <xref ref-type="disp-formula" rid="pcbi.1004762.e033">Eq (7)</xref> for any given <italic>τ</italic>.</p>
</sec>
<sec id="sec005">
<title>Direct estimation of network parameters from empirical covariances</title>
<p>The inverse problem consists in finding an estimate of the connectivity matrix <italic>C</italic> such that the model reproduces the two objective matrices <inline-formula id="pcbi.1004762.e035"><alternatives><graphic id="pcbi.1004762.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e035" xlink:type="simple"/><mml:math display="inline" id="M35"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>0</mml:mn></mml:msup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1004762.e036"><alternatives><graphic id="pcbi.1004762.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e036" xlink:type="simple"/><mml:math display="inline" id="M36"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>τ</mml:mi></mml:msup></mml:math></alternatives></inline-formula> for a given <italic>τ</italic> &gt; 0, e.g., given by empirical observations. The relation in <xref ref-type="disp-formula" rid="pcbi.1004762.e033">Eq (7)</xref> allows for the calculation of <italic>J</italic> from <inline-formula id="pcbi.1004762.e037"><alternatives><graphic id="pcbi.1004762.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e037" xlink:type="simple"/><mml:math display="inline" id="M37"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>0</mml:mn></mml:msup></mml:math></alternatives></inline-formula> and an occurrence of <inline-formula id="pcbi.1004762.e038"><alternatives><graphic id="pcbi.1004762.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e038" xlink:type="simple"/><mml:math display="inline" id="M38"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>τ</mml:mi></mml:msup></mml:math></alternatives></inline-formula> for a given <italic>τ</italic> &gt; 0:
<disp-formula id="pcbi.1004762.e039"><alternatives><graphic id="pcbi.1004762.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e039" xlink:type="simple"/><mml:math display="block" id="M39"><mml:mrow><mml:mi>J</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>τ</mml:mi></mml:mfrac> <mml:mspace width="4pt"/><mml:msup><mml:mfenced close="}" open="{" separators=""><mml:mtext mathvariant="bold">logm</mml:mtext> <mml:mfenced close="]" open="[" separators=""><mml:msup><mml:mfenced close=")" open="("><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>0</mml:mn></mml:msup></mml:mfenced> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>τ</mml:mi></mml:msup></mml:mfenced></mml:mfenced> <mml:mo>†</mml:mo></mml:msup> <mml:mspace width="4pt"/><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(8)</label></disp-formula>
where <bold>logm</bold> is the matrix logarithm [<xref ref-type="bibr" rid="pcbi.1004762.ref034">34</xref>]. In our case, the non-diagonal elements of the Jacobian directly give the connectivity weight <italic>C</italic><sub><italic>ij</italic></sub> = <italic>J</italic><sub><italic>ij</italic></sub>. Note that the diagonal terms of <italic>J</italic> can provide an estimation of <italic>τ</italic><sub><italic>x</italic></sub>, so far as we assume <italic>C</italic><sub><italic>ii</italic></sub> = 0. Then, the noise matrix can be evaluated from the Lyapunov equation <xref ref-type="disp-formula" rid="pcbi.1004762.e030">Eq (6)</xref>:
<disp-formula id="pcbi.1004762.e040"><alternatives><graphic id="pcbi.1004762.e040g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e040" xlink:type="simple"/><mml:math display="block" id="M40"><mml:mrow><mml:mo>Σ</mml:mo> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mi>J</mml:mi> <mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>0</mml:mn></mml:msup> <mml:mo>-</mml:mo> <mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>0</mml:mn></mml:msup> <mml:msup><mml:mi>J</mml:mi> <mml:mo>†</mml:mo></mml:msup> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(9)</label></disp-formula>
Due to the matrix logarithm, this method is very sensitive to the noise in <inline-formula id="pcbi.1004762.e041"><alternatives><graphic id="pcbi.1004762.e041g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e041" xlink:type="simple"/><mml:math display="inline" id="M41"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>0</mml:mn></mml:msup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1004762.e042"><alternatives><graphic id="pcbi.1004762.e042g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e042" xlink:type="simple"/><mml:math display="inline" id="M42"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>τ</mml:mi></mml:msup></mml:math></alternatives></inline-formula>: it can give non-real numbers for <italic>J</italic>, hence <italic>C</italic>. For this reason, we develop the optimization method in the next section.</p>
<sec id="sec006">
<title>Case of zero-time-shift covariances</title>
<p>Before presenting the new optimization, we show that <italic>J</italic> cannot be fully recovered from the zero-shift covariance <inline-formula id="pcbi.1004762.e043"><alternatives><graphic id="pcbi.1004762.e043g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e043" xlink:type="simple"/><mml:math display="inline" id="M43"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>0</mml:mn></mml:msup></mml:math></alternatives></inline-formula> alone. We use similar calculations to those presented in previous work [<xref ref-type="bibr" rid="pcbi.1004762.ref027">27</xref>] to evaluate the solution for <italic>Q</italic><sup>0</sup> in <xref ref-type="disp-formula" rid="pcbi.1004762.e030">Eq (6)</xref> when <italic>J</italic> is diagonalizable and Σ is known. Because <inline-formula id="pcbi.1004762.e044"><alternatives><graphic id="pcbi.1004762.e044g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e044" xlink:type="simple"/><mml:math display="inline" id="M44"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>0</mml:mn></mml:msup></mml:math></alternatives></inline-formula> is symmetric, it is diagonalizable in an orthogonal basis: <inline-formula id="pcbi.1004762.e045"><alternatives><graphic id="pcbi.1004762.e045g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e045" xlink:type="simple"/><mml:math display="inline" id="M45"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>0</mml:mn></mml:msup> <mml:mo>=</mml:mo> <mml:msub><mml:mi>P</mml:mi> <mml:mi>Q</mml:mi></mml:msub> <mml:msub><mml:mi>D</mml:mi> <mml:mi>Q</mml:mi></mml:msub> <mml:msubsup><mml:mi>P</mml:mi> <mml:mi>Q</mml:mi> <mml:mo>†</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> with <italic>D</italic><sub><italic>Q</italic></sub> diagonal and the unitary matrix <italic>P</italic><sub><italic>Q</italic></sub> such that <inline-formula id="pcbi.1004762.e046"><alternatives><graphic id="pcbi.1004762.e046g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e046" xlink:type="simple"/><mml:math display="inline" id="M46"><mml:mrow><mml:msubsup><mml:mi>P</mml:mi> <mml:mi>Q</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>P</mml:mi> <mml:mi>Q</mml:mi> <mml:mo>†</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>. Reorganizing <xref ref-type="disp-formula" rid="pcbi.1004762.e030">Eq (6)</xref>, we obtain
<disp-formula id="pcbi.1004762.e047"><alternatives><graphic id="pcbi.1004762.e047g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e047" xlink:type="simple"/><mml:math display="block" id="M47"><mml:mrow><mml:mfenced close="]" open="[" separators=""><mml:msubsup><mml:mi>P</mml:mi> <mml:mi>Q</mml:mi> <mml:mo>†</mml:mo></mml:msubsup> <mml:mspace width="0.166667em"/><mml:mi>J</mml:mi> <mml:mspace width="0.166667em"/><mml:msub><mml:mi>P</mml:mi> <mml:mi>Q</mml:mi></mml:msub></mml:mfenced> <mml:msub><mml:mi>D</mml:mi> <mml:mi>Q</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>D</mml:mi> <mml:mi>Q</mml:mi></mml:msub> <mml:msup><mml:mfenced close="]" open="[" separators=""><mml:msubsup><mml:mi>P</mml:mi> <mml:mi>Q</mml:mi> <mml:mo>†</mml:mo></mml:msubsup> <mml:mspace width="0.166667em"/><mml:msup><mml:mi>J</mml:mi> <mml:mo>†</mml:mo></mml:msup> <mml:mspace width="0.166667em"/><mml:msub><mml:mi>P</mml:mi> <mml:mi>Q</mml:mi></mml:msub></mml:mfenced> <mml:mo>†</mml:mo></mml:msup> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>P</mml:mi> <mml:mi>Q</mml:mi> <mml:mo>†</mml:mo></mml:msubsup> <mml:mo>Σ</mml:mo> <mml:msub><mml:mi>P</mml:mi> <mml:mi>Q</mml:mi></mml:msub> <mml:mspace width="4pt"/><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(10)</label></disp-formula>
The solution <italic>J</italic> is thus given by
<disp-formula id="pcbi.1004762.e048"><alternatives><graphic id="pcbi.1004762.e048g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e048" xlink:type="simple"/><mml:math display="block" id="M48"><mml:mtable columnalign="right"><mml:mtr columnalign="right"><mml:mtd columnalign="right"><mml:mi>J</mml:mi></mml:mtd><mml:mtd columnalign="right"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>Q</mml:mi></mml:msub><mml:mi>F</mml:mi><mml:msubsup><mml:mi>P</mml:mi><mml:mi>Q</mml:mi><mml:mo>†</mml:mo></mml:msubsup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="right"><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="right"><mml:mtd columnalign="right"><mml:mi>G</mml:mi></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mi>Q</mml:mi><mml:mo>†</mml:mo></mml:msubsup><mml:mi>Σ</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mi>Q</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(11)</label></disp-formula>
with <italic>μ</italic><sub><italic>i</italic></sub> the real eigenvalues of <italic>D</italic><sub><italic>Q</italic></sub> on its diagonal. The second equality in <xref ref-type="disp-formula" rid="pcbi.1004762.e048">Eq (11)</xref> implies that there are infinitely many solutions for <italic>J</italic>: for each pair <italic>i</italic> ≠ <italic>j</italic>, there is one degree of freedom in determining <italic>F</italic>, hence <italic>J</italic>. In other words, <inline-formula id="pcbi.1004762.e049"><alternatives><graphic id="pcbi.1004762.e049g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e049" xlink:type="simple"/><mml:math display="inline" id="M49"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>0</mml:mn></mml:msup></mml:math></alternatives></inline-formula> alone does <italic>not</italic> carry sufficient information to recover the whole <italic>J</italic> and <italic>C</italic>. There is, however, a unique particular solution for <italic>F</italic> that is symmetric:
<disp-formula id="pcbi.1004762.e050"><alternatives><graphic id="pcbi.1004762.e050g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e050" xlink:type="simple"/><mml:math display="block" id="M50"><mml:mrow><mml:msub><mml:mi>F</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>F</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mfrac><mml:msub><mml:mi>G</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:msub><mml:mi>μ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac> <mml:mspace width="4pt"/><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(12)</label></disp-formula>
corresponding to a unique symmetric <italic>J</italic>. Recall that this solution requires knowledge about the noise matrix Σ.</p>
</sec>
</sec>
<sec id="sec007">
<title>Lyapunov optimization (LO) to estimate network connectivity from empirical covariances</title>
<p>As will be shown later in Results, the direct method does not work well with noisy empirical <inline-formula id="pcbi.1004762.e051"><alternatives><graphic id="pcbi.1004762.e051g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e051" xlink:type="simple"/><mml:math display="inline" id="M51"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>/</mml:mo> <mml:mi>τ</mml:mi></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>. We thus propose an alternative estimation method, where <italic>C</italic> is tuned iteratively such that the model reproduces the covariance observables, as illustrated in <xref ref-type="fig" rid="pcbi.1004762.g001">Fig 1H</xref>. Considering the noise matrix Σ to be known for now, we optimize <italic>C</italic> in order to reduce the model error
<disp-formula id="pcbi.1004762.e052"><alternatives><graphic id="pcbi.1004762.e052g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e052" xlink:type="simple"/><mml:math display="block" id="M52"><mml:mrow><mml:mi>V</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>C</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi></mml:mrow></mml:munder> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>Q</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow> <mml:mn>0</mml:mn></mml:msubsup> <mml:mo>-</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow> <mml:mn>0</mml:mn></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mo>+</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi></mml:mrow></mml:munder> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>Q</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow> <mml:mi>τ</mml:mi></mml:msubsup> <mml:mo>-</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow> <mml:mi>τ</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mspace width="4pt"/><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(13)</label></disp-formula>
for a pair of objective covariance matrices <inline-formula id="pcbi.1004762.e053"><alternatives><graphic id="pcbi.1004762.e053g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e053" xlink:type="simple"/><mml:math display="inline" id="M53"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>0</mml:mn></mml:msup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1004762.e054"><alternatives><graphic id="pcbi.1004762.e054g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e054" xlink:type="simple"/><mml:math display="inline" id="M54"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>τ</mml:mi></mml:msup></mml:math></alternatives></inline-formula> with a given <italic>τ</italic> &gt; 0; in Results, it is referred to as <italic>τ</italic><sub><italic>est</italic></sub>. Being the sum of two matrix distances, the Lyapunov function <italic>V</italic> is positive definite and becomes zero only when the two covariance matrices are equal to the objective counterparts. <xref ref-type="disp-formula" rid="pcbi.1004762.e039">Eq (8)</xref> ensures the unicity of the connectivity <italic>C</italic> for a given pair of covariances matrices, when the solution exists.</p>
<p>Starting from zero weights initially, each optimization step aims to reduce <italic>V</italic>. To do so, we calculate the Jacobian <italic>J</italic> in <xref ref-type="disp-formula" rid="pcbi.1004762.e028">Eq (5)</xref> for the current connectivity <italic>C</italic>, then the model matrices <italic>Q</italic><sup>0</sup> and <italic>Q</italic><sup><italic>τ</italic></sup> using Eqs <xref ref-type="disp-formula" rid="pcbi.1004762.e030">(6)</xref> and <xref ref-type="disp-formula" rid="pcbi.1004762.e033">(7)</xref> as we know Σ. We want to update <italic>C</italic> to obtain the following desired changes for the model covariances <italic>Q</italic><sup>0</sup> and <italic>Q</italic><sup><italic>τ</italic></sup>:
<disp-formula id="pcbi.1004762.e055"><alternatives><graphic id="pcbi.1004762.e055g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e055" xlink:type="simple"/><mml:math display="block" id="M55"><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mo>Δ</mml:mo><mml:msubsup><mml:mi>Q</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msubsup></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>C</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>Q</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>Q</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mtext> </mml:mtext><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mo>Δ</mml:mo><mml:msubsup><mml:mi>Q</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mi>τ</mml:mi></mml:msubsup></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>C</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>Q</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mi>τ</mml:mi></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>Q</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mi>τ</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mtext> </mml:mtext><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable>
</mml:math>
</alternatives> <label>(14)</label></disp-formula>
where the optimization rate <italic>ϵ</italic><sub><italic>C</italic></sub> is a some small positive number. To evaluate the Jacobian update Δ<italic>J</italic> that corresponds to Δ<italic>Q</italic><sup>0</sup> and Δ<italic>Q</italic><sup><italic>τ</italic></sup>, we consider the equivalent of <xref ref-type="disp-formula" rid="pcbi.1004762.e039">Eq (8)</xref> for the theoretical covariance matrices, namely <italic>J</italic> = <bold>logm</bold>(<italic>X</italic>)<sup>†</sup>/<italic>τ</italic> with <italic>X</italic> = (<italic>Q</italic><sup>0</sup>)<sup>−1</sup> <italic>Q</italic><sup><italic>τ</italic></sup>. We perform an implicit differentiation with respect to <italic>J</italic> and <italic>X</italic>, yielding
<disp-formula id="pcbi.1004762.e056"><alternatives><graphic id="pcbi.1004762.e056g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e056" xlink:type="simple"/><mml:math display="block" id="M56"><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mo>Δ</mml:mo><mml:mi>J</mml:mi></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>τ</mml:mi></mml:mfrac><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>Δ</mml:mo><mml:mi>X</mml:mi><mml:mtext> </mml:mtext><mml:msup><mml:mi>X</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>†</mml:mo></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>τ</mml:mi></mml:mfrac><mml:mtext> </mml:mtext><mml:msup><mml:mrow><mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>Q</mml:mi><mml:mn>0</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>Δ</mml:mo><mml:msup><mml:mi>Q</mml:mi><mml:mn>0</mml:mn></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>Q</mml:mi><mml:mn>0</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mi>Q</mml:mi><mml:mi>τ</mml:mi></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>Q</mml:mi><mml:mn>0</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>Δ</mml:mo><mml:msup><mml:mi>Q</mml:mi><mml:mi>τ</mml:mi></mml:msup></mml:mrow> <mml:mo>]</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>Q</mml:mi><mml:mn>0</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mi>Q</mml:mi><mml:mi>τ</mml:mi></mml:msup></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow> <mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>†</mml:mo></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>τ</mml:mi></mml:mfrac><mml:mtext> </mml:mtext><mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>Q</mml:mi><mml:mn>0</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mtext> </mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>Δ</mml:mo><mml:msup><mml:mi>Q</mml:mi><mml:mn>0</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mo>Δ</mml:mo><mml:msup><mml:mi>Q</mml:mi><mml:mi>τ</mml:mi></mml:msup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>p</mml:mi><mml:mi>m</mml:mi></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:msup><mml:mi>J</mml:mi><mml:mo>†</mml:mo></mml:msup><mml:mi>τ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>†</mml:mo></mml:msup><mml:mtext> </mml:mtext><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable>
</mml:math>
</alternatives> <label>(15)</label></disp-formula>
Finally, the desired connectivity update is simply for all <italic>i</italic> ≠ <italic>j</italic> <disp-formula id="pcbi.1004762.e057"><alternatives><graphic id="pcbi.1004762.e057g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e057" xlink:type="simple"/><mml:math display="block" id="M57"><mml:mrow><mml:mo>Δ</mml:mo> <mml:msub><mml:mi>C</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mo>Δ</mml:mo> <mml:msub><mml:mi>J</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mspace width="4pt"/><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(16)</label></disp-formula>
and zero for the diagonal elements.</p>
<p>To obtain the rhs of the first line in <xref ref-type="disp-formula" rid="pcbi.1004762.e056">Eq (15)</xref>, we have assumed that matrices <italic>X</italic> and Δ<italic>X</italic> commute. For the LO procedure, this implies the existence of a path of matrix increments corresponding to Δ<italic>J</italic> such that the commutation requirement is satisfied at each step, in order to reach the global optimum. Assuming <italic>X</italic> to be arbitrary, the subspace of commuting matrices in which Δ<italic>X</italic> is constrained is a linear subspace of dimension <italic>n</italic>(<italic>n</italic>−1)/2 with <italic>n</italic> the number of nodes, to be compared to the dimension <italic>n</italic><sup>2</sup> of the space of <italic>X</italic>. Although this subspace is not dense, it is sufficiently rich to hope that suitable paths exist and the optimum can be approached; this will be verified using numerical simulation.</p>
<p>This optimization process may also not reach the global optimum when <inline-formula id="pcbi.1004762.e058"><alternatives><graphic id="pcbi.1004762.e058g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e058" xlink:type="simple"/><mml:math display="inline" id="M58"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>τ</mml:mi></mml:msup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1004762.e059"><alternatives><graphic id="pcbi.1004762.e059g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e059" xlink:type="simple"/><mml:math display="inline" id="M59"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>0</mml:mn></mml:msup></mml:math></alternatives></inline-formula> do not correspond to a real solution for <italic>C</italic>, such as noisy empirical covariances. We will thus verify the estimation performance numerically, using the known theoretical covariance matrices obtained from Eqs <xref ref-type="disp-formula" rid="pcbi.1004762.e030">(6)</xref> and <xref ref-type="disp-formula" rid="pcbi.1004762.e033">(7)</xref> to check for a given connectivity matrix <italic>C</italic>.</p>
<sec id="sec008">
<title>LO estimation of a symmetric network connectivity based on zero-time-shifted covariances only</title>
<p>Here we show how to perform a similar iterative optimization based on <inline-formula id="pcbi.1004762.e060"><alternatives><graphic id="pcbi.1004762.e060g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e060" xlink:type="simple"/><mml:math display="inline" id="M60"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>0</mml:mn></mml:msup></mml:math></alternatives></inline-formula> only as an objective, as was done for the direct calculation method. Namely, a symmetric Δ<italic>J</italic> can be calculated in terms of <inline-formula id="pcbi.1004762.e061"><alternatives><graphic id="pcbi.1004762.e061g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e061" xlink:type="simple"/><mml:math display="inline" id="M61"><mml:mrow><mml:mo>Δ</mml:mo> <mml:msup><mml:mi>Q</mml:mi> <mml:mn>0</mml:mn></mml:msup> <mml:mo>=</mml:mo> <mml:msub><mml:mi>ϵ</mml:mi> <mml:mi>C</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>0</mml:mn></mml:msup> <mml:mo>-</mml:mo> <mml:msup><mml:mi>Q</mml:mi> <mml:mn>0</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> at each optimization step. The desired Jacobian update for <italic>J</italic> can be written as <inline-formula id="pcbi.1004762.e062"><alternatives><graphic id="pcbi.1004762.e062g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e062" xlink:type="simple"/><mml:math display="inline" id="M62"><mml:mrow><mml:mo>Δ</mml:mo> <mml:mi>J</mml:mi> <mml:mo>=</mml:mo> <mml:msub><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>Δ</mml:mo> <mml:msubsup><mml:mi>Q</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow> <mml:mn>0</mml:mn></mml:msubsup> <mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:mi>J</mml:mi></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:msubsup><mml:mi>Q</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow> <mml:mn>0</mml:mn></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>. Using similar calculations to those following <xref ref-type="disp-formula" rid="pcbi.1004762.e047">Eq (10)</xref>, we differentiate <xref ref-type="disp-formula" rid="pcbi.1004762.e030">Eq (6)</xref> with respect to <italic>Q</italic><sup>0</sup> to evaluate <inline-formula id="pcbi.1004762.e063"><alternatives><graphic id="pcbi.1004762.e063g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e063" xlink:type="simple"/><mml:math display="inline" id="M63"><mml:mrow><mml:mi>∂</mml:mi> <mml:mi>J</mml:mi> <mml:mo>/</mml:mo> <mml:mi>∂</mml:mi> <mml:msubsup><mml:mi>Q</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow> <mml:mn>0</mml:mn></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>:
<disp-formula id="pcbi.1004762.e064"><alternatives><graphic id="pcbi.1004762.e064g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e064" xlink:type="simple"/><mml:math display="block" id="M64"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:mi>J</mml:mi></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:msubsup><mml:mi>Q</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow> <mml:mn>0</mml:mn></mml:msubsup></mml:mrow></mml:mfrac> <mml:msup><mml:mi>Q</mml:mi> <mml:mn>0</mml:mn></mml:msup> <mml:mo>+</mml:mo> <mml:mi>J</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>E</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msup> <mml:mo>+</mml:mo> <mml:msup><mml:mi>E</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mi>m</mml:mi></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msup><mml:mi>Q</mml:mi> <mml:mn>0</mml:mn></mml:msup> <mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:msup><mml:mi>J</mml:mi> <mml:mo>†</mml:mo></mml:msup></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:msubsup><mml:mi>Q</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow> <mml:mn>0</mml:mn></mml:msubsup></mml:mrow></mml:mfrac> <mml:mo>+</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>E</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msup> <mml:mo>+</mml:mo> <mml:msup><mml:mi>E</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mi>m</mml:mi></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mi>J</mml:mi> <mml:mo>†</mml:mo></mml:msup> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mspace width="4pt"/><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(17)</label></disp-formula>
where <italic>E</italic><sup><italic>mn</italic></sup> is the matrix filled with zero except for a 1 at indices <italic>m</italic>, <italic>n</italic>. Note that, because <italic>Q</italic><sup>0</sup> is symmetric, <inline-formula id="pcbi.1004762.e065"><alternatives><graphic id="pcbi.1004762.e065g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e065" xlink:type="simple"/><mml:math display="inline" id="M65"><mml:mrow><mml:mi>∂</mml:mi> <mml:msup><mml:mrow><mml:mi>Q</mml:mi></mml:mrow> <mml:mn>0</mml:mn></mml:msup> <mml:mo>/</mml:mo> <mml:mi>∂</mml:mi> <mml:msubsup><mml:mi>Q</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow> <mml:mn>0</mml:mn></mml:msubsup> <mml:mo>=</mml:mo> <mml:msup><mml:mi>E</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msup> <mml:mo>+</mml:mo> <mml:msup><mml:mi>E</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mi>m</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> and not <italic>E</italic><sup><italic>mn</italic></sup> alone. This binds linearly the elements ∂<italic>J</italic>/∂<italic>Q</italic><sub><italic>mn</italic></sub> and <italic>E</italic><sup><italic>mn</italic></sup>+<italic>E</italic><sup><italic>nm</italic></sup>, which actually leads to an equality for Δ<italic>J</italic> that has the same form as <xref ref-type="disp-formula" rid="pcbi.1004762.e030">Eq (6)</xref>:
<disp-formula id="pcbi.1004762.e066"><alternatives><graphic id="pcbi.1004762.e066g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e066" xlink:type="simple"/><mml:math display="block" id="M66"><mml:mrow><mml:mo>Δ</mml:mo> <mml:mi>J</mml:mi> <mml:mspace width="4pt"/><mml:msup><mml:mi>Q</mml:mi> <mml:mn>0</mml:mn></mml:msup> <mml:mo>+</mml:mo> <mml:msup><mml:mi>Q</mml:mi> <mml:mn>0</mml:mn></mml:msup> <mml:mspace width="4pt"/><mml:mo>Δ</mml:mo> <mml:msup><mml:mi>J</mml:mi> <mml:mo>†</mml:mo></mml:msup> <mml:mo>+</mml:mo> <mml:mi>J</mml:mi> <mml:mspace width="4pt"/><mml:mo>Δ</mml:mo> <mml:msup><mml:mi>Q</mml:mi> <mml:mn>0</mml:mn></mml:msup> <mml:mo>+</mml:mo> <mml:mo>Δ</mml:mo> <mml:msup><mml:mi>Q</mml:mi> <mml:mn>0</mml:mn></mml:msup> <mml:mspace width="4pt"/><mml:msup><mml:mi>J</mml:mi> <mml:mo>†</mml:mo></mml:msup> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mspace width="4pt"/><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(18)</label></disp-formula>
We have a similar indetermination as before, which can be lifted by choosing the particular symmetric solution for Δ<italic>J</italic>:
<disp-formula id="pcbi.1004762.e067"><alternatives><graphic id="pcbi.1004762.e067g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e067" xlink:type="simple"/><mml:math display="block" id="M67"><mml:mtable columnalign="right"><mml:mtr columnalign="right"><mml:mtd columnalign="right"><mml:mrow><mml:mo>Δ</mml:mo><mml:mi>J</mml:mi></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>Q</mml:mi></mml:msub><mml:mi>K</mml:mi><mml:msubsup><mml:mi>P</mml:mi><mml:mi>Q</mml:mi><mml:mo>†</mml:mo></mml:msubsup><mml:mtext> </mml:mtext><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="right"><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mtext> </mml:mtext><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="right"><mml:mi>L</mml:mi></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mi>Q</mml:mi><mml:mo>†</mml:mo></mml:msubsup><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mi>J</mml:mi><mml:mtext> </mml:mtext><mml:mo>Δ</mml:mo><mml:msup><mml:mi>Q</mml:mi><mml:mn>0</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mo>Δ</mml:mo><mml:msup><mml:mi>Q</mml:mi><mml:mn>0</mml:mn></mml:msup><mml:mtext> </mml:mtext><mml:msup><mml:mi>J</mml:mi><mml:mo>†</mml:mo></mml:msup></mml:mrow> <mml:mo>]</mml:mo></mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>Q</mml:mi></mml:msub><mml:mtext> </mml:mtext><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math>
</alternatives> <label>(19)</label></disp-formula>
where the diagonal matrix <italic>D</italic><sub><italic>Q</italic></sub> with eigenvalues <italic>μ</italic><sub><italic>i</italic></sub> and the passage matrix <italic>P</italic><sub><italic>Q</italic></sub> are the same as defined above in <xref ref-type="disp-formula" rid="pcbi.1004762.e047">Eq (10)</xref>. Note that we do not need to assume knowledge about Σ here.</p>
</sec>
</sec>
<sec id="sec009">
<title>Tuning of input noise variances</title>
<p>So far, we have considered Σ to be known and fixed during the optimization. Now we extend the theory to optimize Σ in parallel with <italic>C</italic>. We focus on the case where Σ is diagonal with elements Σ<sub><italic>ii</italic></sub> = (<italic>σ</italic><sub><italic>i</italic></sub>)<sup>2</sup> that are the variances of the noise experienced by each network node. The key to adjust each Σ<sub><italic>ii</italic></sub> is to reproduce the corresponding diagonal element <inline-formula id="pcbi.1004762.e068"><alternatives><graphic id="pcbi.1004762.e068g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e068" xlink:type="simple"/><mml:math display="inline" id="M68"><mml:msubsup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>i</mml:mi></mml:mrow> <mml:mn>0</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula>. To do so, the Σ<sub><italic>ii</italic></sub> are simply modified at each optimization step based on the difference between the variance of the <italic>i</italic><sup><italic>th</italic></sup> node of the model and its objective counterpart:
<disp-formula id="pcbi.1004762.e069"><alternatives><graphic id="pcbi.1004762.e069g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e069" xlink:type="simple"/><mml:math display="block" id="M69"><mml:mrow><mml:mo>Δ</mml:mo> <mml:msub><mml:mo>Σ</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>ϵ</mml:mi> <mml:mo>Σ</mml:mo></mml:msub> <mml:mfenced close=")" open="(" separators=""><mml:msubsup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>i</mml:mi></mml:mrow> <mml:mn>0</mml:mn></mml:msubsup> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>Q</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>i</mml:mi></mml:mrow> <mml:mn>0</mml:mn></mml:msubsup></mml:mfenced> <mml:mspace width="4pt"/><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(20)</label></disp-formula>
where the update rate is <italic>ϵ</italic><sub>Σ</sub>.</p>
<p>The implications of tuning the noise matrix Σ will be explored in a dedicated section of Results. Intuitively, it can be seen from <xref ref-type="disp-formula" rid="pcbi.1004762.e030">Eq (6)</xref> that Σ affects the model covariance <italic>Q</italic><sup>0</sup>, hence <italic>Q</italic><sup><italic>τ</italic></sup> via <xref ref-type="disp-formula" rid="pcbi.1004762.e033">Eq (7)</xref>; see <xref ref-type="sec" rid="sec002">Methods</xref> for reference. Therefore, assuming an erroneous Σ for the model implies incorrect desired updates Δ<italic>Q</italic><sup>0</sup> and Δ<italic>Q</italic><sup><italic>τ</italic></sup>, leading to a wrong update Δ<italic>C</italic>.</p>
</sec>
<sec id="sec010">
<title>Heuristic optimization procedure for network connectivity</title>
<p>We also compare the LO method with a heuristic optimization, where existing weights are increased or decreased depending on the <italic>Q</italic><sup><italic>τ</italic></sup> difference between the model and objective for the corresponding matrix element for a given <italic>τ</italic> <disp-formula id="pcbi.1004762.e070"><alternatives><graphic id="pcbi.1004762.e070g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e070" xlink:type="simple"/><mml:math display="block" id="M70"><mml:mrow><mml:mo>Δ</mml:mo> <mml:msub><mml:mi>C</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>ϵ</mml:mi> <mml:mtext>heur</mml:mtext></mml:msub> <mml:mfenced close=")" open="(" separators=""><mml:msubsup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mn>0</mml:mn></mml:msubsup> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>Q</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mn>0</mml:mn></mml:msubsup> <mml:mo>+</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>τ</mml:mi></mml:msubsup> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>Q</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>τ</mml:mi></mml:msubsup></mml:mfenced> <mml:mspace width="4pt"/><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(21)</label></disp-formula>
This method used previously [<xref ref-type="bibr" rid="pcbi.1004762.ref012">12</xref>] is adapted here to spatio-temporal covariances.</p>
</sec>
<sec id="sec011">
<title>Network configuration and model parameters used in numerical simulation</title>
<p>Unless stated otherwise, we use the parameters in <xref ref-type="table" rid="pcbi.1004762.t002">Table 2</xref> and Euler’s approach to simulate <xref ref-type="disp-formula" rid="pcbi.1004762.e020">Eq (3)</xref> numerically. The code is written in python using the packages numpy and scipy, which incorporate a version of the Bartels-Stewart algorithm. The topology for the cluster-hub networks as in <xref ref-type="fig" rid="pcbi.1004762.g001">Fig 1A</xref> consists of two groups of 30% and 60% of the <italic>N</italic> nodes. Each group is connected recurrently with probability <italic>p</italic><sub><italic>con</italic></sub>, with a weight randomly chosen in [10, 100]% of <italic>c</italic><sub><italic>max</italic></sub>. We exclude self connections, although this is not crucial. The two groups are connected via hubs with a higher probability equal to 1.3<italic>p</italic><sub><italic>con</italic></sub> and a weight in the same range as other connections. Hubs do not have connections between each other. For random networks, all pairs of nodes have the probability <italic>p</italic><sub><italic>con</italic></sub> to be connected, with a random weight in [10, 100]% of <italic>c</italic><sub><italic>max</italic></sub>. Simulations of duration <italic>T</italic> with identical parameters but distinct initial conditions are repeated <italic>n</italic><sub><italic>sim</italic></sub> times in order to evaluate the empirical <italic>Q</italic>.</p>
<table-wrap id="pcbi.1004762.t002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004762.t002</object-id>
<label>Table 2</label>
<caption>
<title>Table of simulation, network and optimization parameters for the ND artificial network model.</title>
</caption>
<alternatives>
<graphic id="pcbi.1004762.t002g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004762.t002" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<tbody>
<tr>
<td align="center">simulation duration</td>
<td align="center"><italic>T</italic> = 300 s</td>
</tr>
<tr>
<td align="center">simulation timestep</td>
<td align="center">50 ms</td>
</tr>
<tr>
<td align="center">simulation number</td>
<td align="center"><italic>n</italic><sub><italic>sim</italic></sub> = 50</td>
</tr>
<tr>
<td align="center">network size</td>
<td align="center"><italic>N</italic> = 50</td>
</tr>
<tr>
<td align="center">probability of connection</td>
<td align="center"><italic>p</italic><sub><italic>con</italic></sub> = 20%</td>
</tr>
<tr>
<td align="center">maximum weight for <italic>C</italic></td>
<td align="center"><italic>c</italic><sub><italic>max</italic></sub> = 0.2</td>
</tr>
<tr>
<td align="center">time constant for neural dynamics</td>
<td align="center"><italic>τ</italic><sub><italic>x</italic></sub> = 1 s</td>
</tr>
<tr>
<td align="center">homogeneous input</td>
<td align="center"><italic>e</italic> = 0.3</td>
</tr>
<tr>
<td align="center">noise variance</td>
<td align="center">
<inline-formula id="pcbi.1004762.e071">
<alternatives>
<graphic id="pcbi.1004762.e071g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e071" xlink:type="simple"/>
<mml:math display="inline" id="M71">
<mml:mrow>
<mml:msub>
<mml:mi>Σ</mml:mi>
<mml:mrow>
<mml:mi>i</mml:mi>
<mml:mi>i</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:msubsup>
<mml:mi>σ</mml:mi>
<mml:mi>i</mml:mi>
<mml:mn>2</mml:mn>
</mml:msubsup>
<mml:mo>=</mml:mo>
<mml:mn>0</mml:mn>
<mml:mo>.</mml:mo>
<mml:mn>6</mml:mn>
</mml:mrow>
</mml:math>
</alternatives>
</inline-formula>
</td>
</tr>
<tr>
<td align="center"><italic>C</italic> optimization rate</td>
<td align="center"><italic>ϵ</italic><sub><italic>C</italic></sub> = 2 × 10<sup>−4</sup></td>
</tr>
<tr>
<td align="center">Σ optimization rate</td>
<td align="center"><italic>ϵ</italic><sub>Σ</sub> = 10<sup>−1</sup></td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t002fn001">
<p>Unless stated otherwise, these parameters are used for artificial networks.</p>
</fn>
</table-wrap-foot>
</table-wrap>
<p>We also compare our ND model with the DMF model [<xref ref-type="bibr" rid="pcbi.1004762.ref027">27</xref>] that simulates a network of neural population with AMPA and NMDA conductances, whose synaptic activity determines the BOLD signal via a hemodynamic nonlinear filter [<xref ref-type="bibr" rid="pcbi.1004762.ref029">29</xref>]. The equations regulating the synaptic activity variable <italic>S</italic><sub><italic>i</italic></sub> with 1 ≤ <italic>i</italic> ≤ <italic>N</italic> for the DMF are
<disp-formula id="pcbi.1004762.e072"><alternatives><graphic id="pcbi.1004762.e072g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e072" xlink:type="simple"/><mml:math display="block" id="M72"><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mrow><mml:mtext>d</mml:mtext><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mtext>d</mml:mtext><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mi>M</mml:mi><mml:mi>D</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi>J</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>G</mml:mi><mml:munder><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mi>k</mml:mi></mml:munder><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>S</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mtext>exp</mml:mtext><mml:mo stretchy="false">[</mml:mo><mml:mo>−</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mfrac><mml:mtext> </mml:mtext><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(22)</label></disp-formula>
The HRF model relies on the synaptic activity <italic>S</italic><sub><italic>i</italic></sub> to calculate the intermediate variables <italic>s</italic><sub><italic>i</italic></sub>, <italic>f</italic><sub><italic>i</italic></sub>, <italic>ν</italic><sub><italic>i</italic></sub> and <italic>q</italic><sub><italic>i</italic></sub> for each area, which give the BOLD signal <italic>B</italic><sub><italic>i</italic></sub>:
<disp-formula id="pcbi.1004762.e073"><alternatives><graphic id="pcbi.1004762.e073g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e073" xlink:type="simple"/><mml:math display="block" id="M73"><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mrow><mml:mtext>d</mml:mtext><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mtext>d</mml:mtext><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>κ</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mrow><mml:mtext>d</mml:mtext><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mtext>d</mml:mtext><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mrow><mml:mtext>d</mml:mtext><mml:msub><mml:mi>ν</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mtext>d</mml:mtext><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msubsup><mml:mi>ν</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mtext>H</mml:mtext></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mrow><mml:mtext>d</mml:mtext><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mtext>d</mml:mtext><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mtext>H</mml:mtext></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mi>ρ</mml:mi></mml:mfrac><mml:mo stretchy="false">[</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>ρ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msup><mml:mo stretchy="false">]</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msubsup><mml:mi>ν</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>*</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>7</mml:mn><mml:mi>ρ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mi>ρ</mml:mi><mml:mo>−</mml:mo><mml:mn>0.2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mtext> </mml:mtext><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable>
</mml:math>
</alternatives> <label>(23)</label></disp-formula>
All parameters are recapitulated in <xref ref-type="table" rid="pcbi.1004762.t003">Table 3</xref>.</p>
<table-wrap id="pcbi.1004762.t003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004762.t003</object-id>
<label>Table 3</label>
<caption>
<title>Parameters for the dynamic mean-field (DMF) model and hemodynamic response function (HRF).</title>
</caption>
<alternatives>
<graphic id="pcbi.1004762.t003g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004762.t003" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
</colgroup>
<tr>
<td align="center"><italic>a</italic> = 270</td>
</tr>
<tr>
<td align="center"><italic>b</italic> = 108</td>
</tr>
<tr>
<td align="center"><italic>c</italic> = 0.154</td>
</tr>
<tr>
<td align="center"><italic>β</italic> = 0.641</td>
</tr>
<tr>
<td align="center"><italic>J</italic> = 0.261</td>
</tr>
<tr>
<td align="center"><italic>w</italic><sub><italic>EE</italic></sub> = 0.9</td>
</tr>
<tr>
<td align="center"><italic>G</italic> = 2.5</td>
</tr>
<tr>
<td align="center"><italic>κ</italic> = 0.65</td>
</tr>
<tr>
<td align="center"><italic>γ</italic> = 0.41</td>
</tr>
<tr>
<td align="center"><italic>τ</italic><sub><italic>H</italic></sub> = 0.98</td>
</tr>
<tr>
<td align="center"><italic>α</italic> = 0.32</td>
</tr>
<tr>
<td align="center"><italic>ρ</italic> = 0.34</td>
</tr>
<tr>
<td align="center"><italic>V</italic><sub>0</sub> = 0.02</td>
</tr>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t003fn001">
<p>All parameters are taken from previous publications [<xref ref-type="bibr" rid="pcbi.1004762.ref027">27</xref>, <xref ref-type="bibr" rid="pcbi.1004762.ref029">29</xref>]. The weights of the <italic>C</italic> matrices are chosen in the same range for both ND and DMF models. The value for <italic>G</italic> sets the regime of the DMF close to the bifurcation [<xref ref-type="bibr" rid="pcbi.1004762.ref027">27</xref>].</p>
</fn>
</table-wrap-foot>
</table-wrap>
</sec>
<sec id="sec012">
<title>Experimental data set</title>
<p>Resting-state BOLD signal time series and dwMRI data were acquired for 25 healthy subjects aged between 18 and 39 years (mean 26.7), including 12 females and 13 males. A detailed description of the data acquisition can be found in [<xref ref-type="bibr" rid="pcbi.1004762.ref035">35</xref>], which we briefly summarize here. Subjects were asked to stay awake and keep their eyes closed, during which joint MRI-EEG recordings were performed using a 3 Tesla Siemens Trim Trio MR scanner and a 12-channel Siemens head coil [<xref ref-type="bibr" rid="pcbi.1004762.ref036">36</xref>, <xref ref-type="bibr" rid="pcbi.1004762.ref037">37</xref>]. Acquired time series are spatially aggregated for voxels corresponding to the same area according to the parcellation. Only fMRI data are used in the present study: the BOLD signals were recorded for about 20 minutes (661 time points taken every 2 s). The BOLD signals are high-passed filtered above 0.01 Hz. Then the FC matrices correspond to covariances between all 68 regions, which are calculated using <xref ref-type="disp-formula" rid="pcbi.1004762.e010">Eq (2)</xref> taking each of the 25 subjects as a separate session. Time shifts are multiples of the temporal resolution after preprocessing (2 s). For the most part, we use for FC the average covariance matrix over all subjects; a comparison with optimization based on FC for individual subjects is also presented in ‘Robustness of LO applied to experimental data. For each participant, dwMRI was used to evaluate the white-matter intracortical connectivity. Tractography is performed using corrections for motion, eddy currents, crossing pathways and the size of regions. Processing steps for MRI data include 1) preprocessing of T1-weighted scans, cortical reconstruction, tessellation and parcellation, 2) transformation of anatomical masks to diffusion space, 3) processing of diffusion data, 4) transformation of anatomical masks to fMRI space, 5) Processing of fMRI data. The dwMRI matrix used in the application to experimental data is the average over all subjects, which is thresholded to determine weights to tune in the optimization.</p>
</sec>
<sec id="sec013">
<title>Ethics statement</title>
<p>The paper makes a secondary use of experimental data already published [<xref ref-type="bibr" rid="pcbi.1004762.ref035">35</xref>]. The experiments have been approved by the Ethic Committee of Charite University (Berlin).</p>
</sec>
</sec>
<sec id="sec014" sec-type="results">
<title>Results</title>
<p>The goal of the present study is to tune a dynamic model of cortical activity to reproduce empirical FC obtained from fMRI data. Here FC corresponds to the spatio-temporal covariances <inline-formula id="pcbi.1004762.e074"><alternatives><graphic id="pcbi.1004762.e074g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e074" xlink:type="simple"/><mml:math display="inline" id="M74"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>/</mml:mo> <mml:mi>τ</mml:mi></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>. The optimized network parameters are the matrices of recurrent connectivity <italic>C</italic> and noise Σ, the latter being diagonal. We perform the Lyapunov optimization (LO) developed in Methods to find the parameters that minimize the error between two model <italic>Q</italic><sup>0/<italic>τ</italic></sup> matrices and their empirical counterparts <inline-formula id="pcbi.1004762.e075"><alternatives><graphic id="pcbi.1004762.e075g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e075" xlink:type="simple"/><mml:math display="inline" id="M75"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>/</mml:mo> <mml:mi>τ</mml:mi></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>, as illustrated in <xref ref-type="fig" rid="pcbi.1004762.g001">Fig 1H</xref>. The application to fMRI data is presented in the last two subsections of Results, where the tuned <italic>C</italic> is an estimate of directed intracortical EC. In particular, the asymmetry of EC relates to the non-reciprocality of cortical interactions and to the difference between the strengths of incoming and outgoing connections for each cortical area.</p>
<p>The first part of Results concerns artificial network models, on which we test the LO procedure. We examine the influence of the choice for the time shift <italic>τ</italic><sub><italic>est</italic></sub> related to the objective <inline-formula id="pcbi.1004762.e076"><alternatives><graphic id="pcbi.1004762.e076g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e076" xlink:type="simple"/><mml:math display="inline" id="M76"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>τ</mml:mi></mml:msup></mml:math></alternatives></inline-formula> upon the performance. We also show that it is necessary to tune the noise Σ received by the network nodes in order to accurately estimate the recurrent connectivity <italic>C</italic>. Our LO procedure is compared to two alternative to estimate the strengths of individual connections in a network, namely the ‘direct’ and ‘heuristic’ methods. Before applying our method to experimental data, we also investigate the mapping between EC and FC in a network model equipped with hemodynamics to generate the BOLD signal from neural activity. Specifically, we verify that time-shifted BOLD covariances convey information about the underlying connectivity between neural populations.</p>
<sec id="sec015">
<title>Noise-diffusion (ND) with non-trivial network topology</title>
<p>The network model consists of interconnected neural populations that experience intrinsic noise and excite each other. Details about the mathematical formalism and model parameters are provided in Methods. For artificial networks, we mainly consider the topology in <xref ref-type="fig" rid="pcbi.1004762.g001">Fig 1A</xref>, where two groups of interconnected populations are linked via hubs. An example of the connectivity matrix is displayed in <xref ref-type="fig" rid="pcbi.1004762.g001">Fig 1B</xref>, where the matrix element indexed by <italic>ij</italic> corresponds to the connection from area <italic>j</italic> to <italic>i</italic>. Although hubs (cyan) are connected to both groups and not between each other (as indicated red arrow), they seem to make one with the large group (light green) in <italic>Q</italic><sup>0</sup> and <italic>Q</italic><sup><italic>τ</italic></sup> (see the blue arrow in <xref ref-type="fig" rid="pcbi.1004762.g001">Fig 1D</xref>). In contrast, the small group (dark green in <xref ref-type="fig" rid="pcbi.1004762.g001">Fig 1A and 1B</xref>) does not appear clearly as it exhibits rather low covariances. The reason behind this choice is to check whether the method can recover the correct topology from the <italic>Q</italic><sup>0/<italic>τ</italic></sup> values that significantly deviate from the underlying connectivity strengths in <italic>C</italic>.</p>
<p>Our estimation method uses the spatio-temporal information in the covariance <inline-formula id="pcbi.1004762.e077"><alternatives><graphic id="pcbi.1004762.e077g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e077" xlink:type="simple"/><mml:math display="inline" id="M77"><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> of the entire network to recover the directed weights in <italic>C</italic>, implicitly relying on the asymmetric matrix <inline-formula id="pcbi.1004762.e078"><alternatives><graphic id="pcbi.1004762.e078g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e078" xlink:type="simple"/><mml:math display="inline" id="M78"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>τ</mml:mi></mml:msup></mml:math></alternatives></inline-formula> for <italic>τ</italic> &gt; 0. In general, <italic>Q</italic><sup><italic>τ</italic></sup> is not symmetric for <italic>τ</italic> &gt; 0 for an arbitrary <italic>C</italic>: <xref ref-type="fig" rid="pcbi.1004762.g001">Fig 1F</xref> shows that the asymmetry of <italic>Q</italic><sup><italic>τ</italic></sup> linearly scales on average with that of <italic>C</italic>, with a slope that increases with <italic>τ</italic>. We measure the asymmetry using the following index
<disp-formula id="pcbi.1004762.e079"><alternatives><graphic id="pcbi.1004762.e079g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e079" xlink:type="simple"/><mml:math display="block" id="M79"><mml:mrow><mml:msub><mml:mtext>asym</mml:mtext> <mml:mi>M</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>5</mml:mn> <mml:mfrac><mml:mrow><mml:msub><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>≠</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>|</mml:mo> <mml:msub><mml:mi>M</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>M</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>|</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msub><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>≠</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>|</mml:mo> <mml:msub><mml:mi>M</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives> <label>(24)</label></disp-formula>
for a matrix <italic>M</italic>. It ranges from 0 for symmetric matrices to 1 for antisymmetric matrices. Large weights with no or weak reciprocal connection mainly contribute to the index. The relationship in <xref ref-type="fig" rid="pcbi.1004762.g001">Fig 1F</xref> can be understood looking at the expression for <italic>Q</italic><sup><italic>τ</italic></sup> in <xref ref-type="disp-formula" rid="pcbi.1004762.e033">Eq (7)</xref>, which amounts to <italic>Q</italic><sup>0</sup> multiplied by the matrix exponential <bold>expm</bold>(<italic>J</italic><sup>†</sup> <italic>τ</italic>). The Jacobian <italic>J</italic><sup>†</sup> is the transpose of the Jacobian matrix defined in <xref ref-type="disp-formula" rid="pcbi.1004762.e028">Eq (5)</xref> and has the same off-diagonal elements as <italic>C</italic>, so asym<sub><italic>J</italic></sub> = asym<sub><italic>C</italic></sub>. For small <italic>τ</italic>, <italic>Q</italic><sup><italic>τ</italic></sup> can be approximated by <italic>Q</italic><sup>0</sup> + <italic>Q</italic><sup>0</sup> <italic>J</italic><sup>†</sup> <italic>τ</italic>, which explains why asym<sub><italic>Q</italic><sup><italic>τ</italic></sup></sub> is smaller than asym<sub><italic>C</italic></sub>. The variability of the <italic>Q</italic><sup><italic>τ</italic></sup> asymmetry compared to the small slopes of the curves makes it difficult to infer the asymmetry of <italic>C</italic>. This further motivates our method to estimate accurately <italic>C</italic> from <italic>Q</italic>.</p>
<p>We focus on the case where the recurrent weights are sufficiently large to generate a strong network effect: the mapping between <italic>C</italic> and <italic>Q</italic> is not trivially linear and many large values in <italic>Q</italic><sup>0</sup> correspond to nodes that are only weakly or not connected. Here, hubs in the network in <xref ref-type="fig" rid="pcbi.1004762.g001">Fig 1A</xref> are not connected, but have strong variances in <xref ref-type="fig" rid="pcbi.1004762.g001">Fig 1G</xref> and covariances between each other due to their numerous connections.</p>
</sec>
<sec id="sec016">
<title>Test of Lyapunov optimization (LO) on artificial networks</title>
<p>The optimization procedure is summarized in <xref ref-type="fig" rid="pcbi.1004762.g001">Fig 1H</xref>: <italic>C</italic> is iteratively modified such that the model covariance matrices <italic>Q</italic><sup>0</sup> and <italic>Q</italic><sup><italic>τ</italic></sup> converge towards the objective covariance matrices <inline-formula id="pcbi.1004762.e080"><alternatives><graphic id="pcbi.1004762.e080g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e080" xlink:type="simple"/><mml:math display="inline" id="M80"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>0</mml:mn></mml:msup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1004762.e081"><alternatives><graphic id="pcbi.1004762.e081g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e081" xlink:type="simple"/><mml:math display="inline" id="M81"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>τ</mml:mi></mml:msup></mml:math></alternatives></inline-formula>, for a chosen <italic>τ</italic> = <italic>τ</italic><sub><italic>est</italic></sub> &gt; 0. In the first place we assume Σ to be known. Starting from a initial matrix <italic>C</italic> with all weights equal to zero, LO calculate a <italic>C</italic> update at each step such that it reduces the Lyapunov function <italic>V</italic> in <xref ref-type="disp-formula" rid="pcbi.1004762.e052">Eq (13)</xref>; <italic>V</italic> is the sum of the matrix distance between <italic>Q</italic><sup>0</sup> and <inline-formula id="pcbi.1004762.e082"><alternatives><graphic id="pcbi.1004762.e082g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e082" xlink:type="simple"/><mml:math display="inline" id="M82"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>0</mml:mn></mml:msup></mml:math></alternatives></inline-formula> on the one hand, and that between <italic>Q</italic><sup><italic>τ</italic></sup> and <inline-formula id="pcbi.1004762.e083"><alternatives><graphic id="pcbi.1004762.e083g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e083" xlink:type="simple"/><mml:math display="inline" id="M83"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>τ</mml:mi></mml:msup></mml:math></alternatives></inline-formula> on the other hand. To measure the goodness of fit of <italic>C</italic> or <italic>Q</italic>, we define the model ‘error’ as the normalized distance for a matrix <italic>M</italic> and its objective <italic>M</italic><sup><italic>obj</italic></sup>:
<disp-formula id="pcbi.1004762.e084"><alternatives><graphic id="pcbi.1004762.e084g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e084" xlink:type="simple"/><mml:math display="block" id="M84"><mml:mrow><mml:mi mathvariant="normal">d</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>M</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>M</mml:mi> <mml:mtext>obj</mml:mtext></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>:</mml:mo> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mo>∑</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>M</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>M</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mtext>obj</mml:mtext></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow> <mml:mrow><mml:msub><mml:mo>∑</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>M</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mtext>obj</mml:mtext></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac> <mml:mspace width="4pt"/><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(25)</label></disp-formula>
which are involved in <italic>V</italic>.</p>
<p>Firstly we verify that LO recovers the correct connectivity for theoretical objectives <inline-formula id="pcbi.1004762.e085"><alternatives><graphic id="pcbi.1004762.e085g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e085" xlink:type="simple"/><mml:math display="inline" id="M85"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>/</mml:mo> <mml:mi>τ</mml:mi></mml:mrow></mml:msup></mml:math></alternatives></inline-formula> calculated with Eqs <xref ref-type="disp-formula" rid="pcbi.1004762.e030">(6)</xref> and <xref ref-type="disp-formula" rid="pcbi.1004762.e033">(7)</xref> with the original <italic>C</italic> and Σ. A typical example for the evolution of the <italic>C</italic> and <italic>Q</italic> errors is illustrated in <xref ref-type="fig" rid="pcbi.1004762.g002">Fig 2A</xref> for <italic>τ</italic><sub><italic>est</italic></sub> = <italic>τ</italic><sub><italic>x</italic></sub> = 1 s. While the <italic>Q</italic><sup>0/<italic>τ</italic></sup> errors exhibit a plateau, the <italic>C</italic> error keeps on decreasing. <xref ref-type="fig" rid="pcbi.1004762.g002">Fig 2B</xref> shows the faster convergence for <italic>Q</italic> than <italic>C</italic> for three stages of the optimization. The residual <italic>C</italic> error is very small; it may remain non-zero when the commutativity assumption necessary to derive <xref ref-type="disp-formula" rid="pcbi.1004762.e056">Eq (15)</xref> is not satisfied.</p>
<fig id="pcbi.1004762.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004762.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Iterative optimization to recover <italic>C</italic> from empirical <italic>Q</italic>.</title>
<p><bold>A</bold> Estimation based on theoretical covariances. Evolution of <italic>Q</italic><sup>0</sup> and <italic>Q</italic><sup><italic>τ</italic></sup> errors between the model and theoretical objectives (blue curves), as well as <italic>C</italic> error between the original and model connectivity (red). The theoretical objectives <inline-formula id="pcbi.1004762.e086"><alternatives><graphic id="pcbi.1004762.e086g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e086" xlink:type="simple"/><mml:math display="inline" id="M86"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>/</mml:mo> <mml:mi>τ</mml:mi></mml:mrow></mml:msup></mml:math></alternatives></inline-formula> are calculated using Eqs <xref ref-type="disp-formula" rid="pcbi.1004762.e030">(6)</xref> and <xref ref-type="disp-formula" rid="pcbi.1004762.e033">(7)</xref>. Errors are calculated using the normalized matrix distance in <xref ref-type="disp-formula" rid="pcbi.1004762.e084">Eq (25)</xref>. The optimization relies on <xref ref-type="disp-formula" rid="pcbi.1004762.e056">Eq (15)</xref> with time shift <italic>τ</italic><sub><italic>est</italic></sub> = 1 s. <bold>B</bold> Details of the match of the model and objective matrices for <italic>Q</italic><sup><italic>τ</italic></sup> (blue dots) and <italic>C</italic> (red crosses) at three stages of the optimization in A. The black line indicates a perfect match. <bold>C</bold> Similar plot to A with empirical <italic>Q</italic> as objectives, evaluated using <xref ref-type="disp-formula" rid="pcbi.1004762.e010">Eq (2)</xref> for 50 simulations of the same network as in A. <bold>D</bold> Similar plot to B for the optimization in C.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004762.g002" xlink:type="simple"/>
</fig>
<p>For the same original <italic>C</italic>, we now simulate the network and calculate the empirical objectives <inline-formula id="pcbi.1004762.e087"><alternatives><graphic id="pcbi.1004762.e087g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e087" xlink:type="simple"/><mml:math display="inline" id="M87"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>/</mml:mo> <mml:mi>τ</mml:mi></mml:mrow></mml:msup></mml:math></alternatives></inline-formula> using <xref ref-type="disp-formula" rid="pcbi.1004762.e010">Eq (2)</xref> for 50 independent repetitions of 300 s each with timestep 0.05 s (i.e., 3 × 10<sup>5</sup> data points). In <xref ref-type="fig" rid="pcbi.1004762.g002">Fig 2C</xref>, the <italic>Q</italic><sup>0/<italic>τ</italic></sup> errors first drop, then rebound and stabilize. Interestingly, the <italic>C</italic> error continues to decrease even though the <italic>Q</italic> error worsens. Because of the noise in the empirical <inline-formula id="pcbi.1004762.e088"><alternatives><graphic id="pcbi.1004762.e088g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e088" xlink:type="simple"/><mml:math display="inline" id="M88"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>/</mml:mo> <mml:mi>τ</mml:mi></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>, there is no real solution <italic>C</italic> to <xref ref-type="disp-formula" rid="pcbi.1004762.e033">Eq (7)</xref> and the residual error does not vanish. In <xref ref-type="fig" rid="pcbi.1004762.g002">Fig 2D</xref>, the model <italic>C</italic> gives a better fit for the original <italic>C</italic> after 5000 optimization steps than for the minimum for the <italic>Q</italic> error. LO also allows for the use of constraints on the weights in <italic>C</italic>. Non-negativity is imposed here, although it does not affect the results significantly.</p>
<sec id="sec017">
<title>Matching time shift is crucial for accurate connectivity estimation</title>
<p>The estimation performance depends on the choice for <italic>τ</italic><sub><italic>est</italic></sub> related to the empirical objectives: <xref ref-type="fig" rid="pcbi.1004762.g003">Fig 3A</xref> shows for several <italic>τ</italic><sub><italic>est</italic></sub> the ‘best’ <italic>C</italic>, corresponding to the minimum of the <italic>Q</italic> error as in <xref ref-type="fig" rid="pcbi.1004762.g002">Fig 2C</xref> during the optimization. From now on, the <italic>Q</italic> error denotes the mean normalized distance for both <italic>Q</italic> matrices: <inline-formula id="pcbi.1004762.e089"><alternatives><graphic id="pcbi.1004762.e089g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e089" xlink:type="simple"/><mml:math display="inline" id="M89"><mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="normal">d</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>Q</mml:mi> <mml:mn>0</mml:mn></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>0</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi mathvariant="normal">d</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>Q</mml:mi> <mml:mi>τ</mml:mi></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>τ</mml:mi></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>. For <italic>τ</italic><sub><italic>est</italic></sub> = 0.1 and 1 s, the global characteristics of the original <italic>C</italic> topology (left panel) are recovered, namely the two interconnected groups linked via hubs that are not connected with each other. Although weights are weaker than in the original <italic>C</italic>, the detail of the connectivity is recovered for <italic>τ</italic><sub><italic>est</italic></sub> = 1 s. In contrast, the estimated <italic>C</italic> for <italic>τ</italic><sub><italic>est</italic></sub> = 0.1 s is quasi symmetric. Last, <italic>τ</italic><sub><italic>est</italic></sub> = 5 s gives a poor estimation where the cluster-hub topology is hardly detected.</p>
<fig id="pcbi.1004762.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004762.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Influence of choice for <italic>τ</italic><sub><italic>est</italic></sub> on accuracy of recovered <italic>C</italic>.</title>
<p><bold>A</bold> Best estimated matrices <italic>C</italic> for <italic>τ</italic><sub><italic>est</italic></sub> = 0, 0.1, 1 and 5 s. For <italic>τ</italic><sub><italic>est</italic></sub> = 1, the <italic>C</italic> matrix at the end of the optimization (step 10000) is also shown. <bold>B</bold> Evolution of <italic>Q</italic> errors for the optimizations with various <italic>τ</italic><sub><italic>est</italic></sub> in A. bf C <italic>C</italic> errors corresponding to the best matrices in A (red solid curve), as well as last matrices of the optimization (red dashed curve). The green curve indicates the error of the best <italic>C</italic> with the symmetric part of the original <italic>C</italic>. The blue curve indicates the error between the empirical <inline-formula id="pcbi.1004762.e090"><alternatives><graphic id="pcbi.1004762.e090g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e090" xlink:type="simple"/><mml:math display="inline" id="M90"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>τ</mml:mi></mml:msup></mml:math></alternatives></inline-formula> and the corresponding theoretical matrix. <bold>D</bold> Pearson correlation coefficient between the best and original <italic>C</italic> (red) as well as reconstructed and objective <italic>Q</italic><sup>0/<italic>τ</italic></sup>. between <inline-formula id="pcbi.1004762.e091"><alternatives><graphic id="pcbi.1004762.e091g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e091" xlink:type="simple"/><mml:math display="inline" id="M91"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>τ</mml:mi></mml:msup></mml:math></alternatives></inline-formula> and each corresponding theoretical <italic>Q</italic><sup><italic>τ</italic></sup> matrix for the same <italic>τ</italic> = <italic>τ</italic><sub><italic>est</italic></sub> in C. <bold>E</bold> Comparison between LO with empirical <inline-formula id="pcbi.1004762.e092"><alternatives><graphic id="pcbi.1004762.e092g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e092" xlink:type="simple"/><mml:math display="inline" id="M92"><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> calculated with <xref ref-type="disp-formula" rid="pcbi.1004762.e010">Eq (2)</xref> (red solid curve) and LO with theoretical <inline-formula id="pcbi.1004762.e093"><alternatives><graphic id="pcbi.1004762.e093g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e093" xlink:type="simple"/><mml:math display="inline" id="M93"><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> obtained from <xref ref-type="disp-formula" rid="pcbi.1004762.e033">Eq (7)</xref> (red dashed curve). The blue curve indicates the inaccuracy between the empirical and theoretical <italic>Q</italic><sup><italic>τ</italic></sup> matrices. <bold>F</bold> Same as B for the <italic>Q</italic> error with theoretical objectives <inline-formula id="pcbi.1004762.e094"><alternatives><graphic id="pcbi.1004762.e094g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e094" xlink:type="simple"/><mml:math display="inline" id="M94"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>/</mml:mo> <mml:mi>τ</mml:mi></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004762.g003" xlink:type="simple"/>
</fig>
<p>The left panel of <xref ref-type="fig" rid="pcbi.1004762.g003">Fig 3B</xref> shows the evolution of the <italic>Q</italic> errors for the optimizations in A. For small or large <italic>τ</italic><sub><italic>est</italic></sub> &gt; 0 compared to <italic>τ</italic><sub><italic>x</italic></sub> = 1 s, the <italic>Q</italic> error often exhibits a large rebound similar to an explosion (dashed curves). LO being less stable for small and large <italic>τ</italic><sub><italic>est</italic></sub> &gt; 0, it gives a poor estimate for <italic>C</italic>. In the case <italic>τ</italic><sub><italic>est</italic></sub> = 0, the optimization using <xref ref-type="disp-formula" rid="pcbi.1004762.e067">Eq (19)</xref> is rather stable; however, the resulting estimate is closer to the symmetric part of the original <italic>C</italic>, not the directed matrix. The rate of change for <italic>C</italic> is displayed in <xref ref-type="fig" rid="pcbi.1004762.g003">Fig 3B</xref> (right): during the rebound or plateau of the <italic>Q</italic> error, the <italic>C</italic> matrix stabilizes for <italic>τ</italic><sub><italic>est</italic></sub> = 0 and 1 s (solid curves).</p>
<p>
<xref ref-type="fig" rid="pcbi.1004762.g003">Fig 3C</xref> recapitulates our first main theoretical finding: <italic>τ</italic><sub><italic>est</italic></sub> needs to be matched with <italic>τ</italic><sub><italic>x</italic></sub> = 1 s in order to obtain an accurate estimation (see <italic>C</italic> errors in red). The dashed red curve corresponds to the <italic>C</italic> for the minimum of the rate of change (red curves in <xref ref-type="fig" rid="pcbi.1004762.g003">Fig 3B</xref>), yielding a better <italic>C</italic> recovery than the solid red curve that corresponds to the minimum of the <italic>Q</italic> error (blue curves). The green curve indicates the matrix distance to the symmetric part of the original <italic>C</italic>, namely 0.5(<italic>C</italic>+<italic>C</italic><sup>†</sup>). It shows that LO for small <italic>τ</italic><sub><italic>est</italic></sub> &gt; 0 recovers the undirected connectivity like <italic>τ</italic><sub><italic>est</italic></sub> = 0, rather than the correct directed one. Finally, we observe that the best <italic>Q</italic> error corresponding to the minimum over the optimization (blue curve) is not a good indicator for the <italic>C</italic> error (red curve): it does not provide useful insight for choosing <italic>τ</italic><sub><italic>est</italic></sub>. The performance is further illustrated in <xref ref-type="fig" rid="pcbi.1004762.g003">Fig 3D</xref> by the Pearson correlation coefficient between the best and empirical <italic>C</italic> (red curve) and <italic>Q</italic>. The best <italic>C</italic> for <italic>τ</italic><sub><italic>est</italic></sub> = 1 s corresponds to values larger than 0.8, which means that the weight ranking of the original <italic>C</italic> is well captured.</p>
<p>In <xref ref-type="fig" rid="pcbi.1004762.g003">Fig 3E</xref>, we compare LO for empirical objectives (red solid curve) with LO for theoretical objectives (red dashed curve). For <italic>τ</italic><sub><italic>est</italic></sub> &gt; 0, even theoretical objectives give a large <italic>C</italic> error, meaning that the poor performance comes from the procedure itself. This can be intuited from <xref ref-type="disp-formula" rid="pcbi.1004762.e056">Eq (15)</xref>, which relies on a “contrast” between <inline-formula id="pcbi.1004762.e095"><alternatives><graphic id="pcbi.1004762.e095g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e095" xlink:type="simple"/><mml:math display="inline" id="M95"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>0</mml:mn></mml:msup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1004762.e096"><alternatives><graphic id="pcbi.1004762.e096g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e096" xlink:type="simple"/><mml:math display="inline" id="M96"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>τ</mml:mi></mml:msup></mml:math></alternatives></inline-formula>: for small <italic>τ</italic><sub><italic>est</italic></sub>, these two matrices are too similar and the <italic>C</italic> update is subject to numerical imprecision. This is confirmed by the evolution of the <italic>Q</italic> error in <xref ref-type="fig" rid="pcbi.1004762.g003">Fig 3F</xref>. For large <italic>τ</italic><sub><italic>est</italic></sub>, however, theoretical objectives yield a very good estimation. This means that the poor performance for large <italic>τ</italic><sub><italic>est</italic></sub> comes from the inaccuracy in the empirical <inline-formula id="pcbi.1004762.e097"><alternatives><graphic id="pcbi.1004762.e097g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e097" xlink:type="simple"/><mml:math display="inline" id="M97"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>τ</mml:mi></mml:msup></mml:math></alternatives></inline-formula>, as represented by the blue solid curve in <xref ref-type="fig" rid="pcbi.1004762.g003">Fig 3E</xref>.</p>
</sec>
<sec id="sec018">
<title>Need for estimating intrinsic noise in addition to connectivity</title>
<p>Now we extend the LO procedure to adjust the variance of the noise individually inputted to the network nodes: each diagonal element Σ<sub><italic>ii</italic></sub> is increased or decreased such that the node variance <inline-formula id="pcbi.1004762.e098"><alternatives><graphic id="pcbi.1004762.e098g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e098" xlink:type="simple"/><mml:math display="inline" id="M98"><mml:msubsup><mml:mi>Q</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>i</mml:mi></mml:mrow> <mml:mn>0</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula> of the model converges toward its objective <inline-formula id="pcbi.1004762.e099"><alternatives><graphic id="pcbi.1004762.e099g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e099" xlink:type="simple"/><mml:math display="inline" id="M99"><mml:msubsup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>i</mml:mi></mml:mrow> <mml:mn>0</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula>, see <xref ref-type="disp-formula" rid="pcbi.1004762.e069">Eq (20)</xref> in Methods. To verify the estimation accuracy, we consider a target network with Σ<sub><italic>ii</italic></sub> elements uniformly distributed between in [0.1, 0.6] and perform LO for the theoretical objectives <inline-formula id="pcbi.1004762.e100"><alternatives><graphic id="pcbi.1004762.e100g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e100" xlink:type="simple"/><mml:math display="inline" id="M100"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>0</mml:mn></mml:msup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1004762.e101"><alternatives><graphic id="pcbi.1004762.e101g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e101" xlink:type="simple"/><mml:math display="inline" id="M101"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>τ</mml:mi></mml:msup></mml:math></alternatives></inline-formula> with <italic>τ</italic> = 1 s obtained using Eqs <xref ref-type="disp-formula" rid="pcbi.1004762.e030">(6)</xref> and <xref ref-type="disp-formula" rid="pcbi.1004762.e033">(7)</xref>. The match between the model and objectives for both <italic>C</italic> and Σ is shown in <xref ref-type="fig" rid="pcbi.1004762.g004">Fig 4A</xref>, corresponding to a quasi perfect estimation of the connectivity as in <xref ref-type="fig" rid="pcbi.1004762.g002">Fig 2B</xref> for the tuning of <italic>C</italic> only.</p>
<fig id="pcbi.1004762.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004762.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Need for tuning intrinsic noise Σ for each node in addition to <italic>C</italic>.</title>
<p><bold>A</bold> Match between the recovered and the original <italic>C</italic> (red crosses) and Σ (purple triangles) for LO based on Eqs <xref ref-type="disp-formula" rid="pcbi.1004762.e056">(15)</xref> and <xref ref-type="disp-formula" rid="pcbi.1004762.e069">(20)</xref> with theoretical objectives and <italic>τ</italic><sub><italic>est</italic></sub> = 1 s. The original network has inhomogeneous noise Σ<sub><italic>ii</italic></sub>. <bold>B</bold> Comparison of <italic>Q</italic> error, <italic>C</italic> error and Pearson correlation coefficient for non-zero weights of the original <italic>C</italic> for four optimizations: ‘opt’ where both <italic>C</italic> and Σ are tuned as in A; ‘low’ for the tuning of <italic>C</italic> with a fixed Σ with the minimum value of the original Σ; likewise, ‘med’ and ‘high’ with a fixed Σ with the mean and maximum value of the original Σ. <bold>C</bold> Match between the original and recovered <italic>C</italic> for the optimization with fixed homogeneous Σ for three distinct values: the minimum, mean and maximum of the values in the original Σ. They are to be compared with the left panel in A.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004762.g004" xlink:type="simple"/>
</fig>
<p>To assess the importance of tuning Σ, we perform three optimizations using a fixed homogeneous Σ for three levels of noise, namely the minimum, mean and maximum of the original Σ. As illustrated in <xref ref-type="fig" rid="pcbi.1004762.g004">Fig 4B</xref>, the <italic>Q</italic> error and, more importantly, the <italic>C</italic> error are larger for those cases (circle, square and triangle) than that with the tuning of Σ (crosses). Moreover, the values for the non-zero weights in the original <italic>C</italic> are estimated less accurately, as measured by the Pearson correlation coefficient. <xref ref-type="fig" rid="pcbi.1004762.g004">Fig 4C</xref> shows for each case the corresponding matches between the original and estimated <italic>C</italic> matrices. This is the second main theoretical finding: the optimization of Σ is as important as choosing <italic>τ</italic><sub><italic>est</italic></sub> to obtain an accurate estimate for <italic>C</italic>.</p>
<p>In practice, we find that a fast tuning for Σ works best in order to keep the optimization stable, i.e., avoid early “explosion” of the <italic>Q</italic> error. The presented simulations corresponds to <italic>ϵ</italic><sub>Σ</sub> = 10<sup>−1</sup> in <xref ref-type="disp-formula" rid="pcbi.1004762.e069">Eq (20)</xref>, to be compared with <italic>ϵ</italic><sub><italic>C</italic></sub> = 2 × 10<sup>−4</sup> to calculate Δ<italic>Q</italic> in <xref ref-type="disp-formula" rid="pcbi.1004762.e055">Eq (14)</xref> for the <italic>C</italic> update, cf. Methods.</p>
</sec>
<sec id="sec019">
<title>Benchmark of LO procedure and comparison to the direct and heuristic methods</title>
<p>
<xref ref-type="fig" rid="pcbi.1004762.g005">Fig 5</xref> combines the results found in Figs <xref ref-type="fig" rid="pcbi.1004762.g003">3</xref> and <xref ref-type="fig" rid="pcbi.1004762.g004">4</xref> to verify the robustness of LO when varying the network parameters. <xref ref-type="fig" rid="pcbi.1004762.g005">Fig 5A</xref> compares the <italic>C</italic> error for two network topologies: the lighter red curve corresponds to the cluster-hub type as in <xref ref-type="fig" rid="pcbi.1004762.g001">Fig 1A</xref> and the darker curve to randomly connected networks. The need for matching <italic>τ</italic> with <italic>τ</italic><sub><italic>x</italic></sub> is confirmed in the left panel for both types. The Σ error in purple is close to perfect for all <italic>τ</italic><sub><italic>est</italic></sub>. The error bars correspond to the variability over 40 networks with randomly chosen parameters: 25 ≤ <italic>n</italic><sub><italic>sim</italic></sub> ≤ 50 simulations to calculate the empirical <inline-formula id="pcbi.1004762.e102"><alternatives><graphic id="pcbi.1004762.e102g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e102" xlink:type="simple"/><mml:math display="inline" id="M102"><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>; network size 50 ≤ <italic>N</italic> ≤ 100; probability of connection <italic>p</italic><sub><italic>con</italic></sub> ∈ [10%, 30%]; maximum recurrent weight <italic>c</italic><sub><italic>max</italic></sub> ∈ [1.2, 2] × 1/<italic>N</italic>/<italic>p</italic><sub><italic>con</italic></sub>; input strength <italic>e</italic> ∈ [0.8, 1.2]; and average noise level <italic>σ</italic> ∈ [0.3, 0.6], with individual values shuffled ±50%; see also <xref ref-type="table" rid="pcbi.1004762.t002">Table 2</xref>. No significant difference is observed there. On average over all 80 networks, LO with <italic>τ</italic><sub><italic>est</italic></sub> = 0.5 and 1 s give the best performance. On a technical ground, following the observations in <xref ref-type="fig" rid="pcbi.1004762.g003">Fig 3B and 3C</xref>, here the best <italic>C</italic> is chosen after the minimum for the <italic>Q</italic> error, provided the rate of change for <italic>C</italic> decreases (i.e., <italic>C</italic> keeps stabilizing) and the <italic>Q</italic> error remains smaller than 1.5 times its minimum.</p>
<fig id="pcbi.1004762.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004762.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Robustness of the estimation procedure of <italic>C</italic> and Σ on artificial networks.</title>
<p><bold>A</bold> Left: Comparison of the <italic>C</italic> error (red curves) and Σ error (purple curve) for optimization based on several <italic>τ</italic><sub><italic>est</italic></sub>. For the <italic>C</italic> error, the cluster-hub topology in <xref ref-type="fig" rid="pcbi.1004762.g001">Fig 1A</xref> corresponds to lighter red and the random connectivity to darker red. The plot is similar to <xref ref-type="fig" rid="pcbi.1004762.g003">Fig 3C</xref>; the error bars correspond to the standard deviation over 40 network configurations. Right: Similar plot for the error of <italic>asym</italic><sub><italic>C</italic></sub> for the two network topologies. <bold>B</bold> Pearson correlation coefficient between the matrix elements of the whole recovered and original <italic>C</italic> matrices in red; idem but limited to non-zero elements of the original <italic>C</italic> in yellow; and between the recovered <italic>C</italic> and the symmetric part of the original <italic>C</italic> in green. The plot concerns 50 networks of either topology for which the asymmetry of original <italic>C</italic> is larger than 0.5; LO is performed using <italic>τ</italic><sub><italic>est</italic></sub> = 1 s. <bold>C</bold> <italic>C</italic> and <italic>Q</italic> errors (in red and blue, respectively) plotted against several parameters for the network and LO: the number of simulations used to calculate the empirical <inline-formula id="pcbi.1004762.e103"><alternatives><graphic id="pcbi.1004762.e103g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e103" xlink:type="simple"/><mml:math display="inline" id="M103"><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, the network size <italic>N</italic> and the asymmetry of the original <italic>C</italic>. Each cross/dot corresponds to one of the 80 simulations of either topology in A for <italic>τ</italic><sub><italic>est</italic></sub> = 1 s. <bold>D</bold> Comparison of the estimation performance of LO wit the direct and heuristic methods for the <italic>C</italic> error (left), the Σ error (middle) and asymmetry error (right). For each case, the left boxplot correspond to 40 cluster-hub networks and the right one to 40 randomly connected networks; the optimizations are performed with <italic>τ</italic><sub><italic>est</italic></sub> = 1 s. Contrary to others, the asymmetry error is not normalized.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004762.g005" xlink:type="simple"/>
</fig>
<p>The right panel of <xref ref-type="fig" rid="pcbi.1004762.g001">Fig 1A</xref> shows that the asymmetry of the original <italic>C</italic> is correctly estimated for matched <italic>τ</italic> and <italic>τ</italic><sub><italic>x</italic></sub>. This means that directed connections are well estimated. <xref ref-type="fig" rid="pcbi.1004762.g005">Fig 5B</xref> further illustrates the quality of the estimation for the 50 networks with the strongest asymmetries: for small <italic>τ</italic><sub><italic>est</italic></sub> ≥ 0, the estimated <italic>C</italic> is closer to the symmetric part of the original <italic>C</italic> (largest Pearson correlations in green). For <italic>τ</italic><sub><italic>est</italic></sub> = 1 s, the <italic>C</italic> recovers well the directed connections in the original <italic>C</italic>, as shown by the Pearson correlations in red (all connections) and yellow (non-zero connections in the original <italic>C</italic>).</p>
<p>
<xref ref-type="fig" rid="pcbi.1004762.g005">Fig 5C</xref> shows how LO performs depending on the amount of observed data and network parameters. As expected from previous work [<xref ref-type="bibr" rid="pcbi.1004762.ref025">25</xref>], the optimization performs better in <xref ref-type="fig" rid="pcbi.1004762.g005">Fig 5C</xref> when a larger number <italic>n</italic><sub><italic>sim</italic></sub> of simulations of the network activity is used to compute <inline-formula id="pcbi.1004762.e104"><alternatives><graphic id="pcbi.1004762.e104g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e104" xlink:type="simple"/><mml:math display="inline" id="M104"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>0</mml:mn></mml:msup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1004762.e105"><alternatives><graphic id="pcbi.1004762.e105g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e105" xlink:type="simple"/><mml:math display="inline" id="M105"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>τ</mml:mi></mml:msup></mml:math></alternatives></inline-formula>, see <xref ref-type="disp-formula" rid="pcbi.1004762.e010">Eq (2)</xref>. Connectivity in larger networks is more difficult to estimate, but the asymmetry of the original <italic>C</italic> does not affect much the performance.</p>
<p>Finally, we compare our method with the direct and heuristic methods corresponding to Eqs <xref ref-type="disp-formula" rid="pcbi.1004762.e039">(8)</xref> and <xref ref-type="disp-formula" rid="pcbi.1004762.e070">(21)</xref>, respectively. For each case in <xref ref-type="fig" rid="pcbi.1004762.g005">Fig 5D</xref>, the left and right box plots correspond to the optimization with with <italic>τ</italic><sub><italic>est</italic></sub> = 1 s for 40 cluster-hub and 40 randomly connected networks as in <xref ref-type="fig" rid="pcbi.1004762.g005">Fig 5A</xref>, respectively. While the Σ error is very small for all methods, the <italic>C</italic> error is much smaller for LO than the others. The direct method gives large complex values in the Jacobian obtained from <xref ref-type="disp-formula" rid="pcbi.1004762.e039">Eq (8)</xref> due to the “noise” in empirical <inline-formula id="pcbi.1004762.e106"><alternatives><graphic id="pcbi.1004762.e106g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e106" xlink:type="simple"/><mml:math display="inline" id="M106"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>/</mml:mo> <mml:mi>τ</mml:mi></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>, which severely impairs the estimation. The heuristic method also yields a poor <italic>C</italic> error, although the <italic>Q</italic> error is very low: it does not capture the network effect correctly, namely the non-linear mapping between <italic>C</italic> and <italic>Q</italic> due to the recurrent feedback. Last, the asymmetry of the original <italic>C</italic> is best estimated by LO.</p>
</sec>
</sec>
<sec id="sec020">
<title>Hemodynamics and temporal information in BOLD covariances</title>
<p>Our method relies on information in time-shifted covariances to infer the connectivity of the underlying network. In the context of cortical models of BOLD activity, EC classically denotes the connections between neural populations, whose activity is transformed into BOLD signals via a hemodynamic response function (HRF). Before applying our method to fMRI experimental data, we need to test whether BOLD time series as obtained from the HRF convey information in their time-shifted measures about EC.</p>
<p>Therefore we compare our noise-diffusion (ND) network with the dynamic mean-field (DMF) model based on AMPA and NMDA dynamics [<xref ref-type="bibr" rid="pcbi.1004762.ref027">27</xref>] equipped with the Balloon/Windkessel model for the HRF [<xref ref-type="bibr" rid="pcbi.1004762.ref029">29</xref>]. As illustrated in <xref ref-type="fig" rid="pcbi.1004762.g006">Fig 6A</xref>, the synaptic input activity of the DMF (<italic>u</italic><sub><italic>i</italic></sub> in Methods) is transformed by the HRF to generate the BOLD signal. We consider the two topologies in <xref ref-type="fig" rid="pcbi.1004762.g006">Fig 6B</xref>: a randomly connected network and a network whose connections correspond to the SC obtained from dwMRI (see <xref ref-type="sec" rid="sec002">Methods</xref>). The SC connectivity has 32% density corresponding to the largest dwMRI values, as will be used in the next sections for the ND model applied to fMRI data. The model parameters are taken from previous publications [<xref ref-type="bibr" rid="pcbi.1004762.ref027">27</xref>, <xref ref-type="bibr" rid="pcbi.1004762.ref029">29</xref>] and recapitulated in <xref ref-type="table" rid="pcbi.1004762.t003">Table 3</xref>. In <xref ref-type="fig" rid="pcbi.1004762.g006">Fig 6C</xref>, we simulate 50 configurations of the DMF+HRF model with the two topologies (‘DMF/rnd’ and ‘DMF/SC’, respectively). For each, we choose weights randomly and calculate the empirical autocovariances of the BOLD signals. We find significant values up to time shifts equal to 3 s, which then drop. Interestingly, the slope in the log plot for the smaller time shifts is close to that found in experimental data (black line) up to 2 s of time shift. Then we estimate the similarity between the neural covariances at a short timescale and the FC given by the BOLD covariances, using the Pearson correlation coefficient between the corresponding matrix elements. As shown by the Pearson correlations in <xref ref-type="fig" rid="pcbi.1004762.g006">Fig 6D</xref> (left panel), the match between the neural and BOLD covariances is good, especially when EC is constrained by SC. This means that, although the HRF involves nonlinearities, the DMF model preserves the ranking of the spatio-temporal covariances is preserved between neural and BOLD activity, as illustrated in <xref ref-type="fig" rid="pcbi.1004762.g006">Fig 6E</xref>. In particular, the time-shifted BOLD covariance matrices are asymmetric.</p>
<fig id="pcbi.1004762.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004762.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Information conveyed by spatio-temporal FC and hemodynamic response function (HRF).</title>
<p><bold>A</bold> Schematic representation of the properties of the two dynamic cortical model: ND network whose activity directly models the BOLD signals; dynamic mean-field (DMF) model whose synaptic activity is processed by the HRF to obtain the BOLD signal. <bold>B</bold> Two types of neural connectivity used with the DMF: random and SC matrix obtained from dwMRI. In the matrix, darker pixels indicate a higher probability of existing fibers between cortical areas. <bold>C</bold> Autocovariances of the two models for 50 different simulations. The y-axis has a log-scale. For each simulation, the curves are centered vertically with respect of the mean over all nodes to focus on the slope. The black line represents the exponential decay fitted on the mean experimental BOLD with time constant 5.3 s. <bold>D</bold> Left: Similarity between neural and BOLD covariances (excluding variances) for the two considered DMF models, as measured by the Pearson correlation coefficient. Right: Performance of EC estimation from BOLD FC for the DMF models. The performance is measured by the Pearson correlation coefficient. For each simulation, the objective is the average BOLD FC taken from 50 simulations of the same network. <bold>E</bold> Example of a typical mapping between neural and BOLD covariances for a DMF/SC network. The covariances have been rescaled. <bold>F</bold> Variability of the EC estimated from individual FCs. The grey dots represent the match of four EC each estimated for a single simulation of 300 s. The red dots correspond to the average over 50 estimated EC for 50 simulations of the same DMF/SC network. <bold>G</bold> Uncertainty of the estimated EC as a function of the estimated weight for each neural connection. The y-axis is the standard deviation over the 50 optimizations in F divided by the mean.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004762.g006" xlink:type="simple"/>
</fig>
<p>Now we use the LO procedure to estimate the original EC from the BOLD FC with <italic>τ</italic><sub><italic>est</italic></sub> = 1 s. The right panel in <xref ref-type="fig" rid="pcbi.1004762.g006">Fig 6D</xref> indicates the Pearson correlation between the original and estimated connectivity. For the DMF model, the agreement corresponds to 0.6 and 0.65 for the random and SC topologies, respectively. This means a fair recovery of the ranking between the original EC weights. For the DMF/SC networks where the existing connections are “known” (32% density), LO only tunes the corresponding weights in <italic>C</italic>.</p>
<p>Finally, we find that the variability of the estimated ECs decreases with the strength of the neural connection. This suggests that strong estimated EC values can be trusted based on a threshold on the variability of the estimations (standard deviation divided by the mean). Together, these results support the applicability of our method to fMRI data and directly estimate the EC strengths from the average FC.</p>
</sec>
<sec id="sec021">
<title>Application to estimation of EC from fMRI data during rest</title>
<p>Now we use the ND model to reproduce the cortical FC obtained from fMRI recordings during rest. In contrast to previous studies [<xref ref-type="bibr" rid="pcbi.1004762.ref012">12</xref>, <xref ref-type="bibr" rid="pcbi.1004762.ref027">27</xref>], FC involves both zero-time-shift and time-shifted covariances of the BOLD signals for the 68 cortical regions here. Following the results in <xref ref-type="fig" rid="pcbi.1004762.g006">Fig 6</xref>, we denote by EC the connectivity <italic>C</italic> in our model, even though the network activity directly models the BOLD signals without a HRF. The data set corresponds to 25 subjects aged from 20 to 39 years. The empirical covariances are calculated using <xref ref-type="disp-formula" rid="pcbi.1004762.e010">Eq (2)</xref> for <italic>τ</italic> that are multiples of 2 s, which is the temporal resolution of the BOLD time series. <xref ref-type="fig" rid="pcbi.1004762.g007">Fig 7A</xref> displays the objective FC matrices <inline-formula id="pcbi.1004762.e107"><alternatives><graphic id="pcbi.1004762.e107g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e107" xlink:type="simple"/><mml:math display="inline" id="M107"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>0</mml:mn></mml:msup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1004762.e108"><alternatives><graphic id="pcbi.1004762.e108g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e108" xlink:type="simple"/><mml:math display="inline" id="M108"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>τ</mml:mi></mml:msup></mml:math></alternatives></inline-formula> with <italic>τ</italic> = 4 s, which are averages over all subjects. The autocorrelograms of all 68 nodes are displayed in the inset of <xref ref-type="fig" rid="pcbi.1004762.g007">Fig 7B</xref>. The main panel shows the same curves with a log-scale for the y-axis: they seem quasi straight lines indicating exponential decays, as observed for artificial networks in <xref ref-type="fig" rid="pcbi.1004762.g001">Fig 1E</xref>. Therefore, we estimate from the mean BOLD autocovariance over all nodes (red curve of <xref ref-type="fig" rid="pcbi.1004762.g007">Fig 7B</xref>) the time constant <italic>τ</italic><sub><italic>x</italic></sub> = 5.3 s, which we use to calibrate the model. We use a single <italic>τ</italic><sub><italic>x</italic></sub> for all nodes, because the distribution of individual time constants over all nodes is narrow, as shown in <xref ref-type="fig" rid="pcbi.1004762.g007">Fig 7C</xref>.</p>
<fig id="pcbi.1004762.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004762.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Fitting fMRI data to infer cortico-cortical connectivity.</title>
<p><bold>A</bold> Empirical FC, namely <inline-formula id="pcbi.1004762.e109"><alternatives><graphic id="pcbi.1004762.e109g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e109" xlink:type="simple"/><mml:math display="inline" id="M109"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>0</mml:mn></mml:msup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1004762.e110"><alternatives><graphic id="pcbi.1004762.e110g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e110" xlink:type="simple"/><mml:math display="inline" id="M110"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>τ</mml:mi></mml:msup></mml:math></alternatives></inline-formula>, averaged over 25 subjects for BOLD signal recorded during rest. <bold>B</bold> Autocovariances (grey curves, with a log y-axis) as a function of the time shift <italic>τ</italic>. From the mean curve (red) the time constant for the ND model is estimated: <italic>τ</italic><sub><italic>x</italic></sub> = 5.3 s. The inset represents the autocovariances with a standard y-axis. <bold>C</bold> Variability of similar decay time constants to <italic>τ</italic><sub><italic>x</italic></sub> in B for individual cortical area. <bold>D</bold> SC mask of weights to tune (black pixels), corresponding to the strongest connections of the dwMRI matrix in <xref ref-type="fig" rid="pcbi.1004762.g006">Fig 6B</xref> thresholded to obtain 32% density. <bold>E</bold> Evolution of the <italic>Q</italic> error during the optimization. The black line indicates the rate of change of <italic>C</italic>. <bold>F</bold> EC corresponding to the estimated <italic>C</italic> matrix. <bold>G</bold> Match between empirical and reconstructed <italic>Q</italic> matrices for the optimization with <italic>τ</italic><sub><italic>est</italic></sub> = 4 s while the connections for the mask in D. For both <italic>Q</italic><sup>0</sup> and <italic>Q</italic><sup><italic>τ</italic></sup>, the blue dots correspond to tuned connections, the black crosses to non-diagonal untuned connections and the cyan dots to diagonal connections. The Pearson correlation coefficient between matrix elements are given above each plot. <bold>H</bold> Weak correlation between the symmetric part of the estimated <italic>C</italic> and <inline-formula id="pcbi.1004762.e111"><alternatives><graphic id="pcbi.1004762.e111g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e111" xlink:type="simple"/><mml:math display="inline" id="M111"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>0</mml:mn></mml:msup></mml:math></alternatives></inline-formula>, indicating a strong network effect.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004762.g007" xlink:type="simple"/>
</fig>
<p>The direct method in <xref ref-type="disp-formula" rid="pcbi.1004762.e039">Eq (8)</xref> does not work here: the reason is that the matrix logarithm gives complex values with large imaginary parts. This motivated the development of the LO procedure. Moreover, our approach allows for the use of constraints on the weights in <italic>C</italic>: only a subset of all possible cortico-cortical connections can be tuned. The mask in <xref ref-type="fig" rid="pcbi.1004762.g007">Fig 7D</xref> represents the anatomical cortical connectome obtained from thresholding the dwMRI data averaged over all subjects: connections with large SC values are optimized, other weights are kept equal to zero. The density of existing connections is 32% in <xref ref-type="fig" rid="pcbi.1004762.g007">Fig 7D</xref>.</p>
<p>The blue curve in <xref ref-type="fig" rid="pcbi.1004762.g007">Fig 7E</xref> represents the evolution of the <italic>Q</italic> error during LO with <italic>τ</italic><sub><italic>est</italic></sub> = 4 s: it first decreases and then “explodes”. This instability corresponds to a transition to excessively high activity due to too strong feedback. The black curve show the normalized rate of change for <italic>C</italic>, whose minimum is close to that of the <italic>Q</italic> error. For the experimental data, the minimum of the black curve comes before the minimum of the <italic>Q</italic> error, but the rate of change of <italic>C</italic> remains close to its minimum until the explosion. In the following, we choose the estimated EC in <xref ref-type="fig" rid="pcbi.1004762.g007">Fig 7F</xref> and reconstructed FC as the <italic>Q</italic> and <italic>C</italic> for the minimum of the <italic>Q</italic> error. The match between the model and empirical <italic>Q</italic> matrices is illustrated in <xref ref-type="fig" rid="pcbi.1004762.g007">Fig 7G</xref>. Importantly, the match is similar for the <italic>Q</italic> corresponding to tuned connections (blue dots) and absent connections (black crosses). The fit of variances corresponding to the diagonal elements of <italic>Q</italic> (cyan dots) is very good.</p>
<p>
<xref ref-type="fig" rid="pcbi.1004762.g007">Fig 7H</xref> indicates the poor match between the empirical FC and the symmetric part of estimated <italic>C</italic>: large values in <inline-formula id="pcbi.1004762.e112"><alternatives><graphic id="pcbi.1004762.e112g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e112" xlink:type="simple"/><mml:math display="inline" id="M112"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>0</mml:mn></mml:msup></mml:math></alternatives></inline-formula> arise from strong network effect even though the EC weight is low.</p>
<sec id="sec022">
<title>Robustness of LO applied to experimental data</title>
<p>Before analyzing the properties of the estimated EC, we check the consistency of the <italic>C</italic> and Σ estimated by LO. As shown in <xref ref-type="fig" rid="pcbi.1004762.g008">Fig 8A</xref>, the best <italic>C</italic> matrices for <italic>τ</italic><sub><italic>est</italic></sub> ≥ 2 s describe a similar network topology, i.e., approximately the same ranking between weights (the black line indicates a perfect match). In contrast, the best <italic>C</italic> obtained from <italic>Q</italic><sup>0</sup> only does not match the best <italic>C</italic> for <italic>Q</italic><sup>0</sup> and <italic>Q</italic><sup>4</sup>, as illustrated in <xref ref-type="fig" rid="pcbi.1004762.g008">Fig 8B</xref>. The estimated intrinsic noise Σ in <xref ref-type="fig" rid="pcbi.1004762.g008">Fig 8C</xref> is similar for all <italic>τ</italic><sub><italic>est</italic></sub> ≥ 0.</p>
<fig id="pcbi.1004762.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004762.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Robustness of estimated <italic>C</italic> and Σ from FC with different time shifts <italic>τ</italic><sub><italic>est</italic></sub>.</title>
<p><bold>A</bold> Match between <italic>C</italic> for <italic>τ</italic><sub><italic>est</italic></sub> = 4 s (x-axis) and <italic>C</italic> for <italic>τ</italic><sub><italic>est</italic></sub> = 2, 6 and 8 s (y-axis). Each plotted point corresponds to an EC connection and the black line indicates a perfect match. <bold>B</bold> Same as B for the EC estimated for <italic>τ</italic><sub><italic>est</italic></sub> = 0 on the y-axis. <bold>C</bold> Similar plot to A for the diagonal elements of the estimated noise matrix Σ. <bold>D</bold> Similar plot to <italic>B</italic> for the EC estimated using the direct method. <bold>E</bold> Agreement as measured by the Pearson correlation coefficient between the pairs of EC and Σ plotted in B and D for the LO (red), heuristic (purple) and direct (cyan) methods. The green error bar on the left represents the same between EC with <italic>τ</italic><sub><italic>est</italic></sub> = 0 and the four <italic>τ</italic><sub><italic>est</italic></sub> &gt; 0. <bold>F</bold> Comparison of the models tuned with LO using different time shifts. For each model <italic>C</italic> obtained with <italic>τ</italic><sub><italic>est</italic></sub> from 0 to 6 s, the curve represents the <italic>Q</italic><sup><italic>τ</italic></sup> error for all <italic>τ</italic><sub><italic>mod</italic></sub> on the x-axis.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004762.g008" xlink:type="simple"/>
</fig>
<p>The direct method gives inconsistent <italic>C</italic> for the different <italic>τ</italic><sub><italic>est</italic></sub> &gt; 0, as illustrated in <xref ref-type="fig" rid="pcbi.1004762.g008">Fig 8D</xref> to be compared with LO in A. <xref ref-type="fig" rid="pcbi.1004762.g008">Fig 8E</xref> measures the similarity between these matrices using the Pearson correlation coefficients between the weights corresponding to the mask in <xref ref-type="fig" rid="pcbi.1004762.g007">Fig 7D</xref>. LO (red) provides very consistent <italic>C</italic> for the different <italic>τ</italic><sub><italic>est</italic></sub>, the heuristic method performs worse (purple) and the direct method (cyan) very poorly. The Σ consistency, however, is good for all methods. These findings are in line with the conclusions were found for artificial networks in <xref ref-type="fig" rid="pcbi.1004762.g005">Fig 5</xref>.</p>
<p>Each curve in <xref ref-type="fig" rid="pcbi.1004762.g008">Fig 8F</xref> represents a model whose <italic>C</italic> has been estimated using LO with <inline-formula id="pcbi.1004762.e113"><alternatives><graphic id="pcbi.1004762.e113g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e113" xlink:type="simple"/><mml:math display="inline" id="M113"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>0</mml:mn></mml:msup></mml:math></alternatives></inline-formula> only (green curve); <inline-formula id="pcbi.1004762.e114"><alternatives><graphic id="pcbi.1004762.e114g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e114" xlink:type="simple"/><mml:math display="inline" id="M114"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>0</mml:mn></mml:msup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1004762.e115"><alternatives><graphic id="pcbi.1004762.e115g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e115" xlink:type="simple"/><mml:math display="inline" id="M115"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>τ</mml:mi></mml:msup></mml:math></alternatives></inline-formula> with <italic>τ</italic><sub><italic>est</italic></sub> = 2, 4 and 6 ms (blue to cyan). For each model, the <italic>Q</italic><sup><italic>τ</italic></sup> error between the model and empirical matrices is displayed for <italic>τ</italic> = <italic>τ</italic><sub><italic>mod</italic></sub> on the x-axis. The errors for the two darker blue curves are smaller than the green one for <italic>τ</italic><sub><italic>mod</italic></sub> ≥ 2 s, although the fit for <italic>τ</italic><sub><italic>mod</italic></sub> = 0 is slighly worse. Our optimization procedure thus improves the <italic>whole</italic> spatio-temporal <italic>Q</italic> fit, from <inline-formula id="pcbi.1004762.e116"><alternatives><graphic id="pcbi.1004762.e116g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e116" xlink:type="simple"/><mml:math display="inline" id="M116"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>0</mml:mn></mml:msup></mml:math></alternatives></inline-formula> to <inline-formula id="pcbi.1004762.e117"><alternatives><graphic id="pcbi.1004762.e117g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e117" xlink:type="simple"/><mml:math display="inline" id="M117"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>6</mml:mn></mml:msup></mml:math></alternatives></inline-formula>, as compared to LO based on <inline-formula id="pcbi.1004762.e118"><alternatives><graphic id="pcbi.1004762.e118g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e118" xlink:type="simple"/><mml:math display="inline" id="M118"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>0</mml:mn></mml:msup></mml:math></alternatives></inline-formula> only. Directed connectivity is synonymous with capturing the information in the time-shifted <inline-formula id="pcbi.1004762.e119"><alternatives><graphic id="pcbi.1004762.e119g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e119" xlink:type="simple"/><mml:math display="inline" id="M119"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>τ</mml:mi></mml:msup></mml:math></alternatives></inline-formula> with <italic>τ</italic> &gt; 0. In the following, we take as reference for EC the <italic>C</italic> corresponding to <italic>τ</italic><sub><italic>est</italic></sub> = 4 s and 32% density in <xref ref-type="fig" rid="pcbi.1004762.g007">Fig 7F</xref> (and darkest blue curve in <xref ref-type="fig" rid="pcbi.1004762.g008">Fig 8F</xref>).</p>
<p>To further check the consistency of the estimated <italic>C</italic>, we repeat the optimization procedures with various SC masks, similar to that in <xref ref-type="fig" rid="pcbi.1004762.g007">Fig 7D</xref>. By moving the threshold on the dwMRI values, we obtain various densities for the mask ranging from 25% to almost 100% in <xref ref-type="fig" rid="pcbi.1004762.g009">Fig 9A</xref>. Although the <italic>Q</italic> error decreases for denser <italic>C</italic>, the estimated <italic>C</italic> becomes more similar to <inline-formula id="pcbi.1004762.e120"><alternatives><graphic id="pcbi.1004762.e120g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e120" xlink:type="simple"/><mml:math display="inline" id="M120"><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, and the mapping between <italic>C</italic> and <italic>Q</italic> more linear. Importantly, the estimated topology of <italic>C</italic> estimated by LO for the 4 densities is consistent, as measured by the Pearson correlation in red in <xref ref-type="fig" rid="pcbi.1004762.g009">Fig 9B</xref>. In comparison, the heuristic method is less consistent (purple). Likewise, <xref ref-type="fig" rid="pcbi.1004762.g009">Fig 9C</xref> shows that the asymmetry of the <italic>C</italic> matrices is consistent across SC masks and <italic>τ</italic><sub><italic>est</italic></sub> for LO (red), but less for the heuristic method (purple).</p>
<fig id="pcbi.1004762.g009" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004762.g009</object-id>
<label>Fig 9</label>
<caption>
<title>Robustness of estimated EC with respect to the EC density and individual FC.</title>
<p><bold>A</bold> Fit performance as a function of the density of EC. The blue curve indicates the <italic>Q</italic> error for optimizations with several masks for <italic>C</italic> (x-axis); the error bar correspond to the 4 <italic>τ</italic><sub><italic>est</italic></sub> &gt; 0. The red curve indicates the similarity between the estimated <italic>C</italic> and the empirical <inline-formula id="pcbi.1004762.e121"><alternatives><graphic id="pcbi.1004762.e121g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e121" xlink:type="simple"/><mml:math display="inline" id="M121"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>0</mml:mn></mml:msup></mml:math></alternatives></inline-formula>. <bold>B</bold> Similarity of estimated <italic>C</italic> measured by the Pearson correlation for the different masks in A and <italic>τ</italic><sub><italic>est</italic></sub> = 4 s. <bold>C</bold> Input-output asymmetry of the estimated <italic>C</italic> obtained for various optimization masks (error bars) and <italic>τ</italic><sub><italic>est</italic></sub> (x-axis). The red curve corresponds to LO and the purple curve to the heuristic method. The blue curve indicates the asymmetry of the empirical FC<italic>τ</italic>. <bold>D</bold> <italic>Q</italic> Error for LO based on individual FCs with <italic>τ</italic><sub><italic>est</italic></sub> = 2 and 4 s with 32% density. The horizontal dashed line corresponds to the <italic>Q</italic> error in <xref ref-type="fig" rid="pcbi.1004762.g007">Fig 7</xref>. <bold>E</bold> Similarity between the individual ECs and the EC obtained from the mean FC in <xref ref-type="fig" rid="pcbi.1004762.g007">Fig 7F</xref>. Similarity is measured by the Pearson correlation between the non-zero EC weights for the 32% density mask. <bold>F</bold> EC asymmetry of the individual ECs. The horizontal dashed line indicated the asymmetry of the EC in <xref ref-type="fig" rid="pcbi.1004762.g007">Fig 7F</xref>. <bold>G</bold> Agreement between the mean EC over individual FCs and the EC estimated from the mean FC.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004762.g009" xlink:type="simple"/>
</fig>
<p>Finally, we perform LO for each of the 25 individual empirical FC. The <italic>Q</italic> errors are plotted in <xref ref-type="fig" rid="pcbi.1004762.g009">Fig 9D</xref> for <italic>τ</italic><sub><italic>est</italic></sub> = 2 and 4 s. The errors are similar for the two cases and are larger than the <italic>Q</italic> error for the average FC (dashed horizontal line). <xref ref-type="fig" rid="pcbi.1004762.g009">Fig 9E</xref> shows the good agreement between the individual ECs and the EC obtained from the mean FC in <xref ref-type="fig" rid="pcbi.1004762.g007">Fig 7F</xref>, with Pearson correlation coefficients around 0.7 for both <italic>τ</italic><sub><italic>est</italic></sub> = 2 and 4 s. As shown in <xref ref-type="fig" rid="pcbi.1004762.g009">Fig 9F</xref>, the asymmetry of the individual ECs is homogeneous around 0.4, which is slightly higher than the asymmetry of the EC from the mean FC that is equal to 0.35 (and indicated by the horizontal dashed line). Last, <xref ref-type="fig" rid="pcbi.1004762.g009">Fig 9G</xref> shows the excellent agreement between the mean of individual ECs and the EC from the mean FC. This confirms the consistency of the results obtained from our LO procedure.</p>
</sec>
</sec>
<sec id="sec023">
<title>Interpretation of estimated cortical EC</title>
<p>
<xref ref-type="fig" rid="pcbi.1004762.g010">Fig 10A</xref> shows the very weak match between the <italic>C</italic> and the SC corresponding to the dwMRI data averaged over all subjects, with a Pearson correlation coefficient equal to 0.06. The estimated EC is thus structurally very different from a scaled version of SC. As dwMRI reflects the density of cortico-cortical white-matter fibers, this suggests that the efficacies of these connections are determined by other factors than their size, such as types of neurotransmitters, concentration of synaptic receptors and excitability of cortical areas.</p>
<fig id="pcbi.1004762.g010" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004762.g010</object-id>
<label>Fig 10</label>
<caption>
<title>Interpretation of estimated cortical interactions and intrinsic noise.</title>
<p><bold>A</bold> Weak match between EC and SC values. Each red cross corresponds to a connection. <bold>B</bold> Plot of the sum of incoming <italic>C</italic> weights versus the sum of outgoing <italic>C</italic> weights (x-axis and y-axis, resp.) for each cortical area (red cross). <bold>C</bold> 3D mapped representations on the cortex of the variances of the empirical BOLD signal, sums of incoming weights in EC, and intrinsic noise (related to spontaneous noisy activity). Red corresponds to larger values and blue to small values.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004762.g010" xlink:type="simple"/>
</fig>
<p>The estimated EC matrix in <xref ref-type="fig" rid="pcbi.1004762.g007">Fig 7F</xref> is not symmetric, meaning that cortical interactions are not reciprocal. This information is important as dwMRI data estimate the density of axonal fibers in the white matter, but do not recover the direction of those fibers. SC is by construction quasi symmetric, as is the case in <xref ref-type="fig" rid="pcbi.1004762.g007">Fig 7D</xref>. The matrix asymmetry for <italic>C</italic> relates to the reciprocity of intracortical connections and can be seen in the difference between incoming and outgoing strengths in <xref ref-type="fig" rid="pcbi.1004762.g010">Fig 10B</xref>. No area has both large incoming and outgoing weights, meaning that hubs act either as receptors or feeders.</p>
<p>In <xref ref-type="fig" rid="pcbi.1004762.g010">Fig 10C</xref>, the results are mapped onto the cortical surface. Cortical feeders with the largest outgoing weights are the left and right fusiform, middle temporal and superior temporal gyri, as well as the pre- and postcentral gyri in the left hemisphere. Cortical receivers with the largest incoming weights are the left and right precuneus, lateral occipital and superior parietal gyri, as well as the left isthmus of the cingulate gyrus. We also find that the following areas exhibit the largest values for Σ, synonymous with strong intrinsic variability: both left and right lingual gyri, pericalcarine cortices and frontal poles, as well as right cuneus and transverse temporal gyrus, and left pars orbitalis. This suggests the propagation of spontaneous activity, mainly from visual cortices and the prefrontal area.</p>
</sec>
</sec>
<sec id="sec024" sec-type="conclusions">
<title>Discussion</title>
<p>We have shown in a noise-diffusion network model how the directed connectivity <italic>C</italic> can be retrieved from empirical covariances <inline-formula id="pcbi.1004762.e122"><alternatives><graphic id="pcbi.1004762.e122g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e122" xlink:type="simple"/><mml:math display="inline" id="M122"><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>. The key is to take into account the <italic>temporal</italic> information in covariances <inline-formula id="pcbi.1004762.e123"><alternatives><graphic id="pcbi.1004762.e123g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e123" xlink:type="simple"/><mml:math display="inline" id="M123"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>τ</mml:mi></mml:msup></mml:math></alternatives></inline-formula> for non-zero time shifts <italic>τ</italic> &gt; 0. Our proposed method gives a better fit of all <inline-formula id="pcbi.1004762.e124"><alternatives><graphic id="pcbi.1004762.e124g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e124" xlink:type="simple"/><mml:math display="inline" id="M124"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>τ</mml:mi></mml:msup></mml:math></alternatives></inline-formula> for <italic>τ</italic> ≥ 0, not only <inline-formula id="pcbi.1004762.e125"><alternatives><graphic id="pcbi.1004762.e125g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e125" xlink:type="simple"/><mml:math display="inline" id="M125"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>0</mml:mn></mml:msup></mml:math></alternatives></inline-formula> that is often considered alone as an objective or goal in fitting procedures. Our theoretical study demonstrates two crucial requirements in order to recover the original <italic>C</italic> in the considered noise-diffusion networks: the time shift <italic>τ</italic><sub><italic>est</italic></sub> corresponding to <inline-formula id="pcbi.1004762.e126"><alternatives><graphic id="pcbi.1004762.e126g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e126" xlink:type="simple"/><mml:math display="inline" id="M126"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>τ</mml:mi></mml:msup></mml:math></alternatives></inline-formula> must be matched with the time constant of the dynamical system <italic>τ</italic><sub><italic>x</italic></sub> estimated from the data (<xref ref-type="fig" rid="pcbi.1004762.g003">Fig 3</xref>); it is also necessary to adjust the diagonal matrix Σ that relates to spontaneous fluctuations experienced by each network node (<xref ref-type="fig" rid="pcbi.1004762.g004">Fig 4</xref>).</p>
<p>Our method provides an estimation of the asymmetry of intracortical connections (EC) from fMRI data combined with anatomical information from dwMRI. This is to our knowledge the first of its kind for the human connectome at the scale of the whole cortex. In addition to intracortical EC, our method also estimates via Σ the intrinsic variability of each cortical area, which is then shaped by EC to generate FC. This estimation relies on information in the BOLD spatio-temporal covariances, which convey information about the underlying neural connectivity (<xref ref-type="fig" rid="pcbi.1004762.g006">Fig 6</xref>). Our results suggest that the EC cortical hubs are either receivers or feeders, but not both (<xref ref-type="fig" rid="pcbi.1004762.g010">Fig 10</xref>).</p>
<sec id="sec025">
<title>Inference of directed connectivity from observed network activity</title>
<p>It is known that zero-time-shift covariances are not sufficient to retrieve directed connectivity, but only its symmetric part [<xref ref-type="bibr" rid="pcbi.1004762.ref016">16</xref>, <xref ref-type="bibr" rid="pcbi.1004762.ref025">25</xref>, <xref ref-type="bibr" rid="pcbi.1004762.ref028">28</xref>]. Information-based methods able to estimate directionality such as likelihood maximization [<xref ref-type="bibr" rid="pcbi.1004762.ref013">13</xref>], Granger causality [<xref ref-type="bibr" rid="pcbi.1004762.ref014">14</xref>, <xref ref-type="bibr" rid="pcbi.1004762.ref023">23</xref>] and transfer entropy [<xref ref-type="bibr" rid="pcbi.1004762.ref024">24</xref>] also use temporal information of the observed activity. In minimizing the matrix distance between the model <italic>Q</italic><sup>0/<italic>τ</italic></sup> and objective <inline-formula id="pcbi.1004762.e127"><alternatives><graphic id="pcbi.1004762.e127g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e127" xlink:type="simple"/><mml:math display="inline" id="M127"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>/</mml:mo> <mml:mi>τ</mml:mi></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>, instead of considering connections independently, the LO procedure captures network effects due to the recurrent feedback. Here we do not perform a stochastic gradient descent using many samples of the observed activity, but a deterministic optimization based on the <inline-formula id="pcbi.1004762.e128"><alternatives><graphic id="pcbi.1004762.e128g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e128" xlink:type="simple"/><mml:math display="inline" id="M128"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>/</mml:mo> <mml:mi>τ</mml:mi></mml:mrow></mml:msup></mml:math></alternatives></inline-formula> averaged over the whole observation period (or several simulation sessions). It follows that the optimization is quick: a few minutes for 10<sup>4</sup> optimization steps with a network of 50 nodes and a given <italic>τ</italic><sub><italic>est</italic></sub> on a recent desktop computer.</p>
<p>To obtain the best performance, we have shown that the time shift <italic>τ</italic><sub><italic>est</italic></sub> corresponding to <inline-formula id="pcbi.1004762.e129"><alternatives><graphic id="pcbi.1004762.e129g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e129" xlink:type="simple"/><mml:math display="inline" id="M129"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>τ</mml:mi></mml:msup></mml:math></alternatives></inline-formula> used in LO and the time constant of the dynamical system <italic>τ</italic><sub><italic>x</italic></sub> should be matched. As shown in <xref ref-type="fig" rid="pcbi.1004762.g003">Fig 3E</xref>, poor estimation for large <italic>τ</italic><sub><italic>est</italic></sub> arises from the inaccuracy in empirical <inline-formula id="pcbi.1004762.e130"><alternatives><graphic id="pcbi.1004762.e130g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e130" xlink:type="simple"/><mml:math display="inline" id="M130"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>τ</mml:mi></mml:msup></mml:math></alternatives></inline-formula>; for small <italic>τ</italic><sub><italic>est</italic></sub>, LO itself is unstable (see dashed curve in <xref ref-type="fig" rid="pcbi.1004762.g003">Fig 3F</xref>). <xref ref-type="fig" rid="pcbi.1004762.g005">Fig 5C</xref> shows that the method performance is not strongly affected by the network topology or the connectivity asymmetry, but worsens with the network size and becomes better with more observations used to calculate the empirical objective <inline-formula id="pcbi.1004762.e131"><alternatives><graphic id="pcbi.1004762.e131g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e131" xlink:type="simple"/><mml:math display="inline" id="M131"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>/</mml:mo> <mml:mi>τ</mml:mi></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>. This is in line with previous results [<xref ref-type="bibr" rid="pcbi.1004762.ref025">25</xref>]. In addition to <italic>C</italic>, the intrinsic noise Σ received by the network nodes must be tuned to obtain a correct <italic>C</italic> estimation (<xref ref-type="fig" rid="pcbi.1004762.g004">Fig 4</xref>). Here we use a heuristic optimization for a diagonal Σ in <xref ref-type="disp-formula" rid="pcbi.1004762.e069">Eq (20)</xref>; the present framework should be extended to take into account correlated noise instead of white noise.</p>
<p>The direct method in <xref ref-type="disp-formula" rid="pcbi.1004762.e039">Eq (8)</xref> to estimate <italic>C</italic> has been used previously with statistical tests to estimate the existence of connections from observed activity [<xref ref-type="bibr" rid="pcbi.1004762.ref016">16</xref>, <xref ref-type="bibr" rid="pcbi.1004762.ref026">26</xref>]. As shown in <xref ref-type="fig" rid="pcbi.1004762.g005">Fig 5D</xref>, it does not work well for the level of noise in empirical observations <inline-formula id="pcbi.1004762.e132"><alternatives><graphic id="pcbi.1004762.e132g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e132" xlink:type="simple"/><mml:math display="inline" id="M132"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>/</mml:mo> <mml:mi>τ</mml:mi></mml:mrow></mml:msup></mml:math></alternatives></inline-formula> considered here. This motivated the development of our LO procedure in Methods. Here we focus on the estimation of connection weights, i.e., their ranking; the detection of connections using statistical methods can be based on the estimated <italic>C</italic> from LO, but this is left for further work. Nevertheless, detection should be based on an as-good-as-possible estimated ranking of connections weights, which can be measured by the Pearson correlation. Our method for Ornstein-Uhlenbeck processes also bears similarities with MVAR [<xref ref-type="bibr" rid="pcbi.1004762.ref003">3</xref>], but we enforce additional constraints on the connectivity.</p>
<p>Recent studies [<xref ref-type="bibr" rid="pcbi.1004762.ref012">12</xref>, <xref ref-type="bibr" rid="pcbi.1004762.ref028">28</xref>] have also used greedy algorithms to optimize symmetric <italic>C</italic> relying on <inline-formula id="pcbi.1004762.e133"><alternatives><graphic id="pcbi.1004762.e133g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e133" xlink:type="simple"/><mml:math display="inline" id="M133"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>0</mml:mn></mml:msup></mml:math></alternatives></inline-formula> using more elaborate network models. Those procedures update <italic>C</italic> step-by-step according to various measures such as the Pearson correlation between all matrix elements of zero-time-shift correlations. Here we have transposed this heuristic method to reproduce <inline-formula id="pcbi.1004762.e134"><alternatives><graphic id="pcbi.1004762.e134g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e134" xlink:type="simple"/><mml:math display="inline" id="M134"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>τ</mml:mi></mml:msup></mml:math></alternatives></inline-formula> in addition to <inline-formula id="pcbi.1004762.e135"><alternatives><graphic id="pcbi.1004762.e135g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e135" xlink:type="simple"/><mml:math display="inline" id="M135"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>0</mml:mn></mml:msup></mml:math></alternatives></inline-formula>, see <xref ref-type="disp-formula" rid="pcbi.1004762.e070">Eq (21)</xref>. Although the resulting <italic>Q</italic><sup>0/<italic>τ</italic></sup> fit is close to perfect, the <italic>C</italic> estimation remains poor in <xref ref-type="fig" rid="pcbi.1004762.g005">Fig 5D</xref>. Taking the network effect correctly into account via LO is important to recover the original <italic>C</italic>, as compared to tuning connections individually based on the corresponding <italic>Q</italic><sup>0/<italic>τ</italic></sup> value.</p>
<p>More generally, the problem with inferring <italic>C</italic> lies in the definition of observables or objective functions to constrain models without ambiguity: to a set of network parameters should correspond only a single value of the observable (here a pair <inline-formula id="pcbi.1004762.e136"><alternatives><graphic id="pcbi.1004762.e136g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e136" xlink:type="simple"/><mml:math display="inline" id="M136"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>0</mml:mn></mml:msup></mml:math></alternatives></inline-formula> + <inline-formula id="pcbi.1004762.e137"><alternatives><graphic id="pcbi.1004762.e137g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e137" xlink:type="simple"/><mml:math display="inline" id="M137"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>τ</mml:mi></mml:msup></mml:math></alternatives></inline-formula>). In [<xref ref-type="bibr" rid="pcbi.1004762.ref025">25</xref>], the minimization of matrix L1 norm for sparse networks was used to reduce the indetermination in using <inline-formula id="pcbi.1004762.e138"><alternatives><graphic id="pcbi.1004762.e138g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004762.e138" xlink:type="simple"/><mml:math display="inline" id="M138"><mml:msup><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>0</mml:mn></mml:msup></mml:math></alternatives></inline-formula> only. Beyond our results based on noise-diffusion processes, we expect that directed <italic>C</italic> can be recovered for other network models such as Hawkes processes (a.k.a. Poisson neurons) or binary neurons using second-order moments with non-zero time shift (here covariances). This is supported by recent results that demonstrate how the covariance structures are formally related across these neural models [<xref ref-type="bibr" rid="pcbi.1004762.ref038">38</xref>].</p>
<p>The present framework appears well suited to model activity as continuous signals; for spike trains generated by networks of GLM or Poisson neurons with simple temporal filters, it remains to be seen whether our fast tuning procedure can be adapted. We have only considered resting-state activity, but the procedure may also be extended to the case of multiple stimulation-response pairings. In particular, the external input <italic>e</italic> may be adjusted [<xref ref-type="bibr" rid="pcbi.1004762.ref016">16</xref>], in addition to <italic>C</italic> and Σ.</p>
</sec>
<sec id="sec026">
<title>Whole-cortex dynamic model fitted to fMRI data and cortical interactions</title>
<p>The goal of our model-based approach is to reproduce the resting-state FC obtained from fMRI. Although the ND model is not new, we propose a novel ‘LO’ procedure to tune the model parameters with suitable observables, namely time-shifted covariance matrices as FC. The estimated connectivity of the ND model relates to the intracortical EC, whose properties can then be analyzed [<xref ref-type="bibr" rid="pcbi.1004762.ref001">1</xref>]. For instance, EC can be searched for hubs, communities and similar features [<xref ref-type="bibr" rid="pcbi.1004762.ref030">30</xref>]. Here we have focused on hubs (<xref ref-type="fig" rid="pcbi.1004762.g010">Fig 10</xref>) and our results suggest that activity propagates from the visual, auditory and prefrontal areas. We find among the listening hubs the precuneus and superior parietal gyrus that belong to the default-mode network. These networks are usually found in resting-state FC and our results shed a new light on the architecture that shapes the activity propagation between them.</p>
<p>The ND model was previously used together with hemodynamics in order to reproduce similar fMRI data [<xref ref-type="bibr" rid="pcbi.1004762.ref012">12</xref>, <xref ref-type="bibr" rid="pcbi.1004762.ref027">27</xref>]. As was demonstrated for that study for zero time shifts, the BOLD covariances with time shifts of the order of seconds also convey information about the interactions that determine the neural dynamics (<xref ref-type="fig" rid="pcbi.1004762.g006">Fig 6</xref>). This is in line with recent results showing that the BOLD time series convey information about cognitive processing for similar time lags [<xref ref-type="bibr" rid="pcbi.1004762.ref039">39</xref>, <xref ref-type="bibr" rid="pcbi.1004762.ref040">40</xref>]. In our model, the EC asymmetry generates lags in covariances. Moreover, the LO procedure can estimate the EC ranking this neural connectivity from the BOLD covariances provided the ranking is preserved between the neural and the BOLD covariances for those more elaborate models involving a HRF (<xref ref-type="fig" rid="pcbi.1004762.g006">Fig 6</xref>). This supports the application of the ND model without HRF to model directly the BOLD data. In particular, the ND model seems well adapted to fMRI data at the considered parcellation of about 100 nodes: the BOLD autocovariances are close to exponential decays (i.e., straight lines for the log y-axis), as shown by the comparison between the ND model in <xref ref-type="fig" rid="pcbi.1004762.g001">Fig 1E</xref> and our experimental data for time shifts up to 8 s in <xref ref-type="fig" rid="pcbi.1004762.g007">Fig 7B</xref>. The corresponding time constants are rather homogeneous over all regions in <xref ref-type="fig" rid="pcbi.1004762.g007">Fig 7C</xref>, so we use a single <italic>τ</italic><sub><italic>x</italic></sub> = 5.3 s to calibrate the ND model, which corresponds to typical values for HRF [<xref ref-type="bibr" rid="pcbi.1004762.ref041">41</xref>]. In contrast, the autocovariances for the DMF+HRF in <xref ref-type="fig" rid="pcbi.1004762.g006">Fig 6C</xref> show a drop for <italic>τ</italic> ≥ 4 s that is not observed in the experimental data. We keep in mind that the precise relationship between the fluctuations of the BOLD signal and neural activity is still under debate [<xref ref-type="bibr" rid="pcbi.1004762.ref041">41</xref>–<xref ref-type="bibr" rid="pcbi.1004762.ref043">43</xref>]. Numerous studies such as those about repetition priming and suppression [<xref ref-type="bibr" rid="pcbi.1004762.ref044">44</xref>] have shown how changes in fMRI signals reflects those in neural activity, such as synchronization of the latter at a much shorter timescale. Moreover, fMRI is one of the few non-invasive methods to evaluate processing in the human brain (of course in vivo) and has many clinical applications [<xref ref-type="bibr" rid="pcbi.1004762.ref045">45</xref>], irrespective of its precise link to neural activity. This further supports efforts to develop generative models of BOLD and methods to better interpret these fMRI data.</p>
<p>An underlying assumption of our approach is that the individual variances of BOLD signals are meaningful [<xref ref-type="bibr" rid="pcbi.1004762.ref046">46</xref>]. This motivates the use of covariances to fit our model, rather than correlations that are often used [<xref ref-type="bibr" rid="pcbi.1004762.ref001">1</xref>]. The results in <xref ref-type="fig" rid="pcbi.1004762.g007">Fig 7</xref> give a FC Pearson correlation coefficient (sometimes called predictive power) larger than 0.6 for <italic>both</italic> <italic>Q</italic><sup>0</sup> and <italic>Q</italic><sup>4</sup>. In this sense, our study improves previous results [<xref ref-type="bibr" rid="pcbi.1004762.ref012">12</xref>, <xref ref-type="bibr" rid="pcbi.1004762.ref031">31</xref>]. Importantly, the EC and Σ estimated by LO is surprisingly stable with respect to the choice of time shift for the considered experimental data. We find consistent results for a broad range of <italic>τ</italic><sub><italic>est</italic></sub> from 2 to 8 s, with a Pearson correlation coefficient larger than 0.9 in <xref ref-type="fig" rid="pcbi.1004762.g008">Fig 8</xref>. Choosing denser connectivity for EC improves the FC fit, but does not significantly change the EC ranking as shown in <xref ref-type="fig" rid="pcbi.1004762.g009">Fig 9A and 9B</xref> for results from 25% to 45% density. As an additional check, we have also shown that EC estimated from individual FCs coincides with EC obtained from the mean FC over all 25 subjects. In comparison, the heuristic and direct methods in Figs <xref ref-type="fig" rid="pcbi.1004762.g008">8E</xref> and <xref ref-type="fig" rid="pcbi.1004762.g009">9B and 9C</xref> give far more inconsistent results. Moreover, the heuristic method only uses part of the FC matrices when EC is sparse: it tends to overfit the existing connections compared to absent connections. A recent study [<xref ref-type="bibr" rid="pcbi.1004762.ref015">15</xref>] compared methods to estimate directed cortical interactions in a generative model of BOLD activity including hemodynamics: among those, Patel’s <italic>τ</italic>[<xref ref-type="bibr" rid="pcbi.1004762.ref047">47</xref>] gave the best performance, but that study was limited to sparse connectivity. Here we consider the FC for the whole cortex, which gives coupled constraints for a reasonably large network. Incorporating more areas limits the number of unknown contributions to the node activities, strengthening the estimation accuracy. This was observed for partial correlations in a similar manner for undirected connections [<xref ref-type="bibr" rid="pcbi.1004762.ref015">15</xref>].</p>
<p>Several previous studies used a scaled version of the SC matrix as EC [<xref ref-type="bibr" rid="pcbi.1004762.ref012">12</xref>, <xref ref-type="bibr" rid="pcbi.1004762.ref028">28</xref>, <xref ref-type="bibr" rid="pcbi.1004762.ref031">31</xref>]. As shown in <xref ref-type="fig" rid="pcbi.1004762.g008">Fig 8F</xref>, a symmetric EC does not satisfactorily fit time-shifted FCs. Furthermore, <xref ref-type="fig" rid="pcbi.1004762.g010">Fig 10A</xref> shows the weak match between dwMRI and our estimated EC values. This suggests that the fiber densities as measured by dwMRI may not be a good predictor for the dynamic interactions between cortical areas, but only for the skeleton of the cortical connectome. In addition, those previous studies used interhemispherical connections to improve the FC fit of the models. Here these connections also appear to be fairly strong in the estimated EC in <xref ref-type="fig" rid="pcbi.1004762.g007">Fig 7F</xref>, as shown by the two secondary diagonals in the top-left and bottom-right quadrant of the matrix. In any case, large covariances are obtained even for unconnected areas because of the strong overall feedback in the network, in line with results supporting that the cortex is in a state close to criticality [<xref ref-type="bibr" rid="pcbi.1004762.ref027">27</xref>]. As the dynamics of each cortical region has no nonlinearity in our model, large EC values are the only origin for the strong network effect, which induces the non-trivial mapping between EC and FC in <xref ref-type="fig" rid="pcbi.1004762.g007">Fig 7H</xref>.</p>
<p>As shown in <xref ref-type="fig" rid="pcbi.1004762.g001">Fig 1F</xref> for artificial networks, the <italic>C</italic> asymmetry is reflected in <italic>Q</italic><sup><italic>τ</italic></sup> for <italic>τ</italic> &gt; 0. In our experimental data, the corresponding FC<italic>τ</italic> (blue line in <xref ref-type="fig" rid="pcbi.1004762.g009">Fig 9C</xref>) is not symmetric and relates to propagating activity [<xref ref-type="bibr" rid="pcbi.1004762.ref039">39</xref>]. In the ND network, the noise received by each area is embodied by Σ, which is then shaped by EC to generate FC. Here the LO procedure extracts the spatio-temporal FC information to estimate the EC asymmetry. The information about asymmetry in intracortical connections is thus important and complements the SC obtained from dwMRI, which is symmetric. Compared to previous studies that investigate the directionality of cortico-cortical connections [<xref ref-type="bibr" rid="pcbi.1004762.ref002">2</xref>, <xref ref-type="bibr" rid="pcbi.1004762.ref004">4</xref>, <xref ref-type="bibr" rid="pcbi.1004762.ref007">7</xref>], the novelty is that we estimate this property at the scale of the whole cortex. As all nodes have the same activation function, EC values indicate the relative interaction strengths between areas. What matters in our EC analysis is the ranking of EC weights: the difference between a low EC value and an absent connection is not so important here. Here we have estimated the asymmetry of cortico-cortical EC to be equal to 0.35 in <xref ref-type="fig" rid="pcbi.1004762.g008">Fig 8C</xref>. This is larger than macaque’s COCOMAC asymmetry that gives 0.14 for the same index [<xref ref-type="bibr" rid="pcbi.1004762.ref048">48</xref>, <xref ref-type="bibr" rid="pcbi.1004762.ref049">49</xref>], but note that nonlinearity in the model dynamics would affect the precise EC values; what is important here is that EC is significantly asymmetric. This translates to an imbalance between incoming and outgoing EC weights. <xref ref-type="fig" rid="pcbi.1004762.g010">Fig 10B</xref> suggests that hubs are either feeders or receivers, but do not have both strong incoming or outgoing connections. As a conclusion, our work sets a suitable ground to study both local and global properties of the whole cortical connectivity, which will give insight in the underlying neural processing.</p>
</sec>
</sec>
</body>
<back>
<ack>
<p>We thank Gerald Hahn, Étienne Hugues and Mohit Adhikari for useful comments that improved the manuscript.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1004762.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Deco</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Jirsa</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>McIntosh</surname> <given-names>A</given-names></name>. <article-title>Emerging concepts for the dynamical organization of resting-state activity in the brain</article-title>. <source>Nat Rev Neurosci</source>. <year>2011</year>;<volume>12</volume>:<fpage>43</fpage>–<lpage>56</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nrn2961" xlink:type="simple">10.1038/nrn2961</ext-link></comment> <object-id pub-id-type="pmid">21170073</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004762.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>McIntosh</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Grady</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Ungerleider</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Haxby</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Rapoport</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Horwitz</surname> <given-names>B</given-names></name>. <article-title>Network analysis of cortical visual pathways mapped with PET</article-title>. <source>J Neurosci</source>. <year>1994</year>;<volume>14</volume>:<fpage>655</fpage>–<lpage>666</lpage>. <object-id pub-id-type="pmid">8301356</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004762.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Harrison</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Penny</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Friston</surname> <given-names>K</given-names></name>. <article-title>Multivariate autoregressive modeling of fMRI time series</article-title>. <source>Neuroimage</source>. <year>2003</year>;<volume>19</volume>:<fpage>1477</fpage>–<lpage>1491</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S1053-8119(03)00160-5" xlink:type="simple">10.1016/S1053-8119(03)00160-5</ext-link></comment> <object-id pub-id-type="pmid">12948704</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004762.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>James</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Kelley</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Craddock</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Holtzheimer</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Dunlop</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Nemeroff</surname> <given-names>C</given-names></name>, <etal>et al</etal>. <article-title>Exploratory structural equation modeling of resting-state fMRI: applicability of group models to individual subjects</article-title>. <source>Neuroimage</source>. <year>2009</year>;<volume>45</volume>:<fpage>778</fpage>–<lpage>787</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuroimage.2008.12.049" xlink:type="simple">10.1016/j.neuroimage.2008.12.049</ext-link></comment> <object-id pub-id-type="pmid">19162206</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004762.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Friston</surname> <given-names>K</given-names></name>. <article-title>Functional and effective connectivity: A review</article-title>. <source>Brain Connect</source>. <year>2011</year>;<volume>1</volume>:<fpage>8</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1089/brain.2011.0008" xlink:type="simple">10.1089/brain.2011.0008</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004762.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Friston</surname> <given-names>K</given-names></name>. <article-title>Causal modelling and brain connectivity in functional magnetic resonance imaging</article-title>. <source>PLoS Biol</source>. <year>2009</year>;<volume>7</volume>:<fpage>e33</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pbio.1000033" xlink:type="simple">10.1371/journal.pbio.1000033</ext-link></comment> <object-id pub-id-type="pmid">19226186</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004762.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Roebroeck</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Formisano</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Goebel</surname> <given-names>R</given-names></name>. <article-title>The identification of interacting networks in the brain using fMRI: Model selection, causality and deconvolution</article-title>. <source>Neuroimage</source>. <year>2011</year>;<volume>58</volume>:<fpage>296</fpage>–<lpage>302</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuroimage.2009.09.036" xlink:type="simple">10.1016/j.neuroimage.2009.09.036</ext-link></comment> <object-id pub-id-type="pmid">19786106</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004762.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Valdes-Sosa</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Roebroeck</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Daunizeau</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Friston</surname> <given-names>K</given-names></name>. <article-title>Effective connectivity: Influence, causality and biophysical modeling</article-title>. <source>Neuroimage</source>. <year>2011</year>;<volume>58</volume>:<fpage>339</fpage>–<lpage>361</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuroimage.2011.03.058" xlink:type="simple">10.1016/j.neuroimage.2011.03.058</ext-link></comment> <object-id pub-id-type="pmid">21477655</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004762.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ostojic</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Brunel</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Hakim</surname> <given-names>V</given-names></name>. <article-title>How connectivity, background activity, and synaptic properties shape the cross-correlation between spike trains</article-title>. <source>J Neurosci</source>. <year>2009</year>;<volume>29</volume>:<fpage>10234</fpage>–<lpage>10253</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.1275-09.2009" xlink:type="simple">10.1523/JNEUROSCI.1275-09.2009</ext-link></comment> <object-id pub-id-type="pmid">19692598</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004762.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gerhard</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Pipa</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Lima</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Neuenschwander</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Gerstner</surname> <given-names>W</given-names></name>. <article-title>Extraction of network topology from multi-electrode recordings: is there a small-world effect?</article-title> <source>Front Comput Neurosci</source>. <year>2011</year>;<volume>5</volume>:<fpage>4</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004762.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Trousdale</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Hu</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Shea-Brown</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Jośic</surname> <given-names>K</given-names></name>. <article-title>Impact of network structure and cellular response on spike time correlations</article-title>. <source>PLoS Comput Biol</source>. <year>2012</year>;<volume>8</volume>:<fpage>e1002408</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1002408" xlink:type="simple">10.1371/journal.pcbi.1002408</ext-link></comment> <object-id pub-id-type="pmid">22457608</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004762.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Deco</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Ponce-Alvarez</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Hagmann</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Romani</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Mantini</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Corbetta</surname> <given-names>M</given-names></name>. <article-title>How local excitation-inhibition ratio impacts the whole brain dynamics</article-title>. <source>J Neurosci</source>. <year>2014</year>;<volume>34</volume>:<fpage>7886</fpage>–<lpage>7898</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.5068-13.2014" xlink:type="simple">10.1523/JNEUROSCI.5068-13.2014</ext-link></comment> <object-id pub-id-type="pmid">24899711</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004762.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pillow</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Ahmadian</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Paninski</surname> <given-names>L</given-names></name>. <article-title>Model-based decoding, information estimation, and change-point detection techniques for multi-neuron spike trains</article-title>. <source>Neural Comput</source>. <year>2011</year>;<volume>23</volume>:<fpage>1</fpage>–<lpage>45</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1162/NECO_a_00058" xlink:type="simple">10.1162/NECO_a_00058</ext-link></comment> <object-id pub-id-type="pmid">20964538</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004762.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kim</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Putrino</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Ghosh</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>E</given-names></name>. <article-title>A Granger causality measure for point process models of ensemble neural spiking activity</article-title>. <source>PLoS Comput Biol</source>. <year>2011</year>;<volume>7</volume>:<fpage>e1001110</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1001110" xlink:type="simple">10.1371/journal.pcbi.1001110</ext-link></comment> <object-id pub-id-type="pmid">21455283</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004762.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Smith</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Miller</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Salimi-Khorshidi</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Webster</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Beckmann</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Nichols</surname> <given-names>T</given-names></name>, <etal>et al</etal>. <article-title>Network modelling methods for fMRI</article-title>. <source>NeuroImage</source>. <year>2011</year>;<volume>54</volume>:<fpage>875</fpage>–<lpage>891</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuroimage.2010.08.063" xlink:type="simple">10.1016/j.neuroimage.2010.08.063</ext-link></comment> <object-id pub-id-type="pmid">20817103</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004762.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Timme</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Casadiego</surname> <given-names>J</given-names></name>. <article-title>Revealing networks from dynamics: An introduction</article-title>. <source>J Phys A Math Gen</source>. <year>2014</year>;<volume>47</volume>:<fpage>343001</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1088/1751-8113/47/34/343001" xlink:type="simple">10.1088/1751-8113/47/34/343001</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004762.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Schelter</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Winterhalder</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Dahlhaus</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Kurths</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Timmer</surname> <given-names>J</given-names></name>. <article-title>Partial phase synchronization for multivariate synchronizing systems</article-title>. <source>Phys Rev Lett</source>. <year>2006</year>;<volume>96</volume>:<fpage>208103</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevLett.96.208103" xlink:type="simple">10.1103/PhysRevLett.96.208103</ext-link></comment> <object-id pub-id-type="pmid">16803212</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004762.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ren</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>WX</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Lai</surname> <given-names>YC</given-names></name>. <article-title>noise bridges dynamical correlation and topology in coupled oscillator networks</article-title>. <source>Phys Rev Lett</source>. <year>2010</year>;<volume>104</volume>:<fpage>058701</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevLett.104.058701" xlink:type="simple">10.1103/PhysRevLett.104.058701</ext-link></comment> <object-id pub-id-type="pmid">20366800</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004762.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ching</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Lai</surname> <given-names>PY</given-names></name>, <name name-style="western"><surname>Leung</surname> <given-names>C</given-names></name>. <article-title>Extracting connectivity from dynamics of networks with uniform bidirectional coupling</article-title>. <source>Phys Rev E</source>. <year>2013</year>;<volume>88</volume>:<fpage>042817</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevE.88.042817" xlink:type="simple">10.1103/PhysRevE.88.042817</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004762.ref020">
<label>20</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Storkey</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Simonotto</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Whalley</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Lawrie</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Murray</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Mcgonigle</surname> <given-names>D</given-names></name>. <chapter-title>Learning Structural Equation Models for fMRI</chapter-title>. In: <name name-style="western"><surname>Schölkopf</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Platt</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Hoffman</surname> <given-names>T</given-names></name>, editors. <source>Advances in Neural Information Processing Systems 19</source>. <publisher-name>MIT Press</publisher-name>; <year>2007</year>. p. <fpage>1329</fpage>–<lpage>1336</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004762.ref021">
<label>21</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Kaplan</surname> <given-names>D</given-names></name>. <source>Structural equation modeling: foundations and extensions</source> (<edition>2nd revised edition</edition>). <publisher-name>Sage Publications (CA)</publisher-name>; <year>2008</year>.</mixed-citation>
</ref>
<ref id="pcbi.1004762.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zaytsev</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Morrison</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Deger</surname> <given-names>M</given-names></name>. <article-title>Reconstruction of recurrent synaptic connectivity of thousands of neurons from simulated spiking activity</article-title>. <source>J Comput Neurosci</source>. <year>2015</year>;<volume>39</volume>:<fpage>77</fpage>–<lpage>103</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s10827-015-0565-5" xlink:type="simple">10.1007/s10827-015-0565-5</ext-link></comment> <object-id pub-id-type="pmid">26041729</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004762.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gerhard</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Kispersky</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Gutierrez</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Marder</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Kramer</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Eden</surname> <given-names>U</given-names></name>. <article-title>Successful reconstruction of a physiological circuit with known connectivity from spiking activity alone</article-title>. <source>PLoS Comput Biol</source>. <year>2013</year>;<volume>9</volume>:<fpage>e1003138</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1003138" xlink:type="simple">10.1371/journal.pcbi.1003138</ext-link></comment> <object-id pub-id-type="pmid">23874181</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004762.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Stetter</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Battaglia</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Soriano</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Geisel</surname> <given-names>T</given-names></name>. <article-title>Model-free reconstruction of excitatory neuronal connectivity from calcium imaging signals</article-title>. <source>PLoS Comput Biol</source>. <year>2012</year>;<volume>8</volume>:<fpage>e1002653</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1002653" xlink:type="simple">10.1371/journal.pcbi.1002653</ext-link></comment> <object-id pub-id-type="pmid">22927808</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004762.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pernice</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Rotter</surname> <given-names>S</given-names></name>. <article-title>Reconstruction of sparse connectivity in neural networks from spike train covariances</article-title>. <source>J Stat Mech</source>. <year>2013</year>;<volume>2013</volume>:<fpage>P03008</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1088/1742-5468/2013/03/P03008" xlink:type="simple">10.1088/1742-5468/2013/03/P03008</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004762.ref026">
<label>26</label>
<mixed-citation publication-type="other" xlink:type="simple">Luensmann B. Reconstruction of physical interactions in stationary stochastic network dynamics [MSc Thesis]. University of Göttingen; 2015. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.nld.ds.mpg.de/publications/mastersthesisreference.2015-06-10.5857567117/at_download/publication_pdf" xlink:type="simple">http://www.nld.ds.mpg.de/publications/mastersthesisreference.2015-06-10.5857567117/at_download/publication_pdf</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1004762.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Deco</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Ponce-Alvarez</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Mantini</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Romani</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Hagmann</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Corbetta</surname> <given-names>M</given-names></name>. <article-title>Resting-state functional connectivity emerges from structurally and dynamically shaped slow linear fluctuations</article-title>. <source>J Neurosci</source>. <year>2013</year>;<volume>33</volume>:<fpage>11239</fpage>–<lpage>11252</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.1091-13.2013" xlink:type="simple">10.1523/JNEUROSCI.1091-13.2013</ext-link></comment> <object-id pub-id-type="pmid">23825427</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004762.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Robinson</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Sarkar</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Pandejee</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Henderson</surname> <given-names>J</given-names></name>. <article-title>Determination of effective brain connectivity from functional connectivity with application to resting state connectivities</article-title>. <source>Phys Rev E</source>. <year>2014</year>;<volume>90</volume>:<fpage>012707</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevE.90.012707" xlink:type="simple">10.1103/PhysRevE.90.012707</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004762.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Friston</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Mechelli</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Turner</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Price</surname> <given-names>C</given-names></name>. <article-title>Nonlinear responses in fMRI: the Balloon model, Volterra kernels and other hemodynamics</article-title>. <source>NeuroImage</source>. <year>2000</year>;<volume>12</volume>:<fpage>466</fpage>–<lpage>477</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1006/nimg.2000.0630" xlink:type="simple">10.1006/nimg.2000.0630</ext-link></comment> <object-id pub-id-type="pmid">10988040</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004762.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Fornito</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Zalesky</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Breakspear</surname> <given-names>M</given-names></name>. <article-title>Graph analysis of the human connectome: Promise, progress, and pitfalls</article-title>. <source>Neuroimage</source>. <year>2013</year>;<volume>80</volume>:<fpage>426</fpage>–<lpage>444</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuroimage.2013.04.087" xlink:type="simple">10.1016/j.neuroimage.2013.04.087</ext-link></comment> <object-id pub-id-type="pmid">23643999</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004762.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Messé</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Rudrauf</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Benali</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Marrelec</surname> <given-names>G</given-names></name>. <article-title>Relating structure and function in the human brain: relative contributions of anatomy, stationary dynamics, and non-stationarities</article-title>. <source>PLoS COmput Biol</source>. <year>2014</year>;<volume>10</volume>:<fpage>e1003530</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1003530" xlink:type="simple">10.1371/journal.pcbi.1003530</ext-link></comment> <object-id pub-id-type="pmid">24651524</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004762.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Goebel</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Roebroeck</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Formisano</surname> <given-names>E</given-names></name>. <article-title>Investigating directed cortical interactions in time-resolved fMRI data using vector autoregressive modeling and Granger causality mapping</article-title>. <source>Magn Reson Imaging</source>. <year>2003</year>;<volume>21</volume>:<fpage>1251</fpage>–<lpage>1261</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.mri.2003.08.026" xlink:type="simple">10.1016/j.mri.2003.08.026</ext-link></comment> <object-id pub-id-type="pmid">14725933</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004762.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rodriguez</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Tuckwell</surname> <given-names>H</given-names></name>. <article-title>Statistical properties of stochastic nonlinear dynamical models of single spiking neurons and neural networks</article-title>. <source>Phys Rev E</source>. <year>1996</year>;<volume>54</volume>:<fpage>5585</fpage>–<lpage>5590</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevE.54.5585" xlink:type="simple">10.1103/PhysRevE.54.5585</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004762.ref034">
<label>34</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Bernstein</surname> <given-names>D</given-names></name>. <source>Matrix mathematics: Theory, facts, and formulas</source> (<edition>second edition</edition>). <publisher-name>PUP</publisher-name>; <year>2009</year>.</mixed-citation>
</ref>
<ref id="pcbi.1004762.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Schirner</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Rothmeier</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Jirsa</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>McIntosh</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Ritter</surname> <given-names>P</given-names></name>. <article-title>An automated pipeline for constructing personalised virtual brains from multimodal neuroimaging data</article-title>. <source>Neuroimage</source>. <year>2015</year>;<volume>117</volume>:<fpage>343</fpage>–<lpage>357</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuroimage.2015.03.055" xlink:type="simple">10.1016/j.neuroimage.2015.03.055</ext-link></comment> <object-id pub-id-type="pmid">25837600</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004762.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ritter</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Villringer</surname> <given-names>A</given-names></name>. <article-title>Simultaneous EEG-fMRI</article-title>. <source>Neurosci Biobehav Rev</source>. <year>2006</year>;<volume>30</volume>:<fpage>823</fpage>–<lpage>838</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neubiorev.2006.06.008" xlink:type="simple">10.1016/j.neubiorev.2006.06.008</ext-link></comment> <object-id pub-id-type="pmid">16911826</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004762.ref037">
<label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Schultze-Kraft</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Becker</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Breakspear</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Ritter</surname> <given-names>P</given-names></name>. <article-title>Exploiting the potential of three dimensional spatial wavelet analysis to explore the nesting of oscillations and spatial variance in simultaneous EEG-fMRI data</article-title>. <source>Prog Biophys Mol Biol</source>. <year>2011</year>;<volume>105</volume>:<fpage>67</fpage>–<lpage>79</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.pbiomolbio.2010.11.003" xlink:type="simple">10.1016/j.pbiomolbio.2010.11.003</ext-link></comment> <object-id pub-id-type="pmid">21094179</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004762.ref038">
<label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Grytskyy</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Tetzlaff</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Diesmann</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Helias</surname> <given-names>M</given-names></name>. <article-title>A unified view on weakly correlated recurrent networks</article-title>. <source>Front Comput Neurosci</source>. <year>2013</year>;<volume>18</volume>:<fpage>131</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004762.ref039">
<label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mitra</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Snyder</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Hacker</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Raichle</surname> <given-names>M</given-names></name>. <article-title>Lag structure in resting-state fMRI</article-title>. <source>J Neurophysiol</source>. <year>2014</year>;<volume>111</volume>:<fpage>2374</fpage>–<lpage>2391</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1152/jn.00804.2013" xlink:type="simple">10.1152/jn.00804.2013</ext-link></comment> <object-id pub-id-type="pmid">24598530</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004762.ref040">
<label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mitra</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Snyder</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Blazey</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Raichle</surname> <given-names>M</given-names></name>. <article-title>Lag threads organize the brain’s intrinsic activity</article-title>. <source>Proc Natl Acad Sci</source>. <year>2015</year>;<volume>112</volume>:<fpage>E2235</fpage>–<lpage>E2244</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1503960112" xlink:type="simple">10.1073/pnas.1503960112</ext-link></comment> <object-id pub-id-type="pmid">25825720</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004762.ref041">
<label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Heeger</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Ress</surname> <given-names>D</given-names></name>. <article-title>What does fMRI tell us about neuronal activity?</article-title> <source>Nat Rev Neurosci</source>. <year>2002</year>;<volume>3</volume>:<fpage>142</fpage>–<lpage>151</lpage>. <object-id pub-id-type="pmid">11836522</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004762.ref042">
<label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mantini</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Perrucci</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Del Gratta</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Romani</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Corbetta</surname> <given-names>M</given-names></name>. <article-title>Electrophysiological signatures of resting state networks in the human brain</article-title>. <source>Proc Natl Acad Sci</source>. <year>2007</year>;<volume>104</volume>:<fpage>13170</fpage>–<lpage>13175</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.0700668104" xlink:type="simple">10.1073/pnas.0700668104</ext-link></comment> <object-id pub-id-type="pmid">17670949</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004762.ref043">
<label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ekstrom</surname> <given-names>A</given-names></name>. <article-title>How and when the fMRI BOLD signal relates to underlying neural activity: the danger in dissociation</article-title>. <source>Brain Res Rev</source>. <year>2010</year>;<volume>62</volume>:<fpage>233</fpage>–<lpage>244</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.brainresrev.2009.12.004" xlink:type="simple">10.1016/j.brainresrev.2009.12.004</ext-link></comment> <object-id pub-id-type="pmid">20026191</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004762.ref044">
<label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gotts</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Chow</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Martin</surname> <given-names>A</given-names></name>. <article-title>Repetition priming and repetition suppression: A case for enhanced efficiency through neural synchronization</article-title>. <source>Cogn Neurosci</source>. <year>2012</year>;<volume>3</volume>:<fpage>227</fpage>–<lpage>237</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1080/17588928.2012.670617" xlink:type="simple">10.1080/17588928.2012.670617</ext-link></comment> <object-id pub-id-type="pmid">23144664</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004762.ref045">
<label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bartsch</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Homola</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Biller</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Solymosi</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Bendszus</surname> <given-names>M</given-names></name>. <article-title>Diagnostic functional MRI: illustrated clinical applications and decision-making</article-title>. <source>J Magn Reson Imaging</source>. <year>2006</year>;<volume>23</volume>:<fpage>921</fpage>–<lpage>932</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/jmri.20579" xlink:type="simple">10.1002/jmri.20579</ext-link></comment> <object-id pub-id-type="pmid">16649199</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004762.ref046">
<label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Garrett</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Samanez-Larkin</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>MacDonald</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Lindenberger</surname> <given-names>U</given-names></name>, <name name-style="western"><surname>McIntosh</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Grady</surname> <given-names>C</given-names></name>. <article-title>Moment-to-moment brain signal variability: A next frontier in brain mapping?</article-title> <source>Neurosci Biobehav Rev</source>. <year>2013</year>;<volume>37</volume>:<fpage>610</fpage>–<lpage>624</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neubiorev.2013.02.015" xlink:type="simple">10.1016/j.neubiorev.2013.02.015</ext-link></comment> <object-id pub-id-type="pmid">23458776</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004762.ref047">
<label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Patel</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Bowman</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Rilling</surname> <given-names>J</given-names></name>. <article-title>A Bayesian approach to determining connectivity of the human brain</article-title>. <source>Hum Brain Mapp</source>. <year>2006</year>;<volume>27</volume>:<fpage>267</fpage>–<lpage>276</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/hbm.20182" xlink:type="simple">10.1002/hbm.20182</ext-link></comment> <object-id pub-id-type="pmid">16092131</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004762.ref048">
<label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kötter</surname> <given-names>R</given-names></name>. <article-title>Online retrieval, processing, and visualization of primate connectivity data from the CoCoMac Database</article-title>. <source>Neuroinformatics</source>. <year>2004</year>;<volume>2</volume>:<fpage>127</fpage>–<lpage>144</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1385/NI:2:2:127" xlink:type="simple">10.1385/NI:2:2:127</ext-link></comment> <object-id pub-id-type="pmid">15319511</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004762.ref049">
<label>49</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bakker</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Wachtler</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Diesmann</surname> <given-names>M</given-names></name>. <article-title>CoCoMac 2.0 and the future of tract-tracing databases</article-title>. <source>Front Neuroinform</source>. <year>2012</year>;<volume>6</volume>:<fpage>30</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.3389/fninf.2012.00030" xlink:type="simple">10.3389/fninf.2012.00030</ext-link></comment> <object-id pub-id-type="pmid">23293600</object-id></mixed-citation>
</ref>
</ref-list>
</back>
</article>