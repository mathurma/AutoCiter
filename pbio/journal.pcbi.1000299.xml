<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN">
<front>
<journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher></journal-meta>
<article-meta><article-id pub-id-type="publisher-id">08-PLCB-RA-0525R3</article-id><article-id pub-id-type="doi">10.1371/journal.pcbi.1000299</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline"><subject>Computational Biology/Comparative Sequence Analysis</subject><subject>Computational Biology/Evolutionary Modeling</subject><subject>Computational Biology/Genomics</subject><subject>Computational Biology/Macromolecular Sequence Analysis</subject><subject>Computational Biology/Sequence Motif Analysis</subject><subject>Computational Biology/Transcriptional Regulation</subject><subject>Evolutionary Biology/Bioinformatics</subject><subject>Evolutionary Biology/Developmental Evolution</subject><subject>Evolutionary Biology/Genomics</subject></subj-group></article-categories><title-group><article-title>Alignment and Prediction of <italic>cis</italic>-Regulatory Modules Based on a Probabilistic Model of Evolution</article-title><alt-title alt-title-type="running-head">Evolution of <italic>cis</italic>-Regulatory Modules</alt-title></title-group><contrib-group>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>He</surname><given-names>Xin</given-names></name><xref ref-type="aff" rid="aff1"/></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Ling</surname><given-names>Xu</given-names></name><xref ref-type="aff" rid="aff1"/></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Sinha</surname><given-names>Saurabh</given-names></name><xref ref-type="aff" rid="aff1"/><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
</contrib-group><aff id="aff1">          <addr-line>Department of Computer Science, University of Illinois Urbana-Champaign, Urbana, Illinois, United States of America</addr-line>       </aff><contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Wasserman</surname><given-names>Wyeth W.</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group><aff id="edit1">University of British Columbia, Canada</aff><author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">sinhas@cs.uiuc.edu</email></corresp>
<fn fn-type="con"><p>Conceived and designed the experiments: XH SS. Performed the experiments: XH XL. Analyzed the data: XH XL. Contributed reagents/materials/analysis tools: XH SS. Wrote the paper: XH SS.</p></fn>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn></author-notes><pub-date pub-type="collection"><month>3</month><year>2009</year></pub-date><pub-date pub-type="epub"><day>13</day><month>3</month><year>2009</year></pub-date><volume>5</volume><issue>3</issue><elocation-id>e1000299</elocation-id><history>
<date date-type="received"><day>1</day><month>7</month><year>2008</year></date>
<date date-type="accepted"><day>22</day><month>1</month><year>2009</year></date>
</history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2009</copyright-year><copyright-holder>He et al</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract>
<p>Cross-species comparison has emerged as a powerful paradigm for predicting <italic>cis</italic>-regulatory modules (CRMs) and understanding their evolution. The comparison requires reliable sequence alignment, which remains a challenging task for less conserved noncoding sequences. Furthermore, the existing models of DNA sequence evolution generally do not explicitly treat the special properties of CRM sequences. To address these limitations, we propose a model of CRM evolution that captures different modes of evolution of functional transcription factor binding sites (TFBSs) and the background sequences. A particularly novel aspect of our work is a probabilistic model of gains and losses of TFBSs, a process being recognized as an important part of regulatory sequence evolution. We present a computational framework that uses this model to solve the problems of CRM alignment and prediction. Our alignment method is similar to existing methods of statistical alignment but uses the conserved binding sites to improve alignment. Our CRM prediction method deals with the inherent uncertainties of binding site annotations and sequence alignment in a probabilistic framework. In simulated as well as real data, we demonstrate that our program is able to improve both alignment and prediction of CRM sequences over several state-of-the-art methods. Finally, we used alignments produced by our program to study binding site conservation in genome-wide binding data of key transcription factors in the <italic>Drosophila</italic> blastoderm, with two intriguing results: (i) the factor-bound sequences are under strong evolutionary constraints even if their neighboring genes are not expressed in the blastoderm and (ii) binding sites in distal bound sequences (relative to transcription start sites) tend to be more conserved than those in proximal regions. Our approach is implemented as software, EMMA (Evolutionary Model-based <italic>cis</italic>-regulatory Module Analysis), ready to be applied in a broad biological context.</p>
</abstract><abstract abstract-type="summary"><title>Author Summary</title>
<p>Comparison of noncoding DNA sequences across species has the potential to significantly improve our understanding of gene regulation and our ability to annotate regulatory regions of the genome. This potential is evident from recent publications analyzing 12 <italic>Drosophila</italic> genomes for regulatory annotation. However, because noncoding sequences are much less structured than coding sequences, their interspecies comparison presents technical challenges, such as ambiguity about how to align them and how to predict transcription factor binding sites, which are the fundamental units that make up regulatory sequences. This article describes how to build an integrated probabilistic framework that performs alignment and binding site prediction simultaneously, in the process improving the accuracy of both tasks. It defines a stochastic model for the evolution of entire “<italic>cis</italic>-regulatory modules,” with its highlight being a novel theoretical treatment of the commonly observed loss and gain of binding sites during evolution. This new evolutionary model forms the backbone of newly developed software for the prediction of new <italic>cis</italic>-regulatory modules, alignment of known modules to elucidate general principles of <italic>cis</italic>-regulatory evolution, or both. The new software is demonstrated to provide benefits in performance of these two crucial genomics tasks.</p>
</abstract><funding-group><funding-statement>XH and XL were supported by a National Science Foundation Frontiers in Integrative Biological Research grant (BeeSpace). SS was supported by start-up funds provided by the Department of Computer Science and the Institute of Genomic Biology at the University of Illinois Urbana-Champaign.</funding-statement></funding-group><counts><page-count count="14"/></counts></article-meta>
</front>
<body><sec id="s1">
<title>Introduction</title>
<p>The spatial-temporal expression pattern of a gene is controlled by its regulatory sequences, sometimes called a <italic>cis</italic>-regulatory module (CRM). A CRM contains a number of transcription factor binding sites (TFBSs), which read the expression level of the cognate transcription factors (TFs) and drive the appropriate expression pattern through the combinatorial interactions among TFs, their co-factors and the basal transcriptional machinery <xref ref-type="bibr" rid="pcbi.1000299-Davidson1">[1]</xref>. Cross-species comparison plays a central role in various problems involving <italic>cis</italic>-regulatory sequences, including computational prediction of CRM sequences <xref ref-type="bibr" rid="pcbi.1000299-Berman1">[2]</xref>–<xref ref-type="bibr" rid="pcbi.1000299-Wasserman1">[4]</xref>, discovery of novel sequence motifs <xref ref-type="bibr" rid="pcbi.1000299-Li1">[5]</xref>,<xref ref-type="bibr" rid="pcbi.1000299-Siddharthan1">[6]</xref> and exploration of the principles of regulatory sequence evolution <xref ref-type="bibr" rid="pcbi.1000299-Ludwig1">[7]</xref>. For these different types of analysis, the standard procedure almost always starts with an alignment of these sequences, followed by an analysis of the conservation pattern of sequences as suited for the specific task.</p>
<p>The first major limitation of this two-step procedure arises from errors in alignment. It has been shown that alignment procedure may seriously affect the results of comparative genomic analysis such as reconstruction of phylogenetic trees and inference of positive selection <xref ref-type="bibr" rid="pcbi.1000299-Wong1">[8]</xref>. Most alignment tools are not customized to regulatory sequences, and thus cannot take advantage of their specific structural and evolutionary properties. A second shortcoming of many current methods for regulatory sequence comparison is their heuristic nature. It is difficult to assess the significance of the results if appropriate statistical models have not been specified and used. While there are indeed a number of successful programs based on sound statistical models of DNA sequence evolution <xref ref-type="bibr" rid="pcbi.1000299-Siepel1">[9]</xref>,<xref ref-type="bibr" rid="pcbi.1000299-Thorne1">[10]</xref>, few of them incorporate the CRM structure. Finally, it is commonly assumed that a TFBS is conserved across all species being studied <xref ref-type="bibr" rid="pcbi.1000299-Li1">[5]</xref>,<xref ref-type="bibr" rid="pcbi.1000299-Moses1">[11]</xref>. However, there is strong evidence that functional noncoding sequences in general, and TFBSs in particular, are not always conserved in an alignable sequence even in relatively close species <xref ref-type="bibr" rid="pcbi.1000299-Birney1">[12]</xref>,<xref ref-type="bibr" rid="pcbi.1000299-Moses2">[13]</xref>. This process of TFBS change has been recognized as an important source of evolution of phenotypes <xref ref-type="bibr" rid="pcbi.1000299-Wray1">[14]</xref>.</p>
<p>Several approaches have been proposed to address one or more of the problems discussed above. The programs Stubb <xref ref-type="bibr" rid="pcbi.1000299-Sinha1">[3]</xref>, EvoPromoter <xref ref-type="bibr" rid="pcbi.1000299-Wong2">[15]</xref> and PhylCRM <xref ref-type="bibr" rid="pcbi.1000299-Warner1">[16]</xref> predict CRMs as significant clusters of TFBSs, which are detected by comparing orthologous sequences using an evolutionary model of binding sites. However, all methods require a fixed alignment as input and do not model the binding site gains and losses. The programs CONREAL <xref ref-type="bibr" rid="pcbi.1000299-Berezikov1">[17]</xref>, EEL <xref ref-type="bibr" rid="pcbi.1000299-Hallikas1">[18]</xref> and SimAnn <xref ref-type="bibr" rid="pcbi.1000299-Bais1">[19]</xref> align putative CRM sequences with the explicit goal of aligning the sites matching known TF profiles. None of these methods use rigorous statistical or evolutionary models, and they all assume the complete conservation of TFBSs. Moses et al. <xref ref-type="bibr" rid="pcbi.1000299-Moses2">[13]</xref> deal with alignment uncertainty in their analysis of binding site turnover, but this is done as a post-hoc analysis rather than being integrated with the inference step. Our recent work, Morph <xref ref-type="bibr" rid="pcbi.1000299-Sinha2">[20]</xref>, tries to solve all the above problems in a single framework with a pair-HMM model. However, the Morph model does not accurately capture the evolutionary dynamics of CRMs. Lineage specific TFBSs are treated not as gain or loss events in evolutionary time, but merely as HMM “emissions” from one sequence, and not the other. Another recent work, SAPF <xref ref-type="bibr" rid="pcbi.1000299-Satija1">[21]</xref>, aims to combine probabilistic model-based alignment with “phylogenetic footprinting”, which refers to the identification of evolutionarily constrained sequences based on their lower substitution rates. However, TFBSs are not explicitly represented in the SAPF model, and the program is not designed to predict targets of specific transcription factor(s). Our goal is not to detect constrained sequences per se, but the target sequences of specific transcription factors, whose binding motifs are known <italic>a priori</italic>.</p>
<p>Our philosophy of doing cross-species sequence analysis is: firstly, the method should be based on an explicit model of sequence evolution, as expressed in <xref ref-type="bibr" rid="pcbi.1000299-Thorne1">[10]</xref> – “the study of biological sequence data should not be divorced from the process that created it”; secondly, the problem should be solved in a single, integrative framework, instead of being split into multiple steps. Specifically, this means that to predict a CRM, one should take into account the uncertainty of alignment and TFBS annotation by summing over them from a combined statistical model. The above philosophy has been adopted previously in the area of statistical alignment <xref ref-type="bibr" rid="pcbi.1000299-Thorne1">[10]</xref>,<xref ref-type="bibr" rid="pcbi.1000299-Lunter1">[22]</xref>,<xref ref-type="bibr" rid="pcbi.1000299-Thorne2">[23]</xref>, where stochastic models are used to describe the evolution of indels and the alignment task is often integrated with the ultimate goals, most notably, the reconstruction of phylogenetic tree <xref ref-type="bibr" rid="pcbi.1000299-Lunter2">[24]</xref>. Models that describe one or more aspect of regulatory sequence evolution have been proposed recently <xref ref-type="bibr" rid="pcbi.1000299-Berg1">[25]</xref>–<xref ref-type="bibr" rid="pcbi.1000299-Stone1">[31]</xref>, but none of these methods offers a complete evolutionary model of CRM sequences that can be directly used for bioinformatic tasks such as CRM alignment and prediction. We propose an expressive and biologically realistic model of CRM evolution where (i) stochastic models of substitution and indels are used to characterize the evolution of background sequences (non-TFBS sequences inside a CRM); (ii) TFBSs evolve according to a population genetic model developed previously; (iii) functional switching between a non-TFBS and TFBS can occur in a manner dependent on the binding energy of the evolving site. We implement an efficient inference machinery and apply it to the tasks of CRM alignment and prediction.</p>
<p>We used alignments produced by our program to analyze the regulatory sequences involved in early development of <italic>Drosphila melanogaster</italic>. We took advantage of the recent genome-wide binding data on key TFs involved in blastoderm-stage gene regulation (obtained using ChIP-chip technology <xref ref-type="bibr" rid="pcbi.1000299-Li2">[32]</xref>), and tested two important hypothesis. First, we investigated previously published claims that there is a high level of non-functional binding in such genome-wide TF binding studies <xref ref-type="bibr" rid="pcbi.1000299-Gao1">[33]</xref>,<xref ref-type="bibr" rid="pcbi.1000299-Hu1">[34]</xref>. The prime candidates of such non-functional binding sites are those that are not adjacent to genes expressed in blastoderm. If the claim is true, we expect that these sites will be less conserved than binding sites adjacent to appropriately expressed genes. We found statistical evidence to the contrary, opening up the possibility of functional binding at a larger scale than previously thought. Second, the positions of CRMs relative to the coding sequences, may have a large impact on their functions. For example, computationally predicted CRM sequences enriched with TFBSs are much more likely to drive expression of reporter genes if they are located close to transcription start site (TSS) <xref ref-type="bibr" rid="pcbi.1000299-Berman1">[2]</xref>. Wray has suggested an interesting hypothesis that the CRMs near TSS are likely “control modules”, while those distal ones may be “booster modules” that are less essential <xref ref-type="bibr" rid="pcbi.1000299-Wray2">[35]</xref>. We tested this hypothesis by comparing the conservation level of TFBSs in proximal bound regions and in distal ones. We find no support for this hypothesis, and in fact distal bound regions seem to have a greater conservation of binding sites than proximal regions, contrary to expectation.</p>
</sec><sec id="s2">
<title>Results</title>
<sec id="s2a">
<title>Evolutionary Model of <italic>cis</italic>-Regulatory Modules</title>
<p>In this section, we present the details of our model, which first captures the salient properties of a CRM's content and then lays out the evolutionary forces acting upon its different components. The model prescribes the joint likelihood of a set of orthologous CRMs that are related by a given phylogenetic tree.</p>
<p>We begin with a model of CRM composition and assume that the ancestral CRM is generated from this model. We use a generalized HMM of zero order, similar to the ones used in <xref ref-type="bibr" rid="pcbi.1000299-Sinha1">[3]</xref>,<xref ref-type="bibr" rid="pcbi.1000299-Wong2">[15]</xref>,<xref ref-type="bibr" rid="pcbi.1000299-Frith1">[36]</xref>. The binding specificities (motifs) of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e001" xlink:type="simple"/></inline-formula> TFs are represented by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e002" xlink:type="simple"/></inline-formula> position weight matrices (PWMs), and the nucleotide frequencies of the background sequence are denoted by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e003" xlink:type="simple"/></inline-formula>. At each step, the background state or the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e004" xlink:type="simple"/></inline-formula> motif is sampled with probability <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e005" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e006" xlink:type="simple"/></inline-formula>, respectively. If the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e007" xlink:type="simple"/></inline-formula> motif is chosen, the actual site is sampled from the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e008" xlink:type="simple"/></inline-formula> PWM; otherwise, a single nucleotide is sampled from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e009" xlink:type="simple"/></inline-formula>. The HMM transition probability, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e010" xlink:type="simple"/></inline-formula>, can be interpreted as the average number of binding sites of this motif per nucleotide at equilibrium, or simply binding site density.</p>
<p>Our evolutionary model of the background sequences is adapted from the models developed earlier for “statistical alignment” <xref ref-type="bibr" rid="pcbi.1000299-Siepel1">[9]</xref>,<xref ref-type="bibr" rid="pcbi.1000299-Lunter1">[22]</xref>,<xref ref-type="bibr" rid="pcbi.1000299-Knudsen1">[37]</xref>. Substitutions are described by the standard HKY model <xref ref-type="bibr" rid="pcbi.1000299-Hasegawa1">[38]</xref>, with equilibrium distribution <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e011" xlink:type="simple"/></inline-formula> and transition-transversion bias <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e012" xlink:type="simple"/></inline-formula>. Insertions and deletions follow Poisson processes with rates <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e013" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e014" xlink:type="simple"/></inline-formula> respectively. The length of an indel follows the geometric distribution with the probability of extension <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e015" xlink:type="simple"/></inline-formula>. Following this model, the joint probability of the sequences <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e016" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e017" xlink:type="simple"/></inline-formula> in the example below, under a two-species phylogenetic tree with branch lengths <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e018" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e019" xlink:type="simple"/></inline-formula>, is approximately (# stands for any nucleotide):<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e020" xlink:type="simple"/></disp-formula><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e021" xlink:type="simple"/><label>(1)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e022" xlink:type="simple"/></inline-formula>. The terms <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e023" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e024" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e025" xlink:type="simple"/></inline-formula> are the probabilities of not seeing an indel event in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e026" xlink:type="simple"/></inline-formula>, of seeing a gap in the second sequence and of seeing a gap in the first sequence, respectively. The derivation of these probabilities can be found in <xref ref-type="supplementary-material" rid="pcbi.1000299.s004">Text S1</xref>.</p>
<p>We use the population genetics-based Halpern-Bruno (HB) model for TFBS evolution <xref ref-type="bibr" rid="pcbi.1000299-Halpern1">[39]</xref>,<xref ref-type="bibr" rid="pcbi.1000299-Moses3">[40]</xref>. This model captures the fact that the evolutionary constraints at different positions of a TFBS may be different: less degenerate positions in the PWM generally have lower substitution rates. Let <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e027" xlink:type="simple"/></inline-formula> be the substitution rate matrix of the background sequences, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e028" xlink:type="simple"/></inline-formula> be the PWM of the motif being evolved, the rate of substitution of a nucleotide <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e029" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e030" xlink:type="simple"/></inline-formula> at position <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e031" xlink:type="simple"/></inline-formula> is:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e032" xlink:type="simple"/><label>(2)</label></disp-formula>The transition probability of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e033" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e034" xlink:type="simple"/></inline-formula> in time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e035" xlink:type="simple"/></inline-formula> is thus the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e036" xlink:type="simple"/></inline-formula> entry of the matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e037" xlink:type="simple"/></inline-formula>. Since HB model is time reversible, the joint probability: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e038" xlink:type="simple"/></inline-formula> is simply <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e039" xlink:type="simple"/></inline-formula>.</p>
<p>Gain and loss of TFBSs are commonly observed across a large evolutionary spectrum: e.g. fungi <xref ref-type="bibr" rid="pcbi.1000299-Doniger1">[41]</xref>, insects <xref ref-type="bibr" rid="pcbi.1000299-Moses2">[13]</xref> and vertebrates <xref ref-type="bibr" rid="pcbi.1000299-Birney1">[12]</xref>. There are two different scenarios in which these events may occur. In the first scenario, the expression pattern of the target gene is under adaptive change, which “demands” a change in the composition of the controlling CRM, causing binding site gains and losses. In the second scenario, the expression of the gene is under stabilizing selection, but the selection on individual TFBSs may be weak, and as a result, a TFBS may be lost during evolution due to random drift. New TFBSs may also be created in the background sequences simply by mutations and random drift, due to the fact that TFBSs are often short and degenerate. The two processes may be linked to each other: the loss of one TFBS could make gain of a TFBS in the background more beneficial so as to compensate for the loss; likewise the gain of a new site could make existing sites redundant, thus relax the constraints and speed up the loss process.</p>
<p>The main difference between the two scenarios is: in the former, the changes of TFBSs are driven by external selection forces while in the latter, the changes are mainly dominated by the stochastic forces of mutation and random drift, with selection being weak. In our model, we adopt the second scenario as it is a more “parsimonious” explanation of TFBS gain and loss, and is more consistent with our current knowledge about the <italic>Drosophila</italic> early developmental CRMs <xref ref-type="bibr" rid="pcbi.1000299-Ludwig1">[7]</xref>,<xref ref-type="bibr" rid="pcbi.1000299-Ludwig2">[42]</xref>, which are among the most well-characterized available today.</p>
<p>Our specific model formulates the ideas discussed above. We follow the usual definition of binding energy of a TFBS, for example <xref ref-type="bibr" rid="pcbi.1000299-Mustonen1">[28]</xref>. We assume that there is a threshold for the binding energy of a site, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e040" xlink:type="simple"/></inline-formula>, above which a site is not functional. We use <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e041" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e042" xlink:type="simple"/></inline-formula> to denote the evolutionary models of a TFBS and non-TFBS respectively. Our basic idea for modeling gain and loss is: switching of a site between TFBS and non-TFBS states is a switch between the models that govern the evolution of this site. Under the model <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e043" xlink:type="simple"/></inline-formula>, mutations that change the energy of a site above <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e044" xlink:type="simple"/></inline-formula> may occasionally be fixed due to random drift. After that point, natural selection will not be able to perceive this site (switch to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e045" xlink:type="simple"/></inline-formula>). Likewise, under the model <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e046" xlink:type="simple"/></inline-formula>, a background site could occasionally reach <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e047" xlink:type="simple"/></inline-formula> by mutation and random drift. This site will then be visible to its cognate TF and will be subjected to natural selection (switch to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e048" xlink:type="simple"/></inline-formula>). We note that indel events may happen inside TFBSs, albeit with a much lower rate than in background sequences, and we denote by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e049" xlink:type="simple"/></inline-formula> the relative rate of intra-TFBS indels. Interaction between gain and loss events as explained above is not explicitly modeled, to avoid creating dependencies that make the computational task much more difficult.</p>
<p>We illustrate our model of TFBS loss in <xref ref-type="fig" rid="pcbi-1000299-g001">Figure 1</xref>: starting with a functional site <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e050" xlink:type="simple"/></inline-formula>, a substitution or indel event disrupts this site at time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e051" xlink:type="simple"/></inline-formula>; the background model then governs the evolution of this site, which eventually becomes sequence <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e052" xlink:type="simple"/></inline-formula>. Let <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e053" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e054" xlink:type="simple"/></inline-formula> be the sequences preceding and following the loss event respectively, then:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e055" xlink:type="simple"/><label>(3)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e056" xlink:type="simple"/></inline-formula> is the instantaneous rate of substitution (given by Eq. 2) or indel (given by the product of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e057" xlink:type="simple"/></inline-formula> and the background indel rate) under the model <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e058" xlink:type="simple"/></inline-formula>, the evolutionary model of TFBSs; and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e059" xlink:type="simple"/></inline-formula> must satisfy the energy constraint: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e060" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e061" xlink:type="simple"/></inline-formula>, and the neighborhood constraint: they differ by a single mutation event. The probability of TFBS gain can be calculate in a similar way. Joint probability under a two-species phylogenetic tree can be found in <xref ref-type="supplementary-material" rid="pcbi.1000299.s004">Text S1</xref> and <xref ref-type="supplementary-material" rid="pcbi.1000299.s001">Figure S1</xref>. For computational efficiency, we make the parsimony assumption: suppose <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e062" xlink:type="simple"/></inline-formula> is an intermediate site between <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e063" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e064" xlink:type="simple"/></inline-formula>, then the symbol at any position of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e065" xlink:type="simple"/></inline-formula> is either the symbol of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e066" xlink:type="simple"/></inline-formula> or of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e067" xlink:type="simple"/></inline-formula> at that position. We also note that, even though we rely on a threshold for determining when binding site gain or loss happens, this parameter is not directly used for classifying a site as functional or not. Instead, the annotation of a site depends upon an examination of the site and its orthologous sequences, and their probability under different histories: background, conserved or lineage-specific.</p>
<fig id="pcbi-1000299-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000299.g001</object-id><label>Figure 1</label><caption>
<title>A model of TFBS loss.</title>
<p>Shaded and white box represent functional TFBS and non-functional site respectively. The dashed arrow between <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e068" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e069" xlink:type="simple"/></inline-formula> indicates the instantaneous substitution or indel event that disrupts the site.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000299.g001" xlink:type="simple"/></fig></sec><sec id="s2b">
<title>Statistical Inference</title>
<p>We solve the following computational problems: given two orthologous sequences (that are roughly alignable so that they could be identified in the first place) and a set of TF motifs, (1) align the two sequences and annotate the TFBSs; (2) predict if the sequence is a CRM targeted by the given motifs. We use dynamic programming to simultaneously find the optimal alignment and TFBS annotation. For the second task, we use a likelihood-ratio test of two models: the CRM evolutionary model and the background evolutionary model where no motif is used. Computation under each model is also done by dynamic programming, summing over all possible alignment paths and annotations of TFBSs. The details of the algorithms can be found in <xref ref-type="sec" rid="s4">Materials and Methods</xref>. We allow all parameters to be learned automatically from the data while allowing certain parameters to be specified by users (<xref ref-type="supplementary-material" rid="pcbi.1000299.s004">Text S1</xref>). Our computational framework is implemented as a program called EMMA (Evolutionary Model-based <italic>cis</italic>-regulatory Module Analysis).</p>
</sec><sec id="s2c">
<title>Comparison of Alignment Methods Using Simulated Data</title>
<p>Simulation of sequence evolution is a useful strategy for assessing computational methods, as the true evolutionary history is often unknown for real data. In addition, simulation is an important way to understand how various factors, such as divergence time or the presence of TFBSs, affect the performance of a computational procedure, since such questions are generally difficult to answer analytically. We developed a simulation program that can generate orthologous CRM sequences according to our evolutionary model. The binding site densities, branch lengths, indel rates, etc., are all user-specified parameters. Our simulator captures a richer biology of regulatory evolution than many other sequence simulators <xref ref-type="bibr" rid="pcbi.1000299-Cartwright1">[43]</xref>,<xref ref-type="bibr" rid="pcbi.1000299-Pollard1">[44]</xref> and can be used as a general tool for the study of <italic>cis</italic>-regulatory evolution.</p>
<p>We first used simulation to study alignment methods, similar to what was done previously by Pollard et al. <xref ref-type="bibr" rid="pcbi.1000299-Pollard1">[44]</xref> and Huang et al. <xref ref-type="bibr" rid="pcbi.1000299-Huang1">[45]</xref>. We implemented several versions of EMMA so that we could study the effect of each of its features. We denote by EMMA0 the version that uses only the background model, but not the motifs (thus EMMA0 is equivalent to the traditional Needleman-Wunsch alignment with affine gap penalty); EMMA1 is the version that considers only conserved TFBSs; and EMMA2 models both conserved and lineage-specific TFBSs. In addition, we tested a widely-used general-purpose alignment tool, Lagan <xref ref-type="bibr" rid="pcbi.1000299-Brudno1">[46]</xref>, and our recently developed program for aligning regulatory sequences, Morph <xref ref-type="bibr" rid="pcbi.1000299-Sinha2">[20]</xref>. Morph uses a pair-HMM to model the alignment of two sequence, where the HMM contains several motif states to encode the presence of TFBSs in one or both sequences. We note that Morph does not model binding site turnover, so a non-conserved site will be aligned with gaps, instead of its true orthologous sequence. All programs were run under the default settings. The alignment performance was measured using specificity and sensitivity, as in <xref ref-type="bibr" rid="pcbi.1000299-Sinha2">[20]</xref>. In addition, we defined a measure called “TFBS conservation sensitivity” as the percentage of all positions in conserved TFBSs that are correctly aligned. For CRMs, this is clearly a more relevant measure of alignment quality <xref ref-type="bibr" rid="pcbi.1000299-Pollard1">[44]</xref>.</p>
<p>The specificities and sensitivities of all programs are similar (see Tables S2 and Table S3 in <xref ref-type="supplementary-material" rid="pcbi.1000299.s004">Text S1</xref>) because different programs differ mostly in treating TFBSs, which occupy a small fraction of the total sequence length. The results with the TFBS conservation measure are shown in <xref ref-type="fig" rid="pcbi-1000299-g002">Figure 2</xref>. EMMA0 and Lagan have similar performance with all three measures. This suggests that the values of alignment parameters have relatively small effect on the alignment quality. At moderate to high divergences, both EMMA1 and EMMA2 significantly outperform EMMA0 and Lagan in terms of TFBS conservation sensitivity (e.g. EMMA1 is better than Lagan by 12% and 13% respectively at divergence 0.7 and 0.8) and are slightly better with the other two measures, suggesting that modeling conserved TFBSs is beneficial to alignment of divergent sequences. Modeling lineage-specific TFBSs does not seem to help alignment, as EMMA1 is slightly better than EMMA2 at high divergence levels. This somewhat counter-intuitive observation may be explained by the fact that in pairwise comparison, lineage-specific TFBSs will not help alignment by serving as “anchors”; on the other hand, a truly-conserved TFBS may occasionally be treated as two lineage-specific sites in EMMA2. Morph is superior to Lagan and EMMA0 in terms of aligning conserved TFBSs, but not as good as EMMA1 and EMMA2. In addition, the higher TFBS conservation of Morph is achieved at the cost of significantly lower overall alignment sensitivity (more than 6% lower than all other programs at divergence greater than 0.5, see Tables S2 and S3 in <xref ref-type="supplementary-material" rid="pcbi.1000299.s004">Text S1</xref>).</p>
<fig id="pcbi-1000299-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000299.g002</object-id><label>Figure 2</label><caption>
<title>TFBS conservation sensitivity from various alignment programs using simulated data.</title>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000299.g002" xlink:type="simple"/></fig>
<p>Pollard and colleagues also studied the problem of how alignment affects binding site detection, through simulation <xref ref-type="bibr" rid="pcbi.1000299-Pollard1">[44]</xref>,<xref ref-type="bibr" rid="pcbi.1000299-Pollard2">[47]</xref>. Their recent program, CisEvolver <xref ref-type="bibr" rid="pcbi.1000299-Pollard1">[44]</xref>, is similar to our simulator in that both treat sequences as a mixture of background and TFBSs, and both use the Halpern-Bruno model for binding site evolution. The main differences include: CisEvolver uses empirical indel frequencies to parameterize the evolution of indels while we use a simpler geometric distribution; and CisEvolver does not incorporate the possible gain and loss of functional sites. Nevertheless, to test the robustness of our conclusions, we generated the test data using CisEvolver and repeated the comparisons described above. The results are in broad agreement with our previous results (see <xref ref-type="supplementary-material" rid="pcbi.1000299.s002">Figure S2</xref>, and Tables S4 and S5 in <xref ref-type="supplementary-material" rid="pcbi.1000299.s004">Text S1</xref>), suggesting that EMMA is robust to the treatment of indels and that our gain and loss model will perform well even if there are actually no or few gain or loss events (i.e., it will not introduce such events artificially). The PSPE program <xref ref-type="bibr" rid="pcbi.1000299-Huang1">[45]</xref> is also capable of simulating the evolution of CRMs. It goes beyond modeling the gain and loss of individual binding sites, and captures features not available in either our simulator or CisEvolver; for example, it allows “global” fitness constraints such as “the total number of sites in a CRM must fall in some range”. However, its semantics of sequence alignment is different from the conventional notion of alignment (i.e., nucleotide-level orthology), making its benchmarks unsuitable for studying our program's performance. Furthermore, these alignment benchmarks were obtained under the assumption that each TF had one and only one site in a CRM, an assumption that is overly stringent given that many factors are known for homotypic clustering <xref ref-type="bibr" rid="pcbi.1000299-Lifanov1">[48]</xref>. Also, the key idea of the PSPE model is “replacement turnover”, where one site loss exactly matches a gain in another site and vice versa, but it is not clear if this is a general evolutionary process. One recent study did not find that such change is important in explaining the observed patterns of binding site turnover <xref ref-type="bibr" rid="pcbi.1000299-Moses2">[13]</xref>. Based on these considerations, we chose not to test EMMA on the benchmark data of PSPE.</p>
</sec><sec id="s2d">
<title>Comparison of CRM Prediction Methods Using Simulated Data</title>
<p>We investigated the problem of predicting CRM sequences given a set of motifs, again using simulated sequences. We implemented another program called EMMA-ANN, which scores a sequence by its conserved TFBSs using a fixed, non-motif alignment (we used EMMA0 alignment). The only difference between EMMA-ANN and EMMA1 is that a fixed alignment is used in the former, so the comparison between the two should suggest how important it is to treat alignment uncertainty. In addition to the EMMA family programs and Morph, we tested the program Stubb <xref ref-type="bibr" rid="pcbi.1000299-Sinha1">[3]</xref>, which scores a sequence by its binding site cluster while favoring the conserved sites. Similar to EMMA-ANN, Stubb is also based on a fixed alignment. Here, a site that matches the PWM, but does not fall inside an aligned region, is allowed to contribute to CRM scoring; in contrast, only conserved sites are allowed to make contributions in EMMA-ANN. Thus in terms of identifying binding sites, Stubb is likely to be more sensitive but less accurate, a feature that has implications on CRM prediction. We generated a positive set of sequences simulated under the CRM evolutionary model, and a negative set under the background model. A program is tested by its ability to discriminate positive and negative sequences: all the sequences will be scored by the program; as the score threshold varies, the specificity and sensitivity will be computed. The overall performance of the program is measured by the area under curve (AUC) of the ROC curve, i.e., the plot of sensitivity vs (1 - specificity).</p>
<p>The results are shown in <xref ref-type="fig" rid="pcbi-1000299-g003">Figure 3</xref>. The first observation is that high accuracy of prediction can be achieved even at relatively large divergence. Our explanation is that at higher divergence, conserved TFBSs will be more significant, i.e., less likely to be explained by the chance conservation of neutral sequences. The implication is that CRM prediction is sensitive to the correct alignment of conserved TFBSs, but not to the overall alignment quality. Comparisons between EMMA1 and EMMA-ANN suggest that simultaneous alignment and CRM scoring consistently improve prediction at almost all levels of divergence examined. The effect of modeling lineage-specific TFBSs, as seen from the comparison between EMMA1 and EMMA2, is somewhat mixed: at lower divergence (&lt;0.3), it reduces the performance by 5–8%; at higher divergence, it improves by 3–8%. The intuition is: TFBS gain and loss will become common and thus important for the algorithms only at relatively high level of divergence. EMMA2 is consistently better than both Stubb and Morph which are based on phenomenological models (e.g. at divergence 0.8, AUC of EMMA2 is 0.95, while AUCs of Stubb and Morph are 0.87 and 0.82 respectively), suggesting the importance of correct models. Morph unexpectedly shows poorer performance than all other methods including Stubb. The underlying model of Morph is quite different from the evolutionary model used here, and it is likely that Morph will interpret any weak match to a PWM, even if not conserved, as a TFBS (often a spurious site), thus inflating the scores of all sequences and making discrimination between the two sets more difficult. Overall, the best performance is obtained by EMMA2 at moderate to high divergence levels. This, combined with the fact that in practice the divergence level for pairwise comparison often lies in this range (e.g. human-mouse divergence is estimated to be 0.6–0.8 <xref ref-type="bibr" rid="pcbi.1000299-Waterston1">[49]</xref>), justifies the use of our full model, EMMA2, for practical tasks of CRM prediction. We also repeated the same comparisons using data simulated under CisEvolver, and obtained similar conclusions (data not shown).</p>
<fig id="pcbi-1000299-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000299.g003</object-id><label>Figure 3</label><caption>
<title>AUCs of different programs for CRM classification using simulated data.</title>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000299.g003" xlink:type="simple"/></fig>
<p>In summary, we made several findings through simulation that are relevant to choosing and developing the computational tools for CRM prediction. Generally, one should use relatively divergent sequences, as long as they are alignable. The performance depends on the alignment of TFBSs, but less on the overall alignment quality, or the exact alignment parameters such as gap penalties. When the binding site turnover events are common, it is important to model the lineage specific binding sites. Finally, because of the inherent uncertainty of alignment, simultaneous inference and alignment taking advantage of the special properties of the sequences will help both tasks. All these observations support our efforts in building a comprehensive model of CRM evolution and using it as a basis for related inference tasks.</p>
</sec><sec id="s2e">
<title>EMMA Improves Detection of TFBSs in Fly Developmental CRMs</title>
<p>To test if our model truly brings benefits in real-world applications over existing programs, we start with the task of alignment, and compare our program EMMA (its full version, EMMA2) with Lagan and Morph. We study the set of blastoderm CRMs from the RedFly database <xref ref-type="bibr" rid="pcbi.1000299-Pollard1">[44]</xref> in <italic>D. melanogaster</italic> and <italic>D. pseudoobscura</italic>. Since it is not possible to know the true alignments of the real data, we follow the earlier approach <xref ref-type="bibr" rid="pcbi.1000299-Dewey1">[50]</xref> of evaluating an alignment by how often a TFBS appears to be conserved in this alignment: a correct alignment should contain more conserved TFBSs on average than an incorrect alignment. We call a TFBS conserved in an alignment if it appears as a gapless block, and both orthologous sites have binding energy above some threshold (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e070" xlink:type="simple"/></inline-formula> 0.002, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e071" xlink:type="simple"/></inline-formula> is defined through a standard likelihood ratio score <xref ref-type="bibr" rid="pcbi.1000299-Moses2">[13]</xref>,<xref ref-type="bibr" rid="pcbi.1000299-Stormo1">[51]</xref>).</p>
<p>In our first experiment, we use the known TFBSs <xref ref-type="bibr" rid="pcbi.1000299-Bergman1">[52]</xref> of seven motifs important in the blastoderm stage of development. Among the total of 188 known sites in 65 CRMs, 80 are conserved in the Lagan alignment, while 91 and 103 are conserved in EMMA and Morph alignments, respectively. We further manually examined some sequences on which the alignment programs disagree and show one such example in <xref ref-type="fig" rid="pcbi-1000299-g004">Figure 4</xref>. Three patterns of possible mis-alignment are revealed in Lagan alignment. For the first Hb site, the orthologous site is shifted by two nucleotides likely because the Hb motif has a repeat structure (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e072" xlink:type="simple"/></inline-formula> in its consensus sequence). For two Bcd sites in the middle row, the nucleotides at the boundaries are not aligned. In particular for the first one, the gap in <italic>D. melanogaster</italic> can be moved by one position without changing the Lagan score, suggesting that arbitrary resolution of ambiguous alignments can contribute to small-scale alignment errors that may be important for binding sites. Finally, the last Bcd site in <italic>D. melanogaster</italic> is close to, but does not align to a potentially orthologous Bcd site in <italic>D. pseudoobscura</italic>. In EMMA alignment, all four sites in <italic>D. melanogaster</italic> are aligned with their functional orthologs in <italic>D. pseudoobscura</italic>.</p>
<fig id="pcbi-1000299-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000299.g004</object-id><label>Figure 4</label><caption>
<title><italic>D. melanogaster</italic>-<italic>D. pseudoobscura</italic> alignment of part of the CRM, “hb anterior activator”.</title>
<p>Shown in the <italic>D. melanogaster</italic> sequence (top) are the FlyReg sites of Bcd and Hb, and shown in the <italic>D.pseudoobscura</italic> sequence are the predicted sites in this region. (A) Lagan; (B) EMMA.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000299.g004" xlink:type="simple"/></fig>
<p>We next use predicted sites for further evaluation, since the number of known TFBSs is small. For each of the seven motifs, we constructed alignments with Lagan, EMMA and Morph, using only one motif a time. The results were evaluated by the number of predicted sites (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e073" xlink:type="simple"/></inline-formula> 0.002) that appear conserved in the alignments. The results are shown in <xref ref-type="table" rid="pcbi-1000299-t001">Table 1</xref>. Similar to what we have found above, the number of conserved sites under EMMA is significantly higher than that under Lagan, for all motifs but Kni and Tll. The performance of Morph is intermediate between EMMA and Lagan.</p>
<table-wrap id="pcbi-1000299-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000299.t001</object-id><label>Table 1</label><caption>
<title>Number of predicted TFBSs in blastoderm CRMs that are conserved in different alignments.</title>
</caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1000299-t001-1" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000299.t001" xlink:type="simple"/><table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" colspan="1" rowspan="1">TF</td>
<td align="left" colspan="1" rowspan="1">Bcd</td>
<td align="left" colspan="1" rowspan="1">Cad</td>
<td align="left" colspan="1" rowspan="1">Gt</td>
<td align="left" colspan="1" rowspan="1">Hb</td>
<td align="left" colspan="1" rowspan="1">Kni</td>
<td align="left" colspan="1" rowspan="1">Kr</td>
<td align="left" colspan="1" rowspan="1">Tll</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" colspan="1" rowspan="1">Total</td>
<td align="left" colspan="1" rowspan="1">319</td>
<td align="left" colspan="1" rowspan="1">412</td>
<td align="left" colspan="1" rowspan="1">432</td>
<td align="left" colspan="1" rowspan="1">664</td>
<td align="left" colspan="1" rowspan="1">293</td>
<td align="left" colspan="1" rowspan="1">313</td>
<td align="left" colspan="1" rowspan="1">257</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">Lagan</td>
<td align="left" colspan="1" rowspan="1">140</td>
<td align="left" colspan="1" rowspan="1">132</td>
<td align="left" colspan="1" rowspan="1">102</td>
<td align="left" colspan="1" rowspan="1">192</td>
<td align="left" colspan="1" rowspan="1">68</td>
<td align="left" colspan="1" rowspan="1">100</td>
<td align="left" colspan="1" rowspan="1">111</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">EMMA</td>
<td align="left" colspan="1" rowspan="1">166</td>
<td align="left" colspan="1" rowspan="1">152</td>
<td align="left" colspan="1" rowspan="1">117</td>
<td align="left" colspan="1" rowspan="1">244</td>
<td align="left" colspan="1" rowspan="1">70</td>
<td align="left" colspan="1" rowspan="1">126</td>
<td align="left" colspan="1" rowspan="1">115</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">Morph</td>
<td align="left" colspan="1" rowspan="1">154</td>
<td align="left" colspan="1" rowspan="1">140</td>
<td align="left" colspan="1" rowspan="1">111</td>
<td align="left" colspan="1" rowspan="1">220</td>
<td align="left" colspan="1" rowspan="1">69</td>
<td align="left" colspan="1" rowspan="1">112</td>
<td align="left" colspan="1" rowspan="1">112</td>
</tr>
</tbody>
</table></alternatives><table-wrap-foot><fn id="nt101"><label/><p>The “Total” row shows the total number of predicted TFBSs in <italic>D. melanogaster</italic>.</p></fn></table-wrap-foot></table-wrap>
<p>Though our alignment evaluation is not perfect, all the evidence taken together strongly suggests that by utilizing the knowledge of binding motifs, EMMA can significantly improve detection of TFBSs over general purpose tools by overcoming the alignment problems such as arbitrary gap placement. Morph can also improve TFBS detection, but because lineage-specific TFBSs have to be gap-aligned, Morph results do not capture the true evolutionary history of orthologous sequences.</p>
</sec><sec id="s2f">
<title>EMMA Improves Prediction of Regulatory Targets of Fly TFs</title>
<p>In this experiment, we tested different programs for predicting regulatory target sequences of a given TF. Each program was made to score test sequences with a single known PWM. We did not follow the previous procedure <xref ref-type="bibr" rid="pcbi.1000299-Sinha1">[3]</xref>,<xref ref-type="bibr" rid="pcbi.1000299-Wong2">[15]</xref> of classifying CRM and non-CRM sequences based on sets of known motifs, because we believe that our setting will make the task more challenging and thus make it easier to see the differences of various methods. Furthermore, this experimental setting is particularly relevant to the problem of reconstructing transcriptional regulatory networks, since knowing regulatory relations is often the goal, rather than knowing whether a sequence is a CRM <italic>per se</italic> <xref ref-type="bibr" rid="pcbi.1000299-Aerts1">[53]</xref>. In addition to EMMA, Stubb and Morph, we tested Cluster-Buster, a popular CRM finding program <xref ref-type="bibr" rid="pcbi.1000299-Frith2">[54]</xref>. Cluster-Buster uses a HMM to search for binding site clusters in a given sequence and may therefore be used to discover such clusters for individual TFs. Unlike other methods we are testing, Cluster-Buster does not directly use information in orthologous sequences. For each of the seven blastoderm TFs, we constructed a positive set of sequences: those that contain at least one known binding site of this TF in FlyReg; and we used a common set of random noncoding sequences as the negative set. Again, the <italic>D. melanogaster</italic>-<italic>D. pseudoobscura</italic> comparison is used for this experiment. Our evaluation is based on, first, the same AUC measure used for synthetic data; and second, the average sensitivity of programs at high specificity levels. The latter measure is more relevant in practice than AUC because the score threshold is typically chosen to reduce false positive rate to a satisfiable level.</p>
<p>EMMA substantially outperforms all other three programs with the AUC measure (<xref ref-type="fig" rid="pcbi-1000299-g005">Figure 5A</xref>). Averaging over seven TFs, the improvements of EMMA over Cluster-Buster, Stubb, Morph are 9%, 9% and 17% respectively. Measured by the average sensitivity corresponding to the specificity levels above 80% (<xref ref-type="fig" rid="pcbi-1000299-g005">Figure 5B</xref>), the improvements of EMMA are even more convincing: 15%, 21%, 42%, over the three programs respectively. These results support the key ideas of EMMA: dealing with uncertainty of alignment and explicit modeling TFBS evolution will greatly assist the prediction of regulatory sequences. Interestingly, even though Cluster-Buster uses only sequences in <italic>D. melanogaster</italic>, it is comparable to or even better in some cases than Stubb and Morph, which are based on somewhat similar HMM models and use extra information in the orthologous sequences. Since unlike Cluster-Buster, neither Stubb nor Morph applies a threshold for determining a TFBS, it is likely that they are more sensitive to false positive sites. The problem seems particular serious for Morph because Morph allows a site to be emitted from only one sequence and thus may be overly tolerant to lineage-specific sites matching a PWM (also likely false positive sites). We also note that the experimental setting in this paper is different from the one in <xref ref-type="bibr" rid="pcbi.1000299-Sinha2">[20]</xref>, where multiple motifs are used simultaneously to classify a sequence. In that setting where there is more motif information and the relative importance of conservation may be reduced, the ability of Morph to score non-conserved weak sites may become an advantage.</p>
<fig id="pcbi-1000299-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000299.g005</object-id><label>Figure 5</label><caption>
<title>Performances of different programs for predicting regulatory targets of seven blastoderm TFs using <italic>D. melanogaster</italic>-<italic>D. pseudoobscura</italic> comparison.</title>
<p>CBust: Cluster-Buster. (A) AUC of the ROC curve; (B) the average sensitivity at the specificity level above 80%.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000299.g005" xlink:type="simple"/></fig>
<p>One common procedure to enhance the performance of a program running on single-species data, such as Cluster-Buster, is to filter out the sequences that are not very conserved before running the program. We combined this conservation filtering (percent identity greater than 70%, other values of threshold gave similar or worse results) with Cluster-Buster. However, the new results are only slightly better than the original Cluster-Buster, and still lag far behind EMMA (data not shown). This can be probably explained by the fact that a large fraction of <italic>Drosophila</italic> genome is under constraint <xref ref-type="bibr" rid="pcbi.1000299-Andolfatto1">[55]</xref>,<xref ref-type="bibr" rid="pcbi.1000299-Bergman2">[56]</xref>,<xref ref-type="bibr" rid="pcbi.1000299-Halligan1">[57]</xref>, thus simple conservation measure is not very discriminative of CRM sequences. To test if our results are robust to PWMs, we also repeated the same experiment with PWMs of the same TFs obtained from bacterial one-hybrid experiments <xref ref-type="bibr" rid="pcbi.1000299-Noyes1">[58]</xref> and found similar trends (<xref ref-type="supplementary-material" rid="pcbi.1000299.s003">Figure S3</xref>).</p>
</sec><sec id="s2g">
<title>Binding Site Conservation in Sequences Bound by Key Transcription Factors in the <italic>Drosophila</italic> Blastoderm</title>
<p>In this experiment, we used EMMA to study the evolutionary pattern of TFBSs in sequences involved in gene regulation in blastoderm-stage development of <italic>Drosophila melanogaster</italic>. Such analysis depends on the accurate alignment of TFBSs, a task that EMMA has been shown to perform better than general purpose sequence alignment tools. We took the sequences bound by each transcription factor (except Gt and Kni, see <xref ref-type="sec" rid="s4">Materials and Methods</xref>), as per ChIP-chip assays in Li et al. <xref ref-type="bibr" rid="pcbi.1000299-Li2">[32]</xref>. As a “negative control”, we took the intronic sequences that were not bound by the corresponding TFs. These control sequences are presumably neutral or close to neutral <xref ref-type="bibr" rid="pcbi.1000299-Li2">[32]</xref>. Each “bound sequence” was associated with its nearest gene. We grouped sequences based on whether their associated genes are expressed in the blastoderm or not. (The expression information was obtained from Berkeley Drosophila Genome Project (BDGP) <xref ref-type="bibr" rid="pcbi.1000299-Tomancak1">[59]</xref>). The two groups were compared based on the level of conservation of predicted binding sites, defined as the percentage of binding sites in <italic>D. melanogaster</italic> that are conserved in <italic>D. pseudoobscura</italic>. We expect that the sequences in the expressed group are more conserved than those in the non-expressed group, because binding in the latter group is much more likely to be non-functional. Contrary to our expectation, the non-expressed group appears to be have slightly more binding site conservation than the expressed group (<xref ref-type="fig" rid="pcbi-1000299-g006">Figure 6A</xref>), though the difference is not significant (data not shown). Compared with the control sequences, sequences in both groups have much greater binding site conservation, suggesting functional constraint. We next compared the bound sequences that are proximal to TSS (defined as less than 2 kb distant) and those that are distal (defined as greater than 10 kb). Our expectation is that the proximal sequences overall are more functionally important than the distal sequences, as suggested by others <xref ref-type="bibr" rid="pcbi.1000299-Berman1">[2]</xref>,<xref ref-type="bibr" rid="pcbi.1000299-Wray2">[35]</xref>, and have more conserved binding sites. The results, however, show the opposite pattern (<xref ref-type="fig" rid="pcbi-1000299-g006">Figure 6B</xref>): binding sites in distal sequences tend to be more conserved than those in the proximal ones, and the differences are statistically significant (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e074" xlink:type="simple"/></inline-formula> value &lt;10<sup>−4</sup> for Bcd, Cad, Hb, and &lt;0.005 for Kr, by hypergeometric test).</p>
<fig id="pcbi-1000299-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000299.g006</object-id><label>Figure 6</label><caption>
<title>Conservation of predicted binding sites in regions bound by TFs in the <italic>Drosophila</italic> blastoderm.</title>
<p>(A) Expressed/Unexpressed: sequences that are associated with genes that are expressed/unexpressed in stage 4–6 according to BDGP; Unbound: randomly chosen intronic sequences. (B) Proximal: sequences that are less than 2 kb from the TSS of the associated genes; Distal: sequences that are more than 10 kb from the TSS of the associated genes.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000299.g006" xlink:type="simple"/></fig></sec></sec><sec id="s3">
<title>Discussion</title>
<p>We have proposed an integrative framework for cross-species analysis of <italic>cis</italic>-regulatory sequences. At the heart of our approach is a probabilistic model covering important aspects of CRM evolution, including substitutions and indels in background sequences, and constraints and turnover of TFBSs. The dynamic programming algorithm allows us to efficiently carry out likelihood-based statistical inference. This framework solves the problems of the existing approaches discussed earlier. It aligns regulatory sequences by taking advantage of the tendency of conservation of TFBSs. The TFBS gain and loss model allows us to use information present in lineage-specific TFBSs. Most importantly, when used for predicting CRMs, our method treats alignment and annotation of TFBSs as random variables, summing over them and thus minimizing the impact of an uncertain alignment and TFBS annotation. Our previous programs Stubb and Morph have similar aims, but as shown in our experiments, EMMA significantly outperforms both, strongly suggesting that correct evolutionary modeling is essential to fully utilize the sequence information.</p>
<p>Our model is related to existing models of regulatory sequence evolution, but different from them in several key aspects. Our idea of generation of a new binding site is similar to <xref ref-type="bibr" rid="pcbi.1000299-MacArthur1">[27]</xref>,<xref ref-type="bibr" rid="pcbi.1000299-Stone1">[31]</xref>, but their work is limited to simulation studies. Lassig and colleagues <xref ref-type="bibr" rid="pcbi.1000299-Berg1">[25]</xref>,<xref ref-type="bibr" rid="pcbi.1000299-Mustonen1">[28]</xref> have developed population genetic models where a binding site evolves under a fitness function that depends on the edit distance (to the consensus site) or the energy of the site. Their models are the most detailed and perhaps realistic existing models of binding site evolution; however, they cannot be easily used for computational inference since likelihood computation under these models is very expensive (see below). Mustonen and Lassig <xref ref-type="bibr" rid="pcbi.1000299-Mustonen1">[28]</xref> also proposed ways to model the gain and loss events of TFBSs, but their model is different from ours in that these events are caused by external selection forces, whose rates of occurrences are independent of the actual sequences. A similar model of TFBS turnover has been used to discover lineage-specific TFBSs <xref ref-type="bibr" rid="pcbi.1000299-Ray1">[30]</xref>, where the gain and loss of binding sites are modeled by a two-state Markov chain, similar to the Jukes-Cantor model of nucleotide evolution. Again, the rates of change between functional and neutral sites are external parameters that do not depend on the sequences themselves. Durrett and Schmidt <xref ref-type="bibr" rid="pcbi.1000299-Durrett1">[26]</xref> studied binding site evolution from the perspective of time needed for a specific word to appear and be fixed in a population, according to population genetic models of mutation and drift. Their study assumes neutral evolution and points out that selective forces will take over if the specific word thus evolved is close to being a binding site; this is the view we have adopted in modeling binding site gain. Recently, Raijman et al. <xref ref-type="bibr" rid="pcbi.1000299-Raijman1">[29]</xref> developed a model of CRM evolution, based on the idea that any mutation that creates a new TFBS or destroys an existing one is penalized, i.e., fixed with a smaller probability. Their representation of TFBSs is based on the consensus sequence, instead of the more realistic PWM. Their treatment of TFBS gain is also different from ours: the possibility of TFBS gain from adaptive selection <xref ref-type="bibr" rid="pcbi.1000299-Moses2">[13]</xref> is missing in their model, where all occurrences of new TFBSs will be selected against. Finally, we note that none of the above models integrates the binding site evolution model with the model of insertions and deletions, a feature that is essential to simultaneous alignment and regulatory sequence inference.</p>
<p>Our model is also an extension of statistical alignment (reviewed in <xref ref-type="bibr" rid="pcbi.1000299-Lunter1">[22]</xref>) to the analysis of <italic>cis</italic>-regulatory sequences. Our method shares key features with statistical alignment: explicit modeling of indel evolution; and a probabilistic treatment of alignment uncertainty. Statistical alignment started with the pioneering work of Thorne et al. on pairwise sequence alignment <xref ref-type="bibr" rid="pcbi.1000299-Thorne1">[10]</xref>, commonly named TKF91 model, where insertions and deletions were treated as single nucleotide events. It was later extended to more realistic indel models, where the indels were treated as multi-nucleotide blocks that followed a geometric length distribution, emulating the commonly used affine gap penalty <xref ref-type="bibr" rid="pcbi.1000299-Thorne2">[23]</xref>,<xref ref-type="bibr" rid="pcbi.1000299-Knudsen1">[37]</xref>,<xref ref-type="bibr" rid="pcbi.1000299-Miklos1">[60]</xref>, or an arbitrary length distribution estimated empirically <xref ref-type="bibr" rid="pcbi.1000299-Keightley1">[61]</xref>. In other work, the TFK91 model has been applied to multiple alignment, and an MCMC approach developed to sample alignment from a phylogenetic tree <xref ref-type="bibr" rid="pcbi.1000299-Holmes1">[62]</xref>. To make the evolutionary model more realistic, some researchers have attempted to capture the heterogeneity of substitution and indel rates and used it to infer slowly-evolving DNA sequences <xref ref-type="bibr" rid="pcbi.1000299-Satija1">[21]</xref>,<xref ref-type="bibr" rid="pcbi.1000299-Thorne2">[23]</xref>,<xref ref-type="bibr" rid="pcbi.1000299-Lunter3">[63]</xref>. More recently, the “transducer” model has provided a computational framework for multiple alignment, using TKF91 and other indel models <xref ref-type="bibr" rid="pcbi.1000299-Holmes2">[64]</xref>,<xref ref-type="bibr" rid="pcbi.1000299-Holmes3">[65]</xref>. Our work, especially its alignment functionality, belonging to the category of statistical alignment; however, it is designed specifically for the alignment of <italic>cis</italic>-regulatory modules. Thus the modeling of substitution and indels, the characteristic feature of statistical alignment, has to be integrated with a model-based treatment of binding site evolution.</p>
<p>One main limitation of our model is that under Halpern-Bruno model, the nucleotides of a TFBS evolve independently while in reality, the TFBS as a whole should be a unit for natural selection <xref ref-type="bibr" rid="pcbi.1000299-Mustonen1">[28]</xref>. Also, our model of TFBS gain and loss does not parameterize the fitness function of a TFBS, which will be required for correct modeling based on principles of population genetics<xref ref-type="bibr" rid="pcbi.1000299-Mustonen1">[28]</xref>,<xref ref-type="bibr" rid="pcbi.1000299-Halpern1">[39]</xref>. So our model can be viewed only as an approximation. Our model choice was based on: (i) avoidance of additional free parameters, which will be difficult to estimate given only an individual CRM sequence; (ii) computational complexity, since modeling a TFBS as a unit is very expensive <xref ref-type="bibr" rid="pcbi.1000299-Mustonen1">[28]</xref>,<xref ref-type="bibr" rid="pcbi.1000299-Raijman1">[29]</xref>. One consequence of our simplifications is: any new site created by evolution of background sequences will be selected afterward. A better model should reflect the variability of the rate of TFBS gain in different CRM sequences. Despite these simplifications, we found through simulation that the gain and loss rates under our model with a realistic parameter setting agreed broadly with the empirically estimated values in <italic>Drosophila</italic> <xref ref-type="bibr" rid="pcbi.1000299-Moses2">[13]</xref>,<xref ref-type="bibr" rid="pcbi.1000299-Dermitzakis1">[66]</xref> (data not shown).</p>
<p>The relationship between TF binding and target gene expression is an important, but not straightforward, issue. Earlier studies suggested a high level of non-functional binding in ChIP-chip experiments. Gao et al. estimated that more than 40% TF binding are not functional, based on the correlation of binding and mRNA expression <xref ref-type="bibr" rid="pcbi.1000299-Gao1">[33]</xref>. More recently, Hu et al. found that only a small percentage of genes whose promoters bind to some TF changed expression level when that TF was knocked out in yeast <xref ref-type="bibr" rid="pcbi.1000299-Hu1">[34]</xref>. Our analysis based on binding site conservation provides a new way of studying binding-expression relationship. We find that sequences whose associated genes are not expressed, and thus most likely non-functional, are at least as conserved as the sequences close to expressed genes. This suggests that the extent of non-functional binding may be very low, at least when we restrict ourselves to strong binding events (1% FDR). This immediately raises the following question: if strong binding sites near non-expressed genes are indeed functional (as their evolutionary conservation would reveal), what is this function? We speculate several answers. The function of these sites may be to control expression of more distant genes. (Recall that we annotated only the nearest gene as being the target of each site.) Alternatively, these sites may not directly activate or inactive expression, rather, they help attract TF molecules to DNA, and thus help direct the TF molecules to their true target sequences. Another possibility is that these sites function in regulating the nearby gene in a different developmental stage (i.e., not in blastoderm).</p>
<p>Very little is known about the difference between proximal and distal regulatory sequences. It is likely that the two types of sequences work through different mechanisms (for example, the distal sequences may need specific mechanisms such as DNA looping, to communicate with the core promoter sequences of the target genes <xref ref-type="bibr" rid="pcbi.1000299-Blackwood1">[67]</xref>) and that they play different functional roles, as hypothesized by <xref ref-type="bibr" rid="pcbi.1000299-Wray2">[35]</xref>. Our results suggest that binding sites are more conserved in the distal regions than in proximal regions. One possible explanation is that the proximal sequences are under more adaptive selection than distal sequences, perhaps because it is easier to achieve a different expression pattern by changing the binding sites in the proximal sequences. This increased adaptive selection has been demonstrated in <italic>Drosophila</italic> in 5′ UTR sequences <xref ref-type="bibr" rid="pcbi.1000299-Andolfatto1">[55]</xref>. Another possibility is that because it is more difficult for distal regulatory sequences to target the promoters, they will be more sensitive to minor changes of binding sites, and thus will be more evolutionarily constrained.</p>
<p>We believe that our proposed framework opens up possibilities for a few major applications. The immediate task is to extend the current work to comparison of more than two species. In pairwise comparison, a TFBS is either conserved or not and it is difficult to distinguish a non-conserved but functional TFBS from a spurious site. In the case of multi-species comparison, there is a wide spectrum of partial conservation, which could be effectively used by a program, as shown in earlier studies <xref ref-type="bibr" rid="pcbi.1000299-Kheradpour1">[68]</xref>. We therefore anticipate that our improved evolutionary model and methods will make a crucial difference to the accuracy of multi-species analysis. Our method takes a set of TF motifs as input; however, which TFs may cooperate while binding is often unknown. Our framework itself offers a way of learning such regulatory rules: the probability of sequences under different TF combinations could suggest how well a particular combination explains the data. Finally, it is possible to learn motifs <italic>de novo</italic> by treating PWMs as unknown parameters. This approach to motif finding will introduce several benefits over existing programs, e.g., PhyloGibbs <xref ref-type="bibr" rid="pcbi.1000299-Siddharthan1">[6]</xref>, such as correcting the alignment errors and using information in partially-conserved TFBSs.</p>
</sec><sec id="s4">
<title>Materials and Methods</title>
<sec id="s4a">
<title>Dynamic Programming Algorithm</title>
<p>We use <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e075" xlink:type="simple"/></inline-formula> to denote the background evolutionary model (both substitutions and indels), and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e076" xlink:type="simple"/></inline-formula> for the evolutionary model for binding sites of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e077" xlink:type="simple"/></inline-formula> TF (HB model for substitution and reduced indel rate <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e078" xlink:type="simple"/></inline-formula>). The joint probability of the orthologous sites <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e079" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e080" xlink:type="simple"/></inline-formula> under a model <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e081" xlink:type="simple"/></inline-formula> (background or TFBS) is represented as: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e082" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e083" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e084" xlink:type="simple"/></inline-formula> are branch lengths of the 2 sequences. In the case of TFBS gain or loss, the probability of a functional site of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e085" xlink:type="simple"/></inline-formula> TF being present in the first sequence but not in the second one is denoted by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e086" xlink:type="simple"/></inline-formula>; similarly we use <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e087" xlink:type="simple"/></inline-formula> for the opposite case.</p>
<p>For a pair of sequences <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e088" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e089" xlink:type="simple"/></inline-formula>, we wish to compute the joint probability of the two sequences under the CRM evolutionary model, given the parameters. We define the recurrence variables for dynamic programming as: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e090" xlink:type="simple"/></inline-formula>, the probability of sub-sequences <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e091" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e092" xlink:type="simple"/></inline-formula> where the last site is either <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e093" xlink:type="simple"/></inline-formula> TFBS (if <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e094" xlink:type="simple"/></inline-formula>) or background (if <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e095" xlink:type="simple"/></inline-formula>) with the “state variable” <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e096" xlink:type="simple"/></inline-formula> as explained below and in <xref ref-type="fig" rid="pcbi-1000299-g007">Figure 7</xref>. We then define:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e097" xlink:type="simple"/><label>(4)</label></disp-formula><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e098" xlink:type="simple"/><label>(5)</label></disp-formula>Then the probability of the sequences is <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e099" xlink:type="simple"/></inline-formula> where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e100" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e101" xlink:type="simple"/></inline-formula> are their respective lengths. In the first case in <xref ref-type="fig" rid="pcbi-1000299-g007">Figure 7</xref>, the last site of the sequence <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e102" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e103" xlink:type="simple"/></inline-formula> is a matched background column:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e104" xlink:type="simple"/><label>(6)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e105" xlink:type="simple"/></inline-formula>. In the second case, the last column is a gap in the second sequence. If the previous column is also a gap, this should be treated as extension of an existing indel, otherwise as a new indel:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e106" xlink:type="simple"/><label>(7)</label></disp-formula>The third case, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e107" xlink:type="simple"/></inline-formula>, is handled similarly. In the fourth case, the last sites are a conserved pair of TFBSs of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e108" xlink:type="simple"/></inline-formula> motif, whose length is <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e109" xlink:type="simple"/></inline-formula>:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e110" xlink:type="simple"/><label>(8)</label></disp-formula>In the fifth case, the last site is a <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e111" xlink:type="simple"/></inline-formula> TFBS in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e112" xlink:type="simple"/></inline-formula> but a non-site in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e113" xlink:type="simple"/></inline-formula>. Note that in this case, the length of the non-conserved site may not be <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e114" xlink:type="simple"/></inline-formula>, since there could be insertion or deletion in non-TFBS. We will denote it as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e115" xlink:type="simple"/></inline-formula>. We use <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e116" xlink:type="simple"/></inline-formula> to denote the probability that the site in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e117" xlink:type="simple"/></inline-formula> is <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e118" xlink:type="simple"/></inline-formula> TFBS, but the site in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e119" xlink:type="simple"/></inline-formula> is background with length <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e120" xlink:type="simple"/></inline-formula>, then:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e121" xlink:type="simple"/><label>(9)</label></disp-formula>To make the computation tractable, we will limit <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e122" xlink:type="simple"/></inline-formula> to the range of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e123" xlink:type="simple"/></inline-formula> for some user-specified parameter <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e124" xlink:type="simple"/></inline-formula> Thus, for the new recurrence variable, we have:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e125" xlink:type="simple"/><label>(10)</label></disp-formula>The treatment of the last case is similar. One complication is: if the orthologous sites have a gap at the beginning, it may be an extension of an existing indel. In other words, we may have multiplied the probability of an indel event twice: one during the computation of TFBS switching (the second term in Eq. 10), and the other during the computation of the earlier sequences (the first term in Eq. 10). We correct for this as described in <xref ref-type="supplementary-material" rid="pcbi.1000299.s004">Text S1</xref>.</p>
<fig id="pcbi-1000299-g007" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000299.g007</object-id><label>Figure 7</label><caption>
<title>The recurrence variables used in dynamic programming.</title>
<p>#: any of the four nucleotides; −: gap; shaded box: TFBS; open box: non-TFBS.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000299.g007" xlink:type="simple"/></fig>
<p>For alignment, we simply need to replace the sum operator in the algorithm with the max operator, as is standard in computations involving HMM. The parameters can be estimated by the standard maximum-likelihood approach. In practice, we estimate or fix some parameters, such as transition-transversion bias in HKY model, through external data. The details can be found in <xref ref-type="supplementary-material" rid="pcbi.1000299.s004">Text S1</xref>.</p>
</sec><sec id="s4b">
<title>Simulating CRM Evolution</title>
<p>For our simulation, we first sampled ancestral sequences from the CRM model described in the main text and evolved the sequences in two branches independently for specified lengths of the two branches. Only the two descendant sequences will be used for alignment input. We used PWMs of <italic>Drosophila</italic> TFs from the webpage maintained by Dan Pollard (<ext-link ext-link-type="uri" xlink:href="http://rana.lbl.gov/~dan/matrices.html" xlink:type="simple">http://rana.lbl.gov/̃dan/matrices.html</ext-link>), which are based on footprinted binding sites <xref ref-type="bibr" rid="pcbi.1000299-Bergman1">[52]</xref>. For the alignment experiment, we used Bcd, Kr and Hb with densities equal to 0.008, 0.009 and 0.005 respectively. The motif thresholds were chosen so that the expected rate of TFBS gain equals to the expected rate of loss through simulating evolution of individual TFBS. For the CRM discrimination experiment using simulated data, we used only Bcd and Hb motifs with lower densities 0.004 for both. We generated 50 pairs of sequences with ancestral sequence length equal to 500 bp at each divergence time for the alignment experiment; and 100 pairs of positive and negative sequences with the same ancestral sequence length at each divergence time for the CRM discrimination experiment. A total of 8 divergence time from 0.1 to 0.8 were sampled. For both experiments, the other parameters took values estimated from earlier studies involving <italic>Drosophila</italic> genomes. The distribution of nucleotides in the background sequences was 0.3, 0.2, 0.2 and 0.3 for A, C, G, T respectively <xref ref-type="bibr" rid="pcbi.1000299-Moses2">[13]</xref>. And from the same study, the transition-transversion bias was 2.0. For the ratio of indels vs substitutions, we used the value (0.225 ) estimated from two close <italic>Drosophila</italic> species, <italic>sechellia</italic> and <italic>simulans</italic> <xref ref-type="bibr" rid="pcbi.1000299-Keightley1">[61]</xref>, which was evenly split between insertions and deletion in simulation. The length of indels followed geometric distribution with the probability of adding one more nucleotide equal to 0.87 <xref ref-type="bibr" rid="pcbi.1000299-Bergman2">[56]</xref>. The rate of indel within TFBS relative to the rate within background sequence was 0.25, from manually inspecting the alignment of eve-stripe 2 CRM in <xref ref-type="bibr" rid="pcbi.1000299-Ludwig1">[7]</xref>.</p>
<p>For the simulation under CisEvolver, we used the same parameters except that the indel lengths are specified by their empirical frequencies <xref ref-type="bibr" rid="pcbi.1000299-Keightley1">[61]</xref> instead of approximation by the geometric distribution.</p>
</sec><sec id="s4c">
<title>Alignment Experiment in Fly Developmental CRMs</title>
<p>We took 67 <italic>D. melanogaster</italic> blastoderm CRMs from RedFly database <xref ref-type="bibr" rid="pcbi.1000299-Gallo1">[69]</xref>, and extracted their orthologous sequences in <italic>D. pseudoobscura</italic> by using the LiftOver tool from UCSC Genome Browser <xref ref-type="bibr" rid="pcbi.1000299-Karolchik1">[70]</xref>. Two CRMs without <italic>D. pseudoobscura</italic> orthologs were discarded. We used seven TFs important for early development in our analysis: Bcd, Cad, Gt, Hb, Kr, Kni and Tll and the PWMs of these TFs were taken from the same source we used for simulation. Bona fide binding sites were collected from FlyReg <xref ref-type="bibr" rid="pcbi.1000299-Bergman1">[52]</xref>, after some preprocessing: the sites in FlyReg frequently contain some sequence flanking the true binding sites, so we scanned each FlyReg site with the corresponding PWM and extracted the best match to be used as the “known” binding site for evaluation purposes, rather than the original FlyReg site.</p>
<p>In running EMMA, we set the evolutionary parameters according to the values estimated from earlier studies: divergence between the two species is about 1.5 measured by synonymous substitution (<ext-link ext-link-type="uri" xlink:href="http://rana.lbl.gov/~dan/trees.html" xlink:type="simple">http://rana.lbl.gov/̃dan/trees.html</ext-link>), since the noncoding sequences in general are under a high level of constraint (on average, the intergenic sequences evolve 50–60% more slowly than neutral ones <xref ref-type="bibr" rid="pcbi.1000299-Halligan1">[57]</xref>), we rescale the divergence to be 1.5*(1−0.6) = 0.6; the indel parameters, the transition-transversion bias and the equilibrium distribution of nucleotides are all set by the values used in simulation. All other parameters are either default or estimated from data by the program itself. Both Stubb and Morph were run under the default parameters except that the divergence was set at the same value.</p>
</sec><sec id="s4d">
<title>Experiment of Regulatory Target Prediction for <italic>Drosophila</italic> TFs</title>
<p>For each of the seven TFs, we took all RedFly CRM sequences that contain at least one FlyReg site of this TF as the set of positive sequences. Each positive sequence was expanded or truncated so that the length was 1000 bp. 500 random sequences of length 1000 bp each were chosen randomly from the <italic>D. melanogaster</italic> genome as the negative set. The orthologous sequences in <italic>D. pseudoobscura</italic> genome were extracted similarly using the LiftOver tool. EMMA was run under the same parameter setting as in the alignment experiment. Stubb was run under the same divergence value, 0.6 and Morph used the automatically estimated value of divergence (similar performance was obtained if using 0.6 as the divergence). Cluster-Buster was run under the default setting, as we do not have extra data for training parameters of Cluster-Buster.</p>
</sec><sec id="s4e">
<title>Binding Site Conservation Analysis in ChIP-Chip Data</title>
<p>The genome-wide binding data is taken from <xref ref-type="bibr" rid="pcbi.1000299-Li2">[32]</xref>. We only looked at four factors in this experiment: Bcd, Cad, Hb and Kr. Gt is ignored in this analysis because the PWM of its binding motif is not very specific, and Kni is also ignored because only 35 peaks are identified at 1% FDR level. A bound region is defined as a peak plus 250 bp flanking sequences both upstream and downstream. For the control sequences, we used an equal number of non-first introns, randomly chosen from the <italic>D. melanogaster</italic> genome. The alignment of the sequences with their orthologs in <italic>D. pseudoobscura</italic> were constructed using EMMA. The binding sites in both species were then predicted following the same procedure we used before for the experiment of evaluating alignment performance of EMMA. Similarly, we define a binding site as being conserved if both orthologous sites have scores greater than the threshold (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000299.e126" xlink:type="simple"/></inline-formula> value 0.001). To define expressed and unexpressed group, we used the annotations in BDGP of the expression patterns of genes measured by <italic>in situ</italic> hybridization (<ext-link ext-link-type="uri" xlink:href="http://www.fruitfly.org/cgi-bin/ex/insitu.pl" xlink:type="simple">http://www.fruitfly.org/cgi-bin/ex/insitu.pl</ext-link>). A sequence belongs to the expressed group, if its associated gene is classfied as being expressed in stage 4–6 according to BDGP, and similarly for the unexpressed group (using the term blastoderm instead of stage 4–6 will give similar results, but we want to be more conservative when defining the unexpressed group).</p>
</sec><sec id="s4f">
<title>Availability</title>
<p>The EMMA program, an evolution simulator, and the dataset used in this paper are all available at <ext-link ext-link-type="uri" xlink:href="http://veda.cs.uiuc.edu/emma/" xlink:type="simple">http://veda.cs.uiuc.edu/emma/</ext-link>.</p>
</sec></sec><sec id="s5">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1000299.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000299.s001" xlink:type="simple"><label>Figure S1</label><caption>
<p>A pair of orthologous sites that are functional in one species, but not the other. Two possible histories that could lead to this pattern are shown. Shaded and white box represent functional TFBS and non-functional site respectively.</p>
<p>(0.02 MB PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000299.s002" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000299.s002" xlink:type="simple"><label>Figure S2</label><caption>
<p>TFBS conservation sensitivity from various alignment programs using simulated data from CisEvolver.</p>
<p>(0.02 MB PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000299.s003" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000299.s003" xlink:type="simple"><label>Figure S3</label><caption>
<p>Performances of different programs for predicting regulatory targets of seven blastoderm TFs using B1H PWMs. CBust: Cluster-Buster. (A) AUC of the ROC curve; (B) the average sensitivity at the specificity level above 80%.</p>
<p>(0.02 MB PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000299.s004" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000299.s004" xlink:type="simple"><label>Text S1</label><caption>
<p>Methods and additional results</p>
<p>(0.07 MB PDF)</p>
</caption></supplementary-material></sec></body>
<back>
<ack>
<p>We are thankful to Sheng Zhong for helpful discussions when this project was started and anonymous reviewers for their constructive comments.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1000299-Davidson1"><label>1</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Davidson</surname><given-names>E</given-names></name>
</person-group>             <year>2006</year>             <source>The Regulatory Genome: Gene Regulatory Networks in Development and Evolution</source>             <publisher-loc>San Diego (California)</publisher-loc>             <publisher-name>Academic Press/Elsevier</publisher-name>          </element-citation></ref>
<ref id="pcbi.1000299-Berman1"><label>2</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Berman</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Pfeiffer</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Laverty</surname><given-names>T</given-names></name>
<name name-style="western"><surname>Salzberg</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Rubin</surname><given-names>G</given-names></name>
<etal/></person-group>             <year>2004</year>             <article-title>Computational identification of developmental enhancers: conservation and function of transcription factor binding-site clusters in Drosophila melanogaster and Drosophila pseudoobscura.</article-title>             <source>Genome Biol</source>             <volume>5</volume>             <fpage>R61</fpage>          </element-citation></ref>
<ref id="pcbi.1000299-Sinha1"><label>3</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Sinha</surname><given-names>S</given-names></name>
<name name-style="western"><surname>van Nimwegen</surname><given-names>E</given-names></name>
<name name-style="western"><surname>Siggia</surname><given-names>E</given-names></name>
</person-group>             <year>2003</year>             <article-title>A probabilistic method to detect regulatory modules.</article-title>             <source>Bioinformatics</source>             <volume>19</volume>             <fpage>i292</fpage>             <lpage>i301</lpage>          </element-citation></ref>
<ref id="pcbi.1000299-Wasserman1"><label>4</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Wasserman</surname><given-names>W</given-names></name>
<name name-style="western"><surname>Palumbo</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Thompson</surname><given-names>W</given-names></name>
<name name-style="western"><surname>Fickett</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Lawrence</surname><given-names>C</given-names></name>
</person-group>             <year>2000</year>             <article-title>Human-mouse genome comparisons to locate regulatory sites.</article-title>             <source>Nat Genet</source>             <volume>26</volume>             <fpage>225</fpage>             <lpage>228</lpage>          </element-citation></ref>
<ref id="pcbi.1000299-Li1"><label>5</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Li</surname><given-names>X</given-names></name>
<name name-style="western"><surname>Wong</surname><given-names>W</given-names></name>
</person-group>             <year>2005</year>             <article-title>Sampling motifs on phylogenetic trees.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>102</volume>             <fpage>9481</fpage>             <lpage>9486</lpage>          </element-citation></ref>
<ref id="pcbi.1000299-Siddharthan1"><label>6</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Siddharthan</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Siggia</surname><given-names>E</given-names></name>
<name name-style="western"><surname>van Nimwegen</surname><given-names>E</given-names></name>
</person-group>             <year>2005</year>             <article-title>PhyloGibbs: a Gibbs sampling motif finder that incorporates phylogeny.</article-title>             <source>PLoS Comput Biol</source>             <volume>1</volume>             <fpage>e67</fpage>             <comment>doi:10.1371/journal.pcbi.0010067</comment>          </element-citation></ref>
<ref id="pcbi.1000299-Ludwig1"><label>7</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Ludwig</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Patel</surname><given-names>N</given-names></name>
<name name-style="western"><surname>Kreitman</surname><given-names>M</given-names></name>
</person-group>             <year>1998</year>             <article-title>Functional analysis of eve stripe 2 enhancer evolution in Drosophila: rules governing conservation and change.</article-title>             <source>Development</source>             <volume>125</volume>             <fpage>949</fpage>             <lpage>958</lpage>          </element-citation></ref>
<ref id="pcbi.1000299-Wong1"><label>8</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Wong</surname><given-names>K</given-names></name>
<name name-style="western"><surname>Suchard</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Huelsenbeck</surname><given-names>J</given-names></name>
</person-group>             <year>2008</year>             <article-title>Alignment uncertainty and genomic analysis.</article-title>             <source>Science</source>             <volume>319</volume>             <fpage>473</fpage>             <lpage>476</lpage>          </element-citation></ref>
<ref id="pcbi.1000299-Siepel1"><label>9</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Siepel</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Haussler</surname><given-names>D</given-names></name>
</person-group>             <year>2004</year>             <article-title>Combining phylogenetic and hidden Markov models in biosequence analysis.</article-title>             <source>J Comput Biol</source>             <volume>11</volume>             <fpage>413</fpage>             <lpage>428</lpage>          </element-citation></ref>
<ref id="pcbi.1000299-Thorne1"><label>10</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Thorne</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Kishino</surname><given-names>H</given-names></name>
<name name-style="western"><surname>Felsenstein</surname><given-names>J</given-names></name>
</person-group>             <year>1991</year>             <article-title>An evolutionary model for maximum likelihood alignment of DNA sequences.</article-title>             <source>J Mol Evol</source>             <volume>33</volume>             <fpage>114</fpage>             <lpage>124</lpage>          </element-citation></ref>
<ref id="pcbi.1000299-Moses1"><label>11</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Moses</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Chiang</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Pollard</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Iyer</surname><given-names>V</given-names></name>
<name name-style="western"><surname>Eisen</surname><given-names>M</given-names></name>
</person-group>             <year>2004</year>             <article-title>MONKEY: identifying conserved transcription-factor binding sites in multiple alignments using a binding site-specific evolutionary model.</article-title>             <source>Genome Biol</source>             <volume>5</volume>             <fpage>R98</fpage>          </element-citation></ref>
<ref id="pcbi.1000299-Birney1"><label>12</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Birney</surname><given-names>E</given-names></name>
<name name-style="western"><surname>Stamatoyannopoulos</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Dutta</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Guigo</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Gingeras</surname><given-names>T</given-names></name>
<etal/></person-group>             <year>2007</year>             <article-title>Identification and analysis of functional elements in 1% of the human genome by the ENCODE pilot project.</article-title>             <source>Nature</source>             <volume>447</volume>             <fpage>799</fpage>             <lpage>816</lpage>          </element-citation></ref>
<ref id="pcbi.1000299-Moses2"><label>13</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Moses</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Pollard</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Nix</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Iyer</surname><given-names>V</given-names></name>
<name name-style="western"><surname>Li</surname><given-names>X</given-names></name>
<etal/></person-group>             <year>2006</year>             <article-title>Large-scale turnover of functional transcription factor binding sites in Drosophila.</article-title>             <source>PLoS Comput Biol</source>             <volume>2</volume>             <fpage>e130</fpage>             <comment>doi:10.1371/journal.pcbi.0020130</comment>          </element-citation></ref>
<ref id="pcbi.1000299-Wray1"><label>14</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Wray</surname><given-names>G</given-names></name>
</person-group>             <year>2007</year>             <article-title>The evolutionary significance of cis-regulatory mutations.</article-title>             <source>Nat Rev Genet</source>             <volume>8</volume>             <fpage>206</fpage>             <lpage>216</lpage>          </element-citation></ref>
<ref id="pcbi.1000299-Wong2"><label>15</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Wong</surname><given-names>W</given-names></name>
<name name-style="western"><surname>Nielsen</surname><given-names>R</given-names></name>
</person-group>             <year>2007</year>             <article-title>Finding cis-regulatory modules in Drosophila using phylogenetic hidden Markov models.</article-title>             <source>Bioinformatics</source>             <volume>23</volume>             <fpage>2031</fpage>             <lpage>2037</lpage>          </element-citation></ref>
<ref id="pcbi.1000299-Warner1"><label>16</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Warner</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Philippakis</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Jaeger</surname><given-names>S</given-names></name>
<name name-style="western"><surname>He</surname><given-names>F</given-names></name>
<name name-style="western"><surname>Lin</surname><given-names>J</given-names></name>
<etal/></person-group>             <year>2008</year>             <article-title>Systematic identification of mammalian regulatory motifs' target genes and functions.</article-title>             <source>Nat Methods</source>             <volume>5</volume>             <fpage>347</fpage>             <lpage>353</lpage>          </element-citation></ref>
<ref id="pcbi.1000299-Berezikov1"><label>17</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Berezikov</surname><given-names>E</given-names></name>
<name name-style="western"><surname>Guryev</surname><given-names>V</given-names></name>
<name name-style="western"><surname>Plasterk</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Cuppen</surname><given-names>E</given-names></name>
</person-group>             <year>2004</year>             <article-title>CONREAL: conserved regulatory elements anchored alignment algorithm for identification of transcription factor binding sites by phylogenetic footprinting.</article-title>             <source>Genome Res</source>             <volume>14</volume>             <fpage>170</fpage>             <lpage>178</lpage>          </element-citation></ref>
<ref id="pcbi.1000299-Hallikas1"><label>18</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Hallikas</surname><given-names>O</given-names></name>
<name name-style="western"><surname>Palin</surname><given-names>K</given-names></name>
<name name-style="western"><surname>Sinjushina</surname><given-names>N</given-names></name>
<name name-style="western"><surname>Rautiainen</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Partanen</surname><given-names>J</given-names></name>
<etal/></person-group>             <year>2006</year>             <article-title>Genome-wide prediction of mammalian enhancers based on analysis of transcription-factor binding affinity.</article-title>             <source>Cell</source>             <volume>124</volume>             <fpage>47</fpage>             <lpage>59</lpage>          </element-citation></ref>
<ref id="pcbi.1000299-Bais1"><label>19</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Bais</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Grossmann</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Vingron</surname><given-names>M</given-names></name>
</person-group>             <year>2007</year>             <article-title>Simultaneous alignment and annotation of cisregulatory regions.</article-title>             <source>Bioinformatics</source>             <volume>23</volume>             <fpage>e44</fpage>             <lpage>e49</lpage>          </element-citation></ref>
<ref id="pcbi.1000299-Sinha2"><label>20</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Sinha</surname><given-names>S</given-names></name>
<name name-style="western"><surname>He</surname><given-names>X</given-names></name>
</person-group>             <year>2007</year>             <article-title>MORPH: probabilistic alignment combined with hidden Markov models of cis-regulatory modules.</article-title>             <source>PLoS Comput Biol</source>             <volume>3</volume>             <fpage>e216</fpage>             <comment>doi:10.1371/journal.pcbi.0030216</comment>          </element-citation></ref>
<ref id="pcbi.1000299-Satija1"><label>21</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Satija</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Pachter</surname><given-names>L</given-names></name>
<name name-style="western"><surname>Hein</surname><given-names>J</given-names></name>
</person-group>             <year>2008</year>             <article-title>Combining statistical alignment and phylogenetic footprinting to detect regulatory elements.</article-title>             <source>Bioinformatics</source>             <volume>24</volume>             <fpage>1236</fpage>             <lpage>1242</lpage>          </element-citation></ref>
<ref id="pcbi.1000299-Lunter1"><label>22</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Lunter</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Drummond</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Miklos</surname><given-names>I</given-names></name>
<name name-style="western"><surname>Hein</surname><given-names>J</given-names></name>
</person-group>             <year>2004</year>             <article-title>Statistical alignment: recent progress, new applications, and challenges.</article-title>             <source>Statistical Methods in Molecular Evolution</source>             <publisher-loc>New York</publisher-loc>             <publisher-name>Springer Verlag</publisher-name>             <fpage>375</fpage>             <lpage>405</lpage>          </element-citation></ref>
<ref id="pcbi.1000299-Thorne2"><label>23</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Thorne</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Kishino</surname><given-names>H</given-names></name>
<name name-style="western"><surname>Felsenstein</surname><given-names>J</given-names></name>
</person-group>             <year>1992</year>             <article-title>Inching toward reality: an improved likelihood model of sequence evolution.</article-title>             <source>J Mol Evol</source>             <volume>34</volume>             <fpage>3</fpage>             <lpage>16</lpage>          </element-citation></ref>
<ref id="pcbi.1000299-Lunter2"><label>24</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Lunter</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Mikls</surname><given-names>I</given-names></name>
<name name-style="western"><surname>Drummond</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Jensen</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Hein</surname><given-names>J</given-names></name>
</person-group>             <year>2005</year>             <article-title>Bayesian coestimation of phylogeny and sequence alignment.</article-title>             <source>BMC Bioinformatics</source>             <volume>6</volume>             <fpage>83</fpage>          </element-citation></ref>
<ref id="pcbi.1000299-Berg1"><label>25</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Berg</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Willmann</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Lassig</surname><given-names>M</given-names></name>
</person-group>             <year>2004</year>             <article-title>Adaptive evolution of transcription factor binding sites.</article-title>             <source>BMC Evol Biol</source>             <volume>4</volume>             <fpage>42</fpage>          </element-citation></ref>
<ref id="pcbi.1000299-Durrett1"><label>26</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Durrett</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Schmidt</surname><given-names>D</given-names></name>
</person-group>             <year>2007</year>             <article-title>Waiting for regulatory sequences to appear.</article-title>             <source>Ann Appl Prob</source>             <volume>17</volume>             <fpage>1</fpage>             <lpage>32</lpage>          </element-citation></ref>
<ref id="pcbi.1000299-MacArthur1"><label>27</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>MacArthur</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Brookfield</surname><given-names>J</given-names></name>
</person-group>             <year>2004</year>             <article-title>Expected rates and modes of evolution of enhancer sequences.</article-title>             <source>Mol Biol Evol</source>             <volume>21</volume>             <fpage>1064</fpage>             <lpage>1073</lpage>          </element-citation></ref>
<ref id="pcbi.1000299-Mustonen1"><label>28</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Mustonen</surname><given-names>V</given-names></name>
<name name-style="western"><surname>Lassig</surname><given-names>M</given-names></name>
</person-group>             <year>2005</year>             <article-title>Evolutionary population genetics of promoters: predicting binding sites and functional phylogenies.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>102</volume>             <fpage>15936</fpage>             <lpage>15941</lpage>          </element-citation></ref>
<ref id="pcbi.1000299-Raijman1"><label>29</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Raijman</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Shamir</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Tanay</surname><given-names>A</given-names></name>
</person-group>             <year>2008</year>             <article-title>Evolution and selection in yeast promoters: analyzing the combined effect of diverse transcription factor binding sites.</article-title>             <source>PLoS Comput Biol</source>             <volume>4</volume>             <fpage>e7</fpage>             <comment>doi:10.1371/journal.pcbi.0040007</comment>          </element-citation></ref>
<ref id="pcbi.1000299-Ray1"><label>30</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Ray</surname><given-names>P</given-names></name>
<name name-style="western"><surname>Shringarpure</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Kolar</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Xing</surname><given-names>E</given-names></name>
</person-group>             <year>2008</year>             <article-title>CSMET: comparative genomic motif detection via multi-resolution phylogenetic shadowing.</article-title>             <source>PLoS Comput Biol</source>             <volume>4</volume>             <fpage>e1000090</fpage>             <comment>doi:10.1371/journal.pcbi.1000090</comment>          </element-citation></ref>
<ref id="pcbi.1000299-Stone1"><label>31</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Stone</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Wray</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Wray</surname><given-names>G</given-names></name>
</person-group>             <year>2001</year>             <article-title>Rapid evolution of cis-regulatory sequences via local point mutations.</article-title>             <source>Mol Biol Evol</source>             <volume>18</volume>             <fpage>1764</fpage>             <lpage>1770</lpage>          </element-citation></ref>
<ref id="pcbi.1000299-Li2"><label>32</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Li</surname><given-names>X</given-names></name>
<name name-style="western"><surname>MacArthur</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Bourgon</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Nix</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Pollard</surname><given-names>D</given-names></name>
<etal/></person-group>             <year>2008</year>             <article-title>Transcription factors bind thousands of active and inactive regions in the Drosophila blastoderm.</article-title>             <source>PLoS Biol</source>             <volume>6</volume>             <fpage>e27</fpage>             <comment>doi:10.1371/journal.pbio.0060027</comment>          </element-citation></ref>
<ref id="pcbi.1000299-Gao1"><label>33</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Gao</surname><given-names>F</given-names></name>
<name name-style="western"><surname>Foat</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Bussemaker</surname><given-names>H</given-names></name>
</person-group>             <year>2004</year>             <article-title>Defining transcriptional networks through integrative modeling of mRNA expression and transcription factor binding data.</article-title>             <source>BMC Bioinformatics</source>             <volume>5</volume>             <fpage>31</fpage>          </element-citation></ref>
<ref id="pcbi.1000299-Hu1"><label>34</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Hu</surname><given-names>Z</given-names></name>
<name name-style="western"><surname>Killion</surname><given-names>P</given-names></name>
<name name-style="western"><surname>Iyer</surname><given-names>V</given-names></name>
</person-group>             <year>2007</year>             <article-title>Genetic reconstruction of a functional transcriptional regulatory network.</article-title>             <source>Nat Genet</source>             <volume>39</volume>             <fpage>683</fpage>             <lpage>687</lpage>          </element-citation></ref>
<ref id="pcbi.1000299-Wray2"><label>35</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Wray</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Hahn</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Abouheif</surname><given-names>E</given-names></name>
<name name-style="western"><surname>Balhoff</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Pizer</surname><given-names>M</given-names></name>
<etal/></person-group>             <year>2003</year>             <article-title>The evolution of transcriptional regulation in eukaryotes.</article-title>             <source>Mol Biol Evol</source>             <volume>20</volume>             <fpage>1377</fpage>             <lpage>1419</lpage>          </element-citation></ref>
<ref id="pcbi.1000299-Frith1"><label>36</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Frith</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Hansen</surname><given-names>U</given-names></name>
<name name-style="western"><surname>Weng</surname><given-names>Z</given-names></name>
</person-group>             <year>2001</year>             <article-title>Detection of cis-element clusters in higher eukaryotic DNA.</article-title>             <source>Bioinformatics</source>             <volume>17</volume>             <fpage>878</fpage>             <lpage>889</lpage>          </element-citation></ref>
<ref id="pcbi.1000299-Knudsen1"><label>37</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Knudsen</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Miyamoto</surname><given-names>M</given-names></name>
</person-group>             <year>2003</year>             <article-title>Sequence alignments and pair hidden Markov models using evolutionary history.</article-title>             <source>J Mol Biol</source>             <volume>333</volume>             <fpage>453</fpage>             <lpage>460</lpage>          </element-citation></ref>
<ref id="pcbi.1000299-Hasegawa1"><label>38</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Hasegawa</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Kishino</surname><given-names>H</given-names></name>
<name name-style="western"><surname>Yano</surname><given-names>T</given-names></name>
</person-group>             <year>1985</year>             <article-title>Dating of the human-ape splitting by a molecular clock of mitochondrial DNA.</article-title>             <source>J Mol Evol</source>             <volume>22</volume>             <fpage>160</fpage>             <lpage>174</lpage>          </element-citation></ref>
<ref id="pcbi.1000299-Halpern1"><label>39</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Halpern</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Bruno</surname><given-names>W</given-names></name>
</person-group>             <year>1998</year>             <article-title>Evolutionary distances for protein-coding sequences: modeling site-specific residue frequencies.</article-title>             <source>Mol Biol Evol</source>             <volume>15</volume>             <fpage>910</fpage>             <lpage>917</lpage>          </element-citation></ref>
<ref id="pcbi.1000299-Moses3"><label>40</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Moses</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Chiang</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Kellis</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Lander</surname><given-names>E</given-names></name>
<name name-style="western"><surname>Eisen</surname><given-names>M</given-names></name>
</person-group>             <year>2003</year>             <article-title>Position specific variation in the rate of evolution in transcription factor binding sites.</article-title>             <source>BMC Evol Biol</source>             <volume>3</volume>             <fpage>19</fpage>          </element-citation></ref>
<ref id="pcbi.1000299-Doniger1"><label>41</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Doniger</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Fay</surname><given-names>J</given-names></name>
</person-group>             <year>2007</year>             <article-title>Frequent gain and loss of functional transcription factor binding sites.</article-title>             <source>PLoS Comput Biol</source>             <volume>3</volume>             <fpage>e99</fpage>             <comment>doi:10.1371/journal.pcbi.0030099</comment>          </element-citation></ref>
<ref id="pcbi.1000299-Ludwig2"><label>42</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Ludwig</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Bergman</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Patel</surname><given-names>N</given-names></name>
<name name-style="western"><surname>Kreitman</surname><given-names>M</given-names></name>
</person-group>             <year>2000</year>             <article-title>Evidence for stabilizing selection in a eukaryotic enhancer element.</article-title>             <source>Nature</source>             <volume>403</volume>             <fpage>564</fpage>             <lpage>567</lpage>          </element-citation></ref>
<ref id="pcbi.1000299-Cartwright1"><label>43</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Cartwright</surname><given-names>R</given-names></name>
</person-group>             <year>2005</year>             <article-title>DNA assembly with gaps (Dawg): simulating sequence evolution.</article-title>             <source>Bioinformatics</source>             <volume>21</volume>             <supplement>Suppl 3</supplement><fpage>iii31</fpage>             <lpage>iii38</lpage>          </element-citation></ref>
<ref id="pcbi.1000299-Pollard1"><label>44</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Pollard</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Moses</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Iyer</surname><given-names>V</given-names></name>
<name name-style="western"><surname>Eisen</surname><given-names>M</given-names></name>
</person-group>             <year>2006</year>             <article-title>Detecting the limits of regulatory element conservation and divergence estimation using pairwise and multiple alignments.</article-title>             <source>BMC Bioinformatics</source>             <volume>7</volume>             <fpage>376</fpage>          </element-citation></ref>
<ref id="pcbi.1000299-Huang1"><label>45</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Huang</surname><given-names>W</given-names></name>
<name name-style="western"><surname>Nevins</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Ohler</surname><given-names>U</given-names></name>
</person-group>             <year>2007</year>             <article-title>Phylogenetic simulation of promoter evolution: estimation and modeling of binding site turnover events and assessment of their impact on alignment tools.</article-title>             <source>Genome Biol</source>             <volume>8</volume>             <fpage>R225</fpage>          </element-citation></ref>
<ref id="pcbi.1000299-Brudno1"><label>46</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Brudno</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Do</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Cooper</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Kim</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Davydov</surname><given-names>E</given-names></name>
<etal/></person-group>             <year>2003</year>             <article-title>LAGAN and Multi-LAGAN: efficient tools for large-scale multiple alignment of genomic DNA.</article-title>             <source>Genome Res</source>             <volume>13</volume>             <fpage>721</fpage>             <lpage>731</lpage>          </element-citation></ref>
<ref id="pcbi.1000299-Pollard2"><label>47</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Pollard</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Bergman</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Stoye</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Celniker</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Eisen</surname><given-names>M</given-names></name>
</person-group>             <year>2004</year>             <article-title>Benchmarking tools for the alignment of functional noncoding DNA.</article-title>             <source>BMC Bioinformatics</source>             <volume>5</volume>             <fpage>6</fpage>          </element-citation></ref>
<ref id="pcbi.1000299-Lifanov1"><label>48</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Lifanov</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Makeev</surname><given-names>V</given-names></name>
<name name-style="western"><surname>Nazina</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Papatsenko</surname><given-names>D</given-names></name>
</person-group>             <year>2003</year>             <article-title>Homotypic regulatory clusters in Drosophila.</article-title>             <source>Genome Res</source>             <volume>13</volume>             <fpage>579</fpage>             <lpage>588</lpage>          </element-citation></ref>
<ref id="pcbi.1000299-Waterston1"><label>49</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Waterston</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Lindblad-Toh</surname><given-names>K</given-names></name>
<name name-style="western"><surname>Birney</surname><given-names>E</given-names></name>
<name name-style="western"><surname>Rogers</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Abril</surname><given-names>J</given-names></name>
<etal/></person-group>             <year>2002</year>             <article-title>Initial sequencing and comparative analysis of the mouse genome.</article-title>             <source>Nature</source>             <volume>420</volume>             <fpage>520</fpage>             <lpage>562</lpage>          </element-citation></ref>
<ref id="pcbi.1000299-Dewey1"><label>50</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Dewey</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Huggins</surname><given-names>P</given-names></name>
<name name-style="western"><surname>Woods</surname><given-names>K</given-names></name>
<name name-style="western"><surname>Sturmfels</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Pachter</surname><given-names>L</given-names></name>
</person-group>             <year>2006</year>             <article-title>Parametric alignment of Drosophila genomes.</article-title>             <source>PLoS Comput Biol</source>             <volume>2</volume>             <fpage>e73</fpage>             <comment>doi:10.1371/journal.pcbi.0020073</comment>          </element-citation></ref>
<ref id="pcbi.1000299-Stormo1"><label>51</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Stormo</surname><given-names>G</given-names></name>
</person-group>             <year>2000</year>             <article-title>DNA binding sites: representation and discovery.</article-title>             <source>Bioinformatics</source>             <volume>16</volume>             <fpage>16</fpage>             <lpage>23</lpage>          </element-citation></ref>
<ref id="pcbi.1000299-Bergman1"><label>52</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Bergman</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Carlson</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Celniker</surname><given-names>S</given-names></name>
</person-group>             <year>2005</year>             <article-title>Drosophila DNase I footprint database: a systematic genome annotation of transcription factor binding sites in the fruitfly, Drosophila melanogaster.</article-title>             <source>Bioinformatics</source>             <volume>21</volume>             <fpage>1747</fpage>             <lpage>1749</lpage>          </element-citation></ref>
<ref id="pcbi.1000299-Aerts1"><label>53</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Aerts</surname><given-names>S</given-names></name>
<name name-style="western"><surname>van Helden</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Sand</surname><given-names>O</given-names></name>
<name name-style="western"><surname>Hassan</surname><given-names>B</given-names></name>
</person-group>             <year>2007</year>             <article-title>Fine-tuning enhancer models to predict transcriptional targets across multiple genomes.</article-title>             <source>PLoS ONE</source>             <volume>2</volume>             <fpage>e1115</fpage>             <comment>doi:10.1371/journal.pone.0001115</comment>          </element-citation></ref>
<ref id="pcbi.1000299-Frith2"><label>54</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Frith</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Li</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Weng</surname><given-names>Z</given-names></name>
</person-group>             <year>2003</year>             <article-title>Cluster-Buster: Finding dense clusters of motifs in DNA sequences.</article-title>             <source>Nucleic Acids Res</source>             <volume>31</volume>             <fpage>3666</fpage>             <lpage>3668</lpage>          </element-citation></ref>
<ref id="pcbi.1000299-Andolfatto1"><label>55</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Andolfatto</surname><given-names>P</given-names></name>
</person-group>             <year>2005</year>             <article-title>Adaptive evolution of non-coding DNA in Drosophila.</article-title>             <source>Nature</source>             <volume>437</volume>             <fpage>1149</fpage>             <lpage>1152</lpage>          </element-citation></ref>
<ref id="pcbi.1000299-Bergman2"><label>56</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Bergman</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Kreitman</surname><given-names>M</given-names></name>
</person-group>             <year>2001</year>             <article-title>Analysis of conserved noncoding DNA in Drosophila reveals similar constraints in intergenic and intronic sequences.</article-title>             <source>Genome Res</source>             <volume>11</volume>             <fpage>1335</fpage>             <lpage>1345</lpage>          </element-citation></ref>
<ref id="pcbi.1000299-Halligan1"><label>57</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Halligan</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Keightley</surname><given-names>P</given-names></name>
</person-group>             <year>2006</year>             <article-title>Ubiquitous selective constraints in the Drosophila genome revealed by a genome-wide interspecies comparison.</article-title>             <source>Genome Res</source>             <volume>16</volume>             <fpage>875</fpage>             <lpage>884</lpage>          </element-citation></ref>
<ref id="pcbi.1000299-Noyes1"><label>58</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Noyes</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Meng</surname><given-names>X</given-names></name>
<name name-style="western"><surname>Wakabayashi</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Sinha</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Brodsky</surname><given-names>M</given-names></name>
<etal/></person-group>             <year>2008</year>             <article-title>A systematic characterization of factors that regulate Drosophila segmentation via a bacterial one-hybrid system.</article-title>             <source>Nucleic Acids Res</source>             <volume>36</volume>             <fpage>2547</fpage>             <lpage>2560</lpage>          </element-citation></ref>
<ref id="pcbi.1000299-Tomancak1"><label>59</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Tomancak</surname><given-names>P</given-names></name>
<name name-style="western"><surname>Berman</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Beaton</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Weiszmann</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Kwan</surname><given-names>E</given-names></name>
<etal/></person-group>             <year>2007</year>             <article-title>Global analysis of patterns of gene expression during Drosophila embryogenesis.</article-title>             <source>Genome Biol</source>             <volume>8</volume>             <fpage>R145</fpage>          </element-citation></ref>
<ref id="pcbi.1000299-Miklos1"><label>60</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Miklos</surname><given-names>I</given-names></name>
<name name-style="western"><surname>Lunter</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Holmes</surname><given-names>I</given-names></name>
</person-group>             <year>2004</year>             <article-title>A “Long Indel” model for evolutionary sequence alignment.</article-title>             <source>Mol Biol Evol</source>             <volume>21</volume>             <fpage>529</fpage>             <lpage>540</lpage>          </element-citation></ref>
<ref id="pcbi.1000299-Keightley1"><label>61</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Keightley</surname><given-names>P</given-names></name>
<name name-style="western"><surname>Johnson</surname><given-names>T</given-names></name>
</person-group>             <year>2004</year>             <article-title>MCALIGN: stochastic alignment of noncoding DNA sequences based on an evolutionary model of sequence evolution.</article-title>             <source>Genome Res</source>             <volume>14</volume>             <fpage>442</fpage>             <lpage>450</lpage>          </element-citation></ref>
<ref id="pcbi.1000299-Holmes1"><label>62</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Holmes</surname><given-names>I</given-names></name>
<name name-style="western"><surname>Bruno</surname><given-names>W</given-names></name>
</person-group>             <year>2001</year>             <article-title>Evolutionary HMMs: a Bayesian approach to multiple alignment.</article-title>             <source>Bioinformatics</source>             <volume>17</volume>             <fpage>803</fpage>             <lpage>820</lpage>          </element-citation></ref>
<ref id="pcbi.1000299-Lunter3"><label>63</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Lunter</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Ponting</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Hein</surname><given-names>J</given-names></name>
</person-group>             <year>2006</year>             <article-title>Genome-wide identification of human functional DNA using a neutral indel model.</article-title>             <source>PLoS Comput Biol</source>             <volume>2</volume>             <fpage>e5</fpage>             <comment>doi:10.1371/journal.pcbi.0020005</comment>          </element-citation></ref>
<ref id="pcbi.1000299-Holmes2"><label>64</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Holmes</surname><given-names>I</given-names></name>
</person-group>             <year>2003</year>             <article-title>Using guide trees to construct multiple-sequence evolutionary HMMs.</article-title>             <source>Bioinformatics</source>             <volume>19</volume>             <fpage>i147</fpage>             <lpage>i157</lpage>          </element-citation></ref>
<ref id="pcbi.1000299-Holmes3"><label>65</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Holmes</surname><given-names>I</given-names></name>
</person-group>             <year>2007</year>             <article-title>Phylocomposer and phylodirector: analysis and visualization of transducer indel models.</article-title>             <source>Bioinformatics</source>             <volume>23</volume>             <fpage>3263</fpage>             <lpage>3264</lpage>          </element-citation></ref>
<ref id="pcbi.1000299-Dermitzakis1"><label>66</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Dermitzakis</surname><given-names>E</given-names></name>
<name name-style="western"><surname>Bergman</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Clark</surname><given-names>A</given-names></name>
</person-group>             <year>2003</year>             <article-title>Tracing the evolutionary history of Drosophila regulatory regions with models that identify transcription factor binding sites.</article-title>             <source>Mol Biol Evol</source>             <volume>20</volume>             <fpage>703</fpage>             <lpage>714</lpage>          </element-citation></ref>
<ref id="pcbi.1000299-Blackwood1"><label>67</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Blackwood</surname><given-names>E</given-names></name>
<name name-style="western"><surname>Kadonaga</surname><given-names>J</given-names></name>
</person-group>             <year>1998</year>             <article-title>Going the distance: a current view of enhancer action.</article-title>             <source>Science</source>             <volume>281</volume>             <fpage>60</fpage>             <lpage>63</lpage>          </element-citation></ref>
<ref id="pcbi.1000299-Kheradpour1"><label>68</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Kheradpour</surname><given-names>P</given-names></name>
<name name-style="western"><surname>Stark</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Roy</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Kellis</surname><given-names>M</given-names></name>
</person-group>             <year>2007</year>             <article-title>Reliable prediction of regulator targets using 12 Drosophila genomes.</article-title>             <source>Genome Res</source>             <volume>17</volume>             <fpage>1919</fpage>             <lpage>1931</lpage>          </element-citation></ref>
<ref id="pcbi.1000299-Gallo1"><label>69</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Gallo</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Li</surname><given-names>L</given-names></name>
<name name-style="western"><surname>Hu</surname><given-names>Z</given-names></name>
<name name-style="western"><surname>Halfon</surname><given-names>M</given-names></name>
</person-group>             <year>2006</year>             <article-title>REDfly: a Regulatory Element Database for Drosophila.</article-title>             <source>Bioinformatics</source>             <volume>22</volume>             <fpage>381</fpage>             <lpage>383</lpage>          </element-citation></ref>
<ref id="pcbi.1000299-Karolchik1"><label>70</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Karolchik</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Kuhn</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Baertsch</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Barber</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Clawson</surname><given-names>H</given-names></name>
<etal/></person-group>             <year>2008</year>             <article-title>The UCSC Genome Browser Database: 2008 update.</article-title>             <source>Nucleic Acids Res</source>             <volume>36</volume>             <fpage>D773</fpage>             <lpage>D779</lpage>          </element-citation></ref>
</ref-list>

</back>
</article>