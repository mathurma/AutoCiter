<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN"><front><journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="publisher">pcbi</journal-id><journal-id journal-id-type="allenpress-id">plcb</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher><publisher-name>Public Library of Science</publisher-name><publisher-loc>San Francisco, USA</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.1371/journal.pcbi.0030160</article-id><article-id pub-id-type="publisher-id">06-PLCB-RA-0056R3</article-id><article-id pub-id-type="sici">plcb-03-08-12</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline"><subject>Computational Biology</subject><subject>Evolutionary Biology</subject></subj-group><subj-group subj-group-type="System Taxonomy"><subject>None</subject></subj-group></article-categories><title-group><article-title>Automated Protein Subfamily Identification and Classification</article-title><alt-title alt-title-type="running-head">Protein Subfamily Identification</alt-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Brown</surname><given-names>Duncan P</given-names></name><xref ref-type="aff" rid="aff1"/></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Krishnamurthy</surname><given-names>Nandini</given-names></name><xref ref-type="aff" rid="aff1"/></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Sjölander</surname><given-names>Kimmen</given-names></name><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref><xref ref-type="aff" rid="aff1"/></contrib></contrib-group><aff id="aff1"><label>1</label><addr-line>Department of Bioengineering, University of California, Berkeley, California, United States of America</addr-line></aff><contrib-group><contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Eisen</surname><given-names>Jonathan A</given-names></name><role>Editor</role><xref ref-type="aff" rid="edit1"/></contrib></contrib-group><aff id="edit1">University of California Davis, United States of America</aff><author-notes><fn fn-type="con" id="ack1"><p>DPB, NK, and KS conceived and designed the experiments, analyzed the data, and wrote the paper. KS invented the original algorithm. DPB modified the algorithm.</p></fn><corresp id="cor1">* To whom correspondence should be addressed. E-mail: <email xlink:type="simple">kimmen@berkeley.edu</email></corresp><fn fn-type="conflict" id="ack3"><p> The authors have declared that no competing interests exist.</p></fn></author-notes><pub-date pub-type="ppub"><month>8</month><year>2007</year></pub-date><pub-date pub-type="epub"><day>17</day><month>8</month><year>2007</year></pub-date><volume>3</volume><issue>8</issue><elocation-id>e160</elocation-id><history><date date-type="received"><day>17</day><month>2</month><year>2006</year></date><date date-type="accepted"><day>25</day><month>6</month><year>2007</year></date></history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2007</copyright-year><copyright-holder>Brown et al</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract><p>Function prediction by homology is widely used to provide preliminary functional annotations for genes for which experimental evidence of function is unavailable or limited. This approach has been shown to be prone to systematic error, including percolation of annotation errors through sequence databases. Phylogenomic analysis avoids these errors in function prediction but has been difficult to automate for high-throughput application. To address this limitation, we present a computationally efficient pipeline for phylogenomic classification of proteins. This pipeline uses the SCI-PHY (Subfamily Classification in Phylogenomics) algorithm for automatic subfamily identification, followed by subfamily hidden Markov model (HMM) construction. A simple and computationally efficient scoring scheme using family and subfamily HMMs enables classification of novel sequences to protein families and subfamilies. Sequences representing entirely novel subfamilies are differentiated from those that can be classified to subfamilies in the input training set using logistic regression. Subfamily HMM parameters are estimated using an information-sharing protocol, enabling subfamilies containing even a single sequence to benefit from conservation patterns defining the family as a whole or in related subfamilies. SCI-PHY subfamilies correspond closely to functional subtypes defined by experts and to conserved clades found by phylogenetic analysis. Extensive comparisons of subfamily and family HMM performances show that subfamily HMMs dramatically improve the separation between homologous and non-homologous proteins in sequence database searches. Subfamily HMMs also provide extremely high specificity of classification and can be used to predict entirely novel subtypes. The SCI-PHY Web server at <ext-link ext-link-type="uri" xlink:href="http://phylogenomics.berkeley.edu/SCI-PHY/" xlink:type="simple">http://phylogenomics.berkeley.edu/SCI-PHY/</ext-link> allows users to upload a multiple sequence alignment for subfamily identification and subfamily HMM construction. Biologists wishing to provide their own subfamily definitions can do so. Source code is available on the Web page. The Berkeley Phylogenomics Group PhyloFacts resource contains pre-calculated subfamily predictions and subfamily HMMs for more than 40,000 protein families and domains at <ext-link ext-link-type="uri" xlink:href="http://phylogenomics.berkeley.edu/phylofacts/" xlink:type="simple">http://phylogenomics.berkeley.edu/phylofacts/</ext-link>.</p></abstract><abstract abstract-type="summary"><title>Author Summary</title><sec id="st1"><title/><p>Predicting the function of a gene or protein (gene product) from its primary sequence is a major focus of many bioinformatics methods. In this paper, the authors present a three-stage computational pipeline for gene functional annotation in an evolutionary framework to reduce the systematic errors associated with the standard protocol (annotation transfer from predicted homologs). In the first stage, a functional hierarchy is estimated for each protein family and subfamilies are identified. In the second stage, hidden Markov models (HMMs) (a type of statistical model) are constructed for each subfamily to model both the family-defining and subfamily-specific signatures. In the third stage, subfamily HMMs are used to assign novel sequences to functional subtypes. Extensive experimental validation of these methods shows that predicted subfamilies correspond closely to functional subtypes identified by experts and to conserved clades in phylogenetic trees; that subfamily HMMs increase the separation between homologs and non-homologs in sequence database discrimination tests relative to the use of a single HMM for the family; and that specificity of classification of novel sequences to subfamilies using subfamily HMMs is near perfect (1.5% error rate when sequences are assigned to the top-scoring subfamily, and &lt;0.5% error rate when logistic regression of scores is employed).</p></sec></abstract><funding-group><funding-statement>The authors received no specific funding for this study.</funding-statement></funding-group><counts><page-count count="13"/></counts><!--===== Restructure custom-meta-wrap to custom-meta-group =====--><custom-meta-group><custom-meta><meta-name>citation</meta-name><meta-value>Brown DP, Krishnamurthy N, Sjölander K (2007) Automated protein subfamily identification and classification. PLoS Comput Biol 3(8): e160. doi:<ext-link ext-link-type="doi" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.0030160" xlink:type="simple">10.1371/journal.pcbi.0030160</ext-link></meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1"><title>Introduction</title><p>While millions of novel genes have been discovered in recent years, the <italic>function</italic> of the majority of genes remains unknown. Since experimental characterization of gene function is neither simple nor inexpensive, computational methods have been developed to predict function, with varying levels of accuracy [<xref ref-type="bibr" rid="pcbi-0030160-b001">1</xref>,<xref ref-type="bibr" rid="pcbi-0030160-b002">2</xref>]. Among the most exciting methods for predicting gene function developed in recent years is an approach called <italic>phylogenomics</italic> [<xref ref-type="bibr" rid="pcbi-0030160-b003">3</xref>].</p><p>The standard protocol for functional classification of novel genes is transfer of annotation from a database hit, i.e., predicting function based on sequence similarity between an unknown gene and one whose function is (presumably) known. This concept has given rise to many functional annotation methods [<xref ref-type="bibr" rid="pcbi-0030160-b004">4</xref>–<xref ref-type="bibr" rid="pcbi-0030160-b009">9</xref>]. Unfortunately, transferring the annotation of the highest-scoring database hit has been shown to be prone to systematic error caused by changes in protein function following gene duplication, speciation, domain shuffling, and other evolutionary processes [<xref ref-type="bibr" rid="pcbi-0030160-b010">10</xref>–<xref ref-type="bibr" rid="pcbi-0030160-b013">13</xref>]. Moreover, existing database annotation errors can be propagated by this approach [<xref ref-type="bibr" rid="pcbi-0030160-b014">14</xref>].</p><p>By contrast, phylogenomic inference employs phylogenetic analysis of an entire protein family in order to predict function for individual members. By overlaying experimental data on the phylogenetic tree, a biologist can identify where, in evolution, genes may have been duplicated, lost, or transferred horizontally, or adopted new functions. Phylogenomic analysis thereby enables a biologist to “fill in the blanks” with an extremely low error rate, and often with significant detail [<xref ref-type="bibr" rid="pcbi-0030160-b015">15</xref>–<xref ref-type="bibr" rid="pcbi-0030160-b018">18</xref>]. The value of phylogenomic approaches to gene function prediction has spurred the recent development of a number of methods automating one or more steps in the phylogenomic inference protocol. Many of these automate the process of collecting, aligning, and clustering homologs, but do not actually assign function [<xref ref-type="bibr" rid="pcbi-0030160-b019">19</xref>–<xref ref-type="bibr" rid="pcbi-0030160-b024">24</xref>]. Others focus primarily on the assignment of function [<xref ref-type="bibr" rid="pcbi-0030160-b025">25</xref>–<xref ref-type="bibr" rid="pcbi-0030160-b029">29</xref>]. While each of these approaches has distinct advantages, none are designed for fast classification of novel sequences or identification of new functional subtypes. The protocol outlined in this paper enables improved specificity of functional inference and facilitates prediction of functional shifts in new sequences.</p><p>We present two methods useful in automating phylogenomic inference: de novo subfamily identification using SCI-PHY (Subfamily Classification in Phylogenomics) and classification of novel sequences using subfamily hidden Markov models (HMMs). These two methods form part of a computational pipeline for phylogenomic inference of gene function that was originally developed for the functional classification of the human genome at Celera Genomics [<xref ref-type="bibr" rid="pcbi-0030160-b030">30</xref>]; the methods reported here have been revised to improve both accuracy and computational efficiency. In the first stage, functional subfamilies are defined either through the use of expert knowledge or computationally. In the second stage, these subfamilies are used to construct subfamily Hidden Markov models (SHMMs) [<xref ref-type="bibr" rid="pcbi-0030160-b031">31</xref>]. In the third stage, sequences predicted to be members of the family are then tested for subfamily membership and either assigned to one of the existing subfamilies or predicted to represent an entirely novel subtype not included in the original dataset.</p><sec id="s1a"><title>De Novo Subfamily Identification</title><p>De novo subfamily identification—partitioning of sequences in a dataset into subtypes—provides two advantages for high-throughput systems of functional classification. First, assuming at least one subfamily member has been experimentally characterized, it becomes possible to infer function for other members of the subfamily. Second, the identification and curation of known subfamilies enables biologists to use sequence-based classification methods (e.g., using profiles, HMMs [<xref ref-type="bibr" rid="pcbi-0030160-b032">32</xref>], or support vector machines (SVMs) [<xref ref-type="bibr" rid="pcbi-0030160-b033">33</xref>]) to assign novel sequences to existing subtypes.</p><p>Existing methods for de novo identification of specific subtypes fall into two camps: those that define clusters using pairwise similarity, e.g., InParanoid [<xref ref-type="bibr" rid="pcbi-0030160-b024">24</xref>], OrthoMCL [<xref ref-type="bibr" rid="pcbi-0030160-b021">21</xref>], Ncut [<xref ref-type="bibr" rid="pcbi-0030160-b025">25</xref>], CD-HIT [<xref ref-type="bibr" rid="pcbi-0030160-b022">22</xref>,<xref ref-type="bibr" rid="pcbi-0030160-b034">34</xref>], and those that cluster by cutting a phylogenetic or hierarchical tree, e.g., RIO [<xref ref-type="bibr" rid="pcbi-0030160-b029">29</xref>], Orthostrapper [<xref ref-type="bibr" rid="pcbi-0030160-b028">28</xref>], Secator [<xref ref-type="bibr" rid="pcbi-0030160-b035">35</xref>], SCI-PHY.</p><p>Both Secator [<xref ref-type="bibr" rid="pcbi-0030160-b035">35</xref>] and SCI-PHY identify subfamilies using hierarchical tree construction and analysis. Secator uses a sequence dissimilarity measure to define an optimal cut of the tree. SCI-PHY uses minimum description length principles from information theory to cut the tree into subfamilies [<xref ref-type="bibr" rid="pcbi-0030160-b036">36</xref>]. SCI-PHY exploits two powerful tools to construct a hierarchical tree: Dirichlet mixture densities [<xref ref-type="bibr" rid="pcbi-0030160-b037">37</xref>] and relative entropy [<xref ref-type="bibr" rid="pcbi-0030160-b038">38</xref>]. Dirichlet mixture densities are used to construct profiles for subtrees due to their utility in enhancing sensitivity with no reduction in specificity [<xref ref-type="bibr" rid="pcbi-0030160-b039">39</xref>]. Relative entropy is used as a distance function between subtree profiles to determine the join order in the tree. See <xref ref-type="sec" rid="s4">Methods</xref> for details.</p><p>SCI-PHY is a fast method of subfamily identification which uses only sequence information, in contrast to phylogenetic tree methods that require species information to resolve orthologs from paralogs for functional analysis. Therefore, SCI-PHY is especially advantageous in situations where species information is not known, such as in environmental sequences. Our experiments show that SCI-PHY subfamilies correspond closely to subtypes found by experts and also to conserved clades identified using standard phylogenetic tree analysis.</p></sec><sec id="s1b"><title>Functional Classification of Unknown Sequences to Defined Subfamilies</title><p>The availability of subfamily classifications enables high-throughput functional annotation: as new sequences are released to the sequence databases, sequence-based classification methods can be used to efficiently assign unknown sequences to pre-defined subtypes. Several classes of methods have been developed for this task. Profiles and HMMs are statistical models that generalize the information in a multiple sequence alignment (MSA) [<xref ref-type="bibr" rid="pcbi-0030160-b032">32</xref>], and can be used to develop subfamily profiles or HMMs, as described in this paper. However, most profile/HMM libraries (e.g., PFAM [<xref ref-type="bibr" rid="pcbi-0030160-b040">40</xref>], the NCBI CDD [<xref ref-type="bibr" rid="pcbi-0030160-b041">41</xref>], SMART [<xref ref-type="bibr" rid="pcbi-0030160-b042">42</xref>], etc.) have focused on modeling large diverse clusters of proteins spanning many different functions, enabling high sensitivity, but affording only a fairly coarse level of functional annotation [<xref ref-type="bibr" rid="pcbi-0030160-b029">29</xref>].</p><p>Methods designed specifically for classification of sequences to predefined subfamilies include the profile-based method of Hannenhalli and Russell [<xref ref-type="bibr" rid="pcbi-0030160-b043">43</xref>] and SVMs [<xref ref-type="bibr" rid="pcbi-0030160-b044">44</xref>]. Hannenhalli and Russell developed a profile-based subfamily classification system that attempts to determine which alignment positions discriminate between subfamilies. SVMs use both positive and negative training examples to allow classification of sequences to different subtypes (e.g., [<xref ref-type="bibr" rid="pcbi-0030160-b033">33</xref>]). Weston et al. developed a semi-supervised algorithm that incorporates unlabeled proteins into an SVM-based discriminative classifier [<xref ref-type="bibr" rid="pcbi-0030160-b045">45</xref>].</p><p>Our approach to classification of novel sequences to functional subfamilies uses subfamily hidden Markov models and a computationally efficient scoring system [<xref ref-type="bibr" rid="pcbi-0030160-b031">31</xref>]. Note that subfamilies may be either automatically or manually defined; the system is independent of the origin of the classification. Subfamily HMMs are constructed using an information-sharing protocol that enables small subfamilies to benefit from the information contained in the rest of the family (such as catalytic residues showing universal conservation) while retaining specificity at subfamily-defining regions or motifs. This improves the sensitivity of the subfamily HMM to detect new members while providing for extremely high specificity of classification. A preliminary study of SHMM performance on a small dataset of nine protein families has been previously published [<xref ref-type="bibr" rid="pcbi-0030160-b031">31</xref>]. Here, we present results on a larger, representative dataset of 515 families, and compare SHMMs to other sequence classification systems.</p></sec><sec id="s1c"><title>Identification of Novel Subtypes</title><p>The ability to predict novel subtypes in a protein family is extremely valuable in identifying functional shifts in newly sequenced genomes. In addition to classification of novel sequences to predefined subfamilies, we present a method of logistic regression of positive and negative examples for subfamilies. This method enables discrimination between novel sequences that can be reliably classified to an existing subfamily and those that are more likely to represent entirely different subtypes from any previously observed.</p></sec></sec><sec id="s2"><title>Results</title><sec id="s2a"><title>Benchmark Datasets</title><sec id="s2a1"><title>SCOP-PFAM515.</title><p>515 full alignments were selected from the PFAM resource [<xref ref-type="bibr" rid="pcbi-0030160-b040">40</xref>] to assess remote homolog detection capabilities of subfamily HMMs relative to family HMMs. We used the Structural Classification of Proteins (SCOP) resource [<xref ref-type="bibr" rid="pcbi-0030160-b046">46</xref>] to select PFAM families that corresponded to a single SCOP superfamily, and filtered this set to choose a single representative for each SCOP fold. The dataset selected is thus not biased toward any particular fold type, and results can be expected to generalize well to novel protein families and folds.</p></sec><sec id="s2a2"><title>Enzyme classification.</title><p>A subset of 57 families from SCOP-PFAM515 contains sequences with multiple enzymatic functions based on all four fields of their Enzyme Classification (EC) [<xref ref-type="bibr" rid="pcbi-0030160-b047">47</xref>] number. In each of these PFAM families, only a fraction of the sequences have been assigned an EC number. The subfamily prediction methods are given all sequences to classify, but only scored on those sequences with EC numbers. To reduce the possibility that an EC number assigned to a sequence was based on a region not included in the PFAM full MSA, we ignored any members whose PFAM alignments reflected less than 75% of the sequence length.</p></sec><sec id="s2a3"><title>EXPERT.</title><p>This dataset contains five extensively curated protein families from three different resources, with additional subdivisions of two of the families to create a total of eight classifications of expert-defined subtypes. We selected the enolase and crotonase enzyme families from the Structure-Function Linkage Database (SFLD) [<xref ref-type="bibr" rid="pcbi-0030160-b048">48</xref>], a manually curated resource that incorporates mechanistic, sequence, and structural information for several diverse enzyme families to derive functional subtypes based on conserved chemical mechanisms. We selected the aminergic and secretin families of 7TM receptors from the GPCRDB (G-protein coupled receptor database) [<xref ref-type="bibr" rid="pcbi-0030160-b049">49</xref>] and the nuclear hormone receptor (NHR) family from NucleaRDB [<xref ref-type="bibr" rid="pcbi-0030160-b050">50</xref>]. The GPCRDB and NucleaRDB classify sequences at varying levels of functional specificity, indicated here by the use of level indices. For instance, NHRs have been divided into three levels, from fairly coarse (NHR level 1) to highly specific (NHR level 3). The amine receptors were subdivided by the GPCRDB into a coarser level 1 and a more specific level 2. This produced a total of eight datasets spanning different levels of functional specificity: Enolase, Crotonase, Amine levels 1 and 2, NHR levels 1–3, and Secretin.</p></sec></sec><sec id="s2b"><title>Results of De Novo Subfamily Identification on Benchmark Datasets</title><p>We compared SCI-PHY to three other methods for protein subfamily identification that depend only on sequence information: Secator, Ncut, and CD-HIT. CD-HIT takes a user-specified minimum percent identity as a parameter for determining cluster membership; we present results for two identity cutoffs: a comparatively low value (40%) in order to identify fairly general functional groups, and a higher value (70%) that has been identified as the minimal identity required to guarantee functional similarity within subfamilies [<xref ref-type="bibr" rid="pcbi-0030160-b051">51</xref>,<xref ref-type="bibr" rid="pcbi-0030160-b052">52</xref>]. We refer to these as CD-HIT40 and CD-HIT70. Results for additional percent identity values are available in <xref ref-type="supplementary-material" rid="pcbi-0030160-sd001">Dataset S1</xref>. Secator, CD-HIT40, CD-HIT70, and SCI-PHY were compared on the EXPERT and EC datasets, spanning a total of 62 distinct protein superfamilies each containing multiple subtypes. Due to Ncut's high computational cost, we analyzed Ncut performance on the EXPERT dataset only.</p><p>We used three scoring functions—purity, edit, and variation of information—to measure the agreement between the reference subtypes in each benchmark dataset and the subfamilies predicted by the methods tested. The <italic>purity</italic> score is a simple measure of each method's ability to properly separate reference subtypes, measured by the fraction of predicted subfamilies that contain sequences of only one reference subtype. Since perfect purity can be achieved trivially by placing every sequence in its own class, we exclude singleton subfamilies from the purity calculation. The <italic>edit</italic> distance between the two dataset partitions measures the number of split or merge operations required to transform one partition into the other. For instance, if one partition contains two clusters whose members are found as one large cluster in the other partition, a single merge or split operation suffices to transform one into the other, producing an edit distance of 1. On the other hand, if a cluster of <italic>k</italic> members in the reference (trusted) partition is divided into <italic>k</italic> singletons in the predicted partition, ⌈log<sub>2</sub> <italic>k</italic>⌉ merge operations are required. Thus, the edit distance penalizes over-division of a reference subtype more than it does two or more reference subtypes being merged. The <italic>Variation of Information</italic> (VI) distance [<xref ref-type="bibr" rid="pcbi-0030160-b053">53</xref>] calculates the amount of information (in bits) within each partition that is not present in the other. A perfect score of zero indicates that the partitions are identical. The purity score and edit and VI distances were chosen to be complementary measures: purity represents the overall precision or specificity in separating functional subtypes, while the edit and VI distance are somewhat analogous to sensitivity or recall. An ideal subfamily classification will produce classes having sequences of only one type (perfect precision) and maximize the size of these clusters (perfect recall). The purity function provides a means to measure the first attribute, while the edit and VI distances provide a means to measure the second.</p><p>Finally, we also assessed agreement between SCI-PHY subfamilies and phylogenetic trees and found that SCI-PHY subfamilies typically correspond to well-supported clades within the family (<xref ref-type="supplementary-material" rid="pcbi-0030160-sd002">Dataset S2</xref>).</p><sec id="s2b1"><title>EXPERT dataset.</title><p>These experiments highlighted the classic tradeoff between specificity and sensitivity. High purity and low edit and VI distances for a method indicate that the subfamily decomposition achieved by that method is very similar to the reference partition. Of all the methods tested, SCI-PHY has the most consistent performance in combining both high purity and low distance to the reference partition. For instance, SCI-PHY has the best (lowest) edit and VI distances of all methods tested, ranking first for four out of eight EXPERT datasets. Secator comes next, with the best edit or VI distance for two of the eight datasets. Other methods tested have either high purity but a large distance (e.g., CD-HIT70) or sacrifice purity for a lower distance (CD-HIT40 and Secator). The performance of the Ncut method differed between the families; for example, it performed very well with the crotonase family, but then clustered 317 of the 328 sequences in the aminergic family, spanning multiple GPCR subtypes into one subfamily. The single notable exception is the enolase family, for which SCI-PHY, Secator, and Ncut produced a large number of singleton clusters (52, 29, and 35, respectively), giving each a poor distance score. A detailed comparison of performance of the different methods on the adreno-receptor family of GPCRs is given in <xref ref-type="supplementary-material" rid="pcbi-0030160-sd003">Dataset S3</xref>. An overview of all method performances on the EXPERT dataset is shown in <xref ref-type="table" rid="pcbi-0030160-t001">Table 1</xref>.</p><table-wrap content-type="2col" id="pcbi-0030160-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030160.t001</object-id><label>Table 1</label><caption><p>De Novo Subfamily Identification for the EXPERT Set</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030160.t001" xlink:type="simple"/><!-- <table frame="hsides" rules="none"><colgroup><col id="tb1col1" align="left" charoff="0" char=""/><col id="tb1col2" align="left" charoff="0" char=""/><col id="tb1col3" align="left" charoff="0" char=""/><col id="tb1col4" align="left" charoff="0" char=""/><col id="tb1col5" align="left" charoff="0" char=""/><col id="tb1col6" align="left" charoff="0" char=""/><col id="tb1col7" align="left" charoff="0" char=""/><col id="tb1col8" align="left" charoff="0" char=""/><col id="tb1col9" align="left" charoff="0" char=""/><col id="tb1col10" align="left" charoff="0" char=""/></colgroup><thead><tr><td align="left" colspan="2"><hr/>Family</td><td><hr/>Amine L1</td><td><hr/>Amine L2</td><td><hr/>Crotonase</td><td><hr/>Enolase</td><td><hr/>NHR L1</td><td><hr/>NHR L2</td><td><hr/>NHR L3</td><td><hr/>Secretin</td></tr></thead><tbody><tr><td colspan="2"><hr/>Subtypes/sequences</td><td>7/358</td><td>31/358</td><td>10/365</td><td>8/472</td><td>8/412</td><td>27/412</td><td>77/412</td><td>15/153</td></tr><tr><td>Pure/total subfamilies (percent)</td><td>SCI-PHY</td><td>36/37 (97)</td><td>32/37 (87)</td><td>15/16 (94)</td><td>26/26 (100)</td><td>29/29 (100)</td><td>28/29 (97)</td><td>11/29 (38)</td><td>14/16 (88)</td></tr><tr><td>SECATOR</td><td>10/14 (71)</td><td>6/14 (42)</td><td>3/7 (43)</td><td>8/9 (89)</td><td>3/5 (60)</td><td>1/5 (20)</td><td>0/5 (0)</td><td>3/6 (50)</td></tr><tr><td>NCUT</td><td>7/8 (88)</td><td>7/8 (88)</td><td>14/16 (88)</td><td>65/66 (98)</td><td>24/25 (96)</td><td>22/25 (88)</td><td>10/25 (40)</td><td>8/10 (80)</td></tr><tr><td>CD-HIT40</td><td>22/33 (67)</td><td>16/33 (49)</td><td>47/47 (100)</td><td>16/18 (89)</td><td>28/28 (100)</td><td>24/28 (86)</td><td>9/28 (30)</td><td>7/11 (64)</td></tr><tr><td>CD-HIT70</td><td>67/67 (100)</td><td>66/67 (99)</td><td>65/65 (100)</td><td>73/73 (100)</td><td>57/57 (100)</td><td>57/57 (100)</td><td>41/57 (72)</td><td>31/31 (100)</td></tr><tr><td>Edit distance</td><td>SCI-PHY</td><td>38</td><td>36</td><td>32</td><td>70</td><td>38</td><td>21</td><td>54</td><td>15</td></tr><tr><td>SECATOR</td><td>49</td><td>61</td><td>53</td><td>32</td><td>6</td><td>23</td><td>71</td><td>9</td></tr><tr><td>NCUT</td><td>40</td><td>62</td><td>23</td><td>99</td><td>30</td><td>23</td><td>57</td><td>14</td></tr><tr><td>CD-HIT40</td><td>64</td><td>84</td><td>55</td><td>28</td><td>30</td><td>21</td><td>69</td><td>25</td></tr><tr><td>CD-HIT70</td><td>107</td><td>85</td><td>213</td><td>177</td><td>90</td><td>71</td><td>70</td><td>35</td></tr><tr><td>VI distance</td><td>SCI-PHY</td><td>1.55</td><td>0.90</td><td>1.05</td><td>1.37</td><td>1.62</td><td>0.39</td><td>0.95</td><td>0.56</td></tr><tr><td>SECATOR</td><td>1.44</td><td>1.14</td><td>1.29</td><td>0.87</td><td>0.43</td><td>1.32</td><td>2.39</td><td>0.91</td></tr><tr><td>NCUT</td><td>2.08</td><td>3.01</td><td>0.63</td><td>2.75</td><td>1.38</td><td>0.57</td><td>1.21</td><td>1.15</td></tr><tr><td>CD-HIT40</td><td>1.94</td><td>1.37</td><td>2.28</td><td>0.56</td><td>1.47</td><td>0.45</td><td>1.16</td><td>1.25</td></tr><tr><td>CD-HIT70</td><td>2.53</td><td>1.31</td><td>3.77</td><td>3.19</td><td>2.55</td><td>1.25</td><td>0.70</td><td>0.99</td></tr><tr><td>Singletons</td><td>SCI-PHY</td><td>6</td><td>6</td><td>22</td><td>52</td><td>17</td><td>17</td><td>17</td><td>6</td></tr><tr><td>SECATOR</td><td>34</td><td>34</td><td>46</td><td>29</td><td>5</td><td>5</td><td>5</td><td>0</td></tr><tr><td>NCUT</td><td>27</td><td>27</td><td>9</td><td>35</td><td>9</td><td>9</td><td>9</td><td>3</td></tr><tr><td>CD-HIT40</td><td>4</td><td>4</td><td>18</td><td>14</td><td>10</td><td>10</td><td>10</td><td>3</td></tr><tr><td>CD-HIT70</td><td>47</td><td>47</td><td>158</td><td>112</td><td>41</td><td>41</td><td>41</td><td>19</td></tr></tbody></table> --><!-- <table-wrap-foot><fn id="nt101"><p>We compared the performance of SCI-PHY, SECATOR, NCUT, CD-HIT40, and CD-HIT70 on eight functional classifications for five protein families (the expert classifications gave two and three levels of functional specificity for the Amine and NHR families, respectively).</p></fn><fn id="nt102"><p>Subtypes/sequences: the number of expert-derived subtypes/the number of sequences in each classification. The percentage of pure subfamilies is given in parentheses.</p></fn><fn id="nt103"><p>Pure/total subfamilies: the fraction of pure non-singleton subfamilies/the total number of non-singleton subfamilies for each method.</p></fn><fn id="nt104"><p>Singletons: the number of single-sequence clusters for each method.</p></fn></table-wrap-foot> --></table-wrap><p>Assessing de novo subfamily identification accuracy by comparison with expert-defined subtypes presents unique challenges. First, there is a wide variation in expert definitions of functional classes—some expert-defined subtypes are highly specific and span short evolutionary distances, while others cluster proteins at a much coarser level and may include highly divergent sequence pairs. Similarly, subfamily prediction methods tend to aim at different points in this spectrum. For instance, CD-HIT40 clusters at a fairly coarse level and has comparatively poor purity scores for highly specific expert-defined levels, but fairly good edit and VI distance scores. By contrast, CD-HIT70′s subfamily purity is the best of the five methods tested, but it has the worst edit distance on seven out of eight classifications, and the worst VI distance on four of the eight datasets.</p><p>Comparing de novo subfamily identification methods against an expert-defined hierarchy reveals the inherent biases of these methods, as each tends to target a different level of a functional hierarchy. This is illustrated by comparison of subfamily prediction methods to the different levels in the aminergic GPCR and NHR families in the EXPERT dataset. Here, Secator's division of the NHR family is closest to the coarse level 1 classification (although Secator's purity scores are poor even at this level), while SCI-PHY and CD-HIT40 match the more specific level 2 classification. CD-HIT70 performs very well at the most specific level (NHR L3), with high purity and low VI distance. Interestingly, CD-HIT with a 50% identity cutoff (CD-HIT50) seems to give a better balance of purity and distance than CD-HIT70 (<xref ref-type="supplementary-material" rid="pcbi-0030160-sd001">Dataset S1</xref>), despite the identification of 70% as the minimal identity required for functional specificity [<xref ref-type="bibr" rid="pcbi-0030160-b051">51</xref>,<xref ref-type="bibr" rid="pcbi-0030160-b052">52</xref>]. Nonetheless, CD-HIT50 has worse edit and VI distance scores than SCI-PHY in seven of the eight classifications, and only marginally better purity.</p><p>The different scoring functions used to evaluate subfamily identification highlight the standard problem in function prediction: achieving a balance between sensitivity and specificity. The purity score measures specificity, whereas the distance functions correspond more closely to sensitivity. There are subtle differences between the two distance functions. Both the edit distance and the VI distance penalize over-division as well as mixing of subtypes, but the edit distance penalizes over-division of subtypes proportionately more than joining a few subtypes into large clusters. The edit distance thereby favors methods such as Secator and CD-HIT40 that produce fairly coarse clusterings. The VI distance takes cluster size into account, and errors in large clusters (affecting many sequences) contribute more to the distance than errors in small clusters. These effects are illustrated by the change in distance-based rank between SCI-PHY and Secator for the Secretin family. On this family, SCI-PHY had a better VI distance than Secator, but a worse edit distance. Examining the two predicted partitions relative to the expert division into subtypes shows why. The SCI-PHY subfamily prediction had high purity (only one SCI-PHY subfamily merged two different subtypes together), but somewhat over-divided expert subtypes, splitting three expert subtypes into multiple subfamilies and producing six singleton subfamilies. In contrast, Secator had low purity (three of the six subfamilies produced by Secator joined several subtypes together, placing nearly 70% of the sequences in the family into mixed subfamilies) but did not subdivide expert subtypes, and very few split operations were required to obtain the expert classification.</p></sec><sec id="s2b2"><title>Results on the EC dataset.</title><p>Performance for the EC dataset (<xref ref-type="table" rid="pcbi-0030160-t002">Table 2</xref>) was quite similar to that on the EXPERT set, except that SCI-PHY has slightly lower purity than CD-HIT40 (while still maintaining superior edit and VI distances), and slightly higher distance scores than Secator, but with superior purity. On this dataset, Secator has the lowest purity over the families tested (71%), but has the best average VI and edit distance scores (0.91 and 8.9, respectively). CD-HIT70 has near-perfect subfamily purity (97%), but the worst distance scores (2.07 and 30.0). SCI-PHY lies between these two extremes: very good subfamily purity (80%) and quite close to the expert partition (1.07 and 10.8). Results for additional parameterizations of CD-HIT are given in <xref ref-type="supplementary-material" rid="pcbi-0030160-sd002">Dataset S2</xref>.</p><table-wrap content-type="1col" id="pcbi-0030160-t002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030160.t002</object-id><label>Table 2</label><caption><p>Wilcoxon Signed Rank Tests for De Novo Subfamily Detection on the EC Dataset</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030160.t002" xlink:type="simple"/><!-- <table frame="hsides" rules="none"><colgroup><col id="tb2col1" align="left" charoff="0" char=""/><col id="tb2col2" align="left" charoff="0" char=""/><col id="tb2col3" align="left" charoff="0" char=""/><col id="tb2col4" align="left" charoff="0" char=""/><col id="tb2col5" align="left" charoff="0" char=""/></colgroup><thead><tr><td align="left"><hr/>Method</td><td><hr/>SECATOR</td><td><hr/>SCI-PHY</td><td><hr/>CD-HIT40</td><td><hr/>CD-HIT70</td></tr></thead><tbody><tr><td>SECATOR</td><td>P: 0.71</td><td>(0.003)</td><td>(1.9 &times; 10<sup>&minus;5</sup>)</td><td>(1.9 &times; 10<sup>&minus;7</sup>)</td></tr><tr><td>V: 0.91</td><td>0.018</td><td>4.0 &times; 10<sup>&minus;7</sup></td><td>5.7 &times; 10<sup>&minus;10</sup></td></tr><tr><td>E: 8.9</td><td>0.005</td><td>6.3 &times; 10<sup>&minus;7</sup></td><td>6.4 &times; 10<sup>&minus;10</sup></td></tr><tr><td>SCI-PHY</td><td>P: 0.80</td><td>(0.007)</td><td>(1.2 &times; 10<sup>&minus;6</sup>)</td></tr><tr><td>V: 1.07</td><td>5.0 &times; 10<sup>&minus;8</sup></td><td>2.3 &times; 10<sup>&minus;9</sup></td></tr><tr><td>E: 10.8</td><td>3.2 &times; 10<sup>&minus;6</sup></td><td>6.4 &times; 10<sup>&minus;10</sup></td></tr><tr><td>CD-HIT40</td><td>P: 0.88</td><td>(2.7 &times; 10<sup>&minus;6</sup>)</td></tr><tr><td>V: 1.44</td><td>3.8 &times; 10<sup>&minus;8</sup></td></tr><tr><td>E: 14.7</td><td>7.3 &times; 10<sup>&minus;9</sup></td></tr><tr><td>CD-HIT70</td><td>P: 0.97</td></tr><tr><td>V: 2.07</td></tr><tr><td>E: 30.0</td></tr></tbody></table> --><!-- <table-wrap-foot><fn id="nt201"><p>Diagonal entries are the mean scores for the method. P, purity score; 1.0 is perfect, indicating that all subfamilies contain sequences from a single EC class. V, variation of information distance; E, edit distance. A distance of zero in either case indicates that predicted subfamilies are identical to EC classes. Off-diagonal entries are the Wilcoxon signed rank <italic>p</italic>-values between methods for the corresponding score. In comparison of two methods for a particular score, parentheses around the <italic>p</italic>-value indicate that the method listed in the column is better; plain values indicate that the row method is better. For instance, the CD-HIT70 method has better purity than any other method, but much worse VI distance. This is a consequence of the tradeoff between small, pure clusters and large mixed clusters.</p></fn></table-wrap-foot> --></table-wrap></sec><sec id="s2b3"><title>Classifying unknown sequences: Subfamily HMM classification accuracy.</title><p>HMMs and profiles are very effective at detecting distant homologies. Since primary sequence diverges more rapidly than 3-D structure, the scientific community uses the ASTRAL datasets of solved structural domains from the SCOP database [<xref ref-type="bibr" rid="pcbi-0030160-b054">54</xref>–<xref ref-type="bibr" rid="pcbi-0030160-b056">56</xref>] to assess performance at remote homolog detection. SCOP domain pairs belonging to the same superfamily are considered homologous. Domain pairs belonging to different SCOP folds are considered unrelated. Perfect performance requires ranking all superfamily pairs above all fold-disagreement pairs.</p><p>We compared the ability of family and subfamily HMMs (for subfamilies defined by SCI-PHY) to identify remote homologs using the SCOP-PFAM515 dataset, spanning 515 PFAM families representing unique 3-D folds. Results of these experiments show that subfamily HMMs significantly increase the separation between true homologs and spurious matches by improving the scores of related sequences. For instance, at an e-value cutoff of 10<sup>−20</sup>, SHMMs detected 73% of SCOP superfamily members, whereas family HMMs detected only 31%. This increase in score significance for homologous sequences comes at no cost in error rate: ROC plots of subfamily and family HMMs superpose closely, with the AUC of subfamily HMMs being slightly greater than the AUC of family HMMs (<xref ref-type="fig" rid="pcbi-0030160-g001">Figure 1</xref>). Our information-sharing protocol improves the overall sensitivity of subfamily HMMs: comparisons of the method with “naïve” subfamily HMMs—those built directly from subfamily alignments without information sharing—shows that, on average, “informed” SHMMs improve e-values for family members by approximately nine orders of magnitude (<xref ref-type="supplementary-material" rid="pcbi-0030160-sd004">Dataset S4</xref>).</p><fig id="pcbi-0030160-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030160.g001</object-id><label>Figure 1</label><caption><title>Comparison of Family and Subfamily HMM Performance on Remote Homolog Detection</title><p>Blue: family HMM results. Red: subfamily HMM results.</p><p>(A) Coverage (<italic>x</italic>-axis) is plotted against e-value (<italic>y</italic>-axis). Coverage (or recall) is the fraction of homologous pairs (i.e., from the same SCOP superfamily) that receive a score of equal or greater significance. The e-value curves converge at a coverage of 0.79, the same coverage at which false positives first arise. This corresponds to an e-value of approximately 0.01.</p><p>(B) ROC curve for family and subfamily HMMs, weighted by superfamily size. Subfamily HMMs receive an AUC of 0.947; family HMMs receive 0.943.</p><p>(C) ROC curve for unweighted data. Subfamily HMMs and family HMMs have AUCs of 0.758 and 0.740, respectively. Together, these data show that while subfamily HMMs do not detect more homologs at a given false positive rate, they do find many more homologs at a given significance cutoff.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030160.g001" xlink:type="simple"/></fig><p>We tested subfamily classification accuracy using leave-one-out experiments. Ten sequences from each family in the SCOP-PFAM515 dataset were individually removed from the alignment, SHMM parameters were estimated without the withheld sequence, and the sequence was then scored against all SHMMs. 98.5% were assigned to their original subfamily, producing an error rate of only 1.5%. Since many of the sequences tested were highly similar to sequences present in the alignments, we also tested classification accuracy following alignment editing to remove sequences with different levels of percent identity to the chosen sequence. We compared SHMM performance with the use of BLAST, and to the sub-profile method of Hannenhalli and Russell [<xref ref-type="bibr" rid="pcbi-0030160-b043">43</xref>]. The results are given in <xref ref-type="table" rid="pcbi-0030160-t004">Table 4</xref>. All three methods achieve similar performance on this dataset. We also assessed subfamily HMM and Hannenhalli and Russell sub-profile performance based on subtypes defined by experts rather than by SCI-PHY, and found similar results (<xref ref-type="supplementary-material" rid="pcbi-0030160-sd005">Dataset S5</xref>).</p><table-wrap content-type="1col" id="pcbi-0030160-t003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030160.t003</object-id><label>Table 3</label><caption><p>Error in Function Prediction Is Revealed by Clustering the Misannotated Sequence with Its Homologs Using SCI-PHY</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030160.t003" xlink:type="simple"/><!-- <table frame="hsides" rules="none"><colgroup><col id="tb3col1" align="left" charoff="0" char=""/><col id="tb3col2" align="left" charoff="0" char=""/><col id="tb3col3" align="left" charoff="0" char=""/><col id="tb3col4" align="left" charoff="0" char=""/><col id="tb3col5" align="left" charoff="0" char=""/></colgroup><thead><tr><td align="left"><hr/>Accession</td><td><hr/>Source</td><td><hr/>Description</td><td><hr/>Species</td><td><hr/>GO Function &lsqb;Evidence Code&rsqb;</td></tr></thead><tbody><tr><td>P41338</td><td>UniProt</td><td>Acetyl-CoA acetyltransferase (EC 2.3.1.9) (Acetoacetyl-CoA thiolase)</td><td><named-content content-type="genus-species">Saccharomyces cerevisiae</named-content></td><td>Acetyl-CoA C-acetyltransferase activity &lsqb;IDA&rsqb; identical protein binding &lsqb;IPI&rsqb;</td></tr><tr><td>25286398</td><td>GenBank</td><td>Acetoacetyl-CoA reductase (EC 1.1.1.36)</td><td><named-content content-type="genus-species">Yarrowia lipolytica</named-content></td></tr><tr><td>Q8QZT1</td><td>UniProt</td><td>Acetyl-CoA acetyltransferase, mitochondrial precursor (EC 2.3.1.9)</td><td><named-content content-type="genus-species">Mus musculus</named-content></td><td>acetyl-CoA C-acetyltransferase activity &lsqb;IDA&rsqb;</td></tr></tbody></table> --><!-- <table-wrap-foot><fn id="nt301"><p>The misannotated sequence is highlighted in red. Gene Ontology evidence codes: IDA, inferred from direct assay; IPI, inferred from physical interaction</p></fn></table-wrap-foot> --></table-wrap><table-wrap content-type="1col" id="pcbi-0030160-t004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030160.t004</object-id><label>Table 4</label><caption><p>Novel Sequence Classification on the SCOP-PFAM515 Dataset, after Removal of Sequences Similar to the Target Sequence</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030160.t004" xlink:type="simple"/><!-- <table frame="hsides" rules="none"><colgroup><col id="tb4col1" align="left" charoff="0" char=""/><col id="tb4col2" align="left" charoff="0" char=""/><col id="tb4col3" align="left" charoff="0" char=""/><col id="tb4col4" align="left" charoff="0" char=""/><col id="tb4col5" align="left" charoff="0" char=""/></colgroup><thead><tr><td align="left"><hr/>Percent ID</td><td><hr/>Number of Sequences</td><td><hr/>SHMM</td><td><hr/>BLAST</td><td><hr/>Sub-Profile</td></tr></thead><tbody><tr><td>30&percnt;</td><td>1,674</td><td>74.25</td><td>73.17</td><td>74.37</td></tr><tr><td>40&percnt;</td><td>3,174</td><td>81.82</td><td>81.54</td><td>82.13</td></tr><tr><td>50&percnt;</td><td>4,181</td><td>90.34</td><td>91.94</td><td>91.29</td></tr><tr><td>60&percnt;</td><td>4,614</td><td>95.77</td><td>96.47</td><td>96.10</td></tr><tr><td>70&percnt;</td><td>4,813</td><td>97.28</td><td>98.00</td><td>98.96</td></tr></tbody></table> --><!-- <table-wrap-foot><fn id="nt401"><p>Withheld sequences were classified using either SHMMs, BLAST, or the Hannenhalli and Russell Sub-Profile method, after removal of sequences with identity greater than the given threshold. In some cases, this resulted in removal of all members of the subfamily; these were removed from the results. The total number of sequences tested is given in the Number of Sequences column.</p></fn></table-wrap-foot> --></table-wrap><p>In these experiments, the Hannenhalli and Russell sub-profile method showed only a marginal improvement in classification accuracy over the BLAST and HMM methods, in contrast to earlier work, which showed a dramatic improvement over BLAST and HMM-based classification for more divergently related families [<xref ref-type="bibr" rid="pcbi-0030160-b043">43</xref>]. We believe that this result is due to the coarse classification used in the previous experiments, in which highly diverse families were divided into only two or three subtypes which were individually quite diverse. The sub-profile method attempts to determine which columns discriminate between subtypes, but having a larger number of subtypes reduces the likelihood that any column will show distinct conservation patterns in <italic>all</italic> the subtypes. More specific partitions thus reduce the advantage of the sub-profile method. The marginal improvement of the sub-profile method to SHMMs and BLAST in these experiments may also be related to our providing it the “true” alignment from the input MSA, instead of requiring it to align the sequences separately, as was required by the SHMM and BLAST methods.</p></sec><sec id="s2b4"><title>Classifying unknown sequences: Detecting novel subfamilies.</title><p>Protein families naturally expand in size to accommodate additional homologs produced by genome-sequencing initiatives. Many of these new members will belong to known subtypes, but some will represent novel subtypes having distinct functions. We have developed an online algorithm to assess the likelihood that an unknown sequence represents a novel subfamily.</p><p>Since classification of sequences to existing subfamilies based on top subfamily HMM scores has an extremely low error rate, we treated this task as a binary classification problem, asking the question, “Does the test sequence belong to the top-scoring subfamily, or does it represent a novel subtype?” We used logistic regression to predict the probability of subfamily membership based on the HMM reverse score (<xref ref-type="fig" rid="pcbi-0030160-g002">Figure 2</xref>). The sigmoid logistic curve gives a smooth transition between obvious members and obvious non-members, and gives a better sense of the confidence of our prediction than a simple score threshold. At the same time, it is easy to fit and makes no assumptions about the distributions of the scores.</p><fig id="pcbi-0030160-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030160.g002</object-id><label>Figure 2</label><caption><title>Logistic Regression for Novel Subtype Identification</title><p>The logistic regression fit for an example subfamily is shown. True subfamily members (X) and other family members (+) are shown, together with the fitted curve. When the two classes cannot be completely separated, as in this case, we see a smooth transition in the probability of subfamily membership.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030160.g002" xlink:type="simple"/></fig><p>We tested novel subtype identification as follows. For each PFAM MSA containing at least three SCI-PHY subfamilies, we removed an entire SCI-PHY subfamily (selected at random) and re-estimated HMM parameters for the remaining subfamilies. Retained sequences were used to fit regression curves for each SHMM by all-against-all scoring within the family. Each sequence from the withheld subfamily was then scored against the new set of SHMMs, and the probability that it belonged to the top-scoring subfamily was calculated. We assessed subtype detection sensitivity for a range of membership probability thresholds (<xref ref-type="fig" rid="pcbi-0030160-g003">Figure 3</xref>A). Even at very low acceptance thresholds, logistic regression correctly discriminates between novel sequences and members of existing subfamilies; at the lowest tested threshold of 0.01, 80% of the sequences were correctly classified as novel subtypes.</p><fig id="pcbi-0030160-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030160.g003</object-id><label>Figure 3</label><caption><title>Novel Subtype Identification and Classification Accuracy as a Function of the Threshold on Subfamily Membership Probability</title><p>(A) The red line shows the fraction of novel subfamilies correctly detected; the blue line shows the fraction of subfamily members correctly classified in leave-one-out experiments. Novelty detection is quite robust to the threshold setting, obtaining 80% success rate even at the lowest threshold (0.01).</p><p>(B) The fraction of sequences classified to an incorrect subfamily during leave-one-out experiments. While low to begin with, the false positive error drops dramatically with the imposition of even a small threshold. A threshold of 0.10 probability of subfamily membership seems to be optimal; the false-positive classification rate is just 0.3%, while overall subfamily classification and novel subtype detection accuracy are both 88%. The <italic>x</italic>-axis shows the logistic regression probability threshold for subfamily membership assignment.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030160.g003" xlink:type="simple"/></fig><fig id="pcbi-0030160-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030160.g004</object-id><label>Figure 4</label><caption><title>The Encoding Cost as a Function of the SCI-PHY Iteration for the Secretin Family</title><p>We subtract the encoding cost of the null hypothesis (that all sequences belong in a single subfamily) from the cost of encoding the subclass alignments at each iteration of the algorithm (<italic>y</italic>-axis: Cost<sub>iteration</sub> − Cost<sub>null</sub>). At program commencement, the number of subclasses equals the number of sequences and the encoding cost is high. The encoding cost curve decreases steadily to a minimum when similar sequences are joined and then increases as subtrees with different amino acid preferences are joined. The point in the agglomeration for which the encoding cost is minimal is used to determine a cut of the tree into subtrees, defining the SCI-PHY subfamily decomposition. If the minimum occurs when the encoding cost is zero, then all sequences are placed in a single class (i.e., no subfamilies are predicted). Negative “Encoding Cost” values indicate savings relative to the null hypothesis, and provide support for a division of the sequences into two or more subfamilies.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030160.g004" xlink:type="simple"/></fig><p>We then assessed the impact of this classification protocol for the complementary task: subfamily classification of a test sequence belonging to an existing subfamily. In this case, we repeated the 5,103 leave-one-out experiments described in the previous section, this time fitting regression curves to each subfamily and calculating the probability that the withdrawn sequence was a true member of the best-scoring subfamily. At high stringency (i.e., requiring a high subfamily membership probability), the number of mis-classified sequences (false positives) is minimal, but sensitivity is reduced (<xref ref-type="fig" rid="pcbi-0030160-g003">Figure 3</xref>A). At a threshold of 0.10, both classification accuracy and novel subtype detection algorithms produce an impressive success rate of 88%.</p><p>An unanticipated effect of this thresholding process was to greatly reduce the fraction of false positive classifications (<xref ref-type="fig" rid="pcbi-0030160-g003">Figure 3</xref>B). Virtually all classification errors in the leave-one-out experiments possessed scores well below the norm for their top-scoring subfamily, and were eliminated at very low thresholds. For instance, a membership probability threshold of 0.05 lowered the error rate from 1.5% to 0.3%.</p><p><italic>Detecting errors in the input alignment using SHMMs:</italic> based on prior observations that substantial disagreements between a SCI-PHY subfamily decomposition and classification based on top-scoring SHMM are often diagnostic of errors in the input MSA, we examined errors in classification in the first set of novel subtype detection experiments. We found that many of these errors were singleton subfamilies whose sequences were assigned incorrectly to another subfamily. We suspected that each of these sequences may have been misaligned in the original MSA, causing SCI-PHY to classify the sequence as a separate subfamily instead of joining it to the top-scoring subfamily. To test this hypothesis, we selected all singleton sequences that were erroneously accepted by another subfamily at a probability threshold of 0.7, and we re-aligned each to its top-scoring SHMM. 13 of the 47 tested singleton sequences showed substantial changes in alignment between the initial input MSA and the new alignment (≥5 residues shifted). When these revised alignments were submitted to SCI-PHY, six of the sequences were joined into the (now larger) subfamily to which they had been assigned in the novel subtype detection experiments. We show an example in <xref ref-type="fig" rid="pcbi-0030160-g005">Figure 5</xref>.</p><fig id="pcbi-0030160-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030160.g005</object-id><label>Figure 5</label><caption><title>Discordance between Subfamily Membership and Top-Scoring SHMM Can Be Indicative of Misalignments</title><p>Sequence Q8S220, a singleton subfamily, was classified to its sibling subfamily, N2581. We show a comparison of the sequence as aligned in the original MSA (Q8S220-orig) and after alignment to SHMM N2581 (Q8S220-N2581). The consensus sequence for SHMM N2581 is also shown (N2581-consensus). After realignment, much of the sequence has been shifted, and several motifs now clearly match the N2581 consensus sequence (red boxes).</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030160.g005" xlink:type="simple"/></fig></sec><sec id="s2b5"><title>Genome-scale precomputation of subfamilies and subfamily HMMs.</title><p>We have applied the methods described here in the construction of a phylogenomic HMM library, the PhyloFacts Universal Proteome Explorer, with more than 40,000 protein family “books” and more than 1.2 million HMMs to enable subfamily classification of novel sequences [<xref ref-type="bibr" rid="pcbi-0030160-b057">57</xref>]. Each book contains an MSA, SCI-PHY subfamily decompositions, one or more phylogenetic trees, family and subfamily hidden Markov models, experimental data, Gene Ontology annotations, predicted 3-D structures, PFAM domains, and more. We also provide the SCI-PHY Web server that allows users to upload an MSA for subfamily identification and subfamily HMM construction [<xref ref-type="bibr" rid="pcbi-0030160-b058">58</xref>]. Biologists wishing to provide their own subfamily definitions can do so. See <ext-link ext-link-type="uri" xlink:href="http://phylogenomics.berkeley.edu/SCI-PHY/" xlink:type="simple">http://phylogenomics.berkeley.edu/SCI-PHY/</ext-link>.</p></sec><sec id="s2b6"><title>Annotation transfer and detection of misannotated sequences.</title><p>We present an illustration in which clustering sequences using SCI-PHY enables detection of existing errors in database annotations.</p><p>The GenBank sequence JC7675 (<xref ref-type="table" rid="pcbi-0030160-t003">Table 3</xref>, shown in red) from yeast has been annotated as “Aceto-acetyl-CoA reductase (EC 1.1.1.36).” However, the gene coding for this protein, <italic>pat1,</italic> has been shown to be a peroxisomal acetoacetylCoA thiolase (EC 2.3.1.9) required for n-decane utilization in <named-content content-type="genus-species" xlink:type="simple">Yarrowia lipolytica</named-content> [<xref ref-type="bibr" rid="pcbi-0030160-b059">59</xref>]. The Thiolase family includes both acetoacetylCoA transferase (EC 2.3.1.9) and 3-ketoacylCoA thiolase (EC 2.3.1.16). The SCI-PHY subfamily classification for this sequence reveals that it is more closely related to EC 2.3.1.9, encoding “AcetylCoA-acetyl transferase.” Aceto-acetyl-CoA reductase catalyzes redox reactions, while acetylCoA-acetyl transferase performs a thiolytic cleavage. The clustering of proteins into SCI-PHY subfamilies helps detect and correct this possible misannotation. Note that PFAM is unclear on the classification of this sequence, placing it into the thiolase family which includes both EC 2.3.1.9 and EC 2.3.1.16. Detailed phylogenomic analysis for this protein can be found in the PhyloFacts book “Thiolase” (<ext-link ext-link-type="uri" xlink:href="http://phylogenomics.berkeley.edu/book/book_info.php?book=bpg000891" xlink:type="simple">http://phylogenomics.berkeley.edu/book/book_info.php?book=bpg000891</ext-link>).</p><p>Additional examples of effective annotation transfer and error detection are given in <xref ref-type="supplementary-material" rid="pcbi-0030160-sd006">Dataset S6</xref>.</p></sec></sec></sec><sec id="s3"><title>Discussion</title><p>Phylogenomic analysis is widely regarded as the method of choice for high-accuracy functional annotation but has had limited application due to the technical complexity of this protocol. This paper focuses on methods to automate a phylogenomic pipeline using defined subfamilies followed by construction of HMMs for these subfamilies, which can then be used to classify novel sequences.</p><p>A large fraction of phylogenomic inference tools focus on the identification of orthologs as the basis of annotation transfer, under the assumption that orthologs—related by speciation from a common ancestor—are likely to maintain the same function. Methods developed for phylogenomic inference that use species information in conjunction with phylogenetic tree analysis to identify orthologs include RIO [<xref ref-type="bibr" rid="pcbi-0030160-b029">29</xref>], Orthostrapper [<xref ref-type="bibr" rid="pcbi-0030160-b028">28</xref>], and SIFTER [<xref ref-type="bibr" rid="pcbi-0030160-b027">27</xref>]. While functional inference based on orthology is likely to have the highest specificity, this requirement is effectively quite limiting in practical application. First, annotation transfer based on strict orthology to characterized sequences will be highly restricted due to the small fraction of sequences having experimentally verified function (see, e.g., [<xref ref-type="bibr" rid="pcbi-0030160-b027">27</xref>]). Second, orthology detection requires species information; this is not always available, for example, in environmental sequence analysis [<xref ref-type="bibr" rid="pcbi-0030160-b060">60</xref>,<xref ref-type="bibr" rid="pcbi-0030160-b061">61</xref>]. For these reasons, methods of subfamily identification that use only sequence information (such as SCI-PHY) can be quite useful. In addition, restricting functional inferences to strictly defined orthologs may be unnecessarily restrictive as sub-functionalization following gene duplication is quite common: our analyses of the five families included in the EXPERT dataset show that a significant fraction of expert-defined subtypes include paralogous sequences.</p><p>Any division of a family into functional subtypes is somewhat arbitrary, as proteins have different levels of molecular function ranging from the fairly coarse (e.g., catalytic activity) to highly specific (e.g., substrate recognition). For this reason, some protein classification databases, such as the GPCRDB [<xref ref-type="bibr" rid="pcbi-0030160-b049">49</xref>], present a hierarchy of functional classes rather than a single subfamily definition. For instance, the human type 1 serotonin receptor (UniProt accession P08908) is classified to the GPCRDB serotonin type I receptors, a subtype of the serotonin receptors, which belong to the amine (or aminergic) GPCR family, which forms a subclass of Class A rhodopsin-like GPCRs. Other resources provide single-level classifications, which similarly range from coarse to highly specific. Each of these approaches to functional classification has its own merits. Similarly, biologists can select subfamily prediction methods appropriate to an intended use: for highly specific definitions of molecular function, CD-HIT70 and SCI-PHY will be most appropriate. For more coarsely grained clusters, CD-HIT40 and Secator will be preferred.</p><p>Subfamily identification methods that rely on an MSA as input, including SCI-PHY and Secator (and most phylogenetic tree construction algorithms), tend to be quite sensitive to alignment errors. We therefore recommend careful attention to the construction of the MSA for the family. Removing columns having many gap characters is analogous to alignment masking prior to phylogenetic tree construction, and is recommended. A protocol for collecting and aligning homologs is given in [<xref ref-type="bibr" rid="pcbi-0030160-b018">18</xref>].</p><sec id="s3a"><title>Using Subfamily HMMs to Classify Novel Sequences</title><p>Our results show that subfamily HMMs provide high specificity of sequence classification to functional subtypes, providing a kind of automated phylogenomic inference that approximates the results achievable from a more compute-intensive phylogenetic reconstruction. The information-sharing protocol we present produces subfamily HMMs that generalize effectively to distant homologs. Information sharing leverages available training data and helps to smooth estimated amino acid distributions to prevent overly specific HMM parameters in small subfamilies. This information-sharing protocol more efficiently separates homologs from non-homologs than subfamily HMMs without information sharing, but at a slight cost in subfamily specificity (i.e., the error rate for subfamily classification without information sharing is 0.8%, while our standard information-sharing protocol has an error rate of 1.5%).</p><p>In these experiments, family and subfamily HMMs showed similar classification error rates, although subfamily HMMs produce much more significant e-values for true positives, in addition to identifying subfamily membership. This suggests a simple way to reduce the computational burden of using SHMMs, which we use in practice. Rather than scoring novel sequences against all SHMMs from all families, we screen sequences for family membership using family HMMs and then identify the appropriate subfamily by scoring the sequence only to the SHMMs of that family. Since most HMM libraries contain thousands of families, the average increase in scoring runs due to the use of SHMMs is then marginal.</p><p>Logistic regression of subfamily HMM scores enables us to discriminate between sequences representing entirely novel subtypes and sequences that can be assigned to existing subtypes. This confers a unique capability to subfamily classification systems that is critical to prevent overly specific (incorrect) predictions of molecular function for novel sequences.</p><p>All methods of constructing subfamily models as a means of classifying novel sequences will be sensitive to the inclusion of outlier sequences in a family. A single or small number of outlier sequences normally have minimal effect on a profile or HMM constructed for the family as a whole (since their contribution is typically washed out by the dominant group) and may remain undetected. However, the use of subfamily models, whether through subfamily HMMs, as outlined here, or by another method, can magnify the power of these outliers to attract and recruit their relatives. This may be desirable when outliers are actual homologs, but is generally not desirable in the case of spurious database hits. However, if non-homologous outliers can be flagged, their corresponding subfamily models can be used as decoys, differentiating true family members from those that only appear to be related.</p></sec></sec><sec id="s4" sec-type="materials|methods"><title>Materials and Methods</title><sec id="s4a"><title>SCI-PHY de novo subfamily identification.</title><p>The input to SCI-PHY is an MSA, from which a hierarchical tree and subfamily decomposition are estimated. SCI-PHY uses agglomerative (bottom-up) clustering to construct a hierarchical tree: the input objects form the leaves in the tree; similar objects are joined by edges to form subtrees, and the process is iterated until a rooted tree is obtained.</p><p><bold>Algorithm</bold></p><p><italic>Input:</italic> MSA</p><p><italic>Initialization:</italic></p><p>Each sequence forms a separate class (leaf in tree). For each class, construct a profile, using Dirichlet mixture densities [<xref ref-type="bibr" rid="pcbi-0030160-b037">37</xref>]. Compute the pairwise distances between all classes, using relative entropy (<xref ref-type="disp-formula" rid="pcbi-0030160-e001">Equation 1</xref>) between their profiles. Find the closest pair.</p><p><italic>Agglomeration:</italic></p><p>While (#classes &gt;1) do:</p><p>1. Join the two closest classes into a new class, represented by a new node in the tree. Add edges from the new node to each daughter node.</p><p>2. Construct a profile for the new class based on the joint MSA.</p><p>3. Compute the distance between this new class and other classes (<xref ref-type="disp-formula" rid="pcbi-0030160-e001">Equation 1</xref>).</p><p>4. Compute the encoding cost of this partition, under a Dirichlet mixture density (<xref ref-type="disp-formula" rid="pcbi-0030160-e002">Equation 2</xref>).</p><p><italic>Output:</italic></p><p>1. Hierarchical tree.</p><p>2. Predicted subfamilies, corresponding to the stage in the agglomeration having the lowest encoding cost.</p><p><italic>Subtree profile construction:</italic> each class (individual sequence or set of sequences) is represented by a profile [<xref ref-type="bibr" rid="pcbi-0030160-b062">62</xref>] of amino acid distributions. Profiles are estimated using Dirichlet mixture densities [<xref ref-type="bibr" rid="pcbi-0030160-b037">37</xref>], which helps generalize the amino acid distributions to include probabilities for similar amino acids at each position.</p><p><italic>Distances between profiles:</italic> the distance function between profiles is a symmetrized form of relative entropy [<xref ref-type="bibr" rid="pcbi-0030160-b038">38</xref>] summed over the alignment length (the <italic>total relative entropy</italic> or <italic>TRE</italic>). The TRE for profiles <italic>p</italic> and <italic>q</italic> is averaged over all columns <italic>c</italic>, such that both <italic>p<sub>c</sub></italic> and <italic>q<sub>c</sub></italic> distributions are based on columns with ≥1 amino acid (i.e., neither column contains only gap characters).
					<disp-formula id="pcbi-0030160-e001"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030160.e001" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mtext>TRE</mml:mtext><mml:mo stretchy='false'>(</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>&equals;</mml:mo><mml:mstyle displaystyle='true'><mml:munder><mml:mo>&sum;</mml:mo><mml:mi>c</mml:mi></mml:munder></mml:mstyle><mml:mtext>&thinsp;</mml:mtext><mml:mstyle displaystyle='true'><mml:munderover><mml:mo>&sum;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>&equals;</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>20</mml:mn></mml:mrow></mml:munderover></mml:mstyle><mml:mtext>&thinsp;</mml:mtext><mml:msubsup><mml:mi>p</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mi>log</mml:mi><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mi>q</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>&plus;</mml:mo><mml:msubsup><mml:mi>q</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mi>log</mml:mi><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>q</mml:mi><mml:mi>c</mml:mi><mml:mtext>&thinsp;</mml:mtext><mml:mi>i</mml:mi></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mi>c</mml:mi><mml:mtext>&thinsp;</mml:mtext><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math> --></disp-formula>where <italic>p<sub>c</sub><sup>i</sup></italic> is the probability of amino acid <italic>i</italic> at position <italic>c</italic> in profile <italic>p</italic>.
				</p><p><italic>Encoding cost determination of subfamily decomposition:</italic> subfamily identification is achieved using minimum-description–length principles to determine a cut of the tree into subtrees. There are a very large number of potential tree cuts; we employ a heuristic that examines only those partitions produced during the agglomerative clustering. At each iteration in the tree-building process, we have a forest of distinct subtrees that correspond to a particular cut of the tree. For each of these cuts, we evaluate the cost to encode the current set of subtree alignments under a Dirichlet mixture density [<xref ref-type="bibr" rid="pcbi-0030160-b036">36</xref>,<xref ref-type="bibr" rid="pcbi-0030160-b037">37</xref>]. The encoding cost function, assuming all subfamilies are independent, is defined as
					<disp-formula id="pcbi-0030160-e002"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030160.e002" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mtext>EncodingCost</mml:mtext><mml:mo>&equals;</mml:mo><mml:mi>N</mml:mi><mml:mi>log</mml:mi><mml:mspace width="3pt"/><mml:mi>S</mml:mi><mml:mo>&minus;</mml:mo><mml:mstyle displaystyle='true'><mml:munder><mml:mo>&sum;</mml:mo><mml:mi>c</mml:mi></mml:munder></mml:mstyle><mml:mtext>&thinsp;</mml:mtext><mml:mstyle displaystyle='true'><mml:munderover><mml:mo>&sum;</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>&equals;</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>S</mml:mi></mml:munderover></mml:mstyle><mml:mtext>&thinsp;</mml:mtext><mml:mi>log</mml:mi><mml:mspace width="3pt"/><mml:mtext>P</mml:mtext><mml:mo stretchy='false'>(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi>&alpha;</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math> --></disp-formula>where <italic>N</italic> is the number of sequences in the MSA, <italic>S</italic> is the current number of subtrees, and P(<italic>n<sub>cs</sub></italic> | <italic>α</italic>) is the probability of <italic>n<sub>cs</sub></italic>, the ordered vector of observed amino acids for subfamily <italic>s</italic> at column <italic>c</italic>, under the Dirichlet mixture density <italic>α</italic>.
				</p><p>P(<italic>n<sub>cs</sub></italic> | <italic>α</italic>) is obtained by integrating out the multinomial parameter <italic>θ</italic> from the model (see [<xref ref-type="bibr" rid="pcbi-0030160-b063">63</xref>] for a review of the relevant mathematics). The canonical formulation for this quantity is
					<disp-formula id="pcbi-0030160-e003"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030160.e003" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mtext>P</mml:mtext><mml:mo stretchy='false'>(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi>&alpha;</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:malignmark/><mml:mo>&equals;</mml:mo><mml:mo>&int;</mml:mo><mml:mtext>P</mml:mtext><mml:mo stretchy='false'>(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi>&theta;</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mtext>P</mml:mtext><mml:mo stretchy='false'>(</mml:mo><mml:mi>&theta;</mml:mi><mml:mo>|</mml:mo><mml:mi>&alpha;</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mi>d</mml:mi><mml:mi>&theta;</mml:mi></mml:mrow></mml:math> --><!-- <mml:math display='block'><mml:mrow><mml:malignmark/><mml:mo>&equals;</mml:mo><mml:mstyle displaystyle='true'><mml:munder><mml:mo>&sum;</mml:mo><mml:mi>j</mml:mi></mml:munder></mml:mstyle><mml:mtext>&thinsp;</mml:mtext><mml:msub><mml:mi>q</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mfrac><mml:mrow><mml:mi>Z</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:msub><mml:mi>&alpha;</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>&plus;</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo stretchy='false'>)</mml:mo></mml:mrow><mml:mrow><mml:mi>Z</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:msub><mml:mi>&alpha;</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy='false'>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math> --></disp-formula>In this equation, <italic>Z</italic> is the normalizing constant for the Dirichlet distribution, <italic>α<sub>j</sub></italic> is the <italic>j</italic><sup>th</sup> component of <italic>α</italic>, and <italic>q<sub>j</sub></italic> is its mixture coefficient.
				</p><p>The encoding cost function has two components: the first term is the cost to encode the subfamily labels for each sequence; the second term is the cost to encode each of the subtree alignments for that stage in the agglomeration. The two terms have opposite effects. The first term is large at program commencement when the number of subfamilies is largest, and reduces at each iteration, until it reaches zero at program termination, when there is one subfamily. The second term is minimized when the sequences within each subfamily are very similar to each other. At program commencement, for an input MSA with <italic>N</italic> sequences, there will be <italic>N</italic> separate subfamily alignments to be encoded. As the algorithm continues, the number of subfamilies decreases, until at program termination there is a single subfamily. As very similar sequences are joined into subtrees, the encoding cost decreases. For most protein families, the encoding cost curve decreases steadily to a minimum and then increases as subtrees with different amino acid preferences are joined. The stage in the agglomeration for which the encoding cost is minimal is used to determine a cut of the tree into subfamilies. See <xref ref-type="fig" rid="pcbi-0030160-g004">Figure 4</xref>.</p></sec><sec id="s4b"><title>Sequence weighting in subfamily profile construction.</title><p>Sequence weighting is a standard approach in profile and HMM construction to prevent large subgroups from dominating amino acid distributions [<xref ref-type="bibr" rid="pcbi-0030160-b064">64</xref>]. We use sequence weighting in both SCI-PHY tree construction and in SHMM construction.</p><p>We estimate sequence weights for each subfamily in a two-step process. In the first step, we estimate the total number of independent counts (NIC) in the alignment, as follows. We compute for every position in the alignment the frequency of the most frequent amino acid (ignoring gaps) to derive the positional conservation propensity. We then find the average of this value over all columns having at least one amino acid to obtain the overall conservation propensity (<italic>P<sub>cons</sub></italic>). The NIC for the alignment can then be defined as <inline-formula id="pcbi-0030160-ex001"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0030160.ex001" xlink:type="simple"/></inline-formula>
					, where <italic>N</italic> is the number of sequences in the alignment. This has the effect of producing an NIC of 1 when the sequences in the alignment are 100% identical, and having the NIC approach <italic>N</italic> as the diversity in the alignment increases. In the second step, the relative weights for sequences in each subfamily can then be derived independently (e.g., [<xref ref-type="bibr" rid="pcbi-0030160-b064">64</xref>]), normalizing them to sum to the NIC for that subfamily.
				</p></sec><sec id="s4c"><title>Subfamily HMM construction.</title><p>The input to subfamily HMM construction is an MSA and a decomposition of the alignment into subfamilies. We construct SHMMs in a multi-step process.</p><p><italic>Subfamily HMM architecture and transition parameters:</italic> first, we construct a family HMM using the entire input MSA as input and the SAM w0.5 software, developed by the University of California Santa Cruz (UCSC) Computational Biology group to optimize hidden Markov models for remote homolog detection [<xref ref-type="bibr" rid="pcbi-0030160-b056">56</xref>]. To construct the subfamily HMM, the overall architecture and transition parameters in the family HMM are copied without modification for each SHMM. Keeping the overall architecture fixed enables sequence alignments to any SHMM to be easily mapped to the family as a whole.</p><p><italic>Match-state amino acid emission parameter estimation:</italic> we first identify all positions that are conserved across the family as a whole, allowing gaps. The probability distribution for these positions is taken from the family HMM and fixed within all subfamilies, representing their common functional or structural role. This heuristic also enables small subfamilies to have conserved distributions at positions that clearly define the family as a whole. Next, we identify columns in subfamily alignments containing only gap characters; the match state distributions for these positions are copied from the corresponding match state of the general HMM. This heuristic compensates for any fragmentary or partially aligning sequences included in the MSA. For all other columns, we estimate the amino acid distributions for each subfamily <italic>s</italic> using an information-sharing protocol enabled by the use of Dirichlet mixture densities. For notational simplicity, we suppress the <italic>c</italic> index in the equations that follow.</p><p><italic>Step 1</italic>. We estimate a posterior Dirichlet mixture density <inline-formula id="pcbi-0030160-ex002"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0030160.ex002" xlink:type="simple"/></inline-formula>
					 from the prior density <italic>α</italic> using the weighted amino acid counts in <italic>s</italic>. The mixture coefficients <italic>q</italic> are updated by setting each component <italic>j</italic> to its posterior probability given the observed (weighted) counts <italic>n<sub>s</sub></italic>:
					<disp-formula id="pcbi-0030160-e004"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030160.e004" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:msub><mml:mover accent='true'><mml:mi>q</mml:mi><mml:mo>&circ;</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo>&equals;</mml:mo><mml:mtext>P</mml:mtext><mml:mo stretchy='false'>(</mml:mo><mml:msub><mml:mi>&alpha;</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo stretchy='false'>)</mml:mo></mml:mrow></mml:math> --></disp-formula>
				</p><p>The component parameters <inline-formula id="pcbi-0030160-ex003"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0030160.ex003" xlink:type="simple"/></inline-formula>
					 are also updated to include the <italic>weighted counts</italic> <inline-formula id="pcbi-0030160-ex004"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0030160.ex004" xlink:type="simple"/></inline-formula>
					 of observed amino acids:
					<disp-formula id="pcbi-0030160-e005"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030160.e005" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:msub><mml:mover accent='true'><mml:mi>&alpha;</mml:mi><mml:mo>&circ;</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&equals;</mml:mo><mml:msub><mml:mi>&alpha;</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&plus;</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math> --></disp-formula>where <italic>i</italic> ranges over the twenty amino acids.
				</p><p><italic>Step 2</italic>. We then include counts from other subfamilies <italic>s′</italic> in proportion to their probability under <inline-formula id="pcbi-0030160-ex005"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0030160.ex005" xlink:type="simple"/></inline-formula>
					, obtaining the vector of total training counts <italic>t</italic> as
					<disp-formula id="pcbi-0030160-e006"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030160.e006" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mi>t</mml:mi><mml:mo>&equals;</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>&plus;</mml:mo><mml:mstyle displaystyle='true'><mml:munder><mml:mo>&sum;</mml:mo><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mo>&prime;</mml:mo></mml:msup><mml:mo>&ne;</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:munder></mml:mstyle><mml:mtext>&thinsp;</mml:mtext><mml:mtext>P</mml:mtext><mml:mo stretchy='false'>(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:msup><mml:mi>s</mml:mi><mml:mo>&prime;</mml:mo></mml:msup></mml:msub><mml:mo>|</mml:mo><mml:mover accent='true'><mml:mi>&alpha;</mml:mi><mml:mo>&circ;</mml:mo></mml:mover><mml:mo stretchy='false'>)</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:msup><mml:mi>s</mml:mi><mml:mo>&prime;</mml:mo></mml:msup></mml:msub></mml:mrow></mml:math> --></disp-formula>
				</p><p><italic>Step 3</italic>. Finally, we obtain a posterior estimate of the amino acid distribution from the original <italic>α</italic> using <italic>t</italic> rather than <italic>n</italic>
					<disp-formula id="pcbi-0030160-e007"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030160.e007" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:msub><mml:mover accent='true'><mml:mi>&theta;</mml:mi><mml:mo>&circ;</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>&equals;</mml:mo><mml:mstyle displaystyle='true'><mml:munder><mml:mo>&sum;</mml:mo><mml:mi>j</mml:mi></mml:munder></mml:mstyle><mml:mtext>&thinsp;</mml:mtext><mml:mtext>P</mml:mtext><mml:mo stretchy='false'>(</mml:mo><mml:msub><mml:mi>&alpha;</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&plus;</mml:mo><mml:msub><mml:mi>&alpha;</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>t</mml:mi><mml:mo>|</mml:mo><mml:mo>&plus;</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mi>&alpha;</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math> --></disp-formula>where |<italic>x</italic>| indicates the magnitude of <italic>x</italic>.
				</p><p>Thus, the generalization capability of subfamily HMMs is enhanced by adding in weighted counts from subfamilies having similar amino acids at corresponding positions.</p></sec><sec id="s4d"><title>Details of experimental validation.</title><p><italic>Construction of benchmark datasets.</italic> SCOP-PFAM515: protein families from the PFAM [<xref ref-type="bibr" rid="pcbi-0030160-b040">40</xref>] resource were selected according to the following criteria: (1) the PFAM alignment had to match exactly one SCOP superfamily, and (2) SCI-PHY analysis of the alignment had to detect ≥2 subfamilies. The first criterion was determined based on scoring the Astral PDB90 dataset of structural domains [<xref ref-type="bibr" rid="pcbi-0030160-b065">65</xref>] against all the HMMs in PFAM using the HMMER software (version 2.3.2) [<xref ref-type="bibr" rid="pcbi-0030160-b066">66</xref>], and accepting only those PFAM families matching exactly one SCOP superfamily within the family gathering threshold. The second criterion was chosen to ensure that comparing subfamily and family HMM performance would be informative. Since each SCOP fold can contain numerous superfamilies, PFAM families meeting these criteria were filtered based on the top HMM score to select a single representative of each SCOP fold, to ensure that no fold dominated the results. This produced a set of 515 PFAM families. PFAM full alignments for these families were edited to remove sequences with &gt;95% identity to other sequences in the MSA, columns with &gt;70% gaps, and fragmentary sequences having &gt;30% gap characters in the remaining columns.</p><p><italic>EC dataset construction</italic>: the SCOP-PFAM515 families were examined to find those containing multiple enzymatic functions based on EC numbers obtained from the UniprotKB [<xref ref-type="bibr" rid="pcbi-0030160-b067">67</xref>] database for sequences aligning over &gt;75% of their lengths. The requirement of a minimum fractional alignment was included to prevent an assigned enzymatic function being associated with a domain not represented by the PFAM family selected. 57 families having multiple EC numbers remained after this procedure.</p><p>Since the majority of the sequences in each of these families had no assigned EC numbers, subfamily clustering methods were performed on the full (edited) alignments, but accuracy was assessed using only annotated sequences aligning over &gt;75% of their lengths.</p><p>EXPERT: we selected the enolase and crotonase enzyme families from the SFLD [<xref ref-type="bibr" rid="pcbi-0030160-b048">48</xref>], the amine and secretin families from the GPCRDB [<xref ref-type="bibr" rid="pcbi-0030160-b049">49</xref>], and the NHR family from NucleaRDB [<xref ref-type="bibr" rid="pcbi-0030160-b050">50</xref>]. For the enolase and crotonase families, the full-length sequences were aligned to the structural alignment for the families downloaded from the SFLD Web site. The common domain in the aminergic GPCRs was identified by aligning the full-length sequences from GPCRDB to the PFAM 7tm_1 HMM (PF00001). Similarly, the PFAM 7tm_2 HMM (PF00002) was used for the secretin-like GPCRs. The ligand-binding domain of nuclear hormone receptors was identified using the PFAM Hormone_recep HMM (PF00104). Next, we constructed an MSA for the identified domains from each family using the MUSCLE software [<xref ref-type="bibr" rid="pcbi-0030160-b068">68</xref>]. Finally, we masked columns with ≥70% gap characters and made the alignment non-redundant at 98% identity (by restricting the alignment to a representative set such that no two sequences had ≥98% identity).</p><p><italic>Evaluating predicted subfamilies relative to expert-defined subtypes.</italic> Several scoring functions were developed to enable us to evaluate the performance of predictive methods. <named-content content-type="genus-species" xlink:type="simple">Subfamily purity</named-content> is measured as the fraction of subfamilies that contain only one expert subtype or EC number. The VI is a distance metric on partitions [<xref ref-type="bibr" rid="pcbi-0030160-b053">53</xref>]. As such, it obeys the triangle inequality: <italic>VI</italic>(<italic>A</italic>,<italic>B</italic>) + <italic>VI</italic>(<italic>B</italic>,<italic>C</italic>) ≥ <italic>VI</italic>(<italic>A</italic>,<italic>C</italic>) for partitions <italic>A</italic>,<italic>B</italic>,<italic>C</italic>. Given two partitions, the VI index measures the amount of information in each partition that is not shared between them. It is calculated as
					<disp-formula id="pcbi-0030160-e008"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030160.e008" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mi>V</mml:mi><mml:mi>I</mml:mi><mml:mo>&equals;</mml:mo><mml:mi>H</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>S</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>&plus;</mml:mo><mml:mi>H</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>S</mml:mi><mml:mo>&prime;</mml:mo></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>&minus;</mml:mo><mml:mn>2</mml:mn><mml:mi>I</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>S</mml:mi><mml:mo>&prime;</mml:mo></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math> --></disp-formula>where <italic>H</italic> is the entropy of a partition, and <italic>I</italic> is the mutual information between two partitions:
					<disp-formula id="pcbi-0030160-e009"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030160.e009" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mi>H</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:malignmark/><mml:mo>&equals;</mml:mo><mml:mstyle displaystyle='true'><mml:munderover><mml:mo>&sum;</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>&equals;</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover></mml:mstyle><mml:mtext>&thinsp;</mml:mtext><mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mi>N</mml:mi></mml:mfrac><mml:mi>log</mml:mi><mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mi>N</mml:mi></mml:mfrac></mml:mrow></mml:math> --></disp-formula>
					<disp-formula id="pcbi-0030160-e010"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030160.e010" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mi>I</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>S</mml:mi><mml:mo>&prime;</mml:mo></mml:msup><mml:mo stretchy='false'>)</mml:mo><mml:malignmark/><mml:mo>&equals;</mml:mo><mml:mstyle displaystyle='true'><mml:munderover><mml:mo>&sum;</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>&equals;</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover></mml:mstyle><mml:mtext>&thinsp;</mml:mtext><mml:mstyle displaystyle='true'><mml:munderover><mml:mo>&sum;</mml:mo><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mo>&prime;</mml:mo></mml:msup><mml:mo>&equals;</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msup><mml:mi>K</mml:mi><mml:mo>&prime;</mml:mo></mml:msup></mml:mrow></mml:munderover></mml:mstyle><mml:mtext>&thinsp;</mml:mtext><mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>k</mml:mi><mml:mo>&prime;</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow><mml:mi>N</mml:mi></mml:mfrac><mml:mi>log</mml:mi><mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>k</mml:mi><mml:mo>&prime;</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow><mml:mi>N</mml:mi></mml:mfrac></mml:mrow></mml:math> --></disp-formula>
				</p><p>Here, <italic>n<sub>k</sub></italic> is the number of items in cluster <italic>k</italic> of partition <italic>S</italic>, <italic>n<sub>k,k′</sub></italic> is the number of overlapping items between cluster <italic>k</italic> in partition <italic>S</italic> and cluster <italic>k′</italic> in partition <italic>S′, K</italic> and <italic>K′</italic> are the total number of clusters in partitions <italic>S</italic> and <italic>S′</italic>, respectively, and <italic>N</italic> is the total number of items in the set.</p><p>The <italic>Edit Distance</italic> is defined as the minimum number of split or merge operations required to transform one partition into the other. A split or merge affecting multiple data points is considered one operation. For instance, two clusters containing five sequences may be merged into one ten-sequence cluster with an edit distance of one. The edit distance between a reference and a predicted partition with clusters <italic>k</italic> and <italic>k′</italic>, respectively, is calculated as
					<disp-formula id="pcbi-0030160-e011"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030160.e011" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mtext>Edit</mml:mtext><mml:mo>&equals;</mml:mo><mml:mn>2</mml:mn><mml:mrow><mml:mo stretchy='true'>(</mml:mo><mml:mrow><mml:mstyle displaystyle='true'><mml:munder><mml:mo>&sum;</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>k</mml:mi><mml:mo>&prime;</mml:mo></mml:msup></mml:mrow></mml:munder></mml:mstyle><mml:mtext>&thinsp;</mml:mtext><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>k</mml:mi><mml:mo>&prime;</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy='true'>)</mml:mo></mml:mrow><mml:mo>&minus;</mml:mo><mml:mi>K</mml:mi><mml:mo>&minus;</mml:mo><mml:msup><mml:mi>K</mml:mi><mml:mo>&prime;</mml:mo></mml:msup></mml:mrow></mml:math> --></disp-formula>where <italic>r<sub>k,k′</sub></italic> equals 1 if clusters <italic>k</italic> and <italic>k′</italic> have items in common, and zero otherwise, and <italic>K</italic> and <italic>K′</italic> are the number of clusters in each partition. Like the VI distance, the edit distance is a metric on partitions. Identical partitions will have an edit distance of zero. The edit distance is bounded by <inline-formula id="pcbi-0030160-ex006"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0030160.ex006" xlink:type="simple"/></inline-formula>
					.
				</p><p><italic>SHMM construction and performance:</italic> HMM construction and scoring: we used the UCSC Sequence Alignment and Modeling (SAM) software system [<xref ref-type="bibr" rid="pcbi-0030160-b069">69</xref>,<xref ref-type="bibr" rid="pcbi-0030160-b070">70</xref>] to score sequences in both fold prediction and classification experiments. All family HMMs were estimated using the SAM w0.5 software. Reverse scores for SHMMs and family HMMs were derived using the hmmscore program and local–local scoring (SAM parameter -sw 2). Family HMM e-values for sequences were calculated using the SAM recommended protocol: family HMMs were calibrated with the hmmscore program using the -calibrate option prior to scoring. Raw SHMM scores were obtained by scoring a sequence against all SHMMs in the family and retaining the top score. SHMM e-values were derived by fitting EVD parameters to raw SHMM scores for randomly generated sequences, using a maximum likelihood approach similar to that implemented in HMMER [<xref ref-type="bibr" rid="pcbi-0030160-b071">71</xref>,<xref ref-type="bibr" rid="pcbi-0030160-b072">72</xref>]. E-values were calculated based on a fixed database size of 10<sup>5</sup>. Weighted coverage and ROC curves were calculated by normalizing the contribution of each true positive by the size of its superfamily, so that all superfamilies contributed equally to the dataset [<xref ref-type="bibr" rid="pcbi-0030160-b073">73</xref>].</p><p><italic>Subfamily classification and novel subtype detection:</italic> for leave-one-out experiments, we chose ten sequences at random from each family, which were removed and tested separately. Sequences drawn from singleton subfamilies were replaced and not used. The modified alignment was then used to construct a new set of SHMMs, keeping the original SCI-PHY subfamily decomposition. To simulate classification of remotely related sequences, all sequences having identity greater than a specific cutoff to the withheld sequence were also removed from the alignment. We tested cutoffs of 30%, 40%, 50%, 60%, and 70% identity (see <xref ref-type="table" rid="pcbi-0030160-t004">Table 4</xref>). In some cases, there were no sequences below the threshold within the subfamily; these were removed from the test. For the BLAST method, test sequences were assigned to the subfamily of the highest-scoring hit. To enable direct comparison, the Hannenhalli and Russell sub-profile method was re-implemented to use HMMs constructed from SAM w0.5 software rather than HMMER as in [<xref ref-type="bibr" rid="pcbi-0030160-b043">43</xref>].</p><p>In the novel subtype detection experiments, we removed up to five complete subfamilies at random from each family, ignoring families with only two subfamilies (preventing the case where regression curves would have been trained with no negative examples). Results were normalized by subfamily size. Logistic regression parameters were fit using the iteratively re-weighted least squares (IRLS, [<xref ref-type="bibr" rid="pcbi-0030160-b074">74</xref>]) algorithm (implemented in R [<xref ref-type="bibr" rid="pcbi-0030160-b075">75</xref>]).</p></sec></sec><sec id="s5"><title>Supporting Information</title><supplementary-material id="pcbi-0030160-sd001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030160.sd001" xlink:type="simple"><label>Dataset S1</label><caption><title>De Novo Subfamily Identification on the EXPERT and EC Datasets</title><p>(69 KB PDF)</p></caption></supplementary-material><supplementary-material id="pcbi-0030160-sd002" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030160.sd002" xlink:type="simple"><label>Dataset S2</label><caption><title>Assessing SCI-PHY Agreement with Phylogenetic Clades</title><p>(136 KB PDF)</p></caption></supplementary-material><supplementary-material id="pcbi-0030160-sd003" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030160.sd003" xlink:type="simple"><label>Dataset S3</label><caption><title>Adrenoreceptor GPCRs</title><p>(106 KB PDF)</p></caption></supplementary-material><supplementary-material id="pcbi-0030160-sd004" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030160.sd004" xlink:type="simple"><label>Dataset S4</label><caption><title>Comparison of “Informed” versus “Naïve” Subfamily HMMs</title><p>(37 KB PDF)</p></caption></supplementary-material><supplementary-material id="pcbi-0030160-sd005" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030160.sd005" xlink:type="simple"><label>Dataset S5</label><caption><title>Novel Sequence Classification Using the EXPERT Dataset</title><p>(33 KB PDF)</p></caption></supplementary-material><supplementary-material id="pcbi-0030160-sd006" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030160.sd006" xlink:type="simple"><label>Dataset S6</label><caption><title>Annotation Transfer and Detecting Annotation Error</title><p>(47 KB PDF)</p></caption></supplementary-material></sec></body><back><ack><p>The authors thank Dan Kirshner for developing and maintaining the SCI-PHY Web server, Dr. Ruchira Datta for careful proofreading of the manuscript, and the creators of the resources used in these experiments: PFAM, GPCRDB, NucleaRDB, and SFLD. This work is supported by US National Institutes of Health grant R01 HG002769 and a Presidential Early Career Award in Science and Engineering from the US National Science Foundation to KS.</p></ack><glossary><title>Abbreviations</title><def-list><def-item><term>EC</term><def><p>enzyme commission</p></def></def-item><def-item><term>EPQ</term><def><p>errors per query</p></def></def-item><def-item><term>EVD</term><def><p>extreme value distribution</p></def></def-item><def-item><term>GO</term><def><p>gene ontology</p></def></def-item><def-item><term>GPCRDB</term><def><p>G-protein coupled receptor database</p></def></def-item><def-item><term>HMM</term><def><p>hidden Markov model</p></def></def-item><def-item><term>ML</term><def><p>maximum likelihood</p></def></def-item><def-item><term>MR</term><def><p>majority rule</p></def></def-item><def-item><term>MSA</term><def><p>multiple sequence alignment</p></def></def-item><def-item><term>NHR</term><def><p>nuclear hormone receptor</p></def></def-item><def-item><term>NIC</term><def><p>number of independent counts</p></def></def-item><def-item><term>NJ</term><def><p>neighbor joining</p></def></def-item><def-item><term>SCI-PHY</term><def><p>Subfamily Classification in Phylogenomics</p></def></def-item><def-item><term>SCOP</term><def><p>Structural Classification of Proteins</p></def></def-item><def-item><term>SFLD</term><def><p>Structure Function Linkage Database</p></def></def-item><def-item><term>SHMM</term><def><p>subfamily hidden Markov model</p></def></def-item><def-item><term>SVM</term><def><p>support vector machine</p></def></def-item><def-item><term>TRE</term><def><p>total relative entropy</p></def></def-item><def-item><term>VI</term><def><p>variation of information</p></def></def-item></def-list></glossary><ref-list><title>References</title><ref id="pcbi-0030160-b001"><label>1</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Friedberg</surname><given-names>I</given-names></name></person-group>
					<year>2006</year>
					<article-title>Automated protein function prediction—The genomic challenge.</article-title>
					<source>Brief Bioinform</source>
					<volume>7</volume>
					<fpage>225</fpage>
					<lpage>242</lpage>
				</element-citation></ref><ref id="pcbi-0030160-b002"><label>2</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Soro</surname><given-names>S</given-names></name><name name-style="western"><surname>Tramontano</surname><given-names>A</given-names></name></person-group>
					<year>2005</year>
					<article-title>The prediction of protein function at CASP6.</article-title>
					<source>Proteins</source>
					<volume>61</volume>
					<issue>Supplement 7</issue>
					<fpage>201</fpage>
					<lpage>213</lpage>
				</element-citation></ref><ref id="pcbi-0030160-b003"><label>3</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Eisen</surname><given-names>JA</given-names></name></person-group>
					<year>1998</year>
					<article-title>A phylogenomic study of the MutS family of proteins.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>26</volume>
					<fpage>4291</fpage>
					<lpage>4300</lpage>
				</element-citation></ref><ref id="pcbi-0030160-b004"><label>4</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Andrade</surname><given-names>MA</given-names></name><name name-style="western"><surname>Brown</surname><given-names>NP</given-names></name><name name-style="western"><surname>Leroy</surname><given-names>C</given-names></name><etal/></person-group>
					<year>1999</year>
					<article-title>Automated genome sequence analysis and annotation.</article-title>
					<source>Bioinformatics</source>
					<volume>15</volume>
					<fpage>391</fpage>
					<lpage>412</lpage>
				</element-citation></ref><ref id="pcbi-0030160-b005"><label>5</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Groth</surname><given-names>D</given-names></name><name name-style="western"><surname>Lehrach</surname><given-names>H</given-names></name><name name-style="western"><surname>Hennig</surname><given-names>S</given-names></name></person-group>
					<year>2004</year>
					<article-title>GOblet: A platform for Gene Ontology annotation of anonymous sequence data.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>32</volume>
					<fpage>W313</fpage>
					<lpage>W317</lpage>
				</element-citation></ref><ref id="pcbi-0030160-b006"><label>6</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Khan</surname><given-names>S</given-names></name><name name-style="western"><surname>Situ</surname><given-names>G</given-names></name><name name-style="western"><surname>Decker</surname><given-names>K</given-names></name><name name-style="western"><surname>Schmidt</surname><given-names>CJ</given-names></name></person-group>
					<year>2003</year>
					<article-title>GoFigure: Automated Gene Ontology annotation.</article-title>
					<source>Bioinformatics</source>
					<volume>19</volume>
					<fpage>2484</fpage>
					<lpage>2485</lpage>
				</element-citation></ref><ref id="pcbi-0030160-b007"><label>7</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Lee</surname><given-names>C</given-names></name><name name-style="western"><surname>Irizarry</surname><given-names>K</given-names></name></person-group>
					<year>2001</year>
					<article-title>The GeneMine system for genome/proteome annotation and collaborative data mining.</article-title>
					<source>IBM Sys J</source>
					<volume>40</volume>
					<fpage>592</fpage>
					<lpage>603</lpage>
				</element-citation></ref><ref id="pcbi-0030160-b008"><label>8</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Martin</surname><given-names>DM</given-names></name><name name-style="western"><surname>Berriman</surname><given-names>M</given-names></name><name name-style="western"><surname>Barton</surname><given-names>GJ</given-names></name></person-group>
					<year>2004</year>
					<article-title>GOtcha: A new method for prediction of protein function assessed by the annotation of seven genomes.</article-title>
					<source>BMC Bioinformatics</source>
					<volume>5</volume>
					<fpage>178</fpage>
				</element-citation></ref><ref id="pcbi-0030160-b009"><label>9</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Zehetner</surname><given-names>G</given-names></name></person-group>
					<year>2003</year>
					<article-title>OntoBlast function: From sequence similarities directly to potential functional annotations by ontology terms.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>31</volume>
					<fpage>3799</fpage>
					<lpage>3803</lpage>
				</element-citation></ref><ref id="pcbi-0030160-b010"><label>10</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Brenner</surname><given-names>SE</given-names></name></person-group>
					<year>1999</year>
					<article-title>Errors in genome annotation.</article-title>
					<source>Trends Genet</source>
					<volume>15</volume>
					<fpage>132</fpage>
					<lpage>133</lpage>
				</element-citation></ref><ref id="pcbi-0030160-b011"><label>11</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Devos</surname><given-names>D</given-names></name><name name-style="western"><surname>Valencia</surname><given-names>A</given-names></name></person-group>
					<year>2001</year>
					<article-title>Intrinsic errors in genome annotation.</article-title>
					<source>Trends Genet</source>
					<volume>17</volume>
					<fpage>429</fpage>
					<lpage>431</lpage>
				</element-citation></ref><ref id="pcbi-0030160-b012"><label>12</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Galperin</surname><given-names>MY</given-names></name><name name-style="western"><surname>Koonin</surname><given-names>EV</given-names></name></person-group>
					<year>1998</year>
					<article-title>Sources of systematic error in functional annotation of genomes: Domain rearrangement, non-orthologous gene displacement and operon disruption.</article-title>
					<source>In Silico Biol</source>
					<volume>1</volume>
					<fpage>55</fpage>
					<lpage>67</lpage>
				</element-citation></ref><ref id="pcbi-0030160-b013"><label>13</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Koski</surname><given-names>LB</given-names></name><name name-style="western"><surname>Golding</surname><given-names>GB</given-names></name></person-group>
					<year>2001</year>
					<article-title>The closest BLAST hit is often not the nearest neighbor.</article-title>
					<source>J Mol Evol</source>
					<volume>52</volume>
					<fpage>540</fpage>
					<lpage>542</lpage>
				</element-citation></ref><ref id="pcbi-0030160-b014"><label>14</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Gilks</surname><given-names>WR</given-names></name><name name-style="western"><surname>Audit</surname><given-names>B</given-names></name><name name-style="western"><surname>de Angelis</surname><given-names>D</given-names></name><name name-style="western"><surname>Tsoka</surname><given-names>S</given-names></name><name name-style="western"><surname>Ouzounis</surname><given-names>CA</given-names></name></person-group>
					<year>2005</year>
					<article-title>Percolation of annotation errors through hierarchically structured protein sequence databases.</article-title>
					<source>Math Biosci</source>
					<volume>193</volume>
					<fpage>223</fpage>
					<lpage>234</lpage>
				</element-citation></ref><ref id="pcbi-0030160-b015"><label>15</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Brown</surname><given-names>D</given-names></name><name name-style="western"><surname>Sjölander</surname><given-names>K</given-names></name></person-group>
					<year>2006</year>
					<article-title>Functional classification using phylogenomic inference.</article-title>
					<source>PLoS Comput Biol</source>
					<volume>2</volume>
					<elocation-id>e77.</elocation-id>
				</element-citation></ref><ref id="pcbi-0030160-b016"><label>16</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Eisen</surname><given-names>JA</given-names></name></person-group>
					<year>1998</year>
					<article-title>Phylogenomics: Improving functional predictions for uncharacterized genes by evolutionary analysis.</article-title>
					<source>Genome Res</source>
					<volume>8</volume>
					<fpage>163</fpage>
					<lpage>167</lpage>
				</element-citation></ref><ref id="pcbi-0030160-b017"><label>17</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Eisen</surname><given-names>JA</given-names></name><name name-style="western"><surname>Sweder</surname><given-names>KS</given-names></name><name name-style="western"><surname>Hanawalt</surname><given-names>PC</given-names></name></person-group>
					<year>1995</year>
					<article-title>Evolution of the SNF2 family of proteins: Subfamilies with distinct sequences and functions.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>23</volume>
					<fpage>2715</fpage>
					<lpage>2723</lpage>
				</element-citation></ref><ref id="pcbi-0030160-b018"><label>18</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Sjölander</surname><given-names>K</given-names></name></person-group>
					<year>2004</year>
					<article-title>Phylogenomic inference of protein molecular function: Advances and challenges.</article-title>
					<source>Bioinformatics</source>
					<volume>20</volume>
					<fpage>170</fpage>
					<lpage>179</lpage>
				</element-citation></ref><ref id="pcbi-0030160-b019"><label>19</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Frickey</surname><given-names>T</given-names></name><name name-style="western"><surname>Lupas</surname><given-names>AN</given-names></name></person-group>
					<year>2004</year>
					<article-title>PhyloGenie: Sutomated phylome generation and analysis.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>32</volume>
					<fpage>5231</fpage>
					<lpage>5238</lpage>
				</element-citation></ref><ref id="pcbi-0030160-b020"><label>20</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Gouret</surname><given-names>P</given-names></name><name name-style="western"><surname>Vitiello</surname><given-names>V</given-names></name><name name-style="western"><surname>Balandraud</surname><given-names>N</given-names></name><etal/></person-group>
					<year>2005</year>
					<article-title>FIGENIX: Intelligent automation of genomic annotation: Expertise integration in a new software platform.</article-title>
					<source>BMC Bioinformatics</source>
					<volume>6</volume>
					<fpage>153</fpage>
				</element-citation></ref><ref id="pcbi-0030160-b021"><label>21</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>L</given-names></name><name name-style="western"><surname>Stoeckert</surname><given-names>CJ</given-names><suffix>Jr</suffix></name><name name-style="western"><surname>Roos</surname><given-names>DS</given-names></name></person-group>
					<year>2003</year>
					<article-title>OrthoMCL: Identification of ortholog groups for eukaryotic genomes.</article-title>
					<source>Genome Res</source>
					<volume>13</volume>
					<fpage>2178</fpage>
					<lpage>2189</lpage>
				</element-citation></ref><ref id="pcbi-0030160-b022"><label>22</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>W</given-names></name><name name-style="western"><surname>Jaroszewski</surname><given-names>L</given-names></name><name name-style="western"><surname>Godzik</surname><given-names>A</given-names></name></person-group>
					<year>2002</year>
					<article-title>Tolerating some redundancy significantly speeds up clustering of large protein databases.</article-title>
					<source>Bioinformatics</source>
					<volume>18</volume>
					<fpage>77</fpage>
					<lpage>82</lpage>
				</element-citation></ref><ref id="pcbi-0030160-b023"><label>23</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Plewniak</surname><given-names>F</given-names></name><name name-style="western"><surname>Bianchetti</surname><given-names>L</given-names></name><name name-style="western"><surname>Brelivet</surname><given-names>Y</given-names></name><etal/></person-group>
					<year>2003</year>
					<article-title>PipeAlign: A new toolkit for protein family analysis.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>31</volume>
					<fpage>3829</fpage>
					<lpage>3832</lpage>
				</element-citation></ref><ref id="pcbi-0030160-b024"><label>24</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Remm</surname><given-names>M</given-names></name><name name-style="western"><surname>Storm</surname><given-names>CE</given-names></name><name name-style="western"><surname>Sonnhammer</surname><given-names>EL</given-names></name></person-group>
					<year>2001</year>
					<article-title>Automatic clustering of orthologs and in-paralogs from pairwise species comparisons.</article-title>
					<source>J Mol Biol</source>
					<volume>314</volume>
					<fpage>1041</fpage>
					<lpage>1052</lpage>
				</element-citation></ref><ref id="pcbi-0030160-b025"><label>25</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Abascal</surname><given-names>F</given-names></name><name name-style="western"><surname>Valencia</surname><given-names>A</given-names></name></person-group>
					<year>2002</year>
					<article-title>Clustering of proximal sequence space for the identification of protein families.</article-title>
					<source>Bioinformatics</source>
					<volume>18</volume>
					<fpage>908</fpage>
					<lpage>921</lpage>
				</element-citation></ref><ref id="pcbi-0030160-b026"><label>26</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Abascal</surname><given-names>F</given-names></name><name name-style="western"><surname>Valencia</surname><given-names>A</given-names></name></person-group>
					<year>2003</year>
					<article-title>Automatic annotation of protein function based on family identification.</article-title>
					<source>Proteins</source>
					<volume>53</volume>
					<fpage>683</fpage>
					<lpage>692</lpage>
				</element-citation></ref><ref id="pcbi-0030160-b027"><label>27</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Engelhardt</surname><given-names>BE</given-names></name><name name-style="western"><surname>Jordan</surname><given-names>MI</given-names></name><name name-style="western"><surname>Muratore</surname><given-names>KE</given-names></name><name name-style="western"><surname>Brenner</surname><given-names>SE</given-names></name></person-group>
					<year>2005</year>
					<article-title>Protein molecular function prediction by Bayesian phylogenomics.</article-title>
					<source>PLoS Comput Biol</source>
					<volume>1</volume>
					<elocation-id>e45.</elocation-id>
				</element-citation></ref><ref id="pcbi-0030160-b028"><label>28</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Storm</surname><given-names>CE</given-names></name><name name-style="western"><surname>Sonnhammer</surname><given-names>EL</given-names></name></person-group>
					<year>2002</year>
					<article-title>Automated ortholog inference from phylogenetic trees and calculation of orthology reliability.</article-title>
					<source>Bioinformatics</source>
					<volume>18</volume>
					<fpage>92</fpage>
					<lpage>99</lpage>
				</element-citation></ref><ref id="pcbi-0030160-b029"><label>29</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Zmasek</surname><given-names>CM</given-names></name><name name-style="western"><surname>Eddy</surname><given-names>SR</given-names></name></person-group>
					<year>2002</year>
					<article-title>RIO: Analyzing proteomes by automated phylogenomics using resampled inference of orthologs.</article-title>
					<source>BMC Bioinformatics</source>
					<volume>3</volume>
					<fpage>14</fpage>
				</element-citation></ref><ref id="pcbi-0030160-b030"><label>30</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Venter</surname><given-names>JC</given-names></name><name name-style="western"><surname>Adams</surname><given-names>MD</given-names></name><name name-style="western"><surname>Myers</surname><given-names>EW</given-names></name><name name-style="western"><surname>Li</surname><given-names>PW</given-names></name><name name-style="western"><surname>Mural</surname><given-names>RJ</given-names></name><etal/></person-group>
					<year>2001</year>
					<article-title>The sequence of the human genome.</article-title>
					<source>Science</source>
					<volume>291</volume>
					<fpage>1304</fpage>
					<lpage>1351</lpage>
				</element-citation></ref><ref id="pcbi-0030160-b031"><label>31</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Brown</surname><given-names>D</given-names></name><name name-style="western"><surname>Krishnamurthy</surname><given-names>N</given-names></name><name name-style="western"><surname>Dale</surname><given-names>JM</given-names></name><name name-style="western"><surname>Christopher</surname><given-names>W</given-names></name><name name-style="western"><surname>Sjölander</surname><given-names>K</given-names></name></person-group>
					<year>2005</year>
					<article-title>Subfamily HMMS in functional genomics.</article-title>
					<source>Pac Symp Biocomput</source>
					<volume>10</volume>
					<fpage>322</fpage>
					<lpage>333</lpage>
				</element-citation></ref><ref id="pcbi-0030160-b032"><label>32</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Krogh</surname><given-names>A</given-names></name><name name-style="western"><surname>Brown</surname><given-names>M</given-names></name><name name-style="western"><surname>Mian</surname><given-names>IS</given-names></name><name name-style="western"><surname>Sjölander</surname><given-names>K</given-names></name><name name-style="western"><surname>Haussler</surname><given-names>D</given-names></name></person-group>
					<year>1994</year>
					<article-title>Hidden Markov models in computational biology. Applications to protein modeling.</article-title>
					<source>J Mol Biol</source>
					<volume>235</volume>
					<fpage>1501</fpage>
					<lpage>1531</lpage>
				</element-citation></ref><ref id="pcbi-0030160-b033"><label>33</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Karchin</surname><given-names>R</given-names></name><name name-style="western"><surname>Karplus</surname><given-names>K</given-names></name><name name-style="western"><surname>Haussler</surname><given-names>D</given-names></name></person-group>
					<year>2002</year>
					<article-title>Classifying G-protein coupled receptors with support vector machines.</article-title>
					<source>Bioinformatics</source>
					<volume>18</volume>
					<fpage>147</fpage>
					<lpage>159</lpage>
				</element-citation></ref><ref id="pcbi-0030160-b034"><label>34</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>W</given-names></name><name name-style="western"><surname>Godzik</surname><given-names>A</given-names></name></person-group>
					<year>2006</year>
					<article-title>CD-hit: A fast program for clustering and comparing large sets of protein or nucleotide sequences.</article-title>
					<source>Bioinformatics</source>
					<volume>22</volume>
					<fpage>1658</fpage>
					<lpage>1659</lpage>
				</element-citation></ref><ref id="pcbi-0030160-b035"><label>35</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Wicker</surname><given-names>N</given-names></name><name name-style="western"><surname>Perrin</surname><given-names>GR</given-names></name><name name-style="western"><surname>Thierry</surname><given-names>JC</given-names></name><name name-style="western"><surname>Poch</surname><given-names>O</given-names></name></person-group>
					<year>2001</year>
					<article-title>Secator: A program for inferring protein subfamilies from phylogenetic trees.</article-title>
					<source>Mol Biol Evol</source>
					<volume>18</volume>
					<fpage>1435</fpage>
					<lpage>1441</lpage>
				</element-citation></ref><ref id="pcbi-0030160-b036"><label>36</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Sjölander</surname><given-names>K</given-names></name></person-group>
					<year>1998</year>
					<article-title>Phylogenetic inference in protein superfamilies: Analysis of SH2 domains.</article-title>
					<comment>In:</comment>
					<source>Proceedings of the Sixth International Conference on Intelligent Systems in Molecular Biology</source>
					<conf-date>28 June–1 July, 1998;</conf-date>
					<conf-loc>Montreal, Quebec, Canada.</conf-loc>
					<fpage>165</fpage>
					<lpage>174</lpage>
				</element-citation></ref><ref id="pcbi-0030160-b037"><label>37</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Sjölander</surname><given-names>K</given-names></name><name name-style="western"><surname>Karplus</surname><given-names>K</given-names></name><name name-style="western"><surname>Brown</surname><given-names>M</given-names></name><etal/></person-group>
					<year>1996</year>
					<article-title>Dirichlet mixtures: A method for improved detection of weak but significant protein sequence homology.</article-title>
					<source>Comput Appl Biosci</source>
					<volume>12</volume>
					<fpage>327</fpage>
					<lpage>345</lpage>
				</element-citation></ref><ref id="pcbi-0030160-b038"><label>38</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Kullback</surname><given-names>S</given-names></name></person-group>
					<year>1968</year>
					<source>Information theory and statistics</source>
					<publisher-loc>New York</publisher-loc>
					<publisher-name>Dover Publications</publisher-name>
				</element-citation></ref><ref id="pcbi-0030160-b039"><label>39</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Tatusov</surname><given-names>RL</given-names></name><name name-style="western"><surname>Altschul</surname><given-names>SF</given-names></name><name name-style="western"><surname>Koonin</surname><given-names>EV</given-names></name></person-group>
					<year>1994</year>
					<article-title>Detection of conserved segments in proteins: Iterative scanning of sequence databases with alignment blocks.</article-title>
					<source>Proc Natl Acad Sci U S A</source>
					<volume>91</volume>
					<fpage>12091</fpage>
					<lpage>12095</lpage>
				</element-citation></ref><ref id="pcbi-0030160-b040"><label>40</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Bateman</surname><given-names>A</given-names></name><name name-style="western"><surname>Coin</surname><given-names>L</given-names></name><name name-style="western"><surname>Durbin</surname><given-names>R</given-names></name><etal/></person-group>
					<year>2004</year>
					<article-title>The Pfam protein families database.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>32</volume>
					<fpage>D138</fpage>
					<lpage>D141</lpage>
				</element-citation></ref><ref id="pcbi-0030160-b041"><label>41</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Marchler-Bauer</surname><given-names>A</given-names></name><name name-style="western"><surname>Anderson</surname><given-names>JB</given-names></name><name name-style="western"><surname>Cherukuri</surname><given-names>PF</given-names></name><etal/></person-group>
					<year>2005</year>
					<article-title>CDD: A conserved domain database for protein classification.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>33</volume>
					<fpage>D192</fpage>
					<lpage>D196</lpage>
				</element-citation></ref><ref id="pcbi-0030160-b042"><label>42</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Schultz</surname><given-names>MJ</given-names></name><name name-style="western"><surname>van der Poll</surname><given-names>T</given-names></name></person-group>
					<year>2002</year>
					<article-title>Modulation of pulmonary innate immunity during bacterial infection: Animal studies.</article-title>
					<source>Arch Immunol Ther Exp (Warsz)</source>
					<volume>50</volume>
					<fpage>159</fpage>
					<lpage>167</lpage>
				</element-citation></ref><ref id="pcbi-0030160-b043"><label>43</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Hannenhalli</surname><given-names>SS</given-names></name><name name-style="western"><surname>Russell</surname><given-names>RB</given-names></name></person-group>
					<year>2000</year>
					<article-title>Analysis and prediction of functional sub-types from protein sequence alignments.</article-title>
					<source>J Mol Biol</source>
					<volume>303</volume>
					<fpage>61</fpage>
					<lpage>76</lpage>
				</element-citation></ref><ref id="pcbi-0030160-b044"><label>44</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Cristianini</surname><given-names>N</given-names></name><name name-style="western"><surname>Shawe-Taylor</surname><given-names>J</given-names></name></person-group>
					<year>2000</year>
					<source>An introduction to support vector machines: And other kernel-based learning methods</source>
					<publisher-loc>Cambridge/New York</publisher-loc>
					<publisher-name>Cambridge University Press</publisher-name>
				</element-citation></ref><ref id="pcbi-0030160-b045"><label>45</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Weston</surname><given-names>J</given-names></name><name name-style="western"><surname>Leslie</surname><given-names>C</given-names></name><name name-style="western"><surname>Ie</surname><given-names>E</given-names></name><name name-style="western"><surname>Zhou</surname><given-names>D</given-names></name><name name-style="western"><surname>Elisseeff</surname><given-names>A</given-names></name><etal/></person-group>
					<year>2005</year>
					<article-title>Semi-supervised protein classification using cluster kernels.</article-title>
					<source>Bioinformatics</source>
					<volume>21</volume>
					<fpage>3241</fpage>
					<lpage>3247</lpage>
				</element-citation></ref><ref id="pcbi-0030160-b046"><label>46</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Murzin</surname><given-names>AG</given-names></name><name name-style="western"><surname>Brenner</surname><given-names>SE</given-names></name><name name-style="western"><surname>Hubbard</surname><given-names>T</given-names></name><name name-style="western"><surname>Chothia</surname><given-names>C</given-names></name></person-group>
					<year>1995</year>
					<article-title>SCOP: A structural classification of proteins database for the investigation of sequences and structures.</article-title>
					<source>J Mol Biol</source>
					<volume>247</volume>
					<fpage>536</fpage>
					<lpage>540</lpage>
				</element-citation></ref><ref id="pcbi-0030160-b047"><label>47</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="editor"><name name-style="western"><surname>Webb</surname><given-names>EC</given-names></name><collab xlink:type="simple">NC-IUBMB,</collab></person-group>
					<year>1992</year>
					<source>Enzyme nomenclature 1992: Recommendations of the Nomenclature Committee of the International Union of Biochemistry and Molecular Biology on the nomenclature and classification of enzymes</source>
					<publisher-loc>San Diego</publisher-loc>
					<publisher-name>Academic Press</publisher-name>
				</element-citation></ref><ref id="pcbi-0030160-b048"><label>48</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Pegg</surname><given-names>SC</given-names></name><name name-style="western"><surname>Brown</surname><given-names>SD</given-names></name><name name-style="western"><surname>Ojha</surname><given-names>S</given-names></name><etal/></person-group>
					<year>2006</year>
					<article-title>Leveraging enzyme structure–function relationships for functional inference and experimental design: The Structure-Function Linkage Database.</article-title>
					<source>Biochemistry</source>
					<volume>45</volume>
					<fpage>2545</fpage>
					<lpage>2555</lpage>
				</element-citation></ref><ref id="pcbi-0030160-b049"><label>49</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Horn</surname><given-names>F</given-names></name><name name-style="western"><surname>Bettler</surname><given-names>E</given-names></name><name name-style="western"><surname>Oliveira</surname><given-names>L</given-names></name><name name-style="western"><surname>Campagne</surname><given-names>F</given-names></name><name name-style="western"><surname>Cohen</surname><given-names>FE</given-names></name><etal/></person-group>
					<year>2003</year>
					<article-title>GPCRDB information system for G protein–coupled receptors.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>31</volume>
					<fpage>294</fpage>
					<lpage>297</lpage>
				</element-citation></ref><ref id="pcbi-0030160-b050"><label>50</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Horn</surname><given-names>F</given-names></name><name name-style="western"><surname>Vriend</surname><given-names>G</given-names></name><name name-style="western"><surname>Cohen</surname><given-names>FE</given-names></name></person-group>
					<year>2001</year>
					<article-title>Collecting and harvesting biological data: The GPCRDB and NucleaRDB information systems.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>29</volume>
					<fpage>346</fpage>
					<lpage>349</lpage>
				</element-citation></ref><ref id="pcbi-0030160-b051"><label>51</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Devos</surname><given-names>D</given-names></name><name name-style="western"><surname>Valencia</surname><given-names>A</given-names></name></person-group>
					<year>2000</year>
					<article-title>Practical limits of function prediction.</article-title>
					<source>Proteins</source>
					<volume>41</volume>
					<fpage>98</fpage>
					<lpage>107</lpage>
				</element-citation></ref><ref id="pcbi-0030160-b052"><label>52</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Todd</surname><given-names>AE</given-names></name><name name-style="western"><surname>Orengo</surname><given-names>CA</given-names></name><name name-style="western"><surname>Thornton</surname><given-names>JM</given-names></name></person-group>
					<year>1999</year>
					<article-title>Evolution of protein function, from a structural perspective.</article-title>
					<source>Curr Opin Chem Biol</source>
					<volume>3</volume>
					<fpage>548</fpage>
					<lpage>556</lpage>
				</element-citation></ref><ref id="pcbi-0030160-b053"><label>53</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Meila</surname><given-names>M</given-names></name></person-group>
					<year>2003</year>
					<article-title>Comparing clusterings by the variation of information.</article-title>
					<comment>In: Learning theory and kernel machines. Lect Notes Artif Intell 2777</comment>
					<fpage>173</fpage>
					<lpage>187</lpage>
					<publisher-loc>Springer-Verlag</publisher-loc>
				</element-citation></ref><ref id="pcbi-0030160-b054"><label>54</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Bourne</surname><given-names>PE</given-names></name></person-group>
					<year>2003</year>
					<article-title>CASP and CAFASP experiments and their findings.</article-title>
					<source>Methods Biochem Anal</source>
					<volume>44</volume>
					<fpage>501</fpage>
					<lpage>507</lpage>
				</element-citation></ref><ref id="pcbi-0030160-b055"><label>55</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Chandonia</surname><given-names>JM</given-names></name><name name-style="western"><surname>Hon</surname><given-names>G</given-names></name><name name-style="western"><surname>Walker</surname><given-names>NS</given-names></name><name name-style="western"><surname>Koehl</surname><given-names>P</given-names></name><name name-style="western"><surname>Levitt</surname><given-names>M</given-names></name><etal/></person-group>
					<year>2004</year>
					<article-title>The ASTRAL compendium in 2004.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>32</volume>
					<fpage>D189</fpage>
					<lpage>D192</lpage>
				</element-citation></ref><ref id="pcbi-0030160-b056"><label>56</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Park</surname><given-names>J</given-names></name><name name-style="western"><surname>Karplus</surname><given-names>K</given-names></name><name name-style="western"><surname>Barrett</surname><given-names>C</given-names></name><name name-style="western"><surname>Hughey</surname><given-names>R</given-names></name><name name-style="western"><surname>Haussler</surname><given-names>D</given-names></name><etal/></person-group>
					<year>1998</year>
					<article-title>Sequence comparisons using multiple sequences detect three times as many remote homologues as pairwise methods.</article-title>
					<source>J Mol Biol</source>
					<volume>284</volume>
					<fpage>1201</fpage>
					<lpage>1210</lpage>
				</element-citation></ref><ref id="pcbi-0030160-b057"><label>57</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Krishnamurthy</surname><given-names>N</given-names></name><name name-style="western"><surname>Brown</surname><given-names>D</given-names></name><name name-style="western"><surname>Kirshner</surname><given-names>D</given-names></name><name name-style="western"><surname>Sjölander</surname><given-names>K</given-names></name></person-group>
					<year>2006</year>
					<article-title>PhyloFacts: An online structural phylogenomic encyclopedia for protein functional and structural classification.</article-title>
					<source>Genome Biol</source>
					<volume>7</volume>
					<fpage>R83</fpage>
				</element-citation></ref><ref id="pcbi-0030160-b058"><label>58</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Yamagami</surname><given-names>S</given-names></name><name name-style="western"><surname>Iida</surname><given-names>T</given-names></name><name name-style="western"><surname>Nagata</surname><given-names>Y</given-names></name><name name-style="western"><surname>Ohta</surname><given-names>A</given-names></name><name name-style="western"><surname>Takagi</surname><given-names>M</given-names></name></person-group>
					<year>2001</year>
					<article-title>Isolation and characterization of acetoacetyl-CoA thiolase gene essential for n-decane assimilation in yeast <named-content content-type="genus-species" xlink:type="simple">Yarrowia lipolytica</named-content>.</article-title>
					<source>Biochem Biophys Res Commun</source>
					<volume>282</volume>
					<fpage>832</fpage>
					<lpage>838</lpage>
				</element-citation></ref><ref id="pcbi-0030160-b059"><label>59</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Riesenfeld</surname><given-names>CS</given-names></name><name name-style="western"><surname>Schloss</surname><given-names>PD</given-names></name><name name-style="western"><surname>Handelsman</surname><given-names>J</given-names></name></person-group>
					<year>2004</year>
					<article-title>Metagenomics: Genomic analysis of microbial communities.</article-title>
					<source>Annu Rev Genet</source>
					<volume>38</volume>
					<fpage>525</fpage>
					<lpage>552</lpage>
				</element-citation></ref><ref id="pcbi-0030160-b060"><label>60</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Venter</surname><given-names>JC</given-names></name><name name-style="western"><surname>Remington</surname><given-names>K</given-names></name><name name-style="western"><surname>Heidelberg</surname><given-names>JF</given-names></name><etal/></person-group>
					<year>2004</year>
					<article-title>Environmental genome shotgun sequencing of the Sargasso Sea.</article-title>
					<source>Science</source>
					<volume>304</volume>
					<fpage>66</fpage>
					<lpage>74</lpage>
				</element-citation></ref><ref id="pcbi-0030160-b061"><label>61</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Gribskov</surname><given-names>M</given-names></name><name name-style="western"><surname>McLachlan</surname><given-names>AD</given-names></name><name name-style="western"><surname>Eisenberg</surname><given-names>D</given-names></name></person-group>
					<year>1987</year>
					<article-title>Profile analysis: Detection of distantly related proteins.</article-title>
					<source>Proc Natl Acad Sci U S A</source>
					<volume>84</volume>
					<fpage>4355</fpage>
					<lpage>4358</lpage>
				</element-citation></ref><ref id="pcbi-0030160-b062"><label>62</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Durbin</surname><given-names>R</given-names></name><name name-style="western"><surname>Eddy</surname><given-names>SR</given-names></name><name name-style="western"><surname>Krogh</surname><given-names>A</given-names></name><name name-style="western"><surname>Mitchison</surname><given-names>GJ</given-names></name></person-group>
					<year>1998</year>
					<source>Biological sequence analysis</source>
					<publisher-loc>Cambridge (United Kingdom)</publisher-loc>
					<publisher-name>Cambridge University Press</publisher-name>
				</element-citation></ref><ref id="pcbi-0030160-b063"><label>63</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Henikoff</surname><given-names>S</given-names></name><name name-style="western"><surname>Henikoff</surname><given-names>JG</given-names></name></person-group>
					<year>1994</year>
					<article-title>Position-based sequence weights.</article-title>
					<source>J Mol Biol</source>
					<volume>243</volume>
					<fpage>574</fpage>
					<lpage>578</lpage>
				</element-citation></ref><ref id="pcbi-0030160-b064"><label>64</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Brenner</surname><given-names>SE</given-names></name><name name-style="western"><surname>Koehl</surname><given-names>P</given-names></name><name name-style="western"><surname>Levitt</surname><given-names>M</given-names></name></person-group>
					<year>2000</year>
					<article-title>The ASTRAL compendium for protein structure and sequence analysis.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>28</volume>
					<fpage>254</fpage>
					<lpage>256</lpage>
				</element-citation></ref><ref id="pcbi-0030160-b065"><label>65</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Eddy</surname><given-names>SR</given-names></name></person-group>
					<year>1998</year>
					<article-title>Profile hidden Markov models.</article-title>
					<source>Bioinformatics</source>
					<volume>14</volume>
					<fpage>755</fpage>
					<lpage>763</lpage>
				</element-citation></ref><ref id="pcbi-0030160-b066"><label>66</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Apweiler</surname><given-names>R</given-names></name><name name-style="western"><surname>Bairoch</surname><given-names>A</given-names></name><name name-style="western"><surname>Wu</surname><given-names>CH</given-names></name><etal/></person-group>
					<year>2004</year>
					<article-title>UniProt: The universal protein knowledgebase.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>32</volume>
					<fpage>D115</fpage>
					<lpage>D119</lpage>
				</element-citation></ref><ref id="pcbi-0030160-b067"><label>67</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Edgar</surname><given-names>RC</given-names></name></person-group>
					<year>2004</year>
					<article-title>MUSCLE: Multiple sequence alignment with high accuracy and high throughput.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>32</volume>
					<fpage>1792</fpage>
					<lpage>1797</lpage>
				</element-citation></ref><ref id="pcbi-0030160-b068"><label>68</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Karplus</surname><given-names>K</given-names></name><name name-style="western"><surname>Barrett</surname><given-names>C</given-names></name><name name-style="western"><surname>Hughey</surname><given-names>R</given-names></name></person-group>
					<year>1998</year>
					<article-title>Hidden Markov models for detecting remote protein homologies.</article-title>
					<source>Bioinformatics</source>
					<volume>14</volume>
					<fpage>846</fpage>
					<lpage>856</lpage>
				</element-citation></ref><ref id="pcbi-0030160-b069"><label>69</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Karplus</surname><given-names>K</given-names></name><name name-style="western"><surname>Karchin</surname><given-names>R</given-names></name><name name-style="western"><surname>Draper</surname><given-names>J</given-names></name><etal/></person-group>
					<year>2003</year>
					<article-title>Combining local-structure, fold-recognition, and new fold methods for protein structure prediction.</article-title>
					<source>Proteins</source>
					<volume>53</volume>
					<issue>Supplement 6</issue>
					<fpage>491</fpage>
					<lpage>496</lpage>
				</element-citation></ref><ref id="pcbi-0030160-b070"><label>70</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Altschul</surname><given-names>SF</given-names></name><name name-style="western"><surname>Gish</surname><given-names>W</given-names></name></person-group>
					<year>1996</year>
					<article-title>Local alignment statistics.</article-title>
					<source>Methods Enzymol</source>
					<volume>266</volume>
					<fpage>460</fpage>
					<lpage>480</lpage>
				</element-citation></ref><ref id="pcbi-0030160-b071"><label>71</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Eddy</surname><given-names>SR</given-names></name></person-group>
					<year>1997</year>
					<source>Maximum-likelihood fitting of extreme value distributions</source>
					<comment>Available: <ext-link ext-link-type="uri" xlink:href="http://selab.wustl.edu/publications/Eddy97b/Eddy97b-techreport.pdf" xlink:type="simple">http://selab.wustl.edu/publications/Eddy97b/Eddy97b-techreport.pdf</ext-link>. Accessed 13 July 2007.</comment>
				</element-citation></ref><ref id="pcbi-0030160-b072"><label>72</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Green</surname><given-names>R</given-names></name><name name-style="western"><surname>Brenner</surname><given-names>S</given-names></name></person-group>
					<year>2002</year>
					<article-title>Bootstrapping and normalization for enhanced evaluations of pairwise sequence comparison.</article-title>
					<source>Proc IEEE</source>
					<volume>9</volume>
					<fpage>1834</fpage>
					<lpage>1847</lpage>
				</element-citation></ref><ref id="pcbi-0030160-b073"><label>73</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Wolke</surname><given-names>R</given-names></name></person-group>
					<year>1992</year>
					<article-title>Iteratively reweighted least squares: A comparison of several single step algorithms for linear models.</article-title>
					<source>BIT</source>
					<volume>32</volume>
					<fpage>506</fpage>
					<lpage>524</lpage>
				</element-citation></ref><ref id="pcbi-0030160-b074"><label>74</label><element-citation publication-type="other" xlink:type="simple">
					<collab xlink:type="simple">R-Project</collab>
					<year>2005</year>
					<source>R: A language and environment for statistical computing</source>
					<comment>Available: <ext-link ext-link-type="uri" xlink:href="http://www.R-project.org" xlink:type="simple">http://www.R-project.org</ext-link>. Accessed 13 July 2007.</comment>
				</element-citation></ref><ref id="pcbi-0030160-b075"><label>75</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Glanville</surname><given-names>JG</given-names></name><name name-style="western"><surname>Kirshner</surname><given-names>D</given-names></name><name name-style="western"><surname>Krishnamurthy</surname><given-names>N</given-names></name><name name-style="western"><surname>Sjölander</surname><given-names>K</given-names></name></person-group>
					<year>2007</year>
					<article-title>Berkeley Phylogenics Group Web servers: Resources for structural phylogenomic analysis.</article-title>
					<source>Nucleic Acids Res</source>
					<comment>doi:<ext-link ext-link-type="doi" xlink:href="http://dx.doi.org/10.1093/nar/.gkm325" xlink:type="simple">10.1093/nar/.gkm325</ext-link></comment>
				</element-citation></ref></ref-list></back></article>