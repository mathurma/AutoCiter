<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
  <front>
    <journal-meta>
      <journal-id journal-id-type="publisher-id">plos</journal-id>
      <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
      <journal-id journal-id-type="pmc">ploscomp</journal-id>
      <journal-title-group>
        <journal-title>PLoS Computational Biology</journal-title>
      </journal-title-group>
      <issn pub-type="ppub">1553-734X</issn>
      <issn pub-type="epub">1553-7358</issn>
      <publisher>
        <publisher-name>Public Library of Science</publisher-name>
        <publisher-loc>San Francisco, USA</publisher-loc>
      </publisher>
    </journal-meta>
    <article-meta>
      <article-id pub-id-type="publisher-id">PCOMPBIOL-D-12-00210</article-id>
      <article-id pub-id-type="doi">10.1371/journal.pcbi.1002806</article-id>
      <article-categories>
        <subj-group subj-group-type="heading">
          <subject>Research Article</subject>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Biology</subject>
          <subj-group>
            <subject>Genetics</subject>
            <subj-group>
              <subject>Population genetics</subject>
              <subj-group>
                <subject>Natural selection</subject>
              </subj-group>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Theoretical biology</subject>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Statistics</subject>
            <subj-group>
              <subject>Biostatistics</subject>
              <subject>Statistical methods</subject>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline">
          <subject>Genetics and Genomics</subject>
          <subject>Mathematics</subject>
        </subj-group>
      </article-categories>
      <title-group>
        <article-title>SnIPRE: Selection Inference Using a Poisson Random Effects Model</article-title>
        <alt-title alt-title-type="running-head">SnIPRE</alt-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Eilertson</surname>
            <given-names>Kirsten E.</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
          <xref ref-type="corresp" rid="cor1">
            <sup>*</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Booth</surname>
            <given-names>James G.</given-names>
          </name>
          <xref ref-type="aff" rid="aff2">
            <sup>2</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Bustamante</surname>
            <given-names>Carlos D.</given-names>
          </name>
          <xref ref-type="aff" rid="aff3">
            <sup>3</sup>
          </xref>
        </contrib>
      </contrib-group>
      <aff id="aff1">
        <label>1</label>
        <addr-line>Bioinformatics Core, J David Gladstone Institutes, San Francisco, California, United States of America</addr-line>
      </aff>
      <aff id="aff2">
        <label>2</label>
        <addr-line>Department of Biological Statistics and Computational Biology, Cornell University, Ithaca, New York, United States of America</addr-line>
      </aff>
      <aff id="aff3">
        <label>3</label>
        <addr-line>Department of Genetics, Stanford University, Stanford, California, United States of America</addr-line>
      </aff>
      <contrib-group>
        <contrib contrib-type="editor" xlink:type="simple">
          <name name-style="western">
            <surname>Kosakovsky Pond</surname>
            <given-names>Sergei L.</given-names>
          </name>
          <role>Editor</role>
          <xref ref-type="aff" rid="edit1"/>
        </contrib>
      </contrib-group>
      <aff id="edit1">
        <addr-line>University of California San Diego, United States of America</addr-line>
      </aff>
      <author-notes>
        <corresp id="cor1">* E-mail: <email xlink:type="simple">cdbustam@stanford.edu</email></corresp>
        <fn fn-type="conflict">
          <p>The authors have declared that no competing interests exist.</p>
        </fn>
        <fn fn-type="con">
          <p>Analyzed the data: KEE. Wrote the paper: KEE CDB. Designed the software used in the analysis: KEE JGB CDB. Conceived and designed simulations: KEE CDB.</p>
        </fn>
      </author-notes>
      <pub-date pub-type="collection">
        <month>12</month>
        <year>2012</year>
      </pub-date>
      <pub-date pub-type="epub">
        <day>6</day>
        <month>12</month>
        <year>2012</year>
      </pub-date>
      <volume>8</volume>
      <issue>12</issue>
      <elocation-id>e1002806</elocation-id>
      <history>
        <date date-type="received">
          <day>2</day>
          <month>2</month>
          <year>2012</year>
        </date>
        <date date-type="accepted">
          <day>17</day>
          <month>10</month>
          <year>2012</year>
        </date>
      </history>
      <permissions>
        <copyright-year>2012</copyright-year>
        <copyright-holder>Eilertson et al</copyright-holder>
        <license xlink:type="simple">
          <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
        </license>
      </permissions>
      <abstract>
        <p>We present an approach for identifying genes under natural selection using polymorphism and divergence data from synonymous and non-synonymous sites within genes. A generalized linear mixed model is used to model the genome-wide variability among categories of mutations and estimate its functional consequence. We demonstrate how the model's estimated fixed and random effects can be used to identify genes under selection. The parameter estimates from our generalized linear model can be transformed to yield population genetic parameter estimates for quantities including the average selection coefficient for new mutations at a locus, the synonymous and non-synynomous mutation rates, and species divergence times. Furthermore, our approach incorporates stochastic variation due to the evolutionary process and can be fit using standard statistical software. The model is fit in both the empirical Bayes and Bayesian settings using the lme4 package in R, and Markov chain Monte Carlo methods in WinBUGS. Using simulated data we compare our method to existing approaches for detecting genes under selection: the McDonald-Kreitman test, and two versions of the Poisson random field based method MKprf. Overall, we find our method universally outperforms existing methods for detecting genes subject to selection using polymorphism and divergence data.</p>
      </abstract>
      <abstract abstract-type="summary">
        <title>Author Summary</title>
        <p>We present a new methodology, SnIPRE, for identifying genes under natural selection. SnIPRE is a “McDonald-Kreitman” type of analysis, in that it is based on MK table data and has an advantage over other types of statistics because it is robust to demography. Similar to the MKprf method, SnIPRE makes use of genome-wide information to increase power, but is non-parametric in the sense that it makes no assumptions (and does not require estimation) of parameters such as mutation rate and species divergence time in order to identify genes under selection. In simulations SnIPRE outperforms both the MK statistic and the two versions of MKprf considered. We then apply our method to <italic>Drosophila</italic> and human-chimp data.</p>
      </abstract>
      <funding-group>
        <funding-statement>This work has been funded by the National Science Foundation under grant NSF0516310. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
      </funding-group>
      <counts>
        <page-count count="14"/>
      </counts>
    </article-meta>
  </front>
  <body>
    <sec id="s1">
      <title>Introduction</title>
      <sec id="s1a">
        <title>Background</title>
        <p>Populations evolve over time and how they evolve is the product of different evolutionary forces. Population genetic theory gives us mathematical descriptions of how each of these forces is thought to affect the patterns of genetic variability within and between species. However, if the goal is not to start with an evolutionary model and see what happens, but rather to start with the data and understand what caused it one usually encounters an identifiability issue. For this reason, most population genetic data analyses looking for mutations under selection start by assuming a neutral population genetics model (constant population size, panmictic population, no migration), and test for deviations from this model. Commonly used examples of such procedures include tests based on summary statistics of the site frequency spectrum (distribution of mutation frequencies), such as Tajima's D <xref ref-type="bibr" rid="pcbi.1002806-Tajima1">[1]</xref>. However, since demographic factors (eg population growth) also effect the site frequency spectrum these tests are usually inconclusive. Tests based on linkage disequalibrium are also quite sensitive to demography as well as assumptions on recombination rates <xref ref-type="bibr" rid="pcbi.1002806-Nielsen1">[2]</xref>. The HKA statistic <xref ref-type="bibr" rid="pcbi.1002806-Hudson1">[3]</xref> makes use of divergence data as well as within species variation by estimating the variance of divergence to polymorphism ratios among loci. However, migration will result in a high variance of coalescent times among the loci, making the HKA test also sensitive to demography <xref ref-type="bibr" rid="pcbi.1002806-Nielsen2">[4]</xref>. See Nielsen 2005 <xref ref-type="bibr" rid="pcbi.1002806-Nielsen1">[2]</xref>, for an excellent review of these procedures.</p>
        <p>One class of tests which is generally robust to demography are those tests commonly referred to as “McDonald-Kreitman-type tests” <xref ref-type="bibr" rid="pcbi.1002806-Nielsen2">[4]</xref>. This class includes the McDonald-Kreitman (MK) test <xref ref-type="bibr" rid="pcbi.1002806-McDonald1">[5]</xref> as well as MKprf <xref ref-type="bibr" rid="pcbi.1002806-Bustamante1">[6]</xref>. The theory behind the MK test is developed in the following section.</p>
        <p>Unlike many of the tests mentioned above, the method we present here assumes no particular population genetic model - in other words it is a non-parametric approach. Similar to the MK statistic, it is also generally robust to demography. Our method, which we call SnIPRE for <italic>S</italic>electio<italic>n I</italic>nference using <italic>P</italic>oisson <italic>R</italic>andom <italic>E</italic>ffects, works by modeling the variation within and between species as a combination of four types of “effects”, one for each class of variation. These effects are functions of unknown population parameters of interest, including the selection coefficients.</p>
        <p>Previously, we have developed a suite of powerful approaches that can estimate the average strength of selection operating on a locus and/or the distribution of fitness effects under a specified population genetic setting for MK polymorhism and divergence data (see <xref ref-type="bibr" rid="pcbi.1002806-Bustamante2">[7]</xref>–<xref ref-type="bibr" rid="pcbi.1002806-Boyko1">[12]</xref>). A main advantage of the “MKprf” approach is that it is much more powerful than carrying out individual MK tests and then correcting for multiple tests. A perceived disadvantage to some investigators is that it requires specifying a population genetic model and then fitting the parameters of that model. Some investigators have also been concerned about the use of Bayesian priors on the distribution of effects and the impact these can have on inference <xref ref-type="bibr" rid="pcbi.1002806-Li1">[13]</xref>.</p>
        <p>There are two main advantages of SnIPRE over MK and MKprf, which we highlight here. The first is that it can reliably identify genes under weak and strong negative as well as positive selection without needing to specify a population genetic model a priori. Nonetheless, because it “borrows information” from the rest of the genome regarding the average and variance in polymorphism to divergence, it outperforms the one-at-time MK test. This gain in power is attributable to SnIPRE's use of a “James-Stein” class of estimator. The second advantage is that if one is willing to assume a particular population genetic model, it is possible to view the SnIPRE parameters as a re-parameterization of the population genetic model. With these additional assumptions, we can extend our inference beyond idenfication of genes that are not evolving according to the neutral theory, to quantification of strength and directionality of the selection forces.</p>
        <p>In this paper we will develop the model and the interpretation of its terms, and then describe how that model can be fit in both the empirical Bayes (SnIPRE) and fully Bayesian (B SnIPRE) settings. We also show how this model is robust to demographic history and recombination using standard coalescent simulations. Furthermore, we demonstrate how the Poisson Random Field estimates of average selection intensity, species-split time, mutation rate, and degree of selective constraint at the locus can be “extracted” directly from the SnIPRE estimates. We then compare the SnIPRE methods to the MK statistic and MKprf methods in detecting and estimating selection and other population parameters in simulations, and apply SnIPRE to data from a <italic>Drosophila</italic> comparison and human-chimp comparison.</p>
      </sec>
      <sec id="s1b">
        <title>The MK statistic</title>
        <p>Because SnIPRE works by picking up on the same type of signature of selection as the MK statistic, we will start with a review of this method and the theory behind it. While most techniques to identify loci under selection require assumptions about demography (particularly constant population size and no substructure), the MK statistic does not. Like the HKA statistic, it works by comparing divergence information between inferred neutral sites (such as synonymous sites in a protein-coding gene) and sites potentially under selection (such as non-synonymous sites at the same gene). Strictly speaking, the test is a test of the neutral protein evolution hypothesis which states that the vast majority of evolutionary changes at the molecular level are caused by random drift of selectively neutral mutants (not affecting fitness) <xref ref-type="bibr" rid="pcbi.1002806-Kimura1">[14]</xref>. Although very tempting, the test itself does not allow for inference about the type of selection (negative, positive, or balancing). For example, as noted in original paper, negative selection in recently expanding populations may appear as positive selection. Thus, without additional assumptions on population dynamics the direction cannot be inferred. There have been notable extensions to the MK test, including using non-coding sites whereby upstream regions of a gene are compared to neighboring introns or synonymous sites <xref ref-type="bibr" rid="pcbi.1002806-Andolfatto1">[15]</xref>. Another extension is the estimator <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e001" xlink:type="simple"/></inline-formula>, <xref ref-type="bibr" rid="pcbi.1002806-Smith1">[16]</xref> which estimates the the proportion of amino-acid substititutes which are driven by adaptive selection. These extensions, and the additional set of assumptions they require, are not considered here.</p>
        <p>In its traditional form the MK table consists of counts for four categories of mutations which occur in the coding region of a gene: polymorphic synonymous, divergent synonymous, polymorphic non-synonymous, and divergent non-synonymous, see <xref ref-type="table" rid="pcbi-1002806-t001">Table 1</xref>. A mutation that occurs in every individual in the sample from one species is considered divergent, otherwise considered polymorphic. A mutation that occurs where it changes the amino acid produced is considered non-synonymous, otherwise considered synonymous. If the mutations are neutral, one would expect the ratio of polymorphic synonymous (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e002" xlink:type="simple"/></inline-formula>) to divergent synonymous (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e003" xlink:type="simple"/></inline-formula>) mutations to be the same as the ratio of polymorphic non-synonymous (<italic>PN</italic>) to divergent non-synonymous (<italic>DN</italic>) mutations, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e004" xlink:type="simple"/></inline-formula>. If this is not true, then we are seeing either an excess of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e005" xlink:type="simple"/></inline-formula> mutations, or shortage <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e006" xlink:type="simple"/></inline-formula> mutations. Intuitively, it makes sense to consider an excess of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e007" xlink:type="simple"/></inline-formula> as evidence supporting positive selection as it appears that mutations that change the amino acid are being fixed in the population at a higher rate. Alternatively, a shortage of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e008" xlink:type="simple"/></inline-formula> could be considered as evidence of negative selection as it would appear as though mutations that change the amino acid are being fixed at a lower rate. This interpretation of the data is fairly straightforward considering an additive model of selection with stationary population sizes. However, as mentioned above and as discussed in <xref ref-type="bibr" rid="pcbi.1002806-EyreWalker1">[17]</xref>, asessment of directionality from the MK statistics should be used with caution as it is sensitive to changing population dynamics. It should be noted, however, that in the case of strong negative (i.e. purifying) selection, the signature will be less clear in an MK table since mutations are not likely to segegrate in the population long enough to contribute to the polymorphism count. Thus, in the case of strong negative selection a reduction in the number of both polymorphic and divergent non-synonymous mutations is to be expected, and the MK test will have reduced power to detect this type of selection.</p>
        <table-wrap id="pcbi-1002806-t001" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002806.t001</object-id>
          <label>Table 1</label>
          <caption>
            <title>MK table.</title>
          </caption>
          <alternatives>
            <graphic id="pcbi-1002806-t001-1" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002806.t001" xlink:type="simple"/>
            <table>
              <colgroup span="1">
                <col align="left" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <td align="left" rowspan="1" colspan="1"/>
                  <td colspan="2" align="left" rowspan="1">MK</td>
                  <td colspan="2" align="left" rowspan="1">SnIPRE</td>
                  <td align="left" rowspan="1" colspan="1"/>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1"/>
                  <td align="left" rowspan="1" colspan="1">Polymorphic</td>
                  <td align="left" rowspan="1" colspan="1">Divergent</td>
                  <td align="left" rowspan="1" colspan="1">Polymorphic</td>
                  <td align="left" rowspan="1" colspan="1">Divergent</td>
                  <td align="left" rowspan="1" colspan="1"/>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Synonymous</td>
                  <td align="left" rowspan="1" colspan="1">PS</td>
                  <td align="left" rowspan="1" colspan="1">DS</td>
                  <td align="left" rowspan="1" colspan="1">
                    <inline-formula>
                      <inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e009" xlink:type="simple"/>
                    </inline-formula>
                  </td>
                  <td align="left" rowspan="1" colspan="1">
                    <inline-formula>
                      <inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e010" xlink:type="simple"/>
                    </inline-formula>
                  </td>
                  <td align="left" rowspan="1" colspan="1">
                    <inline-formula>
                      <inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e011" xlink:type="simple"/>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Non-Synonymous</td>
                  <td align="left" rowspan="1" colspan="1">PN</td>
                  <td align="left" rowspan="1" colspan="1">DN</td>
                  <td align="left" rowspan="1" colspan="1">
                    <inline-formula>
                      <inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e012" xlink:type="simple"/>
                    </inline-formula>
                  </td>
                  <td align="left" rowspan="1" colspan="1">
                    <inline-formula>
                      <inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e013" xlink:type="simple"/>
                    </inline-formula>
                  </td>
                  <td align="left" rowspan="1" colspan="1">
                    <inline-formula>
                      <inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e014" xlink:type="simple"/>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1"/>
                  <td align="left" rowspan="1" colspan="1"/>
                  <td align="left" rowspan="1" colspan="1">
                    <inline-formula>
                      <inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e015" xlink:type="simple"/>
                    </inline-formula>
                  </td>
                  <td align="left" rowspan="1" colspan="1"/>
                  <td align="left" rowspan="1" colspan="1"/>
                  <td align="left" rowspan="1" colspan="1"/>
                </tr>
              </tbody>
            </table>
          </alternatives>
          <table-wrap-foot>
            <fn id="nt101">
              <label/>
              <p>Notation used for the MK statistic and SnIPRE. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e016" xlink:type="simple"/></inline-formula> = the number of mutations a gene has in category <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e017" xlink:type="simple"/></inline-formula>; <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e018" xlink:type="simple"/></inline-formula> = 1 if the mutations are non-synonymous, 0 otherwise; <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e019" xlink:type="simple"/></inline-formula> = 1 if the mutations are divergent, 0 otherwise.</p>
            </fn>
          </table-wrap-foot>
        </table-wrap>
        <p>McDonald and Kreitman <xref ref-type="bibr" rid="pcbi.1002806-McDonald2">[18]</xref> use Fisher's exact test of independence on MK tables to identify genes under selection. This test can be justified using coalescent theory where we have the additional assumptions of i) no recombination within a gene ii) all mutations are selectively neutral <xref ref-type="bibr" rid="pcbi.1002806-Wakeley1">[19]</xref>. In this setting, the MK test constitutes a test of this second assumption. Under the coalescent theory model, mutations are Poisson distributed across a gene genealogy with expected value <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e020" xlink:type="simple"/></inline-formula> across a geneology of length <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e021" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e022" xlink:type="simple"/></inline-formula> is the mutation rate. Thus, conditioning on the total mutations (sufficient statistic for tree length) we have that<disp-formula id="pcbi.1002806.e023"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002806.e023" xlink:type="simple"/></disp-formula>We wish to test <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e024" xlink:type="simple"/></inline-formula>, the probability that a synonymous mutation appears fixed is the same as the probability that a non-synonymous mutation appears fixed in the sample. Under this null hypothesis, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e025" xlink:type="simple"/></inline-formula> follows a hypergeometric distribution with parameters, (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e026" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e027" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e028" xlink:type="simple"/></inline-formula>).<disp-formula id="pcbi.1002806.e029"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002806.e029" xlink:type="simple"/></disp-formula>As long as the non-synonymous and synonymous sites are interspersed among each other, they will be similarly affected by demography and have the same distribution of coalescent times, thus the test is robust to demography.</p>
        <p>Motivated by the MK statistic, the SnIPRE framework uses the MK table polymorphism and divergence data for identifying genes under selection. Using generalized linear mixed models we incorporate genome wide effects into our analysis as fixed effects, and individual gene effects as random effects. This method allows us to pool information across genes which increases our power to detect those under selection.</p>
        <p>MKprf is another method that was developed by us which directly estimates the posterior distributions of genomic parameters, such as the species divergence time, based on the MK tables' synonymous cell entries. The posterior of the selection coefficients for each gene are then calculated conditional on these genomic parameters and the non-synonymous cell entries in the MK table, see <xref ref-type="bibr" rid="pcbi.1002806-Bustamante2">[7]</xref>.</p>
      </sec>
    </sec>
    <sec id="s2" sec-type="methods">
      <title>Methods</title>
      <sec id="s2a">
        <title>Data</title>
        <p>The data consists of MK table counts for each gene, as well as the total number of synonymous sites and non-synonymous sites surveyed. Incorporating the number of sites into our model allows us to extend our inference beyond non-synonymous and divergent interaction effects to include effects due to changes in the mutation rate, both in the synonymous and non-synonymous sites.</p>
      </sec>
      <sec id="s2b">
        <title>Model</title>
        <p>Let <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e030" xlink:type="simple"/></inline-formula> be number of genes in the sample. Thus we have <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e031" xlink:type="simple"/></inline-formula> mutation counts <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e032" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e033" xlink:type="simple"/></inline-formula> if the mutation is non-synonymous, 0 otherwise, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e034" xlink:type="simple"/></inline-formula> if the mutation is fixed in the sample among the two populations being compared, 0 otherwise, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e035" xlink:type="simple"/></inline-formula> according to gene identification number. The mutation counts are assumed to be Poisson distributed, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e036" xlink:type="simple"/></inline-formula>, conditional on the covariates. The log of the expected mutation count is modeled using a generalized linear mixed effects model. The fixed effects include an intercept, an effect if the mutation is non-synonymous, an effect if the mutation is fixed, and an interaction effect if the mutation is both fixed and non-synonymous. Additionally the model includes four random effects: a gene effect, and the two-way and three-way interactions between the gene, non-synonymous, and divergence effects. An offset term is used to control for the number of sites sampled in the gene where a mutation of type <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e037" xlink:type="simple"/></inline-formula> could occur, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e038" xlink:type="simple"/></inline-formula> for synonymous mutations, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e039" xlink:type="simple"/></inline-formula> for non-synonymous mutations.<disp-formula id="pcbi.1002806.e040"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002806.e040" xlink:type="simple"/><label>(1)</label></disp-formula></p>
        <p>By using fixed and random effects in the model we are assuming that these gene-specific effects come from some distribution, and that distribution is estimated from the data. The use of mixed effects is particularly relevant in this setting where it capitalizes on the fact that genes share a phylogeny. Thus, even though the mutation rate, coalescent times, constraint and selection forces will vary across genes, the distribution of the influence of these forces across genes can be well estimated by viewing the data set as a whole. From this perspective we estimate the fixed effect terms (genome-wide average estimates) of our model, as well as the variability in the distribution in of the random (gene-specific) effect terms of the model. The random effects, or gene-specific parameters, are then estimated given this context. Below we describe how the terms in this model allow us to estimate for any given gene the average effect of mutation, divergence, constraint and selection levels over time.</p>
        <p>Of primary interest is identifying genes under selection, either positive or negative. Identification of these genes can be done quite easily in the SnIPRE framework with only the assumptions of the MK test: i. synonymous and non-synonymous sites sampled are interspersed; ii. synonymous sites are not under selection. The non-synonymous-divergent interaction effects, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e041" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e042" xlink:type="simple"/></inline-formula>, capture an average genome-wide selection effect and the gene-specific selection effects. The gene-specific selection effect <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e043" xlink:type="simple"/></inline-formula> for a particular gene <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e044" xlink:type="simple"/></inline-formula>, captures how the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e045" xlink:type="simple"/></inline-formula> gene varies from the average selection effect, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e046" xlink:type="simple"/></inline-formula>, of all genes included in the sample. The <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e047" xlink:type="simple"/></inline-formula> gene's selection effect relative to neutrality is reflected in the sum of these two interaction terms, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e048" xlink:type="simple"/></inline-formula>. Thus, we refer to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e049" xlink:type="simple"/></inline-formula> as the <italic>selection effect</italic> for the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e050" xlink:type="simple"/></inline-formula> gene. For example, an estimated <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e051" xlink:type="simple"/></inline-formula> of greater than 0, say 0.5, means that the expected selection coefficient for a gene from that data set is positive. A gene-specific selection effect, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e052" xlink:type="simple"/></inline-formula>, may be negative, say −0.3, indicating that the estimated selection effect for that gene is lower than the average for genes in the data set. The estimated selection effect on that gene relative to neutrality (zero being neutral) is the sum of these two effects. In this example, the estimate would be positive, 0.5+(−0.3) = 0.2.</p>
        <p>The other terms in the SnIPRE model are also quite interpretable. The interecept and the gene specific effect, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e053" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e054" xlink:type="simple"/></inline-formula> reflect the mutation rate. Here again the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e055" xlink:type="simple"/></inline-formula> term captures how the mutation rate for the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e056" xlink:type="simple"/></inline-formula> gene varies from the average mutation rate of the genes in the sample, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e057" xlink:type="simple"/></inline-formula>. We refer to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e058" xlink:type="simple"/></inline-formula> as the <italic>gene effect</italic>. Similarly, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e059" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e060" xlink:type="simple"/></inline-formula> reflect divergence time, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e061" xlink:type="simple"/></inline-formula> is referred to as the <italic>divergence effect</italic>. The proportion of non-synonmyous mutations that are non-lethal are reflected in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e062" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e063" xlink:type="simple"/></inline-formula>. We refer to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e064" xlink:type="simple"/></inline-formula> as the <italic>constraint effect</italic>. These relationships are summarized in <xref ref-type="table" rid="pcbi-1002806-t002">Table 2</xref>. A precise relationship between these model parameters and the evolutionary parameters that influence them is defined the Poisson Random Field framework and discussed in the next section. Examples of the interpretation of these model parameters is provided in the application section.</p>
        <table-wrap id="pcbi-1002806-t002" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002806.t002</object-id>
          <label>Table 2</label>
          <caption>
            <title>SnIPRE coefficients and population genetic parameters.</title>
          </caption>
          <alternatives>
            <graphic id="pcbi-1002806-t002-2" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002806.t002" xlink:type="simple"/>
            <table>
              <colgroup span="1">
                <col align="left" span="1"/>
                <col align="center" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Terms</td>
                  <td align="left" rowspan="1" colspan="1">Related parameters</td>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <inline-formula>
                      <inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e065" xlink:type="simple"/>
                    </inline-formula>
                  </td>
                  <td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e066" xlink:type="simple"/></inline-formula>, mutation rate for the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e067" xlink:type="simple"/></inline-formula> gene</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <inline-formula>
                      <inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e068" xlink:type="simple"/>
                    </inline-formula>
                  </td>
                  <td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e069" xlink:type="simple"/></inline-formula>, divergence time for the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e070" xlink:type="simple"/></inline-formula> gene</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <inline-formula>
                      <inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e071" xlink:type="simple"/>
                    </inline-formula>
                  </td>
                  <td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e072" xlink:type="simple"/></inline-formula>, proportion of non-synonymousmutations that are non-lethal for the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e073" xlink:type="simple"/></inline-formula> gene</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1"/>
                  <td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e074" xlink:type="simple"/></inline-formula>, selection coefficient for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e075" xlink:type="simple"/></inline-formula> gene</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <inline-formula>
                      <inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e076" xlink:type="simple"/>
                    </inline-formula>
                  </td>
                  <td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e077" xlink:type="simple"/></inline-formula>, selection coefficient for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e078" xlink:type="simple"/></inline-formula> gene</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1"/>
                  <td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e079" xlink:type="simple"/></inline-formula>, divergence time for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e080" xlink:type="simple"/></inline-formula> gene</td>
                </tr>
              </tbody>
            </table>
          </alternatives>
          <table-wrap-foot>
            <fn id="nt102">
              <label/>
              <p>Summary of the relationship between SnIPRE coefficients and population genetic parameters.</p>
            </fn>
          </table-wrap-foot>
        </table-wrap>
        <p>We fit this model in R <xref ref-type="bibr" rid="pcbi.1002806-R1">[20]</xref> using the lme4 package <xref ref-type="bibr" rid="pcbi.1002806-Bates1">[21]</xref>, and a Bayesian implementation is also fit using WinBUGS <xref ref-type="bibr" rid="pcbi.1002806-Lunn1">[22]</xref>, <xref ref-type="bibr" rid="pcbi.1002806-Sturtz1">[23]</xref>. In the Bayesian setting (B SnIPRE) we construct credible intervals for these effects based on the MCMC samples (other packages may be used instead to fit the model, e.g. the R package MCMCglmm <xref ref-type="bibr" rid="pcbi.1002806-Hadfield1">[24]</xref> or JAGS <xref ref-type="bibr" rid="pcbi.1002806-Plummer1">[25]</xref>). In the empirical Bayes setting (SnIPRE) confidence intervals are constructed for the random effect estimates based on the standard errors. When fitting SnIPRE using the lme4 package we specified a general (unstructured) covariance. Using a structure other than a general covariance structure presupposes a functional form, e.g. a covariance matrix with the off-diagonal elements all zero would indicate that the gene specific effects are independent of each other. Incorrectly assuming a particular form would lead to spurious results, and the the property of best linear unbiased estimates would no longer hold for the model coefficients. While inference would be more powerful if the correct form of the covariance matrix was known, the unstructured covariance allows for conservative estimation directly from the data. In practice we have found that allowing the general covariance structure versus assuming the random effects are independent of each other greatly improves the fit of the model and improves the prediction of genes under selection. Modeling a general covariance structure makes sense intuitively. For example, for a particular gene the non-synonymous and selection effects are especially likely to be correlated as selection affects the amount of time a non-synonymous mutation exists as a polymorphism before becoming fixed or eliminated. The selection effect reflects the selection coefficient <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e081" xlink:type="simple"/></inline-formula>, and the non-synonymous effect reflects mutation constraint, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e082" xlink:type="simple"/></inline-formula>. Because of this relationship, one may be interested in examining the joint distribution for these estimated effects for a particular gene. This is easily accomplished in the Bayesian setting using the MCMC chains. As an example, see <xref ref-type="fig" rid="pcbi-1002806-g001">Figure 1</xref>.</p>
        <fig id="pcbi-1002806-g001" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002806.g001</object-id>
          <label>Figure 1</label>
          <caption>
            <title>Example joint distribution of the estimated selection effect and the constraint effect for a particular gene.</title>
            <p>Data simulated using PRFREQ. The blue asterisk denotes the true location of parameters.</p>
          </caption>
          <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002806.g001" position="float" xlink:type="simple"/>
        </fig>
        <p>For the Bayesian model the fixed effects have Normal priors with mean <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e083" xlink:type="simple"/></inline-formula>, and precision <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e084" xlink:type="simple"/></inline-formula>. The priors for the random effects for each gene were multivariate normal with mean <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e085" xlink:type="simple"/></inline-formula>, and precision <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e086" xlink:type="simple"/></inline-formula>. The precision matrix is modeled as a hyperparameter in order to estimate the covariance structrue among the random effects. Using the conjugate prior, the Wishart disribution, we set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e087" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e088" xlink:type="simple"/></inline-formula> is the identity matrix. Because the mutation counts are low these priors are considered non-informative.</p>
        <p>An alternative formulation of the Bayesian model using hierarchical centering maybe be preferable as it results in quicker convergence <xref ref-type="bibr" rid="pcbi.1002806-Gelfand1">[26]</xref>. In the hierarchical centering formulation the fixed effects appear as hyper parameters about which the random effects are centered. The models are equivalent and as long as convergence criteria are met will yield the same inference.</p>
      </sec>
      <sec id="s2c">
        <title>Coalescent and Poisson random field frameworks</title>
        <p>In standard coalescent theory we have <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e089" xlink:type="simple"/></inline-formula> lineages coalescing at time points exponentially distributed with rate equal to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e090" xlink:type="simple"/></inline-formula>. The number of segregating sites follows a Poisson process with rate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e091" xlink:type="simple"/></inline-formula> per unit of time. Conditioning on the length of genealogy, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e092" xlink:type="simple"/></inline-formula>, which is a function of the coalescent times, the number of segregating sites is Poisson distributed with mean <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e093" xlink:type="simple"/></inline-formula>. Thus, we have the expected mutation count, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e094" xlink:type="simple"/></inline-formula>, is a function of the sample coalescent times, as well as the mutation rate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e095" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pcbi.1002806-Wakeley1">[19]</xref>. Additionally, the expected mutation count should be adjusted for constraint, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e096" xlink:type="simple"/></inline-formula>, and selection <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e097" xlink:type="simple"/></inline-formula>. This is consistent with our model where the effects of mutation rate and divergence is estimated from the synonymous mutations, and constraint and selection are estimated from the non-synonymous.</p>
        <p>Our model also works well in the Poisson random field (PRF) framework which assumes i. mutations arise at exponentially distributed times, ii. each mutation occurs at a new site, and iii. each mutant follows and independent Wright-Fisher process (no linkage)<xref ref-type="bibr" rid="pcbi.1002806-Sawyer2">[27]</xref>. SnIPRE can be viewed as a re-parameterization of the PRF framework. Thus it is convenient to use the relationships between the SnIPRE coefficients and the PRF model to obtain estimates of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e098" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e099" xlink:type="simple"/></inline-formula>, where 1+s is the fitness of mutants, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e100" xlink:type="simple"/></inline-formula> is the effective population size), as well as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e101" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e102" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e103" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e104" xlink:type="simple"/></inline-formula> where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e105" xlink:type="simple"/></inline-formula> is the nucleotide mutation rate). We can derive the relationship between the population genetic parameters and the SnIPRE coefficients by comparing the predicted MK table counts provided by SnIPRE, see <xref ref-type="table" rid="pcbi-1002806-t003">Table 3</xref>, which are written in terms of model coefficients, to the theoretical expected MK table counts given in <xref ref-type="table" rid="pcbi-1002806-t004">Table 4</xref>. These relationships are derived below; <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e106" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e107" xlink:type="simple"/></inline-formula> represent the number of samples from the population of interest and the outgroup.</p>
        <table-wrap id="pcbi-1002806-t003" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002806.t003</object-id>
          <label>Table 3</label>
          <caption>
            <title>SnIPRE predicted mutation counts.</title>
          </caption>
          <alternatives>
            <graphic id="pcbi-1002806-t003-3" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002806.t003" xlink:type="simple"/>
            <table>
              <colgroup span="1">
                <col align="left" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <td align="left" rowspan="1" colspan="1"/>
                  <td align="left" rowspan="1" colspan="1">Polymorphic</td>
                  <td align="left" rowspan="1" colspan="1">Divergent</td>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Syn</td>
                  <td align="left" rowspan="1" colspan="1">
                    <inline-formula>
                      <inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e108" xlink:type="simple"/>
                    </inline-formula>
                  </td>
                  <td align="left" rowspan="1" colspan="1">
                    <inline-formula>
                      <inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e109" xlink:type="simple"/>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Non-syn</td>
                  <td align="left" rowspan="1" colspan="1">
                    <inline-formula>
                      <inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e110" xlink:type="simple"/>
                    </inline-formula>
                  </td>
                  <td align="left" rowspan="1" colspan="1">
                    <inline-formula>
                      <inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e111" xlink:type="simple"/>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1"/>
                  <td align="left" rowspan="1" colspan="1"/>
                  <td align="left" rowspan="1" colspan="1">
                    <inline-formula>
                      <inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e112" xlink:type="simple"/>
                    </inline-formula>
                  </td>
                </tr>
              </tbody>
            </table>
          </alternatives>
          <table-wrap-foot>
            <fn id="nt103">
              <label/>
              <p>The predicted mutation counts expressed in terms of the number of synonymous and non-synonymous sites sampled <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e113" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e114" xlink:type="simple"/></inline-formula>, the gene effect <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e115" xlink:type="simple"/></inline-formula>, nonsynonymous effect <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e116" xlink:type="simple"/></inline-formula>, divergent effect <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e117" xlink:type="simple"/></inline-formula>, and their interactions.</p>
            </fn>
          </table-wrap-foot>
        </table-wrap>
        <table-wrap id="pcbi-1002806-t004" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002806.t004</object-id>
          <label>Table 4</label>
          <caption>
            <title>Expected mutation counts.</title>
          </caption>
          <alternatives>
            <graphic id="pcbi-1002806-t004-4" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002806.t004" xlink:type="simple"/>
            <table>
              <colgroup span="1">
                <col align="left" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <td align="left" rowspan="1" colspan="1"/>
                  <td align="left" rowspan="1" colspan="1">Polymorphic</td>
                  <td align="left" rowspan="1" colspan="1">Divergent</td>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Syn</td>
                  <td align="left" rowspan="1" colspan="1">
                    <inline-formula>
                      <inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e118" xlink:type="simple"/>
                    </inline-formula>
                  </td>
                  <td align="left" rowspan="1" colspan="1">
                    <inline-formula>
                      <inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e119" xlink:type="simple"/>
                    </inline-formula>
                  </td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Non-syn</td>
                  <td align="left" rowspan="1" colspan="1">
                    <inline-formula>
                      <inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e120" xlink:type="simple"/>
                    </inline-formula>
                  </td>
                  <td align="left" rowspan="1" colspan="1">
                    <inline-formula>
                      <inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e121" xlink:type="simple"/>
                    </inline-formula>
                  </td>
                </tr>
              </tbody>
            </table>
          </alternatives>
          <table-wrap-foot>
            <fn id="nt104">
              <label/>
              <p>
                <inline-formula>
                  <inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e122" xlink:type="simple"/>
                </inline-formula>
              </p>
            </fn>
            <fn id="nt105">
              <label/>
              <p>
                <inline-formula>
                  <inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e123" xlink:type="simple"/>
                </inline-formula>
              </p>
            </fn>
            <fn id="nt106">
              <label/>
              <p>
                <inline-formula>
                  <inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e124" xlink:type="simple"/>
                </inline-formula>
              </p>
            </fn>
            <fn id="nt107">
              <label/>
              <p>The expected mutation counts expressed in terms of the number of synonymous and non-synonymous sites sampled <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e125" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e126" xlink:type="simple"/></inline-formula>, selection coefficient <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e127" xlink:type="simple"/></inline-formula>, the species-split time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e128" xlink:type="simple"/></inline-formula>, the mutation rate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e129" xlink:type="simple"/></inline-formula>, the proportion of lethal non-lethal mutations <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e130" xlink:type="simple"/></inline-formula>, and the number of samples in the population of interest and the outgroup <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e131" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e132" xlink:type="simple"/></inline-formula>, according to the Poisson Random Field framework.</p>
            </fn>
          </table-wrap-foot>
        </table-wrap>
        <p>The gene effect <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e133" xlink:type="simple"/></inline-formula>, is a function of the mutation rate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e134" xlink:type="simple"/></inline-formula>.<disp-formula id="pcbi.1002806.e135"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002806.e135" xlink:type="simple"/><label>(2)</label></disp-formula></p>
        <p>The divergence effect, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e136" xlink:type="simple"/></inline-formula>, is a function of the divergence time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e137" xlink:type="simple"/></inline-formula>.<disp-formula id="pcbi.1002806.e138"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002806.e138" xlink:type="simple"/><label>(3)</label></disp-formula><disp-formula id="pcbi.1002806.e139"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002806.e139" xlink:type="simple"/><label>(4)</label></disp-formula></p>
        <p>The selection effect <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e140" xlink:type="simple"/></inline-formula>, is a function of the selection coefficient <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e141" xlink:type="simple"/></inline-formula>, and the time to the most recent common ancestor <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e142" xlink:type="simple"/></inline-formula>.<disp-formula id="pcbi.1002806.e143"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002806.e143" xlink:type="simple"/><label>(5)</label></disp-formula><disp-formula id="pcbi.1002806.e144"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002806.e144" xlink:type="simple"/><label>(6)</label></disp-formula>The selection effect reflects the interaction of the non-synonymous and divergent effects on the expected mutation count. Under the PRF framework we assume a neutral demography. Thus, a positive (negative) selection effect corresponds to a positive (negative) selection coefficient. That positive (negative) selection leads to the higher (lower) rate of fixation for non-synonymous mutations makes sense intuitively. A positive selection effect indicates that mutations that are non-synonymous are being fixed at a higher rate than expected under the null hypothesis of no selection. A negative selection effect indicates that mutations that are non-synonymous are being fixed at a slower rate than expected.</p>
        <p>The non-synonymous effect, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e145" xlink:type="simple"/></inline-formula>, may also be thought of as a constraint effect since it is a function of the proportion of non-synonymous mutations that are non-lethal <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e146" xlink:type="simple"/></inline-formula>, as well as the selection coefficient, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e147" xlink:type="simple"/></inline-formula>.<disp-formula id="pcbi.1002806.e148"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002806.e148" xlink:type="simple"/><label>(7)</label></disp-formula><disp-formula id="pcbi.1002806.e149"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002806.e149" xlink:type="simple"/><label>(8)</label></disp-formula>The constraint effect, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e150" xlink:type="simple"/></inline-formula>, reflects the effect that mutations being non-synonymous (versus synonymous) has on the expected count. A negative (positive) constraint effect indicates that non-synonymous polymorphic mutations are either being fixed or eliminated at a higher (lower) rate than synonymous mutations. Thus, after estimating the selection coefficient to account for the rate at which non-synonymous mutations are fixed, we can estimate from the constraint effect the proportion of mutations that are lethal, and therefore quickly eliminated from the population. While the selection effect is useful for identifying selection on mildly deleterious mutations as well as advantageous mutations, the constraint effect can be used to identify cases of strong negative or purifying selection.</p>
        <p>It is interesting to note that these are the relationships used by Sawyer and Hartl (1992) to fit their single locus PRF models to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e151" xlink:type="simple"/></inline-formula> MK data. What is different about our approach is that we do not require a PRF parameterization for inference; rather, it naturally falls out from consideration of the standard log-linear model analysis of multi-way contigency tables. Several of the simulations in the next section are done in the PRF framework using PRFREQ <xref ref-type="bibr" rid="pcbi.1002806-Boyko1">[12]</xref>. Also included are several simulations using SFS_CODE <xref ref-type="bibr" rid="pcbi.1002806-Hernandez1">[28]</xref> that show our estimation of population genetic parameters to be fairly robust to the PRF assumption of no linkage between sites. Specifically, the false positive rate remains low for identification of genes under selection. The primary consequence of linkage is underestimation of the magnitude of selection. We plan to explore these results more in a later paper.</p>
      </sec>
    </sec>
    <sec id="s3">
      <title>Results/Discussion</title>
      <p>To assess and compare the performance of the SnIPRE methods against the MK statistic and MKprf method we simulated data using 3 different methods. The first method, based on coalescent theory, was implemented in R. The second method, PRFREQ, simulates data based on the PRF framework. The third method is a forward simulation method, SFS_CODE. In these simulations our first goal was to compare the false positive rates of the methods using simulations under neutrality. Additionally, we simulated data with selective constraint but without selection which illustrates SnIPRE's ability to distinguish between mutational constraint and selection. Using PRFREQ, we were also able to simulate data sets with a distribution of selection coefficients and use this to compare the methods in a litany of non-neutral settings.</p>
      <p>For the results reported below, the MK test (Fisher's exact test) was applied and the resulting p-value left unadjusted for multiple testing, significance was determined by an <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e152" xlink:type="simple"/></inline-formula> cutoff. For B SnIPRE, and the two versions of the MKprf significance was evaluated based on the posterior distributions; if at least 97.5% of the posterior distribution lay to one side of zero, the estimate was deemed significant. This cutoff was chosen to correspond to a two-sided test at <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e153" xlink:type="simple"/></inline-formula> level. For SnIPRE, significance was established based on the standard error and estimate of the effect of interest. A more precise calculation of the significance of an effect is possible in the empirical Bayes framework by estimating the profile likelihood via Laplace approximations. This estimation procedure is not discussed here.</p>
      <sec id="s3a">
        <title>Simulations under neutrality</title>
        <p>To assess false positive rate FPR for each of the methods, we simulated data using standard coalescent theory. In <xref ref-type="table" rid="pcbi-1002806-t005">Table 5</xref>, we report the false positive rate for a data set with 1,000 neutrally evolving genes simulated from a pair of populations of constant size that split <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e154" xlink:type="simple"/></inline-formula> generations ago, with mutation rate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e155" xlink:type="simple"/></inline-formula>. The standard MK approach had an FPR = 0.02. SnIPRE performed very well with an FPR<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e156" xlink:type="simple"/></inline-formula>0.001 for both the Bayesian and empirical Bayes approaches. MKprf had mixed performance, depending on assumptions regarding the variance of the distribution of fitness effects. For fixed variance, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e157" xlink:type="simple"/></inline-formula>, the FPR = 0.14 which is relatively high. This is a mode of MKprf that has a very wide prior distribution that is not updated by information from other loci. When that information is incorporated we see that MKprf (estimated <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e158" xlink:type="simple"/></inline-formula>) also has a low FPR, 0.012.</p>
        <table-wrap id="pcbi-1002806-t005" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002806.t005</object-id>
          <label>Table 5</label>
          <caption>
            <title>False positive rate.</title>
          </caption>
          <alternatives>
            <graphic id="pcbi-1002806-t005-5" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002806.t005" xlink:type="simple"/>
            <table>
              <colgroup span="1">
                <col align="left" span="1"/>
                <col align="center" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Method</td>
                  <td align="left" rowspan="1" colspan="1">False Positive Rate</td>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left" rowspan="1" colspan="1">SnIPRE</td>
                  <td align="left" rowspan="1" colspan="1">0.00</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">B SnIPRE</td>
                  <td align="left" rowspan="1" colspan="1">0.00</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">MKprf (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e159" xlink:type="simple"/></inline-formula>)</td>
                  <td align="left" rowspan="1" colspan="1">0.14</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">MKprf (estimated <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e160" xlink:type="simple"/></inline-formula>)</td>
                  <td align="left" rowspan="1" colspan="1">0.01</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">MK</td>
                  <td align="left" rowspan="1" colspan="1">0.02</td>
                </tr>
              </tbody>
            </table>
          </alternatives>
          <table-wrap-foot>
            <fn id="nt108">
              <label/>
              <p>False positive rate in a data set of 1000 genes simulated using the coalescent method.</p>
            </fn>
          </table-wrap-foot>
        </table-wrap>
        <p>Next we investigated the impact of demographic history as well as recombination on the FPR of the methods using the forward simulator SFS_CODE. In <xref ref-type="table" rid="pcbi-1002806-t006">Table 6</xref>, we report simulation results for 5 demographic settings for 1,000 gene data sets including three bottleneck scenarios, one population growth model, and constant population size. From these simulations we see that both the MK method and SnIPRE methods have very low false positive rates, with the SnIPRE methods performing slightly better. MKprf with estimated variance has similarly very low false positive rates, however MKprf with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e161" xlink:type="simple"/></inline-formula> has consistently higher false positive rates. As stated above, all these methods should be robust to demography. This appears to be the case in our simulations as the false positive rates remain consistent for each method across demographies.</p>
        <table-wrap id="pcbi-1002806-t006" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002806.t006</object-id>
          <label>Table 6</label>
          <caption>
            <title>False positive rate and demography.</title>
          </caption>
          <alternatives>
            <graphic id="pcbi-1002806-t006-6" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002806.t006" xlink:type="simple"/>
            <table>
              <colgroup span="1">
                <col align="left" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <td align="left" rowspan="1" colspan="1"/>
                  <td align="left" rowspan="1" colspan="1">Bottleneck 1</td>
                  <td align="left" rowspan="1" colspan="1">Bottleneck 2</td>
                  <td align="left" rowspan="1" colspan="1">Bottleneck 3</td>
                  <td align="left" rowspan="1" colspan="1">Expansion</td>
                  <td align="left" rowspan="1" colspan="1">Constant</td>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left" rowspan="1" colspan="1">SnIPRE</td>
                  <td align="left" rowspan="1" colspan="1">0.00</td>
                  <td align="left" rowspan="1" colspan="1">0.00</td>
                  <td align="left" rowspan="1" colspan="1">0.00</td>
                  <td align="left" rowspan="1" colspan="1">0.00</td>
                  <td align="left" rowspan="1" colspan="1">0.00</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">B SnIPRE</td>
                  <td align="left" rowspan="1" colspan="1">0.00</td>
                  <td align="left" rowspan="1" colspan="1">0.00</td>
                  <td align="left" rowspan="1" colspan="1">0.00</td>
                  <td align="left" rowspan="1" colspan="1">0.00</td>
                  <td align="left" rowspan="1" colspan="1">0.00</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">MKprf (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e162" xlink:type="simple"/></inline-formula>)</td>
                  <td align="left" rowspan="1" colspan="1">0.11</td>
                  <td align="left" rowspan="1" colspan="1">0.08</td>
                  <td align="left" rowspan="1" colspan="1">0.01</td>
                  <td align="left" rowspan="1" colspan="1">0.11</td>
                  <td align="left" rowspan="1" colspan="1">0.13</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">MKprf (estimated <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e163" xlink:type="simple"/></inline-formula>)</td>
                  <td align="left" rowspan="1" colspan="1">0.00</td>
                  <td align="left" rowspan="1" colspan="1">0.00</td>
                  <td align="left" rowspan="1" colspan="1">0.00</td>
                  <td align="left" rowspan="1" colspan="1">0.00</td>
                  <td align="left" rowspan="1" colspan="1">0.03</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">MK</td>
                  <td align="left" rowspan="1" colspan="1">0.02</td>
                  <td align="left" rowspan="1" colspan="1">0.02</td>
                  <td align="left" rowspan="1" colspan="1">0.01</td>
                  <td align="left" rowspan="1" colspan="1">0.02</td>
                  <td align="left" rowspan="1" colspan="1">0.03</td>
                </tr>
              </tbody>
            </table>
          </alternatives>
          <table-wrap-foot>
            <fn id="nt109">
              <label/>
              <p>False positive rates when no selection, and under various population growth models.</p>
            </fn>
          </table-wrap-foot>
        </table-wrap>
        <p>The key point from all these simulations is that SnIPRE performs just as conservatively as the MK test and better than MKprf under a litany of neutral scenarios that might be cause for concern in analyses for inference of selection.</p>
      </sec>
      <sec id="s3b">
        <title>Simulations with constraint</title>
        <p>A particularly interesting application of SnIPRE is to identify regions of the human (or a new genome) that show very low levels of variation based on both polymorphism and divergence data. These might be interpretable as regions of high selective constraint either at the amino acid or non-coding level (for comparison with a flanking “neutral” standard) and may represent biologically meaningful sequences, see <xref ref-type="bibr" rid="pcbi.1002806-Pollard1">[29]</xref>, <xref ref-type="bibr" rid="pcbi.1002806-Bejerano1">[30]</xref>.</p>
        <p>To quantify the power of SnIPRE to identify constrained loci, we used the coalescent method to simulate three different scenarios with varying degree of selective constraint, or <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e164" xlink:type="simple"/></inline-formula>, among genes in 1,000 gene data sets. Here we consider the case where some proportion of sites are very strongly constrained (any mutation at these locations is considered lethal), and not the case where the mutations are of weak negative effect and could rise in frequency and contribute to polymorphism (considered in the simulations below). That is, these regions do not exhibit a deviation in polymorphism verus divergence; however, they will be outliers with regard to the genome-wide pattern of overall genetic variation. In <xref ref-type="table" rid="pcbi-1002806-t007">Table 7</xref> and <xref ref-type="fig" rid="pcbi-1002806-g002">Figure 2</xref> we see the results from three coalescent simulations with three different distributions on mutational constraint, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e165" xlink:type="simple"/></inline-formula>. A comparable estimate of constraint from the MKprf methods is a function of its estimated nonsynonymous and synonymous mutation rates <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e166" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e167" xlink:type="simple"/></inline-formula>:<disp-formula id="pcbi.1002806.e168"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002806.e168" xlink:type="simple"/></disp-formula>The SnIPRE methods performed quite well on data from distribution one with 98% and 99% correct, the MKprf methods yielded only 43% and 67% correct. Distribution 2 has a wider variety of constraint and presents more of a challenge for both SnIPRE (66% and 86%)and MKprf (38% and 51%) methods. Distribution three contained only mild to moderate constraint and was the most challenging of the three distributions. Here, the B SnIPRE method proved to be the most powerful of the four methods, with 45% correctly classified, and the MKprf methods yeilded approximately 21% correct, and SnIPRE approximately 17% correct. For all three distributions the SnIPRE methods correctly classified the selection effects as neutral. From these results we see that the SnIPRE model is able to detect strong constraint, and can distinguish these effects from those of selection.</p>
        <fig id="pcbi-1002806-g002" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002806.g002</object-id>
          <label>Figure 2</label>
          <caption>
            <title>Classification of constraint.</title>
            <p>Top: Distribution 1, 2, and 3 of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e169" xlink:type="simple"/></inline-formula> used in the coalescent simulations for <xref ref-type="table" rid="pcbi-1002806-t007">Table 7</xref>. Bottom: Proportion of constraint effects classified as significant by SnIPRE; x-axis is true proportion of non-lethal mutations, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e170" xlink:type="simple"/></inline-formula>.</p>
          </caption>
          <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002806.g002" position="float" xlink:type="simple"/>
        </fig>
        <table-wrap id="pcbi-1002806-t007" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002806.t007</object-id>
          <label>Table 7</label>
          <caption>
            <title>Realized coverage of 95% CI for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e171" xlink:type="simple"/></inline-formula> and γ when <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e172" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e173" xlink:type="simple"/></inline-formula> varies, and there is linkage among sites.</title>
          </caption>
          <alternatives>
            <graphic id="pcbi-1002806-t007-7" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002806.t007" xlink:type="simple"/>
            <table>
              <colgroup span="1">
                <col align="left" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <td align="left" rowspan="1" colspan="1"/>
                  <td colspan="3" align="left" rowspan="1">% Correct <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e174" xlink:type="simple"/></inline-formula></td>
                  <td colspan="3" align="left" rowspan="1">% Correct <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e175" xlink:type="simple"/></inline-formula></td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1"/>
                  <td align="left" rowspan="1" colspan="1">Dist 1</td>
                  <td align="left" rowspan="1" colspan="1">Dist 2</td>
                  <td align="left" rowspan="1" colspan="1">Dist 3</td>
                  <td align="left" rowspan="1" colspan="1">Dist 1</td>
                  <td align="left" rowspan="1" colspan="1">Dist 2</td>
                  <td align="left" rowspan="1" colspan="1">Dist 3</td>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left" rowspan="1" colspan="1">SnIPRE</td>
                  <td align="left" rowspan="1" colspan="1">100.0</td>
                  <td align="left" rowspan="1" colspan="1">100.0</td>
                  <td align="left" rowspan="1" colspan="1">100.0</td>
                  <td align="left" rowspan="1" colspan="1">98.7</td>
                  <td align="left" rowspan="1" colspan="1">66.1</td>
                  <td align="left" rowspan="1" colspan="1">17.9</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">B SnIPRE</td>
                  <td align="left" rowspan="1" colspan="1">100.0</td>
                  <td align="left" rowspan="1" colspan="1">100.0</td>
                  <td align="left" rowspan="1" colspan="1">100.0</td>
                  <td align="left" rowspan="1" colspan="1">99.2</td>
                  <td align="left" rowspan="1" colspan="1">86.0</td>
                  <td align="left" rowspan="1" colspan="1">43.4</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">MKprf (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e176" xlink:type="simple"/></inline-formula>)</td>
                  <td align="left" rowspan="1" colspan="1">69.3</td>
                  <td align="left" rowspan="1" colspan="1">92.2</td>
                  <td align="left" rowspan="1" colspan="1">87.9</td>
                  <td align="left" rowspan="1" colspan="1">43.0</td>
                  <td align="left" rowspan="1" colspan="1">38.7</td>
                  <td align="left" rowspan="1" colspan="1">21.5</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">MKprf (estimated <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e177" xlink:type="simple"/></inline-formula>)</td>
                  <td align="left" rowspan="1" colspan="1">71.1</td>
                  <td align="left" rowspan="1" colspan="1">99.3</td>
                  <td align="left" rowspan="1" colspan="1">99.3</td>
                  <td align="left" rowspan="1" colspan="1">67.6</td>
                  <td align="left" rowspan="1" colspan="1">51.6</td>
                  <td align="left" rowspan="1" colspan="1">20.7</td>
                </tr>
              </tbody>
            </table>
          </alternatives>
          <table-wrap-foot>
            <fn id="nt110">
              <label/>
              <p>Results for coalescent model simulations with a distribution on <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e178" xlink:type="simple"/></inline-formula>, and no selection <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e179" xlink:type="simple"/></inline-formula>. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e180" xlink:type="simple"/></inline-formula>.</p>
            </fn>
          </table-wrap-foot>
        </table-wrap>
        <p>A comparison can also be made when selection is present, and there is no constraint (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e181" xlink:type="simple"/></inline-formula>). To do this we considered a data set with selection coefficients drawn from a normal distribution with a mean of zero, a standard deviation of two, and with no constraint. In <xref ref-type="fig" rid="pcbi-1002806-g003">Figure 3 A</xref> we see that SnIPRE's estimated constraint effects are quite accurate (very close to one), while the MKprf methods have much more variable estimates. The SnIPRE method's estimates of constraint are somewhat correlated with the selection coefficient, however we see in <xref ref-type="fig" rid="pcbi-1002806-g003">Figure 3 B</xref> that the effect of this trend is minimal.</p>
        <fig id="pcbi-1002806-g003" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002806.g003</object-id>
          <label>Figure 3</label>
          <caption>
            <title>Comparison of estimates of constraint when <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e182" xlink:type="simple"/></inline-formula> (no constraint).</title>
            <p>A: The distribution of constraint estimates. B: Constraint estimates versus the selection strength.</p>
          </caption>
          <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002806.g003" position="float" xlink:type="simple"/>
        </fig>
      </sec>
      <sec id="s3c">
        <title>Simulations with selection</title>
        <sec id="s3c1">
          <title>Classification of selection effect</title>
          <p>To assess performance when the selection coefficients come from some distribution, we simulated data using PRFREQ for six data sets of 1,000 genes. Selection coefficients for our simulations are drawn from three distributions, which are shown at the bottom of both <xref ref-type="fig" rid="pcbi-1002806-g004">Figure 4</xref> and <xref ref-type="fig" rid="pcbi-1002806-g005">Figure 5</xref>. These selection coefficients were then used to simulate data with drosophila-like parameters <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e183" xlink:type="simple"/></inline-formula>, and with human-like parameters <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e184" xlink:type="simple"/></inline-formula>. In <xref ref-type="fig" rid="pcbi-1002806-g004">Figures 4</xref> and <xref ref-type="fig" rid="pcbi-1002806-g005">5</xref> each row of histograms illustrates a particular method's performance on data from each of the simulations. The colored portions of the histograms represent the proportion of selection coefficients in each bin correctly classified as under selection, with the true selection coefficient values given along the x-axis. These results are also summarized in <xref ref-type="table" rid="pcbi-1002806-t008">Table 8</xref>. From our simulations, we found the SnIPRE method to be a dramatic improvement over other methods in identifying genes under selection, especially when table counts are low, as with a human-like mutation rate of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e185" xlink:type="simple"/></inline-formula>. For example, the SnIPRE methods classify <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e186" xlink:type="simple"/></inline-formula> of genes correctly, MKprf methods classify <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e187" xlink:type="simple"/></inline-formula> correctly, and the MK statistic just <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e188" xlink:type="simple"/></inline-formula> correctly. For the drosophila-like simulations the SnIPRE methods classify <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e189" xlink:type="simple"/></inline-formula> correctly, MKprf methods classify <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e190" xlink:type="simple"/></inline-formula> correctly, and the MK statistics classifies <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e191" xlink:type="simple"/></inline-formula> correctly. Specifically, the SnIPRE methods are more sensitive for small (close to zero) and more accurate for extreme valued selection coefficients. The selection coefficients not identified by SnIPRE as significantly different from zero, are generally within <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e192" xlink:type="simple"/></inline-formula> of zero.</p>
          <fig id="pcbi-1002806-g004" position="float">
            <object-id pub-id-type="doi">10.1371/journal.pcbi.1002806.g004</object-id>
            <label>Figure 4</label>
            <caption>
              <title>Classification of selection effect for <italic>Drosophila</italic>-like simulations.</title>
              <p>Shaded regions of histogram represent the proportion of genes under selection classified as under selection; x-axis is true selection coefficient; <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e193" xlink:type="simple"/></inline-formula>.</p>
            </caption>
            <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002806.g004" position="float" xlink:type="simple"/>
          </fig>
          <fig id="pcbi-1002806-g005" position="float">
            <object-id pub-id-type="doi">10.1371/journal.pcbi.1002806.g005</object-id>
            <label>Figure 5</label>
            <caption>
              <title>Classification of selection effect for human-like simulations.</title>
              <p>Shaded regions of histogram represent the proportion of genes under selection classified as under selection; x-axis is true selection coefficient; <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e194" xlink:type="simple"/></inline-formula>.</p>
            </caption>
            <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002806.g005" position="float" xlink:type="simple"/>
          </fig>
          <table-wrap id="pcbi-1002806-t008" position="float">
            <object-id pub-id-type="doi">10.1371/journal.pcbi.1002806.t008</object-id>
            <label>Table 8</label>
            <caption>
              <title>Selection classification for simulations by method.</title>
            </caption>
            <alternatives>
              <graphic id="pcbi-1002806-t008-8" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002806.t008" xlink:type="simple"/>
              <table>
                <colgroup span="1">
                  <col align="left" span="1"/>
                  <col align="center" span="1"/>
                  <col align="center" span="1"/>
                  <col align="center" span="1"/>
                  <col align="center" span="1"/>
                  <col align="center" span="1"/>
                  <col align="center" span="1"/>
                </colgroup>
                <thead>
                  <tr>
                    <td align="left" rowspan="1" colspan="1"/>
                    <td colspan="3" align="left" rowspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e195" xlink:type="simple"/></inline-formula> (Drosophila)</td>
                    <td colspan="3" align="left" rowspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e196" xlink:type="simple"/></inline-formula> (Human)</td>
                  </tr>
                  <tr>
                    <td align="left" rowspan="1" colspan="1"/>
                    <td align="left" rowspan="1" colspan="1">Dist 1</td>
                    <td align="left" rowspan="1" colspan="1">Dist 2</td>
                    <td align="left" rowspan="1" colspan="1">Dist 3</td>
                    <td align="left" rowspan="1" colspan="1">Dist 1</td>
                    <td align="left" rowspan="1" colspan="1">Dist 2</td>
                    <td align="left" rowspan="1" colspan="1">Dist 3</td>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td align="left" rowspan="1" colspan="1">SnIPRE</td>
                    <td align="left" rowspan="1" colspan="1">0.95</td>
                    <td align="left" rowspan="1" colspan="1">0.92</td>
                    <td align="left" rowspan="1" colspan="1">0.95</td>
                    <td align="left" rowspan="1" colspan="1">0.86</td>
                    <td align="left" rowspan="1" colspan="1">0.72</td>
                    <td align="left" rowspan="1" colspan="1">0.88</td>
                  </tr>
                  <tr>
                    <td align="left" rowspan="1" colspan="1">B SnIPRE</td>
                    <td align="left" rowspan="1" colspan="1">0.93</td>
                    <td align="left" rowspan="1" colspan="1">0.90</td>
                    <td align="left" rowspan="1" colspan="1">0.93</td>
                    <td align="left" rowspan="1" colspan="1">0.85</td>
                    <td align="left" rowspan="1" colspan="1">0.76</td>
                    <td align="left" rowspan="1" colspan="1">0.86</td>
                  </tr>
                  <tr>
                    <td align="left" rowspan="1" colspan="1">MKprf (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e197" xlink:type="simple"/></inline-formula>)</td>
                    <td align="left" rowspan="1" colspan="1">0.90</td>
                    <td align="left" rowspan="1" colspan="1">0.83</td>
                    <td align="left" rowspan="1" colspan="1">0.89</td>
                    <td align="left" rowspan="1" colspan="1">0.50</td>
                    <td align="left" rowspan="1" colspan="1">0.45</td>
                    <td align="left" rowspan="1" colspan="1">0.60</td>
                  </tr>
                  <tr>
                    <td align="left" rowspan="1" colspan="1">MKprf (estimated <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e198" xlink:type="simple"/></inline-formula>)</td>
                    <td align="left" rowspan="1" colspan="1">0.90</td>
                    <td align="left" rowspan="1" colspan="1">0.83</td>
                    <td align="left" rowspan="1" colspan="1">0.89</td>
                    <td align="left" rowspan="1" colspan="1">0.52</td>
                    <td align="left" rowspan="1" colspan="1">0.42</td>
                    <td align="left" rowspan="1" colspan="1">0.57</td>
                  </tr>
                  <tr>
                    <td align="left" rowspan="1" colspan="1">MK</td>
                    <td align="left" rowspan="1" colspan="1">0.77</td>
                    <td align="left" rowspan="1" colspan="1">0.67</td>
                    <td align="left" rowspan="1" colspan="1">0.76</td>
                    <td align="left" rowspan="1" colspan="1">0.20</td>
                    <td align="left" rowspan="1" colspan="1">0.12</td>
                    <td align="left" rowspan="1" colspan="1">0.15</td>
                  </tr>
                </tbody>
              </table>
            </alternatives>
            <table-wrap-foot>
              <fn id="nt111">
                <label/>
                <p>Proportion of genes correctly classified under selection where the selection coefficients are from distribution 1, 2 and 3; mutation rate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e199" xlink:type="simple"/></inline-formula>.</p>
              </fn>
            </table-wrap-foot>
          </table-wrap>
          <p>It is important to note that the increased power of SnIPRE does not rely on the type of selection, since positive, negative, or balancing may affect the MK table counts similarly. We focused here on data simulated with negative and positive selection with constant population sizes, however, SnIPRE will have more power to detect deviations from the neutral expection of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e200" xlink:type="simple"/></inline-formula> than the MK regardless of the reason. For example, if balancing selection disrupts the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e201" xlink:type="simple"/></inline-formula> equality to the same extent as some other selection pressure (for example, an average selection coefficient of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e202" xlink:type="simple"/></inline-formula> under constant population size, which is simulated here), the relative improvement in SnIPRE over MK would be the same.</p>
          <p>The methods were also tested on a data set which contained both genes with and genes without mutations under selection (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e203" xlink:type="simple"/></inline-formula>, selection strength of at least <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e204" xlink:type="simple"/></inline-formula>, simulation done in PRFREQ). In <xref ref-type="fig" rid="pcbi-1002806-g006">Figure 6</xref> the true positive rate is plotted versus the false discovery rate. Here we see that at the cutoff needed for the MK statistic to have identified half the genes under selection (TPR = 0.5), approximately half of the discoveries are false (FDR<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e205" xlink:type="simple"/></inline-formula>0.5). The MKprf methods offer a dramatic improvement of the MK statistic with a FDR approximately equal to 0.1 at a TPR = 0.5, but the SnIPRE methods offer further improvement with a FDR of zero at TPR = 0.5.</p>
          <fig id="pcbi-1002806-g006" position="float">
            <object-id pub-id-type="doi">10.1371/journal.pcbi.1002806.g006</object-id>
            <label>Figure 6</label>
            <caption>
              <title>True positive rate versus false discover rate.</title>
              <p>Results for data set of 2,000 genes, 550 of the genes are under selection with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e206" xlink:type="simple"/></inline-formula> or <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e207" xlink:type="simple"/></inline-formula>.</p>
            </caption>
            <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002806.g006" position="float" xlink:type="simple"/>
          </fig>
        </sec>
        <sec id="s3c2">
          <title>Estimation of selection coefficient, γ</title>
          <p>As previously mentioned, the SnIPRE method can be used not only to reject the hypothesis of neutral evolution for a particular gene, but can also be used with additional assumptions to provide estimates of the selection coefficient, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e208" xlink:type="simple"/></inline-formula>. We compare the SnIPRE and MKprf classification success of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e209" xlink:type="simple"/></inline-formula> for the PRFREQ simulation data in <xref ref-type="fig" rid="pcbi-1002806-g004">Figures 4</xref> and <xref ref-type="fig" rid="pcbi-1002806-g005">5</xref>. The distribution of the differences between the estimates and the true selection coefficent <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e210" xlink:type="simple"/></inline-formula> for each method is shown in <xref ref-type="fig" rid="pcbi-1002806-g007">Figure 7</xref>. The SnIPRE methods generally yield reasonable results for genes with selection coefficients from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e211" xlink:type="simple"/></inline-formula> or higher. However, for genes under strong negative selection cell counts are often quite small or zero, and since the cell counts are bounded below by zero it is hard to estimate precisely the extent of negative selection. Because of this, both the SnIPRE methods and MKprf method suffer in precise estimation of negative selection coefficients. However, as seen in <xref ref-type="fig" rid="pcbi-1002806-g005">Figure 5</xref> the SnIPRE methods still classify these coefficients as negative, whereas MKprf does so for only a fraction of the more extreme cases.</p>
          <fig id="pcbi-1002806-g007" position="float">
            <object-id pub-id-type="doi">10.1371/journal.pcbi.1002806.g007</object-id>
            <label>Figure 7</label>
            <caption>
              <title>Distribution of residuals for selection coefficient estimates by method.</title>
              <p>The top row displays the distribution of constraint, the middle row displays residuals for simulations using <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e212" xlink:type="simple"/></inline-formula>; the bottom row displays residuals for simulations using <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e213" xlink:type="simple"/></inline-formula>. Residuals grouped by true selection strength.</p>
            </caption>
            <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002806.g007" position="float" xlink:type="simple"/>
          </fig>
        </sec>
      </sec>
      <sec id="s3d">
        <title>Application</title>
        <p>We also applied these methods to <italic>Drosophila simulans</italic> data with a <italic>Drosophila melanogaster</italic> outgroup. This data was originally presented by Begun et al <xref ref-type="bibr" rid="pcbi.1002806-Begun1">[31]</xref>. Our results are consistent with others' findings of abundant positive selection among <italic>Drosophila</italic> <xref ref-type="bibr" rid="pcbi.1002806-Bierne1">[32]</xref>–<xref ref-type="bibr" rid="pcbi.1002806-Welch1">[33]</xref> <xref ref-type="bibr" rid="pcbi.1002806-Smith1">[16]</xref>. B SnIPRE identifies an additional 613 genes (nearly a 60% increase) with significant evidence of positive selection that were not significant by the traditional MK test using an un-adjusted p-value cutoff of 0.05. We also find evidence of a significant amount of mutational constraint, see <xref ref-type="fig" rid="pcbi-1002806-g008">Figure 8</xref>. These results are consistent with the large effective population size of Drosophila and the strong efficacy of selection. It is important to note when interpreting these results that all the tests discussed here have an underlying assumption that the synonymous sites are under no selection. These synonymous sites act as a baseline, thus conclusions of positive or negative are actually measured relative to the level of selection acting on synonymous sites. For example, if there is selection against unfavored codons, this may artificially inflate the non-synonymous to synonymous ratio and be misinterpreted as positive selection at non-synonymous sites. If codon bias is believed to be widespread amongst the genome, a better indicator of selection levels may be to compare the gene specific effects to the genome average, rather than comparing the sum of these effects to zero.</p>
        <fig id="pcbi-1002806-g008" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002806.g008</object-id>
          <label>Figure 8</label>
          <caption>
            <title><italic>D. simulans</italic> estimated selection effects and non-synonymous effects for 8,887 genes.</title>
            <p>Plots A and B shows the estimated selection effects using SnIPRE and B SnIPRE respectively.</p>
          </caption>
          <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002806.g008" position="float" xlink:type="simple"/>
        </fig>
        <p>In contrast, when we applied SnIPRE to human data, we found few genes with evidence of strong positive selection and an overwhelming signal of negative selection, see <xref ref-type="fig" rid="pcbi-1002806-g009">Figure 9</xref>. This is consistent with our previous interpretation of the results in <xref ref-type="bibr" rid="pcbi.1002806-Bustamante3">[10]</xref> and <xref ref-type="bibr" rid="pcbi.1002806-Boyko1">[12]</xref>, where we argued weak negative selection is the predominant mode of selection operating across the majority of human evolutionary history. Again, this is consistent with the small long term <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e214" xlink:type="simple"/></inline-formula> of our species. An implication of this result is that many genes likely harbor mutations of small negative effect that can reach appreciable frequencies.</p>
        <fig id="pcbi-1002806-g009" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002806.g009</object-id>
          <label>Figure 9</label>
          <caption>
            <title>Human estimated selection effects and non-synonymous effects for 11,624 genes.</title>
            <p>Plots A and B shows the estimated selection effects using SnIPRE and B SnIPRE respectively. B SnIPRE classifies far more genes as having a negative average selection effect, and this difference can be explained in part by the construction of 95% confidence interval versus the credible interval.</p>
          </caption>
          <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002806.g009" position="float" xlink:type="simple"/>
        </fig>
        <p>The application to humans in particular illustrates nicely the improved power in the SnIPRE model to detect genes under strong negative selection (constraint) and recurrent negative selection on mildly deleterious mutations. Because of the relatively low mutation rate in humans, genes under varying degrees of negative selection usually have such low mutation counts in the MK table that the MK test is unable to achieve significance. For example, consider the spermatogenic <italic>Odf2</italic> gene, which plays an important role in sperm morphology and infertility. The MK table counts are as follows: PS = 1, DS = 9, PN = 1, and DN = 1. The MK test is testing the equality 1/9 = 1/1, but failed to reach significance (p-value = 0.32). SnIPRE, however, found significant evidence of negative selection, as well as mutational constraint. The SnIPRE estimated selection effect for this particular gene was <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e215" xlink:type="simple"/></inline-formula> (significantly different from zero, and lower than the genomic average of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e216" xlink:type="simple"/></inline-formula>), and the estimated reduction in non-synonymous mutations was also quite strong, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e217" xlink:type="simple"/></inline-formula> (compared to a genomic average of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e218" xlink:type="simple"/></inline-formula>). From here we can conclude that there is significant evidence of selection, and additionally, there may be evidence of mutational constraint, or purifying selection, as we are observing significantly fewer non-synonymous mutations than expected. It is difficult to interpret the significance of the constraint, however, without first estimating the strength of negative selection. This is because the strength of selection also influences the expected number of non-synonymous mutations. If we are willing to accept the additional assumptions of the PRF framework, then using the relationship defined in (7) and (8) we estimate the average selection coefficient acting on this gene to be equal to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e219" xlink:type="simple"/></inline-formula>, and the estimated proportion of mutations that are non-lethal in this gene to be <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e220" xlink:type="simple"/></inline-formula> (a proportion which is found to be significantly different from 1). Under the PRF framework the SnIPRE model also tells us that the gene effect for <italic>Odf2</italic>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e221" xlink:type="simple"/></inline-formula> may be interpreted as mutation rate of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e222" xlink:type="simple"/></inline-formula> mutations per generation, per site (slightly higher than the estimated genomic average estimated from this data of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e223" xlink:type="simple"/></inline-formula>); and the estimated divergence effect, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e224" xlink:type="simple"/></inline-formula>, leads to an estimated scaled coalescence time for this gene at <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e225" xlink:type="simple"/></inline-formula> (slightly higher than the genomic average estimated here of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e226" xlink:type="simple"/></inline-formula>).</p>
        <p>The <italic>BRC2</italic> gene, associated with breast cancer and important for DNA repair, is another illustration of a case where examining the individual MK table we are unable to find significant evidence of selection. However the SnIPRE model indicates a significant amount of mutational constraint, indicating strong negative selection. The MK table for this gene has PS = 13, DS = 16, PN = 9, and DN = 17. While there is little evidence of negative selection (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e227" xlink:type="simple"/></inline-formula>, not significantly different than zero), the SnIPRE model indicates evidence for mutational constraint (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e228" xlink:type="simple"/></inline-formula>). From the MK table alone we would not see this as the total synonymous and non-synonymous mutations are similar. However, considered with the additional information that the number of non-synonymous sites sampled was nearly three times the number of synonymous sites sampled, the SnIPRE model in the PRF framework estimates the proportion of mutations that are non-lethal to be <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e229" xlink:type="simple"/></inline-formula>, significantly different than one. The average mutation rate for this gene is estimated to be <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e230" xlink:type="simple"/></inline-formula> and a more recent coalescent time of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e231" xlink:type="simple"/></inline-formula>.</p>
        <p>Due to the overwhelming evidence of negative selection and constraint in humans, signatures of positive selection are difficult to detect even with the increase in power with the SnIPRE framework. B SnIPRE detects only 4 genes under positive selection not identified by the traditional MK statistic, which identifies 10 genes. For this reason it may be informative to consider the effect of selection on a gene <italic>relative</italic> to the genome-wide average. Because the selection effect represents the average effect of selection on that gene throughout time, it may represent an average of both positive and negative selection forces. Assuming a model where we can interpret the the sign of the selection effect as indictive of the direction of selection, genes with selection effects significantly higher than the genome-wide average will have had either more positive selection or less negative selection acting on them than the typical gene. For example, in this data set B SnIPRE identifies 628 genes with selection effects significantly higher than the genome-wide average of −0.60.</p>
      </sec>
      <sec id="s3e">
        <title>Conclusions</title>
        <p>The SnIPRE framework models MK table data in a way consistent with population genetic theory and with minimal assumptions on the demographic model may reject the neutral theory. However, just as with the traditional MK test, conclusions about type of selection (positive, negative, or balancing) require further assumptions. The parameters of the SnIPRE model are easily interpreted and can be effectively used to estimate the affects of selection, constraint, divergence time, and mutation rate on genome-wide patterns of variation on a gene-by-gene basis. Effects may be readily evaluated in the absolute, or relative to the genome-wide estimates.</p>
        <p>The simulations provided here illustrate the significant increase in power over the traditional MK test that the SnIPRE model provides, while maintaining a low false positive rate. This makes sense since we are using genome-wide data to improve our estimate of the influence of mutation rate, species divergence time, constraint, and selection effects. The fixed effects reflect genome-wide averages of these effects; the random effects reflect the gene-by-gene variation in the influence of these forces and provide estimates of this variation with James-Stein-type shrinkage. Both the empirical Bayes and fully Bayesian implementation borrow strength across genes to improve estimates of the parameters of interest. The success of the method in simualtions, as well as the consistency of the <italic>Drosophila</italic> and human-chimp results with other findings corroborates the legitimacy of this methodology in this setting.</p>
        <p>When the assumptions of the PRF are met, our simulations indicate the method provides estimates of the selection coefficient as un-biased as the more parametric method MKprf, and with generally smaller confidence intervals. While in this paper we have focused on the interpretation of SnIPRE parameters in the PRF framework, we believe an extension of the model could be used in another framework which allows for arbitrary dominance. One such framework is described in Williamson et al <xref ref-type="bibr" rid="pcbi.1002806-Williamson1">[34]</xref> in which the dominance parameter is estimated based on additional information from the site frequency spectrum. However, as with any method that makes conclusions about strength and directionality, such as MKprf or <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002806.e232" xlink:type="simple"/></inline-formula>, in order to asses the type of selection assumptions would need to be made about effective population size changes and their timing.</p>
        <p>In the future, we will explore the impact of varying recombination rate on the accuracy of parameter estimates and, in turn, the efficacy of natural selection in weeding out deleterious alleles while promoting favorable mutations to high frequency.</p>
      </sec>
    </sec>
  </body>
  <back>
    <ack>
      <p>Adam Boyko, Ryan Hernandez, and the Bustamante Lab, especially Jeremiah Degenhardt and Kirk Lohmueller.</p>
    </ack>
    <ref-list>
      <title>References</title>
      <ref id="pcbi.1002806-Tajima1">
        <label>1</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tajima</surname><given-names>F</given-names></name> (<year>1989</year>) <article-title>Statistical method for testing the neutral mutation hypothesis by DNA polymorphism</article-title>. <source>Genetics</source> <volume>123</volume>: <fpage>585</fpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002806-Nielsen1">
        <label>2</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nielsen</surname><given-names>R</given-names></name> (<year>2005</year>) <article-title>Molecular signatures of natural selection</article-title>. <source>Genetics</source> <volume>39</volume>: <fpage>197</fpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002806-Hudson1">
        <label>3</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hudson</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Kreitman</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Aguade</surname><given-names>M</given-names></name> (<year>1987</year>) <article-title>A test of neutral molecular evolution based on nucleotide data</article-title>. <source>Genetics</source> <volume>116</volume>: <fpage>153</fpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002806-Nielsen2">
        <label>4</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nielsen</surname><given-names>R</given-names></name> (<year>2001</year>) <article-title>Statistical tests of selective neutrality in the age of genomics</article-title>. <source>Heredity</source> <volume>86</volume>: <fpage>641</fpage>–<lpage>647</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002806-McDonald1">
        <label>5</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>McDonald</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Kreitman</surname><given-names>M</given-names></name> (<year>1991</year>) <article-title>Adaptive protein evolution at the Adh locus in Drosophila</article-title>. <source>Nature</source> <volume>351</volume>: <fpage>652</fpage>–<lpage>654</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002806-Bustamante1">
        <label>6</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bustamante</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Nielsen</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Hartl</surname><given-names>D</given-names></name> (<year>2003</year>) <article-title>Maximum likelihood and Bayesian methods for estimating the distribution of selective effects among classes of mutations using DNA polymorphism data</article-title>. <source>Theoretical Population Biology</source> <volume>63</volume>: <fpage>91</fpage>–<lpage>103</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002806-Bustamante2">
        <label>7</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bustamante</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Nielsen</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Sawyer</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Olsen</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Purugganan</surname><given-names>M</given-names></name>, <etal>et al</etal>. (<year>2002</year>) <article-title>The cost of inbreeding in Arabidopsis</article-title>. <source>Nature</source> <volume>416</volume>: <fpage>531</fpage>–<lpage>534</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002806-Barrier1">
        <label>8</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Barrier</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Bustamante</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Yu</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Purugganan</surname><given-names>M</given-names></name> (<year>2003</year>) <article-title>Selection on rapidly evolving proteins in the Arabidopsis genome</article-title>. <source>Genetics</source> <volume>163</volume>: <fpage>723</fpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002806-Gilad1">
        <label>9</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gilad</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Bustamante</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Lancet</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Pääbo</surname><given-names>S</given-names></name> (<year>2003</year>) <article-title>Natural selection on the olfactory receptor gene family in humans and chimpanzees</article-title>. <source>The American Journal of Human Genetics</source> <volume>73</volume>: <fpage>489</fpage>–<lpage>501</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002806-Bustamante3">
        <label>10</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bustamante</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Fledel-Alon</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Williamson</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Nielsen</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Hubisz</surname><given-names>M</given-names></name>, <etal>et al</etal>. (<year>2005</year>) <article-title>Natural selection on protein-coding genes in the human genome</article-title>. <source>Nature</source> <volume>437</volume>: <fpage>1153</fpage>–<lpage>1157</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002806-Sawyer1">
        <label>11</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sawyer</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Kulathinal</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Bustamante</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Hartl</surname><given-names>D</given-names></name> (<year>2003</year>) <article-title>Bayesian analysis suggests that most amino acid replacements in Drosophila are driven by positive selection</article-title>. <source>Journal of molecular evolution</source> <volume>57</volume>: <fpage>154</fpage>–<lpage>164</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002806-Boyko1">
        <label>12</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Boyko</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Williamson</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Indap</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Degenhardt</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Hernandez</surname><given-names>R</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>Assessing the evolutionary impact of amino acid mutations in the human genome</article-title>. <source>PLoS Genet</source> <volume>4</volume>: <fpage>e1000083</fpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002806-Li1">
        <label>13</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Li</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Costello</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Holloway</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Hahn</surname><given-names>M</given-names></name> (<year>2008</year>) <article-title>Reverse ecology and the power of population genomics</article-title>. <source>Evolution</source> <volume>62</volume>: <fpage>2984</fpage>–<lpage>2994</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002806-Kimura1">
        <label>14</label>
        <mixed-citation publication-type="other" xlink:type="simple">Kimura M (1985) The neutral theory of molecular evolution. Cambridge Univ Pr.</mixed-citation>
      </ref>
      <ref id="pcbi.1002806-Andolfatto1">
        <label>15</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Andolfatto</surname><given-names>P</given-names></name> (<year>2005</year>) <article-title>Adaptive evolution of non-coding DNA in Drosophila</article-title>. <source>Nature</source> <volume>437</volume>: <fpage>1149</fpage>–<lpage>1152</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002806-Smith1">
        <label>16</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Smith</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Eyre-Walker</surname><given-names>A</given-names></name> (<year>2002</year>) <article-title>Adaptive protein evolution in Drosophila</article-title>. <source>Nature</source> <volume>415</volume>: <fpage>1022</fpage>–<lpage>1024</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002806-EyreWalker1">
        <label>17</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Eyre-Walker</surname><given-names>A</given-names></name> (<year>2002</year>) <article-title>Changing effective population size and the McDonald-Kreitman test</article-title>. <source>Genetics</source> <volume>162</volume>: <fpage>2017</fpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002806-McDonald2">
        <label>18</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>McDonald</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Kreitman</surname><given-names>M</given-names></name> (<year>1991</year>) <article-title>Adaptive protein evolution at the Adh locus in Drosophila</article-title>. <source>Nature</source> <volume>351</volume>: <fpage>652</fpage>–<lpage>654</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002806-Wakeley1">
        <label>19</label>
        <mixed-citation publication-type="other" xlink:type="simple">Wakeley J (2007) Coalescent Theory: An Introduction. Greenwood Village, Colorado: Roberts &amp; Company Publishers.</mixed-citation>
      </ref>
      <ref id="pcbi.1002806-R1">
        <label>20</label>
        <mixed-citation publication-type="other" xlink:type="simple">R Development Core Team (2011) R: A Language and Environment for Statistical Computing. R Foundation for Statistical Computing, Vienna, Austria. URL <ext-link ext-link-type="uri" xlink:href="http://www.R-project.org/" xlink:type="simple">http://www.R-project.org/</ext-link>. ISBN 3-900051-07-0.</mixed-citation>
      </ref>
      <ref id="pcbi.1002806-Bates1">
        <label>21</label>
        <mixed-citation publication-type="other" xlink:type="simple">Bates D, Maechler M, Bolker B (2011) lme4: Linear mixed-effects models using S4 classes. URL <ext-link ext-link-type="uri" xlink:href="http://CRAN.R-project.org/package=lme4" xlink:type="simple">http://CRAN.R-project.org/package=lme4</ext-link>. R package version 0.999375–38.</mixed-citation>
      </ref>
      <ref id="pcbi.1002806-Lunn1">
        <label>22</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lunn</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Thomas</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Best</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Spiegelhalter</surname><given-names>D</given-names></name> (<year>2000</year>) <article-title>WinBUGS-a Bayesian modelling framework: concepts, structure, and extensibility</article-title>. <source>Statistics and Computing</source> <volume>10</volume>: <fpage>325</fpage>–<lpage>337</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002806-Sturtz1">
        <label>23</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sturtz</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Ligges</surname><given-names>U</given-names></name>, <name name-style="western"><surname>Gelman</surname><given-names>A</given-names></name> (<year>2005</year>) <article-title>R2winbugs: A package for running winbugs from r</article-title>. <source>Journal of Statistical Software</source> <volume>12</volume>: <fpage>1</fpage>–<lpage>16</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002806-Hadfield1">
        <label>24</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hadfield</surname><given-names>JD</given-names></name> (<year>2010</year>) <article-title>Mcmc methods for multi-response generalized linear mixed models: The MCMCglmm R package</article-title>. <source>Journal of Statistical Software</source> <volume>33</volume>: <fpage>1</fpage>–<lpage>22</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002806-Plummer1">
        <label>25</label>
        <mixed-citation publication-type="other" xlink:type="simple">Plummer M (2003). Jags: A program for analysis of bayesian graphical models using gibbs sampling. Available: <ext-link ext-link-type="uri" xlink:href="http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.13.3406" xlink:type="simple">http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.13.3406</ext-link></mixed-citation>
      </ref>
      <ref id="pcbi.1002806-Gelfand1">
        <label>26</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gelfand</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Sahu</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Carlin</surname><given-names>B</given-names></name> (<year>1995</year>) <article-title>Efficient parametrisations for normal linear mixed models</article-title>. <source>Biometrika</source> <volume>82</volume>: <fpage>479</fpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002806-Sawyer2">
        <label>27</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sawyer</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Hartl</surname><given-names>D</given-names></name> (<year>1992</year>) <article-title>Population genetics of polymorphism and divergence</article-title>. <source>Genetics</source> <volume>132</volume>: <fpage>1161</fpage>–<lpage>1176</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002806-Hernandez1">
        <label>28</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hernandez</surname><given-names>R</given-names></name> (<year>2008</year>) <article-title>A flexible forward simulator for populations subject to selection and demography</article-title>. <source>Bioinformatics</source> <volume>24</volume>: <fpage>2786</fpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002806-Pollard1">
        <label>29</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pollard</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Salama</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Lambert</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Lambot</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Coppens</surname><given-names>S</given-names></name>, <etal>et al</etal>. (<year>2006</year>) <article-title>An RNA gene expressed during cortical development evolved rapidly in humans</article-title>. <source>Nature</source> <volume>443</volume>: <fpage>167</fpage>–<lpage>172</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002806-Bejerano1">
        <label>30</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bejerano</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Lowe</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Ahituv</surname><given-names>N</given-names></name>, <name name-style="western"><surname>King</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Siepel</surname><given-names>A</given-names></name>, <etal>et al</etal>. (<year>2006</year>) <article-title>A distal enhancer and an ultraconserved exon are derived from a novel retroposon</article-title>. <source>Nature</source> <volume>441</volume>: <fpage>87</fpage>–<lpage>90</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002806-Begun1">
        <label>31</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Begun</surname><given-names>DJ</given-names></name>, <name name-style="western"><surname>Holloway</surname><given-names>AK</given-names></name>, <name name-style="western"><surname>Stevens</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Hillier</surname><given-names>LW</given-names></name>, <name name-style="western"><surname>Poh</surname><given-names>YP</given-names></name>, <etal>et al</etal>. (<year>2007</year>) <article-title>Population Genomics: Whole-Genome Analysis of Polymorphism and Divergence in Drosophila simulans</article-title>. <source>PLoS Biol</source> <volume>5</volume>: <fpage>e310</fpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002806-Bierne1">
        <label>32</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bierne</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Eyre-Walker</surname><given-names>A</given-names></name> (<year>2004</year>) <article-title>The genomic rate of adaptive amino acid substitution in Drosophila</article-title>. <source>Molecular Biology and Evolution</source> <volume>21</volume>: <fpage>1350</fpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002806-Welch1">
        <label>33</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Welch</surname><given-names>J</given-names></name> (<year>2006</year>) <article-title>Estimating the genomewide rate of adaptive protein evolution in Drosophila</article-title>. <source>Genetics</source> <volume>173</volume>: <fpage>821</fpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002806-Williamson1">
        <label>34</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Williamson</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Fledel-Alon</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Bustamante</surname><given-names>C</given-names></name> (<year>2004</year>) <article-title>Population genetics of polymorphism and divergence for diploid selection models with arbitrary dominance</article-title>. <source>Genetics</source> <volume>168</volume>: <fpage>463</fpage>–<lpage>475</lpage>.</mixed-citation>
      </ref>
    </ref-list>
  </back>
</article>