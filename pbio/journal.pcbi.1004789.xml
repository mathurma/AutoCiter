<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article article-type="research-article" dtd-version="3.0" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-15-01671</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1004789</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Evolutionary biology</subject><subj-group><subject>Population genetics</subject><subj-group><subject>Effective population size</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Population genetics</subject><subj-group><subject>Effective population size</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Population biology</subject><subj-group><subject>Population genetics</subject><subj-group><subject>Effective population size</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Population biology</subject><subj-group><subject>Population metrics</subject><subj-group><subject>Effective population size</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Population biology</subject><subj-group><subject>Population metrics</subject><subj-group><subject>Population size</subject><subj-group><subject>Effective population size</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Population biology</subject><subj-group><subject>Population metrics</subject><subj-group><subject>Population size</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Infectious diseases</subject><subj-group><subject>Viral diseases</subject><subj-group><subject>Influenza</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Evolutionary biology</subject><subj-group><subject>Population genetics</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Population genetics</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Population biology</subject><subj-group><subject>Population genetics</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Database and informatics methods</subject><subj-group><subject>Biological databases</subject><subj-group><subject>Sequence databases</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Molecular biology</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Sequencing techniques</subject><subj-group><subject>Sequence analysis</subject><subj-group><subject>Sequence databases</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Sequencing techniques</subject><subj-group><subject>Sequence analysis</subject><subj-group><subject>Sequence databases</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Mathematical and statistical techniques</subject><subj-group><subject>Statistical methods</subject><subj-group><subject>Monte Carlo method</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Statistics (mathematics)</subject><subj-group><subject>Statistical methods</subject><subj-group><subject>Monte Carlo method</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Population biology</subject><subj-group><subject>Population dynamics</subject></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Quantifying and Mitigating the Effect of Preferential Sampling on Phylodynamic Inference</article-title>
<alt-title alt-title-type="running-head">Preferential Sampling in Phylodynamic Inference</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Karcher</surname> <given-names>Michael D.</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Palacios</surname> <given-names>Julia A.</given-names></name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Bedford</surname> <given-names>Trevor</given-names></name>
<xref ref-type="aff" rid="aff005"><sup>5</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Suchard</surname> <given-names>Marc A.</given-names></name>
<xref ref-type="aff" rid="aff006"><sup>6</sup></xref>
<xref ref-type="aff" rid="aff007"><sup>7</sup></xref>
<xref ref-type="aff" rid="aff008"><sup>8</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Minin</surname> <given-names>Vladimir N.</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff009"><sup>9</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Department of Statistics, University of Washington, Seattle, Washington, United States of America</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Department of Organismic and Evolutionary Biology, Harvard University, Cambridge, Massachusetts, United States of America</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>Department of Ecology and Evolutionary Biology, Brown University, Providence, Rhode Island, United States of America</addr-line>
</aff>
<aff id="aff004">
<label>4</label>
<addr-line>Center for Computational Molecular Biology, Brown University, Providence, Rhode Island, United States of America</addr-line>
</aff>
<aff id="aff005">
<label>5</label>
<addr-line>Vaccine and Infectious Disease Division, Fred Hutchinson Cancer Research Center, Seattle, Washington, United States of America</addr-line>
</aff>
<aff id="aff006">
<label>6</label>
<addr-line>Department of Human Genetics, David Geffen School of Medicine at UCLA, University of California, Los Angeles, Los Angeles, CA, United States of America</addr-line>
</aff>
<aff id="aff007">
<label>7</label>
<addr-line>Department of Biomathematics, David Geffen School of Medicine at UCLA, University of California, Los Angeles, Los Angeles, CA, United States of America</addr-line>
</aff>
<aff id="aff008">
<label>8</label>
<addr-line>Department of Biostatistics, UCLA Fielding School of Public Health, University of California, Los Angeles, Los Angeles, California, United States of America</addr-line>
</aff>
<aff id="aff009">
<label>9</label>
<addr-line>Department of Biology, University of Washington, Seattle, Washington, United States of America</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Kosakovsky Pond</surname> <given-names>Sergei L.</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Temple University, UNITED STATES</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con" id="contrib001">
<p>Conceived and designed the experiments: MDK JAP TB MAS VNM. Performed the experiments: MDK JAP. Analyzed the data: MDK JAP. Contributed reagents/materials/analysis tools: MDK JAP TB MAS VNM. Wrote the paper: MDK JAP TB MAS VNM.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">vminin@uw.edu</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>3</month>
<year>2016</year>
</pub-date>
<pub-date pub-type="epub">
<day>3</day>
<month>3</month>
<year>2016</year>
</pub-date>
<volume>12</volume>
<issue>3</issue>
<elocation-id>e1004789</elocation-id>
<history>
<date date-type="received">
<day>3</day>
<month>10</month>
<year>2015</year>
</date>
<date date-type="accepted">
<day>2</day>
<month>2</month>
<year>2016</year>
</date>
</history>
<permissions>
<copyright-year>2016</copyright-year>
<copyright-holder>Karcher et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1004789"/>
<abstract>
<p>Phylodynamics seeks to estimate effective population size fluctuations from molecular sequences of individuals sampled from a population of interest. One way to accomplish this task formulates an observed sequence data likelihood exploiting a coalescent model for the sampled individuals’ genealogy and then integrating over all possible genealogies via Monte Carlo or, less efficiently, by conditioning on one genealogy estimated from the sequence data. However, when analyzing sequences sampled serially through time, current methods implicitly assume either that sampling times are fixed deterministically by the data collection protocol or that their distribution does not depend on the size of the population. Through simulation, we first show that, when sampling times do probabilistically depend on effective population size, estimation methods may be systematically biased. To correct for this deficiency, we propose a new model that explicitly accounts for preferential sampling by modeling the sampling times as an inhomogeneous Poisson process dependent on effective population size. We demonstrate that in the presence of preferential sampling our new model not only reduces bias, but also improves estimation precision. Finally, we compare the performance of the currently used phylodynamic methods with our proposed model through clinically-relevant, seasonal human influenza examples.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>Phylodynamics seeks to estimate changes in population size from genetic data sampled from individuals across a particular population. One approach to accomplish this task uses a model called the coalescent, which relates the shape of the individuals’ shared ancestral tree to genetic diversity, which is in turn related to population size. However, when analyzing genetic data sampled at different times, current techniques assume that sampling times are fixed ahead of time or are distributed randomly without any relation to the size of the population. Through simulation, we show that when sampling times are related to population size, a situation referred to as preferential sampling, those estimation methods may be systematically biased. To fix this problem, we propose a new model that explicitly accounts for and models the preferential sampling. We show that in the presence of preferential sampling our new technique not only fixes the bias, but also has improved precision in its population size estimates. We also compare the performance of the old and new techniques on several real-world seasonal human influenza examples.</p>
</abstract>
<funding-group>
<funding-statement>JAP acknowledges scholarship from CONACyT Mexico to pursue her research. MDK, MAS, and VNM are supported by the NIH grant R01 AI107034. MAS is supported by the NSF grant DMS 1264153 and NIH grant R01 LM012080. VNM is supported by the NIH grant U54 GM111274. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="7"/>
<table-count count="2"/>
<page-count count="19"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>Data are available through the R package phylodyn: <ext-link ext-link-type="uri" xlink:href="https://github.com/mdkarcher/phylodyn" xlink:type="simple">https://github.com/mdkarcher/phylodyn</ext-link>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Phylodynamics—a set of techniques for estimating population dynamics from genetic data—has proven useful in ecology and epidemiology [<xref ref-type="bibr" rid="pcbi.1004789.ref001">1</xref>, <xref ref-type="bibr" rid="pcbi.1004789.ref002">2</xref>]. Phylodynamics is especially useful in cases where ascertaining population sizes via traditional sampling methods is infeasible; e.g., in infectious disease epidemiology it is impossible to obtain the total number of infected individuals in a large population. Estimating population dynamics from a limited sample of genetic data is possible because changes in population size leave evidence in the molecular sequences of the population. Recently, techniques employing a nonparametric approach to inferring population trajectories have improved upon earlier models in terms of flexibility, accuracy, and precision by, e.g., employing Gaussian Markov random fields [<xref ref-type="bibr" rid="pcbi.1004789.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1004789.ref004">4</xref>] and Gaussian processes [<xref ref-type="bibr" rid="pcbi.1004789.ref005">5</xref>]. However, none of these state-of-the-art methods currently account for randomness in sampling time data, potentially introducing bias in studies where sampling times have a relationship to population dynamics. Through a simulation study we characterize this bias in a demographic scenario with seasonally varying population size. We also extend the state-of-the-art by incorporating a sampling time model into phylodynamic inference, mitigating the bias and improving precision.</p>
<p>Phylodynamic methods use Kingman’s coalescent model that, given a particular effective population size trajectory, defines the density of a genealogy relating the sampled individuals [<xref ref-type="bibr" rid="pcbi.1004789.ref006">6</xref>]. Effective population size measures genetic diversity present in the population and relates to census population size if certain assumptions are met [<xref ref-type="bibr" rid="pcbi.1004789.ref007">7</xref>]. Many early coalescent-based phylodynamic methods required strict parametric assumptions about the effective population size trajectory, such as constant through time [<xref ref-type="bibr" rid="pcbi.1004789.ref008">8</xref>] or exponential growth [<xref ref-type="bibr" rid="pcbi.1004789.ref009">9</xref>, <xref ref-type="bibr" rid="pcbi.1004789.ref010">10</xref>]. A major alternative arose with the advent of nonparametric methods, one of the earliest and most influential being the piecewise constant classical skyline model [<xref ref-type="bibr" rid="pcbi.1004789.ref011">11</xref>]. This approach greatly increases the number of estimated parameters, leading to noisy effective population size trajectories. A number of algorithms seeking compromise between the relative stability of parametric approaches and the flexibility of nonparametric approaches have been implemented [<xref ref-type="bibr" rid="pcbi.1004789.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1004789.ref004">4</xref>, <xref ref-type="bibr" rid="pcbi.1004789.ref012">12</xref>]. For a detailed comparison, see [<xref ref-type="bibr" rid="pcbi.1004789.ref013">13</xref>].</p>
<p>Many successful applications of phylodynamics methodology come from infectious disease epidemiology, where the effective population size is interpreted, albeit with caution, as the effective number of infections [<xref ref-type="bibr" rid="pcbi.1004789.ref014">14</xref>]. In these epidemiological applications, disease agent DNA or RNA sequences are collected at multiple times. When analyzing such heterochronous data, researchers implicitly assume that sampling times are either fixed or follow a distribution that is functionally independent of the effective population size trajectory. However, it is conceivable that the infectious disease agent DNA samples are collected more frequently when the number of infections is high and less frequently during time periods with few infections. Therefore, the implicit assumption of no relationship between sampling times and population dynamics, made by all state-of-the-art phylodynamic methods, is troublesome, since unrecognized preferential sampling leads to systematic estimation bias, as explored by Diggle et al. [<xref ref-type="bibr" rid="pcbi.1004789.ref015">15</xref>] in the context of spatial statistics. Furthermore, preferential sampling could be present in the sequence databases, but it could also be introduced accidentally or intentionally by filtering during database queries or data mining.</p>
<p>To test the effect of preferential sampling on phylodynamic inference we first perform a simulation study. We simulate sampling times according to multiple distributions, contrasting distributions functionally dependent on effective population size with a functionally independent distribution. We then simulate genealogies based on the sampling times and perform state-of-the-art phylodynamic analyses, and we find that ignoring preferential sampling can bias effective population size estimation and that the size of the bias depends on the local properties of the effective population size trajectory.</p>
<p>In order to account for preferential sampling, we formulate a new phylodynamic model in which sampling times are generated from an inhomogeneous Poisson process with intensity functionally dependent on effective population size. Our model is similar to the augmented coalescent model of Volz and Frost, who work with a specific parametric model [<xref ref-type="bibr" rid="pcbi.1004789.ref016">16</xref>]. In contrast, we work within a nonparametric framework by incorporating our Poisson preferential sampling model into a Gaussian process-based Bayesian phylodynamic method [<xref ref-type="bibr" rid="pcbi.1004789.ref003">3</xref>–<xref ref-type="bibr" rid="pcbi.1004789.ref005">5</xref>]. Applying our new sampling-aware method to our simulations shows that modeling preferential sampling eliminates the aforementioned bias and can increase precision of the phylodynamic inference. In all of our developments, we assume that the genealogy of the sample is known without error. This assumption allows us to use an integrated nested Laplace approximation (INLA) to make our Bayesian inference computationally efficient [<xref ref-type="bibr" rid="pcbi.1004789.ref017">17</xref>, <xref ref-type="bibr" rid="pcbi.1004789.ref018">18</xref>], which is important for executing our simulation studies.</p>
<p>Finally, we examine the performance of our algorithm on two real-world examples. Rambaut et al.[<xref ref-type="bibr" rid="pcbi.1004789.ref019">19</xref>] explore the seasonal variation of genetic diversity in the genes that code for several of the most important proteins in the two most common influenza subtypes, H3N2 and H1N1. For the sake of brevity we only analyze the hemagglutinin gene in H3N2. We find evidence of preferential sampling in the dataset, and our sampling-aware method produces a large improvement in precision over the conditional (sampling un-aware) method. Zinder et al.[<xref ref-type="bibr" rid="pcbi.1004789.ref020">20</xref>] specifically explore the patterns of seasonal migration of genetic diversity of H3N2 influenza across the regions of the world. We examine the regions separately and find differing strengths of preferential sampling, but in all regions our method performs better than the conditional model. In some regions, we see stronger relationships between sampling frequency and population size, most often in regions with the most seasonal variation in incidence.</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Methods</title>
<sec id="sec003">
<title>State-of-the-art phylodynamics</title>
<p>Consider a sample of individuals from a well-mixed population. Some individuals will share a common ancestor more recently than others. One pair of individuals in particular will have the pairwise most recent common ancestor. Moving backwards in time, we can consider those two individuals to have <italic>coalesced</italic>, treating the two individuals as one. We can then repeat this process of finding the pairwise most recent common ancestor and coalescing individuals until we reach the most recent common ancestor of the entire sample. If we keep track of the ancestral lineages and coalescences of the individuals, we see the data take the shape of a bifurcating tree, and we refer to this ancestry tree as a <italic>genealogy</italic> (illustrated in <xref ref-type="fig" rid="pcbi.1004789.g001">Fig 1</xref>).</p>
<fig id="pcbi.1004789.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004789.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Illustration of an example heterochronous genealogy with <italic>n</italic> = 5 lineages.</title>
<p>Sampling times <italic>s</italic><sub>1</sub>, …, <italic>s</italic><sub>5</sub> and coalescent times <italic>t</italic><sub>1</sub>, …, <italic>t</italic><sub>5</sub> are marked below the genealogy.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004789.g001" xlink:type="simple"/>
</fig>
<p>We refer to the branching points of the genealogy tree as <italic>coalescent events</italic>. If the samples are all taken simultaneously, we refer to the genealogy as <italic>isochronous</italic>. Kingman’s original coalescent provided a density for isochronous genealogies with a fixed effective population size [<xref ref-type="bibr" rid="pcbi.1004789.ref006">6</xref>]. Later extensions to the coalescent allowed for parametric and nonparametric specifications of effective population size trajectories along with <italic>heterochronous</italic> sampling times. Heterochronous sampling times (also called sampling events) can occur at any time up to the present.</p>
<p>We consider first the case of a fixed, heterochronous genealogy [<xref ref-type="bibr" rid="pcbi.1004789.ref021">21</xref>]. The coalescent likelihood has sufficient statistics <inline-formula id="pcbi.1004789.e001"><alternatives><graphic id="pcbi.1004789.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004789.e001" xlink:type="simple"/><mml:math display="inline" id="M1"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">g</mml:mi> <mml:mo>=</mml:mo> <mml:msubsup><mml:mrow><mml:mo>{</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>}</mml:mo></mml:mrow> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:msubsup></mml:mrow> <mml:mo>,</mml:mo> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>=</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>&lt;</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>&lt;</mml:mo> <mml:mo>…</mml:mo> <mml:mo>&lt;</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, representing the coalescent times, and <inline-formula id="pcbi.1004789.e002"><alternatives><graphic id="pcbi.1004789.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004789.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">s</mml:mi> <mml:mo>=</mml:mo> <mml:msubsup><mml:mrow><mml:mo>{</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>}</mml:mo></mml:mrow> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>m</mml:mi></mml:msubsup></mml:mrow> <mml:mo>,</mml:mo> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>=</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>&lt;</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>&lt;</mml:mo> <mml:mo>…</mml:mo> <mml:mo>&lt;</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow> <mml:mo>,</mml:mo> <mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>m</mml:mi></mml:msubsup> <mml:msub><mml:mi>n</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi>n</mml:mi></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, representing the sampling times along with the corresponding number of lineages sampled (see <xref ref-type="fig" rid="pcbi.1004789.g001">Fig 1</xref>). We define the number of <italic>active lineages</italic> at time <italic>t</italic> as the number of lineages sampled between <italic>t</italic> and the present, minus the number of coalescent events between <italic>t</italic> and the present. In <xref ref-type="fig" rid="pcbi.1004789.g001">Fig 1</xref>, this appears as the number of horizontal lines that a vertical line at time <italic>t</italic> will cross.</p>
<p>We define a partition of (0, <italic>t</italic><sub>1</sub>) with intervals <italic>I</italic><sub><italic>i</italic>,<italic>k</italic></sub> for <italic>k</italic> = 1, …, <italic>n</italic>. We let <italic>I</italic><sub>0,<italic>k</italic></sub> represent the intervals ending with a coalescent event and let <italic>I</italic><sub><italic>i</italic>,<italic>k</italic></sub> for <italic>i</italic> = 1, …, <italic>m</italic><sub><italic>k</italic></sub> represent the <italic>m</italic><sub><italic>k</italic></sub> intervals ending in a sampling event between the (<italic>k</italic> − 1)th and <italic>k</italic>th coalescent events (see Intervals in <xref ref-type="fig" rid="pcbi.1004789.g001">Fig 1</xref>). We let <inline-formula id="pcbi.1004789.e003"><alternatives><graphic id="pcbi.1004789.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004789.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:mrow><mml:msub><mml:mi>C</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mo>(</mml:mo> <mml:mfrac linethickness="0pt"><mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mn>2</mml:mn></mml:mfrac> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, where <italic>n</italic><sub><italic>i</italic>,<italic>k</italic></sub> is the number of active lineages in the interval <italic>I</italic><sub><italic>i</italic>,<italic>k</italic></sub>. Suppose <bold>s</bold> is fixed, then the coalescent likelihood is
<disp-formula id="pcbi.1004789.e004"><alternatives><graphic id="pcbi.1004789.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004789.e004" xlink:type="simple"/><mml:math display="block" id="M4"><mml:mrow><mml:mo form="prefix">Pr</mml:mo> <mml:mrow><mml:mo>[</mml:mo> <mml:mi mathvariant="bold">g</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>N</mml:mi> <mml:mi>e</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">s</mml:mi> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>∝</mml:mo> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>2</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:munderover> <mml:mfrac><mml:msub><mml:mi>C</mml:mi> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:msub><mml:mi>N</mml:mi> <mml:mi>e</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:mo form="prefix">exp</mml:mo> <mml:mfenced close="]" open="[" separators=""><mml:mo>-</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow> <mml:msub><mml:mi>m</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:munderover> <mml:mrow><mml:msub><mml:mo>∫</mml:mo> <mml:msub><mml:mi>I</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:msub> <mml:mrow><mml:mfrac><mml:msub><mml:mi>C</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:msub><mml:mi>N</mml:mi> <mml:mi>e</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:mfenced> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives></disp-formula></p>
<p>In Bayesian phylodynamic inference, our aim is to explore the posterior distribution of the effective population size trajectory <italic>N</italic><sub><italic>e</italic></sub>(<italic>t</italic>), so we employ a Gaussian process prior Pr[<italic>N</italic><sub><italic>e</italic></sub>(<italic>t</italic>)∣<italic>τ</italic>], where <italic>N</italic><sub><italic>e</italic></sub>(<italic>t</italic>) = exp[<italic>γ</italic>(<italic>t</italic>)], with <inline-formula id="pcbi.1004789.e005"><alternatives><graphic id="pcbi.1004789.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004789.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:mrow><mml:mi>γ</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo> <mml:mo>∼</mml:mo> <mml:mtext mathvariant="script">BM</mml:mtext> <mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> following a Brownian motion with precision parameter <italic>τ</italic>[<xref ref-type="bibr" rid="pcbi.1004789.ref018">18</xref>]. We assign a Gamma(0.01, 0.01) hyperprior to <italic>τ</italic>. This results in the posterior Pr[<italic>N</italic><sub><italic>e</italic></sub>(<italic>t</italic>), <italic>τ</italic>∣<bold>g</bold>]∝Pr[<bold>g</bold>∣<italic>N</italic><sub><italic>e</italic></sub>(<italic>t</italic>)]Pr[<italic>N</italic><sub><italic>e</italic></sub>(<italic>t</italic>)∣<italic>τ</italic>]Pr(<italic>τ</italic>).</p>
<p>The continuous case as written above involves an infinite-dimensional object—the function <italic>N</italic><sub><italic>e</italic></sub>(<italic>t</italic>)—which makes the problem as stated intractable. However, we can approximate the continuous function with a piecewise constant function. We construct a fine, regular grid <inline-formula id="pcbi.1004789.e006"><alternatives><graphic id="pcbi.1004789.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004789.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:mrow><mml:mi mathvariant="bold">x</mml:mi> <mml:mo>=</mml:mo> <mml:msubsup><mml:mrow><mml:mo>{</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>}</mml:mo></mml:mrow> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>B</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> with grid width <italic>w</italic> over the interval that supports the genealogy and let <italic>γ</italic><sub><italic>j</italic></sub> = log[<italic>N</italic><sub><italic>e</italic></sub>(<italic>x</italic><sub><italic>j</italic></sub>)]. We construct a piecewise constant approximation <inline-formula id="pcbi.1004789.e007"><alternatives><graphic id="pcbi.1004789.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004789.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:mrow><mml:msup><mml:mi>N</mml:mi> <mml:mi mathvariant="bold-italic">γ</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>B</mml:mi></mml:msubsup> <mml:mrow><mml:mo form="prefix">exp</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>γ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mn>1</mml:mn> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>∈</mml:mo> <mml:mo>[</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:mi>w</mml:mi> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn> <mml:mo>,</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mi>w</mml:mi> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. The discretized coalescent likelihood becomes
<disp-formula id="pcbi.1004789.e008"><alternatives><graphic id="pcbi.1004789.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004789.e008" xlink:type="simple"/><mml:math display="block" id="M8"><mml:mrow><mml:mo form="prefix">Pr</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">g</mml:mi> <mml:mo>∣</mml:mo> <mml:mi mathvariant="bold-italic">γ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∝</mml:mo> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>2</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:munderover> <mml:mfrac><mml:msub><mml:mi>C</mml:mi> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:msup><mml:mi>N</mml:mi> <mml:mi mathvariant="bold-italic">γ</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:mo form="prefix">exp</mml:mo> <mml:mfenced close="]" open="[" separators=""><mml:mo>-</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow> <mml:msub><mml:mi>m</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:munderover> <mml:mrow><mml:msub><mml:mo>∫</mml:mo> <mml:msub><mml:mi>I</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:msub> <mml:mrow><mml:mfrac><mml:msub><mml:mi>C</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:msup><mml:mi>N</mml:mi> <mml:mi mathvariant="bold-italic">γ</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:mfenced> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(1)</label></disp-formula>
where <bold><italic>γ</italic></bold> = (<italic>γ</italic><sub>1</sub>, …, <italic>γ</italic><sub><italic>B</italic></sub>) and the integrals are simple to compute over the step function <italic>N</italic><sup><italic>γ</italic></sup>(<italic>t</italic>). We discretize the Brownian process prior with an intrinsic random walk prior,
<disp-formula id="pcbi.1004789.e009"><alternatives><graphic id="pcbi.1004789.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004789.e009" xlink:type="simple"/><mml:math display="block" id="M9"><mml:mrow><mml:mo form="prefix">Pr</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">γ</mml:mi> <mml:mo>∣</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∝</mml:mo> <mml:msup><mml:mi>τ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>n</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:msup> <mml:mo form="prefix">exp</mml:mo> <mml:mfenced close="]" open="[" separators=""><mml:mo>-</mml:mo> <mml:mfrac><mml:mi>τ</mml:mi> <mml:mn>2</mml:mn></mml:mfrac> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mi>B</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:munderover> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>γ</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>γ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mfenced> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
Finally, the discretized posterior becomes Pr(<bold><italic>γ</italic></bold>, <italic>τ</italic>∣<bold>g</bold>)∝Pr(<bold>g</bold>∣<bold><italic>γ</italic></bold>)Pr(<bold><italic>γ</italic></bold>|<italic>τ</italic>)Pr(<italic>τ</italic>).</p>
<p>With the posterior known (up to a proportionality constant), we can proceed with numerical integration techniques such as Markov chain Monte Carlo (MCMC) or INLA—a deterministic algorithm for approximating posterior distributions. We select INLA and name the implementation Bayesian nonparametric phylodynamic reconstruction (BNPR).</p>
</sec>
<sec id="sec004">
<title>Phylodynamics with preferential sampling</title>
<p>In the previous section we made the assumption that we could safely ignore any potential dependence of sampling times <bold>s</bold> on effective population size <italic>N</italic><sup><bold><italic>γ</italic></bold></sup>(<italic>t</italic>) in our calculations. In this section, we relax this assumption. We model sampling times according to an inhomogeneous Poisson process in a fixed sampling window [0, <italic>s</italic><sub>0</sub>], with intensity <inline-formula id="pcbi.1004789.e010"><alternatives><graphic id="pcbi.1004789.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004789.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:mrow><mml:mi>λ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>β</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mrow><mml:mo>[</mml:mo> <mml:msup><mml:mi>N</mml:mi> <mml:mi mathvariant="bold-italic">γ</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:msub><mml:mi>β</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, i.e. proportional to a power of the effective population size, where <italic>β</italic><sub>0</sub> and <italic>β</italic><sub>1</sub> are unknown parameters. The sampling log-likelihood is
<disp-formula id="pcbi.1004789.e011"><alternatives><graphic id="pcbi.1004789.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004789.e011" xlink:type="simple"/><mml:math display="block" id="M11"><mml:mrow><mml:mo form="prefix">log</mml:mo> <mml:mrow><mml:mo>[</mml:mo> <mml:mo form="prefix">Pr</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">s</mml:mi> <mml:mo>∣</mml:mo> <mml:mi mathvariant="bold-italic">γ</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>β</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>β</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>C</mml:mi> <mml:mo>+</mml:mo> <mml:mi>n</mml:mi> <mml:msub><mml:mi>β</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:munderover> <mml:mrow><mml:msub><mml:mi>β</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo form="prefix">log</mml:mo> <mml:mrow><mml:mo>[</mml:mo> <mml:msup><mml:mi>N</mml:mi> <mml:mi mathvariant="bold-italic">γ</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:msub><mml:mi>s</mml:mi> <mml:mi>m</mml:mi></mml:msub></mml:mrow> <mml:msub><mml:mi>s</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:msubsup> <mml:mrow><mml:mo form="prefix">exp</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>β</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mrow><mml:mo>[</mml:mo> <mml:msup><mml:mi>N</mml:mi> <mml:mi mathvariant="bold-italic">γ</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>r</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:msub><mml:mi>β</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:msup> <mml:mi>d</mml:mi> <mml:mi>r</mml:mi></mml:mrow></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
To illustrate our parameterization, sampling with <italic>β</italic><sub>1</sub> = 1 would result in collecting genetic sequences with intensity directly proportional to effective population size, while higher <italic>β</italic><sub>1</sub> values result in more clustered samples. Conversely, <italic>β</italic><sub>1</sub> = 0 produces a uniform distribution of sampling times, with a Poisson distribution on the number of individuals sampled.</p>
<p>In many datasets, the sampling time data will have low enough resolution (for instance, only recording the date but not time of sampling) that some sampling times will appear to be coincident. Our sampling model is compatible with simultaneous sampling times because the model naturally bins the samples along our earlier discretization. The likelihood is proportional to a product of Poisson mass functions centered at the grid points <bold>x</bold>.</p>
<p>The genealogy depends on the sampling times, so we condition on <bold>s</bold> in the likelihood for <bold>g</bold>. We are treating <bold>s</bold> as random, so we insert the likelihood term for it as well as independent Normal priors for parameters <italic>β</italic><sub>0</sub> and <italic>β</italic><sub>1</sub>—specifically <italic>β</italic><sub><italic>i</italic></sub> ∼ <italic>N</italic>(mean = 0, variance = 1000) for <italic>i</italic> = 0, 1. We retain the same hyperprior for the precision parameter <italic>τ</italic> as above. This results in the posterior that accounts for preferential sampling,
<disp-formula id="pcbi.1004789.e012"><alternatives><graphic id="pcbi.1004789.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004789.e012" xlink:type="simple"/><mml:math display="block" id="M12"><mml:mrow><mml:mo form="prefix">Pr</mml:mo> <mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">γ</mml:mi> <mml:mo>,</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">β</mml:mi> <mml:mo>∣</mml:mo> <mml:mi mathvariant="bold">g</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">s</mml:mi> <mml:mo>)</mml:mo> <mml:mo>∝</mml:mo> <mml:mo form="prefix">Pr</mml:mo> <mml:mo>(</mml:mo> <mml:mi mathvariant="bold">g</mml:mi> <mml:mo>∣</mml:mo> <mml:mi mathvariant="bold">s</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">γ</mml:mi> <mml:mo>)</mml:mo> <mml:mo form="prefix">Pr</mml:mo> <mml:mo>(</mml:mo> <mml:mi mathvariant="bold">s</mml:mi> <mml:mo>∣</mml:mo> <mml:mi mathvariant="bold-italic">γ</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">β</mml:mi> <mml:mo>)</mml:mo> <mml:mo form="prefix">Pr</mml:mo> <mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">γ</mml:mi> <mml:mo>∣</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo> <mml:mo form="prefix">Pr</mml:mo> <mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo> <mml:mo form="prefix">Pr</mml:mo> <mml:mo>(</mml:mo> <mml:mi>β</mml:mi> <mml:mo>)</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
where Pr(<bold>g</bold>∣<bold>s</bold>, <bold><italic>γ</italic></bold>) is defined by <xref ref-type="disp-formula" rid="pcbi.1004789.e008">Eq (1)</xref>, but now we add conditioning on <bold>s</bold> explicitly. In the case where the density of sampling times <bold>s</bold> is functionally independent of the vector of log effective population sizes <bold><italic>γ</italic></bold>, the posterior for <bold>g</bold> simplifies to the form it had in the previous section, because the likelihood for <bold>s</bold> becomes a constant in <bold><italic>γ</italic></bold>. We incorporate our sampling model into an INLA framework similar to BNPR and name the implementation Bayesian nonparametric phylodynamic reconstruction with preferential sampling (BNPR-PS).</p>
</sec>
<sec id="sec005">
<title>INLA framework</title>
<p>Here we present a brief outline of the INLA methodology [<xref ref-type="bibr" rid="pcbi.1004789.ref017">17</xref>] in the context of our BNPR and BNPR-PS implementations. We first examine BNPR as the simpler model. In the end, we intend to estimate the marginal posteriors of the precision hyperparameter Pr(<italic>τ</italic>∣<bold>g</bold>) and the latent points Pr(<italic>γ</italic><sub><italic>i</italic></sub>∣<bold>g</bold>), <italic>i</italic> = 1, …, <italic>B</italic>, most often focusing on the posterior medians and the end points of the 95% Bayesian credible intervals. We approximate the marginal of <italic>τ</italic> with
<disp-formula id="pcbi.1004789.e013"><alternatives><graphic id="pcbi.1004789.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004789.e013" xlink:type="simple"/><mml:math display="block" id="M13"><mml:mrow><mml:mover accent="true"><mml:mo form="prefix">Pr</mml:mo> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>∣</mml:mo> <mml:mi mathvariant="bold">g</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∝</mml:mo> <mml:msub><mml:mfenced close="|" open="" separators=""><mml:mfrac><mml:mrow><mml:mo form="prefix">Pr</mml:mo> <mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">γ</mml:mi> <mml:mo>,</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">g</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:msub><mml:mover accent="true"><mml:mo form="prefix">Pr</mml:mo> <mml:mo>^</mml:mo></mml:mover> <mml:mi mathvariant="bold">G</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">γ</mml:mi> <mml:mo>∣</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">g</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mfenced> <mml:mrow><mml:mi mathvariant="bold-italic">γ</mml:mi> <mml:mo>=</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">γ</mml:mi></mml:mrow> <mml:mo>*</mml:mo></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
where <inline-formula id="pcbi.1004789.e014"><alternatives><graphic id="pcbi.1004789.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004789.e014" xlink:type="simple"/><mml:math display="inline" id="M14"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mo form="prefix">Pr</mml:mo> <mml:mo>^</mml:mo></mml:mover> <mml:mi mathvariant="bold">G</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">γ</mml:mi> <mml:mo>∣</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">g</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is the Gaussian approximation generated from a Taylor expansion around <bold><italic>γ</italic></bold>*(<italic>τ</italic>), the mode of Pr(<bold><italic>γ</italic></bold>∣<italic>τ</italic>, <bold>g</bold>) for a given <italic>τ</italic>. We can find <bold><italic>γ</italic></bold>*(<italic>τ</italic>) using the Newton-Raphson method.</p>
<p>Next, we need to approximate the distribution of <italic>γ</italic><sub><italic>i</italic></sub> conditional on <italic>τ</italic>. The simplest method of using the Gaussian approximations above can produce errors [<xref ref-type="bibr" rid="pcbi.1004789.ref017">17</xref>], so we briefly describe the use of nested Laplace approximations. The full implementation details can be found in [<xref ref-type="bibr" rid="pcbi.1004789.ref017">17</xref>]. We define
<disp-formula id="pcbi.1004789.e015"><alternatives><graphic id="pcbi.1004789.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004789.e015" xlink:type="simple"/><mml:math display="block" id="M15"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mo form="prefix">Pr</mml:mo> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>L</mml:mi> <mml:mi>A</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>γ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>∣</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">g</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∝</mml:mo> <mml:msub><mml:mfenced close="|" open="" separators=""><mml:mfrac><mml:mrow><mml:mo form="prefix">Pr</mml:mo> <mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">γ</mml:mi> <mml:mo>,</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">g</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:msub><mml:mover accent="true"><mml:mo form="prefix">Pr</mml:mo> <mml:mo>^</mml:mo></mml:mover> <mml:mtext mathvariant="bold">GG</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">γ</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>∣</mml:mo> <mml:msub><mml:mi>γ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">g</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mfenced> <mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">γ</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">γ</mml:mi></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
where <inline-formula id="pcbi.1004789.e016"><alternatives><graphic id="pcbi.1004789.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004789.e016" xlink:type="simple"/><mml:math display="inline" id="M16"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mo form="prefix">Pr</mml:mo> <mml:mo>^</mml:mo></mml:mover> <mml:mtext mathvariant="bold">GG</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">γ</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>∣</mml:mo> <mml:msub><mml:mi>γ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">g</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is a Gaussian approximation of Pr(<bold><italic>γ</italic></bold><sub>−<italic>i</italic></sub>∣<italic>γ</italic><sub><italic>i</italic></sub>, <italic>τ</italic>, <bold>g</bold>) obtained by a Taylor expansion around <inline-formula id="pcbi.1004789.e017"><alternatives><graphic id="pcbi.1004789.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004789.e017" xlink:type="simple"/><mml:math display="inline" id="M17"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">γ</mml:mi></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>=</mml:mo> <mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mphantom><mml:mpadded width="0pt"><mml:mo>(</mml:mo></mml:mpadded></mml:mphantom></mml:mrow> <mml:mi mathvariant="bold">G</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">γ</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>∣</mml:mo> <mml:msub><mml:mi>γ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">g</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, which is computed using <inline-formula id="pcbi.1004789.e018"><alternatives><graphic id="pcbi.1004789.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004789.e018" xlink:type="simple"/><mml:math display="inline" id="M18"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mo form="prefix">Pr</mml:mo> <mml:mo>^</mml:mo></mml:mover> <mml:mi mathvariant="bold">G</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">γ</mml:mi> <mml:mo>∣</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">g</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Finally, we normalize and combine the two approximations, then use numerical integration to calculate
<disp-formula id="pcbi.1004789.e019"><alternatives><graphic id="pcbi.1004789.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004789.e019" xlink:type="simple"/><mml:math display="block" id="M19"><mml:mrow><mml:mover accent="true"><mml:mo form="prefix">Pr</mml:mo> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>γ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>∣</mml:mo> <mml:mi mathvariant="bold">g</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>∫</mml:mo> <mml:mrow><mml:mover accent="true"><mml:mo form="prefix">Pr</mml:mo> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>γ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>∣</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">g</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mover accent="true"><mml:mo form="prefix">Pr</mml:mo> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>∣</mml:mo> <mml:mi mathvariant="bold">g</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>d</mml:mi> <mml:mi>τ</mml:mi></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives></disp-formula></p>
<p>The outline for BNPR-PS is very similar. The approximate marginal of the hyperparameters is
<disp-formula id="pcbi.1004789.e020"><alternatives><graphic id="pcbi.1004789.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004789.e020" xlink:type="simple"/><mml:math display="block" id="M20"><mml:mrow><mml:mover accent="true"><mml:mo form="prefix">Pr</mml:mo> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>,</mml:mo> <mml:mi>β</mml:mi> <mml:mo>∣</mml:mo> <mml:mi mathvariant="bold">g</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∝</mml:mo> <mml:msub><mml:mfenced close="|" open="" separators=""><mml:mfrac><mml:mrow><mml:mo form="prefix">Pr</mml:mo> <mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">γ</mml:mi> <mml:mo>,</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">β</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">g</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:msub><mml:mover accent="true"><mml:mo form="prefix">Pr</mml:mo> <mml:mo>^</mml:mo></mml:mover> <mml:mi mathvariant="bold">G</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">γ</mml:mi> <mml:mo>∣</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">β</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">g</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">s</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mfenced> <mml:mrow><mml:mi mathvariant="bold-italic">γ</mml:mi> <mml:mo>=</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">γ</mml:mi></mml:mrow> <mml:mo>*</mml:mo></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">β</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
for similarly defined factors. We take advantage of an INLA extension by Martins et al. [<xref ref-type="bibr" rid="pcbi.1004789.ref022">22</xref>] that allows for multiple likelihoods. The approximate distribution of <italic>γ</italic><sub><italic>i</italic></sub> conditional on <italic>τ</italic>, <bold><italic>β</italic></bold> becomes
<disp-formula id="pcbi.1004789.e021"><alternatives><graphic id="pcbi.1004789.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004789.e021" xlink:type="simple"/><mml:math display="block" id="M21"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mo form="prefix">Pr</mml:mo> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>L</mml:mi> <mml:mi>A</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>γ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>∣</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">β</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">g</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∝</mml:mo> <mml:msub><mml:mfenced close="|" open="" separators=""><mml:mfrac><mml:mrow><mml:mo form="prefix">Pr</mml:mo> <mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">γ</mml:mi> <mml:mo>,</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">β</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">g</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:msub><mml:mover accent="true"><mml:mo form="prefix">Pr</mml:mo> <mml:mo>^</mml:mo></mml:mover> <mml:mtext mathvariant="bold">GG</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">γ</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>∣</mml:mo> <mml:msub><mml:mi>γ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">β</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">g</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">s</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mfenced> <mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">γ</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">γ</mml:mi></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
and the final numerical integration is analogously more complex but still tractable, since we integrate over both <italic>τ</italic> and <bold><italic>β</italic></bold>.</p>
<p>We use the R-INLA package [<xref ref-type="bibr" rid="pcbi.1004789.ref017">17</xref>, <xref ref-type="bibr" rid="pcbi.1004789.ref022">22</xref>] to perform the above calculations. We make INLA approximations of BNPR and BNPR-PS posteriors available, along with other phylodynamic tools, in the R package <monospace>phylodyn</monospace> which can be found at <ext-link ext-link-type="uri" xlink:href="https://github.com/mdkarcher/phylodyn" xlink:type="simple">https://github.com/mdkarcher/phylodyn</ext-link>.</p>
</sec>
</sec>
<sec id="sec006" sec-type="results">
<title>Results</title>
<sec id="sec007">
<title>Simulation study</title>
<p>We investigate estimating effective population size in the presence of preferential sampling via simulated data. First, we seek to show where and how the model misspecification resulting from ignoring preferential sampling manifests itself in terms of posterior median and Bayesian credible interval width estimation. Our second goal is to show what we gain by properly modeling preferential sampling.</p>
<p>Our primary set of simulation results use the family of seasonally-varying effective population size functions characterized by
<disp-formula id="pcbi.1004789.e022"><alternatives><graphic id="pcbi.1004789.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004789.e022" xlink:type="simple"/><mml:math display="block" id="M22"><mml:mrow><mml:msub><mml:mi>N</mml:mi> <mml:mrow><mml:mi>e</mml:mi> <mml:mo>,</mml:mo> <mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>o</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfenced close="" open="{" separators=""><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mn>10</mml:mn> <mml:mo>+</mml:mo> <mml:mn>90</mml:mn> <mml:mo>/</mml:mo> <mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mo>{</mml:mo> <mml:mi>a</mml:mi> <mml:mo>[</mml:mo> <mml:mn>3</mml:mn> <mml:mo>-</mml:mo> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mi>o</mml:mi> <mml:mspace width="4.pt"/><mml:mtext>(mod</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>12)</mml:mtext> <mml:mo>)</mml:mo> <mml:mo>]</mml:mo> <mml:mo>}</mml:mo> <mml:mo>)</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext> <mml:mspace width="4.pt"/><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mi>o</mml:mi> <mml:mspace width="4.pt"/><mml:mtext>(mod</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>12)</mml:mtext> <mml:mspace width="4.pt"/><mml:mo>≤</mml:mo> <mml:mn>6</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mn>10</mml:mn> <mml:mo>+</mml:mo> <mml:mn>90</mml:mn> <mml:mo>/</mml:mo> <mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mo>{</mml:mo> <mml:mi>a</mml:mi> <mml:mo>[</mml:mo> <mml:mn>3</mml:mn> <mml:mo>+</mml:mo> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mi>o</mml:mi> <mml:mspace width="4.pt"/><mml:mtext>(mod</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>12)</mml:mtext> <mml:mo>)</mml:mo> <mml:mo>-</mml:mo> <mml:mn>12</mml:mn> <mml:mo>]</mml:mo> <mml:mo>}</mml:mo> <mml:mo>)</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext> <mml:mspace width="4.pt"/><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mi>o</mml:mi> <mml:mspace width="4.pt"/><mml:mtext>(mod</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>12)</mml:mtext> <mml:mspace width="4.pt"/><mml:mo>&gt;</mml:mo> <mml:mn>6</mml:mn> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mrow></mml:math></alternatives> <label>(2)</label></disp-formula>
For all of our experiments, the smoothness parameter <italic>a</italic> = 2 will be used. This family emulates a cyclical population time series with <italic>t</italic> in nominal months. The shape is loosely modeled after flu seasons, with <italic>o</italic> controlling which part of the year <italic>t</italic> = 0 represents (<italic>o</italic> = 0, 3, 6 emulates summer, spring, and winter, respectively). We simulate genealogies with varying tip sampling times using two sampling schedules. The uniform schedule distributes <italic>n</italic> sampling times uniformly throughout a given sampling interval. The proportional schedule distributes sampling times in the sampling interval according to an inhomogeneous Poisson process with intensity proportional to effective population size. The proportionality constant here is tuned to have an expected number of sampling times equal to <italic>n</italic>.</p>
<p>We explore the properties of our two methods using a Monte Carlo approach. To create a Monte Carlo iteration, we generate our sampling times according to their sampling schedules, then simulate our genealogies using coalescent theory via the rejection sampling method of [<xref ref-type="bibr" rid="pcbi.1004789.ref005">5</xref>]. Given the genealogy and the samples, we infer the effective population time series, using BNPR and BNPR-PS to approximate grids of marginal posteriors. For each iteration, this gives us approximate estimates of the posterior median and quantiles at each point in the effective population size time series. In <xref ref-type="fig" rid="pcbi.1004789.g002">Fig 2</xref>, we see outputs from BNPR and BNPR-PS on the same example iteration.</p>
<fig id="pcbi.1004789.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004789.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Graphical representation of the output of a single genealogy simulation and integrated nested Laplace approximation (INLA) estimation.</title>
<p>The dotted black lines represent the true population trajectory. The solid colored lines represent the posterior median estimates, while the shaded regions represent the 95% credible regions. At bottom, the upper and lower heatmaps represent frequencies of sampling events and coalescent events, respectively. For this figure, we sampled individuals according to an inhomogeneous Poisson process with intensity proportional to effective population size <italic>N</italic><sub><italic>e</italic></sub>(<italic>t</italic>). The plot on the left is generated by Bayesian nonparametric phylodynamic reconstruction (BNPR) and does not account for preferential sampling, while the plot on the right is generated by Bayesian nonparametric phylodynamic reconstruction with preferential sampling (BNPR-PS) and incorporates our sampling time model. Time is in months.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004789.g002" xlink:type="simple"/>
</fig>
<p>Our first set of experiments is aimed at determining the extent of the bias introduced by unaccounted preferential sampling. With <italic>r</italic> Monte Carlo iterations, we take two approaches to locating model misspecification error—time interval analysis and pointwise analysis. For time interval analyses, we calculate summary statistics for a pre-specified time interval (<italic>a</italic>, <italic>b</italic>) and average them over the set of <italic>r</italic> simulation iterations. For pointwise analyses however, we consider the time series of point estimates from each iteration, and then on a pointwise basis we calculate aggregate point estimates and confidence intervals.</p>
<p>Our time interval summary statistics are <italic>mean relative deviation</italic>,
<disp-formula id="pcbi.1004789.e023"><alternatives><graphic id="pcbi.1004789.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004789.e023" xlink:type="simple"/><mml:math display="block" id="M23"><mml:mrow><mml:mtext>MRD</mml:mtext> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>r</mml:mi></mml:mfrac> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>r</mml:mi></mml:munderover> <mml:mfenced close="]" open="[" separators=""><mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mi>b</mml:mi> <mml:mo>-</mml:mo> <mml:mi>a</mml:mi></mml:mrow></mml:mfrac> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:msubsup> <mml:mfrac><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msubsup><mml:mover accent="true"><mml:mi>N</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi> <mml:mi>γ</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msup><mml:mi>N</mml:mi> <mml:mi mathvariant="bold-italic">γ</mml:mi></mml:msup> <mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>|</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msup><mml:mi>N</mml:mi> <mml:mi mathvariant="bold-italic">γ</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mfenced> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula> <italic>mean relative width</italic> of the 95% Bayesian credible intervals,
<disp-formula id="pcbi.1004789.e024"><alternatives><graphic id="pcbi.1004789.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004789.e024" xlink:type="simple"/><mml:math display="block" id="M24"><mml:mrow><mml:mtext>MRW</mml:mtext> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>r</mml:mi></mml:mfrac> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>r</mml:mi></mml:munderover> <mml:mfenced close="]" open="[" separators=""><mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mi>b</mml:mi> <mml:mo>-</mml:mo> <mml:mi>a</mml:mi></mml:mrow></mml:mfrac> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:msubsup> <mml:mfrac><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>N</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>975</mml:mn></mml:mrow> <mml:mi>γ</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>N</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>025</mml:mn></mml:mrow> <mml:mi>γ</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msup><mml:mi>N</mml:mi> <mml:mi mathvariant="bold-italic">γ</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mfenced> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
where <italic>N</italic><sup><bold><italic>γ</italic></bold></sup>(<italic>t</italic>) is the discretized true effective population size trajectory, <inline-formula id="pcbi.1004789.e025"><alternatives><graphic id="pcbi.1004789.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004789.e025" xlink:type="simple"/><mml:math display="inline" id="M25"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>N</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi> <mml:mi>γ</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is the estimated posterior median of effective population sizes for iteration <italic>i</italic>, and <inline-formula id="pcbi.1004789.e026"><alternatives><graphic id="pcbi.1004789.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004789.e026" xlink:type="simple"/><mml:math display="inline" id="M26"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>N</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>q</mml:mi></mml:mrow> <mml:mi>γ</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is the estimated <italic>q</italic>th posterior quantile for iteration <italic>i</italic>. We also look at <italic>mean envelope</italic>, ME, the proportion of grid points where the credible interval contains the true trajectory, averaged over all grid points contained in [<italic>a</italic>, <italic>b</italic>] across all Monte Carlo iterations.</p>
<p>For a given grid of time points <inline-formula id="pcbi.1004789.e027"><alternatives><graphic id="pcbi.1004789.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004789.e027" xlink:type="simple"/><mml:math display="inline" id="M27"><mml:msubsup><mml:mrow><mml:mo>{</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>}</mml:mo></mml:mrow> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow> <mml:mi>k</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>, pointwise analysis computes the means of pointwise posterior medians,
<disp-formula id="pcbi.1004789.e028"><alternatives><graphic id="pcbi.1004789.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004789.e028" xlink:type="simple"/><mml:math display="block" id="M28"><mml:mrow><mml:mtext>mpmedian</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>r</mml:mi></mml:mfrac> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>r</mml:mi></mml:munderover> <mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>N</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>5</mml:mn></mml:mrow> <mml:mi>γ</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mo>,</mml:mo> <mml:mspace width="4.pt"/><mml:mtext>for</mml:mtext> <mml:mspace width="4.pt"/><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
pointwise mean relative errors,
<disp-formula id="pcbi.1004789.e029"><alternatives><graphic id="pcbi.1004789.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004789.e029" xlink:type="simple"/><mml:math display="block" id="M29"><mml:mrow><mml:mtext>mre</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>r</mml:mi></mml:mfrac> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>r</mml:mi></mml:munderover> <mml:mfrac><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>N</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>5</mml:mn></mml:mrow> <mml:mi>γ</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msup><mml:mi>N</mml:mi> <mml:mi mathvariant="bold-italic">γ</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msup><mml:mi>N</mml:mi> <mml:mi mathvariant="bold-italic">γ</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo> <mml:mspace width="4.pt"/><mml:mtext>for</mml:mtext> <mml:mspace width="4.pt"/><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
and a sequence of mean relative widths of the pointwise Bayesian credible intervals,
<disp-formula id="pcbi.1004789.e030"><alternatives><graphic id="pcbi.1004789.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004789.e030" xlink:type="simple"/><mml:math display="block" id="M30"><mml:mrow><mml:mtext>mrw</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>r</mml:mi></mml:mfrac> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>r</mml:mi></mml:munderover> <mml:mfrac><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>N</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>975</mml:mn></mml:mrow> <mml:mi>γ</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>N</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>025</mml:mn></mml:mrow> <mml:mi>γ</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msup><mml:mi>N</mml:mi> <mml:mi mathvariant="bold-italic">γ</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo> <mml:mspace width="4.pt"/><mml:mtext>for</mml:mtext> <mml:mspace width="4.pt"/><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
We choose grid size <italic>k</italic> = 100, number of simulation iterations <italic>r</italic> = 512, and expected number of lineages per genealogy <italic>n</italic> = 500. We choose the sampling interval [0, 48] for all simulations.</p>
<sec id="sec008">
<title>Ignoring preferential sampling</title>
<p>
<xref ref-type="table" rid="pcbi.1004789.t001">Table 1</xref> shows the averaged time interval summary statistics for simulated genealogies under uniform and proportional schedules for the time intervals (0, 6) and (6, 48). Genealogies were simulated assuming effective population size function <italic>N</italic><sub><italic>e</italic>,2,0</sub>(<italic>t</italic>) defined in <xref ref-type="disp-formula" rid="pcbi.1004789.e022">Eq 2</xref>. We show the time interval summary statistics for inferred effective population sizes both ignoring and considering preferential sampling. Ignoring preferential sampling (<xref ref-type="table" rid="pcbi.1004789.t001">Table 1</xref> under BNPR), we note a 17% increase in mean relative deviation from uniform to proportional schedules, as well as a 20% increase in mean relative width of Bayesian credible intervals for (6, 48). For (0, 6) the increase is more stark. We see a 407% increase in mean relative deviation from uniform to proportional, and a 799% increase in mean relative width of Bayesian credible intervals. Under proportional sampling, we see a notable increase in mean envelope, ME, on the (0, 6) interval. All other cases show BNPR and BNPR-PS having ME within Monte Carlo error. These results confirm that ignoring preferential sampling affects both bias and variance of Bayesian nonparametric estimators of the effective populations size.</p>
<table-wrap id="pcbi.1004789.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004789.t001</object-id>
<label>Table 1</label>
<caption>
<title>Averaged time interval summary statistics for BNPR and BNPR-PS.</title>
</caption>
<alternatives>
<graphic id="pcbi.1004789.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004789.t001" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left"/>
<th align="center" colspan="2">Uniform—(6, 48)</th>
<th align="center" colspan="2">Proportional—(6, 48)</th>
<th align="center" colspan="2">Uniform—(0, 6)</th>
<th align="center" colspan="2">Proportional—(0, 6)</th>
</tr>
<tr>
<th align="left"/>
<th align="right">BNPR</th>
<th align="right">BNPR-PS</th>
<th align="right">BNPR</th>
<th align="right">BNPR-PS</th>
<th align="right">BNPR</th>
<th align="right">BNPR-PS</th>
<th align="right">BNPR</th>
<th align="right">BNPR-PS</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">MRD</td>
<td align="char" char=".">0.205</td>
<td align="char" char=".">0.205</td>
<td align="char" char=".">0.239</td>
<td align="char" char=".">0.183</td>
<td align="char" char=".">0.430</td>
<td align="char" char=".">0.436</td>
<td align="char" char=".">2.181</td>
<td align="char" char=".">0.432</td>
</tr>
<tr>
<td align="left">MRW</td>
<td align="char" char=".">1.255</td>
<td align="char" char=".">1.255</td>
<td align="char" char=".">1.500</td>
<td align="char" char=".">1.008</td>
<td align="char" char=".">2.816</td>
<td align="char" char=".">2.816</td>
<td align="char" char=".">19.681</td>
<td align="char" char=".">1.682</td>
</tr>
<tr>
<td align="left">ME</td>
<td align="char" char=".">0.965</td>
<td align="char" char=".">0.964</td>
<td align="char" char=".">0.962</td>
<td align="char" char=".">0.957</td>
<td align="char" char=".">0.950</td>
<td align="char" char=".">0.948</td>
<td align="char" char=".">0.833</td>
<td align="char" char=".">0.898</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t001fn001">
<p>We compare the performance of the models under two different sampling distributions. Uniform distributes sampling times according to a uniform distribution on the interval (0, 48), while proportional distributes sampling times according to a inhomogeneous Poisson process with intensity proportional to effective population size <italic>N</italic><sub><italic>e</italic></sub>(<italic>t</italic>) on the same interval. We examine the statistics mean relative deviation (MRD), mean relative width of the 95% Bayesian credible interval (MRW), and mean envelope (ME). We average over statistics over the interval (6, 48) where both methods perform well and over the most recent interval (0, 6) where BNPR-PS performs considerably better.</p>
</fn>
</table-wrap-foot>
</table-wrap>
<p>
<xref ref-type="fig" rid="pcbi.1004789.g003">Fig 3</xref> (solid lines) compares the average pointwise statistics for the uniform and proportional sampling schedules. Note the marked increase in mean relative error in several locations. We also see much larger mean relative widths in the same locations. <xref ref-type="fig" rid="pcbi.1004789.g004">Fig 4</xref> compares the time interval statistics for the uniform and proportional sampling schedules, and we see increases in mean relative deviation and mean relative width. We conjecture that these features are representative of the model misspecification error that we would expect while sampling sequences/lineages preferentially in time but not accounting for it in the model.</p>
<fig id="pcbi.1004789.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004789.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Comparison of pointwise statistics.</title>
<p>Dotted black lines represent the truth, where applicable. Solid yellow lines represent the conditional method BNPR (ignoring preferential sampling), while dashed blue lines represent the sampling-aware method BNPR-PS (accounting for preferential sampling). The first row shows true and estimated effective population sizes, the second shows mean relative error, while the third shows mean relative width of the 95% Bayesian credible interval. The left two columns show the interval (6, 48) where both models perform at their best. The right two columns show (0, 6), where BNPR-PS performs significantly better. At the bottom of each plot, the distribution of sampling events (above) and coalescent events (below) are shown as heat maps. Time is in months.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004789.g003" xlink:type="simple"/>
</fig>
<fig id="pcbi.1004789.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004789.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Comparison of time interval statistics.</title>
<p>Within each plot, we apply BNPR and BNPR-PS to sampling times generated according to a Uniform distribution on the left and proportionally to effective population size on the right. In the left column of plots, we examine the interval (6, 48) where the performances of both models are comparable. In the right column, we show (0, 6), and note that BNPR-PS performs well, while BNPR performs considerably worse.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004789.g004" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec009">
<title>Accounting for preferential sampling</title>
<p>
<xref ref-type="table" rid="pcbi.1004789.t001">Table 1</xref> under BNPR-PS shows the time interval statistics for the sampling-aware model. For interval (6, 48), mean relative deviation decreases by 23% versus BNPR under proportional sampling, while mean relative width of Bayesian credible intervals decreases by a larger margin of 33%. For interval (0, 6) mean relative deviation and mean relative width decrease by 80% and 91%, respectively. Under uniform sampling, BNPR-PS performs almost identically to BNPR for both intervals.</p>
<p>
<xref ref-type="fig" rid="pcbi.1004789.g003">Fig 3</xref> (dashed lines) compares the average pointwise statistics for the uniform and proportional sampling schedules under BNPR-PS. We see that BNPR-PS does not experience the increase in relative error that BNPR experiences under preferential sampling. The plots also show an improvement in mean relative width of Bayesian credible intervals under preferential sampling due to the additional information available. <xref ref-type="fig" rid="pcbi.1004789.g004">Fig 4</xref> compares the time interval statistics for the uniform and proportional sampling schedules under BNPR-PS, and shows improvements in mean relative deviation and mean relative width.</p>
</sec>
<sec id="sec010">
<title>Negative control simulations</title>
<p>In the previous sections, we find a pattern of increased mean relative deviation and mean relative width while using a conditional model in a scenario involving preferential sampling. However, it is possible that this behavior of the conditional, state-of-the-art coalescent model can be seen under other simulation scenarios that cluster sampling times, even when such clustering has no relationship to the effective population size fluctuations. To test this assertion, we design a pair of negative control simulation studies to have random clusters of sampling times, but no preferential sampling.</p>
<p>First, we apply BNPR to genealogies generated from randomly constructed piecewise constant sampling intensity functions, independent of effective population size; see Appendix. We see some examples of increased mean relative error, but nothing as consistent nor prevalent as in the preferential sampling case above (see Figs <xref ref-type="fig" rid="pcbi.1004789.g002">2</xref> and <xref ref-type="fig" rid="pcbi.1004789.g003">3</xref>). Similarly, we see increased mean relative width in several locations, but decreased widths in others. Second, we apply BNPR to genealogies generated from Gaussian process evaluations (subsampled for relatively similar shapes and number of peaks and troughs to the true population trajectory); see Appendix. This model has shape characteristics closer to the population trajectory since we are sampling from a Gaussian process. Despite the similar shapes, we see fewer increases in mean relative width and smaller increases in mean relative width. We conclude that unaccounted preferential sampling produces markedly more error more consistently than the negative control cases.</p>
<p>We also apply BNPR-PS to the same scenarios as above. BNPR-PS’s performance suffers significantly due to both scenarios violating its fundamental assumption of a fixed relationship between effective population size and sampling intensity. We see BNPR-PS performs worst locally when there is a nearly fixed relationship which is suddenly reversed in a small time interval.</p>
</sec>
<sec id="sec011">
<title>Parametric simulations</title>
<p>Finally, we also explored model misspecification in a correctly-specified parametric context. We simulated 100,000 genealogies from the coalescent with an exponential effective population size trajectory <italic>N</italic><sub><italic>e</italic></sub>(<italic>t</italic>) = exp(<italic>a</italic>+<italic>bt</italic>), under uniform and proportional sampling schedules. We applied an exponential growth/decline parametric maximum likelihood method and summarized the results in the Appendix. In both uniform and preferential sampling we see small, but comparable biases in estimates of parameter <italic>a</italic>. However, estimates of the exponential growth rate parameter <italic>b</italic> have no detectable bias under uniform sampling, but have small but significant bias under preferential sampling. This verifies that ignoring preferential sampling causes systematic bias, perhaps of small magnitude, in maximum likelihood phylodynamic estimation even under a simple low-dimensional parametric model.</p>
</sec>
</sec>
<sec id="sec012">
<title>Case studies</title>
<sec id="sec013">
<title>New York influenza</title>
<p>We base our first case study on a subset of the data from [<xref ref-type="bibr" rid="pcbi.1004789.ref019">19</xref>], also analyzed by Palacios and Minin [<xref ref-type="bibr" rid="pcbi.1004789.ref005">5</xref>]. We focus on the 709 hemagglutinin gene sequences of H3N2 human influenza type A obtained from the National Center for Biotechnology Information (NCBI) Influenza Virus Sequence Database for years 1992 through 2005 from New York State. We align the sequences using the software MUSCLE [<xref ref-type="bibr" rid="pcbi.1004789.ref023">23</xref>], and infer a maximum clade credibility genealogy using the software BEAST [<xref ref-type="bibr" rid="pcbi.1004789.ref024">24</xref>]. We infer the genealogy branch lengths in units of years using a strict molecular clock, a constant effective population size prior, and an HKY substitution model with the first two nucleotides of a codon sharing the same estimated transition matrix, while the third nucleotide’s transition matrix is estimated separately. We then apply our two algorithms to the estimated genealogy.</p>
<p>We find that BNPR produces results in line with previous analyses of this dataset, showing a characteristic uncertainty around the flu seasons of 2000–2001 and 2002–2003 (see <xref ref-type="fig" rid="pcbi.1004789.g005">Fig 5</xref>). In contrast, BNPR-PS shows a marked improvement in the regularity of the reconstructed flu seasons, as well as thinner Bayesian credible intervals across the the whole observation interval. Estimations also improved during the unusual flu seasons of 2000–2001 and 2002–2003, consistent with these seasons being H1N1 dominant seasons instead of H3N2 dominant [<xref ref-type="bibr" rid="pcbi.1004789.ref025">25</xref>].</p>
<fig id="pcbi.1004789.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004789.g005</object-id>
<label>Fig 5</label>
<caption>
<title>BNPR and BNPR-PS models applied to the genealogy inferred from the New York influenza data [<xref ref-type="bibr" rid="pcbi.1004789.ref019">19</xref>].</title>
<p>Years mark January of the corresponding year. Note the correlation of higher effective population size <italic>N</italic><sup><bold><italic>γ</italic></bold></sup>(<italic>t</italic>) with more intense sampling frequencies (darker regions in the Sampling events heatmap), suggesting preferential sampling. We see a marked improvement in discerning the seasonal influenza patterns and significantly thinner credible regions under BNPR-PS.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004789.g005" xlink:type="simple"/>
</fig>
<p>To compare performance of the BNPR and BNPR-PS models, we introduce an empirical measure of performance because we cannot know the true population size trajectory. We calculate the time interval and pointwise <italic>empirical mean relative width</italic> (EMRW) of the 95% Bayesian credible intervals,
<disp-formula id="pcbi.1004789.e031"><alternatives><graphic id="pcbi.1004789.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004789.e031" xlink:type="simple"/><mml:math display="block" id="M31"><mml:mrow><mml:mtext>EMRW</mml:mtext> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>r</mml:mi></mml:mfrac> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>r</mml:mi></mml:munderover> <mml:mfenced close="]" open="[" separators=""><mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mi>b</mml:mi> <mml:mo>-</mml:mo> <mml:mi>a</mml:mi></mml:mrow></mml:mfrac> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:msubsup> <mml:mfrac><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>N</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>975</mml:mn></mml:mrow> <mml:mi>γ</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>N</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>025</mml:mn></mml:mrow> <mml:mi>γ</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>N</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi> <mml:mi>γ</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mfenced> <mml:mo>,</mml:mo> <mml:mspace width="4.pt"/><mml:mtext>for</mml:mtext> <mml:mspace width="4.pt"/><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
and
<disp-formula id="pcbi.1004789.e032"><alternatives><graphic id="pcbi.1004789.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004789.e032" xlink:type="simple"/><mml:math display="block" id="M32"><mml:mrow><mml:mi>e</mml:mi> <mml:mi>m</mml:mi> <mml:mi>r</mml:mi> <mml:mi>w</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>r</mml:mi></mml:mfrac> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>r</mml:mi></mml:munderover> <mml:mfrac><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>N</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>975</mml:mn></mml:mrow> <mml:mi>γ</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>N</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>025</mml:mn></mml:mrow> <mml:mi>γ</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>N</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi> <mml:mi>γ</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo> <mml:mspace width="4.pt"/><mml:mtext>for</mml:mtext> <mml:mspace width="4.pt"/><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives></disp-formula> <xref ref-type="table" rid="pcbi.1004789.t002">Table 2</xref> shows a very high value of <italic>β</italic><sub>1</sub> for this dataset, suggesting a strong pattern of preferential sampling, and accordingly we see a marked improvement of BNPR-PS model over its BNPR counterpart in estimation precision as measured by the Bayesian credible interval widths (EMRW).</p>
<table-wrap id="pcbi.1004789.t002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004789.t002</object-id>
<label>Table 2</label>
<caption>
<title>Case studies’ empirical mean relative widths and Bayesian credible intervals of <italic>β</italic><sub>0</sub> and <italic>β</italic><sub>1</sub>.</title>
</caption>
<alternatives>
<graphic id="pcbi.1004789.t002g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004789.t002" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left"/>
<th align="center"/>
<th align="center" colspan="2">EMRW</th>
<th align="center" rowspan="2">95% credible interval of <italic>β</italic><sub>0</sub></th>
<th align="center" rowspan="2">95% credible interval of <italic>β</italic><sub>1</sub></th>
</tr>
<tr>
<th align="left"/>
<th align="center"><italic>n</italic></th>
<th align="center">BNPR</th>
<th align="center">BNPR-PS</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><bold>New York influenza</bold></td>
<td align="center">709</td>
<td align="char" char=".">1.23</td>
<td align="char" char=".">0.58</td>
<td align="right">(-47.4, -30.3)</td>
<td align="right">(5.88, 10.23)</td>
</tr>
<tr>
<td align="left"><bold>Regional influenza</bold></td>
<td align="center"/>
<td align="center"/>
<td align="center"/>
<td align="right"/>
<td align="right"/>
</tr>
<tr>
<td align="left">USA &amp; Canada</td>
<td align="center">520</td>
<td align="char" char=".">1.83</td>
<td align="char" char=".">1.11</td>
<td align="right">(-3.02, -0.79)</td>
<td align="right">(2.52, 4.05)</td>
</tr>
<tr>
<td align="left">South America</td>
<td align="center">191</td>
<td align="char" char=".">0.86</td>
<td align="char" char=".">0.91</td>
<td align="right">(-4.21, -0.42)</td>
<td align="right">(3.27, 7.52)</td>
</tr>
<tr>
<td align="left">Europe</td>
<td align="center">361</td>
<td align="char" char=".">1.73</td>
<td align="char" char=".">0.96</td>
<td align="right">(-6.61, -2.44)</td>
<td align="right">(3.68, 6.88)</td>
</tr>
<tr>
<td align="left">India</td>
<td align="center">233</td>
<td align="char" char=".">1.79</td>
<td align="char" char=".">1.30</td>
<td align="right">(-2.18, 0.50)</td>
<td align="right">(2.34, 4.78)</td>
</tr>
<tr>
<td align="left">Japan &amp; Korea</td>
<td align="center">444</td>
<td align="char" char=".">1.82</td>
<td align="char" char=".">1.09</td>
<td align="right">(-2.23, -0.25)</td>
<td align="right">(2.35, 3.76)</td>
</tr>
<tr>
<td align="left">North China</td>
<td align="center">384</td>
<td align="char" char=".">1.80</td>
<td align="char" char=".">1.09</td>
<td align="right">(-2.63, -0.27)</td>
<td align="right">(2.22, 3.89)</td>
</tr>
<tr>
<td align="left">South China</td>
<td align="center">528</td>
<td align="char" char=".">1.27</td>
<td align="char" char=".">0.78</td>
<td align="right">(-1.05, 1.00)</td>
<td align="right">(1.68, 3.23)</td>
</tr>
<tr>
<td align="left">Southeast Asia</td>
<td align="center">494</td>
<td align="char" char=".">0.99</td>
<td align="char" char=".">0.54</td>
<td align="right">(-7.93, -2.55)</td>
<td align="right">(4.39, 8.86)</td>
</tr>
<tr>
<td align="left">Oceania</td>
<td align="center">461</td>
<td align="char" char=".">1.53</td>
<td align="char" char=".">0.88</td>
<td align="right">(-1.51, 0.43)</td>
<td align="right">(2.71, 4.52)</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t002fn001">
<p>The regional influenza dataset is broken down into world regions. In all but one region, we see improvements, or at worst near-equality, in empirical mean relative width (EMRW) using BNPR-PS over BNPR.</p>
</fn>
</table-wrap-foot>
</table-wrap>
</sec>
<sec id="sec014">
<title>Regional influenza</title>
<p>Zinder et al. examine world-wide seasonal patterns of migration of H3N2 influenza across the regions of the world [<xref ref-type="bibr" rid="pcbi.1004789.ref020">20</xref>]. They also examine different seasonal incidence patterns, with tropical regions having a relatively flat incident rate throughout the year, while temperate regions show larger seasonal variation with higher incidence in winter months. In order to explore the effects of seasonality on preferential sampling, we examine the regions separately. We align the sequences using the software MUSCLE [<xref ref-type="bibr" rid="pcbi.1004789.ref023">23</xref>], and infer a maximum clade credibility genealogy using the software BEAST [<xref ref-type="bibr" rid="pcbi.1004789.ref024">24</xref>]. We infer the genealogy branch lengths in units of years using a strict molecular clock, a constant effective population size prior, and an HKY substitution model with the first two nucleotides of a codon sharing the same estimated transition matrix, while the third nucleotide’s transition matrix is estimated separately. We then apply our two algorithms to the estimated genealogy.</p>
<p>We find that none of the regions contain 0 in their <italic>β</italic><sub>1</sub> Bayesian credible interval (see <xref ref-type="table" rid="pcbi.1004789.t002">Table 2</xref>), suggesting a relationship between effective population size and sampling frequency. Across all regions except South America, we see improvements of the BNPR-PS model over the BNPR model in estimation precision (EMRW). We examine three of the regions more closely in Figs <xref ref-type="fig" rid="pcbi.1004789.g006">6</xref> and <xref ref-type="fig" rid="pcbi.1004789.g007">7</xref> and the remaining six regions in the appendix. We see noticeable improvements in the relative widths of the Bayesian credible intervals. We also see more pronounced seasonality in the estimated effective population size trajectories produced by BNPR-PS. The USA/Canada region shows the expected seasonal peak in January-February, while the Oceania region shows the same in July-September. South China shows less seasonality overall, but BNPR-PS shows a more pronounced August peak despite the region being in the northern hemisphere. This is, however, in line with previous findings, most likely due to southern China’s more tropical climate [<xref ref-type="bibr" rid="pcbi.1004789.ref026">26</xref>].</p>
<fig id="pcbi.1004789.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004789.g006</object-id>
<label>Fig 6</label>
<caption>
<title>BNPR and BNPR-PS models applied to the genealogies inferred from the regional influenza example [<xref ref-type="bibr" rid="pcbi.1004789.ref020">20</xref>].</title>
<p>We see moderate correlation between effective population size <italic>N</italic><sup><bold><italic>γ</italic></bold></sup>(<italic>t</italic>) and sampling frequencies in the data (<xref ref-type="table" rid="pcbi.1004789.t002">Table 2</xref>). We see improvements in Bayesian credible interval widths, and BNPR-PS performs as well or better than BNPR everywhere in these examples.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004789.g006" xlink:type="simple"/>
</fig>
<fig id="pcbi.1004789.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004789.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Seasonality in regional influenza.</title>
<p>BNPR and BNPR-PS models applied to the genealogies inferred from the regional influenza example with years overlaid. We see more pronounced seasonality in the BNPR-PS plots.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004789.g007" xlink:type="simple"/>
</fig>
</sec>
</sec>
</sec>
<sec id="sec015" sec-type="conclusions">
<title>Discussion</title>
<p>Researchers who study measurably evolving populations [<xref ref-type="bibr" rid="pcbi.1004789.ref027">27</xref>], such as viruses, can inadvertently or purposefully preferentially select sequences in accordance to the changes in size of the population of interest. Failing to account for such an ascertainment bias can compromise the statistical properties of phylodynamic inference. Our simulation study shows that the effect of preferential sampling is particularly severe when the effective population size is decreasing. We propose an extension to the state-of-the-art in Gaussian process-based Bayesian phylodynamic methods, in which we assume that sampling times <italic>a priori</italic> follow an inhomogeneous Poisson process with intensity proportional to a power of the effective population size. This model extension eliminates the systematic estimation bias resulting from having unrecognized preferential sampling, and also gives us better population size estimates by incorporating sampling times as an additional source of information.</p>
<p>Applied to the real-world examples, our method produces improvements over the state-of-the-art. We see significantly improved precision, as well as more realistic estimation of seasonal variation of influenza diversity. In the presence of weaker preferential sampling, as in some of the regional influenza examples, we note that our method still performs better than the current state-of-the-art, with no loss of performance aside from a slightly longer computation time. In addition, by estimating <italic>β</italic><sub>1</sub>, the effect of population size on the log-intensity of sampling times, we gain the ability to quantify the strength of the preferential sampling relationship in the different regions. Such quantification is scientifically useful in infectious disease phylodynamics, because researchers may want to know whether frequency of sampling times can be used as a proxy for incidence.</p>
<p>One avenue of future exploration is to intentionally guarantee preferential sampling during the sequence data collection phase. For example, if an epidemiological study contains noisy incidence data, we can subsample sequences with intensity proportional to incidence and apply our sampling-aware BNPR-PS model to the resulting sequence data. Such a procedure will indirectly combine sequence and incidence data to estimate the effective number of infections —a nontrivial task for the current methods [<xref ref-type="bibr" rid="pcbi.1004789.ref028">28</xref>]. We contrast this to the approach of [<xref ref-type="bibr" rid="pcbi.1004789.ref029">29</xref>], which examined the effect of sampling infectious disease agent sequences in batches at different points in an epidemic’s life-cycle compared to uniform and preferential sampling. They found that during epidemic declines their estimates had the largest mean squared error and benefited most in terms of this metric when samples were collected more frequently during the declines. This is consistent with our results, as we see the most error and widest credible intervals during effective population size declines. However, they did not consider the effect of the relationship between their proposed sampling intensity and population size trajectories on estimation of population dynamics—the primary goal of our work.</p>
<p>Our current implementation of the BNPR-PS model assumes a fixed, known genealogy. However, in practice, genealogies are inferred with inherent uncertainty from sequence data. We have found that point estimates produced by our method on the Regional influenza data are robust to genealogical uncertainty (see Regional influenza section in the Appendix), but a method that jointly estimates both genealogy and effective population is still necessary to properly assign uncertainty to population size estimates. One limitation of our method is that the INLA framework cannot be extended to include inference of genealogies. However, it should be straightforward to incorporate the core of our approach —the sampling times model— into an MCMC sampler that targets the joint posterior distribution of population size trajectory, genealogy of sampled sequences, and other parameters. We intend to implement such an MCMC approach in the software BEAST [<xref ref-type="bibr" rid="pcbi.1004789.ref024">24</xref>].</p>
<p>The main goal of this manuscript is to point out the danger of ignoring preferential sampling in phylodynamics. Providing a solution to this problem, in the form of BNPR-PS model, remains our secondary goal, but we emphasize that much work is still needed to refine our proposed approach. The main weakness of our new model lies in its rigid parametric form of dependence between effective population size <italic>N</italic><sub><italic>e</italic></sub>(<italic>t</italic>) and sequence sampling intensity <italic>λ</italic>(<italic>t</italic>). In our negative control simulations we see that BNPR-PS performance suffers, possibly greatly, when this assumption of a fixed relationship between effective population size <italic>N</italic><sub><italic>e</italic></sub>(<italic>t</italic>) and sampling intensity <italic>λ</italic>(<italic>t</italic>) is violated. Similar results under model misspecification are observed by Volz and Frost in the context of birth-death-sampling models for phylodynamic inference [<xref ref-type="bibr" rid="pcbi.1004789.ref016">16</xref>, <xref ref-type="bibr" rid="pcbi.1004789.ref030">30</xref>].</p>
<p>Sampling times model misspecification is most likely to occur if other variables besides effective population size <italic>N</italic><sub><italic>e</italic></sub>(<italic>t</italic>) effect changes in the sampling intensity <italic>λ</italic>(<italic>t</italic>). For instance, not accounting for a lag between <italic>N</italic><sub><italic>e</italic></sub>(<italic>t</italic>) and <italic>λ</italic>(<italic>t</italic>) may cause a severe model misspecification. Similarly, not accounting for increases in sampling intensity on longer time scales due to decreases in the cost of sequencing will bias our BNPR-PS estimation. We plan to address these issues by modeling our sampling intensity <italic>λ</italic>(<italic>t</italic>) as a log-linear combination of effective sample size and other covariates:
<disp-formula id="pcbi.1004789.e033"><alternatives><graphic id="pcbi.1004789.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004789.e033" xlink:type="simple"/><mml:math display="block" id="M33"><mml:mrow><mml:mo form="prefix">log</mml:mo> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>λ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msup><mml:mrow><mml:mi>β</mml:mi></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:mi mathvariant="bold">c</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
where <bold>c</bold>(<italic>t</italic>)<sup><italic>T</italic></sup> = (1, <italic>N</italic><sub><italic>e</italic></sub>(<italic>t</italic>), <italic> c</italic><sub>1</sub>(<italic>t</italic>), …, <italic>c</italic><sub><italic>p</italic></sub>(<italic>t</italic>)) and <italic>c</italic><sub><italic>i</italic></sub>(<italic>t</italic>), <italic>i</italic> = 1, …, <italic>p</italic> are covariates of interest. For example, the cost of genome sequencing over time and lagged population size <italic>N</italic><sub><italic>e</italic></sub>(<italic>t</italic>−<italic>l</italic>) are among prime candidates for covariates to be included into our BNPR-PS model. Another example of a promising time-varying sampling covariate is an indicator of ‘outbreak’ status, allowing for changes in sampling intensity during times of increased epidemiological oversight. We hope to explore these model extensions in our future research.</p>
</sec>
<sec id="sec016">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1004789.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004789.s001" xlink:type="simple">
<label>S1 Appendix</label>
<caption>
<title>Additional materials.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="pcbi.1004789.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Grenfell</surname> <given-names>BT</given-names></name>, <name name-style="western"><surname>Pybus</surname> <given-names>OG</given-names></name>, <name name-style="western"><surname>Gog</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>Wood</surname> <given-names>JLN</given-names></name>, <name name-style="western"><surname>Daly</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Mumford</surname> <given-names>JA</given-names></name>, <etal>et al</etal>. <article-title>Unifying the epidemiological and evolutionary dynamics of pathogens</article-title>. <source>Science</source>. <year>2004</year>;<volume>303</volume>(<issue>5656</issue>):<fpage>327</fpage>–<lpage>332</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1090727" xlink:type="simple">10.1126/science.1090727</ext-link></comment> <object-id pub-id-type="pmid">14726583</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004789.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Holmes</surname> <given-names>EC</given-names></name>, <name name-style="western"><surname>Grenfell</surname> <given-names>BT</given-names></name>. <article-title>Discovering the phylodynamics of RNA viruses</article-title>. <source>PLoS Computational Biology</source>. <year>2009</year>;<volume>5</volume>(<issue>10</issue>):<fpage>e1000505</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1000505" xlink:type="simple">10.1371/journal.pcbi.1000505</ext-link></comment> <object-id pub-id-type="pmid">19855824</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004789.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Minin</surname> <given-names>VN</given-names></name>, <name name-style="western"><surname>Bloomquist</surname> <given-names>EW</given-names></name>, <name name-style="western"><surname>Suchard</surname> <given-names>MA</given-names></name>. <article-title>Smooth skyride through a rough skyline: Bayesian coalescent-based inference of population dynamics</article-title>. <source>Molecular Biology and Evolution</source>. <year>2008</year>;<volume>25</volume>(<issue>7</issue>):<fpage>1459</fpage>–<lpage>1471</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/molbev/msn090" xlink:type="simple">10.1093/molbev/msn090</ext-link></comment> <object-id pub-id-type="pmid">18408232</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004789.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gill</surname> <given-names>MS</given-names></name>, <name name-style="western"><surname>Lemey</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Faria</surname> <given-names>NR</given-names></name>, <name name-style="western"><surname>Rambaut</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Shapiro</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Suchard</surname> <given-names>MA</given-names></name>. <article-title>Improving Bayesian population dynamics inference: a coalescent-based model for multiple loci</article-title>. <source>Molecular Biology and Evolution</source>. <year>2013</year>;<volume>30</volume>(<issue>3</issue>):<fpage>713</fpage>–<lpage>724</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/molbev/mss265" xlink:type="simple">10.1093/molbev/mss265</ext-link></comment> <object-id pub-id-type="pmid">23180580</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004789.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Palacios</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Minin</surname> <given-names>VN</given-names></name>. <article-title>Gaussian Process-Based Bayesian Nonparametric Inference of Population Size Trajectories from Gene Genealogies</article-title>. <source>Biometrics</source>. <year>2013</year>;<volume>69</volume>(<issue>1</issue>):<fpage>8</fpage>–<lpage>18</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/biom.12003" xlink:type="simple">10.1111/biom.12003</ext-link></comment> <object-id pub-id-type="pmid">23409705</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004789.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kingman</surname> <given-names>JFC</given-names></name>. <article-title>The coalescent</article-title>. <source>Stochastic processes and their applications</source>. <year>1982</year>;<volume>13</volume>(<issue>3</issue>):<fpage>235</fpage>–<lpage>248</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/0304-4149(82)90011-4" xlink:type="simple">10.1016/0304-4149(82)90011-4</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004789.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wakeley</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Sargsyan</surname> <given-names>O</given-names></name>. <article-title>Extensions of the coalescent effective population size</article-title>. <source>Genetics</source>. <year>2009</year>;<volume>181</volume>(<issue>1</issue>):<fpage>341</fpage>–<lpage>345</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1534/genetics.108.092460" xlink:type="simple">10.1534/genetics.108.092460</ext-link></comment> <object-id pub-id-type="pmid">19001293</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004789.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Griffiths</surname> <given-names>RC</given-names></name>, <name name-style="western"><surname>Tavaré</surname> <given-names>S</given-names></name>. <article-title>Sampling theory for neutral alleles in a varying environment</article-title>. <source>Philosophical Transactions of the Royal Society of London Series B: Biological Sciences</source>. <year>1994</year>;<volume>344</volume>(<issue>1310</issue>):<fpage>403</fpage>–<lpage>410</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rstb.1994.0079" xlink:type="simple">10.1098/rstb.1994.0079</ext-link></comment> <object-id pub-id-type="pmid">7800710</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004789.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Drummond</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Nicholls</surname> <given-names>GK</given-names></name>, <name name-style="western"><surname>Rodrigo</surname> <given-names>AG</given-names></name>, <name name-style="western"><surname>Solomon</surname> <given-names>W</given-names></name>. <article-title>Estimating mutation parameters, population history and genealogy simultaneously from temporally spaced sequence data</article-title>. <source>Genetics</source>. <year>2002</year>;<volume>161</volume>(<issue>3</issue>):<fpage>1307</fpage>–<lpage>1320</lpage>. <object-id pub-id-type="pmid">12136032</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004789.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kuhner</surname> <given-names>MK</given-names></name>, <name name-style="western"><surname>Yamato</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Felsenstein</surname> <given-names>J</given-names></name>. <article-title>Maximum likelihood estimation of population growth rates based on the coalescent</article-title>. <source>Genetics</source>. <year>1998</year>;<volume>149</volume>(<issue>1</issue>):<fpage>429</fpage>–<lpage>434</lpage>. <object-id pub-id-type="pmid">9584114</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004789.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pybus</surname> <given-names>OG</given-names></name>, <name name-style="western"><surname>Rambaut</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Harvey</surname> <given-names>PH</given-names></name>. <article-title>An integrated framework for the inference of viral population history from reconstructed genealogies</article-title>. <source>Genetics</source>. <year>2000</year>;<volume>155</volume>(<issue>3</issue>):<fpage>1429</fpage>–<lpage>1437</lpage>. <object-id pub-id-type="pmid">10880500</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004789.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Drummond</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Rambaut</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Shapiro</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Pybus</surname> <given-names>OG</given-names></name>. <article-title>Bayesian coalescent inference of past population dynamics from molecular sequences</article-title>. <source>Molecular Biology and Evolution</source>. <year>2005</year>;<volume>22</volume>(<issue>5</issue>):<fpage>1185</fpage>–<lpage>1192</lpage>. <object-id pub-id-type="pmid">15703244</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004789.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ho</surname> <given-names>SYW</given-names></name>, <name name-style="western"><surname>Shapiro</surname> <given-names>B</given-names></name>. <article-title>Skyline-plot methods for estimating demographic history from nucleotide sequences</article-title>. <source>Molecular Ecology Resources</source>. <year>2011</year>;<volume>11</volume>(<issue>3</issue>):<fpage>423</fpage>–<lpage>434</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/j.1755-0998.2011.02988.x" xlink:type="simple">10.1111/j.1755-0998.2011.02988.x</ext-link></comment> <object-id pub-id-type="pmid">21481200</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004789.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Frost</surname> <given-names>SDW</given-names></name>, <name name-style="western"><surname>Volz</surname> <given-names>EM</given-names></name>. <article-title>Viral phylodynamics and the search for an ‘effective number of infections’</article-title>. <source>Philosophical Transactions of the Royal Society B: Biological Sciences</source>. <year>2010</year>;<volume>365</volume>(<issue>1548</issue>):<fpage>1879</fpage>–<lpage>1890</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rstb.2010.0060" xlink:type="simple">10.1098/rstb.2010.0060</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004789.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Diggle</surname> <given-names>PJ</given-names></name>, <name name-style="western"><surname>Menezes</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Su</surname> <given-names>T</given-names></name>. <article-title>Geostatistical inference under preferential sampling</article-title>. <source>Journal of the Royal Statistical Society: Series C (Applied Statistics)</source>. <year>2010</year>;<volume>59</volume>(<issue>2</issue>):<fpage>191</fpage>–<lpage>232</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/j.1467-9876.2009.00701.x" xlink:type="simple">10.1111/j.1467-9876.2009.00701.x</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004789.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Volz</surname> <given-names>EM</given-names></name>, <name name-style="western"><surname>Frost</surname> <given-names>SDW</given-names></name>. <article-title>Sampling through time and phylodynamic inference with coalescent and birth–death models</article-title>. <source>Journal of The Royal Society Interface</source>. <year>2014</year>;<volume>11</volume>(<issue>101</issue>):<fpage>20140945</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rsif.2014.0945" xlink:type="simple">10.1098/rsif.2014.0945</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004789.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rue</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Martino</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Chopin</surname> <given-names>N</given-names></name>. <article-title>Approximate Bayesian inference for latent Gaussian models by using integrated nested Laplace approximations</article-title>. <source>Journal of the Royal Statistical Society: Series B</source>. <year>2009</year>;<volume>71</volume>(<issue>2</issue>):<fpage>319</fpage>–<lpage>392</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/j.1467-9868.2008.00700.x" xlink:type="simple">10.1111/j.1467-9868.2008.00700.x</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004789.ref018">
<label>18</label>
<mixed-citation publication-type="other" xlink:type="simple">Palacios JA, Minin VN. Integrated Nested Laplace Approximation for Bayesian Nonparametric Phylodynamics. In: Proceedings of the Twenty-Eighth International Conference on Uncertainty in Artificial Intelligence; 2012. p. 726–735.</mixed-citation>
</ref>
<ref id="pcbi.1004789.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rambaut</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Pybus</surname> <given-names>OG</given-names></name>, <name name-style="western"><surname>Nelson</surname> <given-names>MI</given-names></name>, <name name-style="western"><surname>Viboud</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Taubenberger</surname> <given-names>JK</given-names></name>, <name name-style="western"><surname>Holmes</surname> <given-names>EC</given-names></name>. <article-title>The genomic and epidemiological dynamics of human influenza A virus</article-title>. <source>Nature</source>. <year>2008</year>;<volume>453</volume>(<issue>7195</issue>):<fpage>615</fpage>–<lpage>619</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature06945" xlink:type="simple">10.1038/nature06945</ext-link></comment> <object-id pub-id-type="pmid">18418375</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004789.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zinder</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Bedford</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Baskerville</surname> <given-names>EB</given-names></name>, <name name-style="western"><surname>Woods</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Roy</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Pascual</surname> <given-names>M</given-names></name>. <article-title>Seasonality in the migration and establishment of H3N2 Influenza lineages with epidemic growth and decline</article-title>. <source>BMC Evolutionary Biology</source>. <year>2014</year>;<volume>14</volume>(<issue>1</issue>):<fpage>272</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/s12862-014-0272-2" xlink:type="simple">10.1186/s12862-014-0272-2</ext-link></comment> <object-id pub-id-type="pmid">25539729</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004789.ref021">
<label>21</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Felsenstein</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Rodrigo</surname> <given-names>AG</given-names></name>. <chapter-title>Coalescent Approaches to HIV Population Genetics</chapter-title>. In: <source>The Evolution of HIV</source>. <publisher-name>Johns Hopkins University Press</publisher-name>; <year>1999</year>. p. <fpage>233</fpage>–<lpage>272</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004789.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Martins</surname> <given-names>TG</given-names></name>, <name name-style="western"><surname>Simpson</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Lindgren</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Rue</surname> <given-names>H</given-names></name>. <article-title>Bayesian computing with INLA: new features</article-title>. <source>Computational Statistics &amp; Data Analysis</source>. <year>2013</year>;<volume>67</volume>:<fpage>68</fpage>–<lpage>83</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.csda.2013.04.014" xlink:type="simple">10.1016/j.csda.2013.04.014</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004789.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Edgar</surname> <given-names>RC</given-names></name>. <article-title>MUSCLE: Multiple sequence alignment with high accuracy and high throughput</article-title>. <source>Nucleic Acids Research</source>. <year>2004</year>;<volume>32</volume>:<fpage>1792</fpage>–<lpage>1797</lpage>. <object-id pub-id-type="pmid">15034147</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004789.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Drummond</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Suchard</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Xie</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Rambaut</surname> <given-names>A</given-names></name>. <article-title>Bayesian phylogenetics with BEAUti and the BEAST 1.7</article-title>. <source>Molecular Biology and Evolution</source>. <year>2012</year>;<volume>29</volume>:<fpage>1969</fpage>–<lpage>1973</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/molbev/mss075" xlink:type="simple">10.1093/molbev/mss075</ext-link></comment> <object-id pub-id-type="pmid">22367748</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004789.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Goldstein</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Cobey</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Takahashi</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Miller</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Lipsitch</surname> <given-names>M</given-names></name>. <article-title>Predicting the epidemic sizes of influenza A/H1N1, A/H3N2, and B: a statistical method</article-title>. <source>PLoS medicine</source>. <year>2011</year>;<volume>8</volume>(<issue>7</issue>):<fpage>952</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pmed.1001051" xlink:type="simple">10.1371/journal.pmed.1001051</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004789.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Shu</surname> <given-names>YL</given-names></name>, <name name-style="western"><surname>Fang</surname> <given-names>LQ</given-names></name>, <name name-style="western"><surname>de Vlas</surname> <given-names>SJ</given-names></name>, <name name-style="western"><surname>Gao</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Richardus</surname> <given-names>JH</given-names></name>, <name name-style="western"><surname>Cao</surname> <given-names>WC</given-names></name>. <article-title>Dual seasonal patterns for influenza, China</article-title>. <source>Emerging Infectious Diseases</source>. <year>2010</year>;<volume>16</volume>(<issue>4</issue>):<fpage>725</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.3201/eid1604.091578" xlink:type="simple">10.3201/eid1604.091578</ext-link></comment> <object-id pub-id-type="pmid">20350403</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004789.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Drummond</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Pybus</surname> <given-names>OG</given-names></name>, <name name-style="western"><surname>Rambaut</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Forsberg</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Rodrigo</surname> <given-names>AG</given-names></name>. <article-title>Measurably evolving populations</article-title>. <source>Trends in Ecology &amp; Evolution</source>. <year>2003</year>;<volume>18</volume>(<issue>9</issue>):<fpage>481</fpage>–<lpage>488</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0169-5347(03)00216-7" xlink:type="simple">10.1016/S0169-5347(03)00216-7</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004789.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rasmussen</surname> <given-names>DA</given-names></name>, <name name-style="western"><surname>Ratmann</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Koelle</surname> <given-names>K</given-names></name>. <article-title>Inference for nonlinear epidemiological models using genealogies and time series</article-title>. <source>PLoS Computational Biology</source>. <year>2011</year>;<volume>7</volume>:<fpage>e1002136</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1002136" xlink:type="simple">10.1371/journal.pcbi.1002136</ext-link></comment> <object-id pub-id-type="pmid">21901082</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004789.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Stack</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Welch</surname> <given-names>JD</given-names></name>, <name name-style="western"><surname>Ferrari</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Shapiro</surname> <given-names>BU</given-names></name>, <name name-style="western"><surname>Grenfell</surname> <given-names>BT</given-names></name>. <article-title>Protocols for sampling viral sequences to study epidemic dynamics</article-title>. <source>Journal of The Royal Society Interface</source>. <year>2010</year>;<volume>7</volume>(<issue>48</issue>):<fpage>1119</fpage>–<lpage>1127</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rsif.2009.0530" xlink:type="simple">10.1098/rsif.2009.0530</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004789.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Stadler</surname> <given-names>T</given-names></name>. <article-title>Sampling-through-time in birth–death trees</article-title>. <source>Journal of Theoretical Biology</source>. <year>2010</year>;<volume>267</volume>(<issue>3</issue>):<fpage>396</fpage>–<lpage>404</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jtbi.2010.09.010" xlink:type="simple">10.1016/j.jtbi.2010.09.010</ext-link></comment> <object-id pub-id-type="pmid">20851708</object-id></mixed-citation>
</ref>
</ref-list>
</back>
</article>