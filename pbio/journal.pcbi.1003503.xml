<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id><journal-title-group>
<journal-title>PLoS Computational Biology</journal-title></journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-13-01888</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1003503</article-id>
<article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Genome analysis</subject></subj-group></subj-group><subj-group><subject>Genetics</subject><subj-group><subject>Genomics</subject></subj-group></subj-group><subj-group><subject>Systems biology</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Statistics (mathematics)</subject><subj-group><subject>Statistical methods</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Modeling Mutual Exclusivity of Cancer Mutations</article-title>
<alt-title alt-title-type="running-head">Modeling Mutual Exclusivity of Cancer Mutations</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Szczurek</surname><given-names>Ewa</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Beerenwinkel</surname><given-names>Niko</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
</contrib-group>
<aff id="aff1"><label>1</label><addr-line>Department of Biosystems Science and Engineering, ETH Zurich, Basel, Switzerland</addr-line></aff>
<aff id="aff2"><label>2</label><addr-line>SIB Swiss Institute of Bioinformatics, Basel, Switzerland</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Tanay</surname><given-names>Amos</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group>
<aff id="edit1"><addr-line>Weizmann Institute of Science, Israel</addr-line></aff>
<author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">niko.beerenwinkel@bsse.ethz.ch</email></corresp>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn>
<fn fn-type="con"><p>Conceived and designed the experiments: ES NB. Analyzed the data: ES. Contributed reagents/materials/analysis tools: ES. Wrote the paper: ES NB.</p></fn>
</author-notes>
<pub-date pub-type="collection"><month>3</month><year>2014</year></pub-date>
<pub-date pub-type="epub"><day>27</day><month>3</month><year>2014</year></pub-date>
<volume>10</volume>
<issue>3</issue>
<elocation-id>e1003503</elocation-id>
<history>
<date date-type="received"><day>29</day><month>10</month><year>2013</year></date>
<date date-type="accepted"><day>14</day><month>1</month><year>2014</year></date>
</history>
<permissions>
<copyright-year>2014</copyright-year>
<copyright-holder>Szczurek, Beerenwinkel</copyright-holder><license xlink:type="simple"><license-p>This is an open-access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><related-article id="RA1" related-article-type="companion" ext-link-type="uri" page="e1003501" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pcbi.1003501"> <article-title>An Integrated Model of Multiple-Condition ChIP-seq Data Reveals Predeterminants of Cdx2 Binding</article-title></related-article><related-article id="RA2" related-article-type="companion" ext-link-type="uri" page="e1003500" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pcbi.1003500"> <article-title>MRFalign: Protein Homology Detection through Alignment of Markov Random Fields</article-title></related-article><related-article id="RA3" related-article-type="companion" ext-link-type="uri" page="e1003502" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pcbi.1003502"> <article-title>HapTree: A Novel Bayesian Framework for Single Individual Polyplotyping Using NGS Data</article-title></related-article><related-article id="RA4" related-article-type="companion" ext-link-type="uri" page="e1003515" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pcbi.1003515"> <article-title>Viral Quasispecies Assembly Via Maximal Clique Enumeration</article-title></related-article>
<abstract>
<p>In large collections of tumor samples, it has been observed that sets of genes that are commonly involved in the same cancer pathways tend not to occur mutated together in the same patient. Such gene sets form mutually exclusive patterns of gene alterations in cancer genomic data. Computational approaches that detect mutually exclusive gene sets, rank and test candidate alteration patterns by rewarding the number of samples the pattern covers and by punishing its impurity, i.e., additional alterations that violate strict mutual exclusivity. However, the extant approaches do not account for possible observation errors. In practice, false negatives and especially false positives can severely bias evaluation and ranking of alteration patterns. To address these limitations, we develop a fully probabilistic, generative model of mutual exclusivity, explicitly taking coverage, impurity, as well as error rates into account, and devise efficient algorithms for parameter estimation and pattern ranking. Based on this model, we derive a statistical test of mutual exclusivity by comparing its likelihood to the null model that assumes independent gene alterations. Using extensive simulations, the new test is shown to be more powerful than a permutation test applied previously. When applied to detect mutual exclusivity patterns in glioblastoma and in pan-cancer data from twelve tumor types, we identify several significant patterns that are biologically relevant, most of which would not be detected by previous approaches. Our statistical modeling framework of mutual exclusivity provides increased flexibility and power to detect cancer pathways from genomic alteration data in the presence of noise. A summary of this paper appears in the proceedings of the RECOMB 2014 conference, April 2–5.</p>
</abstract>
<abstract abstract-type="summary"><title>Author Summary</title>
<p>Tumor DNA carries multiple alterations, including somatic point mutations, amplifications, and deletions. It is challenging to identify the disease-causing alterations from the plethora of random ones, and to delineate their functional relations and involvement in common pathways. One solution for this task is inspired by the observation that genes from the same cancer pathway tend not to be altered together in each patient, and thus form patterns of mutually exclusive alterations across patients. Mutual exclusivity may arise, because alteration of only one pathway component is sufficient to deregulate the entire process. Detecting such patterns is an important step in <italic>de novo</italic> identification of cancerous pathways and potential treatment targets. However, the task is complicated by errors in the data, due to measurement noise, false mutation calls and their misinterpretation. Here, we propose a fully probabilistic, generative model of mutually exclusive patterns accounting for observation errors, with interpretable parameters that allow proper evaluation of patterns, free of error bias. Within our statistical framework, we develop efficient algorithms for parameter estimation and pattern ranking, together with a statistical test for mutual exclusivity, providing more flexibility and power than procedures applied previously.</p>
</abstract>
<funding-group><funding-statement>ES was supported by the ETH Zurich Postdoctoral Fellowship Program and the Marie Curie Actions for People COFUND program (grant No. FEL-13 12-1). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="12"/></counts></article-meta>
</front>
<body><sec id="s1">
<title/>
<disp-quote>
<p>This article is associated with RECOMB 2014.</p>
</disp-quote></sec><sec id="s2">
<title>Introduction</title>
<p>Recent years in cancer research are characterized by both accumulation of data and growing awareness of its overwhelming complexity. While consortia like The Cancer Genome Atlas (TCGA) <xref ref-type="bibr" rid="pcbi.1003503-TCGA1">[1]</xref> and the International Cancer Genome Consortium (ICGC) generate the multidimensional profiles of genomic changes in various cancer types, computational approaches struggle to pinpoint its underlying mechanisms <xref ref-type="bibr" rid="pcbi.1003503-Garraway1">[2]</xref>. The most basic yet already challenging task is to identify cancer drivers, genomic events that are causal for disease progression. A second, more general task is to elucidate sets of functionally related drivers, such as mutations of genes involved in a common oncogenic pathway.</p>
<p>One systematic approach to address the latter task is to search for mutually exclusive patterns in cancer genomic data <xref ref-type="bibr" rid="pcbi.1003503-Miller1">[3]</xref>–<xref ref-type="bibr" rid="pcbi.1003503-Leiserson1">[7]</xref>. Typically, the data is collected for a large number of tumor samples, and records presence or absence of genomic alterations, such as somatic point mutations, amplifications, or deletions of genes. In mutually exclusive patterns, the alterations tend not to occur together in the same patient. These patterns are commonly characterized by their coverage and impurity. Coverage is defined as the number of patient samples in which at least one alteration occurred, while impurity refers to non-exclusive, additional alterations (referred to as non-exclusivity or coverage overlap in previous studies). Such mutually exclusive alterations have frequently been observed in cancer data <xref ref-type="bibr" rid="pcbi.1003503-Yeang1">[8]</xref>–<xref ref-type="bibr" rid="pcbi.1003503-Rajagopalan1">[10]</xref> and were associated with functional pathways or synthetic lethality <xref ref-type="bibr" rid="pcbi.1003503-Miller1">[3]</xref>–<xref ref-type="bibr" rid="pcbi.1003503-Yeang1">[8]</xref>, <xref ref-type="bibr" rid="pcbi.1003503-Masica1">[11]</xref>, <xref ref-type="bibr" rid="pcbi.1003503-Szczurek1">[12]</xref>. Therefore, mutually exclusive patterns are important for a basic understanding of cancer progression and may suggest genes for targeted treatment.</p>
<p>Previous studies identified mutually exclusive patterns either via integrated analysis of known cellular interactions and genomic alteration data <xref ref-type="bibr" rid="pcbi.1003503-Ciriello1">[6]</xref>, or <italic>de novo</italic>, by an online learning approach <xref ref-type="bibr" rid="pcbi.1003503-Miller1">[3]</xref>, or by maximizing the mutual exclusivity weight introduced by Vandin and colleagues <xref ref-type="bibr" rid="pcbi.1003503-Vandin1">[4]</xref>, <xref ref-type="bibr" rid="pcbi.1003503-Zhao1">[5]</xref>, <xref ref-type="bibr" rid="pcbi.1003503-Leiserson1">[7]</xref>. The weight increases with coverage and decreases with coverage overlap <xref ref-type="bibr" rid="pcbi.1003503-Vandin1">[4]</xref> and proved successful for pattern ranking and cancer pathway identification.</p>
<p>To our knowledge, there exists no approach that explicitly models the generative process of mutual exclusivity patterns. In the absence of a statistical model of the data, the definition of the weight, although intuitively reasonable, remains arbitrary. In the previous studies, the weight served also as statistic for a column-wise permutation test that assesses the significance of patterns. We show that the power of this test decreases with the number of genes, likely because the weight does not scale with gene number, and the same impurity level affects it more with more genes in the pattern. Most importantly, none of the existing approaches deal with the problem of errors in the data. Despite advanced methodologies on both experimental and computational side <xref ref-type="bibr" rid="pcbi.1003503-Cibulskis1">[13]</xref>, records of genomic alterations may contain false positives and false negatives, due to measurement noise, as well as uncertainty in mutation calling and interpretation. As illustrated in <xref ref-type="supplementary-material" rid="pcbi.1003503.s001">Figure S1</xref>, ignoring errors in the data, particularly false positives, may lead to wrong ranking of patterns.</p>
<p>Here, we develop two alternative models for cancer alteration data (<xref ref-type="fig" rid="pcbi-1003503-g001">Figure 1</xref>). One is a probabilistic, generative model of mutually exclusive patterns in the data. The model contains coverage as well as impurity as parameters, together with false positive and false negative rates. We show analytically that the model parameters are identifiable, and propose how they can be estimated and used for pattern evaluation. The second is a null model assuming independent alterations of genes. Via comparison of the mutual exclusivity model to the null model, our approach allows statistical testing for mutual exclusivity, both in the presence and absence of errors.</p>
<fig id="pcbi-1003503-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003503.g001</object-id><label>Figure 1</label><caption>
<title>Principles of the mutual exclusivity model and test.</title>
<p><bold>A</bold> The generative process underlying mutual exclusivity patterns. The matrices show alteration status (shaded for presence and white for absence of alteration) for genes (columns) in patients (rows) in consecutive steps of the process, each dependent on parameters indicated in brackets. Blue arrows point at patients that are covered by the pattern with probability <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e001" xlink:type="simple"/></inline-formula>. Orange arrows point at impure alterations, added with probability <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e002" xlink:type="simple"/></inline-formula>. Yellow and green arrows show false positives (added with rate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e003" xlink:type="simple"/></inline-formula>) and false negatives (rate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e004" xlink:type="simple"/></inline-formula>), respectively. <bold>B</bold> Graphical representation of the mutual exclusivity model. Large circles: random variables, with observed variables shaded. Small black circles indicate model parameters, and are connected to their corresponding variables with edges. Arrowed edges show dependencies between variables. The rectangle plate indicates a set of identically distributed variables or a set of their parameters (with indices <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e005" xlink:type="simple"/></inline-formula>). <bold>C</bold> The independence model.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003503.g001" position="float" xlink:type="simple"/></fig>
<p>First, we evaluate performance of our approach in the case when, as it is done in the literature, the data is assumed to record no false positive or negative alterations. On simulated patterns our mutual exclusivity test proves more powerful than the weight-based permutation test. In glioblastoma multiforme data <xref ref-type="bibr" rid="pcbi.1003503-Brennan1">[14]</xref>, analyzed by the previous approaches, we find novel, biologically relevant patterns, which are not detected by the permutation test. Next, we examine the bias introduced in pattern ranking by ignorance of errors, especially false positives, and show that when the error rates are known, our approach is able to accurately estimate the true coverage and impurity and rank the patterns accordingly. Finally, we analyze the practical limits of accurate parameter estimation in the most difficult, but also most realistic case where the data contains errors occurring at unknown rates. We apply our approach to a large, pan-cancer collection of 3299 tumor samples from twelve tumor types <xref ref-type="bibr" rid="pcbi.1003503-Ciriello2">[15]</xref>, for which the model accounting for the presence of false positives can accurately be estimated. This model is shown to be more flexible than the model assuming no errors in the data, and is applied to identify several universal, significant mutual exclusivity patterns, which would not be found by the previous methods.</p>
</sec><sec id="s3">
<title>Results</title>
<sec id="s3a">
<title>Modeling and testing for mutual exclusivity</title>
<p>A mutual exclusivity pattern can be detected in a given cancer alteration dataset, with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e006" xlink:type="simple"/></inline-formula> columns that correspond to a subset of measured genes and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e007" xlink:type="simple"/></inline-formula> rows (observations) that correspond to patients whose tumor samples were collected (with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e008" xlink:type="simple"/></inline-formula>). For each patient and gene, the dataset records a binary alteration status of the gene observed in the patient, with 0 standing for absence and 1 for presence of alteration.</p>
<p>We assume that the mutual exclusivity patterns are the result of the following generative process (<xref ref-type="fig" rid="pcbi-1003503-g001">Figure 1A</xref>). First, with a certain probability, denoted <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e009" xlink:type="simple"/></inline-formula> and called coverage, the patients who are covered by the pattern are chosen. Each row corresponding to a covered patient is hit by an exclusive alteration, meaning that exactly one gene is assigned value 1 in this row. Here, we assume that all genes have equal probability to be exclusively mutated. Next, in the same row, with probability <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e010" xlink:type="simple"/></inline-formula>, any other gene can be mutated in addition. Those added alterations are interpreted as impurity in the mutual exclusivity pattern, hence <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e011" xlink:type="simple"/></inline-formula> is referred to as the impurity parameter. The generative process described up to this point coincides with the data simulation procedure used in previous studies <xref ref-type="bibr" rid="pcbi.1003503-Vandin1">[4]</xref>, <xref ref-type="bibr" rid="pcbi.1003503-Zhao1">[5]</xref>. However, the corresponding generative model was not used for statistical inference. This prevalent view of the generative process ignores the possible occurrence of errors. Realistically, the observed alteration data result from adding false positives (with rate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e012" xlink:type="simple"/></inline-formula>) and false negatives (rate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e013" xlink:type="simple"/></inline-formula>) to the true, exclusive, and impure alterations.</p>
<p>We propose a generative model of mutual exclusivity that describes the process illustrated in <xref ref-type="fig" rid="pcbi-1003503-g001">Figure 1A</xref>. For each patient in a given dataset, the proposed model (<xref ref-type="fig" rid="pcbi-1003503-g001">Figure 1B</xref> and Methods) assigns a probability to the corresponding observation. The model is defined by a set of hidden random variables <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e014" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e015" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e016" xlink:type="simple"/></inline-formula>, and observed variables <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e017" xlink:type="simple"/></inline-formula>. The binary variable <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e018" xlink:type="simple"/></inline-formula> has value 1 with probability <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e019" xlink:type="simple"/></inline-formula>, indicating that the patient is covered by the mutual exclusivity pattern. The hidden random variable <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e020" xlink:type="simple"/></inline-formula> points at the gene that is exclusively altered in that pattern. The set of hidden random binary variables <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e021" xlink:type="simple"/></inline-formula> corresponds to the true alteration status of the genes, and the set of observed binary variables <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e022" xlink:type="simple"/></inline-formula> corresponds to the alteration status that is recorded in the data. Each true alteration variable <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e023" xlink:type="simple"/></inline-formula> has value 1 either if it was chosen to be exclusively altered, or if it was not chosen but acquired an impure alteration with probability <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e024" xlink:type="simple"/></inline-formula>. The values of the variables <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e025" xlink:type="simple"/></inline-formula> are the same as values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e026" xlink:type="simple"/></inline-formula>, except for cases of false positives (with probability <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e027" xlink:type="simple"/></inline-formula>) and false negatives (with probability <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e028" xlink:type="simple"/></inline-formula>). First, we analyzed the identifiability of the model from observed data (<xref ref-type="supplementary-material" rid="pcbi.1003503.s015">Text S1</xref>):</p>
<p><bold>Proposition 1</bold> For <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e029" xlink:type="simple"/></inline-formula>, the parameters in the mutual exclusivity model are identifiable.</p>
<p>Encouraged by this result, we propose an expectation maximization algorithm (Methods) to estimate the maximum likelihood parameter values and evaluate its performance in practice (<xref ref-type="sec" rid="s3">Results</xref>).</p>
<p>In the case when the dataset does not carry the mutual exclusivity pattern, we assume that the corresponding genes are mutated independently with their individual alteration frequencies. This is modeled with a set of independent, observed binary random variables <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e030" xlink:type="simple"/></inline-formula>, satisfying <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e031" xlink:type="simple"/></inline-formula> for each <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e032" xlink:type="simple"/></inline-formula> (referred to as the independence model; <xref ref-type="supplementary-material" rid="pcbi.1003503.s015">Text S1</xref>). We devise a mutual exclusivity test (shortly, ME test), which compares the likelihood in the mutual exclusivity model to the likelihood in the independence model. Since the models are not nested, we use Vuong's closeness test <xref ref-type="bibr" rid="pcbi.1003503-Vuong1">[16]</xref> to compute the p-values (Methods). A small p-value means that the mutual exclusivity model is closer (with respect to Kullback-Leibler divergence) to the true model from which the data was generated than the independence model. The test statistic accounts for the difference in degrees of freedom between the models.</p>
<p>We evaluate our mutual exclusivity model and statistical test in three different scenarios. First, we make an assumption prevalent in the literature, namely that the data is generated without errors. In the second scenario, we assume that the data contains errors, and the error rates are given. Finally, we consider the scenario where the data is generated with errors, and the error rates are unknown.</p>
</sec><sec id="s3b">
<title>Modeling mutual exclusivity patterns without errors</title>
<p>First, we evaluate the performance of our mutual exclusivity model on simulated data assuming that the data is clean of errors. In this case, the model is reduced, since it is parametrized only by the coverage <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e033" xlink:type="simple"/></inline-formula> and the impurity <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e034" xlink:type="simple"/></inline-formula>, and the observed variables <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e035" xlink:type="simple"/></inline-formula> are equated with the true hidden variables <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e036" xlink:type="simple"/></inline-formula>. We have derived closed-form expressions for the maximum likelihood parameter values (Methods), providing reliable parameter estimates already for datasets of sample size 200 (<xref ref-type="supplementary-material" rid="pcbi.1003503.s008">Table S1</xref>). We simulated datasets from the reduced mutual exclusivity model, for increasing gene set sizes, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e037" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e038" xlink:type="simple"/></inline-formula> patients, and combinations of parameter values <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e039" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e040" xlink:type="simple"/></inline-formula>, with 20 datasets generated per each parameter setting (example in <xref ref-type="fig" rid="pcbi-1003503-g002">Figure 2A</xref>). For each dataset, we assessed the significance of mutual exclusivity using the proposed ME test (Methods). For comparison, we obtained empirical p-values from the weight-based permutation test, which permutes individual columns in the dataset 1000 times, and reports the number of times a permuted dataset had a higher weight than the original <xref ref-type="bibr" rid="pcbi.1003503-Vandin1">[4]</xref>, <xref ref-type="bibr" rid="pcbi.1003503-Zhao1">[5]</xref>.</p>
<fig id="pcbi-1003503-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003503.g002</object-id><label>Figure 2</label><caption>
<title>Our mutual exclusivity (ME) test is more powerful than a permutation test, which was applied previously.</title>
<p><bold>A</bold> Example simulated mutual exclusivity pattern. <bold>B</bold> The ME test shows smaller p-values with growing number of genes in the patterns. On the contrary, the permutation test (with 1000 column-wise permutations) is less powerful for larger patterns. <bold>C</bold> Both tests do not support mutual exclusivity in data generated from the independence model.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003503.g002" position="float" xlink:type="simple"/></fig>
<p>For datasets with three genes only and low coverages, both our ME and the permutation test not always detect mutual exclusivity (<xref ref-type="fig" rid="pcbi-1003503-g002">Figure 2B</xref>). As the gene set size increases, in contrast to the permutation test, the ME test becomes more powerful. With ten genes, our test supports mutual exclusivity for all datasets, whereas the permutation test does not, even for a large fraction of datasets with high coverage. As an example, for the mutual exclusivity pattern in <xref ref-type="fig" rid="pcbi-1003503-g002">Figure 2A</xref> the ME test p-value is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e041" xlink:type="simple"/></inline-formula>, and the permutation test p-value is 0.15. We speculate that the reason for the decreased power of the permutation test is the weight itself. With the same coverage and impurity, large gene sets get less significant weights than small gene sets, since the weight decreases drastically with addition of impure alterations in each row, and this addition is more likely for longer rows. In addition, with increased gene set size the ME test p-values tend to decrease. This suggests that the test will remain powerful also after multiple hypothesis testing correction, which is expected to be more restrictive for larger set sizes.</p>
<p>Both tests correctly do not support mutual exclusivity for datasets generated from the independence model (<xref ref-type="fig" rid="pcbi-1003503-g002">Figure 2C</xref>). 20 datasets were simulated per each maximum individual frequency <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e042" xlink:type="simple"/></inline-formula> (each frequency <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e043" xlink:type="simple"/></inline-formula> was drawn at random uniformly from interval <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e044" xlink:type="simple"/></inline-formula>). The same, correct behavior was observed when the independent frequencies were drawn from a distribution observed in real cancer data (<xref ref-type="supplementary-material" rid="pcbi.1003503.s002">Figure S2</xref>). <xref ref-type="fig" rid="pcbi-1003503-g002">Figures 2B,C</xref> show that the ME test, without computationally expensive permutations, yields ranges of p-values that are amenable to multiple testing corrections. In summary, the ME test is equally powerful for small gene sets as the permutation test, and more powerful for larger ones, and can efficiently be applied in practice.</p>
<p>We further use our model to identify significant mutual exclusivity patterns with high coverage and low impurity in glioblastoma multiforme samples from The Cancer Genome Atlas (TCGA <xref ref-type="bibr" rid="pcbi.1003503-Brennan1">[14]</xref>; extended collection; originally published with fewer samples <xref ref-type="bibr" rid="pcbi.1003503-TCGA1">[1]</xref>). The data were organized in a binary matrix combining point mutations and copy number variants for 236 patients in 83 genes. The genes and their alterations were selected to represent significant players and events in disease progression (Methods).</p>
<p>To obtain a comprehensive picture of the types of patterns that can be found in this dataset, we restricted the gene set size to four, and evaluated all 1,837,620 possible gene subsets of this size. <xref ref-type="fig" rid="pcbi-1003503-g003">Figure 3A</xref> presents the pattern with the largest weight, but also large imbalance: in that pattern, almost the entire coverage comes from alterations of a single gene, <italic>EGFR</italic>. With our approach the quality of each pattern can be assessed with the estimated coverage and impurity parameters, while its significance is given by the p-value from the ME test. In the standard understanding, a high quality pattern has high coverage and low impurity. For the GBM dataset we obtained 11 significant (Benjamini-Hochberg adjusted ME p-value <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e045" xlink:type="simple"/></inline-formula>) patterns with estimated coverage larger than 0.3 and impurity lower than 0.2 (<xref ref-type="supplementary-material" rid="pcbi.1003503.s009">Table S2</xref>). <xref ref-type="fig" rid="pcbi-1003503-g003">Figure 3B–D</xref> presents top three of those patterns with the lowest impurity. Out of the genes included in those top sets, <italic>NF1</italic>, <italic>PIK3C2G</italic>, <italic>PIK3R1</italic> and <italic>PIK3CA</italic> play roles in the interconnected canonical glioblastoma signaling <xref ref-type="bibr" rid="pcbi.1003503-TCGA1">[1]</xref>, although are not found directly grouped into individual pathways as identified by the original publication. Notably, the TRAT1 protein is a known interaction partner of PIK3R <xref ref-type="bibr" rid="pcbi.1003503-Zhang1">[17]</xref>, <xref ref-type="bibr" rid="pcbi.1003503-Bruyns1">[18]</xref>.</p>
<fig id="pcbi-1003503-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003503.g003</object-id><label>Figure 3</label><caption>
<title>Top mutual exclusivity patterns identified in cancer data.</title>
<p><bold>A–D</bold> Patterns in glioblastoma. <bold>A</bold> Pattern for the gene set with the highest weight (scoring high coverage and low impurity, applied in previous studies), with adjusted permutation test p-value 0. <bold>B–D</bold> Examples of significant, high quality patterns identified using the reduced mutual exclusivity model (assuming no errors), with estimated coverage larger by 0.3 and impurity lower than 0.2. <bold>E–H</bold> Patterns in pan-cancer data. <bold>E</bold> Pattern the for gene set with the highest weight. <bold>F–H</bold> Examples of significant, high quality patterns identified using the mutual exclusivity model that accounts for false positives, with estimated coverage larger by 0.3 and impurity lower than 0.2.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003503.g003" position="float" xlink:type="simple"/></fig>
<p><xref ref-type="table" rid="pcbi-1003503-t001">Table 1</xref> summarizes the statistics for all presented patterns, underlining the differences between the ME and permutation tests. With the explicit account for coverage and impurity as parameters in the model, our approach gives control over which important features of the patterns should be used to prioritize the significant patterns of interest. In contrast to the permutation test, the ME test is specifically designed to prefer balanced patterns. Consequently, patterns identified using our ME approach have over three times lower median imbalance than the median imbalance of top weight patterns with adjusted permutation test p-values <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e046" xlink:type="simple"/></inline-formula> (<xref ref-type="supplementary-material" rid="pcbi.1003503.s003">Figure S3</xref>). To assess the imbalance of a given gene set, we calculated the ratio between the number of alterations of the gene with the largest individual frequency in the set to the total number of patients covered with the pattern.</p>
<table-wrap id="pcbi-1003503-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003503.t001</object-id><label>Table 1</label><caption>
<title>Summary of top patterns identified for the glioblastoma dataset assuming no errors.</title>
</caption><alternatives><graphic id="pcbi-1003503-t001-1" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003503.t001" xlink:type="simple"/>
<table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" rowspan="1" colspan="1">Gene set</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e047" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e048" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">ME statistic</td>
<td align="left" rowspan="1" colspan="1">ME p-value</td>
<td align="left" rowspan="1" colspan="1">Weight</td>
<td align="left" rowspan="1" colspan="1">Perm. p-value</td>
<td align="left" rowspan="1" colspan="1">Imbalance</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>EGFR</italic>, <italic>GCSAML</italic>, <italic>IDH1 OTC</italic></td>
<td align="left" rowspan="1" colspan="1">0.97</td>
<td align="left" rowspan="1" colspan="1">0.01</td>
<td align="left" rowspan="1" colspan="1">−14.72</td>
<td align="left" rowspan="1" colspan="1">1</td>
<td align="left" rowspan="1" colspan="1">221</td>
<td align="left" rowspan="1" colspan="1">0</td>
<td align="left" rowspan="1" colspan="1">0.93</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>ABCC9</italic>, <italic>PIK3CA</italic>, <italic>RPL5 TRAT1</italic></td>
<td align="left" rowspan="1" colspan="1">0.44</td>
<td align="left" rowspan="1" colspan="1">0.11</td>
<td align="left" rowspan="1" colspan="1">2.63</td>
<td align="left" rowspan="1" colspan="1">0.04</td>
<td align="left" rowspan="1" colspan="1">69</td>
<td align="left" rowspan="1" colspan="1">1</td>
<td align="left" rowspan="1" colspan="1">0.28</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>PIK3C2G</italic>, <italic>PIK3CA</italic>, <italic>RPL5 TRAT1</italic></td>
<td align="left" rowspan="1" colspan="1">0.44</td>
<td align="left" rowspan="1" colspan="1">0.11</td>
<td align="left" rowspan="1" colspan="1">2.84</td>
<td align="left" rowspan="1" colspan="1">0.02</td>
<td align="left" rowspan="1" colspan="1">68</td>
<td align="left" rowspan="1" colspan="1">1</td>
<td align="left" rowspan="1" colspan="1">0.27</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>NF1</italic>, <italic>PIK3C2G</italic>, <italic>PIK3R1</italic>, <italic>TRAT1</italic></td>
<td align="left" rowspan="1" colspan="1">0.5</td>
<td align="left" rowspan="1" colspan="1">0.13</td>
<td align="left" rowspan="1" colspan="1">2.63</td>
<td align="left" rowspan="1" colspan="1">0.04</td>
<td align="left" rowspan="1" colspan="1">72</td>
<td align="left" rowspan="1" colspan="1">1</td>
<td align="left" rowspan="1" colspan="1">0.28</td>
</tr>
</tbody>
</table>
</alternatives><table-wrap-foot><fn id="nt101"><label/><p><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e049" xlink:type="simple"/></inline-formula>: estimated coverage; <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e050" xlink:type="simple"/></inline-formula>: estimated impurity; ME statistic: Vuong statistic comparing the likelihood under the mutual exclusivity model to the likelihood under the independence model; ME p-value: p-value in the ME test (Vuong's test with ME statistic; adjusted using the Benjamini and Hochberg method). Weight: a mutual exclusivity score, applied in previous studies, which increases with coverage and decreases with impurity; Perm. p-value: adjusted p-value in a weight-based column permutation test. Imbalance: contribution of the most frequently mutated gene in the pattern to the coverage.</p></fn></table-wrap-foot></table-wrap>
<p>Our analysis did not rediscover four mutually exclusive gene sets (<xref ref-type="supplementary-material" rid="pcbi.1003503.s010">Table S3</xref>) identified previously based on optimizing the weight <xref ref-type="bibr" rid="pcbi.1003503-Vandin1">[4]</xref>, <xref ref-type="bibr" rid="pcbi.1003503-Leiserson1">[7]</xref> for the first, original GBM dataset version. Several genes in those sets did not pass our filtering criteria in the pre-processing step (Methods), and one gene set could not be analyzed for this reason. Two sets had large estimated impurity(<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e051" xlink:type="simple"/></inline-formula>), which does not satisfy our threshold. All three analyzed gene sets were insignificant according to the ME test, most likely due to relatively high imbalance (two to three times larger than median imbalance of gene sets we identified, compare <xref ref-type="supplementary-material" rid="pcbi.1003503.s003">Figure S3</xref>). Interestingly, one of those gene sets does not have a significant permutation p-value, which may be due to the fact that the processing of the data was different and the original dataset contained fewer samples.</p>
</sec><sec id="s3c">
<title>Modeling mutual exclusivity with known error rates</title>
<p>In this section, we consider the scenario where the data are erroneous, and the error rates are known and can be used for pattern evaluation. <xref ref-type="supplementary-material" rid="pcbi.1003503.s001">Figure S1</xref> visualizes the severe effects of error ignorance. The observed weight, computed on datasets with false negatives, is consistently reduced as compared to the true weight of patterns generated without errors. Addition of false positives introduces most bias in the observed weight, and results in false ranking. Similarly, for the reduced mutual exclusivity model assuming no errors, parameter estimation fails in the case when they do occur in the data (<xref ref-type="supplementary-material" rid="pcbi.1003503.s004">Figure S4</xref>). Thus there is a well motivated need for the model to account for errors.</p>
<p>Fixing the parameters <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e052" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e053" xlink:type="simple"/></inline-formula> in our model to the true false positive and negative rates, respectively, we can estimate the remaining coverage <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e054" xlink:type="simple"/></inline-formula> and impurity <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e055" xlink:type="simple"/></inline-formula> parameters using the EM algorithm (Methods). This estimation is very precise for simulated datasets with five genes, and sample sizes 200 or 1000 (<xref ref-type="supplementary-material" rid="pcbi.1003503.s008">Table S1</xref>, <xref ref-type="supplementary-material" rid="pcbi.1003503.s005">Figure S5</xref>). <xref ref-type="fig" rid="pcbi-1003503-g004">Figure 4</xref> shows that such precise estimates can be used to rank the patterns by their estimated true quality, first sorting by the estimated impurity and second by their estimated coverage. We ranked the erroneous datasets simulated in <xref ref-type="supplementary-material" rid="pcbi.1003503.s001">Figure S1</xref> by their estimated true quality. Next, we evaluated the fraction of dataset pairs which were ordered the same way as when their true impurity and coverage were used for sorting. This fraction of correctly ranked pairs was compared to the fraction that is ranked the same way by the observed weight as compared to the true weight. For data containing false negatives both the quality ranking and the observed weight perform very well in correct ranking. The estimated true quality significantly outperforms the observed weight in the presence of false positives.</p>
<fig id="pcbi-1003503-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003503.g004</object-id><label>Figure 4</label><caption>
<title>Improved ranking of erroneous patterns.</title>
<p>In contrast to the observed weight, which was applied in previous studies, and ignores errors and scores observed coverage and impurity, our approach to estimate true quality, using known error rates, estimates the true parameters and ranks the patterns correctly. The data was simulated from the mutual exclusivity model with parameter values fixed to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e056" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e057" xlink:type="simple"/></inline-formula>, with error rates <bold>A</bold> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e058" xlink:type="simple"/></inline-formula> (x-axis), <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e059" xlink:type="simple"/></inline-formula>, as well as <bold>B</bold> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e060" xlink:type="simple"/></inline-formula> (x-axis), <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e061" xlink:type="simple"/></inline-formula>. 20 datasets with 5 genes and 1000 patients were simulated per each parameter setting.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003503.g004" position="float" xlink:type="simple"/></fig></sec><sec id="s3d">
<title>Modeling mutual exclusivity with unknown error rates</title>
<p>Finally, we consider the scenario, where the observed data contains errors that occur at unknown rates. In this case we need to estimate all four model parameters, and we proved the model to be identifiable from the data (<xref ref-type="supplementary-material" rid="pcbi.1003503.s015">Text S1</xref>). As expected, <xref ref-type="supplementary-material" rid="pcbi.1003503.s008">Table S1</xref> shows that for realistic sample and gene set size (200 or 1000 patients and five genes), and for typical parameter settings (with small impurity <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e062" xlink:type="simple"/></inline-formula> and error rates <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e063" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e064" xlink:type="simple"/></inline-formula>), parameter estimation is more difficult than in the case where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e065" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e066" xlink:type="simple"/></inline-formula> are given (compare <xref ref-type="supplementary-material" rid="pcbi.1003503.s005">Figure S5</xref>). The estimated parameter values start approaching the true ones only for prohibitively large sample sizes (<xref ref-type="supplementary-material" rid="pcbi.1003503.s006">Figure S6</xref>). In particular, for realistic sample numbers, the parameter <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e067" xlink:type="simple"/></inline-formula> is largely underestimated. Since in case of mutual exclusivity and small <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e068" xlink:type="simple"/></inline-formula> values, there are in total not many true positive cases, the actual false negatives should be very rare. Thus, without much loss of generality of our approach for realistic datasets, we further assume that the false negative rate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e069" xlink:type="simple"/></inline-formula> is zero, and account only for the false positives. With this assumption, our approach is still very useful in mutual exclusivity analysis: <xref ref-type="supplementary-material" rid="pcbi.1003503.s001">Figure S1</xref> and <xref ref-type="fig" rid="pcbi-1003503-g004">Figure 4</xref> show that in terms of ranking there is a pressing need to account for the false positives rather than for false negatives.</p>
<p><xref ref-type="supplementary-material" rid="pcbi.1003503.s008">Table S1</xref> and <xref ref-type="supplementary-material" rid="pcbi.1003503.s007">Figure S7</xref> illustrate that with this assumption, already for 1000 samples (but not 200) a much more accurate estimation of the remaining parameters <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e070" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e071" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e072" xlink:type="simple"/></inline-formula> is possible. Still, for impurity <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e073" xlink:type="simple"/></inline-formula> too similar to false positive <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e074" xlink:type="simple"/></inline-formula>, the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e075" xlink:type="simple"/></inline-formula> parameter is overestimated, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e076" xlink:type="simple"/></inline-formula> underestimated. Thus, in some cases, the true impurity <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e077" xlink:type="simple"/></inline-formula> may be smaller than its estimated value, making our evaluation of patterns over-conservative. Again, this problem diminishes for larger datasets. <xref ref-type="fig" rid="pcbi-1003503-g005">Figure 5</xref> shows, that for realistic dataset sizes and parameter sizes, the ME test is able to detect mutual exclusivity in data with false positives, and is more powerful than the permutation test.</p>
<fig id="pcbi-1003503-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003503.g005</object-id><label>Figure 5</label><caption>
<title>Power of the mutual exclusivity model accounting for false positives.</title>
<p>The ME test p-values for <bold>A</bold> data generated from the full mutual exclusivity model with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e078" xlink:type="simple"/></inline-formula> given, and <bold>B</bold> generated from the independence model, in comparison to a permutation test applied in previous studies. Again, the ME test is more powerful (compare <xref ref-type="fig" rid="pcbi-1003503-g002">Figure 2</xref>).</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003503.g005" position="float" xlink:type="simple"/></fig>
<p>We applied our approach accounting for false positives to pan-cancer genomic alteration data <xref ref-type="bibr" rid="pcbi.1003503-Ciriello2">[15]</xref>, a data collection from twelve distinct cancer types. Combining cancer datasets enables to mine for mutually exclusive patterns that are universal for the disease, but can be a problem for the search of patterns that are specific for one of the combined types. A gene set which has mutually exclusive alterations in only one cancer type and not others will most likely not be detectable in the combined dataset. The pan-cancer dataset is much larger than the glioblastoma data, thus allowing more accurate parameter estimation. Somatic point mutations, copy number variants, and methylations were compiled into a single binary data matrix. Duplicated columns from the compiled matrix were removed, yielding a matrix with 428 columns, some of which represent not one, but several genes (Methods).</p>
<p>We aimed to collect universal, low-impurity mutual exclusivity patterns for gene sets of size five that cover multiple cancer samples, accounting for possible false positives. We first pre-filtered the immense set of all possible subsets, starting with fitting the reduced model (assuming no errors in the data) for all 15,504 subsets of 20 measured genes that were selected by their large individual alteration frequency (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e079" xlink:type="simple"/></inline-formula>; c.a. 0.6%). Next, we chose the 2039 subsets that had estimated coverage larger than 0.3, impurity lower than 0.2, and ME statistic larger than 0, indicating the reduced mutual exclusivity model fits the data better than the independence model (not necessarily significantly). <xref ref-type="fig" rid="pcbi-1003503-g003">Figure 3E</xref> shows the pattern that in the pre-filtered dataset has the largest weight, which is largely dominated by alterations of TP53. Finally, we applied the model accounting for false positives to the pre-filtered subsets, and identified 476 high quality patterns (<xref ref-type="supplementary-material" rid="pcbi.1003503.s012">Table S5</xref>) with estimated coverage larger than 0.3, impurity lower than 0.2, selecting by significance (Benjamini-Hochberg adjusted ME p-value <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e080" xlink:type="simple"/></inline-formula>), and sorting by impurity (lowest on top; examples in <xref ref-type="fig" rid="pcbi-1003503-g003">Figures 3F–H</xref>). Three out of all columns in the visualized patterns correspond not to one, but a set of genes, and are denoted <italic>META 1-3</italic> (see <xref ref-type="supplementary-material" rid="pcbi.1003503.s011">Table S4</xref> for individual genes). A possible reason for a large number of significant and high quality gene sets (<xref ref-type="supplementary-material" rid="pcbi.1003503.s012">Table S5</xref>) is the fact that the identified gene sets overlap. Such overlapping gene sets may either share strongly mutually exclusive subsets of smaller size, or may all be subsets of a single, larger mutually exclusive gene set.</p>
<p>Findings for various cancers for pairs of genes support that the top patterns are indicative of coexistence in a common cancer pathway. For instance, for the pattern in <xref ref-type="fig" rid="pcbi-1003503-g003">Figure 3G</xref>, the protein products of the genes <italic>PTEN</italic> and <italic>MYC</italic> (element of <italic>META 2</italic>) are co-regulators of p53 in control of differentiation, self-renewal, and transformation in glioblastoma <xref ref-type="bibr" rid="pcbi.1003503-Zheng1">[19]</xref>. The gene copy ratio of <italic>MYC</italic> and <italic>CDKN2A</italic> in the same pattern has a prognostic value in squamous cell carcinoma of the head and neck <xref ref-type="bibr" rid="pcbi.1003503-Akervall1">[20]</xref>. Finally, <italic>PTEN</italic> and <italic>VHL</italic> are both known regulators of the HIF-1 pathway <xref ref-type="bibr" rid="pcbi.1003503-Zundel1">[21]</xref>. <italic>PTEN</italic> and <italic>APC</italic>, common to two identified gene sets, are tumor suppressors that are known to interact in cancer <xref ref-type="bibr" rid="pcbi.1003503-Song1">[22]</xref>.</p>
<p><xref ref-type="supplementary-material" rid="pcbi.1003503.s013">Table S6</xref> compares the p-values and estimated parameters, obtained for the top identified patterns, using the model accounting for false positives to the reduced model. As a rule, the former p-values are smaller, while the values of the coverage and impurity parameters estimated by the two models are similar. In one case however (<xref ref-type="fig" rid="pcbi-1003503-g003">Figure 3G</xref>), the estimated false positive rate is 0.037, yielding the estimated coverage accordingly smaller (0.45) than the estimate from the reduced model (0.55). This is why this pattern, although with larger observed coverage, in our true quality ranking would score lower than the pattern in <xref ref-type="fig" rid="pcbi-1003503-g003">Figure 3H</xref>. In general, for all pre-filtered subsets the ME test based on the model that accounts for false positives was more flexible, and returned a larger number of significant p-values (1397; adjusted ME p-value <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e081" xlink:type="simple"/></inline-formula>), than the test based on the reduced model (1171).</p>
</sec></sec><sec id="s4">
<title>Discussion</title>
<p>This work brings two main contributions. First, a probabilistic, generative model of mutual exclusivity, with readily interpretable parameters that represent pattern coverage and impurity, as well as parameters that account for false positive and false negative rates. In the case when the data is clear of errors, we give closed-form expressions for maximum likelihood coverage and impurity estimates. For erroneous data, we propose an EM algorithm for parameter estimation. We prove analytically that the model parameters are identifiable, and show the limits of parameter estimation in practice, where the sample sizes are small. These limits allow accurate estimation of the most troublesome false positive rate, as well as the coverage and impurity parameters, which are most useful for pattern ranking. Second, we develop the ME test, which assesses the significance of mutual exclusivity patterns by comparing the likelihood of the dataset under the mutual exclusivity model to the null model assuming independent alterations of genes. The proposed test proves to be more powerful than a permutation test applied previously.</p>
<p>Our approach was first applied to identify mutually exclusive patterns that are specific for glioblastoma, with the assumption prevalent in the literature that the data does not contain errors. The genes that show the top identified patterns are involved in canonical glioblastoma signaling pathways, with addition of two novel genes, <italic>RPL5</italic> and <italic>TRAT1</italic>. Next, we applied the model that accounts for false positives, and detected universal patterns with high coverage and low impurity, found significant by the ME test across a collection of samples from twelve different cancers. Although both these cancer cohorts were already analyzed in detail with cutting-edge tools <xref ref-type="bibr" rid="pcbi.1003503-TCGA1">[1]</xref>, <xref ref-type="bibr" rid="pcbi.1003503-Miller1">[3]</xref>–<xref ref-type="bibr" rid="pcbi.1003503-Leiserson1">[7]</xref>, <xref ref-type="bibr" rid="pcbi.1003503-Ciriello2">[15]</xref>, our new testing procedure provides new, significant, and biologically relevant patterns that were not identified previously.</p>
<p>The proposed mutual exclusivity model could be extended in several ways. For instance, the current model explicitly assumes that the mutually exclusive mutations occur equally likely in all genes in the dataset. This assumption has two important advantages. First, the ME test finds most evidence for mutual exclusivity for balanced patterns, where the genes contribute similarly to the coverage. Second, with this assumption our EM algorithm is very efficient (Methods) and dropping it would increase its time complexity. The model may be extended to allow different mutually exclusive mutation rates of genes as parameters, which would be estimated from the data. Another possible extension of the model would allow for multiple gene sets, each with own coverage and impurity parameters, and the same error rates. Such a model, in contrast to previous work in this direction <xref ref-type="bibr" rid="pcbi.1003503-Leiserson1">[7]</xref>, would correct for errors and prioritize patterns with balanced mutually exclusive mutations. Finally, this work, focusing on modeling, evaluation, and testing for mutual exclusivity, does not deal with efficient search for mutual exclusivity patterns. Instead, we browse all possible, small gene subsets measured in glioblastoma, or all gene sets with high coverage in the pan-cancer data. Integration of the model into existing <xref ref-type="bibr" rid="pcbi.1003503-Vandin1">[4]</xref>, <xref ref-type="bibr" rid="pcbi.1003503-Zhao1">[5]</xref> or a new search procedure is one direction of our future research. Ideally, the objective optimized in the search would be a single measure that reflects preferred impurity, coverage, and significance in the ME test. These three evaluation criteria could be combined using appropriate priors in the ME model. The results presented here indicate that already now, the proposed approach is a step forward in the demanding task of mining cancer genomic data for the mechanistic principles of this disease.</p>
</sec><sec id="s5" sec-type="materials|methods">
<title>Materials and Methods</title>
<sec id="s5a">
<title>Preprocessing of genomic cancer data</title>
<p>The TCGA provisional glioblastoma data for 236 patients in 83 genes includes somatic point mutations (identified as significant by MutSig <xref ref-type="bibr" rid="pcbi.1003503-Getz1">[23]</xref>), amplifications and deletions (called by GISTIC <xref ref-type="bibr" rid="pcbi.1003503-Beroukhim1">[24]</xref>). The combined analyzed dataset is filled with zeros, and has entry 1 whenever there was a significant point mutation, or a copy number variant that is concordant with expression in the data. For each gene, concordance of its copy number variants (amplifications and deletions) with expression data was assessed using the Wilcoxon test, comparing medians of the gene expression in the samples with the variant to expression in diploid samples. Specifically, amplifications were tested to have expression median higher, and deletions to have the median lower than the diploid cases. Only significantly concordant (p-value 0.05) variants were recorded in the analyzed dataset. The pan-cancer TCGA data has 3299 samples and records somatic point mutations, amplifications, deletions and methylations. Pre-processed data was downloaded from the cBioPortal <xref ref-type="bibr" rid="pcbi.1003503-Cerami1">[25]</xref> and combined into a single binary matrix with altered genes as columns, separately for the GBM and for the pan-cancer data collection. In the combined pan-cancer matrix some columns were identical, with different genes having alterations in exactly the same patients. Since such genes are undistinguishable with respect to mutual exclusivity patterns, they were combined into “meta” sets of genes, and represented with a single column in the matrix.</p>
</sec><sec id="s5b">
<title>Generative mutual exclusivity model</title>
<p>Let <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e082" xlink:type="simple"/></inline-formula> be the set of model parameters, with coverage <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e083" xlink:type="simple"/></inline-formula>, impurity <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e084" xlink:type="simple"/></inline-formula>, false positive rate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e085" xlink:type="simple"/></inline-formula> and false negative rate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e086" xlink:type="simple"/></inline-formula>. We define the mutual exclusivity model on a set of random variables: hidden binary random variable <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e087" xlink:type="simple"/></inline-formula> that indicates patient coverage, hidden binary vector variable <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e088" xlink:type="simple"/></inline-formula> that specifies the single exclusively mutated gene in a covered patient, a set of hidden binary variables <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e089" xlink:type="simple"/></inline-formula> that represent the true alterations of genes, and a set of observed variables <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e090" xlink:type="simple"/></inline-formula> that correspond to the alteration status of genes recorded in the data. The model is defined by:<disp-formula id="pcbi.1003503.e091"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003503.e091" xlink:type="simple"/></disp-formula><disp-formula id="pcbi.1003503.e092"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003503.e092" xlink:type="simple"/></disp-formula><disp-formula id="pcbi.1003503.e093"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003503.e093" xlink:type="simple"/></disp-formula><disp-formula id="pcbi.1003503.e094"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003503.e094" xlink:type="simple"/></disp-formula><disp-formula id="pcbi.1003503.e095"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003503.e095" xlink:type="simple"/></disp-formula><disp-formula id="pcbi.1003503.e096"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003503.e096" xlink:type="simple"/></disp-formula><disp-formula id="pcbi.1003503.e097"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003503.e097" xlink:type="simple"/></disp-formula>for all <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e098" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e099" xlink:type="simple"/></inline-formula> is a unit vector of length <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e100" xlink:type="simple"/></inline-formula> with a single entry 1 at position <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e101" xlink:type="simple"/></inline-formula>. Thus, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e102" xlink:type="simple"/></inline-formula> means that some other gene than <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e103" xlink:type="simple"/></inline-formula> is selected as mutually exclusively mutated. With this distribution of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e104" xlink:type="simple"/></inline-formula>, our model is tailored for balanced patterns, where the mutually exclusive alterations occur on average equally frequently for each gene in the pattern. The set of of hidden binary random variables <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e105" xlink:type="simple"/></inline-formula> indicates true alterations in the genes. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e106" xlink:type="simple"/></inline-formula> has value 1 either when gene <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e107" xlink:type="simple"/></inline-formula> is selected as mutually exclusive (for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e108" xlink:type="simple"/></inline-formula>), or, otherwise, when the entry for gene <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e109" xlink:type="simple"/></inline-formula> is impure, and it was mutated in addition to another gene (for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e110" xlink:type="simple"/></inline-formula>). In this model, the observed likelihood <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e111" xlink:type="simple"/></inline-formula> for a given observation <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e112" xlink:type="simple"/></inline-formula> depends only on the number of values 1 in the observation, denoted <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e113" xlink:type="simple"/></inline-formula>, and observation length <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e114" xlink:type="simple"/></inline-formula>, and is thus denoted <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e115" xlink:type="simple"/></inline-formula> (<xref ref-type="supplementary-material" rid="pcbi.1003503.s015">Text S1</xref>). For <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e116" xlink:type="simple"/></inline-formula> we have:<disp-formula id="pcbi.1003503.e117"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003503.e117" xlink:type="simple"/><label>(1)</label></disp-formula>The likelihood of the whole dataset <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e118" xlink:type="simple"/></inline-formula> reads:<disp-formula id="pcbi.1003503.e119"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003503.e119" xlink:type="simple"/><label>(2)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e120" xlink:type="simple"/></inline-formula> is the number of observations with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e121" xlink:type="simple"/></inline-formula> values 1 in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e122" xlink:type="simple"/></inline-formula>. Thus, after pre-computation of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e123" xlink:type="simple"/></inline-formula> values in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e124" xlink:type="simple"/></inline-formula> steps, the likelihood can be computed efficiently in only <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e125" xlink:type="simple"/></inline-formula> steps of constant time complexity.</p>
<sec id="s5b1">
<title>Parameter estimation in the model without errors</title>
<p>In the reduced model we know <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e126" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e127" xlink:type="simple"/></inline-formula> and we are interested only in estimating <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e128" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e129" xlink:type="simple"/></inline-formula>. In this case, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e130" xlink:type="simple"/></inline-formula> for all <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e131" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e132" xlink:type="simple"/></inline-formula>, and the log likelihood reads<disp-formula id="pcbi.1003503.e133"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003503.e133" xlink:type="simple"/><label>(3)</label></disp-formula>The maximum likelihood parameter estimates are given by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e134" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e135" xlink:type="simple"/></inline-formula>.</p>
</sec><sec id="s5b2">
<title>Parameter estimation in the model with errors</title>
<p>By Proposition (1), we have that for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e136" xlink:type="simple"/></inline-formula> the parameters in the full model are identifiable (<xref ref-type="supplementary-material" rid="pcbi.1003503.s015">Text S1</xref>). For maximum likelihood estimation, we propose an EM algorithm (<xref ref-type="sec" rid="pcbi-1003503-box001">Box 1</xref> and <xref ref-type="supplementary-material" rid="pcbi.1003503.s015">Text S1</xref>). In our analysis, we set the input arguments to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e137" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e138" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e139" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e140" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e141" xlink:type="simple"/></inline-formula>. The algorithm utilizes the estimates of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e142" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e143" xlink:type="simple"/></inline-formula> parameters from the reduced mutual exclusivity model (assuming no errors) as educated guesses for initialization. In the E-step, five expected values are computed in constant time for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e144" xlink:type="simple"/></inline-formula> values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e145" xlink:type="simple"/></inline-formula>. One reason for this computational efficiency is the assumption that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e146" xlink:type="simple"/></inline-formula> (<xref ref-type="supplementary-material" rid="pcbi.1003503.s015">Text S1</xref>). The M-step is performed in constant time. After <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e147" xlink:type="simple"/></inline-formula> initial pre-computing steps, computation of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e148" xlink:type="simple"/></inline-formula> is only <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e149" xlink:type="simple"/></inline-formula>, and therefore the complexity of the entire algorithm is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e150" xlink:type="simple"/></inline-formula>. We expect that, as for all mutually exclusive patterns so far observed in the literature, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e151" xlink:type="simple"/></inline-formula> holds. Thus, our algorithm gives a significant reduction in run time of EM in the usual case, where computations need to be performed for all observations, and where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e152" xlink:type="simple"/></inline-formula> would replace <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e153" xlink:type="simple"/></inline-formula> in the complexity. Increasing difficulty of the estimation problem (from both error rates given to unknown, <xref ref-type="supplementary-material" rid="pcbi.1003503.s014">Table S7</xref>) for the same <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e154" xlink:type="simple"/></inline-formula> and fixed <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e155" xlink:type="simple"/></inline-formula>, increases the run time, due to larger number of iterations performed (from 21 to 1033 on average). In the case where the data is generated with errors, and the error rates <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e156" xlink:type="simple"/></inline-formula> or <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e157" xlink:type="simple"/></inline-formula> are known, we use the same EM algorithm for estimating the remaining parameters but fix the given values in the M-step.</p>
<boxed-text id="pcbi-1003503-box001" position="float">
<p><bold>Box 1.</bold> EM for Mutual Exclusivity Model.</p>
<list list-type="simple">
<list-item>
 <p><bold>Input:</bold> initialization parameters <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e158" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e159" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e160" xlink:type="simple"/></inline-formula>,</p>
</list-item><list-item>
 <p> iteration parameters <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e161" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e162" xlink:type="simple"/></inline-formula>;</p>
</list-item><list-item>
 <p><bold>Output:</bold> Parameter estimates <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e163" xlink:type="simple"/></inline-formula></p>
</list-item><list-item>
 <p> Estimate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e164" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e165" xlink:type="simple"/></inline-formula> from the reduced mutual exclusivity model</p>
</list-item><list-item>
 <p> Draw at random <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e166" xlink:type="simple"/></inline-formula> initial parameter settings: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e167" xlink:type="simple"/></inline-formula>,</p>
</list-item><list-item>
 <p> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e168" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e169" xlink:type="simple"/></inline-formula></p>
</list-item><list-item>
 <p> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e170" xlink:type="simple"/></inline-formula>; <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e171" xlink:type="simple"/></inline-formula>;</p>
</list-item><list-item>
 <p> <bold>while</bold> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e172" xlink:type="simple"/></inline-formula> &amp; <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e173" xlink:type="simple"/></inline-formula>{</p>
</list-item><list-item>
 <p>    <bold>E-step: for</bold> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e174" xlink:type="simple"/></inline-formula></p>
</list-item></list>
 <p><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e175" xlink:type="simple"/></inline-formula></p>
 <p><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e176" xlink:type="simple"/></inline-formula></p>
 <p><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e177" xlink:type="simple"/></inline-formula></p>
 <p><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e178" xlink:type="simple"/></inline-formula></p>
 <p><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e179" xlink:type="simple"/></inline-formula></p>
<list list-type="simple">
<list-item>
 <p>    <bold>M-step:</bold></p>
</list-item></list>
 <p><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e180" xlink:type="simple"/></inline-formula></p>
 <p><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e181" xlink:type="simple"/></inline-formula></p>
 <p><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e182" xlink:type="simple"/></inline-formula></p>
 <p><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e183" xlink:type="simple"/></inline-formula></p>
 <p><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e184" xlink:type="simple"/></inline-formula></p>
 <p><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e185" xlink:type="simple"/></inline-formula></p>
 <p><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e186" xlink:type="simple"/></inline-formula></p>
<list list-type="simple">
<list-item>
 <p> }</p>
</list-item><list-item>
 <p> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e187" xlink:type="simple"/></inline-formula></p>
</list-item></list>
</boxed-text></sec><sec id="s5b3">
<title>Independence model</title>
<p>The independence model assumes all genes are mutated independently. Each gene <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e188" xlink:type="simple"/></inline-formula> has individual alteration probability <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e189" xlink:type="simple"/></inline-formula>, and the vector <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e190" xlink:type="simple"/></inline-formula> parametrizes the model (<xref ref-type="fig" rid="pcbi-1003503-g001">Figure 1C</xref>). Let <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e191" xlink:type="simple"/></inline-formula> denote the number of patients with alteration in gene <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e192" xlink:type="simple"/></inline-formula>. With log likelihood<disp-formula id="pcbi.1003503.e193"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003503.e193" xlink:type="simple"/><label>(4)</label></disp-formula>the maximum likelihood parameter values are given by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e194" xlink:type="simple"/></inline-formula>.</p>
</sec><sec id="s5b4">
<title>Testing for mutual exclusivity</title>
<p>The mutual exclusivity and independence models are not nested. To compare their likelihoods for a given dataset <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e195" xlink:type="simple"/></inline-formula>, we compute the Vuong's statistic <xref ref-type="bibr" rid="pcbi.1003503-Vuong1">[16]</xref> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e196" xlink:type="simple"/></inline-formula>, defined by the standardized and corrected log-likelihood ratio:<disp-formula id="pcbi.1003503.e197"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003503.e197" xlink:type="simple"/><label>(5)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e198" xlink:type="simple"/></inline-formula> (<xref ref-type="disp-formula" rid="pcbi.1003503.e117">equation 1</xref>) and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e199" xlink:type="simple"/></inline-formula> (<xref ref-type="disp-formula" rid="pcbi.1003503.e193">equation 4</xref>) are the observed log likelihoods of the data <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e200" xlink:type="simple"/></inline-formula> for the maximum likelihood parameter estimates <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e201" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e202" xlink:type="simple"/></inline-formula> under the mutual exclusivity and independence model, respectively, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e203" xlink:type="simple"/></inline-formula> is the standard deviation of the log likelihood ratios across observations. The second term is a correction for the difference in the numbers of free parameters in the models. For non-nested models <xref ref-type="bibr" rid="pcbi.1003503-Vuong1">[16]</xref>, their <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e204" xlink:type="simple"/></inline-formula> has normal distribution <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e205" xlink:type="simple"/></inline-formula> with mean 0 and variance 1, and equals <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e206" xlink:type="simple"/></inline-formula> when the models have equal Kullback-Leiber divergence from the true model generating the data <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e207" xlink:type="simple"/></inline-formula>. Thus, the ME test p-value is given by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e208" xlink:type="simple"/></inline-formula>.</p>
</sec></sec><sec id="s5c">
<title>Compared methods</title>
<p>For a given set of genes <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e209" xlink:type="simple"/></inline-formula>, the mutual exclusivity weight <xref ref-type="bibr" rid="pcbi.1003503-Vandin1">[4]</xref> is defined as<disp-formula id="pcbi.1003503.e210"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003503.e210" xlink:type="simple"/></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e211" xlink:type="simple"/></inline-formula> is the number of samples with at least one alteration in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e212" xlink:type="simple"/></inline-formula>. To assess significance of the weight, a permutation test is performed with the weight as test statistic, and the null distribution is obtained by independently permuting alterations 1000 times for each gene (each column in the dataset), preserving its alteration frequency.</p>
<p>A summary of this paper appears in the proceedings of the RECOMB 2014 conference, April 2–5 [26].</p></sec></sec><sec id="s6">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1003503.s001" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003503.s001" position="float" xlink:type="simple"><label>Figure S1</label><caption>
<p><bold>Computation of mutual exclusivity weight can be severely biased by errors in the data.</bold> Left plot: mutual exclusivity weight, proposed by Vandin and colleagues <xref ref-type="bibr" rid="pcbi.1003503-Vandin1">[4]</xref>, for datasets simulated from the mutual exclusivity model without errors. In this case, the observed weight (weight computed on observed data) is the same as the true weight (weight computed on true data, i.e., with true alteration status recorded), and increases with coverage and decreases with impurity. Arrow points at one example pair of datasets, indicating how they are ranked by the true weight. Middle: addition of false negatives decreases the observed weight (here, computed on the observed, erroneous dataset, and not based on the true alteration status), but has a consistent effect and does not disturb the ranking. Right: addition of false positives has most severe effect on ranking using the observed weight. An arrow points at two datasets, which based on the true weight (i.e. computed on data recording true alteration status, as in the left plot) were ordered increasingly, and which are now reverse-ordered by the observed weight.</p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003503.s002" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003503.s002" position="float" xlink:type="simple"><label>Figure S2</label><caption>
<p><bold>Both our mutual exclusivity (ME) test and a permutation test, which was applied previously do not support mutual exclusivity in data generated from the independence model with independent frequencies distributed as in the glioblastoma dataset.</bold> Shown are log p-values for simulated data with 1000 patients, 20 datasets per each gene set size (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e213" xlink:type="simple"/></inline-formula>).</p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003503.s003" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003503.s003" position="float" xlink:type="simple"><label>Figure S3</label><caption>
<p><bold>Imbalance of patterns identified with the ME approach is much lower than of patterns identified using the previously proposed weight.</bold> Box-plots summarize the imbalance distribution for 11 patterns called significant with ME p-value <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e214" xlink:type="simple"/></inline-formula>, high coverage (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e215" xlink:type="simple"/></inline-formula>) and low impurity (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e216" xlink:type="simple"/></inline-formula>; red), as well as the 10, 100, and 1000 top patterns with the largest weight, called significant with permutation test (p-value <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e217" xlink:type="simple"/></inline-formula>). Median imbalance of patterns prioritized using our approach is around three times lower than of patterns with top, significant weights, regardless of how many of the top ones are considered.</p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003503.s004" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003503.s004" position="float" xlink:type="simple"><label>Figure S4</label><caption>
<p><bold>Parameter estimation in the reduced mutual exclusivity model can be severely biased by errors in the data.</bold> Left column: the difference between the true and the estimated parameter values for datasets simulated from the mutual exclusivity model without errors. In this case, both impurity (delta; top) and coverage (gamma; bottom) estimation is very accurate, regardless the impurity (marked with colors). The true coverage values are indicated on the x-axis. Middle column: addition of false negatives results in underestimation of the coverage parameter. Right column: addition of false positives results in underestimation of both the impurity and coverage parameters, and most strongly affects estimation of low coverage values.</p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003503.s005" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003503.s005" position="float" xlink:type="simple"><label>Figure S5</label><caption>
<p><bold>Efficient parameter estimation of the coverage parameter </bold><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e218" xlink:type="simple"/></inline-formula><bold> and the impurity parameter </bold><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e219" xlink:type="simple"/></inline-formula><bold>, using the EM algorithm, from data generated from the mutual exclusivity model with error rates that were given to the model.</bold> The tested true parameter values were fixed to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e220" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e221" xlink:type="simple"/></inline-formula> (20 datasets with 5 genes and 1000 patients were simulated per each parameter setting). There are different box plots of estimated parameter values for different true values. The medians of the estimated values are close to the true values, marked with red dashed lines.</p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003503.s006" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003503.s006" position="float" xlink:type="simple"><label>Figure S6</label><caption>
<p><bold>Difficulties in estimating the full set of parameters.</bold> We applied our EM algorithm to estimate the coverage parameter <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e222" xlink:type="simple"/></inline-formula>, the impurity parameter <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e223" xlink:type="simple"/></inline-formula>, as well as false positive <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e224" xlink:type="simple"/></inline-formula> and false negative rate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e225" xlink:type="simple"/></inline-formula>, from data generated from the mutual exclusivity model with error rates that were not given to the model, using increasing sample size. The tested parameter values were fixed to realistic values <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e226" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e227" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e228" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e229" xlink:type="simple"/></inline-formula>. 20 datasets with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e230" xlink:type="simple"/></inline-formula> genes and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e231" xlink:type="simple"/></inline-formula> from 1000 (1 K) to 100000 patients (100 K) were simulated. Estimation accuracy increases with sample size.</p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003503.s007" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003503.s007" position="float" xlink:type="simple"><label>Figure S7</label><caption>
<p><bold>More accurate parameter estimation assuming false negative rate </bold><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e232" xlink:type="simple"/></inline-formula><bold>.</bold> <bold>A</bold> Estimation of parameters <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e233" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e234" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e235" xlink:type="simple"/></inline-formula> from data generated from the mutual exclusivity model accounting for false positives (false positive rate was not given to the model). The tested parameter values were fixed to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e236" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e237" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e238" xlink:type="simple"/></inline-formula>. <bold>B</bold> The estimation is more difficult when <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e239" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e240" xlink:type="simple"/></inline-formula> are similar (for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e241" xlink:type="simple"/></inline-formula>). <bold>C</bold> Similarity of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e242" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e243" xlink:type="simple"/></inline-formula> is less of a problem for larger gene sets (here, 10 genes), as well as when more samples are used (not shown). All plots: results on simulations of 20 datasets with 5 genes and 1000 patients per each parameter setting.</p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003503.s008" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003503.s008" position="float" xlink:type="simple"><label>Table S1</label><caption>
<p><bold>Root mean squared error (RMSE) of parameter estimation for different model variants and sample sizes.</bold> To determine a reasonable dataset size for the different model variants, we tracked the RMSE of parameter estimates for sample sizes 200 and 1000, with typical parameter settings: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e244" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e245" xlink:type="simple"/></inline-formula> and error rates as indicated in the column “True error rates”. 20 datasets with 5 genes and the number of patients indicated in column “<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e246" xlink:type="simple"/></inline-formula>” were simulated from the models per each parameter setting. RMSE was chosen to represent the difficulty of the estimation task as a function of the sample size. For example, for the reduced model that assumes no errors, we have derived closed-form expressions for the maximum likelihood parameter values. Thus, in this case, RMSE of parameter estimates depends only on random variation in the data and defines the best you can get reference for the remaining models, where parameter estimation is more difficult and performed using EM. Since both the ME model likelihood and the test largely depend on how accurately the parameters are estimated, RMSE defines the applicability of the approach.</p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003503.s009" xlink:href="info:doi/10.1371/journal.pcbi.1003503.s009" mimetype="text/plain" position="float" xlink:type="simple"><label>Table S2</label><caption>
<p><bold>List of high quality, significant gene sets of size four identified in the GBM dataset.</bold></p>
<p>(TXT)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003503.s010" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003503.s010" position="float" xlink:type="simple"><label>Table S3</label><caption>
<p><bold>Results for mutually exclusive patterns identified in the glioblastoma dataset by previous studies.</bold> Analyzed genes are written in bold, to distinguish from genes that were filtered out in preprocessing steps. Publication: the study in which the gene set was identified as mutually exclusive. Other results are given as in <xref ref-type="table" rid="pcbi-1003503-t001">Table 1</xref>. *from this gene set, only TP53 passed the pre-filtering step, and thus no results are available.</p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003503.s011" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003503.s011" position="float" xlink:type="simple"><label>Table S4</label><caption>
<p><bold>Sets of genes that had identical columns in the combined pan-cancer data matrix and their short names used in the main text.</bold> Genes with identical columns in the combined and binarized pan-cancer data matrix were merged into sets and represented by a single column. The table lists those merged gene sets that are involved in top mutually exclusive patterns identified for the pan-cancer data.</p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003503.s012" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003503.s012" position="float" xlink:type="simple"><label>Table S5</label><caption>
<p><bold>List of high quality, significant gene sets of size five identified in the pan-cancer dataset.</bold></p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003503.s013" xlink:href="info:doi/10.1371/journal.pcbi.1003503.s013" mimetype="text/plain" position="float" xlink:type="simple"><label>Table S6</label><caption>
<p><bold>Summary of top patterns identified for the pan-cancer dataset assuming false positives.</bold> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e247" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e248" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e249" xlink:type="simple"/></inline-formula> p-value: coverage and impurity estimates, and the p-value from the reduced mutual exclusivity model, assuming no errors in the data. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e250" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e251" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003503.e252" xlink:type="simple"/></inline-formula>, ME p-value: parameter estimates and p-value from the mutual exclusivity model accounting for false positives.</p>
<p>(TXT)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003503.s014" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003503.s014" position="float" xlink:type="simple"><label>Table S7</label><caption>
<p><bold>Average runtime of the EM algorithm in CPU seconds.</bold> The table presents average runtimes of parameter estimation using the EM algorithm averaged over the datasets simulated and summarized in <xref ref-type="supplementary-material" rid="pcbi.1003503.s008">Table S1</xref>. The runtime increases with the difficulty of the parameter estimation problem.</p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003503.s015" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003503.s015" position="float" xlink:type="simple"><label>Text S1</label><caption>
<p><bold>Supplementary Methods.</bold> Likelihood in the mutual exclusivity model, identifiability of the mutual exclusivity model, and derivation of the Expectation Maximization algorithm.</p>
<p>(PDF)</p>
</caption></supplementary-material></sec></body>
<back><ref-list>
<title>References</title>
<ref id="pcbi.1003503-TCGA1"><label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple"><collab xlink:type="simple">TCGA</collab> (<year>2008</year>) <article-title>Comprehensive genomic characterization defines human glioblastoma genes and core pathways</article-title>. <source>Nature</source> <volume>455</volume>: <fpage>1061</fpage>–<lpage>1068</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003503-Garraway1"><label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Garraway</surname><given-names>LA</given-names></name>, <name name-style="western"><surname>Lander</surname><given-names>ES</given-names></name> (<year>2013</year>) <article-title>Lessons from the Cancer Genome</article-title>. <source>Cell</source> <volume>153</volume>: <fpage>17</fpage>–<lpage>37</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003503-Miller1"><label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Miller</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Settle</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Sulman</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Aldape</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Milosavljevic</surname><given-names>A</given-names></name> (<year>2011</year>) <article-title>Discovering functional modules by identifying recurrent and mutually exclusive mutational patterns in tumors</article-title>. <source>BMC Medical Genomics</source> <volume>4</volume>: <fpage>34+</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003503-Vandin1"><label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Vandin</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Upfal</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Raphael</surname><given-names>BJ</given-names></name> (<year>2012</year>) <article-title><italic>De Novo</italic> discovery of mutated driver pathways in cancer</article-title>. <source>Genome Res</source> <volume>22</volume>: <fpage>375</fpage>–<lpage>385</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003503-Zhao1"><label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zhao</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Zhang</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Wu</surname><given-names>LY</given-names></name>, <name name-style="western"><surname>Zhang</surname><given-names>XS</given-names></name> (<year>2012</year>) <article-title>Efficient methods for identifying mutated driver pathways in cancer</article-title>. <source>Bioinformatics</source> <volume>28</volume>: <fpage>2940</fpage>–<lpage>2947</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003503-Ciriello1"><label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ciriello</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Cerami</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Sander</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Schultz</surname><given-names>N</given-names></name> (<year>2012</year>) <article-title>Mutual exclusivity analysis identifies oncogenic network modules</article-title>. <source>Genome research</source> <volume>22</volume>: <fpage>398</fpage>–<lpage>406</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003503-Leiserson1"><label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Leiserson</surname><given-names>MDM</given-names></name>, <name name-style="western"><surname>Blokh</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Sharan</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Raphael</surname><given-names>BJ</given-names></name> (<year>2013</year>) <article-title>Simultaneous Identification of Multiple Driver Pathways in Cancer</article-title>. <source>PLoS Comput Biol</source> <volume>9</volume>: <fpage>e1003054+</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003503-Yeang1"><label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yeang</surname><given-names>CH</given-names></name>, <name name-style="western"><surname>Mccormick</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Levine</surname><given-names>A</given-names></name> (<year>2008</year>) <article-title>Combinatorial patterns of somatic gene mutations in cancer</article-title>. <source>FASEB J</source> <volume>22</volume>: <fpage>2605</fpage>–<lpage>2622</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003503-Sparks1"><label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sparks</surname><given-names>AB</given-names></name>, <name name-style="western"><surname>Morin</surname><given-names>PJ</given-names></name>, <name name-style="western"><surname>Vogelstein</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Kinzler</surname><given-names>KW</given-names></name> (<year>1998</year>) <article-title>Mutational analysis of the APC/betacatenin/Tcf pathway in colorectal cancer</article-title>. <source>Cancer Res</source> <volume>58</volume>: <fpage>1130</fpage>–<lpage>1134</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003503-Rajagopalan1"><label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rajagopalan</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Bardelli</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Lengauer</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Kinzler</surname><given-names>KW</given-names></name>, <name name-style="western"><surname>Vogelstein</surname><given-names>B</given-names></name>, <etal>et al</etal>. (<year>2002</year>) <article-title>Tumorigenesis: RAF/RAS oncogenes and mismatch-repair status</article-title>. <source>Nature</source> <volume>418</volume>: <fpage>934</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003503-Masica1"><label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Masica</surname><given-names>DL</given-names></name>, <name name-style="western"><surname>Karchin</surname><given-names>R</given-names></name> (<year>2011</year>) <article-title>Correlation of somatic mutation and expression identifies genes important in human glioblastoma progression and survival</article-title>. <source>Cancer Research</source> <volume>71</volume>: <fpage>4550</fpage>–<lpage>4561</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003503-Szczurek1"><label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Szczurek</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Misra</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Vingron</surname><given-names>M</given-names></name> (<year>2013</year>) <article-title>Synthetic sickness or lethality points at candidate combination therapy targets in glioblastoma</article-title>. <source>International Journal of Cancer</source> <volume>133</volume>: <fpage>2123</fpage>–<lpage>2132</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003503-Cibulskis1"><label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cibulskis</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Lawrence</surname><given-names>MS</given-names></name>, <name name-style="western"><surname>Carter</surname><given-names>SL</given-names></name>, <name name-style="western"><surname>Sivachenko</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Jaffe</surname><given-names>D</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>Sensitive detection of somatic point mutations in impure and heterogeneous cancer samples</article-title>. <source>Nat Biotech</source> <volume>31</volume>: <fpage>213</fpage>–<lpage>219</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003503-Brennan1"><label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Brennan</surname><given-names>CW</given-names></name>, <name name-style="western"><surname>Verhaak</surname><given-names>RGW</given-names></name>, <name name-style="western"><surname>McKenna</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Campos</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Noushmehr</surname><given-names>H</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>The Somatic Genomic Landscape of Glioblastoma</article-title>. <source>Cell</source> <volume>155</volume>: <fpage>462</fpage>–<lpage>477</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003503-Ciriello2"><label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ciriello</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Miller</surname><given-names>ML</given-names></name>, <name name-style="western"><surname>Aksoy</surname><given-names>BA</given-names></name>, <name name-style="western"><surname>Senbabaoglu</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Schultz</surname><given-names>N</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>Emerging landscape of oncogenic signatures across human cancers</article-title>. <source>Nat Genet</source> <volume>45</volume>: <fpage>1127</fpage>–<lpage>1133</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003503-Vuong1"><label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Vuong</surname><given-names>QH</given-names></name> (<year>1989</year>) <article-title>Likelihood ratio tests for model selection and non-nested hypotheses</article-title>. <source>Econometrica</source> <volume>57</volume>: <fpage>307</fpage>–<lpage>33</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003503-Zhang1"><label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zhang</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Samelson</surname><given-names>LE</given-names></name> (<year>2000</year>) <article-title>The role of membrane-associated adaptors in T cell receptor signalling</article-title>. <source>Semin Immunol</source> <volume>12</volume>: <fpage>35</fpage>–<lpage>41</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003503-Bruyns1"><label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bruyns</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Marie-Cardine</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Kirchgessner</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Sagolla</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Shevchenko</surname><given-names>A</given-names></name>, <etal>et al</etal>. (<year>1998</year>) <article-title>T cell receptor (TCR) interacting molecule (TRIM), a novel disulfide-linked dimer associated with the TCR-CD3-zeta complex, recruits intracellular signaling proteins to the plasma membrane</article-title>. <source>J Exp Med</source> <volume>188</volume>: <fpage>561</fpage>–<lpage>575</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003503-Zheng1"><label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zheng</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Ying</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Yan</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Kimmelman</surname><given-names>AC</given-names></name>, <name name-style="western"><surname>Hiller</surname><given-names>DJ</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>Pten and p53 converge on c-Myc to control differentiation, self-renewal, and transformation of normal and neoplastic stem cells in glioblastoma</article-title>. <source>Cold Spring Harb Symp Quant Biol</source> <volume>73</volume>: <fpage>427</fpage>–<lpage>437</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003503-Akervall1"><label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Akervall</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Bockmuhl</surname><given-names>U</given-names></name>, <name name-style="western"><surname>Petersen</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Yang</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Carey</surname><given-names>TE</given-names></name>, <etal>et al</etal>. (<year>2003</year>) <article-title>The gene ratios c-MYC:cyclin-dependent kinase (CDK)N2A and CCND1:CDKN2A correlate with poor prognosis in squamous cell carcinoma of the head and neck</article-title>. <source>Clin Cancer Res</source> <volume>9</volume>: <fpage>1750</fpage>–<lpage>1755</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003503-Zundel1"><label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zundel</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Schindler</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Haas-Kogan</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Koong</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Kaper</surname><given-names>F</given-names></name>, <etal>et al</etal>. (<year>2000</year>) <article-title>Loss of PTEN facilitates HIF-1-mediated gene expression</article-title>. <source>Genes Dev</source> <volume>14</volume>: <fpage>391</fpage>–<lpage>396</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003503-Song1"><label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Song</surname><given-names>MS</given-names></name>, <name name-style="western"><surname>Carracedo</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Salmena</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Song</surname><given-names>SJ</given-names></name>, <name name-style="western"><surname>Egia</surname><given-names>A</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Nuclear PTEN regulates the APC-CDH1 tumor-suppressive complex in a phosphatase-independent manner</article-title>. <source>Cell</source> <volume>144</volume>: <fpage>187</fpage>–<lpage>199</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003503-Getz1"><label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Getz</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Hoing</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Mesirov</surname><given-names>JP</given-names></name>, <name name-style="western"><surname>Golub</surname><given-names>TR</given-names></name>, <name name-style="western"><surname>Meyerson</surname><given-names>M</given-names></name>, <etal>et al</etal>. (<year>2007</year>) <article-title>Comment on “The consensus coding sequences of human breast and colorectal cancers”</article-title>. <source>Science</source> <volume>317</volume>: <fpage>1500</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003503-Beroukhim1"><label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Beroukhim</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Getz</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Nghiemphu</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Barretina</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Hsueh</surname><given-names>T</given-names></name>, <etal>et al</etal>. (<year>2007</year>) <article-title>Assessing the significance of chromosomal aberrations in cancer: methodology and application to glioma</article-title>. <source>Proc Natl Acad Sci USA</source> <volume>104</volume>: <fpage>20007</fpage>–<lpage>20012</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003503-Cerami1"><label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cerami</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Gao</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Dogrusoz</surname><given-names>U</given-names></name>, <name name-style="western"><surname>Gross</surname><given-names>BE</given-names></name>, <name name-style="western"><surname>Sumer</surname><given-names>SO</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>The cBio Cancer Genomics Portal: An Open Platform for Exploring Multidimensional Cancer Genomics Data</article-title>. <source>Cancer Discovery</source> <volume>2</volume>: <fpage>401</fpage>–<lpage>404</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003503-Szczurek2"><label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Szczurek</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Beerenwinkel</surname><given-names>N</given-names></name> (<year>2014</year>) <article-title>Modeling Mutual Exclusivity of Cancer Mutations</article-title>. <source>In: Research in Computational Molecular Biology, Springer</source>. pp <fpage>307</fpage>–<lpage>308</lpage>.</mixed-citation>
</ref>
</ref-list></back>
</article>