<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN">
<front>
<journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher></journal-meta>
<article-meta><article-id pub-id-type="publisher-id">10-PLCB-RA-2209R2</article-id><article-id pub-id-type="doi">10.1371/journal.pcbi.1000985</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline"><subject>Computational Biology/Molecular Dynamics</subject><subject>Computational Biology/Signaling Networks</subject><subject>Computational Biology/Systems Biology</subject><subject>Computer Science/Systems and Control Theory</subject></subj-group></article-categories><title-group><article-title>Analysis of Stochastic Strategies in Bacterial Competence: A Master Equation Approach</article-title><alt-title alt-title-type="running-head">Analysis of Stochastic Strategies in Bacteria</alt-title></title-group><contrib-group>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Dandach</surname><given-names>Sandra H.</given-names></name><xref ref-type="aff" rid="aff1"/></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Khammash</surname><given-names>Mustafa</given-names></name><xref ref-type="aff" rid="aff1"/><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
</contrib-group><aff id="aff1">          <addr-line>Department of Mechanical and Industrial Engineering, University of California, Santa Barbara, Santa Barbara, California, United States of America</addr-line>       </aff><contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Rao</surname><given-names>Christopher V.</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group><aff id="edit1">University of Illinois at Urbana-Champaign, United States of America</aff><author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">khammash@engineering.ucsb.edu</email></corresp>
<fn fn-type="con"><p>Conceived and designed the experiments: MK. Performed the experiments: SHD. Analyzed the data: SHD. Contributed reagents/materials/analysis tools: SHD. Wrote the paper: SHD.</p></fn>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn></author-notes><pub-date pub-type="collection"><month>11</month><year>2010</year></pub-date><pub-date pub-type="epub"><day>11</day><month>11</month><year>2010</year></pub-date><volume>6</volume><issue>11</issue><elocation-id>e1000985</elocation-id><history>
<date date-type="received"><day>11</day><month>5</month><year>2010</year></date>
<date date-type="accepted"><day>4</day><month>10</month><year>2010</year></date>
</history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2010</copyright-year><copyright-holder>Dandach, Khammash</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract>
<p>Competence is a transiently differentiated state that certain bacterial cells reach when faced with a stressful environment. Entrance into competence can be attributed to the excitability of the dynamics governing the genetic circuit that regulates this cellular behavior. Like many biological behaviors, entrance into competence is a stochastic event. In this case cellular noise is responsible for driving the cell from a vegetative state into competence and back. In this work we present a novel numerical method for the analysis of stochastic biochemical events and use it to study the excitable dynamics responsible for competence in <italic>Bacillus subtilis</italic>. Starting with a Finite State Projection (FSP) solution of the chemical master equation (CME), we develop efficient numerical tools for accurately computing competence probability. Additionally, we propose a new approach for the sensitivity analysis of stochastic events and utilize it to elucidate the robustness properties of the competence regulatory genetic circuit. We also propose and implement a numerical method to calculate the expected time it takes a cell to return from competence. Although this study is focused on an example of cell-differentiation in <italic>Bacillus subtilis</italic>, our approach can be applied to a wide range of stochastic phenomena in biological systems.</p>
</abstract><abstract abstract-type="summary"><title>Author Summary</title>
<p>When exposed to stress, organisms react by taking actions that help them protect their DNA. ComK protein is a key regulator which activates hundreds of genes, including the genes encoding the DNA-uptake and recombination systems. In <italic>Bacillus subtilis</italic>, stress in the environment activates a sequence of chemical reactions that, driven by cellular noise, stochastically increases the level of ComK in some bacterial cells driving them from their original vegetative state into a competent state. Entrance into and exit from competence are stochastic switching events that the cell undergoes. In this work, we present a novel numerical method that allows the analysis of stochastic events in biological systems. We illustrate our method by computing the probability with which <italic>Bacillus subtilis</italic> enters in competence. We also present a method to analyze the sensitivity of stochastic events. We use this method to study the sensitivity of the probability of entrance in competence with respect to various gene expressions and degradation rates. We finally present a numerical method to calculate the expected time it takes a cell to return from competence. Although we studied the competence regulatory genetic circuit, our approach can be applied to a variety of stochastic events in biological systems.</p>
</abstract><funding-group><funding-statement>The author acknowledges research funding from the National Science Foundation (<ext-link ext-link-type="uri" xlink:href="http://www.nsf.gov" xlink:type="simple">www.nsf.gov</ext-link>) through Grants ECCS-0835847 and ECCS-0802008 and the Institute for Collaborative Biotechnologies (<ext-link ext-link-type="uri" xlink:href="http://www.icb.ucsb.edu" xlink:type="simple">www.icb.ucsb.edu</ext-link>) through Grant DAAD19-03-D-0004 from the US Army Research Office. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="11"/></counts></article-meta>
</front>
<body><sec id="s1">
<title>Introduction</title>
<p>Competence is the ability of a cell, usually a bacterium, to bind and internalize transforming exogenous DNA. Under stressful environments, such as nutrient limitations, some cells enter competence while other cells commit irreversibly to sporulation. Entry in competence is a transient probabilistic event that facilitates copying of the exogenous DNA <xref ref-type="bibr" rid="pcbi.1000985-Graumann1">[1]</xref>, <xref ref-type="bibr" rid="pcbi.1000985-Maamar1">[2]</xref>. It has been shown that among a group of cells only a randomly chosen fraction enters in competence <xref ref-type="bibr" rid="pcbi.1000985-Grossman1">[3]</xref>, <xref ref-type="bibr" rid="pcbi.1000985-Losick1">[4]</xref>. Proper modeling and correctly accounting for noise in the model of this phenomenon is crucial to understanding the underlying biological explanation. The few cells that enter competence express a high concentration of the key regulator ComK, which activates hundreds of genes, including the genes encoding the DNA-uptake and recombination systems <xref ref-type="bibr" rid="pcbi.1000985-Berka1">[5]</xref>–<xref ref-type="bibr" rid="pcbi.1000985-Ogura1">[7]</xref>. Competence is understood as a bistability pattern <xref ref-type="bibr" rid="pcbi.1000985-Losick1">[4]</xref>, <xref ref-type="bibr" rid="pcbi.1000985-Dubnau1">[8]</xref> and the nonlinear system describing the competence regulatory circuit is an excitable dynamical system.</p>
<p>Auto-activation of the regulator ComK is responsible for the bistable response in competence development. Auto-activation of ComK, is essential and can be sufficient to generate a bistable expression pattern <xref ref-type="bibr" rid="pcbi.1000985-Smits1">[9]</xref>–<xref ref-type="bibr" rid="pcbi.1000985-Maamar2">[11]</xref>. Specifically, the concentration of an inducer must cross a certain threshold to start the positive feedback. Different experimental studies concluded that an auto activation of ComK is the only needed factor for bistability to occur in the expression of this protein <xref ref-type="bibr" rid="pcbi.1000985-Smits1">[9]</xref>, <xref ref-type="bibr" rid="pcbi.1000985-Maamar2">[11]</xref>, <xref ref-type="bibr" rid="pcbi.1000985-Ferrel1">[12]</xref>. In <xref ref-type="bibr" rid="pcbi.1000985-Smits1">[9]</xref>, Smits et. al discuss the factors that determine the required threshold for the activation of ComK and deduce that other transcription factors can raise or lower the threshold. Although many proteins are involved in the regulation of competence, there are two main proteins that play a major role. Süel et al. <xref ref-type="bibr" rid="pcbi.1000985-Sel1">[13]</xref> propose a deterministic model driven by an additive noise to describe the dynamics of competence regulation. We use the reduced order Stochastic Differential Equation model (SDE) presented in <xref ref-type="bibr" rid="pcbi.1000985-Sel1">[13]</xref> to develop a discrete stochastic model for competence. Calculating the probability and the expected time for entering and returning from competence, requires solving for the splitting probabilities and the first moment passage time. The problem of calculating the first passage time has been studied heavily in the literature for the stochastic difference equations, Fokker Planck equations and some special cases of the CME (separable kernels or single specie). For a detailed treatment of this topic see <xref ref-type="bibr" rid="pcbi.1000985-Kampen1">[14]</xref>–<xref ref-type="bibr" rid="pcbi.1000985-GWeiss2">[17]</xref> and references therein. Researchers usually use Monte-Carlo simulations to calculate the distribution of the first passage time when working with he CME (e.g. see <xref ref-type="bibr" rid="pcbi.1000985-BNawakowski1">[18]</xref> and references therein). We propose in this work, an alternative approach that makes it possible to calculate the states in which the system will be as time evolves. The main idea here is to aggregate regions of the state space over which specie evolve into absorbing states. This technique is useful in analytically computing the distribution of the first passage time, by providing a way to deal with the infinite dimension of the state space over which the system evolves.</p>
<p>The contributions of this paper are threefold. First, it provides a new method to calculate exact probabilities of biological phenomena where transient behaviors such as competence, which is the topic we chose to study here, occur. Second, it shows how to calculate sensitivities of the probabilities of passing to the transient state with respect to the system's parameters. Third, it gives a methodology to calculate the expected time that it takes a cell to return from its transient state. All these methods can be used to analyze any biological system that has the characteristic of switching between two states, while staying for a while in the unstable state.</p>
<p>In this paper we start by describing the chemical reactions and the deterministic model. We then generate the Chemical Master Equation (CME) of our proposed discrete stochastic model. The CME characterizes the evolution of the probability density of the different discrete states. We simulate it using the Stochastic Simulation Algorithm (SSA) and show how the solution can be approximated using the Finite State Projection method (FSP). We then conduct a sensitivity analysis studying the effect that the various system parameters have on the probability with which a cell enters in competence. This analysis shows the usefulness of our proposed numerical method in analyzing the roles of the different affinity, transcription and degradation rates, etc., in driving the cellular switching (between competence and vegetative states in this case). Finally, we analyze the roles of these parameters in determining the expected time a cell stays in competence.</p>
</sec><sec id="s2" sec-type="materials|methods">
<title>Materials and Methods</title>
<p>We introduce at the beginning the modeling techniques used to propose a set of equations that capture the behavior of interest. We then present our discrete stochastic Chemical Master Equation (CME) model, followed by the Stochastic Simulation Algorithm (SSA) used to approximate the solution of the CME. We proceed to present our Finite State Projection based method that makes it possible to analyze the CME exactly. We show how such a method can be tailored to answer many questions of biological interest.</p>
<sec id="s2a">
<title>Deterministic model and chemical reactions</title>
<p>Competence is a physiological state that enables cells to bind and internalize transforming DNA. This state is accompanied by blockage of the essential cell's functions, and since this state is driven by the transcriptional factor ComK, it is no surprise that ComK synthesis is subject to a number of finely tuned regulatory circuits <xref ref-type="bibr" rid="pcbi.1000985-Turgay1">[19]</xref>. The gene regulatory model for competence has been presented and described in <xref ref-type="bibr" rid="pcbi.1000985-Sel1">[13]</xref>. Entrance of a cell in competence is controlled by a set of molecular interactions. Initially ComK and ComS are present in the cell at basal levels. The transcriptional factor ComK activates its own expression through positive feedback. The MecA complex is a multiprotein assembly that includes the ClpP-ClpC proteases. Bound to MecA, ComK is degraded under the action of the ClpP-ClpC proteases. In stressful environments, the level of ComS is high and that favors entrance into competence since ComS competes with ComK to bind to MecA. Inhibition of the binding of ComK to MecA by competitive binding with MecA-ComS allows a higher number of free ComK molecules to be present, which finally triggers the positive feedback that further raises the number of ComK molecules driving the cell in competence. This rise in the number of ComK is specific to competence. Once the number of ComK molecules reaches a certain level, it acts as an inhibitor for ComS through repression. The increase in the level of ComK will also favor the binding of MecA-ComK complex which degrades ComK through the ClpP-ClpC proteases, starting the return from competence. At this point ComS is below its basal level because of the aforementioned repression from ComK. The level of ComK starts to decrease by degradation. The degradation has two effects: (1) the decrease in the level of ComK will affect the transcriptional auto regulatory positive feedback loop of ComK, and (2) the absence of ComK in high levels, favors the synthesis of ComS by releasing the ComK-mediated ComS repression. This continues until the cell eventually exits the state of competence. The above mentioned molecular interactions are described <xref ref-type="bibr" rid="pcbi.1000985-Sel1">[13]</xref> by the following chemical reactions:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e001" xlink:type="simple"/></disp-formula><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e002" xlink:type="simple"/></disp-formula>The rate equations describing the dynamics of the molecular reactions between the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e003" xlink:type="simple"/></inline-formula> species model are the following:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e004" xlink:type="simple"/><label>(1)</label></disp-formula><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e005" xlink:type="simple"/><label>(2)</label></disp-formula><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e006" xlink:type="simple"/><label>(3)</label></disp-formula><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e007" xlink:type="simple"/><label>(4)</label></disp-formula>where K, S, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e008" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e009" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e010" xlink:type="simple"/></inline-formula> are the concentrations of ComK,ComS, MecA, MecA-ComK and MecA-ComS respectively. We give in <xref ref-type="table" rid="pcbi-1000985-t001">Table 1</xref> the values and the description of each of the parameters in Eq. 1–4.</p>
<table-wrap id="pcbi-1000985-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000985.t001</object-id><label>Table 1</label><caption>
<title>Parameter values as given in the literature.</title>
</caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1000985-t001-1" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000985.t001" xlink:type="simple"/><table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" colspan="3" rowspan="1">Parameter values</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">Parameter</td>
<td align="left" colspan="1" rowspan="1">Description</td>
<td align="left" colspan="1" rowspan="1">Value</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e011" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1">Basal expression rate of ComK</td>
<td align="left" colspan="1" rowspan="1">0.0028 nM/s</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e012" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1">Saturating expression rate of ComK positive feedback</td>
<td align="left" colspan="1" rowspan="1">0.049 nM/s</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e013" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1">Unrepressed expression rate of ComS</td>
<td align="left" colspan="1" rowspan="1">0.057 nM/s</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e014" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1">ComK concentration for half-maximal ComK activation</td>
<td align="left" colspan="1" rowspan="1">100 nM</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e015" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1">ComK concentration for half-maximal ComS repression</td>
<td align="left" colspan="1" rowspan="1">110 nM</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e016" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1">Unrepressed degradation rate of ComK</td>
<td align="left" colspan="1" rowspan="1">0.0014 <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e017" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e018" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1">Unrepressed degradation rate of ComS</td>
<td align="left" colspan="1" rowspan="1">0.0014 <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e019" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e020" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1">ComK concentration for half-maximal degradation</td>
<td align="left" colspan="1" rowspan="1">500 nM</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e021" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1">ComS concentration for half-maximal degradation</td>
<td align="left" colspan="1" rowspan="1">50 nM</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e022" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1">Hill coefficient of ComK positive feedback</td>
<td align="left" colspan="1" rowspan="1">2</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e023" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1">Hill coefficient of ComS repression by ComK</td>
<td align="left" colspan="1" rowspan="1">5</td>
</tr>
</tbody>
</table></alternatives></table-wrap>
<p>If one further assumes that the reactions of degradation of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e024" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e025" xlink:type="simple"/></inline-formula> are much faster than the other reactions, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e026" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e027" xlink:type="simple"/></inline-formula> can then be eliminated through time scale separation <xref ref-type="bibr" rid="pcbi.1000985-Sel1">[13]</xref>, <xref ref-type="bibr" rid="pcbi.1000985-Rao1">[20]</xref> and the conservation law:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e028" xlink:type="simple"/></disp-formula>giving the following reduced model for the dynamics of competence:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e029" xlink:type="simple"/><label>(5)</label></disp-formula><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e030" xlink:type="simple"/><label>(6)</label></disp-formula>where<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e031" xlink:type="simple"/></disp-formula>and<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e032" xlink:type="simple"/></disp-formula></p>
<p>In their paper Süel et al. <xref ref-type="bibr" rid="pcbi.1000985-Sel1">[13]</xref> analyze the excitable dynamical system described above. They present a phase diagram where they study the nullclines and the vector field of the dynamical system. Their analysis gives insight about the vegetative and competent states analyzed in this work. As we already stated, under the same conditions some cells enter into competence while other cells do not. Entry in competence is a random event, and in order to properly model the cell's behavior, we need to include the effect of noise on the dynamics of competence. In their analysis Süel et al. <xref ref-type="bibr" rid="pcbi.1000985-Sel1">[13]</xref> account for stochasticity by adding white gaussian noise terms in Eq. 6. This drives the excitable dynamical system presented in Eq. 5–6 into long excursions when the noise magnitude is large enough. These long excursions correspond to a high level of ComK indicating entry into a state of competence. The problem with this approach is that reaching a competent state is highly dependent on the magnitude of the additive noise. The dynamics of the system in Eq. 5–6 are such that if the initial number of molecules of ComK and ComS is in the neighborhood of the fixed point of the dynamical system described in Eq. 5–6, the number of molecules for both species will stay in the vicinity of that point without taking long excursions. If on the other hand, the number of molecules is driven beyond a threshold, the dynamical system in Eq. 5–6 will have a totally different behavior. The number of molecules of ComK will increase significantly because of ComK auto-activation through positive feedback; In other words, the cells will enter in competence. Here we would like to analyze the stochastic behavior of the dynamics of the competence regulatory circuit taking into account the internal noise in the environment of the cell without having a direct control on the magnitude of the noise driving the regulatory circuit. To do so, we model the stochasticity in the chemical reactions using the CME. We look at the problem at the molecular level and propose four reactions to model the system in Eq. 5–6. The four reactions are:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e033" xlink:type="simple"/><label>(7)</label></disp-formula>with the following reaction rates:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e034" xlink:type="simple"/></disp-formula><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e035" xlink:type="simple"/></disp-formula>These reactions will serve as the starting point for developing and simulating a discrete stochastic model for competence in the next section.</p>
</sec><sec id="s2b">
<title>Discrete stochastic model and analysis methods</title>
<p>In order to compute the probability of entering into competence we use the CME to describe the stochastic chemical kinetics. Once we derive the CME, we simulate it using the Monte-Carlo based SSA. We then use the FSP method to obtain a finite dimensional solution to the infinite dimensional CME. In the CME, the state vectors indicate the number of molecules of each of the two species of interest: ComK and ComS. The CME describes the evolution of the probability that the number of molecules of each of the species has a given value. The dynamics of the evolution of the probability density vector are directly related to the chemical reactions. Starting from a number of molecules <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e036" xlink:type="simple"/></inline-formula>, the probability of being at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e037" xlink:type="simple"/></inline-formula> molecules at time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e038" xlink:type="simple"/></inline-formula> has the following dynamics:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e039" xlink:type="simple"/><label>(8)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e040" xlink:type="simple"/></inline-formula> is the propensity vector and it represents the change that reaction <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e041" xlink:type="simple"/></inline-formula> will have on the number of molecules of each of the species. For example reaction <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e042" xlink:type="simple"/></inline-formula> increases ComK by one molecule and leaves the number of molecules of ComS unchanged so the propensity vector <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e043" xlink:type="simple"/></inline-formula> is <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e044" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e045" xlink:type="simple"/></inline-formula> denotes the probability that the reaction <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e046" xlink:type="simple"/></inline-formula> will occur in the next infinitesimal time interval <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e047" xlink:type="simple"/></inline-formula>. Written in vector form, the CME becomes<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e048" xlink:type="simple"/><label>(9)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e049" xlink:type="simple"/></inline-formula> corresponds to the number of reactions that the species would go through. Let <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e050" xlink:type="simple"/></inline-formula> be a vector of the possible states of the system. Let <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e051" xlink:type="simple"/></inline-formula> be the corresponding vector of probabilities of the states in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e052" xlink:type="simple"/></inline-formula> computed at time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e053" xlink:type="simple"/></inline-formula>. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e054" xlink:type="simple"/></inline-formula> evolves according to the equation<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e055" xlink:type="simple"/><label>(10)</label></disp-formula>In general, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e056" xlink:type="simple"/></inline-formula> may be infinite, resulting in an infinite dimensional system.</p>
</sec><sec id="s2c">
<title>Stochastic Simulation Algorithm</title>
<p>Getting the exact value for the solution to the CME is not generally an easy task. In this part we introduce the SSA that is normally used to simulate Eq. 9. The SSA is a Monte-Carlo based algorithm that generates sample paths for the underlying stochastic process. Gillespie introduced this algorithm in 1977 <xref ref-type="bibr" rid="pcbi.1000985-Gillespie1">[21]</xref>. Reactions are modeled as a random event whose occurrence depends in a non linear manner on the number of molecules through the reaction rates. The algorithm can be summarized as follows:</p>
<list list-type="order"><list-item>
<p><bold>Initialization:</bold> Initialize the number of molecules in the system as well as the reaction rates.</p>
</list-item><list-item>
<p><bold>Reaction:</bold> Generate random numbers that will correspond to a choice of a reaction. The probability of a reaction being chosen is proportional to the number of molecules involved in it.</p>
</list-item><list-item>
<p><bold>Number of molecules:</bold> Update the number of molecules that were involved in the reaction.</p>
</list-item><list-item>
<p><bold>Time:</bold> Update the time by the reaction time and repeat.</p>
</list-item></list>
<p>What we described above is a a basic summary of the algorithm, interested readers are referred to <xref ref-type="bibr" rid="pcbi.1000985-Gillespie1">[21]</xref> for more details.</p>
</sec><sec id="s2d">
<title>Finite State Projection</title>
<p>The CME derived in Eq. 9 describes the evolution of the probability density vector of the number of molecules. Using SSA to get an estimate of the probability of entering into competence is easy to implement. However, a large number of simulations is required for a reasonably accurate estimate to be obtained. Aside from being time consuming, the algorithm has the drawback of lacking an accurate bound on the estimation error. In addition, analyzing the effect that different parameters have on the probability with which a cell enters in competence, requires the repetition of a large number of SSA simulations while changing those parameters of interest. This is numerically very costly. An alternative method in dealing with the CME is to compute an analytical expression for the probability of being in each state. The FSP method introduced in <xref ref-type="bibr" rid="pcbi.1000985-Munsky1">[22]</xref> provides a way to compute these probabilities. The probability density vector described in Eq. 9 allows molecules to evolve on an infinite lattice (<xref ref-type="fig" rid="pcbi-1000985-g001">Fig. 1</xref>) and therefore gives an infinite dimensional system. The idea behind FSP is to choose a suitable subset of the lattice in which one retains all the states and chemical reactions (transitions) found in the original system, while aggregating the remaining states in the lattice into one absorbing state. Transitions that drive the states outside the region are retained, while those that allow return to the selected finite region are deleted (see <xref ref-type="fig" rid="pcbi-1000985-g001">Fig. 1</xref> for illustration). The finite state projection method gives the probability of being at any of the states inside the specified region at any point in time <xref ref-type="bibr" rid="pcbi.1000985-Munsky1">[22]</xref>. In this problem we are interested in finding the probability with which the pair (ComK,ComS) enters a region <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e057" xlink:type="simple"/></inline-formula> corresponding to the cell entering a state of competence. The sum of the probabilities of a cell being in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e058" xlink:type="simple"/></inline-formula> and of the probability of being anywhere else in the state space has to equal one at all times. Moreover, if we divide the state space of the two proteins ComK and ComS in two regions, then the probability of the cell being inside the first region without ever leaving it, and the probability of leaving the first region once within a time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e059" xlink:type="simple"/></inline-formula> should sum to one. These properties make FSP a very well suited numerical method to solve our problem.</p>
<fig id="pcbi-1000985-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000985.g001</object-id><label>Figure 1</label><caption>
<title>Projection of infinite lattice into a finite subspace.</title>
<p>The probability density vector evolves on an infinite integer lattice as shown by the arrows. A boundary region of interest is chosen (shown as a <italic>box</italic> in the figure). In this region all the reactions are maintained. Outside the region all the states are aggregated into one absorbing state, and the reactions leaving the region are maintained, while return from the outside to the inside of the region is prohibited by deletion of the reactions. We chose the maximum value of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e060" xlink:type="simple"/></inline-formula>, so that we detect the probability of leaving this boundary region within the reactions run time we are interested in.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000985.g001" xlink:type="simple"/></fig>
<p>In the finite model all the states outside the projection region are aggregated into one absorbing state: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e061" xlink:type="simple"/></inline-formula> (see <xref ref-type="fig" rid="pcbi-1000985-g001">Fig. 1</xref> for an illustration). The probability vector at time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e062" xlink:type="simple"/></inline-formula> is given as in Eq. 10 by<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e063" xlink:type="simple"/><label>(11)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e064" xlink:type="simple"/></inline-formula> is an infinite matrix and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e065" xlink:type="simple"/></inline-formula> is the initial distribution of the probabilities, that is a vector with infinite entries, where each entry corresponds to a probability with which the system starts with a given number of molecules. Using FSP we can project the infinite system in Eq. 11 into the following finite system:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e066" xlink:type="simple"/><label>(12)</label></disp-formula>In this case, <bold>A</bold> becomes a finite matrix, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e067" xlink:type="simple"/></inline-formula> is the finite vector of projected states. We build the finite matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e068" xlink:type="simple"/></inline-formula> as follows<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e069" xlink:type="simple"/></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e070" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e071" xlink:type="simple"/></inline-formula> are the terms appearing in Eq. 8. If <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e072" xlink:type="simple"/></inline-formula> denotes the underlying stochastic process, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e073" xlink:type="simple"/></inline-formula> gives the probability of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e074" xlink:type="simple"/></inline-formula> being in any of the states listed in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e075" xlink:type="simple"/></inline-formula> during the time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e076" xlink:type="simple"/></inline-formula>, conditioned on the event of never leaving the inside region for any time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e077" xlink:type="simple"/></inline-formula>. We can rewrite the probability as the conditional probability<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e078" xlink:type="simple"/><label>(13)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e079" xlink:type="simple"/></inline-formula> is the state to which the outside region <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e080" xlink:type="simple"/></inline-formula> is aggregated. Remember that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e081" xlink:type="simple"/></inline-formula> is an absorbing state. The probability of being inside the region <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e082" xlink:type="simple"/></inline-formula> without ever leaving it during the interval <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e083" xlink:type="simple"/></inline-formula> and the probability of visiting <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e084" xlink:type="simple"/></inline-formula> once should sum to one. Therefore<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e085" xlink:type="simple"/><label>(14)</label></disp-formula>Eq. 14 gives the probability of entering the region <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e086" xlink:type="simple"/></inline-formula> at least once within a time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e087" xlink:type="simple"/></inline-formula>. The boundary of the region that is aggregated into the absorbing state <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e088" xlink:type="simple"/></inline-formula>, is chosen to include the states with a high number of ComK molecules. This indicates that the systems reaching the absorbing state corresponds to the cell being in a state of competence. Denoting <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e089" xlink:type="simple"/></inline-formula> by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e090" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e091" xlink:type="simple"/></inline-formula> by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e092" xlink:type="simple"/></inline-formula> it can be seen that the probability of competence at time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e093" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e094" xlink:type="simple"/></inline-formula>, is given by<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e095" xlink:type="simple"/><label>(15)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e096" xlink:type="simple"/></inline-formula> is chosen so that the columns of the state transition matrix add up exactly to zero.</p>
</sec><sec id="s2e">
<title>FSP for competence sensitivity</title>
<p>One advantage of having an analytical solution of the probability of competence is that we can use the solution to run a sensitivity analysis with respect to different model parameters. This makes it possible to shed light on the importance and roles that the different parts of the regulatory circuit play in reaching competence.</p>
<p>We start this section by introducing the equations we used to compute the sensitivity for the probability with respect to all the parameters. We then compare answers obtained by this method to estimates of sensitivities that we obtained using a finite difference method.</p>
<p>Recall that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e097" xlink:type="simple"/></inline-formula> and suppose that we are interested in looking at the sensitivity of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e098" xlink:type="simple"/></inline-formula> with respect to a parameter <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e099" xlink:type="simple"/></inline-formula>, which could be any of the parameters presented in <xref ref-type="table" rid="pcbi-1000985-t001">Table 1</xref>. The <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e100" xlink:type="simple"/></inline-formula> entry in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e101" xlink:type="simple"/></inline-formula> is given by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e102" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e103" xlink:type="simple"/></inline-formula>, is an <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e104" xlink:type="simple"/></inline-formula> vector with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e105" xlink:type="simple"/></inline-formula> in the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e106" xlink:type="simple"/></inline-formula> entry and zero everywhere else. We have from Eq. 9 that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e107" xlink:type="simple"/></inline-formula>. Letting <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e108" xlink:type="simple"/></inline-formula> take values in the set of parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e109" xlink:type="simple"/></inline-formula>, and using the fact that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e110" xlink:type="simple"/></inline-formula>, we get that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e111" xlink:type="simple"/></inline-formula> where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e112" xlink:type="simple"/></inline-formula> is defined to be <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e113" xlink:type="simple"/></inline-formula>. Similar equations hold for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e114" xlink:type="simple"/></inline-formula>. The sensitivity of the probability with which a cell enters in competence evolves according to the following dynamical system:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e115" xlink:type="simple"/><label>(16)</label></disp-formula>Solving the above linear system, we obtain the sensitivity of the exit probability to all the parameters. We evaluate the solution at the nominal values given in <xref ref-type="table" rid="pcbi-1000985-t001">Table 1</xref>. The results are reported in <xref ref-type="table" rid="pcbi-1000985-t002">Table 2</xref>.</p>
<table-wrap id="pcbi-1000985-t002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000985.t002</object-id><label>Table 2</label><caption>
<title>Sensitivity of the probability of entering in competence.</title>
</caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1000985-t002-2" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000985.t002" xlink:type="simple"/><table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" colspan="6" rowspan="1">System sensitivity</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">Sens <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e116" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1">Sens <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e117" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1">Sens <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e118" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1">Sens <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e119" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1">Sens <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e120" xlink:type="simple"/></inline-formula></td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" colspan="1" rowspan="1">Method # 1</td>
<td align="left" colspan="1" rowspan="1">4.9931</td>
<td align="left" colspan="1" rowspan="1">8.4417</td>
<td align="left" colspan="1" rowspan="1">43.0166</td>
<td align="left" colspan="1" rowspan="1">−11.9632</td>
<td align="left" colspan="1" rowspan="1">−43.1321</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">Method # 2</td>
<td align="left" colspan="1" rowspan="1">4.9844</td>
<td align="left" colspan="1" rowspan="1">8.2370</td>
<td align="left" colspan="1" rowspan="1">42.3560</td>
<td align="left" colspan="1" rowspan="1">−11.9632</td>
<td align="left" colspan="1" rowspan="1">−43.0821</td>
</tr>
</tbody>
</table></alternatives><table-wrap-foot><fn id="nt101"><label/><p>This table shows the sensitivity of the probability of entering in competence, as each of the indicated parameter varies, when the remaining parameters are set to their nominal values given in <xref ref-type="table" rid="pcbi-1000985-t001">Table 1</xref>.</p></fn><fn id="nt102"><label/><p>Using method <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e121" xlink:type="simple"/></inline-formula>, we solve the higher order system earlier introduced in the text. Using method <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e122" xlink:type="simple"/></inline-formula>, we used the solutions of the probability of entering in competence to numerically estimate the sensitivity of the system to various parameters.</p></fn></table-wrap-foot></table-wrap>
<p>For comparison, we calculated the same terms computed above by using a finite difference method. The sensitivity of the probability of entering competence with respect to the various parameters is calculated according to the formula <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e123" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e124" xlink:type="simple"/></inline-formula> denotes the normalized sensitivity and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e125" xlink:type="simple"/></inline-formula> denotes the nominal value of the parameter of interest. In order to change study the sensitivity to each parameter, we update the value with small steps using the equation below<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e126" xlink:type="simple"/><label>(17)</label></disp-formula></p>
<p>In summary, the sensitivity results presented in <xref ref-type="table" rid="pcbi-1000985-t002">Table 2</xref> are calculated using two different methods:</p>
<p><italic>Method #1:</italic> We solve the double order system in Eq. 16. This results in more accurate answers but is more computationally expensive.</p>
<p><italic>Method #2:</italic> We use the solutions for the original system describing the evolution of the probabilities of the states presented in Eq. 15 in addition to the numerical approximation method presented in Eq. 17 with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e127" xlink:type="simple"/></inline-formula>. This method is less accurate than the first but is considerably faster to implement.</p>
</sec><sec id="s2f">
<title>FSP for expected duration of competence</title>
<p>We study here the time it takes for a cell to return from a state of competence to its original vegetative state. We use once again the analytical solution of the CME to conduct this analysis. We use a similar concept to the one explained earlier, with the difference that in this case, we aggregate into an absorbing state the region of the state space that corresponds to the vegetative state, indicating that the cell returned from competence. We also assume that the cell starts from a state of competence and that it is allowed to return from that state, i.e., competent states are no longer absorbing in this case. Starting from competence corresponds to starting from a pair (ComK,ComS) that falls anywhere in the region <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e128" xlink:type="simple"/></inline-formula>. We assume that the cell can be at any state in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e129" xlink:type="simple"/></inline-formula> equally likely. This assumption translates to setting the initial probability vector <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e130" xlink:type="simple"/></inline-formula> in a way that gives equal probability to all the states in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e131" xlink:type="simple"/></inline-formula>. Return from competence is mapped to the region defined by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e132" xlink:type="simple"/></inline-formula>. We set the initial probability vector to take the value <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e133" xlink:type="simple"/></inline-formula> at the entries corresponding to the states in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e134" xlink:type="simple"/></inline-formula> and zero everywhere else. Here <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e135" xlink:type="simple"/></inline-formula> is the cardinality of the competence region in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e136" xlink:type="simple"/></inline-formula>. Having defined a region <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e137" xlink:type="simple"/></inline-formula> to be the region in the state space corresponding to return from competence, we aggregate all the states of return from competence into one absorbing state <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e138" xlink:type="simple"/></inline-formula>. Hence, for the purpose of this calculation, once a trajectory ‘returns’ from competence, it cannot go back to it.</p>
<p>Having described the dynamics of the probability for return from competence in a similar manner to the description we had presented for the probability of entering in competence, we find the probability of returning from competence as a function of time by solving a set of differential equation just like we did earlier. We still need to deal with the infinite dimensions of the original model. For this purpose we add another absorbing state. This state is an aggregation of the region outside the finite state space that we consider, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e139" xlink:type="simple"/></inline-formula>, into a single state <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e140" xlink:type="simple"/></inline-formula>. The finite state space is chosen so that the probability of reaching <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e141" xlink:type="simple"/></inline-formula> in the time interval of interest remains small. This small probability gives an upper bound on the approximation error due to the reduction of the infinite system into a finite one, as can be seen in the FSP algorithm <xref ref-type="bibr" rid="pcbi.1000985-Munsky1">[22]</xref>. Define <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e142" xlink:type="simple"/></inline-formula> to be the probability of returning from competence within <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e143" xlink:type="simple"/></inline-formula>. Denote by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e144" xlink:type="simple"/></inline-formula>, the probability <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e145" xlink:type="simple"/></inline-formula> of returning from competence at time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e146" xlink:type="simple"/></inline-formula>, and by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e147" xlink:type="simple"/></inline-formula>, the probability <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e148" xlink:type="simple"/></inline-formula> of exiting to the outside region at time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e149" xlink:type="simple"/></inline-formula>.</p>
<p>The system becomes:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e150" xlink:type="simple"/><label>(18)</label></disp-formula></p>
<p>Now consider a partition of the interval <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e151" xlink:type="simple"/></inline-formula> as follows:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e152" xlink:type="simple"/></disp-formula>We can approximate the expected value of return time as follows:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e153" xlink:type="simple"/><label>(19)</label></disp-formula></p>
</sec></sec><sec id="s3">
<title>Results/Discussion</title>
<p>We applied SSA to both the full model presented in Eq. 1–4, as well as to the reduced model presented in Eq. 7. We say that a cell entered in competence when the pair <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e154" xlink:type="simple"/></inline-formula> enter in the region <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e155" xlink:type="simple"/></inline-formula>. SSA simulations start from a number of molecules for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e156" xlink:type="simple"/></inline-formula> and all runs simulate <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e157" xlink:type="simple"/></inline-formula> hours of molecular reactions. The initial number of molecules for ComK and ComS corresponds roughly to the mean steady state values of the reduced model. We are interested in studying the probability with which a cell enters in competence. For the return from competence analysis, we defined the region <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e158" xlink:type="simple"/></inline-formula>. A cell return trajectory is the one it takes when going from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e159" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e160" xlink:type="simple"/></inline-formula> (see <xref ref-type="fig" rid="pcbi-1000985-g002">Fig. 2</xref> for illustration). We should point out that the boundaries of the region may be selected regardless of their shape.</p>
<fig id="pcbi-1000985-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000985.g002</object-id><label>Figure 2</label><caption>
<title>Return time for a sample trajectory.</title>
<p>This figure shows how the regions were divided to compute the expected value of the time for which the cell remains in competence. The cross on the red rectangle is the start of the <italic>return trajectory</italic> of the cell from competence. The cross on the green rectangle is the end of the <italic>return trajectory</italic> to the vegetative state. We wish to calculate the expected time it takes for a cell to traverse such a trajectory.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000985.g002" xlink:type="simple"/></fig>
<p>In <xref ref-type="fig" rid="pcbi-1000985-g003">Fig. 3</xref> we show seven different SSA runs, for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e161" xlink:type="simple"/></inline-formula> hours each. It can be seen that two of the runs behave differently from the remaining five runs. The long excursions seen in <xref ref-type="fig" rid="pcbi-1000985-g003">Fig. 3</xref> correspond to a high number of ComK molecules, i.e., the state of competence. In <xref ref-type="fig" rid="pcbi-1000985-g004">Fig. 4</xref> we show one SSA run where both ComK and ComS concentrations were plotted. Competence is clear in this case, and it is detected by both the high level of ComK and the negative correlation between ComK and ComS corresponding to the negative feedback from ComK to ComS when the number of molecules of ComK is high. In <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e162" xlink:type="simple"/></inline-formula> SSA runs, we found that the cell entered in competence <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e163" xlink:type="simple"/></inline-formula> times, corresponding to an approximate probability <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e164" xlink:type="simple"/></inline-formula>. Using the <bold>Chernoff inequality</bold>, the accuracy in this case is described as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e165" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e166" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e167" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pcbi.1000985-Tempo1">[23]</xref>. Using the bound on <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e168" xlink:type="simple"/></inline-formula> and Equation 19, we find an upper bound on the error in the calculation of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e169" xlink:type="simple"/></inline-formula>.</p>
<fig id="pcbi-1000985-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000985.g003</object-id><label>Figure 3</label><caption>
<title>Seven SSA runs.</title>
<p>This figure shows seven different SSA simulation runs of the competence regulatory genetic circuit. Each run is shown by a different color. Long trajectories correspond to high levels of ComK indicating that the cell has entered in a state of competence. This figure illustrates the stochastic nature of competence, by showing that starting from the same initial conditions, only two out out of seven cells enter in competence.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000985.g003" xlink:type="simple"/></fig><fig id="pcbi-1000985-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000985.g004</object-id><label>Figure 4</label><caption>
<title>Single SSA run for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e170" xlink:type="simple"/></inline-formula> hours.</title>
<p>This figure shows a single SSA run. The high level of ComK (shown in <italic>blue</italic>), as well as the negative correlations between ComK and ComS (shown in <italic>red</italic>) is a characteristic of competence.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000985.g004" xlink:type="simple"/></fig>
<p>Using the FSP based method as described in Eq. 15, we find that the probability of entering in competence at least once in 40 hours is <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e171" xlink:type="simple"/></inline-formula>, this probability is calculated with an error of no more than <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e172" xlink:type="simple"/></inline-formula>.</p>
<sec id="s3a">
<title>Sensitivity of entrance in competence</title>
<p>Now that we presented the SSA, and FSP method, we first use the SSA algorithm to compare the reduced model in Eq. 5–6 to the full model in Eq. 1–4 both presented in <xref ref-type="bibr" rid="pcbi.1000985-Sel1">[13]</xref>. In order to do this, we simulate both models using SSA and compare the probability of entering in competence as the parameters presented in <xref ref-type="table" rid="pcbi-1000985-t001">Table 1</xref> were changed. We show the results for the parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e173" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e174" xlink:type="simple"/></inline-formula> for demonstration purposes, but we note that the behavior of the full and reduced model were very close for all the parameters. We then compare the results given by the SSA and the FSP method, when applied to the reduced model. We show in <xref ref-type="fig" rid="pcbi-1000985-g005">Figs. 5</xref> and <xref ref-type="fig" rid="pcbi-1000985-g006">6</xref>, these results.</p>
<fig id="pcbi-1000985-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000985.g005</object-id><label>Figure 5</label><caption>
<title>Probability of competence vs. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e175" xlink:type="simple"/></inline-formula>.</title>
<p>This figure shows the probability of entering in competence when <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e176" xlink:type="simple"/></inline-formula> is varied. The three plots show simulations from the full model using SSA (<italic>black</italic>), the reduced model using FSP (<italic>blue</italic>) and the reduced model using SSA (<italic>red</italic>). SSA results were generated by averaging over <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e177" xlink:type="simple"/></inline-formula> runs. For each data point, the error indicated by the errorbar is no larger than <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e178" xlink:type="simple"/></inline-formula> with a certainty no smaller than <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e179" xlink:type="simple"/></inline-formula>. This is to be compared to an upper bound of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e180" xlink:type="simple"/></inline-formula> when using FSP.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000985.g005" xlink:type="simple"/></fig><fig id="pcbi-1000985-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000985.g006</object-id><label>Figure 6</label><caption>
<title>Probability of competence vs. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e181" xlink:type="simple"/></inline-formula>.</title>
<p>This figure shows the probability of entering in competence when <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e182" xlink:type="simple"/></inline-formula> is varied. The three plots show simulations from the full model using SSA (<italic>black</italic>), the reduced model using FSP (<italic>blue</italic>) and the reduced model using SSA (<italic>red</italic>). SSA results were generated by averaging over <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e183" xlink:type="simple"/></inline-formula> runs. For each data point, the error indicated by the errorbar is no larger than <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e184" xlink:type="simple"/></inline-formula> with a certainty no smaller than <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e185" xlink:type="simple"/></inline-formula>. This is to be compared to an upper bound of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e186" xlink:type="simple"/></inline-formula> when using FSP.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000985.g006" xlink:type="simple"/></fig></sec><sec id="s3b">
<title>Expected duration of competence</title>
<p>We show next the insights our numerical methods allowed us to have about how the molecules involved in competence, affect the time a cell spends in this state. In <xref ref-type="fig" rid="pcbi-1000985-g007">Fig. 7</xref> we show how changing the parameter <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e187" xlink:type="simple"/></inline-formula> affects the time a cell stays in competence. This parameter corresponds to the saturation expression rate of the ComK positive feedback. The plot shows results obtained by both FSP and SSA. We can see that the plots exhibit similar behaviors, keeping in mind that such a calculation requires a lot more SSA simulations. In addition to giving more accurate results, the FSP approach allows us to combine multiple points from which we consider the cell as being in competence, while a different set of SSA simulations should be run for each different initial condition (starting number of molecules). Combining initial conditions is extremely useful in this case, since we care more about regions that the states go through than about specific points. It is not crucial to know the specific number of molecules of ComK or ComS when the cell is entering and returning from competence.</p>
<fig id="pcbi-1000985-g007" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000985.g007</object-id><label>Figure 7</label><caption>
<title>Expected time to return from competence vs. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e188" xlink:type="simple"/></inline-formula>.</title>
<p>This figure shows the expected value it takes for a cell that started from competence to return to its vegetative state as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e189" xlink:type="simple"/></inline-formula> varies. The results are obtained using FSP (<italic>blue line</italic>) and SSA (<italic>red line</italic>). SSA results were generated by averaging over <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e190" xlink:type="simple"/></inline-formula> runs. For each data point, the error indicated by the errorbar is no larger than <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e191" xlink:type="simple"/></inline-formula> with a certainty no smaller than <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e192" xlink:type="simple"/></inline-formula>. These results should be compared with the results obtained using FSP whose error has an upper bound of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e193" xlink:type="simple"/></inline-formula>.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000985.g007" xlink:type="simple"/></fig>
<p>We saw earlier that increasing <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e194" xlink:type="simple"/></inline-formula> will increase the probability of cells entering competence. We now know that it will also keep the cell in competence for a longer time. Competence is an exhausting but occasionally necessary state for the cell. In this work we develop the CME accounting properly for the internal noise driving the competence switching dynamical system. The stochastic behavior of cell switching to competence has been studied in the literature. For example in their work, Süel et al. <xref ref-type="bibr" rid="pcbi.1000985-Sel1">[13]</xref> account for the stochasticity by introducing an additive noise term to their model. The intensity of the noise and its distribution were parameters that are determined by the authors. In this work, we accounted for noise in its natural intrinsic form, eliminating therefore any controlled excitation of the excitable system.</p>
<p>We applied FSP to come up with an analytical solution, whereas other researchers always reverted to Monte-Carlo simulations, in their analysis. Finding an analytical solution made it possible for us to describe to a great extent the role of each of the molecules in driving cells into and out of competence. We discuss our results below.</p>
<p>We start by addressing the roles of the different expression and degradation rates in a cell entering competence. <xref ref-type="fig" rid="pcbi-1000985-g005">Fig. 5</xref> shows that an increase in the saturating expression rate of ComK positive feedback <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e195" xlink:type="simple"/></inline-formula> increases the probability of entering in competence. <xref ref-type="fig" rid="pcbi-1000985-g007">Fig. 7</xref> also shows that it makes returning from competence slower. Although <xref ref-type="fig" rid="pcbi-1000985-g005">Figs. 5</xref> and <xref ref-type="fig" rid="pcbi-1000985-g006">6</xref> show that ComK and ComS have similar roles in driving a cell into and back from competence, <xref ref-type="table" rid="pcbi-1000985-t002">Table 2</xref> suggests that changes in ComS affected by the values of the expression and degradation rates of ComS <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e196" xlink:type="simple"/></inline-formula> affect the probability of entering and staying in competence more than changes in ComK affected by the values of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e197" xlink:type="simple"/></inline-formula>. This leads to the expectation that the genetic circuits controlling ComS levels need to be much more sophisticated and complex than those regulating ComK in order to keep ComS concentration at specific values. Our normalized sensitivity analysis showed that increasing the basal expression rate <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e198" xlink:type="simple"/></inline-formula> and the saturating expression rate of ComK <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e199" xlink:type="simple"/></inline-formula> has an almost canceling effect to increasing the degradation rate of Comk <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e200" xlink:type="simple"/></inline-formula> as far as the probability of entering in competence is concerned. It also showed that the expression and degradation rates of ComS <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e201" xlink:type="simple"/></inline-formula>, had a similar canceling effect. This means that each of these molecules plays a dual role. As it turned out, while the expression rate of Comk drives the cell in competence, its degradation rate brings it back to its vegetative state. Similarly, a high concentration of ComS drives the cell in competence by competing over free MecA with ComK molecules, leaving more ComK molecules free. On the other hand, a decrease in ComS is necessary to return from competence as we will see next. This is true because low levels of ComS allow free MecA molecules to bind to ComK decreasing therefore the level of ComK molecules. We saw as well that high levels of ComK and ComS drive the cell into competence with probability 1. This is in agreement with experimental results reported in <xref ref-type="bibr" rid="pcbi.1000985-Leisner1">[24]</xref>, where Leisner et al use an approximate SDE model in which they account for noise by introducing an additive gaussian noise term, in contrast to our approach which uses CME directly.</p>
<p>We now study the roles of the different molecules in the return from competence. <xref ref-type="fig" rid="pcbi-1000985-g007">Figs. 7</xref> and <xref ref-type="fig" rid="pcbi-1000985-g008">8</xref> suggest that the degradation rate <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e202" xlink:type="simple"/></inline-formula> has a larger effect than <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e203" xlink:type="simple"/></inline-formula> when it comes to the expected time for which a cell stays in competence. We found similar results for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e204" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e205" xlink:type="simple"/></inline-formula>. This implies that once a cell is in a state of competence, the degradation rate acts fast bringing it back to its vegetative state. The degradation rate is faster than the rate at which the free molecules try to keep the cell in competence. <xref ref-type="fig" rid="pcbi-1000985-g008">Fig. 8</xref> suggests that increasing the value of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e206" xlink:type="simple"/></inline-formula> will decrease the time for which a cell stays in competence. We also know from <xref ref-type="table" rid="pcbi-1000985-t002">Table 2</xref> that an increase in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e207" xlink:type="simple"/></inline-formula> diminishes the probability with which <italic>Bacillus subtilis</italic> enters in competence. Our calculations also show that an increase in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e208" xlink:type="simple"/></inline-formula> has a similar effect to an increase in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e209" xlink:type="simple"/></inline-formula> in the sense that they both decrease the probability with which a cell enters in competence and the expected time it takes for a cell to return form competence. Recall that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e210" xlink:type="simple"/></inline-formula> is the degradation rate of ComK, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e211" xlink:type="simple"/></inline-formula> is the degradation rate of ComS. Also recall that whenever the number of ComS molecules is sufficiently small, more MecA molecules will be free to bind with ComK decreasing therefore the number of ComK molecules. Similarly, a higher ComK degradation rate, will lead to a decrease in the number of ComK molecules. A lower number of ComK molecules drive the cell back to its vegetative state and/or decreases its probability of entering in competence. This explains the similarity in the effect of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e212" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e213" xlink:type="simple"/></inline-formula> on the probability of entering competence and the expected return time.</p>
<fig id="pcbi-1000985-g008" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000985.g008</object-id><label>Figure 8</label><caption>
<title>Expected time to return from competence vs. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e214" xlink:type="simple"/></inline-formula>.</title>
<p>This figure shows the expected value it takes for a cell that started from competence to return to its vegetative state as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e215" xlink:type="simple"/></inline-formula> varies. The results are obtained using FSP (<italic>blue line</italic>) and SSA (<italic>red line</italic>). SSA results were generated by averaging over <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e216" xlink:type="simple"/></inline-formula> runs. For each data point, the error indicated by the errorbar is no larger than <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e217" xlink:type="simple"/></inline-formula> with a certainty no smaller than <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e218" xlink:type="simple"/></inline-formula>. These results should be compared with the results obtained using FSP whose error has an upper bound of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000985.e219" xlink:type="simple"/></inline-formula>.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000985.g008" xlink:type="simple"/></fig></sec><sec id="s3c">
<title>Conclusion</title>
<p>In this paper we developed a discrete stochastic model for competence in <italic>Bacillus subtilis</italic>. We performed simulations of the model using Monte Carlo based SSA and verified that the reduced order model gave a valid approximation of the full model. We then applied the recently developed FSP method to the reduced model and computed the probability of competence, where competence was defined in terms of a trajectory leaving a pre-defined region of the state space. Having the analytical solution, we were able to conduct a sensitivity analysis of the probability with which a cell enters in competence as the model parameters vary. We were also able to compute interesting terms such as the expected time it takes for a cell to return from competence.</p>
<p>This paper presented numerical methods that are applicable to many biological systems that exhibit a transient switching behavior. These methods were shown to be very useful in studying the genetic circuit regulating competence in a bacteria, and in answering questions about exact probabilities of stochastic events in this bistable biological behavior. They were also useful in studying sensitivities of these probabilities when expression rates, degradation rates, repression rates or activation rates of proteins were changed. Finally, the methods introduced in this paper showed how to calculate the expected time for return from transient states. Many other terms characterizing different transient physiological behaviors, such as the number of molecules that are most likely to enter in the transient states, and the return trajectories that are most likely to be taken can be computed using similar approaches to the one discussed here. Our approach should be easily extendible to analyze many biological system exhibiting a bistable switching behavior.</p>
</sec></sec></body>
<back><ref-list>
<title>References</title>
<ref id="pcbi.1000985-Graumann1"><label>1</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Graumann</surname><given-names>P</given-names></name>
</person-group>             <year>2006</year>             <article-title>Different genetic programmes within identical bacteria under identical conditions: the phemenon of bistability greatly modifies our view on bacterial population.</article-title>             <source>Mol Microbiol</source>             <volume>61</volume>             <fpage>560</fpage>             <lpage>563</lpage>          </element-citation></ref>
<ref id="pcbi.1000985-Maamar1"><label>2</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Maamar</surname><given-names>H</given-names></name>
<name name-style="western"><surname>Raj</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Dubnau</surname><given-names>D</given-names></name>
</person-group>             <year>2007</year>             <article-title>Noise in gene expression determines cell fate.</article-title>             <source>Science</source>             <volume>317</volume>             <fpage>526</fpage>             <lpage>529</lpage>          </element-citation></ref>
<ref id="pcbi.1000985-Grossman1"><label>3</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Grossman</surname><given-names>A</given-names></name>
</person-group>             <year>1995</year>             <article-title>Genetic networks controlling the initiation of sporulation and the development of genetic competence in bacillus subtilis.</article-title>             <source>Annu Rev Genet</source>             <volume>29</volume>             <fpage>477</fpage>             <lpage>508</lpage>          </element-citation></ref>
<ref id="pcbi.1000985-Losick1"><label>4</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Losick</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Desplan</surname><given-names>C</given-names></name>
</person-group>             <year>2008</year>             <article-title>Stochasticity and cell fate.</article-title>             <source>Science</source>             <volume>320</volume>             <fpage>65</fpage>             <lpage>68</lpage>          </element-citation></ref>
<ref id="pcbi.1000985-Berka1"><label>5</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Berka</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Hahn</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Albano</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Draskovic</surname><given-names>I</given-names></name>
<name name-style="western"><surname>Persuh</surname><given-names>M</given-names></name>
<etal/></person-group>             <year>2002</year>             <article-title>Microarray analysis of the bacillus subtilis k-state: genome-wide expression changes dependent on comk.</article-title>             <source>Mol Microbiol</source>             <volume>43</volume>             <fpage>1331</fpage>             <lpage>1345</lpage>          </element-citation></ref>
<ref id="pcbi.1000985-Hamoen1"><label>6</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Hamoen</surname><given-names>L</given-names></name>
<name name-style="western"><surname>Venema</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Kuipers</surname><given-names>O</given-names></name>
</person-group>             <year>2003</year>             <article-title>Controlling competence in bacillus subtilis: shared use of regulators.</article-title>             <source>Microbiology</source>             <volume>149</volume>             <fpage>9</fpage>             <lpage>17</lpage>          </element-citation></ref>
<ref id="pcbi.1000985-Ogura1"><label>7</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Ogura</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Yamaguchi</surname><given-names>H</given-names></name>
<name name-style="western"><surname>Kobayashi</surname><given-names>K</given-names></name>
<name name-style="western"><surname>Ogasawara</surname><given-names>N</given-names></name>
<name name-style="western"><surname>Yasutaro</surname><given-names>F</given-names></name>
<etal/></person-group>             <year>2002</year>             <article-title>Whole-genome analysis of genes regulated by the bacillus subtilis competence transcription factor comk.</article-title>             <source>J Bacteriol</source>             <volume>184</volume>             <fpage>2344</fpage>             <lpage>2351</lpage>          </element-citation></ref>
<ref id="pcbi.1000985-Dubnau1"><label>8</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Dubnau</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Losick</surname><given-names>R</given-names></name>
</person-group>             <year>2006</year>             <article-title>Bistability in bacteria.</article-title>             <source>Mol Microbiol</source>             <volume>61</volume>             <fpage>564</fpage>             <lpage>572</lpage>          </element-citation></ref>
<ref id="pcbi.1000985-Smits1"><label>9</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Smits</surname><given-names>W</given-names></name>
<name name-style="western"><surname>Eschevins</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Susanna</surname><given-names>K</given-names></name>
<name name-style="western"><surname>Bron</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Kuipers</surname><given-names>O</given-names></name>
<etal/></person-group>             <year>2005</year>             <article-title>Stripping bacillus: Comk auto-simulation is responsible for the bistable response in competence development.</article-title>             <source>Mol Microbiol</source>             <volume>56</volume>             <fpage>604</fpage>             <lpage>614</lpage>          </element-citation></ref>
<ref id="pcbi.1000985-Simon1"><label>10</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Simon</surname><given-names>A</given-names></name>
</person-group>             <year>2005</year>             <article-title>Cell individuality: the bistability of competence development.</article-title>             <source>Trends Microbiol</source>             <volume>13</volume>             <fpage>459</fpage>             <lpage>462</lpage>          </element-citation></ref>
<ref id="pcbi.1000985-Maamar2"><label>11</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Maamar</surname><given-names>H</given-names></name>
<name name-style="western"><surname>Dubnau</surname><given-names>D</given-names></name>
</person-group>             <year>2005</year>             <article-title>Bistability in the bacillus subtilis k-state (competence) requires a positive feedback loop.</article-title>             <source>Mol Microbiol</source>             <volume>56</volume>             <fpage>615</fpage>             <lpage>624</lpage>          </element-citation></ref>
<ref id="pcbi.1000985-Ferrel1"><label>12</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Ferrel</surname><given-names>J</given-names></name>
</person-group>             <year>2002</year>             <article-title>Self-perpetuating states in signal transduction: positive feedback, double-negative feedback and bistability.</article-title>             <source>Curr Opin Cell Biol</source>             <volume>14</volume>             <fpage>140</fpage>             <lpage>148</lpage>          </element-citation></ref>
<ref id="pcbi.1000985-Sel1"><label>13</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Süel</surname><given-names>GM</given-names></name>
<name name-style="western"><surname>Garcia-Ojalvo</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Liberman</surname><given-names>LM</given-names></name>
<name name-style="western"><surname>Elowitz</surname><given-names>MB</given-names></name>
</person-group>             <year>2006</year>             <article-title>An excitable gene regulatory circuit induces transient cellular differentiation.</article-title>             <source>Nature</source>             <volume>440</volume>             <fpage>545</fpage>             <lpage>550</lpage>          </element-citation></ref>
<ref id="pcbi.1000985-Kampen1"><label>14</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Kampen</surname><given-names>V</given-names></name>
</person-group>             <year>2001</year>             <source>Stochastic Processes in Physics and Chemistry</source>             <publisher-loc>North Holland</publisher-loc>          </element-citation></ref>
<ref id="pcbi.1000985-GWeiss1"><label>15</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>G Weiss</surname><given-names>AS</given-names></name>
</person-group>             <year>1983</year>             <article-title>First passage time problems for a class of master equations with separable kernels.</article-title>             <source>Physica A</source>             <volume>119</volume>             <fpage>569</fpage>             <lpage>579</lpage>          </element-citation></ref>
<ref id="pcbi.1000985-Redner1"><label>16</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Redner</surname><given-names>S</given-names></name>
</person-group>             <year>2007</year>             <source>A guide to first passage processes</source>             <publisher-name>Cambridge University Press</publisher-name>          </element-citation></ref>
<ref id="pcbi.1000985-GWeiss2"><label>17</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>G Weiss</surname><given-names>AS</given-names></name>
</person-group>             <year>1980</year>             <article-title>First passage time approach to diffusion controlled reactions.</article-title>             <source>J Chem Phys</source>             <volume>72</volume>             <fpage>4350</fpage>             <lpage>4357</lpage>          </element-citation></ref>
<ref id="pcbi.1000985-BNawakowski1"><label>18</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>B Nawakowski</surname><given-names>AK</given-names></name>
</person-group>             <year>2005</year>             <article-title>Master equation simulations of bistable and excitable dynamics in a model of a thermochemical system.</article-title>             <source>J Chem Phys</source>             <volume>109</volume>             <fpage>3134</fpage>             <lpage>3138</lpage>          </element-citation></ref>
<ref id="pcbi.1000985-Turgay1"><label>19</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Turgay</surname><given-names>K</given-names></name>
<name name-style="western"><surname>Hahn</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Burghoom</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Dubnau</surname><given-names>D</given-names></name>
</person-group>             <year>1998</year>             <article-title>Competence in bacillus subtilis is controlled by regulated proteolysis of a transcriptioni factor.</article-title>             <source>Embo J</source>             <volume>17</volume>             <fpage>6730</fpage>             <lpage>6738</lpage>          </element-citation></ref>
<ref id="pcbi.1000985-Rao1"><label>20</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Rao</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Arkin</surname><given-names>A</given-names></name>
</person-group>             <year>2003</year>             <article-title>Stochastic chemical kinetics and the quasi-steady-state assumption: Application to the gillespie algorithm.</article-title>             <source>J Chem Phys</source>             <volume>118</volume>             <fpage>4999</fpage>             <lpage>5010</lpage>          </element-citation></ref>
<ref id="pcbi.1000985-Gillespie1"><label>21</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Gillespie</surname><given-names>DT</given-names></name>
</person-group>             <year>1977</year>             <article-title>Exact stochastic simulation of coupled chemical reactions.</article-title>             <source>J Phys Chem</source>             <volume>81</volume>             <fpage>2340</fpage>             <lpage>2361</lpage>          </element-citation></ref>
<ref id="pcbi.1000985-Munsky1"><label>22</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Munsky</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Khammash</surname><given-names>M</given-names></name>
</person-group>             <year>2006</year>             <article-title>The finite state projection algorithm for the solution of the chemical master equation.</article-title>             <source>J Chem Phys</source>             <volume>124</volume>             <fpage>044104</fpage>          </element-citation></ref>
<ref id="pcbi.1000985-Tempo1"><label>23</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Tempo</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Calafiore</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Dabbene</surname><given-names>F</given-names></name>
</person-group>             <year>2005</year>             <source>Randomized Algorithms for Analysis and Control of Uncertain Systems</source>             <publisher-name>Springer</publisher-name>          </element-citation></ref>
<ref id="pcbi.1000985-Leisner1"><label>24</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Leisner</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Kuhr</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Rädler</surname><given-names>JO</given-names></name>
<name name-style="western"><surname>Frey</surname><given-names>E</given-names></name>
<name name-style="western"><surname>Maier</surname><given-names>B</given-names></name>
</person-group>             <year>2009</year>             <article-title>Kinetics of genetic switching into the state of bacterial competence.</article-title>             <source>Biophys J</source>             <volume>96</volume>             <fpage>1178</fpage>             <lpage>1188</lpage>          </element-citation></ref>
</ref-list>

</back>
</article>