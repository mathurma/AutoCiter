<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id><journal-title-group>
<journal-title>PLoS Computational Biology</journal-title></journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-13-00541</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1003494</article-id>
<article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Biology</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Genomics</subject></subj-group></subj-group><subj-group><subject>Genomics</subject><subj-group><subject>Genome analysis tools</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Mathematics</subject><subj-group><subject>Statistics</subject><subj-group><subject>Statistical methods</subject></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Universal Count Correction for High-Throughput Sequencing</article-title>
<alt-title alt-title-type="running-head">Universal Count Correction</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Hashimoto</surname><given-names>Tatsunori B.</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Edwards</surname><given-names>Matthew D.</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Gifford</surname><given-names>David K.</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
</contrib-group>
<aff id="aff1"><label>1</label><addr-line>Computer Science and Artificial Intelligence Laboratory, Massachusetts Institute of Technology, Cambridge, Massachusetts, United States of America</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>McHardy</surname><given-names>Alice Carolyn</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group>
<aff id="edit1"><addr-line>Heinrich Heine University, Germany</addr-line></aff>
<author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">gifford@mit.edu</email></corresp>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn>
<fn fn-type="con"><p>Conceived and designed the experiments: TBH MDE DKG. Performed the experiments: TBH MDE. Analyzed the data: TBH MDE. Contributed reagents/materials/analysis tools: TBH MDE. Wrote the paper: TBH MDE DKG.</p></fn>
</author-notes>
<pub-date pub-type="collection"><month>3</month><year>2014</year></pub-date>
<pub-date pub-type="epub"><day>6</day><month>3</month><year>2014</year></pub-date>
<volume>10</volume>
<issue>3</issue>
<elocation-id>e1003494</elocation-id>
<history>
<date date-type="received"><day>1</day><month>4</month><year>2013</year></date>
<date date-type="accepted"><day>8</day><month>1</month><year>2014</year></date>
</history>
<permissions>
<copyright-year>2014</copyright-year>
<copyright-holder>Hashimoto et al</copyright-holder><license xlink:type="simple"><license-p>This is an open-access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><related-article id="RA1" related-article-type="companion" ext-link-type="uri" vol="" page="e1002972" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pcbi.1002972"> <article-title>New Methods Section in PLOS Computational Biology</article-title></related-article>
<abstract>
<p>We show that existing RNA-seq, DNase-seq, and ChIP-seq data exhibit overdispersed per-base read count distributions that are not matched to existing computational method assumptions. To compensate for this overdispersion we introduce a nonparametric and universal method for processing per-base sequencing read count data called F<sc>ixseq</sc>. We demonstrate that F<sc>ixseq</sc> substantially improves the performance of existing RNA-seq, DNase-seq, and ChIP-seq analysis tools when compared with existing alternatives.</p>
</abstract>
<abstract abstract-type="summary"><title>Author Summary</title>
<p>High-throughput DNA sequencing has been adapted to measure diverse biological state information including RNA expression, chromatin accessibility, and transcription factor binding to the genome. The accurate inference of biological mechanism from sequence counts requires a model of how sequence counts are distributed. We show that presently used sequence count distribution models are typically inaccurate and present a new method called F<sc>ixseq</sc> to process counts to more closely follow existing count models. On typical datasets F<sc>ixseq</sc> improves the performance of existing tools for RNA-seq, DNase-seq, and ChIP-seq, while yielding complementary additional gains in cases where domain-specific tools are available.</p>
</abstract>
<funding-group><funding-statement>This study was funded by NIH grant no. 5-U01-HG007037, NSF grant no. 0645960, and the Qatar Computing Research Institute. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="11"/></counts></article-meta>
</front>
<body><sec id="s1">
<title/>
<disp-quote>
<p>This is a <italic>PLOS Computational Biology</italic> Methods article.</p>
</disp-quote></sec><sec id="s2">
<title>Introduction</title>
<p>High-throughput sequencing is used in a variety of molecular counting assays <xref ref-type="bibr" rid="pcbi.1003494-Wold1">[1]</xref> to study protein-DNA binding, transcription, and the dynamics of chromatin occupancy. ChIP-seq <xref ref-type="bibr" rid="pcbi.1003494-Park1">[2]</xref>, used to study protein binding to the genome, captures short DNA fragments that are attached to a protein of interest after a chemical treatment that affixes proteins to nearby DNA molecules. High-throughput sequencing of these DNA fragments, followed by identifying their originating location in the genome, allows for the identification of read-enriched areas. These enriched regions correspond to locations where the protein of interest was bound, perhaps indirectly, to the DNA. RNA-seq <xref ref-type="bibr" rid="pcbi.1003494-Wang1">[3]</xref>, <xref ref-type="bibr" rid="pcbi.1003494-Ozsolak1">[4]</xref>, used to study gene expression, requires isolating the RNA content of a sample, converting it to DNA, and sequencing the resulting DNA library. Mapping or assembling the DNA reads and assigning them to exons or transcripts enables the genome-wide quantification of gene expression. DNase-seq <xref ref-type="bibr" rid="pcbi.1003494-Boyle1">[5]</xref>, <xref ref-type="bibr" rid="pcbi.1003494-Neph1">[6]</xref> identifies regions of open chromatin and patterns of transcription factor binding by employing an enzyme that preferentially cuts DNA in accessible positions. Retrieving and sequencing the resulting library of DNA fragments, followed by identification of the originating locations, allows for a genome-wide characterization of chromatin occupancy. A unifying task in these analyses is comparing read count profiles, obtained from read mapping results, across varying biological samples or experimental conditions.</p>
<p>Although a myriad of specialized methods exist for analyzing read count data, it is frequently assumed (implicitly or explicitly) that read counts are generated according to a Poisson distribution with a local mean. The assumption is explicitly introduced by using the Poisson density directly as well as implicitly by relying on binned per-base counts in ranking and statistical testing (see <xref ref-type="supplementary-material" rid="pcbi.1003494.s007">Text S1</xref>). When read count data exhibit overdispersed per-base read distributions, a Poisson model may produce erroneous or noisy results. This occurs because the data are not matched to the modeling assumption, resulting in incorrect assessments of statistical significance. While it is well known that the distribution of per-base counts within a single experiment is in fact typically overdispersed, there has not been a precise characterization of the degree of overdispersion and its effects on downstream analysis for general sequencing data.</p>
<p>We introduce a general and asymptotically correct preprocessing technique called F<sc>ixseq</sc> for correcting per-base and per-experiment read counts. F<sc>ixseq</sc> reduces noise and increases stability in subsequent inference procedures and complements existing literature on applications of heavy-tailed distributions <xref ref-type="bibr" rid="pcbi.1003494-Anders1">[7]</xref>–<xref ref-type="bibr" rid="pcbi.1003494-Ji1">[9]</xref>. Existing literature for preprocessing focuses on either de-duplication, which removes all but one read per base, or normalization techniques for RNA-seq data, which generally operate over exon-level counts. We have previously dealt with these problems when developing a ChIP-seq caller with adaptive count truncation <xref ref-type="bibr" rid="pcbi.1003494-Guo1">[10]</xref> and found that this was effective in practice (see <xref ref-type="supplementary-material" rid="pcbi.1003494.s007">Text S1</xref> and <xref ref-type="supplementary-material" rid="pcbi.1003494.s003">Table S1</xref>), but this work aims to construct a more general preprocessing scheme that works for any method and sequencing assay.</p>
<p>The normalization strategy of de-duplication is prevalent in multiple ChIP-seq peak callers <xref ref-type="bibr" rid="pcbi.1003494-Pepke1">[11]</xref>, but less common in RNA-seq data analysis where highly-expressed transcripts may be expected to have many duplicate reads. However, a handful of RNA-seq processing algorithms remove duplicates as a conservative choice to avoid nonlinear PCR amplification errors <xref ref-type="bibr" rid="pcbi.1003494-Jones1">[12]</xref>, <xref ref-type="bibr" rid="pcbi.1003494-Skelly1">[13]</xref>.</p>
<p>Existing RNA-seq normalization techniques work at a higher conceptual level than F<sc>ixseq</sc>, using information from a local sequence context to correct exon- or transcript-level sums and reduce the impact of confounding noise covariates <xref ref-type="bibr" rid="pcbi.1003494-Anders1">[7]</xref>, <xref ref-type="bibr" rid="pcbi.1003494-Srivastava1">[14]</xref>–<xref ref-type="bibr" rid="pcbi.1003494-Bullard1">[18]</xref>. In our RNA-seq results we show that F<sc>ixseq</sc> can enhance the results of methods such as DEseq that already account for exon-level overdispersion as well as provide complementary information to methods that correct for mappability and GC content (see <xref ref-type="supplementary-material" rid="pcbi.1003494.s002">Figure S2</xref>). While these methods are valuable for RNA-seq and binned count statistics, they are less applicable to other sequencing data types and often have specific modeling assumptions that rely on the mechanisms of transcription, cDNA library preparation, and DNA sequencing. Covariate-based normalization techniques designed for other assays, like ChIP-seq, require identified binding sites as a prerequisite and are designed to correct only windowed read counts <xref ref-type="bibr" rid="pcbi.1003494-Cheung1">[19]</xref>, rendering them unusable as preprocessing tools for algorithms which require per-base count data. Other assay-specific normalization tools (e.g. <xref ref-type="bibr" rid="pcbi.1003494-Yaffe1">[20]</xref>–<xref ref-type="bibr" rid="pcbi.1003494-Benjamini1">[23]</xref>) require extensive domain knowledge and application-specific modeling strategies and, while valuable, must be developed independently for each new assay.</p>
<p>In contrast to most of these existing strategies, F<sc>ixseq</sc> works at a lower and more general level, the per-base count, and attempts to decrease the false positive rate rather than recover lost signal caused by sequencing artifacts. This approach is applicable to many types of sequencing assays and downstream processing algorithms, without additional assumptions. This universal nature allows for F<sc>ixseq</sc> to be applied to any type of sequencing count data, without training phases or specialized model-building. However, in cases where applicable covariate-based or assay-specific normalization tools exist, they may be used in addition to F<sc>ixseq</sc> in order to leverage complementary gains (as in <xref ref-type="supplementary-material" rid="pcbi.1003494.s002">Figure S2</xref>). One additional consequence of our work is a generalization of the de-duplication heuristic into a broader and asymptotically correct preprocessing technique.</p>
</sec><sec id="s3">
<title>Results</title>
<sec id="s3a">
<title>Read counts in sequencing data are highly overdispersed</title>
<p>The distributions of per-base mapped read counts in all ChIP-seq and RNA-seq runs for the human embryonic stem cell type (H1-hESC or ES cells) in the ENCODE project and a set of K562 cell line DNase-seq experiments (see <xref ref-type="supplementary-material" rid="pcbi.1003494.s007">Text S1</xref>) show evidence of consistent and significant overdispersion (<xref ref-type="fig" rid="pcbi-1003494-g001">Figures 1</xref>, <xref ref-type="fig" rid="pcbi-1003494-g002">2</xref>, and <xref ref-type="fig" rid="pcbi-1003494-g003">3</xref>). This extra variation arises from a myriad of biological and technical sources, including true variation in factor binding signal or expression levels genome-wide, variation in molecular sequencing affinity, and variation in read mapping accuracy. The overdispersion we find is complex and cannot be directly categorized as the result of a well-known parametric distribution such as gamma-Poisson <xref ref-type="bibr" rid="pcbi.1003494-Thygesen1">[24]</xref>, <xref ref-type="bibr" rid="pcbi.1003494-Bliss1">[25]</xref> or log-normal-Poisson <xref ref-type="bibr" rid="pcbi.1003494-Bulmer1">[26]</xref> (<xref ref-type="fig" rid="pcbi-1003494-g001">Figures 1</xref> and <xref ref-type="fig" rid="pcbi-1003494-g002">2</xref>).</p>
<fig id="pcbi-1003494-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003494.g001</object-id><label>Figure 1</label><caption>
<title>Log-likelihood difference between maximum likelihood and observed distributions.</title>
<p>Differences in log-likelihood per base between the fitted model and the empirical distribution, also interpreted as the log-difference between observed and fitted counts. This error metric represents the error when calculating p-values or significance tests using a Poisson assumption. Three assay types are shown in each panel, analyzed by three models: (a) Poisson. (b) Negative binomial. (c) Log-normal Poisson. A model that fits the data would have points along the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003494.e001" xlink:type="simple"/></inline-formula> line. Consistent deviation from zero by all distributions show that none of the distributions fit all assays well.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003494.g001" position="float" xlink:type="simple"/></fig><fig id="pcbi-1003494-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003494.g002</object-id><label>Figure 2</label><caption>
<title>Log-likelihood errors for ENCODE ChIP-seq data.</title>
<p>The distribution described as log-concave is the statistical model used in F<sc>ixseq</sc>. Subfigure (a) shows that de-duplication Poisson can control high per-base errors much like overdispersed models, but Subfigure (b) shows that de-duplication error rises rapidly as sequencing depth increases.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003494.g002" position="float" xlink:type="simple"/></fig><fig id="pcbi-1003494-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003494.g003</object-id><label>Figure 3</label><caption>
<title>Distribution of counts for 14 DNase-seq experiments, 23 RNA-seq experiments and 87 ChIP-seq experiments.</title>
<p>The left panel shows uncorrected counts, and the right shows counts after correction. Poisson distributed counts would follow a straight line; all experiments show significant deviation from linearity that is corrected by F<sc>ixseq</sc>.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003494.g003" position="float" xlink:type="simple"/></fig>
<p>We quantified the degree of overdispersion with respect to a distribution by comparing per-base empirical log-likelihoods against the per-base maximum log-likelihood distributions for the Poisson, negative binomial, and log-normal Poisson, where the per-base rates of the Poisson are assumed to be drawn from a log-normal distribution. For the negative binomial and log-normal Poisson, maximum likelihood distributions were found via numerical optimization with randomized restarts.</p>
<p>The deviation from Poisson is consistent across experiment and assay type, as shown in the left column of <xref ref-type="fig" rid="pcbi-1003494-g003">Figure 3</xref>. We would expect a completely linear histogram of log-counts but actually observe significant overdispersion, shown by large number of high-count bases.</p>
<p><xref ref-type="fig" rid="pcbi-1003494-g001">Figure 1</xref> shows that none of the parametric distributions we tested fit the observed counts well. The Poisson significantly underestimates the number of bases with more than one read, with the probability of having ten counts land on the same base estimated to be <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003494.e002" xlink:type="simple"/></inline-formula> times less than the observed number of counts. The negative binomial has previously been shown to be effective for modeling exon-level RNA-seq data, and we confirm that negative binomial fits per-base RNA-seq data well. However, we find that it fails to capture the wide variation in overdispersion for ChIP-seq, underestimating the high count bases by at most a factor of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003494.e003" xlink:type="simple"/></inline-formula>. The log-normal Poisson fit shows that real-world sequencing data is not simply heavy-tailed; it has heavy tails whose shapes are dependent on the assay type. The log-normal Poisson is traditionally considered an extremely heavy-tailed distribution, and while it is relatively correct for ChIP-seq, it significantly overestimates the tail mass for DNase-seq experiments.</p>
<p>The wide variation in overdispersion level and type suggests that any single parametric approach is unlikely to be effective for all assay types. Instead of attempting to model each assay type with a separate parametric family, we will use nonparametric distributions that are flexible enough to fit all observed assay types well.</p>
</sec><sec id="s3b">
<title>Count correction via data transformation</title>
<p>While we have already seen that the Poisson assumption fails for most of the assay types we consider, it is not feasible or necessary to modify every analysis algorithm to use overdispersed distributions. Instead, for the class of inference algorithms which implicitly or explicitly assume Poisson counts and independent bases, such as most ChIP-seq callers, DNase-binding identifiers, and RNA-seq exon read counting methods, we can construct improved datasets with transformed counts that correct for overdispersion.</p>
<p>The two major nonparametric approaches to data transformation are quantile normalization, which matches input samples to a reference sample via their quantiles, and distribution matching, which fits a distribution to both the input and reference and constructs a mapping function between them.</p>
<p>Quantile normalization, which is a popular approach in the microarray literature, cannot easily be adapted to sequencing data, due to the large number of bases with equal counts. In order to rank normalize our observed counts to a Poisson, we would have to arbitrarily break ties between bases with equal reads, which could lead to spurious inference as well as force bases with non-zero counts to be discarded.</p>
<p>Instead of breaking ties, we employ a different approach to distribution mapping: given a distribution <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003494.e004" xlink:type="simple"/></inline-formula> over counts, we find the mapping which makes the density of the Poisson equal to that of the given distribution <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003494.e005" xlink:type="simple"/></inline-formula>. By fitting a distribution <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003494.e006" xlink:type="simple"/></inline-formula> to the observed counts, we avoid the problem of tied counts and allow for a continuous mapping. One advantage of viewing this approach under a distribution mapping framework is that it allows us to understand the theoretical basis of the de-duplication heuristic that is a popular preprocessing method for ChIP-seq data.</p>
<p>Our approach transforms the non-Poisson, curved count histogram on the left column of <xref ref-type="fig" rid="pcbi-1003494-g003">Figure 3</xref> into the Poisson-like linear count histogram on the right column of <xref ref-type="fig" rid="pcbi-1003494-g003">Figure 3</xref>.</p>
</sec><sec id="s3c">
<title>De-duplication acts as a degenerate data transform</title>
<p>De-duplication, or removal of all but one read at each base position, has gained adoption in the ChIP-seq analysis literature as an effective way of reducing noise and improving replicate consistency <xref ref-type="bibr" rid="pcbi.1003494-Chen1">[27]</xref>, <xref ref-type="bibr" rid="pcbi.1003494-Wilbanks1">[28]</xref>. ChIP-seq event callers such as MACS <xref ref-type="bibr" rid="pcbi.1003494-Zhang1">[29]</xref> and SPP <xref ref-type="bibr" rid="pcbi.1003494-Kharchenko1">[30]</xref> either de-duplicate by default or strongly suggest enabling de-duplication.</p>
<p>The heuristic of de-duplication can be derived as a distribution mapping data transformation by assuming that the read counts arise from a degenerate count distribution, where the number of bases with non-zero reads is drawn from a binomial, and the number of reads at non-zero bases is drawn from a uniform noise component over <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003494.e007" xlink:type="simple"/></inline-formula>. In this case, the probability of all non-zero counts are equal, and they should be mapped to the same value after the transform. Conversely, any data transform preserving rank order will not fully de-duplicate but will instead monotonically re-weight counts.</p>
<p>De-duplication works well in practice by drastically reducing the error and additional variance from overdispersion, despite assuming that the data follow a degenerate distribution. <xref ref-type="fig" rid="pcbi-1003494-g002">Figure 2a</xref> shows the performance of various overdispersion correction methods using the per-base log-likelihood error for the Poisson, de-duplicated Poisson, negative binomial, and the log-concave Poisson distribution, which we use in F<sc>ixseq</sc>. These per-base errors reflect the expected error in statistical significance testing under window-based DNase-seq and ChIP-seq callers, as errors in the log-likelihood propagate directly into error in the Poisson test statistic.</p>
<p>Preprocessing by de-duplication does not continue to reduce per-base errors as sequencing depth increases. <xref ref-type="fig" rid="pcbi-1003494-g002">Figure 2b</xref> shows that the log-likelihood error per-base increases rapidly as a function of the total sequencing depth. The Poisson and de-duplicated Poisson both have average per-base error which increases similarly as a function of sequencing depth. This confirms the observation that as sequencing depth increases, more of the mappable genome will have at least one mapped read, leading to a loss of predictive power.</p>
<p>Therefore while de-duplication may be effective at lower sequencing depths, it relies upon a limited heuristic justification and will not remain effective as sequencing depths increase. On the other hand, F<sc>ixseq</sc> significantly outperforms de-duplication at modeling the observed data distribution as sequencing depth grows (<xref ref-type="fig" rid="pcbi-1003494-g002">Figure 2b</xref>) and is asymptotically consistent under relatively weak assumptions.</p>
<p>We compared three methods of count preprocessing: original (raw) counts, removal of all duplicates (de-duplication), and our novel preprocessing technique (F<sc>ixseq</sc>). These preprocessing schemes are compared across three assay types and in multiple experiments and in multiple contexts. We show that F<sc>ixseq</sc> consistently improves performance, with substantial improvements obtained in certain cases.</p>
</sec><sec id="s3d">
<title>DNase-seq</title>
<p>We evaluate our model on the ability to identify transcription factor binding sites based upon DNase-seq counts on the ENCODE human K562 DNase-seq data using two different methods: an unsupervised task using the CENTIPEDE binding site caller <xref ref-type="bibr" rid="pcbi.1003494-PiqueRegi1">[31]</xref> and a supervised task using a linear classifier. The binding site predictions are compared against all matching ChIP-seq calls for the same factor on a matched cell type, and we evaluate the algorithm on the fraction of ChIP-seq calls we are able to recover. The details of the comparison, such as the PWM matching and cutoffs, follow the techniques used by CENTIPEDE.</p>
<p>In the unsupervised task shown in <xref ref-type="fig" rid="pcbi-1003494-g004">Figure 4</xref>, F<sc>ixseq</sc> shows small but consistent improvements on nearly all runs and all methods, and on many factors we show improvements up to a 0.3 increase in area under the curve (AUC), a metric of accuracy. These large performance increases indicate that F<sc>ixseq</sc> rescued an otherwise failed run.</p>
<fig id="pcbi-1003494-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003494.g004</object-id><label>Figure 4</label><caption>
<title>AUC comparisons for baseline methods compared to F<sc>ixseq</sc>.</title>
<p>Boxplots depicting AUC improvement across multiple factors (boxes above zero represent improvement due to F<sc>ixseq</sc>). Variance was estimated using one thousand bootstrap replicates each. Transcription factors with no significant difference across methods (p = 0.05) are not shown. Of the 301 factors tested, 90 could be predicted nontrivially (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003494.e008" xlink:type="simple"/></inline-formula>) via CENTIPEDE. Of these, 51 show significant differences.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003494.g004" position="float" xlink:type="simple"/></fig></sec><sec id="s3e">
<title>ChIP-seq</title>
<p>We tested F<sc>ixseq</sc> on 87 ES cell ChIP-seq experiments from the ENCODE project <xref ref-type="bibr" rid="pcbi.1003494-Khatun1">[32]</xref>, using the ChIP-seq callers MACS <xref ref-type="bibr" rid="pcbi.1003494-Zhang1">[29]</xref> and PeakSeq <xref ref-type="bibr" rid="pcbi.1003494-Rozowsky1">[33]</xref> on original counts, de-duplicated counts, and F<sc>ixseq</sc> processed counts with rounding (see <xref ref-type="supplementary-material" rid="pcbi.1003494.s007">Text S1</xref>). Following prior work in evaluating ChIP-seq caller accuracy <xref ref-type="bibr" rid="pcbi.1003494-Wilbanks1">[28]</xref>, <xref ref-type="bibr" rid="pcbi.1003494-Landt1">[34]</xref>, we selected two evaluation criteria: replicate consistency of q-values and the number of overlapping ChIP-seq events across replicates.</p>
<p>We evaluate quantile-quantile correlation for replicate consistency, as this allows us to evaluate the distribution of q-values generated by each method without pairing binding sites explicitly. The quantile-quantile (QQ) correlations are an effective means of detecting not only whether we call similar numbers of binding sites across replicates, but also whether our ChIP-seq call confidence is consistent across replicates. The quantile-quantile correlations across all analyzed ENCODE ChIP-seq experiments shown in <xref ref-type="fig" rid="pcbi-1003494-g005">Figure 5a</xref> strongly suggest that F<sc>ixseq</sc> stabilizes the distribution of q-values from PeakSeq and MACS. F<sc>ixseq</sc> outperforms both raw counts and de-duplication for PeakSeq and improves on de-duplication significantly for MACS (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003494.e009" xlink:type="simple"/></inline-formula>).</p>
<fig id="pcbi-1003494-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003494.g005</object-id><label>Figure 5</label><caption>
<title>Event reproducibility for ChIP replicates.</title>
<p>Subfigure (a) shows that F<sc>ixseq</sc> increases the q-value correlation between replicates. Subfigure (b) shows the increase in the log number of bases overlapping between calls on replicates due to F<sc>ixseq</sc>. F<sc>ixseq</sc> calls have consistently higher peak overlaps between replicates for both MACS and PeakSeq.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003494.g005" position="float" xlink:type="simple"/></fig>
<p>An alternative measure of ChIP-seq experiment quality is the number and size of overlapping sites across replicates. F<sc>ixseq</sc> increases the number of overlapping sites in both methods, showing that F<sc>ixseq</sc> improves consistency of localization of sites as well as the ranking of ChIP-sites (<xref ref-type="fig" rid="pcbi-1003494-g005">Figure 5b</xref>).</p>
</sec><sec id="s3f">
<title>RNA-seq</title>
<p>We ran F<sc>ixseq</sc> on all 23 ES cell RNA-seq datasets from ENCODE and evaluated the replicate consistency of the original read counts, de-duplication, and F<sc>ixseq</sc>. Using the ENCODE alignments, we followed the analysis technique suggested by DEseq <xref ref-type="bibr" rid="pcbi.1003494-Anders1">[7]</xref> and mapped reads and adjusted counts to exons and generated exon-level counts.</p>
<p>Replicate consistency was measured in two ways: Spearman's rank correlation and the number of false positive differential expression events called by DEseq <xref ref-type="bibr" rid="pcbi.1003494-Anders1">[7]</xref> across replicates. Spearman's rank correlation on exon counts was chosen to characterize the run-to-run variability between replicates, while DEseq was chosen to represent F<sc>ixseq</sc>'s ability to enhance existing techniques that attempt to handle exon-level overdispersion.</p>
<p>The rank correlation between replicates shown in <xref ref-type="fig" rid="pcbi-1003494-g006">Figure 6</xref> is significantly higher for F<sc>ixseq</sc> processed counts than for both raw counts and de-duplication (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003494.e010" xlink:type="simple"/></inline-formula>). We make even greater improvements in the 75-bp single-end RNA-seq datasets, where it is possible that difficulty or ambiguity in read mapping causes single-base spikes that adversely affect replicate consistency. The RNA-seq correlations also support our earlier claims that de-duplication performance will begin to degrade as sequencing depth increases. In both the paired-end Caltech and Cold Spring Harbor Laboratory (CSHL) experiments we find that the original counts are on average better than the de-duplicated counts due to the higher coverage per base.</p>
<fig id="pcbi-1003494-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003494.g006</object-id><label>Figure 6</label><caption>
<title>Bootstrapped differences in Spearman's rank correlation coefficient for ENCODE RNA-seq experiments.</title>
<p>Higher rank correlations across exon expression measurements between replicates indicate greater data quality and reproducibility. F<sc>ixseq</sc> increases the rank correlation coefficient for almost all experiments, though the improvements compared to de-duplication for the CSHL 75bp align and splice experiments are minimal.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003494.g006" position="float" xlink:type="simple"/></fig>
<p>Our DEseq results in <xref ref-type="table" rid="pcbi-1003494-t001">Table 1</xref> are consistent with the correlation results, with F<sc>ixseq</sc> calling fewer differential exons across replicates despite being a less aggressive truncation scheme than de-duplication. Following the DEseq analysis pipeline, we used replicates to estimate exon-level overdispersion and identified exons differential across replicates at 0.05% FDR. The number of exons called differential across replicates in <xref ref-type="table" rid="pcbi-1003494-t001">Table 1</xref> are consistently the lowest for F<sc>ixseq</sc> out of all methods tested. Since F<sc>ixseq</sc> is a shrinkage method, we would expect there to be fewer false positives between replicates under F<sc>ixseq</sc> than the original counts. For example, if we preprocess by deleting all counts, we would have a trivial zero false positive rate. However, this is likely not the method by which F<sc>ixseq</sc> decreases false positive rate since we outperform de-duplication, which is an even more aggressive shrinkage method. This suggests that the counts we retain are consistent between replicates.</p>
<table-wrap id="pcbi-1003494-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003494.t001</object-id><label>Table 1</label><caption>
<title>Differential expression results across replicate experiments.</title>
</caption><alternatives><graphic id="pcbi-1003494-t001-1" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003494.t001" xlink:type="simple"/>
<table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">Caltech Align 75</td>
<td align="left" rowspan="1" colspan="1">Caltech Splice 75</td>
<td align="left" rowspan="1" colspan="1">Caltech Align 75x2</td>
<td align="left" rowspan="1" colspan="1">Caltech Splice 75x2</td>
<td align="left" rowspan="1" colspan="1">CSHL polyA-</td>
<td align="left" rowspan="1" colspan="1">CSHL polyA+</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1">Original</td>
<td align="left" rowspan="1" colspan="1">2903</td>
<td align="left" rowspan="1" colspan="1">1454</td>
<td align="left" rowspan="1" colspan="1">5719</td>
<td align="left" rowspan="1" colspan="1">2748</td>
<td align="left" rowspan="1" colspan="1">8403</td>
<td align="left" rowspan="1" colspan="1">6955</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">De-duplication</td>
<td align="left" rowspan="1" colspan="1">2559</td>
<td align="left" rowspan="1" colspan="1">1033</td>
<td align="left" rowspan="1" colspan="1">4951</td>
<td align="left" rowspan="1" colspan="1">2027</td>
<td align="left" rowspan="1" colspan="1">6640</td>
<td align="left" rowspan="1" colspan="1">5253</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">F<sc>ixseq</sc></td>
<td align="left" rowspan="1" colspan="1"><bold>2213</bold></td>
<td align="left" rowspan="1" colspan="1"><bold>944</bold></td>
<td align="left" rowspan="1" colspan="1"><bold>4230</bold></td>
<td align="left" rowspan="1" colspan="1"><bold>1989</bold></td>
<td align="left" rowspan="1" colspan="1"><bold>5319</bold></td>
<td align="left" rowspan="1" colspan="1"><bold>4374</bold></td>
</tr>
</tbody>
</table>
</alternatives><table-wrap-foot><fn id="nt101"><label/><p>Number of exons falsely called differentially expressed between biological replicates by DEseq at 5% FDR level; entries with the fewest false calls are bolded. There are 256324 total exons in the annotation set.</p></fn></table-wrap-foot></table-wrap></sec></sec><sec id="s4">
<title>Discussion</title>
<p>We have shown that per-base count overdispersion is a widespread and consistent phenomenon in high-throughput sequencing experiments. While correcting for exon-level overdispersion has been studied in RNA-seq, per-base methods and corresponding tools for ChIP-seq and DNase-seq have largely been unexplored outside of aggressive count truncation methods particular to individual algorithms. One reason for the slow adoption of overdispersed models has been the empirical success of the de-duplication heuristic as a preprocessing scheme. However, we show that de-duplication assumes the data arise from a degenerate distribution, and that the performance of de-duplication will degrade as sequencing depth increases.</p>
<p>F<sc>ixseq</sc> corrects overdispersed sequence count data by assuming that the data arise from a flexible class of log-concave distributions. We designed a novel and fast inference algorithm for the class of Poisson log-concave distributions as well as effective rounding schemes. In a diverse array of validation tasks, including DNase-seq binding site identification, ChIP-seq peak calling, and RNA-seq self-consistency, F<sc>ixseq</sc> consistently increased performance compared to both original counts and de-duplication. In cases where domain-specific correction schemes exist, F<sc>ixseq</sc> can operate in conjunction with them to yield complementary gains. While not replacing other sophisticated methods that can model the intricate biological realities of a new sequencing assay, F<sc>ixseq</sc> aims to provide a useful solution for all count-based sequencing assays without modification for new protocols.</p>
<p>The F<sc>ixseq</sc> method has the potential of broadly improving inference for high-throughput sequencing by bringing sophisticated overdispersion correction to a large number of existing analysis pipelines, while being applicable to future assays without lengthy development and modeling cycles. Additionally, the modeling and inference results we presented can be used in new flexible analysis procedures for count data.</p>
</sec><sec id="s5" sec-type="methods">
<title>Methods</title>
<p>Our count preprocessing method, F<sc>ixseq</sc>, consists of three components:</p>
<list list-type="order"><list-item>
<p>Parameter inference for a novel class of distributions called log-concave Poisson distributions.</p>
</list-item><list-item>
<p>A probability integral transform method to map counts generated under log-concave Poisson to a Poisson distribution.</p>
</list-item><list-item>
<p>Rounding techniques to adapt datasets to methods that utilize only integral counts.</p>
</list-item></list>
<p>In the case that the algorithm downstream of our method is able to take weighted counts, F<sc>ixseq</sc> inherits all the favorable properties of the maximum likelihood estimator (MLE) and can guarantee unbiased and asymptotically consistent inference under the assumptions of per-base independence and log-concave count distributions.</p>
<sec id="s5a">
<title>Poisson log-concave distributions</title>
<p>The challenge of constructing a universal preprocessor is finding a class of count distributions that is flexible enough to model a variety of assay types while remaining non-degenerate. We achieve this goal by letting the per-base rates of a Poisson distribution be drawn from a nonparametric class of distributions called log-concave. Log-concave distributions are a family of distributions <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003494.e011" xlink:type="simple"/></inline-formula> for which the log-density is a concave function. This allows us to write any log-concave function in terms of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003494.e012" xlink:type="simple"/></inline-formula>, a concave function:<disp-formula id="pcbi.1003494.e013"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003494.e013" xlink:type="simple"/></disp-formula></p>
<p>The log-concave family includes a large family of unimodal distributions, such as most of the exponential family (including common cases such as the normal, gamma with shape parameter greater than one, Dirichlet) <xref ref-type="bibr" rid="pcbi.1003494-Cule1">[35]</xref>. Important exceptions include all multi-modal distributions and distributions with super-exponential tails such as the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003494.e014" xlink:type="simple"/></inline-formula>-distribution or the Cauchy.</p>
<p>In sequencing experiments log-concave Poisson families are capable of modeling zero-inflation as well as mixtures induced by copy number variation for low Poisson rates with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003494.e015" xlink:type="simple"/></inline-formula>, where the overall distribution remains unimodal. If such distributions are needed, straightforward extensions for mixtures of log-concave distribution are well known <xref ref-type="bibr" rid="pcbi.1003494-Chang1">[36]</xref>.</p>
<p>Our algorithmic contribution is the use of compound log-concave distributions, where we use latent log-concave distributions which generate Poisson counts along the genome. Inference for latent log-concave distributions does not follow directly from recent results in log-concave density estimation because of the ambiguity of parameters in the latent space.</p>
<p>The full model is as follows: per-base counts <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003494.e016" xlink:type="simple"/></inline-formula> are generated by per-base log-rates <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003494.e017" xlink:type="simple"/></inline-formula>, which are drawn from a log-concave distribution with density <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003494.e018" xlink:type="simple"/></inline-formula>:<disp-formula id="pcbi.1003494.e019"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003494.e019" xlink:type="simple"/></disp-formula><disp-formula id="pcbi.1003494.e020"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003494.e020" xlink:type="simple"/></disp-formula></p>
<p>Note that the two exponential operators above are intentional: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003494.e021" xlink:type="simple"/></inline-formula> is a log-rate and therefore is exponentiated to become the Poisson rate, while <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003494.e022" xlink:type="simple"/></inline-formula> is a log-density and therefore is exponentiated to create an unnormalized density <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003494.e023" xlink:type="simple"/></inline-formula>.</p>
<p>The form of this model naturally suggests an expectation-maximization strategy, which has been shown to be effective for clustering tasks <xref ref-type="bibr" rid="pcbi.1003494-Walther1">[37]</xref>. However, while we can perform expectation maximization using numerical quadrature, we find in practice that the algorithm is unstable and converges extremely slowly.</p>
<p>Instead we propose an inference technique based upon accelerated proximal gradient descent. The marginal likelihood for counts can be written as:<disp-formula id="pcbi.1003494.e024"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003494.e024" xlink:type="simple"/></disp-formula></p>
<p>The bottom term normalizes the log-concave distribution. Approximating the integral with a sum over <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003494.e025" xlink:type="simple"/></inline-formula> quadrature points <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003494.e026" xlink:type="simple"/></inline-formula> we obtain:<disp-formula id="pcbi.1003494.e027"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003494.e027" xlink:type="simple"/></disp-formula></p>
<p>Since <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003494.e028" xlink:type="simple"/></inline-formula> is always evaluated at the fixed points <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003494.e029" xlink:type="simple"/></inline-formula>, we can use the shorthand <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003494.e030" xlink:type="simple"/></inline-formula> and let <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003494.e031" xlink:type="simple"/></inline-formula> be the number of bases with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003494.e032" xlink:type="simple"/></inline-formula> counts. Then the maximum likelihood estimator for the observed data is given by:<disp-formula id="pcbi.1003494.e033"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003494.e033" xlink:type="simple"/></disp-formula></p>
<p>Both the objective function and constraints are concave, and therefore we can use accelerated gradient descent to quickly find the global optimum <xref ref-type="bibr" rid="pcbi.1003494-Nesterov1">[38]</xref>. In particular, we use a method called proximal gradient descent, which optimizes a objective function of the form <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003494.e034" xlink:type="simple"/></inline-formula> by repeatedly applying:<disp-formula id="pcbi.1003494.e035"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003494.e035" xlink:type="simple"/></disp-formula></p>
<p><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003494.e036" xlink:type="simple"/></inline-formula> is defined as the projection of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003494.e037" xlink:type="simple"/></inline-formula> onto <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003494.e038" xlink:type="simple"/></inline-formula>.</p>
<p>Our gradient, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003494.e039" xlink:type="simple"/></inline-formula>, is easily written in terms of the shorthand, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003494.e040" xlink:type="simple"/></inline-formula>, as:<disp-formula id="pcbi.1003494.e041"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003494.e041" xlink:type="simple"/></disp-formula></p>
<p>This gradient has a straightforward interpretation: the first term is the distribution of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003494.e042" xlink:type="simple"/></inline-formula> when observing the counts <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003494.e043" xlink:type="simple"/></inline-formula> and the second term is the distribution of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003494.e044" xlink:type="simple"/></inline-formula> predicted from the prior <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003494.e045" xlink:type="simple"/></inline-formula> alone. The gradient works to minimize the difference between these observed and prior terms.</p>
<p>The projection operator <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003494.e046" xlink:type="simple"/></inline-formula> taking <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003494.e047" xlink:type="simple"/></inline-formula> and producing the closest concave <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003494.e048" xlink:type="simple"/></inline-formula> is the well-known concave regression algorithm <xref ref-type="bibr" rid="pcbi.1003494-Hildreth1">[39]</xref>.</p>
<p>The inference algorithm is guaranteed to converge to a global optima of the quadrature approximation, which as the number of quadrature points increase will converge to the global optima. If there are sufficiently many quadrature points, Fixseq will converge to the log-concave distribution closest to the data-generating distribution in the KL-divergence sense <xref ref-type="bibr" rid="pcbi.1003494-Walther1">[37]</xref>. For the results, we use one million quadrature points throughout.</p>
<p>When compared to the naive expectation maximization based method, our algorithm converges more quickly, with average runtime on our DNase datasets reducing from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003494.e049" xlink:type="simple"/></inline-formula> hours per dataset for EM down to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003494.e050" xlink:type="simple"/></inline-formula> minutes for the gradient based method on a standard laptop with Intel i7 2.5ghz, with a slight increase in goodness of fit for the gradient approach.</p>
</sec><sec id="s5b">
<title>Count adjustment via probability integral transform</title>
<p>Once we fit a log-concave distribution <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003494.e051" xlink:type="simple"/></inline-formula>, we need to be able to convert counts generated under the log-concave Poisson into those generated by the continuous extension of the Poisson. We will define the transformation from raw counts to processed counts via the probability integral transform.</p>
<p>Throughout this section, we will use the continuous extension of the Poisson PDF, CDF and the analogous densities for the log-concave compound distributions, defined below as:<disp-formula id="pcbi.1003494.e052"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003494.e052" xlink:type="simple"/></disp-formula><disp-formula id="pcbi.1003494.e053"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003494.e053" xlink:type="simple"/></disp-formula><disp-formula id="pcbi.1003494.e054"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003494.e054" xlink:type="simple"/></disp-formula><disp-formula id="pcbi.1003494.e055"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003494.e055" xlink:type="simple"/></disp-formula></p>
<p>Given the continuous extensions, we can apply the probability integral transform directly. Given <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003494.e056" xlink:type="simple"/></inline-formula>, we can generate a uniform random variable <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003494.e057" xlink:type="simple"/></inline-formula>, from which we define the Poissonization transform, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003494.e058" xlink:type="simple"/></inline-formula>. Since we are applying the probability integral transform to the continuous extensions of the Poisson, we are not guaranteed integral counts or consistency properties generally implied by the probability integral transform. However, for our purposes it is sufficient that the quantiles and densities are matched.</p>
<p>Our preprocessing function <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003494.e059" xlink:type="simple"/></inline-formula> takes any <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003494.e060" xlink:type="simple"/></inline-formula> distributed as Poisson-log concave with latent distribution <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003494.e061" xlink:type="simple"/></inline-formula> and returns adjusted counts distributed as Poisson. This operation preserves all of the joint structure of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003494.e062" xlink:type="simple"/></inline-formula> and acts as a black box which exchanges the Poisson assumption used in a method for a compound Poisson log-concave distribution assumption. Alternatively, one can consider using <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003494.e063" xlink:type="simple"/></inline-formula> to be a re-weighting operation, which ‘fixes’ the underestimated tail density of the Poisson.</p>
<p>Examples of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003494.e064" xlink:type="simple"/></inline-formula> function for various ENCODE assays are shown as <xref ref-type="supplementary-material" rid="pcbi.1003494.s001">Figure S1</xref>.</p>
<p>Finally, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003494.e065" xlink:type="simple"/></inline-formula> contains a free parameter <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003494.e066" xlink:type="simple"/></inline-formula> which we can choose freely. While any <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003494.e067" xlink:type="simple"/></inline-formula> would be essentially equivalent, we choose to set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003494.e068" xlink:type="simple"/></inline-formula> to be the median of the latent density throughout our results.</p>
</sec><sec id="s5c">
<title>Rounding schemes</title>
<p>While some algorithms, such as CENTIPEDE <xref ref-type="bibr" rid="pcbi.1003494-PiqueRegi1">[31]</xref> for DNase-seq binding, can take weighted (fractional) read counts, many existing algorithms will only accept integral counts. We therefore develop two rounding schemes that can improve performance while providing integral counts.</p>
<p>The straightforward count flooring schemes, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003494.e069" xlink:type="simple"/></inline-formula> can be thought of as generalizations of de-duplication. In a typical DNase-seq experiment with 100 million reads, we find that flooring results in bases with 5 counts or less being de-duplicated, and those with 6 or more being reduced to two reads per base. While in the low-count cases, flooring is nearly identical to de-duplication, as sequencing depth increases, we expect our floored preprocessor to begin strongly outperforming de-duplication.</p>
<p>We also propose a more sophisticated randomized rounding scheme, where we take <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003494.e070" xlink:type="simple"/></inline-formula> and let <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003494.e071" xlink:type="simple"/></inline-formula> be a Bernoulli random variable with probability <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003494.e072" xlink:type="simple"/></inline-formula>, then the randomized round scheme generates simulated datasets whose counts round either up or down by the proximity of the adjusted count to its neighboring integers:<disp-formula id="pcbi.1003494.e073"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003494.e073" xlink:type="simple"/><label>(%)</label></disp-formula></p>
<p>We compared these schemes on DNase data, where the unsupervised classifier, CENTIPEDE, was capable of accepting weighted counts, allowing us to compare various rounding schemes to the direct weighting scheme using the same comparison method as our DNase-seq results. The results in <xref ref-type="fig" rid="pcbi-1003494-g007">Figure 7</xref> show that floored counts provides a statistically significant, but similar, performance to de-duplication and randomized rounding strictly improves upon both schemes. Rounding is relatively dependent on the number of randomly-sampled replicates, with around thirty samples needed to achieve its peak performance. The peak performance achieved by weighted counts is not achievable by any rounding scheme, but we find randomized rounding comes relatively close.</p>
<fig id="pcbi-1003494-g007" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003494.g007</object-id><label>Figure 7</label><caption>
<title>Performance comparison of rounding schemes on unsupervised DNase binding prediction.</title>
<p>All rounding schemes outperform baseline methods (bottom left) but only randomized rounding approaches performance of the weighted counts (top right).</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003494.g007" position="float" xlink:type="simple"/></fig></sec><sec id="s5d">
<title>Availability</title>
<p>F<sc>ixseq</sc> is freely available for download at <ext-link ext-link-type="uri" xlink:href="http://cgs.csail.mit.edu/fixseq" xlink:type="simple">http://cgs.csail.mit.edu/fixseq</ext-link>.</p>
</sec></sec><sec id="s6">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1003494.s001" mimetype="application/postscript" xlink:href="info:doi/10.1371/journal.pcbi.1003494.s001" position="float" xlink:type="simple"><label>Figure S1</label><caption>
<p><bold>Examples of latent </bold><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003494.e074" xlink:type="simple"/></inline-formula><bold> distributions and mapping function.</bold> Panel (a) shows the latent distribution of log-lambdas for various assays, while panel (b) plots the mapping function for various assays.</p>
<p>(EPS)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003494.s002" mimetype="application/postscript" xlink:href="info:doi/10.1371/journal.pcbi.1003494.s002" position="float" xlink:type="simple"><label>Figure S2</label><caption>
<p><bold>Comparison to a covariate-based correction method.</bold> A comparison of rank correlation between replicate experiments is plotted for F<sc>ixseq</sc>, BEADS, and the two methods run in series. Measurements within each boxplot are computed via bootstrapping.</p>
<p>(EPS)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003494.s003" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003494.s003" position="float" xlink:type="simple"><label>Table S1</label><caption>
<p><bold>Comparison to a specialized ChIP-seq event caller.</bold> Correlation in q-value across replicates is shown for a set of hESC CTCF ChIP-seq experiments, with varying count preprocessing schemes.</p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003494.s004" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003494.s004" position="float" xlink:type="simple"><label>Table S2</label><caption>
<p><bold>Analyzed ChIP-seq experiments.</bold> Accession numbers and details for ChIP-seq experiments.</p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003494.s005" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003494.s005" position="float" xlink:type="simple"><label>Table S3</label><caption>
<p><bold>Analyzed RNA-seq experiments.</bold> Accession numbers and details for RNA-seq experiments.</p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003494.s006" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003494.s006" position="float" xlink:type="simple"><label>Table S4</label><caption>
<p><bold>Analyzed DNase-seq experiments.</bold> Accession numbers and details for DNase-seq experiments.</p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003494.s007" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003494.s007" position="float" xlink:type="simple"><label>Text S1</label><caption>
<p><bold>Supplementary methods.</bold> Supplementary results and a description of data sources and processing.</p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003494.s008" mimetype="application/zip" xlink:href="info:doi/10.1371/journal.pcbi.1003494.s008" position="float" xlink:type="simple"><label>Dataset S1</label><caption>
<p><bold>Software.</bold> Code, documentation, and test data implementing the F<sc>ixseq</sc> method.</p>
<p>(ZIP)</p>
</caption></supplementary-material></sec></body>
<back><ref-list>
<title>References</title>
<ref id="pcbi.1003494-Wold1"><label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wold</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Myers</surname><given-names>R</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>Sequence census methods for functional genomics</article-title>. <source>Nature Methods</source> <volume>5</volume>: <fpage>19</fpage>–<lpage>21</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003494-Park1"><label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Park</surname><given-names>P</given-names></name> (<year>2009</year>) <article-title>Chip–seq: advantages and challenges of a maturing technology</article-title>. <source>Nature Reviews Genetics</source> <volume>10</volume>: <fpage>669</fpage>–<lpage>680</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003494-Wang1"><label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wang</surname><given-names>Z</given-names></name>, <name name-style="western"><surname>Gerstein</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Snyder</surname><given-names>M</given-names></name> (<year>2009</year>) <article-title>Rna-seq: a revolutionary tool for transcriptomics</article-title>. <source>Nature Reviews Genetics</source> <volume>10</volume>: <fpage>57</fpage>–<lpage>63</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003494-Ozsolak1"><label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ozsolak</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Milos</surname><given-names>PM</given-names></name> (<year>2010</year>) <article-title>Rna sequencing: advances, challenges and opportunities</article-title>. <source>Nature Reviews Genetics</source> <volume>12</volume>: <fpage>87</fpage>–<lpage>98</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003494-Boyle1"><label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Boyle</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Davis</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Shulha</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Meltzer</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Margulies</surname><given-names>E</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>High-resolution mapping and characterization of open chromatin across the genome</article-title>. <source>Cell</source> <volume>132</volume>: <fpage>311</fpage>–<lpage>322</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003494-Neph1"><label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Neph</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Vierstra</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Stergachis</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Reynolds</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Haugen</surname><given-names>E</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>An expansive human regulatory lexicon encoded in transcription factor footprints</article-title>. <source>Nature</source> <volume>489</volume>: <fpage>83</fpage>–<lpage>90</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003494-Anders1"><label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Anders</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Huber</surname><given-names>W</given-names></name> (<year>2010</year>) <article-title>Differential expression analysis for sequence count data</article-title>. <source>Genome Biology</source> <volume>11</volume>: <fpage>R106</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003494-Spyrou1"><label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Spyrou</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Stark</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Lynch</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Tavare</surname><given-names>S</given-names></name> (<year>2009</year>) <article-title>Bayespeak: Bayesian analysis of chip-seq data</article-title>. <source>BMC Bioinformatics</source> <volume>10</volume>: <fpage>299</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003494-Ji1"><label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ji</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Jiang</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Ma</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Johnson</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Myers</surname><given-names>R</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>An integrated software system for analyzing chip-chip and chip-seq data</article-title>. <source>Nature Biotechnology</source> <volume>26</volume>: <fpage>1293</fpage>–<lpage>1300</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003494-Guo1"><label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Guo</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Mahony</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Gifford</surname><given-names>DK</given-names></name> (<year>2012</year>) <article-title>High resolution genome wide binding event finding and motif discovery reveals transcription factor spatial binding constraints</article-title>. <source>PLoS computational biology</source> <volume>8</volume>: <fpage>e1002638</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003494-Pepke1"><label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pepke</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Wold</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Mortazavi</surname><given-names>A</given-names></name> (<year>2009</year>) <article-title>Computation for chip-seq and rna-seq studies</article-title>. <source>Nature methods</source> <volume>6</volume>: <fpage>S22</fpage>–<lpage>S32</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003494-Jones1"><label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jones</surname><given-names>DC</given-names></name>, <name name-style="western"><surname>Ruzzo</surname><given-names>WL</given-names></name>, <name name-style="western"><surname>Peng</surname><given-names>X</given-names></name>, <name name-style="western"><surname>Katze</surname><given-names>MG</given-names></name> (<year>2012</year>) <article-title>A new approach to bias correction in rna-seq</article-title>. <source>Bioinformatics</source> <volume>28</volume>: <fpage>921</fpage>–<lpage>928</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003494-Skelly1"><label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Skelly</surname><given-names>DA</given-names></name>, <name name-style="western"><surname>Johansson</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Madeoy</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Wakefield</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Akey</surname><given-names>JM</given-names></name> (<year>2011</year>) <article-title>A powerful and exible statistical framework for testing hypotheses of allele-specific gene expression from rna-seq data</article-title>. <source>Genome research</source> <volume>21</volume>: <fpage>1728</fpage>–<lpage>1737</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003494-Srivastava1"><label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Srivastava</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Chen</surname><given-names>L</given-names></name> (<year>2010</year>) <article-title>A two-parameter generalized poisson model to improve the analysis of RNA-seq data</article-title>. <source>Nucleic acids research</source> <volume>38</volume>: <fpage>e170</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003494-Li1"><label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Li</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Jiang</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Wong</surname><given-names>WH</given-names></name> (<year>2010</year>) <article-title>Modeling non-uniformity in short-read rates in rna-seq data</article-title>. <source>Genome Biology</source> <volume>11</volume>: <fpage>R50</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003494-Roberts1"><label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Roberts</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Trapnell</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Donaghey</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Rinn</surname><given-names>JL</given-names></name>, <name name-style="western"><surname>Pachter</surname><given-names>L</given-names></name> (<year>2011</year>) <article-title>Improving rna-seq expression estimates by correcting for fragment bias</article-title>. <source>Genome Biology</source> <volume>12</volume>: <fpage>R22</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003494-Hansen1"><label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hansen</surname><given-names>KD</given-names></name>, <name name-style="western"><surname>Brenner</surname><given-names>SE</given-names></name>, <name name-style="western"><surname>Dudoit</surname><given-names>S</given-names></name> (<year>2010</year>) <article-title>Biases in illumina transcriptome sequencing caused by random hexamer priming</article-title>. <source>Nucleic acids research</source> <volume>38</volume>: <fpage>e131</fpage>–<lpage>e131</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003494-Bullard1"><label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bullard</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Purdom</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Hansen</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Dudoit</surname><given-names>S</given-names></name> (<year>2010</year>) <article-title>Evaluation of statistical methods for normalization and differential expression in mrna-seq experiments</article-title>. <source>BMC bioinformatics</source> <volume>11</volume>: <fpage>94</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003494-Cheung1"><label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cheung</surname><given-names>MS</given-names></name>, <name name-style="western"><surname>Down</surname><given-names>TA</given-names></name>, <name name-style="western"><surname>Latorre</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Ahringer</surname><given-names>J</given-names></name> (<year>2011</year>) <article-title>Systematic bias in high-throughput sequencing data and its correction by beads</article-title>. <source>Nucleic acids research</source> <volume>39</volume>: <fpage>e103</fpage>–<lpage>e103</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003494-Yaffe1"><label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yaffe</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Tanay</surname><given-names>A</given-names></name> (<year>2011</year>) <article-title>Probabilistic modeling of hi-c contact maps eliminates systematic biases to characterize global chromosomal architecture</article-title>. <source>Nature genetics</source> <volume>43</volume>: <fpage>1059</fpage>–<lpage>1065</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003494-Li2"><label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Li</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Jiang</surname><given-names>T</given-names></name> (<year>2012</year>) <article-title>Transcriptome assembly and isoform expression level estimation from biased rna-seq reads</article-title>. <source>Bioinformatics</source> <volume>28</volume>: <fpage>2914</fpage>–<lpage>2921</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003494-Imakaev1"><label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Imakaev</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Fudenberg</surname><given-names>G</given-names></name>, <name name-style="western"><surname>McCord</surname><given-names>RP</given-names></name>, <name name-style="western"><surname>Naumova</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Goloborodko</surname><given-names>A</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Iterative correction of hi-c data reveals hallmarks of chromosome organization</article-title>. <source>Nature Methods</source> <volume>9</volume>: <fpage>999</fpage>–<lpage>1003</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003494-Benjamini1"><label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Benjamini</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Speed</surname><given-names>TP</given-names></name> (<year>2012</year>) <article-title>Summarizing and correcting the gc content bias in high-throughput sequencing</article-title>. <source>Nucleic acids research</source> <volume>40</volume>: <fpage>e72</fpage>–<lpage>e72</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003494-Thygesen1"><label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Thygesen</surname><given-names>HH</given-names></name>, <name name-style="western"><surname>Zwinderman</surname><given-names>AH</given-names></name> (<year>2006</year>) <article-title>Modeling sage data with a truncated gamma-poisson model</article-title>. <source>BMC bioinformatics</source> <volume>7</volume>: <fpage>157</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003494-Bliss1"><label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bliss</surname><given-names>CI</given-names></name>, <name name-style="western"><surname>Fisher</surname><given-names>RA</given-names></name> (<year>1953</year>) <article-title>Fitting the negative binomial distribution to biological data</article-title>. <source>Biometrics</source> <volume>9</volume>: <fpage>176</fpage>–<lpage>200</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003494-Bulmer1"><label>26</label>
<mixed-citation publication-type="other" xlink:type="simple">Bulmer M (1974) On fitting the poisson lognormal distribution to species-abundance data. Biometrics: 101–110.</mixed-citation>
</ref>
<ref id="pcbi.1003494-Chen1"><label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Chen</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Negre</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Li</surname><given-names>Q</given-names></name>, <name name-style="western"><surname>Mieczkowska</surname><given-names>JO</given-names></name>, <name name-style="western"><surname>Slattery</surname><given-names>M</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Systematic evaluation of factors inuencing ChIP-seq fidelity</article-title>. <source>Nature Methods</source> <volume>9</volume>: <fpage>609</fpage>–<lpage>614</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003494-Wilbanks1"><label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wilbanks</surname><given-names>EG</given-names></name>, <name name-style="western"><surname>Facciotti</surname><given-names>MT</given-names></name> (<year>2010</year>) <article-title>Evaluation of algorithm performance in ChIP-Seq peak detection</article-title>. <source>PLoS ONE</source> <volume>5</volume>: <fpage>e11471</fpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0011471" xlink:type="simple">10.1371/journal.pone.0011471</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1003494-Zhang1"><label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zhang</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Liu</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Meyer</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Eeckhoute</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Johnson</surname><given-names>D</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>Model-based analysis of chip-seq (macs)</article-title>. <source>Genome Biology</source> <volume>9</volume>: <fpage>R137</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003494-Kharchenko1"><label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kharchenko</surname><given-names>PV</given-names></name>, <name name-style="western"><surname>Tolstorukov</surname><given-names>MY</given-names></name>, <name name-style="western"><surname>Park</surname><given-names>PJ</given-names></name> (<year>2008</year>) <article-title>Design and analysis of ChIP-seq experiments for DNA-binding proteins</article-title>. <source>Nature Biotechnology</source> <volume>26</volume>: <fpage>1351</fpage>–<lpage>1359</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003494-PiqueRegi1"><label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pique-Regi</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Degner</surname><given-names>JF</given-names></name>, <name name-style="western"><surname>Pai</surname><given-names>AA</given-names></name>, <name name-style="western"><surname>Gaffney</surname><given-names>DJ</given-names></name>, <name name-style="western"><surname>Gilad</surname><given-names>Y</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Accurate inference of transcription factor binding from DNA sequence and chromatin accessibility data</article-title>. <source>Genome Research</source> <volume>21</volume>: <fpage>447</fpage>–<lpage>455</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003494-Khatun1"><label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Khatun</surname><given-names>J</given-names></name> (<year>2012</year>) <article-title>An integrated encyclopedia of dna elements in the human genome</article-title>. <source>Nature</source> <volume>489</volume>: <fpage>57</fpage>–<lpage>74</lpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature11247" xlink:type="simple">10.1038/nature11247</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1003494-Rozowsky1"><label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rozowsky</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Euskirchen</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Auerbach</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Zhang</surname><given-names>Z</given-names></name>, <name name-style="western"><surname>Gibson</surname><given-names>T</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>Peakseq enables systematic scoring of chip-seq experiments relative to controls</article-title>. <source>Nature Biotechnology</source> <volume>27</volume>: <fpage>66</fpage>–<lpage>75</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003494-Landt1"><label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Landt</surname><given-names>SG</given-names></name>, <name name-style="western"><surname>Marinov</surname><given-names>GK</given-names></name>, <name name-style="western"><surname>Kundaje</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Kheradpour</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Pauli</surname><given-names>F</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>ChIP-seq guidelines and practices of the ENCODE and modENCODE consortia</article-title>. <source>Genome Research</source> <volume>22</volume>: <fpage>1813</fpage>–<lpage>1831</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003494-Cule1"><label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cule</surname><given-names>M</given-names></name> (<year>2010</year>) <article-title>Theoretical properties of the log-concave maximum likelihood estimator of a mul-tidimensional density</article-title>. <source>Electronic Journal of Statistics</source> <volume>4</volume>: <fpage>254</fpage>–<lpage>270</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003494-Chang1"><label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Chang</surname><given-names>GT</given-names></name>, <name name-style="western"><surname>Walther</surname><given-names>G</given-names></name> (<year>2007</year>) <article-title>Clustering with mixtures of log-concave distributions</article-title>. <source>Computational Statistics &amp; Data Analysis</source> <volume>51</volume>: <fpage>6242</fpage>–<lpage>6251</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003494-Walther1"><label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Walther</surname><given-names>G</given-names></name> (<year>2009</year>) <article-title>Inference and modeling with log-concave distributions</article-title>. <source>Statistical Science</source> <volume>24</volume>: <fpage>319</fpage>–<lpage>327</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003494-Nesterov1"><label>38</label>
<mixed-citation publication-type="book" xlink:type="simple">Nesterov Y (2003) Introductory Lectures on Convex Optimization: A Basic Course. Springer.</mixed-citation>
</ref>
<ref id="pcbi.1003494-Hildreth1"><label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hildreth</surname><given-names>C</given-names></name> (<year>1954</year>) <article-title>Point estimates of ordinates of concave functions</article-title>. <source>Journal of the American Statistical Association</source> <volume>49</volume>: <fpage>598</fpage>.</mixed-citation>
</ref>
</ref-list></back>
</article>