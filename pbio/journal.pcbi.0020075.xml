<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN"><front><journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="publisher">pcbi</journal-id><journal-id journal-id-type="flc">plcb</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher><publisher-name>Public Library of Science</publisher-name><publisher-loc>San Francisco, USA</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.1371/journal.pcbi.0020075</article-id><article-id pub-id-type="publisher-id">05-PLCB-RA-0295R3</article-id><article-id pub-id-type="sici">plcb-02-07-08</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline"><subject>Computational Biology</subject><subject>Evolutionary Biology</subject><subject>Genetics and Genomics</subject><subject>Genetics and Genomics/Comparative Genomics</subject><subject>Evolutionary Biology</subject></subj-group><subj-group subj-group-type="System Taxonomy"><subject>Eubacteria</subject></subj-group></article-categories><title-group><article-title>An Integrative Method for Accurate Comparative Genome Mapping</article-title><alt-title alt-title-type="running-head">An Comparative Genome Mapping Method</alt-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Swidan</surname><given-names>Firas</given-names></name><xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref><xref ref-type="aff" rid="aff2">
            <sup>2</sup>
          </xref><xref ref-type="corresp" rid="cor1">
            <sup>*</sup>
          </xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Rocha</surname><given-names>Eduardo P. C</given-names></name><xref ref-type="aff" rid="aff3">
            <sup>3</sup>
          </xref><xref ref-type="aff" rid="aff4">
            <sup>4</sup>
          </xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Shmoish</surname><given-names>Michael</given-names></name><xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Pinter</surname><given-names>Ron Y</given-names></name><xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref></contrib></contrib-group><aff id="aff1">
				<label>1</label><addr-line> Department of Computer Science, Technion, Israel Institute of Technology, Haifa, Israel
			</addr-line></aff><aff id="aff2">
				<label>2</label><addr-line> Janelia Farm Research Center, Howard Hughes Medical Institute, Ashburn, Virginia, United States of America
			</addr-line></aff><aff id="aff3">
				<label>3</label><addr-line> Atelier de Bioinformatique, University Paris VI, Paris, France
			</addr-line></aff><aff id="aff4">
				<label>4</label><addr-line> Unité GGB, Institut Pasteur, Paris, France
			</addr-line></aff><contrib-group><contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Pevzner</surname><given-names>Pavel</given-names></name><role>Editor</role><xref ref-type="aff" rid="edit1"/></contrib></contrib-group><aff id="edit1">University of California San Diego, United States of America</aff><author-notes><fn fn-type="con"><p>FS, EPCR, and RYP conceived and designed the experiments. FS performed the experiments. FS, EPCR, MS, and RYP analyzed the data. FS and MS contributed reagents/materials/analysis tools. FS, EPCR, and RYP wrote the paper.</p></fn><corresp id="cor1">* To whom correspondence should be addressed. E-mail: <email xlink:type="simple">Swidanf@janelia.hhmi.org</email></corresp><fn fn-type="conflict" id="ack3"><p> The authors have declared that no competing interests exist.</p></fn></author-notes><pub-date pub-type="ppub"><month>8</month><year>2006</year></pub-date><pub-date pub-type="epub"><day>4</day><month>8</month><year>2006</year></pub-date><pub-date pub-type="epreprint"><day>15</day><month>5</month><year>2006</year></pub-date><volume>2</volume><issue>8</issue><elocation-id>e75</elocation-id><history><date date-type="received"><day>21</day><month>10</month><year>2005</year></date><date date-type="accepted"><day>15</day><month>5</month><year>2006</year></date></history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2006</copyright-year><copyright-holder>Swidan et al</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract><p>We present MAGIC, an integrative and accurate method for comparative genome mapping. Our method consists of two phases: <italic>preprocessing</italic> for identifying “maximal similar segments,” and <italic>mapping</italic> for clustering and classifying these segments. MAGIC's main novelty lies in its biologically intuitive clustering approach, which aims towards both calculating reorder-free segments and identifying orthologous segments. In the process, MAGIC efficiently handles ambiguities resulting from duplications that occurred before the speciation of the considered organisms from their most recent common ancestor. We demonstrate both MAGIC's robustness and scalability: the former is asserted with respect to its initial input and with respect to its parameters' values. The latter is asserted by applying MAGIC to distantly related organisms and to large genomes. We compare MAGIC to other comparative mapping methods and provide detailed analysis of the differences between them. Our improvements allow a comprehensive study of the diversity of genetic repertoires resulting from large-scale mutations, such as indels and duplications, including explicitly transposable and phagic elements. The strength of our method is demonstrated by detailed statistics computed for each type of these large-scale mutations. MAGIC enabled us to conduct a comprehensive analysis of the different forces shaping prokaryotic genomes from different clades, and to quantify the importance of novel gene content introduced by horizontal gene transfer relative to gene duplication in bacterial genome evolution. We use these results to investigate the breakpoint distribution in several prokaryotic genomes.</p></abstract><abstract abstract-type="synopsis"><title>Synopsis</title><p>Comparative genomics is an important discipline with applications in evolutionary, genetic, and genome rearrangement studies. When comparing genomes, one is usually interested in investigating the relation between the genomic segments to establish their evolutionary origin: are the segments orthologous, and hence inherited from their most recent common ancestor? Are they paralogs, and hence duplicated from an ancestral segment? Did the segments undergo reordering? Were the segments deleted or inserted and—if so—how (insertion sequence, prophage, horizontal gene transfer)?</p><p>In this paper, Swidan et al. present MAGIC, a new approach for comparative genome mapping. The main novelty of this approach is the biologically intuitive clustering step, which aims towards both calculating reorder-free segments and identifying orthologous segments. The authors demonstrate MAGIC's robustness, relative to both its initial input and to its parameters' values. MAGIC's scalability is demonstrated by running it on distantly related organisms and on large genomes. In addition, Swidan et al. provide a detailed analysis of the differences between MAGIC and other comparative mapping methods.</p><p>Applying MAGIC to several prokaryotic pairs enabled the authors to address the aforementioned questions and to quantitatively study the different evolutionary forces shaping the prokaryotic genome as well as to investigate their breakpoint distribution.</p></abstract><funding-group><funding-statement>Firas Swidan was supported in part by a Fellowship from the Planning and Budgeting Committee of the Council for Higher Education in Israel. Eduardo Rocha is supported in part by an ACI IMPBIO grant EVOLREP. Michael Shmoish is supported by the Center of Knowledge for Bioinformatics Infrastructure sponsored by the Israeli Ministry of Science and Technology.</funding-statement></funding-group><counts><page-count count="20"/></counts><!--===== Restructure custom-meta-wrap to custom-meta-group =====--><custom-meta-group><custom-meta><meta-name>citation</meta-name><meta-value>Swidan F, Rocha EPC, Shmoish M, Pinter RY (2006) An integrative method for accurate comparative genome mapping. PLoS Comput Biol 2(8): e75. DOI: <ext-link ext-link-type="doi" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.0020075" xlink:type="simple">10.1371/journal.pcbi.0020075</ext-link></meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1"><title>Introduction</title><p>In the context of <italic>comparative genome mapping,</italic> one seeks to identify “homologous” segments in different genomes and to classify them into orthologs and paralogs, as well as to identify segments “free of reordering.” Segments belonging to different genomes are said to be <italic>homologous</italic> if they descend from a single common ancestral segment [<xref ref-type="bibr" rid="pcbi-0020075-b001">1</xref>–<xref ref-type="bibr" rid="pcbi-0020075-b003">3</xref>]. Segments belonging to different genomes are said to be <italic>free of reordering</italic> or <italic>reorder free</italic> (RF) if they were not reordered in the different genomes relative to their <italic>cenancestor,</italic> i.e., their most recent common ancestor [<xref ref-type="bibr" rid="pcbi-0020075-b002">2</xref>]. RF segments may contain large indels, resulting, for example, from deletions, duplications, horizontal gene transfer (HGT), or selfish DNA. Thus, in the context of comparative genome mapping, one attempts to achieve a detailed description of the common and different parts between whole genomes with respect to large-scale mutations. This description, along with a characterization of point mutations in homologous segments, enables us to study the relative frequency and the effect of the different types of mutations (or forces) shaping the evolution of the genomes. Since the biological events considered in the comparative mapping problem are substantially different from those considered in the alignment problem, neither global alignment nor local alignment techniques are sufficient to address it.</p><p>Most of the pioneering studies considered the problem of comparative mapping over sets of genes instead of arbitrary genomic segments. These methods start, usually, by calculating an all-against-all alignment of common sets of genes (a preprocessing phase), and then, in a second phase, use clustering techniques to predict operons or collinear blocks. Such approaches include Lamarck, the P-quasi complete linkage approach, ADHoRe, EM_TRAILS, STRING, and other methods [<xref ref-type="bibr" rid="pcbi-0020075-b004">4</xref>–<xref ref-type="bibr" rid="pcbi-0020075-b010">10</xref>]. This approach was also applied in yeast for the automatic discovery of regulatory motifs [<xref ref-type="bibr" rid="pcbi-0020075-b011">11</xref>]. Later, comparative mapping methods over arbitrary genomic segments were developed. The preprocessing phase in these methods consists of searching for similar genomic segments—referred to as <italic>hits, markers,</italic> or <italic>anchors</italic> (usually performed by a fast local alignment procedure). Then, in the mapping phase, a clustering procedure is applied to the output of the first phase. Examples of fast seed-based preprocessing phases include BLASTZ and CHAOS [<xref ref-type="bibr" rid="pcbi-0020075-b012">12</xref>,<xref ref-type="bibr" rid="pcbi-0020075-b013">13</xref>], in which the seeds are allowed to contain degeneracy, as well as that of Mauve, which searches for exact and unique matches [<xref ref-type="bibr" rid="pcbi-0020075-b014">14</xref>]. Examples for mapping phases include CHAIN-NET, FISH, GRIMM-Synteny, Mauve (as well as GRIL—its predecessor), and SLAGAN [<xref ref-type="bibr" rid="pcbi-0020075-b013">13</xref>–<xref ref-type="bibr" rid="pcbi-0020075-b018">18</xref>]; for a mini-review see [<xref ref-type="bibr" rid="pcbi-0020075-b019">19</xref>]. CHAIN-NET and GRIMM-Synteny use the distance between anchors as a criterion for clustering (and hence are referred to as <italic>distance-based</italic> mapping methods). Mauve and SLAGAN rely on solving (different) optimization problems to prune anchors and to define the mapping. SLAGAN prunes anchors by introducing various gap penalties for discriminating between different subsets. Finally, FISH is based on a statistical model for anchor clustering.</p><p>Here we present MAGIC, an integrative and accurate tool for comparative genome mapping. MAGIC consists of two independent phases: a preprocessing phase, in which we compute a <italic>comprehensive</italic> table of all <italic>maximal similar segments</italic> (see Preprocessing Phase: Building a Comprehensive Table of Similar Segments), and a mapping phase for clustering the table into RF regions. MAGIC's clustering approach is based on a new definition of “consecutive homologous segments” which relies on a biologically intuitive ordering of similar segments (see Mapping Phase: Clustering into RF Segments). It enables a better handling of duplications in general and allows us to adequately address the problem of “nuisance cross-overlaps,” i.e<italic>.</italic>, misleading similarities between duplications that occurred before the most recent common ancestor (see <xref ref-type="fig" rid="pcbi-0020075-g001">Figures 1</xref> and <xref ref-type="fig" rid="pcbi-0020075-g002">2</xref> for examples). Nuisance cross-overlaps can introduce significant artifacts in the mapping (see False Anchors and A Comparison with Mauve's Results for examples), and, to the best of our knowledge, were not taken explicitly into account before. MAGIC is also robust with respect to both its parameters' values and the initial set of anchors (see MAGIC's Robustness). It is capable of modifying and refining the mapping induced from the anchors and even recognizing and reassigning false orthologs in the initial anchor set itself (see False Anchors). Furthermore, MAGIC is scalable and can be applied to distantly related pairs and to large genomes (see MAGIC's Scalability). Finally, our approach is explicitly designed to handle circular genomes (by considering the last and first nucleotides to be successive). The output of our algorithm consists of detailed coverage statistics of the genomes and of several tables including a one-to-one table describing the RF segments.</p><fig id="pcbi-0020075-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0020075.g001</object-id><label>Figure 1</label><caption><title>A Hypothetical Example Demonstrating the Definition of Positional Orthologs and the Emergence of a Nuisance Cross-Overlap</title><p>A portion of the genomic segments in a hypothetical cenancestor is denoted by letters. Their orthologous segments in the descendant organisms org1 and org2 are given, using the same letters, but in different font (to stress that the segments, despite being orthologous, are similar but not identical). The scenario described in this example is as follows: a duplication of a genomic segment results in two duplicates <italic>b</italic><sub>1</sub> and <italic>b</italic><sub>2</sub> in the cenancestor. During the speciation of org1 and org2 the cenancestor genomic segments are shuffled. The orthologous segments <bold>b1</bold> and b1 have similar genomic contexts and are thus positional orthologs. Similary <bold>b2</bold> and b2 are positional orthologs as well. When comparatively mapping org1 and org2, one would find that <bold>b1</bold> is similar to b2 and <bold>b2</bold> is similar to b1. These hits obscure the deduction of the true evolutionary relation between <bold>b1</bold> and b1 as well as between <bold>b2</bold> and b2, and are referred to as nuisance cross-overlaps. In real biological examples, similar situations arise, e.g., because of rDNAs; see <xref ref-type="fig" rid="pcbi-0020075-g002">Figure 2</xref>. Notice also that, unlike in sequence alignment, and as is demonstrated in this example, duplications that occurred <italic>before</italic> the cenancestor (referred to sometimes as <italic>outparalogs</italic> [<xref ref-type="bibr" rid="pcbi-0020075-b003">3</xref>]) may cause hardships when comparatively mapping two organisms. Thus, nuisance cross-overlaps can be thought of as an “ancestral curse.”</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020075.g001" xlink:type="simple"/></fig><fig id="pcbi-0020075-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0020075.g002</object-id><label>Figure 2</label><caption><title>Schematic Examples of Situations That May Be Encountered While Clustering Entries of the Comprehensive Table (Steps 2 and 3 in the Mapping Phase)</title><p>An entry is represented as two arrows having the same label, one in the top and one in the bottom panels. Labels for the arrows are given on the left side. The relative direction of identically labeled arrows represents the relative orientation of the corresponding segments.</p><p>(A) A real example from the comparison of <named-content content-type="genus-species" xlink:type="simple">E. coli</named-content> versus <named-content content-type="genus-species" xlink:type="simple">S. typhi</named-content> ty2 demonstrating the difficulty of identifying the consecutive entry. In the top (bottom) panels, the positions of the segments in <named-content content-type="genus-species" xlink:type="simple">S. typhi</named-content> ty2 (<named-content content-type="genus-species" xlink:type="simple">E. coli</named-content>) are given. Arrows having the same label are drawn with identical grayscale color. The significantly overlapping entries, e.g<italic>.</italic>, 2 and 3 in <italic>E. coli,</italic> correspond to rDNA operons, of which there are seven units in each organism. Each of these seven units have a hit overlapping, for example Entry 2 in both top and bottom panels. For the sake of clarity, the figure demonstrates only a part of the hits and is schematic (not to scale).</p><p>(B) Illustration of nuisance cross-overlaps and inparalogs. Entry 2 overlaps with Entry 1 in org1 and with Entry 3 in org2. Assuming that both overlaps are long enough and that Entry 2 is significantly shorter than either Entry 1 or Entry 3, Entry 2 is considered as a nuisance cross-overlap. On the other hand, Entry 4 overlaps Entry 1 in org2, but does not overlap with other entries in org1, and hence is not a nuisance cross-overlap. Assuming the length of Entry 1 is significantly greater than that of Entry 4, Entry 1 is considered to be the positional ortholog, while Entry 4 is considered to be the inparalog.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020075.g002" xlink:type="simple"/></fig><p>We have applied our method to several prokaryotic pairs spanning different branches of the tree of life. Due to the quality of their sequences, annotations, and the availability of many closely related sequenced species, prokaryotic genomes are very good models to test the quality of the mapping. MAGIC's analysis of the different forces shaping these genomes shows that lateral transfer and large deletions affect them significantly more than duplications (see Major Forces Shaping the Prokaryotic Genome). Furthermore, we utilized MAGIC's results to analyze the breakpoint distribution in bacteria. Previous studies, on <named-content content-type="genus-species" xlink:type="simple">Salmonella typhimurium</named-content> [<xref ref-type="bibr" rid="pcbi-0020075-b020">20</xref>,<xref ref-type="bibr" rid="pcbi-0020075-b021">21</xref>] and on <named-content content-type="genus-species" xlink:type="simple">Escherichia coli</named-content> [<xref ref-type="bibr" rid="pcbi-0020075-b022">22</xref>,<xref ref-type="bibr" rid="pcbi-0020075-b023">23</xref>], have shown that they contain noninvertible (or nonpermissive) segments. For some of these segments, forcing an inversion by mechanisms different from those found in the cell resulted in organisms that are viable and that grow normally [<xref ref-type="bibr" rid="pcbi-0020075-b024">24</xref>]. Thus, these studies suggest that the mechanisms of reordering in these bacteria may inherently cause deviations from a uniform breakpoint distribution [<xref ref-type="bibr" rid="pcbi-0020075-b020">20</xref>]. In addition, reorderings in bacterial genomes are constrained by the viability and fitness of the resulting organisms. These selection constraints result in operons and in the large-scale organization of the genome relative to replication [<xref ref-type="bibr" rid="pcbi-0020075-b025">25</xref>]. Finally, repeats, a major element of genome disruptions caused by homologous recombination [<xref ref-type="bibr" rid="pcbi-0020075-b026">26</xref>], are by themselves recombination hotspots [<xref ref-type="bibr" rid="pcbi-0020075-b025">25</xref>,<xref ref-type="bibr" rid="pcbi-0020075-b027">27</xref>]. Surprisingly, however, statistical tests show that, in many pairs, the breakpoint distribution fits well to the uniform distribution (see Breakpoint Distribution section). This controversy extends the debate about the Nadeau-Taylor model and the existence of hotspots in mammalian genomes to prokaryotes [<xref ref-type="bibr" rid="pcbi-0020075-b017">17</xref>,<xref ref-type="bibr" rid="pcbi-0020075-b028">28</xref>–<xref ref-type="bibr" rid="pcbi-0020075-b035">35</xref>].</p><p>To relate our method to previous work, we give a detailed comparison between MAGIC's results and that of other well-known genome mapping tools (see A Comparison with Mauve's Procedure and A Comparison with Mauve's Results).</p><p>A C++ implementation of MAGIC and a Java-based graphical user interface (GUI) are under development. They will be made available at <ext-link ext-link-type="uri" xlink:href="http://magicmapping.sourceforge.net" xlink:type="simple">http://magicmapping.sourceforge.net</ext-link>.</p><sec id="s1a"><title>Terms and Definitions</title><p>The relation of being orthologous can be further refined to “positional orthology”—see <xref ref-type="fig" rid="pcbi-0020075-g001">Figure 1</xref>. Segments belonging to different genomes are said to be <italic>positional orthologs</italic> if they are orthologs and have preserved their relative positioning or genomic contexts in the genomes. The related term “positional homologs” was presented in [<xref ref-type="bibr" rid="pcbi-0020075-b036">36</xref>,<xref ref-type="bibr" rid="pcbi-0020075-b037">37</xref>] to refine the homology relation. The paralogy relation can be further refined to “outparalogs” and “inparalogs” [<xref ref-type="bibr" rid="pcbi-0020075-b003">3</xref>]: a segment that has duplicated before (after) the speciation from the cenancestor is referred to as an <italic>outparalog</italic> (<italic>inparalog</italic>). Outparalogs induce the phenomenon of nuisance cross-overlaps, complicating the comparative mapping (see <xref ref-type="fig" rid="pcbi-0020075-g001">Figure 1</xref>). Identifying inparalogs, on the other hand, is required to quantify the amount of duplications that occurred since the divergence of the taxa.</p></sec></sec><sec id="s2"><title>Results/Discussion</title><p>MAGIC's preprocessing phase constitutes a linear flow of global and local alignments and can be described as a cascade of five steps (<xref ref-type="fig" rid="pcbi-0020075-g003">Figure 3</xref>A). We first choose a set of anchors, which are joined into consecutive runs to serve as a first (likely inaccurate) table. Any set of anchors can be chosen. In the present analysis, we used the list of curated orthologs of KEGG (KO) [<xref ref-type="bibr" rid="pcbi-0020075-b038">38</xref>], since it is based on functional and positional information [<xref ref-type="bibr" rid="pcbi-0020075-b005">5</xref>], in addition to sequence similarity. Note, however, that the anchor set can be derived from other sources. For example, in the comparison with other comparative mapping methods, we have used their automatically generated output as a set of anchors (see A Comparison with Mauve's Results). The table is then refined by validating the similarity of existing correspondences (by global alignment) and extracting unmatched regions. This is followed by looking for new hits in the unmatched regions (by local alignment). Because of MAGIC's ability to discover and reassign “false” anchors (see False Anchors) and its robustness with respect to the initial set of anchors (see MAGIC'S Robustness), it is suitable to be used with any set of (noisy) anchors.</p><fig id="pcbi-0020075-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0020075.g003</object-id><label>Figure 3</label><caption><title>A Flow Diagram of MAGIC</title><p>(A) A flow diagram of the preprocessing phase (see Preprocessing Phase: Building a Comprehensive Table of Similar Segments).</p><p>(A1) A one-to-one table (anchors) between two genomes is used to calculate runs of anchors corresponding to potentially similar segments.</p><p>(A2) These segments are globally aligned to validate their similarity and to find unmatched regions (these regions are candidates for indels or reordering events).</p><p>(A3) The unmatched regions are extracted (the entries remaining in the table correspond thus to maximal similar segments) and aligned (including uncovered regions between the runs) locally against the other genome to search for new hits, in an attempt to make the table comprehensive.</p><p>(A4) Local hits are stitched together to form potentially similar segments.</p><p>(A5) These segments are globally aligned to validate their similarity and to extract unmatched regions out of them. The resulting table is comprehensive and consists of maximal similar segments.</p><p>(B) A flow diagram of the mapping phase (see Mapping Phase: Clustering into RF Segments).</p><p>(B1) Short entries and entries corresponding to known selfish DNA in either of the genomes are removed.</p><p>(B2) Consecutive entries are joined for the first time (which makes it easier to identify nuisance cross-overlaps and inparalogs).</p><p>(B3) Nuisance cross-overlaps (see Steps 3–5: Identifying nuisance, classifying inparalogs, and re-clustering and <xref ref-type="fig" rid="pcbi-0020075-g002">Figure 2</xref>) are identified and discarded.</p><p>(B4) Inparalogs are identified, classified, and removed from the table.</p><p>(B5) Consecutive entries are joined again (nuisances and inparalogs may have hindered joining some of the entries in the previous clustering). Steps B3–B5 are performed iteratively until the table converges (no more nuisance or inparalogs are identified).</p><p>(B6) Remaining conflicts (unresolved significant overlaps), corresponding most likely to selfish DNA, are removed.</p><p>(B7) Consecutive entries are joined for the final time (the conflicts removed in B6 may have hindered joining some of the entries in the previous clustering). The output of the mapping phase consists of several tables, among which are: a one-to-one table describing the RF segments, a one-to-one table describing the positional orthologous segments contained in the RF segments, a table of the classified inparalogs in each organism, and a table of identified transposable elements.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020075.g003" xlink:type="simple"/></fig><p>In the mapping phase (<xref ref-type="fig" rid="pcbi-0020075-g003">Figure 3</xref>B), the comprehensive table resulting from the preprocessing phase is cleaned from short entries and selfish DNA. Then a clustering technique is applied to the remaining entries to combine RF segments, determine positional orthologs, and classify inparalogs.</p><p>The design of the method aims towards maximizing the flexibility of replacing existing components with new ones as soon as those become available. Thus, for example, the anchor set can be chosen arbitrarily. Also, the local or global alignment programs from the preprocessing phase can be readily replaced. Eventually, the whole preprocessing phase can be replaced with another one.</p><p>In the following we present a description of the two phases; further details can be found in <xref ref-type="sec" rid="s3">Materials and Methods</xref>, as noted throughout. In the section Preprocessing Phase: Building a Comprehensive Table of Similar Segments, we describe the steps involved in the preprocessing phase (building the comprehensive table). Then, in Mapping Phase: Clustering into RF Segments, we describe the mapping phase. A summary of MAGIC's parameters is given in <xref ref-type="table" rid="pcbi-0020075-t001">Table 1</xref>. Tuning these parameters is discussed in Tuning the Parameters. Finally, in A Comparison with Mauve's Procedure, we compare our method to previous work. While some of the algorithms are based on existing tools (the dependencies are noted in the text), the rest was implemented as R [<xref ref-type="bibr" rid="pcbi-0020075-b039">39</xref>] and BASH scripts (a C++ implementation with a Java-based GUI are under development).</p><table-wrap content-type="1col" id="pcbi-0020075-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0020075.t001</object-id><label>Table 1</label><caption><p>A Summary of the Parameters Used in MAGIC</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020075.t001" xlink:type="simple"/><!-- <table frame="hsides" rules="none"><colgroup><col id="tb1col1" align="left" charoff="0" char=""/><col id="tb1col2" align="left" charoff="0" char=""/><col id="tb1col3" align="left" charoff="0" char=""/><col id="tb1col4" align="left" charoff="0" char=""/><col id="tb1col5" align="left" charoff="0" char=""/></colgroup><thead><tr><td align="left"><hr/>Phase</td><td valign="middle"><hr/>Parameter</td><td valign="middle"><hr/>Value</td><td valign="middle"><hr/>Parameter Used for</td><td valign="middle"><hr/>Parameter Used In Step</td></tr></thead><tbody><tr><td>Preprocessing phase</td><td valign="middle"><italic>gapJoinLen</italic></td><td valign="middle">110 bp</td><td valign="middle">Joining close gaps</td><td rowspan="1" valign="middle">Extracting unmatched regions from global alignments (Step 3)</td></tr><tr><td></td><td valign="middle"><italic>gapExtractLen</italic></td><td valign="middle">200 bp</td><td valign="middle">Extracting long unmatched regions</td><td rowspan="1" valign="middle">Extracting unmatched regions from global alignments (Step 3)</td></tr><tr><td></td><td valign="middle"><italic>stitchDifference</italic></td><td valign="middle">2,000 bp</td><td valign="middle">Finding hits having similar distances</td><td rowspan="1">Stitching hits resulting from local alignments and extracting long ones (Step 4)</td></tr><tr><td></td><td valign="middle"><italic>stitchDistance</italic></td><td valign="middle">15,000 bp</td><td valign="middle">Finding close hits</td><td rowspan="1">Stitching hits resulting from local alignments and extracting long ones (Step 4)</td></tr><tr><td></td><td valign="middle"><italic>stitchMinLen</italic></td><td valign="middle">200 bp</td><td valign="middle">Removing short stitched hits</td><td rowspan="1">Stitching hits resulting from local alignments and extracting long ones (Step 4)</td></tr><tr><td>Mapping phase</td><td valign="middle"><italic>cleanMinLen</italic></td><td valign="middle">200 bp</td><td valign="middle">Removing short entries</td><td rowspan="1">Cleaning the table (Step 1)</td></tr><tr><td></td><td valign="middle"><italic>cleanISPerc</italic></td><td valign="middle">40&percnt;</td><td valign="middle">Removing transposable elements</td><td rowspan="1">Cleaning the table (Step 1)</td></tr><tr><td></td><td valign="middle"><italic>cleanProPerc</italic></td><td valign="middle">40&percnt;</td><td valign="middle">Removing prophages</td><td rowspan="1">Cleaning the table (Step 1)</td></tr><tr><td></td><td valign="middle"><italic>dupPerc</italic></td><td valign="middle">50&percnt;</td><td valign="middle">Finding significant overlaps</td><td valign="middle">The mapping phase (Steps 2&ndash;7)</td></tr><tr><td></td><td><italic>orthPerc</italic></td><td>50&percnt;</td><td>Identifying positional orthologs</td><td valign="middle">Distinguishing positional orthologs from inparalogs (Step 4)</td></tr></tbody></table> --><!-- --></table-wrap><sec id="s2a"><title>Preprocessing Phase: Building a Comprehensive Table of Similar Segments</title><p>Here we describe Steps 1–5 of the preprocessing phase (see <xref ref-type="fig" rid="pcbi-0020075-g003">Figure 3</xref>A) in detail. Some of our steps require a more complicated mathematical formalism so as to be well-defined. For these, the formal definitions are given in <xref ref-type="sec" rid="s3">Materials and Methods</xref>.</p><sec id="s2a1"><title>Step 1: Generating runs of anchors.</title><p>To generate a first coarse mapping, we join consecutive anchors into runs: given two genomes, we generate <italic>permutations</italic> of signed elements [<xref ref-type="bibr" rid="pcbi-0020075-b017">17</xref>] based on their common unique anchors, e.g., KOs—see <xref ref-type="fig" rid="pcbi-0020075-g004">Figure 4</xref>. The signs represent the relative orientation of the KOs in the two genomes. The two permutations are renamed so that one becomes the identity permutation (with positive elements). The other permutation is then searched for maximal runs of consecutive numbers (while taking their signs into account). We refer to a genomic segment corresponding to such a run as a <italic>KO-induced segment</italic> (KIS). The procedure is illustrated in <xref ref-type="fig" rid="pcbi-0020075-g004">Figure 4</xref>.</p><fig id="pcbi-0020075-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0020075.g004</object-id><label>Figure 4</label><caption><title>Renaming Common Anchors in Genomes org1 and org2 to Permutations perm1 and perm2 (Step 1 of the Preprocessing Phase)</title><p>The genome org1 is renamed to the identity permutation (perm1) and the genome org2 is renamed accordingly. Runs of consecutive numbers in perm2 are combined (with respect to their signs) into KISs. A negative sign preceding a KO indicates that the KO is coded on the complementary strand. A negative sign preceding a permutation element indicates that its orientation is not identical in both genomes.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020075.g004" xlink:type="simple"/></fig></sec><sec id="s2a2"><title>Step 2: Global alignment of KISs.</title><p>To validate the similarity of the KISs in the two organisms, we globally align them. Among the currently available methods for global alignments, e.g., [<xref ref-type="bibr" rid="pcbi-0020075-b040">40</xref>–<xref ref-type="bibr" rid="pcbi-0020075-b049">49</xref>] (see also [<xref ref-type="bibr" rid="pcbi-0020075-b050">50</xref>] for a recent review), we used AVID [<xref ref-type="bibr" rid="pcbi-0020075-b041">41</xref>]. AVID is a heuristic that runs in time and space that are linear with respect to the size of the genomic sequences. Still, to cope with memory limitations, KISs longer than 200,000 bp are divided into subsegments such that successive pieces start and end with the same KO.</p></sec><sec id="s2a3"><title>Step 3: Extracting unmatched regions and local alignments.</title><p>To identify unmatched regions in the global alignment, we group proximal gaps and extract sufficiently long ones—see <xref ref-type="fig" rid="pcbi-0020075-g005">Figure 5</xref>. The unmatched regions are either segments that have undergone reordering (and thus disturb the collinear global alignment) or indels. To distinguish between the two cases, we search the other genome for hits based on these regions. If hits are found, the unmatched regions might result from reordering mutations (this is determined in the mapping phase—see Mapping Phase: Clustering into RF Segments), or otherwise they are most likely indels. The unmatched regions are constructed by joining close gaps in each of the two genomes separately (<italic>&lt;gapJoinLen</italic> parameter). Afterwards, sufficiently long unmatched regions (<italic>&gt;gapExtractLen</italic> parameter) that overlap are merged together, the merged unmatched regions are extracted, and the alignment is broken at the corresponding points. The extracted unmatched regions, along with the uncovered regions between KISs, are locally aligned against the other genome. Among the currently available methods for local alignment, e.g., [<xref ref-type="bibr" rid="pcbi-0020075-b012">12</xref>,<xref ref-type="bibr" rid="pcbi-0020075-b043">43</xref>,<xref ref-type="bibr" rid="pcbi-0020075-b051">51</xref>–<xref ref-type="bibr" rid="pcbi-0020075-b053">53</xref>], we used BLAST [<xref ref-type="bibr" rid="pcbi-0020075-b054">54</xref>]. Tuning the parameters is discussed under Tuning the Parameters. Pseudo-code for the procedure is given in Algorithm 1, in <xref ref-type="sec" rid="s3">Materials and Methods</xref>.</p><fig id="pcbi-0020075-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0020075.g005</object-id><label>Figure 5</label><caption><title>Joining Gaps into Unmatched Regions and Extracting Long Ones from a Sequence Alignment (Step 3 of the Preprocessing Phase)</title><p>Gaps <italic>ℓ</italic><sub>1</sub> and <italic>ℓ</italic><sub>3</sub> in org1 are joined if the (intragapped) hit <italic>ℓ</italic><sub>2</sub> is short enough. Assume that <italic>ℓ</italic><sub>2</sub> and other intra-gapped regions are short enough so that the proximal gaps in org1 are joined to form the unmatched region <italic>ℓ</italic>. Assume that gaps in org2 are joined similarly to form the unmatched region <italic>k,</italic> and that the unmatched regions <italic>ℓ</italic> and <italic>k</italic> are long enough. If the regions <italic>ℓ</italic> and <italic>k</italic> intersect (as in this example), they are joined and the resulting segments in both organisms are extracted to be handled in the next step.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020075.g005" xlink:type="simple"/></fig></sec><sec id="s2a4"><title>Step 4: Stitching local matches.</title><p>To calculate new potential maximal similar segments, each set of local matches is scanned for hits that can be stitched together. Stitched hits need to have the same orientation. To determine which hits to stitch, three quantities are considered—see <xref ref-type="fig" rid="pcbi-0020075-g006">Figure 6</xref>. The first is the difference between the <italic>distances</italic> of the two hits in the two organisms (|<italic>ℓ</italic><sub>1</sub> − <italic>ℓ</italic><sub>2</sub>| in <xref ref-type="fig" rid="pcbi-0020075-g006">Figure 6</xref>). Intuitively, the distance between two hits in a given organism is calculated by subtracting the end of the one hit from the start of the other—see the section, Formal description of stitching local matches, for the exact definition and <xref ref-type="fig" rid="pcbi-0020075-g006">Figure 6</xref> for an illustration. If the segments between the two hits are similar, the distances between the two hits in the two organisms should be similar. Therefore, hits with an excessive difference in their distances (<italic>&gt;stitchDifference</italic> parameter) are not stitched. Second, we consider the distance between the two hits (<italic>ℓ</italic><sub>1</sub> and <italic>ℓ</italic><sub>2</sub> in <xref ref-type="fig" rid="pcbi-0020075-g006">Figure 6</xref>). If two segments in the two organisms are similar, one would expect to find many hits when locally aligning them. Thus, the distance between consecutive hits in similar segments should be short. Therefore, hits with too large a distance (<italic>&gt;stitchDistance</italic> parameter) are not stitched. Finally, after stitching hits that fulfill the above two requirements, we keep stitched segments (<italic>ℓ</italic><sub>3</sub> in <xref ref-type="fig" rid="pcbi-0020075-g006">Figure 6</xref>) that are long enough (<italic>&gt;stitchMinLen</italic> parameter). Tuning the parameters is discussed in Tuning the Parameters. A formal definition of the quantities considered in this step is included in the section Formal description of stitching local matches. Pseudo-code for the procedure is given in Algorithm 2, in <xref ref-type="sec" rid="s3">Materials and Methods</xref>.</p><fig id="pcbi-0020075-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0020075.g006</object-id><label>Figure 6</label><caption><title>Parameters Considered When Stitching Hits Having the Same Orientation (Step 4 of the Preprocessing Phase)</title><p>To stitch the hits hit1 and hit2, we consider first the distance between them in both organisms (length <italic>ℓ</italic><sub>1</sub> and <italic>ℓ</italic><sub>2</sub>, respectively). If the segments corresponding to the lengths <italic>ℓ</italic><sub>1</sub> and <italic>ℓ</italic><sub>2</sub> are similar, then <italic>ℓ</italic><sub>1</sub> and <italic>ℓ</italic><sub>2</sub> are expected to have similar values. Assuming the latter, the difference between the distances of the two hits, i.e., |<italic>ℓ</italic><sub>1</sub> − <italic>ℓ</italic><sub>2</sub> |, should be small. In addition, consecutive hits in similar segments are expected to be close, i.e., both distances, <italic>ℓ</italic><sub>1</sub> and <italic>ℓ</italic><sub>2</sub>, should be small. Finally, if hit1 and hit2 are stitched (with no other hits stitched to them), we check that the total segment's length in each organism is long enough. In org2 this length is referred to as <italic>ℓ</italic><sub>3</sub>.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020075.g006" xlink:type="simple"/></fig></sec><sec id="s2a5"><title>Step 5: Global alignment of new segments.</title><p>Potentially similar segments that were stitched together are globally aligned to validate their similarity, and unmatched regions are extracted from them. However, unlike the previous round of global alignments, this time there is no need to locally align the unmatched regions against the other genome—they cannot have significant hits since they were not picked up by the previous local and global alignment steps.</p></sec></sec><sec id="s2b"><title>Mapping Phase: Clustering into RF Segments</title><p>At this point we have a comprehensive table of maximal similar segments between the two organisms. However, because of repeated elements, e.g<italic>.</italic>, duplicated rDNA operons and ISs, the mapping is not one-to-one. Moreover, due to insertions, deletions, and duplications, consecutive elements belonging to the same RF segment are hard to identify. In the remainder of this section, we present a novel approach for defining consecutive entries that is capable of handling duplications in general, and nuisance cross-overlaps in particular. A flow diagram summarizing the mapping phase as a cascade of seven steps is given in <xref ref-type="fig" rid="pcbi-0020075-g003">Figure 3</xref>B.</p><sec id="s2b1"><title>Step 1: Removing trivial entries and selfish DNA.</title><p>We start with the comprehensive table that was created in the preprocessing phase. First we remove short entries (<italic>&lt;cleanMinLen</italic>). Then we identify and remove transposable elements and prophages (when applicable). These elements replicate and integrate autonomously in the genome [<xref ref-type="bibr" rid="pcbi-0020075-b055">55</xref>]. Therefore, unless discarded before constructing the RF segments, they can lead to wrong assumptions about genome dynamics and an incorrect mapping. The cleaning is done by first identifying transposable elements in both genomes. Then, entries in the table having too long an intersection (<italic>&gt;cleanISPerc</italic>) with the identified transposable elements are discarded. Since sequences of transposable elements diverge fast, we used the <sc>tblastx</sc> mode of BLAT [<xref ref-type="bibr" rid="pcbi-0020075-b052">52</xref>] to identify them. To do the search, a database of all known transposable elements in bacteria was obtained through SRS [<xref ref-type="bibr" rid="pcbi-0020075-b056">56</xref>] on EMBL [<xref ref-type="bibr" rid="pcbi-0020075-b057">57</xref>].</p><p>Prophages, on the other hand, are harder to identify because their sequences diverge fast, they often have genes that are similar to chromosomal genes, and both functional and remnant prophages (e.g., cryptic and mosaic) often have only residual similarity with other known functional phages [<xref ref-type="bibr" rid="pcbi-0020075-b058">58</xref>]. Guidelines for identifying prophages were introduced in [<xref ref-type="bibr" rid="pcbi-0020075-b058">58</xref>] and were implemented in [<xref ref-type="bibr" rid="pcbi-0020075-b059">59</xref>]. We use the latter annotation for discarding entries in the table intersecting with prophages in a similar manner to transposable elements. We refer to the threshold used for the prophages as c<italic>leanProPerc</italic>.</p><p>Finally, we join entries that overlap in both organisms and move toward constructing the RF segments.</p><p>We emphasize that MAGIC can be run without the information on transposable elements or prophages (see, for example, the <italic>Bordetella</italic> pair in <xref ref-type="table" rid="pcbi-0020075-t002">Table 2</xref>). However, keeping these elements is expected to result in a less accurate map with higher fragmentation (see, for example, A Comparison with Mauve's Results as well as <xref ref-type="table" rid="pcbi-0020075-t003">Tables 3</xref> and <xref ref-type="table" rid="pcbi-0020075-t004">4</xref>).</p><table-wrap content-type="2col" id="pcbi-0020075-t002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0020075.t002</object-id><label>Table 2</label><caption><p>Pairwise Comparison Statistics</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020075.t002" xlink:type="simple"/><!-- <table frame="hsides" rules="none"><colgroup><col id="tb2col1" align="left" charoff="0" char=""/><col id="tb2col2" align="left" charoff="0" char=""/><col id="tb2col3" align="left" charoff="0" char=""/><col id="tb2col4" align="left" charoff="0" char=""/><col id="tb2col5" align="left" charoff="0" char=""/><col id="tb2col6" align="left" charoff="0" char=""/><col id="tb2col7" align="left" charoff="0" char=""/><col id="tb2col8" align="left" charoff="0" char=""/><col id="tb2col9" align="left" charoff="0" char=""/><col id="tb2col10" align="left" charoff="0" char=""/></colgroup><thead><tr><td align="left"><hr/>Pairs</td><td><hr/>Organism (Shown in Pairs)</td><td><hr/>Genome Size</td><td><hr/>Number/ Coverage of RF Segments</td><td><hr/>Coverage of Positionally Orthologous Segments</td><td><hr/>Adding Paralogs to the Previous Column</td><td><hr/>Adding Transposable Elements to the Previous Column</td><td><hr/>Adding Prophages and Phagic Elements to the Previous Column</td><td><hr/>Mean Identity of all Positional Orthologs</td><td><hr/>Result of Rao Uniformity Test with Critical Value of 5&percnt;</td></tr></thead><tbody><tr><td rowspan="1">Type I pairs</td><td><bold><named-content content-type="genus-species">B. bronchiseptica</named-content><sup>a</sup></bold></td><td>5,339,179</td><td>149/0.74</td><td>0.67</td><td>0.69</td><td>0.70</td><td>0.70</td><td>0.98</td><td>&plus;</td></tr><tr><td></td><td><bold><named-content content-type="genus-species">B. pertussis</named-content><sup>a</sup></bold></td><td>4,086,189</td><td>149/0.91</td><td>0.87</td><td>0.87</td><td>0.90</td><td>0.90</td><td>0.98</td><td>&plus;</td></tr><tr><td></td><td><named-content content-type="genus-species">H. pylori</named-content></td><td>1,667,867</td><td>31/0.96</td><td>0.92</td><td>0.93</td><td>0.94</td><td>0.94</td><td>0.93</td><td>-</td></tr><tr><td></td><td><named-content content-type="genus-species">H. pylori</named-content> j99</td><td>1,643,831</td><td>31/0.97</td><td>0.93</td><td>0.94</td><td>0.94</td><td>0.94</td><td>0.93</td><td>-</td></tr><tr><td></td><td><bold><named-content content-type="genus-species">N. meningitidis</named-content> a</bold></td><td>2,184,406</td><td>34/0.99</td><td>0.88</td><td>0.90</td><td>0.92</td><td>0.94</td><td>0.96</td><td>-</td></tr><tr><td></td><td><bold><named-content content-type="genus-species">N. meningitidis</named-content> b</bold></td><td>2,272,351</td><td>34/0.95</td><td>0.85</td><td>0.88</td><td>0.90</td><td>0.91</td><td>0.96</td><td>-</td></tr><tr><td></td><td><italic>S. typhi ty2</italic></td><td>4,791,961</td><td>18/0.95</td><td>0.85</td><td>0.86</td><td>0.87</td><td>0.90</td><td>0.98</td><td>&plus;</td></tr><tr><td></td><td><named-content content-type="genus-species">S. typhimurium</named-content></td><td>4,857,432</td><td>18/0.99</td><td>0.84</td><td>0.84</td><td>0.85</td><td>0.90</td><td>0.98</td><td>&plus;</td></tr><tr><td></td><td><bold><italic>Y. pestis co92</italic></bold></td><td>4,653,728</td><td>33/0.97</td><td>0.90</td><td>0.90</td><td>0.94</td><td>0.96</td><td>0.98</td><td>&plus;</td></tr><tr><td></td><td><bold><named-content content-type="genus-species">Y. pseudotuberculosis</named-content><sup>a</sup></bold></td><td>4,744,671</td><td>33/0.98</td><td>0.89</td><td>0.89</td><td>0.90</td><td>0.90</td><td>0.98</td><td>&plus;</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td rowspan="1">Type II pairs</td><td><named-content content-type="genus-species">B. aphidicola</named-content> aps</td><td>640,681</td><td>1/0.93</td><td>0.91</td><td>0.91</td><td>0.91</td><td>0.91</td><td>0.75</td><td>NA</td></tr><tr><td></td><td><named-content content-type="genus-species">B. aphidicola</named-content> sg</td><td>641,454</td><td>1/0.93</td><td>0.90</td><td>0.90</td><td>0.90</td><td>0.90</td><td>0.75</td><td>NA</td></tr><tr><td></td><td><bold><named-content content-type="genus-species">E. coli</named-content> mg1655</bold></td><td>4,639,675</td><td>37/0.95</td><td>0.79</td><td>0.79</td><td>0.82</td><td>0.85</td><td>0.97</td><td>&plus;</td></tr><tr><td></td><td><bold><named-content content-type="genus-species">S. flexneri</named-content> 2457t</bold></td><td>4,599,354</td><td>37/0.93</td><td>0.80</td><td>0.80</td><td>0.88</td><td>0.92</td><td>0.98</td><td>-</td></tr><tr><td></td><td><named-content content-type="genus-species">L. monocytogenes</named-content> egd-e</td><td>2,944,528</td><td>11/0.99</td><td>0.85</td><td>0.85</td><td>0.85</td><td>0.87</td><td>0.87</td><td>-</td></tr><tr><td></td><td><named-content content-type="genus-species">L. innocua</named-content></td><td>3,011,208</td><td>11/0.98</td><td>0.83</td><td>0.83</td><td>0.83</td><td>0.90</td><td>0.87</td><td>-</td></tr><tr><td></td><td><bold><named-content content-type="genus-species">P. abyssi</named-content></bold></td><td>1,765,118</td><td>99/0.88</td><td>0.75</td><td>0.75</td><td>0.76</td><td>0.76</td><td>0.73</td><td>-</td></tr><tr><td></td><td><bold><named-content content-type="genus-species">P. horikoshii</named-content></bold></td><td>1,738,505</td><td>99/0.87</td><td>0.76</td><td>0.76</td><td>0.76</td><td>0.76</td><td>0.73</td><td>-</td></tr><tr><td></td><td><named-content content-type="genus-species">S. pyogenes</named-content> m18</td><td>1,895,017</td><td>4/0.97</td><td>0.79</td><td>0.79</td><td>0.79</td><td>0.90</td><td>0.98</td><td>&plus;</td></tr><tr><td></td><td><named-content content-type="genus-species">S. pyogenes</named-content> ssi1</td><td>1,894,275</td><td>4/0.95</td><td>0.79</td><td>0.79</td><td>0.79</td><td>0.97</td><td>0.98</td><td>&plus;</td></tr></tbody></table> --><!-- <table-wrap-foot><fn id="nt201"><p>Bolding and nonbolding are used to highlight pairs.</p></fn><fn id="nt202"><p><sup>a</sup>Indicates that no prophage annotation was available for those species. The 10 pairs are divided into two groups according to the uniformity test reliability. Type I pairs are pairs in which the number of breakpoints is large (&ge;10), at least in one organism the RF coverage is large (&ge;90&percnt;), and at least in one organism the difference between the RF and the positional ortholog coverage is small (&le;10&percnt;). Type II are the remaining pairs.</p></fn><fn id="nt203"><p>&plus;, accepting; -, rejecting; NA not applicable.</p></fn></table-wrap-foot> --></table-wrap><table-wrap content-type="2col" id="pcbi-0020075-t003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0020075.t003</object-id><label>Table 3</label><caption><p>Comparing Coverage between MAGIC's Results and Mauve's Results When Run with Default Parameters</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020075.t003" xlink:type="simple"/><!-- <table frame="hsides" rules="none"><colgroup><col id="tb3col1" align="left" charoff="0" char=""/><col id="tb3col2" align="left" charoff="0" char=""/><col id="tb3col3" align="left" charoff="0" char=""/><col id="tb3col4" align="left" charoff="0" char=""/><col id="tb3col5" align="left" charoff="0" char=""/><col id="tb3col6" align="left" charoff="0" char=""/><col id="tb3col7" align="left" charoff="0" char=""/><col id="tb3col8" align="left" charoff="0" char=""/></colgroup><thead><tr><td align="left" valign="top">Pairs</td><td valign="top">Organism (Shown in Pairs)</td><td colspan="2"><hr/>Differences in RFs</td><td colspan="2"><hr/>Differences in PO</td><td colspan="2"><hr/>Differences in PS</td></tr><tr><td valign="middle"><hr/></td><td valign="middle"><hr/></td><td valign="middle"><hr/>MVMG</td><td valign="middle"><hr/>MGMV</td><td valign="middle"><hr/>MVMG</td><td valign="middle"><hr/>MGMV</td><td valign="middle"><hr/>MVMG</td><td valign="middle"><hr/>MGMV</td></tr></thead><tbody><tr><td rowspan="1">Type I</td><td valign="middle"><named-content content-type="genus-species">B. bronchiseptica</named-content></td><td valign="middle">0.038</td><td valign="middle">0.0240</td><td valign="middle">0.037</td><td valign="middle">0.0050</td><td valign="middle">0.035</td><td valign="middle">0.036</td></tr><tr><td></td><td><named-content content-type="genus-species">B. pertussis</named-content></td><td valign="middle">0.043</td><td valign="middle">0.0069</td><td valign="middle">0.047</td><td valign="middle">0.0042</td><td valign="middle">0.042</td><td valign="middle">0.032</td></tr><tr><td></td><td><bold><named-content content-type="genus-species">H. pylori</named-content></bold></td><td valign="middle">0.0071</td><td valign="middle">0.13</td><td valign="middle">0.013</td><td valign="middle">0.14</td><td valign="middle">0.010</td><td valign="middle">0.16</td></tr><tr><td></td><td><bold><named-content content-type="genus-species">H. pylori</named-content> j99</bold></td><td valign="middle">0.0066</td><td valign="middle">0.12</td><td valign="middle">0.013</td><td valign="middle">0.14</td><td valign="middle">0.010</td><td valign="middle">0.15</td></tr><tr><td></td><td><named-content content-type="genus-species">N. meningitidis</named-content> a</td><td valign="middle">0.0045</td><td valign="middle">0.077</td><td valign="middle">0.051</td><td valign="middle">0.034</td><td valign="middle">0.032</td><td valign="middle">0.08</td></tr><tr><td></td><td><named-content content-type="genus-species">N. meningitidis</named-content> b</td><td valign="middle">0.0140</td><td valign="middle">0.070</td><td valign="middle">0.051</td><td valign="middle">0.037</td><td valign="middle">0.026</td><td valign="middle">0.078</td></tr><tr><td></td><td><bold><named-content content-type="genus-species">S. typhi</named-content> ty2</bold></td><td valign="middle">0.0072</td><td valign="middle">0.038</td><td valign="middle">0.061</td><td valign="middle">0.0090</td><td valign="middle">0.044</td><td valign="middle">0.041</td></tr><tr><td></td><td><bold><named-content content-type="genus-species">S. typhimurium</named-content></bold></td><td valign="middle">0.0026</td><td valign="middle">0.051</td><td valign="middle">0.060</td><td valign="middle">0.0098</td><td valign="middle">0.043</td><td valign="middle">0.046</td></tr><tr><td></td><td><named-content content-type="genus-species">Y. pestis</named-content></td><td valign="middle">0.016</td><td valign="middle">0.017</td><td valign="middle">0.045</td><td valign="middle">0.0042</td><td valign="middle">0.027</td><td valign="middle">0.050</td></tr><tr><td></td><td><named-content content-type="genus-species">Y. pseudotuberculosis</named-content></td><td valign="middle">0.013</td><td valign="middle">0.040</td><td valign="middle">0.044</td><td valign="middle">0.0076</td><td valign="middle">0.039</td><td valign="middle">0.017</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td rowspan="1">Type II</td><td valign="middle"><bold><named-content content-type="genus-species">B. aphidicola</named-content> aps</bold></td><td valign="middle">0.067</td><td valign="middle">0.0051</td><td valign="middle">0.078</td><td valign="middle">0.027</td><td valign="middle">0.076</td><td valign="middle">0.028</td></tr><tr><td></td><td><bold><named-content content-type="genus-species">B. aphidicola</named-content> sg</bold></td><td valign="middle">0.068</td><td valign="middle">0.0051</td><td valign="middle">0.078</td><td valign="middle">0.027</td><td valign="middle">0.076</td><td valign="middle">0.027</td></tr><tr><td></td><td><named-content content-type="genus-species">E. coli</named-content> mg1655</td><td valign="middle">0.0078</td><td valign="middle">0.041</td><td valign="middle">0.055</td><td valign="middle">0.0044</td><td valign="middle">0.031</td><td valign="middle">0.042</td></tr><tr><td></td><td><named-content content-type="genus-species">S. flexneri</named-content> 2457t</td><td valign="middle">0.0120</td><td valign="middle">0.020</td><td valign="middle">0.055</td><td valign="middle">0.0032</td><td valign="middle">0.033</td><td valign="middle">0.100</td></tr><tr><td></td><td><bold><named-content content-type="genus-species">L. monocytogenes</named-content> egde</bold></td><td valign="middle">0.0039</td><td valign="middle">0.016</td><td valign="middle">0.059</td><td valign="middle">0.0061</td><td valign="middle">0.043</td><td valign="middle">0.012</td></tr><tr><td></td><td><bold><named-content content-type="genus-species">L. innocua</named-content></bold></td><td valign="middle">0.0120</td><td valign="middle">0.072</td><td valign="middle">0.057</td><td valign="middle">0.0082</td><td valign="middle">0.038</td><td valign="middle">0.063</td></tr><tr><td></td><td><named-content content-type="genus-species">P. abyssi</named-content></td><td valign="middle">0.0200</td><td valign="middle">0.54</td><td valign="middle">0.018</td><td valign="middle">0.50</td><td valign="middle">0.015</td><td valign="middle">0.50</td></tr><tr><td></td><td><named-content content-type="genus-species">P. horikoshii</named-content></td><td valign="middle">0.0071</td><td valign="middle">0.57</td><td valign="middle">0.014</td><td valign="middle">0.50</td><td valign="middle">0.014</td><td valign="middle">0.50</td></tr><tr><td></td><td><bold><named-content content-type="genus-species">S. pyogenes</named-content> m18</bold></td><td valign="middle">0.011</td><td valign="middle">0.55</td><td valign="middle">0.047</td><td valign="middle">0.44</td><td valign="middle">0.017</td><td valign="middle">0.52</td></tr><tr><td></td><td valign="top"><bold><named-content content-type="genus-species">S. pyogenes</named-content> ssi1</bold></td><td valign="top">0.028</td><td valign="top">0.55</td><td valign="top">0.046</td><td valign="top">0.43</td><td valign="top">0.016</td><td valign="top">0.59</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td rowspan="1">Results from the Example Run</td><td valign="middle"><named-content content-type="genus-species">S. flexneri</named-content> 2457t</td><td valign="middle">0.028</td><td valign="middle">0.031</td><td valign="middle">0.056</td><td valign="middle">0.023</td><td valign="middle">0.030</td><td valign="middle">0.140</td></tr><tr><td></td><td valign="middle"><named-content content-type="genus-species">S. typhi</named-content> ty2</td><td valign="middle">0.033</td><td valign="middle">0.060</td><td valign="middle">0.053</td><td valign="middle">0.022</td><td valign="middle">0.044</td><td valign="middle">0.071</td></tr></tbody></table> --><!-- <table-wrap-foot><fn id="nt301"><p>MG, MAGIC; MV, Mauve.</p></fn><fn id="nt302"><p>MAGIC's results from <xref ref-type="table" rid="pcbi-0020075-t002">Table 2</xref> and the Example Run section and Mauve's results when run with default parameters, see <xref ref-type="supplementary-material" rid="pcbi-0020075-st001">Table S1</xref>.</p></fn><fn id="nt303"><p>Bolding and nonbolding are used to highlight pairs.</p></fn><fn id="nt304"><p>Differences in RFs coverage, the genomic portion covered by Mauve's LCBs but not by MAGIC's RFs (MVMG), and vice versa (MGMV).</p></fn><fn id="nt305"><p>Differences in PO, the genomic portion covered by Mauve's Backbones but not by MAGIC's positional orthologs (MVMG), and vice versa (MGMV).</p></fn><fn id="nt307"><p>Differences in PS (positional orthologs and selfish): the genomic portion covered by Mauve's backbones but not by MAGIC's &plus;Prophages column, i.e., after adding inparalogs, transposable elements, and prophages to positional orthologs (MVMG), and vice versa (MGMV). Compare with <xref ref-type="supplementary-material" rid="pcbi-0020075-st003">Table S3</xref>.</p></fn><fn id="nt306"><p>Type I pairs are pairs in which the number of breakpoints is large (&ge;10), at least in one organism the RF coverage is large (&ge;90&percnt;), and at least in one organism the difference between the RF and the positional ortholog coverage is small (&le;10&percnt;). Type II are the remaining pairs.</p></fn></table-wrap-foot> --></table-wrap><table-wrap content-type="2col" id="pcbi-0020075-t004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0020075.t004</object-id><label>Table 4</label><caption><p>Running MAGIC with Mauve's Backbones as Anchors and Classifying these Anchors into Five Categories</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020075.t004" xlink:type="simple"/><!-- <table frame="hsides" rules="none"><colgroup><col id="tb4col1" align="left" charoff="0" char=""/><col id="tb4col2" align="left" charoff="0" char=""/><col id="tb4col3" align="left" charoff="0" char=""/><col id="tb4col4" align="left" charoff="0" char=""/><col id="tb4col5" align="left" charoff="0" char=""/><col id="tb4col6" align="left" charoff="0" char=""/><col id="tb4col7" align="left" charoff="0" char=""/><col id="tb4col8" align="left" charoff="0" char=""/><col id="tb4col9" align="left" charoff="0" char=""/><col id="tb4col10" align="left" charoff="0" char=""/><col id="tb4col11" align="left" charoff="0" char=""/><col id="tb4col12" align="left" charoff="0" char=""/><col id="tb4col13" align="left" charoff="0" char=""/><col id="tb4col14" align="left" charoff="0" char=""/><col id="tb4col15" align="left" charoff="0" char=""/><col id="tb4col16" align="left" charoff="0" char=""/><col id="tb4col17" align="left" charoff="0" char=""/><col id="tb4col18" align="left" charoff="0" char=""/><col id="tb4col19" align="left" charoff="0" char=""/><col id="tb4col20" align="left" charoff="0" char=""/></colgroup><thead><tr><td align="left" rowspan="2"><hr/>Pairs</td><td rowspan="2"><hr/>Organism Pairs</td><td colspan="3"><hr/> Transposable</td><td colspan="3"><hr/>Prophages</td><td colspan="3"><hr/>Nuisances</td><td colspan="3"><hr/>Inparalogs</td><td colspan="3"><hr/>Final conflicts</td><td colspan="3"><hr/>Total</td></tr><tr><td><hr/>Number</td><td><hr/><italic>&ell;</italic><sub>1</sub></td><td><hr/><italic>&ell;</italic><sub>2</sub></td><td><hr/>Number</td><td><hr/><italic>&ell;</italic><sub>1</sub></td><td><hr/><italic>&ell;</italic><sub>2</sub></td><td><hr/>Number</td><td><hr/><italic>&ell;</italic><sub>1</sub></td><td><hr/><italic>&ell;</italic><sub>2</sub></td><td><hr/>Number</td><td><hr/><italic>&ell;</italic><sub>1</sub></td><td><hr/><italic>&ell;</italic><sub>2</sub></td><td><hr/>Number</td><td><hr/><italic>&ell;</italic><sub>1</sub></td><td><hr/><italic>&ell;</italic><sub>2</sub></td><td><hr/>Number</td><td><hr/><italic>&ell;</italic><sub>1</sub></td><td><hr/><italic>&ell;</italic><sub>2</sub></td></tr></thead><tbody><tr><td rowspan="1">Type I</td><td><italic>B</italic>. &lcub;<italic>bronchiseptica, pertussis</italic>&rcub;</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>10</td><td>32,528</td><td>32,432</td><td>6</td><td>2,352</td><td>1,998</td><td>8</td><td>29,415</td><td>29,166</td><td>24</td><td>64,295</td><td>63,596</td></tr><tr><td></td><td><named-content content-type="genus-species">H. pylori</named-content> &lcub; , j99&rcub;</td><td>2</td><td>1,380</td><td>1,409</td><td>0</td><td>0</td><td>0</td><td>19</td><td>24,872</td><td>24,533</td><td>2</td><td>1,140</td><td>1,140</td><td>1</td><td>489</td><td>490</td><td>24</td><td>27,881</td><td>27,572</td></tr><tr><td></td><td><named-content content-type="genus-species">N. meningitidis</named-content> &lcub;a, b&rcub;</td><td>51</td><td>12,720</td><td>12,674</td><td>13</td><td>20,167</td><td>20,067</td><td>33</td><td>32,078</td><td>32,089</td><td>41</td><td>64,329</td><td>63,939</td><td>24</td><td>43,634</td><td>43,580</td><td>162</td><td>172,928</td><td>172,349</td></tr><tr><td></td><td><italic>S</italic>. &lcub;<italic>typhi</italic> ty2, typhimurium&rcub;</td><td>19</td><td>11,911</td><td>12,260</td><td>34</td><td>82,543</td><td>82,830</td><td>6</td><td>10,522</td><td>10,581</td><td>14</td><td>3,303</td><td>2,950</td><td>0</td><td>0</td><td>0</td><td>73</td><td>108,279</td><td>108,621</td></tr><tr><td></td><td><italic>Y.</italic> &lcub;<italic>pestis</italic>, <italic>pseudotuberculosis</italic>&rcub;</td><td>23</td><td>21,703</td><td>22,721</td><td>21</td><td>109,399</td><td>109,775</td><td>5</td><td>1,003</td><td>1,003</td><td>10</td><td>4,566</td><td>4,365</td><td>3</td><td>4,267</td><td>4,267</td><td>62</td><td>140,938</td><td>142,131</td></tr><tr><td rowspan="1">Type II</td><td><named-content content-type="genus-species">B. aphidicola</named-content> &lcub;aps, sg&rcub;</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td></tr><tr><td></td><td><named-content content-type="genus-species">E. coli</named-content> mg1655, <named-content content-type="genus-species">S. flexneri</named-content> 2457t</td><td>36</td><td>32,320</td><td>31,966</td><td>44</td><td>129,024</td><td>128,641</td><td>1</td><td>142</td><td>143</td><td>5</td><td>1,005</td><td>767</td><td>0</td><td>0</td><td>0</td><td>86</td><td>162,491</td><td>161,517</td></tr><tr><td></td><td><italic>L</italic>. &lcub;<italic>monocytogenes</italic> egd-e, <italic>innocua</italic>&rcub;</td><td>0</td><td>0</td><td>0</td><td>43</td><td>77,396</td><td>77,290</td><td>0</td><td>0</td><td>0</td><td>6</td><td>890</td><td>1,076</td><td>1</td><td>54</td><td>54</td><td>50</td><td>78,340</td><td>78,420</td></tr><tr><td></td><td>P. &lcub;<italic>abyssi, horikoshii</italic>&rcub;</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>5</td><td>1,115</td><td>1115</td><td>10</td><td>5,580</td><td>5,345</td><td>6</td><td>3,067</td><td>2,924</td><td>21</td><td>9,762</td><td>9,384</td></tr><tr><td></td><td><italic>S</italic>. pyogenes &lcub;m18, ssi1&rcub;</td><td>0</td><td>0</td><td>0</td><td>63</td><td>35,511</td><td>35,594</td><td>1</td><td>619</td><td>619</td><td>2</td><td>240</td><td>238</td><td>0</td><td>0</td><td>0</td><td>66</td><td>36,370</td><td>36,451</td></tr><tr><td>Results from the Example Run</td><td><italic>S.</italic> &lcub;<italic>flexneri</italic> 2457t, <italic>typhi</italic> ty2&rcub;</td><td>50</td><td>51,218</td><td>51,142</td><td>51</td><td>101,948</td><td>101,662</td><td>8</td><td>3,735</td><td>3,829</td><td>3</td><td>633</td><td>529</td><td>2</td><td>411</td><td>411</td><td>114</td><td>157,945</td><td>157,573</td></tr></tbody></table> --><!-- <table-wrap-foot><fn id="nt401"><p>Backbones that were identified (by MAGIC) as transposable elements (Step 1: Removing trivial entries and selfish DNA), prophages (see Step 1: Removing trivial entries and selfish DNA), nuisance cross-overlaps (see Steps 3&ndash;5: Identifying nuisance, classifying inparalogs, and re-clustering), inparalogs (see Steps 3&ndash;5: Identifying nuisance, classifying inparalogs, and re-clustering), or as remaining significant overlaps (see Steps 6&ndash;7: Discarding remaining conflicts and re-clustering).</p></fn><fn id="nt402"><p>Total, summing over the five categories.</p></fn><fn id="nt403"><p>In each category, the number of backbones identified as belonging to that category (Number), the length of these backbones in the first organism (<italic>&ell;</italic><sub>1</sub>) as well as their length in the second organism (<italic>&ell;</italic><sub>2</sub>) are given. A backbone is associated with a category if it intersects with more than 90&percnt; in either of the two organisms with an entry in that category. Sets of backbones belonging to the different categories are disjoint.</p></fn><fn id="nt404"><p>Type I pairs are pairs in which the number of breakpoints is large (&ge;10), at least in one organism the RF coverage is large (&ge;90&percnt;), and at least in one organism the difference between the RF and the positional ortholog coverage is small (&le;10&percnt;). Type II are the remaining pairs.</p></fn></table-wrap-foot> --></table-wrap></sec><sec id="s2b2"><title>Step 2: Finding consecutive entries and clustering into RF segments.</title><p>Duplications are one of the major hurdles when constructing RF segments because they introduce ambiguity that makes identifying consecutive entries hard. <xref ref-type="fig" rid="pcbi-0020075-g002">Figure 2</xref>A illustrates this difficulty by an example from the comparison of <named-content content-type="genus-species" xlink:type="simple">Escherichia coli</named-content> K-12 MG1655 <italic>(E. coli)</italic> [<xref ref-type="bibr" rid="pcbi-0020075-b060">60</xref>] versus <named-content content-type="genus-species" xlink:type="simple">Salmonella enterica</named-content> serovar <italic>typhi</italic> ty2 (<named-content content-type="genus-species" xlink:type="simple">S. typhi</named-content> ty2) [<xref ref-type="bibr" rid="pcbi-0020075-b061">61</xref>]. The question that we want to answer is: which of the entries {2,…,5} from <xref ref-type="fig" rid="pcbi-0020075-g002">Figure 2A</xref> is consecutive to 1 (if any)? Intuitively, Entry 3 is the “natural” choice, since among all the entries that have the same orientation as Entry 1 in both organisms, Entry 3 is the “closest” to Entry 1 in both organisms. In the following we present a description for a method to generalize the above example. The description is intuitive and is demonstrated on Entries 1 and 3 from <xref ref-type="fig" rid="pcbi-0020075-g002">Figure 2A</xref>. The formal definitions are given in Formal description of clustering into RF segments.</p><p>Consider all the “significant overlaps” of Entries 1 and 3 in both organisms. Two entries are said to <italic>overlap significantly</italic> in a given organism if the percentage of their intersecting length in that organism relative to their length is large enough (<italic>&gt;dupPerc</italic>). For example, Entry 2 overlaps significantly with Entry 3 in <named-content content-type="genus-species" xlink:type="simple">E. coli</named-content>, while Entries 4 and 5 overlap significantly with Entry 3 in <named-content content-type="genus-species" xlink:type="simple">S. typhi</named-content> ty2. Entry 1 does not overlap significantly with other entries in either of the organisms. Notice that even though Entries 1 and 3 are not successive in either of the organisms, Entry 2, which overlaps significantly with Entry 3 in <italic>E. coli,</italic> is successive to Entry 1 in <named-content content-type="genus-species" xlink:type="simple">E. coli</named-content>. Furthermore, Entry 4, which overlaps significantly with Entry 3 in <named-content content-type="genus-species" xlink:type="simple">S. typhi</named-content> ty2, precedes Entry 1 in <named-content content-type="genus-species" xlink:type="simple">S. typhi</named-content> ty2. Thus, even though 1 and 3 are not successive in either of the organisms, Entry 3 overlaps significantly with entries in both organisms that are the closest to Entry 1. In addition, as mentioned earlier, Entries 1 and 3 have the same sign. Therefore, they are potentially a consecutive pair. Since this is the only potentially consecutive pair involving either Entry 1 or 3, these two Entries are considered to be consecutive. In general there might be another entry besides 3 that is potentially consecutive with Entry 1. In this case, we choose the entry that is closest to 1 (for more details, see the section Formal description of clustering into RF segments). After calculating the consecutive entry of each given one, we join consecutive entries together into initial RFs (Algorithm 3 in <xref ref-type="sec" rid="s3">Materials and Methods</xref>).</p></sec><sec id="s2b3"><title>Steps 3–5: Identifying nuisance, classifying inparalogs, and re-clustering.</title><p>The table resulting from the above clustering step would usually contain overlapping entries. To identify duplications correctly, we need first to identify and remove “nuisance cross-overlaps,” which are entries that overlap significantly with different initial RF segments in the different organisms. <xref ref-type="fig" rid="pcbi-0020075-g001">Figures 1</xref> and <xref ref-type="fig" rid="pcbi-0020075-g002">2B</xref> illustrate the definition. Nuisance cross-overlaps correspond to “fake” hits, e.g., low similarity segments or duplications that occurred before the most recent common ancestor (outparalogs), and need therefore to be discarded (see A Comparison with Mauve's Results for the artifacts that nuisance cross-overlaps can introduce in the mappings).</p><p>For the remaining significant overlaps, we consider those for which positional orthologs and inparalogs can be determined. Given two entries that overlap significantly according to one of the organisms, if one entry is at least <italic>orthPerc</italic> longer than the other, the former is considered to be the positional ortholog, and the latter—the inparalog. <xref ref-type="fig" rid="pcbi-0020075-g002">Figure 2B</xref> illustrates these definitions. Notice that the duplications that are considered in this method are those that happened in either of the two organisms since their divergence (inparalogs). Therefore, old duplications (outparalogs), e.g., the rDNA operons, are not relevant. This behavior is assured by removing the nuisance cross-overlaps. The set of inparalogs in each organism is further classified to identify segments that have multiple duplications. In addition, entries in the set of inparalogs that correspond to a single duplicated segment in one organism are identified and grouped together. Such entries might result in multiple counting of the same duplicated segment, unless counted as a single group.</p><p>After discarding the inparalogs, we extend the initial RF segments by calculating consecutive entries and joining them (by running Algorithm 3 in <xref ref-type="sec" rid="s3">Materials and Methods</xref>) again. Steps 3–5 are performed iteratively until the table converges and no more nuisances or inparalogs are identified.</p></sec><sec id="s2b4"><title>Steps 6–7: Discarding remaining conflicts and re-clustering.</title><p>Any significant overlaps that remain at this point correspond to isolated segments for which positional orthologs and inparalogs cannot be inferred—see <xref ref-type="supplementary-material" rid="pcbi-0020075-sg001">Figure S1</xref>. Such entries are referred to as <italic>conflicts</italic>. Conflicts could correspond to unidentified selfish DNA segments and are thus discarded. Afterwards, we calculate consecutive entries and join them (by running Algorithm 3 in <xref ref-type="sec" rid="s3">Materials and Methods</xref>) for the final time, which results in the final RF segments.</p></sec><sec id="s2b5"><title>Comparison statistics.</title><p>To check the similarity between the two genomes, we calculate at this point the similarity between all the initial entries that were joined to construct the RF segments. This calculation is done by globally aligning these entries one more time. Based on the alignments, a weighted mean of their identity percentage is calculated for each genome, where the weights are the respective lengths of the entries in each organism. Furthermore, these entries, the RF segments, the classified inparalogs, the transposable elements, and the annotated prophages as well as identified phagic elements in [<xref ref-type="bibr" rid="pcbi-0020075-b059">59</xref>] are all used to calculate genome coverage statistics (see <xref ref-type="table" rid="pcbi-0020075-t002">Table 2</xref>).</p></sec></sec><sec id="s2c"><title>Tuning the Parameters</title><p>We tuned the parameters used in the different steps based on comparisons between the bacteria <named-content content-type="genus-species" xlink:type="simple">Shigella flexneri</named-content> 2457t serotype 2a (<named-content content-type="genus-species" xlink:type="simple">S. flexneri</named-content> 2457t) [<xref ref-type="bibr" rid="pcbi-0020075-b062">62</xref>] and <named-content content-type="genus-species" xlink:type="simple">S. typhi</named-content> ty2, which are among the most difficult and the least stable genomes in the enterobacteria family, since they contain more ISs, prophages, and rearrangements than other <italic>Escherichia</italic> or <italic>Salmonella</italic> [<xref ref-type="bibr" rid="pcbi-0020075-b063">63</xref>]. A summary of the parameters and their default values is given in <xref ref-type="table" rid="pcbi-0020075-t001">Table 1</xref>. As a guideline, we took advantage of the initial coarse mapping induced by the KISs wherever possible, to help in tuning the different parameter values as described below. In addition, we ran the algorithms with a range of values and compared their behavior under the different settings.</p><p>To calibrate the parameters <italic>gapJoinLen</italic> and <italic>gapExtractLen</italic> in Step 3 of the preprocessing phase, we checked the gap distribution resulting from alignments between common unique KOs. We found that most of the gaps in these regions are usually shorter than 200 bp, with a few extending to 300 bp and 600 bp in <named-content content-type="genus-species" xlink:type="simple">S. flexneri</named-content> 2457t and <named-content content-type="genus-species" xlink:type="simple">S. typhi</named-content> ty2, respectively. Similarly, we checked the lengths of intragap regions in the KO alignments and found that most of these regions are shorter than 100 bp.</p><p>To gain more evidence, we ran the algorithm described in Step 3 of the preprocessing phase with different parameter values, while focusing on the total count of unmatched regions that the algorithm finds in both organisms. The results given in <xref ref-type="fig" rid="pcbi-0020075-g007">Figure 7</xref> show that the count decreases rapidly as the value of <italic>gapExtractLen</italic> approaches 200 from below. The decrease, however, becomes moderate for values greater than 200 (<xref ref-type="fig" rid="pcbi-0020075-g007">Figure 7</xref>). As for <italic>gapJoinLen,</italic> the fast decay occurs when its value approaches 100 from below and is followed by a moderate increase for values between 200 and 600 (<xref ref-type="fig" rid="pcbi-0020075-g007">Figure 7</xref>). Intuitively, this change in behavior results from two factors: first, the tendency of gaps to be joined together as the <italic>gapJoinLen</italic> parameter increases causes the initial decrease. Second, after some point, especially when <italic>gapJoinLen</italic> gets larger than <italic>gapExtractLen,</italic> new unmatched regions longer than <italic>gapExtractLen</italic> start to emerge as the result of joining faraway small gaps that did not pass the threshold test before. Thus, it does not make much sense to set <italic>gapJoinLen</italic> to a value greater than <italic>gapExtractLen</italic>. In the actual runs, we used a value of 200 for <italic>gapExtractLen</italic> (approximately where the moderate decrease starts) and 110 for <italic>gapJoinLen</italic> (approximately where the minimum happens)—see <xref ref-type="fig" rid="pcbi-0020075-g007">Figure 7</xref>.</p><fig id="pcbi-0020075-g007" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0020075.g007</object-id><label>Figure 7</label><caption><title>Number of Detected Unmatched Regions in Step 3 of the Preprocessing Phase (see <xref ref-type="fig" rid="pcbi-0020075-g003">Figure 3A</xref> and Preprocessing Phase: Building a Comprehensive Table of Similar Segments) in the Comparison of <named-content content-type="genus-species" xlink:type="simple">S. flexneri</named-content> 2457t and <named-content content-type="genus-species" xlink:type="simple">S. typhi</named-content> ty2 as a Function of <italic>gapJoinLen</italic> and of <italic>gapExtractLen</italic></title><p>(A) A 3-D graph of the function.</p><p>(B) A projection of the graph as a function of <italic>gapExtractLen</italic> (horizontal axis) when setting <italic>gapJoinLen</italic> = 110.</p><p>(C) A projection of the graph as a function of <italic>gapJoinLen</italic> (horizontal axis) when setting <italic>gapExtractLen</italic> = 200.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020075.g007" xlink:type="simple"/></fig><p>Similar runs were performed to determine the value of the parameters <italic>stitchDifference, stitchDistance,</italic> and <italic>stitchMinLen</italic> used in Step 4 of the preprocessing phase. The results, shown in <xref ref-type="fig" rid="pcbi-0020075-g008">Figure 8</xref>, showed that the parameter <italic>stitchDistance</italic> did not have much influence on the number of stitched hits calculated by the algorithm. In the actual runs, we used values of 2,000, 200, and 15,000 for the parameters <italic>stitchDifference, stitchMinLen,</italic> and <italic>stitchDistance,</italic> respectively. Loose values can be chosen for these parameters since the stitched hits are going to be validated by global alignments.</p><fig id="pcbi-0020075-g008" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0020075.g008</object-id><label>Figure 8</label><caption><title>Number of Stitched Hits as a Function of the Parameters <italic>stitchDifference, stitchDistance,</italic> and <italic>stitchMinLen</italic></title><p>The hits were obtained by locally aligning inter-KIS genomic regions against the other genome in the comparison of the bacteria <named-content content-type="genus-species" xlink:type="simple">S. flexneri</named-content> 2457t versus <named-content content-type="genus-species" xlink:type="simple">S. typhi</named-content> ty2.</p><p>(A) The number of stitched hits as a function of <italic>stitchDistance</italic> when <italic>stitchDifference</italic> = 500 and <italic>stitchMinLen</italic> = 200. Notice that the number of stitched hits changes only by 1 while <italic>stitchDistance</italic> ranges from 5,000 to 29,000. This indicates that the value of <italic>stitchDistance</italic> has a very weak effect on the number of stitched hits.</p><p>(B) The number of stitched hits as a function of <italic>stitchDifference</italic> and <italic>stitchMinLen</italic> when <italic>stitchDistance</italic> = 29,000. Here, the number of stitched hits decreases rapidly as <italic>stitchDifference</italic> increases from 1,000 to 2,000. This is followed by a moderate decrease. As <italic>stitchDifference</italic> approaches 8,000, a moderate increase is observed. The reasons for this increase are similar to those discussed in Tuning the Parameters to explain the increase observed in <xref ref-type="fig" rid="pcbi-0020075-g007">Figure 7</xref>. On the other hand, and as is expected, the number of stitched hits decreases monotonically when <italic>stitchMinLen</italic> runs from 200 to 1,000.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020075.g008" xlink:type="simple"/></fig><p>The value of <italic>cleanMinLen</italic> was set to equal that of <italic>stitchMinLen</italic> (200 bp). Tuning the values used for discarding transposable elements and prophages was based on the intersection percentage between table entries and identified transposable elements as well as that between table entries and annotated prophages, respectively. Histograms describing these percentages are given in <xref ref-type="fig" rid="pcbi-0020075-g009">Figure 9</xref>. As mentioned earlier, these elements' sequences diverge fast. Therefore, one would expect that they undergo rapid changes in their sequence. To balance this effect, we choose a conservative threshold for their identification, by setting both <italic>cleanISPerc</italic> and <italic>cleanProPerc</italic> to 40%. The values of <italic>dupPerc</italic> and <italic>orthPerc</italic> were both determined to be 50%, based on similar histograms (see <xref ref-type="fig" rid="pcbi-0020075-g010">Figures 10</xref> and <xref ref-type="fig" rid="pcbi-0020075-g011">11</xref>).</p><fig id="pcbi-0020075-g009" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0020075.g009</object-id><label>Figure 9</label><caption><title>Step 1 of the Mapping Phase in the Comparison of <named-content content-type="genus-species" xlink:type="simple">S. flexneri</named-content> 2457t and <named-content content-type="genus-species" xlink:type="simple">S. typhi</named-content> ty2</title><p>Histograms of the percentage of intersection (horizontal axis) between entries of the comprehensive table and transposable elements (A) and between entries of the comprehensive table and phages (B). See <xref ref-type="fig" rid="pcbi-0020075-g003">Figure 3</xref> and Step 1: Removing trivial entries and selfish DNA.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020075.g009" xlink:type="simple"/></fig><fig id="pcbi-0020075-g010" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0020075.g010</object-id><label>Figure 10</label><caption><title>Histogram of Intersection Ratios between Table Entries (after Removing Trivial Entries and Selfish DNA) in the comparison of <named-content content-type="genus-species" xlink:type="simple">S. flexneri</named-content> 2457t and <named-content content-type="genus-species" xlink:type="simple">S. typhi</named-content> ty2</title><p>The ratio is calculated as the intersection length divided by the length of the shortest entry.</p><p>(A) Ratios in <named-content content-type="genus-species" xlink:type="simple">S. flexneri</named-content> 2457t and (B) ratios in <named-content content-type="genus-species" xlink:type="simple">S. typhi</named-content> ty2. We set the default value of <italic>dupPerc</italic> to 50% since most of the histogram values are larger than that.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020075.g010" xlink:type="simple"/></fig><fig id="pcbi-0020075-g011" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0020075.g011</object-id><label>Figure 11</label><caption><title>Histogram of Length Ratios between Significant Overlaps (after Removing Nuisance Cross-Overlaps) in the Comparison of <named-content content-type="genus-species" xlink:type="simple">S. flexneri</named-content> 2457t and <named-content content-type="genus-species" xlink:type="simple">S. typhi</named-content> ty2</title><p>Given two entries that significantly overlap, the ratio between the smallest entry to the largest one is calculated. For identifying significant overlaps we use <italic>dupPerc</italic> = 50%.</p><p>(A) Ratios in <named-content content-type="genus-species" xlink:type="simple">S. flexneri</named-content> 2457t and (B) ratios in <named-content content-type="genus-species" xlink:type="simple">S. typhi</named-content> ty2. We set the default value of <italic>orthPerc</italic> to 50%, where the minimum in both histograms occurs.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020075.g011" xlink:type="simple"/></fig><p>For identifying local similarities between extracted unmatched regions and whole genomes, we used <sc>blast</sc> [<xref ref-type="bibr" rid="pcbi-0020075-b054">54</xref>] in its <sc>bl2seq</sc> [<xref ref-type="bibr" rid="pcbi-0020075-b064">64</xref>] implementation, with an e-value of .01.</p></sec><sec id="s2d"><title>A Comparison with Mauve's Procedure</title><p>We compare MAGIC primarily with Mauve, a cross-species genome comparison tool, since the motivation for developing Mauve was to compare bacterial genomes. In fact, Mauve was initially used on nine enterobacterial genomes, four of which form two pairs that are considered in this study. In addition, it has been previously shown that Mauve is more accurate than other well-known comparison tools on bacteria pairs with substitution and inversion rates as in the above nine enterobacteria genomes [<xref ref-type="bibr" rid="pcbi-0020075-b014">14</xref>].</p><sec id="s2d1"><title>Preprocessing phases.</title><p>In the preprocessing phase, Mauve [<xref ref-type="bibr" rid="pcbi-0020075-b014">14</xref>] constructs multiple maximal <italic>unique</italic> matches (multi-MUMs) and considers only those that are longer than a given threshold as alignment anchors. The multi-MUMs correspond to <italic>exact</italic> matches shared by a number of genomes. Mauve uses a recursive anchoring scheme combined with its mapping phase. One can pinpoint at least two differences between the preprocessing phase of Mauve and our method: first, MAGIC does not require exact matches; this allows comparing more divergent genomes [<xref ref-type="bibr" rid="pcbi-0020075-b014">14</xref>]. Second, MAGIC does not consider only unique matches. On the contrary, it aims towards building a comprehensive table.</p></sec><sec id="s2d2"><title>Mapping phases.</title><p>Mauve applies a selection criterion to the multi-MUMs calculated in the preprocessing phase (see the previous section Preprocessing phases). Before that, overlaps between the multi-MUMs are resolved <italic>locally,</italic> i.e., by only considering the two overlapping multi-MUMs. Then, a minimum partitioning of the multi-MUMs into collinear blocks (i.e., segments free of reordering) is done by breakpoint analysis [<xref ref-type="bibr" rid="pcbi-0020075-b065">65</xref>]. To do that, a guiding phylogeny is calculated from the multi-MUMs. After calculating the partitioning, the locally collinear blocks (LCBs) having the minimum weight are discarded if their weight is below a given threshold. The weight of an LCB is defined to be the sum of lengths of the multi-MUMs contained in it. After discarding the minimum weight blocks (if any), the program recalculates the partitioning and discards the minimum weight blocks iteratively. Thus, Mauve's mapping phase requires that the input table is one-to-one, which is guaranteed by locally resolving overlaps. Our approach resolves overlaps based on global information, after performing a clustering step. In contrast to our approach, Mauve tackles the problem of selfish DNA, similarly to GRIMM-Synteny and CHAIN-NET, by discarding blocks weighing less than a given threshold. Similarly to our method, in Mauve gaps are extracted from the alignments to construct the “backbone” of the compared genomes. However, in Mauve proximal gaps are not grouped prior to their extraction.</p><p>There is at least one important difference between the mapping phases of Mauve and MAGIC: in MAGIC, resolving overlaps is done based on global information. Thus, given two overlapping entries, MAGIC seeks evidence on how to solve the overlap in other table entries. Mauve, on the other hand, resolves the overlap based on local information and by considering only the two overlapping entries. The section A Comparison with Mauve's Results demonstrates the implications of this difference.</p></sec></sec><sec id="s2e"><title>Example Run</title><p>To illustrate MAGIC's operation and output we use the same pair, i.e<italic>.</italic>, <named-content content-type="genus-species" xlink:type="simple">S. flexneri</named-content> 2457t and <named-content content-type="genus-species" xlink:type="simple">S. typhi</named-content> ty2, that was used in Tuning the Parameters. Yet, and for the same reason, its results are excluded from the subsequent biological discussions (to avoid tuning the algorithm and analyzing its results on the same input).</p><p>The genome of <named-content content-type="genus-species" xlink:type="simple">S. flexneri</named-content> 2457t contains 4,599,354 bp, 4,068 genes, and 131 RNAs. Out of the 4,068 genes, 1,446 are associated with KOs. The genome of <named-content content-type="genus-species" xlink:type="simple">S. typhi</named-content> ty2 is somewhat larger: it contains 4,791,961 bp, 4,323 genes, out of which 1,542 are associated with KOs, and 109 RNAs. The number of common KOs is 1,118, out of which 917 are unique. The KIS permutation contains 69 runs and covers about 77% of both genomes. The total length of the homologous segments in these KISs, i.e., the sum of the lengths of the 917 common KOs covers slightly more than 20% of the two genomes. For comparison, see <xref ref-type="table" rid="pcbi-0020075-t005">Table 5</xref>, which gives a complete overview on genome coverage statistics reported by MAGIC.</p><table-wrap content-type="1col" id="pcbi-0020075-t005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0020075.t005</object-id><label>Table 5</label><caption><p>Genomes' Coverage Statistics</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020075.t005" xlink:type="simple"/><!-- <table frame="hsides" rules="none"><colgroup><col id="tb5col1" align="left" charoff="0" char=""/><col id="tb5col2" align="left" charoff="0" char=""/><col id="tb5col3" align="left" charoff="0" char=""/><col id="tb5col4" align="left" charoff="0" char=""/><col id="tb5col5" align="left" charoff="0" char=""/><col id="tb5col6" align="left" charoff="0" char=""/><col id="tb5col7" align="left" charoff="0" char=""/></colgroup><thead><tr><td align="left"><hr/>Organism</td><td><hr/>RF</td><td><hr/>PO</td><td><hr/>&plus;IP</td><td><hr/>&plus;Transposable</td><td><hr/>&plus;Prophages</td><td><hr/>Identity</td></tr></thead><tbody><tr><td><italic>S. flexneri 2457t</italic></td><td>0.84</td><td>0.65</td><td>0.65</td><td>0.76</td><td>0.80</td><td>0.79</td></tr><tr><td><italic>S. typhi ty2</italic></td><td>0.84</td><td>0.62</td><td>0.63</td><td>0.64</td><td>0.68</td><td>0.79</td></tr></tbody></table> --><!-- <table-wrap-foot><fn id="nt501"><p>RF, coverage of reordering-free segments.</p></fn><fn id="nt502"><p>PO, coverage of positionally orthologous segments.</p></fn><fn id="nt503"><p>&plus;IP, adding inparalogs to the previous column.</p></fn><fn id="nt504"><p>&plus;Transposable, adding transposable elements to the previous column.</p></fn><fn id="nt505"><p>&plus;Prophages, adding prophages as well as phagic elements to the previous columns.</p></fn><fn id="nt506"><p>Identity, mean identity of all positional orthologs.</p></fn></table-wrap-foot> --></table-wrap><p>After running the preprocessing phase and removing short entries, the comprehensive table of similar segments contained 854 entries. The number of entries identified as belonging to transposable elements was 72. The number of entries identified as belonging to prophages was 45. Entries belonging to either of the two categories were discarded from the table leaving 737 entries. Notice that these numbers are <italic>not</italic> the number of transposable elements or prophages in either of the two genomes: transposable elements or prophages that are present in one organism but not in the other are not expected to be included in the mapping. Furthermore, as mentioned earlier, two segments belonging to the same prophage in one organism might correspond to two distant—either chromosomal or phagic—segments in the other organism.</p><p>Joining overlapping entries and clustering consecutive entries reduced the table size to 247. After removing identified nuisance cross-overlaps, the size is further reduced to 185. Classifying the inparalogs resulted in 22 and 19 identified duplications in the two bacteria, respectively. Some of the duplicates are rather nontrivial. A detailed description of the nontrivial duplicates is given in Text S1. We note that the table converged with respect to nuisances and inparalogs after the first iteration (see <xref ref-type="fig" rid="pcbi-0020075-g003">Figure 3</xref> and Steps 3–5: Identifying nuisance, classifying inparalogs, and re-clustering).</p><p>The table size after removing the classified inparalogs is 140. After clustering consecutive entries a second time, the table size is reduced to 122. The number of remaining unresolved significant overlaps is nine. The total lengths of these entries are 5,920 bp (.1%) and 3,962 bp (.08%) in the two bacteria, respectively. They are discarded, and clustering consecutive entries is done for the last time, which results in the final table of size 106. A schematic presentation of the comparative mapping is given in <xref ref-type="fig" rid="pcbi-0020075-g012">Figure 12</xref>.</p><fig id="pcbi-0020075-g012" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0020075.g012</object-id><label>Figure 12</label><caption><title>A Dot-Plot-Like Schematic Presentation of the Final One-to-One RF Table in the Comparison between <named-content content-type="genus-species" xlink:type="simple">S. flexneri</named-content> 2457t (Horizontal Axis) and <named-content content-type="genus-species" xlink:type="simple">S. typhi</named-content> ty2 (Vertical Axis)</title><p>Each line in the figure corresponds to an entry in the table. Lines corresponding to entries with a positive sign are drawn parallel to the positive diagonal and lines corresponding to entries with a negative sign are drawn parallel to the negative diagonal.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020075.g012" xlink:type="simple"/></fig><p>Recall that there were 201 entries in the initial anchor set corresponding to common non-unique KOs. Except perhaps for some of the identified duplications and some of the nine unresolved significant overlaps, MAGIC was able to establish that the ambiguity in the majority of the non-unique common KOs does not result from inparalogs. Thus, it most likely results from nuisance cross-overlaps or selfish DNA elements.</p><p>The calculated statistics of the two genomes is given in <xref ref-type="table" rid="pcbi-0020075-t005">Table 5</xref>. The RF coverage leaves about 16% of both genomes in the breakpoint regions. A comparison between the RF coverage and the positional ortholog coverage shows that a significant amount of indels (about 20%) is found inside RF segments. Notice that taking the inparalogs into account did not add much to the positional ortholog coverage percentage. On the other hand, transposable elements do cover a significant part of <named-content content-type="genus-species" xlink:type="simple">S. flexneri</named-content> 2457t—about 10%—as previously indicated [<xref ref-type="bibr" rid="pcbi-0020075-b062">62</xref>]. However, they are less significant in <named-content content-type="genus-species" xlink:type="simple">S. typhi</named-content> ty2. Prophages contribute equally to the coverage of both genomes—about 5%. The average nucleotide similarity between positional orthologs in both genomes equals 79%. Notice that approximately 20% and 30% of the genomes of <named-content content-type="genus-species" xlink:type="simple">S. flexneri</named-content> 2457t and <named-content content-type="genus-species" xlink:type="simple">S. typhi</named-content> ty2, respectively, can neither be mapped onto the other genome nor explained by known transposable elements or prophages. These portions can result from deletions, unknown prophages, unknown transposable elements, or HGTs. Interestingly, several authors [<xref ref-type="bibr" rid="pcbi-0020075-b066">66</xref>,<xref ref-type="bibr" rid="pcbi-0020075-b067">67</xref>] estimate that <named-content content-type="genus-species" xlink:type="simple">E. coli</named-content> (which is the same species as <named-content content-type="genus-species" xlink:type="simple">S. flexneri</named-content>) has obtained &gt;15% of its genetic material by HGT from distant species having different sequence composition.</p></sec><sec id="s2f"><title>False Anchors</title><p>Even when MAGIC starts from a high quality anchor set (the KOs) and the organisms are evolutionarily close, a few false anchors could still be discovered. A striking example was found in the comparison of <named-content content-type="genus-species" xlink:type="simple">Salmonella typhi</named-content> CT18 (<named-content content-type="genus-species" xlink:type="simple">S. typhi</named-content>) and <named-content content-type="genus-species" xlink:type="simple">S. typhi</named-content> ty2 (99% average identity)—see <xref ref-type="supplementary-material" rid="pcbi-0020075-sg002">Figure S2</xref>. K00357 (hmp), dihydropteridine reductase, one of the anchors uniquely common to the two organisms, corresponds to genomic segments (621146,621799) and (344300,345490), respectively. This anchor is isolated (it is not collinear to any other anchor). Furthermore, the identity percentage achieved by globally aligning the two segments is about 56% and 31%, respectively. Notice that in KEGG [<xref ref-type="bibr" rid="pcbi-0020075-b038">38</xref>], unlike in MAGIC, the alignments are done on the translated amino acid sequences, which may result in high amino acid similarity for low DNA sequence similarity. MAGIC, however, has found the segment (595530,629581) in <named-content content-type="genus-species" xlink:type="simple">S. typhi</named-content> to correspond to (2351520,2385571) in <named-content content-type="genus-species" xlink:type="simple">S. typhi</named-content> ty2. These two segments are 99% identical, are much longer than the initial KO, and are collinear with other entries. As for the segment (344300,345490) in <named-content content-type="genus-species" xlink:type="simple">S. typhi</named-content> ty2, MAGIC has found the segment (344119,355499) in <named-content content-type="genus-species" xlink:type="simple">S. typhi</named-content> ty2 to correspond to (2649350,2660730) in <italic>S. typhi,</italic> with similar properties to the above. Thus, K00357 is an example of a false anchor and a nuisance cross-overlap. As such, it is discarded during MAGIC's mapping phase (see Steps 3–5: Identifying nuisance, classifying inparalgos, and re-clustering).</p><p>Detailed statistics and classifications of false anchors are given in A Comparison with Mauve's Results and in <xref ref-type="table" rid="pcbi-0020075-t004">Table 4</xref>.</p></sec><sec id="s2g"><title>Major Forces Shaping the Prokaryotic Genome</title><p>The results described in <xref ref-type="table" rid="pcbi-0020075-t002">Table 2</xref> enable us to compare between the different forces shaping the genome, i.e<italic>.</italic>, point mutations, genome reorderings, duplications, and indels (insertions resulting from transposable elements, prophages, and HGTs or deletions). Many of these elements have been separately analyzed in the recent literature [<xref ref-type="bibr" rid="pcbi-0020075-b055">55</xref>,<xref ref-type="bibr" rid="pcbi-0020075-b058">58</xref>,<xref ref-type="bibr" rid="pcbi-0020075-b059">59</xref>,<xref ref-type="bibr" rid="pcbi-0020075-b068">68</xref>], but were not quantitatively compared against each other.</p><p>A comparison between duplications and indels indicates that indels are more frequent. Duplications, except in <named-content content-type="genus-species" xlink:type="simple">Bordetella bronchiseptica</named-content> and the two <italic>Neisseria,</italic> account for at most 1% of the genomes' lengths, whereas a large fraction of the genomes are not mapped to their counterparts because of lack of similarity. This observation is best explained by HGT or deletion events and is coherent with data indicating that HGT is the major cause of bacterial diversification [<xref ref-type="bibr" rid="pcbi-0020075-b069">69</xref>]. It is also consistent with the known role of lateral transfer in the fast exchange of pathogenicity islands among prokaryotes [<xref ref-type="bibr" rid="pcbi-0020075-b070">70</xref>,<xref ref-type="bibr" rid="pcbi-0020075-b071">71</xref>] and supports the hypothesis regarding its central role in speciation and sub-speciation [<xref ref-type="bibr" rid="pcbi-0020075-b072">72</xref>–<xref ref-type="bibr" rid="pcbi-0020075-b075">75</xref>]. In <italic>B. bronchiseptica,</italic> these events account for up to 30% of its genome. This high percentage is likely to result from massive gene loss in <named-content content-type="genus-species" xlink:type="simple">Bordetella pertussis</named-content> due to the action of transposable elements and its small population size [<xref ref-type="bibr" rid="pcbi-0020075-b076">76</xref>]. This analysis also points out that gene loss in <named-content content-type="genus-species" xlink:type="simple">B. pertussis</named-content> has severely reduced the number of inparalogs relative to the ancestral genome, if this is taken to be more similar to <named-content content-type="genus-species" xlink:type="simple">B. bronchiseptica</named-content>. Taking into account the evolutionary distance between the pairs of genomes, one finds <italic>Buchnera</italic> (<named-content content-type="genus-species" xlink:type="simple">B. aphidicola</named-content> aps and <named-content content-type="genus-species" xlink:type="simple">B. aphidicola</named-content> sg) at the other end of the spectrum with as little as 7% of unmapped regions for an average sequence identity of 75%, as described previously [<xref ref-type="bibr" rid="pcbi-0020075-b077">77</xref>].</p><p>Transposable elements and prophages can account for as much as 18% of the genome length, as in <named-content content-type="genus-species" xlink:type="simple">S. pyogenes</named-content> ssi1. However, the share of prophages is typically much larger than that of transposable elements, namely 3% and 1.25% on average, respectively.</p></sec><sec id="s2h"><title>Breakpoint Distribution</title><p>Let <italic>x</italic><sub>1</sub> &lt; <italic>x</italic><sub>2</sub> &lt; . . . &lt; <italic>x<sub>k</sub></italic> be the ordered positions of <italic>k</italic> breakpoints relative to a fixed origin in the genome, and denote the genome length by <italic>G</italic>. The check for breakpoint circular uniformity was done on the transformed positions 2<italic>πx</italic><sub>1</sub>/<italic>G</italic>, 2<italic>πx</italic><sub>2</sub>/<italic>G</italic>, …, 2<italic>πx<sub>k</sub></italic>/G by applying the Rao, the Watson, and the Kuiper tests [<xref ref-type="bibr" rid="pcbi-0020075-b078">78</xref>,<xref ref-type="bibr" rid="pcbi-0020075-b079">79</xref>]. The critical value in the three tests is set to 5%. All tests showed similar tendencies, except on the <italic>Helicobacter</italic> pair, <named-content content-type="genus-species" xlink:type="simple">S. flexneri</named-content> 2457t, and <named-content content-type="genus-species" xlink:type="simple">Neisseria meningitidis</named-content> a (which Rao rejected while Watson and Kuiper accepted), demonstrating the robustness of the results. In <xref ref-type="table" rid="pcbi-0020075-t002">Table 2</xref> we report the Rao test results (as mentioned above, the Rao test rejected more organisms than the other two tests), and the discussion is based on them. These results indicate that in more than four pairs, three of which are considered reliable (see <xref ref-type="table" rid="pcbi-0020075-t002">Table 2</xref>), one cannot reject the uniformity null-hypothesis.</p><p>One should emphasize that the breakpoint uniformity test aims only at checking genome reorderings. It does not take into account the disruption of chromosomal organization resulting from deletions and insertions of genetic material. In our comparisons we find that between 3% and 30% of the genomes cannot be mapped either to their counterpart or to known selfish DNA (<xref ref-type="table" rid="pcbi-0020075-t002">Table 2</xref>). These regions are likely to correspond to indels that occurred since the divergence of the species, i.e., HGTs and large deletions, and they have an important role in defining the boundaries between RF segments. Hence, our observation that the distribution of breakpoints can be uniform suggests that, in the relevant cases, the distribution of reorderings, and also the distribution of HGTs and large deletions, is uniform. This is in line with data indicating that HGT is more or less homogeneously distributed in <named-content content-type="genus-species" xlink:type="simple">E. coli</named-content> [<xref ref-type="bibr" rid="pcbi-0020075-b080">80</xref>] and along the two replichores of <italic>Bacillus</italic> and <italic>Streptococcus</italic> [<xref ref-type="bibr" rid="pcbi-0020075-b081">81</xref>].</p><p>Interestingly, and despite containing noninvertible segments [<xref ref-type="bibr" rid="pcbi-0020075-b020">20</xref>–<xref ref-type="bibr" rid="pcbi-0020075-b023">23</xref>], both <named-content content-type="genus-species" xlink:type="simple">S. typhimurium</named-content> and <named-content content-type="genus-species" xlink:type="simple">E. coli</named-content> mg1655 passed the uniformity test. The fit of uniformity in four pairwise comparisons is surprising for two additional reasons. First, one does not expect deletion and reordering events to be totally random because both events are typically induced by homologous recombination between repeated elements [<xref ref-type="bibr" rid="pcbi-0020075-b027">27</xref>]. Since these are discrete elements dispersed along the genome, the likelihood of each pair of contiguous nucleotides in the genome to be separated by a reordering mutation is not homogeneous. However, if there are many pairs of repeats displaced randomly in the chromosome, each with a low probability of leading to a reordering mutation, the overall picture is one of random distribution of breakpoints and few—if any—breakpoint reuses. Indeed, both <named-content content-type="genus-species" xlink:type="simple">E. coli</named-content> mg1655 and <named-content content-type="genus-species" xlink:type="simple">S. typhimurium</named-content> have many repeats [<xref ref-type="bibr" rid="pcbi-0020075-b082">82</xref>], but the number of reorderings between them is very low, in spite of the ~100 million years of divergence [<xref ref-type="bibr" rid="pcbi-0020075-b083">83</xref>]. Hence, although repeats are abundant and lead to reorderings, each individual repeat has a low probability of leading to a reordering that gets fixed in the population [<xref ref-type="bibr" rid="pcbi-0020075-b084">84</xref>]. Also, when one identifies inverted repeats within a genome, the distance between each pair of repeats is random [<xref ref-type="bibr" rid="pcbi-0020075-b082">82</xref>]. Thus, the conditions for a uniform positioning of breakpoints are fulfilled, but at a coarser level—the one defined by the distribution of repeats in genomes.</p><p>Second, even if reorderings, HGTs, and deletions were random, one would expect selection to purge events disrupting operons [<xref ref-type="bibr" rid="pcbi-0020075-b085">85</xref>] or disorganizing the chromosome relative to replication [<xref ref-type="bibr" rid="pcbi-0020075-b081">81</xref>]. However, none of these constraints would lead to a large deviation from uniformity. Hence, our data suggest that the uniformity is a good approximation of the reordering mechanisms of closely related bacterial genomes, even though a finer analysis might reveal the selective constraints associated with the organization of the genome.</p></sec><sec id="s2i"><title>A Comparison with Mauve's Results</title><p>Recall that Mauve's output includes an alignment of LCBs, comparable to MAGIC's RFs, and a backbone table (comparable to MAGIC's positional orthologs) containing segments in these alignments that do not contain large gaps. These segments are extracted similarly to Step 3 of MAGIC's preprocessing phase. However, in Mauve, proximal gaps are not joined before extracting long ones <italic>(&gt;maxBackboneGapSize</italic>). In addition, similarly to MAGIC's filtering steps, Mauve discards short entries <italic>(&lt;minBackboneSize</italic>). The seed-size threshold used in Mauve (comparable to BLAST's seed size) for filtering short multi-MUMs is dynamically calculated by the formula <italic>seed_size =</italic> log<sub>2</sub><inline-formula id="pcbi-0020075-ex001"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020075.ex001" xlink:type="simple"/></inline-formula>
					/1.5, where <italic>g</italic><sub>1</sub> and <italic>g</italic><sub>2</sub> are the sizes of the first and second genomes, respectively. For the genomes considered in this study, this value ranges between 12.8 and 15. These three parameters are comparable to the three parameters <italic>gapExtractLen, stitchMinLen,</italic> and BLAST seed size used in MAGIC, respectively. By giving these parameters two sets of values, we conducted two runs: in the first, Mauve's default values are used, whereas in the second, we set the values of the parameters to the defaults used in MAGIC (<italic>seed_size</italic> = 11, <italic>maxBackboneGapSize</italic> = 200,<italic>minBackboneSize</italic> = 200). The results of both runs are given in <xref ref-type="supplementary-material" rid="pcbi-0020075-st001">Tables S1</xref> and <xref ref-type="supplementary-material" rid="pcbi-0020075-st002">S2</xref>. We note that these settings might not be optimal for Mauve and that other settings might yield better results. A comparison between the results of both runs of Mauve (<xref ref-type="supplementary-material" rid="pcbi-0020075-st001">Tables S1</xref> and <xref ref-type="supplementary-material" rid="pcbi-0020075-st002">S2</xref>) against MAGIC's results (<xref ref-type="table" rid="pcbi-0020075-t002">Table 2</xref> and the example run given above in Example Run) shows the following: a) Mauve fragments the genomes into more segments (~7.7-fold higher on average in the ten pairs); b) Mauve's default settings sometimes give poor coverage—see, for example, the <italic>Streptococcus</italic> pair (with LCB/backbone coverage of 43% and 39%, respectively, in the default run and 95% and 92%, respectively, in the nondefault run); c) changing the seed size usually increases the fragmentation of the genomes as well (e.g., the number of LCBs is 9-fold higher for the <italic>Buchnera</italic> pair); d) both runs of Mauve reject the breakpoint circular uniformity null-hypothesis in all pairs, except in <italic>Buchnera</italic> (which has a single RF according to MAGIC); e) the values of the identity percentage in the three tables (<xref ref-type="table" rid="pcbi-0020075-t002">Tables 2</xref>, S1, and S2) are similar; f) the LCB and backbone coverage of Mauve with nondefault parameters are similar to the RF and positional orthologous coverage of MAGIC, respectively; g) Mauve is faster than MAGIC (unpublished data). On the example run (the comparison of <named-content content-type="genus-species" xlink:type="simple">S. flexneri</named-content> 2457t with <named-content content-type="genus-species" xlink:type="simple">S. typhi</named-content> ty2), Mauve terminated after less than 17 min of CPU time (the run was done by using the command-line tool, called mauveAligner—and not the Java GUI, called Mauve—as well as by using the program calculateBackboneCoverage for extracting the backbones and calculating identities), while MAGIC required about 35 min of CPU time, most of which is consumed by AVID for global alignments (about 70%) and by BLAST for local alignments (about 13%). Recall that the rest of MAGIC's steps are implemented as R [<xref ref-type="bibr" rid="pcbi-0020075-b039">39</xref>] and BASH scripts, whereas Mauve is implemented in C. (We expect MAGIC's C++ implementation to be faster.)
				</p><p>The differences in the LCB/RF numbers may result from either of these two reasons: the methods cover rather different parts of the genomes or the methods cover similar parts but map them differently. To get a better understanding of the differences in this case, we conducted two types of analysis: first, we checked whether the genomic portions covered by the two methods are similar. Second, we checked whether the mappings are similar. The results of the first comparison are given in <xref ref-type="table" rid="pcbi-0020075-t003">Table 3</xref> for Mauve's default run, and in <xref ref-type="supplementary-material" rid="pcbi-0020075-st003">Table S3</xref> for Mauve's nondefault run. These two tables show that when the coverage percentage is similar (e.g<italic>.</italic>, not in the <italic>Streptococcus</italic> pair), both methods cover similar portions of the genomes. Thus, the difference between the methods is most likely in the mapping.</p><p>To gain more evidence for this, we utilized the flexibility of MAGIC and its ability to correct false anchors by running it on Mauve's backbone tables. This feature is made possible by MAGIC's robustness with respect to the initial set of anchors, which we discuss in the next section. By checking MAGIC's classifications of the backbone anchors, we are able to learn more about the differences in the mappings. <xref ref-type="table" rid="pcbi-0020075-t004">Table 4</xref> describes these classifications. The table shows that there are indeed differences between the mappings achieved by the two methods. These differences are significant enough to explain the deviations in the results of the uniformity test. For example, in genomes with abundant transposable elements, e.g., <italic>Shigella,</italic> the results show many of Mauve's backbone anchors corresponding to transposable elements. A similar situation exists in genomes abundant with prophages, e.g., <italic>Streptococcus</italic>. In genomes abundant with repeats, e.g<italic>.</italic>, <italic>Neisseria</italic> [<xref ref-type="bibr" rid="pcbi-0020075-b086">86</xref>], the results show many of Mauve's backbone anchors corresponding to nuisance cross-overlaps, inparalogs, or final conflicts that MAGIC could not resolve (see Steps 6–7: Discarding remaining conflicts and re-clustering).</p><p>We note that for the two enterobacteria pairs, the total percentage of the corrected anchor lengths is less than 4%. This percentage is in agreement with the estimated error for Mauve on the enterobacteria family [<xref ref-type="bibr" rid="pcbi-0020075-b014">14</xref>]. The results achieved by both methods show that this small percentage (calculated according to nucleotide lengths) causes considerable differences in breakpoint positions, which are very significant for the uniformity test.</p></sec><sec id="s2j"><title>MAGIC's Robustness</title><p>MAGIC robustness was checked against two types of changes: first, and since MAGIC is an anchor-based method, robustness with respect to the initial set of anchors was tested; and second, robustness with respect to perturbations in the parameters' values was tested. In the following, we report the results of both tests.</p><sec id="s2j1"><title>Robustness with respect to the initial anchor set.</title><p>To validate the robustness of MAGIC relative to the initial set of anchors, we ran it on the backbone tables produced by Mauve (with default parameters). The results of this run are given in <xref ref-type="supplementary-material" rid="pcbi-0020075-st004">Table S4</xref>, and are similar to the results achieved in the KO-based run (<xref ref-type="table" rid="pcbi-0020075-t002">Table 2</xref>). This similarity demonstrated the robustness of MAGIC: in both runs, the identities are equal. The difference in RF numbers is at most 11 (in the <italic>Pyrococcus</italic> archaeal pair where the RF number equals 88 and 99, respectively). The difference in the RF coverage is usually very low and reaches a maximum of 5% in <named-content content-type="genus-species" xlink:type="simple">Neisseria meningitidis</named-content> b. The positional ortholog coverage is usually very similar and its maximal difference (of 7%) is obtained in <named-content content-type="genus-species" xlink:type="simple">S. pyogenes</named-content> m18 (which belongs to the pair on which Mauve yielded very low coverage with the default settings—see <xref ref-type="supplementary-material" rid="pcbi-0020075-st001">Table S1</xref>). Finally, the paralog percentage (the difference between the +IP column and the PO column in <xref ref-type="supplementary-material" rid="pcbi-0020075-st004">Table S4</xref>) is virtually identical.</p><p>The test for uniformity yielded similar results, and the same pairs are accepting/rejecting the test in both MAGIC's runs.</p></sec><sec id="s2j2"><title>Robustness with respect to parameter values.</title><p>We checked the effect of changing the parameters' values on MAGIC's results. Each length parameter was randomly chosen from {1/2<italic>d</italic>,<italic>d</italic>,3/2<italic>d</italic>}, where <italic>d</italic> is the parameter's default value (<xref ref-type="table" rid="pcbi-0020075-t001">Table 1</xref>). For example, <italic>gapJoinLen</italic> was randomly chosen from {55<italic>bp</italic>,110<italic>bp</italic>,165<italic>bp</italic>}. Each percentage parameter was randomly chosen from {<italic>d</italic> − 0.1,<italic>d</italic>,<italic>d</italic> + 0.1}, where <italic>d</italic> is the parameter's default value. For example, cleanISPerc was randomly chosen from {0.3,0.4,0.5}. Twenty random runs were performed on <named-content content-type="genus-species" xlink:type="simple">S. flexneri</named-content> 2457t and <named-content content-type="genus-species" xlink:type="simple">S. typhi</named-content> ty2. The greatest deviations were observed in the number of RFs—see <xref ref-type="fig" rid="pcbi-0020075-g013">Figure 13</xref>. These changes are not surprising, and result from removing or adding different types of entries along MAGIC's run because of the different parameter values. On the other hand, the RF and the positional ortholog coverage did not change significantly, ranging 0.83–0.85 and 0.59–0.64 in <named-content content-type="genus-species" xlink:type="simple">S. flexneri</named-content> 2457t, and 0.83–0.85 and 0.57–0.62 in <named-content content-type="genus-species" xlink:type="simple">S. typhi</named-content> ty2, respectively. The identity did not change much either, and ranged 0.78–0.80 in <named-content content-type="genus-species" xlink:type="simple">S. flexneri</named-content> 2457t and 0.78–0.79 in <named-content content-type="genus-species" xlink:type="simple">S. typhi</named-content> ty2.</p><fig id="pcbi-0020075-g013" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0020075.g013</object-id><label>Figure 13</label><caption><title>Histogram of RF Numbers when Comparing <named-content content-type="genus-species" xlink:type="simple">S. flexneri</named-content> 2457t versus <named-content content-type="genus-species" xlink:type="simple">S. typhi</named-content> ty2 under Different Parameter Values</title><p>See the section Robustness with respect to parameter values.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020075.g013" xlink:type="simple"/></fig></sec></sec><sec id="s2k"><title>MAGIC's Scalability</title><p>We perform two tests to check how MAGIC scales up: first, we run MAGIC on evolutionary distant pairs. Second, we test MAGIC on large genomes.</p><sec id="s2k1"><title>Comparing evolutionarily distant organisms.</title><p>The results of comparing evolutionarily distant organisms are given in <xref ref-type="table" rid="pcbi-0020075-t006">Table 6</xref>. Despite their very low average similarity (~65% of protein similarity between orthologs), MAGIC was able to calculate a good mapping for these pairs. In particular, the results for the <italic>Chlamydia</italic> pair are in agreement with those reported in previous studies [<xref ref-type="bibr" rid="pcbi-0020075-b087">87</xref>].</p><table-wrap content-type="1col" id="pcbi-0020075-t006" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0020075.t006</object-id><label>Table 6</label><caption><p>Comparing Distantly Related Bacteria Pairs</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020075.t006" xlink:type="simple"/><!-- <table frame="hsides" rules="none"><colgroup><col id="tb6col1" align="left" charoff="0" char=""/><col id="tb6col2" align="left" charoff="0" char=""/><col id="tb6col3" align="left" charoff="0" char=""/><col id="tb6col4" align="left" charoff="0" char=""/><col id="tb6col5" align="left" charoff="0" char=""/><col id="tb6col6" align="left" charoff="0" char=""/><col id="tb6col7" align="left" charoff="0" char=""/><col id="tb6col8" align="left" charoff="0" char=""/><col id="tb6col9" align="left" charoff="0" char=""/></colgroup><thead><tr><td align="left"><hr/>Species</td><td valign="middle"><hr/>Organism (Each Two a Pair)</td><td valign="middle"><hr/>Size</td><td valign="middle"><hr/>RF (Number/Coverage)</td><td valign="middle"><hr/>PO</td><td valign="middle"><hr/>&plus;IP</td><td valign="middle"><hr/>&plus;Transposable</td><td valign="middle"><hr/>&plus;Prophages</td><td valign="middle"><hr/>Identity</td></tr></thead><tbody><tr><td><italic>Chlamydia</italic></td><td valign="middle"><named-content content-type="genus-species">C. trachomatis</named-content></td><td valign="middle">1,042,519</td><td valign="middle">65/0.81</td><td valign="middle">0.70</td><td valign="middle">0.71</td><td valign="middle">0.71</td><td valign="middle">0.71</td><td valign="middle">0.62</td></tr><tr><td></td><td valign="middle"><named-content content-type="genus-species">C. pneumoniae</named-content></td><td valign="middle">1,230,230</td><td valign="middle">65/0.74</td><td valign="middle">0.59</td><td valign="middle">0.59</td><td valign="middle">0.59</td><td valign="middle">0.59</td><td valign="middle">0.63</td></tr><tr><td><italic>Bacillus</italic></td><td valign="middle"><named-content content-type="genus-species">B. subtilis</named-content></td><td valign="middle">4,214,630</td><td valign="middle">275/0.39</td><td valign="middle">0.28</td><td valign="middle">0.29</td><td valign="middle">0.29</td><td valign="middle">0.35</td><td valign="middle">0.63</td></tr><tr><td></td><td valign="middle"><named-content content-type="genus-species">B. anthracis</named-content><sup>a</sup></td><td valign="middle">5,227,293</td><td valign="middle">275/0.34</td><td valign="middle">0.23</td><td valign="middle">0.23</td><td valign="middle">0.23</td><td valign="middle">0.23</td><td valign="middle">0.63</td></tr></tbody></table> --><!-- <table-wrap-foot><fn id="nt601"><p>The format is identical to that of <xref ref-type="table" rid="pcbi-0020075-t002">Table 2</xref>.</p></fn><fn id="nt602"><p>RF, number and coverage of reordering-free segments.</p></fn><fn id="nt603"><p>PO, coverage of positionally orthologous segments.</p></fn><fn id="nt604"><p>&plus;IP, adding inparalogs to the previous column.</p></fn><fn id="nt605"><p>&plus;Transposable, adding transposable elements to the previous column.</p></fn><fn id="nt606"><p>&plus;Prophages, adding prophages as well as phagic elements to the previous columns.</p></fn><fn id="nt607"><p>Identity, mean identity of all positional orthologs.</p></fn><fn id="nt608"><p><sup>a</sup>Indicates that no prophage annotation was available for those species.</p></fn></table-wrap-foot> --></table-wrap></sec><sec id="s2k2"><title>Comparison of the X chromosome in human–mouse.</title><p>Although the initial motivation of our method was to compare prokaryotic genomes, we applied MAGIC to the X chromosome of the human and mouse genomes to assess its scalability. Running the preprocessing phase on the human–mouse genomes is time-consuming: BLASTZ (a fast local alignment tool) required 481 days of CPU time on a cluster of 1,024 833-Mhz Pentium III CPUs [<xref ref-type="bibr" rid="pcbi-0020075-b012">12</xref>]. To avoid this computational bottleneck, we extracted the information on the X chromosome from the precomputed preprocessing table available on the UCSC Genome Browser [<xref ref-type="bibr" rid="pcbi-0020075-b088">88</xref>] for the human genome build 35 and the mouse genome build 35. Because of the large size of the table, we had to implement our mapping phase in C++. The initial size of the table (restricted to the X chromosome) is 86,755. Running the C++ implementation required less than half a minute of CPU time and less than 10 MB of memory on a 1.4-GHz PC equipped with GNU/Linux. The resulting table contained 1,101 entries. Removing entries shorter than 100,00 bp and re-clustering reduced the table size to 25. Removing entries shorter than 1,000,000 bp and re-clustering reduced further the table size to 7. This table is presented in <xref ref-type="supplementary-material" rid="pcbi-0020075-st005">Table S5</xref>. The calculated RF coverage is 0.85 and 0.90 in the human and mouse, respectively. These results are comparable to what has been previously reported [<xref ref-type="bibr" rid="pcbi-0020075-b017">17</xref>,<xref ref-type="bibr" rid="pcbi-0020075-b088">88</xref>]—see <xref ref-type="table" rid="pcbi-0020075-t007">Tables 7</xref> and <xref ref-type="table" rid="pcbi-0020075-t008">8</xref>. The implementation of MAGIC in C++, when ready, will allow both a more detailed comparison of these results and an extension of the analysis to larger chromosomes.</p><table-wrap content-type="1col" id="pcbi-0020075-t007" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0020075.t007</object-id><label>Table 7</label><caption><p>Comparing the Results of MAGIC, GRIMM-Synteny, and the UCSC Genome Browser on Human–Mouse X Chromosome</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020075.t007" xlink:type="simple"/><!-- <table frame="hsides" rules="none"><colgroup><col id="tb7col1" align="left" charoff="0" char=""/><col id="tb7col2" align="left" charoff="0" char=""/><col id="tb7col3" align="left" charoff="0" char=""/><col id="tb7col4" align="left" charoff="0" char=""/></colgroup><thead><tr><td align="left"><hr/>Method</td><td><hr/>Table Size</td><td><hr/>Human Coverage</td><td><hr/>Mouse Coverage</td></tr></thead><tbody><tr><td>MAGIC</td><td>7</td><td>0.85</td><td>0.90</td></tr><tr><td>GRIMM-Synteny</td><td>11</td><td>0.82</td><td>0.79</td></tr><tr><td>UCSC Genome Browser</td><td>6</td><td>0.93</td><td>0.92</td></tr></tbody></table> --><!-- <table-wrap-foot><fn id="nt701"><p>In all methods, segments shorter than 1,000,000 bp were discarded. Table size and coverage as reported by the three methods.</p></fn><fn id="nt702"><p>Table size, the number of RF segments (MAGIC), synteny blocks (GRIMM-Synteny) &lsqb;<xref ref-type="bibr" rid="pcbi-0020075-b017">17</xref>&rsqb;, and nets in the syntenic subset (UCSC Genome Browser) &lsqb;<xref ref-type="bibr" rid="pcbi-0020075-b015">15</xref>&rsqb;.</p></fn><fn id="nt703"><p>Human Coverage, segments coverage of the human X chromosome.</p></fn><fn id="nt704"><p>Mouse Coverage, segments coverage of the mouse X chromosome.</p></fn></table-wrap-foot> --></table-wrap><table-wrap content-type="1col" id="pcbi-0020075-t008" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0020075.t008</object-id><label>Table 8</label><caption><p>Comparing the Results of MAGIC, GRIMM-Synteny, and the UCSC Genome Browser on Human–Mouse X Chromosome</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020075.t008" xlink:type="simple"/><!-- <table frame="hsides" rules="none"><colgroup><col id="tb8col1" align="left" charoff="0" char=""/><col id="tb8col2" align="left" charoff="0" char=""/><col id="tb8col3" align="left" charoff="0" char=""/></colgroup><thead><tr><td align="left"><hr/>Method</td><td><hr/>Human</td><td><hr/>Mouse</td></tr></thead><tbody><tr><td>MG&ndash;GS</td><td>0.09</td><td>0.18</td></tr><tr><td>GS&ndash;MG</td><td>0.05</td><td>0.06</td></tr><tr><td>MG&ndash;UC</td><td>0.00</td><td>0.05</td></tr><tr><td>UC&ndash;MG</td><td>0.08</td><td>0.07</td></tr><tr><td>GS&ndash;UC</td><td>0.00</td><td>0.03</td></tr><tr><td>UC&ndash;GS</td><td>0.11</td><td>0.16</td></tr></tbody></table> --><!-- <table-wrap-foot><fn id="nt801"><p>In all methods, segments shorter than 1,000,000 bp were discarded. Differences in chromosome coverage: the genomic portion covered by MAGIC's (MG) RFs but not by GRIMM-Synteny (GS) &lsqb;<xref ref-type="bibr" rid="pcbi-0020075-b017">17</xref>&rsqb; syntenic blocks (MG&ndash;GS) as well as the portion covered by MAGIC's RFs but not by the UCSC Genome Browser (UC) syntenic nets (MG&ndash;UC). The rest of the differences are defined similarly. Notice that the results of the different methods are reported on different Human and Mouse genome assemblies. Furthermore, whereas MAGIC's RFs and GRIMM-Synteny syntenic blocks correspond to one-to-one mappings, the UCSC Genome Browser table represents a hierarchy of syntenic nets &lsqb;<xref ref-type="bibr" rid="pcbi-0020075-b015">15</xref>&rsqb;.</p></fn></table-wrap-foot> --></table-wrap></sec></sec><sec id="s2l"><title>Future Work</title><p>MAGIC can be enhanced to enable comparing both multichromosomal organisms and multiple genomes. Furthermore, MAGIC can be extended to integrate additional annotations of the genomes. For example, such an approach was adopted in [<xref ref-type="bibr" rid="pcbi-0020075-b089">89</xref>]. Here, identified repeat pairs were added to MAGIC's comparative mapping, enabling a unique and efficient reconstruction of the ancestral genome order and the rearrangement scenario.</p></sec></sec><sec id="s3"><title>Materials and Methods</title><p>In this section we give a formal description of the methods used in stitching local matches (Step 4 in the preprocessing phase) and clustering the RF segments (Step 2 in the mapping phase). Throughout the section we present a correspondence between a segment in organism 1 and a segment in organism 2 as an Entry <italic>I</italic> = ((<italic>s</italic><sub>1</sub>(<italic>I</italic>),<italic>e</italic><sub>1</sub>(<italic>I</italic>)),(<italic>s</italic><sub>2</sub>(<italic>I</italic>),<italic>e</italic><sub>2</sub>(<italic>I</italic>)),<italic>sign</italic>(<italic>I</italic>)). Here, (<italic>s<sub>k</sub></italic>(<italic>I</italic>),<italic>e<sub>k</sub></italic>(<italic>I</italic>)) represents the start and end indices of the entry in organism <italic>k,</italic> for <italic>k</italic> ∈ {1,2}, and <italic>sign</italic>(<italic>I</italic>) represents the sign of the entry, i.e., +1, if the matching sequences have the same orientation in both organisms and −1 otherwise.</p><sec id="s3a"><title>Formal description of stitching local matches.</title><p>Let <italic>I</italic> and <italic>J</italic> be two entries representing two hits such that <italic>sign</italic>(<italic>I</italic>) = <italic>sign</italic>(<italic>J</italic>), <italic>s</italic><sub>1</sub>(<italic>I</italic>) ≤ <italic>s</italic><sub>1</sub>(<italic>J</italic>), and <italic>sign</italic> (<italic>I</italic>) · <italic>s</italic><sub>2</sub>(<italic>I</italic>) ≤ <italic>sign</italic>(<italic>I</italic>) · s<sub>2</sub>(<italic>J</italic>). We define the relative distance between (<italic>s</italic><sub>1</sub>(<italic>I</italic>),<italic>s</italic><sub>1</sub>(<italic>J</italic>)) and (<italic>s</italic><sub>2</sub>(<italic>I</italic>)<italic>s</italic><sub>2</sub>(<italic>J</italic>)) as</p><disp-formula id="pcbi-0020075-e001"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0020075.e001" xlink:type="simple"/><!-- <mml:math display='block'><mml:mi>d</mml:mi><mml:mo>(</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>(</mml:mo><mml:mi>J</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>(</mml:mo><mml:mi>J</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mo>&equals;</mml:mo><mml:mo>|</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo><mml:mo>&minus;</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>(</mml:mo><mml:mi>J</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mo>&minus;</mml:mo><mml:mtext>sign</mml:mtext><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo><mml:mi>&middot;</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo><mml:mo>&minus;</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>(</mml:mo><mml:mi>J</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mo>|</mml:mo></mml:math> --></disp-formula><p>Notice that <italic>s</italic><sub>2</sub>(<italic>I</italic>) ≤ <italic>s</italic><sub>2</sub>(<italic>J</italic>) when <italic>sign</italic>(<italic>I</italic>) = 1. But if <italic>sign</italic>(<italic>I</italic>) = −1, we have <italic>s</italic><sub>2</sub>(<italic>I</italic>) ≥ <italic>s</italic><sub>2</sub>(<italic>J</italic>). To correct the latter, we need to multiply <italic>s</italic><sub>2</sub>(<italic>I</italic>) − <italic>s</italic><sub>2</sub>(<italic>J</italic>) by the sign <italic>sign</italic>(<italic>I</italic>).</p><p>Intuitively, the distance defined in Equation 1 corresponds to the length of indel mutations that occurred since the divergence of the two organisms. This distance directly influences the result of the global alignment that we are going to perform on the stitched local matches. If the distance in Equation 1 is too big, then most probably the global alignment is going to contain big gaps, and hence is going to be broken. Thus, stitching faraway (with respect to Equation 1) hits would be unwise. Therefore, we first group hits with relative distance smaller than a specified threshold (parameter <italic>stitchDifference</italic> in Algorithm 2). Afterward, we check that the grouped hits are not too far apart on both genomes, i.e., that | <italic>s</italic><sub>1</sub>(<italic>I</italic>) − <italic>s</italic><sub>1</sub>(<italic>J</italic>)| + | <italic>s</italic><sub>2</sub>(<italic>I</italic>) − <italic>s</italic><sub>2</sub>(<italic>J</italic>) | is smaller than a specified threshold (parameter <italic>stitchDistance</italic> in Algorithm 2). Indeed, if a segment is conserved in the two organisms, one would expect to find a lot of hits in it. Thus, the distance between consecutive hits in a conserved segment should be short. Finally, stitched matches that are longer than a specified threshold in both organisms (parameter <italic>stitchMinLen</italic> in Algorithm 2) are further considered. Pseudo-code describing this step is given in Algorithm 2.</p></sec><sec id="s3b"><title>Formal description of clustering into RF segments.</title><p><xref ref-type="fig" rid="pcbi-0020075-g002">Figure 2</xref> is used throughout this section to demonstrate the different definitions and steps.</p><p>Denote the length of the intersection of Entries <italic>I</italic> and <italic>J</italic> in organism <italic>k</italic> by <italic>intersect</italic>(<italic>I</italic>,<italic>J</italic>,<italic>k</italic>) and denote the length of Entry <italic>I</italic> in organism <italic>k</italic> by λ(<italic>I</italic>,<italic>k</italic>). Entries <italic>I</italic> and <italic>J</italic> are said to <italic>significantly overlap</italic> in organism <italic>k</italic> if their intersection length is greater than <italic>dupPerc</italic> of the length of the shorter one according to <italic>k,</italic> i.e., <italic>intersec</italic>t(<italic>I</italic>,<italic>J</italic>,<italic>k</italic>) ≥ <italic>dupPerc</italic> · min(λ(<italic>I</italic>,<italic>k</italic>),λ(<italic>J</italic>,<italic>k</italic>)). Define <italic>Duplicates</italic>(<italic>I</italic>,<italic>k</italic>) to be the set of all entries that significantly overlap with Entry <italic>I</italic> in organism <italic>k</italic> (including <italic>I</italic> itself). In <xref ref-type="fig" rid="pcbi-0020075-g002">Figure 2</xref> (with <italic>dupPerc</italic> = 50%), since Entries 2 and 3 significantly overlap in <italic>E. coli,</italic> we have <italic>Duplicates</italic>(2,1) = {2,3}. In <named-content content-type="genus-species" xlink:type="simple">S. typhi</named-content> ty2, however, Entry 2 does not overlap significantly with other entries and thus <italic>Duplicates</italic>(2,2) = {2}. Given two Entries <italic>I</italic> and <italic>J,</italic> denote by <italic>dist</italic>(<italic>I</italic>,<italic>J</italic>,<italic>k</italic>), for <italic>k</italic> ∈ {1,2}, the offset between <italic>J</italic> and <italic>I</italic> when sorting the table in lexicographical order according to (<italic>s</italic><sub>k</sub>,<italic>e</italic><sub>k</sub>), i.e., sorting first according to <italic>s<sub>k</sub></italic> and among entries having the same <italic>s<sub>k</sub></italic> value according to <italic>e<sub>k</sub></italic>. For example, if the table is sorted according to (<italic>s</italic><sub>1</sub>,<italic>e</italic><sub>1</sub>), then <italic>dist</italic>(<italic>I</italic>,<italic>J</italic>,1) = J − <italic>I</italic>. Notice that dist(·,·,·) is a signed quantity. In <xref ref-type="fig" rid="pcbi-0020075-g002">Figure 2</xref>, the arrows are sorted in lexicographical order according to <named-content content-type="genus-species" xlink:type="simple">E. coli</named-content>. For Entries 1,2 and 4 we have: <italic>dist</italic>(1,2,1) = <italic>dist</italic>(1,2,2) = 1 while <italic>dist</italic>(1,4,1) = 3 and <italic>dist</italic>(1,4,2) = −2 (Entry 3 precedes Entry 4 in <named-content content-type="genus-species" xlink:type="simple">S. typhi</named-content> ty2).</p><p>We refer to two Entries <italic>I</italic> and <italic>J</italic> such that | <italic>dist</italic>(<italic>I</italic>,<italic>J</italic>,<italic>k</italic>) | = 1 as <italic>successive</italic> in organism <italic>k</italic>. If <italic>dist</italic>(<italic>I</italic>,<italic>J</italic>,1) = 1 and <italic>dist</italic>(<italic>I</italic>,<italic>J</italic>,2) = sign(<italic>I</italic>), then <italic>I</italic> and <italic>J</italic> are successive in both organisms in the correct orientation with respect to <italic>I</italic>'s sign. If, in addition, <italic>sign</italic>(<italic>I</italic>) = <italic>sign</italic>(<italic>J</italic>), then (<italic>I</italic>,<italic>J</italic>) are <italic>consecutive</italic>. If the table does not contain overlapping entries, the previous definition would have been sufficient. However, as <xref ref-type="fig" rid="pcbi-0020075-g002">Figure 2</xref> demonstrates, usually this is not the case. To cope with overlapping entries, the definition of consecutive entries needs to be generalized. We denote the “desired” distance between two Entries <italic>I</italic> and <italic>J</italic> that have the same sign by <italic>C<sub>k</sub></italic>. So we have <italic>C</italic><sub>1</sub> = 1 and <italic>C</italic>2 = <italic>sign</italic>(<italic>I</italic>). If the segment of <italic>J</italic> in organism 2 was duplicated, then we might get that | <italic>dist</italic>(<italic>I</italic>,<italic>J</italic>,1) | &gt; 1, as is the case with Entries 1,3 in <xref ref-type="fig" rid="pcbi-0020075-g002">Figure 2</xref>. Consider the sets <italic>Duplicates</italic>(<italic>I</italic>,<italic>k</italic>) and <italic>Duplicates</italic>(<italic>J</italic>,<italic>k</italic>) for <italic>k</italic> ∈ {1,2}. Define the distance in organism <italic>k</italic> between the sets of significant overlaps of <italic>I</italic> and significant overlaps of <italic>J</italic> as the closest distance to the desired distance <italic>C<sub>k</sub></italic> realized by a pair of significant overlaps:
					<disp-formula id="pcbi-0020075-e002"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0020075.e002" xlink:type="simple"/><!-- <mml:math display='block'><mml:mspace width='-8pc'/><mml:mtext fontstyle='italic'>Dist</mml:mtext><mml:mo>(</mml:mo><mml:mtext fontstyle='italic'>Duplicates</mml:mtext><mml:mo>(</mml:mo><mml:mi>J</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mtext fontstyle='italic'>Duplicates</mml:mtext><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:math> --><!-- <mml:math display='block'><mml:mo>&esdot;</mml:mo><mml:msub><mml:mtext fontstyle='italic'>minarg</mml:mtext><mml:mrow><mml:mtext fontstyle='italic'>dist</mml:mtext><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mo>&lcub;</mml:mo><mml:mtext fontstyle='italic'>|dist</mml:mtext><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo><mml:mi>&minus;</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>:</mml:mo></mml:math> --><!-- <mml:math display='block'><mml:mi>L</mml:mi><mml:mo>&isin;</mml:mo><mml:mtext fontstyle='italic'>Duplicates</mml:mtext><mml:mo>(</mml:mo><mml:mi>J</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mo>&isin;</mml:mo><mml:mtext fontstyle='italic'>Duplicates</mml:mtext><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo><mml:mo>&rcub;</mml:mo></mml:math> --></disp-formula>For example, we have
					<disp-formula id="pcbi-0020075-e003"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0020075.e003" xlink:type="simple"/><!-- <mml:math display='block'><mml:mtext>dist</mml:mtext><mml:mo>(</mml:mo><mml:mo>(</mml:mo><mml:mtext>Duplicates</mml:mtext><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mtext>Duplicates</mml:mtext><mml:mo>(</mml:mo><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mo>&equals;</mml:mo><mml:mn>3</mml:mn></mml:math> --></disp-formula>and
					<disp-formula id="pcbi-0020075-e004"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0020075.e004" xlink:type="simple"/><!-- <mml:math display='block'><mml:mtext fontstyle='italic'>dist</mml:mtext><mml:mo>(</mml:mo><mml:mo>(</mml:mo><mml:mtext fontstyle='italic'>Duplicates</mml:mtext><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mtext fontstyle='italic'>Duplicates</mml:mtext><mml:mo>(</mml:mo><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo><mml:mo>&equals;</mml:mo><mml:mo>&minus;</mml:mo><mml:mn>1.</mml:mn></mml:math> --></disp-formula>
				</p><p>We say that (<italic>I</italic>,<italic>J</italic>) is a <italic>potentially consecutive pair</italic> (PCP) if J ∉ <italic>Duplicates</italic>(<italic>I</italic>,<italic>k</italic>) for <italic>k</italic> ∈ {1,2}, the entries have the same relative orientation (<italic>sign</italic>(<italic>I</italic>) = <italic>sign</italic>(<italic>J</italic>)), and</p><disp-formula id="pcbi-0020075-e005"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0020075.e005" xlink:type="simple"/><!-- <mml:math display='block'><mml:mtext fontstyle='italic'>Dist</mml:mtext><mml:mo>(</mml:mo><mml:mtext fontstyle='italic'>Duplicates</mml:mtext><mml:mo>(</mml:mo><mml:mi>J</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mtext fontstyle='italic'>Duplicates</mml:mtext><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo><mml:mo>&equals;</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy='true'>&lcub;</mml:mo> <mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi>k</mml:mi><mml:mo>&equals;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>n</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>I</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi>k</mml:mi><mml:mo>&equals;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow> </mml:mrow></mml:mrow></mml:math> --></disp-formula><p>Given an Entry <italic>I,</italic> it might be the case that there exists <italic>J</italic> and <italic>J′</italic> ≠ <italic>J</italic> where both pairs (<italic>I</italic>,<italic>J</italic>) and (<italic>I</italic>,<italic>J′</italic>) are PCPs. If (<italic>I</italic>,<italic>J</italic>) is a PCP such that
					<disp-formula id="pcbi-0020075-e006"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0020075.e006" xlink:type="simple"/><!-- <mml:math display='block'><mml:mo>&forall;</mml:mo><mml:mi>J</mml:mi><mml:mo>&prime; </mml:mo><mml:mo>&ne;</mml:mo><mml:mi>J</mml:mi><mml:mo>,</mml:mo><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>,</mml:mo><mml:mi>J</mml:mi><mml:mo>&prime;</mml:mo><mml:mo>)</mml:mo><mml:mtext fontstyle='italic'>PCP</mml:mtext><mml:mo>:</mml:mo><mml:mtext fontstyle='italic'>dist</mml:mtext><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>,</mml:mo><mml:mi>J</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo><mml:mi>&le;</mml:mi><mml:mtext fontstyle='italic'>dist</mml:mtext><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>,</mml:mo><mml:mi>J</mml:mi><mml:mo>&prime;</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mi>&isin;</mml:mi><mml:mo>&lcub;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>&rcub;</mml:mo></mml:math> --><!-- <mml:math display='block'><mml:mo>&forall;</mml:mo><mml:mi>I</mml:mi><mml:mo>&prime;</mml:mo><mml:mo>&ne;</mml:mo><mml:mi>I</mml:mi><mml:mo>,</mml:mo><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>&prime;</mml:mo><mml:mo>,</mml:mo><mml:mi>J</mml:mi><mml:mo>)</mml:mo><mml:mtext fontstyle='italic'>PCP</mml:mtext><mml:mo>:</mml:mo><mml:mtext fontstyle='italic'>dist</mml:mtext><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>,</mml:mo><mml:mi>J</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo><mml:mi>&le;</mml:mi><mml:mtext fontstyle='italic'>dist</mml:mtext><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>&prime;</mml:mo><mml:mo>,</mml:mo><mml:mi>J</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo><mml:mi>k</mml:mi><mml:mi>&isin;</mml:mi><mml:mo>&lcub;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>&rcub;</mml:mo></mml:math> --></disp-formula>i.e., the <italic>best</italic> PCP, then we refer to them as <italic>consecutive</italic>. For a consecutive pair (<italic>I</italic>,<italic>J</italic>), where <italic>J</italic> comes after <italic>I</italic> according to the lexicographical order on (<italic>s</italic><sub>1</sub>(·),<italic>e</italic><sub>1</sub>(·)), we say that <italic>J</italic> is consecutive to <italic>I</italic> and denote this by <italic>J</italic> = <italic>consec</italic>(<italic>I</italic>).
				</p><p>In <xref ref-type="fig" rid="pcbi-0020075-g002">Figure 2</xref>, we have that <italic>Duplicates</italic>(1,1) = <italic>Duplicates</italic>(1,2) = {1} while <italic>Duplicates</italic>(3,1) = {2,3} and <italic>Duplicates</italic>(3,2) = {3,4,5}. Notice that <italic>sign</italic>(1) = <italic>sign</italic>(3) = − 1 and that Entries 1,3 do not significantly overlap. On the other hand, we have that <italic>dist</italic>({1},{2,3},1) = 1 and <italic>dist</italic>({1},{3,4,5},2) = −1. In addition (1,3) is the only PCP involving either Entry 1 or Entry 3. Thus we conclude that 3 = <italic>consec</italic>(1).</p><p>It is straightforward to show that, in general, if the table contains no entries that overlap in both organisms, each entry can have at most one consecutive entry and each entry can be the consecutive of at most another one.</p><p>Using the notion of “consecutive,” we can use single linkage clustering to start constructing the RF segments as follows: calculate chains (or runs) of consecutive entries in the table and join them to the same RF segment. A pseudo-code implementing this idea is given in Algorithm 3. Notice that the resulting table might still contain overlapping entries. To identify duplications correctly, we need first to identify and remove “nuisance cross-overlaps.” We say that Entry <italic>I cross-overlaps</italic> in the table if <italic>I</italic> significantly overlaps with two other Entries <italic>H</italic> and <italic>J</italic> in organisms 1 and 2, respectively, i.e., <italic>I</italic> ∈ <italic>Duplicates</italic>(<italic>H</italic>,1) and <italic>I</italic> ∈ <italic>Duplicates</italic>(<italic>J</italic>,2). Notice that cross-overlaps might correspond either to “fake” hits, e.g., low similarity homologous segments, or might be the result of evolutionary events, e.g., duplications or genome rearrangements in both organisms. We distinguish between the two cases based on the relative lengths of the entries: if the length of <italic>I</italic> is less than <italic>orgPerc</italic> the lengths of <italic>H</italic> and <italic>J</italic> in organisms 1 and 2, respectively, i.e., <italic>ℓ</italic>(<italic>I</italic>,1) &lt; <italic>orgPerc</italic> · <italic>ℓ</italic>(<italic>H</italic>,1) and <italic>ℓ</italic>(<italic>I</italic>,2) &lt; <italic>orgPerc</italic> · <italic>ℓ</italic>(<italic>J</italic>,2), <italic>I</italic> is considered as a <italic>nuisance cross-overlap</italic> and is discarded.</p><p>For the remaining significant overlaps, we consider those for which positional orthologs and inparalogs can be determined: if <italic>I</italic> significantly overlaps with <italic>J</italic> in organism <italic>k</italic> and <italic>I</italic> is shorter than <italic>orgPerc</italic> of <italic>J</italic>'s length in <italic>k,</italic> i.e., <italic>ℓ</italic>(I,k) &lt; orgPerc · <italic>ℓ</italic>(<italic>J</italic>,<italic>k</italic>), <italic>I</italic> is declared an inparalog and <italic>J</italic> is declared a positional ortholog.</p></sec><sec id="s3c"><title>Pseudo-code.</title><p><bold>Algorithm 1</bold> getGappedSegments(<italic>org</italic>1<italic>Gaps</italic>,<italic>org</italic>2<italic>Gaps</italic>,<italic>gapExtractLen</italic>, <italic>gapJoinLen</italic>)</p><p>1: <italic>org</italic>1<italic>CloseGaps</italic> ← joinCloseGaps(<italic>org</italic>1<italic>Gaps</italic>,<italic>gapJoinLen</italic>)</p><p>2: <italic>org2CloseGaps</italic> ← joinCloseGaps(<italic>org</italic>2<italic>Gaps</italic>,<italic>gapJoinLen</italic>)</p><p>3: <italic>org</italic>1<italic>LongGaps</italic> ← gapsLongerThanThreshold(<italic>org</italic>1<italic>CloseGaps</italic>,<italic>gapExtractLen</italic>)</p><p>4: <italic>org</italic>2<italic>LongGaps</italic> ← gapsLongerThanThreshold(<italic>org</italic>2<italic>CloseGaps</italic>,<italic>gapExtractLen</italic>)</p><p>5: return mergeGaps(org1<italic>LongGaps</italic>,<italic>org</italic>2<italic>LongGaps</italic>)</p><p><bold>Algorithm 2</bold> combineBlastResults(<italic>hits</italic>,<italic>stitchDifference</italic>,<italic>stitchMinLen</italic>,<italic>stitchDistance</italic>)</p><p>1:  <italic>relativeDistanceHits</italic> ← checkRelativeDistance(<italic>hits</italic>,<italic>stitchDifference</italic>)</p><p>2: <italic>absoluteDistanceHits</italic> ← checkAbsoluteDistance(<italic>relativeDistanceHits</italic>,<italic>stitchDistance</italic>)</p><p>3: return checkLength(<italic>absoluteDistanceHits</italic>,<italic>stitchMinLen</italic>)</p><p><bold>Algorithm 3</bold> buildRFs(<italic>table</italic>)</p><p>1: let <italic>group</italic>[·] be an array of length <italic>length</italic>(<italic>table</italic>) s.t. ∀<italic>I</italic> ∈ <italic>table</italic> : <italic>group</italic>[<italic>I</italic>]= <italic>I</italic>.</p><p>2: for <italic>I</italic> ∈ <italic>table</italic> do</p><p>3:  <italic>J</italic> ← <italic>consec</italic>(<italic>I</italic>)</p><p>4:  if J != NULL then</p><p>5:   <italic>group</italic>[<italic>J</italic>] ← <italic>group</italic>[<italic>I</italic>]</p><p>6:  end if</p><p>7: end for</p><p>8: cluster <italic>table</italic> according to <italic>group</italic>[·]</p><p>9: return clusters</p></sec></sec><sec id="s4"><title>Supporting Information</title><supplementary-material id="pcbi-0020075-sg001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020075.sg001" xlink:type="simple"><label>Figure S1</label><caption><title>An Example of a Final Conflict in the Comparison of <named-content content-type="genus-species" xlink:type="simple">S. flexneri</named-content> 2457t and <named-content content-type="genus-species" xlink:type="simple">S. typhi</named-content> ty2</title><p>The cyan and the gray entries correspond to the same segment in <named-content content-type="genus-species" xlink:type="simple">S. typhi</named-content> ty2. However, their corresponding segments in <named-content content-type="genus-species" xlink:type="simple">S. flexneri</named-content> 2457t are different. Since these two entries are not collinear to any other entry, one cannot infer positional ortholog and inparalog relations based on length considerations. Hence, these two entries are considered a conflict.</p><p>(30 KB PDF)</p></caption></supplementary-material><supplementary-material id="pcbi-0020075-sg002" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020075.sg002" xlink:type="simple"><label>Figure S2</label><caption><title>An Example of a False KO Anchor Resulting from a Nuisance Cross-Overlap in the Comparison of <named-content content-type="genus-species" xlink:type="simple">S. typhi</named-content> ct18 and <named-content content-type="genus-species" xlink:type="simple">S. typhi</named-content> ty2</title><p>Entry 2 (green) corresponds to K00357. By comparing it with Entry 1 and Entry 3, it is easy to see that Entry 2 corresponds to a false anchor and is a nuisance cross-overlap.</p><p>(21 KB PDF)</p></caption></supplementary-material><supplementary-material id="pcbi-0020075-st001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020075.st001" xlink:type="simple"><label>Table S1</label><caption><title>Running Mauve with Default Parameters on 10 Prokaryotic Pairs</title><p>(101 KB PDF)</p></caption></supplementary-material><supplementary-material id="pcbi-0020075-st002" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020075.st002" xlink:type="simple"><label>Table S2</label><caption><title>Running Mauve with Nondefault Parameters on 10 Prokaryotic Pairs</title><p>(98 KB PDF)</p></caption></supplementary-material><supplementary-material id="pcbi-0020075-st003" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020075.st003" xlink:type="simple"><label>Table S3</label><caption><title>Comparing Coverage between MAGIC's and Mauve's Results</title><p>(109 KB PDF)</p></caption></supplementary-material><supplementary-material id="pcbi-0020075-st004" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020075.st004" xlink:type="simple"><label>Table S4</label><caption><title>Running MAGIC while Taking Mauve's Backbone Results as Anchors</title><p>(117 KB PDF)</p></caption></supplementary-material><supplementary-material id="pcbi-0020075-st005" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020075.st005" xlink:type="simple"><label>Table S5</label><caption><title>The One-to-One RF Table Resulting from Running MAGIC Mapping Phase and Filtering Entries of Length Smaller than 1,000,000 on the Human–Mouse X Chromosome Based on BLASTZ Chained Output as Available on the UCSC Genome Browser</title><p>(37 KB PDF)</p></caption></supplementary-material><supplementary-material id="pcbi-0020075-sd001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020075.sd001" xlink:type="simple"><label>Text S1</label><caption><title>A Description of Nontrivial Duplications in the Comparison of <named-content content-type="genus-species" xlink:type="simple">S. flexneri</named-content> 2457t and <named-content content-type="genus-species" xlink:type="simple">S. typhi</named-content> ty2</title><p>(40 KB PDF)</p></caption></supplementary-material></sec></body><back><ack><sec id="ack1"><title/><p>We thank Anat Caspi for helpful discussions, Aaron Darling for valuable help with Mauve and for a critical reading of the manuscript, Ghislain Fournous for providing the data on prophages from [<xref ref-type="bibr" rid="pcbi-0020075-b059">59</xref>], Shadi Ibrahim for developing the Web site and the Java GUI, Faddy Saad for implementing the preprocessing phase in C++, Ishay Weissman for helpful discussions on statistical tests, and Rani Zand for implementing the mapping phase in C++.</p></sec></ack><glossary><title>Abbreviations</title><def-list><def-item><term>GUI</term><def><p>graphical user interface</p></def></def-item><def-item><term>HGT</term><def><p>horizontal gene transfer</p></def></def-item><def-item><term>KIS</term><def><p>KO-induced segment</p></def></def-item><def-item><term>KO</term><def><p>KEGG orthologs</p></def></def-item><def-item><term>LCB</term><def><p>locally colinear block</p></def></def-item><def-item><term>RF</term><def><p>reorder-free</p></def></def-item></def-list></glossary><ref-list><title>References</title><ref id="pcbi-0020075-b001"><label>1</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Fitch</surname><given-names>WM</given-names></name></person-group>
					<year>1970</year>
					<article-title>Distinguishing homologous from analogous proteins.</article-title>
					<source>Syst Zool</source>
					<volume>19</volume>
					<fpage>9</fpage>
					<lpage>113</lpage>
				</element-citation></ref><ref id="pcbi-0020075-b002"><label>2</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Fitch</surname><given-names>WM</given-names></name></person-group>
					<year>2000</year>
					<article-title>Homology: A personal view on some of the problems.</article-title>
					<source>Trends Genet</source>
					<volume>16</volume>
					<fpage>227</fpage>
					<lpage>231</lpage>
				</element-citation></ref><ref id="pcbi-0020075-b003"><label>3</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Koonin</surname><given-names>EV</given-names></name></person-group>
					<year>2005</year>
					<article-title>Orthologs, paralogs, and evolutionary genomics.</article-title>
					<source>Annu Rev Genet</source>
					<volume>39</volume>
					<fpage>309</fpage>
					<lpage>338</lpage>
					<comment>DOI: <ext-link ext-link-type="doi" xlink:href="http://dx.doi.org/10.1146/annurev.genet.39.073003.114725" xlink:type="simple">10.1146/annurev.genet.39.073003.114725</ext-link>.</comment>
				</element-citation></ref><ref id="pcbi-0020075-b004"><label>4</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Wolf</surname><given-names>YI</given-names></name><name name-style="western"><surname>Rogozin</surname><given-names>IB</given-names></name><name name-style="western"><surname>Kondrashov</surname><given-names>AS</given-names></name><name name-style="western"><surname>Koonin</surname><given-names>EV</given-names></name></person-group>
					<year>2001</year>
					<article-title>Genome alignment, evolution of prokaryotic genome organization, and prediction of gene function using genomic context.</article-title>
					<source>Genome Res</source>
					<volume>11</volume>
					<fpage>356</fpage>
					<lpage>372</lpage>
				</element-citation></ref><ref id="pcbi-0020075-b005"><label>5</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Fujibuchi</surname><given-names>W</given-names></name><name name-style="western"><surname>Ogata</surname><given-names>H</given-names></name><name name-style="western"><surname>Matsuda</surname><given-names>H</given-names></name><name name-style="western"><surname>Kanehisa</surname><given-names>M</given-names></name></person-group>
					<year>2000</year>
					<article-title>Automatic detection of conserved gene clusters in multiple genomes by graph comparison and P-quasi grouping.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>28</volume>
					<fpage>4029</fpage>
					<lpage>4036</lpage>
				</element-citation></ref><ref id="pcbi-0020075-b006"><label>6</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Vandepoele</surname><given-names>K</given-names></name><name name-style="western"><surname>Saeys</surname><given-names>Y</given-names></name><name name-style="western"><surname>Simillion</surname><given-names>C</given-names></name><name name-style="western"><surname>Raes</surname><given-names>J</given-names></name><name name-style="western"><surname>Van de Peer</surname><given-names>Y</given-names></name></person-group>
					<year>2002</year>
					<article-title>The automatic detection of homologous regions (ADHoRe) and its application to microcolinearity between <italic>Arabidopsis</italic> and rice.</article-title>
					<source>Genome Res</source>
					<volume>12</volume>
					<fpage>1792</fpage>
					<lpage>1801</lpage>
					<comment>Available: <ext-link ext-link-type="uri" xlink:href="http://www.genome.org/cgi/reprint/12/11/1792.pdf" xlink:type="simple">http://www.genome.org/cgi/reprint/12/11/1792.pdf</ext-link>. Accessed 9 June 2006.</comment>
				</element-citation></ref><ref id="pcbi-0020075-b007"><label>7</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Rogozin</surname><given-names>IB</given-names></name><name name-style="western"><surname>Makarova</surname><given-names>KS</given-names></name><name name-style="western"><surname>Murvai</surname><given-names>J</given-names></name><name name-style="western"><surname>Czabarka</surname><given-names>E</given-names></name><name name-style="western"><surname>Wolf</surname><given-names>YI</given-names></name><etal/></person-group>
					<year>2002</year>
					<article-title>Connected gene neighborhoods in prokaryotic genomes.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>30</volume>
					<fpage>2212</fpage>
					<lpage>2223</lpage>
				</element-citation></ref><ref id="pcbi-0020075-b008"><label>8</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Snel</surname><given-names>B</given-names></name><name name-style="western"><surname>Lehmann</surname><given-names>G</given-names></name><name name-style="western"><surname>Bork</surname><given-names>P</given-names></name><name name-style="western"><surname>Huynen</surname><given-names>MA</given-names></name></person-group>
					<year>2000</year>
					<article-title>STRING: A web-server to retrieve and display the repeatedly occurring neighbourhood of a gene.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>28</volume>
					<fpage>3442</fpage>
					<lpage>3444</lpage>
					<comment>Available: <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/reprint/28/18/3442.pdf" xlink:type="simple">http://nar.oxfordjournals.org/cgi/reprint/28/18/3442.pdf</ext-link>. Accessed 9 June 2006.</comment>
				</element-citation></ref><ref id="pcbi-0020075-b009"><label>9</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Overbeek</surname><given-names>R</given-names></name><name name-style="western"><surname>Fonstein</surname><given-names>M</given-names></name><name name-style="western"><surname>D'Souza</surname><given-names>M</given-names></name><name name-style="western"><surname>Pusch</surname><given-names>GD</given-names></name><name name-style="western"><surname>Maltsev</surname><given-names>N</given-names></name></person-group>
					<year>1999</year>
					<article-title>Use of contiguity on the chromosome to predict functional coupling.</article-title>
					<source>In Silico Biol</source>
					<volume>1</volume>
					<fpage>93</fpage>
					<lpage>108</lpage>
				</element-citation></ref><ref id="pcbi-0020075-b010"><label>10</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Overbeek</surname><given-names>R</given-names></name><name name-style="western"><surname>Fonstein</surname><given-names>M</given-names></name><name name-style="western"><surname>D'Souza</surname><given-names>M</given-names></name><name name-style="western"><surname>Pusch</surname><given-names>GD</given-names></name><name name-style="western"><surname>Maltsev</surname><given-names>N</given-names></name></person-group>
					<year>1999</year>
					<article-title>The use of gene clusters to infer functional coupling.</article-title>
					<source>PNAS</source>
					<volume>96</volume>
					<fpage>2896</fpage>
					<lpage>2901</lpage>
					<comment>Available: <ext-link ext-link-type="uri" xlink:href="http://www.pnas.org/cgi/reprint/96/6/2896.pdf" xlink:type="simple">http://www.pnas.org/cgi/reprint/96/6/2896.pdf</ext-link>. Accessed 9 June 2006.</comment>
				</element-citation></ref><ref id="pcbi-0020075-b011"><label>11</label><mixed-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Kamvysselis</surname><given-names>M</given-names></name><name name-style="western"><surname>Patterson</surname><given-names>N</given-names></name><name name-style="western"><surname>Birren</surname><given-names>B</given-names></name><name name-style="western"><surname>Berger</surname><given-names>B</given-names></name><name name-style="western"><surname>Lander</surname><given-names>ES</given-names></name></person-group>
					<year>2003</year>
					<article-title>Whole-genome comparative annotation and regulatory motif discovery in multiple yeast species.</article-title>
					<source>Proceedings of the 7th Annual International Conference on Research in Computational Molecular Biology (RECOMB)</source>
					<conf-loc>Berlin, Germany.</conf-loc>&gt;
					<publisher-loc>New York</publisher-loc>
					<publisher-name>ACM Press</publisher-name>
					<comment>pp.</comment>
					<fpage>157</fpage>
					<lpage>166</lpage>
				</mixed-citation></ref><ref id="pcbi-0020075-b012"><label>12</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Schwartz</surname><given-names>S</given-names></name><name name-style="western"><surname>Kent</surname><given-names>WJ</given-names></name><name name-style="western"><surname>Smit</surname><given-names>A</given-names></name><name name-style="western"><surname>Zhang</surname><given-names>Z</given-names></name><name name-style="western"><surname>Baertsch</surname><given-names>R</given-names></name><etal/></person-group>
					<year>2003</year>
					<article-title>Human–mouse alignments with BLASTZ.</article-title>
					<source>Genome Res</source>
					<volume>13</volume>
					<fpage>103</fpage>
					<lpage>107</lpage>
					<comment>Available: <ext-link ext-link-type="uri" xlink:href="http://www.genome.org/cgi/reprint/13/1/103.pdf" xlink:type="simple">http://www.genome.org/cgi/reprint/13/1/103.pdf</ext-link>. Accessed 9 June 2006.</comment>
				</element-citation></ref><ref id="pcbi-0020075-b013"><label>13</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Brudno</surname><given-names>M</given-names></name><name name-style="western"><surname>Malde</surname><given-names>S</given-names></name><name name-style="western"><surname>Poliakov</surname><given-names>A</given-names></name><name name-style="western"><surname>Do</surname><given-names>CB</given-names></name><name name-style="western"><surname>Couronne</surname><given-names>O</given-names></name><etal/></person-group>
					<year>2003</year>
					<article-title>Glocal alignment: Finding rearrangements during alignment.</article-title>
					<source>Bioinformatics</source>
					<volume>19</volume>
					<fpage>i54</fpage>
					<lpage>i62</lpage>
					<comment>Available: <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/reprint/19/suppl_1/i54.pdf" xlink:type="simple">http://bioinformatics.oxfordjournals.org/cgi/content/reprint/19/suppl_1/i54.pdf</ext-link>. Accessed 9 June 2006.</comment>
				</element-citation></ref><ref id="pcbi-0020075-b014"><label>14</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Darling</surname><given-names>AC</given-names></name><name name-style="western"><surname>Mau</surname><given-names>B</given-names></name><name name-style="western"><surname>Blattner</surname><given-names>FR</given-names></name><name name-style="western"><surname>Perna</surname><given-names>NT</given-names></name></person-group>
					<year>2004</year>
					<article-title>Mauve: Multiple alignment of conserved genomic sequence with rearrangements.</article-title>
					<source>Genome Res</source>
					<volume>14</volume>
					<fpage>1394</fpage>
					<lpage>1403</lpage>
					<comment>Available: <ext-link ext-link-type="uri" xlink:href="http://www.genome.org/cgi/reprint/14/7/1394.pdf" xlink:type="simple">http://www.genome.org/cgi/reprint/14/7/1394.pdf</ext-link>. Accessed 9 June 2006.</comment>
				</element-citation></ref><ref id="pcbi-0020075-b015"><label>15</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Kent</surname><given-names>WJ</given-names></name><name name-style="western"><surname>Baertsch</surname><given-names>R</given-names></name><name name-style="western"><surname>Hinrichs</surname><given-names>A</given-names></name><name name-style="western"><surname>Miller</surname><given-names>W</given-names></name><name name-style="western"><surname>Haussler</surname><given-names>D</given-names></name></person-group>
					<year>2003</year>
					<article-title>Evolution's cauldron: Duplication, deletion, and rearrangement in the mouse and human genomes.</article-title>
					<source>Proc Natl Acad Sci U S A</source>
					<volume>100</volume>
					<fpage>11484</fpage>
					<lpage>11489</lpage>
					<comment>Available: <ext-link ext-link-type="uri" xlink:href="http://www.pnas.org/cgi/reprint/100/20/11484.pdf" xlink:type="simple">http://www.pnas.org/cgi/reprint/100/20/11484.pdf</ext-link>. Accessed 9 June 2006.</comment>
				</element-citation></ref><ref id="pcbi-0020075-b016"><label>16</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Calabrese</surname><given-names>PP</given-names></name><name name-style="western"><surname>Chakravarty</surname><given-names>S</given-names></name><name name-style="western"><surname>Vision</surname><given-names>TJ</given-names></name></person-group>
					<year>2003</year>
					<article-title>Fast identification and statistical evaluation of segmental homologies in comparative maps.</article-title>
					<source>Bioinformatics</source>
					<volume>19</volume>
					<fpage>i74</fpage>
					<lpage>i80</lpage>
					<comment>Available: <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/reprint/19/suppl_1/i74.pdf" xlink:type="simple">http://bioinformatics.oxfordjournals.org/cgi/reprint/19/suppl_1/i74.pdf</ext-link>. Accessed 9 June 2006.</comment>
				</element-citation></ref><ref id="pcbi-0020075-b017"><label>17</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Pevzner</surname><given-names>PA</given-names></name><name name-style="western"><surname>Tesler</surname><given-names>G</given-names></name></person-group>
					<year>2003</year>
					<article-title>Genome rearrangements in mammalian evolution: Lessons from human and mouse genomes.</article-title>
					<source>Genome Res</source>
					<volume>13</volume>
					<fpage>37</fpage>
					<lpage>45</lpage>
				</element-citation></ref><ref id="pcbi-0020075-b018"><label>18</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Darling</surname><given-names>AE</given-names></name><name name-style="western"><surname>Mau</surname><given-names>B</given-names></name><name name-style="western"><surname>Blattner</surname><given-names>FR</given-names></name><name name-style="western"><surname>Perna</surname><given-names>NT</given-names></name></person-group>
					<year>2004</year>
					<article-title>GRIL: Genome rearrangement and inversion locator.</article-title>
					<source>Bioinformatics</source>
					<volume>20</volume>
					<fpage>122</fpage>
					<lpage>124</lpage>
					<comment>Available: <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/reprint/20/1/122.pdf" xlink:type="simple">http://bioinformatics.oxfordjournals.org/cgi/reprint/20/1/122.pdf</ext-link>. Accessed 9 June 2006.</comment>
				</element-citation></ref><ref id="pcbi-0020075-b019"><label>19</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Field</surname><given-names>D</given-names></name><name name-style="western"><surname>Feil</surname><given-names>EJ</given-names></name><name name-style="western"><surname>Wilson</surname><given-names>GA</given-names></name></person-group>
					<year>2005</year>
					<article-title>Databases and software for the comparison of prokaryotic genomes.</article-title>
					<source>Microbiology</source>
					<volume>151</volume>
					<fpage>2125</fpage>
					<lpage>2132</lpage>
				</element-citation></ref><ref id="pcbi-0020075-b020"><label>20</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Schmid</surname><given-names>MB</given-names></name><name name-style="western"><surname>Roth</surname><given-names>JR</given-names></name></person-group>
					<year>1983</year>
					<article-title>Selection and endpoint distribution of bacterial inversion mutations.</article-title>
					<source>Genetics</source>
					<volume>105</volume>
					<fpage>539</fpage>
					<lpage>557</lpage>
				</element-citation></ref><ref id="pcbi-0020075-b021"><label>21</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Segall</surname><given-names>A</given-names></name><name name-style="western"><surname>Mahan</surname><given-names>MJ</given-names></name><name name-style="western"><surname>Roth</surname><given-names>JR</given-names></name></person-group>
					<year>1988</year>
					<article-title>Rearrangement of the bacterial chromosome: Forbidden inversions.</article-title>
					<source>Science</source>
					<volume>241</volume>
					<fpage>1314</fpage>
					<lpage>1318</lpage>
				</element-citation></ref><ref id="pcbi-0020075-b022"><label>22</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>François</surname><given-names>V</given-names></name><name name-style="western"><surname>Louarn</surname><given-names>J</given-names></name><name name-style="western"><surname>Patte</surname><given-names>J</given-names></name><name name-style="western"><surname>Rebollo</surname><given-names>JE</given-names></name><name name-style="western"><surname>Louarn</surname><given-names>JM</given-names></name></person-group>
					<year>1990</year>
					<article-title>Constraints in chromosomal inversions in <named-content content-type="genus-species" xlink:type="simple">Escherichia coli</named-content> are not explained by replication pausing at inverted terminator-like sequences.</article-title>
					<source>Mol Microbiol</source>
					<volume>4</volume>
					<fpage>537</fpage>
					<lpage>542</lpage>
				</element-citation></ref><ref id="pcbi-0020075-b023"><label>23</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Guijo</surname><given-names>MI</given-names></name><name name-style="western"><surname>Patte</surname><given-names>J</given-names></name><name name-style="western"><surname>del Mar Campos</surname><given-names>M</given-names></name><name name-style="western"><surname>Louarn</surname><given-names>JM</given-names></name><name name-style="western"><surname>Rebollo</surname><given-names>JE</given-names></name></person-group>
					<year>2001</year>
					<article-title>Localized remodeling of the <named-content content-type="genus-species" xlink:type="simple">Escherichia coli</named-content> chromosome: The patchwork of segments refractory and tolerant to inversion near the replication terminus.</article-title>
					<source>Genetics</source>
					<volume>157</volume>
					<fpage>1413</fpage>
					<lpage>1423</lpage>
				</element-citation></ref><ref id="pcbi-0020075-b024"><label>24</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Miesel</surname><given-names>L</given-names></name><name name-style="western"><surname>Segall</surname><given-names>A</given-names></name><name name-style="western"><surname>Roth</surname><given-names>JR</given-names></name></person-group>
					<year>1994</year>
					<article-title>Construction of chromosomal rearrangements in <italic>Salmonella</italic> by transduction: Inversions of nonpermissive segments are not lethal.</article-title>
					<source>Genetics</source>
					<volume>137</volume>
					<fpage>919</fpage>
					<lpage>932</lpage>
				</element-citation></ref><ref id="pcbi-0020075-b025"><label>25</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Rocha</surname><given-names>EPC</given-names></name></person-group>
					<year>2004</year>
					<article-title>Order and disorder in bacterial genomes.</article-title>
					<source>Curr Opin Microbiol</source>
					<volume>7</volume>
					<fpage>519</fpage>
					<lpage>537</lpage>
				</element-citation></ref><ref id="pcbi-0020075-b026"><label>26</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Kowalczykowski</surname><given-names>SC</given-names></name><name name-style="western"><surname>Dixon</surname><given-names>DA</given-names></name><name name-style="western"><surname>Eggleston</surname><given-names>AK</given-names></name><name name-style="western"><surname>Lauder</surname><given-names>SD</given-names></name><name name-style="western"><surname>Rehrauer</surname><given-names>WM</given-names></name></person-group>
					<year>1994</year>
					<article-title>Biochemistry of homologous recombination in <named-content content-type="genus-species" xlink:type="simple">Escherichia coli</named-content>.</article-title>
					<source>Microbiol Rev</source>
					<volume>58</volume>
					<fpage>401</fpage>
					<lpage>65</lpage>
				</element-citation></ref><ref id="pcbi-0020075-b027"><label>27</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Rocha</surname><given-names>EPC</given-names></name></person-group>
					<year>2003</year>
					<article-title>DNA repeats lead to the accelerated loss of gene order in bacteria.</article-title>
					<source>Trends Genet</source>
					<volume>19</volume>
					<fpage>600</fpage>
					<lpage>603</lpage>
				</element-citation></ref><ref id="pcbi-0020075-b028"><label>28</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Sankoff</surname><given-names>D</given-names></name><name name-style="western"><surname>Nadeau</surname><given-names>JH</given-names></name></person-group>
					<year>2003</year>
					<article-title>Chromosome rearrangements in evolution: From gene order to genome sequence and back.</article-title>
					<source>Proc Natl Acad Sci U S A</source>
					<volume>100</volume>
					<fpage>11188</fpage>
					<lpage>11189</lpage>
				</element-citation></ref><ref id="pcbi-0020075-b029"><label>29</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Nadeau</surname><given-names>JH</given-names></name><name name-style="western"><surname>Taylor</surname><given-names>BA</given-names></name></person-group>
					<year>1984</year>
					<article-title>Lengths of chromosomal segments conserved since divergence of man and mouse.</article-title>
					<source>Proc Natl Acad Sci U S A</source>
					<volume>81</volume>
					<fpage>814</fpage>
					<lpage>818</lpage>
				</element-citation></ref><ref id="pcbi-0020075-b030"><label>30</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Trinh</surname><given-names>P</given-names></name><name name-style="western"><surname>McLysaght</surname><given-names>A</given-names></name><name name-style="western"><surname>Sankoff</surname><given-names>D</given-names></name></person-group>
					<year>2004</year>
					<article-title>Genomic features in the breakpoint regions between syntenic blocks.</article-title>
					<source>Bioinformatics</source>
					<volume>20</volume>
					<issue>(Suppl 1)</issue>
					<fpage>I318</fpage>
					<lpage>I325</lpage>
				</element-citation></ref><ref id="pcbi-0020075-b031"><label>31</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Lefebvre</surname><given-names>J</given-names></name><name name-style="western"><surname>El-Mabrouk</surname><given-names>N</given-names></name><name name-style="western"><surname>Tillier</surname><given-names>E</given-names></name><name name-style="western"><surname>Sankoff</surname><given-names>D</given-names></name></person-group>
					<year>2003</year>
					<article-title>Detection and validation of single gene inversions.</article-title>
					<source>Bioinformatics</source>
					<volume>19</volume>
					<issue>(Suppl 1)</issue>
					<fpage>i190</fpage>
					<lpage>i196</lpage>
					<comment>Available: <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oupjournals.org/cgi/reprint/19/suppl_1/i190.pdf" xlink:type="simple">http://bioinformatics.oupjournals.org/cgi/reprint/19/suppl_1/i190.pdf</ext-link>. Accessed 12 June 2006.</comment>
				</element-citation></ref><ref id="pcbi-0020075-b032"><label>32</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Bourque</surname><given-names>G</given-names></name><name name-style="western"><surname>Pevzner</surname><given-names>PA</given-names></name><name name-style="western"><surname>Tesler</surname><given-names>G</given-names></name></person-group>
					<year>2004</year>
					<article-title>Reconstructing the genomic architecture of ancestral mammals: Lessons from human, mouse, and rat genomes.</article-title>
					<source>Genome Res</source>
					<volume>14</volume>
					<fpage>507</fpage>
					<lpage>516</lpage>
				</element-citation></ref><ref id="pcbi-0020075-b033"><label>33</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Pevzner</surname><given-names>P</given-names></name><name name-style="western"><surname>Tesler</surname><given-names>G</given-names></name></person-group>
					<year>2003</year>
					<article-title>Transforming men into mice: The Nadeau-Taylor chromosomal breakage model revisited.</article-title>
					<source>Proceedings of the 7th Annual International Conference on Research in Computational Molecular Biology (RECOMB)</source>
					<conf-date>10–13 April 2003;</conf-date>
					<conf-loc>Berlin, Germany.</conf-loc>
					<publisher-loc>New York</publisher-loc>
					<publisher-name>ACM Press</publisher-name>
					<comment>pp.</comment>
					<fpage>247</fpage>
					<lpage>256</lpage>
					<comment>Available: <ext-link ext-link-type="uri" xlink:href="http://doi.acm.org/10.1145/640075.640108" xlink:type="simple">http://doi.acm.org/10.1145/640075.640108</ext-link>. Accessed 12 June 2006.</comment>
				</element-citation></ref><ref id="pcbi-0020075-b034"><label>34</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Pevzner</surname><given-names>P</given-names></name><name name-style="western"><surname>Tesler</surname><given-names>G</given-names></name></person-group>
					<year>2003</year>
					<article-title>Human and mouse genomic sequences reveal extensive breakpoint reuse in mammalian evolution.</article-title>
					<source>Proc Natl Acad Sci U S A</source>
					<volume>100</volume>
					<fpage>7672</fpage>
					<lpage>7677</lpage>
					<comment>Available: <ext-link ext-link-type="uri" xlink:href="http://www.pnas.org/cgi/reprint/100/13/7672.pdf" xlink:type="simple">http://www.pnas.org/cgi/reprint/100/13/7672.pdf</ext-link>. Accessed 12 June 2006.</comment>
				</element-citation></ref><ref id="pcbi-0020075-b035"><label>35</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Peng</surname><given-names>Q</given-names></name><name name-style="western"><surname>Pevzner</surname><given-names>PA</given-names></name><name name-style="western"><surname>Tesler</surname><given-names>G</given-names></name></person-group>
					<year>2006</year>
					<article-title>The fragile breakage versus random breakage models of chromosome evolution.</article-title>
					<source>PLoS Comput Biol</source>
					<volume>2</volume>
					<elocation-id>e14.</elocation-id>
					<comment>Available: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.0020014" xlink:type="simple">http://dx.doi.org/10.1371/journal.pcbi.0020014</ext-link>. Accessed 12 June 2006.</comment>
				</element-citation></ref><ref id="pcbi-0020075-b036"><label>36</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Burgetz</surname><given-names>IJ</given-names></name><name name-style="western"><surname>Shariff</surname><given-names>S</given-names></name><name name-style="western"><surname>Pang</surname><given-names>A</given-names></name><name name-style="western"><surname>Tillier</surname><given-names>ERM</given-names></name></person-group>
					<year>2006</year>
					<article-title>Positional homology in bacterial genomes.</article-title>
					<source>Evol Bioinform Online</source>
					<volume>2</volume>
					<fpage>42</fpage>
					<lpage>55</lpage>
				</element-citation></ref><ref id="pcbi-0020075-b037"><label>37</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Bourque</surname><given-names>G</given-names></name><name name-style="western"><surname>Yacef</surname><given-names>Y</given-names></name><name name-style="western"><surname>El-Mabrouk</surname><given-names>N</given-names></name></person-group>
					<year>2005</year>
					<article-title>Maximizing synteny blocks to identify ancestral homolgos.</article-title>
					<source>Proceedings of the 3rd RECOMB Satellite Workshop on Comparative Genomics (RCG)</source>
					<conf-date>September 2005;</conf-date>
					<conf-loc>Dublin, Ireland.</conf-loc>
					<person-group person-group-type="editor"><name name-style="western"><surname>McLysaght</surname><given-names>A</given-names></name><name name-style="western"><surname>Daniel</surname><given-names>H</given-names></name></person-group>
					<publisher-loc>Berlin</publisher-loc>
					<publisher-name>Springer</publisher-name>
					<comment>pp.</comment>
					<fpage>21</fpage>
					<lpage>34</lpage>
				</element-citation></ref><ref id="pcbi-0020075-b038"><label>38</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Kanehisa</surname><given-names>M</given-names></name><name name-style="western"><surname>Goto</surname><given-names>S</given-names></name><name name-style="western"><surname>Kawashima</surname><given-names>S</given-names></name><name name-style="western"><surname>Okuno</surname><given-names>Y</given-names></name><name name-style="western"><surname>Hattori</surname><given-names>M</given-names></name></person-group>
					<year>2004</year>
					<article-title>The KEGG resource for deciphering the genome.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>32</volume>
					<fpage>D277</fpage>
					<lpage>D280</lpage>
				</element-citation></ref><ref id="pcbi-0020075-b039"><label>39</label><element-citation publication-type="other" xlink:type="simple">
					<collab xlink:type="simple">R Development Core Team</collab>
					<year>2003</year>
					<source>R: A language and environment for statistical computing</source>
					<publisher-loc>Vienna</publisher-loc>
					<publisher-name>R Foundation for Statistical Computing</publisher-name>
					<comment>Available: <ext-link ext-link-type="uri" xlink:href="http://www.R-project.org" xlink:type="simple">http://www.R-project.org</ext-link>. Accessed 19 June 2006.</comment>
				</element-citation></ref><ref id="pcbi-0020075-b040"><label>40</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Needleman</surname><given-names>SB</given-names></name><name name-style="western"><surname>Wunsch</surname><given-names>CD</given-names></name></person-group>
					<year>1970</year>
					<article-title>A general method applicable to the search for similarities in the amino acid sequence of two proteins.</article-title>
					<source>J Mol Biol</source>
					<volume>48</volume>
					<fpage>443</fpage>
					<lpage>453</lpage>
				</element-citation></ref><ref id="pcbi-0020075-b041"><label>41</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Bray</surname><given-names>N</given-names></name><name name-style="western"><surname>Dubchak</surname><given-names>I</given-names></name><name name-style="western"><surname>Pachter</surname><given-names>L</given-names></name></person-group>
					<year>2003</year>
					<article-title>AVID: A global alignment program.</article-title>
					<source>Genome Res</source>
					<volume>13</volume>
					<fpage>97</fpage>
					<lpage>102</lpage>
				</element-citation></ref><ref id="pcbi-0020075-b042"><label>42</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Thompson</surname><given-names>JD</given-names></name><name name-style="western"><surname>Higgins</surname><given-names>DG</given-names></name><name name-style="western"><surname>Gibson</surname><given-names>TJ</given-names></name></person-group>
					<year>1994</year>
					<article-title>CLUSTALW: Improving the sensitivity of progressive multiple sequence alignment through sequence weighting, position-specific gap penalties and weight matrix choice.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>22</volume>
					<fpage>4673</fpage>
					<lpage>4680</lpage>
				</element-citation></ref><ref id="pcbi-0020075-b043"><label>43</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Brudno</surname><given-names>M</given-names></name><name name-style="western"><surname>Chapman</surname><given-names>M</given-names></name><name name-style="western"><surname>Gottgens</surname><given-names>B</given-names></name><name name-style="western"><surname>Batzoglou</surname><given-names>S</given-names></name><name name-style="western"><surname>Morgenstern</surname><given-names>B</given-names></name></person-group>
					<year>2003</year>
					<article-title>Fast and sensitive multiple alignment of large genomic sequences.</article-title>
					<source>BMC Bioinformatics</source>
					<volume>23</volume>
					<fpage>4</fpage>
					<lpage>66</lpage>
				</element-citation></ref><ref id="pcbi-0020075-b044"><label>44</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Batzoglou</surname><given-names>S</given-names></name><name name-style="western"><surname>Pachter</surname><given-names>L</given-names></name><name name-style="western"><surname>Mesirov</surname><given-names>JP</given-names></name><name name-style="western"><surname>Berger</surname><given-names>B</given-names></name><name name-style="western"><surname>Lander</surname><given-names>ES</given-names></name></person-group>
					<year>2000</year>
					<article-title>Human and mouse gene structure: Comparative analysis and application to exon prediction.</article-title>
					<source>Genome Res</source>
					<volume>10</volume>
					<fpage>950</fpage>
					<lpage>958</lpage>
					<comment>Available: <ext-link ext-link-type="uri" xlink:href="http://www.genome.org/cgi/reprint/10/7/950.pdf" xlink:type="simple">http://www.genome.org/cgi/reprint/10/7/950.pdf</ext-link>. Accessed 12 June 2006.</comment>
				</element-citation></ref><ref id="pcbi-0020075-b045"><label>45</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Brudno</surname><given-names>M</given-names></name><name name-style="western"><surname>Do</surname><given-names>CB</given-names></name><name name-style="western"><surname>Cooper</surname><given-names>GM</given-names></name><name name-style="western"><surname>Kim</surname><given-names>MF</given-names></name><name name-style="western"><surname>Davydov</surname><given-names>E</given-names></name><etal/></person-group>
					<year>2003</year>
					<article-title>LAGAN and Multi-LAGAN: Efficient tools for large-scale multiple alignment of genomic DNA.</article-title>
					<source>Genome Res</source>
					<volume>13</volume>
					<fpage>721</fpage>
					<lpage>731</lpage>
					<comment>Available: <ext-link ext-link-type="uri" xlink:href="http://www.genome.org/cgi/reprint/13/4/721.pdf" xlink:type="simple">http://www.genome.org/cgi/reprint/13/4/721.pdf</ext-link>. Accessed 12 June 2006.</comment>
				</element-citation></ref><ref id="pcbi-0020075-b046"><label>46</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Hohl</surname><given-names>M</given-names></name><name name-style="western"><surname>Kurtz</surname><given-names>S</given-names></name><name name-style="western"><surname>Ohlebusch</surname><given-names>E</given-names></name></person-group>
					<year>2002</year>
					<article-title>Efficient multiple genome alignment.</article-title>
					<source>Bioinformatics</source>
					<volume>18</volume>
					<fpage>312S</fpage>
					<lpage>320S</lpage>
					<comment>Available: <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/reprint/18/suppl_1/S312.pdf" xlink:type="simple">http://bioinformatics.oxfordjournals.org/cgi/reprint/18/suppl_1/S312.pdf</ext-link>. Accessed 12 June 2006.</comment>
				</element-citation></ref><ref id="pcbi-0020075-b047"><label>47</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Delcher</surname><given-names>A</given-names></name><name name-style="western"><surname>Kasif</surname><given-names>S</given-names></name><name name-style="western"><surname>Fleischmann</surname><given-names>R</given-names></name><name name-style="western"><surname>Peterson</surname><given-names>J</given-names></name><name name-style="western"><surname>White</surname><given-names>O</given-names></name><etal/></person-group>
					<year>1999</year>
					<article-title>Alignment of whole genomes.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>27</volume>
					<fpage>2369</fpage>
					<lpage>2376</lpage>
					<comment>Available: <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/reprint/27/11/2369.pdf" xlink:type="simple">http://nar.oxfordjournals.org/cgi/reprint/27/11/2369.pdf</ext-link>. Accessed 12 June 2006.</comment>
				</element-citation></ref><ref id="pcbi-0020075-b048"><label>48</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Kent</surname><given-names>WJ</given-names></name><name name-style="western"><surname>Zahler</surname><given-names>AM</given-names></name></person-group>
					<year>2000</year>
					<article-title>Conservation, regulation, synteny, and introns in a large-scale c. briggsae-c. elegans genomic alignment.</article-title>
					<source>Genome Res</source>
					<volume>10</volume>
					<fpage>1115</fpage>
					<lpage>1125</lpage>
					<comment>Available: <ext-link ext-link-type="uri" xlink:href="http://www.genome.org/cgi/reprint/10/8/1115.pdf" xlink:type="simple">http://www.genome.org/cgi/reprint/10/8/1115.pdf</ext-link>. Accessed 12 June 2006.</comment>
				</element-citation></ref><ref id="pcbi-0020075-b049"><label>49</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Raphael</surname><given-names>B</given-names></name><name name-style="western"><surname>Zhi</surname><given-names>D</given-names></name><name name-style="western"><surname>Tang</surname><given-names>H</given-names></name><name name-style="western"><surname>Pevzner</surname><given-names>P</given-names></name></person-group>
					<year>2004</year>
					<article-title>A novel method for multiple alignment of sequences with repeated and shuffled elements.</article-title>
					<source>Genome Res</source>
					<volume>14</volume>
					<fpage>2336</fpage>
					<lpage>2346</lpage>
					<comment>Available: <ext-link ext-link-type="uri" xlink:href="http://www.genome.org/cgi/reprint/14/11/2336.pdf" xlink:type="simple">http://www.genome.org/cgi/reprint/14/11/2336.pdf</ext-link>. Accessed 12 June 2006.</comment>
				</element-citation></ref><ref id="pcbi-0020075-b050"><label>50</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Notredame</surname><given-names>C</given-names></name></person-group>
					<year>2002</year>
					<article-title>Recent progress in multiple sequence alignment: A survey.</article-title>
					<source>Pharmacogenomics</source>
					<volume>3</volume>
					<fpage>131</fpage>
					<lpage>144</lpage>
				</element-citation></ref><ref id="pcbi-0020075-b051"><label>51</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Altschul</surname><given-names>SF</given-names></name><name name-style="western"><surname>Gish</surname><given-names>W</given-names></name><name name-style="western"><surname>Miller</surname><given-names>W</given-names></name><name name-style="western"><surname>Myers</surname><given-names>EW</given-names></name><name name-style="western"><surname>Lipman</surname><given-names>DJ</given-names></name></person-group>
					<year>1990</year>
					<article-title>Basic local alignment search tool.</article-title>
					<source>J Mol Biol</source>
					<volume>215</volume>
					<fpage>403</fpage>
					<lpage>410</lpage>
				</element-citation></ref><ref id="pcbi-0020075-b052"><label>52</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Kent</surname><given-names>WJ</given-names></name></person-group>
					<year>2002</year>
					<article-title>BLAT—The BLAST-like alignment tool.</article-title>
					<source>Genome Res</source>
					<volume>12</volume>
					<fpage>656</fpage>
					<lpage>664</lpage>
					<comment>Available: <ext-link ext-link-type="uri" xlink:href="http://www.genome.org/cgi/reprint/12/4/656.pdf" xlink:type="simple">http://www.genome.org/cgi/reprint/12/4/656.pdf</ext-link>. Accessed 12 June 2006.</comment>
				</element-citation></ref><ref id="pcbi-0020075-b053"><label>53</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Kalafus</surname><given-names>KJ</given-names></name><name name-style="western"><surname>Jackson</surname><given-names>AR</given-names></name><name name-style="western"><surname>Milosavljevic</surname><given-names>A</given-names></name></person-group>
					<year>2004</year>
					<article-title>Pash: Efficient genome-scale sequence anchoring by positional hashing.</article-title>
					<source>Genome Res</source>
					<volume>14</volume>
					<fpage>672</fpage>
					<lpage>678</lpage>
					<comment>Available: <ext-link ext-link-type="uri" xlink:href="http://www.genome.org/cgi/reprint/14/4/672.pdf" xlink:type="simple">http://www.genome.org/cgi/reprint/14/4/672.pdf</ext-link>. Accessed 12 June 2006.</comment>
				</element-citation></ref><ref id="pcbi-0020075-b054"><label>54</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Altschul</surname><given-names>SF</given-names></name><name name-style="western"><surname>Madden</surname><given-names>TL</given-names></name><name name-style="western"><surname>Schaffer</surname><given-names>AA</given-names></name><name name-style="western"><surname>Zhang</surname><given-names>J</given-names></name><name name-style="western"><surname>Zhang</surname><given-names>Z</given-names></name><etal/></person-group>
					<year>1997</year>
					<article-title>Gapped BLAST and PSI-BLAST: A new generation of protein database search programs.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>25</volume>
					<fpage>3389</fpage>
					<lpage>3402</lpage>
					<comment>Available: <ext-link ext-link-type="uri" xlink:href="http://nar.oupjournals.org/cgi/reprint/25/17/3389.pdf" xlink:type="simple">http://nar.oupjournals.org/cgi/reprint/25/17/3389.pdf</ext-link>. Accessed 12 June 2006.</comment>
				</element-citation></ref><ref id="pcbi-0020075-b055"><label>55</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Mahillon</surname><given-names>J</given-names></name><name name-style="western"><surname>Chandler</surname><given-names>M</given-names></name></person-group>
					<year>1998</year>
					<article-title>Insertion sequences.</article-title>
					<source>Microbiol Mol Biol Rev</source>
					<volume>62</volume>
					<fpage>725</fpage>
					<lpage>774</lpage>
					<comment>Available: <ext-link ext-link-type="uri" xlink:href="http://mmbr.asm.org/cgi/reprint/62/3/725.pdf" xlink:type="simple">http://mmbr.asm.org/cgi/reprint/62/3/725.pdf</ext-link>. Accessed 12 June 2006.</comment>
				</element-citation></ref><ref id="pcbi-0020075-b056"><label>56</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Zdobnov</surname><given-names>EM</given-names></name><name name-style="western"><surname>Lopez</surname><given-names>R</given-names></name><name name-style="western"><surname>Apweiler</surname><given-names>R</given-names></name><name name-style="western"><surname>Etzold</surname><given-names>T</given-names></name></person-group>
					<year>2002</year>
					<article-title>The EBI SRS server—Recent developments.</article-title>
					<source>Bioinformatics</source>
					<volume>18</volume>
					<fpage>368</fpage>
					<lpage>373</lpage>
					<comment>Available: <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oupjournals.org/cgi/reprint/18/2/368.pdf" xlink:type="simple">http://bioinformatics.oupjournals.org/cgi/reprint/18/2/368.pdf</ext-link>. Accessed 12 June 2006.</comment>
				</element-citation></ref><ref id="pcbi-0020075-b057"><label>57</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Kanz</surname><given-names>C</given-names></name><name name-style="western"><surname>Aldebert</surname><given-names>P</given-names></name><name name-style="western"><surname>Althorpe</surname><given-names>N</given-names></name><name name-style="western"><surname>Baker</surname><given-names>W</given-names></name><name name-style="western"><surname>Baldwin</surname><given-names>A</given-names></name><etal/></person-group>
					<year>2005</year>
					<article-title>The EMBL nucleotide sequence database.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>33</volume>
					<fpage>D29</fpage>
					<lpage>D33</lpage>
					<comment><ext-link ext-link-type="uri" xlink:href="http://nar.oupjournals.org/cgi/reprint/33/suppl_1/D29.pdf" xlink:type="simple">http://nar.oupjournals.org/cgi/reprint/33/suppl_1/D29.pdf</ext-link>. Accessed 12 June 2006.</comment>
				</element-citation></ref><ref id="pcbi-0020075-b058"><label>58</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Casjens</surname><given-names>S</given-names></name></person-group>
					<year>2003</year>
					<article-title>Prophages and bacterial genomics What have we learned so far?</article-title>
					<source>Mol Microbiol</source>
					<volume>49</volume>
					<fpage>277</fpage>
					<lpage>300</lpage>
					<comment>Available: <ext-link ext-link-type="uri" xlink:href="http://www.blackwell-synergy.com/links/doi/10.1046/j.1365-2958.2003.03580.x/pdf" xlink:type="simple">http://www.blackwell-synergy.com/links/doi/10.1046/j.1365–2958.2003.03580.x/pdf</ext-link>. Accessed 12 June 2006.</comment>
				</element-citation></ref><ref id="pcbi-0020075-b059"><label>59</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Canchaya</surname><given-names>C</given-names></name><name name-style="western"><surname>Fournous</surname><given-names>G</given-names></name><name name-style="western"><surname>Brussow</surname><given-names>H</given-names></name></person-group>
					<year>2004</year>
					<article-title>The impact of prophages on bacterial chromosomes.</article-title>
					<source>Mol Microbiol</source>
					<volume>53</volume>
					<fpage>9</fpage>
					<lpage>18</lpage>
					<comment>Available: <ext-link ext-link-type="uri" xlink:href="http://www.blackwell-synergy.com/links/doi/10.1111/j.1365-2958.2004.04113.x/pdf" xlink:type="simple">http://www.blackwell-synergy.com/links/doi/10.1111/j.1365–2958.2004.04113.x/pdf</ext-link>. Accessed 12 June 2006.</comment>
				</element-citation></ref><ref id="pcbi-0020075-b060"><label>60</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Blattner</surname><given-names>FR</given-names></name><name name-style="western"><surname>Plunkett</surname><given-names>G</given-names><suffix>III</suffix></name><name name-style="western"><surname>Bloch</surname><given-names>CA</given-names></name><name name-style="western"><surname>Perna</surname><given-names>NT</given-names></name><name name-style="western"><surname>Burland</surname><given-names>V</given-names></name><etal/></person-group>
					<year>1997</year>
					<article-title>The complete genome sequence of <named-content content-type="genus-species" xlink:type="simple">Escherichia coli</named-content> k-12.</article-title>
					<source>Science</source>
					<volume>277</volume>
					<fpage>1453</fpage>
					<lpage>1474</lpage>
				</element-citation></ref><ref id="pcbi-0020075-b061"><label>61</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Deng</surname><given-names>W</given-names></name><name name-style="western"><surname>Liou</surname><given-names>SR</given-names></name><name name-style="western"><surname>Plunkett</surname><given-names>IIIG</given-names></name><name name-style="western"><surname>Mayhew</surname><given-names>GF</given-names></name><name name-style="western"><surname>Rose</surname><given-names>DJ</given-names></name><etal/></person-group>
					<year>2003</year>
					<article-title>Comparative genomics of <italic>Salmonella</italic> enterica serovar <italic>typhi</italic> strains ty2 and ct18.</article-title>
					<source>J Bacteriol</source>
					<volume>185</volume>
					<fpage>2330</fpage>
					<lpage>2337</lpage>
					<comment>Available: <ext-link ext-link-type="uri" xlink:href="http://jb.asm.org/cgi/reprint/185/7/2330.pdf" xlink:type="simple">http://jb.asm.org/cgi/reprint/185/7/2330.pdf</ext-link>. Accessed 12 June 2006.</comment>
				</element-citation></ref><ref id="pcbi-0020075-b062"><label>62</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Wei</surname><given-names>J</given-names></name><name name-style="western"><surname>Goldberg</surname><given-names>MB</given-names></name><name name-style="western"><surname>Burland</surname><given-names>V</given-names></name><name name-style="western"><surname>Venkatesan</surname><given-names>MM</given-names></name><name name-style="western"><surname>Deng</surname><given-names>W</given-names></name><etal/></person-group>
					<year>2003</year>
					<article-title>Complete genome sequence and comparative genomics of <named-content content-type="genus-species" xlink:type="simple">Shigella flexneri</named-content> serotype 2a strain 2457t.</article-title>
					<source>Infect Immun</source>
					<volume>71</volume>
					<fpage>2775</fpage>
					<lpage>2786</lpage>
				</element-citation></ref><ref id="pcbi-0020075-b063"><label>63</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Liu</surname><given-names>SL</given-names></name><name name-style="western"><surname>Sanderson</surname><given-names>KE</given-names></name></person-group>
					<year>1996</year>
					<article-title>Highly plastic chromosomal organization in <named-content content-type="genus-species" xlink:type="simple">Salmonella typhi</named-content>.</article-title>
					<source>Proc Natl Acad Sci U S A</source>
					<volume>93</volume>
					<fpage>10303</fpage>
					<lpage>10308</lpage>
					<comment>Available: <ext-link ext-link-type="uri" xlink:href="http://www.pnas.org/cgi/reprint/93/19/10303.pdf" xlink:type="simple">http://www.pnas.org/cgi/reprint/93/19/10303.pdf</ext-link>. Accessed 12 June 2006.</comment>
				</element-citation></ref><ref id="pcbi-0020075-b064"><label>64</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Tatusova</surname><given-names>TA</given-names></name><name name-style="western"><surname>Madden</surname><given-names>TL</given-names></name></person-group>
					<year>1999</year>
					<article-title>BLAST 2 sequences, a new tool for comparing protein and nucleotide sequences.</article-title>
					<source>FEMS Microbiol Lett</source>
					<volume>174</volume>
					<fpage>247</fpage>
					<lpage>250</lpage>
				</element-citation></ref><ref id="pcbi-0020075-b065"><label>65</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Blanchette</surname><given-names>M</given-names></name><name name-style="western"><surname>Bourque</surname><given-names>G</given-names></name><name name-style="western"><surname>Sankoff</surname><given-names>D</given-names></name></person-group>
					<year>1997</year>
					<article-title>Breakpoint phylogenies.</article-title>
					<source>Genome Inform Ser Workshop Genmoe Inform</source>
					<volume>8</volume>
					<fpage>25</fpage>
					<lpage>34</lpage>
				</element-citation></ref><ref id="pcbi-0020075-b066"><label>66</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Lawrence</surname><given-names>JG</given-names></name><name name-style="western"><surname>Ochman</surname><given-names>H</given-names></name></person-group>
					<year>1998</year>
					<article-title>Molecular archaeology of the <named-content content-type="genus-species" xlink:type="simple">Escherichia coli</named-content> genome.</article-title>
					<source>Proc Natl Acad Sci U S A</source>
					<volume>95</volume>
					<fpage>9413</fpage>
					<lpage>9417</lpage>
					<comment>Available: <ext-link ext-link-type="uri" xlink:href="http://www.pnas.org/cgi/reprint/95/16/9413.pdf" xlink:type="simple">http://www.pnas.org/cgi/reprint/95/16/9413.pdf</ext-link>. Accessed 12 June 2006.</comment>
				</element-citation></ref><ref id="pcbi-0020075-b067"><label>67</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Medigue</surname><given-names>C</given-names></name><name name-style="western"><surname>Rouxel</surname><given-names>T</given-names></name><name name-style="western"><surname>Vigier</surname><given-names>P</given-names></name><name name-style="western"><surname>Henaut</surname><given-names>A</given-names></name><name name-style="western"><surname>Danchin</surname><given-names>A</given-names></name></person-group>
					<year>1991</year>
					<article-title>Evidence for horizontal gene transfer in <named-content content-type="genus-species" xlink:type="simple">Escherichia coli</named-content> speciation.</article-title>
					<source>J Mol Biol</source>
					<volume>222</volume>
					<fpage>851</fpage>
					<lpage>856</lpage>
				</element-citation></ref><ref id="pcbi-0020075-b068"><label>68</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Andersson</surname><given-names>J</given-names></name><name name-style="western"><surname>Andersson</surname><given-names>S</given-names></name></person-group>
					<year>1999</year>
					<article-title>Insights into the evolutionary process of genome degradation.</article-title>
					<source>Curr Op Genet Dev</source>
					<volume>9</volume>
					<fpage>664</fpage>
					<lpage>671</lpage>
				</element-citation></ref><ref id="pcbi-0020075-b069"><label>69</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Lerat</surname><given-names>E</given-names></name><name name-style="western"><surname>Daubin</surname><given-names>V</given-names></name><name name-style="western"><surname>Ochman</surname><given-names>H</given-names></name><name name-style="western"><surname>Moran</surname><given-names>NA</given-names></name></person-group>
					<year>2005</year>
					<article-title>Evolutionary origins of genomic repertoires in bacteria.</article-title>
					<source>PLoS Biol</source>
					<volume>3</volume>
					<elocation-id>e130.</elocation-id>
					<comment>Available: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pbio.0030130" xlink:type="simple">http://dx.doi.org/10.1371/journal.pbio.0030130</ext-link>. Accessed 12 June 2006.</comment>
				</element-citation></ref><ref id="pcbi-0020075-b070"><label>70</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Maiden</surname><given-names>MC</given-names></name></person-group>
					<year>1998</year>
					<article-title>Horizontal genetic exchange, evolution, and spread of antibiotic resistance in bacteria.</article-title>
					<source>Clin Infect Dis</source>
					<volume>27</volume>
					<issue>(Suppl 1)</issue>
					<fpage>S12</fpage>
					<lpage>S20</lpage>
				</element-citation></ref><ref id="pcbi-0020075-b071"><label>71</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Ziebuhr</surname><given-names>W</given-names></name><name name-style="western"><surname>Ohlsen</surname><given-names>K</given-names></name><name name-style="western"><surname>Karch</surname><given-names>H</given-names></name><name name-style="western"><surname>Korhonen</surname><given-names>T</given-names></name><name name-style="western"><surname>Hacker</surname><given-names>J</given-names></name></person-group>
					<year>1999</year>
					<article-title>Evolution of bacterial pathogenesis.</article-title>
					<source>Cell Mol Life Sci</source>
					<volume>56</volume>
					<fpage>719</fpage>
					<lpage>728</lpage>
				</element-citation></ref><ref id="pcbi-0020075-b072"><label>72</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>de la Cruz</surname><given-names>F</given-names></name><name name-style="western"><surname>Davies</surname><given-names>J</given-names></name></person-group>
					<year>2000</year>
					<article-title>Horizontal gene transfer and the origin of species: Lessons from bacteria.</article-title>
					<source>Trends Microbiol</source>
					<volume>8</volume>
					<fpage>128</fpage>
					<lpage>133</lpage>
				</element-citation></ref><ref id="pcbi-0020075-b073"><label>73</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Ochman</surname><given-names>H</given-names></name><name name-style="western"><surname>Lawrence</surname><given-names>JG</given-names></name><name name-style="western"><surname>Groisman</surname><given-names>EA</given-names></name></person-group>
					<year>2000</year>
					<article-title>Lateral gene transfer and the nature of bacterial innovation.</article-title>
					<source>Nature</source>
					<volume>405</volume>
					<fpage>299</fpage>
					<lpage>299</lpage>
					<comment>Available: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/35012500" xlink:type="simple">http://dx.doi.org/10.1038/35012500</ext-link>. Accessed 12 June 2006.</comment>
				</element-citation></ref><ref id="pcbi-0020075-b074"><label>74</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Lawrence</surname><given-names>JG</given-names></name></person-group>
					<year>1999</year>
					<article-title>Gene transfer, speciation, and the evolution of bacterial genomes.</article-title>
					<source>Curr Opin Microbiol</source>
					<volume>2</volume>
					<fpage>519</fpage>
					<lpage>523</lpage>
				</element-citation></ref><ref id="pcbi-0020075-b075"><label>75</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Lawrence</surname><given-names>JG</given-names></name></person-group>
					<year>2002</year>
					<article-title>Gene transfer in bacteria: Speciation without species?</article-title>
					<source>Theor Popul Biol</source>
					<volume>61</volume>
					<fpage>449</fpage>
					<lpage>460</lpage>
				</element-citation></ref><ref id="pcbi-0020075-b076"><label>76</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Parkhill</surname><given-names>J</given-names></name><name name-style="western"><surname>Sebaihia</surname><given-names>M</given-names></name><name name-style="western"><surname>Preston</surname><given-names>A</given-names></name><name name-style="western"><surname>Murphy</surname><given-names>L</given-names></name><name name-style="western"><surname>Thomson</surname><given-names>N</given-names></name><etal/></person-group>
					<year>2003</year>
					<article-title>Comparative analysis of the genome sequences of <named-content content-type="genus-species" xlink:type="simple">Bordetella pertussis</named-content>, <named-content content-type="genus-species" xlink:type="simple">Bordetella parapertussis</named-content> and <named-content content-type="genus-species" xlink:type="simple">Bordetella bronchiseptica</named-content>.</article-title>
					<source>Nat Genet</source>
					<volume>35</volume>
					<fpage>32</fpage>
					<lpage>40</lpage>
				</element-citation></ref><ref id="pcbi-0020075-b077"><label>77</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Tamas</surname><given-names>I</given-names></name><name name-style="western"><surname>Klasson</surname><given-names>L</given-names></name><name name-style="western"><surname>Canback</surname><given-names>B</given-names></name><name name-style="western"><surname>Naslund</surname><given-names>A</given-names></name><name name-style="western"><surname>Eriksson</surname><given-names>A</given-names></name><etal/></person-group>
					<year>2002</year>
					<article-title>50 million years of genomic stasis in endosymbiotic bacteria.</article-title>
					<source>Science</source>
					<volume>296</volume>
					<fpage>2376</fpage>
					<lpage>2379</lpage>
				</element-citation></ref><ref id="pcbi-0020075-b078"><label>78</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Jammalamadaka</surname><given-names>SR</given-names></name><name name-style="western"><surname>SenGupta</surname><given-names>A</given-names></name></person-group>
					<year>2001</year>
					<source>Topics in circular statistics</source>
					<publisher-loc>Singapore</publisher-loc>
					<publisher-name>World Scientific Press</publisher-name>
				</element-citation></ref><ref id="pcbi-0020075-b079"><label>79</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Stephens</surname><given-names>MA</given-names></name></person-group>
					<year>1974</year>
					<article-title>EDF statistics for goodness of fit and some comparisons.</article-title>
					<source>J Amer Stat Assoc</source>
					<volume>69</volume>
					<fpage>730</fpage>
					<lpage>737</lpage>
				</element-citation></ref><ref id="pcbi-0020075-b080"><label>80</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Bergthorsson</surname><given-names>U</given-names></name><name name-style="western"><surname>Ochman</surname><given-names>H</given-names></name></person-group>
					<year>1995</year>
					<article-title>Heterogeneity of genome sizes among natural isolates of <named-content content-type="genus-species" xlink:type="simple">Escherichia coli</named-content>.</article-title>
					<source>J Bacteriol</source>
					<volume>177</volume>
					<fpage>5784</fpage>
					<lpage>5789</lpage>
					<comment>Available: <ext-link ext-link-type="uri" xlink:href="http://jb.asm.org/cgi/reprint/177/20/5784.pdf" xlink:type="simple">http://jb.asm.org/cgi/reprint/177/20/5784.pdf</ext-link>. Accessed 12 June 2006.</comment>
				</element-citation></ref><ref id="pcbi-0020075-b081"><label>81</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Rocha</surname><given-names>EPC</given-names></name></person-group>
					<year>2004</year>
					<article-title>The replication-related organization of bacterial genomes.</article-title>
					<source>Microbiol</source>
					<volume>150</volume>
					<fpage>1609</fpage>
					<lpage>1627</lpage>
					<comment>Available: <ext-link ext-link-type="uri" xlink:href="http://mic.sgmjournals.org/cgi/reprint/150/6/1609.pdf" xlink:type="simple">http://mic.sgmjournals.org/cgi/reprint/150/6/1609.pdf</ext-link>. Accessed 12 June 2006.</comment>
				</element-citation></ref><ref id="pcbi-0020075-b082"><label>82</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Achaz</surname><given-names>G</given-names></name><name name-style="western"><surname>Coissac</surname><given-names>E</given-names></name><name name-style="western"><surname>Netter</surname><given-names>P</given-names></name><name name-style="western"><surname>Rocha</surname><given-names>EPC</given-names></name></person-group>
					<year>2003</year>
					<article-title>Associations between inverted repeats and the structural evolution of bacterial genomes.</article-title>
					<source>Genetics</source>
					<volume>164</volume>
					<fpage>1279</fpage>
					<lpage>1289</lpage>
					<comment>Available: <ext-link ext-link-type="uri" xlink:href="http://www.genetics.org/cgi/reprint/164/4/1279.pdf" xlink:type="simple">http://www.genetics.org/cgi/reprint/164/4/1279.pdf</ext-link>. Accessed 12 June 2006.</comment>
				</element-citation></ref><ref id="pcbi-0020075-b083"><label>83</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Ochman</surname><given-names>H</given-names></name><name name-style="western"><surname>Wilson</surname><given-names>AC</given-names></name></person-group>
					<year>1987</year>
					<article-title>Evolution in bacteria: Evidence for a universal substitution rate in cellular genomes.</article-title>
					<source>J Mol Evol</source>
					<volume>26</volume>
					<fpage>74</fpage>
					<lpage>86</lpage>
				</element-citation></ref><ref id="pcbi-0020075-b084"><label>84</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Hughes</surname><given-names>D</given-names></name></person-group>
					<year>2000</year>
					<article-title>Evaluating genome dynamics: The constraints on rearrangements within bacterial genomes.</article-title>
					<source>Genome Biol</source>
					<volume>1</volume>
					<fpage>6</fpage>
					<lpage>8</lpage>
					<comment>Available: <ext-link ext-link-type="uri" xlink:href="http://genomebiology.com/2000/1/6/reviews/0006" xlink:type="simple">http://genomebiology.com/2000/1/6/reviews/0006</ext-link>. Accessed 12 June 2006.</comment>
				</element-citation></ref><ref id="pcbi-0020075-b085"><label>85</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Lawrence</surname><given-names>JG</given-names></name></person-group>
					<year>2003</year>
					<article-title>Gene organization: Selection, selfishness, and serendipity.</article-title>
					<source>Ann Rev Microbiol</source>
					<volume>57</volume>
					<fpage>419</fpage>
					<lpage>440</lpage>
				</element-citation></ref><ref id="pcbi-0020075-b086"><label>86</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Saunders</surname><given-names>NJ</given-names></name><name name-style="western"><surname>Jeffries</surname><given-names>AC</given-names></name><name name-style="western"><surname>Peden</surname><given-names>JF</given-names></name><name name-style="western"><surname>Hood</surname><given-names>DW</given-names></name><name name-style="western"><surname>Tettelin</surname><given-names>H</given-names></name><etal/></person-group>
					<year>2000</year>
					<article-title>Repeat-associated phase variable genes in the complete genome sequence of <named-content content-type="genus-species" xlink:type="simple">Neisseria meningitidis</named-content> strain mc58.</article-title>
					<source>Mol Microbiol</source>
					<volume>37</volume>
					<fpage>207</fpage>
					<lpage>215</lpage>
					<comment>Available: <ext-link ext-link-type="uri" xlink:href="http://www.blackwell-synergy.com/doi/pdf/10.1046/j.1365-2958.2000.02000.x" xlink:type="simple">http://www.blackwell-synergy.com/doi/pdf/10.1046/j.1365–2958.2000.02000.x</ext-link>. Accessed 12 June 2006.</comment>
				</element-citation></ref><ref id="pcbi-0020075-b087"><label>87</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Tillier</surname><given-names>ER</given-names></name><name name-style="western"><surname>Collins</surname><given-names>RA</given-names></name></person-group>
					<year>2000</year>
					<article-title>Genome rearrangement by replication-directed translocation.</article-title>
					<source>Nat Genet</source>
					<volume>26</volume>
					<fpage>195</fpage>
					<lpage>197</lpage>
					<comment>Available: <ext-link ext-link-type="uri" xlink:href="http://www.nature.com/ng/journal/v26/n2/full/ng1000_195.html" xlink:type="simple">http://www.nature.com/ng/journal/v26/n2/full/ng1000_195.html</ext-link>. Accessed 12 June 2006.</comment>
				</element-citation></ref><ref id="pcbi-0020075-b088"><label>88</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Hinrichs</surname><given-names>AS</given-names></name><name name-style="western"><surname>Karolchik</surname><given-names>D</given-names></name><name name-style="western"><surname>Baertsch</surname><given-names>R</given-names></name><name name-style="western"><surname>Barber</surname><given-names>GP</given-names></name><name name-style="western"><surname>Bejerano</surname><given-names>G</given-names></name><etal/></person-group>
					<year>2006</year>
					<article-title>The UCSC Genome Browser Database: Update 2006.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>34</volume>
					<fpage>D590</fpage>
					<lpage>D598</lpage>
					<comment>Available: <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/34/suppl_1/D590" xlink:type="simple">http://nar.oxfordjournals.org/cgi/content/full/34/suppl_1/D590</ext-link>. Accessed 12 June 2006.</comment>
				</element-citation></ref><ref id="pcbi-0020075-b089"><label>89</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Swidan</surname><given-names>F</given-names></name><name name-style="western"><surname>Ziv-Ukelson</surname><given-names>M</given-names></name><name name-style="western"><surname>Pinter</surname><given-names>RY</given-names></name></person-group>
					<year>2006</year>
					<article-title>On the repeat-annotated phylogenetic tree reconstruction problem.</article-title>
					<source>Proceedings of the 17th Annual Symposium on Combinatorial Pattern Matching</source>
					<conf-date>5–6 July 2006;</conf-date>
					<conf-loc>Barcelona, Spain.</conf-loc>
					<publisher-loc>Berlin</publisher-loc>
					<publisher-name>Springer</publisher-name>
					<comment>pp.</comment>
					<fpage>141</fpage>
					<lpage>153</lpage>
				</element-citation></ref></ref-list></back></article>