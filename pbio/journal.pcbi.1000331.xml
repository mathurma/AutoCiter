<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN">
<front>
<journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher></journal-meta>
<article-meta><article-id pub-id-type="publisher-id">08-PLCB-RA-0687R3</article-id><article-id pub-id-type="doi">10.1371/journal.pcbi.1000331</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline"><subject>Biophysics/Protein Folding</subject><subject>Biophysics/Structural Genomics</subject><subject>Computational Biology/Macromolecular Structure Analysis</subject><subject>Evolutionary Biology/Bioinformatics</subject><subject>Molecular Biology/Bioinformatics</subject><subject>Molecular Biology/Molecular Evolution</subject></subj-group></article-categories><title-group><article-title>Cross-Over between Discrete and Continuous Protein Structure Space: Insights into Automatic Classification and Networks of Protein Structures</article-title><alt-title alt-title-type="running-head">Can Protein Folds Be Objectively Classified?</alt-title></title-group><contrib-group>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Pascual-García</surname><given-names>Alberto</given-names></name><xref ref-type="aff" rid="aff1"/></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Abia</surname><given-names>David</given-names></name><xref ref-type="aff" rid="aff1"/></contrib>
<contrib contrib-type="author" deceased="yes" xlink:type="simple"><name name-style="western"><surname>Ortiz</surname><given-names>Ángel R.</given-names></name><xref ref-type="aff" rid="aff1"/></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Bastolla</surname><given-names>Ugo</given-names></name><xref ref-type="aff" rid="aff1"/><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
</contrib-group><aff id="aff1">          <addr-line>Centro de Biología Molecular ‘Severo Ochoa’ (CSIC-UAM), Cantoblanco, Madrid, Spain</addr-line>       </aff><contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Bourne</surname><given-names>Philip E.</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group><aff id="edit1">University of California San Diego, United States of America</aff><author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">ubastolla@cbm.uam.es</email></corresp>
<fn fn-type="con"><p>Conceived and designed the experiments: ÁRO UB. Performed the experiments: APG. Analyzed the data: APG UB. Contributed reagents/materials/analysis tools: DA. Wrote the paper: UB.</p></fn>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn></author-notes><pub-date pub-type="collection"><month>3</month><year>2009</year></pub-date><pub-date pub-type="epub"><day>27</day><month>3</month><year>2009</year></pub-date><volume>5</volume><issue>3</issue><elocation-id>e1000331</elocation-id><history>
<date date-type="received"><day>20</day><month>8</month><year>2008</year></date>
<date date-type="accepted"><day>11</day><month>2</month><year>2009</year></date>
</history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2009</copyright-year><copyright-holder>Pascual-García et al</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract>
<p>Structural classifications of proteins assume the existence of the fold, which is an intrinsic equivalence class of protein domains. Here, we test in which conditions such an equivalence class is compatible with objective similarity measures. We base our analysis on the transitive property of the equivalence relationship, requiring that similarity of A with B and B with C implies that A and C are also similar. Divergent gene evolution leads us to expect that the transitive property should approximately hold. However, if protein domains are a combination of recurrent short polypeptide fragments, as proposed by several authors, then similarity of partial fragments may violate the transitive property, favouring the continuous view of the protein structure space. We propose a measure to quantify the violations of the transitive property when a clustering algorithm joins elements into clusters, and we find out that such violations present a well defined and detectable cross-over point, from an approximately transitive regime at high structure similarity to a regime with large transitivity violations and large differences in length at low similarity. We argue that protein structure space is discrete and hierarchic classification is justified up to this cross-over point, whereas at lower similarities the structure space is continuous and it should be represented as a network. We have tested the qualitative behaviour of this measure, varying all the choices involved in the automatic classification procedure, i.e., domain decomposition, alignment algorithm, similarity score, and clustering algorithm, and we have found out that this behaviour is quite robust. The final classification depends on the chosen algorithms. We used the values of the clustering coefficient and the transitivity violations to select the optimal choices among those that we tested. Interestingly, this criterion also favours the agreement between automatic and expert classifications. As a domain set, we have selected a consensus set of 2,890 domains decomposed very similarly in SCOP and CATH. As an alignment algorithm, we used a global version of MAMMOTH developed in our group, which is both rapid and accurate. As a similarity measure, we used the size-normalized contact overlap, and as a clustering algorithm, we used average linkage. The resulting automatic classification at the cross-over point was more consistent than expert ones with respect to the structure similarity measure, with 86% of the clusters corresponding to subsets of either SCOP or CATH superfamilies and fewer than 5% containing domains in distinct folds according to both SCOP and CATH. Almost 15% of SCOP superfamilies and 10% of CATH superfamilies were split, consistent with the notion of fold change in protein evolution. These results were qualitatively robust for all choices that we tested, although we did not try to use alignment algorithms developed by other groups. Folds defined in SCOP and CATH would be completely joined in the regime of large transitivity violations where clustering is more arbitrary. Consistently, the agreement between SCOP and CATH at fold level was lower than their agreement with the automatic classification obtained using as a clustering algorithm, respectively, average linkage (for SCOP) or single linkage (for CATH). The networks representing significant evolutionary and structural relationships between clusters beyond the cross-over point may allow us to perform evolutionary, structural, or functional analyses beyond the limits of classification schemes. These networks and the underlying clusters are available at <ext-link ext-link-type="uri" xlink:href="http://ub.cbm.uam.es/research/ProtNet.php" xlink:type="simple">http://ub.cbm.uam.es/research/ProtNet.php</ext-link></p>
</abstract><abstract abstract-type="summary"><title>Author Summary</title>
<p>Making order of the fast-growing information on proteins is essential for gaining evolutionary and functional knowledge. The most successful approaches to this task are based on classifications of protein structures, such as SCOP and CATH, which assume a discrete view of the protein structure space as a collection of separated equivalence classes (folds). However, several authors proposed that protein domains should be regarded as assemblies of polypeptide fragments, which implies that the protein–structure space is continuous. Here, we assess these views of domain space through the concept of transitivity; i.e., we test whether structure similarity of A with B and B with C implies that A and C are similar, as required for consistent classification. We find that the domain space is approximately transitive and discrete at high similarity and continuous at low similarity, where transitivity is severely violated. Comparing our classification at the cross-over similarity with CATH and SCOP, we find that they join proteins at low similarity where classification is inconsistent. Part of this discrepancy is due to structural divergence of homologous domains, which are forced to be in a single cluster in CATH and SCOP. Structural and evolutionary relationships between consistent clusters are represented as a network in our approach, going beyond current protein classification schemes. We conjecture that our results are related to a change of evolutionary regime, from uniparental divergent evolution for highly related domains to assembly of large fragments for which the classical tree representation is unsuitable.</p>
</abstract><funding-group><funding-statement>This work was supported by the Ramon y Cajal program of the Spanish Science Ministry of Education and Science, Project ‘Centrosoma 3D- Bioinformatics’ of the program Consolider-Ingenio 2010 of the Spanish Ministry of Education and Science, Project BIO2005-0576 from the Spanish Ministry of Education and Science, Project 200520M157 from the Comunidad de Madrid, and Research Foundation “Ramon Areces”.</funding-statement></funding-group><counts><page-count count="20"/></counts></article-meta>
</front>
<body><sec id="s1">
<title>Introduction</title>
<p>Structural genomics projects <xref ref-type="bibr" rid="pcbi.1000331-Burley1">[1]</xref> aim at an exhaustive exploration of the space of protein structures realized in evolution <xref ref-type="bibr" rid="pcbi.1000331-GoldsmithFischman1">[2]</xref>,<xref ref-type="bibr" rid="pcbi.1000331-Honig1">[3]</xref>, speeding up considerably the rate at which new protein structures are resolved. In this context, structural classification of proteins <xref ref-type="bibr" rid="pcbi.1000331-Murzin1">[4]</xref>–<xref ref-type="bibr" rid="pcbi.1000331-Holm2">[9]</xref> has become essential for uncovering remote evolutionary relationship that can not be inferred from sequence information alone, and it will have important consequences on our understanding of protein evolution, the sequence to structure to function relationships, the recognition of remote homologs and the modelling of their structures.</p>
<p>This dramatic growth of the number of known protein structures calls upon automatic classification methods that are objective and based only on structural information. The most used structural classifications of proteins, such as SCOP <xref ref-type="bibr" rid="pcbi.1000331-Murzin1">[4]</xref> and CATH <xref ref-type="bibr" rid="pcbi.1000331-Orengo1">[5]</xref>, are manually curated, and therefore they are slow to update. For instance, the last update of SCOP at the moment of writing this paper took from october 2006 to november 2007 (13 months), and the last update of CATH took from may 2006 to january 2007 (9 months). This makes automatic classifications with similar quality to that of CATH and SCOP highly desirable.</p>
<p>However, this goal raises the question of whether, and up to which point, the classification of protein structures is justified. This question is addressed in this paper, where we ask whether an automatic classification based on an objective similarity measure can be uniquely defined.</p>
<p>Several authors studied the agreement between SCOP and CATH classifications <xref ref-type="bibr" rid="pcbi.1000331-Hadley1">[10]</xref>–<xref ref-type="bibr" rid="pcbi.1000331-Sam1">[13]</xref>, concluding that an overall agreement exists, but it is not satisfactory from a quantitative point of view. This problem is partially due to the fact that SCOP and CATH differ in the way in which they split the proteins into domains <xref ref-type="bibr" rid="pcbi.1000331-Day1">[12]</xref>, which are the units of protein classifications. Nevertheless, they often classify differently even domains that are defined in the same way. Sam and coworkers <xref ref-type="bibr" rid="pcbi.1000331-Sam1">[13]</xref> found out that more than 25% of the domain pairs classified in the same SCOP fold are not significantly similar under two measures of structure similarity.</p>
<p>The other side of the coin is that several structures classified in different folds present a significant structural similarity due to the presence of common substructures, a fact noted for instance by the group of Orengo and later by other groups <xref ref-type="bibr" rid="pcbi.1000331-Harrison1">[14]</xref>,<xref ref-type="bibr" rid="pcbi.1000331-Friedberg1">[15]</xref>, which in principle makes multiple classifications possible.</p>
<p>The first and most successful automatic classification of protein domains is the database FSSP <xref ref-type="bibr" rid="pcbi.1000331-Holm1">[8]</xref>, which is based on the DALI algorithm <xref ref-type="bibr" rid="pcbi.1000331-Holm2">[9]</xref> and on its structure similarity measure. Though this similarity measure is overall consistent with the CATH and SCOP classifications important differences exist <xref ref-type="bibr" rid="pcbi.1000331-Getz1">[11]</xref>,<xref ref-type="bibr" rid="pcbi.1000331-Day1">[12]</xref>. Other approaches aiming at the automatic classification of protein structures have been recently proposed by Rogen and Fain <xref ref-type="bibr" rid="pcbi.1000331-Rogen1">[16]</xref>, Sam et al. <xref ref-type="bibr" rid="pcbi.1000331-Sam2">[17]</xref>, Zemla et al. <xref ref-type="bibr" rid="pcbi.1000331-Zemla1">[18]</xref> and by the group of Sippl <xref ref-type="bibr" rid="pcbi.1000331-Suhrer1">[19]</xref>. However, the FSSP database and its more recent followers do not address the question to which extent structure classification is possible and unique. This question is the subject of the present paper.</p>
<sec id="s1a">
<title>Is Protein Structure Space Discrete or Continuous?</title>
<p>Some of the above difficulties are related with the very essence of protein classification schemes, which assume that it exists an intrinsic level of structure similarity for defining equivalence classes of protein structures. In SCOP, such an equivalence class is called <italic>fold</italic> <xref ref-type="bibr" rid="pcbi.1000331-Chothia1">[20]</xref>. Two proteins are defined to belong to the same fold if they share “the same major number and direction of secondary structures with a same connectivity” <xref ref-type="bibr" rid="pcbi.1000331-Murzin1">[4]</xref>. In CATH, the corresponding classification level is called <italic>topology</italic>, defined as “the overall shape and connectivity of secondary structures” <xref ref-type="bibr" rid="pcbi.1000331-Orengo1">[5]</xref>. These apparently clear definitions are in practice subject to substantial arbitrariety, first because it is not always clear which secondary structure elements belong to the structural core defining the fold and which ones are regarded as optional “embellishments”, and second because one has to allow a certain extent of structural divergence in the protein core.</p>
<p>The difficulties presented above have led several authors to propose that the space of protein structures is continous <xref ref-type="bibr" rid="pcbi.1000331-Sam1">[13]</xref>,<xref ref-type="bibr" rid="pcbi.1000331-Kolodny1">[21]</xref>,<xref ref-type="bibr" rid="pcbi.1000331-Shindyalov1">[22]</xref>. This view is supported by the studies that underline the importance of substructures below the level of the globular domain, such as the autonomously folding units of Tsai et al <xref ref-type="bibr" rid="pcbi.1000331-Tsai1">[23]</xref>, the loops of standard size (approximately 30 residues) of Berezowski and Trifunov <xref ref-type="bibr" rid="pcbi.1000331-Berezowski1">[24]</xref>, or the recurrent fragments of Tendulkar et al. <xref ref-type="bibr" rid="pcbi.1000331-Tendulkar1">[25]</xref> and Szustakowski et al. <xref ref-type="bibr" rid="pcbi.1000331-Szustakowski1">[26]</xref>. Expanding an old idea by Ohno <xref ref-type="bibr" rid="pcbi.1000331-Ohno1">[27]</xref>, Lupas et al. <xref ref-type="bibr" rid="pcbi.1000331-Lupas1">[28]</xref> proposed that the most ancient folds have arisen through an evolutionary process consisting in assembling polypeptide fragments together. These and similar ideas have suggest that the basic unit of protein classification should be substructures below the domain level, defined by Shindyalov and Bourne <xref ref-type="bibr" rid="pcbi.1000331-Shindyalov1">[22]</xref> as “highly repetitive near-contiguous pieces of polypeptide chain that occur frequently” in a set of non-redundant protein structures. If protein domains can be regarded as a combination of such substructures, the resulting structure space should be seen as continuous rather than discrete.</p>
<p>A similar spirit is present in the approaches of Efimov <xref ref-type="bibr" rid="pcbi.1000331-Efimov1">[29]</xref> and in particular Taylor, who proposed to enumerate in a kind of periodic table all possible arrangements of secondary structure elements compatible with simple stability rules <xref ref-type="bibr" rid="pcbi.1000331-Taylor1">[30]</xref>, consistent with the view that evolution of protein structures proceeds by combining simpler modules, resulting in a continuous structure space.</p>
</sec><sec id="s1b">
<title>Homology and Structure Similarity Are Not Always Consistent</title>
<p>Another basic assumption of CATH and SCOP is that evolutionary relationships at the superfamily level imply structure similarity at the fold level. Although this assumption is most of the times correct, it was observed already in Ref. <xref ref-type="bibr" rid="pcbi.1000331-Chothia2">[31]</xref> that sequence divergence beyond ≈40% identity sometimes implies large structural variations. Grishin <xref ref-type="bibr" rid="pcbi.1000331-Grishin1">[32]</xref>,<xref ref-type="bibr" rid="pcbi.1000331-Krishna1">[33]</xref> has monitored several examples in which proteins belonging to the same superfamily diverged to the point where they do not share a common fold under the loose definition given above. Interestingly, many of these fold changes take place together with insertions or deletions of large polypeptide fragments, although an interesting example of secondary structure switching has been reported between two homologues regions of distant related proteins <xref ref-type="bibr" rid="pcbi.1000331-Newlove1">[34]</xref>,<xref ref-type="bibr" rid="pcbi.1000331-Roessler1">[35]</xref>. Viksna and Gilbert <xref ref-type="bibr" rid="pcbi.1000331-Viksna1">[36]</xref> recently quantified these fold changes in protein evolution, finding that some of them are relatively common. The occurrence of fold change implies that the classification level based on evolution, as the superfamily, and the classification based on structure, as the fold, should not be necessarily consistent, as already recognized by the group of Orengo <xref ref-type="bibr" rid="pcbi.1000331-Harrison1">[14]</xref>.</p>
</sec></sec><sec id="s2">
<title>Results</title>
<sec id="s2a">
<title>Objective Fold Definition and Transitive Property</title>
<p>Given the above, one can ask whether protein classifications entirely based on a quantitative measure of structure similarity are possible at all, and if so to which extent.</p>
<p>In formal terms, a protein fold is an equivalence class of protein structures. Mathematically, an equivalence relationship must possess the three property of symmetry, reflexivity and transitivity. Whereas symmetry and reflexivity are automatically fulfilled by any relationship based on a similarity measure, transitivity is not. For transitivity to hold, every time that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e001" xlink:type="simple"/></inline-formula> is similar to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e002" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e003" xlink:type="simple"/></inline-formula> is similar to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e004" xlink:type="simple"/></inline-formula>, then <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e005" xlink:type="simple"/></inline-formula> must also be similar to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e006" xlink:type="simple"/></inline-formula>. In other words, you can not make a big step from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e007" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e008" xlink:type="simple"/></inline-formula> by making an intermediate small step through <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e009" xlink:type="simple"/></inline-formula>. Note that transitivity is not the same as the familiar triangular inequality, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e010" xlink:type="simple"/></inline-formula>, which characterizes similarity measures obtained from a properly defined distance. Rather, transitivity is guaranteed by the much stronger property of ultrametricity <xref ref-type="bibr" rid="pcbi.1000331-Rammal1">[37]</xref>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e011" xlink:type="simple"/></inline-formula>, i.e., the distance travelled in two steps can not be larger than the longer of the two steps. An ultrametric set can be uniquely classified in the form of a tree.</p>
<sec id="s2a1">
<title>Uniparental evolution satisfies transitivity</title>
<p>The importance of gene duplication for protein evolution <xref ref-type="bibr" rid="pcbi.1000331-Ohno1">[27]</xref> is a reason to expect that protein structural similarity fulfils the transitive property. The distance across the gene tree, i.e., the time spent since the divergence of two genes, is ultrametric (the time spent from the divergence of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e012" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e013" xlink:type="simple"/></inline-formula> can not be larger than the time either from the divergence of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e014" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e015" xlink:type="simple"/></inline-formula> or from the divergence of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e016" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e017" xlink:type="simple"/></inline-formula>), and therefore it is naturally endowed with the transitive property. Therefore, a phylogenetic tree naturally induces a hierarchical classification for every similarity threshold. If pairs of proteins are related through gene duplication, and if their structural dissimilarity correlates with the time of divergence, as it happens for suitable sequence dissimilarities when evolution is neutral, the transitivity property will approximately hold. However, directed evolution where new conformations are positively selected, for instance to fulfill a new function, may violate the last hypothesis.</p>
</sec><sec id="s2a2">
<title>Fragment assembly violates transitivity</title>
<p>Gene duplication is not the only possible mechanism for the evolution of protein domains. Complex proteins are formed from a combination of individual domains with independent evolutionary history. For this reason, the domain and not the complete protein is the basic unit for protein classification. However, there is increasing evidence that globular domains may be formed by combining fragments below the domain level <xref ref-type="bibr" rid="pcbi.1000331-Tsai1">[23]</xref>–<xref ref-type="bibr" rid="pcbi.1000331-Szustakowski1">[26]</xref>,<xref ref-type="bibr" rid="pcbi.1000331-Lupas1">[28]</xref>, and it has been observed that many structurally unrelated proteins share common substructures <xref ref-type="bibr" rid="pcbi.1000331-Harrison1">[14]</xref>,<xref ref-type="bibr" rid="pcbi.1000331-Szustakowski1">[26]</xref>,<xref ref-type="bibr" rid="pcbi.1000331-Efimov1">[29]</xref>. If two domains <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e018" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e019" xlink:type="simple"/></inline-formula> are similar because of a partial substructure <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e020" xlink:type="simple"/></inline-formula>, while <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e021" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e022" xlink:type="simple"/></inline-formula> are similar because of a different partial substructure <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e023" xlink:type="simple"/></inline-formula>, then <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e024" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e025" xlink:type="simple"/></inline-formula> are not similar and transitivity is violated. Several authors refer to this kind of situation by saying that protein space is continuous, since one can connect two different structures <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e026" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e027" xlink:type="simple"/></inline-formula> with two small steps passing through <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e028" xlink:type="simple"/></inline-formula>.</p>
</sec></sec><sec id="s2b">
<title>Transitivity Violation and Automatic Stop of the Clustering</title>
<p>If <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e029" xlink:type="simple"/></inline-formula> is similar to both <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e030" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e031" xlink:type="simple"/></inline-formula> but <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e032" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e033" xlink:type="simple"/></inline-formula> are not similar, there is no classification simultaneously compatible with all the pairwise similarity relationships. Borrowing a term from statistical physics, we can say that the classification problem is <italic>frustrated</italic> <xref ref-type="bibr" rid="pcbi.1000331-Toulouse1">[38]</xref> when transitivity is violated. We expect that, if this situation is common for many triplets, there is an exponentially large number of substantially different classifications that are almost optimal, in the sense that they violate a small and similar number of pairwise relationships. Conversely, if the transitive property approximately holds, we expect that a well-defined unique globally optimal classification exists, and all sub-optimal classifications are very similar to it.</p>
<p>We expect that the validity of the transitive property strongly depends on structure similarity. Domain pairs with high similarity share most of their structure, and we expect that transitivity approximately holds for them, so that at high similarity the structure space is made of discrete clusters. However, less stringent similarities may be due to partial substructures, and we expect that the transitive property will be violated, and the clustering will strongly depend on the algorithm used.</p>
<p>We propose here a measure to quantify the violation of the transitive property at each step of a hierarchical clustering algorithm. In this way, we aim at detecting the minimum similarity at which transitivity still holds and clustering is justified. At lower similarity, the space should be regarded as continuous, and the significant similarities between clusters should be represented as a network rather than a tree.</p>
<p>Let us consider three elements or clusters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e034" xlink:type="simple"/></inline-formula>, with the convention that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e035" xlink:type="simple"/></inline-formula>. Violation of the transitive property occurs if <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e036" xlink:type="simple"/></inline-formula> is large while <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e037" xlink:type="simple"/></inline-formula> is small, so that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e038" xlink:type="simple"/></inline-formula> is an intermediate point between <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e039" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e040" xlink:type="simple"/></inline-formula>. Therefore it is natural to define the transitivity violation of the triangle <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e041" xlink:type="simple"/></inline-formula> as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e042" xlink:type="simple"/></inline-formula>. Such a quantity depends on the absolute scale and the offset of the similarity measure, i.e., it is not invariant if we multiply all similarities times a scale factor or we add to them a constant. To remove this dependency, we divide <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e043" xlink:type="simple"/></inline-formula> times the difference between the largest and smallest similarities, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e044" xlink:type="simple"/></inline-formula>, defining the transitivity violation associated to the triangle <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e045" xlink:type="simple"/></inline-formula> as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e046" xlink:type="simple"/><label>(1)</label></disp-formula></p>
<p>Notice that, by definition, Eq. (1) is comprised between zero and one because <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e047" xlink:type="simple"/></inline-formula> The maximum violation <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e048" xlink:type="simple"/></inline-formula> happens when <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e049" xlink:type="simple"/></inline-formula> while <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e050" xlink:type="simple"/></inline-formula>.</p>
<p>Another way to interpret this formula is the following. Because of transitivity, only five clustering configurations of the elements <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e051" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e052" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e053" xlink:type="simple"/></inline-formula> are possible: all elements joined, all separated, two joined and the third one separated. For a threshold <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e054" xlink:type="simple"/></inline-formula>, we say that the link <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e055" xlink:type="simple"/></inline-formula> is violated if either <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e056" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e057" xlink:type="simple"/></inline-formula> are joined despite <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e058" xlink:type="simple"/></inline-formula> (overunification) or <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e059" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e060" xlink:type="simple"/></inline-formula> are separated despite <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e061" xlink:type="simple"/></inline-formula> (oversplitting). For thresholds <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e062" xlink:type="simple"/></inline-formula> such that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e063" xlink:type="simple"/></inline-formula> or <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e064" xlink:type="simple"/></inline-formula> there is one and only one configuration that satisfies all links. However, if <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e065" xlink:type="simple"/></inline-formula>, no one of the five possible configurations satisfies all links, since either <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e066" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e067" xlink:type="simple"/></inline-formula> are incorrectly joined, or <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e068" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e069" xlink:type="simple"/></inline-formula> are incorrectly separated. The volume in the space of the threshold parameter <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e070" xlink:type="simple"/></inline-formula> such that some links are violated quantifies the violation of transitivity as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e071" xlink:type="simple"/></inline-formula>. On the other hand, if <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e072" xlink:type="simple"/></inline-formula> all elements are separated, and if <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e073" xlink:type="simple"/></inline-formula> all elements are joined, so that only values of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e074" xlink:type="simple"/></inline-formula> such that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e075" xlink:type="simple"/></inline-formula> correspond to non-trivial clustering. Therefore, Eq. (1) represents the ratio between the volume of parameter space for which transitivity is violated and the volume for which non-trivial clustering exist.</p>
<p>Yet a third way to look at the above equation is the following. Most hierarchical clustering algorithms join at each step <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e076" xlink:type="simple"/></inline-formula> the two most similar clusters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e077" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e078" xlink:type="simple"/></inline-formula> and then recompute the similarity of the new cluster <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e079" xlink:type="simple"/></inline-formula> with any other one <italic>C</italic>. For the average linkage algorithm, we use the formula <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e080" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e081" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e082" xlink:type="simple"/></inline-formula> are proportional to the number of elements in sets <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e083" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e084" xlink:type="simple"/></inline-formula>. The error made by substituting the original similarities <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e085" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e086" xlink:type="simple"/></inline-formula> with the combined one is <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e087" xlink:type="simple"/></inline-formula>, and it is proportional to Eq. (1).</p>
<p>Finally, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e088" xlink:type="simple"/></inline-formula> also quantifies the violation of ultrametricity, since in an ultrametric set the two longest sides of any triangle must be equal <xref ref-type="bibr" rid="pcbi.1000331-Rammal1">[37]</xref>, which implies that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e089" xlink:type="simple"/></inline-formula>. Eq. (1) is normalized in such a way that the value 1 corresponds to the maximum possible violation of ultrametricity, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e090" xlink:type="simple"/></inline-formula>.</p>
<p>Now let us consider the step <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e091" xlink:type="simple"/></inline-formula> of the clustering algorithm in which clusters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e092" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e093" xlink:type="simple"/></inline-formula> are joined. We define the transitivity violation at this step as the weighted sum of the transitivity violations for all triangles involving <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e094" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e095" xlink:type="simple"/></inline-formula>:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e096" xlink:type="simple"/><label>(2)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e097" xlink:type="simple"/></inline-formula> is proportional to the number of elements in cluster <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e098" xlink:type="simple"/></inline-formula>, and for each triangle we label as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e099" xlink:type="simple"/></inline-formula> the element such that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e100" xlink:type="simple"/></inline-formula>.</p>
</sec><sec id="s2c">
<title>Cross-Over in Transitivity Violations</title>
<p>The main result obtained in this study is the existence of a cross-over in the behavior of transitivity violations. This cross-over point determines an intrinsic condition for stopping the hierarchical clustering algorithm. We call the classification obtained at this point “automatic classification”.</p>
<p>The results that we present here are based on a set of 2890 domains that are decomposed very similarly in the SCOP and CATH databases (see <xref ref-type="sec" rid="s4">Methods</xref>), so that the domain decompositions are more likely to be accurate and differences between CATH and SCOP on this set can not be attributed to their different ways of decomposing proteins into domains. We compute structure similarities using the Mammoth-mult algorithm <xref ref-type="bibr" rid="pcbi.1000331-Lupyan1">[39]</xref>, which is one of the fastest algorithms for such a purpose and is comparable in accuracy to other state of the art algorithms <xref ref-type="bibr" rid="pcbi.1000331-Teichert1">[40]</xref>. The similarity measure that we use is based on the contact overlap, normalized in such a way as to eliminate the dependence on the domain size for pairs of unrelated domains, and for clustering we use the average linkage algorithm (see <xref ref-type="sec" rid="s4">Methods</xref>). These choices yielded the best results, as described below, and the results presented will refer to them unless otherwise stated.</p>
<p>We plot in <xref ref-type="fig" rid="pcbi-1000331-g001">Figure 1</xref> the transitivity violations as a function of the step <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e101" xlink:type="simple"/></inline-formula> of the clustering algorithm. For large <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e102" xlink:type="simple"/></inline-formula> the clusters joined are less similar and the transitivity violations increase. The plot can be divided into two regimes: an initial part with slow increase of transitivity violations at large similarity and a final part with faster increase and small similarity. The cross-over between these two regimes can be detected through a two-pieces fit (see <xref ref-type="sec" rid="s4">Methods</xref>). The normalized error of the fit, plotted in <xref ref-type="fig" rid="pcbi-1000331-g001">Figure 1</xref> versus the trial cross-over point, allows us to detect at its minimum the optimal cross-over point, depicted as a vertical line. The classification obtained at this cross-over point is called here “automatic classification”, since the threshold similarity at which the clustering algorithm is stopped is automatically determined. We find <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e103" xlink:type="simple"/></inline-formula>, corresponding to joining two clusters with similarity <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e104" xlink:type="simple"/></inline-formula>. At the stopping point, the automatic classification has 779 clusters.</p>
<fig id="pcbi-1000331-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000331.g001</object-id><label>Figure 1</label><caption>
<title>Violations of transitivity, Eq. (2), as a function of the step of the average linkage algorithm.</title>
<p>We also plot the mean quadratic error of the two-piece linear fit, whose minimum identifies the cross-over point, plotted as a vertical line;</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000331.g001" xlink:type="simple"/></fig></sec><sec id="s2d">
<title>Robustness of the Method</title>
<p>In order to test the robustness of our method, we repeated the numerical experiments changing all the relevant choices: The alignment algorithm, the similarity measure and its normalization, the clustering algorithm and the set of domains. In all cases, we observed a clear cross-over in the behavior of the transitivity violations, and the cross-over point could be automatically located through our algorithm. Moreover, the cross-over point did not vary very much for different choices (see <xref ref-type="table" rid="pcbi-1000331-t001">Table 1</xref>).</p>
<table-wrap id="pcbi-1000331-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000331.t001</object-id><label>Table 1</label><caption>
<title>Robustness of the automatic classification.</title>
</caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1000331-t001-1" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000331.t001" xlink:type="simple"/><table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" colspan="1" rowspan="1">Set</td>
<td align="left" colspan="1" rowspan="1">Ali</td>
<td align="left" colspan="1" rowspan="1">Score</td>
<td align="left" colspan="1" rowspan="1">Norm</td>
<td align="left" colspan="1" rowspan="1">Cl. Al.</td>
<td align="left" colspan="1" rowspan="1">N.Clu.</td>
<td align="left" colspan="1" rowspan="1">Clus.co.</td>
<td align="left" colspan="1" rowspan="1">T.V.</td>
<td align="left" colspan="1" rowspan="1">WKSS</td>
<td align="left" colspan="1" rowspan="1">WKSF</td>
<td align="left" colspan="1" rowspan="1">WKCS</td>
<td align="left" colspan="1" rowspan="1">WKCF</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" colspan="1" rowspan="1">SCOP 2890</td>
<td align="left" colspan="1" rowspan="1">MM</td>
<td align="left" colspan="1" rowspan="1">Cont.</td>
<td align="left" colspan="1" rowspan="1">Gauss</td>
<td align="left" colspan="1" rowspan="1">AL</td>
<td align="left" colspan="1" rowspan="1"><bold>779</bold></td>
<td align="left" colspan="1" rowspan="1"><bold>0.90</bold></td>
<td align="left" colspan="1" rowspan="1"><bold>0.072</bold></td>
<td align="left" colspan="1" rowspan="1"><bold>0.54</bold></td>
<td align="left" colspan="1" rowspan="1"><bold>0.69</bold></td>
<td align="left" colspan="1" rowspan="1"><bold>0.58</bold></td>
<td align="left" colspan="1" rowspan="1"><bold>0.32</bold></td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">SCOP 2890</td>
<td align="left" colspan="1" rowspan="1">MM</td>
<td align="left" colspan="1" rowspan="1"><bold>TM</bold></td>
<td align="left" colspan="1" rowspan="1"><bold>No</bold></td>
<td align="left" colspan="1" rowspan="1">AL</td>
<td align="left" colspan="1" rowspan="1">740</td>
<td align="left" colspan="1" rowspan="1">0.87</td>
<td align="left" colspan="1" rowspan="1">0.101</td>
<td align="left" colspan="1" rowspan="1">0.59</td>
<td align="left" colspan="1" rowspan="1">0.60</td>
<td align="left" colspan="1" rowspan="1">0.55</td>
<td align="left" colspan="1" rowspan="1">0.22</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">SCOP 2890</td>
<td align="left" colspan="1" rowspan="1">MM</td>
<td align="left" colspan="1" rowspan="1"><bold>PSI4-p</bold></td>
<td align="left" colspan="1" rowspan="1">EV</td>
<td align="left" colspan="1" rowspan="1">AL</td>
<td align="left" colspan="1" rowspan="1">768</td>
<td align="left" colspan="1" rowspan="1">0.88</td>
<td align="left" colspan="1" rowspan="1">0.088</td>
<td align="left" colspan="1" rowspan="1">0.51</td>
<td align="left" colspan="1" rowspan="1">0.57</td>
<td align="left" colspan="1" rowspan="1">0.51</td>
<td align="left" colspan="1" rowspan="1">0.24</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">SCOP 2890</td>
<td align="left" colspan="1" rowspan="1">MM</td>
<td align="left" colspan="1" rowspan="1"><bold>PSI6-p</bold></td>
<td align="left" colspan="1" rowspan="1">EV</td>
<td align="left" colspan="1" rowspan="1">AL</td>
<td align="left" colspan="1" rowspan="1">855</td>
<td align="left" colspan="1" rowspan="1">0.87</td>
<td align="left" colspan="1" rowspan="1">0.113</td>
<td align="left" colspan="1" rowspan="1">0.54</td>
<td align="left" colspan="1" rowspan="1">0.58</td>
<td align="left" colspan="1" rowspan="1">0.52</td>
<td align="left" colspan="1" rowspan="1">0.27</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">SCOP 2890</td>
<td align="left" colspan="1" rowspan="1">MM</td>
<td align="left" colspan="1" rowspan="1"><bold>PSI4-t</bold></td>
<td align="left" colspan="1" rowspan="1">EV</td>
<td align="left" colspan="1" rowspan="1">AL</td>
<td align="left" colspan="1" rowspan="1">788</td>
<td align="left" colspan="1" rowspan="1">0.88</td>
<td align="left" colspan="1" rowspan="1">0.084</td>
<td align="left" colspan="1" rowspan="1">0.49</td>
<td align="left" colspan="1" rowspan="1">0.60</td>
<td align="left" colspan="1" rowspan="1">0.48</td>
<td align="left" colspan="1" rowspan="1">0.26</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">SCOP 2890</td>
<td align="left" colspan="1" rowspan="1">MM</td>
<td align="left" colspan="1" rowspan="1">Cont.</td>
<td align="left" colspan="1" rowspan="1"><bold>No</bold></td>
<td align="left" colspan="1" rowspan="1">AL</td>
<td align="left" colspan="1" rowspan="1">883</td>
<td align="left" colspan="1" rowspan="1">0.88</td>
<td align="left" colspan="1" rowspan="1">0.069</td>
<td align="left" colspan="1" rowspan="1">0.57</td>
<td align="left" colspan="1" rowspan="1">0.50</td>
<td align="left" colspan="1" rowspan="1">0.53</td>
<td align="left" colspan="1" rowspan="1">0.27</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">SCOP 2890</td>
<td align="left" colspan="1" rowspan="1"><bold>MP</bold></td>
<td align="left" colspan="1" rowspan="1">Cont.</td>
<td align="left" colspan="1" rowspan="1"><bold>No</bold></td>
<td align="left" colspan="1" rowspan="1">AL</td>
<td align="left" colspan="1" rowspan="1">950</td>
<td align="left" colspan="1" rowspan="1">0.86</td>
<td align="left" colspan="1" rowspan="1">0.070</td>
<td align="left" colspan="1" rowspan="1">0.51</td>
<td align="left" colspan="1" rowspan="1">0.54</td>
<td align="left" colspan="1" rowspan="1">0.53</td>
<td align="left" colspan="1" rowspan="1">0.23</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">SCOP 2890</td>
<td align="left" colspan="1" rowspan="1"><bold>MP</bold></td>
<td align="left" colspan="1" rowspan="1"><bold>PSI4-p</bold></td>
<td align="left" colspan="1" rowspan="1">EV</td>
<td align="left" colspan="1" rowspan="1">AL</td>
<td align="left" colspan="1" rowspan="1">797</td>
<td align="left" colspan="1" rowspan="1">0.77</td>
<td align="left" colspan="1" rowspan="1">0.089</td>
<td align="left" colspan="1" rowspan="1">0.47</td>
<td align="left" colspan="1" rowspan="1">0.44</td>
<td align="left" colspan="1" rowspan="1">0.49</td>
<td align="left" colspan="1" rowspan="1">0.19</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">SCOP 2890</td>
<td align="left" colspan="1" rowspan="1"><bold>MP</bold></td>
<td align="left" colspan="1" rowspan="1"><bold>PSI4-t</bold></td>
<td align="left" colspan="1" rowspan="1">EV</td>
<td align="left" colspan="1" rowspan="1">AL</td>
<td align="left" colspan="1" rowspan="1">758</td>
<td align="left" colspan="1" rowspan="1">0.88</td>
<td align="left" colspan="1" rowspan="1">0.085</td>
<td align="left" colspan="1" rowspan="1">0.51</td>
<td align="left" colspan="1" rowspan="1">0.54</td>
<td align="left" colspan="1" rowspan="1">0.51</td>
<td align="left" colspan="1" rowspan="1">0.25</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">SCOP 2890</td>
<td align="left" colspan="1" rowspan="1">MM</td>
<td align="left" colspan="1" rowspan="1">Cont.</td>
<td align="left" colspan="1" rowspan="1">Gauss</td>
<td align="left" colspan="1" rowspan="1"><bold>SL</bold></td>
<td align="left" colspan="1" rowspan="1">876</td>
<td align="left" colspan="1" rowspan="1">0.90</td>
<td align="left" colspan="1" rowspan="1">0.167</td>
<td align="left" colspan="1" rowspan="1">0.24</td>
<td align="left" colspan="1" rowspan="1">0.48</td>
<td align="left" colspan="1" rowspan="1">0.54</td>
<td align="left" colspan="1" rowspan="1">0.69</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">SCOP 2890</td>
<td align="left" colspan="1" rowspan="1">MM</td>
<td align="left" colspan="1" rowspan="1">Cont.</td>
<td align="left" colspan="1" rowspan="1">Gauss</td>
<td align="left" colspan="1" rowspan="1"><bold>CL</bold></td>
<td align="left" colspan="1" rowspan="1">730</td>
<td align="left" colspan="1" rowspan="1">0.90</td>
<td align="left" colspan="1" rowspan="1">0.080</td>
<td align="left" colspan="1" rowspan="1">0.26</td>
<td align="left" colspan="1" rowspan="1">0.47</td>
<td align="left" colspan="1" rowspan="1">0.43</td>
<td align="left" colspan="1" rowspan="1">0.10</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">CATH 2890</td>
<td align="left" colspan="1" rowspan="1">MM</td>
<td align="left" colspan="1" rowspan="1">Cont.</td>
<td align="left" colspan="1" rowspan="1">Gauss</td>
<td align="left" colspan="1" rowspan="1"><bold>A</bold>L</td>
<td align="left" colspan="1" rowspan="1">776</td>
<td align="left" colspan="1" rowspan="1">0.90</td>
<td align="left" colspan="1" rowspan="1">0.079</td>
<td align="left" colspan="1" rowspan="1">0.50</td>
<td align="left" colspan="1" rowspan="1">0.71</td>
<td align="left" colspan="1" rowspan="1">0.54</td>
<td align="left" colspan="1" rowspan="1">0.36</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><bold>SCOP 5041</bold></td>
<td align="left" colspan="1" rowspan="1">MM</td>
<td align="left" colspan="1" rowspan="1">Cont.</td>
<td align="left" colspan="1" rowspan="1">Gauss</td>
<td align="left" colspan="1" rowspan="1">AL</td>
<td align="left" colspan="1" rowspan="1">1353</td>
<td align="left" colspan="1" rowspan="1">0.92</td>
<td align="left" colspan="1" rowspan="1">0.063</td>
<td align="left" colspan="1" rowspan="1">0.61</td>
<td align="left" colspan="1" rowspan="1">0.52</td>
<td align="left" colspan="1" rowspan="1">-</td>
<td align="left" colspan="1" rowspan="1">-</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><bold>CATH 7073</bold></td>
<td align="left" colspan="1" rowspan="1">MM</td>
<td align="left" colspan="1" rowspan="1">Cont.</td>
<td align="left" colspan="1" rowspan="1">Gauss</td>
<td align="left" colspan="1" rowspan="1">AL</td>
<td align="left" colspan="1" rowspan="1">2287</td>
<td align="left" colspan="1" rowspan="1">0.91</td>
<td align="left" colspan="1" rowspan="1">0.068</td>
<td align="left" colspan="1" rowspan="1">-</td>
<td align="left" colspan="1" rowspan="1">-</td>
<td align="left" colspan="1" rowspan="1">0.51</td>
<td align="left" colspan="1" rowspan="1">0.14</td>
</tr>
</tbody>
</table></alternatives><table-wrap-foot><fn id="nt101"><p>The qualitative features of the classification at the cross-over point are robust with respect to different methodological choices. First column, set of domains at less than 40 percent sequence identity: either 2890 domains from SCOP, or the corresponding 2890 domains from CATH, or 5041 domains from SCOP, or 7073 domains from CATH. The number of superfamilies and folds is, respectively: SCOP 2890: 779, 466; CATH 2890: 873, 473; SCOP 5041: 1094, 660; CATH 7073: 995, 1852. 2nd column, alignment algorithm: either the multiple structure alignment algorithm MAMMOTH multiple (MM) or its pairwise version (MP), faster but much less accurate. 3rd column, similarity measures: either Contact Overlap (Cont.) or TM score (TM) or percentage of structure identity (PSI). This can have a tolerance of either 4Å or 6Å , and it can be normalized either with respect the length of the shortest domain, PSI partial (PSI-p), or with respect to the geometric average, PSI total (PSI-t). 4th column, normalization with respect to length: either none, or Gaussian statistics (Gauss) or extreme value statistics (EV) 5th column, clustering algorithms: either average linkage (AL), or single linkage (SL) or complete linkage (CL). The results presented are the following. Number of clusters at the cross-over point (6th column), clustering coefficient averaged until the cross-over similarity (7th column), mean transitivity violations(8th column) and weighted kappa with respect to SCOP superfamilies (9th column), SCOP folds (10th column), CATH superfamilies (11th column) and CATH topologies (12th column), The first line in bold face refers to the selected choices, used in the presented results. In the following lines we evidence in bold face the variables that have changed with respect to the reference.</p></fn></table-wrap-foot></table-wrap>
<p>In order to choose the best options, we measured the transitivity violations, the clustering coefficient, which is the network analogous of the transitive property (see <xref ref-type="sec" rid="s4">Methods</xref>), and the agreement of the automatic classification with SCOP and CATH as assessed through the weighted kappa measure, which is a normalized measure of consistency between two classifications (see <xref ref-type="sec" rid="s4">Methods</xref>). These measures tend to be consistent, i.e., choices yielding larger clustering coefficient tend to yield smaller transitivity violations and larger weighted kappa as well. This justifies the use of the weighted kappa to assess the method, despite the problems that we will discuss in the following and that limit the best possible agreement between the automatic classification and SCOP or CATH. In particular, we considered the following options:</p>
<p>1. As <bold>structure alignment</bold> method, we used either the multiple <xref ref-type="bibr" rid="pcbi.1000331-Lupyan1">[39]</xref> or the pairwise <xref ref-type="bibr" rid="pcbi.1000331-Ortiz1">[41]</xref> version of the MAMMOTH algorithm. As it has been recently assessed through an extensive test <xref ref-type="bibr" rid="pcbi.1000331-Teichert1">[40]</xref>, MAMMOTH multiple is of comparable accuracy to other state of the art structure alignment tools and faster than most of them, while its pairwise version is even faster, but at the expense of accuracy. Moreover, the two algorithms are based on different principles, since Mammoth pairwise optimizes the local superimpositions of heptamers whereas Mammoth-mult optimizes the global superimposition of the two structures. Nevertheless, we obtained very similar results with the two algorithms, which shows that the whole methodology is not very sensitive to the accuracy of the alignment. We used the more accurate MAMMOTH-mult algorithm as the standard option.</p>
<p>2. We used several different measures of <bold>structure similarity</bold>. First, we used measures that require optimal rigid-body superimposition of the aligned residues. Such is the the percentage of structure identity (PSI), which counts the percentage of aligned residues that superimpose within a given threshold after optimal rigid body superimposition. In order to examine the influence of this threshold, we used the standard value 4Å as used in the standard MAMMOTH score and the larger tolerance 6Å. We normalized the PSI either through the length of the shorter protein, Eq. (5), which does not penalize matches that are only partial (we refer to it as the Partial PSI) or through the geometric mean length, Eq. (6) (Total PSI). As an alternative to an arbitrary tolerance parameter we tested the TM score <xref ref-type="bibr" rid="pcbi.1000331-Zhang1">[42]</xref>, which uses a length dependent threshold that makes this score almost independent of the size of the aligned proteins. Second, we used the contact overlap, Eq. (7), which does not depend neither on the optimal rigid body superimposition nor on a tolerance parameter, although it depends on the parameter used to define contacts, i.e., interatomic interactions in the native structure. Most of the results presented here are obtained with the overlap as similarity score.</p>
<p>In order to remove the dependence on protein length for unrelated proteins, we normalized the PSI and the overlap as in Eq. (8). The parameters used in this expression were determined by fitting mean and standard deviation of the similarity of unrelated structures with respect to the length used to normalize the PSI, using either Gaussian statistics Eq. (9), or extreme value statistics, Eq. (10), as in the original Mammoth paper.</p>
<p>The best similarity score was selected based on the value of transitivity violations and the clustering coefficient evaluated up to the automatic cross-over point (see <xref ref-type="sec" rid="s4">Methods</xref>). Using these criteria, the best score was the contact overlap (see <xref ref-type="supplementary-material" rid="pcbi.1000331.s001">Figure S1</xref>).</p>
<p>The normalization with respect to domain size did not modify the clustering coefficient considerably. However, measures that omit the normalization yield much lower agreement with expert classifications, and their cross-over points are rather distinct, whereas all the normalized scores have almost the same cross-over points. Therefore, normalized scores were used as the standard.</p>
<p>3. As <bold>clustering method</bold>, we considered average linkage (AL), single linkage (SL) and complete linkage (CL). We also used the neighbour joining algorithm (NJ), finding results very similar to those with average linkage (data not shown). For this comparison, we did not use the clustering coefficient, since it does not depend on the clustering algorithm.</p>
<p>The plot of transitivity violations for the three algorithms is shown as <xref ref-type="supplementary-material" rid="pcbi.1000331.s002">Figure S2</xref>, plot A. Not surprisingly, we found the best results with the average linkage algorithm, which can be interpreted as an algorithm trying to minimize the combination of oversplitting and overunification transitivity violations. The complete linkage only minimizes overunification errors, since it separates all structures that are below the similarity threshold. Its transitivity violations are only slightly larger than for the average linkage, but its weighted kappa is much smaller. The single linkage only minimizes oversplitting errors, since it joins all pairs above the similarity threshold. Correspondingly, it generates larger clusters. Its transitivity error is much larger than for complete and average linkage.</p>
<p>Remarkably, single linkage clustering agrees much better than average linkage with the CATH classification at topology (fold) level. This is not surprising, since CATH uses single linkage clustering, but it is an interesting observation, since it illustrate that one basic difference between CATH and SCOP arises from their reliance on different clustering procedures. However, superfamilies agree much better with the average linkage classification for both CATH and SCOP. More important, the transitivity violation is an intrinsic criterion, not based on any reference classification, which clearly favors the average linkage algorithm (see also the <xref ref-type="sec" rid="s3">Discussion</xref>).</p>
<p>4. As <bold>domain set</bold>, we used the consensus domains (2890 domains), the ASTRAL40 set of domains corresponding to SCOP release 1.63 (5041 domains), and the set of non-redundant domains at the 35 percent sequence identity threshold corresponding to CATH release 3.1.1 (7073 domains).</p>
<p>The number of domains per fold as defined by SCOP (1.67, 2.05) and CATH (1.64, 2.30) increases with the size of the set, as we would expect from the fact that the cluster size is power law distributed, so that smaller samples are more likely to have smaller averages. The same happens at the level of superfamily. In contrast, the number of domains per cluster does not increase for larger samples, being 3.71 and 3.73 for SCOP domains and 3.71 and 3.09 for CATH domains. This indicates that our method tends to stop the clustering process relatively earlier for larger samples. In fact, larger samples are more likely to contain proteins that evidence transitivity violations. The plots of transitivity violations are qualitatively very similar, and are represented in <xref ref-type="supplementary-material" rid="pcbi.1000331.s002">Figure S2</xref>, plot B.</p>
</sec><sec id="s2e">
<title>Length Differences</title>
<p>At each clustering step, we measure the difference between the average domain length of the two joined clusters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e105" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e106" xlink:type="simple"/></inline-formula>,<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e107" xlink:type="simple"/><label>(3)</label></disp-formula></p>
<p>One can see from <xref ref-type="fig" rid="pcbi-1000331-g002">Figure 2</xref> that the length difference is significantly larger after the cross-over point when transitivity violations increase faster. This observation is consistent with the intepretation that the regime of large transitivity violations takes place when the joined clusters are more likely to share only partial substructures. This behavior of the length difference is very robust with respect to changes in the clustering algorithm, similarity score, or set of domains.</p>
<fig id="pcbi-1000331-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000331.g002</object-id><label>Figure 2</label><caption>
<title>Difference between the mean lengths of the two joined clusters, Eq. (3), versus the average linkage step.</title>
<p>The cross-over of transitivity violations is depicted as a vertical line. One can see that length differences are significantly larger after the cross-over. To improve the representation, we performed running averages with window size of 30 steps.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000331.g002" xlink:type="simple"/></fig></sec><sec id="s2f">
<title>Statistics of the Cluster Size</title>
<p>At the cross-over point, we find a broad distribution of the number of domains per cluster, with power-law probability density, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e108" xlink:type="simple"/></inline-formula>. This result agrees with the distribution of the number of proteins predicted to belong to specific folds in various genomes, which follow power-laws <xref ref-type="bibr" rid="pcbi.1000331-Gerstein1">[43]</xref> with exponents between 2.5 and 4.0, approaching 2.5 for large genomes <xref ref-type="bibr" rid="pcbi.1000331-Huynen1">[44]</xref>. It also agrees very well with the automatic clustering by Dokholyan et al. <xref ref-type="bibr" rid="pcbi.1000331-Dokholyan1">[45]</xref>, who found an exponent of 2.5 using as similarity measure the Dali score <xref ref-type="bibr" rid="pcbi.1000331-Holm2">[9]</xref>, with single linkage clustering and threshold derived from the statistical analysis of the domain similarity network. We also measured the cluster size distribution in the SCOP classification with 40 percent sequence similarity threshold to reduce redundancy, finding <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e109" xlink:type="simple"/></inline-formula> for folds and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e110" xlink:type="simple"/></inline-formula> for superfamilies.</p>
<p>Therefore, the exponent of the distribution of the number of domains per cluster agrees reasonably between the SCOP and the automatic classification. Nevertheless, this agreement is not an evidence of the consistency between classifications, since the same size distribution can be found also for clusters obtained from random networks with the same statistical properties <xref ref-type="bibr" rid="pcbi.1000331-Dokholyan1">[45]</xref>.</p>
</sec><sec id="s2g">
<title>Comparison of Automatic and Expert Classifications</title>
<sec id="s2g1">
<title>Weighted kappa</title>
<p>We compared the automatic classification with SCOP and CATH measuring their weighted kappa, which is plotted in <xref ref-type="fig" rid="pcbi-1000331-g003">Figure 3</xref> versus the step of the average linkage. At first kappa increases steadily, since most joined domains belong to the same superfamily or fold, then it reaches a plateau and it decreases steeply when most of the joined domains belong to different folds or superamilies. The maximum of kappa is reached earlier, i.e., at larger number of clusters, for superfamilies than for folds, as expected since there are more superfamilies than folds. The maximum kappa for folds is larger than for superfamilies, which seem at first sight surprising, since structural similarity is on the average larger within a superfamily than within a fold. However, kappa can be decomposed into the contributions of related and unrelated pairs, with weights proportional to the number of related and unrelated pairs, respectively, see Eq. (20). For folds, the ratio of related to unrelated pairs, and consequently the weight of related pairs, is larger than for superfamilies. Therefore, kappa will be larger when all domains in the same fold are joined than when all domains in the same superfamily are joined.</p>
<fig id="pcbi-1000331-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000331.g003</object-id><label>Figure 3</label><caption>
<title>Weighted kappa measuring the agreement the average linkage classifications with step represented in the horizontal axis and SCOP and CATH superfamilies and folds.</title>
<p>Notice that the cross-over point, depicted as a vertical line, lies between the maximum agreement with superfamilies and the maximum agreement with folds.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000331.g003" xlink:type="simple"/></fig>
<p>The cross over point is located before the maximum weighted kappa for folds, indicating that many clustering steps that join clusters containing domains in the same fold imply large transitivity violations. This suggests that these fold relationships are more compatible with a network than with a classification. The difference between the automatic classification and the classification at the step where the kappa for folds is maximum becomes larger when more domains are added to the set, which makes it more likely to find transitivity violations that prevents clusters from being joined.</p>
<p>These results are robust with respect to the different choices mentioned above. In the following, we analyze in more detail the instances of disagreement between the automatic and the expert classifications.</p>
</sec><sec id="s2g2">
<title>Splitting of SCOP and CATH superfamilies</title>
<p>At the cross-over point, the great majority of the clusters only contain domains in the same SCOP or CATH superfamily. Their number is 632 for CATH superfamilies, 664 for SCOP superfamilies, and 673 over 779 (more than 86 percent) for either SCOP or CATH superfamilies (see <xref ref-type="table" rid="pcbi-1000331-t002">Table 2</xref>).</p>
<table-wrap id="pcbi-1000331-t002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000331.t002</object-id><label>Table 2</label><caption>
<title>Detailed comparison between automatic and expert classifications.</title>
</caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1000331-t002-2" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000331.t002" xlink:type="simple"/><table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" colspan="1" rowspan="1">Reference classification</td>
<td align="left" colspan="1" rowspan="1">Num. clust.</td>
<td align="left" colspan="1" rowspan="1">Homogeneity</td>
<td align="left" colspan="1" rowspan="1">Joining probability</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" colspan="1" rowspan="1">SCOP SF</td>
<td align="left" colspan="1" rowspan="1">779</td>
<td align="left" colspan="1" rowspan="1">85.2</td>
<td align="left" colspan="1" rowspan="1">68.0</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">CATH SF</td>
<td align="left" colspan="1" rowspan="1">885</td>
<td align="left" colspan="1" rowspan="1">81.1</td>
<td align="left" colspan="1" rowspan="1">66.4</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">SCOP or CATH SF</td>
<td align="left" colspan="1" rowspan="1">-</td>
<td align="left" colspan="1" rowspan="1">86.3</td>
<td align="left" colspan="1" rowspan="1">69.1</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">SCOP folds</td>
<td align="left" colspan="1" rowspan="1">466</td>
<td align="left" colspan="1" rowspan="1">92.0</td>
<td align="left" colspan="1" rowspan="1">44.5</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">CATH folds</td>
<td align="left" colspan="1" rowspan="1">473</td>
<td align="left" colspan="1" rowspan="1">91.4</td>
<td align="left" colspan="1" rowspan="1">10.7</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">SCOP or CATH folds</td>
<td align="left" colspan="1" rowspan="1">-</td>
<td align="left" colspan="1" rowspan="1">95.4</td>
<td align="left" colspan="1" rowspan="1">45.0</td>
</tr>
</tbody>
</table></alternatives><table-wrap-foot><fn id="nt102"><p>First column: reference classification. Second column: Number of clusters in the reference classification. Third column: Percentage of the 779 clusters in the automatic classification that are pure with respect to the reference classification (in case of CATH or SCOP, it is the fraction of clusters that are pure with respect to either CATH or SCOP). Fourth column: Percentage of the pairs joined in the reference classification that are joined in the automatic classification. In the case of folds, only pairs in different superfamilies are counted.</p></fn></table-wrap-foot></table-wrap>
<p>Several superfamilies are splitted in various clusters of the automatic classification. This is one of the most common disagreement between the automatic and the expert classifications. This is however not surprising, since it is well known that evolutionarily related proteins may diverge structurally. The number of splitted superfamilies is 115 over 779 (almost 15%) for SCOP and 87 over 885 (less than 10%) for CATH, which splits several superfamilies that are unique in SCOP.</p>
<p>To analyse these splittings, we measured the distribution of structure similarity between each pair of domains in the same SCOP superfamily, distinguishing split superfamilies from superfamilies contained in just one cluster of the automatic classification. The two distributions are shown in <xref ref-type="fig" rid="pcbi-1000331-g004">Figure 4A</xref>. Similarities in split superfamilies show a bimodal distribution, with one peak at low similarity corresponding to pairs of domains belonging to different clusters and one peak at high similarity corresponding to pairs in the same cluster. This indicates that the splitting is not an artifact of the method, but it reflects a significant difference between split and unsplit superfamilies.</p>
<fig id="pcbi-1000331-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000331.g004</object-id><label>Figure 4</label><caption>
<title>Distributions of intra-superfamily and intra-cluster similarity scores.</title>
<p>(A) Distribution of the normalized total similarity score, Eq. (6) and (8), for domain pairs in the same superfamily. The grey bars are obtained for superfamilies that are not split, whereas the white bars are obtained for splitted superfamilies. One can see that splitted superfamilies present a bimodal distribution, with a peak with very small structure similarity. (B) Distribution of the mean intracluster similarity in the automatic classification, Eq. (11). The white bars are obtained for domains in clusters that contain only proteins of the same SCOP fold. The orange bars are obtained for minority domains in clusters containing domains that are mostly of a different SCOP fold.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000331.g004" xlink:type="simple"/></fig>
<p>For some cases, the difference between domains in the same superfamily appears to be due to large insertions or deletions of secondary structures, which may produce fold changes in protein evolution <xref ref-type="bibr" rid="pcbi.1000331-Grishin1">[32]</xref>,<xref ref-type="bibr" rid="pcbi.1000331-Krishna1">[33]</xref>,<xref ref-type="bibr" rid="pcbi.1000331-Viksna1">[36]</xref>. In fact, we measured the difference in length between proteins in the same superfamily, distinguishing split and unsplit superfamilies. The median size difference is 41 residues for splitted superfamilies, as compared with 22 residues for unsplitted ones. One such example of split superfamilies is shown in <xref ref-type="fig" rid="pcbi-1000331-g005">Figure 5A</xref>, showing domains 1c7ka_ and 1e1h.1, both from the SCOP superfamily of metalloproteases (55486). The first domain has 132 residues, and it is automatically classified in a cluster of 5 domains from the same superfamily with average length 163. The second domain has 399 residues and it is not joined with any other domain. Only three of the five beta strands in the main sheet of the large domain superimpose with the corresponding strands in the small domain. The large domain has several additional beta strands and alpha helices. CATH also separates the two domains. It includes the cluster containing 1c7ka_ in the superfamily collagenase, and the domain that we separate in the superfamily metalloproteases.</p>
<fig id="pcbi-1000331-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000331.g005</object-id><label>Figure 5</label><caption>
<title>Examples of splitted SCOP superfamilies with large structural changes.</title>
<p>Above: Two domains classified in SCOP in the metalloproteases superfamily, but splitted in CATH. Their codes are 1c7ka_ (A) and 1e1h.1 (B), with lengths of 132 and 399 residues respectively. Most of the secondary structure elements in the long protein are not matched in the short one. Below: Lambda repressor-like DNA-binding domains 1lmb3_ and 1r69__ (C) and 1d1la_ (D), which represent a well studied example of possible secondary structure switch in evolution.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000331.g005" xlink:type="simple"/></fig>
<p>Another example is the superfamily lambda repressor-like DNA-binding domains (47413). We separate this superfamily in two clusters, one containing the domains with ASTRAL id. 1lmb3_ and 1r69__ and another one containing domain 1d1la_. This is consistent with the CATH classification, which separates them in two different topologies, and even two different secondary structure classes (all alpha and alpha+beta). Domains 1lmb3_ and 1d1la_ constitute possibly a very interesting example of evolutionary secondary structure switch between proteins that could be demonstrated to be homologues <xref ref-type="bibr" rid="pcbi.1000331-Newlove1">[34]</xref>,<xref ref-type="bibr" rid="pcbi.1000331-Roessler1">[35]</xref>. Placing both structures in the same fold puts in shadow this very interesting example of divergent structure evolution.</p>
<p>A number of splittings is due to the limited ability of the similarity score to assign significant similarity to short proteins In fact, the average overlap or PSI of unrelated structures is larger for short proteins, and therefore a larger overlap or PSI is required to judge it as significant (see Eq. (8)). As a consequence, there is a bias to split superfamilies with small domains: The mean length of splitted superfamilies is 165 residues versus 180 residues for superfamilies that are not splitted. We show one such example in <xref ref-type="fig" rid="pcbi-1000331-g006">Figure 6</xref>, which represents three short domains of the homeodomain-like superfamily that would be joined at a similarity value slightly below the cross-over (at <italic>Z</italic>-score 6.1). A possible solution would be to modify the score so that the similarity does not depend on chain length neither for closely related nor for unrelated proteins. We will study such a modification in following work.</p>
<fig id="pcbi-1000331-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000331.g006</object-id><label>Figure 6</label><caption>
<title>Three small domains of the Homeodomain-like superfamily, with PDB codes 1bl0a1, 1bl0a2 and 1d5ya2 are splitted in two clusters despite very high similarity.</title>
<p>These clusters would be joined with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e111" xlink:type="simple"/></inline-formula>, short after the cross-over. This is an example of the limitation of the similarity measure in recognizing significant similarity when dealing with small structures.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000331.g006" xlink:type="simple"/></fig></sec><sec id="s2g3">
<title>Fold unification</title>
<p>The automatic classification disagrees with CATH or SCOP when two domains in the same cluster belong to different folds. This kind of disagreement is rather rare. Only 142 domains over 2890, i.e., less than 5 percent, are contained in clusters where the majority of domains is from another SCOP fold, and they are distributed in only 63 clusters, so that 92 percent of the clusters contains only domains from the same fold. Similarly, 124 CATH domains over 2890 are minority domains, distributed in 67 clusters. However, these do not coincide with the 62 homogeneous clusters according to SCOP. Only 36 clusters (less than 5 percent) are not homogeneous according to both SCOP and CATH, indicating a very high agreement in cluster composition with the expert classifications (see <xref ref-type="table" rid="pcbi-1000331-t002">Table 2</xref>).</p>
<p>For analyzing these disagreements, we computed the mean similarity score of each domain with the other domains in the same cluster, distinguishing domains in homogeneous clusters from minority domains in clusters with a majority of domains of a different fold. As one can see in <xref ref-type="fig" rid="pcbi-1000331-g004">Figure 4B</xref>, the two distributions overlap quite considerably, but their median values are significantly different, which means that it may be possible to distinguish some minority domains and “clean” some clusters from them. This possible refinement of the clustering will be studied elsewhere.</p>
<p>Some examples of fold unification are represented in <xref ref-type="fig" rid="pcbi-1000331-g007">Figure 7</xref>. One such case involves SCOP folds Tim Beta/Alpha Barrel (51350) and 7-stranded beta/alpha barrel (51988). They correspond to two distinct CATH topologies with the same names as in SCOP. However, the distribution of domains in the two folds is not the same in SCOP and CATH. We split these two folds into seven clusters. Four clusters are pure for both SCOP and CATH, which agree in classifying them as TIM barrels, two clusters only contain 7-stranded barrels according to SCOP but all domains but one are classified as TIM barrels in CATH, and the last cluster contains, together with 12 TIM barrel domains, one domain, 1m65a_ that is considered 7-stranded in SCOP and TIM barrel in CATH. Visual inspection supports the 7-stranded classification, in agreement with SCOP, but the structure similarity inside the cluster is very high.</p>
<fig id="pcbi-1000331-g007" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000331.g007</object-id><label>Figure 7</label><caption>
<title>Examples of fold unifications.</title>
<p>(A) Domain 1o4wa_ from SCOP fold PIN domain-like and domain 1jmva_ from fold Adenine Nucleotide alpha Hydrolase-like. They have a nearly identical description in the SCOP database in terms of secondary structure elements. (B) The 7-stranded barrel with code 1m65a_ is unified to a cluster with 12 TIM barrel, one representative of which, with code 1j6oa_, is shown for comparison. (C) Unification of two domains from the SCOP folds STAT-like (PDB 1lvfa) and spectrin repeat-like (PDB 2e2aa).</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000331.g007" xlink:type="simple"/></fig>
<p>In another example, the automatic classification joins domains from the SCOP folds Spectrin repeat-like (46965, corresponding to CATH topology 12058) and STAT-like (47654, corresponding to CATH topology 1201050) in three different clusters. However CATH classifies domain 1lvfa_, which is STAT-like according to SCOP, in the Spectrin repeat-like fold, while a paper of the SCOP team reports that the SCOP release 1.53 changed the classification of domain 1br0 from spectrin repeat to STAT-like, showing that even experts can confound these two folds <xref ref-type="bibr" rid="pcbi.1000331-LoConte1">[46]</xref>. Visual inspection shows that the domains that we unify are indeed very similar.</p>
<p>The third example corresponds to two domains from SCOP folds PIN domain-like (PDB code 1o4wa_) and Adenine Nucleotide alpha Hydrolase-like (PDB 1jmva_), which are automatically classified in the same cluster. Besides a very high structure similarity, these folds have an almost identical description in the SCOP database (beta-sheet of 5 strands, order 32145).</p>
</sec><sec id="s2g4">
<title>Splitting of folds</title>
<p>Another possible disagreement happens when superfamilies that are joined together in the same SCOP fold or CATH topology are splitted in different clusters. This is very frequent: 55.5 percent of the domain pairs in the same SCOP fold but distinct superfamilies are separated. For CATH, this percentage raises to 89.2%. This is not likely to be an artifact of the automatic classification, since the automatic classification agrees with SCOP or CATH at the fold level better than they agree with each other, as discussed in next section. The transitivity analysis suggests that this happens because SCOP and CATH join superfamilies into folds at a similarity level for which transitivity violations are rather large, so that clustering is not justified and unique. At this similarity level different clustering algorithms yield radically different classifications. In contrast, the pairs of domains of the same superfamily that are separated in the automatic classification is significantly smaller, 32% for SCOP and 34% for CATH.</p>
</sec></sec><sec id="s2h">
<title>Analysis of Expert Classifications</title>
<sec id="s2h1">
<title>Comparison between SCOP and CATH</title>
<p>The expert classification schemes CATH and SCOP split proteins into domains differently. Domains in the CATH classification are typically smaller than those in the SCOP classification, with an average of 155 residues compared to 179 residues for SCOP domains (the standard deviations are 88 and 120 respectively). Comparison with a set of expert curated domain decompositions <xref ref-type="bibr" rid="pcbi.1000331-Islam1">[47]</xref> shows that SCOP undercuts domains, whereas CATH decompositions are usually in good agreement with experts <xref ref-type="bibr" rid="pcbi.1000331-Veretnik1">[48]</xref>. We used here 2890 domains similarly defined in both SCOP and CATH. For this consensus set, we measured the agreement between the SCOP and the CATH classification through the weighted kappa (see <xref ref-type="sec" rid="s4">Methods</xref>). The values found are reported in <xref ref-type="table" rid="pcbi-1000331-t003">Table 3</xref>, where the automatic classification is also shown for comparison.</p>
<table-wrap id="pcbi-1000331-t003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000331.t003</object-id><label>Table 3</label><caption>
<title>Comparison of the agreement between different classifications.</title>
</caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1000331-t003-3" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000331.t003" xlink:type="simple"/><table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">Superfam.</td>
<td align="left" colspan="1" rowspan="1">Folds</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" colspan="1" rowspan="1">SCOP vs. CATH</td>
<td align="left" colspan="1" rowspan="1">0.84</td>
<td align="left" colspan="1" rowspan="1">0.48</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">Automatic (AL) vs. SCOP</td>
<td align="left" colspan="1" rowspan="1">0.54</td>
<td align="left" colspan="1" rowspan="1">0.69</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">Automatic (AL) vs. CATH</td>
<td align="left" colspan="1" rowspan="1">0.58</td>
<td align="left" colspan="1" rowspan="1">0.32</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">AL (max) vs. SCOP</td>
<td align="left" colspan="1" rowspan="1">0.65</td>
<td align="left" colspan="1" rowspan="1">0.79</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">AL (max) vs. CATH</td>
<td align="left" colspan="1" rowspan="1">0.64</td>
<td align="left" colspan="1" rowspan="1">0.63</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">Automatic (SL) vs. SCOP</td>
<td align="left" colspan="1" rowspan="1">0.24</td>
<td align="left" colspan="1" rowspan="1">0.48</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">Automatic (SL) vs. CATH</td>
<td align="left" colspan="1" rowspan="1">0.28</td>
<td align="left" colspan="1" rowspan="1">0.70</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">SL (max) vs. SCOP</td>
<td align="left" colspan="1" rowspan="1">0.51</td>
<td align="left" colspan="1" rowspan="1">0.67</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">SL (max) vs. CATH</td>
<td align="left" colspan="1" rowspan="1">0.51</td>
<td align="left" colspan="1" rowspan="1">0.80</td>
</tr>
</tbody>
</table></alternatives><table-wrap-foot><fn id="nt103"><p>The agreement is evaluated through the weighted kappa parameter, Eq. (19). The first line compares superfamilies and folds from SCOP and CATH. In the two following lines, the automatic classification at the stop point obtained with average linkage (AL) is compared with SCOP and CATH, respectively, at the levels of superfamilies and folds. The two following lines compare the expert classifications with the AL classification at the points where their weighted kappa is maximum. The four last line are the same, but using as clustering algorithm single linkage (SL), which gives a much stronger agreement with CATH than with SCOP at the fold level, consistent with the fact that CATH uses single linkage.</p></fn></table-wrap-foot></table-wrap>
<p>There is rather good agreement, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e112" xlink:type="simple"/></inline-formula>, between CATH and SCOP at superfamily level. The 779 SCOP superfamilies become 885 with CATH (almost 14 percent more), but CATH superfamilies are larger, so that 26320 pairs of domains are in the same CATH superfamily versus 22937 for SCOP, of which 90 percent (i.e., 20695) are common.</p>
<p>The agreement with the average linkage clustering is significantly weaker. Around 68 percent and 66 percent of pairs in the same SCOP and CATH superfamily are in the same automatic cluster, since many superfamilies are split in the automatic classification.</p>
<p>In contrast, the agreement between CATH and SCOP at fold level is much poorer, with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e113" xlink:type="simple"/></inline-formula>. This suggests that the fold is more subjectively defined than the superfamily. The disagreement comes mainly from the fact that CATH joins many more pairs than SCOP at fold level: there are 3.9 times as many pairs classified as same fold and different superfamily by CATH than by SCOP (137608 versus 35428). More than 94 percent of the domain pairs defined by SCOP in the same fold are joined by CATH, but these commonly joined pairs represent only one third of the pairs in the same CATH topology.</p>
<p>Interestingly, at the fold level the similarity based clustering agrees with the two manual classifications better than they agree with each other, with maximum agreement <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e114" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e115" xlink:type="simple"/></inline-formula> for SCOP and CATH, respectively. At the cross-over point, the agreement between the automatic classification and SCOP is <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e116" xlink:type="simple"/></inline-formula>, much larger than with CATH <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e117" xlink:type="simple"/></inline-formula>.</p>
<p>If we perform the clustering using single linkage instead of average linkage, the agreement between the automatic clustering and CATH becomes much better (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e118" xlink:type="simple"/></inline-formula> at the maximum and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e119" xlink:type="simple"/></inline-formula> at the stop point), whereas the agreement with SCOP becomes much poorer. Indeed, CATH uses single linkage clustering, i.e., a new domain is joined to the cluster containing the most similar domain if similarity is above a threshold. This explains why CATH joins more pairs of domains than SCOP at the topology level.</p>
<p>If we compare the average linkage with the single linkage clustering as a function of the clustering step, we find that the single linkage joins many more pairs than the average linkage for the same number of clusters, as expected from the fact that it does not penalize the overunification. The weighted kappa between the two algorithms decreases as the clustering proceeds, as shown in Supporting <xref ref-type="supplementary-material" rid="pcbi.1000331.s003">Figure S3</xref>. The disagreement between the two classifications is already important before the cross-over point.</p>
<p>These findings shed light on the comparison between CATH and SCOP. Despite their good agreement at the level of superfamily, CATH and SCOP use different criteria for clustering superfamilies. They would nevertheless agree better if the clustering would be stopped at large similarity, where transitivity is approximately fulfilled. Therefore, the discrepancy between CATH and SCOP at fold level has two roots (besides the different in domain decompositions): (1) They use different clustering methods, a procedure effectively similar to average linkage for SCOP and single linkage for CATH. which yields a much larger number of pairs classified as the same fold, despite the number of folds is practically the same. (2) They push the clustering up to a low similarity level at which the two clustering methods diverge considerably.</p>
</sec><sec id="s2h2">
<title>Classification criteria may vary with time</title>
<p>Another possible source of subjectivity in the definition of the fold is the amount of biological knowledge that the expert curators use. To test the influence of this factor, we analyzed how SCOP folds and superfamilies changed through time. We labelled the age of a SCOP fold or superfamily through its SCOP index. Since the SCOP index depends on the secondary structure class, we normalized separately the index for different secondary structure classes, so that a value of 1 means that the index lies within the first 10% of its class and so on. We measured the mean similarity score for pairs of proteins in the same fold or superfamily. The MAMMOTH similarity score of related domains depends on their length. For superfamilies, we find that the average score depends on the average length of the superfamily, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e120" xlink:type="simple"/></inline-formula>, as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e121" xlink:type="simple"/></inline-formula>. Since the folds and superfamilies with index in the 7th and 8th interval are characterized by much longer domains (the average length is 270, compared with average lengths between 131 and 188 for all other intervals), we normalized the MAMMOTH similarity score dividing it by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e122" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e123" xlink:type="simple"/></inline-formula> is the average length in the cluster.</p>
<p>One can see from <xref ref-type="fig" rid="pcbi-1000331-g008">Figure 8</xref> that folds classified since longer time (smaller index) tend to be structurally more diverse. They also contain more domains and more superfamilies (data not shown). There are two possible interpretations of these findings. It is possible that some folds are intrinsically more diverse, and that they are more likely to be discovered and studied first, since they contain a larger number of proteins. But it is also possible that the greater biological knowledge available for older folds makes it easier to classify domains in these folds even in the absence of a large structure similarity.</p>
<fig id="pcbi-1000331-g008" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000331.g008</object-id><label>Figure 8</label><caption>
<title>Normalized structural similarity score of the program MAMMOTH (A) and standard deviation of domain length (B) versus the date of the oldest PDB file included in the SCOP fold.</title>
<p>Older folds appear to be significantly more structurally diverse, as assessed both through the MAMMOTH score and their length difference.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000331.g008" xlink:type="simple"/></fig>
<p>To distinguish between these two interpretations, we measured structure similarity within superfamilies, see <xref ref-type="fig" rid="pcbi-1000331-g008">Figure 8</xref>. Similar as for folds, older superfamilies contain more domains than the more recent ones (11.6±2.2 for the most ancient and 4.1±0.9 for the most recent index interval), but they are not more structurally diverse. This suggests that: (1) Ancient folds are structurally more diverse because they join superfamilies that are more diverse between each other but not within each other. Consistently, ancient folds contain more superfamilies: 3.7±0.8 for folds with the most ancient labels, less than 1.9±0.3 for SCOP labels above the third interval; (2) When there is sequence information to guide the classification, as in the case of superfamilies, the structural diversity remains stable with time, and it does not depend on the size of the superfamily, whereas it changes with time in the case of folds, for which no sequence information is used. This may suggest the existence of a bias to join new superfamilies to a fold known since long time even if the structure similarity is small.</p>
<p>Summarizing, the structure similarity within SCOP superfamilies remained stable through time, whereas the similarity of superfamilies classified into the same fold tends to be lower for ancient folds.</p>
</sec></sec><sec id="s2i">
<title>Beyond the Classification: Protein Similarity Network</title>
<p>The cross-over point of transitivity violations determines an intrinsic threshold beyond which protein similarity is better represented as a network rather than as a tree. Protein similarities have been previously represented as a network by other authors. Dokholyan et al. <xref ref-type="bibr" rid="pcbi.1000331-Dokholyan1">[45]</xref> generated the protein domain universe graph using as similarity measure the Z score of the structure alignment program Dali <xref ref-type="bibr" rid="pcbi.1000331-Holm2">[9]</xref>. They found out that, for proper thresholds, the network is scale-free, i.e., the number of links per node is power-law distributed. Performing single linkage clustering over this network, they obtained clusters whose size distribution is also a power-law, reminiscent of the distribution of protein domains per SCOP fold in a genome <xref ref-type="bibr" rid="pcbi.1000331-Gerstein1">[43]</xref>,<xref ref-type="bibr" rid="pcbi.1000331-Huynen1">[44]</xref>. Krishnadev et al. <xref ref-type="bibr" rid="pcbi.1000331-Krishnadev1">[49]</xref> performed a similar study for the similarity graph of protein chains instead of protein domains. They also found scale-free behavior at large enough similarity threshold. They used spectral analysis of the adjacency matrix to partition the graph into clusters.</p>
<p>In contrast to these previous approaches, the graph presented here is not a preliminary step for clustering, but it represents the significant similarity relationships for which clustering is not justified. These relationships not only allow to recover relationships present in expert classifications, such as splitted superfamilies and folds, but also allow to treat on the same ground the cross-fold relationships discussed by several authors, which go beyond expert classifications.</p>
<p>We construct the similarity network by connecting the clusters of the automatic classification that have significant structural similarity. As the similarity threshold is decreased, more and more clusters are connected. Pairs of clusters containing structures from a superfamily splitted in the automatic classification get unified in the network. We measured the probability that a pair of domains is joined in the network as a function of the similarity threshold, distinguishing pairs of domains from the same superfamily, from the same fold, or from different folds. (see <xref ref-type="fig" rid="pcbi-1000331-g009">Figure 9</xref>). Only for similarities as low as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e124" xlink:type="simple"/></inline-formula>, more than 90% of the domains in the same superfamily are joined. However, already for similarities <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e125" xlink:type="simple"/></inline-formula> the majority of the joined domains are from different folds. A reasonable threshold for significant structure similarity, mostly corresponding to pairs of different folds, seems to be <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e126" xlink:type="simple"/></inline-formula> between 3 and 4. Results presented here are obtained using <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e127" xlink:type="simple"/></inline-formula> as threshold for significant structure similarity.</p>
<fig id="pcbi-1000331-g009" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000331.g009</object-id><label>Figure 9</label><caption>
<title>For networks of clusters in the automatic classification joined with the similarity threshold represented in the horizontal axis, we plot in (A) the fraction of links joining clusters that contain two proteins from the same SCOP superfamily (a), the same SCOP fold (b), or different folds (c), respectively; in (B) we plot the probability that a link exists for a pair of clusters of type (a), (b), and (c).</title>
<p>In (A), we see that, for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e128" xlink:type="simple"/></inline-formula>, the majority of links are from clusters unrelated in SCOP.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000331.g009" xlink:type="simple"/></fig>
<p>A visual representation of such a network is shown in <xref ref-type="fig" rid="pcbi-1000331-g010">Figure 10B</xref>. One can see that almost all of the structure space is connected, but there is still some structure appearing. If we use a higher similarity threshold but still below the cross-over, such as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e129" xlink:type="simple"/></inline-formula>, the resulting network contains several linear motifs clearly expressing transitivity violations, with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e130" xlink:type="simple"/></inline-formula> connected to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e131" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e132" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e133" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e134" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e135" xlink:type="simple"/></inline-formula>, and so on, but without direct connection between <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e136" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e137" xlink:type="simple"/></inline-formula> or <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e138" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e139" xlink:type="simple"/></inline-formula>. For comparison, we also show in <xref ref-type="fig" rid="pcbi-1000331-g010">Figure 10A</xref> the network constructed joining clusters at high similarity before the cross-over point (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e140" xlink:type="simple"/></inline-formula>) using as threshold the cross-over similarity, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e141" xlink:type="simple"/></inline-formula>. This network presents many regions with high density of links, representing clusters that have still to be joined,</p>
<fig id="pcbi-1000331-g010" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000331.g010</object-id><label>Figure 10</label><caption>
<title>Networks of protein clusters similarities.</title>
<p>(A) High similarity clusters (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e142" xlink:type="simple"/></inline-formula>) linked using as a threshold the cross-over similarity, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e143" xlink:type="simple"/></inline-formula>. (B) Cross-over clusters (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e144" xlink:type="simple"/></inline-formula>) linked below the high transitivity regime, up to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e145" xlink:type="simple"/></inline-formula>.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000331.g010" xlink:type="simple"/></fig>
<p>In the context of network analysis, the transitive property studied in this paper is analogous to the clustering coefficient (see <xref ref-type="sec" rid="s4">Methods</xref>). Clustering coefficient equal one means that the network is transitive, i.e., if <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e146" xlink:type="simple"/></inline-formula> is connected with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e147" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e148" xlink:type="simple"/></inline-formula> is connected with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e149" xlink:type="simple"/></inline-formula>, also <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e150" xlink:type="simple"/></inline-formula> is connected with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e151" xlink:type="simple"/></inline-formula>. The high siilarity network obtained before the cross-over point has a high mean clustering coefficient equal to 0.69, which decreases to 0.36 for the network after the cross-over. In general, as one could expect, the clustering coefficient increases with the similarity threshold <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e152" xlink:type="simple"/></inline-formula> (see <xref ref-type="supplementary-material" rid="pcbi.1000331.s001">Figure S1</xref>). However this increase is smooth, so that we can not use the clustering coefficient to detect the cross-over point.</p>
<p>Interestingly, the network allows not only to recover similarity relationships at the superfamily and fold level that are below the threshold for clustering, but it may also help to discover new evolutionary or functional relationships that are not contained in SCOP or CATH. For instance, in a recent paper Xie and Bourne proposed a new method to detect remote evolutionary relationships based on the structure similarity of the active site <xref ref-type="bibr" rid="pcbi.1000331-Xie1">[50]</xref>. Using this method, they confirm a previously proposed evolutionary relationship between SCOP superamily Phosphoenolpyruvate carboxykinase (PCK) and the P loop containing nucleotide triphosphate hydrolase (NTH) superfamily. The PCK domain 1ayl_1 used as a seed by Xie and Bourne is joined in the automatic classification with domains 1knxa2 and 1ko7a2, which are classified in SCOP in the PCK superfamily but are classified in CATH in the NTH superfamily. The automatic classification supports the CATH classification. This cluster has a single significant structural link, with average similarity <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e153" xlink:type="simple"/></inline-formula>, with a cluster containing only domains classified in the NTH superfamily in both CATH and SCOP, and through this link another step connects it to many other clusters in the NTH superfamily or in the NTH fold. The relevant part of the network is represented in <xref ref-type="supplementary-material" rid="pcbi.1000331.s004">Figure S4</xref>, from which it is clear that the structurally consistent clusters joined in a network give a richer evolutionary information than a unique fold.</p>
<p>In order to complement structure information with sequence information, we constructed the network connecting clusters that have members belonging to the same superfamily. The networks based on sequence and structure similarity can be accessed at the url <ext-link ext-link-type="uri" xlink:href="http://ub.cbm.uam.es/research/ProtNet.php" xlink:type="simple">http://ub.cbm.uam.es/research/ProtNet.php</ext-link></p>
<sec id="s2i1">
<title>Transitivity violations and protein modularity</title>
<p>To investigate protein modularity, we studied the triangles that violate transitivity for a specific threshold <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e154" xlink:type="simple"/></inline-formula>, in the sense that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e155" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e156" xlink:type="simple"/></inline-formula>, but <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e157" xlink:type="simple"/></inline-formula>. For such triangles, we tested whether the regions of the intermediate structure <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e158" xlink:type="simple"/></inline-formula> having a good match with structures <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e159" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e160" xlink:type="simple"/></inline-formula> are the same or they are different, by measuring the overlap between these two regions as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e161" xlink:type="simple"/><label>(4)</label></disp-formula>where the initial and final residues of the matching regions are denoted as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e162" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e163" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e164" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e165" xlink:type="simple"/></inline-formula>, respectively. The value <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e166" xlink:type="simple"/></inline-formula> means that all three structures all share the same core over which they are similar. In contrast, the value <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e167" xlink:type="simple"/></inline-formula> means that the intermediate structure <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e168" xlink:type="simple"/></inline-formula> shares completely different fragments with structures <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e169" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e170" xlink:type="simple"/></inline-formula>. This is the most dangerous case for clustering algorithms, which can run the risk to join two structures that do not share any common region. One such example, with ASTRAL codes d1mt5a_, d1bif_1 and d1b3qa1, is shown in <xref ref-type="fig" rid="pcbi-1000331-g011">Figure 11</xref>.</p>
<fig id="pcbi-1000331-g011" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000331.g011</object-id><label>Figure 11</label><caption>
<title>Example of three domains that violate transitivity with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e171" xlink:type="simple"/></inline-formula>.</title>
<p>They are joined after the cross-over point in the network built using similarity threshold <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e172" xlink:type="simple"/></inline-formula>. The ASTRAL codes are d1mt5a_ (a), d1bif_1 (b) and 1b3qa1 (c). The bigger domain d1mt5a_ (red) links in the network the two smaller domains, which deviate considerably from each other as they don't share any significant part of structure between them. It holds <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e173" xlink:type="simple"/></inline-formula> (red and blue), <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e174" xlink:type="simple"/></inline-formula> (red and green) and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e175" xlink:type="simple"/></inline-formula> (blue and green), which violates transitivity.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000331.g011" xlink:type="simple"/></fig>
<p>The distribution of the fragment overlap <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e176" xlink:type="simple"/></inline-formula> is bimodal, with peaks at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e177" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e178" xlink:type="simple"/></inline-formula> (see <xref ref-type="fig" rid="pcbi-1000331-g012">Figure 12</xref>). However, triangles with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e179" xlink:type="simple"/></inline-formula> are very rare for large similarity <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e180" xlink:type="simple"/></inline-formula>, where they may correspond to errors in domain decompositions, whereas they become more frequent for similarities below the cross-over point.</p>
<fig id="pcbi-1000331-g012" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000331.g012</object-id><label>Figure 12</label><caption>
<title>For networks defined through the condition <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e181" xlink:type="simple"/></inline-formula>, with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e182" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e183" xlink:type="simple"/></inline-formula>, respectively, and for all triangles that violate the transitive property, i.e., <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e184" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e185" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e186" xlink:type="simple"/></inline-formula>, we measured the overlap <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e187" xlink:type="simple"/></inline-formula> between the two relevant matches of the intermediate structure <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e188" xlink:type="simple"/></inline-formula>, Eq. (4).</title>
<p>The peaks of the distribution at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e189" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e190" xlink:type="simple"/></inline-formula> correspond to matches over completely different and exactly the same region of protein <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e191" xlink:type="simple"/></inline-formula>, respectively.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000331.g012" xlink:type="simple"/></fig>
<p>Thus, beyond the cross-over point it is likely to find severe violations of transitivity in which two significant matches <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e192" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e193" xlink:type="simple"/></inline-formula> fall in two completely different regions of protein <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e194" xlink:type="simple"/></inline-formula>, consistent with the idea that transitivity violations and the consequent continuity of protein structure space stem from the modularity of proteins. These significant and disjoint partial matches offer a way to operatively define substructures below the domain level. A more detailed study of substructures based on their recurrence will be presented elsewhere.</p>
</sec></sec></sec><sec id="s3">
<title>Discussion</title>
<sec id="s3a">
<title>Transitivity Violations</title>
<p>As for all problems for which hierarchical clustering algorithms are applied, for clustering protein structures it is of key importance to determine up to which point the clustering is justified. We propose to test the internal consistency of a clustering method based on a similarity measure by testing the transitive property, which requires that whenever <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e195" xlink:type="simple"/></inline-formula> is similar to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e196" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e197" xlink:type="simple"/></inline-formula> is similar to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e198" xlink:type="simple"/></inline-formula>, then <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e199" xlink:type="simple"/></inline-formula> must be similar to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e200" xlink:type="simple"/></inline-formula>. Only if the transitive property holds a hierarchical classification can be unambiguously built. If the transitive property is violated for an extensive number of triangles, hierarchical clustering is frustrated <xref ref-type="bibr" rid="pcbi.1000331-Toulouse1">[38]</xref>, and we expect that there is a very large number of unrelated and almost optimal classifications, in each of which a similar number of similarity relationships are violated. We proposed here Eq. (1) to quantify the violations of transitivity of a group of three elements, and Eq. (2) to quantify the violation of transitivity when two clusters are joined.</p>
<p>Transitivity violations as defined here occur either when a pair of domains is joined below the similarity threshold, or when a pair is separated above the same threshold. Another definition, common in the context of sequence comparisons, considers that transitivity is violated only when pairs are separated above threshold. This definition is motivated by the fact that significant sequence similarity demonstrates almost certainly an evolutionary relationship, whereas the lack of similarity does not exclude it. With this definition, the single linkage algorithm does not produce any transitivity violation, since it joins all pairs above threshold. In fact, the term transitivity is often used as a synonymous of single linkage clustering.</p>
<p>Nevertheless, several reasons make the definition of transitivity adopted here more suitable in the context of structure classification. The first reason also applies to sequence comparisons, and it is based on protein modularity. If a domain <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e201" xlink:type="simple"/></inline-formula> is made of two fragments <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e202" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e203" xlink:type="simple"/></inline-formula>, with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e204" xlink:type="simple"/></inline-formula> similar to domain <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e205" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e206" xlink:type="simple"/></inline-formula> similar to domain <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e207" xlink:type="simple"/></inline-formula>, single linkage will infer a non existing relationship between <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e208" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e209" xlink:type="simple"/></inline-formula>. Indeed, for applying single linkage clustering to the triangle <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e210" xlink:type="simple"/></inline-formula>, one has to check whether the fragment overlap <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e211" xlink:type="simple"/></inline-formula>, Eq. (4), is also significant. Secondly, single linkage joins many structures that are not significantly similar, producing clusters that are not structurally consistent. These clusters may lack a common core, as it is often found applying multiple structure alignment algorithms to SCOP and even more CATH superfamilies. For the goal of modelling, it may not be convenient to join structurally dissimilar domains in the same fold, since this would increase the likelihood of selecting wrong templates. The study of structure evolution is made more difficult when structural variation is hidden inside a very diverse cluster, whereas well defined clusters connected by links expressing evolutionary relationships may represent a better framework for the study of structure divergence.</p>
</sec><sec id="s3b">
<title>Cross-Over from Discrete Sets to Continuous Space</title>
<p>We have observed that the transitivity violations grow while the clustering algorithm joins protein domains into clusters. Interestingly, in all instances that we studied we have found a cross-over between two regimes of slow and fast increase of transitivity violations.</p>
<list list-type="order"><list-item>
<p>At high similarity, transitivity violations grow slowly as the clustering algorithm proceeds, and domain size does not vary very much within a cluster. Clusters in this regime mostly correspond to subsets of SCOP superfamilies. Therefore, most domains in the same cluster are related through gene duplication and subsequent divergence, which justifies to classify related domains on a tree.</p>
</list-item><list-item>
<p>At low similarity, transitivity violations grow rapidly as the clustering algorithm proceeds, and domains in the same cluster differ substantially in size. Many pairs in the same cluster are related through partial substructures.</p>
</list-item></list>
<p>We propose that the cross-over in transitivity violations is an intrinsic point to stop the automatic classification. Lower similarity relationships should be represented as a network rather than a tree.</p>
</sec><sec id="s3c">
<title>Influence of the Methodology</title>
<p>The method that we presented requires several arbitrary choices. In order to test its robustness, and the influence of the parameters, we have studied at least two alternatives for each of these choices. Qualitatively similar results were obtained for several similarity scores computed on two different alignments obtained with a local and a global version of the MAMMOTH algorithm. Both alignment algorithms were developed at our group. We did not test whether alignments obtained with algorithms developed by other groups, such as DALI, yield different conclusions, as they might do.</p>
<p>In all cases that we tested, we have observed a cross-over in transitivity violations, finding that most of the clusters at the cross-over point correspond to subsets of SCOP or CATH superfamilies. However, the exact location of the cross-over point and the quality of the clustering, as assessed through the clustering coefficient and through the mean value of the transitivity violations, varies for different choices.</p>
<p>Although we do not aim at reproducing SCOP or CATH, which we believe is impossible, we recognize that these expert classifications have important merits. It is therefore noteworthy that the highest clustering coefficients and lowest transitivity violations tend to be associated with scores that are better compatible with SCOP or CATH classifications.</p>
<p>The first important choice is the structure alignment algorithm. Computationally, structure alignment is an NP-complete problem, and even if it were exactly solved different algorithms would differ, since they optimize different scores. We used two versions of the algorithm MAMMOTH that are quite different, since one optimizes local superimmposition of heptamers whereas the second one, MAMMOTH-mult, otpimizes the global structure superimposition, achieving alignments with better PSI and contact overlap. Despite this important difference, the results obtained with the two methods are rather similar.</p>
<p>The similarity measure used is probably the most relevant choice, and we tried several of them. We obtained better results with the contact overlap than with measures that score the optimal spatial superimposition of the two structures, which are used in the standard MAMMOTH score. We conjecture that the contact overlap is a better measure than the PSI for clustering protein structures because of three reasons: (1) It does not assume that there is an optimal rigid body superimposition between the two structures. In doing so, it implicitly allows for flexible superimpositions, which might be better suited for detecting evolutionary relationships <xref ref-type="bibr" rid="pcbi.1000331-Shatsky1">[51]</xref>–<xref ref-type="bibr" rid="pcbi.1000331-Mosca1">[54]</xref>. (2) It weights the residues in the core of the protein more than loop residues, since the former have a larger number of contacts. (3) The parameter it depends on, i.e., the threshold at which two residues are considered in contact, has a physical meaning in terms of interatomic interactions, and it is therefore less arbitrary than the tolerance parameter of the PSI, i.e., the threshold below which two residues are considered to be superimposed.</p>
<p>Similarity scores based on structure superimposition typically need a tolerance threshold to decide whether two residues superimpose. We tested the TM score <xref ref-type="bibr" rid="pcbi.1000331-Zhang1">[42]</xref>, which uses a length dependent threshold that makes this score almost independent of the size of the aligned proteins. The results obtained with this score are very similar to those obtained with the contact overlap. In contrast, the percentage of structure identity (PSI) adopts a fixed tolerance threshold, usually chosen as 4Å . To study the effect of this parameter, we repeated our numerical experiments with a more tolerant threshold of 6Å . Not surprisingly, the more tolerant similarity measure makes the space more continuous, decreasing the clustering coefficient and increasing the transitivity violations. Therefore, the cross-over from the discrete to the continuous regime occurs at higher similarity, which means that protein domains are splitted into a larger number of clusters. In this case as well, the cross-over is clear and the clusters at the cross-over are mainly subsets of superfamilies.</p>
<p>All measures, except the TM score, must be normalized in order to make them independent of the length of the aligned proteins. We implemented this through a length dependent Z score, as in the original MAMMOTH score. The drawback of the Z score is that not only it makes the similarity of unrelated proteins almost independent of length, but at the same time it reduces the similarity of related proteins with short length. In this way, the similarity of related proteins depend on their length and not on their evolutionary divergence, which makes the Z score an unsuitable measure for evolutionary analysis. This drawback does not occurr with the TM score, although this does not necessarily imply that it is a suitable measure for evolutionary analysis.</p>
<p>Last, we have to decide which clustering algorithm we use. If we adopt the definition of transitivity proposed in the present work, the average linkage algorithm has to be preferred over both single linkage and complete linkage. In fact, average linkage reduces the combination of splitting and overunification errors, whereas single linkage only eliminates splitting errors, since it joins all pairs above the similarity threshold, and the complete linkage eliminates overunification errors, since it separates all structures that are below the similarity threshold. Interestingly, from our analysis it turns out that the main difference between SCOP and CATH is that the latter uses single linkage, while the former uses some procedure effectively similar to average linkage.</p>
<p>As a last remark, we note that there is some analogy between our method, which uses transitivity violations to detect the point at which hierarchical clustering is not justified, and the bootstrap method that scores the significance of each cluster in a tree. Nevertheless, there are also important differences. Besides the fact that bootstrap is computationally much more cumbersome than our method, for obtaining a classification with the bootstrap method we would have to fix a threshold bootstrap probability to accept one cluster, whereas the cross-over that we obtain with our method arises in a natural way without fixing an arbitrary threshold.</p>
</sec><sec id="s3d">
<title>Perspectives for the Automatic Classification of Proteins</title>
<p>The existence of two regimes of transitivity violations, and the fact that the automatic classification at the cross-over point mostly consists of sets of SCOP or CATH superfamilies are the main results of this work. They are robust with respect to changes in the clustering algorithm, the similarity measure, the set of protein domains that we automatically classify, and the accuracy of the alignment algorithm. These results suggest that it is possible to automatically and objectively define an equivalence class for protein domains up to the similarity corresponding to the cross-over point.</p>
<p>Clusters in the automatic classification are structurally more consistent than SCOP folds or CATH topologies, mainly because of two reasons. (1) In the automatic classification, almost 15 percent of superfamilies are split into structurally divergent clusters, indicating that there can be important structural changes in protein evolution <xref ref-type="bibr" rid="pcbi.1000331-Grishin1">[32]</xref>,<xref ref-type="bibr" rid="pcbi.1000331-Krishna1">[33]</xref>,<xref ref-type="bibr" rid="pcbi.1000331-Viksna1">[36]</xref>. Interestingly, domains in split superfamilies tend to have larger size difference between each other, suggesting that insertions and deletions play an important role for structural divergence, consistent with recent analysis <xref ref-type="bibr" rid="pcbi.1000331-Reeves1">[55]</xref>,<xref ref-type="bibr" rid="pcbi.1000331-Jiang1">[56]</xref>. (2) Only 44 percent of the pairs of domains in different SCOP superfamilies and the same SCOP fold are joined in the automatic classification. This percentage becomes much smaller for CATH (less than 11 percent), whereas 68 and 66 percent of the pairs in the same SCOP or CATH superfamily are joined in the automatic classification The similarity between most of the pairs that are not joined is significant, but it is at the level where transitivity violations are large and a network fits the data better than a classification. Our analysis thus suggests that CATH and SCOP classify proteins up to similarities that are below the cross-over of transitivity violations. The same is possibly true for the automatic FSSP classification as well, where proteins are classified in the same fold if the Z score of their similarity is above 2. This is the smallest threshold at which the structures compared are significantly related. Here we also use a Z score, but we find that the cross-over point is at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e212" xlink:type="simple"/></inline-formula> implying that the transitive property is severely violated at the similarity level <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e213" xlink:type="simple"/></inline-formula>.</p>
<p>An indication that the fold defined in expert classification may not correspond to an intrinsic similarity level is that CATH and SCOP neatly agree at the level of superfamily, as assessed through the weighted kappa measure, but they disagree between each other at the level of fold even more than they disagree with the automatic classification, when the proper clustering algorithm is used. Indeed, the main difference between SCOP and CATH at fold level is that SCOP uses a procedure effectively similar to the average linkage algorithm, whereas CATH uses the single linkage algorithm, which does not penalize the joining of structurally distinct domains, resulting in clusters that are structurally very diverse.</p>
<p>Furthermore, we have shown that the structural diversity within a SCOP fold is larger if the fold was defined since longer time, suggesting that the criteria underlying the definition of fold may change through time. Classifications are very useful, but the present analysis supports the view that the low similarities at the fold level are better represented as a network rather than as a tree.</p>
</sec><sec id="s3e">
<title>Possible Improvements of the Automatic Classification</title>
<p>The comparison between the automatic and the expert classifications also indicates that the automatic classification can be improved along three lines.</p>
<p>First, in the present study we considered protein domains as defined in the SCOP and CATH classifications. However, proteins are split into domains in the two schemes in a rather different way. In particular, some domains defined in the SCOP classification appear by visual inspection to consist of more than one domain. An incomplete domain partition can be an important source of transitivity violations and consequent errors in an automatic classification of protein structures. We are developing a new automatic method for decomposing proteins into domains based on their recurrence in a database of unrelated structures, similar to the method proposed by Holm and Sanders <xref ref-type="bibr" rid="pcbi.1000331-Holm3">[57]</xref>. The domains obtained in this way will be subject to further decomposition based on their structure, to obtain a set of domains to which we will apply our clustering procedure.</p>
<p>Secondly, our method tends to split superfamilies constituted of short domains. Some of these splitting appear to be due to the dependency of the similarity score on the protein length. The raw similarity score, either PSI or contact overlap, is transformed into a Z score in order to reduce as much as possible the dependency of the score of unrelated structures on their size. Our results show that the classification deteriorates if this normalization is not properly performed. However, due to this normalization the similarity score corresponding to identical structures decreases for decreasing domain size, which makes it more difficult to cluster together short proteins. In order to overcome this problem, it would be very helpful to define a similarity score that is independent of domain size both for unrelated and for closely related structures. This will be presented in a forthcoming work.</p>
<p>Third, we found 63 over 779 clusters that contain protein domains defined by SCOP curators as different folds (although 27 of these clusters are homogeneous in terms of CATH topologies). The distribution of structure similarity suggests that several of the foreign domains appearing in clusters that are mostly from another fold are characterized by low mean similarity, and that it could be possible to “clean” the clusters of the automatic classification. Preliminary results indicates that this strategy is promising.</p>
</sec><sec id="s3f">
<title>Protein Domain Networks</title>
<p>Significant sequence or structure similarity below the threshold for clustering <xref ref-type="bibr" rid="pcbi.1000331-Harrison1">[14]</xref>,<xref ref-type="bibr" rid="pcbi.1000331-Friedberg1">[15]</xref> constitutes a very valuable information for evolutionary or functional studies. In the CASP and SCOP database, these significant cross-fold similarities are not available. We present this information in the form of two networks with structure-based and sequence-based links between the clusters of the automatic classification. In this way, we can recover not only superfamily and fold relationships that are not present in the automatic classification, but also new relationships that are not reported in expert classifications.</p>
</sec><sec id="s3g">
<title>Two Modes of Protein Evolution?</title>
<p>As a concluding remark, we note that the two regimes of transitivity violations that we found can be related with two modes of protein domain evolution. In the regime of large structure similarity, transitivity violations are small, related domains are similar in size, and 95 percent of them contain domains from a single CATH or SCOP fold, whereas 86 percent contain evolutionarily related domains from the same superfamily. These results indicate that most of the domains with structure similarity above the cross-over are evolutionarily related through gene duplication and divergent evolution. Moreover, domains in different superfamilies but same fold can not be excluded to be evolutionarily related, and some careful studies have been able to demonstrate this common origin also in the absence of a clear signal from sequence similarity, as in the case of the study of TIM-barrels conducted by Nagano et al. <xref ref-type="bibr" rid="pcbi.1000331-Nagano1">[58]</xref>. This view also agrees with the results by Deeds et al. <xref ref-type="bibr" rid="pcbi.1000331-Deeds1">[59]</xref>, who tested models of convergent and divergent evolution using statistical properties of protein structural clusters, finding that the data support divergent evolution <xref ref-type="bibr" rid="pcbi.1000331-Goldstein1">[60]</xref>. We summarize these findings saying that, for large similarity, protein domain evolution is mostly uniparental.</p>
<p>On the other hand, similarities below the cross-over of transitivity violations are often due to partial substructures, and the typical size difference between related domains raises from 20 to 40 residues, indicating the occurrence of large insertions and deletions when the related domains belong to the same superfamily. These are clues of multi-parental evolution, proceeding through the assembly of new polypeptide fragments. This hypothetical mechanism has been proposed by Lupas et al. for the evolution of early protein domains through assembly of small peptide fragments <xref ref-type="bibr" rid="pcbi.1000331-Lupas1">[28]</xref>. Our findings suggest that it can also be extended to more recent evolution, consistent with another recent study <xref ref-type="bibr" rid="pcbi.1000331-Friedberg1">[15]</xref>. In this regime the domain structure space should be regarded as continuous, and significant structure similarity should be described as a network rather than a tree.</p>
<p>These considerations parallel recent considerations about the classification of organisms on the tree of life <xref ref-type="bibr" rid="pcbi.1000331-Doolittle1">[61]</xref>. Speciation and evolutionary divergence generate a tree of species, which can be reconstructed by estimating the time of divergence from the molecular sequences of their genes. In order to do this, one has to use a proper sequence distance, approximately ultrametric, which makes species classification possible on a rigorous basis. Nevertheless, this view of the tree of life has been recently challenged by the discovery of the high rate of horizontal gene transfer in genome evolution. Due to horizontal gene transfer, genome evolution is multiparental, and genes that have been subject to gene transfer can not be used to reconstruct the phylogenetic tree. The extensive presence of horizontal gene transfer in evolution has led Doolittle to propose that the evolutionary relationships between organisms should be regarded as a net of life rather than a tree <xref ref-type="bibr" rid="pcbi.1000331-Doolittle1">[61]</xref>. The present work suggests that, in the context of protein domain evolution, a tree scenario of uniparental divergent evolution is suitable to represent high similarity relationships, but a pluriparental network emerges for more remote relationships.</p>
</sec></sec><sec id="s4">
<title>Methods</title>
<sec id="s4a">
<title>Datasets</title>
<p>We have used two non redundant sets of protein domains. The first set was obtained from the ASTRAL 40 database, in which no pair has sequence similarity larger than 40%. We used the SCOP version 1.65 and selected only domains from the four main SCOP classes, all <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e214" xlink:type="simple"/></inline-formula>, all <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e215" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e216" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e217" xlink:type="simple"/></inline-formula>. The second set is the non redundant set of domains from the CATH classification, with sequence similarity smaller than 35%. Also in this case we excluded domains outside the four main classes. The final number of domains was 5041 for the SCOP set and 7073 for the CATH set.</p>
</sec><sec id="s4b">
<title>Consensus Set between CATH and SCOP</title>
<p>In order to select a set of domains consistently defined in SCOP and CATH, we aligned with BLAST <xref ref-type="bibr" rid="pcbi.1000331-Altschul1">[62]</xref> the sequences of domains in the non redundant ASTRAL40 database against domains in the non redundant CATH database at 35% sequence identity. We identified two domains to be equivalent if their BLAST evalue was smaller than 10<sup>−3</sup>, with sequence identity larger than 75%, and their size differed by less than 10%. In this way we have obtained a set of 2890 non redundant domains classified in 779 SCOP superfamilies, 466 SCOP folds, 885 CATH superfamilies and 473 CATH topologies.</p>
</sec><sec id="s4c">
<title>Similarity Scores</title>
<p>We performed pairwise structure alignments using either the program MAMMOTH <xref ref-type="bibr" rid="pcbi.1000331-Ortiz1">[41]</xref>, which is the fastest program of protein structure alignment that we know, or its multiple alignment version MAMMOTHmult <xref ref-type="bibr" rid="pcbi.1000331-Lupyan1">[39]</xref>, which is a bit slower but much more accurate.</p>
<p>The MAMMOTH similarity score is based on the number of aligned residues that are closer than 4Å after optimal spatial superimposition of structures <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e218" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e219" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e220" xlink:type="simple"/></inline-formula>. This is transformed into a percentage of structure identity (PSI) dividing it by the length of the shortest structure,<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e221" xlink:type="simple"/><label>(5)</label></disp-formula></p>
<p><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e222" xlink:type="simple"/></inline-formula> equals one if the two structures coincide over the length of the shorter one. There is no penalization for additional residues in the longer structure, i.e., the score is sensitive to good partial matches and we call it partial PSI. However, the fact that the score does not penalize inserted regions may lead to join domains with very large length difference. To tackle this problem, we also defined the total similarity score, which penalizes regions in the larger structure that are not matched by the short one:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e223" xlink:type="simple"/><label>(6)</label></disp-formula><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e224" xlink:type="simple"/></inline-formula> equals one only if the match completely covers the longer protein.</p>
<p>Third, we adopted the contact overlap, which counts the fraction of contacts in common between two aligned structures <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e225" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e226" xlink:type="simple"/></inline-formula>. Also this score is normalized in such a way to penalize partial matches. We defined the contact matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e227" xlink:type="simple"/></inline-formula> of protein <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e228" xlink:type="simple"/></inline-formula> such that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e229" xlink:type="simple"/></inline-formula> equals one if two heavy atoms of residues <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e230" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e231" xlink:type="simple"/></inline-formula> are closer than 4.5Å and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e232" xlink:type="simple"/></inline-formula>, and zero otherwise. We considered two cases, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e233" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e234" xlink:type="simple"/></inline-formula>. In this last case, intrahelical contacts are not considered. Denoting by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e235" xlink:type="simple"/></inline-formula> the residue in structure <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e236" xlink:type="simple"/></inline-formula> aligned with residue <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e237" xlink:type="simple"/></inline-formula> in structure <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e238" xlink:type="simple"/></inline-formula>, the contact overlap can be written as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e239" xlink:type="simple"/><label>(7)</label></disp-formula></p>
<p>The main qualitative difference between the contact overlap and the PSI is that in the contact overlap superimposed residues in the core of the protein, which form many contacts, receive a larger weight.</p>
<p>It is crucial for protein structure classification that the distribution of the similarity score used is almost independent of the length for comparisons of unrelated proteins. The MAMMOTH score takes care of this by normalizing the PSI in such a way that the distribution of the normalized PSI is almost independent of size for unrelated pairs:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e240" xlink:type="simple"/><label>(8)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e241" xlink:type="simple"/></inline-formula> in the case of the partial PSI, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e242" xlink:type="simple"/></inline-formula> in the case of the total PSI. In the case of the overlap, we also used <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e243" xlink:type="simple"/></inline-formula> as a normalization. The exponents <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e244" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e245" xlink:type="simple"/></inline-formula> depend on the raw similarity score and on the alignment algorithm used, and they were determined by fitting the mean and standard deviation of the PSI of unrelated structures having <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e246" xlink:type="simple"/></inline-formula> in some given interval, using the best fit between a Gaussian fit or an Extreme Value statistics fit (see <xref ref-type="table" rid="pcbi-1000331-t004">Table 4</xref>).</p>
<table-wrap id="pcbi-1000331-t004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000331.t004</object-id><label>Table 4</label><caption>
<title>Size normalization of similarity scores.</title>
</caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1000331-t004-4" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000331.t004" xlink:type="simple"/><table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" colspan="1" rowspan="1">Score</td>
<td align="left" colspan="1" rowspan="1">Normalization</td>
<td align="left" colspan="1" rowspan="1">Alignment</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e247" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e248" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e249" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e250" xlink:type="simple"/></inline-formula></td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" colspan="1" rowspan="1">PSI partial</td>
<td align="left" colspan="1" rowspan="1">EV</td>
<td align="left" colspan="1" rowspan="1">Pair</td>
<td align="left" colspan="1" rowspan="1">5.97</td>
<td align="left" colspan="1" rowspan="1">0.720</td>
<td align="left" colspan="1" rowspan="1">0.920</td>
<td align="left" colspan="1" rowspan="1">0.634</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">PSI partial</td>
<td align="left" colspan="1" rowspan="1">EV</td>
<td align="left" colspan="1" rowspan="1">Mult</td>
<td align="left" colspan="1" rowspan="1">5.73</td>
<td align="left" colspan="1" rowspan="1">0.714</td>
<td align="left" colspan="1" rowspan="1">0.860</td>
<td align="left" colspan="1" rowspan="1">0.622</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">PSI total</td>
<td align="left" colspan="1" rowspan="1">EV</td>
<td align="left" colspan="1" rowspan="1">Pair</td>
<td align="left" colspan="1" rowspan="1">6.48</td>
<td align="left" colspan="1" rowspan="1">0.722</td>
<td align="left" colspan="1" rowspan="1">0.972</td>
<td align="left" colspan="1" rowspan="1">0.662</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">PSI total</td>
<td align="left" colspan="1" rowspan="1">EV</td>
<td align="left" colspan="1" rowspan="1">Mult</td>
<td align="left" colspan="1" rowspan="1">5.62</td>
<td align="left" colspan="1" rowspan="1">0.729</td>
<td align="left" colspan="1" rowspan="1">0.961</td>
<td align="left" colspan="1" rowspan="1">0.659</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">Overlap</td>
<td align="left" colspan="1" rowspan="1">Gauss</td>
<td align="left" colspan="1" rowspan="1">Pair</td>
<td align="left" colspan="1" rowspan="1">0.375</td>
<td align="left" colspan="1" rowspan="1">0.535</td>
<td align="left" colspan="1" rowspan="1">1.340</td>
<td align="left" colspan="1" rowspan="1">0.676</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">Overlap</td>
<td align="left" colspan="1" rowspan="1">Gauss</td>
<td align="left" colspan="1" rowspan="1">Mult</td>
<td align="left" colspan="1" rowspan="1">0.752</td>
<td align="left" colspan="1" rowspan="1">0.576</td>
<td align="left" colspan="1" rowspan="1">1.874</td>
<td align="left" colspan="1" rowspan="1">0.773</td>
</tr>
</tbody>
</table></alternatives><table-wrap-foot><fn id="nt104"><p>The reported parameters were used to normalize the raw scores according to Eq. (8).</p></fn></table-wrap-foot></table-wrap>
<p>Using Gaussian statistics, we fit<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e251" xlink:type="simple"/><label>(9)</label></disp-formula>and using Extreme Value statistics, we fit<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e252" xlink:type="simple"/><label>(10)</label></disp-formula></p>
<p>The domain similarity score of domain <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e253" xlink:type="simple"/></inline-formula> in cluster A is defined as the average pairwise similarity between domain <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e254" xlink:type="simple"/></inline-formula> and all other domains in the cluster,<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e255" xlink:type="simple"/><label>(11)</label></disp-formula></p>
</sec><sec id="s4d">
<title>Clustering Algorithms</title>
<p>We programmed and tested three hierarchical clustering algorithms: average linkage <xref ref-type="bibr" rid="pcbi.1000331-Sokal1">[63]</xref>, single linkage and complete linkage. Starting from each element being a separate cluster, at each step <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e256" xlink:type="simple"/></inline-formula> all algorithms join the two most similar clusters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e257" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e258" xlink:type="simple"/></inline-formula>, and compute the similarity between the new combined cluster and all other clusters in a way that depends on the clustering algorithm.</p>
<p>With <bold>average linkage</bold>, the combined similarity is computed as the average similarity with the two joined clusters,<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e259" xlink:type="simple"/><label>(12)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e260" xlink:type="simple"/></inline-formula> labels the step of the algorithm, A and B are the clusters that are joined, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e261" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e262" xlink:type="simple"/></inline-formula> is the number of elements they contain, AB denotes the new composite cluster, and C is any other cluster. Note that this updating rule is equivalent to computing the new similarity score as the average between the similarity between all pairs of elements from the cluster C and the cluster AB.</p>
<p>With <bold>single linkage</bold>, the combined similarity is the largest similarity in the set, so that two sets are joined if at least one pair of elements is above threshold<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e263" xlink:type="simple"/><label>(13)</label></disp-formula></p>
<p>With <bold>complete linkage</bold>, the combined similarity is the smallest similarity in the set, so that two sets are joined if all pairs of elements are above threshold<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e264" xlink:type="simple"/><label>(14)</label></disp-formula></p>
</sec><sec id="s4e">
<title>Ultrametricity</title>
<p>An ultrametric set is a set <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e265" xlink:type="simple"/></inline-formula> with an associated distance measure <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e266" xlink:type="simple"/></inline-formula> where every triplet of points <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e267" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e268" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e269" xlink:type="simple"/></inline-formula> fulfils a property stronger than the ordinary triangular inequality: each side of a triangle is smaller than the larger between the other two sides, i.e., <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e270" xlink:type="simple"/></inline-formula>. This implies that the two longer sides must be equal. In particular, for an ultrametric set and for every threshold <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e271" xlink:type="simple"/></inline-formula>, it holds that if <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e272" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e273" xlink:type="simple"/></inline-formula>, then <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e274" xlink:type="simple"/></inline-formula>. Consider now the cluster containing all elements within a distance <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e275" xlink:type="simple"/></inline-formula> from element <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e276" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e277" xlink:type="simple"/></inline-formula>. It is easy to see that, for every pair of points <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e278" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e279" xlink:type="simple"/></inline-formula>, either <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e280" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e281" xlink:type="simple"/></inline-formula> coincide, or they do not share any point. Therefore, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e282" xlink:type="simple"/></inline-formula> is an equivalence relationship, since if <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e283" xlink:type="simple"/></inline-formula> then it must also be <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e284" xlink:type="simple"/></inline-formula>, and the set of points can be considered discrete.</p>
</sec><sec id="s4f">
<title>Clustering Coefficient</title>
<p>A concept related to transitivity in the context of networks is the clustering coefficient, which can be computed through the formula<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e285" xlink:type="simple"/><label>(15)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e286" xlink:type="simple"/></inline-formula> is the number of nodes in the network, labelled as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e287" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e288" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e289" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e290" xlink:type="simple"/></inline-formula> is the adjacency matrix (one if <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e291" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e292" xlink:type="simple"/></inline-formula> are joined, zero otherwise), <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e293" xlink:type="simple"/></inline-formula> is the number of neighbors of node <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e294" xlink:type="simple"/></inline-formula>, and the clustering coefficient of node <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e295" xlink:type="simple"/></inline-formula> is the fraction of pairs of its neighbors <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e296" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e297" xlink:type="simple"/></inline-formula> that are neighbors between each other. If the clustering coefficient is one for all nodes, connections on the network define an equivalence relationship.</p>
<p>We have computed the clustering coefficient for the network obtained by joining domains with similarity <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e298" xlink:type="simple"/></inline-formula>, for various values of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e299" xlink:type="simple"/></inline-formula>. To compare different similarity measures, we have plotted the clustering coefficient versus the number of clusters obtained through single linkage clustering with the same threshold <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e300" xlink:type="simple"/></inline-formula>.</p>
</sec><sec id="s4g">
<title>Detecting the Cross-Over Point</title>
<p>For detecting the cross-over point of transitivity violations (TV), we first measure TV at each step of the clustering algorithm using Eq. (2). We then perform two-pieces exponential fits of TV versus the step <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e301" xlink:type="simple"/></inline-formula>, as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e302" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e303" xlink:type="simple"/></inline-formula> is zero for negative <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e304" xlink:type="simple"/></inline-formula> and one otherwise. Fits are performed for all possible cross-over points <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e305" xlink:type="simple"/></inline-formula>, and their quadratic error is measured as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e306" xlink:type="simple"/><label>(16)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e307" xlink:type="simple"/></inline-formula> is the mean value of TV. To find the optimum <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e308" xlink:type="simple"/></inline-formula> in a robust way, we perform a cubic fit of the error function in an interval <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e309" xlink:type="simple"/></inline-formula> centered around the step <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e310" xlink:type="simple"/></inline-formula> yielding the minimum error, and such that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e311" xlink:type="simple"/></inline-formula> for all <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e312" xlink:type="simple"/></inline-formula>. The analytic minimum of this cubic fitting is then selected as the best first estimate of the cross-over point.</p>
<p>The last points in the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e313" xlink:type="simple"/></inline-formula> curve, where the transitivity violations approach the maximum possible value, are very badly fitted through the two-pieces fit. Therefore, we refined the estimate of the cross-over point by removing the outliers of the optimal fit, with the conditions that a point is removed if its residual with respect to the optimal fit is more than three times larger than the median, which is the condition used to define type-1 outliers. We then apply the procedure described above to the reduced set of points, and we determine the cross-over point at which the clustering is stopped.</p>
</sec><sec id="s4h">
<title>Weighted Kappa</title>
<p>We assessed the agreement of two classifications through the weighted kappa measure <xref ref-type="bibr" rid="pcbi.1000331-Cohen1">[64]</xref>, which uses as reference the expected agreement for two independent classifications with the same number of relationships. We define <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e314" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e315" xlink:type="simple"/></inline-formula>) the number of related pairs in classification <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e316" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e317" xlink:type="simple"/></inline-formula>) of the same <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e318" xlink:type="simple"/></inline-formula> objects, with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e319" xlink:type="simple"/></inline-formula> pairs in total. If <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e320" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e321" xlink:type="simple"/></inline-formula> are independent, the number of pairs that are either related or unrelated in both <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e322" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e323" xlink:type="simple"/></inline-formula> is given by<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e324" xlink:type="simple"/><label>(17)</label></disp-formula></p>
<p>We compare this number to the observed number of pairs that agree,<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e325" xlink:type="simple"/><label>(18)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e326" xlink:type="simple"/></inline-formula> is the number of pairs that are related in both classifications. &gt;From this number, the weighted kappa is computed as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e327" xlink:type="simple"/><label>(19)</label></disp-formula></p>
<p>A value of zero means that two classifications are as related as independent classifications, one means that the two classifications coincide. Using the weighted kappa, we have compared the classification obtained at every step of the clustering algorithm with the manual classifications of CATH and SCOP at the superfamily and the fold level.</p>
<p>Notice that the weighted kappa can be decomposed into the contributions of related and unrelated pairs as follows:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e328" xlink:type="simple"/><label>(20)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e329" xlink:type="simple"/></inline-formula> is the number of pairs related in both classifications expected by random, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e330" xlink:type="simple"/></inline-formula>, and the weights are <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e331" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e332" xlink:type="simple"/></inline-formula> for related and unrelated pairs, respectively.</p>
</sec><sec id="s4i">
<title>Network Analysis</title>
<p>For the sake of illustration, we have represented two domain similarity networks obtained before and beyond the stopping point of the automatic classification.</p>
<p>Two networks were constructed by considering each cluster as a node, and connecting nodes with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e333" xlink:type="simple"/></inline-formula>. In the first case, we used clusters obtained before the cross-over point of the average linkage algorithm using a high similarity threshold <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e334" xlink:type="simple"/></inline-formula>, and we connected them if <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e335" xlink:type="simple"/></inline-formula>, which is the similarity at the cross-over point. In the second case we used clusters generated at the cross-over point and we connected them with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000331.e336" xlink:type="simple"/></inline-formula>. The networks have been visualized using the Pajek software <xref ref-type="bibr" rid="pcbi.1000331-Batagelj1">[65]</xref>.</p>
</sec><sec id="s4j">
<title>Other Methods</title>
<p>To visualize spatial superimpositions, we used the multiple structure allignments program MAMMOTHmult <xref ref-type="bibr" rid="pcbi.1000331-Lupyan1">[39]</xref> in combination with the Pymol software.</p>
</sec></sec><sec id="s5">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1000331.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000331.s001" xlink:type="simple"><label>Figure S1</label><caption>
<p>Clustering coefficient for three different similarity measures. The clustering coefficient is computed for networks in which domains with similarity above S<sub>0</sub> are connected, and it is plotted as a function of the number of clusters obtained with single linkage clustering of the same network.</p>
<p>(0.02 MB PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000331.s002" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000331.s002" xlink:type="simple"><label>Figure S2</label><caption>
<p>Transitivity violations versus the step of the clustering algorithm for three different clustering algorithms. The smallest violations are obtained with the average linkage algorithm.</p>
<p>(0.19 MB PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000331.s003" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000331.s003" xlink:type="simple"><label>Figure S3</label><caption>
<p>Agreement between the classifications obtained with different clustering algorithms at the same step. The best agreement is between single linkage and complete linkage.</p>
<p>(0.05 MB PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000331.s004" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000331.s004" xlink:type="simple"><label>Figure S4</label><caption>
<p>Network of protein clusters joining superfamilies NTH and PCK. Xie and Bourne confirmed a previously proposed evolutionary relationship between a member of SCOP superamily Phosphoenolpyruvate carboxykinase (PCK), with code 1ayl_1, and the P loop containing nucleotide triphosphate hydrolase (NTH) superfamily. PCK domain 1ayl_1 is joined in the automatic classification with domains 1knxa2 and 1ko7a2, which are classified in SCOP in the PCK superfamily but are classified in CATH in the NTH superfamily. The automatic classification supports the CATH classification. This cluster has a single significant structural link, with average similarity <italic>S</italic> = 5.0, with an cluster containing only domains classified in the NTH superfamily in both CATH and SCOP, and through this cluster another step connects it to many other clusters in the NTH superfamily or in the NTH fold. Here we represent the relevant part of the network. The hybrid cluster containing domain 1ayl_1 is close to the upper left corner. Links denote significant structure similarity between clusters (<italic>S</italic>&gt;4.0), and they are coloured red if the two joined clusters contain domains in the same superfamily according to both SCOP and CATH, green if they are in the same superfamily only according to CATH, blue if they are in the same fold according to either SCOP or CATH, and black if there is no pair in the same fold. The figure supports the view that the structurally consistent clusters joined in a network give a richer evolutionary information than a unique and structrally diverse fold.</p>
<p>(0.02 MB PDF)</p>
</caption></supplementary-material></sec></body>
<back>
<ack>
<p>This work is dedicated to the memory of Ángel Ramírez Ortiz, who proposed and directed its starting phase. We deeply mourn his loss as an advisor and a friend. We thank Ian Sillitoe and Christine Orengo for providing the data necessary to compare our classification with the CATH database. Useful discussions with Florian Teichert and Markus Porto are gratefully acknowledged. We also thank Enrique García de Bustos, who participated in a previous phase of this project.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1000331-Burley1"><label>1</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Burley</surname><given-names>SK</given-names></name>
<name name-style="western"><surname>Bonanno</surname><given-names>JB</given-names></name>
</person-group>             <year>2002</year>             <article-title>Structuring the universe of proteins Annu Rev of Genomics.</article-title>             <source>Hum Genet</source>             <volume>3</volume>             <fpage>243</fpage>             <lpage>262</lpage>          </element-citation></ref>
<ref id="pcbi.1000331-GoldsmithFischman1"><label>2</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Goldsmith-Fischman</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Honig</surname><given-names>B</given-names></name>
</person-group>             <year>2003</year>             <article-title>Structural genomics: computational methods for structure analysis.</article-title>             <source>Protein Sci</source>             <volume>12</volume>             <fpage>1813</fpage>             <lpage>1821</lpage>          </element-citation></ref>
<ref id="pcbi.1000331-Honig1"><label>3</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Honig</surname><given-names>B</given-names></name>
</person-group>             <year>2007</year>             <article-title>Protein structure space is much more than the sum of its folds.</article-title>             <source>Nat Struct Mol Biol</source>             <volume>14</volume>             <fpage>458</fpage>          </element-citation></ref>
<ref id="pcbi.1000331-Murzin1"><label>4</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Murzin</surname><given-names>AG</given-names></name>
<name name-style="western"><surname>Brenner</surname><given-names>SE</given-names></name>
<name name-style="western"><surname>Hubbard</surname><given-names>T</given-names></name>
<name name-style="western"><surname>Chothia</surname><given-names>C</given-names></name>
</person-group>             <year>1995</year>             <article-title>SCOP: a structural classification of proteins database for the investigation of sequences and structures.</article-title>             <source>J Mol Biol</source>             <volume>247</volume>             <fpage>536</fpage>             <lpage>540</lpage>          </element-citation></ref>
<ref id="pcbi.1000331-Orengo1"><label>5</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Orengo</surname><given-names>CA</given-names></name>
<name name-style="western"><surname>Michie</surname><given-names>AD</given-names></name>
<name name-style="western"><surname>Jones</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Jones</surname><given-names>DT</given-names></name>
<name name-style="western"><surname>Swindells</surname><given-names>MB</given-names></name>
<etal/></person-group>             <year>1997</year>             <article-title>CATH-a hierarchic classification of protein domain structures.</article-title>             <source>Structure</source>             <volume>5</volume>             <fpage>1093</fpage>             <lpage>1108</lpage>          </element-citation></ref>
<ref id="pcbi.1000331-Brenner1"><label>6</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Brenner</surname><given-names>SE</given-names></name>
<name name-style="western"><surname>Cothia</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Hubbard</surname><given-names>TJ</given-names></name>
</person-group>             <year>1997</year>             <article-title>Population statistics of protein structures: lessons from structural classifications.</article-title>             <source>Curr Opin Struct Biol</source>             <volume>7</volume>             <fpage>369</fpage>             <lpage>376</lpage>          </element-citation></ref>
<ref id="pcbi.1000331-Swindells1"><label>7</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Swindells</surname><given-names>MB</given-names></name>
<name name-style="western"><surname>Orengo</surname><given-names>CA</given-names></name>
<name name-style="western"><surname>Jones</surname><given-names>DT</given-names></name>
<name name-style="western"><surname>Hutchinson</surname><given-names>EG</given-names></name>
<name name-style="western"><surname>Thornton</surname><given-names>JM</given-names></name>
</person-group>             <year>1998</year>             <article-title>Contemporary approaches to protein structure classification.</article-title>             <source>Bioessays</source>             <volume>20</volume>             <fpage>884</fpage>             <lpage>891</lpage>          </element-citation></ref>
<ref id="pcbi.1000331-Holm1"><label>8</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Holm</surname><given-names>L</given-names></name>
<name name-style="western"><surname>Sander</surname><given-names>C</given-names></name>
</person-group>             <year>1998</year>             <article-title>Touring protein fold space with Dali/FSSP.</article-title>             <source>Nucleic Acids Res</source>             <volume>26</volume>             <fpage>316</fpage>             <lpage>319</lpage>          </element-citation></ref>
<ref id="pcbi.1000331-Holm2"><label>9</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Holm</surname><given-names>L</given-names></name>
<name name-style="western"><surname>Sander</surname><given-names>C</given-names></name>
</person-group>             <year>1993</year>             <article-title>Protein structure comparison by alignment of distance matrices.</article-title>             <source>J Mol Biol</source>             <volume>233</volume>             <fpage>123</fpage>             <lpage>138</lpage>          </element-citation></ref>
<ref id="pcbi.1000331-Hadley1"><label>10</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Hadley</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Jones</surname><given-names>D</given-names></name>
</person-group>             <year>1999</year>             <article-title>A systematic comparison of protein structure classifications: SCOP, CATH and FSSP.</article-title>             <source>Structure</source>             <volume>7</volume>             <fpage>1099</fpage>             <lpage>1112</lpage>          </element-citation></ref>
<ref id="pcbi.1000331-Getz1"><label>11</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Getz</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Vendruscolo</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Sachs</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Domany</surname><given-names>E</given-names></name>
</person-group>             <year>2002</year>             <article-title>Automated assignment of SCOP and CATH protein structure classifications from FSSP.</article-title>             <source>Proteins</source>             <volume>46</volume>             <fpage>405</fpage>             <lpage>415</lpage>          </element-citation></ref>
<ref id="pcbi.1000331-Day1"><label>12</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Day</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Beck</surname><given-names>DAC</given-names></name>
<name name-style="western"><surname>Armen</surname><given-names>RS</given-names></name>
<name name-style="western"><surname>Daggett</surname><given-names>V</given-names></name>
</person-group>             <year>2003</year>             <article-title>A consensus view of fold space: combining SCOP, CATH, and the Dali Domain Dictionary.</article-title>             <source>Protein Sci</source>             <volume>12</volume>             <fpage>2150</fpage>             <lpage>2160</lpage>          </element-citation></ref>
<ref id="pcbi.1000331-Sam1"><label>13</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Sam</surname><given-names>V</given-names></name>
<name name-style="western"><surname>Tai</surname><given-names>C-H</given-names></name>
<name name-style="western"><surname>Garnier</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Gibrat</surname><given-names>J-F</given-names></name>
<name name-style="western"><surname>Lee</surname><given-names>B</given-names></name>
<etal/></person-group>             <year>2006</year>             <article-title>ROC and confusion analysis of structure comparison methods identify the main causes of divergence from manual protein classification.</article-title>             <source>BMC Bioinformatics</source>             <volume>7</volume>             <fpage>206</fpage>          </element-citation></ref>
<ref id="pcbi.1000331-Harrison1"><label>14</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Harrison</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Pearl</surname><given-names>F</given-names></name>
<name name-style="western"><surname>Mott</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Thornton</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Orengo</surname><given-names>C</given-names></name>
</person-group>             <year>2002</year>             <article-title>Quantifying the similarity within fold space.</article-title>             <source>J Mol Biol</source>             <volume>323</volume>             <fpage>909</fpage>             <lpage>926</lpage>          </element-citation></ref>
<ref id="pcbi.1000331-Friedberg1"><label>15</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Friedberg</surname><given-names>I</given-names></name>
<name name-style="western"><surname>Godzik</surname><given-names>A</given-names></name>
</person-group>             <year>2005</year>             <article-title>Connecting the protein structure universe by using sparse recurring fragments.</article-title>             <source>Structure</source>             <volume>13</volume>             <fpage>1213</fpage>             <lpage>1224</lpage>          </element-citation></ref>
<ref id="pcbi.1000331-Rogen1"><label>16</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Rogen</surname><given-names>P</given-names></name>
<name name-style="western"><surname>Fain</surname><given-names>B</given-names></name>
</person-group>             <year>2003</year>             <article-title>Automatic classification of protein structure by using Gauss integrals.</article-title>             <source>Proc Nat Acad Sci U S A</source>             <volume>100</volume>             <fpage>119</fpage>             <lpage>124</lpage>          </element-citation></ref>
<ref id="pcbi.1000331-Sam2"><label>17</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Sam</surname><given-names>V</given-names></name>
<name name-style="western"><surname>Tai</surname><given-names>C-H</given-names></name>
<name name-style="western"><surname>Garnier</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Gibrat</surname><given-names>J-F</given-names></name>
<name name-style="western"><surname>Lee</surname><given-names>B</given-names></name>
<etal/></person-group>             <year>2008</year>             <article-title>Towards an automatic classification of protein structural domains based on structural similarity.</article-title>             <source>BMC Bioinformatics</source>             <volume>9</volume>             <fpage>74</fpage>          </element-citation></ref>
<ref id="pcbi.1000331-Zemla1"><label>18</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Zemla</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Geisbrecht</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Smith</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Lam</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Kirkpatrick</surname><given-names>B</given-names></name>
<etal/></person-group>             <year>2007</year>             <article-title>STRALCP—structure alignment-based clustering of proteins.</article-title>             <source>Nucleic Acids Res</source>             <volume>35</volume>             <fpage>e150</fpage>          </element-citation></ref>
<ref id="pcbi.1000331-Suhrer1"><label>19</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Suhrer</surname><given-names>SJ</given-names></name>
<name name-style="western"><surname>Wiederstein</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Sippl</surname><given-names>MJ</given-names></name>
</person-group>             <year>2007</year>             <article-title>QSCOP–SCOP quantified by structural relationships.</article-title>             <source>Bioinformatics</source>             <volume>23</volume>             <fpage>513</fpage>             <lpage>514</lpage>          </element-citation></ref>
<ref id="pcbi.1000331-Chothia1"><label>20</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Chothia</surname><given-names>C</given-names></name>
</person-group>             <year>1992</year>             <article-title>Proteins. One thousand families for the molecular biologist.</article-title>             <source>Nature</source>             <volume>357</volume>             <fpage>543</fpage>             <lpage>544</lpage>          </element-citation></ref>
<ref id="pcbi.1000331-Kolodny1"><label>21</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Kolodny</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Petrey</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Honig</surname><given-names>B</given-names></name>
</person-group>             <year>2006</year>             <article-title>Protein structure comparison: implications for the nature of ‘fold space’, and structure and function prediction.</article-title>             <source>Curr Opin Struct Biol</source>             <volume>16</volume>             <fpage>393</fpage>             <lpage>398</lpage>          </element-citation></ref>
<ref id="pcbi.1000331-Shindyalov1"><label>22</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Shindyalov</surname><given-names>IN</given-names></name>
<name name-style="western"><surname>Bourne</surname><given-names>PE</given-names></name>
</person-group>             <year>2000</year>             <article-title>An alternative view of protein fold space.</article-title>             <source>Proteins</source>             <volume>38</volume>             <fpage>247</fpage>             <lpage>260</lpage>          </element-citation></ref>
<ref id="pcbi.1000331-Tsai1"><label>23</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Tsai</surname><given-names>CJ</given-names></name>
<name name-style="western"><surname>Maizel</surname><given-names>JV</given-names><suffix>Jr</suffix></name>
<name name-style="western"><surname>Nussinov</surname><given-names>R</given-names></name>
</person-group>             <year>2000</year>             <article-title>Anatomy of protein structures: visualizing how a one-dimensional protein chain folds into a three dimensional shape.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>97</volume>             <fpage>12038</fpage>             <lpage>12043</lpage>          </element-citation></ref>
<ref id="pcbi.1000331-Berezowski1"><label>24</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Berezowski</surname><given-names>IN</given-names></name>
<name name-style="western"><surname>Trifunov</surname><given-names>EN</given-names></name>
</person-group>             <year>2001</year>             <article-title>Loop fold nature of globular proteins.</article-title>             <source>Protein Eng</source>             <volume>14</volume>             <fpage>403</fpage>             <lpage>407</lpage>          </element-citation></ref>
<ref id="pcbi.1000331-Tendulkar1"><label>25</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Tendulkar</surname><given-names>AV</given-names></name>
<name name-style="western"><surname>Joshi</surname><given-names>AA</given-names></name>
<name name-style="western"><surname>Sohoni</surname><given-names>MA</given-names></name>
<name name-style="western"><surname>Wangikar</surname><given-names>PP</given-names></name>
</person-group>             <year>2004</year>             <article-title>Clustering of protein structural fragments reveals modular building block approach of nature</article-title>             <source>J Mol Biol</source>             <volume>338</volume>             <fpage>611</fpage>             <lpage>629</lpage>          </element-citation></ref>
<ref id="pcbi.1000331-Szustakowski1"><label>26</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Szustakowski</surname><given-names>JD</given-names></name>
<name name-style="western"><surname>Kasif</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Weng</surname><given-names>Z</given-names></name>
</person-group>             <year>2005</year>             <article-title>Less is more: towards an optimal universal description of protein folds.</article-title>             <source>Bioinformatics</source>             <volume>21</volume>             <fpage>ii66</fpage>             <lpage>ii71</lpage>          </element-citation></ref>
<ref id="pcbi.1000331-Ohno1"><label>27</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Ohno</surname><given-names>S</given-names></name>
</person-group>             <year>1970</year>             <source>Evolution by Gene Duplication</source>             <publisher-loc>New York</publisher-loc>             <publisher-name>Springer-Verlag</publisher-name>          </element-citation></ref>
<ref id="pcbi.1000331-Lupas1"><label>28</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Lupas</surname><given-names>AN</given-names></name>
<name name-style="western"><surname>Ponting</surname><given-names>CP</given-names></name>
<name name-style="western"><surname>Russel</surname><given-names>RB</given-names></name>
</person-group>             <year>2001</year>             <article-title>On the evolution of protein folds: are similar motifs in different protein folds the result of convergence, insertion, or relics of an ancient peptide world?</article-title>             <source>J Struct Biol</source>             <volume>134</volume>             <fpage>191</fpage>             <lpage>203</lpage>          </element-citation></ref>
<ref id="pcbi.1000331-Efimov1"><label>29</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Efimov</surname><given-names>AV</given-names></name>
</person-group>             <year>1997</year>             <article-title>Structural trees for protein superfamilies.</article-title>             <source>Proteins</source>             <volume>28</volume>             <fpage>241</fpage>             <lpage>260</lpage>          </element-citation></ref>
<ref id="pcbi.1000331-Taylor1"><label>30</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Taylor</surname><given-names>WR</given-names></name>
</person-group>             <year>2002</year>             <article-title>A ‘periodic table’ for protein structure.</article-title>             <source>Nature</source>             <volume>416</volume>             <fpage>657</fpage>             <lpage>660</lpage>          </element-citation></ref>
<ref id="pcbi.1000331-Chothia2"><label>31</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Chothia</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Lesk</surname><given-names>AM</given-names></name>
</person-group>             <year>1986</year>             <article-title>The relation between the divergence of sequence and structure in proteins.</article-title>             <source>EMBO J</source>             <volume>5</volume>             <fpage>823</fpage>             <lpage>826</lpage>          </element-citation></ref>
<ref id="pcbi.1000331-Grishin1"><label>32</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Grishin</surname><given-names>NV</given-names></name>
</person-group>             <year>2001</year>             <article-title>Fold change in evolution of protein structures.</article-title>             <source>J Struct Biol</source>             <volume>134</volume>             <fpage>167</fpage>             <lpage>185</lpage>          </element-citation></ref>
<ref id="pcbi.1000331-Krishna1"><label>33</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Krishna</surname><given-names>SS</given-names></name>
<name name-style="western"><surname>Grishin</surname><given-names>NV</given-names></name>
</person-group>             <year>2005</year>             <article-title>Structural drift: a possible path to protein fold change.</article-title>             <source>Bioinformatics</source>             <volume>21</volume>             <fpage>1308</fpage>             <lpage>1310</lpage>          </element-citation></ref>
<ref id="pcbi.1000331-Newlove1"><label>34</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Newlove</surname><given-names>T</given-names></name>
<name name-style="western"><surname>Konieczka</surname><given-names>JH</given-names></name>
<name name-style="western"><surname>Cordes</surname><given-names>MH</given-names></name>
</person-group>             <year>2003</year>             <article-title>Retroevolution of λ Cro toward a stable monomer.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>100</volume>             <fpage>2345</fpage>             <lpage>2350</lpage>          </element-citation></ref>
<ref id="pcbi.1000331-Roessler1"><label>35</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Roessler</surname><given-names>CG</given-names></name>
<name name-style="western"><surname>Hall</surname><given-names>BM</given-names></name>
<name name-style="western"><surname>Anderson</surname><given-names>WJ</given-names></name>
<name name-style="western"><surname>Ingram</surname><given-names>WM</given-names></name>
<name name-style="western"><surname>Roberts</surname><given-names>SA</given-names></name>
<etal/></person-group>             <year>2008</year>             <article-title>Transitive homology-guided structural studies lead to discovery of Cro proteins with 40% sequence identity but different folds.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>105</volume>             <fpage>2343</fpage>             <lpage>2348</lpage>          </element-citation></ref>
<ref id="pcbi.1000331-Viksna1"><label>36</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Viksna</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Gilbert</surname><given-names>D</given-names></name>
</person-group>             <year>2007</year>             <article-title>Assessment of the probabilities for evolutionary structural changes in protein folds.</article-title>             <source>Bioinformatics</source>             <volume>23</volume>             <fpage>832</fpage>             <lpage>841</lpage>          </element-citation></ref>
<ref id="pcbi.1000331-Rammal1"><label>37</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Rammal</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Toulouse</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Virasoro</surname><given-names>MA</given-names></name>
</person-group>             <year>1986</year>             <article-title>Ultrametricity for physicists.</article-title>             <source>Rev Mod Phys</source>             <volume>58</volume>             <fpage>765</fpage>             <lpage>788</lpage>          </element-citation></ref>
<ref id="pcbi.1000331-Toulouse1"><label>38</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Toulouse</surname><given-names>G</given-names></name>
</person-group>             <year>1977</year>             <article-title>Theory of the frustration effect in spin glasses: I.</article-title>             <source>Commun Phys</source>             <volume>2</volume>             <fpage>115</fpage>             <lpage>119</lpage>          </element-citation></ref>
<ref id="pcbi.1000331-Lupyan1"><label>39</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Lupyan</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Leo-Macias</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Ortiz</surname><given-names>AR</given-names></name>
</person-group>             <year>2005</year>             <article-title>A new progressive-iterative algoithm for multiple structure alignment.</article-title>             <source>Bioinformatics</source>             <volume>21</volume>             <fpage>3255</fpage>             <lpage>3263</lpage>          </element-citation></ref>
<ref id="pcbi.1000331-Teichert1"><label>40</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Teichert</surname><given-names>F</given-names></name>
<name name-style="western"><surname>Bastolla</surname><given-names>U</given-names></name>
<name name-style="western"><surname>Porto</surname><given-names>M</given-names></name>
</person-group>             <year>2007</year>             <article-title>SABERTOOTH: protein structural alignment based on a vectorial structure representation.</article-title>             <source>BMC Bioinformatics</source>             <volume>8</volume>             <fpage>425</fpage>          </element-citation></ref>
<ref id="pcbi.1000331-Ortiz1"><label>41</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Ortiz</surname><given-names>AR</given-names></name>
<name name-style="western"><surname>Strauss</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Olmea</surname><given-names>O</given-names></name>
</person-group>             <year>2002</year>             <article-title>MAMMOTH (Matching Molecular Models Obtained from Theory): an automated method for model comparison.</article-title>             <source>Protein Sci</source>             <volume>11</volume>             <fpage>2606</fpage>             <lpage>2621</lpage>          </element-citation></ref>
<ref id="pcbi.1000331-Zhang1"><label>42</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Zhang</surname><given-names>Y</given-names></name>
<name name-style="western"><surname>Skolnick</surname><given-names>J</given-names></name>
</person-group>             <year>2004</year>             <article-title>Scoring function for automated assessment of protein structure template quality.</article-title>             <source>Proteins</source>             <volume>57</volume>             <fpage>702</fpage>             <lpage>710</lpage>          </element-citation></ref>
<ref id="pcbi.1000331-Gerstein1"><label>43</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Gerstein</surname><given-names>M</given-names></name>
</person-group>             <year>1997</year>             <article-title>A structural census of genomes: comparing bacterial, eukaryotic, and archaeal genomes in terms of protein structure.</article-title>             <source>J Mol Biol</source>             <volume>274</volume>             <fpage>562</fpage>             <lpage>576</lpage>          </element-citation></ref>
<ref id="pcbi.1000331-Huynen1"><label>44</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Huynen</surname><given-names>MA</given-names></name>
<name name-style="western"><surname>van Nimwegen</surname><given-names>E</given-names></name>
</person-group>             <year>1998</year>             <article-title>The frequency distribution of gene family sizes in complete genomes.</article-title>             <source>Mol Biol Evol</source>             <volume>15</volume>             <fpage>583</fpage>             <lpage>589</lpage>          </element-citation></ref>
<ref id="pcbi.1000331-Dokholyan1"><label>45</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Dokholyan</surname><given-names>NV</given-names></name>
<name name-style="western"><surname>Shakhnovich</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Shakhnovich</surname><given-names>EI</given-names></name>
</person-group>             <year>2002</year>             <article-title>Expanding protein universe and its origin from the biological Big Bang.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>99</volume>             <fpage>14132</fpage>             <lpage>14136</lpage>          </element-citation></ref>
<ref id="pcbi.1000331-LoConte1"><label>46</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Lo Conte</surname><given-names>L</given-names></name>
<name name-style="western"><surname>Brenner</surname><given-names>SE</given-names></name>
<name name-style="western"><surname>Hubbard</surname><given-names>TJ</given-names></name>
<name name-style="western"><surname>Chothia</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Murzin</surname><given-names>AG</given-names></name>
</person-group>             <year>2002</year>             <article-title>SCOP database in 2002: refinements accommodate structural genomics.</article-title>             <source>Nucleic Acids Res</source>             <volume>30</volume>             <fpage>264</fpage>             <lpage>267</lpage>          </element-citation></ref>
<ref id="pcbi.1000331-Islam1"><label>47</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Islam</surname><given-names>SA</given-names></name>
<name name-style="western"><surname>Luo</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Sternberg</surname><given-names>MJ</given-names></name>
</person-group>             <year>1995</year>             <article-title>Identification and analysis of domains in proteins.</article-title>             <source>Protein Eng</source>             <volume>8</volume>             <fpage>513</fpage>             <lpage>525</lpage>          </element-citation></ref>
<ref id="pcbi.1000331-Veretnik1"><label>48</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Veretnik</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Bourne</surname><given-names>PE</given-names></name>
<name name-style="western"><surname>Alexandrov</surname><given-names>NN</given-names></name>
<name name-style="western"><surname>Shindyalov</surname><given-names>IN</given-names></name>
</person-group>             <year>2004</year>             <article-title>Toward consistent assignment of structural domains in proteins.</article-title>             <source>J Mol Biol</source>             <volume>339</volume>             <fpage>647</fpage>             <lpage>678</lpage>          </element-citation></ref>
<ref id="pcbi.1000331-Krishnadev1"><label>49</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Krishnadev</surname><given-names>O</given-names></name>
<name name-style="western"><surname>Brinda</surname><given-names>KV</given-names></name>
<name name-style="western"><surname>Vishveshwara</surname><given-names>S</given-names></name>
</person-group>             <year>2005</year>             <article-title>A graph spectral analysis of the structural similarity of protein chains.</article-title>             <source>Proteins</source>             <volume>61</volume>             <fpage>152</fpage>             <lpage>163</lpage>          </element-citation></ref>
<ref id="pcbi.1000331-Xie1"><label>50</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Xie</surname><given-names>L</given-names></name>
<name name-style="western"><surname>Bourne</surname><given-names>PE</given-names></name>
</person-group>             <year>2008</year>             <article-title>Detecting evolutionary relationships across existing fold space, using sequence order-independent profile-profile alignments.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>105</volume>             <fpage>5441</fpage>             <lpage>5446</lpage>          </element-citation></ref>
<ref id="pcbi.1000331-Shatsky1"><label>51</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Shatsky</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Nussinov</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Wolfson</surname><given-names>HJ</given-names></name>
</person-group>             <year>2002</year>             <article-title>Flexible protein alignment and hinge detection.</article-title>             <source>Proteins</source>             <volume>48</volume>             <fpage>242</fpage>             <lpage>256</lpage>          </element-citation></ref>
<ref id="pcbi.1000331-Ye1"><label>52</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Ye</surname><given-names>Y</given-names></name>
<name name-style="western"><surname>Godzik</surname><given-names>A</given-names></name>
</person-group>             <year>2005</year>             <article-title>Multiple flexible structure alignment using partial order graphs.</article-title>             <source>Bioinformatics</source>             <volume>21</volume>             <fpage>2362</fpage>             <lpage>2369</lpage>          </element-citation></ref>
<ref id="pcbi.1000331-Csaba1"><label>53</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Csaba</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Birzele</surname><given-names>F</given-names></name>
<name name-style="western"><surname>Zimmer</surname><given-names>R</given-names></name>
</person-group>             <year>2008</year>             <article-title>Protein structure alignment considering phenotypic plasticity.</article-title>             <source>Bioinformatics</source>             <volume>24</volume>             <fpage>i98</fpage>             <lpage>i104</lpage>          </element-citation></ref>
<ref id="pcbi.1000331-Mosca1"><label>54</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Mosca</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Brannetti</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Schneider</surname><given-names>TR</given-names></name>
</person-group>             <year>2008</year>             <article-title>Alignment of protein structures in the presence of domain motions.</article-title>             <source>BMC Bioinformatics</source>             <volume>9</volume>             <fpage>352</fpage>          </element-citation></ref>
<ref id="pcbi.1000331-Reeves1"><label>55</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Reeves</surname><given-names>GA</given-names></name>
<name name-style="western"><surname>Dallman</surname><given-names>TJ</given-names></name>
<name name-style="western"><surname>Redfern</surname><given-names>OC</given-names></name>
<name name-style="western"><surname>Akpor</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Orengo</surname><given-names>CA</given-names></name>
</person-group>             <year>2006</year>             <article-title>Structural diversity of domain superfamilies in the CATH database.</article-title>             <source>J Mol Biol</source>             <volume>360</volume>             <fpage>725</fpage>             <lpage>741</lpage>          </element-citation></ref>
<ref id="pcbi.1000331-Jiang1"><label>56</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Jiang</surname><given-names>H</given-names></name>
<name name-style="western"><surname>Blouin</surname><given-names>C</given-names></name>
</person-group>             <year>2007</year>             <article-title>Insertions and the emergence of novel protein structure: a structure-based phylogenetic study of insertions.</article-title>             <source>BMC Bioinformatics</source>             <volume>8</volume>             <fpage>444</fpage>          </element-citation></ref>
<ref id="pcbi.1000331-Holm3"><label>57</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Holm</surname><given-names>L</given-names></name>
<name name-style="western"><surname>Sander</surname><given-names>C</given-names></name>
</person-group>             <year>1998</year>             <article-title>Dictionary of recurrent domains in protein structures.</article-title>             <source>Proteins</source>             <volume>33</volume>             <fpage>88</fpage>             <lpage>96</lpage>          </element-citation></ref>
<ref id="pcbi.1000331-Nagano1"><label>58</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Nagano</surname><given-names>N</given-names></name>
<name name-style="western"><surname>Orengo</surname><given-names>CA</given-names></name>
<name name-style="western"><surname>Thornton</surname><given-names>JM</given-names></name>
</person-group>             <year>2002</year>             <article-title>One fold with many functions: the evolutionary relationships between TIM barrel families based on their sequences, structures and functions.</article-title>             <source>J Mol Biol</source>             <volume>321</volume>             <fpage>741</fpage>             <lpage>765</lpage>          </element-citation></ref>
<ref id="pcbi.1000331-Deeds1"><label>59</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Deeds</surname><given-names>EJ</given-names></name>
<name name-style="western"><surname>Shakhnovich</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Shakhnovich</surname><given-names>EI</given-names></name>
</person-group>             <year>2004</year>             <article-title>Proteomic traces of speciation.</article-title>             <source>J Mol Biol</source>             <volume>336</volume>             <fpage>695</fpage>             <lpage>706</lpage>          </element-citation></ref>
<ref id="pcbi.1000331-Goldstein1"><label>60</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Goldstein</surname><given-names>RA</given-names></name>
</person-group>             <year>2008</year>             <article-title>The structure of protein evolution and the evolution of protein structure.</article-title>             <source>Curr Opin Struct Biol</source>             <volume>18</volume>             <fpage>170</fpage>             <lpage>177</lpage>          </element-citation></ref>
<ref id="pcbi.1000331-Doolittle1"><label>61</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Doolittle</surname><given-names>RF</given-names></name>
</person-group>             <year>1999</year>             <article-title>Phylogenetic classification and the universal tree.</article-title>             <source>Science</source>             <volume>284</volume>             <fpage>2124</fpage>             <lpage>2129</lpage>          </element-citation></ref>
<ref id="pcbi.1000331-Altschul1"><label>62</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Altschul</surname><given-names>SF</given-names></name>
<name name-style="western"><surname>Madden</surname><given-names>TL</given-names></name>
<name name-style="western"><surname>Schaffer</surname><given-names>AA</given-names></name>
<name name-style="western"><surname>Zhang</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Zhang</surname><given-names>Z</given-names></name>
<etal/></person-group>             <year>1997</year>             <article-title>Gapped BLAST and PSI-BLAST: a new generation of protein database search programs.</article-title>             <source>Nucleic Acids Res</source>             <volume>25</volume>             <fpage>3389</fpage>             <lpage>3402</lpage>          </element-citation></ref>
<ref id="pcbi.1000331-Sokal1"><label>63</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Sokal</surname><given-names>RR</given-names></name>
<name name-style="western"><surname>Michener</surname><given-names>CD</given-names></name>
</person-group>             <year>1958</year>             <article-title>A statistical method for evaluating systematic relationships.</article-title>             <source>Univ Kans Sci Bull</source>             <volume>38</volume>             <fpage>1409</fpage>             <lpage>1438</lpage>          </element-citation></ref>
<ref id="pcbi.1000331-Cohen1"><label>64</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Cohen</surname><given-names>J</given-names></name>
</person-group>             <year>1968</year>             <article-title>Weighted kappa: nominal scale agreement with provision for scaled disagreement or partial credit.</article-title>             <source>Psychol Bull</source>             <volume>70</volume>             <fpage>213</fpage>             <lpage>220</lpage>          </element-citation></ref>
<ref id="pcbi.1000331-Batagelj1"><label>65</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Batagelj</surname><given-names>V</given-names></name>
<name name-style="western"><surname>Mrvar</surname><given-names>A</given-names></name>
</person-group>             <article-title>Pajek: A Program for Large Network Analysis.</article-title>             <comment><ext-link ext-link-type="uri" xlink:href="http://vlado.fmf.uni-lj.si/pub/networks/pajek/" xlink:type="simple">http://vlado.fmf.uni-lj.si/pub/networks/pajek/</ext-link></comment>          </element-citation></ref>
</ref-list>

</back>
</article>