<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-17-01368</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1006096</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Database and informatics methods</subject><subj-group><subject>Biological databases</subject><subj-group><subject>Sequence databases</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Database and informatics methods</subject><subj-group><subject>Bioinformatics</subject><subj-group><subject>Sequence analysis</subject><subj-group><subject>Sequence databases</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Taxonomy</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Data management</subject><subj-group><subject>Taxonomy</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Database and informatics methods</subject><subj-group><subject>Bioinformatics</subject><subj-group><subject>Sequence analysis</subject><subj-group><subject>Sequence alignment</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Microbiology</subject><subj-group><subject>Medical microbiology</subject><subj-group><subject>Microbiome</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Genomics</subject><subj-group><subject>Microbial genomics</subject><subj-group><subject>Microbiome</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Microbiology</subject><subj-group><subject>Microbial genomics</subject><subj-group><subject>Microbiome</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Applied mathematics</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Computational techniques</subject><subj-group><subject>Split-decomposition method</subject><subj-group><subject>Multiple alignment calculation</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Taxonomy</subject><subj-group><subject>Microbial taxonomy</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Data management</subject><subj-group><subject>Taxonomy</subject><subj-group><subject>Microbial taxonomy</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Database and informatics methods</subject></subj-group></subj-group></article-categories>
<title-group>
<article-title>Using pseudoalignment and base quality to accurately quantify microbial community composition</article-title>
<alt-title alt-title-type="running-head">Microbial community composition using pseudoalignment and base quality</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-7992-4537</contrib-id>
<name name-style="western">
<surname>Reppell</surname> <given-names>Mark</given-names></name>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<xref ref-type="aff" rid="aff001"/>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Novembre</surname> <given-names>John</given-names></name>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"/>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<addr-line>Department of Human Genetics, University of Chicago, Chicago, Illinois, United States of America</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>McHardy</surname> <given-names>Alice Carolyn</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Helmholtz-Zentrum fur Infektionsforschung GmbH, GERMANY</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">jnovembre@uchicago.edu</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>4</month>
<year>2018</year>
</pub-date>
<pub-date pub-type="epub">
<day>16</day>
<month>4</month>
<year>2018</year>
</pub-date>
<volume>14</volume>
<issue>4</issue>
<elocation-id>e1006096</elocation-id>
<history>
<date date-type="received">
<day>14</day>
<month>8</month>
<year>2017</year>
</date>
<date date-type="accepted">
<day>19</day>
<month>3</month>
<year>2018</year>
</date>
</history>
<permissions>
<copyright-year>2018</copyright-year>
<copyright-holder>Reppell, Novembre</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1006096"/>
<abstract>
<p>Pooled DNA from multiple unknown organisms arises in a variety of contexts, for example microbial samples from ecological or human health research. Determining the composition of pooled samples can be difficult, especially at the scale of modern sequencing data and reference databases. Here we propose a novel method for taxonomic profiling in pooled DNA that combines the speed and low-memory requirements of k-mer based pseudoalignment with a likelihood framework that uses base quality information to better resolve multiply mapped reads. We apply the method to the problem of classifying 16S rRNA reads using a reference database of known organisms, a common challenge in microbiome research. Using simulations, we show the method is accurate across a variety of read lengths, with different length reference sequences, at different sample depths, and when samples contain reads originating from organisms absent from the reference. We also assess performance in real 16S data, where we reanalyze previous genetic association data to show our method discovers a larger number of quantitative trait associations than other widely used methods. We implement our method in the software Karp, for k-mer based analysis of read pools, to provide a novel combination of speed and accuracy that is uniquely suited for enhancing discoveries in microbial studies.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>Pooled DNA from multiple unknown organisms arises in a variety of contexts. Determining the composition of pooled samples can be difficult, especially at the scale of modern data. Here we propose the novel method Karp, designed to perform taxonomic profiling in pooled DNA. Karp combines the speed and low-memory requirements of k-mer based pseudoalignment with a likelihood framework that uses base quality information to better resolve multiply mapped reads. We apply Karp to the problem of classifying 16S rRNA reads using a reference database of known organisms. Using simulations, we show Karp is accurate across a variety of read lengths, reference sequence lengths, sample depths, and when samples contain reads originating from organisms absent from the reference. We also assess performance in real 16S data, where we reanalyze previous genetic association data to show that relative to other widely used quantification methods Karp reveals a larger number of microbiome quantitative trait association signals. Modern sequencing technology gives us unprecedented access to microbial communities, but uncovering significant findings requires correctly interpreting pooled microbial DNA. Karp provides a novel combination of speed and accuracy that makes it uniquely suited for enhancing discoveries in microbial studies.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000051</institution-id>
<institution>National Human Genome Research Institute</institution>
</institution-wrap>
</funding-source>
<award-id>RO1 HG007089</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Novembre</surname> <given-names>John</given-names></name>
</principal-award-recipient>
</award-group>
<funding-statement>This work was supported by National Institute of Health/National Human Genome Research Institute (<ext-link ext-link-type="uri" xlink:href="https://www.genome.gov/" xlink:type="simple">https://www.genome.gov/</ext-link>) R01 HG007089 (JN). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="4"/>
<table-count count="3"/>
<page-count count="23"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2018-05-10</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>The Karp software is available from gitHub at <ext-link ext-link-type="uri" xlink:href="https://github.com/mreppell/Karp" xlink:type="simple">https://github.com/mreppell/Karp</ext-link>. The software simreads, used to simulate sequencing reads for this project, is available as part of the Harp software package at <ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/dkessner/harp" xlink:type="simple">https://bitbucket.org/dkessner/harp</ext-link>. The authors of this paper modified simreads to handle paired-end and references shorter than the read length, these modifications and installation instructions are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/mreppell/simreads_expansion" xlink:type="simple">https://github.com/mreppell/simreads_expansion</ext-link>. The real sequence data analyzed in this study was shared with us by the Ober Lab at the University of Chicago, who have deposited it in dbGap as phs000185.v4.p1 Genetic Studies in the Hutterites, available at <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/projects/gap/cgi-bin/study.cgi?study_id=phs000185.v4.p1" xlink:type="simple">https://www.ncbi.nlm.nih.gov/projects/gap/cgi-bin/study.cgi?study_id=phs000185.v4.p1</ext-link>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<disp-quote><p>This is a <italic>PLOS Computational Biology</italic> Methods paper.</p></disp-quote>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>The study of microbial community composition has been revolutionized by modern genetic sequencing. Experimenters can forgo the laborious work of culturing cells and detect a broader range of taxa than was previously possible. This improved ability to describe the microbes present in a pooled sample has led to important findings in human health [<xref ref-type="bibr" rid="pcbi.1006096.ref001">1</xref>–<xref ref-type="bibr" rid="pcbi.1006096.ref003">3</xref>] and ecology [<xref ref-type="bibr" rid="pcbi.1006096.ref004">4</xref>, <xref ref-type="bibr" rid="pcbi.1006096.ref005">5</xref>]. These findings rely on quantification of the taxa present in experimental samples, and towards that goal many methods have been developed. The ever-increasing scale of both sequencing data and relevant reference databases require that such methods be efficient in addition to accurate. Here we present a novel method, Karp, which combines the speed of k-mer-based pseudoaligning with a likelihood framework that incorporates base quality information. In this work we use Karp to profile the taxonomy of pooled 16S microbiome data quickly and with an accuracy superior to widely adopted alternative methods.</p>
<p>Microbiome samples are commonly generated using either shotgun sequencing or the sequencing of marker genes, most often the gene encoding 16S ribosomal RNA. Classifying the output of shotgun sequencing can be difficult, as limited reference databases exist for entire bacterial genomes, so whole genome sequencing generally either requires computationally intensive de novo assembly methods [<xref ref-type="bibr" rid="pcbi.1006096.ref006">6</xref>–<xref ref-type="bibr" rid="pcbi.1006096.ref008">8</xref>] or limits the range of organisms available for study [<xref ref-type="bibr" rid="pcbi.1006096.ref009">9</xref>]. Alternatively, several large reference databases exist for microbial 16S sequences [<xref ref-type="bibr" rid="pcbi.1006096.ref010">10</xref>–<xref ref-type="bibr" rid="pcbi.1006096.ref012">12</xref>]. The 16S gene contains alternating regions of highly conserved and highly variable sequences, making it easy to target and well powered for differentiating taxa. Many experiments target one or several of the 16S hypervariable regions and sequence to a high depth [<xref ref-type="bibr" rid="pcbi.1006096.ref013">13</xref>–<xref ref-type="bibr" rid="pcbi.1006096.ref015">15</xref>].</p>
<p>Sequence identification problems can be broadly classified as either open-reference or closed-reference. In open-reference problems the reference sequences of possible contributors are unknown, so sample sequences are clustered or binned based on similarities between them. In a closed-reference problem the sequences of contributors are known, and quantification is typically a process of matching the observed sequencing reads against a reference database in order to build a taxonomic profile of a sequenced sample. Some algorithms use a hybrid approach, with a binning step followed by a closed-reference classification. Open and closed reference methods are suited for answering different research questions. While open reference methods can uncover novel organisms and broadly classify diversity in samples, closed reference methods provide information that can help compare the abundance of specific organisms in samples and search for associations when differences are observed. There are several significant challenges faced by closed-reference methods for classifying microbial samples. First, methods must be able to provide unbiased estimates when samples contain previously unidentified taxa. Second, microbial samples often contain a range of genetic diversity unmatched by single species sequencing samples. And finally, methods must efficiently compare sequences against reference databases containing potentially millions of organisms.</p>
<p>One widely applied approach to classifying microbiome samples is to calculate a similarity metric between a sample’s reads themselves, between the reads and a reference database, or both. Many early similarity based methods first employed the Basic Local Alignment Search Tool (BLAST) [<xref ref-type="bibr" rid="pcbi.1006096.ref016">16</xref>], which calculates both a similarity score and relative significance for local alignments of queries against reference sequences. Several methods refined BLAST output to classify sequence origin [<xref ref-type="bibr" rid="pcbi.1006096.ref017">17</xref>–<xref ref-type="bibr" rid="pcbi.1006096.ref019">19</xref>], however, the BLAST algorithm is computationally very intensive, making methods based on it hard to scale with both reference panel size and sequencing depth. These early BLAST based methods have largely been superseded by the USEARCH and UCLUST algorithms [<xref ref-type="bibr" rid="pcbi.1006096.ref020">20</xref>, <xref ref-type="bibr" rid="pcbi.1006096.ref021">21</xref>] and several other recent similarity-based clustering algorithms [<xref ref-type="bibr" rid="pcbi.1006096.ref022">22</xref>–<xref ref-type="bibr" rid="pcbi.1006096.ref025">25</xref>] that are fast enough to handle modern data (millions of reads, each one hundreds of base pairs long). The speed and accuracy of these modern clustering algorithms has been shown to be very similar [<xref ref-type="bibr" rid="pcbi.1006096.ref022">22</xref>, <xref ref-type="bibr" rid="pcbi.1006096.ref026">26</xref>]. Another approach for classifying sequences, often with the goal of profiling a sample, is based on the shared phylogeny of samples, and places query sequences along a phylogenetic tree. Phylogenetic methods using maximum-likelihood estimation [<xref ref-type="bibr" rid="pcbi.1006096.ref027">27</xref>], Bayesian posterior probabilities [<xref ref-type="bibr" rid="pcbi.1006096.ref028">28</xref>], or neighbor-joining [<xref ref-type="bibr" rid="pcbi.1006096.ref029">29</xref>] have all been developed. While representing the explicit relationships between organisms provided by phylogenetic methods is attractive, these methods impose a large computational burden. Also, while they often make accurate taxonomic assignments, phylogenetic methods tend to suffer from low sensitivity [<xref ref-type="bibr" rid="pcbi.1006096.ref030">30</xref>]. A third approach to classifying microbiome sequencing reads consists of methods that use sequence composition. Early sequence composition methods calculated the probability of a query originating from a specific taxon based on shared k-mers [<xref ref-type="bibr" rid="pcbi.1006096.ref031">31</xref>–<xref ref-type="bibr" rid="pcbi.1006096.ref033">33</xref>], an approach that has been refined and expanded upon by recent sequence composition methods [<xref ref-type="bibr" rid="pcbi.1006096.ref034">34</xref>, <xref ref-type="bibr" rid="pcbi.1006096.ref035">35</xref>]. Recent articles by Lindgreen <italic>et al</italic> (2016) [<xref ref-type="bibr" rid="pcbi.1006096.ref036">36</xref>] and Sczyrba <italic>et al</italic> (2017) [<xref ref-type="bibr" rid="pcbi.1006096.ref037">37</xref>] provide performance evaluations of both binning and profiling methods in the context of metagenomics.</p>
<p>Very recently, the development of pseudoalignment [<xref ref-type="bibr" rid="pcbi.1006096.ref038">38</xref>] has allowed sequence composition quantification with minimal computational requirements and an accuracy superior to other recent methods [<xref ref-type="bibr" rid="pcbi.1006096.ref039">39</xref>, <xref ref-type="bibr" rid="pcbi.1006096.ref040">40</xref>]. Pseudoaligning, originally developed in the context of RNA sequencing experiments, is a rapid k-mer based algorithm that uses a de Bruijn Graph of the reference database to identify potential matches for a query sequence without aligning the query to reference sequences. Pseudoaligning is very fast, and is implemented in the software Kallisto [<xref ref-type="bibr" rid="pcbi.1006096.ref038">38</xref>], which uses an expectation maximization (EM) algorithm to resolve multiply-mapped reads without assigning them to a single taxonomic unit. The speed advantages of Kallisto and pseudoaligning come at a cost; notably it ignores information about sequencing quality that could help assign multiply-mapped reads more accurately. Sequencing errors occur non-uniformly along reads, and base-quality scores record the probability of errors at each base. Thus, quantification can be improved by using base-quality scores to help distinguish true mismatches between reads and references from sequencing errors.</p>
<p>Kallisto’s limitations led us to develop Karp, a program that leverages the speed and low memory requirements of pseudoaligning with an EM algorithm that uses sequencing base-quality scores to quickly and accurately classify the taxonomy of pooled microbiome samples. Here, we demonstrate with simulations of 16S sequencing experiments the improvement in accuracy that Karp provides relative to Kallisto, modern similarity-based methods, the machine learning based 16S Classifier [<xref ref-type="bibr" rid="pcbi.1006096.ref041">41</xref>], and the Wang <italic>et al.</italic> (2007) naive Bayesian classifier. We also use simulations to demonstrate how Karp leads to better estimates of important summary statistics and remains robust when sequences from organisms absent from our reference database are present at high frequencies in samples. We also introduce a modified version of the Karp algorithm that collapses information across reference sequences sharing the same taxonomic labels, which we call Karp-Collapse. We evaluated the method in practice by assessing the number of discoveries made in a dataset [<xref ref-type="bibr" rid="pcbi.1006096.ref042">42</xref>] designed to associate host microbiome abundance with individual’s genotypes. We tested genera level abundances, and found that across sampling conditions Karp is able to detect more significant associations than comparison methods. For researchers seeking to maximize their power to detect associations between known taxa in their 16S samples and environmental or genetic variables, Karp provides the highest accuracy at a minimal comupational cost.</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Materials and methods</title>
<sec id="sec003">
<title>Ethics statement</title>
<p>The human data we reanalyzed in this study was originally collected and analyzed by the Ober Lab, who had their protocol approved by the University of Chicago IRB (protocol 09-354-A). Written informed consent was obtained from all adult participants and the parents of minors. In addition, written assent was obtained from minor participants.</p>
</sec>
<sec id="sec004">
<title>Method overview</title>
<p>The aim of Karp is to estimate a vector <inline-formula id="pcbi.1006096.e001"><alternatives><graphic id="pcbi.1006096.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006096.e001" xlink:type="simple"/><mml:math display="inline" id="M1"><mml:mrow><mml:mi mathvariant="script">F</mml:mi> <mml:mo>=</mml:mo> <mml:mo>(</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mi>M</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, containing the proportion of a pooled DNA sample that is contributed by each of <italic>M</italic> possible haploid reference sequences, which we refer to as just reference sequences hereafter. <xref ref-type="fig" rid="pcbi.1006096.g001">Fig 1</xref> gives an outline of Karp’s quantification process and <xref ref-type="table" rid="pcbi.1006096.t001">Table 1</xref> defines the terms used in this section. The first step in using Karp is the construction of a k-mer index of the <italic>M</italic> reference sequences. This index catalogs the subset of the <italic>M</italic> reference sequences that contain each unique k-mer of a given length. Next, the query reads are pseudoaligned using the k-mer index. Query reads that pseudoalign to multiple references (multiply-mapped reads) are locally aligned to each potential reference, and each reference’s best alignment is kept. Queries that pseudoalign to a single reference are assigned without alignment. Next, for multiply-mapped reads the likelihood that they originated from each potential reference is calculated using the best alignment and the base-quality scores that correspond to the read. After the likelihoods for every query read have been calculated, an EM-algorithm is used to estimate the relative frequencies of each reference sequence contributing to the pool. More details about the method are provided in the following sections.</p>
<table-wrap id="pcbi.1006096.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006096.t001</object-id>
<label>Table 1</label>
<caption>
<title>Materials and methods definitions.</title>
</caption>
<alternatives>
<graphic id="pcbi.1006096.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006096.t001" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center"/>
<th align="left">Definitions</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><italic>N</italic></td>
<td align="left">total number of reads</td>
</tr>
<tr>
<td align="center"><italic>M</italic></td>
<td align="left">total number of haploid reference sequences</td>
</tr>
<tr>
<td align="center"><italic>r</italic><sub><italic>j</italic></sub></td>
<td align="left">read <italic>j</italic> for <italic>j</italic> ∈ 1, .., <italic>N</italic></td>
</tr>
<tr>
<td align="center"><italic>h</italic><sub><italic>k</italic></sub></td>
<td align="left">haploid reference sequence <italic>k</italic> for <italic>k</italic> ∈ 1, …, <italic>M</italic></td>
</tr>
<tr>
<td align="center">
<inline-formula id="pcbi.1006096.e002">
<alternatives>
<graphic id="pcbi.1006096.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006096.e002" xlink:type="simple"/>
<mml:math display="inline" id="M2">
<mml:mi mathvariant="script">F</mml:mi>
</mml:math>
</alternatives>
</inline-formula>
</td>
<td align="left">vector of length <italic>M</italic>, with entries <italic>f</italic><sub><italic>k</italic></sub> corresponding to frequency of reference <italic>h</italic><sub><italic>k</italic></sub></td>
</tr>
<tr>
<td align="center"><italic>η</italic><sub><italic>j</italic></sub></td>
<td align="left">vector of length <italic>M</italic>, entry <italic>k</italic> = 1 if read <italic>r</italic><sub><italic>j</italic></sub> originated from reference <italic>h</italic><sub><italic>k</italic></sub>, 0 otherwise</td>
</tr>
<tr>
<td align="center"><italic>l</italic><sub><italic>j</italic>,<italic>k</italic></sub></td>
<td align="left"><italic>P</italic>(<italic>r</italic><sub><italic>j</italic></sub>|<italic>η</italic><sub><italic>j</italic>,<italic>k</italic></sub> = 1), likelihood of read <italic>r</italic><sub><italic>j</italic></sub> originating from reference <italic>h</italic><sub><italic>k</italic></sub></td>
</tr>
<tr>
<td align="center"><italic>t</italic><sub><italic>k</italic></sub></td>
<td align="left">number of reads known to originate from reference <italic>h</italic><sub><italic>k</italic></sub></td>
</tr>
<tr>
<td align="center"><italic>N</italic>*</td>
<td align="left">
<inline-formula id="pcbi.1006096.e003">
<alternatives>
<graphic id="pcbi.1006096.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006096.e003" xlink:type="simple"/>
<mml:math display="inline" id="M3">
<mml:mrow>
<mml:mi>N</mml:mi>
<mml:mo>-</mml:mo>
<mml:mstyle displaystyle="true"><mml:munderover>
<mml:mo>∑</mml:mo>
<mml:mrow>
<mml:mi>k</mml:mi>
<mml:mo>=</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mi>M</mml:mi>
</mml:munderover>
</mml:mstyle>
<mml:msub>
<mml:mi>t</mml:mi>
<mml:mi>k</mml:mi>
</mml:msub>
</mml:mrow>
</mml:math>
</alternatives>
</inline-formula>, number of reads with unknown reference of origin</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<fig id="pcbi.1006096.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006096.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Overview of Karp.</title>
<p>(1) Query reads are pseudoaligned against an index of the reference database, resulting in a set of references they could have potentially originated from. (2) The query reads are locally aligned to the possible references. (3) Using the best alignment, the likelihood that a read originated from a specific reference is calculated. (4) Using the read likelihoods an EM-algorithm is employed to estimate the relative abundances of the references in the pool of query reads.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006096.g001" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec005">
<title>Pseudoaligning and alignment</title>
<p>Aligning millions of reads against hundreds of thousands of references is impractical in both memory and time. However, calculating the probability that a read originated from a given reference sequence using base-quality information requires an alignment. To overcome this challenge, Karp uses pseudoalignment as a filter before performing local alignment. Pseudoalignment is a fast and memory efficient way to narrow the space of possible references from which a query read may have originated. Our pseudoaligning algorithm is directly based on that of Kallisto [<xref ref-type="bibr" rid="pcbi.1006096.ref038">38</xref>]. Briefly, first an indexed de Bruijn Graph of the reference database is constructed, with each observed k-mer mapped to an equivalence class of reference sequences that it is contained in. Next, each query read is decomposed into its constituent k-mers, which are searched against the index. Kallisto uses a strict intersection of the equivalence classes returned by the k-mer search to arrive at a pseudoalignment. Karp can also be set to use the strict intersection of equivalence classes. However, because mismatched bases are accounted for in Karp’s read likelihood framework, we are more concerned with false negatives than false positive matches and the default setting is more inclusive. In Karp’s default mode, if no strict intersection is observed, the intersection of all equivalence classes with the same maximum number of matched k-mers, conditional on the maximum being &gt;1, are declared matches. Reads with &lt;2 matched k-mers are always removed from analysis for failing to pseudoalign.</p>
<p>After pseudoaligning, reads are locally aligned to the matching reference sequences using the Striped Smith-Waterman algorithm [<xref ref-type="bibr" rid="pcbi.1006096.ref043">43</xref>, <xref ref-type="bibr" rid="pcbi.1006096.ref044">44</xref>] (SSW penalties: mismatch (2), gap opening (3), gap extending (1)).</p>
</sec>
<sec id="sec006">
<title>Read likelihoods</title>
<p>Our likelihood and EM frameworks build closely on the work of Kessner <italic>et al.</italic> (2013) [<xref ref-type="bibr" rid="pcbi.1006096.ref045">45</xref>], whose software Harp implemented a method for estimating reference frequencies in pooled DNA. Kessner <italic>et al.</italic> (2013) recognized the potential of their method to improve accuracy in microbiome studies, but Harp was computationally infeasible with modern reference databases.</p>
<p>For a read <italic>r</italic><sub><italic>j</italic></sub> with <italic>j</italic> ∈ 1, .., <italic>N</italic> and length <italic>L</italic><sub><italic>j</italic></sub>, let (<italic>r</italic><sub><italic>j</italic></sub>[1], …, <italic>r</italic><sub><italic>j</italic></sub>[<italic>L</italic><sub><italic>j</italic></sub>]) be the base calls at each position along the read. Assume we have a reference database with <italic>M</italic> possible reference sequences. For reference sequence <italic>h</italic><sub><italic>k</italic></sub> with <italic>k</italic> ∈ 1, …, <italic>M</italic> let (<italic>h</italic><sub><italic>k</italic>,<italic>j</italic></sub>[1], …, <italic>h</italic><sub><italic>k</italic>,<italic>j</italic></sub>[<italic>L</italic><sub><italic>j</italic></sub>]) give the values of the bases in <italic>h</italic><sub><italic>k</italic></sub> corresponding to the best alignment of read <italic>r</italic><sub><italic>j</italic></sub>. Note the entries in this vector may not be contiguous due to insertions, deletions, or because the reads are paired-end. Define the probability of sequencing error at each position as <italic>q</italic><sub><italic>j</italic></sub>[<italic>i</italic>] = <italic>P</italic>(<italic>r</italic><sub><italic>j</italic></sub>[<italic>i</italic>] ≠ <italic>h</italic><sub><italic>k</italic>,<italic>j</italic></sub>[<italic>i</italic>]) for <italic>i</italic> ∈ 1, .., <italic>L</italic><sub><italic>j</italic></sub>, and define the variable <italic>η</italic><sub><italic>j</italic></sub>, a vector of length <italic>M</italic> with components <italic>η</italic><sub><italic>j</italic>,<italic>k</italic></sub> = 1 if <italic>r</italic><sub><italic>j</italic></sub> originated from reference <italic>h</italic><sub><italic>k</italic></sub> and 0 otherwise. Assuming sequencing errors are independent, we can then formulate the probability of read <italic>r</italic><sub><italic>j</italic></sub> arising from reference <italic>h</italic><sub><italic>k</italic></sub>, which we label <italic>l</italic><sub><italic>j</italic>,<italic>k</italic></sub>, as
<disp-formula id="pcbi.1006096.e004"><alternatives><graphic id="pcbi.1006096.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006096.e004" xlink:type="simple"/><mml:math display="block" id="M4"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>l</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>r</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>η</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:msub><mml:mi>L</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:munderover> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>r</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>i</mml:mi> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>|</mml:mo> <mml:msub><mml:mi>h</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>i</mml:mi> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:msub><mml:mi>q</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>i</mml:mi> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula>
where, if we assume every base is equally likely when an error occurs
<disp-formula id="pcbi.1006096.e005"><alternatives><graphic id="pcbi.1006096.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006096.e005" xlink:type="simple"/><mml:math display="block" id="M5"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>r</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>i</mml:mi> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>|</mml:mo> <mml:msub><mml:mi>h</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>i</mml:mi> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:msub><mml:mi>q</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>i</mml:mi> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>{</mml:mo> <mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mi>q</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>i</mml:mi> <mml:mo>]</mml:mo></mml:mrow> <mml:mphantom><mml:mpadded depth="0pt" height="0pt"><mml:mi>l</mml:mi> <mml:mi>l</mml:mi> <mml:mi>l</mml:mi> <mml:mi>l</mml:mi> <mml:mi>l</mml:mi> <mml:mi>l</mml:mi></mml:mpadded></mml:mphantom> <mml:mspace width="4.pt"/><mml:mtext>if</mml:mtext> <mml:mspace width="4.pt"/><mml:msub><mml:mi>r</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>i</mml:mi> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>h</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>i</mml:mi> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>q</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>i</mml:mi> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:mn>3</mml:mn> <mml:mphantom><mml:mpadded depth="0pt" height="0pt"><mml:mi>l</mml:mi> <mml:mi>m</mml:mi> <mml:mi>s</mml:mi> <mml:mi>l</mml:mi> <mml:mi>l</mml:mi> <mml:mi>l</mml:mi></mml:mpadded></mml:mphantom> <mml:mspace width="4.pt"/><mml:mtext>if</mml:mtext> <mml:mspace width="4.pt"/><mml:msub><mml:mi>r</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>i</mml:mi> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>≠</mml:mo> <mml:msub><mml:mi>h</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>i</mml:mi> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable> <mml:mo/> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2)</label></disp-formula></p>
<p>A more complete definition of the probability would sum over all possible alignments of <italic>r</italic><sub><italic>j</italic></sub> to <italic>h</italic><sub><italic>k</italic></sub>. However, in non-repetitive marker gene sequence the best local alignment typically contributes such a large proportion of the probability weight, that excluding alternate local alignments has a negligible impact on results but substantially improves computation.</p>
</sec>
<sec id="sec007">
<title>Estimating reference sequence frequencies</title>
<p>As previously noted, the aim of our method is to estimate a vector <inline-formula id="pcbi.1006096.e006"><alternatives><graphic id="pcbi.1006096.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006096.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:mrow><mml:mi mathvariant="script">F</mml:mi> <mml:mo>=</mml:mo> <mml:mo>(</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mi>M</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, containing the frequencies of the <italic>M</italic> possible references in a pooled DNA sample. If we were to observe which reference gave rise to each read in our sample, the maximum likelihood estimate of <inline-formula id="pcbi.1006096.e007"><alternatives><graphic id="pcbi.1006096.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006096.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:mi mathvariant="script">F</mml:mi></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1006096.e008"><alternatives><graphic id="pcbi.1006096.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006096.e008" xlink:type="simple"/><mml:math display="inline" id="M8"><mml:mover accent="true"><mml:mi mathvariant="script">F</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, would follow directly from the multinomial likelihood. In reality, we observe the reads <italic>r</italic>, but the references that they originate from, <italic>η</italic>, are unobserved. To estimate <inline-formula id="pcbi.1006096.e009"><alternatives><graphic id="pcbi.1006096.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006096.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:mi mathvariant="script">F</mml:mi></mml:math></alternatives></inline-formula> we therefore employ an EM algorithm, with a form common to mixture model problems. Details of our EM algorithm are provided in <xref ref-type="supplementary-material" rid="pcbi.1006096.s001">S1 File</xref>.</p>
<p>Karp modifies the standard mixture EM algorithm in two ways to speed up performance. The first is an assumption that if a read <italic>r</italic><sub><italic>j</italic></sub> uniquely pseudoaligns to a reference <italic>h</italic><sub><italic>k</italic></sub> then <inline-formula id="pcbi.1006096.e010"><alternatives><graphic id="pcbi.1006096.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006096.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:mrow><mml:mi>P</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>η</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>|</mml:mo> <mml:mi>r</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="script">F</mml:mi> <mml:mo>)</mml:mo> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>. For haploid reference <italic>h</italic><sub><italic>k</italic></sub>, label the number of reads that uniquely map as <italic>t</italic><sub><italic>k</italic></sub> and define <inline-formula id="pcbi.1006096.e011"><alternatives><graphic id="pcbi.1006096.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006096.e011" xlink:type="simple"/><mml:math display="inline" id="M11"><mml:mrow><mml:msup><mml:mi>N</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>=</mml:mo> <mml:mi>N</mml:mi> <mml:mo>-</mml:mo> <mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>M</mml:mi></mml:munderover></mml:mstyle> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>. Then we can write the likelihood of the data as
<disp-formula id="pcbi.1006096.e012"><alternatives><graphic id="pcbi.1006096.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006096.e012" xlink:type="simple"/><mml:math display="block" id="M12"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="script">F</mml:mi><mml:mo>|</mml:mo><mml:mi>η</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>∝</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover></mml:mstyle><mml:msubsup><mml:mi>f</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>*</mml:mo></mml:mrow></mml:munderover></mml:mstyle><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives> <label>(3)</label></disp-formula>
and our update step as
<disp-formula id="pcbi.1006096.e013"><alternatives><graphic id="pcbi.1006096.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006096.e013" xlink:type="simple"/><mml:math display="block" id="M13"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>f</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:mfrac><mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mi>N</mml:mi></mml:mfrac> <mml:mo>+</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>N</mml:mi></mml:mfrac> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:msup><mml:mi>N</mml:mi> <mml:mo>*</mml:mo></mml:msup></mml:munderover> <mml:mo>[</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>l</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:msubsup><mml:mover accent="true"><mml:mi>f</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow> <mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>M</mml:mi></mml:munderover></mml:mstyle> <mml:msub><mml:mi>l</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi>m</mml:mi></mml:mrow></mml:msub> <mml:msubsup><mml:mover accent="true"><mml:mi>f</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>m</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac> <mml:mo>]</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(4)</label></disp-formula>
This assumption also provides a logical initial estimate of <inline-formula id="pcbi.1006096.e014"><alternatives><graphic id="pcbi.1006096.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006096.e014" xlink:type="simple"/><mml:math display="inline" id="M14"><mml:msup><mml:mi mathvariant="script">F</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:math></alternatives></inline-formula> <disp-formula id="pcbi.1006096.e015"><alternatives><graphic id="pcbi.1006096.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006096.e015" xlink:type="simple"/><mml:math display="block" id="M15"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>f</mml:mi> <mml:mrow><mml:mi>k</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:mfrac><mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mi>N</mml:mi></mml:mfrac> <mml:mo>+</mml:mo> <mml:mfrac><mml:msup><mml:mi>N</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mi>M</mml:mi></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(5)</label></disp-formula></p>
<p>The second speed-up that Karp uses is an implementation of SQUAREM [<xref ref-type="bibr" rid="pcbi.1006096.ref046">46</xref>], which accelerates the convergence of EM algorithms by using information from multiple previous parameter updates to improve the current EM update step.</p>
<p>Additionally, Karp allows the user to specify a minimum reference frequency. After the frequency of a reference falls below this threshold during the EM updates, its value is set to zero and its frequency weight is distributed evenly across the remaining references. Technically, this filter violates the guarantee of the EM algorithm to reach a local maximum of the likelihood function, however, it proves quite useful in practice. We find that when there is sufficient information to distinguish closely related species this approach imposes a sparsity condition which is effective for avoiding the estimation of spurious references at very low frequencies. When only limited information to distinguish between closely related species exists, for example in data generated from a single 16S hypervariable region, it can be better to set the minimum frequency very low to avoid eliminating true low frequency taxa with probability weights distributed evenly across indistinguishable taxa. <xref ref-type="supplementary-material" rid="pcbi.1006096.s006">S2</xref> and <xref ref-type="supplementary-material" rid="pcbi.1006096.s007">S3</xref> Figs explore the impact of different thresholds on the simulated and real data presented in this study.</p>
</sec>
<sec id="sec008">
<title>Read likelihood filter</title>
<p>Our EM method relies on the fact that all the reads in our sample originated from reference sequences present in our reference database. In real data this assumption can be problematic; the classification of microbial taxonomy is an ongoing project and many taxons have yet to be identified or referenced. To preserve the accuracy of our frequency estimates in the presence of reads originating from organisms absent from the reference database we implemented a filter on the maximum read likelihood value [<xref ref-type="bibr" rid="pcbi.1006096.ref045">45</xref>].</p>
<p>Specifically, using the base-quality scores of the query reads we calculate a “null” distribution of likelihood values corresponding to what we would observe if every query were matched to its true originating reference and every mismatched base was the result of sequencing errors. Then, after the local realignment step we filter out query reads where the greatest observed likelihood falls too far outside this distribution, as these are unlikely to truly match any of the reference sequences present in the database. Karp includes the option to output the maximum likelihood for each read, which can be used to determine the appropriate cutoff value. In our simulations, where a variety of empirical quality score distributions were encountered, cutoff values between -3.0 and -1.5 yielded similar results, a finding in line with Kessner <italic>et al.</italic> (2013), and which supports a default value of -2.0. For more details about the filter see <xref ref-type="supplementary-material" rid="pcbi.1006096.s002">S2 File</xref>.</p>
<p>This likelihood filter works in concert with the pseudoalignment step to prevent chimeric reads that may exist in a sample from being classified. Chimeric reads should rarely pseudo align properly and when they do, the likelihood filter can trigger their removal as the alignment is likely to contain mismatches.</p>
</sec>
<sec id="sec009">
<title>Karp-Collapse</title>
<p>The default approach in Karp estimates the relative frequencies of the individual reference sequences present in the reference database. In many microbiome databases there is not a one-to-one relationship between reference sequences and taxonomic labels; multiple sequences share a single label. When little information exists to distinguish closely related reference sequences, estimating the relative frequencies at the taxon level rather than individual reference sequences can improve accuracy. To accommodate this, Karp includes a collapse option, which adds a step to the estimation procedure. When the collapse option is used, after pseudoalignment and local alignment Karp calculates the average likelihood for each taxonomic label, and uses these likelihoods in the EM algorithm to estimate taxonomic frequencies. This can be interpreted in a Bayesian context as the likelihood a read is from a taxon under a uniform prior for the source reference sequence within that taxa. Karp output in collapse mode provides counts at each taxonomic level from species to phylum. Because it is estimating the frequencies of fewer categories, collapse mode is often faster than Karp’s default. It is important to note that the read-likelihood distribution for the read filter described in section Read likelihood filter, is based on the assumption of matching a read with its exact source. Karp-Collapse potentially combines information from multiple reference sequences, so this distribution no longer fits the data, and the filter should not be applied in the same manner. For more details see <xref ref-type="supplementary-material" rid="pcbi.1006096.s003">S3 File</xref>.</p>
</sec>
<sec id="sec010">
<title>Simulating 16S reads</title>
<p>To compare Karp with alternative methods we simulated pooled sequence samples. The general simulation procedure was as follows. First, a fixed number of reference sequences were selected at random from a reference fasta file and a vector of frequencies corresponding to these references was generated by drawing from a Dirichlet distribution. Next, a predetermined number of reads were simulated. For each read a reference sequence was drawn at random according to its frequency in the original frequency vector. We simulated reads from either the entire 16S gene or from only the V4 hypervariable region. When we simulated reads from the entire gene a read start position was selected uniformly and a number of bases corresponding to the desired read length were copied from the selected reference. In the case of paired-end reads, the distance between pairs was drawn as an upper-bound Poisson random variable with an empirically derived mean. Bases which would cause the read to extend past the end of the reference were excluded from being initiation points. When we simulated paired-end reads from the V4 hypervariable region, the initiation point for the forward read was the first base of the region, and the reverse read sequenced backwards from the region’s final base. Once a read’s bases were copied, a corresponding base-quality score vector was generated based on an empirical distribution of quality scores. To simulate 75bp single-end reads we used the publicly available Illumina-sequenced mock-community dataset from the Human Microbiome Project [<xref ref-type="bibr" rid="pcbi.1006096.ref047">47</xref>]. For simulating 151bp paired-end reads we used the quality scores observed in Illumina-sequenced microbiome samples collected from Amish and Hutterite mattresses [<xref ref-type="bibr" rid="pcbi.1006096.ref048">48</xref>]. Finally, 301bp paired-end reads were simulated using scores from a sample of human saliva downloaded from Illumina’s BaseSpace platform (<ext-link ext-link-type="uri" xlink:href="https://basespace.illumina.com/projects/17438426" xlink:type="simple">https://basespace.illumina.com/projects/17438426</ext-link>) [<xref ref-type="bibr" rid="pcbi.1006096.ref049">49</xref>]. Finally, errors were simulated along the read with probabilities corresponding to the base-quality score at each position and assuming that the three alternative bases were equally likely. After adding errors the read was added to the pooled sample, and the algorithm proceeded to the next read.</p>
</sec>
<sec id="sec011">
<title>Simulations</title>
<p>In our simulations we used two reference databases. For full 16S gene sequence we used the 99% identity GreenGenes version 13.8 [<xref ref-type="bibr" rid="pcbi.1006096.ref012">12</xref>]. To simulate reads from the V4 hypervariable region we used the TaxMan tool [<xref ref-type="bibr" rid="pcbi.1006096.ref050">50</xref>] with the primers from Caporaso <italic>et al</italic> (2012) [<xref ref-type="bibr" rid="pcbi.1006096.ref051">51</xref>] to extract the region from the Greengenes 13.5 database. We simulated reads as coming from only the V4 region, but used the database with the full gene sequence for classification. We reduced the full gene database to match the non-redundant sequences present in the V4 database so that we could classify which taxon a read was generated from. We simulated samples with two depths: first, samples containing 10<sup>6</sup> sequencing reads, a depth inspired by recent high-depth studies [<xref ref-type="bibr" rid="pcbi.1006096.ref048">48</xref>] and designed to demonstrate the computational feasibility of Karp, and second, samples with 10<sup>5</sup> reads, more in line with more shallow pooled sequencing experiments [<xref ref-type="bibr" rid="pcbi.1006096.ref052">52</xref>, <xref ref-type="bibr" rid="pcbi.1006096.ref053">53</xref>]. At both depths, for each sample we selected 1,000 reference sequences randomly from the reference database and simulated reads following the approach in the section “Simulating 16S reads”. The Dirichlet distribution used to generate the sample frequency vectors had identical alpha values varied between 0.002 and 7. These parameter settings created samples with a broad range of Shannon Diversity values (<xref ref-type="supplementary-material" rid="pcbi.1006096.s008">S4 Fig</xref>). For each combination of read length, region size, and sample depth we generated between 100 and 200 samples. We placed samples into bins based on their Shannon diversity, and each bin for each condition had a minimum of 10 samples. Each sample was a unique mix of 1,000 reference sequences. With Kallisto and Karp the raw forward and reverse reads were directly classified. For SINTAX, SortMeRNA, 16S Classifier, Mothur’s Naive Bayesian classifier, UCLUST, and USEARCH6.1 paired-end reads were merged into contigs using the QIIME script <italic>join_paired_ends.py</italic> or Mothur’s <italic>make.contigs</italic> command before being submitted for classification. The QIIME algorithms UCLUST and USEARCH6.1 performed OTU clustering before taxonomy was assigned, and as would be expected observed an increasing number of clusters as diversity increased. At the high end, in the 75bp single-end samples with 1,000,000 reads we observed between 10,000 and 70,000 OTUs in the samples. On the low end, in the 301bp paired-end 100,000 read samples we observed between 25 and 2,000 OTUs.</p>
<p>We simulated an additional 100 samples with 75bp single-end reads to compare how each method’s frequency estimates impacted the estimation of common sample summary statistics. Many statistics, such as <italic>β</italic> Diversity, summarize the sharing of taxa between samples, so instead of 1,000 unique taxa in each sample, we used a shared pool of 1,000 taxa for all 100 samples, and further increased the similarity between samples by introducing correlation between the reference frequencies. The reference frequencies for each sample were a linear combination of a random Dirichlet variable generated in a manner identical to the simulations above and the reference frequencies of the preceding sample. In this way the samples again covered the full range of Shannon Diversity values, however the frequencies of shared taxa was potentially much higher, providing a broader range of summary statistic values in the simulations.</p>
<p>Next we compared how the methods performed when the simulated samples contained reads generated from taxa that were absent from the reference database being used for quantification. We selected one phylum (<italic>Acidobacteria</italic>), one order (<italic>Pseudomonadales</italic>), and one genus (<italic>Clostridiisalibacter</italic>) at random from the taxa in GreenGenes with more than 30 reference sequences. Then, for each missing taxa, we simulated 10 samples where 50% of the reads originated from 3 different members and at least 5% of the reads came from closely related taxa (kingdom Bactera for <italic>Acidobacteria</italic>, class Gammaproteobacteria for <italic>Pseudomonadales</italic>, and family Clostridiaceae for <italic>Clostridiisalibacter</italic>). Next, we create 3 reduced GreeGenes reference databases, each with one of the missing taxa (including all lower ranking members) expunged. Finally, we classified the simulated samples using both the appropriate reduced reference database and the full GreenGenes database.</p>
<p>Finally, we examined how sensitive our results were to the assumption that base-quality scores are accurate representations of the probability of sequencing error. Karp assumes that base-quality scores follow the Phred scale, where the probability of a sequencing error is <inline-formula id="pcbi.1006096.e016"><alternatives><graphic id="pcbi.1006096.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006096.e016" xlink:type="simple"/><mml:math display="inline" id="M16"><mml:msup><mml:mn>10</mml:mn> <mml:mfrac><mml:mi>Q</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>10</mml:mn></mml:mrow></mml:mfrac></mml:msup></mml:math></alternatives></inline-formula> for quality score <italic>Q</italic>. To test this assumption we simulated and classified 50 samples where the actual probability of an error was <inline-formula id="pcbi.1006096.e017"><alternatives><graphic id="pcbi.1006096.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006096.e017" xlink:type="simple"/><mml:math display="inline" id="M17"><mml:msup><mml:mn>10</mml:mn> <mml:mfrac><mml:mi>Q</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>5</mml:mn></mml:mrow></mml:mfrac></mml:msup></mml:math></alternatives></inline-formula> and also 50 samples where errors occurred uniformly at 1% of bases.</p>
<p>We compare the different methods using an AVGRE (AVerage Relative Error) metric [<xref ref-type="bibr" rid="pcbi.1006096.ref039">39</xref>, <xref ref-type="bibr" rid="pcbi.1006096.ref054">54</xref>, <xref ref-type="bibr" rid="pcbi.1006096.ref055">55</xref>] which is based on the absolute value of the difference between the true and estimated counts of reads in the simulated samples. Define <italic>M</italic><sub><italic>a</italic></sub> as a set of indices for the actual reference sequences contributing to a pooled sample and <italic>M</italic><sub><italic>e</italic></sub> as the set of indices for additional references a method classifies as having a non-zero number of reads that are not truly present. Also, let <italic>T</italic><sub><italic>i</italic>,<italic>e</italic></sub> be the count of reads estimated for reference <italic>i</italic> and <italic>T</italic><sub><italic>i</italic>,<italic>a</italic></sub> is the actual number of simulated reads from reference <italic>i</italic> present in the sample. Using these values the AVGRE metric has the form:
<disp-formula id="pcbi.1006096.e018"><alternatives><graphic id="pcbi.1006096.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006096.e018" xlink:type="simple"/><mml:math display="block" id="M18"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>A</mml:mi> <mml:mi>V</mml:mi> <mml:mi>G</mml:mi> <mml:mi>R</mml:mi> <mml:mi>E</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>1000</mml:mn></mml:mfrac> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi>M</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mo>∪</mml:mo> <mml:msub><mml:mi>M</mml:mi> <mml:mi>e</mml:mi></mml:msub></mml:mrow></mml:munder> <mml:mo>|</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>e</mml:mi></mml:mrow></mml:msub> <mml:mo>*</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi>M</mml:mi> <mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:msub> <mml:msub><mml:mi>T</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:msub><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi>M</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mo>∪</mml:mo> <mml:msub><mml:mi>M</mml:mi> <mml:mi>e</mml:mi></mml:msub></mml:mrow></mml:msub> <mml:msub><mml:mi>T</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac> <mml:mo>-</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>a</mml:mi></mml:mrow></mml:msub> <mml:mo>|</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(6)</label></disp-formula></p>
<p>We include the scaling factor of 1/1000 in order to transform the value into an estimate of the average per-reference error rate, as our pooled simulation samples include 1,000 individual reference sequences. We use the same scaling factor when looking at errors in the estimation of higher order taxonomy for consistency, although the true number of references at any given taxonomic level will be &lt;1,000. Throughout this work we calculate error using only references with either estimated or true frequencies &gt;0.1%.</p>
</sec>
<sec id="sec012">
<title>Real data</title>
<p>To test the performance of Karp with real data we reanalyzed samples originally published by Igartua <italic>et al.</italic> (2017). In brief, these samples were collected from nasal brushings of Hutterites located in South Dakota at two time points, January/February 2011 (winter) and July 2011 (summer). Two nasal sites were collected, the nasal vestibule and the nasopharynx. After quality control a total of 332 samples were analyzed (87 summer and 80 winter vestibule, 88 summer and 77 winter nasopharynx). From these samples the V4 region of the 16S rRNA gene was amplified and sequenced using the Illumina HiSeq2000 (llumina, San Diego, USA) under a single end 102 base-pair protocol.</p>
<p>Following de-multiplexing, reads were processed using the QIIME 1.9.1 toolkit, and only reads with an expected barcode, zero ambiguous base calls, less than three consecutive low-quality base calls, and a minimum Phred quality score of 20 along the entire read were kept. The reads that passed the QC filters were then taxonomically classified using the 97% identity Greengenes May 2013 reference database [<xref ref-type="bibr" rid="pcbi.1006096.ref012">12</xref>] and the Karp, Karp-Collapse, Kallisto and UCLUST algorithms. The UCLUST classification was carried out with classifier version 1.2.22q as part of the original study, the other classifications were performed for this study.</p>
<p>The Hutterite samples were previously genotyped using Affymetrix arrays (Affymetrix, Santa Clara, USA) [<xref ref-type="bibr" rid="pcbi.1006096.ref056">56</xref>–<xref ref-type="bibr" rid="pcbi.1006096.ref058">58</xref>]. Imputation was performed using the pedigree based approach PRIMAL [<xref ref-type="bibr" rid="pcbi.1006096.ref059">59</xref>] with a sequenced reference panel of 98 Hutterites. 3,161,460 variant sites with genotype call rates &gt; 95% and a minor allele frequencies &gt; 0.10 in any of the 4 season/site subsamples were then tested for association with the relative abundance of genera level taxa. Association was tested using a linear mixed model implemented in GEMMA [<xref ref-type="bibr" rid="pcbi.1006096.ref060">60</xref>]. The model included sex and age as fixed effects and a kinship random effect to adjust for the relatedness between study members. For each season/site combination, any genera that was classified as present in &gt; 75% of samples by Karp, UCLUST, or Kallisto was analyzed. In total, 369 genera-season association analysis were performed (120 summer nasopharynx, 69 winter nasopharynx, 98 summer vestibule, 82 winter vestibule). To calculate q-values for our association statistics a subset of 148,653 SNPs pruned to have LD <italic>r</italic><sup>2</sup> &lt; 0.5 were used as independent markers in each analysis and the Benjamini and Hochberg procedure [<xref ref-type="bibr" rid="pcbi.1006096.ref061">61</xref>] was applied.</p>
</sec>
<sec id="sec013">
<title>Implementation</title>
<p>The program Karp is implemented in C++, and available for download from GitHub at <ext-link ext-link-type="uri" xlink:href="https://github.com/mreppell/Karp" xlink:type="simple">https://github.com/mreppell/Karp</ext-link>. Karp takes as input sample fastq files, reference sequences in fasta format, and taxonomy files with labels corresponding to the references. The first stage of analysis with Karp is building a k-mer index of the references. Karp then uses this index along with the reference sequences to pseudoalign, locally align, and then quantify the taxonomy in the fastq file of query reads. Karp includes a post analysis option to tabulate multiple samples and calculate compositional summaries. Karp can make use of multi-threading to improve performance, and allows users to specify frequency thresholds, EM convergence conditions, likelihood filter parameters, and pseudoalignment k-mer length.</p>
<p>The simreads program we used to simulate sequence data with an empirical distribution of base-quality scores is available at <ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/dkessner/harp" xlink:type="simple">https://bitbucket.org/dkessner/harp</ext-link>.</p>
</sec>
</sec>
<sec id="sec014" sec-type="results">
<title>Results</title>
<sec id="sec015">
<title>Comparison of competing methods with simulations</title>
<p>To test the performance of Karp against alternatives we simulated independent samples with 75bp single-end reads drawn from 1,000 reference sequences selected at random using two reference databases, one with full 16S gene sequences, and the other with only the V4 hypervariable region of the gene. We simulated samples at two depths: 100,000 reads per sample and 1,000,000 reads per sample. Each simulation used a unique set of 1,000 references, and the frequencies of each reference was varied to create a range of Shannon Diversity (<xref ref-type="supplementary-material" rid="pcbi.1006096.s008">S4 Fig</xref>). With both the full gene sequence and the V4 samples we classified sequences against the full 16S gene sequence in a GreenGenes database using Karp, Kallisto (v0.42.4), SINTAX (USEARCH v10.0.240) [<xref ref-type="bibr" rid="pcbi.1006096.ref062">62</xref>], the Wang <italic>et al.</italic> (2007) Naive Bayes classifier implemented in Mothur (v1.36.1) [<xref ref-type="bibr" rid="pcbi.1006096.ref063">63</xref>], the downloaded version of the 16S Classifier [<xref ref-type="bibr" rid="pcbi.1006096.ref041">41</xref>], and several algorithms from QIIME including UCLUST (v1.2.22q), USEARCH (v6.1.544), and SortMeRNA (v2.0). We estimated errors as described in section Simulations. Quantitative results from these simulations, and those with 151bp and 301bp paired-end reads are available in <xref ref-type="supplementary-material" rid="pcbi.1006096.s004">S4 File</xref>. If not explicitly stated, in the following paragraphs samples were 75bp single-end with 1,000,000 reads.</p>
<p>We looked first at performance in 75bp single-end reads, identifying the exact reference sequence that was used to generate the sequencing reads in a sample. Across both sample sizes, at both samples depths, and in both the full gene and just the V4 region samples, the Karp algorithm had the lowest average errors (<xref ref-type="fig" rid="pcbi.1006096.g002">Fig 2</xref>). For example, in the full gene samples with 1,000,000 reads, Karp’s average error was 34% smaller than Kallisto and 65-66% smaller than UCLUST, USEARCH, and SortMeRNA. Across all the methods there was a trend of decreasing average error with increasing sample diversity. In the samples with 1,000,000 reads, Karp’s average error was 48% smaller when diversity was &gt;6.2 than when it was &lt;0.7.</p>
<fig id="pcbi.1006096.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006096.g002</object-id>
<label>Fig 2</label>
<caption>
<title>75bp simulation results.</title>
<p>The average absolute error with 95% confidence intervals from simulated samples of 1 × 10<sup>6</sup> 75bp reads, with every simulated dataset having a unique mix of 1,000 reference sequences. Each colored line represents a different quantification method, including Karp, Kallisto, SINTAX, UCLUST, USEARCH, SortMeRNA, and the Naive Bayes method implemented in Mothur. The samples were also classified with the 16S Classifier, its errors were above the shown range. Error refers to the average relative error (AVGRE): the difference between the true number of reads for each reference sequence present in the simulated data and the number classified by each method, if each method had classified every read in the data. (A) Per reference level error for taxa with frequency &gt;0.1% in samples simulated from the full 16S gene sequence. (B) Per reference level error for taxa with frequency &gt;0.1% in samples simulated using only the V4 hypervariable region of the 16S gene. (C) Genera-level error in the full gene samples. (D) Genera-level error in V4 samples.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006096.g002" xlink:type="simple"/>
</fig>
<p>Many reference sequences share the same taxonomic label, and researchers are often interested in hypotheses at a broader taxonomic level, like genera, than individual references. We aggregated counts for references with identical labels and again compared with the truth in our simulated samples. In the full gene high depth samples, the Karp and Karp-Collapse algorithms were the most accurate across diversity values and across taxonomic levels. (<xref ref-type="fig" rid="pcbi.1006096.g002">Fig 2C</xref>, <xref ref-type="supplementary-material" rid="pcbi.1006096.s004">S4 File</xref>). In the low depth and V4 samples, the Karp algorithm was still the most accurate, however Karp-Collapse’s performance was comparable to, or slightly worse than Kallisto and the QIIME algorithms. The SINTAX algorithm had accuracy similar to Karp in the lowest diversity samples (Shannon Diversity &lt; 1.4), but decreased in accuracy as sample diversity increased. Across all evaluations Mothur’s Naive Bayes classifier and the 16S Classifier gave the least accurate estimates on average (<xref ref-type="fig" rid="pcbi.1006096.g002">Fig 2D</xref>).</p>
<p>The difference in quantification error observed here is relevant for downstream analysis. Using the full 16S gene we calculated summary statistics in 100 independent simulated samples. Karp’s estimates were on average closer to the truth than either Kallisto or UCLUST (<xref ref-type="table" rid="pcbi.1006096.t002">Table 2</xref>). For Simpson Diversity, Karp’s estimate was within 10% of the actual value for 44% of samples, compared with 32% of samples for Kallisto, and only 2% of samples with UCLUST. Karp’s estimate of Simpson Diversity fell within 25% of the actual value in 82% of samples, with Kallisto this figure was 62%, and UCLUST was 18%.</p>
<table-wrap id="pcbi.1006096.t002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006096.t002</object-id>
<label>Table 2</label>
<caption>
<title>Summaries of microbiome data were calculated from 100 simulated samples containing different mixtures of 1,000 references.</title>
<p>Only reference sequences with frequencies &gt;0.1% were used to calculate the statistics. In each sample the absolute value of the difference between the actual statistic and that estimated by Karp, Kallisto, and UCLUST was calculated. The group-wise Beta Diversity value was a single estimate from all 100 samples; it is not an average and therefore there is no standard error.</p>
</caption>
<alternatives>
<graphic id="pcbi.1006096.t002g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006096.t002" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<tbody>
<tr>
<td align="center"/>
<td align="center">Individual</td>
<td align="center" colspan="2">Pairwise</td>
<td align="center">Group</td>
</tr>
<tr>
<td align="center">Statistic</td>
<td align="center">Simpson Diversity</td>
<td align="center"><sup>2</sup><italic>D</italic> Beta Diversity</td>
<td align="center">Bray-Curtis Dissimilarity</td>
<td align="center"><sup>2</sup><italic>D</italic> Beta Diversity</td>
</tr>
<tr>
<td align="center">Actual Values</td>
<td align="center">0.002—0.9</td>
<td align="center">0.44—0.87</td>
<td align="center">0.40—1.0</td>
<td align="center">0.025</td>
</tr>
<tr>
<td align="center"/>
<td align="center" colspan="4">Average Absolute Difference (Standard Error)</td>
</tr>
<tr>
<td align="center">Karp</td>
<td align="center">0.014 (0.029)</td>
<td align="center">0.029 (0.035)</td>
<td align="center">0.009 (0.018)</td>
<td align="center">0.002</td>
</tr>
<tr>
<td align="center">Kallisto</td>
<td align="center">0.015 (0.025)</td>
<td align="center">0.037 (0.046)</td>
<td align="center">0.012 (0.023)</td>
<td align="center">0.002</td>
</tr>
<tr>
<td align="center">UCLUST</td>
<td align="center">0.079 (0.13)</td>
<td align="center">0.093 (0.090)</td>
<td align="center">0.026 (0.043)</td>
<td align="center">0.008</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>In addition to 75bp single-end reads, we simulated and classified samples with 151bp and 301bp paired-end reads, again at depths of 100,000 and 1,000,000 reads per sample, and using both the full 16S gene and just the V4 hypervariable region (<xref ref-type="fig" rid="pcbi.1006096.g003">Fig 3</xref>). With 151bp paired-end reads, in the full gene simulations at both depths, Kallisto had the lowest per reference error rate, with Karp a close second. On average Kallisto’s errors were 11% smaller than Karp’s at high depth and 19% smaller at low depth, and between 88-91% smaller than the QIIME algorithms across all comparisons. In the V4 simulations, at both depths, Karp had a substantially lower per reference error rate than the other methods: between 92% and 96% smaller across all comparisons. When we aggregated counts for references with identical taxonomic labels and compared their abundance estimates with the true values we saw different patterns in the V4 and full gene samples. In the V4 samples Karp and Karp-Collapse were very comparable with each other and had lower average errors than all other methods in almost all comparisons below the taxonomic level of class. SINTAX had the lowest errors in some low diversity bins at the taxonomic levels of family and order, and the lowest errors across the full diversity spectrum at the level of class. In the full gene simulations, Karp had the lowest average errors at taxonomic levels below class, with SINTAX the most accurate at class level classification. The second most accurate algorithm varied with taxonomic level: Kallisto at species, Karp-Collapse at genus and family, UCLUST at order, and Karp at class.</p>
<fig id="pcbi.1006096.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006096.g003</object-id>
<label>Fig 3</label>
<caption>
<title>151bp and 301bp simulation results.</title>
<p>Average relative errror (AVGRE) with 95% confidence intervals from the taxonomic quantification of simulated samples with 151bp paired-end and 301bp paired-end reads. Per reference error was calculated using the classifications from Karp, Kallisto, UCLUST, USEARCH, and SortMeRNA Only references with frequencies &gt;0.1% in either the true reference or a simulated sample were used to calculate error. (A) Per reference error in full 16S gene samples of 151bp paired-end reads. (B) Per reference level error in 151bp paired-end samples simulated using only the V4 hypervariable region of the 16S gene. (C) Per reference error in full 16S gene samples of 301bp paired-end reads. (D) Per reference error in V4 samples of 301bp paired-end reads.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006096.g003" xlink:type="simple"/>
</fig>
<p>For the 301bp paired-end reads Kallisto’s strict pseudoalignment threshold struggled to make assignments. In the deeper samples, it classified only 3.8% of reads on average (versus 53% with Karp). Note that Kallisto’s performance could be improved by subsampling shorter regions from the longer reads, although this would be removing information that Karp is currently using to assign reads. Also, the Naive Bayes quantification could not be computed for the higher depth 301bp paired-end reads for the full gene samples with the computational resources available and was therefore not compared. In the 301bp samples, at the level of correctly identifying reference sequences, Karp was the most accurate, with average errors &lt;90% smaller than Kallisto and &lt;60% smaller than the QIIME algorithms across both depths in both the full gene and V4 samples. When we looked at errors in estimating taxonomic groups in the 301bp samples we see a more complex pattern (<xref ref-type="supplementary-material" rid="pcbi.1006096.s004">S4 File</xref>). In the full gene samples, at both depths, Karp is the most accurate for estimating species and genus frequencies (Karp average error at least 12% smaller than Karp-Collapse and at least 46% smaller than all other methods across comparisons). At higher taxonomic classifications both Karp algorithms, SINTAX, and the three QIIME algorithms perform well, and different ones have the lowest error in different comparisons: across family, order, and class and both depths UCLUST has the lowest error in four of the comparisons, Karp-Collapse in one, and SINTAX in one. For the V4 samples, Karp-Collapse had the lowest average errors for estimating species, genus, and family frequencies, while SINTAX and UCLUST performed the best at classifying orders and classes. Relative to the other methods, the Karp algorithms performed best in higher diversity samples and more specific taxonomic labels. Overall, in the V4 samples with the 301bp paired-end reads the errors for both Karp algorithms, SINTAX, and the QIIME algorithms were generally very small.</p>
<p>In microbiome quantification problems it is not uncommon to have taxa present in sequenced samples that are absent from reference databases. We tested the robustness of Karp under this scenario with simulated samples containing reads from references removed from the reference databases used for quantification. For each of one phylum (<italic>Acidobacteria</italic>), one order (<italic>Pseudomonadales</italic>), and one genus (<italic>Clostridiisalibacter</italic>) we simulated 10 independent samples where 50% of reads originated from 3 different members of each taxon and created copies of the GreenGenes database where the reference sequences for every member was removed. We classified the simulated data with both the reduced databases and the full GreenGenes to measure how much the absence of relevant references impacted estimate accuracy. Karp, Kallisto, and UCLUST were all less accurate when classifying samples using the reduced databases rather than the full database (<xref ref-type="fig" rid="pcbi.1006096.g004">Fig 4</xref>). Under all scenarios Karp remained the most accurate method, and in the case of the phylum <italic>Acidobacteria</italic> and genus <italic>Clostridiisalibacter</italic> Karp’s quantification using the reduced reference database was more accurate than UCLUST using the full reference database.</p>
<fig id="pcbi.1006096.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006096.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Results with missing taxa.</title>
<p>Accuracy when the reference database used for quantification is missing taxa found in the sample. For each of one phylum (<italic>Acidobacteria</italic>), one order (<italic>Pseudomonadales</italic>), and one genus (<italic>Clostridiisalibacter</italic>), 10 samples were simulated where 50% of the reads originated from the noted taxa. Each sample was classified with the full GreenGenes database and also a reduced version of the database lacking all members of the taxa which had been used to simulate the sample. The accuracy of estimates by Karp, Kallisto, and UCLUST for the 50% of the samples that did not originate from the absent taxa were compared with their true frequencies. Black bars give 95% confidence intervals.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006096.g004" xlink:type="simple"/>
</fig>
<p>The model that underpins Karp relies on knowing the probability of a sequencing error at a given position in a read. Our work assumes that the base-quality scores are accurate estimates for the probability of sequencing error. In real data it has been recognized that base-quality scores are not always accurate, leading to the development of methods to empirically recalibrate base-quality using known monomorphic sites. With pooled microbiome samples this recalibration is complicated (possibly requiring spike-ins of known sequence during the experiment or alignment to conserved reference sequence), so we explored how differences between the expected sequencing error rate as represented by the base-quality scores and the actual sequencing error rate effect Karp’s accuracy. Under a model where the actual probability of a sequencing error was <inline-formula id="pcbi.1006096.e019"><alternatives><graphic id="pcbi.1006096.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006096.e019" xlink:type="simple"/><mml:math display="inline" id="M19"><mml:msup><mml:mn>10</mml:mn> <mml:mfrac><mml:mi>Q</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>5</mml:mn></mml:mrow></mml:mfrac></mml:msup></mml:math></alternatives></inline-formula> for quality score <italic>Q</italic>, rather than the <inline-formula id="pcbi.1006096.e020"><alternatives><graphic id="pcbi.1006096.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006096.e020" xlink:type="simple"/><mml:math display="inline" id="M20"><mml:msup><mml:mn>10</mml:mn> <mml:mfrac><mml:mi>Q</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>10</mml:mn></mml:mrow></mml:mfrac></mml:msup></mml:math></alternatives></inline-formula> assumed by our model, Karp was still on average more accurate than Kallisto or UCLUST/USEARCH (errors 12.9% smaller than Kallisto and 64.2% smaller than UCLUST, <xref ref-type="supplementary-material" rid="pcbi.1006096.s009">S5 Fig</xref>). When errors actually occurred uniformly at 1% of bases, grossly violating Karp’s model, it was still the most accurate method (errors 11.5% smaller than Kallisto, 62.8% smaller than UCLUST, <xref ref-type="supplementary-material" rid="pcbi.1006096.s009">S5 Fig</xref>).</p>
<p>The increased accuracy of Karp comes at some computational cost, especially relative to Kallisto, however it is still quite feasible for modern data. <xref ref-type="table" rid="pcbi.1006096.t003">Table 3</xref> compares the performance of the methods while classifying samples with either 10<sup>6</sup> 75bp single-end, 151bp paired-end, or 301bp paired-end reads using 12 cores, and in all cases even the full mode of Karp requires &lt;3 hours. Karp was run with default settings, in both full and collapse mode. For Karp and Kallisto the 75bp reads require longer to classify than the 151bp reads due to the larger number of multiply-mapped reads resulting from the shorter length.</p>
<table-wrap id="pcbi.1006096.t003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006096.t003</object-id>
<label>Table 3</label>
<caption>
<title>Computational requirements and speed of Karp, Kallisto, SINTAX, UCLUST, USEARCH61, SortMeRNA, and the Wang <italic>et al.</italic> (2007) Naive Bayes using Mothur.</title>
<p>All programs were run using 12 multi-threaded cores except Mothur. Mothur’s memory requirements scale with the number of cores used, and in order to keep memory &lt;16GB we limited it to 4 cores. The values for UCLUST and USEARCH give the time to assign taxonomy, generally with these methods reads are clustered before taxonomy is assigned and the value in parenthesis gives the time to first cluster and then assign taxonomy. The results for the method 16S Classifier are not shown: it was fast and required a few minutes at most; however its memory usage scaled dramatically with the number of reads. To keep memory usage &lt; 128GB samples needed to be split into several smaller samples and then reassembled. Additionally, it could not be run in parallel, so a meaningful comparison against the other methods of speed and memory requirements was not possible.</p>
</caption>
<alternatives>
<graphic id="pcbi.1006096.t003g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006096.t003" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left" rowspan="2">Method</th>
<th align="center" colspan="3">Time (Minutes)</th>
<th align="center" rowspan="2">Max Memory</th>
</tr>
<tr>
<th align="center">75bp</th>
<th align="center">151bp</th>
<th align="center">301bp</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Karp</td>
<td align="center">161.9</td>
<td align="center">24.7</td>
<td align="center">80.4</td>
<td align="center">10 GB</td>
</tr>
<tr>
<td align="left">Karp-Collapse</td>
<td align="center">36.0</td>
<td align="center">16.1</td>
<td align="center">74.5</td>
<td align="center">10 GB</td>
</tr>
<tr>
<td align="left">Kallisto</td>
<td align="center">4.5</td>
<td align="center">2.6</td>
<td align="center">1.3</td>
<td align="center">10 GB</td>
</tr>
<tr>
<td align="left">SINTAX</td>
<td align="center">267.9</td>
<td align="center">361.8</td>
<td align="center">366.5</td>
<td align="center">2 GB</td>
</tr>
<tr>
<td align="left">UCLUST</td>
<td align="center">87.4 (146.6)</td>
<td align="center">18.9 (67.1)</td>
<td align="center">3.9 (55.9)</td>
<td align="center">4 GB</td>
</tr>
<tr>
<td align="left">USEARCH61</td>
<td align="center">9.6 (27.7)</td>
<td align="center">1.4 (10.0)</td>
<td align="center">0.7 (7.1)</td>
<td align="center">4 GB</td>
</tr>
<tr>
<td align="left">SortMeRNA</td>
<td align="center">37.3</td>
<td align="center">22.3</td>
<td align="center">29.6</td>
<td align="center">4 GB</td>
</tr>
<tr>
<td align="left">Mothur Naive Bayes<xref ref-type="table-fn" rid="t003fn001">*</xref></td>
<td align="center">502.4</td>
<td align="center">1578.2</td>
<td align="center">NA</td>
<td align="center">16 GB</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t003fn001"><p>*limited to 4 cores</p></fn>
</table-wrap-foot>
</table-wrap>
</sec>
<sec id="sec016">
<title>Performance assessment in real 16S rRNA data</title>
<p>We next sought to evaluate the relative performance of the method in the context of real 16S data, where the true composition of samples is unknown. As a testbed, we re-analyzed data from a recent large-scale human nasal microbiome study [<xref ref-type="bibr" rid="pcbi.1006096.ref042">42</xref>] that aimed to detect associations between the relative frequencies of genera level taxa and host genotypes. For this study, genome-wide association studies (GWAS) are carried out where each genus is tested for association with each individual genotyped variant present in the genomes of the host individuals. Because lower rates of measurement error should allow for the discovery of more associations, we evaluated classification methods on the number of discovered associations, controlling for false discovery rate (FDR). Specifically, we classified 332 16S samples sequenced from 144 Hutterite individuals. The samples were brushed from two nasal locations (nasopharynx and vestibule) during two seasons (summer and winter). We classified the samples using the Karp algorithm, the Karp-Collapse algorithm, and Kallisto. We also used previous classification data created using the UCLUST algorithm [<xref ref-type="bibr" rid="pcbi.1006096.ref042">42</xref>]. With all four classification methods we tested for additive effects in the relative abundances of 369 genera level taxa from 3,161,460 SNPs using a linear mixed model that controlled for relatedness between the Hutterite individuals. Following the approach of Igartua et al. (2017) we used 148,653 SNPs with linkage disequilibrium <italic>r</italic><sup>2</sup> &lt; 0.5 as a set of independent tests to calculate the false discovery rate (FDR). For this study we classified associations as independent if they involved different seasons, different genera, or had LD <italic>r</italic><sup>2</sup> &lt; 0.5 and were &gt;10kb apart.</p>
<p>The summer samples were more taxonomically diverse than the winter samples, and this was reflected in the number of associations detected, particularly in the nasopharynx. Across the four classification methods, at an FDR of 0.05, associations with 63 distinct genera were detected. Across the two tissues and two seasons, at an FDR rate of 0.05, the Karp-Collapse method detected 53 associations with 32 distinct genera (27 summer nasopharynx (SN), 8 summer vestibule (SV), 10 winter nasopharynx (WN), 8 winter vestibule (WV)), the Karp method 40 associations with 26 genera (17 SN, 9 SV, 10 WN, 4 WV), Kallisto 38 associations with 27 genera (23 SN, 4 SV, 5 WN, 6 WV), and the UCLUST algorithm 42 associations with 18 genera (15 SN, 11 SV, 2 WN, 6 WV) (<xref ref-type="supplementary-material" rid="pcbi.1006096.s011">S7 Fig</xref>). The relative ordering of methods, from most discoveries to least, was not dependent on the qvalue cutoff chosen, at a 0.1 threshold (131 Karp-Collapse, 121 Karp, 95 Kallisto, 120 UCLUST) and 0.01 threshold (12 Karp-Collapse, 4 Karp, 9 Kallisto, 8 UCLUST) the Karp-Collapse method also detected the most total associations. At an FDR threshold of 0.05, if we classify a signal as overlapping between methods when it is for the same genus, same season, and for SNPs with <italic>r</italic><sup>2</sup> &gt; 0.5 within 10kb, the overlap between the Karp algorithms was 0.12 (10/83), it varied between 0.08 and 0.11 for either Karp algorithm and Kallisto or UCLUST. Kallisto and UCLUST only shared 0.04 (3/77) of their total associations.</p>
</sec>
</sec>
<sec id="sec017" sec-type="conclusions">
<title>Discussion</title>
<p>In both simulations and real 16S data we have shown that Karp is an accurate and computationally feasible method for estimating the relative frequencies of contributing members in a pooled DNA sample. Although not as fast as some alternatives, Karp’s superior accuracy across the tested range of read lengths, taxonomic levels, and absent references makes a strong case for its adoption.</p>
<p>Although our work here has focused on applying Karp in the context of 16S microbiome experiments, its potential uses extend to most closed-reference quantification problems. Pooled DNA experiments are common in many fields. The identification and estimation of contributor abundance in whole genome metagenomics, pooled sequencing of data from artificial selection experiments, and RNA isoform identification are all possible with Karp. The limiting factor with extending Karp is not related to data type, but the diversity of kmers in the potential reference databases. The memory requirements of creating the the pseudoalignment kmer index is the limiting step, and is shared equally by Karp and Kallisto. For such applications, finding a suitable reference may be challenging, but the resulting improvements in accuracy from the application of Karp should be available.</p>
<p>A important consideration when designing a 16S sequencing experiment is how much of the gene to sequence, and what reference database to use for profiling. It has previously often been preferred to sequence either one or few hypervariable regions, in part to prevent clustering algorithms like those in QIIME from creating multiple taxonomic groups from the same reference at different regions. With Karp and Kallisto this concern can be ignored, opening up the possibility of capturing more fine scale information about the organisms present in a sample by sequencing a longer portion of their genome. In our V4 simulations we used a reference database that had been pared down to non-redundant reference sequences, so that we could definitively assess whether the estimate frequencies were accurate. This is not necessarily possible or desirable in a real experiment, and the cost of that needs to be understood. The shorter the reference used the more likely there are closely related organisms with identical reference sequences. Many more taxa have identical sequences across a single hypervariable region than across the entire 16S gene. Under such conditions the difference between methods that probabilistically assign reads to references, like Karp and Kallisto, and those that make a hard assignment, like UCLUST or USEARCH, can arise. With Karp, when references are nearly identical they will receive nearly equal probability weights from each read that maps to them, and the result will be many closely related references at low frequencies. With UCLUST or other similarity score methods, the references are sorted and the first of the closely related references to appear in the sorting order will be assigned all or nearly all the references, regardless of if it is the actual contributing organism. The truth in this case, is that the sequencing data does not contain enough information to accurately distinguish between the references, and both methods end up at sub-optimal, albeit different solutions. Under such conditions researches need to have a realistic expectation of what they can resolve in their data, and it is likely that inferences of higher-level taxonomic abundances rather than individual references are more likely to be robust. In such situations the Karp-Collapse algorithm is likely to perform well, as was the case with the real data association testing performed for this study. Now that the computational methods exist to work with multiple hypervariable regions or even the entire gene, we would suggest that experimenters could benefit substantially from sequencing more than is often presently used.</p>
<p>In addition to k-mer length, Karp users can adjust the thresholds for minimum frequency during the update step of the EM algorithm and the likelihood filter z-score. While results are often relatively invariant across a broad range of threshold values (<xref ref-type="supplementary-material" rid="pcbi.1006096.s005">S1</xref>, <xref ref-type="supplementary-material" rid="pcbi.1006096.s006">S2</xref> and <xref ref-type="supplementary-material" rid="pcbi.1006096.s007">S3</xref> Figs), avoiding extreme threshold values can improve quantification accuracy substantially. Practical guidance for setting the thresholds is given in Supplementary file S3 <xref ref-type="supplementary-material" rid="pcbi.1006096.s003">S3 File</xref>. It is worth noting that Karp’s tuning parameters influence performance as well as accuracy, so choosing optimum values can improve not just accuracy but experimental run time as well.</p>
<p>In both ecology and human health a greater understanding of the microbiome promises medical and scientific breakthroughs. Modern sequencing technology gives us unprecedented access to these microbial communities, but only if we can correctly interpret the pooled DNA that sequencing generates can we hope to make significant progress. Towards that end, Karp provides a novel combination of speed and accuracy that makes it uniquely suited for scientists seeking to make the most out of their samples.</p>
</sec>
<sec id="sec018">
<title>Supporting information</title>
<supplementary-material id="pcbi.1006096.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006096.s001" xlink:type="simple">
<label>S1 File</label>
<caption>
<title>EM algorithm details.</title>
<p>A more detailed description of the EM algorithm used by Karp.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006096.s002" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006096.s002" xlink:type="simple">
<label>S2 File</label>
<caption>
<title>Likelihood filter details.</title>
<p>A more detailed description of the maximum likelihood z-score filter used by Karp.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006096.s003" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006096.s003" xlink:type="simple">
<label>S3 File</label>
<caption>
<title>Effect of Karp tuning parameters on run-time and accuracy.</title>
<p>Discussion of the impact of Karp’s tuning parameters on the accuracy of results and the speed of computation, related to <xref ref-type="supplementary-material" rid="pcbi.1006096.s005">S1</xref>, <xref ref-type="supplementary-material" rid="pcbi.1006096.s006">S2</xref> and <xref ref-type="supplementary-material" rid="pcbi.1006096.s007">S3</xref> Figs.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006096.s004" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006096.s004" xlink:type="simple">
<label>S4 File</label>
<caption>
<title>Full simulation results table.</title>
<p>Mean and standard deviation AVGRE values for all permutations of read length and sample depth for both the full 16S gene and V4 hypervariable region simulations. Includes the per reference error values as well as the results when estimates were collapsed to species, genus, family, order, or class classification.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006096.s005" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006096.s005" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>K-mer length and Karp performance.</title>
<p>Impact of k-mer length on Karp performance. Pseudoalignment indexes constructed using different k-mer lengths were used to classify 30 previously analyzed samples selected to cover a full range of Shannon Diversities. For each of 75bp, 151bp, and 301bp reads 10 samples of 1,000,000 reads were analyzed. (A) The average error values with 95% confidence intervals for each read length. (B) Average run times using 12-cores in parallel.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006096.s006" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006096.s006" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Impact of EM update minimum frequency threshold on program performance.</title>
<p>Karp uses an EM algorithm to estimate the relative frequencies of reference sequences in a pooled sample. During the EM process a minimum frequency threshold can be applied that removes references with frequencies below this threshold. Set at a low frequency, the threshold helps remove spurious findings and improves accuracy, particularly for shorter reads. At higher frequencies the threshold removes references actually present in the sample and lowers accuracy. In this figure different thresholds are applied during quantification of 30 previously analyzed samples selected to cover a full range of Shannon Diversities. K-mers of length 19 were used for these analyses. For lengths of 75bp, 151bp, and 301bp 10 samples were analyzed. (A) The average error values with 95% confidence intervals for each read length. (B) Average run times using 12-cores in parallel. For shorter reads, increasing the threshold reduces the number of EM iterations required to converge and decreases run-time.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006096.s007" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006096.s007" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Impact of the EM update minimum frequency threshold on performance in common references.</title>
<p>The impact of the EM frequency threshold is smaller when analyzing error in the estimates of more common references. Solid lines present the error calculated using all references classified, dashed lines give the error when only references with an actual or estimated frequency above &gt;0.1%, a cut-off used frequently in this study. In such cases the chosen frequency threshold is less important.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006096.s008" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006096.s008" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>Properties of simulated 75bp samples.</title>
<p>Each simulated dataset contains reads from a mixture of 1,000 reference sequences (each an operational taxonomic unit: OTU). The frequencies at which reads were generated from contributing references were varied to create datasets with a range of Shannon Diversity. As diversity increases the frequency distribution begins to approach a uniform distribution.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006096.s009" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006096.s009" xlink:type="simple">
<label>S5 Fig</label>
<caption>
<title>Robustness of assumption that base quality scores reflect rate of sequencing error.</title>
<p>Impact of assumption that base-quality scores accurately represent probability of sequencing error. For two different models of sequencing error we simulated 50 samples and classified them with Karp, Kallisto, and UCLUST/USEARCH. Each method is represented by a different colored line, and bars represent 95% confidence intervals (A) In our first model the true rate of sequencing error varied with the base-quality score, but was smaller than Karp’s model assumes. (B) In our second model, errors were distributed uniformly at 1% of bases in each read, independent of whatever base-quality score was assigned.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006096.s010" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006096.s010" xlink:type="simple">
<label>S6 Fig</label>
<caption>
<title>Accuracy of methods in simulated data when classifying 75bp samples at higher taxonomic levels.</title>
<p>Average absolute error and 95% confidence intervals from the taxonomic quantification of 110 simulated samples, each comprised of 1,000,000 75bp paired-end reads. Taxonomy was classified using Karp, Kallisto, SINTAX, UCLUST, USEARCH, SortMeRNA, and the Naive Bayes implemented in Mothur. Counts were aggregated for OTUs classified in the same (A) family, (B) order, or (C) class and taxa with a frequency &gt;0.1% were compared to their true counts.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006096.s011" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006096.s011" xlink:type="simple">
<label>S7 Fig</label>
<caption>
<title>Genomic association results with genera level taxa in real 16S sequencing data.</title>
<p>Associations between the relative abundances of 369 genera level taxa in 332 16S sequencing samples and their host genomes. The 16S samples were drawn from brushings of two tissues, the nasopharynx and nasal vestibule, during either the summer or the winter. 3,161,460 SNPs were tested for association with the relative genera abundances estimated by four methods: Karp, Karp-Collapse, Kallisto, and UCLUST. There was greater microbiome diversity in the summer samples, particularly those from the nasopharynx, and this was reflected in a greater number of associations across all classification methods. At FDR thresholds of 0.01, 0.05, and 0.1 the Karp-Collapse method detected the most independent associations, and with the most distinct genera. Additionally, the Karp algorithms and Kallisto also shared a larger group of common associations with each other than they did with UCLUST.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We would like to thank Katie Igartua and the Ober Lab as well as Simon Lax and the Gilbert Lab at University of Chicago for sharing technical expertise and data for this study. Chaoxing Dai wrote a C++ version of the R-package SQUAREM that provided a template for our own implementation in Karp. Emily Davenport provided helpful feedback on the manuscript. This work was completed in part with resources provided by the University of Chicago Research Computing Center.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1006096.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Davenport</surname> <given-names>ER</given-names></name>, <name name-style="western"><surname>Mizrahi-Man</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Michelini</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Barreiro</surname> <given-names>LB</given-names></name>, <name name-style="western"><surname>Ober</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Gilad</surname> <given-names>Y</given-names></name>. <article-title>Seasonal Variation in Human Gut Microbiome Composition</article-title>. <source>PLoS One</source>. <year>2014</year>;<volume>9</volume>:<fpage>e90731</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0090731" xlink:type="simple">10.1371/journal.pone.0090731</ext-link></comment> <object-id pub-id-type="pmid">24618913</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006096.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wu</surname> <given-names>GD</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Hoffmann</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Bittinger</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>YY</given-names></name>, <name name-style="western"><surname>Keilbaugh</surname> <given-names>SA</given-names></name>, <etal>et al</etal>. <article-title>Linking long-term dietary patterns with gut microbial enterotypes</article-title>. <source>Science</source>. <year>2011</year>;<volume>334</volume>:<fpage>105</fpage>–<lpage>8</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.1208344" xlink:type="simple">10.1126/science.1208344</ext-link></comment> <object-id pub-id-type="pmid">21885731</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006096.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Turnbaugh</surname> <given-names>PJ</given-names></name>, <name name-style="western"><surname>Hamady</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Yatsunenko</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Cantarel</surname> <given-names>BL</given-names></name>, <name name-style="western"><surname>Duncan</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Ley</surname> <given-names>RE</given-names></name>, <etal>et al</etal>. <article-title>A core gut microbiome in obese and lean twins</article-title>. <source>Nature</source>. <year>2009</year>;<volume>457</volume>:<fpage>480</fpage>–<lpage>4</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature07540" xlink:type="simple">10.1038/nature07540</ext-link></comment> <object-id pub-id-type="pmid">19043404</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006096.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Metcalf</surname> <given-names>JL</given-names></name>, <name name-style="western"><surname>Xu</surname> <given-names>ZZ</given-names></name>, <name name-style="western"><surname>Weiss</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Lax</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Van Treuren</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Hyde</surname> <given-names>ER</given-names></name>, <etal>et al</etal>. <article-title>Microbial community assembly and metabolic function during mammalian corpse decomposition</article-title>. <source>Science</source>. <year>2016</year>;<volume>351</volume>:<fpage>158</fpage>–<lpage>62</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.aad2646" xlink:type="simple">10.1126/science.aad2646</ext-link></comment> <object-id pub-id-type="pmid">26657285</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006096.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Godon</surname> <given-names>JJ</given-names></name>, <name name-style="western"><surname>Arulazhagan</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Steyer</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Hamelin</surname> <given-names>J</given-names></name>. <article-title>Vertebrate bacterial gut diversity: size also matters</article-title>. <source>BMC Ecol</source>. <year>2016</year>;<volume>16</volume>:<fpage>12</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/s12898-016-0071-2" xlink:type="simple">10.1186/s12898-016-0071-2</ext-link></comment> <object-id pub-id-type="pmid">27008566</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006096.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cleary</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Brito</surname> <given-names>IL</given-names></name>, <name name-style="western"><surname>Huang</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Gevers</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Shea</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Young</surname> <given-names>S</given-names></name>, <etal>et al</etal>. <article-title>Detection of low-abundance bacterial strains in metagenomic datasets by eigengenome partitioning</article-title>. <source>Nat Biotechnol</source>. <year>2015</year>;<volume>33</volume>:<fpage>1053</fpage>–<lpage>1060</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nbt.3329" xlink:type="simple">10.1038/nbt.3329</ext-link></comment> <object-id pub-id-type="pmid">26368049</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006096.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Howe</surname> <given-names>AC</given-names></name>, <name name-style="western"><surname>Jansson</surname> <given-names>JK</given-names></name>, <name name-style="western"><surname>Malfatti</surname> <given-names>SA</given-names></name>, <name name-style="western"><surname>Tringe</surname> <given-names>SG</given-names></name>, <name name-style="western"><surname>Tiedje</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>CT</given-names></name>. <article-title>Tackling soil diversity with the assembly of large, complex metagenomes</article-title>. <source>Proc Natl Acad Sci USA</source>. <year>2014</year>;<volume>111</volume>:<fpage>4904</fpage>–<lpage>4909</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1402564111" xlink:type="simple">10.1073/pnas.1402564111</ext-link></comment> <object-id pub-id-type="pmid">24632729</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006096.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Boisvert</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Raymond</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Godzaridis</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Laviolette</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Corbeil</surname> <given-names>J</given-names></name>. <article-title>Ray Meta: scalable de novo metagenome assembly and profiling</article-title>. <source>Genome Biol</source>. <year>2012</year>;<volume>13</volume>:<fpage>R122</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/gb-2012-13-12-r122" xlink:type="simple">10.1186/gb-2012-13-12-r122</ext-link></comment> <object-id pub-id-type="pmid">23259615</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006096.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Scholz</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Ward</surname> <given-names>DV</given-names></name>, <name name-style="western"><surname>Pasolli</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Tolio</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Zolfo</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Asnicar</surname> <given-names>F</given-names></name>, <etal>et al</etal>. <article-title>Strain-level microbial epidemiology and population genomics from shotgun metagenomics</article-title>. <source>Nat Methods</source>. <year>2016</year>;<volume>13</volume>:<fpage>435</fpage>–<lpage>438</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nmeth.3802" xlink:type="simple">10.1038/nmeth.3802</ext-link></comment> <object-id pub-id-type="pmid">26999001</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006096.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cole</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>Q</given-names></name>, <name name-style="western"><surname>Fish</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Chai</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>McGarrell</surname> <given-names>DM</given-names></name>, <name name-style="western"><surname>Sun</surname> <given-names>Y</given-names></name>, <etal>et al</etal>. <article-title>Ribosomal Database Project: data and tools for high throughput rRNA analysis</article-title>. <source>Nucleic Acids Res</source>. <year>2014</year>;<volume>42</volume>:<fpage>D633</fpage>–<lpage>642</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gkt1244" xlink:type="simple">10.1093/nar/gkt1244</ext-link></comment> <object-id pub-id-type="pmid">24288368</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006096.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Quast</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Pruesse</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Yilmaz</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Gerken</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Schweer</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Yarza</surname> <given-names>P</given-names></name>, <etal>et al</etal>. <article-title>The SILVA ribosomal RNA gene database project: improved data processing and web-based tools</article-title>. <source>Nucleic Acids Res</source>. <year>2013</year>;<volume>41</volume>:<fpage>D590</fpage>–<lpage>596</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gks1219" xlink:type="simple">10.1093/nar/gks1219</ext-link></comment> <object-id pub-id-type="pmid">23193283</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006096.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>DeSantis</surname> <given-names>TZ</given-names></name>, <name name-style="western"><surname>Hugenholtz</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Larsen</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Rojas</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Brodie</surname> <given-names>EL</given-names></name>, <name name-style="western"><surname>Keller</surname> <given-names>K</given-names></name>, <etal>et al</etal>. <article-title>Greengenes, a chimera-checked 16S rRNA gene database and workbench compatible with ARB</article-title>. <source>Appl Environ Microbiol</source>. <year>2006</year>;<volume>72</volume>:<fpage>5069</fpage>–<lpage>5072</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1128/AEM.03006-05" xlink:type="simple">10.1128/AEM.03006-05</ext-link></comment> <object-id pub-id-type="pmid">16820507</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006096.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Howe</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Ringus</surname> <given-names>DL</given-names></name>, <name name-style="western"><surname>Williams</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Choo</surname> <given-names>ZN</given-names></name>, <name name-style="western"><surname>Greenwald</surname> <given-names>SM</given-names></name>, <name name-style="western"><surname>Owens</surname> <given-names>SM</given-names></name>, <etal>et al</etal>. <article-title>Divergent responses of viral and bacterial communities in the gut microbiome to dietary disturbances in mice</article-title>. <source>ISME J</source>. <year>2016</year>;<volume>10</volume>:<fpage>1217</fpage>–<lpage>1227</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ismej.2015.183" xlink:type="simple">10.1038/ismej.2015.183</ext-link></comment> <object-id pub-id-type="pmid">26473721</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006096.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ahn</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Yang</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Paster</surname> <given-names>BJ</given-names></name>, <name name-style="western"><surname>Ganly</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Morris</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Pei</surname> <given-names>Z</given-names></name>, <etal>et al</etal>. <article-title>Oral microbiome profiles: 16S rRNA pyrosequencing and microarray assay comparison</article-title>. <source>PLoS ONE</source>. <year>2011</year>;<volume>6</volume>:<fpage>e22788</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0022788" xlink:type="simple">10.1371/journal.pone.0022788</ext-link></comment> <object-id pub-id-type="pmid">21829515</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006096.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Chakravorty</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Helb</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Burday</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Connell</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Alland</surname> <given-names>D</given-names></name>. <article-title>A detailed analysis of 16S ribosomal RNA gene segments for the diagnosis of pathogenic bacteria</article-title>. <source>J Microbiol Methods</source>. <year>2007</year>;<volume>69</volume>:<fpage>330</fpage>–<lpage>339</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.mimet.2007.02.005" xlink:type="simple">10.1016/j.mimet.2007.02.005</ext-link></comment> <object-id pub-id-type="pmid">17391789</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006096.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Altschul</surname> <given-names>SF</given-names></name>, <name name-style="western"><surname>Gish</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Miller</surname> <given-names>EW</given-names></name> <name name-style="western"><surname>Myers</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Lipman</surname> <given-names>DJ</given-names></name>. <article-title>Basic local alignment search tool</article-title>. <source>J Mol Biol</source>. <year>1990</year>;<volume>215</volume>:<fpage>403</fpage>–<lpage>10</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/S0022-2836(05)80360-2" xlink:type="simple">10.1016/S0022-2836(05)80360-2</ext-link></comment> <object-id pub-id-type="pmid">2231712</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006096.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Glass</surname> <given-names>EM</given-names></name>, <name name-style="western"><surname>Wilkening</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Wilke</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Antonopoulos</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Meyer</surname> <given-names>F</given-names></name>. <article-title>Using the metagenomics RAST server (MG-RAST) for analyzing shotgun metagenomes</article-title>. <source>Cold Spring Harb Protoc</source>. <year>2010</year>;<volume>2010</volume>:pdb.prot5368. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1101/pdb.prot5368" xlink:type="simple">10.1101/pdb.prot5368</ext-link></comment> <object-id pub-id-type="pmid">20150127</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006096.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Horton</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Bodenhausen</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Bergelson</surname> <given-names>J</given-names></name>. <article-title>MARTA: a suite of Java-based tools for assigning taxonomic status to DNA sequences</article-title>. <source>Bioinformatics</source>. <year>2010</year>;<volume>26</volume>:<fpage>568</fpage>–<lpage>569</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btp682" xlink:type="simple">10.1093/bioinformatics/btp682</ext-link></comment> <object-id pub-id-type="pmid">20007739</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006096.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Huson</surname> <given-names>DH</given-names></name>, <name name-style="western"><surname>Auch</surname> <given-names>AF</given-names></name>, <name name-style="western"><surname>Qi</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Schuster</surname> <given-names>SC</given-names></name>. <article-title>MEGAN analysis of metagenomic data</article-title>. <source>Genome Res</source>. <year>2007</year>;<volume>17</volume>:<fpage>377</fpage>–<lpage>386</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1101/gr.5969107" xlink:type="simple">10.1101/gr.5969107</ext-link></comment> <object-id pub-id-type="pmid">17255551</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006096.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Edgar</surname> <given-names>RC</given-names></name>. <article-title>Search and clustering orders of magnitude faster than BLAST</article-title>. <source>Bioinformatics</source>. <year>2010</year>;<volume>26</volume>:<fpage>2460</fpage>–<lpage>2461</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btq461" xlink:type="simple">10.1093/bioinformatics/btq461</ext-link></comment> <object-id pub-id-type="pmid">20709691</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006096.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Edgar</surname> <given-names>RC</given-names></name>. <article-title>UPARSE: highly accurate OTU sequences from microbial amplicon reads</article-title>. <source>Nat Methods</source>. <year>2013</year>;<volume>10</volume>:<fpage>996</fpage>–<lpage>998</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nmeth.2604" xlink:type="simple">10.1038/nmeth.2604</ext-link></comment> <object-id pub-id-type="pmid">23955772</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006096.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Al-Ghalith</surname> <given-names>GA</given-names></name>, <name name-style="western"><surname>Montassier</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Ward</surname> <given-names>HN</given-names></name>, <name name-style="western"><surname>Knights</surname> <given-names>D</given-names></name>. <article-title>NINJA-OPS: Fast Accurate Marker Gene Alignment Using Concatenated Ribosomes</article-title>. <source>PLoS Comput Biol</source>. <year>2016</year>;<volume>12</volume>:<fpage>e1004658</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1004658" xlink:type="simple">10.1371/journal.pcbi.1004658</ext-link></comment> <object-id pub-id-type="pmid">26820746</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006096.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Albanese</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Fontana</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>De Filippo</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Cavalieri</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Donati</surname> <given-names>C</given-names></name>. <article-title>MICCA: a complete and accurate software for taxonomic profiling of metagenomic data</article-title>. <source>Sci Rep</source>. <year>2015</year>;<volume>5</volume>:<fpage>9743</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/srep09743" xlink:type="simple">10.1038/srep09743</ext-link></comment> <object-id pub-id-type="pmid">25988396</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006096.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mahe</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Rognes</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Quince</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>de Vargas</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Dunthorn</surname> <given-names>M</given-names></name>. <article-title>Swarm: robust and fast clustering method for amplicon-based studies</article-title>. <source>PeerJ</source>. <year>2014</year>;<volume>2</volume>:<fpage>e593</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.7717/peerj.593" xlink:type="simple">10.7717/peerj.593</ext-link></comment> <object-id pub-id-type="pmid">25276506</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006096.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kopylova</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Noe</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Touzet</surname> <given-names>H</given-names></name>. <article-title>SortMeRNA: fast and accurate filtering of ribosomal RNAs in metatranscriptomic data</article-title>. <source>Bioinformatics</source>. <year>2012</year>;<volume>28</volume>:<fpage>3211</fpage>–<lpage>3217</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/bts611" xlink:type="simple">10.1093/bioinformatics/bts611</ext-link></comment> <object-id pub-id-type="pmid">23071270</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006096.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kopylova</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Navas-Molina</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Mercier</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Xu</surname> <given-names>ZZ</given-names></name>, <name name-style="western"><surname>Mahé</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>He</surname> <given-names>Y</given-names></name>, <etal>et al</etal>. <article-title>Open-Source Sequence Clustering Methods Improve the State Of the Art</article-title>. <source>mSystems</source>. <year>2016</year>;<volume>1</volume>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1128/mSystems.00003-15" xlink:type="simple">10.1128/mSystems.00003-15</ext-link></comment> <object-id pub-id-type="pmid">27822515</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006096.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Berger</surname> <given-names>SA</given-names></name>, <name name-style="western"><surname>Krompass</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Stamatakis</surname> <given-names>A</given-names></name>. <article-title>Performance, accuracy, and Web server for evolutionary placement of short sequence reads under maximum likelihood</article-title>. <source>Syst Biol</source>. <year>2011</year>;<volume>60</volume>:<fpage>291</fpage>–<lpage>302</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/sysbio/syr010" xlink:type="simple">10.1093/sysbio/syr010</ext-link></comment> <object-id pub-id-type="pmid">21436105</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006096.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Matsen</surname> <given-names>FA</given-names></name>, <name name-style="western"><surname>Kodner</surname> <given-names>RB</given-names></name>, <name name-style="western"><surname>Armbrust</surname> <given-names>EV</given-names></name>. <article-title>pplacer: linear time maximum-likelihood and Bayesian phylogenetic placement of sequences onto a fixed reference tree</article-title>. <source>BMC Bioinformatics</source>. <year>2010</year>;<volume>11</volume>:<fpage>538</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/1471-2105-11-538" xlink:type="simple">10.1186/1471-2105-11-538</ext-link></comment> <object-id pub-id-type="pmid">21034504</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006096.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Price</surname> <given-names>MN</given-names></name>, <name name-style="western"><surname>Dehal</surname> <given-names>PS</given-names></name>, <name name-style="western"><surname>Arkin</surname> <given-names>AP</given-names></name>. <article-title>FastTree: computing large minimum evolution trees with profiles instead of a distance matrix</article-title>. <source>Mol Biol Evol</source>. <year>2009</year>;<volume>26</volume>:<fpage>1641</fpage>–<lpage>1650</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/molbev/msp077" xlink:type="simple">10.1093/molbev/msp077</ext-link></comment> <object-id pub-id-type="pmid">19377059</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006096.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bazinet</surname> <given-names>AL</given-names></name>, <name name-style="western"><surname>Cummings</surname> <given-names>MP</given-names></name>. <article-title>A comparative evaluation of sequence classification programs</article-title>. <source>BMC Bioinformatics</source>. <year>2012</year>;<volume>13</volume>:<fpage>92</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/1471-2105-13-92" xlink:type="simple">10.1186/1471-2105-13-92</ext-link></comment> <object-id pub-id-type="pmid">22574964</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006096.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rosen</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Garbarine</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Caseiro</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Polikar</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Sokhansanj</surname> <given-names>B</given-names></name>. <article-title>Metagenome fragment classification using N-mer frequency profiles</article-title>. <source>Adv Bioinformatics</source>. <year>2008</year>;<volume>2008</volume>:<fpage>205969</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1155/2008/205969" xlink:type="simple">10.1155/2008/205969</ext-link></comment> <object-id pub-id-type="pmid">19956701</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006096.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>McHardy</surname> <given-names>AC</given-names></name>, <name name-style="western"><surname>Martin</surname> <given-names>HG</given-names></name>, <name name-style="western"><surname>Tsirigos</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Hugenholtz</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Rigoutsos</surname> <given-names>I</given-names></name>. <article-title>Accurate phylogenetic classification of variable-length DNA fragments</article-title>. <source>Nat Methods</source>. <year>2007</year>;<volume>4</volume>:<fpage>63</fpage>–<lpage>72</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nmeth976" xlink:type="simple">10.1038/nmeth976</ext-link></comment> <object-id pub-id-type="pmid">17179938</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006096.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wang</surname> <given-names>Q</given-names></name>, <name name-style="western"><surname>Garrity</surname> <given-names>GM</given-names></name>, <name name-style="western"><surname>Tiedje</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Cole</surname> <given-names>JR</given-names></name>. <article-title>Naive Bayesian classifier for rapid assignment of rRNA sequences into the new bacterial taxonomy</article-title>. <source>Appl Environ Microbiol</source>. <year>2007</year>;<volume>73</volume>:<fpage>5261</fpage>–<lpage>5267</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1128/AEM.00062-07" xlink:type="simple">10.1128/AEM.00062-07</ext-link></comment> <object-id pub-id-type="pmid">17586664</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006096.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wood</surname> <given-names>DE</given-names></name>, <name name-style="western"><surname>Salzberg</surname> <given-names>SL</given-names></name>. <article-title>Kraken: ultrafast metagenomic sequence classification using exact alignments</article-title>. <source>Genome Biol</source>. <year>2014</year>;<volume>15</volume>:<fpage>R46</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/gb-2014-15-3-r46" xlink:type="simple">10.1186/gb-2014-15-3-r46</ext-link></comment> <object-id pub-id-type="pmid">24580807</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006096.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ounit</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Wanamaker</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Close</surname> <given-names>TJ</given-names></name>, <name name-style="western"><surname>Lonardi</surname> <given-names>S</given-names></name>. <article-title>CLARK: fast and accurate classification of metagenomic and genomic sequences using discriminative k-mers</article-title>. <source>BMC Genomics</source>. <year>2015</year>;<volume>16</volume>:<fpage>236</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/s12864-015-1419-2" xlink:type="simple">10.1186/s12864-015-1419-2</ext-link></comment> <object-id pub-id-type="pmid">25879410</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006096.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lindgreen</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Adair</surname> <given-names>KL</given-names></name>, <name name-style="western"><surname>Gardner</surname> <given-names>PP</given-names></name>. <article-title>An evaluation of the accuracy and speed of metagenome analysis tools</article-title>. <source>Sci Rep</source>. <year>2016</year>;<volume>6</volume>:<fpage>19233</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/srep19233" xlink:type="simple">10.1038/srep19233</ext-link></comment> <object-id pub-id-type="pmid">26778510</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006096.ref037">
<label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sczyrba</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Hofmann</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Belmann</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Koslicki</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Janssen</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Droege</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Critical Assessment of Metagenome Interpretation—a benchmark of computational metagenomics software</article-title>. <source>bioRxiv</source>. <year>2017</year>;</mixed-citation>
</ref>
<ref id="pcbi.1006096.ref038">
<label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bray</surname> <given-names>NL</given-names></name>, <name name-style="western"><surname>Pimentel</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Melsted</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Pachter</surname> <given-names>L</given-names></name>. <article-title>Near-optimal probabilistic RNA-seq quantification</article-title>. <source>Nat Biotechnol</source>. <year>2016</year>;. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nbt0816-888d" xlink:type="simple">10.1038/nbt0816-888d</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006096.ref039">
<label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Schaeffer</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Pimentel</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Bray</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Melsted</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Pachter</surname> <given-names>L</given-names></name>. <source>Pseudoalignment for metagenomic read assignment</source>. arXiv, 151007371v2 [q-bioQM]. <year>2015</year>;.</mixed-citation>
</ref>
<ref id="pcbi.1006096.ref040">
<label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Teo</surname> <given-names>YV</given-names></name>, <name name-style="western"><surname>Neretti</surname> <given-names>N</given-names></name>. <article-title>A comparative study of metagenomics analysis pipelines at the species level</article-title>. <source>bioRxiv</source>. <year>2016</year>; p. <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/081141" xlink:type="simple">http://dx.doi.org/10.1101/081141</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006096.ref041">
<label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Chaudhary</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Sharma</surname> <given-names>AK</given-names></name>, <name name-style="western"><surname>Agarwal</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Gupta</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Sharma</surname> <given-names>VK</given-names></name>. <article-title>16S classifier: a tool for fast and accurate taxonomic classification of 16S rRNA hypervariable regions in metagenomic datasets</article-title>. <source>PLoS ONE</source>. <year>2015</year>;<volume>10</volume>:<fpage>e0116106</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0116106" xlink:type="simple">10.1371/journal.pone.0116106</ext-link></comment> <object-id pub-id-type="pmid">25646627</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006096.ref042">
<label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Igartua</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Davenport</surname> <given-names>ER</given-names></name>, <name name-style="western"><surname>Gilad</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Nicolae</surname> <given-names>DL</given-names></name>, <name name-style="western"><surname>Pinto</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Ober</surname> <given-names>C</given-names></name>. <article-title>Host genetic variation in mucosal immunity pathways influences the upper airway microbiome</article-title>. <source>Microbiome</source>. <year>2017</year>;<volume>5</volume>(<issue>1</issue>):<fpage>16</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/s40168-016-0227-5" xlink:type="simple">10.1186/s40168-016-0227-5</ext-link></comment> <object-id pub-id-type="pmid">28143570</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006096.ref043">
<label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zhao</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>WP</given-names></name>, <name name-style="western"><surname>Garrison</surname> <given-names>EP</given-names></name>, <name name-style="western"><surname>Marth</surname> <given-names>GT</given-names></name>. <article-title>SSW library: an SIMD Smith-Waterman C/C++ library for use in genomic applications</article-title>. <source>PLoS ONE</source>. <year>2013</year>;<volume>8</volume>:<fpage>e82138</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0082138" xlink:type="simple">10.1371/journal.pone.0082138</ext-link></comment> <object-id pub-id-type="pmid">24324759</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006096.ref044">
<label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Farrar</surname> <given-names>M</given-names></name>. <article-title>Striped Smith-Waterman speeds database searches six times over other SIMD implementations</article-title>. <source>Bioinformatics</source>. <year>2007</year>;<volume>23</volume>:<fpage>156</fpage>–<lpage>161</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btl582" xlink:type="simple">10.1093/bioinformatics/btl582</ext-link></comment> <object-id pub-id-type="pmid">17110365</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006096.ref045">
<label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kessner</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Turner</surname> <given-names>TL</given-names></name>, <name name-style="western"><surname>Novembre</surname> <given-names>J</given-names></name>. <article-title>Maximum likelihood estimation of frequencies of known haplotypes from pooled sequence data</article-title>. <source>Mol Biol Evol</source>. <year>2013</year>;<volume>30</volume>:<fpage>1145</fpage>–<lpage>1158</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/molbev/mst016" xlink:type="simple">10.1093/molbev/mst016</ext-link></comment> <object-id pub-id-type="pmid">23364324</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006096.ref046">
<label>46</label>
<mixed-citation publication-type="other" xlink:type="simple">Varadhan R, Roland C. Squared Extrapolation Methods (SQUAREM): A New Class of Simple and Efficient Numerical Schemes for Accelerating the Convergence of the EM Algorithm. Johns Hopkins University, Dept of Biostatistics Working Papers. 2004;Working Paper 63.</mixed-citation>
</ref>
<ref id="pcbi.1006096.ref047">
<label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Peterson</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Garges</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Giovanni</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>McInnes</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Schloss</surname> <given-names>JA</given-names></name>, <etal>et al</etal>. <article-title>The NIH Human Microbiome Project</article-title>. <source>Genome Res</source>. <year>2009</year>;<volume>19</volume>:<fpage>2317</fpage>–<lpage>2323</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1101/gr.096651.109" xlink:type="simple">10.1101/gr.096651.109</ext-link></comment> <object-id pub-id-type="pmid">19819907</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006096.ref048">
<label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Stein</surname> <given-names>MM</given-names></name>, <name name-style="western"><surname>Hrusch</surname> <given-names>CL</given-names></name>, <name name-style="western"><surname>Gozdz</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Igartua</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Pivniouk</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Murray</surname> <given-names>SE</given-names></name>, <etal>et al</etal>. <article-title>Innate Immunity and Asthma Risk in Amish and Hutterite Farm Children</article-title>. <source>N Engl J Med</source>. <year>2016</year>;<volume>375</volume>(<issue>5</issue>):<fpage>411</fpage>–<lpage>421</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1056/NEJMoa1508749" xlink:type="simple">10.1056/NEJMoa1508749</ext-link></comment> <object-id pub-id-type="pmid">27518660</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006096.ref049">
<label>49</label>
<mixed-citation publication-type="other" xlink:type="simple">Illumina BaseSpace. MiSeq v3: 16S Metagenomics (Human Saliva, Wastewater Sludge, Alum Rock Cave); 2014. Retrieved from <ext-link ext-link-type="uri" xlink:href="https://basespace.illumina.com/projects/17438426" xlink:type="simple">https://basespace.illumina.com/projects/17438426</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006096.ref050">
<label>50</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Brandt</surname> <given-names>BW</given-names></name>, <name name-style="western"><surname>Bonder</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Huse</surname> <given-names>SM</given-names></name>, <name name-style="western"><surname>Zaura</surname> <given-names>E</given-names></name>. <article-title>TaxMan: a server to trim rRNA reference databases and inspect taxonomic coverage</article-title>. <source>Nucleic Acids Res</source>. <year>2012</year>;<volume>40</volume>:<fpage>W82</fpage>–<lpage>87</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gks418" xlink:type="simple">10.1093/nar/gks418</ext-link></comment> <object-id pub-id-type="pmid">22618877</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006096.ref051">
<label>51</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Caporaso</surname> <given-names>JG</given-names></name>, <name name-style="western"><surname>Lauber</surname> <given-names>CL</given-names></name>, <name name-style="western"><surname>Walters</surname> <given-names>WA</given-names></name>, <name name-style="western"><surname>Berg-Lyons</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Huntley</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Fierer</surname> <given-names>N</given-names></name>, <etal>et al</etal>. <article-title>Ultra-high-throughput microbial community analysis on the Illumina HiSeq and MiSeq platforms</article-title>. <source>ISME J</source>. <year>2012</year>;<volume>6</volume>:<fpage>1621</fpage>–<lpage>1624</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ismej.2012.8" xlink:type="simple">10.1038/ismej.2012.8</ext-link></comment> <object-id pub-id-type="pmid">22402401</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006096.ref052">
<label>52</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Shin</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Go</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>SY</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>SC</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>CH</given-names></name>, <etal>et al</etal>. <article-title>Analysis of the mouse gut microbiome using full-length 16S rRNA amplicon sequencing</article-title>. <source>Sci Rep</source>. <year>2016</year>;<volume>6</volume>:<fpage>29681</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/srep29681" xlink:type="simple">10.1038/srep29681</ext-link></comment> <object-id pub-id-type="pmid">27411898</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006096.ref053">
<label>53</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Stewart</surname> <given-names>CJ</given-names></name>, <name name-style="western"><surname>Embleton</surname> <given-names>ND</given-names></name>, <name name-style="western"><surname>Marrs</surname> <given-names>EC</given-names></name>, <name name-style="western"><surname>Smith</surname> <given-names>DP</given-names></name>, <name name-style="western"><surname>Nelson</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Abdulkadir</surname> <given-names>B</given-names></name>, <etal>et al</etal>. <article-title>Temporal bacterial and metabolic development of the preterm gut reveals specific signatures in health and disease</article-title>. <source>Microbiome</source>. <year>2016</year>;<volume>4</volume>:<fpage>67</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/s40168-016-0216-8" xlink:type="simple">10.1186/s40168-016-0216-8</ext-link></comment> <object-id pub-id-type="pmid">28034304</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006096.ref054">
<label>54</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Li</surname> <given-names>H</given-names></name>. <article-title>Microbiome, metagenomics, and high-dimensional compositional data analysis</article-title>. <source>Annu Rev Stat Appl</source>. <year>2015</year>;<volume>2</volume>:<fpage>73</fpage>–<lpage>94</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1146/annurev-statistics-010814-020351" xlink:type="simple">10.1146/annurev-statistics-010814-020351</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006096.ref055">
<label>55</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sohn</surname> <given-names>MB</given-names></name>, <name name-style="western"><surname>An</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Pookhao</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>Q</given-names></name>. <article-title>Accurate genome relative abundance estimation for closely related species in a metagenomic sample</article-title>. <source>BMC Bioinformatics</source>. <year>2014</year>;<volume>15</volume>:<fpage>242</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/1471-2105-15-242" xlink:type="simple">10.1186/1471-2105-15-242</ext-link></comment> <object-id pub-id-type="pmid">25027647</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006096.ref056">
<label>56</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yao</surname> <given-names>TC</given-names></name>, <name name-style="western"><surname>Du</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Han</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Sun</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Hu</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Yang</surname> <given-names>JJ</given-names></name>, <etal>et al</etal>. <article-title>Genome-wide association study of lung function phenotypes in a founder population</article-title>. <source>J Allergy Clin Immunol</source>. <year>2014</year>;<volume>133</volume>(<issue>1</issue>):<fpage>248</fpage>–<lpage>255</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.jaci.2013.06.018" xlink:type="simple">10.1016/j.jaci.2013.06.018</ext-link></comment> <object-id pub-id-type="pmid">23932459</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006096.ref057">
<label>57</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cusanovich</surname> <given-names>DA</given-names></name>, <name name-style="western"><surname>Billstrand</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Zhou</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Chavarria</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>De Leon</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Michelini</surname> <given-names>K</given-names></name>, <etal>et al</etal>. <article-title>The combination of a genome-wide association study of lymphocyte count and analysis of gene expression data reveals novel asthma candidate genes</article-title>. <source>Hum Mol Genet</source>. <year>2012</year>;<volume>21</volume>(<issue>9</issue>):<fpage>2111</fpage>–<lpage>2123</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/hmg/dds021" xlink:type="simple">10.1093/hmg/dds021</ext-link></comment> <object-id pub-id-type="pmid">22286170</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006096.ref058">
<label>58</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ober</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Tan</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Sun</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Possick</surname> <given-names>JD</given-names></name>, <name name-style="western"><surname>Pan</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Nicolae</surname> <given-names>R</given-names></name>, <etal>et al</etal>. <article-title>Effect of variation in CHI3L1 on serum YKL-40 level, risk of asthma, and lung function</article-title>. <source>N Engl J Med</source>. <year>2008</year>;<volume>358</volume>(<issue>16</issue>):<fpage>1682</fpage>–<lpage>1691</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1056/NEJMoa0708801" xlink:type="simple">10.1056/NEJMoa0708801</ext-link></comment> <object-id pub-id-type="pmid">18403759</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006096.ref059">
<label>59</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Livne</surname> <given-names>OE</given-names></name>, <name name-style="western"><surname>Han</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Alkorta-Aranburu</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Wentworth-Sheilds</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Abney</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Ober</surname> <given-names>C</given-names></name>, <etal>et al</etal>. <article-title>PRIMAL: Fast and accurate pedigree-based imputation from sequence data in a founder population</article-title>. <source>PLoS Comput Biol</source>. <year>2015</year>;<volume>11</volume>(<issue>3</issue>):<fpage>e1004139</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1004139" xlink:type="simple">10.1371/journal.pcbi.1004139</ext-link></comment> <object-id pub-id-type="pmid">25735005</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006096.ref060">
<label>60</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zhou</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Stephens</surname> <given-names>M</given-names></name>. <article-title>Genome-wide efficient mixed-model analysis for association studies</article-title>. <source>Nat Genet</source>. <year>2012</year>;<volume>44</volume>(<issue>7</issue>):<fpage>821</fpage>–<lpage>824</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ng.2310" xlink:type="simple">10.1038/ng.2310</ext-link></comment> <object-id pub-id-type="pmid">22706312</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006096.ref061">
<label>61</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Benjamini</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Hochberg</surname> <given-names>Y</given-names></name>. <article-title>Controlling the false discovery rate: a practical and powerful approach to multiple testing</article-title>. <source>Journal of the Royal Statistical Society Series B</source>. <year>1995</year>;<volume>57</volume>:<fpage>289</fpage>–<lpage>300</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006096.ref062">
<label>62</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Edgar</surname> <given-names>RC</given-names></name>. <article-title>SINTAX: a simple non-Bayesian taxonomy classifier for 16S and ITS sequences</article-title>. <source>bioRxiv</source>. <year>2016</year>;</mixed-citation>
</ref>
<ref id="pcbi.1006096.ref063">
<label>63</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kozich</surname> <given-names>JJ</given-names></name>, <name name-style="western"><surname>Westcott</surname> <given-names>SL</given-names></name>, <name name-style="western"><surname>Baxter</surname> <given-names>NT</given-names></name>, <name name-style="western"><surname>Highlander</surname> <given-names>SK</given-names></name>, <name name-style="western"><surname>Schloss</surname> <given-names>PD</given-names></name>. <article-title>Development of a dual-index sequencing strategy and curation pipeline for analyzing amplicon sequence data on the MiSeq Illumina sequencing platform</article-title>. <source>Appl Environ Microbiol</source>. <year>2013</year>;<volume>79</volume>:<fpage>5112</fpage>–<lpage>5120</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1128/AEM.01043-13" xlink:type="simple">10.1128/AEM.01043-13</ext-link></comment> <object-id pub-id-type="pmid">23793624</object-id></mixed-citation>
</ref>
</ref-list>
</back>
</article>