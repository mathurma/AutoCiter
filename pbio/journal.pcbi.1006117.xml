<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-17-01856</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1006117</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Epidemiology</subject><subj-group><subject>Genetic epidemiology</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Pathology and laboratory medicine</subject><subj-group><subject>Pathogens</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Molecular biology</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Sequencing techniques</subject><subj-group><subject>Nucleotide sequencing</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Sequencing techniques</subject><subj-group><subject>Nucleotide sequencing</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Evolutionary biology</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject><subj-group><subject>Phylogenetic analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Taxonomy</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject><subj-group><subject>Phylogenetic analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Data management</subject><subj-group><subject>Taxonomy</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject><subj-group><subject>Phylogenetic analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>DNA</subject><subj-group><subject>DNA recombination</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Nucleic acids</subject><subj-group><subject>DNA</subject><subj-group><subject>DNA recombination</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Evolutionary biology</subject><subj-group><subject>Evolutionary genetics</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Epidemiology</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Evolutionary biology</subject><subj-group><subject>Population genetics</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Population genetics</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Population biology</subject><subj-group><subject>Population genetics</subject></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Bayesian reconstruction of transmission within outbreaks using genomic variants</article-title>
<alt-title alt-title-type="running-head">Transmission reconstruction from genomic variants</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-1776-8564</contrib-id>
<name name-style="western">
<surname>De Maio</surname> <given-names>Nicola</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Worby</surname> <given-names>Colin J.</given-names></name>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" equal-contrib="yes" xlink:type="simple">
<name name-style="western">
<surname>Wilson</surname> <given-names>Daniel J.</given-names></name>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" equal-contrib="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-4508-7969</contrib-id>
<name name-style="western">
<surname>Stoesser</surname> <given-names>Nicole</given-names></name>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Nuffield Department of Medicine, University of Oxford, Oxford, United Kingdom</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Department of Ecology and Evolutionary Biology, Princeton University, Princeton, New Jersey, United States of America</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>Wellcome Trust Centre for Human Genetics, University of Oxford, Oxford, United Kingdom</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Koelle</surname> <given-names>Katia</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Duke University, UNITED STATES</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">demaio@ebi.ac.uk</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>4</month>
<year>2018</year>
</pub-date>
<pub-date pub-type="epub">
<day>18</day>
<month>4</month>
<year>2018</year>
</pub-date>
<volume>14</volume>
<issue>4</issue>
<elocation-id>e1006117</elocation-id>
<history>
<date date-type="received">
<day>9</day>
<month>11</month>
<year>2017</year>
</date>
<date date-type="accepted">
<day>3</day>
<month>4</month>
<year>2018</year>
</date>
</history>
<permissions>
<copyright-year>2018</copyright-year>
<copyright-holder>De Maio et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1006117"/>
<abstract>
<p>Pathogen genome sequencing can reveal details of transmission histories and is a powerful tool in the fight against infectious disease. In particular, within-host pathogen genomic variants identified through heterozygous nucleotide base calls are a potential source of information to identify linked cases and infer direction and time of transmission. However, using such data effectively to model disease transmission presents a number of challenges, including differentiating genuine variants from those observed due to sequencing error, as well as the specification of a realistic model for within-host pathogen population dynamics. Here we propose a new Bayesian approach to transmission inference, BadTrIP (BAyesian epiDemiological TRansmission Inference from Polymorphisms), that explicitly models evolution of pathogen populations in an outbreak, transmission (including transmission bottlenecks), and sequencing error. BadTrIP enables the inference of host-to-host transmission from pathogen sequencing data and epidemiological data. By assuming that genomic variants are unlinked, our method does not require the computationally intensive and unreliable reconstruction of individual haplotypes. Using simulations we show that BadTrIP is robust in most scenarios and can accurately infer transmission events by efficiently combining information from genetic and epidemiological sources; thanks to its realistic model of pathogen evolution and the inclusion of epidemiological data, BadTrIP is also more accurate than existing approaches. BadTrIP is distributed as an open source package (<ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/nicofmay/badtrip" xlink:type="simple">https://bitbucket.org/nicofmay/badtrip</ext-link>) for the phylogenetic software BEAST2. We apply our method to reconstruct transmission history at the early stages of the 2014 Ebola outbreak, showcasing the power of within-host genomic variants to reconstruct transmission events.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>We present a new tool to reconstruct transmission events within outbreaks. Our approach makes use of pathogen genetic information, notably genetic variants at low frequency within host that are usually discarded, and combines it with epidemiological information of host exposure to infection. This leads to accurate reconstruction of transmission even in cases where abundant within-host pathogen genetic variation and weak transmission bottlenecks (multiple pathogen units colonising a new host at transmission) would otherwise make inference difficult due to the transmission history differing from the pathogen evolution history inferred from pathogen isolets. Also, the use of within-host pathogen genomic variants increases the resolution of the reconstruction of the transmission tree even in scenarios with limited within-outbreak pathogen genetic diversity: within-host pathogen populations that appear identical at the level of consensus sequences can be discriminated using within-host variants. Our Bayesian approach provides a measure of the confidence in different possible transmission histories, and is published as open source software. We show with simulations and with an analysis of the beginning of the 2014 Ebola outbreak that our approach is applicable in many scenarios, improves our understanding of transmission dynamics, and will contribute to finding and limiting sources and routes of transmission, and therefore preventing the spread of infectious disease.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100004440</institution-id>
<institution>Wellcome Trust</institution>
</institution-wrap>
</funding-source>
<award-id>101237/Z/13/Z</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Wilson</surname> <given-names>Daniel J</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100004211</institution-id>
<institution>Oxford Martin School, University of Oxford</institution>
</institution-wrap>
</funding-source>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-1776-8564</contrib-id>
<name name-style="western">
<surname>De Maio</surname> <given-names>Nicola</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award003">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000865</institution-id>
<institution>Bill and Melinda Gates Foundation</institution>
</institution-wrap>
</funding-source>
<award-id>OPP1091919</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-1776-8564</contrib-id>
<name name-style="western">
<surname>De Maio</surname> <given-names>Nicola</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award004">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100002141</institution-id>
<institution>Public Health England</institution>
</institution-wrap>
</funding-source>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-4508-7969</contrib-id>
<name name-style="western">
<surname>Stoesser</surname> <given-names>Nicole</given-names></name>
</principal-award-recipient>
</award-group>
<funding-statement>Daniel J. Wilson was supported by a Sir Henry Dale Fellowship, jointly funded by the Wellcome Trust (<ext-link ext-link-type="uri" xlink:href="http://www.wellcome.ac.uk/" xlink:type="simple">www.wellcome.ac.uk/</ext-link>) and the Royal Society (<ext-link ext-link-type="uri" xlink:href="https://royalsociety.org/grant101237/Z/13/Z" xlink:type="simple">https://royalsociety.org/grant101237/Z/13/Z</ext-link>). CJW was supported by the Bill and Melinda Gates Foundation (<ext-link ext-link-type="uri" xlink:href="https://www.gatesfoundation.org/grantOPP1091919" xlink:type="simple">https://www.gatesfoundation.org/grantOPP1091919</ext-link>). NS is currently funded through a Public Health England (<ext-link ext-link-type="uri" xlink:href="https://www.gov.uk/government/organisations/public-health-england" xlink:type="simple">https://www.gov.uk/government/organisations/public-health-england</ext-link>)/University of Oxford (<ext-link ext-link-type="uri" xlink:href="http://www.ox.ac.uk/" xlink:type="simple">http://www.ox.ac.uk/</ext-link>) Clinical Lectureship. N.D.M. was supported by the Oxford Martin School (<ext-link ext-link-type="uri" xlink:href="http://www.oxfordmartin.ox.ac.uk/" xlink:type="simple">http://www.oxfordmartin.ox.ac.uk/</ext-link>). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="5"/>
<table-count count="0"/>
<page-count count="23"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2018-04-30</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant data are within the paper and its Supporting Information files.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Understanding transmission is important for devising effective policies and measures that limit the spread of infectious diseases. In recent years, affordable whole genome sequencing has provided unprecedented detail on the relatedness of pathogen samples [<xref ref-type="bibr" rid="pcbi.1006117.ref001">1</xref>–<xref ref-type="bibr" rid="pcbi.1006117.ref004">4</xref>]. Consequently, accurately inferring transmission between hosts is becoming more feasible. However, this requires robust statistical approaches that make use of the full extent of genetic and epidemiological data available. Here, we present a new approach that makes use of within-host genetic variation and epidemiological data to infer transmission.</p>
<p>A number of approaches have been developed that reconstruct transmission from genetic data. The number of substitutions between samples from different hosts can be used to rule out transmission [<xref ref-type="bibr" rid="pcbi.1006117.ref005">5</xref>–<xref ref-type="bibr" rid="pcbi.1006117.ref007">7</xref>], or the phylogenetic tree of the pathogen samples can be used as a proxy for the transmission history [<xref ref-type="bibr" rid="pcbi.1006117.ref008">8</xref>, <xref ref-type="bibr" rid="pcbi.1006117.ref009">9</xref>]. However, while the phylogenetic signal can be very informative of transmission, it can also be misleading [<xref ref-type="bibr" rid="pcbi.1006117.ref010">10</xref>, <xref ref-type="bibr" rid="pcbi.1006117.ref011">11</xref>], due to within-host variation that can generate discrepancies between the phylogenetic and epidemiological relatedness of hosts, and can bias estimates of infection times [<xref ref-type="bibr" rid="pcbi.1006117.ref012">12</xref>, <xref ref-type="bibr" rid="pcbi.1006117.ref013">13</xref>].</p>
<p>In recent years a number of methods have been proposed explicitly modelling both the transmission process and within-host pathogen genetic evolution to infer transmission events [<xref ref-type="bibr" rid="pcbi.1006117.ref011">11</xref>, <xref ref-type="bibr" rid="pcbi.1006117.ref013">13</xref>–<xref ref-type="bibr" rid="pcbi.1006117.ref028">28</xref>]. Some of these methods use epidemiological data and genetic sequences from pathogen samples, and ignore within-host evolution and other causes of phylogenetic discordance with transmission history [<xref ref-type="bibr" rid="pcbi.1006117.ref014">14</xref>–<xref ref-type="bibr" rid="pcbi.1006117.ref019">19</xref>, <xref ref-type="bibr" rid="pcbi.1006117.ref021">21</xref>–<xref ref-type="bibr" rid="pcbi.1006117.ref023">23</xref>]. Methods that explicitly model pathogen evolution within hosts and within an outbreak [<xref ref-type="bibr" rid="pcbi.1006117.ref013">13</xref>, <xref ref-type="bibr" rid="pcbi.1006117.ref020">20</xref>, <xref ref-type="bibr" rid="pcbi.1006117.ref024">24</xref>, <xref ref-type="bibr" rid="pcbi.1006117.ref025">25</xref>, <xref ref-type="bibr" rid="pcbi.1006117.ref027">27</xref>] generally assume, among other things, that samples provide individual and reliable pathogen haplotypes. This is often true for bacteria that are sampled and cultured before being sequenced, but it is mostly false for viruses and bacteria that are sequenced directly from samples without culturing. In fact, in these cases the sequencing process delivers reads coming from the different pathogen haplotypes that constitute the within-host pathogen population, and it is often very hard (if not impossible) to reconstruct complete haplotypes from these reads. In such cases, within-sample genetic variation is often neglected, and a single haplotype (which we call the consensus sequence of the sample) is built. While this procedure might lead to errors (and maybe biases), it also certainly discards a very informative part of the available genetic data, because within-sample genetic variants can be very informative of epidemiological distance, direction of transmission, time from infection and transmission bottleneck intensity (see [<xref ref-type="bibr" rid="pcbi.1006117.ref029">29</xref>–<xref ref-type="bibr" rid="pcbi.1006117.ref032">32</xref>] and <xref ref-type="fig" rid="pcbi.1006117.g001">Fig 1</xref>). Furthermore, it is generally assumed that the pathogen does not recombine, so that a single phylogeny describes the evolutionary history of the whole genome, but this assumption does not fit highly recombinant pathogens such as HIV [<xref ref-type="bibr" rid="pcbi.1006117.ref033">33</xref>]. For these reasons, a few approaches have recently been proposed that use within-host genetic variants to reconstruct transmission [<xref ref-type="bibr" rid="pcbi.1006117.ref030">30</xref>, <xref ref-type="bibr" rid="pcbi.1006117.ref032">32</xref>].</p>
<fig id="pcbi.1006117.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006117.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Examples of informativeness of within-host genetic variants.</title>
<p>Here we show how within-host within-sample genetic variants can be useful without requiring pathogen haplotypes. Each string of letters (a frequency sequence logo [<xref ref-type="bibr" rid="pcbi.1006117.ref034">34</xref>, <xref ref-type="bibr" rid="pcbi.1006117.ref035">35</xref>]) represents the collective genome of the pathogen at a certain point in time, as could be observed through deep sequencing. Multiple letters in the same column represent a genetic variant, with letter size representing allelic abundance. Time is on the Y axis, hosts are represented as black rectangles (a host is only active in the outbreak for the portion of vertical axis it occupies), and plausible transmission events as arrows. The posterior probability of different transmission events is represented by the arrow thickness. The number of little circles within arrows represents the inoculum size (transmission bottleneck). <bold>A</bold>) Shared genetic variants hint to epidemiological relatedness: the two top hosts (H1 and H2) are both possible infectors of the central host (H3), but H2 shares two genetic variants with H3, making it a likely infector of H3. Furthermore, the presence of shared genetic variants suggests a large transmission inoculum (a weak transmission bottleneck). <bold>B</bold>) A genetic variant of the same type of a substitution can hint to an infector: as before, but now H3 has a substitution (at third genome position, from T to C), which means that its within-host population is non-polymorphic at this position, but with a different nucleotide than the index case. This substitution is between the two nucleotides present at the same position in H2 (where this position is a genetic variant), consistent with H2 being the infector of H3. Also, this time the absence of shared genetic variants is indicative of a small transmission inoculum (a strong transmission bottleneck). <bold>C-D</bold>) The number of new genetic variants is informative of the age of an infection (but possibly also of the history of the pathogen population size within the host): in <bold>C</bold> the presence of non-shared variants in H2 suggests that the infection is older, while in <bold>D</bold> their absence suggests that the infection is younger.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006117.g001" xlink:type="simple"/>
</fig>
<p>Here, we propose a new Bayesian approach called BadTrIP (BAyesian epiDemiological TRansmission Inference from Polymorphisms) that not only uses within-sample genetic variants (from possibly multiple samples per host) to reconstruct transmission (including directionality and time of infection), but also combines this information with epidemiological data and an explicit model of within-host pathogen population evolution and transmission. We use the phylogenetic models with polymorphisms PoMo [<xref ref-type="bibr" rid="pcbi.1006117.ref036">36</xref>–<xref ref-type="bibr" rid="pcbi.1006117.ref038">38</xref>] to model population evolution along branches of the transmission tree; thanks to this, our transmission tree and phylogenetic tree are the same entity, and within-host evolution and recombination (resulting from a single primary infection, not multiple infections) do not create discrepancies that make statistical inference hard and computationally demanding [<xref ref-type="bibr" rid="pcbi.1006117.ref024">24</xref>, <xref ref-type="bibr" rid="pcbi.1006117.ref025">25</xref>, <xref ref-type="bibr" rid="pcbi.1006117.ref027">27</xref>]. We also explicitly model transmission bottlenecks, with one parameter defining the intensity of the bottleneck, and therefore the number of pathogen particles that establish a new population at transmission. Another feature of our approach is that we assume that different genomic positions are unlinked, an assumption also made by other methods using within-host variants [<xref ref-type="bibr" rid="pcbi.1006117.ref030">30</xref>, <xref ref-type="bibr" rid="pcbi.1006117.ref032">32</xref>]; most coalescent-based methods assume instead no recombination at all. Because of our assumption of no linkage, we expect our approach to work well when recombination is strong enough to break linkage between genetic variants in the same host, or when the evolutionary rate is slow so that very few new mutations originate with each new transmission.</p>
<p>BadTrIP is implemented as an open-source package for the Bayesian phylogenetic software BEAST2 [<xref ref-type="bibr" rid="pcbi.1006117.ref039">39</xref>], and as such, it can be freely installed, used, and modified. We compare the performance of BadTrIP, of the shared variants-based clustering (SVC) method of [<xref ref-type="bibr" rid="pcbi.1006117.ref030">30</xref>], and of the coalescent-based method SCOTTI [<xref ref-type="bibr" rid="pcbi.1006117.ref013">13</xref>] on simulated data and on a real dataset from the early stages of the 2014 Ebola outbreak [<xref ref-type="bibr" rid="pcbi.1006117.ref040">40</xref>]. These applications show that BadTrIP has high accuracy to reconstruct transmission thanks to its explicit model of population evolution, the use of within-host genetic variants, and the inclusion of epidemiological data, and can provide important information to understand and limit the spread of infectious disease.</p>
<p>In the rest of the manuscript, we refer to a “host” as any entity that can contain and transmit a pathogen. Typically a host is a human within a community or nosocomial outbreak, or patients, but the concept of host can also be generalised for example to farms within a livestock outbreak. We will refer to the collection of all pathogens of the type under consideration within an individual host at a certain time as a “pathogen population” (for example all Ebola virions within an infected host, excluding non-Ebola pathogens and Ebola virions from other hosts). We will call a “pathogen unit” a single pathogen individual within a population, for example an individual bacterial cell or an individual virion. We call a pathogen population “polymorphic” at a particular genome position if pathogen units with different nucleotides at that position are present in the population; in this case, we also call the considered genome position a “genetic variant”.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<sec id="sec003">
<title>Modelling within-host evolution, transmission, and sequencing</title>
<p>Methods to reconstruct transmission that account for within-host evolution usually have to deal with the complex task of modelling and inferring the discrepancies between the transmission tree and the pathogen phylogenetic trees [<xref ref-type="bibr" rid="pcbi.1006117.ref013">13</xref>, <xref ref-type="bibr" rid="pcbi.1006117.ref020">20</xref>, <xref ref-type="bibr" rid="pcbi.1006117.ref024">24</xref>, <xref ref-type="bibr" rid="pcbi.1006117.ref025">25</xref>, <xref ref-type="bibr" rid="pcbi.1006117.ref027">27</xref>]. We avoid this complication by adopting and adapting a substitution model, PoMo [<xref ref-type="bibr" rid="pcbi.1006117.ref036">36</xref>–<xref ref-type="bibr" rid="pcbi.1006117.ref038">38</xref>], that describes population evolution along the branches of a species (or population) tree. In this model, a virtual population, similar to a Moran model [<xref ref-type="bibr" rid="pcbi.1006117.ref041">41</xref>] without selection and with fixed population size, evolves by accumulating random changes in nucleotide frequencies (genetic drift, eventually resulting in the fixation of polymorphic sites), and new mutations resulting in new polymorphic sites. Different genome positions are modelled as completely unlinked.</p>
<p>The adoption of such a population genetic model within a transmission tree structure means that the phylogenetic tree and the transmission tree are now the same entity, and that each point of the tree represents the state of the pathogen population at a certain time within a host (<xref ref-type="fig" rid="pcbi.1006117.g002">Fig 2</xref>). Each bifurcation in the tree represents a transmission event, where the pathogen population splits in two groups: one remaining in the current host, and a small sub-population colonising a new host. We use a population bottleneck at time of transmission for the colonising branch to better model the transmission process.</p>
<fig id="pcbi.1006117.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006117.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Graphical representation of the transmission, evolution and sequencing model.</title>
<p>Here we describe some key aspects of our model. The figure depicts a possible evolutionary outcome for one position of the pathogen genome and the given transmission history. There are three hosts in this outbreak, represented by the black rectangles: H1 infects H2, which in turn infects H3. Time is on the vertical axis, and transmission events are represented by the thick arrows between hosts. Within each host, while it is colonised, the pathogen population consists of 15 units, each of which can have one of the four nucleotides at the considered position and at any time. For example, H1 starts off with all 15 pathogen units having an A, but during infection one of them mutates to C, and through genetic drift when H1 infects H2 it has 4 C’s and 11 A’s. While instantaneously only small changes can occur (one pathogen unit changing its nucleotide), along a time interval any number of changes can occur. As H2 is infected by H1, H2 is colonised by a copy of the pathogen population of H1, but the transmission bottleneck in this case causes one of the nucleotides to be lost, so that H2 is founded by a homogenous population of A’s. Within H2 again a mutation occurs and now a G is present in the pathogen population, but when H3 is colonised by H2 both nucleotides survive the transmission bottleneck, so H3 starts off with a polymorphic population. In the figure, H1 and H3 both have samples extracted and sequenced once, while H2 is not sampled at all. The sequencing process can result in any coverage (24 for H1 and 7 for H3 at the considered position). Furthermore, the observed nucleotide frequencies don’t necessarily exactly match the real nucleotides frequencies due to the randomness of read sampling, and because sequencing error can cause absent nucleotides to be observed at very low frequencies.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006117.g002" xlink:type="simple"/>
</fig>
<p>Our method uses two sources of information: epidemiological and genetic data. Epidemiological data is in the form of dates: the times when genetic samples are collected (it is possible to give any number of samples ≥ 0 for any host, even no sample at all) and a time interval for each host describing when it can contribute to the outbreak. Each host can only be infected, be sampled, and can infect other hosts within its time interval [<xref ref-type="bibr" rid="pcbi.1006117.ref013">13</xref>]. Genetic data from each sample is in the form of nucleotide counts: for each position of the genome, for a certain sample, the model expects the number of times each of the four nucleotides is observed in the reads (for example: 59 As, 0 Cs, 12 Gs, 1 Ts). We assume that reads are sampled with replacement from the pathogen population according to the (hidden) true nucleotide frequencies, and we model the sequencing error. This in particular means that sites without any sequencing coverage, or with very low coverage, are also allowed, and that differently from similar approaches (i.e. [<xref ref-type="bibr" rid="pcbi.1006117.ref030">30</xref>, <xref ref-type="bibr" rid="pcbi.1006117.ref032">32</xref>]) we don’t require the specification of a minimum genetic variant frequency threshold.</p>
<p>While in our model we make the strong assumption that sites are completely unlinked, we test the performance of our approach with simulations in which we explicitly model within-host recombination events and we assume that a limited number of individuals in the pathogen population is sequenced. We even simulate scenarios in the total absence of recombination (complete linkage) to measure the robustness of our method. We simulate a broad range of scenarios: different transmission bottleneck severities (weak vs. strong), different amounts of genetic information, different recombination and mutation rates, different sequencing coverage levels, different sequencing error rates, and different virtual population sizes. We give further details on the model used and the simulations in the Materials and Methods section.</p>
</sec>
<sec id="sec004">
<title>Accuracy of inference on simulated data</title>
<p>To test the accuracy of our new method BadTrIP in inferring transmission events, and to compare it to previous methods [<xref ref-type="bibr" rid="pcbi.1006117.ref013">13</xref>, <xref ref-type="bibr" rid="pcbi.1006117.ref030">30</xref>], we simulated pathogen evolution within outbreaks and sample sequencing, and we used different methods to reconstruct the transmission history from sequencing and epidemiological data. To simulate pathogen evolution, first we simulated an outbreak using SEEDY [<xref ref-type="bibr" rid="pcbi.1006117.ref042">42</xref>] (we used a fixed population of 15 hosts, one initial case, and a basic reproduction number of 1.43, see <xref ref-type="sec" rid="sec007">Materials and methods</xref>); then, we translated the transmission history into a population history, and simulated within-population pathogen coalescent, recombination and mutation with fastsimcoal2 [<xref ref-type="bibr" rid="pcbi.1006117.ref043">43</xref>]. Throughout the simulations each host in the outbreak is sampled exactly once. We measure the accuracy of a method as the frequency with which the correct transmission source of each host is inferred to be the most likely a posteriori. We also give a measure of how well calibrated [<xref ref-type="bibr" rid="pcbi.1006117.ref044">44</xref>] methods are by counting how often the correct source is in the 95% posterior credible set, defined as the minimum set of sources with cumulative probability ≥ 95% such that all sources in the set have higher posterior probability than all sources outside of it.</p>
<p>BadTrIP shows elevated accuracy in detecting the correct source of transmission (between 50% and 90%) and calibration (between 80% and 100%), in particular compared to the SVC approach (accuracy between 20% and 45% and calibration between 45% and 95%), see <xref ref-type="fig" rid="pcbi.1006117.g003">Fig 3</xref>. This shows that the use of epidemiological data and an explicit model of evolution can help to reconstruct transmission. Using alternative statistics for accuracy and calibration leads to similar patterns (Fig F in <xref ref-type="supplementary-material" rid="pcbi.1006117.s001">S1 Text</xref>). BadTrIP also shows more accuracy than the coalescent approach SCOTTI (accuracy between 25% and 70%). The latter method appears very conservative in this application (calibration between 95% and 100%). SCOTTI uses the same epidemiological information as BadTrIP, but a different format of genetic data and a different model of genetic evolution. In fact, like most coalescent-based approaches, SCOTTI requires a full haplotype to be given for each sample; in these simulations we used the consensus sequence of a sample as its haplotype for SCOTTI, discarding within-sample genetic variation. The fact that SCOTTI has strictly less genetic information available than BadTrIP can explain why generally it has less accuracy and is more conservative, however it is not the only factor at play, another being recombination. For example in the scenario with 1x coverage BadTrIP seems to have higher accuracy than SCOTTI, despite the two methods having the same information available: this can be explained with the fact the SCOTTI wrongly assumes that there is no recombination. Similarly, the simulations suggest that the accuracy gap between SCOTTI and BadTrIP reduces with no recombination, and increase at high recombination: this fits well with the fact BadTrIP assumes no linkage between genomic positions, while SCOTTI assumes complete linkage (no recombination). While these results are very suggestive and fit with our expectations, we also have to warn that for each individual scenario we have 10–20 simulated outbreaks, so while the general patterns are clear, the specific patterns of each scenario are subject to considerable uncertainty.</p>
<fig id="pcbi.1006117.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006117.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Accuracy and calibration of BadTrIP on simulated data.</title>
<p><bold>A</bold>) We represent accuracy as the frequency with which the correct simulated transmission event is more likely a posteriori than the alternatives. <bold>B</bold>) Calibration is the frequency with which the correct transmission event is in the 95% posterior credible set (the minimum set of sources with cumulative probability ≥ 95% such that all sources in the set have higher posterior probability than all sources outside of it). Bars represent percentages (from 0, worst, to 100, best) for BadTrIP (red), SCOTTI [<xref ref-type="bibr" rid="pcbi.1006117.ref013">13</xref>] (yellow) and the shared variants-based clustering (SVC) approach [<xref ref-type="bibr" rid="pcbi.1006117.ref030">30</xref>] (blue). On the x axis are different simulation scenarios with the first one, “base”, being the basic simulation scenario with 10–15 cases per outbreak, about 300–500 SNPs among all hosts, recombination 10 times stronger than mutation, complete bottleneck (no transmission of within-host genetic variants), read coverage of 40x, PoMo virtual population size of 15, actual pathogen population size of 1000, and genome size of 5 kb. All other scenarios are obtained from the base one changing one or two parameters: in “no recombination” the recombination rate is set to 0; in “high recombination” the recombination rate is 10 times higher; in “high mutation” the mutation rate is 10 times higher resulting in 2000–3000 SNPs per outbreak; in “low mutation” the mutation rate is 10 times lower resulting in 30–50 SNPs per outbreak; in “very low mutation” the mutation rate is 1000 times lower, resulting in 0–1 SNPs per outbreak; in “weak bottleneck” at transmission 5 pathogen units from the infector colonised the infected host, instead of just 1; in “high rec. weak bott.” both the recombination rate is 10 times higher and the founding population at transmission is made of 5 pathogen particles; in “high coverage” read coverage in sequencing is 100x instead of 40x; in “1x coverage” read coverage in sequencing is 1x instead of 40x; in “sequencing error” 0.2% of read bases are randomly modified to simulate sequencing error, coverage is reduced to 20x, and genome size is reduced to 1kb; in “high N” the PoMo virtual population size is 25 instead of 15.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006117.g003" xlink:type="simple"/>
</fig>
<p>Comparing the base scenario with the one with almost no mutation, we see that BadTrIP accuracy drops from about 80% to about 50%; this drop hints to the contribution given by genetic data to the inference of transmission. Also, since in the latter scenario almost no genetic information is available, it also suggests what is the contribution of epidemiological information alone. Calibration of BadTrIP seems to increase as mutation rate decreases, one probable contributing factor being that as mutation rate decreases the effect of genetic linkage on the pathogen evolutionary dynamics decreases (neither method models genetic linkage), or possibly as a result of the increased uncertainty on the evolutionary process. The complete absence of recombination seems to negatively affect calibration in BadTrIP, but the difference is not dramatic (from about 90% to about 80%) suggesting that even in the worst case scenario of complete absence of recombination BadTrIP can still provide meaningful inference and posterior distributions. Accuracy of all methods seems to decrease with decreasing mutation rate, as is expected because of the reduced genetic information. However, very high mutation rates (to the point that about half the genome, of length 5kb, is polymorphic within the outbreak) do not seem to improve inference, probably because of saturation.</p>
<p>Accuracy of BadTrIP seems higher (around 10% difference) in the presence of a strong bottleneck (small inoculum) than a weak bottleneck (large inoculum), while calibration seems almost unaffected; this probably happens because, with strong bottlenecks, polymorphisms are unlikely shared between hosts, and so polymorphisms leading to substitutions (see <xref ref-type="fig" rid="pcbi.1006117.g001">Fig 1B</xref>) become more informative for identifying infectors. An increase in coverage (from 40x to 100x) does not seem to bring improvement in accuracy or calibration to BadTrIP; on the other hand, when a single uniform colony is sequenced (which is equivalent to reducing coverage to 1x, and therefore removing information on within-host genetic variation), accuracy seems moderately reduced (≈ 10%) but not calibration. Introducing sequencing error (0.2% of mis-called bases, slightly more than what typical for high-throughput DNA sequencing [<xref ref-type="bibr" rid="pcbi.1006117.ref045">45</xref>]) accompanied by reduced coverage (20x) and genome length (1kb) still seems to result in elevated accuracy (72.5%) and calibration (97.5%). Increasing the PoMo virtual population size (from 15 to 25, while the actual simulated population size remains 1000) showed negligible effects on the inference.</p>
<p>BadTrIP also infers the time of infection. Calibration seems to increase with recombination, and to decrease with mutation (<xref ref-type="fig" rid="pcbi.1006117.g004">Fig 4</xref>), probably again an effect of our assumption of no linkage. Also, very high mutation rates seem to reduce the error in time inference, as do high coverage and virtual population size.</p>
<fig id="pcbi.1006117.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006117.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Error and calibration of BadTrIP inferring infection time from simulated data.</title>
<p><bold>A</bold>) Error (root mean square error) of the inferred median times of infection with BadTrIP. The time unit is days, with a simulated transmission rate of 0.1 per day, and a recovery rate of 0.07 per day (mean duration of infection ≈ 14.3 days). <bold>B</bold>) Calibration (the percentage with which the true time of infection is within the inferred 95% credible interval) for the time of infection with BadTrIP. Simulation scenarios are as in <xref ref-type="fig" rid="pcbi.1006117.g003">Fig 3</xref>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006117.g004" xlink:type="simple"/>
</fig>
<p>The running time of BadTrIP is affected by the number of genetic variants present in the alignment and by the number of hosts present in the outbreak (Fig A in <xref ref-type="supplementary-material" rid="pcbi.1006117.s001">S1 Text</xref>). The number of variants affect the number of likelihoods that need to be calculated at each MCMC step, while the number of hosts affects the size of the transmission/population tree (so both the computational and statistical complexity of BadTrIP). However, the time required to complete an analysis is not always a linear function of these two quantities: at low mutation rates BadTrIP requires similar times for different outbreak sizes. The reason is probably that with less data there is more uncertainty (in particular in the posterior distribution of the mutation rate), and so it takes longer to explore the the parameter space effectively. Overall, it takes a few hours to completely investigate an outbreak of moderate size (one or two dozen hosts) with BadTrIP.</p>
</sec>
<sec id="sec005">
<title>Analysis of the early 2014 Ebola outbreak in Sierra Leone</title>
<p>To demonstrate the applicability of BadTrIP and the advantage of using a model that combines epidemiological and within-sample genetic variation data, we use BadTrIP to infer transmission within the early cases of the 2014 Ebola outbreak in Sierra Leone. We use data published by Gire and colleagues [<xref ref-type="bibr" rid="pcbi.1006117.ref040">40</xref>] and previously analysed with the SVC method by Worby and colleagues [<xref ref-type="bibr" rid="pcbi.1006117.ref030">30</xref>]. One of the factors that make this dataset important to this study is the presence of within-host variants shared by multiple hosts, with one genetic variant that was even shared by eleven hosts [<xref ref-type="bibr" rid="pcbi.1006117.ref040">40</xref>]. While classical approaches based on consensus sequences would struggle to accommodate such data, in particular due to their assumption of strong transmission bottleneck that would not allow the transmission of variants, BadTrIP can accommodate such features, and such shared genomic variants are expected to increase the resolution of our transmission history inference. We investigate a collection of 62 samples with associated time and location of sampling. As observed by previous researchers, the number of substitutions (and more generally the number of SNPs) within this partial outbreak is very limited, and as such we expect to see a lot of uncertainty in the inference [<xref ref-type="bibr" rid="pcbi.1006117.ref030">30</xref>]; furthermore, all the samples were collected over a time interval of two months, and we assume transmission from a host to be possible from three weeks prior to three weeks following the sample collection, so the epidemiological data are also not very informative. Indeed, we see that most of the cases are inferred by BadTrIP to have a flat distribution of possible infectors, with highest per-infectee values generally under 30% posterior probability (<xref ref-type="fig" rid="pcbi.1006117.g005">Fig 5</xref>). However, we also see that BadTrIP identifies some pairs of infector-infectee with very high posterior probabilities (Fig B in <xref ref-type="supplementary-material" rid="pcbi.1006117.s001">S1 Text</xref>). These pairs not only generally fit with the geographical epidemiological data, with most transmission with posterior probability &gt; 50% happening within chiefdoms (with two exceptions discussed later), but also with the SVC inference [<xref ref-type="bibr" rid="pcbi.1006117.ref030">30</xref>]. Of these, transmission from EM119 to G3770 was inferred by Worby and colleagues [<xref ref-type="bibr" rid="pcbi.1006117.ref030">30</xref>] using consensus sequence genetic distance, while transmission from EM096 to G3679, from G3826 to G3827, from G3820 to G3838, from EM110 to G3809, and from G3729 to G3795 was inferred with the help of shared within-host genetic variants. All highly likely transmission pairs in [<xref ref-type="bibr" rid="pcbi.1006117.ref030">30</xref>] are also inferred by BadTrIP, but there are some highly likely transmission events inferred by BadTrIP that were not detected by SVC. For example, transmission from G3834 to G3817 is inferred by BadTrIP and is supported by a 3% frequency variant within G3834 that becomes fixed in G3817; however, such a variant fixation, attributable to the transmission dynamics described in <xref ref-type="fig" rid="pcbi.1006117.g001">Fig 1B</xref>, is not informative in the SVC method [<xref ref-type="bibr" rid="pcbi.1006117.ref030">30</xref>] and was further ignored due to the imposition of a 5% variant frequency threshold that we could avoid thanks to our explicit model of sequence evolution and sequencing error. Other cases similar to the latter are the inferred transmissions from EM110 to G3856, from EM110 to G3822, and from EM111 to G3724.</p>
<fig id="pcbi.1006117.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006117.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Inference of transmission in the early 2014 Ebola outbreak in Sierra Leone.</title>
<p><bold>A</bold>) Transmission events with posterior probability higher than 15% as inferred by BadTrIP. Circles represent hosts, while arrows are transmission events between hosts. Only hosts connected to any other host are represented. The numbers next to arrows represent their posterior probability (between 0.0 and 1.0), as does their shade of red (from pale to dark red) and arrow thickness. Numbers within circles represent the inferred (posterior median) time of infection of the respective host, as also does the shade of green (from pale to dark green) of the circle. Time is expressed in days from the date of the first availability of the first host.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006117.g005" xlink:type="simple"/>
</fig>
<p>Cross-chiefdom transmissions inferred by BadTrIP with elevated posterior distributions are from EM110 in the chiefdom of Jawie, district of Kailahun, to G3856 in the chiefdom of Nongowa, district of Kenema; and from G3834 in the chiefdom of Kpeje to G3817 in the chiefdom of Jawie, both in the district of Kailahun. Neither of them had a high probability in [<xref ref-type="bibr" rid="pcbi.1006117.ref030">30</xref>], but they are both supported by low-frequency variants becoming fixed in the recipient.</p>
<p>Our inference of the sequencing error rate <italic>ϵ</italic> is extremely low (2 ⋅ 10<sup>−7</sup> &lt; <italic>ϵ</italic> &lt; 7 ⋅ 10<sup>−7</sup>) consistent with the thorough filtering steps adopted by Gire and colleagues [<xref ref-type="bibr" rid="pcbi.1006117.ref040">40</xref>] prior to within-host variant calling.</p>
</sec>
</sec>
<sec id="sec006" sec-type="conclusions">
<title>Discussion</title>
<p>Methods to infer transmission histories within outbreaks are important to determine the causes of transmission, and to limit and prevent future outbreaks. Genomic pathogen data from an outbreak reveals in detail the genetic relatedness of pathogens from different cases. Most methods to infer transmission from pathogen genetic data require full haplotypes, but it is often not possible to reconstruct haplotypes due to pathogen recombination and short or inaccurate reads. This leads in many cases to discarding information regarding within-sample genetic diversity, and only use a sample consensus.</p>
<p>In recent years two methods have been proposed to infer transmission from genetic distances between samples and shared within-sample variants [<xref ref-type="bibr" rid="pcbi.1006117.ref030">30</xref>, <xref ref-type="bibr" rid="pcbi.1006117.ref032">32</xref>]. Here we presented BadTrIP, a Bayesian approach to transmission inference that makes use of within-sample variants and allows inference of transmission direction and time. Compared to other similar methods [<xref ref-type="bibr" rid="pcbi.1006117.ref030">30</xref>, <xref ref-type="bibr" rid="pcbi.1006117.ref032">32</xref>], our approach has the advantage of implementing an explicit model of pathogen population evolution, transmission and sequencing, of allowing the inclusion of epidemiological data (sampling times and host exposure times), of not requiring minimum thresholds for within-host variant frequencies, of accounting for sequencing errors, and of being implemented as part of an open source phylogenetic package (BEAST2 [<xref ref-type="bibr" rid="pcbi.1006117.ref039">39</xref>]). These aspects can result in more applicability, but also, as we have seen in our simulations, in greater accuracy. Compared to existing methods based on the coalescent (e.g. [<xref ref-type="bibr" rid="pcbi.1006117.ref013">13</xref>, <xref ref-type="bibr" rid="pcbi.1006117.ref024">24</xref>, <xref ref-type="bibr" rid="pcbi.1006117.ref025">25</xref>, <xref ref-type="bibr" rid="pcbi.1006117.ref028">28</xref>]) BadTrIP does not require the reconstruction of haplotypes and consensus sequences, but instead uses data of within-sample genetic variability, therefore having access to important information that can reveal otherwise cryptic transmission events.</p>
<p>Using simulations, we show that our approach achieves higher accuracy and calibration than SVC [<xref ref-type="bibr" rid="pcbi.1006117.ref030">30</xref>], has more accuracy than the coalescent-based method SCOTTI [<xref ref-type="bibr" rid="pcbi.1006117.ref013">13</xref>] used on consensus sequences of pathogen population genetic data, and can reliably identify likely transmission histories. The comparison between BadTrIP and SCOTTI is particularly interesting, because it shows us that reducing the genetic data of a within-host pathogen population to a single consensus sequence leads not only to the loss of within-host genetic diversity information, but can also lead to errors by ignoring recombination and weak transmission bottlenecks. Also, using a dataset of the early 2014 Ebola outbreak in Sierra Leone, and making use of information of within-sample variation and an explicit population evolution model, BadTrIP could infer previously unidentified likely transmission events, including transmissions between different geographic locations.</p>
<p>BadTrIP infers transmission from both epidemiological time data and pathogen genetic data. In most circumstances, both types of data are extremely useful, and we see in our simulations that removing genetic data information leads to a loss of ≈ 30% accuracy, and similarly the epidemiological data is expected to provide ≈ 40% accuracy (the baseline accuracy without any data is expected to be around 10% in our simulations). However, the contribution of the two types of data will be extremely dependent on the particular context at hand. As we showed in our simulations, BadTrIP can account for uninformative genetic data, with which it still provides meaningful inference. Our approach can however also account for uninformative epidemiological data: in the absence of exact dates, the user can specify arbitrarily large exposure intervals, allowing hosts to be infected any time by any host; as with the lack of genetic data, in this case we would also expect a significant drop in the accuracy of our method.</p>
<p>Despite these results, BadTrIP also has limitations, for example its model of genetic linkage. By assuming that all sites are unlinked, our model could be poorly calibrated in cases where there is no within-host recombination but high within-host mutation, causing strong correlations between inherited variants that are not expected in our model. However, we show in our simulations that our method is robust in a large variety of scenarios, including in the absence of recombination and with reads coming from few pathogen units. Another limitation is that our approach is generally not fast enough to deal with very large datasets, and, at the current stage, application is recommended to outbreaks with fewer than 100 cases. Also, BadTrIP is only applicable to the case where all hosts in the outbreak have been observed. In fact, our current implementation does not allow to infer the number of non-observed hosts (hosts for which there is no sample or epidemiological data). However, BadTrIP does allow to model non-sampled hosts with epidemiological data, or a fixed number of non-observed hosts (such hosts could be given uninformative epidemiological data, such as exposure intervals without ends). The assumption that all cases are observed or sampled is very common among transmission inference methods [<xref ref-type="bibr" rid="pcbi.1006117.ref011">11</xref>, <xref ref-type="bibr" rid="pcbi.1006117.ref014">14</xref>–<xref ref-type="bibr" rid="pcbi.1006117.ref020">20</xref>, <xref ref-type="bibr" rid="pcbi.1006117.ref023">23</xref>–<xref ref-type="bibr" rid="pcbi.1006117.ref026">26</xref>, <xref ref-type="bibr" rid="pcbi.1006117.ref028">28</xref>], but it limits their applicability. Extending our method to infer the presence of possible non-sampled and non-observed intermediate hosts would be relatively straightforward and would increase the method’s applicability, but it would also lead to a significant increase in the statistical complexity and computational demand (but see [<xref ref-type="bibr" rid="pcbi.1006117.ref013">13</xref>, <xref ref-type="bibr" rid="pcbi.1006117.ref027">27</xref>]).</p>
<p>Another scenario that is not accounted for in our model is multiple infections of the same host (one host being infected by multiple sources, or by the same source multiple times). This scenario can be relatively frequent in many viruses, for example HIV [<xref ref-type="bibr" rid="pcbi.1006117.ref046">46</xref>], but it is very hard to model in our context as it would require the use of a population network (see e.g. [<xref ref-type="bibr" rid="pcbi.1006117.ref047">47</xref>]) instead of a population phylogeny, which would make likelihood calculation more computationally demanding. Another similarly looking and equally concerning problem is sample contamination. We recommend sequencing data to be tested for possible contaminations and multiple infections using methods such as PHYLOSCANNER [<xref ref-type="bibr" rid="pcbi.1006117.ref048">48</xref>] prior to being investigated with BadTRiP. In our Ebola dataset we found no obvious pattern of mixed infection or contamination (like an excess of similar frequency SNPs in one sample). However, none of these approaches would detect multiple infections from closely related cases. BadTrIP uses a very simple model of sequencing error, only accounting for the two most common nucleotides at a given position and sample. This sequencing error model would probably have sub-optimal performance when sequencing error rate is high (e.g. with Nanopore sequencing technologies) and coverage is high or mutation rate is elevated. In these circumstances, a more realistic and computationally demanding model of sequencing error might be preferable. Similarly, our model of evolution only allows 2 alleles for one genome position in one host at one time. If mutation rates are so high that more than 2 alleles are frequently present simultaneously in the same host, time and position, then our model could have sub-optimal performance. However, our approach can still account for the more common scenario where a site has more than 2 alleles but not all in the same host: for example if at a certain position host 1 has a fixed A, host 2 has a polymorphism with A and C, and host 3 has a polymorphism with C and G.</p>
<p>BadTrIP does not account for selective pressure, which could sometimes cause errors, for example by creating homoplasies due to the same mutation appearing multiple times in different hosts, or by the same polymorphism being maintained by balancing selection. However, our approach weighs information from both fixed substitutions and polymorphic variants, so the same mutation appearing in different genetic backgrounds will not be as nearly as misleading as for the SVC method (which gives much more weight to shared variants than to genetic distances). We assume that within-host population sizes are constant after an initial expansion. Size fluctuations in all hosts are unlikely to cause problems, as the PoMo drift rate would in this case represent the average drift rate in hosts. On the other hand, if fluctuations only happen in certain hosts, so that different hosts have different average drift rates, it might have averse effects on the estimate of infection times.</p>
<p>As our model is implemented in BEAST2, it is possible to specify a broad range of models of genomic variation in substitution rates which could at least partly account for the effects of selection. An additional feature that could be added to BadTrIP is indel evolution. For example, by assuming an infinite sites mutation model, indel data could be reduced to 0–1 states, and a PoMo matrix with two alleles instead of 4 nucleotides could be used. This approach could be useful to complement SNP data, but would only work at relatively low indel rates.</p>
<p>Finally, it is possible that errors in the bioinformatic processing of reads, for example mapping errors, cause the identification of the same spurious genetic variants in multiple hosts. We therefore encourage the investigations of genetic variants shared by many hosts to assess their biological plausibility. In the future we will work to solve some of the limitations of BadTrIP, in particular to reduce its computational demand and to model non-sampled non-observed hosts.</p>
<p>In conclusion, we have presented a new method that addresses the urgent need for software to efficiently and accurately analyse genomic and epidemiological data, in particular taking advantage of within-sample genetic variants to identify transmission pairs and reconstruct direction and time of infection. BadTrIP can be used in a broad range of outbreaks, and will be important for devising effective strategies to fight the spread of infectious disease.</p>
</sec>
<sec id="sec007" sec-type="materials|methods">
<title>Materials and methods</title>
<sec id="sec008">
<title>Model of transmission</title>
<p>We model each host as a deme <italic>d</italic> ∈ <italic>D</italic> that can be colonised by a pathogen population, with total number of hosts-demes being <italic>n</italic><sub><italic>D</italic></sub>. Each deme <italic>d</italic> is associated with an exposure interval limited by an introduction time <italic>i</italic><sub><italic>d</italic></sub> ∈ (−∞, +∞] and a removal time <italic>r</italic><sub><italic>d</italic></sub> ∈ [−∞, +∞), with <italic>r</italic><sub><italic>d</italic></sub> &lt; <italic>i</italic><sub><italic>d</italic></sub> (we consider time backward as typical in coalescent theory); the host only contributes to the outbreak within this interval, which is determined by the epidemiological data. In the least informative scenario where no information on host <italic>d</italic> exposure is provided, it is assumed that <italic>d</italic> is exposed for the whole outbreak (<italic>i</italic><sub><italic>d</italic></sub> = +∞ and <italic>r</italic><sub><italic>d</italic></sub> = −∞). We will denote as <bold><italic>X</italic></bold> the collection of exposure times.</p>
<p>Each host-deme starts off as non-colonised and is colonised (infected) at some time <italic>t</italic><sub><italic>d</italic></sub> between <italic>i</italic><sub><italic>d</italic></sub> and the time that the first sample is collected from <italic>d</italic> (if no sample is collected from <italic>d</italic>, then we require only <italic>t</italic><sub><italic>d</italic></sub> &gt; <italic>r</italic><sub><italic>d</italic></sub>). Also, unless <italic>d</italic> is the first host to be infected in the outbreak, <italic>d</italic> is infected by another host in the outbreak <italic>I</italic><sub><italic>d</italic></sub> ≠ <italic>d</italic>, such that <inline-formula id="pcbi.1006117.e001"><alternatives><graphic id="pcbi.1006117.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006117.e001" xlink:type="simple"/><mml:math display="inline" id="M1"><mml:mrow><mml:msub><mml:mi>r</mml:mi> <mml:msub><mml:mi>I</mml:mi> <mml:mi>d</mml:mi></mml:msub></mml:msub> <mml:mo>&lt;</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>d</mml:mi></mml:msub> <mml:mo>&lt;</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:msub><mml:mi>I</mml:mi> <mml:mi>d</mml:mi></mml:msub></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, that is, <italic>d</italic> is infected after <italic>I</italic><sub><italic>d</italic></sub> is infected, but before <italic>I</italic><sub><italic>d</italic></sub> reaches its removal time. If <italic>d</italic> is indeed the first case of the outbreak, then <italic>I</italic><sub><italic>d</italic></sub> is assigned the ∅ (we assume ∅ ∉ <italic>D</italic>). We assume for simplicity that transmission between any pair of hosts and at any time is equally likely, as long as it is consistent with the epidemiological data. A transmission event of host <italic>d</italic> at time <italic>t</italic><sub><italic>d</italic></sub> is inconsistent with the epidemiological data if <italic>t</italic><sub><italic>d</italic></sub> is outside the exposure interval of <italic>d</italic> or its infector <italic>I</italic><sub><italic>d</italic></sub>, or if <italic>d</italic> is sampled, infects another host, before <italic>t</italic><sub><italic>d</italic></sub>. Given the epidemiological data, some infector-infectee pairs are a priori more likely than others, depending on the length of time that a transmission between them is allowed.</p>
<p>Each host is also provided with a (possibly empty) set of samples, <italic>S</italic><sub><italic>d</italic></sub>. Each sample <italic>s</italic> consists of a sampling time <italic>t</italic><sub><italic>s</italic></sub> and genetic data <italic>G</italic><sub><italic>s</italic></sub>. Each sample <italic>s</italic> in <italic>S</italic><sub><italic>d</italic></sub> has to be collected after <italic>d</italic> is infected (<italic>t</italic><sub><italic>s</italic></sub> &lt; <italic>t</italic><sub><italic>d</italic></sub>) and before <italic>d</italic> is removed (<italic>t</italic><sub><italic>s</italic></sub> &gt; <italic>r</italic><sub><italic>d</italic></sub>). Assuming that the genome is <italic>L</italic> bases long, then the genetic data <italic>G</italic><sub><italic>s</italic></sub> of every sample <italic>s</italic> has to be in the form of a list of <italic>L</italic> quadruples, with for example the quadruple for genome position <italic>i</italic> being <italic>G</italic><sub><italic>s</italic></sub><sub><italic>i</italic></sub> = (<italic>a</italic><sub><italic>i</italic></sub>, <italic>c</italic><sub><italic>i</italic></sub>, <italic>g</italic><sub><italic>i</italic></sub>, <italic>t</italic><sub><italic>i</italic></sub>), the four positive natural values being the numbers of A’s, C’s, G’s and T’s observed at position <italic>i</italic> in the sample. If there is no read mapping to position <italic>i</italic> in sample <italic>s</italic>, then its quadruple is simply <italic>G</italic><sub><italic>s</italic></sub><sub><italic>i</italic></sub> = (0, 0, 0, 0). We denote the set of all sequencing data as <italic>G</italic>.</p>
<p>All hosts share a common parameter <italic>B</italic> (with real positive values) describing the intensity of the transmission bottlenecks associated with transmission events. Generally, the value of <italic>B</italic> can be inferred jointly with other model parameters, however its interpretation in terms of the size of the transmission inoculum is not straightforward. <italic>T</italic> denotes the transmission-population tree consisting of all sampling times, all infection times and all infectors of each host, and <bold><italic>μ</italic></bold> denotes the pathogen evolution model (described below). An example of tree <italic>T</italic> and of model parameters is given in Fig C in <xref ref-type="supplementary-material" rid="pcbi.1006117.s001">S1 Text</xref>.</p>
<p>We aim to sample from the following joint posterior distribution with a Monte Carlo Markov Chain approach:
<disp-formula id="pcbi.1006117.e002"><alternatives><graphic id="pcbi.1006117.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006117.e002" xlink:type="simple"/><mml:math display="block" id="M2"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd><mml:mrow><mml:mi>P</mml:mi> <mml:mo>(</mml:mo> <mml:mi>T</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">μ</mml:mi> <mml:mo>,</mml:mo> <mml:mi>B</mml:mi> <mml:mo>|</mml:mo> <mml:mi>G</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">X</mml:mi> <mml:mo>)</mml:mo> <mml:mo>∝</mml:mo> <mml:mi>P</mml:mi> <mml:mo>(</mml:mo> <mml:mi>G</mml:mi> <mml:mo>|</mml:mo> <mml:mi>T</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">μ</mml:mi> <mml:mo>,</mml:mo> <mml:mi>B</mml:mi> <mml:mo>)</mml:mo> <mml:mi>P</mml:mi> <mml:mo>(</mml:mo> <mml:mi>T</mml:mi> <mml:mo>|</mml:mo> <mml:mi mathvariant="bold-italic">X</mml:mi> <mml:mo>)</mml:mo> <mml:mi>P</mml:mi> <mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">μ</mml:mi> <mml:mo>)</mml:mo> <mml:mi>P</mml:mi> <mml:mo>(</mml:mo> <mml:mi>B</mml:mi> <mml:mo>)</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula></p>
<p><italic>P</italic>(<bold><italic>μ</italic></bold>) and <italic>P</italic>(<italic>B</italic>) are the prior probabilities for respectively the substitution model and the bottleneck size, which can be chosen arbitrarily by the user. We ignore the prior for the transmission tree <italic>P</italic>(<italic>T</italic>|<bold><italic>X</italic></bold>) as in [<xref ref-type="bibr" rid="pcbi.1006117.ref013">13</xref>]. <italic>P</italic>(<italic>G</italic>|<italic>T</italic>, <bold><italic>μ</italic></bold>, <italic>B</italic>) is the likelihood of the sequences given the genealogy and substitution model, and is calculated as described below, using an adaptation of [<xref ref-type="bibr" rid="pcbi.1006117.ref036">36</xref>–<xref ref-type="bibr" rid="pcbi.1006117.ref038">38</xref>] to transmission trees. So once we calculate the likelihood <italic>P</italic>(<italic>G</italic>|<italic>T</italic>, <bold><italic>μ</italic></bold>, <italic>B</italic>), we can use <xref ref-type="disp-formula" rid="pcbi.1006117.e002">Eq 1</xref> with an MCMC to infer a posterior distribution of infection times, infectors, bottleneck size and substitution model parameters.</p>
</sec>
<sec id="sec009">
<title>Model of pathogen evolution</title>
<p>Here, we make use of a phylogenetic model for population evolution, PoMo [<xref ref-type="bibr" rid="pcbi.1006117.ref036">36</xref>–<xref ref-type="bibr" rid="pcbi.1006117.ref038">38</xref>], to model mutation and drift in the within-host pathogen populations; also, we extend the model to include transmission bottlenecks and sequencing errors. Sequence evolution is usually modelled along phylogenetic trees, which can differ from the transmission tree [<xref ref-type="bibr" rid="pcbi.1006117.ref013">13</xref>]. However, PoMo describes evolution along species (or population) trees, and the population tree of a pathogen within an outbreak corresponds to the transmission tree <italic>T</italic> described in the previous section. If we consider the pathogen community within a host <italic>d</italic> as a population, we see that this population exists from time of infection <italic>t</italic><sub><italic>d</italic></sub>, when it originates from a split with the population of its infector <italic>I</italic><sub><italic>d</italic></sub>. So, transmission events corresponds to timed splits in the population tree, similar to the bifurcations of a species tree. However, one difference is that the split is asymmetrical, as we assume that the pathogen population size is not affected at <italic>t</italic><sub><italic>d</italic></sub> in <italic>I</italic><sub><italic>d</italic></sub>, but at the start of the branch leading to <italic>d</italic> it undergoes a bottleneck of intensity <italic>B</italic>. All events in the tree are timed in real time (e.g., days) with some values fixed (for samples) and some values inferred in the MCMC (infection times).</p>
<p>We use a procedure very similar to the Felsenstein pruning algorithm [<xref ref-type="bibr" rid="pcbi.1006117.ref049">49</xref>] to calculate the likelihood of the genetic data over the tree. First of all, the substitution process along the branches of the transmission-population tree is not a simple DNA substitution process, but is similar to a 4-allelic Moran model [<xref ref-type="bibr" rid="pcbi.1006117.ref041">41</xref>] with mutation. We assume we have a continuous-time Markov process along each branch of the tree, where the state space is not made by the four nucleotides, as is typical, but by all 1- and 2-allelic states possible for a population of <italic>N</italic> units. Typical values of <italic>N</italic> that we use here are 15 or 25, that is, we describe evolution of a large within-host pathogen population (possibly with billions of units) with a small virtual within-host population of <italic>N</italic> units. Such an approximation generally leads to reasonably good results as long as we rescale the mutation rates between the real and the virtual population [<xref ref-type="bibr" rid="pcbi.1006117.ref036">36</xref>–<xref ref-type="bibr" rid="pcbi.1006117.ref038">38</xref>]. <italic>N</italic> here is not estimated, but is fixed by the user. Lower values of <italic>N</italic> are expected to reduce the computational demand of the method, but can result in lower accuracy. The states of our Markov process always include the four fixed states, where only one nucleotide is present in the population. In addition, they also include six groups of polymorphic states, where two nucleotides are present in the virtual population at the same site at the same time. Each group corresponds to one of the six unordered pairs of nucleotides ({<italic>A</italic>, <italic>C</italic>}, {<italic>A</italic>, <italic>G</italic>}, {<italic>A</italic>, <italic>T</italic>}, {<italic>C</italic>, <italic>G</italic>}, {<italic>C</italic>, <italic>T</italic>}, {<italic>G</italic>, <italic>T</italic>}) and contains <italic>N</italic> − 1 states: if the two nucleotides present in the population are <italic>n</italic><sub>1</sub> and <italic>n</italic><sub>2</sub>, then such <italic>N</italic> − 1 states are the ones in which the population contains <italic>i</italic> times nucleotide <italic>n</italic><sub>1</sub> and <italic>N</italic> − <italic>i</italic> times nucleotide <italic>n</italic><sub>2</sub>, for 0 &lt; <italic>i</italic> &lt; <italic>N</italic>. So in total our state space is of size 4 + 6(<italic>N</italic> − 1). Our substitution rate matrix is sparse, in that we only allow one unit in the virtual population to change at the time. So, from a fixed state with nucleotide <italic>n</italic><sub>1</sub>, a instantaneous move is only possible to one of the three states with <italic>N</italic> − 1 times nucleotide <italic>n</italic><sub>1</sub> and one time any other nucleotide <italic>n</italic><sub>2</sub> different from <italic>n</italic><sub>1</sub>. Such moves correspond to mutation events, and we represent their rates as <inline-formula id="pcbi.1006117.e003"><alternatives><graphic id="pcbi.1006117.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006117.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:msub><mml:mi>μ</mml:mi> <mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>. Instead, if we are already in a polymorphic state with <italic>i</italic> times nucleotide <italic>n</italic><sub>1</sub> and <italic>N</italic> − <italic>i</italic> times nucleotide <italic>n</italic><sub>2</sub>, we only allow nucleotide counts to instantaneously change by one, so an instantaneous move is only possible to the state with <italic>i</italic> + 1 times nucleotide <italic>n</italic><sub>1</sub> and <italic>N</italic> − <italic>i</italic> − 1 times nucleotide <italic>n</italic><sub>2</sub>, or to state <italic>i</italic> − 1 times nucleotide <italic>n</italic><sub>1</sub> and <italic>N</italic> + 1 − <italic>i</italic> times nucleotide <italic>n</italic><sub>2</sub> (one of these two latter states might be a fixed state). The instantaneous rate at which such changes happen is <inline-formula id="pcbi.1006117.e004"><alternatives><graphic id="pcbi.1006117.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006117.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi>i</mml:mi> <mml:mo>(</mml:mo> <mml:mi>N</mml:mi> <mml:mo>-</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mi>N</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mfrac></mml:mstyle> <mml:mi>R</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> which corresponds to the rate of genetic drift; here <italic>R</italic> scales the rate of drift in the virtual population in units of real time; the rate of drift in the virtual population also depends on <italic>N</italic>, and it represents the rate of drift in a real pathogen population, which in turn depends on the pathogen effective population size, the pathogen generation time, and the time unit. All other non-diagonal substitution rates are set to 0. All these states and rates constitute the substitution process <bold><italic>E</italic></bold>. The rate matrix is further described in Fig D in <xref ref-type="supplementary-material" rid="pcbi.1006117.s001">S1 Text</xref>. Our model only allows 2 alleles to be present in one host at one time at one position. This can be unrealistic where mutation rates are extremely high, or selection favours several variants at the same site.</p>
<p>The likelihood of <italic>T</italic> is calculated starting from the hosts in the outbreaks who don’t infect others (the leaves of the transmission tree). For such leaves, the likelihood is first calculated from the latest sample (if no sample is present, then the likelihood of such leaf at time of their transmission is 1 for every state). Given any state of our substitution process with nucleotides <italic>n</italic><sub>1</sub> and <italic>n</italic><sub>2</sub> with respectively abundances <italic>i</italic> and <italic>N</italic> − <italic>i</italic> in the virtual population (here for generality <italic>i</italic> can also be 0), given a sample and site at which the nucleotides with the highest coverage are <italic>x</italic><sub>1</sub> with coverage <italic>c</italic><sub>1</sub>, and <italic>x</italic><sub>2</sub> with coverage <italic>c</italic><sub>2</sub> (we ignore the nucleotides with lower counts for numerical stability, and in case of a tie random nucleotides are selected from the tying ones), then the likelihood of this state at this sample and site is approximated as:
<disp-formula id="pcbi.1006117.e005"><alternatives><graphic id="pcbi.1006117.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006117.e005" xlink:type="simple"/><mml:math display="block" id="M5"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>ϵ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>ϵ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>N</mml:mi></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>ϵ</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mi>N</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>ϵ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>N</mml:mi></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>i</mml:mi><mml:mi>ϵ</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mi>N</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>≠</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>≠</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>*</mml:mo><mml:mfrac><mml:mi>ϵ</mml:mi><mml:mn>3</mml:mn></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msup><mml:mo>·</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>·</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>ϵ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>N</mml:mi></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>ϵ</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mi>N</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>ϵ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>N</mml:mi></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>i</mml:mi><mml:mi>ϵ</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mi>N</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>≠</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>≠</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>*</mml:mo><mml:mfrac><mml:mi>ϵ</mml:mi><mml:mn>3</mml:mn></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msup><mml:mo>·</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>·</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2)</label></disp-formula></p>
<p>Where <italic>ϵ</italic> is a parameter describing the sequencing error rate. Here, due to sequencing errors and to random sampling of reads from the pathogen population, the observed alleles <italic>c</italic><sub>1</sub> and <italic>c</italic><sub>2</sub> are allowed be different from the alleles <italic>n</italic><sub>1</sub> and <italic>n</italic><sub>2</sub> in the virtual population. We assume that each read has the same probability to represent any of the individuals in the virtual population, and that there is a probability <italic>ϵ</italic> that the considered position of the read is a sequencing error (in which case any of the three wrong nucleotides is equally likely to be on the read). <inline-formula id="pcbi.1006117.e006"><alternatives><graphic id="pcbi.1006117.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006117.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:mrow><mml:mo>(</mml:mo> <mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi>i</mml:mi> <mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>N</mml:mi></mml:mfrac></mml:mstyle> <mml:mo>+</mml:mo> <mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mo>(</mml:mo> <mml:mi>N</mml:mi> <mml:mo>-</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo> <mml:mi>ϵ</mml:mi></mml:mrow> <mml:mrow><mml:mn>3</mml:mn> <mml:mi>N</mml:mi></mml:mrow></mml:mfrac></mml:mstyle> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is the probability to see a <italic>n</italic><sub>1</sub> nucleotide: the first part is the probability that the read comes from an individual in the virtual population with nucleotide <italic>n</italic><sub>1</sub> at the given position and that no sequencing error happened; the right end part represents the probability that the virtual individual had a different nucleotide but there was a sequencing error. <italic>ϵ</italic> can be estimated with the other model parameters as we do with the real data and with the simulations including sequencing error. For all other simulations we set <italic>ϵ</italic> = 0. This sequencing model assumes that there are at most 2 alleles in the reads data for one sample at one position. If more than 2 alleles are observed, then only the counts from the 2 most common alleles are retained.</p>
<p>Along branches of <italic>T</italic>, the likelihood is updated using the matrix exponential of <bold><italic>E</italic></bold>. At bifurcations (corresponding either to internal samples or transmission events) the likelihood is also updated according to the classical pruning algorithm, but at transmission events an extra step is added. A new drift-only substitution matrix <bold><italic>E</italic></bold><sub><italic>D</italic></sub> is defined by setting the mutation rates in <bold><italic>E</italic></bold> to 0. Then, we describe a bottleneck as a branch of length <italic>B</italic> along which the population evolves under drift alone, that is, under <bold><italic>E</italic></bold><sub><italic>D</italic></sub>. The length <italic>B</italic> does not count toward the branch lengths in real time, so that changing the intensity of the bottleneck does not affect the timing of the events in <italic>T</italic>. Under this model, a more intense bottleneck, corresponding to a small transmission inoculum, will be represented by a longer bottleneck branch, so a larger <italic>B</italic>. If we have a transmission event from <italic>I</italic><sub><italic>d</italic></sub> to <italic>d</italic> at time <italic>t</italic><sub><italic>d</italic></sub>, we first calculate the likelihood within population <italic>I</italic><sub><italic>d</italic></sub> up to right before time <italic>t</italic><sub><italic>d</italic></sub> (likelihoods are updated backward in time), then within population <italic>d</italic> up to right before time <italic>t</italic><sub><italic>d</italic></sub>, then we update the likelihood within <italic>d</italic> using the bottleneck branch, and finally we multiply the two likelihoods in <italic>d</italic> and <italic>I</italic><sub><italic>d</italic></sub> to obtain the likelihood in <italic>I</italic><sub><italic>d</italic></sub> right after <italic>t</italic><sub><italic>d</italic></sub> (again backward in time). This backward-in-time likelihood update process is terminated after the transmission event of the index case, and before its bottleneck we assume state equilibrium frequencies. We now describe an example of likelihood calculation in Fig E in <xref ref-type="supplementary-material" rid="pcbi.1006117.s001">S1 Text</xref>.</p>
</sec>
<sec id="sec010">
<title>MCMC proposals</title>
<p>We use typical BEAST2 scalar proposals for <italic>B</italic>, <italic>ϵ</italic> and <bold><italic>E</italic></bold>, which, given a constant <italic>s</italic> and a random uniform real number 0 &lt; <italic>u</italic> &lt; 1, propose to scale the given parameter by a factor of <italic>s</italic> + (1/<italic>s</italic> − <italic>s</italic>)<italic>u</italic>; the reciprocal of this factor is the Hastings ratio of the proposal. We also define below five new operators (proposals) for updating our transmission-population tree.</p>
<list list-type="bullet">
<list-item>
<p>The first operator picks a random host <italic>d</italic> uniformly, then picks its new transmission time <italic>t</italic><sub><italic>d</italic></sub> uniformly within the time interval allowed by <italic>i</italic><sub><italic>d</italic></sub>, <italic>r</italic><sub><italic>d</italic></sub>, the first sampling time of <italic>d</italic> (if any is present), the first time <italic>d</italic> infects another host (if any), and the exposure interval of the infector of <italic>d</italic>, <italic>I</italic><sub><italic>d</italic></sub>. This operator does not modify any other parameter, not even <italic>I</italic><sub><italic>d</italic></sub>. The Hastings ratio is 1.</p>
</list-item>
<list-item>
<p>The second operator picks a random non-index case <italic>d</italic> and, without modifying its infection time <italic>t</italic><sub><italic>d</italic></sub>, picks a random new infector <italic>I</italic><sub><italic>d</italic></sub> among the ones compatible with infection time <italic>t</italic><sub><italic>d</italic></sub>. The Hastings ratio is 1.</p>
</list-item>
<list-item>
<p>The third operator is similar to the second, but first picks a new infection time <inline-formula id="pcbi.1006117.e007"><alternatives><graphic id="pcbi.1006117.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006117.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:msubsup><mml:mi>t</mml:mi> <mml:mi>d</mml:mi> <mml:mo>′</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> for <italic>d</italic> among those allowed by <italic>i</italic><sub><italic>d</italic></sub>, <italic>r</italic><sub><italic>d</italic></sub>, first sample time of <italic>d</italic> and the first time <italic>d</italic> infects another host (but not based on the current infector <italic>I</italic><sub><italic>d</italic></sub>), and then picks a new infector <inline-formula id="pcbi.1006117.e008"><alternatives><graphic id="pcbi.1006117.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006117.e008" xlink:type="simple"/><mml:math display="inline" id="M8"><mml:msubsup><mml:mi>I</mml:mi> <mml:mi>d</mml:mi> <mml:mo>′</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> of <italic>d</italic> uniformly among those compatible with <inline-formula id="pcbi.1006117.e009"><alternatives><graphic id="pcbi.1006117.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006117.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:msubsup><mml:mi>t</mml:mi> <mml:mi>d</mml:mi> <mml:mo>′</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> (if any is present, otherwise the proposal is rejected). The Hastings ratio is calculated taking the number of possible infectors of <italic>d</italic> compatible with the new infection time <inline-formula id="pcbi.1006117.e010"><alternatives><graphic id="pcbi.1006117.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006117.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:msubsup><mml:mi>t</mml:mi> <mml:mi>d</mml:mi> <mml:mo>′</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula>, and dividing it by the number of possible infectors of <italic>d</italic> compatible with the old infection time <italic>t</italic><sub><italic>d</italic></sub>.</p>
</list-item>
<list-item>
<p>The fourth operator swaps infector-infectee. First, a random non-tip host (a host with some infectees) <italic>d</italic> is uniformly chosen; we call its first infectee <italic>c</italic>. Given infection times <italic>t</italic><sub><italic>c</italic></sub> and <italic>t</italic><sub><italic>d</italic></sub>, if the swap is legal (<italic>d</italic> has no samples collected before <italic>t</italic><sub><italic>c</italic></sub>, and <italic>t</italic><sub><italic>d</italic></sub> is within the exposure interval of <italic>c</italic>) then <italic>I</italic><sub><italic>d</italic></sub> (possibly ∅) becomes the infector <inline-formula id="pcbi.1006117.e011"><alternatives><graphic id="pcbi.1006117.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006117.e011" xlink:type="simple"/><mml:math display="inline" id="M11"><mml:msubsup><mml:mi>I</mml:mi> <mml:mi>c</mml:mi> <mml:mo>′</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> of <italic>c</italic> at time <inline-formula id="pcbi.1006117.e012"><alternatives><graphic id="pcbi.1006117.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006117.e012" xlink:type="simple"/><mml:math display="inline" id="M12"><mml:mrow><mml:msubsup><mml:mi>t</mml:mi> <mml:mi>c</mml:mi> <mml:mo>′</mml:mo></mml:msubsup> <mml:mo>=</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>d</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, and <italic>c</italic> becomes the infector <inline-formula id="pcbi.1006117.e013"><alternatives><graphic id="pcbi.1006117.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006117.e013" xlink:type="simple"/><mml:math display="inline" id="M13"><mml:msubsup><mml:mi>I</mml:mi> <mml:mi>d</mml:mi> <mml:mo>′</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> of <italic>d</italic> at time <inline-formula id="pcbi.1006117.e014"><alternatives><graphic id="pcbi.1006117.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006117.e014" xlink:type="simple"/><mml:math display="inline" id="M14"><mml:mrow><mml:msubsup><mml:mi>t</mml:mi> <mml:mi>d</mml:mi> <mml:mo>′</mml:mo></mml:msubsup> <mml:mo>=</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>. The Hastings ratio is 1.</p>
</list-item>
<list-item>
<p>The last operator picks a random case <italic>d</italic> uniformly, selects a new infection time <inline-formula id="pcbi.1006117.e015"><alternatives><graphic id="pcbi.1006117.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006117.e015" xlink:type="simple"/><mml:math display="inline" id="M15"><mml:msubsup><mml:mi>t</mml:mi> <mml:mi>d</mml:mi> <mml:mo>′</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> as in operator three, then picks a random new infector <inline-formula id="pcbi.1006117.e016"><alternatives><graphic id="pcbi.1006117.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006117.e016" xlink:type="simple"/><mml:math display="inline" id="M16"><mml:msubsup><mml:mi>I</mml:mi> <mml:mi>d</mml:mi> <mml:mo>′</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> uniformly within the set of infectors compatible with <inline-formula id="pcbi.1006117.e017"><alternatives><graphic id="pcbi.1006117.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006117.e017" xlink:type="simple"/><mml:math display="inline" id="M17"><mml:msubsup><mml:mi>t</mml:mi> <mml:mi>d</mml:mi> <mml:mo>′</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> and within the epidemiological upper neighbourhood of <italic>d</italic> (the grandparent <inline-formula id="pcbi.1006117.e018"><alternatives><graphic id="pcbi.1006117.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006117.e018" xlink:type="simple"/><mml:math display="inline" id="M18"><mml:msub><mml:mi>I</mml:mi> <mml:msub><mml:mi>I</mml:mi> <mml:mi>d</mml:mi></mml:msub></mml:msub></mml:math></alternatives></inline-formula>, its infectees, and the infectees of <italic>I</italic><sub><italic>d</italic></sub> different from <italic>d</italic>); if no compatible infector is found, the move is rejected. The Hastings ratio is calculated like in operator three, but counting only compatible infectors within epidemiological upper neighbourhoods.</p>
</list-item>
</list>
<p>We will now give a very informal intuition of why the above proposals make an irreducible MCMC. We will focus on the transmission history, and not on <italic>B</italic>, <italic>ϵ</italic> or <bold><italic>E</italic></bold>, but the extension is trivial. We will discuss intuitively how it is possible to move from any given tree <italic>T</italic> to a specific tree <inline-formula id="pcbi.1006117.e019"><alternatives><graphic id="pcbi.1006117.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006117.e019" xlink:type="simple"/><mml:math display="inline" id="M19"><mml:mover accent="true"><mml:mi>T</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> (the tree we use as a starting point of the MCMC). As proposals are reversible, this is sufficient to have irreducibility. <inline-formula id="pcbi.1006117.e020"><alternatives><graphic id="pcbi.1006117.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006117.e020" xlink:type="simple"/><mml:math display="inline" id="M20"><mml:mover accent="true"><mml:mi>T</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is defined as the tree where the host with the earliest introduction time is the index case; each non-index host <italic>d</italic> in <inline-formula id="pcbi.1006117.e021"><alternatives><graphic id="pcbi.1006117.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006117.e021" xlink:type="simple"/><mml:math display="inline" id="M21"><mml:mover accent="true"><mml:mi>T</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is infected by the host <italic>I</italic><sub><italic>d</italic></sub> with the earliest introduction time <inline-formula id="pcbi.1006117.e022"><alternatives><graphic id="pcbi.1006117.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006117.e022" xlink:type="simple"/><mml:math display="inline" id="M22"><mml:msub><mml:mi>i</mml:mi> <mml:msub><mml:mi>I</mml:mi> <mml:mi>d</mml:mi></mml:msub></mml:msub></mml:math></alternatives></inline-formula> among those with an exposure overlap to <italic>d</italic>; in <inline-formula id="pcbi.1006117.e023"><alternatives><graphic id="pcbi.1006117.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006117.e023" xlink:type="simple"/><mml:math display="inline" id="M23"><mml:mover accent="true"><mml:mi>T</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> infection time <italic>t</italic><sub><italic>d</italic></sub> of any host <italic>d</italic> is set to <italic>i</italic><sub><italic>d</italic></sub> (for a more formal proof an infinitesimal interval after <italic>i</italic><sub><italic>d</italic></sub> might be considered). Starting from <italic>T</italic>, we first approach <inline-formula id="pcbi.1006117.e024"><alternatives><graphic id="pcbi.1006117.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006117.e024" xlink:type="simple"/><mml:math display="inline" id="M24"><mml:mover accent="true"><mml:mi>T</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> by moving host <italic>h</italic>, the index case in <inline-formula id="pcbi.1006117.e025"><alternatives><graphic id="pcbi.1006117.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006117.e025" xlink:type="simple"/><mml:math display="inline" id="M25"><mml:mover accent="true"><mml:mi>T</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, up from its starting position in <italic>T</italic> by using repeatedly operator four. At each step, before applying operator four, we use operator one to move <italic>t</italic><sub><italic>h</italic></sub> up to make sure it is the first infectee of its infector, and that it is infected before the first sample of its infector is collected. Repeating these two steps long enough, <italic>h</italic> is guaranteed to become the root, at which point we can apply operator one to make sure its infection time is the same as in <inline-formula id="pcbi.1006117.e026"><alternatives><graphic id="pcbi.1006117.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006117.e026" xlink:type="simple"/><mml:math display="inline" id="M26"><mml:mover accent="true"><mml:mi>T</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula>. We then proceed to apply a similar strategy iteratively on all other hosts in order based on their introduction time (from earlier to latest). We stop when we obtain <inline-formula id="pcbi.1006117.e027"><alternatives><graphic id="pcbi.1006117.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006117.e027" xlink:type="simple"/><mml:math display="inline" id="M27"><mml:mover accent="true"><mml:mi>T</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula>.</p>
</sec>
<sec id="sec011">
<title>Simulations of pathogen evolution</title>
<p>To test the accuracy of our new method BadTrIP in inferring transmission events, and to compare it with the SVC method [<xref ref-type="bibr" rid="pcbi.1006117.ref030">30</xref>], we simulated pathogen evolution within outbreaks and sample sequencing, and we used different methods to reconstruct the transmission history from sequencing and epidemiological data. To simulate pathogen evolution, first we simulated an outbreak using SEEDY [<xref ref-type="bibr" rid="pcbi.1006117.ref042">42</xref>] with a host population of 15 hosts and an infection rate of 0.1 per day, a recovery rate 0.07 per day, and conditionally accepting only outbreaks that achieve a minimum total of 10 infected cases. Given these parameters, SEEDY will start at time 0 with one infected individual in the community of 15 hosts. Each day every infected host has a 0.1 chance of infecting any other host, and a 0.07 chance of recovering (recovered hosts are no more infectious or infectable). If the outbreak runs out of infected hosts before a total of 10 hosts are infected, the simulation is repeated. We then took the outbreak simulated by SEEDY and translated the transmission history into a population history, assuming a within-host pathogen population size of 1000 and using fastsimcoal2 [<xref ref-type="bibr" rid="pcbi.1006117.ref043">43</xref>] to simulate pathogen coalescent, recombination and mutation with scenario-dependent parameters. fastSimCoal2 is an approximate coalescent simulator implementing the sequential Markov coalescent model [<xref ref-type="bibr" rid="pcbi.1006117.ref050">50</xref>, <xref ref-type="bibr" rid="pcbi.1006117.ref051">51</xref>] with cross-over recombination. This model describes viral recombination more appropriately than bacterial recombination, for which a coalescent simulation software modeling gene conversion is preferable [<xref ref-type="bibr" rid="pcbi.1006117.ref052">52</xref>, <xref ref-type="bibr" rid="pcbi.1006117.ref053">53</xref>]. The use of a coalescent simulator with recombination is also the main difference with the simulations made by [<xref ref-type="bibr" rid="pcbi.1006117.ref030">30</xref>], where within-host recombination was not allowed. Within each infection we assume that the population size is constantly 1000 individuals, but at the time of transmission we assume an instantaneous population bottleneck (founding population size either 1 or 5 individuals depending on the scenario). At the time of a transmission (simulated by SEEDY) the whole infectee population is, backward in time, merged with the infector population. We observed that some times, in particular at high recombination rates, fastSimCoal can crash: if this happens we simply repeat the fastSimCoal2 simulation with a different seed. Throughout all simulations each host was sampled exactly once.</p>
<p>We define a basic group of simulations (called “base”), and nine variants, in each of which one or two aspects of the base group of simulations is modified. In “base” we simulated about 300–500 SNPs (counting also variants present at very low frequency in just one host) or 45 substitutions per outbreak (which might be typical for HIV but high for many other pathogens), recombination rate 10 times higher than the mutation rate, complete bottlenecks (no transmission of within-host genetic variants), homogeneous read coverage of 40x, no sequencing error, PoMo virtual population size of 15, all equal mutation rates, and genome size of 5 kb. The eleven variant settings are:</p>
<list list-type="bullet">
<list-item>
<p><bold>no recombination</bold>—the recombination rate is set to 0.</p>
</list-item>
<list-item>
<p><bold>high recombination</bold>—the recombination rate is increased 10-fold.</p>
</list-item>
<list-item>
<p><bold>high mutation</bold>—the mutation rate is 10-fold higher resulting in 2000–3000 SNPs and about 385 substitutions per outbreak.</p>
</list-item>
<list-item>
<p><bold>low mutation</bold>—the mutation rate is 10-fold lower resulting in 30–50 SNPs and about 4–5 substitutions per outbreak.</p>
</list-item>
<list-item>
<p><bold>very low mutation</bold>—the mutation rate is 1000-fold lower, resulting in 0–1 SNPs and 0 substitutions per outbreak.</p>
</list-item>
<list-item>
<p><bold>weak bottleneck</bold>—at transmission, 5 pathogen particles from the infector colonise the infected host, instead of just 1.</p>
</list-item>
<list-item>
<p><bold>high recombination and weak bottleneck</bold>—the recombination rate is 10-fold higher and the founding population at transmission is made of 5 pathogen particles.</p>
</list-item>
<list-item>
<p><bold>high coverage</bold>—read coverage is higher (100x instead of 40x).</p>
</list-item>
<list-item>
<p><bold>1x coverage</bold>—read coverage is extremely low (1x instead of 40x).</p>
</list-item>
<list-item>
<p><bold>sequencing error</bold>—read coverage is lower (20x instead of 40x), genome size is reduced (1kb instead of 5kb) and read bases are randomly modified to simulate sequencing error (0.2% of bases in reads are wrong).</p>
</list-item>
<list-item>
<p><bold>high N</bold>—the PoMo virtual population size is 25 instead of 15 (this only affects the BADTRIP inference and not the simulation itself).</p>
</list-item>
</list>
<p>We ran 10 replicates for all scenarios, and 20 for “base”, “weak bottleneck” and “no recombination” (some scenarios are more computationally demanding due to the effect of recombination on coalescent simulations and of genetic diversity on transmission inference). For each repeat in each scenario we ran a completely different simulation with different seeds resulting in different transmission and coalescent histories, even when outrbeak or coalescent parameters do not change across scenarios. We ran the BadTrIP MCMC for 5 ⋅ 10<sup>5</sup> steps for each replicate, sampled from the posterior every 100 steps and with a 20% burn-in. We specified in BadTrIP the true simulated sampling time and removal time of each host, while we specified as introduction time of each host its infection time minus one quarter of the mean duration of infection (so that the true infection time is contained within the exposure time of the host). For SCOTTI we used the same epidemiological data and options as for BadTrIP, except that we ran the MCMC for 2 ⋅ 10<sup>6</sup> steps for each replicate. We did not allow unobserved cases in SCOTTI. We measured accuracy as the frequency with which the correct transmission source of each host is inferred by a method to be the most likely a posteriori. We also measured calibration as how often the correct transmission source is the the 95% posterior credible set (the minimum set of sources with cumulative probability ≥ 95% such that all sources in the set have higher posterior probability than all sources outside of it).</p>
<p>We also used the SVC method [<xref ref-type="bibr" rid="pcbi.1006117.ref030">30</xref>] to infer transmission from simulated data. This method consists of selecting, for each host <italic>d</italic>, the set of possible infectors as those cases with most shared variants with <italic>d</italic>, or, if <italic>d</italic> does not share variants with other hosts, the cases with the smallest consensus genetic distance from <italic>d</italic>. If a single possible infector is found, it is assigned 100% posterior probability, otherwise if multiple possible infectors are found they are assigned the same posterior probability. For example, if 4 cases all have 2 shared genetic variants with <italic>d</italic>, and all other cases have fewer than 2, than each of those 4 cases is assigned a posterior probability of 25% of infecting <italic>d</italic>. This is very different from BadTrIP, which always weighs the information from shared variants, genetic distances, and epidemiological data simultaneously from all cases. So, the 4 cases sharing 2 genetic variants with <italic>d</italic> can have very different posterior probabilities in BadTrIP of being infectors of <italic>d</italic>, depending on the other data. For example, if one of these 4 cases has very high genetic distance from <italic>d</italic>, or epidemiological data incompatible with a transmission to <italic>d</italic>, BadTrIP would infer very low (or null) probability of it being the infector of <italic>d</italic>.</p>
</sec>
<sec id="sec012">
<title>The 2014 Sierra Leone Ebola dataset</title>
<p>We use sequencing and epidemiological data published by Gire and colleagues [<xref ref-type="bibr" rid="pcbi.1006117.ref040">40</xref>] and analysed by Worby and colleagues [<xref ref-type="bibr" rid="pcbi.1006117.ref030">30</xref>]. In particular, we use information from sampling dates, nucleotide frequencies and sequencing coverage. We specify the introduction date (removal date) of each host as its sampling date minus (plus) 21 days. This means that we allow each host to be infected at most 21 days before it being sampled, and to infect others at most 21 days after being sampled. We ran the BadTrIP MCMC until an effective sample size of 1000 was reached for each parameter and for the posterior probability (requiring ≈ 3.5 million MCMC steps). to reduce the computational time required we subsampled the reads from each sample to obtain a per-base coverage of at most 100.</p>
</sec>
<sec id="sec013">
<title>Software availability</title>
<p>BadTrIP is distributed as an open source package for the Bayesian phylogenetic software BEAST2 [<xref ref-type="bibr" rid="pcbi.1006117.ref039">39</xref>]. It can be downloaded from <ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/nicofmay/badtrip/" xlink:type="simple">https://bitbucket.org/nicofmay/badtrip/</ext-link> or via the BEAUti interface [<xref ref-type="bibr" rid="pcbi.1006117.ref054">54</xref>] of BEAST2.</p>
</sec>
</sec>
<sec id="sec014">
<title>Supporting information</title>
<supplementary-material id="pcbi.1006117.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006117.s001" xlink:type="simple">
<label>S1 Text</label>
<caption>
<title>The supplementary text containing supplementary figures.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006117.s002" mimetype="application/zip" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006117.s002" xlink:type="simple">
<label>S1 Data</label>
<caption>
<title>Contains the xml script to replicate our Ebola analysis with BadTrIP, an R script to run the SVC approach, and a python script to replicate our simulations.</title>
<p>(ZIP)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="pcbi.1006117.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Didelot</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Bowden</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Wilson</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>Peto</surname> <given-names>TE</given-names></name>, <name name-style="western"><surname>Crook</surname> <given-names>DW</given-names></name>. <article-title>Transforming clinical microbiology with bacterial genome sequencing</article-title>. <source>Nature Reviews Genetics</source>. <year>2012</year>;<volume>13</volume>(<issue>9</issue>):<fpage>601</fpage>–<lpage>612</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nrg3226" xlink:type="simple">10.1038/nrg3226</ext-link></comment> <object-id pub-id-type="pmid">22868263</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006117.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wilson</surname> <given-names>DJ</given-names></name>. <article-title>Insights from genomics into bacterial pathogen populations</article-title>. <source>PLoS Pathog</source>. <year>2012</year>;<volume>8</volume>(<issue>9</issue>):<fpage>e1002874</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.ppat.1002874" xlink:type="simple">10.1371/journal.ppat.1002874</ext-link></comment> <object-id pub-id-type="pmid">22969423</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006117.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Köser</surname> <given-names>CU</given-names></name>, <name name-style="western"><surname>Ellington</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Cartwright</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Gillespie</surname> <given-names>SH</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>NM</given-names></name>, <name name-style="western"><surname>Farrington</surname> <given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Routine use of microbial whole genome sequencing in diagnostic and public health microbiology</article-title>. <source>PLoS Pathog</source>. <year>2012</year>;<volume>8</volume>(<issue>8</issue>):<fpage>e1002824</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.ppat.1002824" xlink:type="simple">10.1371/journal.ppat.1002824</ext-link></comment> <object-id pub-id-type="pmid">22876174</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006117.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Le</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Diep</surname> <given-names>BA</given-names></name>. <article-title>Selected insights from application of whole-genome sequencing for outbreak investigations</article-title>. <source>Current opinion in critical care</source>. <year>2013</year>;<volume>19</volume>(<issue>5</issue>):<fpage>432</fpage>–<lpage>439</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1097/MCC.0b013e3283636b8c" xlink:type="simple">10.1097/MCC.0b013e3283636b8c</ext-link></comment> <object-id pub-id-type="pmid">23856896</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006117.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Eyre</surname> <given-names>DW</given-names></name>, <name name-style="western"><surname>Cule</surname> <given-names>ML</given-names></name>, <name name-style="western"><surname>Wilson</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>Griffiths</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Vaughan</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>O’Connor</surname> <given-names>L</given-names></name>, <etal>et al</etal>. <article-title>Diverse sources of C. difficile infection identified on whole-genome sequencing</article-title>. <source>New England Journal of Medicine</source>. <year>2013</year>;<volume>369</volume>(<issue>13</issue>):<fpage>1195</fpage>–<lpage>1205</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1056/NEJMoa1216064" xlink:type="simple">10.1056/NEJMoa1216064</ext-link></comment> <object-id pub-id-type="pmid">24066741</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006117.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Walker</surname> <given-names>TM</given-names></name>, <name name-style="western"><surname>Ip</surname> <given-names>CL</given-names></name>, <name name-style="western"><surname>Harrell</surname> <given-names>RH</given-names></name>, <name name-style="western"><surname>Evans</surname> <given-names>JT</given-names></name>, <name name-style="western"><surname>Kapatai</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Dedicoat</surname> <given-names>MJ</given-names></name>, <etal>et al</etal>. <article-title>Whole-genome sequencing to delineate Mycobacterium tuberculosis outbreaks: a retrospective observational study</article-title>. <source>The Lancet infectious diseases</source>. <year>2013</year>;<volume>13</volume>(<issue>2</issue>):<fpage>137</fpage>–<lpage>146</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/S1473-3099(12)70277-3" xlink:type="simple">10.1016/S1473-3099(12)70277-3</ext-link></comment> <object-id pub-id-type="pmid">23158499</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006117.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Walker</surname> <given-names>TM</given-names></name>, <name name-style="western"><surname>Lalor</surname> <given-names>MK</given-names></name>, <name name-style="western"><surname>Broda</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Ortega</surname> <given-names>LS</given-names></name>, <name name-style="western"><surname>Morgan</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Parker</surname> <given-names>L</given-names></name>, <etal>et al</etal>. <article-title>Assessment of Mycobacterium tuberculosis transmission in Oxfordshire, UK, 2007–12, with whole pathogen genome sequences: an observational study</article-title>. <source>The Lancet Respiratory Medicine</source>. <year>2014</year>;<volume>2</volume>(<issue>4</issue>):<fpage>285</fpage>–<lpage>292</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/S2213-2600(14)70027-X" xlink:type="simple">10.1016/S2213-2600(14)70027-X</ext-link></comment> <object-id pub-id-type="pmid">24717625</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006117.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Leitner</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Escanilla</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Franzen</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Uhlen</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Albert</surname> <given-names>J</given-names></name>. <article-title>Accurate reconstruction of a known HIV-1 transmission history by phylogenetic tree analysis</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>1996</year>;<volume>93</volume>(<issue>20</issue>):<fpage>10864</fpage>–<lpage>10869</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.93.20.10864" xlink:type="simple">10.1073/pnas.93.20.10864</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006117.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Harris</surname> <given-names>SR</given-names></name>, <name name-style="western"><surname>Feil</surname> <given-names>EJ</given-names></name>, <name name-style="western"><surname>Holden</surname> <given-names>MT</given-names></name>, <name name-style="western"><surname>Quail</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Nickerson</surname> <given-names>EK</given-names></name>, <name name-style="western"><surname>Chantratita</surname> <given-names>N</given-names></name>, <etal>et al</etal>. <article-title>Evolution of MRSA during hospital transmission and intercontinental spread</article-title>. <source>Science</source>. <year>2010</year>;<volume>327</volume>(<issue>5964</issue>):<fpage>469</fpage>–<lpage>474</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.1182395" xlink:type="simple">10.1126/science.1182395</ext-link></comment> <object-id pub-id-type="pmid">20093474</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006117.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pybus</surname> <given-names>OG</given-names></name>, <name name-style="western"><surname>Rambaut</surname> <given-names>A</given-names></name>. <article-title>Evolutionary analysis of the dynamics of viral infectious disease</article-title>. <source>Nature Reviews Genetics</source>. <year>2009</year>;<volume>10</volume>(<issue>8</issue>):<fpage>540</fpage>–<lpage>550</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nrg2583" xlink:type="simple">10.1038/nrg2583</ext-link></comment> <object-id pub-id-type="pmid">19564871</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006117.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Worby</surname> <given-names>CJ</given-names></name>, <name name-style="western"><surname>Lipsitch</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Hanage</surname> <given-names>WP</given-names></name>. <article-title>Within-host bacterial diversity hinders accurate reconstruction of transmission networks from genomic distance data</article-title>. <source>PLoS Comput Biol</source>. <year>2014</year>;<volume>10</volume>:<fpage>e1003549</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1003549" xlink:type="simple">10.1371/journal.pcbi.1003549</ext-link></comment> <object-id pub-id-type="pmid">24675511</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006117.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Romero-Severson</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Skar</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Bulla</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Albert</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Leitner</surname> <given-names>T</given-names></name>. <article-title>Timing and order of transmission events is not directly reflected in a pathogen phylogeny</article-title>. <source>Molecular biology and evolution</source>. <year>2014</year>;<volume>31</volume>(<issue>9</issue>):<fpage>2472</fpage>–<lpage>2482</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/molbev/msu179" xlink:type="simple">10.1093/molbev/msu179</ext-link></comment> <object-id pub-id-type="pmid">24874208</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006117.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>De Maio</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Wu</surname> <given-names>CH</given-names></name>, <name name-style="western"><surname>Wilson</surname> <given-names>DJ</given-names></name>. <article-title>SCOTTI: efficient reconstruction of transmission within outbreaks with the structured coalescent</article-title>. <source>PLoS computational biology</source>. <year>2016</year>;<volume>12</volume>(<issue>9</issue>):<fpage>e1005130</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1005130" xlink:type="simple">10.1371/journal.pcbi.1005130</ext-link></comment> <object-id pub-id-type="pmid">27681228</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006117.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cottam</surname> <given-names>EM</given-names></name>, <name name-style="western"><surname>Thébaud</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Wadsworth</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Gloster</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Mansley</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Paton</surname> <given-names>DJ</given-names></name>, <etal>et al</etal>. <article-title>Integrating genetic and epidemiological data to determine transmission pathways of foot-and-mouth disease virus</article-title>. <source>Proceedings of the Royal Society of London B: Biological Sciences</source>. <year>2008</year>;<volume>275</volume>(<issue>1637</issue>):<fpage>887</fpage>–<lpage>895</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1098/rspb.2007.1442" xlink:type="simple">10.1098/rspb.2007.1442</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006117.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Aldrin</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Lyngstad</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Kristoffersen</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Storvik</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Borgan</surname> <given-names>Ø</given-names></name>, <name name-style="western"><surname>Jansen</surname> <given-names>P</given-names></name>. <article-title>Modelling the spread of infectious salmon anaemia among salmon farms based on seaway distances between farms and genetic relationships between infectious salmon anaemia virus isolates</article-title>. <source>Journal of The Royal Society Interface</source>. <year>2011</year>;<volume>8</volume>(<issue>62</issue>):<fpage>1346</fpage>–<lpage>1356</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1098/rsif.2010.0737" xlink:type="simple">10.1098/rsif.2010.0737</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006117.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Jombart</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Eggo</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Dodd</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Balloux</surname> <given-names>F</given-names></name>. <article-title>Reconstructing disease outbreaks from genetic data: a graph approach</article-title>. <source>Heredity</source>. <year>2011</year>;<volume>106</volume>(<issue>2</issue>):<fpage>383</fpage>–<lpage>390</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/hdy.2010.78" xlink:type="simple">10.1038/hdy.2010.78</ext-link></comment> <object-id pub-id-type="pmid">20551981</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006117.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lieberman</surname> <given-names>TD</given-names></name>, <name name-style="western"><surname>Michel</surname> <given-names>JB</given-names></name>, <name name-style="western"><surname>Aingaran</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Potter-Bynoe</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Roux</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Davis</surname> <given-names>MR</given-names> <suffix>Jr</suffix></name>, <etal>et al</etal>. <article-title>Parallel bacterial evolution within multiple patients identifies candidate pathogenicity genes</article-title>. <source>Nature genetics</source>. <year>2011</year>;<volume>43</volume>(<issue>12</issue>):<fpage>1275</fpage>–<lpage>1280</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ng.997" xlink:type="simple">10.1038/ng.997</ext-link></comment> <object-id pub-id-type="pmid">22081229</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006117.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Morelli</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Thebaud</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Chadoeuf</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>King</surname> <given-names>DP</given-names></name>, <name name-style="western"><surname>Haydon</surname> <given-names>DT</given-names></name>, <name name-style="western"><surname>Soubeyrand</surname> <given-names>S</given-names></name>. <article-title>A Bayesian Inference Framework to Reconstruct Transmission Trees Using Epidemiological and Genetic Data</article-title>. <source>PLoS Comput Biol</source>. <year>2012</year> <month>11</month>;<volume>8</volume>(<issue>11</issue>):<fpage>e1002768</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1002768" xlink:type="simple">10.1371/journal.pcbi.1002768</ext-link></comment> <object-id pub-id-type="pmid">23166481</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006117.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ypma</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Bataille</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Stegeman</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Koch</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Wallinga</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Van Ballegooijen</surname> <given-names>W</given-names></name>. <article-title>Unravelling transmission trees of infectious diseases by combining genetic and epidemiological data</article-title>. <source>Proceedings of the Royal Society of London B: Biological Sciences</source>. <year>2012</year>;<volume>279</volume>(<issue>1728</issue>):<fpage>444</fpage>–<lpage>450</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1098/rspb.2011.0913" xlink:type="simple">10.1098/rspb.2011.0913</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006117.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ypma</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>van Ballegooijen</surname> <given-names>WM</given-names></name>, <name name-style="western"><surname>Wallinga</surname> <given-names>J</given-names></name>. <article-title>Relating phylogenetic trees to transmission trees of infectious disease outbreaks</article-title>. <source>Genetics</source>. <year>2013</year>;<volume>195</volume>(<issue>3</issue>):<fpage>1055</fpage>–<lpage>1062</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1534/genetics.113.154856" xlink:type="simple">10.1534/genetics.113.154856</ext-link></comment> <object-id pub-id-type="pmid">24037268</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006117.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Volz</surname> <given-names>EM</given-names></name>, <name name-style="western"><surname>Frost</surname> <given-names>SD</given-names></name>. <article-title>Inferring the source of transmission with phylogenetic data</article-title>. <source>PLoS Comput Biol</source>. <year>2013</year>;. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1003397" xlink:type="simple">10.1371/journal.pcbi.1003397</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006117.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Jombart</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Cori</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Didelot</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Cauchemez</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Fraser</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Ferguson</surname> <given-names>N</given-names></name>. <article-title>Bayesian reconstruction of disease outbreaks by combining epidemiologic and genomic data</article-title>. <source>PLoS computational biology</source>. <year>2014</year>;<volume>10</volume>(<issue>1</issue>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1003457" xlink:type="simple">10.1371/journal.pcbi.1003457</ext-link></comment> <object-id pub-id-type="pmid">24465202</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006117.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mollentze</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Nel</surname> <given-names>LH</given-names></name>, <name name-style="western"><surname>Townsend</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Le Roux</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Hampson</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Haydon</surname> <given-names>DT</given-names></name>, <etal>et al</etal>. <article-title>A Bayesian approach for inferring the dynamics of partially observed endemic infectious diseases from space-time-genetic data</article-title>. <source>Proceedings of the Royal Society of London B: Biological Sciences</source>. <year>2014</year>;<volume>281</volume>(<issue>1782</issue>):<fpage>20133251</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1098/rspb.2013.3251" xlink:type="simple">10.1098/rspb.2013.3251</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006117.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Didelot</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Gardy</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Colijn</surname> <given-names>C</given-names></name>. <article-title>Bayesian inference of infectious disease transmission from whole-genome sequence data</article-title>. <source>Molecular biology and evolution</source>. <year>2014</year>;<volume>31</volume>(<issue>7</issue>):<fpage>1869</fpage>–<lpage>1879</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/molbev/msu121" xlink:type="simple">10.1093/molbev/msu121</ext-link></comment> <object-id pub-id-type="pmid">24714079</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006117.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hall</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Woolhouse</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Rambaut</surname> <given-names>A</given-names></name>. <article-title>Epidemic reconstruction in a phylogenetics framework: transmission trees as partitions of the node set</article-title>. <source>PLoS Comput Biol</source>. <year>2015</year>;<volume>11</volume>(<issue>12</issue>):<fpage>e1004613</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1004613" xlink:type="simple">10.1371/journal.pcbi.1004613</ext-link></comment> <object-id pub-id-type="pmid">26717515</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006117.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Romero-Severson</surname> <given-names>EO</given-names></name>, <name name-style="western"><surname>Bulla</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Leitner</surname> <given-names>T</given-names></name>. <article-title>Phylogenetically resolving epidemiologic linkage</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2016</year>; p. <fpage>201522930</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006117.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Didelot</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Fraser</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Gardy</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Colijn</surname> <given-names>C</given-names></name>. <article-title>Genomic infectious disease epidemiology in partially sampled and ongoing outbreaks</article-title>. <source>Molecular biology and evolution</source>. <year>2017</year>;<volume>34</volume>(<issue>4</issue>):<fpage>997</fpage>–<lpage>1007</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/molbev/msw275" xlink:type="simple">10.1093/molbev/msw275</ext-link></comment> <object-id pub-id-type="pmid">28100788</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006117.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Klinkenberg</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Backer</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Didelot</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Colijn</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Wallinga</surname> <given-names>J</given-names></name>. <article-title>Simultaneous inference of phylogenetic and transmission trees in infectious disease outbreaks</article-title>. <source>PLoS computational biology</source>. <year>2017</year>;<volume>13</volume>(<issue>5</issue>):<fpage>e1005495</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1005495" xlink:type="simple">10.1371/journal.pcbi.1005495</ext-link></comment> <object-id pub-id-type="pmid">28545083</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006117.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bull</surname> <given-names>RA</given-names></name>, <name name-style="western"><surname>Eden</surname> <given-names>JS</given-names></name>, <name name-style="western"><surname>Luciani</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>McElroy</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Rawlinson</surname> <given-names>WD</given-names></name>, <name name-style="western"><surname>White</surname> <given-names>PA</given-names></name>. <article-title>Contribution of intra-and interhost dynamics to norovirus evolution</article-title>. <source>Journal of virology</source>. <year>2012</year>;<volume>86</volume>(<issue>6</issue>):<fpage>3219</fpage>–<lpage>3229</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1128/JVI.06712-11" xlink:type="simple">10.1128/JVI.06712-11</ext-link></comment> <object-id pub-id-type="pmid">22205753</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006117.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Worby</surname> <given-names>CJ</given-names></name>, <name name-style="western"><surname>Lipsitch</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Hanage</surname> <given-names>WP</given-names></name>. <article-title>Shared genomic variants: identification of transmission routes using pathogen deep sequence data</article-title>. <source>American Journal of Epidemiology</source>. <year>2015</year>;.</mixed-citation>
</ref>
<ref id="pcbi.1006117.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Leonard</surname> <given-names>AS</given-names></name>, <name name-style="western"><surname>Weissman</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Greenbaum</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Ghedin</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Koelle</surname> <given-names>K</given-names></name>. <article-title>Transmission Bottleneck Size Estimation from Pathogen Deep-Sequencing Data, with an Application to Human Influenza A Virus</article-title>. <source>Journal of Virology</source>. <year>2017</year>; p.</mixed-citation>
</ref>
<ref id="pcbi.1006117.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Skums</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Zelikovsky</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Singh</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Gussler</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Dimitrova</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Knyazev</surname> <given-names>S</given-names></name>, <etal>et al</etal>. <article-title>QUENTIN: reconstruction of disease transmissions from viral quasispecies genomic data</article-title>. <source>Bioinformatics</source>. <year>2017</year>; p.</mixed-citation>
</ref>
<ref id="pcbi.1006117.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Shriner</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Rodrigo</surname> <given-names>AG</given-names></name>, <name name-style="western"><surname>Nickle</surname> <given-names>DC</given-names></name>, <name name-style="western"><surname>Mullins</surname> <given-names>JI</given-names></name>. <article-title>Pervasive genomic recombination of HIV-1 in vivo</article-title>. <source>Genetics</source>. <year>2004</year>;<volume>167</volume>(<issue>4</issue>):<fpage>1573</fpage>–<lpage>1583</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1534/genetics.103.023382" xlink:type="simple">10.1534/genetics.103.023382</ext-link></comment> <object-id pub-id-type="pmid">15342499</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006117.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Schneider</surname> <given-names>TD</given-names></name>, <name name-style="western"><surname>Stephens</surname> <given-names>RM</given-names></name>. <article-title>Sequence logos: a new way to display consensus sequences</article-title>. <source>Nucleic Acids Res</source>. <year>1990</year>;<volume>18</volume>:<fpage>6097</fpage>–<lpage>6100</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/18.20.6097" xlink:type="simple">10.1093/nar/18.20.6097</ext-link></comment> <object-id pub-id-type="pmid">2172928</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006117.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Crooks</surname> <given-names>GE</given-names></name>, <name name-style="western"><surname>Hon</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Chandonia</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Brenner</surname> <given-names>SE</given-names></name>. <article-title>WebLogo: a sequence logo generator</article-title>. <source>Genome research</source>. <year>2004</year>;<volume>14</volume>(<issue>6</issue>):<fpage>1188</fpage>–<lpage>1190</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1101/gr.849004" xlink:type="simple">10.1101/gr.849004</ext-link></comment> <object-id pub-id-type="pmid">15173120</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006117.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>De Maio</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Schlötterer</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Kosiol</surname> <given-names>C</given-names></name>. <article-title>Linking great apes genome evolution across time scales using polymorphism-aware phylogenetic models</article-title>. <source>Molecular biology and evolution</source>. <year>2013</year>;<volume>30</volume>(<issue>10</issue>):<fpage>2249</fpage>–<lpage>2262</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/molbev/mst131" xlink:type="simple">10.1093/molbev/mst131</ext-link></comment> <object-id pub-id-type="pmid">23906727</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006117.ref037">
<label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>De Maio</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Schrempf</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Kosiol</surname> <given-names>C</given-names></name>. <article-title>PoMo: an allele frequency-based approach for species tree estimation</article-title>. <source>Systematic biology</source>. <year>2015</year>;<volume>64</volume>(<issue>6</issue>):<fpage>1018</fpage>–<lpage>1031</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/sysbio/syv048" xlink:type="simple">10.1093/sysbio/syv048</ext-link></comment> <object-id pub-id-type="pmid">26209413</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006117.ref038">
<label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Schrempf</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Minh</surname> <given-names>BQ</given-names></name>, <name name-style="western"><surname>De Maio</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>von Haeseler</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Kosiol</surname> <given-names>C</given-names></name>. <article-title>Reversible polymorphism-aware phylogenetic models and their application to tree inference</article-title>. <source>Journal of theoretical biology</source>. <year>2016</year>;<volume>407</volume>:<fpage>362</fpage>–<lpage>370</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.jtbi.2016.07.042" xlink:type="simple">10.1016/j.jtbi.2016.07.042</ext-link></comment> <object-id pub-id-type="pmid">27480613</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006117.ref039">
<label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bouckaert</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Heled</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Kühnert</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Vaughan</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Wu</surname> <given-names>CH</given-names></name>, <name name-style="western"><surname>Xie</surname> <given-names>D</given-names></name>, <etal>et al</etal>. <article-title>BEAST 2: a software platform for Bayesian evolutionary analysis</article-title>. <source>PLoS Comput Biol</source>. <year>2014</year>;<volume>10</volume>(<issue>4</issue>):<fpage>e1003537</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1003537" xlink:type="simple">10.1371/journal.pcbi.1003537</ext-link></comment> <object-id pub-id-type="pmid">24722319</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006117.ref040">
<label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gire</surname> <given-names>SK</given-names></name>, <name name-style="western"><surname>Goba</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Andersen</surname> <given-names>KG</given-names></name>, <name name-style="western"><surname>Sealfon</surname> <given-names>RS</given-names></name>, <name name-style="western"><surname>Park</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>Kanneh</surname> <given-names>L</given-names></name>, <etal>et al</etal>. <article-title>Genomic surveillance elucidates Ebola virus origin and transmission during the 2014 outbreak</article-title>. <source>Science</source>. <year>2014</year>;<volume>345</volume>(<issue>6202</issue>):<fpage>1369</fpage>–<lpage>1372</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.1259657" xlink:type="simple">10.1126/science.1259657</ext-link></comment> <object-id pub-id-type="pmid">25214632</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006117.ref041">
<label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Moran</surname> <given-names>PAP</given-names></name>; <collab>Cambridge Univ Press</collab>. <article-title>Random processes in genetics</article-title>. <source>Math Proc Cambridge</source>. <year>1958</year>;<volume>54</volume>:<fpage>60</fpage>–<lpage>71</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1017/S0305004100033193" xlink:type="simple">10.1017/S0305004100033193</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006117.ref042">
<label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Worby</surname> <given-names>CJ</given-names></name>, <name name-style="western"><surname>Read</surname> <given-names>TD</given-names></name>. <article-title>’SEEDY’(Simulation of Evolutionary and Epidemiological Dynamics): An R Package to Follow Accumulation of Within-Host Mutation in Pathogens</article-title>. <source>PloS one</source>. <year>2015</year>;<volume>10</volume>(<issue>6</issue>):<fpage>e0129745</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0129745" xlink:type="simple">10.1371/journal.pone.0129745</ext-link></comment> <object-id pub-id-type="pmid">26075402</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006117.ref043">
<label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Excoffier</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Dupanloup</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Huerta-Sánchez</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Sousa</surname> <given-names>VC</given-names></name>, <name name-style="western"><surname>Foll</surname> <given-names>M</given-names></name>. <article-title>Robust demographic inference from genomic and SNP data</article-title>. <source>PLoS genetics</source>. <year>2013</year>;<volume>9</volume>(<issue>10</issue>):<fpage>e1003905</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pgen.1003905" xlink:type="simple">10.1371/journal.pgen.1003905</ext-link></comment> <object-id pub-id-type="pmid">24204310</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006117.ref044">
<label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dawid</surname> <given-names>AP</given-names></name>. <article-title>The well-calibrated Bayesian</article-title>. <source>Journal of the American Statistical Association</source>. <year>1982</year>;<volume>77</volume>(<issue>379</issue>):<fpage>605</fpage>–<lpage>610</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1080/01621459.1982.10477856" xlink:type="simple">10.1080/01621459.1982.10477856</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006117.ref045">
<label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Loman</surname> <given-names>NJ</given-names></name>, <name name-style="western"><surname>Misra</surname> <given-names>RV</given-names></name>, <name name-style="western"><surname>Dallman</surname> <given-names>TJ</given-names></name>, <name name-style="western"><surname>Constantinidou</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Gharbia</surname> <given-names>SE</given-names></name>, <name name-style="western"><surname>Wain</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Performance comparison of benchtop high-throughput sequencing platforms</article-title>. <source>Nature biotechnology</source>. <year>2012</year>;<volume>30</volume>(<issue>5</issue>):<fpage>434</fpage>–<lpage>439</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nbt.2198" xlink:type="simple">10.1038/nbt.2198</ext-link></comment> <object-id pub-id-type="pmid">22522955</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006117.ref046">
<label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Romero-Severson</surname> <given-names>EO</given-names></name>, <name name-style="western"><surname>Bulla</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Hengartner</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Bártolo</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Abecasis</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Azevedo-Pereira</surname> <given-names>JM</given-names></name>, <etal>et al</etal>. <article-title>Donor-Recipient identification in para-and poly-phyletic trees under alternative HIV-1 transmission hypotheses using approximate Bayesian computation</article-title>. <source>Genetics</source>. <year>2017</year>;<volume>207</volume>(<issue>3</issue>):<fpage>1089</fpage>–<lpage>1101</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1534/genetics.117.300284" xlink:type="simple">10.1534/genetics.117.300284</ext-link></comment> <object-id pub-id-type="pmid">28912340</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006117.ref047">
<label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yu</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Than</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Degnan</surname> <given-names>JH</given-names></name>, <name name-style="western"><surname>Nakhleh</surname> <given-names>L</given-names></name>. <article-title>Coalescent histories on phylogenetic networks and detection of hybridization despite incomplete lineage sorting</article-title>. <source>Systematic Biology</source>. <year>2011</year>;<volume>60</volume>(<issue>2</issue>):<fpage>138</fpage>–<lpage>149</lpage>. <object-id pub-id-type="pmid">21248369</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006117.ref048">
<label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wymant</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Hall</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Ratmann</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Bonsall</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Golubchik</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>de Cesare</surname> <given-names>M</given-names></name>, <etal>et al</etal>. <article-title>PHYLOSCANNER: Analysing Within-and Between-Host Pathogen Genetic Diversity to Identify Transmission, Multiple Infection, Recombination and Contamination</article-title>. <source>bioRxiv</source>. <year>2017</year>; p. <fpage>157768</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006117.ref049">
<label>49</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Felsenstein</surname> <given-names>J</given-names></name>. <article-title>Evolutionary trees from DNA sequences: a maximum likelihood approach</article-title>. <source>J Mol Evol</source>. <year>1981</year>;<volume>17</volume>(<issue>6</issue>):<fpage>368</fpage>–<lpage>376</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/BF01734359" xlink:type="simple">10.1007/BF01734359</ext-link></comment> <object-id pub-id-type="pmid">7288891</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006117.ref050">
<label>50</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>McVean</surname> <given-names>GA</given-names></name>, <name name-style="western"><surname>Cardin</surname> <given-names>NJ</given-names></name>. <article-title>Approximating the coalescent with recombination</article-title>. <source>Philosophical Transactions of the Royal Society of London B: Biological Sciences</source>. <year>2005</year>;<volume>360</volume>(<issue>1459</issue>):<fpage>1387</fpage>–<lpage>1393</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1098/rstb.2005.1673" xlink:type="simple">10.1098/rstb.2005.1673</ext-link></comment> <object-id pub-id-type="pmid">16048782</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006117.ref051">
<label>51</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Marjoram</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Wall</surname> <given-names>JD</given-names></name>. <article-title>Fast “coalescent” simulation</article-title>. <source>BMC genetics</source>. <year>2006</year>;<volume>7</volume>(<issue>1</issue>):<fpage>16</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/1471-2156-7-16" xlink:type="simple">10.1186/1471-2156-7-16</ext-link></comment> <object-id pub-id-type="pmid">16539698</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006117.ref052">
<label>52</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Brown</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Didelot</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Wilson</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>De Maio</surname> <given-names>N</given-names></name>. <article-title>SimBac: simulation of whole bacterial genomes with homologous recombination</article-title>. <source>Microbial genomics</source>. <year>2016</year>;<volume>2</volume>(<issue>1</issue>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1099/mgen.0.000044" xlink:type="simple">10.1099/mgen.0.000044</ext-link></comment> <object-id pub-id-type="pmid">27713837</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006117.ref053">
<label>53</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>De Maio</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Wilson</surname> <given-names>DJ</given-names></name>. <article-title>The bacterial sequential Markov coalescent</article-title>. <source>Genetics</source>. <year>2017</year>;<volume>206</volume>(<issue>1</issue>):<fpage>333</fpage>–<lpage>343</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1534/genetics.116.198796" xlink:type="simple">10.1534/genetics.116.198796</ext-link></comment> <object-id pub-id-type="pmid">28258183</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006117.ref054">
<label>54</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Drummond</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Suchard</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Xie</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Rambaut</surname> <given-names>A</given-names></name>. <article-title>Bayesian phylogenetics with BEAUti and the BEAST 1.7</article-title>. <source>Mol Biol Evol</source>. <year>2012</year>;<volume>29</volume>(<issue>8</issue>):<fpage>1969</fpage>–<lpage>1973</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/molbev/mss075" xlink:type="simple">10.1093/molbev/mss075</ext-link></comment> <object-id pub-id-type="pmid">22367748</object-id></mixed-citation>
</ref>
</ref-list>
</back>
</article>