<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN"><front><journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher><publisher-name>Public Library of Science</publisher-name><publisher-loc>San Francisco, USA</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">07-PLCB-RA-0081R3</article-id><article-id pub-id-type="doi">10.1371/journal.pcbi.1000063</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline"><subject>Computational Biology/Comparative Sequence Analysis</subject><subject>Computational Biology/Evolutionary Modeling</subject><subject>Computational Biology/Genomics</subject><subject>Computational Biology/Protein Homology Detection</subject><subject>Evolutionary Biology/Bioinformatics</subject><subject>Evolutionary Biology/Evolutionary and Comparative Genetics</subject><subject>Evolutionary Biology/Genomics</subject></subj-group></article-categories><title-group><article-title>Sequence Similarity Network Reveals Common Ancestry of Multidomain Proteins</article-title><alt-title alt-title-type="running-head">Similarity Network Reveals Common Ancestry</alt-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Song</surname><given-names>Nan</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Joseph</surname><given-names>Jacob M.</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Davis</surname><given-names>George B.</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Durand</surname><given-names>Dannie</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff3"><sup>3</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib></contrib-group><aff id="aff1"><label>1</label><addr-line>Department of Biological Sciences, Carnegie Mellon University, Pittsburgh, Pennsylvania, United States of America</addr-line>       </aff><aff id="aff2"><label>2</label><addr-line>Computational Biology, Carnegie Mellon University, Pittsburgh, Pennsylvania, United States of America</addr-line>       </aff><aff id="aff3"><label>3</label><addr-line>School of Computer Science, Carnegie Mellon University, Pittsburgh, Pennsylvania, United States of America</addr-line>       </aff><contrib-group><contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Vogel</surname><given-names>Christine</given-names></name><role>Editor</role><xref ref-type="aff" rid="edit1"/></contrib></contrib-group><aff id="edit1">University of Texas at Austin, United States of America</aff><author-notes><corresp id="cor1">* E-mail: <email xlink:type="simple">durand@cmu.edu</email></corresp><fn fn-type="con"><p>Conceived and designed the experiments: NS JJ DD. Performed the experiments: NS JJ GD. Analyzed the data: NS JJ GD DD. Contributed reagents/materials/analysis tools: JJ GD. Wrote the paper: NS JJ GD DD.</p></fn><fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn></author-notes><pub-date pub-type="collection"><month>5</month><year>2008</year></pub-date><pub-date pub-type="epub"><day>16</day><month>5</month><year>2008</year></pub-date><volume>4</volume><issue>5</issue><elocation-id>e1000063</elocation-id><history><date date-type="received"><day>15</day><month>2</month><year>2007</year></date><date date-type="accepted"><day>18</day><month>3</month><year>2008</year></date></history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2008</copyright-year><copyright-holder>Song et al</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract><p>We address the problem of homology identification in complex multidomain families with varied domain architectures. The challenge is to distinguish sequence pairs that share common ancestry from pairs that share an inserted domain but are otherwise unrelated. This distinction is essential for accuracy in gene annotation, function prediction, and comparative genomics. There are two major obstacles to multidomain homology identification: lack of a formal definition and lack of curated benchmarks for evaluating the performance of new methods. We offer preliminary solutions to both problems: 1) an extension of the traditional model of homology to include domain insertions; and 2) a manually curated benchmark of well-studied families in mouse and human. We further present Neighborhood Correlation, a novel method that exploits the local structure of the sequence similarity network to identify homologs with great accuracy based on the observation that gene duplication and domain shuffling leave distinct patterns in the sequence similarity network. In a rigorous, empirical comparison using our curated data, Neighborhood Correlation outperforms sequence similarity, alignment length, and domain architecture comparison. Neighborhood Correlation is well suited for automated, genome-scale analyses. It is easy to compute, does not require explicit knowledge of domain architecture, and classifies both single and multidomain homologs with high accuracy. Homolog predictions obtained with our method, as well as our manually curated benchmark and a web-based visualization tool for exploratory analysis of the network neighborhood structure, are available at <ext-link ext-link-type="uri" xlink:href="http://www.neighborhoodcorrelation.org" xlink:type="simple">http://www.neighborhoodcorrelation.org</ext-link>. Our work represents a departure from the prevailing view that the concept of homology cannot be applied to genes that have undergone domain shuffling. In contrast to current approaches that either focus on the homology of individual domains or consider only families with identical domain architectures, we show that homology can be rationally defined for multidomain families with diverse architectures by considering the genomic context of the genes that encode them. Our study demonstrates the utility of mining network structure for evolutionary information, suggesting this is a fertile approach for investigating evolutionary processes in the post-genomic era.</p></abstract><abstract abstract-type="summary"><title>Author Summary</title><p>New genes evolve through the duplication and modification of existing genes. As a result, genes that share common ancestry tend to have similar structure and function. Computational methods that use common ancestry have been extraordinarily successful in inferring function. The practice of discerning evolutionary relationships is stymied, however, by modular sequences made up of two or more domains. When two genes share some domains but not others, it is difficult to distinguish a case of common ancestry from insertion of the same domain into both genes. We present a formal framework to define how multidomain genes are related, and propose a novel method for rapid, robust characterization of evolutionary relationships. In an empirical comparison with the current state of the art, we demonstrate superior performance of our method using a large hand-curated set of sequences known to share common ancestry. The success of our method derives from its unique ability to infer evolutionary history from local topology in the sequence similarity network. This represents a departure from the view that protein family classification must be restricted to families with conserved architecture. By exploiting the structure of the sequence similarity network, our approach surmounts this limitation and opens the door to studies of the role of modularity in protein evolution.</p></abstract><funding-group><funding-statement>This work was funded by NSF DBI-0641313, NIH grant 1 K22 HG 02451-01, and a David and Lucille Packard Foundation fellowship. These organizations have had no role in the design or execution of this study or in the preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="19"/></counts></article-meta></front><body><sec id="s1"><title>Introduction</title><p>Accurate identification of <italic>homologs</italic>, sequences that share common ancestry, is essential for accuracy in function prediction and comparative genomics. Homology identification is integral to the annotation of novel genes <xref ref-type="bibr" rid="pcbi.1000063-Wu1">[1]</xref> and prediction of gene function by various methods, including phylogenetic clustering <xref ref-type="bibr" rid="pcbi.1000063-Pellegrini1">[2]</xref>, gene fusion analysis <xref ref-type="bibr" rid="pcbi.1000063-Marcotte1">[3]</xref>,<xref ref-type="bibr" rid="pcbi.1000063-Enright1">[4]</xref>, phylogenomic inference <xref ref-type="bibr" rid="pcbi.1000063-Brown1">[5]</xref>, and genomic context <xref ref-type="bibr" rid="pcbi.1000063-Overbeek1">[6]</xref>,<xref ref-type="bibr" rid="pcbi.1000063-Dandekar1">[7]</xref>. Homologous genes are used as markers to identify homologous chromosomal regions for comparative mapping <xref ref-type="bibr" rid="pcbi.1000063-Nadeau1">[8]</xref>,<xref ref-type="bibr" rid="pcbi.1000063-OBrien1">[9]</xref>, analysis of whole genome duplication <xref ref-type="bibr" rid="pcbi.1000063-Durand1">[10]</xref>,<xref ref-type="bibr" rid="pcbi.1000063-VandePeer1">[11]</xref>, phylogenetic footprinting <xref ref-type="bibr" rid="pcbi.1000063-Dickmeis1">[12]</xref>, and operon prediction <xref ref-type="bibr" rid="pcbi.1000063-Chen1">[13]</xref>–<xref ref-type="bibr" rid="pcbi.1000063-Westover1">[15]</xref>. Pairwise homology detection is also an integral component of clustering approaches to protein family classification (<xref ref-type="bibr" rid="pcbi.1000063-Wu1">[1]</xref>,<xref ref-type="bibr" rid="pcbi.1000063-Redfern1">[16]</xref>, and work cited therein).</p><p>All of these applications exploit one or both of the following properties of homologous sequences: genes that share common ancestry tend (1) to have similar structure and function, and (2) be located in homologous chromosomal regions, making them suitable markers for comparative genomics. Because of their prevalence and importance, it is desirable to incorporate multidomain sequences in such analyses: Multidomain proteins represent 40% of the metazoan proteome, with functional roles in signal transduction, cellular adhesion, tissue repair, and immune response <xref ref-type="bibr" rid="pcbi.1000063-Tordai1">[17]</xref>. However, multidomain sequences, especially those with promiscuous domains that occur in many contexts, are frequently excluded from genomic analyses due to lack of a theoretical framework and practical methods for detecting multidomain homologs. In this paper, we extend the traditional definition of homology <xref ref-type="bibr" rid="pcbi.1000063-Fitch1">[18]</xref> to multidomain sequences that share a common ancestral gene, providing a formalism suitable for modeling multidomain family evolution, design and validation of multidomain homology identification methods, and incorporation of multidomain sequences in genomic analyses.</p><p>The original definition of molecular homology <xref ref-type="bibr" rid="pcbi.1000063-Fitch1">[18]</xref> does not capture multidomain evolution. Homology traditionally refers to evolution from a common ancestor by vertical descent (e.g., gene duplication and speciation), but multidomain proteins evolve via both vertical descent and domain insertion. For example, <xref ref-type="fig" rid="pcbi-1000063-g001">Figure 1</xref> depicts two genes, <italic>a</italic> and <italic>b</italic>, which share not only a homologous domain but also a common ancestral gene. In contrast, <italic>b</italic> and <italic>c</italic> are a <italic>domain-only match</italic>, a pair of sequences that share similarity due to insertion of the same domain into both sequences but are otherwise unrelated.</p><fig id="pcbi-1000063-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000063.g001</object-id><label>Figure 1</label><caption><title>The evolution of a hypothetical multidomain family by gene duplication and domain insertion.</title><p>Genes in the <italic>a</italic> and <italic>b</italic> subfamilies share a common ancestor but do not have identical domain composition. Gene <italic>c</italic> shares a homologous domain with genes in the <italic>b</italic> subfamily, but there is no gene that is ancestral to both <italic>b</italic> and <italic>c</italic>.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000063.g001" xlink:type="simple"/></fig><p>Beta platelet-derived growth factor receptor (<italic>PDGFRB</italic>) and cGMP-dependent protein kinase 1, beta (<italic>PRKG1B</italic>), in <xref ref-type="fig" rid="pcbi-1000063-g002">Figure 2A</xref>, are enzymes involved in protein amino acid phosphorylation and provide a concrete example of this situation. Phylogenomic and structural evidence <xref ref-type="bibr" rid="pcbi.1000063-Robinson1">[19]</xref>–<xref ref-type="bibr" rid="pcbi.1000063-Scheeff1">[22]</xref>, as well as the promiscuity of the Ig and cNMP-binding domains, supports the common ancestry of this pair (see <xref ref-type="sec" rid="s4">Methods</xref>). They have a statistically significant alignment with an E-value of 2.4<italic>e</italic><sup>−8</sup> that covers 13% of the average of their lengths. While they share a common domain (Pkinase), the Ig domains are unique to <italic>PDGFRB</italic> and the cNMP-binding domains are unique to <italic>PRKG1B</italic>. An example of a domain-only match is shown in <xref ref-type="fig" rid="pcbi-1000063-g002">Figure 2B</xref>. Neural cell adhesion molecule 2 (<italic>NCAM2</italic>) and <italic>PDGFRB</italic> share two Ig domains, resulting in a significant alignment, also with an E-value of 2.4<italic>e</italic><sup>−8</sup>, and alignment coverage of 24%. However, the genes that encode them are not homologous and they perform different functions: <italic>NCAM2</italic> is involved in cell-cell adhesion with no enzymatic function.</p><fig id="pcbi-1000063-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000063.g002</object-id><label>Figure 2</label><caption><title>Domain models of a pair of multidomain homologs and a pair of sequences with a domain-only match.</title><p>(A) Domain architectures of the multidomain homologs <italic>PDGFRB</italic> and <italic>PRKG1B</italic>. These sequences share a Pkinase domain, but have different auxiliary domains. (B) Domain architectures of <italic>PDGFRB</italic> and <italic>NCAM2</italic>, which have significant sequence similarity due to shared Ig domains, but do not share common ancestry.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000063.g002" xlink:type="simple"/></fig><p>The ability to distinguish multidomain homologs from unrelated pairs that share a domain is essential to genomic analysis. The evolutionary relationship between <italic>a</italic> and <italic>b</italic> in <xref ref-type="fig" rid="pcbi-1000063-g001">Figure 1</xref> supports inferences about genome evolution, organization, and function. The same inferences would not necessarily be justified by the evolutionary relationship between <italic>b</italic> and <italic>c</italic>. For example, chromosomal regions enriched with homologous gene pairs are likely to be homologous themselves. In contrast, enrichment with homologous domains does not support the inference that a pair of chromosomal regions is homologous. Heuristics based on similarity and <italic>alignment coverage</italic> (the fraction of the mean sequence length covered by the optimal local alignment) have been proposed to screen out domain insertions. Recently, approaches based on domain architecture comparison have also been proposed <xref ref-type="bibr" rid="pcbi.1000063-Song1">[23]</xref>–<xref ref-type="bibr" rid="pcbi.1000063-Lin1">[26]</xref>. To our knowledge, despite the prevalence of methods based on sequence similarity and alignment coverage <xref ref-type="bibr" rid="pcbi.1000063-Huynen1">[27]</xref>–<xref ref-type="bibr" rid="pcbi.1000063-Remm1">[37]</xref>, the accuracy of these heuristics has never been systematically tested. However, the examples in <xref ref-type="fig" rid="pcbi-1000063-g002">Figure 2</xref> raise doubt about the general effectiveness of these methods. Both pairs have weak sequence similarity, short alignments, and a similar combination of shared and unique domains. Setting a significance threshold to eliminate <italic>NCAM2</italic> would also eliminate roughly 240 sequences that are related to <italic>PDGFRB</italic>, since more than a quarter of the Kinases that match <italic>PDGFRB</italic> have E-values less significant than 2.4<italic>e</italic><sup>−8</sup>. Alignment coverage would not help distinguish these two cases: the homologous pair has a <italic>shorter</italic> alignment than the unrelated pair. Nor could we separate this case by comparing domain content, since <italic>PDGFRB</italic> and <italic>PRKG1B</italic> share one domain, while <italic>PDGFRB</italic> and <italic>NCAM2</italic> share two. For this example, sequence similarity, the length of the shared region, and domain architecture comparison all fail to distinguish the homologous pair from the domain-only match.</p><p>To determine the extent of this problem, here we evaluate sequence similarity, alignment coverage, and domain architecture comparison on a hand-curated benchmark of 853,465 known homologous pairs. Our results show that these heuristics are all insufficient for consistent, reliable identification of multidomain homologs. Surprisingly, given its widespread use, even a modest alignment coverage requirement dramatically increased the number of mis-assigned homologs in our study. These results challenge two unstated, but widely accepted hypotheses: (1) homologous sequences share similarity along the bulk of their length and (2) the local alignment between homologous sequences usually covers a greater fraction of their mean length than the local alignments of sequences that only share a domain.</p><p>These observations suggest to us that sequences alone may not consistently contain enough information to differentiate homology from domain-only matches. We introduce a novel method, called <italic>Neighborhood Correlation</italic>, that leverages additional information contained in the weighted sequence similarity network to distinguish homologs from domain-only matches. In this network, each vertex corresponds to a sequence. Vertices whose corresponding sequences have significant similarity are connected by an edge with weight proportional to that similarity. The <italic>neighborhood</italic> of a sequence is the set of vertices adjacent to it; that is, the set of all sequences that match it above a predefined significance threshold. (In this work, “sequence neighborhood” refers to the local context of the sequence in the network and not to the region immediately surrounding it in the genome.) Our analysis demonstrates that the neighborhood structure of gene pairs related through shared domain insertions is characteristically different from that of pairs related through duplication or speciation. These differences in neighborhood organization are detectable and can be exploited to distinguish homology from domain sharing.</p><p>A homology detection method for genomic analysis must meet the following criteria: It should correctly predict homologous pairs and reject unrelated pairs, including those that share domains. With a single set of parameter values, it should perform reliably on sequences with a broad range of attributes, including single domain families, multidomain families, families with short regions of conservation, and families with weak sequence homology. Finally, it should be easy to use and fast enough for datasets comprising hundreds of millions of sequence pairs.</p><p>In an empirical evaluation, we demonstrate that Neighborhood Correlation meets these criteria. It is highly effective in classifying multidomain homologs and achieves superior performance in comparisons with sequence similarity (BLAST and PSI-BLAST), alignment coverage, and domain architecture comparison. To evaluate performance, we hand-curated a benchmark of 853,465 known homologous pairs of mouse and human sequences, drawn from twenty well-studied families. Our test set includes single-domain families, as well as multidomain families with promiscuous domains that are at risk for domain-only matches. Although comprehensive datasets are available for testing methods for predicting homology of <italic>individual</italic> domains <xref ref-type="bibr" rid="pcbi.1000063-Murzin1">[38]</xref>,<xref ref-type="bibr" rid="pcbi.1000063-Pearl1">[39]</xref>, we are unaware of any other gold-standard dataset of known multidomain families with variable domain architectures. We offer this validation dataset, which is based on published evidence by experts on each of the families, as a resource for future studies.</p><p>As a validation of our approach, we applied Neighborhood Correlation to all complete, mouse and human sequences in SwissProt 50.9 to predict homologs. A comparison of our predictions with the euKaryotic Clusters of Orthologous Groups (KOGs) database <xref ref-type="bibr" rid="pcbi.1000063-Tatusov1">[40]</xref> showed that the set of protein sequences with highly correlated neighborhoods includes the vast majority of pairs that share an orthologous group (i.e., have the same KOG annotation). This is consistent with the fact that orthology is a more restrictive criterion than homology. We also show that most pairs in our set of predictions share at least one domain, according to the Pfam database <xref ref-type="bibr" rid="pcbi.1000063-Finn1">[41]</xref>, but many sequence pairs that share a domain are excluded. This is consistent with our goal of identifying <italic>gene</italic> homology rather than <italic>domain</italic> homology.</p></sec><sec id="s2"><title>Results</title><p>Homology has traditionally been defined in terms of families that evolve by vertical descent <xref ref-type="bibr" rid="pcbi.1000063-Fitch1">[18]</xref>,<xref ref-type="bibr" rid="pcbi.1000063-Fitch2">[42]</xref>; that is, by speciation and gene duplication. However, multidomain sequences evolve by speciation, gene duplication, <italic>and</italic> acquistion of domains from outside the family <xref ref-type="bibr" rid="pcbi.1000063-Gilbert1">[43]</xref> (<xref ref-type="fig" rid="pcbi-1000063-g001">Figure 1</xref>). The traditional definition of homology does not apply in this case, as previous authors have pointed out <xref ref-type="bibr" rid="pcbi.1000063-Fitch2">[42]</xref>,<xref ref-type="bibr" rid="pcbi.1000063-Hillis1">[44]</xref>. In the words of Walter Fitch <xref ref-type="bibr" rid="pcbi.1000063-Fitch2">[42]</xref>, “We must recognize that not all parts of a gene have the same history and thus, in such cases, that the gene is not the unit to which the terms orthology, paralogy, <italic>et cetera</italic>, apply.” It has been proposed that sub-genic sequence fragments should be the units of interest <xref ref-type="bibr" rid="pcbi.1000063-Hillis1">[44]</xref>,<xref ref-type="bibr" rid="pcbi.1000063-Liu1">[45]</xref>. However, there are many applications, such as ortholog detection, comparative mapping, and phylogenetic footprinting, for which it is essential to work with a definition of homology where the gene is the basic unit. Moreover, in order to study the evolution of multidomain gene families, it is necessary to focus on genes. The gene is the unit of selection. While domains confer modular function on genes, ultimately it is the functionality of those genes drives their retention.</p><sec id="s2a"><title>A Model of Multidomain Homology</title><p>Here, we propose a model of multidomain homology based on vertical descent and insertion of a sequence fragment into an existing gene. In our model, two sequences are homologous if they are encoded by genes that share an ancestral <italic>locus</italic>. The rationale for this definition is illustrated in <xref ref-type="fig" rid="pcbi-1000063-g003">Figure 3</xref>, which shows the evolution of genes through vertical descent and domain insertion in the context of the chromosomes in which they reside. When genomic context is taken into account, it is clear that genes <italic>g</italic><sub>2</sub> and <italic>g</italic><sub>2</sub>′ are homologous, despite the fact that <italic>g</italic><sub>2</sub> contains a domain not present in <italic>g</italic><sub>2</sub>′ and vice-versa. In contrast, genes <italic>g</italic><sub>2</sub> and <italic>g</italic><sub>3</sub>′ are <italic>not</italic> homologous, despite the fact that they share a homologous domain, since <italic>g<sub>2</sub></italic> and <italic>g</italic><sub>3</sub>′ are not located in chromosomal regions that share common ancestry. For comparative mapping applications, where homologous genes are used as markers for identifying chromosomal regions, this distinction is crucial. For example, phylogenetic footprinting <xref ref-type="bibr" rid="pcbi.1000063-Dickmeis1">[12]</xref> predicts transcription factor binding sites by identifying homologous genes and then searching their flanking chromosomal regions for conserved sequence motifs. In <xref ref-type="fig" rid="pcbi-1000063-g003">Figure 3</xref>, the regions upstream of <italic>g</italic><sub>2</sub> and <italic>g</italic><sub>2</sub>′ have an elevated probability of sharing conserved motifs since they share common ancestry. However, there is no reason to expect an enrichment of motifs shared between the flanking regions of <italic>g<sub>2</sub></italic> and <italic>g</italic><sub>3</sub>′.</p><fig id="pcbi-1000063-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000063.g003</object-id><label>Figure 3</label><caption><title>Evolutionary history of multidomain sequences in genomic context.</title><p>(A) A hypothetical genome with two chromosomes. (B) Both chromosomes are copied through duplication or speciation, resulting in two identical copies. (C) Following sequence divergence, similarity is only retained in coding regions. (D) Two instances of the orange domain are inserted in <italic>g</italic><sub>2</sub> and <italic>g</italic><sub>3</sub>’, respectively. A yellow domain is inserted in <italic>g</italic><sub>2</sub>’. (E) Conserved genomic context shows that genes <italic>g</italic><sub>2</sub> are <italic>g</italic><sub>2</sub>’ are homologous genes, although they contain unrelated domains. Similarly, genes <italic>g</italic><sub>2</sub> and <italic>g</italic><sub>3</sub>’ contain homologous domains, but are not homologous genes.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000063.g003" xlink:type="simple"/></fig><p>Our model is applicable to families that evolved through acquisition of a new domain by an existing gene. This can occur through insertion of sequence fragments into the gene or by recruitment of adjacent exons. Formation of a new gene architecture by domain loss is also consistent with our model. Several lines of evidence suggest that acquisition of an auxiliary domain by an existing gene is a relatively common mode of domain shuffling. First, a substantial number of metazoan, chordate, and vertebrate families have been identified that evolved through a pattern of duplication, insertion of domains, and further duplication, a pattern consistent with this model <xref ref-type="bibr" rid="pcbi.1000063-Miyata1">[46]</xref>,<xref ref-type="bibr" rid="pcbi.1000063-BenShlomo1">[47]</xref>. Second, the existence of promiscuous domains that lend themselves to insertion in new chromosomal environments <xref ref-type="bibr" rid="pcbi.1000063-Marcotte2">[48]</xref>,<xref ref-type="bibr" rid="pcbi.1000063-Patthy1">[49]</xref> supports an insertion model. Third, domain insertion is more likely to be successful when a domain is inserted into an existing functional environment, e.g., into the intron of an existing gene. In this case, all regulatory and termination signals required for successful transcription are already present. A fourth line of evidence stems from analyses of the flanking DNA of genes that arose very recently, where traces of the particular domain shuffling mechanism that occurred can still be observed. A number of recently evolved metazoan genes have been discovered that arose through duplication of an existing gene, followed by acquisition of one or more domains by unequal crossing over or by retrotransposition <xref ref-type="bibr" rid="pcbi.1000063-Sayah1">[50]</xref>–<xref ref-type="bibr" rid="pcbi.1000063-Fumasoni1">[54]</xref>. Finally, a number of studies have inferred relative rates of various domain shuffling events by applying parsimony models to abstract domain architectures. Their results suggest that the most common domain shuffling scenario involves insertion or deletion of a single domain into an existing multidomain architecture <xref ref-type="bibr" rid="pcbi.1000063-Bjorklund1">[24]</xref>,<xref ref-type="bibr" rid="pcbi.1000063-Fong1">[55]</xref>,<xref ref-type="bibr" rid="pcbi.1000063-Weiner1">[56]</xref>.</p><p>Our model is not applicable to the case where a new domain architecture is assembled <italic>de novo</italic> from several unrelated building blocks and subsequently acquires a regulatory region. We consider such a novel architecture to be the progenitor of a new family, since it is not clear that the ancestry of any one constituent is preferred. Similarly, our model does not capture formation of new architectures through fragmentation of more complex ones. However, recent evidence suggests that both of these scenarios occur rarely <xref ref-type="bibr" rid="pcbi.1000063-Bjorklund1">[24]</xref>,<xref ref-type="bibr" rid="pcbi.1000063-Fong1">[55]</xref>,<xref ref-type="bibr" rid="pcbi.1000063-Kummerfeld1">[57]</xref>.</p></sec><sec id="s2b"><title>Neighborhood Correlation</title><p>Homology detection is the problem of distinguishing between sequence pairs with different types of evolutionary histories: evolution via gene duplication or via domain insertion. Sequence similarity, alignment coverage, and domain architecture comparison have all been considered for this purpose. However, none of these distinguish the homologous pair from the domain-only match given in <xref ref-type="fig" rid="pcbi-1000063-g002">Figure 2</xref>. The empirical results in the following sections confirm that this is not an isolated example. Accurate classification of multidomain homologs requires additional information from another source.</p><p>The structure of the sequence similarity network provides a basis for distinguishing pairs related through vertical descent from other pairs. The local network neighborhoods of homologs and domain-only matches differ in both topology and edge weights. In particular, for homologous pairs, the shared neighborhood (i.e., the set of vertices adjacent to both members of the pair) tends to have more vertices and stronger edge weights than their unique neighborhoods (i.e., vertices adjacent to one pair but not the other). This is not true for domain-only matches. We express this distinction quantitatively by the Neighborhood Correlation score of two sequences, defined to be the correlation coefficient of their respective neighborhoods:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000063.e001" xlink:type="simple"/><label>(1)</label></disp-formula>where <italic>S(x,i)</italic> is the normalized bit score <xref ref-type="bibr" rid="pcbi.1000063-Altschul1">[58]</xref> of the optimal local alignment of query sequence <italic>x</italic> and database sequence <italic>i</italic>, <italic>N</italic> is the number of sequences in the database, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000063.e002" xlink:type="simple"/></inline-formula> is the mean of <italic>S(x,i)</italic> over all sequences (see <xref ref-type="sec" rid="s4">Methods</xref>). Note that <italic>NC</italic>(<italic>x</italic>,<italic>y</italic>) increases with the number, weight, and correlation of edges in the shared neighborhoods of <italic>x</italic> and <italic>y</italic> and decreases with the number and weight of edges in their unique neighborhoods.</p><p>The Neighborhood Correlation score captures properties of the sequence similarity network that are strongly influenced by the evolutionary processes of interest. The number of edges in the shared and unique neighborhoods is influenced by the rates of gene duplication and domain insertion, while edge weights depend on sequence divergence. Immediately following a gene duplication, the two resulting paralogs have identical neighborhoods. The Neighborhood Correlation score of this new pair is initially one and decreases as the sequences diverge. Additional gene duplications in the same family further increase the size of the shared neighborhood and, hence, the Neighborhood Correlation score. In contrast, if a domain is inserted into a single member of the pair, the number of edges in its unique neighborhood increases and the Neighborhood Correlation score decreases. The increase in the number of unique edges is directly related to the promiscuity of the inserted domain, while the weights of these new edges are proportional to the degree of sequence conservation in the domain superfamily. In practice, the impact of insertion of a domain into a single member on the Neighborhood Correlation score is typically small because promiscuity and sequence conservation within domain superfamilies are inversely related. For example, Pfam domains exhibit a highly significant, negative correlation between domain promiscuity (see <xref ref-type="sec" rid="s4">Methods</xref>) and sequence identity (ρ = −0.21, <italic>p</italic> = 2.08<italic>e</italic><sup>−30</sup>, Spearman test). This can be understood by observing that when a domain is inserted into a new context, it is likely to experience new selective pressures leading to rapid mutational change.</p><p>To see how these principles play out in practice, we consider the neighborhoods of <italic>PDGFRB</italic>, <italic>PRKG1B</italic>, and <italic>NCAM2</italic> in the sequence similarity network derived from our test dataset (<xref ref-type="fig" rid="pcbi-1000063-g002">Figures 2</xref> and <xref ref-type="fig" rid="pcbi-1000063-g004">4</xref>). Although the homologous pair, <italic>PDGFRB</italic> and <italic>PRKG1B</italic>, and the domain sharers, <italic>PDGFRB</italic> and <italic>NCAM2</italic>, have pairwise alignments with similar properties (E-value, alignment length, number of shared domains), their neighborhoods in the weighted sequence similarity network are very different. The shared neighborhood of the Kinase homologs <italic>PDGFRB</italic> and <italic>PRKG1B</italic> is substantially larger (779 sequences) than their unique neighborhoods (183 and 142 sequences, respectively). The shared neighborhood consists almost entirely of Kinases. The unique neighborhoods are dominated by domain-only matches, due to Ig in the case of <italic>PDGFRB</italic> and the cNMP-binding domain in the case of <italic>PRKG1B</italic>. Sequence similarities within these unique neighborhoods are weak; the Pfam models for the Ig and cNMP-binding domains have average sequence identities of 20% and 18%, respectively. Thus, the edge weights (not shown) in the shared neighborhood are strong and well correlated, while the edge weights in the unique neighborhoods are weak, yielding a Neighborhood Correlation score of <italic>NC</italic> = 0.65.</p><fig id="pcbi-1000063-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000063.g004</object-id><label>Figure 4</label><caption><title>Differences in neighborhood structure of the sequence similarity network reflect differences in evolutionary history.</title><p>Network neighborhoods in which nodes represent sequences. Edges connect pairs with significant sequence similarity. Edge weights reflecting degree of sequence similarity are not shown. (A) The neighborhoods of the homologous pair, <italic>PDGFRB</italic> and <italic>PRKG1B</italic>. <italic>PDGFRB</italic> and <italic>PRKG1B</italic> share 779 neighbors, mostly Kinases (turquoise nodes). These are strong matches due to a shared kinase domain. <italic>PDGFRB</italic> has 183 unique neighbors, mostly due to weak matches with Ig domains (green nodes). <italic>PRKG1B</italic> has 142 unique neighbors due to weak matches with the cNMP-binding domain (red nodes). Other matching sequences are shown in yellow. (B) <italic>PDGFRB</italic> and <italic>NCAM2</italic>, a domain-only match, have 232 matches in common. <italic>PDGFRB</italic> has 730 unique neighbors and <italic>NCAM2</italic> has 240, mostly due to Fn3 domains (dark blue nodes).</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000063.g004" xlink:type="simple"/></fig><p>Conversely, <italic>PDGFRB</italic> and <italic>NCAM2</italic> are related through domain insertion and have significant sequence similarity due to a shared Ig domain. Their shared neighborhood is relatively small (242 sequences) and comprised primarily of Ig-based matches. These contribute little to the Neighborhood Correlation score of this pair due to low sequence conservation within the Ig superfamily. In contrast, the unique neighborhood of <italic>PDGFRB</italic> is large (630 sequences), with strong edge weights. For these reasons, <italic>PDGFRB</italic> and <italic>NCAM2</italic> have a Neighborhood Correlation score of 0.29, distinctly smaller than the score for <italic>PDGFRB</italic> and <italic>PRKG1B</italic>. Unlike sequence comparison, this clear difference in neighborhood structure can be used to recognize multidomain homology.</p></sec><sec id="s2c"><title>A Benchmark Dataset for Multidomain Homology</title><p>Evaluation of classification performance requires a trusted set of positive examples (known homologous pairs) and negative examples (pairs known not to share common ancestry). Although benchmarks are available for detection of remote homology (e.g., SCOP <xref ref-type="bibr" rid="pcbi.1000063-Murzin1">[38]</xref>, CATH <xref ref-type="bibr" rid="pcbi.1000063-Pearl1">[39]</xref>), functional similarity (e.g., the Gene Ontology (GO) <xref ref-type="bibr" rid="pcbi.1000063-Ashburner1">[59]</xref>), orthology (e.g, COGs <xref ref-type="bibr" rid="pcbi.1000063-Tatusov1">[40]</xref>), and structural genomics (<xref ref-type="bibr" rid="pcbi.1000063-Redfern1">[16]</xref>,<xref ref-type="bibr" rid="pcbi.1000063-Liu1">45</xref>,<xref ref-type="bibr" rid="pcbi.1000063-Ouzounis1">[60]</xref>, and work cited therein), we are unaware of any gold-standard validation dataset for multidomain homology. Our benchmark is designed to be suitable for testing two classification goals: good overall performance on a large set of sequence pairs and consistent performance on individual families with varying properties. To satisfy these needs, we constructed a test set of 1577 sequences from 20 families of known evolutionary origin (<xref ref-type="table" rid="pcbi-1000063-t001">Table 1</xref>). The families encompass a broad range of functional categories, summarized in <xref ref-type="table" rid="pcbi-1000063-t002">Table 2</xref>. The full curation procedure is described in <xref ref-type="sec" rid="s4">Methods</xref> and <xref ref-type="supplementary-material" rid="pcbi.1000063.s008">Text S1</xref>.</p><table-wrap id="pcbi-1000063-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000063.t001</object-id><label>Table 1</label><caption><title>Test family statistics.</title></caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1000063-t001-1" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000063.t001" xlink:type="simple"/><table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/></colgroup><thead><tr><td align="left" colspan="1" rowspan="1">Family</td><td align="left" colspan="1" rowspan="1"><italic>k</italic></td></tr></thead><tbody><tr><td align="left" colspan="1" rowspan="1"><italic>ALL</italic></td><td align="left" colspan="1" rowspan="1">1577</td></tr><tr><td align="left" colspan="1" rowspan="1"><italic>ALL-Kin</italic></td><td align="left" colspan="1" rowspan="1">671</td></tr><tr><td align="left" colspan="2" rowspan="1">Single domain families</td></tr><tr><td align="left" colspan="1" rowspan="1">ACSL</td><td align="left" colspan="1" rowspan="1">10</td></tr><tr><td align="left" colspan="1" rowspan="1">FGF</td><td align="left" colspan="1" rowspan="1">44</td></tr><tr><td align="left" colspan="1" rowspan="1">FOX</td><td align="left" colspan="1" rowspan="1">81</td></tr><tr><td align="left" colspan="1" rowspan="1">Tbox</td><td align="left" colspan="1" rowspan="1">31</td></tr><tr><td align="left" colspan="1" rowspan="1">TNF</td><td align="left" colspan="1" rowspan="1">32</td></tr><tr><td align="left" colspan="1" rowspan="1">USP</td><td align="left" colspan="1" rowspan="1">77</td></tr><tr><td align="left" colspan="1" rowspan="1">WNT</td><td align="left" colspan="1" rowspan="1">38</td></tr><tr><td align="left" colspan="2" rowspan="1">Multidomain families: conserved architecture</td></tr><tr><td align="left" colspan="1" rowspan="1">DVL</td><td align="left" colspan="1" rowspan="1">7</td></tr><tr><td align="left" colspan="1" rowspan="1">GATA</td><td align="left" colspan="1" rowspan="1">12</td></tr><tr><td align="left" colspan="1" rowspan="1">Notch</td><td align="left" colspan="1" rowspan="1">8</td></tr><tr><td align="left" colspan="1" rowspan="1">KIR</td><td align="left" colspan="1" rowspan="1">14</td></tr><tr><td align="left" colspan="1" rowspan="1">TRAF</td><td align="left" colspan="1" rowspan="1">12</td></tr><tr><td align="left" colspan="2" rowspan="1">Multidomain families: variable architecture</td></tr><tr><td align="left" colspan="1" rowspan="1">ADAM</td><td align="left" colspan="1" rowspan="1">44</td></tr><tr><td align="left" colspan="1" rowspan="1">Kinase</td><td align="left" colspan="1" rowspan="1">906</td></tr><tr><td align="left" colspan="1" rowspan="1">Kinesin</td><td align="left" colspan="1" rowspan="1">56</td></tr><tr><td align="left" colspan="1" rowspan="1">Laminin</td><td align="left" colspan="1" rowspan="1">22</td></tr><tr><td align="left" colspan="1" rowspan="1">Myosin</td><td align="left" colspan="1" rowspan="1">46</td></tr><tr><td align="left" colspan="1" rowspan="1">PDE</td><td align="left" colspan="1" rowspan="1">44</td></tr><tr><td align="left" colspan="1" rowspan="1">SEMA</td><td align="left" colspan="1" rowspan="1">38</td></tr><tr><td align="left" colspan="1" rowspan="1">TNFR</td><td align="left" colspan="1" rowspan="1">55</td></tr></tbody></table></alternatives><table-wrap-foot><fn id="nt101"><p><italic>k</italic>: the number of sequences.</p></fn></table-wrap-foot></table-wrap><table-wrap id="pcbi-1000063-t002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000063.t002</object-id><label>Table 2</label><caption><title>Functional properties of the 20 test families.</title></caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1000063-t002-2" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000063.t002" xlink:type="simple"/><table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup><thead><tr><td align="left" colspan="2" rowspan="1">Functional category</td><td align="left" colspan="1" rowspan="1">Family</td></tr></thead><tbody><tr><td align="left" colspan="1" rowspan="1">Biological process</td><td align="left" colspan="1" rowspan="1">Neural development</td><td align="left" colspan="1" rowspan="1">SEMA, Notch</td></tr><tr><td align="left" colspan="1" rowspan="1"/><td align="left" colspan="1" rowspan="1">Immune response</td><td align="left" colspan="1" rowspan="1">TNF, TNFR, KIR</td></tr><tr><td align="left" colspan="1" rowspan="1"/><td align="left" colspan="1" rowspan="1">Development and homeostatic regulation</td><td align="left" colspan="1" rowspan="1">ADAM, FGF, WNT</td></tr><tr><td align="left" colspan="1" rowspan="1"/><td align="left" colspan="1" rowspan="1">Cell-cell/cell-matrix interaction</td><td align="left" colspan="1" rowspan="1">ADAM, Laminin, Notch</td></tr><tr><td align="left" colspan="1" rowspan="1">Molecular function</td><td align="left" colspan="1" rowspan="1">Transcription factor</td><td align="left" colspan="1" rowspan="1">FOX, GATA, Tbx</td></tr><tr><td align="left" colspan="1" rowspan="1"/><td align="left" colspan="1" rowspan="1">Intracellular signal transducer</td><td align="left" colspan="1" rowspan="1">Kinase, DVL, TRAF</td></tr><tr><td align="left" colspan="1" rowspan="1"/><td align="left" colspan="1" rowspan="1">Enzyme</td><td align="left" colspan="1" rowspan="1">ACSL, ADAM, Kinase, USP, PDE</td></tr><tr><td align="left" colspan="1" rowspan="1"/><td align="left" colspan="1" rowspan="1">Motor</td><td align="left" colspan="1" rowspan="1">Myosin, Kinesin</td></tr><tr><td align="left" colspan="1" rowspan="1"/><td align="left" colspan="1" rowspan="1">Structural molecule</td><td align="left" colspan="1" rowspan="1">Laminin</td></tr><tr><td align="left" colspan="1" rowspan="1"/><td align="left" colspan="1" rowspan="1">Ligand</td><td align="left" colspan="1" rowspan="1">FGF, SEMA, TNF, WNT</td></tr><tr><td align="left" colspan="1" rowspan="1"/><td align="left" colspan="1" rowspan="1">Receptor</td><td align="left" colspan="1" rowspan="1">TNFR, KIR, Notch</td></tr><tr><td align="left" colspan="1" rowspan="1">Cellular location</td><td align="left" colspan="1" rowspan="1">Extracellular</td><td align="left" colspan="1" rowspan="1">ADAM, FGF, Laminin, SEMA, WNT</td></tr><tr><td align="left" colspan="1" rowspan="1"/><td align="left" colspan="1" rowspan="1">Transmembrane</td><td align="left" colspan="1" rowspan="1">ADAM, SEMA, KIR, Kinase, Notch, TNF, TNFR</td></tr><tr><td align="left" colspan="1" rowspan="1"/><td align="left" colspan="1" rowspan="1">Intracellular</td><td align="left" colspan="1" rowspan="1">ACSL, DVL, FOX, GATA, Myosin, Kinesin, PDE, Tbx, Kinase, TRAF,USP</td></tr></tbody></table></alternatives></table-wrap><p>For each family, we identified two sets of sequence pairs: family (FF) pairs, where both members of the pair are in the family, and non-family (FO) pairs, where only one of the two sequences is in the family. Given a family of size <italic>k</italic>, we obtain <italic>k</italic><sup>2</sup> FF pairs (the positive examples) and <italic>k</italic>(<italic>N</italic>−<italic>k</italic>) FO pairs (the negative examples). Individual families, which cover a range of functional properties and domain architecture complexity, can be used for family specific tests. In addition, we constructed a test set (<italic>ALL</italic>) for general performance evaluation by merging all sets of FF and, respectively, FO pairs, yielding 853,465 positive and 40,459,204 negative examples. Performance measurements obtained with this set could be biased by the Kinase family, which is much larger than the other families. We therefore also considered the set of all sequences excluding the Kinases (<italic>ALL-Kin</italic>), resulting in 32,629 positive and 17,545,558 negative examples.</p><p>Our goal is a method that can correctly identify homologs in multidomain families without degrading performance in other types of families. We therefore devised a benchmark to test a range of homology detection challenges, involving single domain as well as multidomain families. Families with complex and varied domain architectures represent the primary challenge undertaken in this study. Such families result from duplication, domain accretion, and further duplication. Some of these families are defined by a single domain that is unique to the family (e.g., Kinase), while others are characterized by a particular combination of domains (e.g., ADAM) or by a conserved set of domains with variations in domain copy number (e.g. Laminin). Modularity in both single and multidomain families can also arise through the presence of sequence motifs, such as subcellular localization signals, transactivation sequences (e.g., Tbox), and functional components that confer substrate specificity (e.g. USP). These motifs can result in matches to unrelated sequences. In addition, promiscuous domains challenge homology identification because they can result in significant sequence similarity but carry little information about gene homology. Promiscuity can confound reliable detection of homologs even in families with conserved domain architectures.</p><p>Remote homology detection is a serious challenge that has received widespread attention. In our dataset, this challenge is represented set by FGF, TNF, TNFR, and USP, families that exhibit low sequence conservation. Finally, we considered homologous pairs with short conserved regions. A minimum alignment coverage criterion is frequently imposed to eliminate domain-only matches, reflecting a widely held, but untested belief that homologous pairs have regions of similarity that cover a substantial fraction of their length. To test the robustness of homology detection methods with respect to alignment length, we included single domain families with short conserved regions such as the Tbox family.</p><p>Our selection of test families was limited to those for which it was possible to obtain evidence concerning their evolutionary history. Evolutionary evidence was obtained from published articles and/or curation by a nomenclature committee. In the best cases, direct syntenic evidence of vertical descent can be found. In other cases, indirect evidence such as conserved intron/exon structure is used. Phylogenetic evidence can confirm vertical descent, for example, if all domains in a family have consistent phylogenies. However, phylogenetic disagreement between core and auxiliary domains does not rule out homology according to our model. For each, the evidence used is described in <xref ref-type="supplementary-material" rid="pcbi.1000063.s008">Text S1</xref>.</p></sec><sec id="s2d"><title>Accuracy of Homolog Identification</title><p>We evaluated Neighborhood Correlation using our benchmark, and compared its performance with other methods currently in use. We considered performance on multidomain homology identification, as well as overall performance on diverse, heterogeneous datasets. We also used Neighborhood Correlation to predict novel homologous relationships.</p></sec><sec id="s2e"><title>Methods Compared</title><p>We compared the performance of Neighborhood Correlation with BLAST <xref ref-type="bibr" rid="pcbi.1000063-Altschul2">[61]</xref>, alignment coverage <xref ref-type="bibr" rid="pcbi.1000063-Huynen1">[27]</xref>, and PSI-BLAST <xref ref-type="bibr" rid="pcbi.1000063-Altschul1">[58]</xref>, methods commonly used for assessing homology, as well as Domain Architecture Comparison (DAC), a recently introduced approach that compares sequences by considering their constituent domains <xref ref-type="bibr" rid="pcbi.1000063-Song1">[23]</xref>–<xref ref-type="bibr" rid="pcbi.1000063-Lin1">[26]</xref>,<xref ref-type="bibr" rid="pcbi.1000063-Fong1">[55]</xref>.</p><p>BLAST gives a measure of sequence similarity based on the optimal local alignment between two sequences. BLAST does not capture gene structure (e.g., domain organization), nor does it reflect additional information that might be derived from suboptimal local alignments. BLAST is widely used, its behavior is well understood, and its scores are easily compared with those from other studies. A great deal of attention has been devoted to tuning BLAST performance and to developing accurate statistical tests. It represents an attractive balance between rigor and speed.</p><p>A significant BLAST score is evidence of similarity greater than that expected by chance, but cannot distinguish whether that similarity stems from vertical descent or domain insertion. In order to eliminate domain-only matches, many analyses combine sequence similarity with alignment coverage to identify homologs <xref ref-type="bibr" rid="pcbi.1000063-Blin1">[28]</xref>–<xref ref-type="bibr" rid="pcbi.1000063-Remm1">[37]</xref>. To be considered homologous, sequence pairs must then satisfy a second criterion in addition to significant sequence similarity: the fraction of the sequence length covered by the optimal local alignment must meet a pre-specified threshold. To our knowledge, alignment coverage criteria have never been empirically evaluated. In this work, we demonstrate that such a requirement is highly detrimental to performance overall, and in nearly all tested families.</p><p>In the presence of high sequence divergence, BLAST is limited by the amount of information that can be derived from pairwise comparison. To address this problem, approaches based on multiple sequence alignments (MSAs) have been used to increase sensitivity. PSI-BLAST, one of the most widely used examples of this approach, constructs a Position Specific Scoring Matrix (PSSM) through iterative search and has been shown to dramatically improve sensitivity <xref ref-type="bibr" rid="pcbi.1000063-Schaffer1">[62]</xref>. MSA-based methods are designed to detect remote homology, not multidomain homology. Since sequences with different architectures cannot be aligned, MSA-based methods are not a natural choice for multidomain homology detection. We included PSI-BLAST in our study because it is widely used as a standard for remote homology detection.</p><p>In addition to sequence based methods, we considered direct comparison of domain architectures for multidomain homology detection. Each sequence was represented by a linear sequence of Pfam domains. Linker sequences between domains were ignored, as was sequence variation between instances of a given Pfam domain family. The resulting domain architectures were compared based on their domain composition. In a previous study, we proposed and evaluated 21 different methods for comparing domain architectures <xref ref-type="bibr" rid="pcbi.1000063-Song1">[23]</xref>. These methods considered properties such as the number of shared domains, domain copy number, total number of domains in a protein, domain order, and domain promiscuity. We included the domain architecture comparison strategy that exhibited the best performance from that study in our current study. This method assigns a score to each pair based on the number of shared domains (see <xref ref-type="sec" rid="s4">Methods</xref>), following the rationale that homologous pairs will have more domains in common than pairs related through domain insertion. In assessing similarity, each domain is assigned a weight inversely proportional to its promiscuity. This reflects the assumption that rare domains convey more information about homology than promiscuous domains.</p></sec><sec id="s2f"><title>Evaluation Procedure</title><p>The performance of each method was assessed via the <italic>ROC-n</italic> score (<xref ref-type="table" rid="pcbi-1000063-t003">Table 3</xref>), which represents both false positives and false negatives (see <xref ref-type="sec" rid="s4">Methods</xref>). <italic>ROC-n</italic> is the area under the Receiver Operating Characteristic (<italic>ROC</italic>) curve comprised of the top ranking pairs up to the first <italic>n</italic> false positives. We used <italic>n</italic> = 100<italic>k</italic>, where <italic>k</italic> is family size, corresponding to 100 false positives per query.</p><table-wrap id="pcbi-1000063-t003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000063.t003</object-id><label>Table 3</label><caption><title><italic>ROC-100k</italic> scores for Neighborhood Correlation, BLAST, PSI-BLAST, and Domain Architecture Comparison for all families.</title></caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1000063-t003-3" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000063.t003" xlink:type="simple"/><table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup><thead><tr><td align="left" colspan="1" rowspan="1"/><td align="left" colspan="2" rowspan="1">NC</td><td align="left" colspan="1" rowspan="1">BLAST</td><td align="left" colspan="1" rowspan="1">p-value</td><td align="left" colspan="1" rowspan="1">PSI-BLAST</td><td align="left" colspan="1" rowspan="1">p-value</td><td align="left" colspan="1" rowspan="1">DAC</td><td align="left" colspan="1" rowspan="1">p-value</td></tr></thead><tbody><tr><td align="left" colspan="1" rowspan="1"><italic>ALL</italic></td><td align="left" colspan="2" rowspan="1"><bold>0.8148</bold></td><td align="left" colspan="1" rowspan="1">0.5838</td><td align="left" colspan="1" rowspan="1">0</td><td align="left" colspan="1" rowspan="1">0.7080</td><td align="left" colspan="1" rowspan="1">0</td><td align="left" colspan="1" rowspan="1">0.4431</td><td align="left" colspan="1" rowspan="1">0</td></tr><tr><td align="left" colspan="1" rowspan="1"><italic>ALL-Kin</italic></td><td align="left" colspan="2" rowspan="1">0.8353</td><td align="left" colspan="1" rowspan="1">0.7505</td><td align="left" colspan="1" rowspan="1">0</td><td align="left" colspan="1" rowspan="1">0.7375</td><td align="left" colspan="1" rowspan="1">0</td><td align="left" colspan="1" rowspan="1"><bold>0.8960</bold></td><td align="left" colspan="1" rowspan="1">0</td></tr><tr><td align="left" colspan="9" rowspan="1">Single domain families</td></tr><tr><td align="left" colspan="1" rowspan="1">ACSL</td><td align="left" colspan="1" rowspan="1"><bold>1.0000</bold></td><td align="left" colspan="2" rowspan="1"><bold>1.0000</bold></td><td align="left" colspan="1" rowspan="1">-</td><td align="left" colspan="1" rowspan="1"><bold>1.0000</bold></td><td align="left" colspan="1" rowspan="1">-</td><td align="left" colspan="1" rowspan="1">0.8184</td><td align="left" colspan="1" rowspan="1">0</td></tr><tr><td align="left" colspan="1" rowspan="1">FGF</td><td align="left" colspan="1" rowspan="1"><bold>1.0000</bold></td><td align="left" colspan="2" rowspan="1">0.9920</td><td align="left" colspan="1" rowspan="1">0</td><td align="left" colspan="1" rowspan="1"><bold>1.0000</bold></td><td align="left" colspan="1" rowspan="1">-</td><td align="left" colspan="1" rowspan="1"><bold>1.0000</bold></td><td align="left" colspan="1" rowspan="1">–</td></tr><tr><td align="left" colspan="1" rowspan="1">FOX</td><td align="left" colspan="1" rowspan="1"><bold>1.0000</bold></td><td align="left" colspan="2" rowspan="1">0.9996</td><td align="left" colspan="1" rowspan="1">0</td><td align="left" colspan="1" rowspan="1">0.9985</td><td align="left" colspan="1" rowspan="1">1.3e-04</td><td align="left" colspan="1" rowspan="1">0.9756</td><td align="left" colspan="1" rowspan="1">0</td></tr><tr><td align="left" colspan="1" rowspan="1">Tbox</td><td align="left" colspan="1" rowspan="1"><bold>1.0000</bold></td><td align="left" colspan="2" rowspan="1"><bold>1.0000</bold></td><td align="left" colspan="1" rowspan="1">-</td><td align="left" colspan="1" rowspan="1"><bold>1.0000</bold></td><td align="left" colspan="1" rowspan="1">-</td><td align="left" colspan="1" rowspan="1">0.9376</td><td align="left" colspan="1" rowspan="1">0</td></tr><tr><td align="left" colspan="1" rowspan="1">TNF</td><td align="left" colspan="1" rowspan="1">0.3992</td><td align="left" colspan="2" rowspan="1">0.3631</td><td align="left" colspan="1" rowspan="1">0</td><td align="left" colspan="1" rowspan="1">0.6764</td><td align="left" colspan="1" rowspan="1">0</td><td align="left" colspan="1" rowspan="1"><bold>1.0000</bold></td><td align="left" colspan="1" rowspan="1">0</td></tr><tr><td align="left" colspan="1" rowspan="1">USP</td><td align="left" colspan="1" rowspan="1">0.9236</td><td align="left" colspan="2" rowspan="1">0.8666</td><td align="left" colspan="1" rowspan="1">0</td><td align="left" colspan="1" rowspan="1"><bold>0.9856</bold></td><td align="left" colspan="1" rowspan="1">0</td><td align="left" colspan="1" rowspan="1">0.9395</td><td align="left" colspan="1" rowspan="1">0</td></tr><tr><td align="left" colspan="1" rowspan="1">WNT</td><td align="left" colspan="1" rowspan="1"><bold>1.0000</bold></td><td align="left" colspan="2" rowspan="1"><bold>1.0000</bold></td><td align="left" colspan="1" rowspan="1">-</td><td align="left" colspan="1" rowspan="1"><bold>1.0000</bold></td><td align="left" colspan="1" rowspan="1">-</td><td align="left" colspan="1" rowspan="1"><bold>1.0000</bold></td><td align="left" colspan="1" rowspan="1">–</td></tr><tr><td align="left" colspan="1" rowspan="1">Mean</td><td align="left" colspan="1" rowspan="1">0.9033</td><td align="left" colspan="2" rowspan="1">0.8888</td><td align="left" colspan="1" rowspan="1"/><td align="left" colspan="1" rowspan="1">0.9515</td><td align="left" colspan="1" rowspan="1"/><td align="left" colspan="1" rowspan="1"><bold>0.9530</bold></td><td align="left" colspan="1" rowspan="1"/></tr><tr><td align="left" colspan="9" rowspan="1">Multidomain families: conserved architecture</td></tr><tr><td align="left" colspan="1" rowspan="1">DVL</td><td align="left" colspan="2" rowspan="1"><bold>1.0000</bold></td><td align="left" colspan="1" rowspan="1"><bold>1.0000</bold></td><td align="left" colspan="1" rowspan="1">-</td><td align="left" colspan="1" rowspan="1"><bold>1.0000</bold></td><td align="left" colspan="1" rowspan="1">-</td><td align="left" colspan="1" rowspan="1"><bold>1.0000</bold></td><td align="left" colspan="1" rowspan="1">–</td></tr><tr><td align="left" colspan="1" rowspan="1">GATA</td><td align="left" colspan="2" rowspan="1"><bold>1.0000</bold></td><td align="left" colspan="1" rowspan="1"><bold>1.0000</bold></td><td align="left" colspan="1" rowspan="1">-</td><td align="left" colspan="1" rowspan="1"><bold>1.0000</bold></td><td align="left" colspan="1" rowspan="1">-</td><td align="left" colspan="1" rowspan="1">0.9675</td><td align="left" colspan="1" rowspan="1">–</td></tr><tr><td align="left" colspan="1" rowspan="1">Notch</td><td align="left" colspan="2" rowspan="1"><bold>1.0000</bold></td><td align="left" colspan="1" rowspan="1"><bold>1.0000</bold></td><td align="left" colspan="1" rowspan="1">-</td><td align="left" colspan="1" rowspan="1"><bold>1.0000</bold></td><td align="left" colspan="1" rowspan="1">-</td><td align="left" colspan="1" rowspan="1"><bold>1.0000</bold></td><td align="left" colspan="1" rowspan="1">–</td></tr><tr><td align="left" colspan="1" rowspan="1">KIR</td><td align="left" colspan="2" rowspan="1"><bold>1.0000</bold></td><td align="left" colspan="1" rowspan="1">0.9971</td><td align="left" colspan="1" rowspan="1">2.0e-15</td><td align="left" colspan="1" rowspan="1">0.9876</td><td align="left" colspan="1" rowspan="1">4.4e-16</td><td align="left" colspan="1" rowspan="1"><bold>1.0000</bold></td><td align="left" colspan="1" rowspan="1">–</td></tr><tr><td align="left" colspan="1" rowspan="1">TRAF</td><td align="left" colspan="2" rowspan="1"><bold>1.0000</bold></td><td align="left" colspan="1" rowspan="1"><bold>1.0000</bold></td><td align="left" colspan="1" rowspan="1">-</td><td align="left" colspan="1" rowspan="1"><bold>1.0000</bold></td><td align="left" colspan="1" rowspan="1">-</td><td align="left" colspan="1" rowspan="1">0.9843</td><td align="left" colspan="1" rowspan="1">2.2e-16</td></tr><tr><td align="left" colspan="1" rowspan="1">Mean</td><td align="left" colspan="2" rowspan="1"><bold>1.0000</bold></td><td align="left" colspan="1" rowspan="1">0.9994</td><td align="left" colspan="1" rowspan="1"/><td align="left" colspan="1" rowspan="1">0.9975</td><td align="left" colspan="1" rowspan="1"/><td align="left" colspan="1" rowspan="1">0.9904</td><td align="left" colspan="1" rowspan="1"/></tr><tr><td align="left" colspan="9" rowspan="1">Multidomain families: variable architecture</td></tr><tr><td align="left" colspan="1" rowspan="1">ADAM</td><td align="left" colspan="2" rowspan="1"><bold>1.0000</bold></td><td align="left" colspan="1" rowspan="1">0.9830</td><td align="left" colspan="1" rowspan="1">0</td><td align="left" colspan="1" rowspan="1">0.9061</td><td align="left" colspan="1" rowspan="1">0</td><td align="left" colspan="1" rowspan="1">0.9552</td><td align="left" colspan="1" rowspan="1">0</td></tr><tr><td align="left" colspan="1" rowspan="1">Kinase</td><td align="left" colspan="2" rowspan="1"><bold>0.8362</bold></td><td align="left" colspan="1" rowspan="1">0.6164</td><td align="left" colspan="1" rowspan="1">0</td><td align="left" colspan="1" rowspan="1">0.7238</td><td align="left" colspan="1" rowspan="1">0</td><td align="left" colspan="1" rowspan="1">0.3789</td><td align="left" colspan="1" rowspan="1">0</td></tr><tr><td align="left" colspan="1" rowspan="1">Kinesin</td><td align="left" colspan="2" rowspan="1">0.9757</td><td align="left" colspan="1" rowspan="1">0.9806</td><td align="left" colspan="1" rowspan="1">-</td><td align="left" colspan="1" rowspan="1"><bold>0.9866</bold></td><td align="left" colspan="1" rowspan="1">8.5e-12</td><td align="left" colspan="1" rowspan="1">0.9640</td><td align="left" colspan="1" rowspan="1">0</td></tr><tr><td align="left" colspan="1" rowspan="1">Laminin</td><td align="left" colspan="2" rowspan="1"><bold>0.9592</bold></td><td align="left" colspan="1" rowspan="1">0.9245</td><td align="left" colspan="1" rowspan="1">0</td><td align="left" colspan="1" rowspan="1">0.8028</td><td align="left" colspan="1" rowspan="1">0</td><td align="left" colspan="1" rowspan="1">0.9055</td><td align="left" colspan="1" rowspan="1">0</td></tr><tr><td align="left" colspan="1" rowspan="1">Myosin</td><td align="left" colspan="2" rowspan="1">0.8046</td><td align="left" colspan="1" rowspan="1"><bold>0.9870</bold></td><td align="left" colspan="1" rowspan="1">0</td><td align="left" colspan="1" rowspan="1">0.9796</td><td align="left" colspan="1" rowspan="1">0</td><td align="left" colspan="1" rowspan="1">0.8435</td><td align="left" colspan="1" rowspan="1">4.4e-16</td></tr><tr><td align="left" colspan="1" rowspan="1">PDE</td><td align="left" colspan="2" rowspan="1"><bold>0.7565</bold></td><td align="left" colspan="1" rowspan="1"><bold>0.7565</bold></td><td align="left" colspan="1" rowspan="1">-</td><td align="left" colspan="1" rowspan="1">0.7562</td><td align="left" colspan="1" rowspan="1">0</td><td align="left" colspan="1" rowspan="1">0.7174</td><td align="left" colspan="1" rowspan="1">0</td></tr><tr><td align="left" colspan="1" rowspan="1">SEMA</td><td align="left" colspan="2" rowspan="1"><bold>1.0000</bold></td><td align="left" colspan="1" rowspan="1">0.9983</td><td align="left" colspan="1" rowspan="1">1.1e-06</td><td align="left" colspan="1" rowspan="1">0.9986</td><td align="left" colspan="1" rowspan="1">1.3e-04</td><td align="left" colspan="1" rowspan="1"><bold>1.0000</bold></td><td align="left" colspan="1" rowspan="1">–</td></tr><tr><td align="left" colspan="1" rowspan="1">TNFR</td><td align="left" colspan="2" rowspan="1"><bold>0.6909</bold></td><td align="left" colspan="1" rowspan="1">0.5607</td><td align="left" colspan="1" rowspan="1">0</td><td align="left" colspan="1" rowspan="1">0.6278</td><td align="left" colspan="1" rowspan="1">0</td><td align="left" colspan="1" rowspan="1">0.5390</td><td align="left" colspan="1" rowspan="1">0</td></tr><tr><td align="left" colspan="1" rowspan="1">Mean</td><td align="left" colspan="2" rowspan="1"><bold>0.8779</bold></td><td align="left" colspan="1" rowspan="1">0.8509</td><td align="left" colspan="1" rowspan="1"/><td align="left" colspan="1" rowspan="1">0.8477</td><td align="left" colspan="1" rowspan="1"/><td align="left" colspan="1" rowspan="1">0.7879</td><td align="left" colspan="1" rowspan="1"/></tr></tbody></table></alternatives><table-wrap-foot><fn id="nt102"><p>The maximum value in each row is shown in bold. The significance of the difference of the <italic>ROC-100k</italic> score for each method compared with that of Neighborhood Correlation is expressed as a p-value. Dashes indicate <italic>ROC-100k</italic> scores that are not significantly different at the 0.001 level.</p></fn></table-wrap-foot></table-wrap><p>In evaluating homology identification methods, we consider two user models. Genome-scale analyses require all-against-all comparison of a large and heterogeneous set of sequences. In order to be suitable for automated, genomic analyses, a method must be robust enough for use without human intervention, deliver consistent behavior on different types of domain architectures, and be fast and easy to use. In this case, the goal is to maximize the total number of homolog pairs that are correctly predicted. A second application is analysis of individual families, where the goal is to obtain good per-family prediction scores over a wide range of families.</p><p>To evaluate performance for both user models, we report <italic>ROC-100k</italic> scores for all pairs (<italic>ALL</italic> and <italic>ALL-Kin</italic>), as well as <italic>ROC-100k</italic> scores for each family. To show how the methods tested behave on proteins with various attributes, we also report the average <italic>ROC-100k</italic> score per family for single domain families, multidomain families with conserved architectures, and multidomain families with variable architectures.</p><p>As a visualization tool, we generated <italic>rank plots</italic>, which show the scores of all matches to a given query sequence in rank order. Rank plots provide a visual representation of the organizational structure of the network neighborhood of the query sequence, as well as organizational substructure within the family. For example, <xref ref-type="fig" rid="pcbi-1000063-g005">Figure 5</xref> shows a rank plot for the query sequence <italic>PDGFRB</italic>, a protein tyrosine kinase. The break in the curve in <xref ref-type="fig" rid="pcbi-1000063-g005">Figure 5B</xref> at <italic>NC</italic>≈0.8 corresponds to the first match to a Serine/Threonine Kinase, the inflection point at <italic>NC</italic>≈0.75 corresponds to the first match to a Dual-Specificity Kinase, and the downward plunge at <italic>NC</italic>≈0.59 corresponds to the first Casein Kinase. Rank plots for each of the 26,197 sequences in our dataset are provided at <ext-link ext-link-type="uri" xlink:href="http://www.neighborhoodcorrelation.org" xlink:type="simple">http://www.neighborhoodcorrelation.org</ext-link>.</p><fig id="pcbi-1000063-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000063.g005</object-id><label>Figure 5</label><caption><title>Rank plots for the query sequence <italic>PDGFRB</italic>.</title><p>Family and non-family matches are shown in blue and red, respectively. Matches with the Kinase <italic>PRKG1B</italic> and the non-Kinase <italic>NCAM2</italic> are indicated by magenta and green circles. Scores of matching sequences ranked by (A) Neighborhood Correlation score, (B) BLAST score, and (C) PSI-BLAST score.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000063.g005" xlink:type="simple"/></fig></sec><sec id="s2g"><title>Neighborhood Correlation Performance</title><p>When all considered classifiers are applied to the aggregate set of sequence pairs (<italic>ALL</italic>), Neighborhood Correlation dramatically outperforms the other three methods (<xref ref-type="table" rid="pcbi-1000063-t003">Table 3</xref>, <xref ref-type="supplementary-material" rid="pcbi.1000063.s001">Figures S1</xref> and <xref ref-type="supplementary-material" rid="pcbi.1000063.s002">S2</xref>). In the <italic>ALL-Kin</italic> dataset, Neighborhood Correlation yields better performance than BLAST and PSI-BLAST, but performs slightly worse than DAC. The superior performance of Neighborhood Correlation on the <italic>ALL</italic> and <italic>ALL-Kin</italic> datasets demonstrates that its optimal classification threshold is less sensitive to family specific properties than those of BLAST or PSI-BLAST.</p><p>When performance on individual families is considered, Neighborhood Correlation is generally more robust than the other three methods. It perfectly classifies twelve families, more than any other method. In addition, in 16 of 20 families, the discriminatory performance of Neighborhood Correlation is better than or equal to that of all other methods. In particular, Neighborhood Correlation obtains the highest average score for both conserved and variable architectures and performs much better on individual multidomain families except for Myosin and Kinesin. For families with high sequence divergence, including FGF, TNF, and USP, Neighborhood Correlation performs better than BLAST, indicating that neighborhood structure can compensate for a low signal to noise ratio in pairwise comparisons of remote homologs. PSI-BLAST also performs well in such cases.</p><p>To demonstrate why Neighborhood Correlation is more effective for complex families, we consider its performance on the Kinase family. <xref ref-type="fig" rid="pcbi-1000063-g005">Figure 5</xref> shows a rank plot of the results of a query with the Kinase <italic>PDGFRB</italic>. A robust method is expected to rank all Kinase family members before non-Kinase matches. In particular, we examine pairing between the Kinase <italic>PRKG1B</italic> and the non-Kinase <italic>NCAM2</italic>, the genes depicted in <xref ref-type="fig" rid="pcbi-1000063-g002">Figure 2</xref>. Neighborhood Correlation exhibits no difficulty separating these pairs. The match with <italic>PRKG1B</italic> scores substantially higher than <italic>NCAM2</italic> (indicated by magenta and green circles, repectively, in <xref ref-type="fig" rid="pcbi-1000063-g005">Figure 5</xref>). In contrast, the BLAST scores for these sequences are indistinguishable, and the PSI-BLAST scores for these sequences are <italic>reversed</italic>: The match to <italic>NCAM2</italic> obtains θ = 3.65<italic>e</italic><sup>−40</sup>, while the match to <italic>PRKG1B</italic> is much less significant (θ = 1.26<italic>e</italic><sup>−25</sup>). How typical are these examples? As shown in <xref ref-type="fig" rid="pcbi-1000063-g006">Figure 6</xref>, the sequence similarity distributions of FF and FO pairs overlap completely for BLAST and partially for PSI-BLAST. In contrast, the Neighborhood Correlation score distributions for family and non-family matches are largely distinct, with only a limited overlap in the tails of the distributions.</p><fig id="pcbi-1000063-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000063.g006</object-id><label>Figure 6</label><caption><title>Distribution of scores for all family and non-family pairs in the Kinase family.</title><p>Family and non-family matches are shown in blue and red, respectively. (A) Neighborhood Correlation scores, (B) BLAST scores, and (C) PSI-BLAST scores.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000063.g006" xlink:type="simple"/></fig><p>Neighborhood Correlation also delivers robust performance when sensitivity (<italic>Sn</italic>) and specificity (<italic>Sp</italic>) are considered independently. For example, when matches to the query sequence <italic>PDGFRB</italic> are ranked by Neighborhood Correlation score (<xref ref-type="fig" rid="pcbi-1000063-g005">Figure 5A</xref>), a cutoff of <italic>NC = 0.3</italic> results in three false positives with only ten false negatives. In contrast, a BLAST threshold of <italic>E</italic>&lt;3<italic>e</italic><sup>−10</sup> results in three false positives and 630 false negatives (<xref ref-type="fig" rid="pcbi-1000063-g005">Figure 5B</xref>). The number of false negatives obtained with PSI-BLAST at this specificity is even greater (<xref ref-type="fig" rid="pcbi-1000063-g005">Figure 5C</xref>). More generally, the <italic>ROC-n</italic> curves for the Kinase family in <xref ref-type="fig" rid="pcbi-1000063-g007">Figure 7</xref> demonstrate that Neighborhood Correlation achieves both higher sensitivity and higher specificity than BLAST, except at very high specificity, and always outperforms PSI-BLAST by both measures. Neighborhood Correlation simultaneously achieves <italic>Sn</italic>≈0.85 and <italic>Sp</italic>≥0.999. At this specificity, <italic>Sn≈</italic>0.7 for PSI-BLAST and <italic>Sn≈</italic>0.55 for BLAST.</p><fig id="pcbi-1000063-g007" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000063.g007</object-id><label>Figure 7</label><caption><title><italic>ROC-100k</italic> curves for the Kinase family for all classification methods tested.</title><p><italic>ROC-100k</italic> curves of Neighborhood Correlation (blue), BLAST (red), PSI-BLAST (magenta), DAC (purple) and alignment coverage (<italic>α</italic>≥0.3: green, <italic>α</italic>≥0.6: yellow, <italic>α</italic> ≥0.8: orange).</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000063.g007" xlink:type="simple"/></fig><p>While the other methods considered have strengths specific to particular challenges, Neighborhood Correlation delivers the most reliable and consistent performance on large, heterogeneous datasets. Neighborhood Correlation is, therefore, particularly well suited to automated genome-scale analyses, which require that a single classification threshold be suitable for the vast majority of sequence pairs in a genomic dataset. Moreover, Neighborhood Correlation is robust. The distribution of Neighborhood Correlation scores for all sequence pairs in our dataset (<xref ref-type="supplementary-material" rid="pcbi.1000063.s003">Figure S3</xref>) has a flat trough ranging from 0.4 to 0.8. Within this range, the prediction quality will be relatively insensitive to the choice of threshold. A putative set of mouse and human homologs imposed by a threshold of <italic>NC</italic>≥0.6 on all sequence pairs in our dataset is available at <ext-link ext-link-type="uri" xlink:href="http://www.neighborhoodcorrelation.org" xlink:type="simple">http://www.neighborhoodcorrelation.org</ext-link>.</p></sec><sec id="s2h"><title>PSI-BLAST</title><p>As expected, PSI-BLAST excels at families with low sequence conservation, such as TNF and USP, and generally performs well on single domain families. However, PSI-BLAST falters on complex multidomain families and on sequences with promiscuous domains. PSI-BLAST's average <italic>ROC-100k</italic> scores for both conserved and variable multidomain families are inferior to those of both Neighborhood Correlation and BLAST. This is exemplified by PSI-BLAST's poor performance (<xref ref-type="fig" rid="pcbi-1000063-g005">Figure 5B</xref>) when querying with <italic>PDGFRB</italic>, which has two copies of the highly promiscuous Ig domain. PSI-BLAST's iterative profile construction algorithm incorporates matches to the highly promiscuous Ig domain in the growing alignment, even when a very stringent inclusion threshold (<italic>E</italic>&lt;10<sup>−13</sup>) is used. As a result, unrelated sequences that contain Ig domains match the resulting profile with better scores than Kinases without Ig. PSI-BLAST performs better on the Kinase family as a whole than it does on <italic>PDGFRB</italic> (<xref ref-type="table" rid="pcbi-1000063-t003">Table 3</xref>) because many Kinases are single domain proteins.</p><p>When classification of heterogeneous data is considered, PSI-BLAST's performance is inferior to Neighborhood Correlation on the <italic>ALL</italic> dataset and to both Neighborhood Correlation and BLAST on the <italic>ALL-Kin</italic> dataset. This demonstrates that no single PSI-BLAST cutoff is suitable for all families. Indeed, inspection of PSI-BLAST output on individual queries (data not shown) indicates that PSI-BLAST scores tend to vary widely from family to family. PSI-BLAST introduces a clear tradeoff between sensitivity and generality, to the particular detriment of large-scale studies. Moreover, PSI-BLAST is characterized by greater instability and running time than BLAST or Neighborhood Correlation.</p></sec><sec id="s2i"><title>Domain Architecture Comparison</title><p>Domain architecture comparison performs well on single domain families and on multidomain families with conserved domain architectures (e.g., DVL, Notch, Laminin, and WNT). Like PSI-BLAST, DAC can recognize distant homology because domain architectures are recognized by MSA-based models. The performance of DAC on other families is mixed, however, because it faces a number of challenges that do not arise with the other classification methods.</p><p>First, all domain architecture comparison methods are substantially restricted by the limitations of domain detection. In our dataset, 12.7% of sequences do not have domain annotations, resulting in low <italic>ROC-100k</italic> scores for many families. This explains why single domain families, such as Tbox, which have identical domain architectures, do not achieve perfect <italic>ROC-100k</italic> scores, contrary to expectations. An additional shortcoming is that domain architecture comparison methods do not capture information in linker sequences or sequence variation within a domain family. Therefore, domain architecture comparison tends to assign the same score to pairs that actually differ in sequence divergence. This explains the long plateaus in the ROC curve for DAC in <xref ref-type="fig" rid="pcbi-1000063-g007">Figure 7</xref>.</p><p>A particularly challenging problem for domain architecture comparison is how to effectively distinguish domains that proliferated through gene duplication from promiscuous domains that proliferated through domain shuffling. The number of domain partners, used here, is a typical measure of promiscuity, based on the assumption that this measure reflects the frequency of domain insertion <xref ref-type="bibr" rid="pcbi.1000063-Marcotte2">[48]</xref>. This measure of promiscuity will inappropriately down-weight a domain that characterizes a family, if the domain happens to be the target of insertions of many other domains. Consider, for example, a sequence with a single domain <italic>A</italic> that sustains repeated duplication, followed by insertion of different domains into the resulting copies, yielding <italic>AB</italic>, <italic>AC</italic>, <italic>AD</italic>, and so on. Domain <italic>A</italic> will have a high promiscuity score, although it is never inserted into new contexts. As a concrete example, the Pkinase domain partners with more than 100 different domains. However, the resulting high promiscuity score may be inappropriate since Pkinase lacks many of the other characteristics of promiscuous domains, such as small size and 1-1 phase <xref ref-type="bibr" rid="pcbi.1000063-Tordai1">[17]</xref>, and is important in defining the Kinase family. This explains why domain architecture comparison performs poorly on the Kinase family.</p></sec><sec id="s2j"><title>Alignment Coverage</title><p>To assess the effectiveness of alignment coverage in eliminating domain-only matches, we compared <italic>ROC-100k</italic> scores for sequence similarity alone and combined with alignment coverage (<italic>α</italic>, see <xref ref-type="sec" rid="s4">Methods</xref>). We considered three alignment coverage thresholds, <italic>α</italic>≥0.3, <italic>α</italic>≥0.6, and <italic>α</italic>≥0.8, that span the range of length cutoffs used in the literature (<italic>e.g.</italic> <xref ref-type="bibr" rid="pcbi.1000063-McLysaght1">[32]</xref>,<xref ref-type="bibr" rid="pcbi.1000063-Rubin1">[34]</xref>). The results (<xref ref-type="table" rid="pcbi-1000063-t004">Table 4</xref>) show that the addition of an alignment coverage criterion does not improve the performance of sequence similarity. For example, a cutoff of <italic>α</italic>≥0.3 reduces the <italic>ROC-100k</italic> score by 25% in the <italic>ALL</italic> dataset and 23% in the <italic>ALL-Kin</italic> dataset. When families are considered individually, a cutoff of <italic>α</italic>≥0.3 decreases the <italic>ROC-100k</italic> score by at least 10% in one-third of the families. Increasing the cutoff to <italic>α</italic>≥0.6 or <italic>α</italic>≥0.8 does not increase performance in any family. Note that although the <italic>ROC-100k</italic> score for KIR when <italic>α</italic>≥0.6 is higher than the score for sequence similarity alone, this difference is not significant (<italic>p = 0.69</italic>).</p><table-wrap id="pcbi-1000063-t004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000063.t004</object-id><label>Table 4</label><caption><title><italic>ROC-100k</italic> scores for BLAST alone, and combined with alignment coverage at thresholds of <italic>α</italic>≥0.3, <italic>α</italic>≥0.6, and <italic>α</italic>≥0.8.</title></caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1000063-t004-4" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000063.t004" xlink:type="simple"/><table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup><thead><tr><td align="left" colspan="1" rowspan="1"/><td align="left" colspan="1" rowspan="1">BLAST</td><td align="left" colspan="1" rowspan="1"><italic>α</italic>≥0.3</td><td align="left" colspan="1" rowspan="1"><italic>α</italic>≥0.6</td><td align="left" colspan="1" rowspan="1"><italic>α</italic>≥0.8</td></tr></thead><tbody><tr><td align="left" colspan="1" rowspan="1"><italic>ALL</italic></td><td align="left" colspan="1" rowspan="1"><bold>0.5838</bold></td><td align="left" colspan="1" rowspan="1">0.4295</td><td align="left" colspan="1" rowspan="1">0.0784</td><td align="left" colspan="1" rowspan="1">0.0236</td></tr><tr><td align="left" colspan="1" rowspan="1"><italic>ALL-Kin</italic></td><td align="left" colspan="1" rowspan="1"><bold>0.7505</bold></td><td align="left" colspan="1" rowspan="1">0.5756</td><td align="left" colspan="1" rowspan="1">0.2902</td><td align="left" colspan="1" rowspan="1">0.1747</td></tr><tr><td align="left" colspan="5" rowspan="1">Single domain families</td></tr><tr><td align="left" colspan="1" rowspan="1">ACSL</td><td align="left" colspan="1" rowspan="1"><bold>1.0000</bold></td><td align="left" colspan="1" rowspan="1"><bold>1.0000</bold></td><td align="left" colspan="1" rowspan="1"><bold>1.0000</bold></td><td align="left" colspan="1" rowspan="1"><bold>1.0000</bold></td></tr><tr><td align="left" colspan="1" rowspan="1">FGF</td><td align="left" colspan="1" rowspan="1"><bold>0.9920</bold></td><td align="left" colspan="1" rowspan="1">0.9757</td><td align="left" colspan="1" rowspan="1">0.6002</td><td align="left" colspan="1" rowspan="1">0.1403</td></tr><tr><td align="left" colspan="1" rowspan="1">FOX</td><td align="left" colspan="1" rowspan="1"><bold>0.9996</bold></td><td align="left" colspan="1" rowspan="1">0.3172</td><td align="left" colspan="1" rowspan="1">0.0635</td><td align="left" colspan="1" rowspan="1">0.0310</td></tr><tr><td align="left" colspan="1" rowspan="1">Tbox</td><td align="left" colspan="1" rowspan="1"><bold>1.0000</bold></td><td align="left" colspan="1" rowspan="1">0.9740</td><td align="left" colspan="1" rowspan="1">0.1883</td><td align="left" colspan="1" rowspan="1">0.1136</td></tr><tr><td align="left" colspan="1" rowspan="1">TNF</td><td align="left" colspan="1" rowspan="1"><bold>0.3631</bold></td><td align="left" colspan="1" rowspan="1">0.3588</td><td align="left" colspan="1" rowspan="1">0.2090</td><td align="left" colspan="1" rowspan="1">0.0814</td></tr><tr><td align="left" colspan="1" rowspan="1">USP</td><td align="left" colspan="1" rowspan="1"><bold>0.8666</bold></td><td align="left" colspan="1" rowspan="1">0.3312</td><td align="left" colspan="1" rowspan="1">0.1230</td><td align="left" colspan="1" rowspan="1">0.0609</td></tr><tr><td align="left" colspan="1" rowspan="1">WNT</td><td align="left" colspan="1" rowspan="1"><bold>1.0000</bold></td><td align="left" colspan="1" rowspan="1"><bold>1.0000</bold></td><td align="left" colspan="1" rowspan="1"><bold>1.0000</bold></td><td align="left" colspan="1" rowspan="1"><bold>1.0000</bold></td></tr><tr><td align="left" colspan="1" rowspan="1">Mean</td><td align="left" colspan="1" rowspan="1"><bold>0.8888</bold></td><td align="left" colspan="1" rowspan="1">0.7081</td><td align="left" colspan="1" rowspan="1">0.4549</td><td align="left" colspan="1" rowspan="1">0.3467</td></tr><tr><td align="left" colspan="5" rowspan="1">Multidomain families: conserved architecture</td></tr><tr><td align="left" colspan="1" rowspan="1">DVL</td><td align="left" colspan="1" rowspan="1"><bold>1.0000</bold></td><td align="left" colspan="1" rowspan="1"><bold>1.0000</bold></td><td align="left" colspan="1" rowspan="1">0.7755</td><td align="left" colspan="1" rowspan="1">0.2653</td></tr><tr><td align="left" colspan="1" rowspan="1">GATA</td><td align="left" colspan="1" rowspan="1"><bold>1.0000</bold></td><td align="left" colspan="1" rowspan="1">0.8679</td><td align="left" colspan="1" rowspan="1">0.4097</td><td align="left" colspan="1" rowspan="1">0.3125</td></tr><tr><td align="left" colspan="1" rowspan="1">Notch</td><td align="left" colspan="1" rowspan="1"><bold>1.0000</bold></td><td align="left" colspan="1" rowspan="1"><bold>1.0000</bold></td><td align="left" colspan="1" rowspan="1"><bold>1.0000</bold></td><td align="left" colspan="1" rowspan="1"><bold>1.0000</bold></td></tr><tr><td align="left" colspan="1" rowspan="1">KIR</td><td align="left" colspan="1" rowspan="1">0.9971</td><td align="left" colspan="1" rowspan="1">0.9971</td><td align="left" colspan="1" rowspan="1"><bold>0.9973</bold></td><td align="left" colspan="1" rowspan="1">0.7597</td></tr><tr><td align="left" colspan="1" rowspan="1">TRAF</td><td align="left" colspan="1" rowspan="1"><bold>1.0000</bold></td><td align="left" colspan="1" rowspan="1"><bold>1.0000</bold></td><td align="left" colspan="1" rowspan="1">0.8401</td><td align="left" colspan="1" rowspan="1">0.8403</td></tr><tr><td align="left" colspan="1" rowspan="1">Mean</td><td align="left" colspan="1" rowspan="1"><bold>0.9994</bold></td><td align="left" colspan="1" rowspan="1">0.9730</td><td align="left" colspan="1" rowspan="1">0.8045</td><td align="left" colspan="1" rowspan="1">0.6356</td></tr><tr><td align="left" colspan="5" rowspan="1">Multidomain families: variable architecture</td></tr><tr><td align="left" colspan="1" rowspan="1">ADAM</td><td align="left" colspan="1" rowspan="1"><bold>0.9830</bold></td><td align="left" colspan="1" rowspan="1">0.9372</td><td align="left" colspan="1" rowspan="1">0.8772</td><td align="left" colspan="1" rowspan="1">0.4744</td></tr><tr><td align="left" colspan="1" rowspan="1">Kinase</td><td align="left" colspan="1" rowspan="1"><bold>0.6164</bold></td><td align="left" colspan="1" rowspan="1">0.4384</td><td align="left" colspan="1" rowspan="1">0.0704</td><td align="left" colspan="1" rowspan="1">0.0176</td></tr><tr><td align="left" colspan="1" rowspan="1">Kinesin</td><td align="left" colspan="1" rowspan="1"><bold>0.9806</bold></td><td align="left" colspan="1" rowspan="1">0.7644</td><td align="left" colspan="1" rowspan="1">0.1582</td><td align="left" colspan="1" rowspan="1">0.0842</td></tr><tr><td align="left" colspan="1" rowspan="1">Laminin</td><td align="left" colspan="1" rowspan="1"><bold>0.9245</bold></td><td align="left" colspan="1" rowspan="1">0.5681</td><td align="left" colspan="1" rowspan="1">0.2836</td><td align="left" colspan="1" rowspan="1">0.1640</td></tr><tr><td align="left" colspan="1" rowspan="1">Myosin</td><td align="left" colspan="1" rowspan="1"><bold>0.9870</bold></td><td align="left" colspan="1" rowspan="1">0.8804</td><td align="left" colspan="1" rowspan="1">0.4482</td><td align="left" colspan="1" rowspan="1">0.2682</td></tr><tr><td align="left" colspan="1" rowspan="1">PDE</td><td align="left" colspan="1" rowspan="1"><bold>0.7565</bold></td><td align="left" colspan="1" rowspan="1">0.7311</td><td align="left" colspan="1" rowspan="1">0.1960</td><td align="left" colspan="1" rowspan="1">0.1424</td></tr><tr><td align="left" colspan="1" rowspan="1">SEMA</td><td align="left" colspan="1" rowspan="1">0.9983</td><td align="left" colspan="1" rowspan="1"><bold>0.9998</bold></td><td align="left" colspan="1" rowspan="1">0.6409</td><td align="left" colspan="1" rowspan="1">0.3493</td></tr><tr><td align="left" colspan="1" rowspan="1">TNFR</td><td align="left" colspan="1" rowspan="1"><bold>0.5607</bold></td><td align="left" colspan="1" rowspan="1">0.3927</td><td align="left" colspan="1" rowspan="1">0.0703</td><td align="left" colspan="1" rowspan="1">0.0453</td></tr><tr><td align="left" colspan="1" rowspan="1">Mean</td><td align="left" colspan="1" rowspan="1"><bold>0.8509</bold></td><td align="left" colspan="1" rowspan="1">0.7140</td><td align="left" colspan="1" rowspan="1">0.3431</td><td align="left" colspan="1" rowspan="1">0.1932</td></tr></tbody></table></alternatives></table-wrap><p>Alignment coverage is based on the assumption that non-homologous pairs have shorter regions of similarity than homologous pairs, yet <xref ref-type="table" rid="pcbi-1000063-t004">Table 4</xref> suggests this is not universally true. To assess the extent to which the region of similarity in homologous pairs extends over the bulk of their length, we calculated Precision and Recall (see <xref ref-type="sec" rid="s4">Methods</xref>) for <italic>α</italic>≥0.3, <italic>α</italic>≥0.6, and <italic>α</italic>≥0.8. The results, shown in <xref ref-type="table" rid="pcbi-1000063-t005">Tables 5</xref> and <xref ref-type="supplementary-material" rid="pcbi.1000063.s005">Table S1</xref>, suggest that full length alignments are not a characteristic property of homologous families, at least in our dataset. In the <italic>ALL-Kin</italic> dataset, a cutoff of <italic>α</italic>≥0.3 eliminates 40% of true positives, specifying <italic>α</italic>≥0.6 eliminates 70% of true positives, and <italic>α</italic>≥0.8 eliminates 83% true positives. The loss in Recall is even more extreme in the <italic>ALL</italic> dataset.</p><table-wrap id="pcbi-1000063-t005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000063.t005</object-id><label>Table 5</label><caption><title>Precision and recall for predictions using optimal and combined alignments.</title></caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1000063-t005-5" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000063.t005" xlink:type="simple"/><table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup><thead><tr><td align="left" colspan="1" rowspan="1"/><td align="left" colspan="2" rowspan="1"><italic>α</italic>≥0.3</td><td align="left" colspan="2" rowspan="1"><italic>α</italic>≥0.6</td><td align="left" colspan="2" rowspan="1"><italic>α</italic>≥0.8</td></tr><tr><td align="left" colspan="1" rowspan="1"/><td align="left" colspan="1" rowspan="1">Precision</td><td align="left" colspan="1" rowspan="1">Recall</td><td align="left" colspan="1" rowspan="1">Precision</td><td align="left" colspan="1" rowspan="1">Recall</td><td align="left" colspan="1" rowspan="1">Precision</td><td align="left" colspan="1" rowspan="1">Recall</td></tr></thead><tbody><tr><td align="left" colspan="7" rowspan="1">Optimal alignment</td></tr><tr><td align="left" colspan="1" rowspan="1"><italic>ALL</italic></td><td align="left" colspan="1" rowspan="1">0.8810</td><td align="left" colspan="1" rowspan="1">0.4675</td><td align="left" colspan="1" rowspan="1">0.9556</td><td align="left" colspan="1" rowspan="1">0.0772</td><td align="left" colspan="1" rowspan="1">0.9893</td><td align="left" colspan="1" rowspan="1">0.0217</td></tr><tr><td align="left" colspan="1" rowspan="1"><italic>ALL-Kin</italic></td><td align="left" colspan="1" rowspan="1">0.3775</td><td align="left" colspan="1" rowspan="1">0.6072</td><td align="left" colspan="1" rowspan="1">0.7853</td><td align="left" colspan="1" rowspan="1">0.2904</td><td align="left" colspan="1" rowspan="1">0.9758</td><td align="left" colspan="1" rowspan="1">0.1732</td></tr><tr><td align="left" colspan="7" rowspan="1">Combined alignments</td></tr><tr><td align="left" colspan="1" rowspan="1"><italic>ALL</italic></td><td align="left" colspan="1" rowspan="1">0.8776</td><td align="left" colspan="1" rowspan="1">0.4777</td><td align="left" colspan="1" rowspan="1">0.9549</td><td align="left" colspan="1" rowspan="1">0.0787</td><td align="left" colspan="1" rowspan="1">0.9889</td><td align="left" colspan="1" rowspan="1">0.0220</td></tr><tr><td align="left" colspan="1" rowspan="1"><italic>ALL-Kin</italic></td><td align="left" colspan="1" rowspan="1">0.3807</td><td align="left" colspan="1" rowspan="1">0.6528</td><td align="left" colspan="1" rowspan="1">0.7861</td><td align="left" colspan="1" rowspan="1">0.2999</td><td align="left" colspan="1" rowspan="1">0.9750</td><td align="left" colspan="1" rowspan="1">0.1771</td></tr></tbody></table></alternatives></table-wrap><p>To better understand these results, we plotted histograms of <italic>α</italic> for individual families (<xref ref-type="fig" rid="pcbi-1000063-g008">Figures 8</xref>, <xref ref-type="supplementary-material" rid="pcbi.1000063.s004">S4</xref>). While some families do have long regions of similarity, long conserved regions are not a persistent characteristic of most families in our dataset. Several different trends in domain organization can cause this. Some families are characterized by a short, conserved domain, such as the DNA binding domain in the FOX family, and little conservation elsewhere (<xref ref-type="fig" rid="pcbi-1000063-g008">Figure 8A</xref>). Multidomain families exhibit a range of alignment lengths for a variety of reasons. In families characterized by a single defining domain partnered with a variety of auxiliary domains, alignment lengths depend upon the number of domains a given pair has in common. For example, the histogram for the PDE family (<xref ref-type="fig" rid="pcbi-1000063-g008">Figure 8B</xref>) has a small peak near <italic>α</italic> = 1.0, corresponding to pairs with identical domain architectures, and a much larger peak between <italic>α</italic> = 0.2 and <italic>α</italic> = 0.7 that represents pairs of family members with different auxiliary domains. Families can also demonstrate wide variation in due to differences in copy number (<italic>e.g.</italic>, Laminin, <xref ref-type="fig" rid="pcbi-1000063-g008">Figure 8C</xref>). Finally, a broad <italic>α</italic> distribution can be caused by variation in sequence length within the family. Even when the length of the conserved region is constant, alignment coverage, expressed as a fraction of total length, may vary widely, confounding homology prediction methods based upon alignment coverage.</p><fig id="pcbi-1000063-g008" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000063.g008</object-id><label>Figure 8</label><caption><title>Alignment coverage distributions for representative families.</title><p>Histograms calculated with the optimal alignment length only (FF: blue, FO: red) and with combined non-conflicting alignments (FF: turquoise, FO: brown) (A) FOX, (B) PDE, and (C) Laminin.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000063.g008" xlink:type="simple"/></fig><p>Given the widespread use of alignment coverage criteria, we were surprised by this poor performance. We examined the possibility that our failure to observe a consistent pattern of long alignments was due to the fact that we considered the length of the optimal alignment, only. To investigate whether including sub-optimal alignments would result in different conclusions, we implemented a simple heuristic (see <xref ref-type="sec" rid="s4">Methods</xref>) that identifies and combines a consistent set of high-scoring local alignments; i.e., alignments that appear in the same order in both sequences and do not overlap. Surprisingly, including suboptimal alignments in the alignment coverage calculation has little impact on our results. The distributions of the combined alignment lengths, shown in turquoise and brown in <xref ref-type="fig" rid="pcbi-1000063-g008">Figures 8</xref> and <xref ref-type="supplementary-material" rid="pcbi.1000063.s004">S4</xref>, differ little from the distribution of optimal alignment length distributions (shown in blue and red). Nor do the values of Precision and Recall obtained with combined alignments differ greatly from those obtained with the optimal alignment (see <xref ref-type="table" rid="pcbi-1000063-t005">Table 5</xref> and <xref ref-type="supplementary-material" rid="pcbi.1000063.s006">Table S2</xref>). In summary, analysis with combined alignments confirms that full length similarity is not a general characteristic of homologous families.</p></sec></sec><sec id="s3"><title>Discussion</title><p>Protein modularity allows the evolution of diverse function through combinatorial rearrangement of functional building blocks. This versatile evolutionary mechanism played a transformative role in key evolutionary transitions, including the emergence of multicellular animals and the vertebrate immune system. Identification of multidomain homologs is essential to studying the evolution of modular families, as well as to many genomic applications that exploit evolutionary information.</p><p>Two obstacles have impeded research on multidomain homology: the absence of formal models and a lack of curated datasets of multidomain homologs for evaluation of proposed methods. In the current paper, we offer preliminary solutions to both problems: We propose an evolutionary model and an associated definition of homology suitable for multidomain proteins. We further provide a curated test set of homologous mouse and human sequence pairs from twenty well-studied families for which there is unambiguous evidence that member sequences are derived from a common ancestor. Our benchmark encompasses various challenges for homology identification methods, including both conserved and variable multidomain architectures, promiscuous domains, single domain families with short regions of conservation, and families with weak sequence conservation. It differs from other available benchmarks in that it seeks to represent evolutionary, rather than structural (e.g., SCOP <xref ref-type="bibr" rid="pcbi.1000063-Murzin1">[38]</xref>) or functional (e.g., GO <xref ref-type="bibr" rid="pcbi.1000063-Ashburner1">[59]</xref>) information. This benchmark is available to the community through the Neighborhood Correlation website.</p><p>Using our curated benchmark, we demonstrate that the most widely used homology identification methods, BLAST, PSI-BLAST, domain architecture comparison, and alignment coverage, all face serious limitations in their ability to recognize multidomain homologs. In response, we introduce Neighborhood Correlation, a method that uses a fundamentally different approach to homology identification by deriving evolutionary signal from the local structure of the sequence similarity network. Following a discussion of our model within the historical framework of models of homology, we place our results in the perspective of similar problems and approaches. We discuss Neighborhood Correlation in relation to other evolutionary classifications, the needs of genomic applications and multiple sequence alignment methods, and conclude by reviewing the potential of networks in molecular evolution.</p><sec id="s3a"><title>Model</title><p>Although models of gene family evolution have been proposed and debated for more than three decades <xref ref-type="bibr" rid="pcbi.1000063-Fitch1">[18]</xref>, models of multidomain evolution are in their infancy. Gene homology is a yes/no question: genes either share common ancestry or they do not. With this in mind, Fitch <xref ref-type="bibr" rid="pcbi.1000063-Fitch2">[42]</xref> argued that when subsequences of genes have distinct evolutionary histories, it is not possible to determine gene homology. Rost and colleagues <xref ref-type="bibr" rid="pcbi.1000063-Liu1">[45]</xref>,<xref ref-type="bibr" rid="pcbi.1000063-Rost1">[63]</xref> further proposed that “dissecting proteins into structural domain-like fragments” <xref ref-type="bibr" rid="pcbi.1000063-Liu1">[45]</xref> is the only reasonable way to study relationships in such proteins. We suggest an alternative: By considering the genomic context of genes that encode multidomain proteins, it is possible to define homology for multidomain sequences without violating the tenet that homology is an indivisible property.</p><p>We propose a model of multidomain evolution in which the set of events by which sequences diverge is expanded to include domain insertion and deletion as well as mutation. Recent evidence from studies of young genes <xref ref-type="bibr" rid="pcbi.1000063-Sayah1">[50]</xref>–<xref ref-type="bibr" rid="pcbi.1000063-Jones1">[53]</xref>, as well as indirect evidence of sequence shuffling <xref ref-type="bibr" rid="pcbi.1000063-Tordai1">[17]</xref>,<xref ref-type="bibr" rid="pcbi.1000063-Bjorklund1">[24]</xref>,<xref ref-type="bibr" rid="pcbi.1000063-Patthy1">[49]</xref>,<xref ref-type="bibr" rid="pcbi.1000063-Fong1">[55]</xref>,<xref ref-type="bibr" rid="pcbi.1000063-Weiner1">[56]</xref>, suggests that our model is consistent with a significant fraction of metazoan multidomain families. This model permits discrimination between genes related by vertical descent and those related by domain insertion alone, which is the basis for our definition of multidomain homology. This in turn enlarges the scope of inquiry from domain family homology to gene family homology, providing a broader context in which to study the evolutionary processes by which modular families are formed. Our model does not describe families that evolved through other domain shuffling processes such as gene fission, the fusion of adjacent genes resulting from read-through errors, or <italic>de novo</italic> formation of novel architectures through independent insertions in intergenic regions. Extending the model to capture a broader range of domain shuffling scenarios and testing it on other datasets and applications are important directions for future work.</p></sec><sec id="s3b"><title>Comparison with Other Evolutionary Classifications</title><p>Evidence supporting the validity of our model can be obtained by comparing Neighborhood Correlation with related classifications, such as orthology and domain homology. The success of Neighborhood Correlation in recapitulating homologous relationships in our benchmark empirically supports Neighborhood Correlation as a predictor of homologous genes; that is, sequences derived from a common ancestor by vertical descent, whether by duplication or speciation. Since orthologs, sequences that diverged by speciation in their most recent common ancestor, are by definition homologs, our model predicts that known mouse and human orthologs will have high Neighborhood Correlation scores. To test this prediction, we compared Neighborhood Correlation with KOGs <xref ref-type="bibr" rid="pcbi.1000063-Tatusov1">[40]</xref>. As expected, 90% of sequences in our dataset with the same KOG annotation have a Neighborhood Correlation Score greater than 0.6 (<xref ref-type="fig" rid="pcbi-1000063-g009">Figure 9A</xref>). However, only 12% of pairs with <italic>NC</italic>≥0.6 share the same KOG annotation. This is consistent with the observation that gene homology is a necessary but not sufficient condition to establish orthology.</p><fig id="pcbi-1000063-g009" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000063.g009</object-id><label>Figure 9</label><caption><title>Comparison of Neighborhood Correlation with other classifications.</title><p>(A) Venn diagram representing pairs with <italic>NC</italic>≥0.6 that share a KOG annotation (turquoise), pairs with <italic>NC</italic>≥0.6 that do not share a KOG annotation (blue), and pairs with <italic>NC</italic>&lt;0.6 that share a KOG annotation (yellow). (B) Pairs with <italic>NC</italic>≥0.6 that share a Pfam domain (turquoise), pairs with <italic>NC</italic>≥0.6 that do not share a Pfam domain (blue), and pairs with <italic>NC</italic>&lt;0.6 that share a Pfam domain (green).</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000063.g009" xlink:type="simple"/></fig><p>Domain homology, on the other hand, is a less stringent criterion than gene homology. Homologous genes, by definition, share at least one homologous domain. Of pairs with Neighborhood Correlation scores above 0.6, 88% of pairs share at least one Pfam <xref ref-type="bibr" rid="pcbi.1000063-Finn1">[41]</xref> code (<xref ref-type="fig" rid="pcbi-1000063-g009">Figure 9B</xref>), consistent with the assertion that gene homology is a more stringent requirement than domain homology. That the remaining 12% do not share a domain is primarily due to missing annotations. Recall that 12.7% of sequences in our dataset do not contain a recognizable Pfam domain.</p><p>Since only some sequences that share a domain are encoded by homologous genes, our model predicts that a significant fraction of sequence pairs that share homologous domains will not have high Neighborhood Correlation scores. In fact, with <italic>NC</italic>≥0.6, only half of sequence pairs in our dataset share a Pfam domain. These results are consistent with the expectation that gene homology is a less restrictive condition than orthology but more restrictive than domain homology. This analysis provides additional evidence, independent of our curated dataset, that Neighborhood Correlation can predict homologous genes according to our model.</p></sec><sec id="s3c"><title>Empirical Evaluation for Genome-Scale Analyses</title><p>Insight into the evolutionary processes responsible for the development of novel function are of greatest value when considered in the context of entire genomes. To accommodate studies of such scale, a method must be suitable for robust, automated analyses. For the current application, this requires speed, ease of use, and consistent behavior across varied domain architectures.</p><p>Neighborhood Correlation displays excellent performance across an array of families with a range of sequence patterns and evolutionary histories. Neighborhood Correlation is able to correctly classify complex families, while maintaining accuracy on simpler families. Further, it displays a classification threshold that is robust with respect to family, yielding good performance on individual families as well as on aggregate datasets in which families may not be known or readily discernible. Since Neighborhood Correlation can be computed easily with existing computing resources and data stores, it is easy to add to a computational workflow. These qualities demonstrate that Neighborhood Correlation is well suited to large-scale genomic analysis.</p><p>Empirical evaluation of existing homology detection methods revealed limitations in their applicability, often contrary to common expectations. Meticulous tests of BLAST and PSI-BLAST performance have been carried out on well-characterized datasets <xref ref-type="bibr" rid="pcbi.1000063-Altschul1">[58]</xref>,<xref ref-type="bibr" rid="pcbi.1000063-Schaffer1">[62]</xref>,<xref ref-type="bibr" rid="pcbi.1000063-Altschul3">[64]</xref>, but, to our knowledge, performance on multidomain proteins with promiscuous domains and low complexity regions has not been considered empirically. Our tests on datasets with multidomain sequences, promiscuous domains, and low complexity regions show that while BLAST represents an attractive balance between speed and accuracy on conserved, single-domain families, additional screening is needed for correct multidomain classification.</p><p>Since Huynen and Bork <xref ref-type="bibr" rid="pcbi.1000063-Huynen1">[27]</xref> proposed that alignment length could be used to reduce false positives in ortholog prediction, the practice of pre-screening using an alignment coverage criterion has become widespread in genomic analyses <xref ref-type="bibr" rid="pcbi.1000063-Blin1">[28]</xref>–<xref ref-type="bibr" rid="pcbi.1000063-Remm1">[37]</xref>. To determine the effectiveness of this approach, we investigated the two hypotheses underlying the use of alignment coverage:</p><list list-type="order"><list-item><p>The region of similarity in homologous sequence pairs covers a significant fraction of their length.</p></list-item><list-item><p>The fraction of sequence length covered by the aligned region is typically larger in homologous pairs than in unrelated sequence pairs that share an inserted domain.</p></list-item></list><p>Surprisingly, the imposition of an alignment coverage requirement, in addition to sequence similarity, actually <italic>decreased</italic> the accuracy of homology identification, suggesting that the above hypotheses are not generally true. To our knowledge, this is the first rigorous evaluation of alignment coverage.</p><p>Our study suggests that PSI-BLAST, while first-rate for detecting remote homology, is ill-suited to large scale automated analyses on datasets with complex multidomain architectures, promiscuous domains, and low complexity sequences due to its running time, instability, and family dependent score thresholds. The same iterative strategy that confers PSI-BLAST's increased sensitivity leads to a lack of robust behavior when PSI-BLAST is run in an automated manner. Even at extremely stringent inclusion thresholds, false positives are incorporated in during model construction when the query sequence contains promiscuous domains or low complexity regions. Once a false positive is included, PSI-BLAST rapidly degrades the MSA used in subsequent iterations, leading to both incorrect results and excessively long running times. PSI-BLAST required 208 CPU days for our dataset, a 300-fold increase in time over basic BLAST. This slowdown is associated with the large fraction of promiscuous, multidomain, and low complexity sequences in our dataset. When PSI-BLAST is used interactively, the user can eliminate potentially troublesome matches by inspection; however, human intervention is not possible for genome-scale studies. The additional computational cost of calculating Neighborhood Correlation scores once a BLAST search has been performed is negligible. Though PSI-BLAST does offer accuracy improvement over Neighborhood Correlation on families with conserved domain architectures, these issues suggest that PSI-BLAST is impractical for this or larger genomic studies.</p><p>Domain architecture comparison performs well on families with low sequence conservation due to the discrimintatory power of multiple alignment based domain models, yet our empirical evaluation of DAC reveals several areas for improvement. Domain architecture comparison can be compromised by faulty or incomplete domain annotation. Failure to capture sequence variation within domain and linker sequences results in an inability to resolve family substructure. A model of promiscuity that better captures domain mobility is needed to correctly classify families defined by a single domain with many partners. Because the sequence similarity network reflects both domain architecture and sequence variation, Neighborhood Correlation avoids many of these difficulties, including unresolved family substructure and sensitivity to domain annotation. Neighborhood Correlation captures modular organization on a range of scales, including sequence motifs as well as structural domains, regardless of whether these subunits are encoded in a database. In addition, Neighborhood Correlation's success on kinase classification, relative to DAC, suggests that it may be possible to derive accurate promiscuity measures from the network.</p></sec><sec id="s3d"><title>Neighborhood Correlation and Multiple Sequence Alignment</title><p>Neighborhood Correlation differs fundamentally in both goals and approach from Position Specific Scoring Matrices, Profile hidden Markov models, PSI-BLAST, and similar methods that exploit multiple alignments to detect distant homology. MSA-based approaches are not suitable for detecting multidomain homologs with varied architectures. These rely upon full length alignments that are not possible with multidomain sequences. The objective of multiple alignment methods is to identify related sequence motifs when the signal to noise ratio is low. In contrast, the goal of Neighborhood Correlation is to identify homologs that have sustained domain insertions and deletions since their divergence.</p><p>Neighborhood Correlation also differs from methods based on multiple alignment in its computational approach. Although both approaches derive information from neighboring sequences, only Neighborhood Correlation exploits the topology of the network. MSA-based methods synthesize a model from a set of neighbors in the sequence similarity network and then use the resulting composite model in pairwise comparisons. Such models reflect aggregate properties of the network neighborhood, but not the underlying topological structure of the network. In contrast, Neighborhood Correlation compares the edge weights for each pair of shared neighbors separately, capturing not only neighborhood membership, but also specific information about how individual sequences in the neighborhood are related. Finally, Neighborhood Correlation derives information from neighborhood difference as well as from neighborhood similarity, taking advantage of the fact that sequences that match one member of the pair and not the other are informative.</p></sec><sec id="s3e"><title>Evolutionary Information in Similarity Networks</title><p>Neighborhood Correlation complements a recent set of studies relating multidomain evolution to the <italic>global</italic> topological properties of the domain similarity network <xref ref-type="bibr" rid="pcbi.1000063-Wuchty1">[65]</xref>–<xref ref-type="bibr" rid="pcbi.1000063-Wolf1">[69]</xref>. Unlike these methods we focus on <italic>local</italic> network structure as evidence of the evolutionary history of specific sequence pairs and families. In an early use of local network structure, Koonin and colleagues <xref ref-type="bibr" rid="pcbi.1000063-Tatusov1">[40]</xref> argued that orthologous groups correspond to cliques in the sequence similarity network. In a similar vein, Przytycka and colleagues <xref ref-type="bibr" rid="pcbi.1000063-Przytycka1">[70]</xref>,<xref ref-type="bibr" rid="pcbi.1000063-Przytycka2">[71]</xref> used a different aspect of local structure (chordality) to test whether domain insertion and intron acquisition are evolving in a parsimonious manner in a given family. In a recent study of protein families in prokaryotes, Medini <italic>et al.</italic> <xref ref-type="bibr" rid="pcbi.1000063-Medini1">[72]</xref> consider local network structure, but do not relate it to evolutionary processes. In their study, they developed a scoring system based on sets of nearest neighbors in an unweighted network and used these pairwise scores to identify core sets of proteins associated with secretion systems in prokaryotes.</p><p>Neighborhood Correlation links local network structure to both domain architecture and evolutionary process. The similarities and differences in domain architecture are reflected in the neighborhoods of adjacent sequences. The number and weights of edges in the shared neighborhood is influenced by the number and conservation of their shared domains. Their unique neighborhoods are similarly influenced by their unique domains. The Neighborhood Correlation score, therefore, is an implicit measure of both sequence similarity and domain architecture comparison.</p><p>The history of gene duplication and domain insertion in gene family evolution is also recorded in network topology. Neighborhood Correlation is able to elucidate multidomain homology because it can decipher the traces of this history in the network. In particular, Neighborhood Correlation relies on the hypothesis that the neighborhoods of genes related through duplication are more similar to each other than the neighborhoods of genes related through domain insertion. This hypothesis in turn assumes that</p><list list-type="order"><list-item><p>gene duplication occurs more frequently than domain insertion, and</p></list-item><list-item><p>the promiscuity and sequence conservation of domain superfamilies are inversely related.</p></list-item></list><p>There is concrete evidence to support the latter assertion as indicated by the negative correlation between the promiscuity and sequence identity of Pfam domains, discussed in <xref ref-type="sec" rid="s2">Results</xref>. We are not aware of any studies predicting the relative rates of gene duplication and domain insertion. However, the success of Neighborhood Correlation in classifying multidomain homologs provides indirect evidence that the assertion is true, at least in the dataset studied here. If, contrary to this hypothesis, domain insertions occurred as or more frequently than gene duplications, the Neighborhood Correlation scores of multidomain homologs would not be distinctly higher than those of domain-only matches.</p><p>More generally, the success of Neighborhood Correlation has demonstrated that information about the interplay of the processes of gene duplication, domain shuffling, and sequence divergence lies hidden in the local structure of the sequence similarity network. This success suggests that mining network structures is a promising direction for extending bioinformatics methodology, as well as for asking basic questions about evolutionary processes. For example, it has been argued that the increased complexity of multidomain families in metazoans is directly related to the advent of multicellular animals. Multicellularity has evolved several times (<xref ref-type="bibr" rid="pcbi.1000063-Kaiser1">[73]</xref> and work cited therein). In each case, Nature has had to evolve novel solutions to the problems of coordinated cellular communication and control. It is an intriguing question whether the same patterns of gene duplication and domain insertion that prompted the evolution of metazoan signal transduction families also dominate in other lineages. Future work will determine whether we can further exploit local organization of the sequence similarity network to investigate such questions.</p></sec></sec><sec id="s4"><title>Methods</title><sec id="s4a"><title>Data</title><p>We extracted all complete mouse and human protein sequences from SwissProt Version 50.9 <xref ref-type="bibr" rid="pcbi.1000063-Bairoch1">[74]</xref>, yielding 11,553 mouse protein sequences and 14,644 human protein sequences. Sequence fragments were excluded from this set of sequences by rejecting sequences annotated with a description field containing “(fragment”. We chose SwissProt, a high quality, curated protein sequence database, as opposed to GenBank, which would have resulted in a larger, but less reliable, dataset. KOG annotations were obtained from the Clusters of Orthologous Groups database <xref ref-type="bibr" rid="pcbi.1000063-Tatusov1">[40]</xref>, available from <ext-link ext-link-type="uri" xlink:href="ftp://ftp.ncbi.nih.gov/pub/COG/KOG/" xlink:type="simple">ftp://ftp.ncbi.nih.gov/pub/COG/KOG/</ext-link>. KOG annotations were mapped to SwissProt identifiers by exact matching of KOG FASTA protein sequences with those in SwissProt.</p><p>The analysis was carried out on the combined set of mouse and human sequences. In a preliminary study, we compared the performance of Neighborhood Correlation on a smaller, combined set of mouse and human sequences with its performance on separate sets of mouse and human sequences <xref ref-type="bibr" rid="pcbi.1000063-Song2">[75]</xref> to determine whether Neighborhood Correlation performs differently on comparisons within and across genomes. The mouse-only and human-only data test the ability to classify paralogs within a single mammalian species, as opposed to the combination of orthologs and paralogs seen in the combined dataset. The basic trends in the mouse-only and human-only datasets were the same as the combined dataset for all tests performed. This suggests that Neighborhood Correlation performance is not highly sensitive to the degree of sequence divergence, since paralogous and orthologous sequences in these species exhibit different patterns of divergence.</p></sec><sec id="s4b"><title>Family Identification</title><p>For each family, we derived a list of designated gene symbols, Pfam <xref ref-type="bibr" rid="pcbi.1000063-Finn1">[41]</xref> and/or InterPro <xref ref-type="bibr" rid="pcbi.1000063-Mulder1">[76]</xref> codes from publications by family experts, and reports from the Human Genome Nomenclature Committee (<ext-link ext-link-type="uri" xlink:href="http://www.gene.ucl.ac.uk/nomenclature/genefamily.html" xlink:type="simple">http://www.gene.ucl.ac.uk/nomenclature/genefamily.html</ext-link>). These lists were used to generate a preliminary roster for each family, then confirmed by referring to recent analyses of gene family evolution in the literature. A detailed account of the curation procedure for each family with specific identification criteria and references is given in <xref ref-type="supplementary-material" rid="pcbi.1000063.s008">Text S1</xref>. SwissProt accession numbers for all sequences in the twenty families are provided in <xref ref-type="supplementary-material" rid="pcbi.1000063.s007">Dataset S1</xref>.</p></sec><sec id="s4c"><title>Sequence Comparison</title><p>We conducted all-against-all BLAST (Version 2.2.15) <xref ref-type="bibr" rid="pcbi.1000063-Altschul2">[61]</xref> and PSI-BLAST (Version 2.2.16) <xref ref-type="bibr" rid="pcbi.1000063-Altschul1">[58]</xref> searches for the sequences in our dataset, using the BLOSUM 62 matrix, an affine gap penalty of −<italic>(11+k)</italic> for a gap of length <italic>k</italic>, and low complexity filtering. For both searches, the size of the search space was set to <italic>Y = n</italic><sup>2</sup> and the significance threshold to <italic>E = 10N</italic>, where <italic>n</italic> is the size of the database in residues and <italic>N</italic> is the number of sequences in the dataset.</p><p>The combined dataset has <italic>N = </italic>26,197 sequences, 11,553 mouse and 14,644 human sequences, corresponding to a total of <italic>n = </italic>14,073,417 residues. For PSI-BLAST, four passes were executed with an inclusion threshold of <italic>E</italic>&lt;10<sup>−13</sup> for inclusion in the multiple alignment used to search in the next pass. Although this cutoff is much more stringent than the default, we found it essential to obtain correct results with sequences containing low complexity regions. Less stringent thresholds resulted in the inclusion of unrelated sequences in the intermediate PSSM. Asymmetries (i.e., <italic>E</italic>(<italic>x</italic>,<italic>y</italic>)≠<italic>E</italic>(<italic>y</italic>,<italic>x</italic>)) that occur due to low complexity filtering <xref ref-type="bibr" rid="pcbi.1000063-Wootton1">[77]</xref>, which is applied only to the query sequence but not to database sequences, were corrected by assigning the better of the two values to both matrix entries. The resulting dataset had 4,864,226 significant BLAST pairs and 10,854,626 significant PSI-BLAST pairs.</p><p>The parameter values used in this study embody the view that an all-against-all BLAST search is a single experiment. This approach is roughly equivalent to conducting <italic>N</italic> single query BLAST searches with <italic>E = </italic>10 and <italic>Y = m<sub>x</sub> n</italic>, where <italic>m<sub>x</sub></italic> is the length of query sequence <italic>x</italic>. Treating the all-against-all BLAST comparison as a single experiment results in symmetric E-values in the absence of low complexity filtering. We define <italic>θ</italic>(<italic>x</italic>,<italic>y</italic>) = <italic>E</italic>(<italic>x</italic>,<italic>y</italic>)/10<italic>N</italic> to be the expected number of chance hits per sequence in the dataset with a score equivalent to, or better than, that of the alignment of query sequence <italic>x</italic> with matching sequence <italic>y</italic>. The significance threshold of <italic>E = </italic>10<italic>N</italic> corresponds to <italic>θ</italic> = 10 chance hits per sequence, in expectation.</p></sec><sec id="s4d"><title>Neighborhood Correlation Score Calculation</title><p>We calculated the Neighborhood Correlation scores for all sequence pairs in our dataset from Equation 1 using the similarity score,<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000063.e003" xlink:type="simple"/><label>(2)</label></disp-formula>where ς(<italic>x</italic>,<italic>i</italic>) is the normalized bit score <xref ref-type="bibr" rid="pcbi.1000063-Altschul1">[58]</xref> of the alignment of <italic>x</italic> and <italic>i</italic> and ς<italic><sub>min</sub></italic>(<italic>x</italic>,<italic>i</italic>) = log<sub>2</sub>(<italic>n</italic><sup>2</sup>/10<italic>N</italic>)*0.95 = 28.019, which is 5% less than the bit score corresponding to <italic>θ</italic> = 10 for a dataset of the size used in this study.</p><p>The effectiveness of Neighborhood Correlation depends strongly on how the similarity score, <italic>S(x, i)</italic>, is defined. We considered three measures of similarity: <italic>S</italic>(<italic>x</italic>,<italic>i</italic>) = log ς(<italic>x</italic>,<italic>i</italic>), <italic>S</italic>(<italic>x</italic>,<italic>i</italic>) = ς(<italic>x</italic>,<italic>i</italic>) and an unweighted comparison of neighborhood membership defined as <italic>S</italic>(<italic>x</italic>,<italic>i</italic>) = 1 if there is a significant match between <italic>x</italic> and <italic>i</italic>, and zero otherwise. Although the other two measures performed well on some families, only <italic>S</italic>(<italic>x</italic>,<italic>i</italic>) = log ς(<italic>x</italic>,<italic>i</italic>) gave consistent, good performance on a wide range of families. This suggests two factors that may be important to Neighborhood Correlation performance. First, the relatively poor performance of the unweighted score indicates that it is necessary to capture differences in the degree of similarity to sequences in the neighborhood to capture complete evolutionary information. Second, the improved performance obtained with <italic>S</italic>(<italic>x</italic>,<italic>i</italic>) = log ς(<italic>x</italic>,<italic>i</italic>) can be understood by recalling that the correlation coefficient captures only linear associations. The use of the logarithm compresses the range of ς(.,.), resulting in scores that more closely approximate linearity.</p><p>The choice of ς<italic><sub>min</sub></italic>, the score assigned to pairs without significant similarity, may influence Neighborhood Correlation performance in homology identification. We experimented with values of ς<italic><sub>min</sub></italic> corresponding to significance thresholds ranging over two orders of magnitude. The results (data not shown) suggest that varying ς<italic><sub>min</sub></italic> has little impact on Neighborhood Correlation.</p></sec><sec id="s4e"><title>Promiscuity and Sequence Identity</title><p>Promiscuity refers to the tendency of domains to be inserted into many different contexts. Typically, promiscuity of a domain is defined as the number of distinct partners associated with it, where two domains are <italic>partners</italic> if they co-occur in at least one sequence <xref ref-type="bibr" rid="pcbi.1000063-Marcotte1">[3]</xref>. We obtained the set of Pfam codes associated with all sequences in our dataset from the SwissProt database. For each Pfam domain, we determined the number of distinct Pfam codes that co-occur with it in any of the 26,197 sequences in our dataset.</p><p>We further obtained percent sequence identity for each Pfam identifier from the Pfam website. The Spearman ranked correlation coefficient of domain promiscuity and sequence identity was calculated to evaluate whether promiscuity and sequence identity were related.</p></sec><sec id="s4f"><title>Domain Architecture Comparison</title><p>We conducted an all-against-all domain architecture comparison using the Pfam identifiers provided by SwissProt. Similarity of each pair of sequences, <italic>x</italic> and <italic>y</italic> were calculated as follows:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000063.e004" xlink:type="simple"/><label>(3)</label></disp-formula>where <italic>w</italic>(<italic>d<sub>i</sub></italic>,<italic>x</italic>) is the weight of domain <italic>d<sub>i</sub></italic> in sequence <italic>x</italic>. Domains are assigned weights inversely proportional to their promiscuity. Promiscuous domains may occur in many unrelated sequences, and so are less useful than relatively rare domains in determining homology. The weight of a domain not contained in a given sequence is zero. As a result, pairs of sequences which share no domains are assigned a similarity of zero. This domain architecture comparison function corrects for the bias of proteins with many domains. Proteins with numerous domains have an elevated probability of sharing a domain with other proteins. Of the 21 domain architecture comparison methods we evaluated in a previous study <xref ref-type="bibr" rid="pcbi.1000063-Song1">[23]</xref>, this was shown to have the best performance.</p></sec><sec id="s4g"><title>Alignment Coverage</title><p>For every pair of sequences, <italic>x</italic> and <italic>y</italic>, with significant similarity, we calculated the alignment coverage, defined as <italic>α</italic>(<italic>x</italic>,<italic>y</italic>) = 2<italic>l<sub>a</sub></italic>/(<italic>l<sub>x</sub></italic>+<italic>l<sub>y</sub></italic>), where <italic>l<sub>x</sub></italic> and <italic>l<sub>y</sub></italic> are the length of sequences <italic>x</italic> and <italic>y</italic>, and <italic>l<sub>a</sub></italic> is the length of the optimal local alignment, define to be the number of columns needed to represent it; that is, it includes gapped positions. The length of the optimal alignment between query <italic>x</italic> and match <italic>y</italic> will not, in general, be the same as the length of the optimal alignment between query <italic>y</italic> and match <italic>x</italic>. We forced the alignment coverage to be symmetric by setting both <italic>α</italic>(<italic>x</italic>,<italic>y</italic>) and <italic>α</italic>(<italic>y</italic>,<italic>x</italic>) to the maximum of the two values.</p><p>By considering only the optimal alignment, we risk underestimating the extent of similarity between homologous sequences. To take suboptimal alignments into account, we used a simple heuristic method for selecting a set of high-scoring local alignments that do not conflict. Two alignments conflict if they overlap or do not appear in the same order in both sequences (see <xref ref-type="supplementary-material" rid="pcbi.1000063.s008">Text S1</xref>).</p></sec><sec id="s4h"><title>Validation</title><p>Classifier performance was evaluated using Receiver Operating Characteristic (<italic>ROC</italic>), which captures the tradeoff between sensitivity (<italic>S<sub>n</sub></italic>) and specificity (<italic>S<sub>p</sub></italic>) as a function of the classifier threshold. A <italic>ROC</italic> curve is a plot of <italic>S<sub>n</sub></italic> as a function of 1−<italic>S<sub>p</sub></italic>, where <italic>S<sub>n</sub></italic> = <italic>TP</italic>/(<italic>TP</italic>+<italic>FN</italic>) and <italic>S<sub>p</sub></italic> = <italic>TN</italic>/(<italic>TN</italic>+<italic>FP</italic>). <italic>TP</italic>, <italic>FP</italic>, <italic>TN</italic>, and <italic>FN</italic> refer to the number of True Positives, False Positives, True Negatives, and False Negatives, respectively. In the context of our test, <italic>TP</italic> is the number of sequence pairs that have common ancestry and have been correctly identified by the classifier. <italic>FP</italic> represents the number of pairs that are classified as homologs, but are not family pairs. <italic>TN</italic> and <italic>FN</italic> refer to the number of non-homologous pairs that are correctly ruled out and incorrectly included, respectively.</p><p>The area under the <italic>ROC</italic> curve provides a single measure of classification accuracy, corresponding to the fraction of correctly classified entities given the best possible choice of threshold. We used the <italic>ROC-n</italic> score, defined to be the area under the <italic>ROC</italic> curve truncated after the first <italic>n</italic> false positives or<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000063.e005" xlink:type="simple"/><label>(4)</label></disp-formula>where <italic>t<sub>i</sub></italic> is the number of FF pairs observed before the <italic>i<sup>th</sup></italic> FO pair and <italic>T</italic> is the total number of FF pairs in the dataset. When the number of negative examples far exceeds the number of positive examples, as is the case here, the <italic>ROC</italic> score approaches one, resulting in an unjustifiably optimistic assessment of classifier performance. <italic>R<sub>n</sub></italic> is a more sensitive figure of merit than the untruncated <italic>ROC</italic> score in this case <xref ref-type="bibr" rid="pcbi.1000063-Gribskov1">[78]</xref>. We selected <italic>n</italic> = 100<italic>k</italic>, where <italic>k</italic> is the number of FF pairs. This is equivalent to 100 false positives per query. We found that 100<italic>k</italic> was sufficiently large so that few FF pairs were missed in most tests but not so large so as to obscure the differences in performance between classifiers.</p><p>The statistical significance of the difference between the <italic>ROC-n</italic> scores obtained by Neighborhood Correlation and sequence similarity was estimated using p-values calculated using the method described in Schaffer <italic>et al.</italic> <xref ref-type="bibr" rid="pcbi.1000063-Schaffer1">[62]</xref>. This method tests the null hypothesis that the difference in <italic>ROC-n</italic> scores is due the sampling process used to obtain the test data. Rejection of the null hypothesis indicates that the difference in <italic>ROC-n</italic> scores represents a true difference in the performance of the classifiers.</p><p>Precision and Recall are also used for evaluation. In the context of our test, Recall denotes the fraction of homologous pairs retrieved and is equivalent to sensitivity. Precision refers to the fraction of protein pairs retrieved that are actually homologous pairs.</p></sec><sec id="s4i"><title>Supporting Information on Our Website</title><p><ext-link ext-link-type="uri" xlink:href="http://www.neighborhoodcorrelation.org" xlink:type="simple">http://www.neighborhoodcorrelation.org</ext-link></p><list list-type="bullet"><list-item><p>FASTA sequences for all 26,197 human and mouse sequences used in our study.</p></list-item><list-item><p>The complete set of sequences in each family of our manually curated benchmark.</p></list-item><list-item><p>A list of Pfam annotations for each sequence used in our study.</p></list-item><list-item><p>The complete set of NC scores for all sequence pairs.</p></list-item><list-item><p>Novel predictions of mouse and human homologs using our method (<italic>NC</italic>≥0.6).</p></list-item></list></sec><sec id="s4j"><title>Accession Numbers</title><p>The accession numbers used in this paper are from Swiss Prot (<ext-link ext-link-type="uri" xlink:href="http://www.ebi.ac.uk/swissprot" xlink:type="simple">http://www.ebi.ac.uk/swissprot</ext-link>): human <italic>PDGFRG</italic> (P09619), human <italic>PRKG1B</italic> (P14619), and mouse <italic>NCAM2</italic> (O35136). Accession numbers for all 1577 sequences in the twenty families in our benchmark are given in <xref ref-type="supplementary-material" rid="pcbi.1000063.s007">Dataset S1</xref>.</p></sec></sec><sec id="s5"><title>Supporting Information</title><supplementary-material id="pcbi.1000063.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000063.s001" xlink:type="simple"><label>Figure S1</label><caption><p>ROC-100k curves for all families. ROC-100k curves of Neighborhood Correlation (blue), PSI-BLAST (magenta), DAC (purple), and BLAST sequence similarity with alignment coverage thresholds of <italic>α</italic>≥0.0 (red), <italic>α</italic>≥0.3 (green), <italic>α</italic>≥0.6 (yellow), and <italic>α</italic>≥0.8 (orange) for all families.</p><p>(0.15 MB PDF)</p></caption></supplementary-material><supplementary-material id="pcbi.1000063.s002" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000063.s002" xlink:type="simple"><label>Figure S2</label><caption><p>Distributions of BLAST and NC scores for all families. (FF: blue, FO: red).</p><p>(0.04 MB PDF)</p></caption></supplementary-material><supplementary-material id="pcbi.1000063.s003" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000063.s003" xlink:type="simple"><label>Figure S3</label><caption><p>Distribution of Neighborhood Correlation scores for all sequence pairs.</p><p>(0.00 MB PDF)</p></caption></supplementary-material><supplementary-material id="pcbi.1000063.s004" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000063.s004" xlink:type="simple"><label>Figure S4</label><caption><p>Distributions of alignment coverage for all families. Distributions of alignment coverage calculated with the optimal alignment length only (FF: blue, FO: red) and with combined non-conflicting alignments (FF: turquoise, FO: brown) for all families.</p><p>(0.03 MB PDF)</p></caption></supplementary-material><supplementary-material id="pcbi.1000063.s005" mimetype="application/msword" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000063.s005" xlink:type="simple"><label>Table S1</label><caption><p>Precision and Recall for predictions using simple alignment coverage thresholds of 0.3, 0.6, and 0.8 for all families.</p><p>(0.07 MB DOC)</p></caption></supplementary-material><supplementary-material id="pcbi.1000063.s006" mimetype="application/msword" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000063.s006" xlink:type="simple"><label>Table S2</label><caption><p>Precision and recall for predictions using combined alignment coverage thresholds of 0.3, 0.6, and 0.8 for all families.</p><p>(0.07 MB DOC)</p></caption></supplementary-material><supplementary-material id="pcbi.1000063.s007" mimetype="application/tds" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000063.s007" xlink:type="simple"><label>Dataset S1</label><caption><p>Curated Benchmark.</p><p>(0.02 MB TDS)</p></caption></supplementary-material><supplementary-material id="pcbi.1000063.s008" mimetype="application/msword" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000063.s008" xlink:type="simple"><label>Text S1</label><caption><p>Supporting Text.</p><p>(0.09 MB DOC)</p></caption></supplementary-material></sec></body><back><ack><p>We thank S. F. Altschul for helpful discussions, especially on PSI-BLAST and on the theoretical aspects of alignment coverage; S. H. Bryant and L. Y. Geer for helpful discussions and for providing the domain architecture models used in preliminary analysis; R. A. Hoberman and A. W. Moore for suggestions on the scoring function; and J. A. Lopez for detailed comments on the manuscript. We are especially grateful to the late W. E. Brown for his guidance throughout.</p></ack><ref-list><title>References</title><ref id="pcbi.1000063-Wu1"><label>1</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Wu</surname><given-names>C</given-names></name><name name-style="western"><surname>Huang</surname><given-names>H</given-names></name><name name-style="western"><surname>Yeh</surname><given-names>L</given-names></name><name name-style="western"><surname>Barker</surname><given-names>W</given-names></name></person-group>             <year>2003</year>             <article-title>Protein family classification and functional annotation.</article-title>             <source>Comput Biol Chem</source>             <volume>27</volume>             <fpage>37</fpage>             <lpage>47</lpage>          </element-citation></ref><ref id="pcbi.1000063-Pellegrini1"><label>2</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Pellegrini</surname><given-names>M</given-names></name><name name-style="western"><surname>Marcotte</surname><given-names>E</given-names></name><name name-style="western"><surname>Thompson</surname><given-names>M</given-names></name><name name-style="western"><surname>Eisenberg</surname><given-names>D</given-names></name><name name-style="western"><surname>Yeates</surname><given-names>T</given-names></name></person-group>             <year>1999</year>             <article-title>Assigning protein functions by comparative genome analysis: protein phylogenetic profiles.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>96</volume>             <fpage>4285</fpage>             <lpage>4288</lpage>          </element-citation></ref><ref id="pcbi.1000063-Marcotte1"><label>3</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Marcotte</surname><given-names>E</given-names></name><name name-style="western"><surname>Pellegrini</surname><given-names>M</given-names></name><name name-style="western"><surname>Ng</surname><given-names>H</given-names></name><name name-style="western"><surname>Rice</surname><given-names>D</given-names></name><name name-style="western"><surname>Yeates</surname><given-names>T</given-names></name><etal/></person-group>             <year>1999</year>             <article-title>Detecting protein function and protein–protein interactions from genome sequences.</article-title>             <source>Science</source>             <volume>285</volume>             <fpage>751</fpage>             <lpage>753</lpage>          </element-citation></ref><ref id="pcbi.1000063-Enright1"><label>4</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Enright</surname><given-names>A</given-names></name><name name-style="western"><surname>Iliopoulos</surname><given-names>I</given-names></name><name name-style="western"><surname>Kyrpides</surname><given-names>N</given-names></name><name name-style="western"><surname>Ouzounis</surname><given-names>C</given-names></name></person-group>             <year>1999</year>             <article-title>Protein interaction maps for complete genomes based on gene fusion events.</article-title>             <source>Nature</source>             <volume>402</volume>             <fpage>86</fpage>             <lpage>90</lpage>          </element-citation></ref><ref id="pcbi.1000063-Brown1"><label>5</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Brown</surname><given-names>D</given-names></name><name name-style="western"><surname>Sjolander</surname><given-names>K</given-names></name></person-group>             <year>2006</year>             <article-title>Functional classification using phylogenomic inference.</article-title>             <source>PLoS Comput Biol</source>             <volume>2</volume>             <fpage>479</fpage>             <lpage>483</lpage><comment>doi:10.1371/journal.pcbi.0020077</comment>          </element-citation></ref><ref id="pcbi.1000063-Overbeek1"><label>6</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Overbeek</surname><given-names>R</given-names></name><name name-style="western"><surname>Fonstein</surname><given-names>M</given-names></name><name name-style="western"><surname>D'Souza</surname><given-names>M</given-names></name><name name-style="western"><surname>Pusch</surname><given-names>G</given-names></name><name name-style="western"><surname>Maltsev</surname><given-names>N</given-names></name></person-group>             <year>1999</year>             <article-title>The use of gene clusters to infer functional coupling.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>96</volume>             <fpage>2896</fpage>             <lpage>2901</lpage>          </element-citation></ref><ref id="pcbi.1000063-Dandekar1"><label>7</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Dandekar</surname><given-names>T</given-names></name><name name-style="western"><surname>Snel</surname><given-names>B</given-names></name><name name-style="western"><surname>Huynen</surname><given-names>M</given-names></name><name name-style="western"><surname>Bork</surname><given-names>P</given-names></name></person-group>             <year>1998</year>             <article-title>Conservation of gene order: a fingerprint of proteins that physically interact.</article-title>             <source>Trends Biochem Sci</source>             <volume>23</volume>             <fpage>324</fpage>             <lpage>328</lpage>          </element-citation></ref><ref id="pcbi.1000063-Nadeau1"><label>8</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Nadeau</surname><given-names>J</given-names></name><name name-style="western"><surname>Sankoff</surname><given-names>D</given-names></name></person-group>             <year>1998</year>             <article-title>Counting on comparative maps.</article-title>             <source>Trends Genet</source>             <volume>14</volume>             <fpage>495</fpage>             <lpage>501</lpage>          </element-citation></ref><ref id="pcbi.1000063-OBrien1"><label>9</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>O'Brien</surname><given-names>S</given-names></name><name name-style="western"><surname>Wienberg</surname><given-names>J</given-names></name><name name-style="western"><surname>Lyons</surname><given-names>L</given-names></name></person-group>             <year>1997</year>             <article-title>Comparative genomics: lessons from cats.</article-title>             <source>Trends Genet</source>             <volume>10</volume>             <fpage>393</fpage>             <lpage>399</lpage>          </element-citation></ref><ref id="pcbi.1000063-Durand1"><label>10</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Durand</surname><given-names>D</given-names></name><name name-style="western"><surname>Hoberman</surname><given-names>R</given-names></name></person-group>             <year>2006</year>             <article-title>Diagnosing duplications: can it be done?</article-title>             <source>Trends Genet</source>             <volume>22</volume>             <fpage>156</fpage>             <lpage>64</lpage>          </element-citation></ref><ref id="pcbi.1000063-VandePeer1"><label>11</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Van de Peer</surname><given-names>Y</given-names></name></person-group>             <year>2004</year>             <article-title>Computational approaches to unveiling ancient genome duplications.</article-title>             <source>Nat Rev Genet</source>             <volume>5</volume>             <fpage>752</fpage>             <lpage>763</lpage>          </element-citation></ref><ref id="pcbi.1000063-Dickmeis1"><label>12</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Dickmeis</surname><given-names>T</given-names></name><name name-style="western"><surname>Muller</surname><given-names>F</given-names></name></person-group>             <year>2005</year>             <article-title>The identification and functional characterisation of conserved regulatory elements in developmental genes.</article-title>             <source>Brief Funct Genomic Proteomic</source>             <volume>3</volume>             <fpage>332</fpage>             <lpage>350</lpage>          </element-citation></ref><ref id="pcbi.1000063-Chen1"><label>13</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Chen</surname><given-names>X</given-names></name><name name-style="western"><surname>Su</surname><given-names>Z</given-names></name><name name-style="western"><surname>Dam</surname><given-names>P</given-names></name><name name-style="western"><surname>Palenik</surname><given-names>B</given-names></name><name name-style="western"><surname>Xu</surname><given-names>Y</given-names></name><etal/></person-group>             <year>2004</year>             <article-title>Operon prediction by comparative genomics: an application to the <italic>Synechococcus</italic> sp. WH8102 genome.</article-title>             <source>Nucleic Acids Res</source>             <volume>32</volume>             <fpage>2147</fpage>             <lpage>2157</lpage>          </element-citation></ref><ref id="pcbi.1000063-Price1"><label>14</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Price</surname><given-names>M</given-names></name><name name-style="western"><surname>Huang</surname><given-names>K</given-names></name><name name-style="western"><surname>Alm</surname><given-names>E</given-names></name><name name-style="western"><surname>Arkin</surname><given-names>A</given-names></name></person-group>             <year>2005</year>             <article-title>A novel method for accurate operon predictions in all sequenced prokaryotes.</article-title>             <source>Nucleic Acids Res</source>             <volume>33</volume>             <fpage>880</fpage>             <lpage>892</lpage>          </element-citation></ref><ref id="pcbi.1000063-Westover1"><label>15</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Westover</surname><given-names>B</given-names></name><name name-style="western"><surname>Buhler</surname><given-names>J</given-names></name><name name-style="western"><surname>Sonnenburg</surname><given-names>J</given-names></name><name name-style="western"><surname>Gordon</surname><given-names>J</given-names></name></person-group>             <year>2005</year>             <article-title>Operon prediction without a training set.</article-title>             <source>Bioinformatics</source>             <volume>21</volume>             <fpage>880</fpage>             <lpage>888</lpage>          </element-citation></ref><ref id="pcbi.1000063-Redfern1"><label>16</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Redfern</surname><given-names>O</given-names></name><name name-style="western"><surname>Grant</surname><given-names>A</given-names></name><name name-style="western"><surname>Maibaum</surname><given-names>M</given-names></name><name name-style="western"><surname>Orengo</surname><given-names>C</given-names></name></person-group>             <year>2005</year>             <article-title>Survey of current protein family databases and their application in comparative, structural and functional genomics.</article-title>             <source>J Chromatogr B Analyt Technol Biomed Life Sci</source>             <volume>815</volume>             <fpage>97</fpage>             <lpage>107</lpage>          </element-citation></ref><ref id="pcbi.1000063-Tordai1"><label>17</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Tordai</surname><given-names>H</given-names></name><name name-style="western"><surname>Nagy</surname><given-names>A</given-names></name><name name-style="western"><surname>Farkas</surname><given-names>K</given-names></name><name name-style="western"><surname>Banyai</surname><given-names>L</given-names></name><name name-style="western"><surname>Patthy</surname><given-names>L</given-names></name></person-group>             <year>2005</year>             <article-title>Modules, multidomain proteins and organismic complexity.</article-title>             <source>FEBS J</source>             <volume>272</volume>             <fpage>5064</fpage>             <lpage>5078</lpage>          </element-citation></ref><ref id="pcbi.1000063-Fitch1"><label>18</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Fitch</surname><given-names>W</given-names></name></person-group>             <year>1970</year>             <article-title>Distinguishing homologous from analogous proteins.</article-title>             <source>Syst Zool</source>             <volume>19</volume>             <fpage>99</fpage>             <lpage>113</lpage>          </element-citation></ref><ref id="pcbi.1000063-Robinson1"><label>19</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Robinson</surname><given-names>D</given-names></name><name name-style="western"><surname>Wu</surname><given-names>Y</given-names></name><name name-style="western"><surname>Lin</surname><given-names>S</given-names></name></person-group>             <year>2000</year>             <article-title>The protein tyrosine kinase family of the human genome.</article-title>             <source>Oncogene</source>             <volume>19</volume>             <fpage>5548</fpage>             <lpage>5557</lpage>          </element-citation></ref><ref id="pcbi.1000063-Hanks1"><label>20</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Hanks</surname><given-names>S</given-names></name></person-group>             <year>2003</year>             <article-title>Genomic analysis of the eukaryotic protein kinase superfamily: a perspective.</article-title>             <source>Genome Biol</source>             <volume>4</volume>             <fpage>111</fpage>          </element-citation></ref><ref id="pcbi.1000063-Cheek1"><label>21</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Cheek</surname><given-names>S</given-names></name><name name-style="western"><surname>Zhang</surname><given-names>H</given-names></name><name name-style="western"><surname>Grishin</surname><given-names>N</given-names></name></person-group>             <year>2002</year>             <article-title>Sequence and structure classification of kinases.</article-title>             <source>J Mol Biol</source>             <volume>320</volume>             <fpage>855</fpage>             <lpage>881</lpage>          </element-citation></ref><ref id="pcbi.1000063-Scheeff1"><label>22</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Scheeff</surname><given-names>ED</given-names></name><name name-style="western"><surname>Bourne</surname><given-names>PE</given-names></name></person-group>             <year>2005</year>             <article-title>Structural evolution of the protein kinase-like superfamily.</article-title>             <source>PLoS Comput Biol</source>             <volume>1</volume>             <fpage>e49</fpage><comment>doi:10.1371/journal.pcbi.0010049</comment>          </element-citation></ref><ref id="pcbi.1000063-Song1"><label>23</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Song</surname><given-names>N</given-names></name><name name-style="western"><surname>Sedgewick</surname><given-names>RD</given-names></name><name name-style="western"><surname>Durand</surname><given-names>D</given-names></name></person-group>             <year>2007</year>             <article-title>Domain architecture comparison for multidomain homology identification.</article-title>             <source>J Comput Biol</source>             <volume>14</volume>             <fpage>496</fpage>             <lpage>516</lpage>          </element-citation></ref><ref id="pcbi.1000063-Bjorklund1"><label>24</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Bjorklund</surname><given-names>A</given-names></name><name name-style="western"><surname>Ekman</surname><given-names>D</given-names></name><name name-style="western"><surname>Light</surname><given-names>S</given-names></name><name name-style="western"><surname>Frey-Skott</surname><given-names>J</given-names></name><name name-style="western"><surname>Elofsson</surname><given-names>A</given-names></name></person-group>             <year>2005</year>             <article-title>Domain rearrangements in protein evolution.</article-title>             <source>J Mol Biol</source>             <volume>353</volume>             <fpage>911</fpage>             <lpage>923</lpage>          </element-citation></ref><ref id="pcbi.1000063-Geer1"><label>25</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Geer</surname><given-names>L</given-names></name><name name-style="western"><surname>Domrachev</surname><given-names>M</given-names></name><name name-style="western"><surname>Lipman</surname><given-names>D</given-names></name><name name-style="western"><surname>Bryant</surname><given-names>S</given-names></name></person-group>             <year>2002</year>             <article-title>CDART: protein homology by domain architecture.</article-title>             <source>Genome Res</source>             <volume>12</volume>             <fpage>1619</fpage>             <lpage>1623</lpage>          </element-citation></ref><ref id="pcbi.1000063-Lin1"><label>26</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Lin</surname><given-names>K</given-names></name><name name-style="western"><surname>Zhu</surname><given-names>L</given-names></name><name name-style="western"><surname>Zhang</surname><given-names>D</given-names></name></person-group>             <year>2006</year>             <article-title>An initial strategy for comparing proteins at the domain architecture level.</article-title>             <source>Bioinformatics</source>             <volume>22</volume>             <fpage>2081</fpage>             <lpage>2086</lpage>          </element-citation></ref><ref id="pcbi.1000063-Huynen1"><label>27</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Huynen</surname><given-names>M</given-names></name><name name-style="western"><surname>Bork</surname><given-names>P</given-names></name></person-group>             <year>1998</year>             <article-title>Measuring genome evolution.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>95</volume>             <fpage>5849</fpage>             <lpage>5856</lpage>          </element-citation></ref><ref id="pcbi.1000063-Blin1"><label>28</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Blin</surname><given-names>G</given-names></name><name name-style="western"><surname>Chauve</surname><given-names>C</given-names></name><name name-style="western"><surname>Fertin</surname><given-names>G</given-names></name></person-group>             <year>2005</year>             <article-title>Gene order and phylogenetic reconstruction: application to gamma-Proteobacteria.</article-title>             <person-group person-group-type="editor"><name name-style="western"><surname>McLysaght</surname><given-names>A</given-names></name><name name-style="western"><surname>Huson</surname><given-names>DH</given-names></name></person-group>             <source>RECOMB Workshop on Comparative Genomics</source>             <publisher-loc>Berlin Heidelberg</publisher-loc>             <publisher-name>Springer Verlag, volume 3678 of Lecture Notes in Bioinformatics</publisher-name>             <fpage>11</fpage>             <lpage>20</lpage>          </element-citation></ref><ref id="pcbi.1000063-Fu1"><label>29</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Fu</surname><given-names>Z</given-names></name><name name-style="western"><surname>Chen</surname><given-names>X</given-names></name><name name-style="western"><surname>Vacic</surname><given-names>V</given-names></name><name name-style="western"><surname>Nan</surname><given-names>P</given-names></name><name name-style="western"><surname>Yong</surname><given-names>Y</given-names></name><etal/></person-group>             <year>2006</year>             <article-title>A parsimony approach to genome-wide orthology assignment.</article-title>             <source>RECOMB 2006</source>             <publisher-loc>Berlin Heidelberg</publisher-loc>             <publisher-name>Springer Verlag, volume 3909 of Lecture Notes in Bioinformatics</publisher-name>             <fpage>578</fpage>             <lpage>594</lpage>          </element-citation></ref><ref id="pcbi.1000063-Chen2"><label>30</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Chen</surname><given-names>X</given-names></name><name name-style="western"><surname>Zheng</surname><given-names>J</given-names></name><name name-style="western"><surname>Fu</surname><given-names>Z</given-names></name><name name-style="western"><surname>Nan</surname><given-names>P</given-names></name><name name-style="western"><surname>Zhong</surname><given-names>Y</given-names></name><etal/></person-group>             <year>2005</year>             <article-title>Assignment of orthologous genes via genome rearrangement.</article-title>             <source>IEEE/ACM Transactions on Computational Biology and Bioinformatics</source>             <volume>2</volume>             <fpage>302</fpage>             <lpage>315</lpage>          </element-citation></ref><ref id="pcbi.1000063-Hirsh1"><label>31</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Hirsh</surname><given-names>A</given-names></name><name name-style="western"><surname>Fraser</surname><given-names>H</given-names></name></person-group>             <year>2001</year>             <article-title>Protein dispensability and rate of evolution.</article-title>             <source>Nature</source>             <volume>411</volume>             <fpage>1046</fpage>             <lpage>1049</lpage>          </element-citation></ref><ref id="pcbi.1000063-McLysaght1"><label>32</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>McLysaght</surname><given-names>A</given-names></name><name name-style="western"><surname>Hokamp</surname><given-names>K</given-names></name><name name-style="western"><surname>Wolfe</surname><given-names>K</given-names></name></person-group>             <year>2002</year>             <article-title>Extensive genomic duplication during early chordate evolution.</article-title>             <source>Nat Genet</source>             <volume>31</volume>             <fpage>200</fpage>             <lpage>204</lpage>          </element-citation></ref><ref id="pcbi.1000063-Blanc1"><label>33</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Blanc</surname><given-names>G</given-names></name><name name-style="western"><surname>Hokamp</surname><given-names>K</given-names></name><name name-style="western"><surname>Wolfe</surname><given-names>K</given-names></name></person-group>             <year>2003</year>             <article-title>A recent polyploidy superimposed on older large-scale duplications in the <italic>Arabidopsis</italic> genome.</article-title>             <source>Genome Res</source>             <volume>13</volume>             <fpage>137</fpage>             <lpage>144</lpage>          </element-citation></ref><ref id="pcbi.1000063-Rubin1"><label>34</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Rubin</surname><given-names>G</given-names></name><name name-style="western"><surname>Yandell</surname><given-names>M</given-names></name><name name-style="western"><surname>Wortman</surname><given-names>J</given-names></name><name name-style="western"><surname>Gabor M</surname><given-names>G</given-names></name><name name-style="western"><surname>Nelson</surname><given-names>C</given-names></name><etal/></person-group>             <year>2000</year>             <article-title>Comparative genomics of the eukaryotes.</article-title>             <source>Science</source>             <volume>287</volume>             <fpage>2204</fpage>             <lpage>2215</lpage>          </element-citation></ref><ref id="pcbi.1000063-Li1"><label>35</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>W</given-names></name><name name-style="western"><surname>Gu</surname><given-names>Z</given-names></name><name name-style="western"><surname>Wang</surname><given-names>H</given-names></name><name name-style="western"><surname>Nekrutenko</surname><given-names>A</given-names></name></person-group>             <year>2001</year>             <article-title>Evolutionary analyses of the human genome.</article-title>             <source>Nature</source>             <volume>409</volume>             <fpage>847</fpage>          </element-citation></ref><ref id="pcbi.1000063-Dehal1"><label>36</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Dehal</surname><given-names>P</given-names></name><name name-style="western"><surname>Satou</surname><given-names>Y</given-names></name><name name-style="western"><surname>Campbell</surname><given-names>R</given-names></name><name name-style="western"><surname>Chapman</surname><given-names>J</given-names></name><name name-style="western"><surname>Degnan</surname><given-names>B</given-names></name><etal/></person-group>             <year>2002</year>             <article-title>The draft genome of <italic>Ciona intestinalis</italic>: Insights into chordate and vertebrate origins.</article-title>             <source>Science</source>             <volume>298</volume>             <fpage>2157</fpage>             <lpage>2167</lpage>          </element-citation></ref><ref id="pcbi.1000063-Remm1"><label>37</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Remm</surname><given-names>M</given-names></name><name name-style="western"><surname>Storm</surname><given-names>C</given-names></name><name name-style="western"><surname>Sonnhammer</surname><given-names>E</given-names></name></person-group>             <year>2001</year>             <article-title>Automatic clustering of orthologs and in-paralogs from pairwise species comparisons.</article-title>             <source>J Mol Biol</source>             <volume>314</volume>             <fpage>1041</fpage>             <lpage>1052</lpage>          </element-citation></ref><ref id="pcbi.1000063-Murzin1"><label>38</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Murzin</surname><given-names>A</given-names></name><name name-style="western"><surname>Brenner</surname><given-names>S</given-names></name><name name-style="western"><surname>Hubbard</surname><given-names>T</given-names></name><name name-style="western"><surname>Chothia</surname><given-names>C</given-names></name></person-group>             <year>1995</year>             <article-title>SCOP: a structural classification of proteins database for the investigation of sequences and structures.</article-title>             <source>J Mol Biol</source>             <volume>247</volume>             <fpage>536</fpage>             <lpage>540</lpage>          </element-citation></ref><ref id="pcbi.1000063-Pearl1"><label>39</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Pearl</surname><given-names>F</given-names></name><name name-style="western"><surname>Bennett</surname><given-names>C</given-names></name><name name-style="western"><surname>Bray</surname><given-names>J</given-names></name><name name-style="western"><surname>Harrison</surname><given-names>A</given-names></name><name name-style="western"><surname>Martin</surname><given-names>N</given-names></name><etal/></person-group>             <year>2003</year>             <article-title>The CATH database: an extended protein family resource for structural and functional genomics.</article-title>             <source>Nucleic Acids Res</source>             <volume>31</volume>             <fpage>452</fpage>             <lpage>455</lpage>          </element-citation></ref><ref id="pcbi.1000063-Tatusov1"><label>40</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Tatusov</surname><given-names>R</given-names></name><name name-style="western"><surname>Fedorova</surname><given-names>N</given-names></name><name name-style="western"><surname>Jackson</surname><given-names>J</given-names></name><name name-style="western"><surname>Jacobs</surname><given-names>A</given-names></name><name name-style="western"><surname>Kiryutin</surname><given-names>B</given-names></name><etal/></person-group>             <year>2003</year>             <article-title>The COG database: an updated version includes eukaryotes.</article-title>             <source>BMC Bioinformatics</source>             <volume>4</volume>             <fpage>41</fpage>          </element-citation></ref><ref id="pcbi.1000063-Finn1"><label>41</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Finn</surname><given-names>RD</given-names></name><name name-style="western"><surname>Mistry</surname><given-names>J</given-names></name><name name-style="western"><surname>Schuster-Bockler</surname><given-names>B</given-names></name><name name-style="western"><surname>Griffiths-Jones</surname><given-names>S</given-names></name><name name-style="western"><surname>Hollich</surname><given-names>V</given-names></name><etal/></person-group>             <year>2006</year>             <article-title>Pfam: clans, web tools and services.</article-title>             <source>Nucleic Acids Res</source>             <volume>34</volume>             <fpage>D247</fpage>             <lpage>D251</lpage>          </element-citation></ref><ref id="pcbi.1000063-Fitch2"><label>42</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Fitch</surname><given-names>W</given-names></name></person-group>             <year>2000</year>             <article-title>Homology: a personal view on some of the problems.</article-title>             <source>Trends Genet</source>             <volume>16</volume>             <fpage>227</fpage>             <lpage>231</lpage>          </element-citation></ref><ref id="pcbi.1000063-Gilbert1"><label>43</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Gilbert</surname><given-names>W</given-names></name></person-group>             <year>1985</year>             <article-title>Genes-in-pieces revisited.</article-title>             <source>Science</source>             <volume>228</volume>             <fpage>823</fpage>             <lpage>824</lpage>          </element-citation></ref><ref id="pcbi.1000063-Hillis1"><label>44</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Hillis</surname><given-names>D</given-names></name></person-group>             <year>1994</year>             <article-title>Homology in molecular biology.</article-title>             <person-group person-group-type="editor"><name name-style="western"><surname>Hall</surname><given-names>BK</given-names></name></person-group>             <source>Homology, the hierarchical basis of comparative biology</source>             <publisher-name>Academic Press</publisher-name>             <fpage>339</fpage>             <lpage>368</lpage>          </element-citation></ref><ref id="pcbi.1000063-Liu1"><label>45</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Liu</surname><given-names>J</given-names></name><name name-style="western"><surname>Rost</surname><given-names>B</given-names></name></person-group>             <year>2003</year>             <article-title>Domains, motifs and clusters in the protein universe.</article-title>             <source>Curr Opin Chem Biol</source>             <volume>7</volume>             <fpage>5</fpage>             <lpage>11</lpage>          </element-citation></ref><ref id="pcbi.1000063-Miyata1"><label>46</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Miyata</surname><given-names>T</given-names></name><name name-style="western"><surname>Suga</surname><given-names>H</given-names></name></person-group>             <year>2001</year>             <article-title>Divergence pattern of animal gene families and relationship with the Cambrian explosion.</article-title>             <source>Bioessays</source>             <volume>23</volume>             <fpage>1018</fpage>             <lpage>1027</lpage>          </element-citation></ref><ref id="pcbi.1000063-BenShlomo1"><label>47</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Ben-Shlomo</surname><given-names>I</given-names></name><name name-style="western"><surname>Yu Hsu</surname><given-names>S</given-names></name><name name-style="western"><surname>Rauch</surname><given-names>R</given-names></name><name name-style="western"><surname>Kowalski</surname><given-names>H</given-names></name><name name-style="western"><surname>Hsueh</surname><given-names>A</given-names></name></person-group>             <year>2003</year>             <article-title>Signaling receptome: a genomic and evolutionary perspective of plasma membrane receptors involved in signal transduction.</article-title>             <source>Sci STKE</source>             <volume>2003</volume>             <fpage>RE9</fpage>          </element-citation></ref><ref id="pcbi.1000063-Marcotte2"><label>48</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Marcotte</surname><given-names>E</given-names></name><name name-style="western"><surname>Pellegrini</surname><given-names>M</given-names></name><name name-style="western"><surname>Thompson</surname><given-names>M</given-names></name><name name-style="western"><surname>Yeates</surname><given-names>T</given-names></name><name name-style="western"><surname>Eisenberg</surname><given-names>D</given-names></name></person-group>             <year>1999</year>             <article-title>A combined algorithm for genome-wide prediction of protein function.</article-title>             <source>Nature</source>             <volume>402</volume>             <fpage>83</fpage>             <lpage>86</lpage>          </element-citation></ref><ref id="pcbi.1000063-Patthy1"><label>49</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Patthy</surname><given-names>L</given-names></name></person-group>             <year>1987</year>             <article-title>Intron-dependent evolution: preferred types of exons and introns.</article-title>             <source>FEBS Lett</source>             <volume>214</volume>             <fpage>1</fpage>             <lpage>7</lpage>          </element-citation></ref><ref id="pcbi.1000063-Sayah1"><label>50</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Sayah</surname><given-names>D</given-names></name><name name-style="western"><surname>Sokolskaja</surname><given-names>E</given-names></name><name name-style="western"><surname>Berthoux</surname><given-names>L</given-names></name><name name-style="western"><surname>Luban</surname><given-names>J</given-names></name></person-group>             <year>2004</year>             <article-title>Cyclophilin A retrotransposition into TRIM5 explains owl monkey resistance to HIV-1.</article-title>             <source>Nature</source>             <volume>430</volume>             <fpage>569</fpage>             <lpage>573</lpage>          </element-citation></ref><ref id="pcbi.1000063-Long1"><label>51</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Long</surname><given-names>M</given-names></name><name name-style="western"><surname>Betran</surname><given-names>E</given-names></name><name name-style="western"><surname>Thornton</surname><given-names>K</given-names></name><name name-style="western"><surname>Wang</surname><given-names>W</given-names></name></person-group>             <year>2003</year>             <article-title>The origin of new genes: glimpses from the young and old.</article-title>             <source>Nat Rev Genet</source>             <volume>4</volume>             <fpage>865</fpage>             <lpage>875</lpage>          </element-citation></ref><ref id="pcbi.1000063-Vinckenbosch1"><label>52</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Vinckenbosch</surname><given-names>N</given-names></name><name name-style="western"><surname>Dupanloup</surname><given-names>I</given-names></name><name name-style="western"><surname>Kaessmann</surname><given-names>H</given-names></name></person-group>             <year>2006</year>             <article-title>Evolutionary fate of retroposed gene copies in the human genome.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>103</volume>             <fpage>3220</fpage>             <lpage>3225</lpage>          </element-citation></ref><ref id="pcbi.1000063-Jones1"><label>53</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Jones</surname><given-names>C</given-names></name><name name-style="western"><surname>Custer</surname><given-names>A</given-names></name><name name-style="western"><surname>Begun</surname><given-names>D</given-names></name></person-group>             <year>2005</year>             <article-title>Origin and evolution of a chimeric fusion gene in <italic>Drosophila subobscura</italic>, <italic>D. madeirensis</italic> and <italic>D. guanche</italic>.</article-title>             <source>Genetics</source>             <volume>170</volume>             <fpage>207</fpage>             <lpage>219</lpage>          </element-citation></ref><ref id="pcbi.1000063-Fumasoni1"><label>54</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Fumasoni</surname><given-names>I</given-names></name><name name-style="western"><surname>Meani</surname><given-names>N</given-names></name><name name-style="western"><surname>Rambaldi</surname><given-names>D</given-names></name><name name-style="western"><surname>Scafetta</surname><given-names>G</given-names></name><name name-style="western"><surname>Alcalay</surname><given-names>M</given-names></name><etal/></person-group>             <year>2007</year>             <article-title>Family expansion and gene rearrangements contributed to the functional specialization of PRDM genes in vertebrates.</article-title>             <source>BMC Evol Biol</source>             <volume>7</volume>             <fpage>187</fpage>          </element-citation></ref><ref id="pcbi.1000063-Fong1"><label>55</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Fong</surname><given-names>J</given-names></name><name name-style="western"><surname>Geer</surname><given-names>L</given-names></name><name name-style="western"><surname>Panchenko</surname><given-names>A</given-names></name><name name-style="western"><surname>Bryant</surname><given-names>S</given-names></name></person-group>             <year>2007</year>             <article-title>Modeling the evolution of protein domain architectures using maximum parsimony.</article-title>             <source>J Mol Biol</source>             <volume>366</volume>             <fpage>307</fpage>             <lpage>315</lpage>          </element-citation></ref><ref id="pcbi.1000063-Weiner1"><label>56</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Weiner</surname><given-names>J</given-names></name><name name-style="western"><surname>Beaussart</surname><given-names>F</given-names></name><name name-style="western"><surname>Bornberg-Bauer</surname><given-names>E</given-names></name></person-group>             <year>2006</year>             <article-title>Domain deletions and substitutions in the modular protein evolution.</article-title>             <source>FEBS J</source>             <volume>273</volume>             <fpage>2037</fpage>             <lpage>2047</lpage>          </element-citation></ref><ref id="pcbi.1000063-Kummerfeld1"><label>57</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Kummerfeld</surname><given-names>S</given-names></name><name name-style="western"><surname>Teichman</surname><given-names>S</given-names></name></person-group>             <year>2005</year>             <article-title>Relative rates of gene fusion and fission in mutli-domain proteins.</article-title>             <source>Trends Genet</source>             <volume>21</volume>             <fpage>25</fpage>             <lpage>30</lpage>          </element-citation></ref><ref id="pcbi.1000063-Altschul1"><label>58</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Altschul</surname><given-names>S</given-names></name><name name-style="western"><surname>Madden</surname><given-names>T</given-names></name><name name-style="western"><surname>Schaffer</surname><given-names>A</given-names></name><name name-style="western"><surname>Zhang</surname><given-names>J</given-names></name><name name-style="western"><surname>Zhang</surname><given-names>Z</given-names></name><etal/></person-group>             <year>1997</year>             <article-title>Gapped BLAST and PSI-BLAST: a new generation of protein database search programs.</article-title>             <source>Nucleic Acids Res</source>             <volume>25</volume>             <fpage>3389</fpage>             <lpage>3402</lpage>          </element-citation></ref><ref id="pcbi.1000063-Ashburner1"><label>59</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Ashburner</surname><given-names>M</given-names></name><name name-style="western"><surname>Ball</surname><given-names>CA</given-names></name><name name-style="western"><surname>Blake</surname><given-names>JA</given-names></name><name name-style="western"><surname>Botstein</surname><given-names>D</given-names></name><name name-style="western"><surname>Butler</surname><given-names>H</given-names></name><etal/></person-group>             <year>2000</year>             <article-title>Gene ontology: tool for the unification of biology. The Gene Ontology Consortium.</article-title>             <source>Nat Genet</source>             <volume>25</volume>             <fpage>25</fpage>             <lpage>29</lpage>          </element-citation></ref><ref id="pcbi.1000063-Ouzounis1"><label>60</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Ouzounis</surname><given-names>C</given-names></name><name name-style="western"><surname>Coulson</surname><given-names>R</given-names></name><name name-style="western"><surname>Enright</surname><given-names>A</given-names></name><name name-style="western"><surname>Kunin</surname><given-names>V</given-names></name><name name-style="western"><surname>Pereira-Leal</surname><given-names>J</given-names></name></person-group>             <year>2003</year>             <article-title>Classification schemes for protein structure and function.</article-title>             <source>Nat Rev Genet</source>             <volume>4</volume>             <fpage>508</fpage>             <lpage>519</lpage>          </element-citation></ref><ref id="pcbi.1000063-Altschul2"><label>61</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Altschul</surname><given-names>S</given-names></name><name name-style="western"><surname>Gish</surname><given-names>W</given-names></name><name name-style="western"><surname>Miller</surname><given-names>W</given-names></name><name name-style="western"><surname>Myers</surname><given-names>E</given-names></name><name name-style="western"><surname>Lipman</surname><given-names>D</given-names></name></person-group>             <year>1990</year>             <article-title>Basic local alignment search tool.</article-title>             <source>Journal of Molecular Biology</source>             <volume>215</volume>             <fpage>403</fpage>             <lpage>410</lpage>          </element-citation></ref><ref id="pcbi.1000063-Schaffer1"><label>62</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Schaffer</surname><given-names>A</given-names></name><name name-style="western"><surname>Aravind</surname><given-names>L</given-names></name><name name-style="western"><surname>Madden</surname><given-names>T</given-names></name><name name-style="western"><surname>Shavirin</surname><given-names>S</given-names></name><name name-style="western"><surname>Spouge</surname><given-names>J</given-names></name><etal/></person-group>             <year>2001</year>             <article-title>Improving the accuracy of PSI- BLAST protein database searches with composition-based statistics and other refinements.</article-title>             <source>Nucleic Acids Res</source>             <volume>29</volume>             <fpage>2994</fpage>             <lpage>3005</lpage>          </element-citation></ref><ref id="pcbi.1000063-Rost1"><label>63</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Rost</surname><given-names>B</given-names></name><name name-style="western"><surname>Liu</surname><given-names>J</given-names></name><name name-style="western"><surname>Nair</surname><given-names>R</given-names></name><name name-style="western"><surname>Wrzeszczynski</surname><given-names>K</given-names></name><name name-style="western"><surname>Ofran</surname><given-names>Y</given-names></name></person-group>             <year>2003</year>             <article-title>Automatic prediction of protein function.</article-title>             <source>Cell Mol Life Sci</source>             <volume>60</volume>             <fpage>2637</fpage>             <lpage>2650</lpage>          </element-citation></ref><ref id="pcbi.1000063-Altschul3"><label>64</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Altschul</surname><given-names>S</given-names></name><name name-style="western"><surname>Wootton</surname><given-names>J</given-names></name><name name-style="western"><surname>Gertz</surname><given-names>E</given-names></name><name name-style="western"><surname>Agarwala</surname><given-names>R</given-names></name><name name-style="western"><surname>Morgulis</surname><given-names>A</given-names></name><etal/></person-group>             <year>2005</year>             <article-title>Protein database searches using compositionally adjusted substitution matrices.</article-title>             <source>FEBS J</source>             <volume>272</volume>             <fpage>5101</fpage>             <lpage>5109</lpage>          </element-citation></ref><ref id="pcbi.1000063-Wuchty1"><label>65</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Wuchty</surname><given-names>S</given-names></name></person-group>             <year>2001</year>             <article-title>Scale free behavior in protein domain networks.</article-title>             <source>Mol Biol Evol</source>             <volume>18</volume>             <fpage>1694</fpage>             <lpage>1702</lpage>          </element-citation></ref><ref id="pcbi.1000063-Karev1"><label>66</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Karev</surname><given-names>G</given-names></name><name name-style="western"><surname>Wolf</surname><given-names>Y</given-names></name><name name-style="western"><surname>Rzhetsky</surname><given-names>A</given-names></name><name name-style="western"><surname>Berezovskaya</surname><given-names>F</given-names></name><name name-style="western"><surname>Koonin</surname><given-names>E</given-names></name></person-group>             <year>2002</year>             <article-title>Birth and death of protein domains: a simple model of evolution explains power law behavior.</article-title>             <source>BMC Evol Biol</source>             <volume>2</volume>             <fpage>18</fpage>          </element-citation></ref><ref id="pcbi.1000063-Karev2"><label>67</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Karev</surname><given-names>G</given-names></name><name name-style="western"><surname>Wolf</surname><given-names>Y</given-names></name><name name-style="western"><surname>Berezovskaya</surname><given-names>F</given-names></name><name name-style="western"><surname>Koonin</surname><given-names>E</given-names></name></person-group>             <year>2004</year>             <article-title>Gene family evolution: an in-depth theoretical and simulation analysis of non-linear birth-death-innovation models.</article-title>             <source>BMC Evol Biol</source>             <volume>4</volume>             <fpage>32</fpage>          </element-citation></ref><ref id="pcbi.1000063-Rzhetsky1"><label>68</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Rzhetsky</surname><given-names>A</given-names></name><name name-style="western"><surname>Gomez</surname><given-names>S</given-names></name></person-group>             <year>2001</year>             <article-title>Birth of scale-free molecular networks and the number of distinct DNA and protein domains per genome.</article-title>             <source>Bioinformatics</source>             <volume>17</volume>             <fpage>988</fpage>             <lpage>996</lpage>          </element-citation></ref><ref id="pcbi.1000063-Wolf1"><label>69</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Wolf</surname><given-names>Y</given-names></name><name name-style="western"><surname>Rogozin</surname><given-names>I</given-names></name><name name-style="western"><surname>Kondrashov</surname><given-names>A</given-names></name><name name-style="western"><surname>Koonin</surname><given-names>E</given-names></name></person-group>             <year>2001</year>             <article-title>Genome alignment, evolution of prokaryotic genome organization, and prediction of gene function using genomic context.</article-title>             <source>Genome Res</source>             <volume>11</volume>             <fpage>356</fpage>             <lpage>372</lpage>          </element-citation></ref><ref id="pcbi.1000063-Przytycka1"><label>70</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Przytycka</surname><given-names>T</given-names></name><name name-style="western"><surname>Davis</surname><given-names>G</given-names></name><name name-style="western"><surname>Song</surname><given-names>N</given-names></name><name name-style="western"><surname>Durand</surname><given-names>D</given-names></name></person-group>             <year>2006</year>             <article-title>Graph theoretical insights into evolution of multidomain proteins.</article-title>             <source>J Comput Biol</source>             <volume>13</volume>          </element-citation></ref><ref id="pcbi.1000063-Przytycka2"><label>71</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Przytycka</surname><given-names>T</given-names></name></person-group>             <year>2007</year>             <article-title>Stability of characters and construction of phylogenetic trees.</article-title>             <source>J Comput Biol</source>             <volume>14</volume>             <fpage>539</fpage>             <lpage>549</lpage>          </element-citation></ref><ref id="pcbi.1000063-Medini1"><label>72</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Medini</surname><given-names>D</given-names></name><name name-style="western"><surname>Covacci</surname><given-names>A</given-names></name><name name-style="western"><surname>Donati</surname><given-names>C</given-names></name></person-group>             <year>2006</year>             <article-title>Protein homology network families reveal step-wise diversification of Type III and Type IV secretion systems.</article-title>             <source>PLoS Comput Biol</source>             <volume>2</volume>             <fpage>e173</fpage><comment>doi:10.1371/journal.pcbi.0020173</comment>          </element-citation></ref><ref id="pcbi.1000063-Kaiser1"><label>73</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Kaiser</surname><given-names>D</given-names></name></person-group>             <year>2001</year>             <article-title>Building a multicellular organism.</article-title>             <source>Annu Rev Genet</source>             <volume>35</volume>             <fpage>103</fpage>             <lpage>123</lpage>          </element-citation></ref><ref id="pcbi.1000063-Bairoch1"><label>74</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Bairoch</surname><given-names>A</given-names></name><name name-style="western"><surname>Apweiler</surname><given-names>R</given-names></name><name name-style="western"><surname>Wu</surname><given-names>C</given-names></name><name name-style="western"><surname>Barker</surname><given-names>W</given-names></name><name name-style="western"><surname>Boeckmann</surname><given-names>B</given-names></name><etal/></person-group>             <year>2005</year>             <article-title>The universal protein resource (UniProt).</article-title>             <source>Nucleic Acids Res</source>             <volume>33</volume>             <fpage>D154</fpage>             <lpage>D159</lpage>          </element-citation></ref><ref id="pcbi.1000063-Song2"><label>75</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Song</surname><given-names>N</given-names></name></person-group>             <year>2007</year>             <article-title>Homology Identification for Multidomain Proteins.</article-title>             <comment>Ph.D. thesis, Carnegie Mellon University, Pittsburgh, PA</comment>          </element-citation></ref><ref id="pcbi.1000063-Mulder1"><label>76</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Mulder</surname><given-names>N</given-names></name><name name-style="western"><surname>Apweiler</surname><given-names>R</given-names></name><name name-style="western"><surname>Attwood</surname><given-names>T</given-names></name><name name-style="western"><surname>Bairoch</surname><given-names>A</given-names></name><name name-style="western"><surname>Bateman</surname><given-names>A</given-names></name><etal/></person-group>             <year>2005</year>             <article-title>InterPro, progress and status in 2005.</article-title>             <source>Nucleic Acids Res</source>             <volume>33</volume>             <fpage>D201</fpage>             <lpage>D205</lpage>          </element-citation></ref><ref id="pcbi.1000063-Wootton1"><label>77</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Wootton</surname><given-names>J</given-names></name><name name-style="western"><surname>Federhen</surname><given-names>S</given-names></name></person-group>             <year>1996</year>             <article-title>Analysis of compositionally biased regions in sequence databases.</article-title>             <source>Methods Enzymol</source>             <volume>266</volume>             <fpage>554</fpage>             <lpage>571</lpage>          </element-citation></ref><ref id="pcbi.1000063-Gribskov1"><label>78</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Gribskov</surname><given-names>M</given-names></name><name name-style="western"><surname>Robinson</surname><given-names>N</given-names></name></person-group>             <year>1996</year>             <article-title>Use of receiver operating characteristic (ROC) analysis to evaluate sequence matching.</article-title>             <source>Comput Chem</source>             <volume>20</volume>             <fpage>25</fpage>             <lpage>33</lpage>          </element-citation></ref></ref-list></back></article>