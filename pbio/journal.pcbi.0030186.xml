<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN"><front><journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="publisher">pcbi</journal-id><journal-id journal-id-type="allenpress-id">plcb</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher><publisher-name>Public Library of Science</publisher-name><publisher-loc>San Francisco, USA</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.1371/journal.pcbi.0030186</article-id><article-id pub-id-type="publisher-id">07-PLCB-RA-0128R3</article-id><article-id pub-id-type="sici">plcb-03-09-19</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline"><subject>Computational Biology</subject><subject>Evolutionary Biology</subject></subj-group><subj-group subj-group-type="System Taxonomy"><subject>Eubacteria</subject></subj-group></article-categories><title-group><article-title>The Origins of Specificity in Polyketide Synthase Protein Interactions</article-title><alt-title alt-title-type="running-head">Specificity in PKS Protein Interactions</alt-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Thattai</surname><given-names>Mukund</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Burak</surname><given-names>Yoram</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Shraiman</surname><given-names>Boris I</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib></contrib-group><aff id="aff1">
				<label>1</label><addr-line> National Centre for Biological Sciences, Bangalore, India
			</addr-line></aff><aff id="aff2">
				<label>2</label><addr-line> Kavli Institute for Theoretical Physics, University of California Santa Barbara, Santa Barbara, California, United States of America
			</addr-line></aff><contrib-group><contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Kholsa</surname><given-names>Chaitan</given-names></name><role>Editor</role><xref ref-type="aff" rid="edit1"/></contrib></contrib-group><aff id="edit1">Stanford University, United States of America</aff><author-notes><fn fn-type="con" id="ack1"><p>MT developed the theory, performed the analysis, and wrote the paper. YB developed the theory and edited the paper. BIS developed the theory and edited the paper.</p></fn><corresp id="cor1">* To whom correspondence should be addressed. E-mail: <email xlink:type="simple">thattai@ncbs.res.in</email></corresp><fn fn-type="conflict" id="ack3"><p> The authors have declared that no competing interests exist.</p></fn></author-notes><pub-date pub-type="ppub"><month>9</month><year>2007</year></pub-date><pub-date pub-type="epub"><day>28</day><month>9</month><year>2007</year></pub-date><volume>3</volume><issue>9</issue><elocation-id>e186</elocation-id><history><date date-type="received"><day>16</day><month>3</month><year>2007</year></date><date date-type="accepted"><day>10</day><month>8</month><year>2007</year></date></history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2007</copyright-year><copyright-holder>Thattai et al</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract><p>Polyketides, a diverse group of heteropolymers with antibiotic and antitumor properties, are assembled in bacteria by multiprotein chains of modular polyketide synthase (PKS) proteins. Specific protein–protein interactions determine the order of proteins within a multiprotein chain, and thereby the order in which chemically distinct monomers are added to the growing polyketide product. Here we investigate the evolutionary and molecular origins of protein interaction specificity. We focus on the short, conserved N- and C-terminal docking domains that mediate interactions between modular PKS proteins. Our computational analysis, which combines protein sequence data with experimental protein interaction data, reveals a hierarchical interaction specificity code. PKS docking domains are descended from a single ancestral interacting pair, but have split into three phylogenetic classes that are mutually noninteracting. Specificity <italic>within</italic> one such compatibility class is determined by a few key residues, which can be used to define compatibility subclasses. We identify these residues using a novel, highly sensitive co-evolution detection algorithm called CRoSS (correlated residues of statistical significance). The residue pairs selected by CRoSS are involved in direct physical interactions in a docked-domain NMR structure. A single PKS system can use docking domain pairs from multiple classes, as well as domain pairs from multiple subclasses of any given class. The termini of individual proteins are frequently shuffled, but docking domain pairs straddling two interacting proteins are linked as an evolutionary module. The hierarchical and modular organization of the specificity code is intimately related to the processes by which bacteria generate new PKS pathways.</p></abstract><abstract abstract-type="summary"><title>Author Summary</title><sec id="st1"><title/><p>Biomolecular interactions can be extraordinarily specific. In many instances, a protein can select its single correct binding partner from among a large array of closely related candidates. For polyketide synthases (PKSs), a family of bacterial enzymes, such specificity is essential. Like workers on an assembly line, PKSs function as multiprotein chains, each enzyme modifying its substrate before passing it along to the next. And like a well-designed jigsaw puzzle, the overall multiprotein chain is correctly ordered precisely because each component protein can only bind to specific nearest neighbors. A PKS multiprotein chain is held together by sticky “head” and “tail” domains found at either end of each protein, the head of one protein binding to the tail of the next. We looked for patterns in the amino-acid sequences of these domains that could explain why certain head–tail pairs bind, while others do not. We discovered that heads and tails each come in three very different varieties. Mismatched head–tail pairs do not bind at all, while the binding of a matching head–tail pair is governed by the amino acids found at a few key positions on the physical interface between these domains.</p></sec></abstract><funding-group><funding-statement>MT was supported by the National Centre for Biological Sciences, and acknowledges the hospitality of the Kavli Institute of Theoretical Physics. This work was supported in part by a Max Planck–India Fellowship (MT), US National Science Foundation grant PHY05–51164 (YB), and US National Institutes of Health grant GM67794 (BIS).</funding-statement></funding-group><counts><page-count count="9"/></counts><!--===== Restructure custom-meta-wrap to custom-meta-group =====--><custom-meta-group><custom-meta><meta-name>citation</meta-name><meta-value>Thattai M, Burak Y, Shraiman BI (2007) The origins of specificity in polyketide synthase protein interactions. PLoS Comput Biol 3(9): e186. doi:<ext-link ext-link-type="doi" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.0030186" xlink:type="simple">10.1371/journal.pcbi.0030186</ext-link></meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1"><title>Introduction</title><p>The extraordinary biosynthetic capabilities of polyketide synthases (PKS), some of the largest known bacterial multi-enzyme complexes, have been extensively investigated over the past decade. Using a combination of biochemical and genetic techniques, researchers have developed a detailed understanding of the organization and structure of these complex enzymes, as well as of the biochemical reactions they catalyze [<xref ref-type="bibr" rid="pcbi-0030186-b001">1</xref>]. The assembly of a polyketide proceeds by the successive addition of acyl extender groups to a growing biochemical polymer. Each module of a modular PKS is a multidomain catalytic unit responsible for a single step of polyketide chain extension. PKS proteins can each contain one or more modules. Different modules add different basic or modified extender units, so the order of proteins and their modules in the multiprotein chain determines the chemical structure of the final polyketide product. Crucially, PKS catalytic domains exhibit broad substrate tolerance, and are able to extend “unnatural” polyketide substrates [<xref ref-type="bibr" rid="pcbi-0030186-b002">2</xref>,<xref ref-type="bibr" rid="pcbi-0030186-b003">3</xref>]. In particular, PKS modules are catalytically active even when their order is changed, enabling a combinatorial diversity of possible polyketide products. This property, which suggests that modules are frequently shuffled during natural selection, has generated enormous interest in using PKS pathways to achieve combinatorial biochemistry in the laboratory [<xref ref-type="bibr" rid="pcbi-0030186-b002">2</xref>–<xref ref-type="bibr" rid="pcbi-0030186-b006">6</xref>].</p><p>Biochemical studies of PKS systems have recently been complemented by powerful computational tools. These tools allow results from well-characterized PKS systems to be extended to the rapidly growing set of putative PKS gene clusters in fully sequenced bacterial genomes. Computational analysis of sequence data has been used to identify catalytic domains and to predict their substrate specificity, both for PKS systems [<xref ref-type="bibr" rid="pcbi-0030186-b007">7</xref>,<xref ref-type="bibr" rid="pcbi-0030186-b008">8</xref>] as well as for the closely related nonribosomal peptide synthase (NRPS) systems [<xref ref-type="bibr" rid="pcbi-0030186-b008">8</xref>,<xref ref-type="bibr" rid="pcbi-0030186-b009">9</xref>]. In a recent analysis, Minowa et al. [<xref ref-type="bibr" rid="pcbi-0030186-b010">10</xref>] were able to effectively predict the catalytic function of individual proteins, as well as the order in which multiple proteins act to produce the final polyketide product, by combining a variety of data including the chromosomal context of genes, and the sequences and phylogeny of catalytic and linker regions. While these predictive tools can be extremely accurate, their output cannot necessarily be interpreted in ways that provide biological insight. It is therefore important, in parallel with predictive approaches, to investigate underlying evolutionary and molecular mechanisms. For example, a new generation of sequence-based classification algorithms promises not only to have predictive power, but also to reveal sequence features that are important for discrimination, thus providing insight at the molecular level [<xref ref-type="bibr" rid="pcbi-0030186-b011">11</xref>]. Comparative sequence analysis can also be used to shed light on the evolutionary history of a system, as shown in a recent study of PKS catalytic-domain duplication [<xref ref-type="bibr" rid="pcbi-0030186-b012">12</xref>].</p><p>Here we use sequence data to investigate PKS protein interactions. For the PKS proteins to line up in the correct order, protein interactions must be <italic>specific</italic> [<xref ref-type="bibr" rid="pcbi-0030186-b013">13</xref>,<xref ref-type="bibr" rid="pcbi-0030186-b014">14</xref>]: certain protein pairs must be allowed to bind, while others must be prevented from doing so. It is remarkable that these proteins are able to correctly discriminate between various possible binding partners, given that all the docking domains which mediate their interactions are homologous. We uncover key sequence features that govern PKS protein interactions, and thereby construct a predictive specificity code. We show that, by studying how the code is organized, we can learn a great deal about the evolutionary origins as well as the molecular basis of this elegant specificity.</p></sec><sec id="s2"><title>Results</title><sec id="s2a"><title>Docking Domains and Interaction Compatibility Classes</title><p>Biochemical investigations have shown that interactions between PKS proteins map to docking domains at their N- and C-termini [<xref ref-type="bibr" rid="pcbi-0030186-b013">13</xref>–<xref ref-type="bibr" rid="pcbi-0030186-b015">15</xref>]. Starting with a seed alignment of terminal fragments from well-characterized PKS pathways [<xref ref-type="bibr" rid="pcbi-0030186-b007">7</xref>], we used PSI-BLAST to assemble a dataset of proteins with regions homologous to these (<xref ref-type="supplementary-material" rid="pcbi-0030186-se001">Text S1</xref>, Section 1). Homologous regions were only detected at protein termini, never in the interior. Most of the proteins we pulled up belonged to biochemically characterized modular PKS pathways, and the rest to putative modular PKS pathways in fully sequenced genomes. Almost all known modular PKS proteins contained homologous termini, and we found no significant hits to non-PKS proteins. This suggests that all modular PKS proteins employ the same mechanism to mediate interactions.</p><p>We next confined our attention to 42 biochemically characterized modular PKS pathways in which the order of proteins within the multiprotein chain has been determined (<xref ref-type="supplementary-material" rid="pcbi-0030186-sd001">Dataset S1</xref>). An alignment of the protein termini revealed short, conserved regions at the very ends of the proteins (<xref ref-type="fig" rid="pcbi-0030186-g001">Figure 1</xref>A): a 19 aa C-terminal “head” region, and a 27 aa N-terminal “tail” region (<xref ref-type="fig" rid="pcbi-0030186-g001">Figure 1</xref>B). Throughout our discussion, we shall refer to these regions as docking domains. (The docking domains originally defined by Broadhurst et al. [<xref ref-type="bibr" rid="pcbi-0030186-b015">15</xref>] are slightly larger protein interaction regions, of which the heads and tails defined here form only a part: PKS protein termini typically contain one conserved N-terminal helix, which corresponds to our tail domain, and three conserved C-terminal helices, of which the most C-terminal helix corresponds to our head domain.) When these domains were clustered according to sequence similarity [<xref ref-type="bibr" rid="pcbi-0030186-b016">16</xref>] (<xref ref-type="supplementary-material" rid="pcbi-0030186-se001">Text S1</xref>, Section 2), the heads and tails each <italic>independently</italic> assorted into three phylogenetic groups (<xref ref-type="fig" rid="pcbi-0030186-g002">Figure 2</xref>A). When the docking domains of the proteins in each multiprotein chain were labeled according to group membership (<xref ref-type="fig" rid="pcbi-0030186-g002">Figure 2</xref>B), a striking pattern emerged: phylogenetic clustering coincided precisely with head–tail interactions (<xref ref-type="fig" rid="pcbi-0030186-g002">Figure 2</xref>C). Heads from one group could only interact with tails from a corresponding group, but were incompatible with other tails, and vice versa. From this one-to-one pairing, we were able to assign common labels to the head and tail clusters, thus defining three mutually incompatible classes of docking domain pairs: <italic>H1</italic>–<italic>T1</italic>, <italic>H2</italic>–<italic>T2</italic>, and <italic>H3</italic>–<italic>T3</italic>. However, membership within a compatibility class was only a necessary, not a sufficient, condition for head–tail interaction: there were still numerous cases in which domain pairs belonging to the same compatibility class did not interact (<xref ref-type="fig" rid="pcbi-0030186-g002">Figures 2</xref>B and <xref ref-type="fig" rid="pcbi-0030186-g002">2</xref>C). This implies that, <italic>within</italic> each class, there are additional rules that determine the set of allowed interactions. In essence, there is another layer to the PKS specificity code.</p><fig id="pcbi-0030186-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030186.g001</object-id><label>Figure 1</label><caption><title>PKS Docking Domains</title><p>(A) Location of docking domains at protein termini. A pair of interacting PKS proteins are represented as chevrons, with their docking domains indicated in grey: the C-terminal head domain (pointed) and the N-terminal tail domain (notched). The boxes immediately below give an overview of the 149 head and tail domains in our dataset. Each horizontal line represents a single protein sequence; the sequences are aligned according to their conserved docking domains (grey), and sorted according to the lengths of their unconserved overhangs. We see that most docking domains are to be found within a few amino acids of protein termini.</p><p>(B) Representative multiple-sequence alignments of the 19 aa C-terminal head domains (left) and 27 aa N-terminal tail domains (right). Hydrophobic residues are colored red, hydrophilic residues are colored blue, and intensity reflects sequence conservation [<xref ref-type="bibr" rid="pcbi-0030186-b029">29</xref>]. Note that sequences are sorted differently than in <xref ref-type="fig" rid="pcbi-0030186-g001">Figure 1</xref>A. Each row shows an interacting head–tail pair, labeled by the PKS pathway it belongs to, and the interface number within that pathway. For example, <italic>ampho_003</italic> represents the interface between proteins 3 and 4 of the amphotericin PKS. (Pathway abbreviations are described in detail in <xref ref-type="supplementary-material" rid="pcbi-0030186-sd001">Dataset S1</xref>.) The head and tail alignments are divided into three groups each (<italic>H1</italic>, <italic>H2</italic>, <italic>H3,</italic> and <italic>T1</italic>, <italic>T2</italic>, <italic>T3</italic>) corresponding to the clusters discussed in <xref ref-type="fig" rid="pcbi-0030186-g002">Figure 2</xref>.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030186.g001" xlink:type="simple"/></fig><fig id="pcbi-0030186-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030186.g002</object-id><label>Figure 2</label><caption><title>Docking Domain Compatibility Classes</title><p>(A) Docking domains are clustered according to sequence similarity (<xref ref-type="supplementary-material" rid="pcbi-0030186-se001">Text S1</xref>, Section 2). Each node represents a particular head (left) or tail (right) domain; two domains are connected by a line if their BLAST e-value is less than a defined cutoff (2.0e-4 for heads, and 1.0e-4 for tails). Head and tail domains each independently assort into three phylogenetic clusters, labeled <italic>H1</italic>, <italic>H2</italic>, <italic>H3</italic>, and <italic>T1</italic>, <italic>T2</italic>, <italic>T3</italic>, respectively. For the moment, cluster coloring is arbitrary.</p><p>(B) Examples of PKS multiprotein chains. Each row shows a different PKS pathway, with names as defined in <xref ref-type="supplementary-material" rid="pcbi-0030186-sd001">Dataset S1</xref>. Proteins are represented as chevrons, with C-terminal head domains (pointed) and N-terminal tail domains (notched) now colored according to their phylogenetic group, as defined in <xref ref-type="fig" rid="pcbi-0030186-g002">Figure 2</xref>A. The pathway termini, as well as domains which could not be clustered, are colored grey. Note that interactions predominantly occur between docking domains of the same color. There are only two exceptions to this rule, one of which is shown in the <italic>nanch</italic> multiprotein chain. (The other, in the <italic>nidda</italic> multiprotein chain, involves a domain that lies at the boundary of its parent cluster, indicating that it has probably been misclassified by our clustering algorithm; see <xref ref-type="supplementary-material" rid="pcbi-0030186-sd002">Dataset S2</xref>.) Actinobacterial pathways tend to use domains pairs of type <italic>H1</italic>–<italic>T1</italic> and <italic>H2</italic>–<italic>T2</italic>, while myxobacterial and cyanobacterial pathways use domain pairs of type <italic>H3</italic>–<italic>T3</italic> alone. (Again, the few exceptions to this rule, such as in the <italic>epoth</italic> multiprotein chain, are likely due to misclassification.)</p><p>(C) Phylogenetic clusters coincide with docking domain compatibility classes. Each PKS pathway in our dataset gives us a list of known interactors, as well as a list of known noninteractors. For example, the amphotericin pathway contains five internal head and tail domains; of the 25 possible pairings of these domains, five represent interactors (three <italic>H1</italic>–<italic>T1</italic> and two <italic>H2</italic>–<italic>T2</italic>), while the remaining 20 represent noninteractors (six <italic>H1</italic>–<italic>T1</italic>, six <italic>H1</italic>–<italic>T2</italic>, six <italic>H2</italic>–<italic>T1</italic>, and two <italic>H2</italic>–<italic>T2</italic>). We tallied such interaction and noninteraction information over the 42 PKS pathways in our dataset, and summarized our results in a single table. Each row corresponds to a head cluster, and each column to a tail cluster. The top-left entry of every cell reports the number head–tail pairs of the given variety known to be interactors; the bottom-right entry reports the number of head–tail pairs known to be noninteractors. For example, we know one interactor and 73 non-interactors of the <italic>H1</italic>-<italic>T2</italic> variety. The correspondence between the head and tail clusters is obvious: we find large numbers of interactors within compatible clusters (on-diagonal, highlighted in orange) and large numbers of noninteractors between them (off-diagonal, highlighted in purple). This defines a one-to-one pairing of head and tail clusters into three compatibility classes, <italic>H1</italic>–<italic>T1</italic> (green), <italic>H2</italic>–<italic>T2</italic> (red), and <italic>H3</italic>–<italic>T3</italic> (blue), and justifies the common coloring used in <xref ref-type="fig" rid="pcbi-0030186-g002">Figure 2</xref>A. This division into compatibility classes is a useful predictive tool for actinobacterial pathways, since they tend to contain docking domains of multiple varieties. For example, since the <italic>ampho</italic> pathway has three <italic>H1</italic>–<italic>T1</italic> domain pairs and 2 <italic>H2</italic>–<italic>T2</italic> domain pairs, only 12 of the 120 possible ways of pairing them are compatible (2!3! out of 5!). Of the 33 actinobacterial pathways in our dataset, 19 contain both <italic>H1</italic>–<italic>T1</italic> and <italic>H2</italic>–<italic>T2</italic> varieties (<xref ref-type="supplementary-material" rid="pcbi-0030186-sd002">Dataset S2</xref>). For these mixed pathways, on average less than a third of all possible ways of pairing their domains are compatible.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030186.g002" xlink:type="simple"/></fig></sec><sec id="s2b"><title>CRoSS: Sensitive Detection of Co-Evolving Residues</title><p>To gain further insight into the rules that governed specificity, we sought to identify residue pairs that co-evolved between interacting partners [<xref ref-type="bibr" rid="pcbi-0030186-b017">17</xref>,<xref ref-type="bibr" rid="pcbi-0030186-b018">18</xref>]. This task is complicated by the fact that our dataset is small and nonuniformly sampled, therefore dominated by spurious correlations. To overcome this problem, we developed a new algorithm called CRoSS (correlated residues of statistical significance) which uses both interaction and noninteraction data to identify significant pairings between head and tail residues (<xref ref-type="sec" rid="s4">Methods</xref>). For each site pair, the algorithm first calculates, separately for interactors and noninteractors, the joint distribution of amino acids summed over pathways. It then assigns a score to that site pair, which is essentially a <italic>p</italic>-value reporting the significance of the difference between these distributions. CRoSS has numerous advantages over existing co-evolution algorithms [<xref ref-type="bibr" rid="pcbi-0030186-b017">17</xref>,<xref ref-type="bibr" rid="pcbi-0030186-b018">18</xref>] (<xref ref-type="supplementary-material" rid="pcbi-0030186-sg001">Figure S1</xref>D). Because it is based on comparisons within rather than between pathways, it is less susceptible to errors from nonuniform sampling; because it reports a significance rather than a correlation, it can be applied to datasets of any size; and because it identifies sites but averages over amino acids, it is more sensitive given smaller datasets. CRoSS can generally be used to investigate protein specificity whenever data are available about which protein pairs do or do not interact, such as for bacterial two-component systems [<xref ref-type="bibr" rid="pcbi-0030186-b019">19</xref>].</p></sec><sec id="s2c"><title>Code Words and Interaction Compatibility Subclasses</title><p>We used CRoSS to investigate the key residues that determine specificity within each compatibility class. We were able to detect significant residue pairs only for class <italic>H1–T1</italic> (<xref ref-type="fig" rid="pcbi-0030186-g003">Figures 3</xref>A and <xref ref-type="fig" rid="pcbi-0030186-g003">3</xref>B). (This does not mean there are no correlations in the other cases, only that we cannot detect them with confidence given the smaller sizes of those datasets.) We found that the <italic>H1–T1</italic> correlation matrix was extremely sparse (<xref ref-type="fig" rid="pcbi-0030186-g003">Figure 3</xref>B), showing that a small number of site pairs co-evolved independently, uncorrelated to any broad phylogenetic patterns. CRoSS identified only seven significant correlated residue pairs for <italic>H1–T1</italic> interactors, involving three head residues and five tail residues (<xref ref-type="supplementary-material" rid="pcbi-0030186-sg001">Figure S1</xref>C). Note that while residues involved in protein secondary structure are expected to be highly conserved, those that determine specificity should show moderate sequence conservation but strong co-evolution. Such residues cannot be identified from structure alone, but can only be identified from the type of correlation analysis presented here, or from detailed domain swapping and mutagenesis experiments [<xref ref-type="bibr" rid="pcbi-0030186-b020">20</xref>,<xref ref-type="bibr" rid="pcbi-0030186-b021">21</xref>].</p><fig id="pcbi-0030186-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030186.g003</object-id><label>Figure 3</label><caption><title>Co-Evolving Residues</title><p>In this figure, symbols associated with head domains are colored red, and those associated with tail domains are colored green. This coloring is unrelated to compatibility class, as all domains pictured belong to compatibility class <italic>H1</italic>–<italic>T1</italic>.</p><p>(A,B) CRoSS matrices, showing the residue pairs that significantly contribute to specificity (<xref ref-type="sec" rid="s4">Methods</xref>). Residues on the C-terminal head domain are indexed vertically (<italic>i</italic> = 1, ... , 19); residues on the N-terminal tail domain are indexed horizontally (<italic>j</italic> = 1, ... , 27). Each entry shows -log<sub>10</sub>(<italic>ρ<sub>ij</sub></italic>) for the corresponding site-pair, with the scale indicated on the color bar; the higher this value, the more significant the site-pair as a determinant of specificity.</p><p>(A) The <italic>H1</italic>–<italic>T1</italic> control matrix, generated by comparing random pairings with noninteractors. Since we expect no significant hits, these entries provide us with an estimate of the random background.</p><p>(B) The <italic>H1</italic>–<italic>T1</italic> interaction matrix, generated by comparing interactors with noninteractors. Several entries are highlighted above the background (white circles serve as guides to the eye). The matrix is sparse, showing that residue pairs at a few key sites vary independently, uncorrelated to any broad phylogenetic patterns. There are only seven significant residue pairs (<xref ref-type="supplementary-material" rid="pcbi-0030186-sg001">Figure S1</xref>C). These are, in order of significance, {<italic>i</italic>, <italic>j</italic>} = {6,5}, {13,11}, {12,18}, {12,11}, {12,12}, {12,16}, {12,5}. The three head residues and five tail residues that make up these pairs are indicated along the axes by red and green arrows, respectively.</p><p>(C) Representative multiple-sequence alignments of <italic>H1</italic> head domains (left) and <italic>T1</italic> tail domains (right), with cartoon representations of the head and tail domains shown below. Each row shows an interacting head–tail pair, labeled by the PKS pathway it belongs to, and the interface number within that pathway. The three head residues and five tail residues selected by CRoSS are indicated by red and green arrows, respectively; the corresponding positions in the sequence alignments are highlighted in bold. The three most significant head and tail residues (used to define code words in <xref ref-type="fig" rid="pcbi-0030186-g004">Figure 4</xref>) are indicated by asterisks. The head and tail alignments are divided into four groups each (<italic>H1a</italic>–<italic>H1d</italic> and <italic>T1a</italic>–<italic>T1d</italic>) corresponding to the subclasses discussed in <xref ref-type="fig" rid="pcbi-0030186-g004">Figure 4</xref>.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030186.g003" xlink:type="simple"/></fig><fig id="pcbi-0030186-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030186.g004</object-id><label>Figure 4</label><caption><title>Code Words and Compatibility Subclasses</title><p>In this figure, symbols associated with head domains are colored red, and those associated with tail domains are colored green. This coloring is unrelated to compatibility class, as all domains pictured belong to compatibility class <italic>H1</italic>–<italic>T1</italic>.</p><p>(A) The three most significant CRoSS pairs pick out three residues each on the head (red) and tail (green) domains. These residues (indicated by asterisks in <xref ref-type="fig" rid="pcbi-0030186-g003">Figure 3</xref>C) are highlighted by arrows, with their position along the domain shown in parentheses. The amino acids at these positions define our code words.</p><p>(B) Schematic representation of code word clusters. Each node of the graph represents a unique head (red) or tail (green) code word, and each edge represents a known interaction (orange) or noninteraction (purple) between code words. We use a Monte Carlo algorithm (<xref ref-type="supplementary-material" rid="pcbi-0030186-se001">Text S1</xref>, Section 3) to group the nodes into clusters, such that interactions are enriched within a cluster, and noninteractions are enriched between clusters. These clusters thus represent a refinement of <italic>H1-T1</italic> into compatibility subclasses.</p><p>(C) Actual code word clusters. This is a matrix representation of the interaction graph shown in <xref ref-type="fig" rid="pcbi-0030186-g004">Figure 4</xref>B. Each row corresponds to a head code word (red), and each column to a tail code word (green). The entries represent edges, showing that the corresponding code word pairs have been found on known interactors (orange), known noninteractors (purple), both (pink), or neither (white). Code words are grouped into four clusters (each labeled by a different shade of red or green), corresponding to subclasses of <italic>H1</italic>–<italic>T1</italic> within which interactions are enriched. Nodes that occur as singletons are not shown.</p><p>(D) Synonymous sets of code words. The code words belonging to each subclass are explicitly listed, in the same order as in the matrix of <xref ref-type="fig" rid="pcbi-0030186-g004">Figure 4</xref>C. Comparison with the matrix shows that, within a given subclass, each head is compatible with several tails, and vice-versa. The subclasses are labeled by shade, as well as by the index <italic>a</italic>, <italic>b</italic>, <italic>c</italic>, <italic>d</italic>. Within each subclass, we see a high degree of code word sequence similarity. If an amino acid occurs in a majority of instances at a given position, it is included in the consensus sequence characterizing a given subclass.</p><p>(E) Histogram of clustering energies for 50 datasets with randomized interactions (<xref ref-type="supplementary-material" rid="pcbi-0030186-se001">Text S1</xref>, Section 3). The more negative the energy, the better the clustering. The red line indicates the energy of the true dataset, far to the left of the distribution for randomized datasets. This indicates that the observed degree of clustering is statistically significant, with <italic>p</italic>-value &lt; 0.02.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030186.g004" xlink:type="simple"/></fig><p>Having identified the sites predominantly responsible for <italic>H1–T1</italic> specificity, we next asked whether we could construct a specificity code for interactions within this class. We focussed on the three most significant CRoSS pairs, which involved three residues each on the head and tail domains (indicated by asterisks in <xref ref-type="fig" rid="pcbi-0030186-g003">Figure 3</xref>C, and by arrows in <xref ref-type="fig" rid="pcbi-0030186-g004">Figure 4</xref>A). For any given head or tail, these residues define a short amino acid code word. We used a Monte Carlo technique to cluster these words into cliques [<xref ref-type="bibr" rid="pcbi-0030186-b022">22</xref>], such that interactions were enriched within cliques but suppressed between them (<xref ref-type="fig" rid="pcbi-0030186-g004">Figures 4</xref>B and <xref ref-type="fig" rid="pcbi-0030186-g004">4</xref>C; <xref ref-type="supplementary-material" rid="pcbi-0030186-se001">Text S1</xref>, Section 3). The code words broke up into clearly distinguishable sets of synonyms (<xref ref-type="fig" rid="pcbi-0030186-g004">Figure 4</xref>D), with sequences much more similar than expected by chance (<italic>p</italic>-value &lt; 0.02, estimated by using datasets with randomly permuted interactions; <xref ref-type="fig" rid="pcbi-0030186-g004">Figure 4</xref>E). These clusters essentially correspond to a refinement of <italic>H1–T1</italic> into interaction compatibility subclasses (<xref ref-type="fig" rid="pcbi-0030186-g003">Figure 3</xref>C).</p></sec><sec id="s2d"><title>Testing the Specificity Code</title><p>The organization of docking domains into compatibility classes and subclasses is striking, but perhaps circumstantial. Are there falsifiable predictions that can be tested against independent sources of data, other than those used during the original analysis? In this section, we present three tests of the specificity code. The first test is structural: by mapping our results onto an NMR structure of PKS docking domains, we ask whether the correlated residue pairs picked out by CRoSS involve actual physical interactions. The second test is statistical: we break up our data into training and test sets, using the former to make predictions, and the latter to validate them. The third test is functional: we use published experimental data involving hybrid PKS pathways to validate our classification of docking domains into compatibility classes.</p><sec id="s2d1"><title>Structural: Physically interacting residues.</title><p>A key component of our analysis, information about which protein pairs in a PKS system do or do not interact, is based on PKS multiprotein chain order, which in turn is typically inferred from the nature of the polyketide synthesized by the system. Underlying this inference is the assumption that there is only one order in which the proteins can interact, namely that which results in the correct polyketide product. Alternatively, it could be argued that protein interactions are nonspecific, and that multiprotein chains of various permutations do arise, only one of which is catalytically active and therefore detectable. Under the former hypothesis of physical specificity, we might expect some of the co-evolving residue pairs detected by CRoSS to be involved in direct physical interactions. Under the latter hypothesis of chemical specificity, co-evolution would arise indirectly due to the constraints of catalysis, and would therefore have no relationship to physical interactions. In order to distinguish between these two possibilities, we mapped our <italic>H1–T1</italic> CRoSS residues onto the only available NMR structure of a PKS docking domain interaction complex [<xref ref-type="bibr" rid="pcbi-0030186-b015">15</xref>], corresponding to an <italic>H1–T1</italic> interface between proteins 2 and 3 of the erythromycin synthase pathway (<xref ref-type="supplementary-material" rid="pcbi-0030186-se001">Text S1</xref>, Section 4). Remarkably, four of the seven CRoSS pairs mapped to residue pairs separated by 5 Å or less in the NMR structure (<xref ref-type="fig" rid="pcbi-0030186-g005">Figure 5</xref>). Of the 19 × 27 = 513 possible residue pairings between the head and tail domains, only 31 lie within this separation (<xref ref-type="fig" rid="pcbi-0030186-g005">Figure 5</xref>A). If we had selected seven residue pairs at random, we would have picked out four or more such proximate pairs with probability <italic>p</italic> = 3.4e-4. This highly significant agreement between sequence and structure provides strong, independent confirmation that CRoSS is picking out residue pairs involved in physical specificity. By the same token, it provides confidence that the structure inferred from NMR is an accurate description of the in vivo interaction complex.</p><fig id="pcbi-0030186-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030186.g005</object-id><label>Figure 5</label><caption><title>CRoSS Residues and Physical Interactions</title><p>In (B–F), symbols associated with head domains are colored red, and those associated with tail domains are colored green. This coloring is unrelated to compatibility class, as all domains pictured belong to compatibility class <italic>H1</italic>–<italic>T1</italic>.</p><p>(A) Comparison of the residues selected by CRoSS to those that are in physical contact in the docked domain NMR structure. The matrix has residues of the head domain indexed vertically, and residues of the tail domain indexed horizontally. Each entry is shaded gray if the pairwise distance between the corresponding residues is 5 Å or less, and white otherwise. The residue pairs selected by CRoSS are highlighted as red boxes; remarkably, four of the seven CRoSS pairs are separated by 5 Å or less. Residue pairs previously suggested as contributing to specificity are highlighted as blue circles: R1, suggested by Broadhurst et al. [<xref ref-type="bibr" rid="pcbi-0030186-b015">15</xref>] and Weissman [<xref ref-type="bibr" rid="pcbi-0030186-b020">20</xref>] as “code residue pairs” that play a critical role in discrimination; R2, demonstrated by Weissman [<xref ref-type="bibr" rid="pcbi-0030186-b021">21</xref>] to alter the efficiency of docking in the erythromycin PKS. It has also been suggested that the entire complement of hydrophobic residues at the docking interface might contribute to specificity [<xref ref-type="bibr" rid="pcbi-0030186-b020">20</xref>].</p><p>(B–C) Structure of the docking complex between the head domain of protein 2 (red) and the tail domain of protein 3 (green) of the erythromycin PKS [<xref ref-type="bibr" rid="pcbi-0030186-b015">15</xref>]. PKS proteins exist as homodimers, so the docking complex involves a pair of tail domains <italic>T<sub>A</sub></italic> and <italic>T<sub>B</sub></italic> (which form a coiled coil) and a pair of head domains <italic>H<sub>A</sub></italic> and <italic>H<sub>B</sub></italic> (which are alpha helices that lock around the coiled coil).</p><p>(B) Cartoon representation of the structure, showing domain labels.</p><p>(C) Space-filling representation of the structure. The head domains are now colored dark grey, and the tail domains are colored light gray, while the head and tail residues selected by CRoSS are colored red and green, respectively. The three circles indicate regions that have been magnified in subsequent panels of the figure.</p><p>(D–F) Space-filling representations of the structure, magnified around the neighborhood of the CRoSS residues. The side chains of the significant head (red) and tail (green) residues are also shown. As seen in <xref ref-type="fig" rid="pcbi-0030186-g005">Figure 5</xref>A, four out of the seven CRoSS residue pairs correspond to pairwise physical interactions: {<italic>i</italic>, <italic>j</italic>} = {6,5}, {12,12}, {13,11}, {12,16}. Note that the two copies of any residue participate in symmetric contacts, but it is not possible for CRoSS to assign which of two possible pairings, i.e., <italic>A</italic>–<italic>A</italic> and <italic>B</italic>–<italic>B</italic> versus <italic>A</italic>–<italic>B</italic> and <italic>B</italic>–<italic>A</italic>, actually occurs. For example, <italic>H<sub>B</sub></italic>6 contacts <italic>T<sub>A</sub></italic>5, while <italic>H<sub>A</sub></italic>6 contacts <italic>T<sub>B</sub></italic>5. One copy of each interacting pair is shown here: (D) <italic>H<sub>B</sub></italic>6-<italic>T<sub>A</sub></italic>5, (E) <italic>H<sub>A</sub></italic>12-<italic>T<sub>B</sub></italic>12, (E) <italic>H<sub>A</sub></italic>13-<italic>T<sub>A</sub></italic>11, (F) <italic>H<sub>B</sub></italic>12-<italic>T<sub>A</sub></italic>16. We have also highlighted (F) <italic>T<sub>A</sub></italic>18, which does not lie on the head–tail interface but is instead buried within the tail coiled-coil. It is possible that destabilization of the <italic>T<sub>A</sub></italic>18-<italic>T<sub>B</sub></italic>18 contact changes the global conformation of the coiled-coil, and thus has a long-range effect on head–tail interactions. (Similar long-range effects have been demonstrated to alter the efficiency of docking in the erythromycin PKS [<xref ref-type="bibr" rid="pcbi-0030186-b021">21</xref>].)</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030186.g005" xlink:type="simple"/></fig></sec><sec id="s2d2"><title>Statistical: Training and test data.</title><p>Any successful predictive code must be able to generalize to previously unseen data. This ability can be measured by training the code on one subset of data (e.g., allowing it to learn sequence patterns), and testing its predictions against another (e.g., applying those pattern-based rules to predict interactions). The true positive rate (TP) is the fraction of known interactors predicted to interact, while the false positive rate (FP) is the fraction of known noninteractors predicted to interact. Random guessing would give TP = FP; a code which performed better than random would have TP &gt; FP; the ideal code would have TP = 1, FP = 0. We carried out training and testing separately for the two levels of the specificity code (<xref ref-type="supplementary-material" rid="pcbi-0030186-se001">Text S1</xref>, Section 5). We found that predictions based on the classification of docking domains into compatibility classes gave TP = 0.97, FP = 0.52. That is, matching of compatibility class represents a necessary (almost all interacting pairs match) but not sufficient (half of the noninteracting pairs also match) condition for head<italic>–</italic>tail interaction, consistent with our earlier results. In contrast, predictions based on the division into subclasses performed only marginally better than random, with TP = 0.6, FP = 0.5 (<xref ref-type="supplementary-material" rid="pcbi-0030186-sg002">Figure S2</xref>). When additional CRoSS residues were included in the construction of our code words, the performance was no better than random. Thus, while we were able to identify key residue <italic>positions</italic> with excellent statistical significance (as discussed in the previous section), the identification of predictive code words proved more difficult. The reason for this is that CRoSS averages over amino acids, while code word clusters are based on the particular amino acids found at each position. Since there are many distinct code words, the connections between them become sparse, leaving the algorithm unable to generalize from training data to test data. We do expect the predictive ability of the subclass code to improve once the size of the dataset is increased, and connections become better sampled.</p></sec><sec id="s2d3"><title>Functional: Whole-protein hybrid PKS systems.</title><p>The hypothesis that docking domains from different compatibility classes cannot interact is certainly falsifiable: experimental evidence of a significant number of mismatched interactors would lead us to reject it. We see only two mismatched interactors in our dataset, one of which involves a domain that is probably misclassified (<xref ref-type="fig" rid="pcbi-0030186-g002">Figure 2</xref>C; <xref ref-type="supplementary-material" rid="pcbi-0030186-sd002">Dataset S2</xref>). On the other hand, we have a large body of evidence in favor of it, including the statistical analysis presented above. To further test the validity of the hypothesis, we looked at cases in which hybrid systems were generated by combining whole proteins from different PKS pathways. There are several reported examples of functional interactions between hererologous proteins with compatible docking domains. These include <italic>pikro_002</italic>-<italic>eryth_003</italic> [<xref ref-type="bibr" rid="pcbi-0030186-b023">23</xref>], <italic>pikro_002</italic>-<italic>olean_003</italic> [<xref ref-type="bibr" rid="pcbi-0030186-b023">23</xref>], and <italic>eryth_001</italic>-<italic>pikro_002</italic> [<xref ref-type="bibr" rid="pcbi-0030186-b024">24</xref>], all of which would require <italic>H1–T1</italic> docking (<xref ref-type="fig" rid="pcbi-0030186-g002">Figure 2</xref>B). To some extent, this is to be expected: successful hybrids tend to be made by combining closely related PKS sytems, so the sequential interactions of the parent multiprotein chains are recapitulated in the hybrid. More interestingly, an efficient nonsequential interaction was observed for <italic>eryth_001</italic>-<italic>pikro_004</italic> [<xref ref-type="bibr" rid="pcbi-0030186-b024">24</xref>], a pairing that would seem to require <italic>H1–T2</italic> docking (<xref ref-type="fig" rid="pcbi-0030186-g002">Figure 2</xref>B), thus violating the compatibility class hypothesis. Closer inspection reveals that the situation is more complicated. A successful <italic>eryth_001</italic>-<italic>pikro_004</italic> interaction ought to result in polyketide chain elongation, similar to the natural interaction between <italic>pikro_003</italic> and <italic>pikro_004</italic>; instead, it results in polyketide chain cyclization and release, similar to the nonstandard interaction between <italic>pikro_003</italic> and a truncated form of <italic>pikro_004</italic> (which lacks its N-terminal docking domain) [<xref ref-type="bibr" rid="pcbi-0030186-b025">25</xref>]. The fact that the N-terminal docking domain of <italic>pikro_004</italic> is unnecessary for the nonstandard <italic>pikro_003</italic>-<italic>pikro_004</italic> interaction suggests that it might be similarly unnecessary for the observed <italic>eryth_001</italic>-<italic>pikro_004</italic> interaction. However, this remains to be directly demonstrated. Since the nonstandard <italic>pikro_003</italic>-<italic>pikro_004</italic> interaction can occur even when the N-terminal docking domain of <italic>pikro_004</italic> is present [<xref ref-type="bibr" rid="pcbi-0030186-b026">26</xref>], and since the C-terminal docking domain of <italic>eryth_001</italic> is necessary for the <italic>eryth_001</italic>-<italic>pikro_004</italic> interaction [<xref ref-type="bibr" rid="pcbi-0030186-b024">24</xref>], the possibility of <italic>H1–T2</italic> docking cannot be ruled out. Nevertheless, when taken together, the results from hybrid pathways suggest that the classification of docking domains into compatibility classes is biologically meaningful.</p></sec></sec></sec><sec id="s3"><title>Discussion</title><p>We set out to understand the rules that governed interactions between modular PKS proteins. By focusing on the conserved N- and C-terminal docking domains, we were able to construct a predictive specificity code, and to prove that it pertained to pairwise physical interactions. This code provided us with necessary but not sufficient conditions for protein interaction, indicating that further determinants of specificity were required to explain the observed data. There have been several proposals regarding the nature of such determinants. First, it is possible that additional information is contained in the docking domains themselves (<xref ref-type="fig" rid="pcbi-0030186-g005">Figure 5</xref>A). For example, it has been suggested that interaction efficiency could be influenced by long-range electrostatic interactions between a set of “code residues” [<xref ref-type="bibr" rid="pcbi-0030186-b015">15</xref>,<xref ref-type="bibr" rid="pcbi-0030186-b020">20</xref>,<xref ref-type="bibr" rid="pcbi-0030186-b021">21</xref>] and short-range interactions between the complement of hydrophobic residues at the docking interface [<xref ref-type="bibr" rid="pcbi-0030186-b020">20</xref>]. Second, it is clear that multiple protein<italic>–</italic>protein interactions, other than those between the docking domains, can influence the efficiency and specificity of polyketide transfer. For example, truncated PKS proteins lacking N-terminal docking domains can nevertheless catalyze polyketide chain extension [<xref ref-type="bibr" rid="pcbi-0030186-b025">25</xref>], and interprotein interactions between the C-terminal ACP domain and N-terminal KS domain of adjacent proteins can mitigate the effect of mismatched docking domains [<xref ref-type="bibr" rid="pcbi-0030186-b027">27</xref>]. If such interactions are relevant, it is likely that they will influence residue co-evolution, both between docking domains as well as between other domain varieties. At our current level of sensitivity, we were able to identify a handful of residue pairs contributing to the specificity of <italic>H1–T1</italic> interactions, but were unable to find any significant pairs for the other compatibility classes. Moreover, when we applied the same analysis to the case of interactions between the much larger ACP and KS domains, we found no significant co-evolution (<xref ref-type="supplementary-material" rid="pcbi-0030186-sg001">Figures S1</xref>E and <xref ref-type="supplementary-material" rid="pcbi-0030186-sg001">S1</xref>F). If we are to increase the sensitivity of our analysis, we must increase the number of ordered PKS pathways in our dataset. Aside from waiting for more PKS pathways to be biochemically characterized, one way to achieve this would be to include putative pathways from fully sequenced genomes whose order was inferred using techniques such as those developed by Minowa et al. [<xref ref-type="bibr" rid="pcbi-0030186-b010">10</xref>] (though this runs the risk of circularity).</p><sec id="s3a"><title>Hierarchy, Modularity, and Abstraction</title><p>One of our central findings is that the PKS specificity code is hierarchical. At the highest level, there are phylogenetically diverged, extremely distinct compatibility classes of docking domains; at the next level, there are subclasses of domains that essentially differ from one another at just a few residues. As such, it is possible to achieve interactions between any pair of docking domains in a given phylogenetic class by a handful of mutations, but docking domains from different phylogenetic classes are likely to remain forever incompatible. This hierarchical organization provides important clues about the selective pressures that operate on PKS pathways. If it were possible to switch the class of any docking domain to any other by mutation, undesirable interactions in PKS multiprotein chains would arise at high frequency, reducing the overall fitness of a bacterial population. At the opposite extreme, if docking domains were all extremely distinct from one another, it would be prohibitively difficult to “reprogram” the order of a PKS multiprotein chain, so bacteria would not be sufficiently nimble in response to rapidly changing ecological conditions. The observed hierarchy of classes and subclasses might represent an optimal intermediate strategy, balancing the competing requirements of robustness and flexibility.</p><p>If we examine how PKS pathways are encoded at the genetic level, we uncover two further puzzles. First, why are the PKS docking domains positioned so close to protein termini (<xref ref-type="fig" rid="pcbi-0030186-g001">Figure 1</xref>A), when it is not uncommon to find protein<italic>–</italic>protein interaction domains deep within protein coding regions? Second, why does gene order tend to match protein order in PKS pathways, when experiments involving hybrid PKSs [<xref ref-type="bibr" rid="pcbi-0030186-b023">23</xref>,<xref ref-type="bibr" rid="pcbi-0030186-b024">24</xref>] have shown that gene order is not essential for function? The key to both these puzzles lies in the patterns of PKS pathway inheritance. If proteins were inherited in their entirety over evolutionary timescales, we would expect their N- and C-termini to have similar phylogenetic trees. Instead, we find that pairs of proteins with closely related tails can have distantly related heads and vice versa (<xref ref-type="fig" rid="pcbi-0030186-g006">Figure 6</xref>B), implying that domain shuffling occurs frequently. More remarkably, we find that the interacting domain pairs, the head of one protein and the tail of its partner, have similar phylogenies (<xref ref-type="fig" rid="pcbi-0030186-g006">Figure 6</xref>C). Interacting docking domains, <italic>straddling two proteins</italic>, constitute the unit of inheritance. This is presumably because the two also represent a unit of function, one being useless without the other. Their combined inheritance is ensured if these two protein fragments are encoded contiguously on the genome. Indeed, we find that most of the docking domain pairs in our dataset are adjacently transcribed (<xref ref-type="supplementary-material" rid="pcbi-0030186-sd002">Dataset S2</xref>). Of course, this would require that docking domains map to gene termini, and that gene order match protein order. In a world of rampant recombination and gene transfer, domain and gene order are functionally irrelevant, but evolutionarily important.</p><fig id="pcbi-0030186-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030186.g006</object-id><label>Figure 6</label><caption><title>Domain Shuffling and Domain Linkage</title><p>(A) Δ<italic>H</italic> is the fraction of amino acid differences between some pair of head domains; Δ<italic>T</italic> is the fraction of amino acid differences between some pair of tail domains. We compare the observed degree of similarity of two head domains (Δ<italic>H</italic>), with that of the two tail domains on the same proteins (Δ<italic>T</italic>) or the two tail domains that are their interaction partners (Δ<italic>T′</italic>). Each such comparison gives us a point in Δ<italic>H −</italic> Δ<italic>T</italic> space; by running over all possible pairs, we generate a family of points.</p><p>(B,C) Density plots of points in Δ<italic>H −</italic> Δ<italic>T</italic> space, with axes running from 0 (identical) to 1 (distinct). To generate these plots, a 2-D histogram was calculated by binning the data into a 10-by-10 grid, which was then smoothed by interpolation. The multimodal appearance of these plots is a manifestation of the underlying phylogenetic clusters.</p><p>(B) Density plot of Δ<italic>H</italic> versus Δ<italic>T</italic>, when the head and tail domains belong to the same protein. <italic>A priori</italic>, we expect two proteins descended from a common ancestor to show a uniform degree of sequence similarity across their entire length. Instead, we find that Δ<italic>H</italic> is largely uncorrelated with Δ<italic>T</italic> (cc = 0.13). That is, proteins with very similar head domains can have very diverged tail domains, and vice versa. This implies that proteins are not inherited in their entirety, but instead undergo frequent domain shuffling.</p><p>(C) Density plot of Δ<italic>H</italic> versus Δ<italic>T′</italic>, when the head and tail domains are interaction partners. In this case, Δ<italic>H</italic> and Δ<italic>T′</italic> are highly correlated (cc = 0.67), implying that these two domains are evolutionarily linked. Remarkably, the interacting domain pair straddling two proteins, rather than the protein itself, constitutes the true unit of inheritance.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030186.g006" xlink:type="simple"/></fig><p>The high-level structure of the PKS protein interaction code is striking. The <italic>hierarchical</italic> organization of docking domains into compatibility classes and subclasses creates multiprotein chains that are simultaneously robust and reprogrammable. A pair of interacting docking domains form a single <italic>module</italic>, a genetic unit straddling protein termini, so they are always inherited together. And the correspondence between gene order and protein order is a beautiful example of <italic>abstraction</italic>, allowing new protein configurations to be efficiently sampled through the underlying process of DNA recombination. All this amounts to a common standard for information exchange, allowing microbes to access a shared pool of biosynthetic capabilities. It would appear that PKS pathways should not simply be regarded as machines, evolved to produce this or that polyketide product. Rather, they represent a sort of genetic sketchpad, allowing biosynthesis to be abstractly represented, shared, and shuffled, in a process of continual biochemical innovation.</p></sec></sec><sec id="s4"><title>Methods</title><sec id="s4a"><title>CRoSS algorithm: Correlated residues of statistical significance.</title><p>Head and tail domains of interest were grouped by PKS pathway. For each pathway, known interactors (I) and known noninteractors (NI) were coupled, and appropriately weighted. For example, consider a hypothetical pathway which involves five proteins, with m<sub>I</sub> = 4 head–tail interfaces. Let the heads be labeled h<sub>i</sub> and the tails t<sub>i</sub>, numbered by interface i = 1, ..., m<sub>I</sub>. The I dataset will contain the m<sub>I</sub> = 4 interacting pairs {h<sub>1</sub>, t<sub>1</sub>} through {h<sub>4</sub>, t<sub>4</sub>}, each with weight w<sub>I</sub> = 1. The NI dataset will contain the m<sub>NI</sub> = 12 noninteracting pairs {h<sub>1</sub>, t<sub>2</sub>}, {h<sub>1</sub>, t<sub>3</sub>}, ..., {h<sub>4</sub>, t<sub>2</sub>}, {h<sub>4</sub>, t<sub>3</sub>}, each with a weight w<sub>NI</sub> = m<sub>I</sub>/m<sub>NI</sub> = 1/3. The total contribution of this pathway to both the I and the NI dataset will therefore be:
					<disp-formula id="pcbi-0030186-e001"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030186.e001" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:msub><mml:mtext>w</mml:mtext><mml:mtext>I</mml:mtext></mml:msub><mml:mtext>m</mml:mtext><mml:msub><mml:mtext>I</mml:mtext></mml:msub><mml:mo>&equals;</mml:mo><mml:msub><mml:mtext>w</mml:mtext><mml:mrow><mml:mtext>NI</mml:mtext></mml:mrow></mml:msub><mml:msub><mml:mtext>m</mml:mtext><mml:mrow><mml:mtext>NI</mml:mtext></mml:mrow></mml:msub><mml:mo>&equals;</mml:mo><mml:msub><mml:mtext>m</mml:mtext><mml:mtext>I</mml:mtext></mml:msub></mml:mrow></mml:math> --></disp-formula>
				</p><p>We carried out this procedure for all pathways, leaving out those with m<sub>NI</sub> = 0. The datasets I and NI each contain an ordered list of head–tail pairs indexed by r, with corresponding weights w<sub>r</sub>. The sequences of the rth domain pair are represented by binary variables as follows: <inline-formula id="pcbi-0030186-ex001"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0030186.ex001" xlink:type="simple"/></inline-formula>
					, <inline-formula id="pcbi-0030186-ex002"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0030186.ex002" xlink:type="simple"/></inline-formula>
					, where i runs over head sites and j over tail sites, and α and β run over the 20 amino acids. We next calculated the joint distribution of amino acids at some site pair {i, j}:
					<disp-formula id="pcbi-0030186-e002"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030186.e002" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:msubsup><mml:mi>&sigma;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>&alpha;</mml:mi><mml:mi>&beta;</mml:mi></mml:mrow><mml:mi>I</mml:mi></mml:msubsup><mml:mo>&equals;</mml:mo><mml:mstyle displaystyle='true'><mml:munder><mml:mo>&sum;</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>&isin;</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>&alpha;</mml:mi></mml:mrow><mml:mi>r</mml:mi></mml:msubsup></mml:mrow></mml:mstyle><mml:msubsup><mml:mi>t</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>&beta;</mml:mi></mml:mrow><mml:mi>r</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mtext>&emsp;</mml:mtext><mml:msubsup><mml:mi>&sigma;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>&alpha;</mml:mi><mml:mi>&beta;</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mi>I</mml:mi></mml:mrow></mml:msubsup><mml:mo>&equals;</mml:mo><mml:mstyle displaystyle='true'><mml:munder><mml:mo>&sum;</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>&isin;</mml:mo><mml:mi>N</mml:mi><mml:mi>I</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>&alpha;</mml:mi></mml:mrow><mml:mi>r</mml:mi></mml:msubsup></mml:mrow></mml:mstyle><mml:msubsup><mml:mi>t</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>&beta;</mml:mi></mml:mrow><mml:mi>r</mml:mi></mml:msubsup></mml:mrow></mml:math> --></disp-formula>
				</p><p>For any given site pair {i, j}, it follows from <xref ref-type="disp-formula" rid="pcbi-0030186-e001">Equation 1</xref>) that the marginal distribution of amino acids are identical:
					<disp-formula id="pcbi-0030186-e003"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030186.e003" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mstyle displaystyle='true'><mml:munder><mml:mo>&sum;</mml:mo><mml:mrow><mml:mi>&alpha;</mml:mi><mml:mi>&beta;</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msubsup><mml:mi>&sigma;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>&alpha;</mml:mi><mml:mi>&beta;</mml:mi></mml:mrow><mml:mi>I</mml:mi></mml:msubsup></mml:mrow></mml:mstyle><mml:mo>&equals;</mml:mo><mml:mstyle displaystyle='true'><mml:munder><mml:mo>&sum;</mml:mo><mml:mrow><mml:mi>&alpha;</mml:mi><mml:mi>&beta;</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msubsup><mml:mi>&sigma;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>&alpha;</mml:mi><mml:mi>&beta;</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mi>I</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle><mml:mo>,</mml:mo><mml:mtext>&emsp;</mml:mtext><mml:mstyle displaystyle='true'><mml:munder><mml:mo>&sum;</mml:mo><mml:mi>&alpha;</mml:mi></mml:munder><mml:mrow><mml:msubsup><mml:mi>&sigma;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>&alpha;</mml:mi><mml:mi>&beta;</mml:mi></mml:mrow><mml:mi>I</mml:mi></mml:msubsup></mml:mrow></mml:mstyle><mml:mo>&equals;</mml:mo><mml:mstyle displaystyle='true'><mml:munder><mml:mo>&sum;</mml:mo><mml:mi>&alpha;</mml:mi></mml:munder><mml:mrow><mml:msubsup><mml:mi>&sigma;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>&alpha;</mml:mi><mml:mi>&beta;</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mi>I</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle><mml:mo>,</mml:mo><mml:mtext>&emsp;</mml:mtext><mml:mstyle displaystyle='true'><mml:munder><mml:mo>&sum;</mml:mo><mml:mi>&beta;</mml:mi></mml:munder><mml:mrow><mml:msubsup><mml:mi>&sigma;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>&alpha;</mml:mi><mml:mi>&beta;</mml:mi></mml:mrow><mml:mi>I</mml:mi></mml:msubsup></mml:mrow></mml:mstyle><mml:mo>&equals;</mml:mo><mml:mstyle displaystyle='true'><mml:munder><mml:mo>&sum;</mml:mo><mml:mi>&beta;</mml:mi></mml:munder><mml:mrow><mml:msubsup><mml:mi>&sigma;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>&alpha;</mml:mi><mml:mi>&beta;</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mi>I</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle><mml:mo>.</mml:mo></mml:mrow></mml:math> --></disp-formula>
				</p><p>Therefore, the only way the joint distributions can be different is if they display different correlations. However, we must be careful not to take the observed correlations too seriously, given the small size of the dataset. We therefore calculated the significance of the difference between the joint distributions using a chi-squared test [<xref ref-type="bibr" rid="pcbi-0030186-b028">28</xref>]:
					<disp-formula id="pcbi-0030186-e004"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030186.e004" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:msub><mml:mi>&rho;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>&equals;</mml:mo><mml:mi>Q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>&nu;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>&chi;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math> --></disp-formula>where
					<disp-formula id="pcbi-0030186-e005"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030186.e005" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:msubsup><mml:mi>&chi;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>&equals;</mml:mo><mml:mstyle displaystyle='true'><mml:munder><mml:mo>&sum;</mml:mo><mml:mrow><mml:mi>&alpha;</mml:mi><mml:mi>&beta;</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy='false'>(</mml:mo><mml:msubsup><mml:mi>&sigma;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>&alpha;</mml:mi><mml:mi>&beta;</mml:mi></mml:mrow><mml:mi>I</mml:mi></mml:msubsup><mml:mo>&minus;</mml:mo><mml:msubsup><mml:mi>&sigma;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>&alpha;</mml:mi><mml:mi>&beta;</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mi>I</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy='false'>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mo stretchy='false'>(</mml:mo><mml:msubsup><mml:mi>&sigma;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>&alpha;</mml:mi><mml:mi>&beta;</mml:mi></mml:mrow><mml:mi>I</mml:mi></mml:msubsup><mml:mo>&plus;</mml:mo><mml:msubsup><mml:mi>&sigma;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>&alpha;</mml:mi><mml:mi>&beta;</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mi>I</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy='false'>)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle><mml:mo>,</mml:mo></mml:mrow></mml:math> --><!-- <mml:math display='block'><mml:mrow><mml:mi>Q</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>&equals;</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>&Gamma;</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy='false'>)</mml:mo></mml:mrow></mml:mfrac><mml:mstyle displaystyle='true'><mml:mrow><mml:msubsup><mml:mo>&int;</mml:mo><mml:mi>x</mml:mi><mml:mi>&infin;</mml:mi></mml:msubsup><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>&minus;</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:mstyle><mml:mo>.</mml:mo></mml:mrow></mml:math> --></disp-formula>
				</p><p>Here, ν<sub>ij</sub> is the number of bins for which either <inline-formula id="pcbi-0030186-ex003"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0030186.ex003" xlink:type="simple"/></inline-formula>
					 or <inline-formula id="pcbi-0030186-ex004"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0030186.ex004" xlink:type="simple"/></inline-formula>
					 is nonzero, Q is the incomplete gamma function, and Γ(<italic>a</italic>) is the Euler gamma function.
				</p><p>If this were a true chi-squared test, the final CRoSS matrix ρ<sub>ij</sub> would give the probability that the interaction and noninteraction distributions were drawn from the same underlying joint-distribution. The lower this value, the more significant the site pair {i, j} as a predictor of specificity. In fact, the fractional weighting used in <xref ref-type="disp-formula" rid="pcbi-0030186-e001">Equation 1</xref>) means that the values ρ<sub>ij</sub> overestimate the probability of the null hypothesis. Moreover, we are testing multiple hypotheses, one for each site pair under consideration. In choosing a threshold to classify a particular subset of site pairs as being significant, it is useful to compare the distribution of values ρ<sub>ij</sub> against a background distribution ρ<sub>ij</sub>, generated by applying CRoSS to compare random pairings with noninteractors. This is how the seven significant pairs in <xref ref-type="fig" rid="pcbi-0030186-g003">Figure 3</xref>B were identified (<xref ref-type="supplementary-material" rid="pcbi-0030186-sg001">Figure S1</xref>C).</p><p>CRoSS was implemented in MATLAB (The MathWorks).</p></sec></sec><sec id="s5"><title>Supporting Information</title><supplementary-material id="pcbi-0030186-sd001" mimetype="text/plain" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030186.sd001" xlink:type="simple"><label>Dataset S1</label><caption><title>List of PKS Pathways, Abbreviations, and Data Sources</title><p>(11 KB TXT)</p></caption></supplementary-material><supplementary-material id="pcbi-0030186-sd002" mimetype="text/plain" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030186.sd002" xlink:type="simple"><label>Dataset S2</label><caption><title>Compatibility Class Multiple Sequence Alignments</title><p>(13 KB TXT)</p></caption></supplementary-material><supplementary-material id="pcbi-0030186-sg001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030186.sg001" xlink:type="simple"><label>Figure S1</label><caption><title>Selecting Significant CRoSS Residue Pairs</title><p>(A) The <italic>H1–T1</italic> control matrix (also shown in <xref ref-type="fig" rid="pcbi-0030186-g003">Figure 3</xref>A), generated by using CRoSS to compare random pairings with noninteractors, has entries -log<sub>10</sub>(<italic>ρ</italic><sup>0</sup><italic><sub>ij</sub></italic>).</p><p>(B) The <italic>H1–T1</italic> interaction matrix (also shown in <xref ref-type="fig" rid="pcbi-0030186-g003">Figure 3</xref>B), generated by using CRoSS to compare interactors with noninteractors, has entries -log<sub>10</sub>(<italic>ρ<sub>ij</sub></italic>).</p><p>(C) Cumulative histograms of the values log<sub>10</sub>(<italic>ρ</italic><sup>0</sup><italic><sub>ij</sub></italic>) (blue) and log<sub>10</sub>(<italic>ρ<sub>ij</sub></italic>) (red). The distribution of <italic>ρ-</italic>values in the CRoSS interaction matrix coincides with that of the control matrix above <italic>ρ</italic> ∼ 10<sup>−1</sup>. However, the CRoSS interaction matrix shows a tail of much lower <italic>ρ</italic>-values. The seven lowest points were selected as representing significant CRoSS pairs.</p><p>(D) Significance and mutual information. For each site pair, we know the joint distribution of amino acids for interactors, as well as for noninteractors (<xref ref-type="sec" rid="s4">Methods</xref>, <xref ref-type="disp-formula" rid="pcbi-0030186-e002">Equation 2</xref>). CRoSS calculates a significance score <italic>ρ</italic>, which reports the probability that these two observed distributions could arise from the same underlying distribution. In screening for co-evolving pairs, an alternative approach would be to use the interactor joint distribution alone, and to measure the mutual information between the head and tail amino acids (closely related to the approach used in [<xref ref-type="bibr" rid="pcbi-0030186-b017">17</xref>] and [<xref ref-type="bibr" rid="pcbi-0030186-b018">18</xref>]). To compare these two approaches, we plotted mutual information (in natural logarithms) against the significance <italic>ρ</italic>, for all site pairs. The two most significant points have the highest mutual information, and all seven chosen points (red) have high mutual information as expected, since they are useful predictors of specificity. However, there is a cloud of points of low significance (black) which show a spread of mutual information values. Selecting site pairs based on mutual information alone would tend to include a large number of spurious correlations, or to exclude most of the important correlations.</p><p>(E<italic>–</italic>F) Interactions between ACP and KS domains have been shown to contribute to specificity [<xref ref-type="bibr" rid="pcbi-0030186-b027">27</xref>]. We analyzed the C-terminal ACP domains and N-terminal KS domains adjacent to the 90 <italic>H1–T1</italic> docking domain pairs in our dataset, precisely as we had done for the docking domains themselves. Starting with a multiple-sequence alignment, we applied CRoSS to detect co-evolving residues by comparing interactors with noninteractors (<italic>ρ<sub>ij</sub></italic>). We also applied CRoSS on a control dataset, comparing random pairings with noninteractors (<italic>ρ</italic><sup>0</sup><italic><sub>ij</sub></italic>).</p><p>(E) The ACP-KS CRoSS interaction matrix shows very low signals (note the color scale, which is different from that used in <xref ref-type="supplementary-material" rid="pcbi-0030186-sg001">Figure S1</xref>B).</p><p>(F) CRoSS entries in the interaction (red) and control (blue) matrices are comparable, indicating that there are no significant co-evolving pairs.</p><p>(1.6 MB PDF)</p></caption></supplementary-material><supplementary-material id="pcbi-0030186-sg002" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030186.sg002" xlink:type="simple"><label>Figure S2</label><caption><title>Measuring the Predictive Ability of the Subclass Code</title><p>(A) Receiver operating characteristics (ROC) for predictions based on Monte Carlo clustering. Each curve shows the TP rate versus the FP rate, as the clustering threshold <italic>N<sub>min</sub></italic> is varied from high (TP = FP = 0) to low (TP = FP = 1). Curves of different colors correspond to different partitions of the data into training and test sets.</p><p>B) Interpolated ROC curves were used to calculate the FP value at each TP value, for each of the 15 training and test sets. Here we show the mean ROC value (black) along with one standard error on each side (gray) as a function of TP values. A random classifier would trace the curve TP = FP (red), while the ROC of a classifier that performed better than random would lie above this diagonal. The performance of our code is marginally better than random, but statistically significant. The performance tends to be better at higher FP values. The mean area under the ROC is 0.55 ± 0.02, and at FP = 0.5, we have TP = 0.6.</p><p>(C) Performance of the code as a predictor of PKS multiprotein chain order. Consider a hypothetical five-protein chain for which the termini (1, 5) are specified, so the three internal proteins (2, 3, 4) can have six possible permutations. Using FP = 0.5 and TP = 0.6, we generated a possible prediction of pairwise docking domain interactions based on the correct underlying multiprotein chain permutation. We then used Bayesian inference to assign a posterior probability to the six possible permutations given the prediction, and selected the permutation with the maximum posterior probability. (The six possible permutations correspond to six allowed types of pairwise interactions between the four internal head<italic>–</italic>tail pairs of the multiprotein chain. These are represented as six 4 × 4 matrices with a single entry in each row and column.) This procedure was repeated for 1,000 trials. The figure shows the fraction of trials in which each of the six possible permutations was selected as being most likely. We see that the correct permutation is chosen in 42% of instances. Random guessing would pick the correct permutation in 16.7% of instances, so our performance is 2.5 times better than random.</p><p>(1.1 MB PDF)</p></caption></supplementary-material><supplementary-material id="pcbi-0030186-se001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030186.sd003" xlink:type="simple"><label>Text S1</label><caption><title>Supporting Analysis</title><p>(281 KB PDF)</p></caption></supplementary-material></sec></body><back><ack><p>We would like to thank Jitu Mayor for bringing polyketides to our attention, and Tilmann Weber for very useful discussions about PKS biology and biochemistry. We would especially like to acknowledge the contribution of Andrei Lupas and his group, from whom we learned a great deal about the use of bioinformatic techniques to analyze protein structure and function.</p></ack><glossary><title>Abbreviations</title><def-list><def-item><term>CRoSS</term><def><p>correlated residues of statistical significance</p></def></def-item><def-item><term>FP</term><def><p>false positive</p></def></def-item><def-item><term>PKS</term><def><p>polyketide synthase</p></def></def-item><def-item><term>ROC</term><def><p>receiver operating characteristics</p></def></def-item><def-item><term>TP</term><def><p>true positive</p></def></def-item></def-list></glossary><ref-list><title>References</title><ref id="pcbi-0030186-b001"><label>1</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Staunton</surname><given-names>J</given-names></name><name name-style="western"><surname>Weissman</surname><given-names>KJ</given-names></name></person-group>
					<year>2001</year>
					<article-title>Polyketide biosynthesis: A millennium review.</article-title>
					<source>Nat Prod Rep</source>
					<volume>18</volume>
					<fpage>380</fpage>
					<lpage>416</lpage>
				</element-citation></ref><ref id="pcbi-0030186-b002"><label>2</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Khosla</surname><given-names>C</given-names></name><name name-style="western"><surname>Gokhale</surname><given-names>RS</given-names></name><name name-style="western"><surname>Jacobsen</surname><given-names>JR</given-names></name><name name-style="western"><surname>Cane</surname><given-names>DE</given-names></name></person-group>
					<year>1999</year>
					<article-title>Tolerance and specificity of polyketide synthases.</article-title>
					<source>Annu Rev Biochem</source>
					<volume>68</volume>
					<fpage>291</fpage>
					<lpage>253</lpage>
				</element-citation></ref><ref id="pcbi-0030186-b003"><label>3</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Watanabe</surname><given-names>K</given-names></name><name name-style="western"><surname>Wang</surname><given-names>CCC</given-names></name><name name-style="western"><surname>Boddy</surname><given-names>CN</given-names></name><name name-style="western"><surname>Cane</surname><given-names>DE</given-names></name><name name-style="western"><surname>Khosla</surname><given-names>C</given-names></name></person-group>
					<year>2003</year>
					<article-title>Understanding substrate specificity of polyketide synthase modules by generating hybrid multimodular synthases.</article-title>
					<source>J Biol Chem</source>
					<volume>278</volume>
					<fpage>42020</fpage>
					<lpage>42026</lpage>
				</element-citation></ref><ref id="pcbi-0030186-b004"><label>4</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Leadlay</surname><given-names>PF</given-names></name></person-group>
					<year>1997</year>
					<article-title>Combinatorial approaches to polyketide biosynthesis.</article-title>
					<source>Curr Op Chem Biol</source>
					<volume>1</volume>
					<fpage>162</fpage>
					<lpage>166</lpage>
				</element-citation></ref><ref id="pcbi-0030186-b005"><label>5</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Weissman</surname><given-names>KJ</given-names></name><name name-style="western"><surname>Leadlay</surname><given-names>PF</given-names></name></person-group>
					<year>2005</year>
					<article-title>Combinatorial biosynthesis of reduced polyketides.</article-title>
					<source>Nat Rev Microbiol</source>
					<volume>3</volume>
					<fpage>925</fpage>
					<lpage>936</lpage>
				</element-citation></ref><ref id="pcbi-0030186-b006"><label>6</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>McDaniel</surname><given-names>R</given-names></name><name name-style="western"><surname>Welch</surname><given-names>M</given-names></name><name name-style="western"><surname>Hutchinson</surname><given-names>CR</given-names></name></person-group>
					<year>2005</year>
					<article-title>Genetic approaches to polyketide antibiotics.</article-title>
					<source>Chem Rev</source>
					<volume>105</volume>
					<fpage>543</fpage>
					<lpage>558</lpage>
				</element-citation></ref><ref id="pcbi-0030186-b007"><label>7</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Yadav</surname><given-names>G</given-names></name><name name-style="western"><surname>Gokhale</surname><given-names>RS</given-names></name><name name-style="western"><surname>Mohanty</surname><given-names>D</given-names></name></person-group>
					<year>2003</year>
					<article-title>Computational approach for prediction of domain organization and substrate specificity of modular polyketide synthases.</article-title>
					<source>J Mol Biol</source>
					<volume>328</volume>
					<fpage>335</fpage>
					<lpage>363</lpage>
				</element-citation></ref><ref id="pcbi-0030186-b008"><label>8</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Ansari</surname><given-names>MZ</given-names></name><name name-style="western"><surname>Yadav</surname><given-names>G</given-names></name><name name-style="western"><surname>Gokhale</surname><given-names>RS</given-names></name><name name-style="western"><surname>Mohanty</surname><given-names>D</given-names></name></person-group>
					<year>2004</year>
					<article-title>NRPS-PKS: A knowledge-based resource for analysis of NRPS/PKS megasynthases.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>32</volume>
					<fpage>W405</fpage>
					<lpage>W413</lpage>
				</element-citation></ref><ref id="pcbi-0030186-b009"><label>9</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Rausch</surname><given-names>C</given-names></name><name name-style="western"><surname>Weber</surname><given-names>T</given-names></name><name name-style="western"><surname>Kohlbacher</surname><given-names>O</given-names></name><name name-style="western"><surname>Wohlleben</surname><given-names>W</given-names></name><name name-style="western"><surname>Huson</surname><given-names>DH</given-names></name></person-group>
					<year>2005</year>
					<article-title>Specificity prediction of adenylation domains in nonribosomal peptide synthases (NRPS) using transductive support vector machines (TSVMs).</article-title>
					<source>Nucleic Acids Res</source>
					<volume>33</volume>
					<fpage>5799</fpage>
					<lpage>5808</lpage>
				</element-citation></ref><ref id="pcbi-0030186-b010"><label>10</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Minowa</surname><given-names>Y</given-names></name><name name-style="western"><surname>Araki</surname><given-names>M</given-names></name><name name-style="western"><surname>Kanehisa</surname><given-names>M</given-names></name></person-group>
					<year>2007</year>
					<article-title>Comprehensive analysis of distinctive polyketide and nonribosomal peptide structural motifs encoded in microbial Genomes.</article-title>
					<source>J Mol Biol</source>
					<volume>368</volume>
					<fpage>1500</fpage>
					<lpage>1517</lpage>
				</element-citation></ref><ref id="pcbi-0030186-b011"><label>11</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Ratsch</surname><given-names>G</given-names></name><name name-style="western"><surname>Sonnenburg</surname><given-names>S</given-names></name><name name-style="western"><surname>Schafer</surname><given-names>C</given-names></name></person-group>
					<year>2006</year>
					<article-title>Learning interpretable SVMs for biological sequence classification.</article-title>
					<source>BMC Bioinformatics</source>
					<volume>7</volume>
					<fpage>S9</fpage>
				</element-citation></ref><ref id="pcbi-0030186-b012"><label>12</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Jenke-Kodama</surname><given-names>H</given-names></name><name name-style="western"><surname>Borner</surname><given-names>T</given-names></name><name name-style="western"><surname>Dittmann</surname><given-names>E</given-names></name></person-group>
					<year>2006</year>
					<article-title>Natural biocombinatorics in the polyketide synthase genes of the actinobacterium streptomyces avermitilis.</article-title>
					<source>PLoS Comp Biol</source>
					<volume>2</volume>
					<elocation-id>e132</elocation-id>
					<comment>doi:<ext-link ext-link-type="doi" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.0020132" xlink:type="simple">10.1371/journal.pcbi.0020132</ext-link></comment>
				</element-citation></ref><ref id="pcbi-0030186-b013"><label>13</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Gokhale</surname><given-names>RS</given-names></name><name name-style="western"><surname>Tsuji</surname><given-names>SY</given-names></name><name name-style="western"><surname>Cane</surname><given-names>DE</given-names></name><name name-style="western"><surname>Khosla</surname><given-names>C</given-names></name></person-group>
					<year>1999</year>
					<article-title>Dissecting and exploiting intermodular communication in polyketide synthases.</article-title>
					<source>Science</source>
					<volume>284</volume>
					<fpage>482</fpage>
					<lpage>485</lpage>
				</element-citation></ref><ref id="pcbi-0030186-b014"><label>14</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Tsuji</surname><given-names>SY</given-names></name><name name-style="western"><surname>Cane</surname><given-names>DE</given-names></name><name name-style="western"><surname>Khosla</surname><given-names>CK</given-names></name></person-group>
					<year>2001</year>
					<article-title>Selective protein–protein interactions direct channeling of intermediates between polyketide synthase modules.</article-title>
					<source>Biochemistry</source>
					<volume>40</volume>
					<fpage>2326</fpage>
					<lpage>2331</lpage>
				</element-citation></ref><ref id="pcbi-0030186-b015"><label>15</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Broadhurst</surname><given-names>RW</given-names></name><name name-style="western"><surname>Nietlispach</surname><given-names>D</given-names></name><name name-style="western"><surname>Wheatcroft</surname><given-names>MP</given-names></name><name name-style="western"><surname>Leadlay</surname><given-names>PF</given-names></name><name name-style="western"><surname>Weissman</surname><given-names>KJ</given-names></name></person-group>
					<year>2003</year>
					<article-title>The structure of docking domains in modular polyketide synthases.</article-title>
					<source>Chem Biol</source>
					<volume>10</volume>
					<fpage>723</fpage>
					<lpage>731</lpage>
				</element-citation></ref><ref id="pcbi-0030186-b016"><label>16</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Fricke</surname><given-names>T</given-names></name><name name-style="western"><surname>Lupas</surname><given-names>A</given-names></name></person-group>
					<year>2004</year>
					<article-title>CLANS: A Java application for visualizing protein families based on pairwise similarity.</article-title>
					<source>Bioinformatics</source>
					<volume>20</volume>
					<fpage>3702</fpage>
					<lpage>3704</lpage>
				</element-citation></ref><ref id="pcbi-0030186-b017"><label>17</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Lockless</surname><given-names>SW</given-names></name><name name-style="western"><surname>Ranganathan</surname><given-names>R</given-names></name></person-group>
					<year>1999</year>
					<article-title>Evolutionarily conserved pathways of energetic connectivity in protein families.</article-title>
					<source>Science</source>
					<volume>286</volume>
					<fpage>295</fpage>
					<lpage>299</lpage>
				</element-citation></ref><ref id="pcbi-0030186-b018"><label>18</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Süel</surname><given-names>GM</given-names></name><name name-style="western"><surname>Lockless</surname><given-names>SW</given-names></name><name name-style="western"><surname>Wall</surname><given-names>MA</given-names></name><name name-style="western"><surname>Ranganathan</surname><given-names>R</given-names></name></person-group>
					<year>2003</year>
					<article-title>Evolutionarily conserved networks of residues mediate allosteric communication in proteins.</article-title>
					<source>Nat Struct Biol</source>
					<volume>10</volume>
					<fpage>59</fpage>
					<lpage>69</lpage>
				</element-citation></ref><ref id="pcbi-0030186-b019"><label>19</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Hoch</surname><given-names>JA</given-names></name></person-group>
					<year>2000</year>
					<article-title>Two-component and phosphorelay signal transduction.</article-title>
					<source>Curr Opin Microbiol</source>
					<volume>3</volume>
					<fpage>165</fpage>
					<lpage>170</lpage>
				</element-citation></ref><ref id="pcbi-0030186-b020"><label>20</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Weissman</surname><given-names>KJ</given-names></name></person-group>
					<year>2006</year>
					<article-title>The structural basis for docking in modular polyketide biosynthesis.</article-title>
					<source>Chem Bio Chem</source>
					<volume>7</volume>
					<fpage>485</fpage>
					<lpage>494</lpage>
				</element-citation></ref><ref id="pcbi-0030186-b021"><label>21</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Weissman</surname><given-names>KJ</given-names></name></person-group>
					<year>2006</year>
					<article-title>Single amino acid substitutions alter the efficiency of docking in modular polyketide biosynthesis.</article-title>
					<source>Chem Bio Chem</source>
					<volume>7</volume>
					<fpage>1334</fpage>
					<lpage>1342</lpage>
				</element-citation></ref><ref id="pcbi-0030186-b022"><label>22</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>van Nimwegen</surname><given-names>E</given-names></name><name name-style="western"><surname>Zavolan</surname><given-names>M</given-names></name><name name-style="western"><surname>Rajewsky</surname><given-names>N</given-names></name><name name-style="western"><surname>Siggia</surname><given-names>ED</given-names></name></person-group>
					<year>2002</year>
					<article-title>Probabilistic clustering of sequences: Inferring new bacterial regulons by comparative genomics.</article-title>
					<source>Proc Natl Acad Sci U S A</source>
					<volume>99</volume>
					<fpage>7323</fpage>
					<lpage>7328</lpage>
				</element-citation></ref><ref id="pcbi-0030186-b023"><label>23</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Tang</surname><given-names>L</given-names></name><name name-style="western"><surname>Fu</surname><given-names>H</given-names></name><name name-style="western"><surname>McDaniel</surname><given-names>R</given-names></name></person-group>
					<year>2000</year>
					<article-title>Formation of functional heterologous complexes using subunits from the picromycin, erythromycin and oleandomycin polyketide synthases.</article-title>
					<source>Chem Biol</source>
					<volume>7</volume>
					<fpage>77</fpage>
					<lpage>84</lpage>
				</element-citation></ref><ref id="pcbi-0030186-b024"><label>24</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Kim</surname><given-names>BS</given-names></name><name name-style="western"><surname>Cropp</surname><given-names>A</given-names></name><name name-style="western"><surname>Florova</surname><given-names>G</given-names></name><name name-style="western"><surname>Lindsay</surname><given-names>Y</given-names></name><name name-style="western"><surname>Sherman</surname><given-names>DH</given-names></name><etal/></person-group>
					<year>2002</year>
					<article-title>An unexpected interaction between the modular polyketide synthases, erythromycin DEBS1 and pikromycin PikAIV, leads to efficient triketide lactone synthesis.</article-title>
					<source>Biochemistry</source>
					<volume>41</volume>
					<fpage>10827</fpage>
					<lpage>10833</lpage>
				</element-citation></ref><ref id="pcbi-0030186-b025"><label>25</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Xue</surname><given-names>Y</given-names></name><name name-style="western"><surname>Sherman</surname><given-names>DH</given-names></name></person-group>
					<year>2000</year>
					<article-title>Alternative modular polyketide synthase expression controls macrolactone structure.</article-title>
					<source>Nature</source>
					<volume>403</volume>
					<fpage>571</fpage>
					<lpage>575</lpage>
				</element-citation></ref><ref id="pcbi-0030186-b026"><label>26</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Aldrich</surname><given-names>CC</given-names></name><name name-style="western"><surname>Beck</surname><given-names>BJ</given-names></name><name name-style="western"><surname>Fecik</surname><given-names>RA</given-names></name><name name-style="western"><surname>Sherman</surname><given-names>DH</given-names></name></person-group>
					<year>2005</year>
					<article-title>Biochemical investigation of pikromycin biosynthesis employing native penta- and hexaketide chain elongation intermediates.</article-title>
					<source>J Am Chem Soc</source>
					<volume>127</volume>
					<fpage>8441</fpage>
					<lpage>8452</lpage>
				</element-citation></ref><ref id="pcbi-0030186-b027"><label>27</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Wu</surname><given-names>N</given-names></name><name name-style="western"><surname>Cane</surname><given-names>DE</given-names></name><name name-style="western"><surname>Khosla</surname><given-names>C</given-names></name></person-group>
					<year>2002</year>
					<article-title>Quantitative analysis of the relative contributions of donor acyl carrier proteins, acceptor ketosynthases, and linker regions to intermodular transfer of intermediates in hybrid polyketide synthases.</article-title>
					<source>Biochemistry</source>
					<volume>41</volume>
					<fpage>5056</fpage>
					<lpage>5066</lpage>
				</element-citation></ref><ref id="pcbi-0030186-b028"><label>28</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Press</surname><given-names>WH</given-names></name><name name-style="western"><surname>Teukolsky</surname><given-names>SA</given-names></name><name name-style="western"><surname>Vetterling</surname><given-names>WT</given-names></name><name name-style="western"><surname>Flannery</surname><given-names>BP</given-names></name></person-group>
					<year>1997</year>
					<source>Numerical recipes in C</source>
					<publisher-loc>Cambridge (United Kingdom)</publisher-loc>
					<publisher-name>Cambridge University Press</publisher-name>
					<fpage>620</fpage>
					<lpage>623</lpage>
				</element-citation></ref><ref id="pcbi-0030186-b029"><label>29</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Clamp</surname><given-names>M</given-names></name><name name-style="western"><surname>Cuff</surname><given-names>J</given-names></name><name name-style="western"><surname>Searle</surname><given-names>SM</given-names></name><name name-style="western"><surname>Barton</surname><given-names>GJ</given-names></name></person-group>
					<year>2004</year>
					<article-title>The Jalview Java Alignment Editor.</article-title>
					<source>Bioinformatics</source>
					<volume>12</volume>
					<fpage>426</fpage>
					<lpage>427</lpage>
				</element-citation></ref></ref-list></back></article>