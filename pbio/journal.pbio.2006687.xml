<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article article-type="research-article" dtd-version="1.1d3" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">plosbiol</journal-id>
<journal-title-group>
<journal-title>PLOS Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1544-9173</issn>
<issn pub-type="epub">1545-7885</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pbio.2006687</article-id>
<article-id pub-id-type="publisher-id">pbio.2006687</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Methods and Resources</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Digestive system</subject><subj-group><subject>Gastrointestinal tract</subject><subj-group><subject>Colon</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Digestive system</subject><subj-group><subject>Gastrointestinal tract</subject><subj-group><subject>Colon</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Ecology</subject><subj-group><subject>Ecological metrics</subject><subj-group><subject>Species diversity</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Ecology and environmental sciences</subject><subj-group><subject>Ecology</subject><subj-group><subject>Ecological metrics</subject><subj-group><subject>Species diversity</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Statistics</subject><subj-group><subject>Statistical data</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Genome analysis</subject><subj-group><subject>Transcriptome analysis</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Genomics</subject><subj-group><subject>Genome analysis</subject><subj-group><subject>Transcriptome analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Data visualization</subject><subj-group><subject>Infographics</subject><subj-group><subject>Graphs</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Blood cells</subject><subj-group><subject>White blood cells</subject><subj-group><subject>T cells</subject><subj-group><subject>Cytotoxic T cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Immune cells</subject><subj-group><subject>White blood cells</subject><subj-group><subject>T cells</subject><subj-group><subject>Cytotoxic T cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Immunology</subject><subj-group><subject>Immune cells</subject><subj-group><subject>White blood cells</subject><subj-group><subject>T cells</subject><subj-group><subject>Cytotoxic T cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Immunology</subject><subj-group><subject>Immune cells</subject><subj-group><subject>White blood cells</subject><subj-group><subject>T cells</subject><subj-group><subject>Cytotoxic T cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Information technology</subject><subj-group><subject>Data processing</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Mathematical and statistical techniques</subject><subj-group><subject>Cluster analysis</subject><subj-group><subject>Hierarchical clustering</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Quantitative assessment of cell population diversity in single-cell landscapes</article-title>
<alt-title alt-title-type="running-head">Hierachical tree comparisons of single-cell diversity landscapes</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Liu</surname>
<given-names>Qi</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Herring</surname>
<given-names>Charles A.</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Sheng</surname>
<given-names>Quanhu</given-names>
</name>
<role content-type="http://credit.casrai.org/">Software</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Ping</surname>
<given-names>Jie</given-names>
</name>
<role content-type="http://credit.casrai.org/">Data curation</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Simmons</surname>
<given-names>Alan J.</given-names>
</name>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
<xref ref-type="aff" rid="aff005"><sup>5</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Chen</surname>
<given-names>Bob</given-names>
</name>
<role content-type="http://credit.casrai.org/">Software</role>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
<xref ref-type="aff" rid="aff005"><sup>5</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Banerjee</surname>
<given-names>Amrita</given-names>
</name>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
<xref ref-type="aff" rid="aff005"><sup>5</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Li</surname>
<given-names>Wei</given-names>
</name>
<role content-type="http://credit.casrai.org/">Resources</role>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
<xref ref-type="aff" rid="aff006"><sup>6</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Gu</surname>
<given-names>Guoqiang</given-names>
</name>
<role content-type="http://credit.casrai.org/">Resources</role>
<xref ref-type="aff" rid="aff005"><sup>5</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Coffey</surname>
<given-names>Robert J.</given-names>
</name>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
<xref ref-type="aff" rid="aff005"><sup>5</sup></xref>
<xref ref-type="aff" rid="aff006"><sup>6</sup></xref>
<xref ref-type="aff" rid="aff007"><sup>7</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Shyr</surname>
<given-names>Yu</given-names>
</name>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-8438-0319</contrib-id>
<name name-style="western">
<surname>Lau</surname>
<given-names>Ken S.</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
<xref ref-type="aff" rid="aff005"><sup>5</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001"><label>1</label> <addr-line>Department of Biostatistics, Vanderbilt University Medical Center, Nashville, Tennessee, United States of America</addr-line></aff>
<aff id="aff002"><label>2</label> <addr-line>Center for Quantitative Sciences, Vanderbilt University Medical Center, Nashville, Tennessee, United States of America</addr-line></aff>
<aff id="aff003"><label>3</label> <addr-line>Epithelial Biology Center, Vanderbilt University Medical Center, Nashville, Tennessee, United States of America</addr-line></aff>
<aff id="aff004"><label>4</label> <addr-line>Program in Chemical and Physical Biology, Vanderbilt University School of Medicine, Nashville, Tennessee, United States of America</addr-line></aff>
<aff id="aff005"><label>5</label> <addr-line>Department of Cell and Developmental Biology, Vanderbilt University School of Medicine, Nashville, Tennessee, United States of America</addr-line></aff>
<aff id="aff006"><label>6</label> <addr-line>Department of Medicine, Vanderbilt University Medical Center, Nashville, Tennessee, United States of America</addr-line></aff>
<aff id="aff007"><label>7</label> <addr-line>Veterans Affairs Medical Center, Tennessee Valley Healthcare System, Nashville, Tennessee, United States of America</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Huang</surname>
<given-names>Sui</given-names>
</name>
<role>Academic Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1"><addr-line>Institute for Systems Biology, United States of America</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">qi.liu@vanderbilt.edu</email> (QL); <email xlink:type="simple">ken.s.lau@vanderbilt.edu</email> (KSL)</corresp>
</author-notes>
<pub-date pub-type="epub">
<day>22</day>
<month>10</month>
<year>2018</year>
</pub-date>
<pub-date pub-type="collection">
<month>10</month>
<year>2018</year>
</pub-date>
<volume>16</volume>
<issue>10</issue>
<elocation-id>e2006687</elocation-id>
<history>
<date date-type="received">
<day>16</day>
<month>5</month>
<year>2018</year>
</date>
<date date-type="accepted">
<day>1</day>
<month>10</month>
<year>2018</year>
</date>
</history>
<permissions>
<copyright-year>2018</copyright-year>
<copyright-holder>Liu et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pbio.2006687"/>
<abstract>
<p>Single-cell RNA sequencing (scRNA-seq) has become a powerful tool for the systematic investigation of cellular diversity. As a number of computational tools have been developed to identify and visualize cell populations within a single scRNA-seq dataset, there is a need for methods to quantitatively and statistically define proportional shifts in cell population structures across datasets, such as expansion or shrinkage or emergence or disappearance of cell populations. Here we present sc-UniFrac, a framework to statistically quantify compositional diversity in cell populations between single-cell transcriptome landscapes. sc-UniFrac enables sensitive and robust quantification in simulated and experimental datasets in terms of both population identity and quantity. We have demonstrated the utility of sc-UniFrac in multiple applications, including assessment of biological and technical replicates, classification of tissue phenotypes and regional specification, identification and definition of altered cell infiltrates in tumorigenesis, and benchmarking batch-correction tools. sc-UniFrac provides a framework for quantifying diversity or alterations in cell populations across conditions and has broad utility for gaining insight into tissue-level perturbations at the single-cell resolution.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>Single-cell technologies generate hundreds to thousands of data points per sample, presenting a conundrum in determining similarities and differences across multiple samples. Currently, similarity is determined by the degree of “intermixing” of data points among samples, a local approach, but this approach cannot accurately evaluate the similarity of samples with cell populations close in data space but not overlapping. We present sc-UniFrac, an approach to compare hierarchical trees that represent single-cell landscapes, taking both global and local similarities into account. Furthermore, sc-UniFrac allows cells that drive differences between samples to be easily identified as unbalanced branches on trees. We used sc-UniFrac to evaluate experimental design based on biological and technical replicates, regional specification of brain cells, degree and identity of stromal infiltrate into tumor, and computational batch-correction tools. sc-UniFrac will be an important analysis tool going forward as the cost of single-cell technologies drops and more studies adopt multi-sample experimental designs.</p>
</abstract>
<funding-group>
<funding-statement>NCI (grant number U01CA215798). KSL, AJS. The funder had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript. NIDDK (grant number R01DK103831). KSL, AB, AJS. The funder had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript. NCI (grant number P50CA095103). QL, KSL, RJC. The funder had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript. NICHD (grant number T32HD007502). CAH. The funder had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript. NIGMS (grant number F31 GM120940). CAH. The funder had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript. NCI (grant number R35CA197570). RJC, WL. The funder had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript. NCI (grant number P30CA068485). YS, KSL, RJC, QS, JP. The funder had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript. NIDDK (grant number R01DK065949). GG. The funder had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript. NLM (grant number T32LM012412). BC. The funder had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript. NCI (grant number U2CCA233291). QL, JP, QS. The funder had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="8"/>
<table-count count="1"/>
<page-count count="29"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2018-11-01</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>Relevant processed data are within the paper and its Supporting Information Files (<xref ref-type="supplementary-material" rid="pbio.2006687.s012">S1 Data</xref> through <xref ref-type="supplementary-material" rid="pbio.2006687.s015">S4 Data</xref>) and <ext-link ext-link-type="uri" xlink:href="https://github.com/KenLauLab/pCreode_Comparison_Across_Datasets" xlink:type="simple">https://github.com/KenLauLab/pCreode_Comparison_Across_Datasets</ext-link>. Raw scRNA-seq data generated by this study are available from NCBI GEO (accession numbers: GSE114044, GSE117615, GSE117616).</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Single-cell sequencing technologies enable profiling of hundreds to thousands of individual cells from a tissue composed of diverse cell types [<xref ref-type="bibr" rid="pbio.2006687.ref001">1</xref>–<xref ref-type="bibr" rid="pbio.2006687.ref008">8</xref>]. The rapid advances in single-cell technologies have led to a proliferation of novel computational tools. Current analyses mainly focus on identification of cell populations and transitional trajectories from data obtained from a single sample (reviewed in [<xref ref-type="bibr" rid="pbio.2006687.ref009">9</xref>–<xref ref-type="bibr" rid="pbio.2006687.ref012">12</xref>]). While these tools can shed light on complex biological processes within a given sample [<xref ref-type="bibr" rid="pbio.2006687.ref013">13</xref>], it is becoming apparent that the power of single-cell technologies lies in multi-sample experiments, for which the response of single cells—in terms of identity and quantity following multiple perturbations—can be assessed. This poses a new statistical challenge: given that each sample is composed of transcriptomes from hundreds to thousands of individual cells, how does one compare across different samples to statistically assess population diversity and to detect population changes in an unbiased manner? As an increasing number of studies are generating single-cell RNA sequencing (scRNA-seq) data from multiple samples, there is an unmet need for a statistical framework that enables quantitative comparisons across different single-cell landscapes. Such a framework would have wide application from quantitatively uncovering cell population changes and assessing batch effect correction methods to classifying disease subtypes based upon single-cell landscapes.</p>
<p>There currently exists a paucity of approaches to determine cellular composition similarities and differences between samples. Citrus is a supervised approach for identifying cell populations that are significantly different between specified outcomes, and its goal is distinct from unsupervised comparison of samples based on similarities [<xref ref-type="bibr" rid="pbio.2006687.ref014">14</xref>]. Another approach uses the Wasserstein metric known as Earth Mover’s Distance (EMD), which is a measure of the distance between two probability distributions over a certain data space [<xref ref-type="bibr" rid="pbio.2006687.ref015">15</xref>]. Briefly, EMD partitions the entire data space into bins and measures the cost of transfer of data points from one distribution across these bins to resemble the other distribution. Orlova and colleagues applied EMD across datasets to quantify the similarity of two cell populations by measuring the distance between expression distributions in two-dimensional marker space [<xref ref-type="bibr" rid="pbio.2006687.ref016">16</xref>]. However, partition of data spaces into bins has an exponential computational cost as the number of dimensions increases, limiting EMD use to one- or two-dimensional data spaces. Although there are multiple dimension-reduction approaches for high-dimensional data [<xref ref-type="bibr" rid="pbio.2006687.ref011">11</xref>,<xref ref-type="bibr" rid="pbio.2006687.ref017">17</xref>,<xref ref-type="bibr" rid="pbio.2006687.ref018">18</xref>], analysis in a customizable, unrestricted number of dimensions would be preferred, especially for scRNA-seq datasets with thousands of native dimensions. We have developed the p-Creode score, which determines the similarities between p-Creode trajectories derived from a multidimensional single-cell landscape [<xref ref-type="bibr" rid="pbio.2006687.ref019">19</xref>]. Most recently, cellAlign was developed to align single-cell trajectories using dynamic time warping, and an alignment-based distance was defined to evaluate similarities between trajectories [<xref ref-type="bibr" rid="pbio.2006687.ref020">20</xref>]. However, these approaches are limited to datasets in which trajectories can be derived from continuous single-cell data and are not generalizable to all data distributions. Currently, the most common strategy for assessing similarities between single-cell landscapes remains a visual evaluation of the degree of “mixing” of data points when two or more samples are analyzed together on a t-distributed stochastic neighbor embedding (t-SNE) plot [<xref ref-type="bibr" rid="pbio.2006687.ref002">2</xref>]. Two methods have recently been developed to use k-nearest neighbors to characterize this degree of intermixing [<xref ref-type="bibr" rid="pbio.2006687.ref021">21</xref>,<xref ref-type="bibr" rid="pbio.2006687.ref022">22</xref>]. Both methods use the simple assumption that k-nearest neighbors of each cell should have the same distribution of sample labels as the full dataset if the datasets are well mixed.</p>
<p>We were originally inspired by some of the early single-cell work in which similarities between replicates can be qualitatively evaluated by the degree of mixing of hierarchical clusters between replicates [<xref ref-type="bibr" rid="pbio.2006687.ref007">7</xref>]. Thus, by deriving a quantitative measure to compare between hierarchical trees generated by clustering, we can obtain a corresponding quantitative, statistically testable metric to compare cell population diversity between single-cell landscapes. Multiple metrics to measure similarity between trees have been proposed, such as Baker’s gamma index [<xref ref-type="bibr" rid="pbio.2006687.ref023">23</xref>], which we used previously to determine the similarity between signaling modules [<xref ref-type="bibr" rid="pbio.2006687.ref024">24</xref>]. UniFrac is a distance metric originally devised to compute differences between microbial communities by incorporating phylogenetic information [<xref ref-type="bibr" rid="pbio.2006687.ref025">25</xref>]. UniFrac provides a qualitative measure, which is calculated as the fraction of the total unshared branch lengths. A weighted version of UniFrac is a quantitative measure, such that branch lengths are weighted by the relative abundance of each taxon [<xref ref-type="bibr" rid="pbio.2006687.ref026">26</xref>]. We created a workflow, called sc-UniFrac, that enables the application of the weighted UniFrac statistical framework on single-cell data to identify and characterize cellular diversity that distinguishes single-cell landscapes. Pairwise comparisons using sc-UniFrac can easily be extended to multi-sample experimental designs that are increasingly common in single-cell studies. sc-UniFrac compares diversity based on transcriptome similarities of single cells and is more powerful than intermixing methods based on its accounting of both the global and local structures of the data. We demonstrated the utility of sc-UniFrac in quantifying similarities between simulated and real sc-RNAseq datasets, for which the ground truth of similarities between samples is known. We also successfully applied sc-UniFrac to detect technical effects from replicate samples, assess the performance of batch-correcting methods, and implicate the sources of technical variation, although sc-UniFrac itself does not correct for these effects. We envision that quantitative metrics such as sc-UniFrac will find increasing utility as the field continues to generate a greater number of sc-RNAseq datasets from different conditions. sc-UniFrac will greatly facilitate single-cell studies, including those aimed at deciphering how cell populations respond to perturbations or tracking the evolution of cell populations during disease progression.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<sec id="sec003">
<title>Overview of sc-UniFrac</title>
<p>For quantifying cell diversity differences in single-cell landscapes, we borrowed the UniFrac concept from the microbiome field. UniFrac is a distance metric for quantifying differences in phylogenetic diversity between ecological landscapes. Instead of operating on phylogenetic trees that describe microbial diversity between two samples, sc-UniFrac has been adopted for single-cell research and builds hierarchical trees from clustering analyte profiles (e.g., transcriptome) of single cells combined from two datasets. The purpose of clustering was not to separate cells into distinct groups, as performed traditionally for single-cell transcriptome datasets; instead, the hierarchical tree in sc-UniFrac is only to discern potential structures within the data. Thus, clustering can be performed with any method and can be applied to data with any distributions. The hierarchical tree can be constructed post hoc using distances between cluster centroids. The clustering tree, encompassing the structural features of cell subpopulations, is used for calculating the weighted UniFrac distance. sc-UniFrac is calculated by weighting relative abundance of samples assigned to each branch, as well as the branch length that denotes the distance between cluster centroids (<xref ref-type="fig" rid="pbio.2006687.g001">Fig 1A</xref>). A permutation test, conducted by randomizing the sample labels of the cells without changing the tree topology, is used to calculate statistical significance of the overall sc-UniFrac distance (i.e., to test whether the cell populational structures between the two samples are identical) (see <xref ref-type="sec" rid="sec010">Methods</xref>). For single-cell data, it is very important to identify cell populations altered across conditions, which are derived from branches that have significant proportion shifts between two samples. Instead of relying on exact, nonzero proportional differences, which would find every branch and easily be skewed by outliers, sc-UniFrac leveraged the above permutation test to identify branches whose proportional shifts cannot occur by chance alone. This procedure corrects for the algorithm’s sensitivity to noisy outliers prevalent in scRNA-seq experiments. After identifying cell populations that drive the compositional difference between single-cell transcriptome landscapes, sc-UniFrac detects gene signatures that mark these cell populations. Finally, sc-UniFrac predicts the potential identities of these populations by matching individual cell signatures to cell types from reference atlases. sc-UniFrac can operate in two modes: (1) pairwise comparisons and (2) extension of the pairwise approach to a multi-sample experimental design. The general workflow of the sc-UniFrac pipeline is shown in <xref ref-type="fig" rid="pbio.2006687.g001">Fig 1B</xref>.</p>
<fig id="pbio.2006687.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pbio.2006687.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Overview of the sc-UniFrac method.</title>
<p>(A) A hierarchical tree is built by clustering the combined single-cell transcriptome profiles from two samples and by calculating distances between cluster centroids. Each cell, as a function of their cluster membership, is then assigned to branches. Branch lengths weighted by the relative abundance of each sample are used to calculate the sc-UniFrac distance. In the second step, the sample labels of all cells are swapped without altering the tree topology to generate a null distribution of sc-UniFrac distances, where a <italic>p</italic>-value for the sc-UniFrac distance can be calculated. (B) Workflow overview of the sc-UniFrac package for characterizing dissimilarities between two samples.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pbio.2006687.g001" xlink:type="simple"/>
</fig>
<p>Note that sc-UniFrac operates agnostically to technical or biological effects in the datasets and can be used to evaluate either depending on the input data. To evaluate technical effects, control replicate samples over multiple batches would be used as the input. To evaluate biological differences, it is assumed that technical variation in the input datasets has been well controlled for or batch correction has already been applied in previous processing steps.</p>
</sec>
<sec id="sec004">
<title>Sensitive and robust quantification of proportional shifts in single-cell population diversity</title>
<p>To evaluate the performance of sc-UniFrac in quantifying the compositional difference between single-cell landscapes, we first applied the method to experimental datasets in which population structure can be precisely controlled. Two 1,000-cell populations were generated by sampling from the CD8 and CD4 T-cell populations, respectively, from the T-cell development dataset of the mouse thymus (<xref ref-type="supplementary-material" rid="pbio.2006687.s012">S1 Data</xref>) [<xref ref-type="bibr" rid="pbio.2006687.ref025">25</xref>]. This process was repeated 50 times to evaluate the robustness of sc-UniFrac. Comparing the CD8 versus CD4 populations (1,000-cell sample from each population) using sc-UniFrac resulted in a large sc-UniFrac distance, indicating, as expected, completely different cell populations (<xref ref-type="fig" rid="pbio.2006687.g002">Fig 2A</xref>—red arrow, <xref ref-type="supplementary-material" rid="pbio.2006687.s001">S1A Fig</xref>). In contrast, comparing two 1,000-cell populations resampled from CD8 cells revealed that they possess the same population structures with a median distance of 0 (<xref ref-type="fig" rid="pbio.2006687.g002">Fig 2A</xref>—green arrow, <xref ref-type="supplementary-material" rid="pbio.2006687.s001">S1B Fig</xref>). We then evaluated the performance of sc-UniFrac in a simulation experiment in which we constructed a series of paired samples with a gradation of proportional shift in cell populations. For each pair, one sample included only CD8 cells (N1), while the other was composed of proportional mixtures of CD4 and CD8 cells (N2), starting from 0% of CD4 cells (no shift) to 100% of CD4 cells (complete shift). The distance of sc-UniFrac progressively increased as proportional shifts became larger (<xref ref-type="fig" rid="pbio.2006687.g002">Fig 2A</xref> and <xref ref-type="supplementary-material" rid="pbio.2006687.s001">S1C and S1D Fig</xref>). Among the 50 resampled runs, less than 0.2% of the sc-UniFrac distances generated were significantly different (identified as false positives) when two samples were identical (0% proportional shift), while over 95% of the distances were significantly different even when there was as little as 2% of CD4 cells mixed in with the CD8 cells (<xref ref-type="fig" rid="pbio.2006687.g002">Fig 2B</xref>). These results signify that sc-UniFrac is sensitive and specific for detecting minute shifts in population structure.</p>
<fig id="pbio.2006687.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pbio.2006687.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Simulation data reveal sc-UniFrac to be sensitive and robust.</title>
<p>(A) Two groups (N1 and N2) of 1,000 cells were selected from CD8 and CD4 cells identified in the Wishbone dataset (<xref ref-type="supplementary-material" rid="pbio.2006687.s012">S1 Data</xref>) [<xref ref-type="bibr" rid="pbio.2006687.ref025">25</xref>]. N1 is always composed of 100% CD8 cells, while N2 is composed of CD8 cells and different proportions of CD4 cells (indicated on x-axis). Green and red arrows represent CD8/CD8 (completely similar) and CD8/CD4 (completely dissimilar) comparisons, respectively; y-axis is the sc-UniFrac distance calculated over <italic>n</italic> = 50 runs with k = 10. Boxes represent the first and third quartiles, and bars represent maximum and minimum values. (B) Sensitivity of sc-UniFrac evaluated by the fraction of incidences that a statistically significant sc-UniFrac distance was returned over <italic>n</italic> = 50 runs, as a function of increasing dissimilarity between N1 and N2 using the same simulation scheme as panel A. (C) Mean sc-UniFrac plotted as in panel A with varying k parameter. (D) Fraction significant sc-UniFrac detected plotted as in panel B with varying k parameter. (E) Mean sc-UniFrac plotted as in panel A with N1 = 1,000 but a varying N2 size to determine the effect of dataset size imbalance on sc-UniFrac. (F) Fraction significant sc-UniFrac detected plotted as in panel B with N1 = 1,000 and varying N2 size.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pbio.2006687.g002" xlink:type="simple"/>
</fig>
<p>Next, using this controlled sampling scheme, we evaluated the impact of changing various parameters on the performance of sc-UniFrac. First, we altered the k parameter for dividing the data into k subpopulations for analysis, which tunes the resolution by which sc-UniFrac analyzes the datasets. The quantitative ability and sensitivity of sc-UniFrac were robust as long as k was not exceedingly low (k &gt; 3) (<xref ref-type="fig" rid="pbio.2006687.g002">Fig 2C and 2D</xref>). At k ≤ 3, single-cell datasets are represented by three major groups or less, reducing the resolution of sc-UniFrac for detecting differences in single-cell level diversity. As k increases, the performance of sc-UniFrac continues to improve slowly until reaching an asymptote at the expense of higher computational costs. When k is extremely high, sc-UniFrac might be distracted by unimportant details (noise) and fail to capture global structures. Thus, we conclude that the performance of sc-UniFrac is minimally affected by the selection of k (as long as it is not too low or extremely high). We recommend a k in the range of 10 to 30 depending on the heterogeneity of the data.</p>
<p>Second, we assessed the effect of imbalanced dataset sizes. Keeping the size of sample 1 (N1) constant at 1,000 cells, we altered the size of sample 2 (N2) during resampling while maintaining the same population structure. The sc-UniFrac method was observed to be robust with respect to dataset size imbalances, with only minor losses in sensitivity at larger imbalances (detection limit of 5% instead of 2%) (<xref ref-type="fig" rid="pbio.2006687.g002">Fig 2E and 2F</xref> and <xref ref-type="supplementary-material" rid="pbio.2006687.s002">S2 Fig</xref>). These results demonstrate the robustness of sc-UniFrac, whose performance is independent of input parameters.</p>
<p>The same analysis using scRNA-seq data demonstrated similar results (<xref ref-type="supplementary-material" rid="pbio.2006687.s003">S3 Fig</xref>). Here, we extracted erythrocyte and myeloid cell progenitor cell populations from the Paul and colleagues dataset (<xref ref-type="supplementary-material" rid="pbio.2006687.s013">S2</xref> and <xref ref-type="supplementary-material" rid="pbio.2006687.s014">S3</xref> Data) [<xref ref-type="bibr" rid="pbio.2006687.ref026">26</xref>]. Using the erythrocyte as a base population (<italic>N</italic> = 500 cells), we progressively mixed in the progenitor cells to construct simulated datasets in a manner similar to the CD4/CD8 analysis. The general conclusions are the same, with two minor differences. First, this dataset is more robust to parameter changes due to the increased distinctiveness between the two cell populations. We speculate that better separation can be achieved either through true biological difference or by having more dimensions to define cell populations in scRNA-seq data compared with Cytometry Time-of-Flight (CyTOF) data. Second, sensitivity to detect dissimilarity is slightly decreased (from 2% to 5% disparate cells for k = 10, e.g.) due to smaller dataset sizes. Nevertheless, the robustness of the algorithm to the k parameter and dataset size imbalance still holds in this analysis.</p>
</sec>
<sec id="sec005">
<title>Assessment of reproducibility of scRNA-seq data and dissimilarities between different tissue samples</title>
<p>To demonstrate the utility of sc-UniFrac on scRNA-seq data, we generated a series of scRNA-seq datasets with known similarities and differences using inDrop (1Cell Bio; Cambridge, MA) sequencing [<xref ref-type="bibr" rid="pbio.2006687.ref001">1</xref>]. These datasets included tissue samples from mouse colonic epithelium, consisting of both technical and biological replicates, as well as biological replicate samples of mouse embryonic pancreatic islets collected at embryonic day 14.5 (E14.5). Three technical replicates (colon1_1, colon1_2, colon1_3) consisted of multiple single-cell fractions collected from 1 mouse, whose libraries were constructed and sequenced on separate days. Three biological replicates (colon1, colon2, colon3) consisted of samples collected from different mice on different days but underwent library preparation and sequencing together. One sample (colon1) has both technical and biological replicates.</p>
<p>Two traditional strategies to assess the reproducibility of scRNA-seq datasets—for both biological and technical replicates—were performed. One strategy is to compare the median levels of all genes expressed between every sample pair using Spearman correlation analysis. The correlation analysis demonstrated that the technical replicates were more similar among each other (mean R = 0.89 ± SD 0.04) compared with samples among biological replicates (mean R = 0.80 ± SD 0.07) (<xref ref-type="supplementary-material" rid="pbio.2006687.s004">S4 Fig</xref>). As expected, the embryonic islets displayed a median gene expression that was the most different when compared to the adult colon (mean R = 0.504 ± SD 0.07). These results are consistent with the expected similarity among different conditions with technical replicates being more similar than biological replicates, which are more similar than the outgroup organ. While correlation analysis can quantify the degree of similarity in terms of the average transcriptional profile, it provides a very rough estimate and tends to be easily biased towards the dominant population in single-cell landscapes. The other strategy is to do a visual evaluation on how cells from multiple samples are intermixed on a t-SNE plot. Structural differences among different samples will be reflected in segregation of data points into separate clusters by sample, while data points from similar samples will appear together as mixed clusters. Visualization on a t-SNE plot showed the same result as median correlation analysis. Technical replicates appeared more intermixed within t-SNE clusters compared with biological replicates (<xref ref-type="fig" rid="pbio.2006687.g003">Fig 3A and 3B</xref> and <xref ref-type="supplementary-material" rid="pbio.2006687.s005">S5A and S5B Fig</xref>). In contrast, pancreatic islet biological replicates segregate away from samples generated from both the technical and biological replicates of the colon (<xref ref-type="fig" rid="pbio.2006687.g003">Fig 3C</xref>). While t-SNE analysis describes the subpopulation structure of the samples, it is not quantitative in that similarities and differences were assessed subjectively by visualization.</p>
<fig id="pbio.2006687.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pbio.2006687.g003</object-id>
<label>Fig 3</label>
<caption>
<title>sc-UniFrac statistically determines dissimilarities between single-cell data landscapes.</title>
<p>t-SNE plots of (A) technical and (B) biological replicates of scRNA-seq data generated from the adult murine colonic mucosa. Replicates were combined for t-SNE analyses and labeled with different colors. Outlined populations were identified with canonical markers. (C) t-SNE plot depicting E14.5 pancreatic islet and adult colonic mucosa scRNA-seq data in different mice, showing segregation by organ type. (D) Hierarchical clustering by sc-UniFrac of scRNA-seq landscapes generated from E14.5 pancreatic islet and adult colonic mucosa (indicated by tissue label), with technical and biological replicates (indicated by mouse label), as well as colonic tumor and adjacent normal isolated from an induced <italic>Lrig1</italic><sup><italic>CreERT2/+</italic></sup>;<italic>Apc</italic><sup><italic>fl/+</italic></sup> mouse. Heat represents sc-UniFrac distance between two samples. (E) Hierarchical clustering by sc-UniFrac of single-cell landscapes of technical and biological replicates of the colonic mucosa while varying parameter k. (F) Discriminate analysis of sc-UniFrac on biological and technical replicates. Discriminative ability, as defined by the smallest distance between biological replicates minus the largest distance between technical replicates, plotted against k. Data from GSE102698, GSE114044, GSE117615, GSE117616. scRNA-seq, single-cell RNA-sequencing; t-SNE, t-distributed stochastic neighbor embedding.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pbio.2006687.g003" xlink:type="simple"/>
</fig>
<p>Compared with these two traditional strategies, sc-UniFrac provides an objective, precise, and unbiased metric to quantify compositional dissimilarities across scRNA-seq datasets while taking population structures into account. The calculated sc-UniFrac distance between the colonic and pancreatic islet datasets was 1, the maximal obtainable distance demonstrating that the samples did not share any cell populations (<xref ref-type="fig" rid="pbio.2006687.g003">Fig 3D</xref> and <xref ref-type="supplementary-material" rid="pbio.2006687.s005">S5C Fig</xref>). Much smaller, but significant, distances were observed among biological replicates of colonic datasets (<xref ref-type="fig" rid="pbio.2006687.g003">Fig 3D</xref> and <xref ref-type="supplementary-material" rid="pbio.2006687.s005">S5C Fig</xref>, distance = 0.24–0.37), suggesting that they share cell populations but proportional compositional difference can still be detected. Technical replicates appeared the most similar with sc-UniFrac being marginally small without statistical significance (<xref ref-type="fig" rid="pbio.2006687.g003">Fig 3D</xref> and <xref ref-type="supplementary-material" rid="pbio.2006687.s005">S5C Fig</xref>, distance = 0.05–0.09), suggesting that they are composed of almost identical data points. The ordering by similarity across samples was robust to the k parameter (<xref ref-type="fig" rid="pbio.2006687.g003">Fig 3E and 3F</xref>). A metric was defined to evaluate the power of sc-UniFrac for discriminating biological replicates from technical replicates (discriminative ability) by subtracting the smallest distance between biological replicates by the largest distance between technical replicates. A positive discriminative ability suggests that sc-UniFrac can discriminate technical from biological replicates. Notably, the k parameter again did not affect the discriminative ability except when k is very small (k ≤ 2) (<xref ref-type="fig" rid="pbio.2006687.g003">Fig 3E and 3F</xref>). These results demonstrate the ability of sc-UniFrac to objectively and quantitatively determine dissimilarities between single-cell datasets, as seen by the ordering of samples by their expected similarities (technical replicate &gt; biological replicate &gt; outgroup organ).</p>
<p>We performed a comparison of sc-UniFrac to published methods for assessing single-cell landscape similarity, using the above dataset with known similarity ordering. First, we evaluated cellAlign, an algorithm for aligning two unbranched pseudotemporal trajectories using dynamic time warping [<xref ref-type="bibr" rid="pbio.2006687.ref020">20</xref>]. The alignment-based distance was defined to evaluate the similarity of two trajectories. cellAlign requires the input to be continuous scRNA-seq data comprising single unbranched trajectories. To generate such an input, we manually selected cells that form unbranched data continua from stem cells to colonocytes for the colonic datasets as well as from endocrine progenitors to beta cells for the pancreatic islet datasets (<xref ref-type="supplementary-material" rid="pbio.2006687.s015">S4 Data</xref>). The cellAlign distance, similar to sc-UniFrac, revealed that colonic datasets can be distinguished and clustered away from pancreatic islet datasets, while biological and technical replicates of the colon cannot be clearly delineated (<xref ref-type="fig" rid="pbio.2006687.g004">Fig 4A</xref>). An example of a nonideal alignment between technical replicates compared with an alignment between biological replicates is shown (<xref ref-type="fig" rid="pbio.2006687.g004">Fig 4B and 4C</xref>). These results suggest that sc-UniFrac is more powerful for distinguishing differences between single-cell landscapes than cellAlign. The low sensitivity of cellAlign might be due to various parameters, such as dataset size imbalance or uneven sampling of datapoints along a trajectory, which we have not thoroughly tested here. Furthermore, the application of cellAlign is restricted to the very specific case of continuous data that form a single unbranched trajectory, thus limiting its generalizability.</p>
<fig id="pbio.2006687.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pbio.2006687.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Alternative methods of landscape comparisons arrive at similar results compared with sc-UniFrac.</title>
<p>(A) Hierarchical clustering by cellAlign distance calculated using unbranched trajectories created from scRNA-seq data generated from E14.5 pancreatic islet and adult colonic mucosa (indicated by tissue label-greyscale bar), with technical and biological replicates (indicated by mouse label-red bar) (<xref ref-type="supplementary-material" rid="pbio.2006687.s015">S4 Data</xref>). Heat represents cellAlign distance between two samples. Example dissimilarity matrices resulting from alignments of unbranched stem cell to colonocyte trajectories using the cellAlign algorithm according to [<xref ref-type="bibr" rid="pbio.2006687.ref020">20</xref>] for (B) technical replicates and (C) biological replicates. Normalized alignment-based distances appear below each matrix. (D) Representative p-Creode trajectories depicting the colonic epithelial differentiation continuum of 2 technical and 2 biological replicates. Outlined lineages were identified with canonical markers. <italic>Muc2</italic> expression overlay. (E) Hierarchical clustering by p-Creode scoring of trajectories generated from scRNA-seq data of technical (green) and biological (red, cyan) replicates. <italic>N</italic> = 100 resampled p-Creode runs for each dataset were performed and then analyzed together in a single clustering analysis. Heat represents the p-Creode score between two trajectories. Data from GSE102698, GSE114044, GSE117616; <ext-link ext-link-type="uri" xlink:href="https://github.com/KenLauLab/pCreode_Comparison_Across_Datasets" xlink:type="simple">https://github.com/KenLauLab/pCreode_Comparison_Across_Datasets</ext-link>. scRNA-seq, single-cell RNA sequencing.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pbio.2006687.g004" xlink:type="simple"/>
</fig>
<p>To extend orthogonal methodologic comparisons to sc-UniFrac, we also used p-Creode trajectory analysis, an algorithm by which a single-cell landscape composed of continuous cell-state data is represented as acyclic graphs to model transition trajectories [<xref ref-type="bibr" rid="pbio.2006687.ref019">19</xref>]. The p-Creode score, developed to determine the topological similarity between graphs with differing nodes and edges, can be used to quantify dissimilarities of the trajectory graph outputs generated from different datasets. We revised the p-Creode scoring method to accommodate comparisons of graphs of difference sizes by interpolating between edges connecting nodes instead of directly matching node positions between the two test datasets (<xref ref-type="supplementary-material" rid="pbio.2006687.s006">S6A–S6C Fig</xref> and <xref ref-type="sec" rid="sec010">Methods</xref>). p-Creode was applied to each dataset for 100 times to generate consensus trajectories using data resampling. The modified p-Creode score was used as a distance metric for clustering cell-transitional trajectories created from the resampled datasets. Consistent with sc-UniFrac, p-Creode trajectories among technical replicates clustered together using the p-Creode score as a dissimilarity metric, while data from biological replicates were more disparate (<xref ref-type="fig" rid="pbio.2006687.g004">Fig 4D and 4E</xref>). As expected, organ specificity drove clustering when pancreatic islet data were added to the analysis, with all trajectories generated from colonic data clustering together away from pancreatic trajectories (<xref ref-type="supplementary-material" rid="pbio.2006687.s006">S6D</xref> and <xref ref-type="supplementary-material" rid="pbio.2006687.s007">S7</xref> Figs). Similar to cellAlign, p-Creode was designed for data that are distributed as a continuum, and not as distinct clusters. However, the p-Creode score can also be used to evaluate complex multi-branching trajectories in addition to linear ones. Nevertheless, comparisons can only be made for tissue systems that are transitioning, which is the case for both the adult colonic epithelium and embryonic pancreatic islets compared here. sc-UniFrac does not have this limitation because it can compare between datasets of any distribution, including continuous data, as well as discrete populations that are composed of cells from different lineages. Thus, sc-UniFrac has greater general utility than the above two trajectory comparison methods for determining dissimilarities of single-cell datasets in an unsupervised way without prior knowledge of the distribution of the data.</p>
</sec>
<sec id="sec006">
<title>Identification of cell populations that drive differences between single-cell landscapes</title>
<p>While sc-UniFrac can statistically measure the population diversity between two single-cell landscapes, it also provides an easy and intuitive way to identify the cells that drive the differences. The distance-driving cells are either expanding or contracting populations or even newly emerging populations across conditions. Instead of relying on nonzero proportional differences between two samples, which would identify every branch and easily be skewed by outliers, sc-UniFrac uses the incorporated permutation significance tests to detect branches whose proportion shifts in cell populations cannot happen by chance alone (<xref ref-type="sec" rid="sec010">Methods</xref>). The branches with significant proportional shifts between two samples are distance-driving cells. Illustrating this concept, sc-UniFrac was performed to demonstrate pairwise comparison of scRNA-seq datasets of colonic and pancreatic tissue with k = 10. As expected, technical replicates of the colon with the smallest sc-UniFrac value have mostly shared branches between them, with only one branch with subtle proportional shifts (<xref ref-type="fig" rid="pbio.2006687.g005">Fig 5A</xref>). In contrast, comparison of the pancreatic and colonic datasets revealed no shared branches, with every unshared branch being highly significant (<xref ref-type="fig" rid="pbio.2006687.g005">Fig 5B</xref>). Evaluation of unshared branches can easily pinpoint cell groupings that contribute to sc-UniFrac. Here, we focus on group 10, which was composed entirely of cells from the pancreatic sample. Supervised analysis of differential gene expression revealed the unique gene signatures of these cells compared to colonic populations, which can be identified by canonical marker genes (e.g., group 1 represents deep crypt secretory cells; 2 and 3 are colonocytes; 4 and 5 are goblet cells; 6 are intraepithelial lymphocytes) (<xref ref-type="supplementary-material" rid="pbio.2006687.s008">S8A Fig</xref>). Projection of cells from group 10 onto reference cell type gene expression signatures from the Mouse Cell Atlas [<xref ref-type="bibr" rid="pbio.2006687.ref003">3</xref>] revealed that individual cells mapped onto pancreatic acinar cells, duct cells, endocrine cells, and immune cells (<xref ref-type="fig" rid="pbio.2006687.g005">Fig 5C</xref>). These results demonstrate the utility of the branching feature of sc-UniFrac to statistically determine cell populations that drive differences between single-cell landscapes. Notably, none of the methods that we used above for comparison with sc-UniFrac can perform this task.</p>
<fig id="pbio.2006687.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pbio.2006687.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Cells that drive sc-UniFrac can be intuitively identified.</title>
<p>(A, B) Branching structure of two single-cell landscapes being scored by sc-UniFrac (k = 10), with black representing statistically shared branches and blue and red representing statistically unshared branches from each of the colored samples. Thickness of branch is proportional to effect size. Comparing between (A) technical replicates and (B) different tissues. (C) Individual cells (columns) from group 10 of panel B being matched to cell types (rows) referenced from the Mouse Cell Atlas. Heat represents the correlation of gene expression between the cell and the reference using all genes. Data from GSE102698, GSE114044, GSE117616.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pbio.2006687.g005" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec007">
<title>Evaluation of physiologically relevant similarities using sc-UniFrac</title>
<p>While sc-UniFrac was able to derive the correct ordering of similarity between normal tissues, we next applied sc-UniFrac to more challenging cases to determine whether it can decipher meaningful dissimilarities in cell diversity arising from the same tissue. Cell type diversity is altered during the process of tumorigenesis as mutations alter signaling pathways to convert cells to abnormal states while, at the same time, additional cell types are recruited to the tumor microenvironment. Nevertheless, cancer cells should harbor some similarities to the cells from the organ of origin while being distinct to cells of other organs. We examined colonic adenoma that are initiated by stochastic loss of the second allele of the tumor suppressor gene Adenomatous Polyposis Coli (<italic>Apc</italic>) in our inducible, stem-cell–driven mouse model (<italic>Lrig1</italic><sup><italic>CreERT2/+</italic></sup>;<italic>Apc</italic><sup><italic>fl/+</italic></sup>) [<xref ref-type="bibr" rid="pbio.2006687.ref027">27</xref>,<xref ref-type="bibr" rid="pbio.2006687.ref028">28</xref>]. We collected scRNA-seq data using inDrop for both the adenoma and adjacent normal (<xref ref-type="fig" rid="pbio.2006687.g006">Fig 6A</xref>) and then appended sc-UniFrac analysis of these samples to the existing colon and pancreas analysis. As ranked by sc-UniFrac, the tumor landscape is dissimilar to the normal colon landscape, but it is more similar to the colon than the pancreas landscape, lying somewhere in the middle (<xref ref-type="fig" rid="pbio.2006687.g003">Fig 3D</xref>). This relationship can be approximated on principal component analysis (PCA) plots (<xref ref-type="supplementary-material" rid="pbio.2006687.s008">S8B Fig</xref>), in which global relationships between data points are better represented. Because all tumor cells would have activated Wnt signaling, there was minimal overlap between the tumor cell and normal cell landscapes, as expected. We performed experiments with control replicate samples to confirm minimal batch effects in this comparison. As such, adjacent normal colon was intermingled among normal colon samples, highlighting its normal phenotype.</p>
<fig id="pbio.2006687.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pbio.2006687.g006</object-id>
<label>Fig 6</label>
<caption>
<title>sc-UniFrac identifies unique cellular infiltrates within colonic tumor compared with normal colon.</title>
<p>(A) t-SNE plot of multiple replicates of single-cell data from the pancreas, colonic tumor, adjacent normal colon, and normal colon analyzed together. Random sampling of 400 cells from each group. Populations delineated by marker genes. (B) Branching structure of tumor and adjacent normal landscapes scored by sc-UniFrac (k = 10). (C, D) Individual cells (columns) from subpopulations 1 (C) and 10 (D) of panel B being matched to cell types (rows) referenced from the Mouse Cell Atlas. Analysis similar to <xref ref-type="fig" rid="pbio.2006687.g005">Fig 5</xref>. Data from GSE117615. t-SNE, t-distributed stochastic neighbor embedding.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pbio.2006687.g006" xlink:type="simple"/>
</fig>
<p>The distance-driving cells between tumor and adjacent normal were identified by branches with significant proportional shifts. For simplicity, we selected two subpopulations for further characterization: subpopulation 1, which is the most skewed towards adjacent normal colon, and subpopulation 10, which is composed entirely of cells from the tumor (<xref ref-type="fig" rid="pbio.2006687.g006">Fig 6B</xref>). Subpopulation 1, when matched to the Mouse Cell Atlas, consists of differentiated absorptive cells of the gut (<xref ref-type="fig" rid="pbio.2006687.g006">Fig 6C</xref>). This result corroborates known colonic tumor biology that tumors are characterized by stem/progenitor signatures while the normal colon is overrepresented with differentiated cells. Note that the tumor sample also contributes to this subpopulation but only a very minor proportion, as tumors have differentiated cells at a very low level. Subpopulation 10, which is completely tumor derived, represent granulocytes (<xref ref-type="fig" rid="pbio.2006687.g006">Fig 6D</xref>). Granulocytes—predominantly neutrophils—are absent in the uninflamed normal colon, while tumors present altered, possibly inflamed, microenvironments with substantial infiltrates.</p>
<p>Next, we applied sc-UniFrac to analyze a scRNA-seq dataset describing oligodendrocyte progenitor cells (OPCs) that have been isolated from distinct regions of the mouse brain by microdissection [<xref ref-type="bibr" rid="pbio.2006687.ref029">29</xref>]. While region-based information was provided, region-specific differences in OPC subpopulations were not identified in the original manuscript. We analyzed the cells from various brain regions together as in the original manuscript, with the assumption that technical variation between regions has been well-controlled for. Clustering by sc-UniFrac distance, we identified that OPCs grouped together on a dorsal (cortex S1, corpus callosum, hippocampus CA1) to ventral (dentate gyrus, amygdala, zona incerta, striatum, hypothalamus, substantia nigra and ventral tegmental area [SN-VTA], dorsal horn) axis globally (<xref ref-type="fig" rid="pbio.2006687.g007">Fig 7A</xref>). Looking at more local clustering, we observed grouping of the dentate gyrus and amygdala OPCs, similar to previous work (labeled as “immature” there), while SN-VTA and dorsal horn OPCs grouped together (labeled as “mature” and also physically the most posterior regions of the central nervous system assayed) (<xref ref-type="fig" rid="pbio.2006687.g007">Fig 7A</xref>). In addition, sc-UniFrac revealed that cortex S1, corpus callosum, and hippocampus CA1 clustered together, while the zona incerta, striatum, and hypothalamus formed another cluster (<xref ref-type="fig" rid="pbio.2006687.g007">Fig 7A</xref>). These regions develop from pallium-derived and subpallium-derived tissues, respectively (<xref ref-type="fig" rid="pbio.2006687.g007">Fig 7B</xref>). The groupings by sc-UniFrac can be visually observed in t-SNE plots, supporting our analysis (<xref ref-type="fig" rid="pbio.2006687.g007">Fig 7C</xref>), although conclusions cannot be definitively drawn by visual inspection alone. Hence, sc-UniFrac was able to provide biologically meaningful results for relating OPCs from different regions of the brain.</p>
<fig id="pbio.2006687.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pbio.2006687.g007</object-id>
<label>Fig 7</label>
<caption>
<title>sc-UniFrac groups oligodendrocytes by brain regions.</title>
<p>(A) Hierarchical clustering by sc-UniFrac of scRNA-seq data generated from different regions of the brain according to [<xref ref-type="bibr" rid="pbio.2006687.ref029">29</xref>]. Heat represents sc-UniFrac distance between two regions. (B) Schematic of brain regions for generating scRNA-seq data. (C) t-SNE plot of data combined from all brain regions, with oligodendrocytes from each region highlighted. Data from GSE75330. scRNA-seq, single-cell RNA sequencing; SN-VTA, substantia nigra and ventral tegmental area; t-SNE, t-distributed stochastic neighbor embedding.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pbio.2006687.g007" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec008">
<title>Quantitative evaluation of batch-correction methods by sc-UniFrac</title>
<p>The presence of batch effects is a significant and common problem in scRNA-seq experiments, by introducing systematic error and masking underlying biological signals. Removal of batch effects is generally required prior to downstream analysis. Many methods and tools have been developed for batch correction [<xref ref-type="bibr" rid="pbio.2006687.ref030">30</xref>–<xref ref-type="bibr" rid="pbio.2006687.ref033">33</xref>]. Some methods have been successfully used in bulk RNA-seq [<xref ref-type="bibr" rid="pbio.2006687.ref030">30</xref>,<xref ref-type="bibr" rid="pbio.2006687.ref032">32</xref>], while other methods were recently developed and specially designed for scRNA-seq [<xref ref-type="bibr" rid="pbio.2006687.ref031">31</xref>,<xref ref-type="bibr" rid="pbio.2006687.ref033">33</xref>]. While the suitability of batch-correction methods may depend on the distribution of data that vary from dataset to dataset, the universality of such methods is undefined given that there is no quantitative, objective metric to evaluate batch effect correction in scRNA-seq data. sc-UniFrac, a quantitative measure of cell population diversity in single-cell landscapes, provides a sensitive and objective way to assess the performance of batch-correction methods.</p>
<p>We compared three batch removal methods, limma, ComBat, and MNN, on three scRNA-seq datasets. Limma and ComBat have been widely used for batch correction in bulk experiments, which fit a linear model to determine and then correct the batch effect for each gene [<xref ref-type="bibr" rid="pbio.2006687.ref030">30</xref>,<xref ref-type="bibr" rid="pbio.2006687.ref032">32</xref>]. MNN first identifies mutual nearest neighbor pairs between batches and then uses these pairs to estimate the batch effect in scRNA-seq data [<xref ref-type="bibr" rid="pbio.2006687.ref034">34</xref>]. MNN is expected to perform well when population composition is different across batches. The evaluation of these methods was performed on the following three scRNA-seq datasets: (1) human embryonic kidney 293 (HEK293) cells prepared fresh and cryopreserved from two batches [<xref ref-type="bibr" rid="pbio.2006687.ref035">35</xref>], (2) our three technical replicates of mouse colonic epithelium, and (3) two separate studies of mouse gastrulation [<xref ref-type="bibr" rid="pbio.2006687.ref036">36</xref>,<xref ref-type="bibr" rid="pbio.2006687.ref037">37</xref>].</p>
<p>For HEK293 cell line data, a small sc-UniFrac—reflecting high similarity—was observed between freshly isolated and cryopreserved samples within the same batch (<xref ref-type="supplementary-material" rid="pbio.2006687.s009">S9 Fig</xref>), indicating minimal technical variation during the cryopreservation process consistent with the original findings [<xref ref-type="bibr" rid="pbio.2006687.ref035">35</xref>]. In contrast, a large sc-UniFrac was observed between two batches, indicating a strong batch effect similar to the original manuscript (<xref ref-type="supplementary-material" rid="pbio.2006687.s009">S9 Fig</xref>). All three methods, limma, ComBat and MNN, decreased the sc-UniFrac distance, indicative of batch effect correction (<xref ref-type="fig" rid="pbio.2006687.g008">Fig 8A</xref> and <xref ref-type="supplementary-material" rid="pbio.2006687.s010">S10A–S10C Fig</xref>). Among them, limma and ComBat decreased the distances to those approaching to zero, suggesting that batch effects have been completely removed.</p>
<fig id="pbio.2006687.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pbio.2006687.g008</object-id>
<label>Fig 8</label>
<caption>
<title>sc-UniFrac can benchmark batch effect removal approaches.</title>
<p>(A) sc-UniFrac distance calculated comparing uncorrected and batch-corrected scRNA-seq datasets of HEK293 cells fresh, frozen at −80 °C, or liquid nitrogen flash frozen performed in two different batches (GSE85534) [<xref ref-type="bibr" rid="pbio.2006687.ref035">35</xref>]. ComBat, limma, and MNN were used for batch correction. (B) sc-UniFrac distance calculated similar to panel A for technical replicates of the mouse colonic epithelium scRNA-seq data (GSE102698). (C) Hierarchical clustering by sc-UniFrac of uncorrected or batch-corrected scRNA-seq data depicting murine gastrulation from two different studies [<xref ref-type="bibr" rid="pbio.2006687.ref036">36</xref>,<xref ref-type="bibr" rid="pbio.2006687.ref037">37</xref>]. A gradation of similarity, and hence clustering, was expected over developmental times from the earliest development stage (E5.5) to the latest stage (E7.5). Data from GSE100597; <ext-link ext-link-type="uri" xlink:href="http://gastrulation.stemcells.cam.ac.uk/scialdone2016" xlink:type="simple">http://gastrulation.stemcells.cam.ac.uk/scialdone2016</ext-link>. E, embryonic day; Fre, fresh; Fro, frozen at −80 °C; HEK293, human embryonic kidney 293; Nitr, liquid nitrogen flash frozen; scRNA-seq, single-cell RNA sequencing.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pbio.2006687.g008" xlink:type="simple"/>
</fig>
<p>In the technical replicates of the mouse colonic epithelium, only minimal batch effects were observed as indicated by our previous analyses. Due to the initial small differences between batches, limma, ComBat, and MNN only moderately removed batch effects further, as seen in the decrease in sc-UniFrac between replicates 1 and 2, and between replicates 1 and 3 (<xref ref-type="fig" rid="pbio.2006687.g008">Fig 8B</xref> and <xref ref-type="supplementary-material" rid="pbio.2006687.s010">S10D–S10F Fig</xref>). Batch effects were initially minimal between replicates 2 and 3. In this case, limma and ComBat successfully removed the batch effects (reduced sc-UniFrac to zero), while MNN failed to do so but instead introduced additional systematic bias (sc-UniFrac increased) (<xref ref-type="fig" rid="pbio.2006687.g008">Fig 8B</xref>).</p>
<p>scRNA-seq data of mouse cells during gastrulation were obtained from two studies [<xref ref-type="bibr" rid="pbio.2006687.ref036">36</xref>,<xref ref-type="bibr" rid="pbio.2006687.ref037">37</xref>], which used plate-based Smart-seq2 and G&amp;T-seq (genome and transcriptome sequencing), respectively, which introduced large technical variation. The first study generated scRNA-seq data from mouse embryos at E5.5, E6.5, and E6.75, and the second focused on mouse embryos at E6.5 and E7.0. sc-UniFrac generated from the uncorrected data indicated that the two datasets clustered by studies and not by developmental stages, revealing strong technical variation between the two studies (<xref ref-type="fig" rid="pbio.2006687.g008">Fig 8C</xref> and <xref ref-type="supplementary-material" rid="pbio.2006687.s011">S11A Fig</xref>). After applying limma, ComBat, and MNN, sc-UniFrac indicated that the batch-correction methods removed the technical variation, with cells no longer clustering by studies but by developmental stages. Among the three methods, both limma and ComBat were able to arrange cells chronologically from the earliest development stage (E5.5) to the latest (E7.5), whereas the ordering of samples processed by MNN was incomplete (<xref ref-type="fig" rid="pbio.2006687.g008">Fig 8C</xref>). This conclusion is supported by t-SNE analysis in which E6.5_1 and E.6.5_2 clustered together after limma and ComBat but remained separated after MNN (<xref ref-type="supplementary-material" rid="pbio.2006687.s011">S11B–S11D Fig</xref>).</p>
<p>From these results, limma and ComBat both outperformed MNN, probably due to identical population composition across batches in all datasets. One of MNN’s assumptions is that batch effects should be much smaller than biological variation, which may not hold true in these datasets. Additionally, the performance of MNN is dependent on the number of nearest neighbors to consider when identifying mutual nearest neighbor pairs. Choosing the correct parameter would probably improve MNN performance, but this would require prior knowledge of what the correct parameter is. While all methods were able to reduce technical variation, sc-UniFrac was able to quantitatively evaluate the initial batch effects and the performance of batch-correction methods.</p>
</sec>
</sec>
<sec id="sec009" sec-type="conclusions">
<title>Discussion</title>
<p>We developed a new tool, sc-UniFrac, for quantitatively assessing the dissimilarities in cell population structures between two single-cell landscapes that can be generated by various types of single-cell technologies. Compared with existing methods, sc-UniFrac has distinct advantages, including (1) its ability to objectively and quantitatively assess population diversity differences, (2) its precision by taking population structure into account, (3) its statistical rigor based on the available UniFrac framework, (4) its intuitive and statistically robust method to identify disparate cell populations between samples, (5) its flexibility to analyze multiple samples and to add new samples to current analyses, and (6) its ability to handle any dataset with unlimited dimensional representation and distribution [<xref ref-type="bibr" rid="pbio.2006687.ref016">16</xref>]. While sc-UniFrac presents a statistical test to estimate the significance of the observed distance, the resulting p-value should be interpreted with caution because it is sensitive to tree topology and randomization methods [<xref ref-type="bibr" rid="pbio.2006687.ref038">38</xref>]. We have demonstrated the validity of sc-UniFrac using gold-standard datasets for which the similarities between datasets are known.</p>
<p>Single-cell technologies provide unprecedented resolution to study heterogeneity in disease, especially in cancer. Intratumor heterogeneity is a key determinant of tumor diagnosis, prognosis, and drug response [<xref ref-type="bibr" rid="pbio.2006687.ref039">39</xref>,<xref ref-type="bibr" rid="pbio.2006687.ref040">40</xref>]. Although a large amount of effort has been devoted to the genomic [<xref ref-type="bibr" rid="pbio.2006687.ref041">41</xref>], transcriptomic [<xref ref-type="bibr" rid="pbio.2006687.ref042">42</xref>–<xref ref-type="bibr" rid="pbio.2006687.ref044">44</xref>], and proteomic [<xref ref-type="bibr" rid="pbio.2006687.ref045">45</xref>] subtyping of cancers in hope for better precision application and/or to better understand the disease, current bulk analyses obscure signals coming from distinct cell populations. Unbiased characterization of cellular diversity in tumor tissues and application of this information to define tumor subtypes provides a unique opportunity to better understand cancer. Subtypes based on tumor heterogeneity refine the subtypes defined by bulk “omic” approaches and may provide additional prognostic and diagnostic value for predicting patient survival and drug response. For current single-cell applications, comparing heterogeneity between multiple samples has been performed manually using t-SNE analysis in conjunction with distinguishing markers to qualitatively match cell populations across samples; however, this is done in a low-throughput fashion with few samples [<xref ref-type="bibr" rid="pbio.2006687.ref046">46</xref>]. sc-UniFrac enables quantitative evaluation of cellular diversity among potentially large numbers of samples, which can then be rapidly clustered into different subtypes. Thus, sc-UniFrac can facilitate studies on intratumor and intertumor heterogeneity to reveal the importance of diverse cell populations in tumor progression and drug treatment. Furthermore, data structures generated by sc-UniFrac can be applied to software developed for microbiome research, such as QIIME [<xref ref-type="bibr" rid="pbio.2006687.ref047">47</xref>], which will provide single-cell researchers access to advanced analytical tools.</p>
<p>Cell populations will expand, shrink, or emerge as a function of disease subtype, disease progression, or after extrinsic drug perturbations. sc-UniFrac can intuitively identify significantly altered cell populations or states driving compositional difference. Moreover, difference-driving cells can be further analyzed to identify gene expression signatures, and their identities and behaviors can be inferred based on transcriptomes of previously referenced cell types. Introduction of new cells into the landscape as a result of perturbation—e.g., the infiltration of CD8 cytotoxic T cells into a tumor—can be deciphered by matching (or blasting) [<xref ref-type="bibr" rid="pbio.2006687.ref048">48</xref>] difference-driving cells against the transcriptomes of reference cell types [<xref ref-type="bibr" rid="pbio.2006687.ref003">3</xref>], as sc-UniFrac has demonstrated here.</p>
<p>There is currently a proliferation of single-cell data analysis tools, such that many of them utilize different approaches for achieving the same goal. In response, it is necessary for the single-cell biology community to benchmark the performance of these tools with reference datasets. Batch effect correction is a very important procedure for removing technical variation. The sources of variation can arise from runs on different sequencing lanes, different single-cell encapsulation platforms, ischemic times, or different tissue preparations, even if procedures are performed by the same experimenter. Several tools designed to remove batch effects have been developed specifically for scRNA-seq [<xref ref-type="bibr" rid="pbio.2006687.ref021">21</xref>,<xref ref-type="bibr" rid="pbio.2006687.ref034">34</xref>,<xref ref-type="bibr" rid="pbio.2006687.ref049">49</xref>,<xref ref-type="bibr" rid="pbio.2006687.ref050">50</xref>]. A quantitative measure of performance is required for effective benchmarking, and sc-UniFrac now provides a metric by which the similarity between single-cell landscapes of a tissue generated from different batches, before and after batch correction, can be evaluated. While evaluation of a tool on any specific datasets can be performed, it should be noted that the performance of any particular tool depends on the assumptions underlying the algorithm as well as the distribution of the dataset. Thus, different tools may perform better on some datasets than others. More importantly, this work calls attention to the requirement for proper experimental design and controls in scRNA-seq experiments. sc-UniFrac reports differences in single-cell landscapes agnostic to technical (batch) versus biological effects. Similar to other experimental platforms such as bulk RNAseq, if proper controls were not performed or an erroneous experimental design was adopted, technical effects can be confounded with biological effects to arrive at erroneous conclusions. Experimental samples should be prepared and run simultaneously with replicate control samples to assess whether the control samples produce similar landscapes, like we have done here with sc-UniFrac on technical and biological replicates. This is especially important for multi-sample experimental designs conducted over different batches. If technical effects were determined to overwhelm biological variation, appropriate measures—such as batch correction—should be performed prior to further downstream analysis. sc-UniFrac can support the evaluation of these effects, such that multiple single-cell landscapes clustering by batch or biological conditions can be readily evaluated in a quantitative and statistically robust manner. Furthermore, cell populations that contribute to batch effects can be identified through the sc-UniFrac pipeline, which helps delineate sources of technical variations, such as an excess of dying cells in one prep versus another. We have demonstrated various applications of this approach, and we envision its broad usage as increasing number of scRNA-seq datasets are generated.</p>
</sec>
<sec id="sec010" sec-type="materials|methods">
<title>Methods</title>
<sec id="sec011">
<title>Ethics statement</title>
<p>Animal experiments were performed under protocols approved by the Vanderbilt University Animal Care and Use Committee and in accordance with NIH guidelines. Wild-type mice (C57BL/6) and tumor-bearing mice (<italic>Lrig1</italic><sup><italic>CreERT2/+</italic></sup>;<italic>Apc</italic><sup><italic>fl/+</italic></sup>) were euthanized in an approved fashion prior to dissection and tissue harvesting. Tumor induction was performed following a previous protocol [<xref ref-type="bibr" rid="pbio.2006687.ref028">28</xref>].</p>
</sec>
<sec id="sec012">
<title>The sc-UniFrac framework</title>
<p>sc-Unifrac is freely available as an R package at <ext-link ext-link-type="uri" xlink:href="https://github.com/liuqivandy/scUnifrac" xlink:type="simple">https://github.com/liuqivandy/scUnifrac</ext-link>. sc-Unifrac includes the following four main steps:
<list list-type="order">
<list-item><p>Data processing: scRNA-seq data were first normalized by library size per cell (total number of UMIs) and log-transformed.</p></list-item>
<list-item><p>Tree construction: highly variable genes were selected (user defined: default 500). PCA was performed to reduce the dimensionality while preserving the signal of interest, which reduces the noise and makes the data more tractable both from a statistical and computational point of view (user defined: default = 4). A hierarchical tree representing cell population structure was built by clustering via average linkage, and the upper portion of the tree was defined by cutting off the connections at k clusters (user defined: default k = 10).</p></list-item>
<list-item><p>Quantification of cell population diversity: the sc-UniFrac distance was calculated by weighted branch sharing, and statistical significance was assessed by permutation testing.</p></list-item>
<list-item><p>Identifying populations that drive sc-UniFrac by querying the shared branching structure: gene expression signatures were derived for matching against reference cell type signatures.</p></list-item>
</list></p>
<p>The sc-Unifrac package provides the following two functions: (1) pairwise comparisons and (2) multi-sample comparisons. In pairwise comparison, sc-Unifrac generates a report to summarize the results, including the sc-UniFrac distance on population diversity, statistical significance, cell population structures, gene expression signatures in each altered population, and their match to reference cell types (<xref ref-type="supplementary-material" rid="pbio.2006687.s016">S1 Report</xref>). In multi-sample comparisons (<italic>n</italic> samples), sc-Unifrac generates an <italic>n</italic>-by-<italic>n</italic> pairwise distance matrix, a corresponding statistical significance matrix, a hierarchical tree, and a table of counts per cluster per sample.</p>
</sec>
<sec id="sec013">
<title>sc-UniFrac distance calculation</title>
<p>sc-UniFrac (<italic>D</italic>) is calculated as:
<disp-formula id="pbio.2006687.e001">
<alternatives>
<graphic id="pbio.2006687.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pbio.2006687.e001" xlink:type="simple"/>
<mml:math display="block" id="M1">
<mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:mo>|</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:mo>|</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mfrac>
</mml:math>
</alternatives>
</disp-formula>
<disp-formula id="pbio.2006687.e002">
<alternatives>
<graphic id="pbio.2006687.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pbio.2006687.e002" xlink:type="simple"/>
<mml:math display="block" id="M2">
<mml:mi>p</mml:mi><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:msup><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup><mml:mo>≥</mml:mo><mml:mi>D</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac>
</mml:math>
</alternatives>
</disp-formula></p>
<p>Here, <italic>n</italic> is the total number of branches in the tree. <italic>b</italic><sub><italic>i</italic></sub> is the length of branch i. <italic>A</italic><sub><italic>i</italic></sub> and <italic>B</italic><sub><italic>i</italic></sub> are the number of cells that descend from branch <italic>i</italic> in the two samples A and B, respectively. <italic>A</italic><sub><italic>T</italic></sub> and <italic>B</italic><sub><italic>T</italic></sub> are the total number of cells in two samples A and B, respectively. <inline-formula id="pbio.2006687.e003"><alternatives><graphic id="pbio.2006687.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pbio.2006687.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mi>*</mml:mi><mml:mo>|</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is the average distance of each cell from the root, used to normalized the distance from 0 to 1. <italic>D</italic>* is the distance based on permuted data, while <italic>D</italic> is the observed distance. <italic>N</italic> is the total number of permutations. A distribution of distance is obtained with a <italic>p</italic>-value that reflects the probability that the permuted distances are greater than or equal to the observed distance by chance.</p>
<p>Unshared branches are occupied by populations with statistically significant shifts between samples. The proportion shift of a cell population <italic>i</italic> is defined as <inline-formula id="pbio.2006687.e004"><alternatives><graphic id="pbio.2006687.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pbio.2006687.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:msub><mml:mrow><mml:mi>p</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>|</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>|</mml:mo></mml:math></alternatives></inline-formula>, with statistical significance achieved if <italic>ps</italic><sub><italic>i</italic></sub> &gt; <italic>ps</italic>*, where <italic>ps</italic>* is the proportion shift in permuted datasets.</p>
</sec>
<sec id="sec014">
<title>Signature matching to reference cell types</title>
<p>The signature composed of under- or overexpressed genes associated with a cell population was defined by limma comparisons with other populations. For predicting cell types, each cell of a given cluster was matched to the 894 cell type references from the Mouse Cell Atlas [<xref ref-type="bibr" rid="pbio.2006687.ref003">3</xref>]. Matching was performed by deriving a Pearson correlation of all genes between the query cell and the reference cell type transcriptome.</p>
</sec>
<sec id="sec015">
<title>Modified scoring of p-Creode trajectories</title>
<p>The p-Creode score was originally designed to compare p-Creode trajectories as a means to evaluate robustness of the calculated trajectories and also to arrive at a representative trajectory over multiple bootstrapped runs on the same single-cell dataset. Thus, it was developed to assess the dissimilarity between trajectories of largely the same sizes. Here, we use p-Creode scoring to compare different datasets, which can generate trajectories of different sizes. To make the p-Creode score size-invariant, we modified how nodes are transformed from one graph to another while maintaining the scoring approach outlined in [<xref ref-type="bibr" rid="pbio.2006687.ref019">19</xref>]. Previously, when a node was not contained in both graphs, a node transformation was performed by translating the node in the second graph to the closest node in the first graph with a penalty (<xref ref-type="supplementary-material" rid="pbio.2006687.s006">S6A Fig</xref>). To eliminate excess penalty when a dense graph is transformed into a sparse graph and vice versa (<xref ref-type="supplementary-material" rid="pbio.2006687.s006">S6C Fig</xref>), the scoring routine was updated to allow for transformations into the edges as well as nodes in the reference first graph. More formally, the transformation penalty is the minimum distance to the closest edge projection between two nodes in opposing graphs plus the remaining graph edge distance to the closest node along the path of the pairwise comparison (<xref ref-type="supplementary-material" rid="pbio.2006687.s006">S6B Fig</xref>). The code and data for reproducing the analysis is at <ext-link ext-link-type="uri" xlink:href="https://github.com/KenLauLab/pCreode_Comparison_Across_Datasets" xlink:type="simple">https://github.com/KenLauLab/pCreode_Comparison_Across_Datasets</ext-link>.</p>
</sec>
<sec id="sec016">
<title>Batch-correction methods</title>
<p>We compared three batch-correction methods, limma, ComBat, and MNN. For limma, we used the removeBatchEffect function in the limma package, which fits a linear model to the data and then removes the component due to the batch effects [<xref ref-type="bibr" rid="pbio.2006687.ref032">32</xref>]. For ComBat, we used the ComBat function in the sva package, which uses Empirical Bayes methods to adjust for both the mean and variance differences across the batches [<xref ref-type="bibr" rid="pbio.2006687.ref030">30</xref>]. MNN identifies the mutual nearest neighbors between batches and uses them to estimate and remove the batch effect [<xref ref-type="bibr" rid="pbio.2006687.ref034">34</xref>]. We performed the mnnCorrect function in the scran package. We set the number of nearest neighbors to consider to be 20.</p>
</sec>
<sec id="sec017">
<title>scRNA-seq data sources</title>
<sec id="sec018">
<title>T-cell differentiation CyTOF dataset [<xref ref-type="bibr" rid="pbio.2006687.ref025">25</xref>]</title>
<p>This is a mass cytometry dataset characterizing the mouse thymus during T-cell development, such that lymphoid progenitors differentiate to either CD8<sup>+</sup> or CD4<sup>+</sup> cells. Data on about 250,000 cells on 37 surface markers and transcription factors were generated. We removed the DN cell population and included only CD8<sup>+</sup> or CD4<sup>+</sup> cells labeled by Wishbone. We then simulated population mixtures by randomly sampling CD8<sup>+</sup> and CD4<sup>+</sup> cells.</p>
</sec>
<sec id="sec019">
<title>Myeloid differentiation scRNA-seq dataset [<xref ref-type="bibr" rid="pbio.2006687.ref026">26</xref>]</title>
<p>This is a sc-RNAseq data conducted using MAR-seq on myeloid cell differentiation. A total of 4,423 cells were included after filtering. Erythrocytes and myeloid progenitor cells were further identified and gated using canonical markers. We then simulated population mixtures by randomly sampling erythrocytes and myeloid progenitor cells. Raw data can be assessed in GEO with accession number GSE72857.</p>
</sec>
<sec id="sec020">
<title>Fresh and frozen HEK293 scRNA-seq datasets [<xref ref-type="bibr" rid="pbio.2006687.ref035">35</xref>]</title>
<p>Single-cell transcriptomes of the fresh and cryopreserved HEK293 cells were generated by MARS-seq, which included about 50 cells in each sample. The UMI-filtered read counts were downloaded from GEO with accession number GSE85534.</p>
</sec>
<sec id="sec021">
<title>Technical and biological replicate scRNA-seq datasets from mouse colon and pancreas tissues newly generated</title>
<p>scRNA-seq data of colonic, colonic tumor, and pancreatic tissues were generated by inDrop platform, with datasets sizes ranging from approximately 500 to 1,800 cells (<xref ref-type="sec" rid="sec010">Methods</xref> described below). The UMI-filtered read counts and raw data are available from GEO with accession numbers GSE102698, GSE114044, GSE117615, and GSE117616.</p>
</sec>
<sec id="sec022">
<title>Mouse gastrulation scRNA-seq datasets [<xref ref-type="bibr" rid="pbio.2006687.ref036">36</xref>,<xref ref-type="bibr" rid="pbio.2006687.ref037">37</xref>]</title>
<p>scRNA-seq data of mouse cells during gastrulation were obtained from two studies. Mohammed and colleagues isolated single cells from mouse embryos at different stages and generated scRNA-seq data using G&amp;T-seq. We selected data from the E5.5 (267 cells), E6.5 (168 cells), and E6.75 stages (82 cells). Count tables were downloaded from GEO with accession number GSE100597. Scialdone and colleagues used Smart-seq2 to profile 1,205 cells of gastrulating mouse embryos. We selected data from the E6.5 (502 cells) and E7.0 stages (138 cells). Gene counts were downloaded from <ext-link ext-link-type="uri" xlink:href="http://gastrulation.stemcells.cam.ac.uk/scialdone2016" xlink:type="simple">http://gastrulation.stemcells.cam.ac.uk/scialdone2016</ext-link>. Ensembl gene IDs were mapped to mouse gene symbols using the biomaRt package.</p>
</sec>
<sec id="sec023">
<title>Oligodendrocyte scRNA-seq datasets from mouse brain regions [<xref ref-type="bibr" rid="pbio.2006687.ref029">29</xref>]</title>
<p>scRNA-seq data tables from brain regions microdissected from mouse brain sections were downloaded from GSE75330. In total, 5,053 cells were analyzed without filtering, distributed as cortex S1 (613), hippocampus CA1 (112), corpus callosum (591), dentate gyrus (114), dorsal horn (1,127), zona incerta (225), amygdala (135), hypothalamus (754), SN-VTA (1,247), and striatum (135).</p>
</sec>
</sec>
<sec id="sec024">
<title>scRNA-seq of colonic and pancreatic tissues</title>
<p>Single-cell suspensions of colonic epithelium were prepared by chelating (3 mM EDTA; 1 mM DTT) distal colon segments at 4°C for 45 minutes followed by shaking off crypts [<xref ref-type="bibr" rid="pbio.2006687.ref019">19</xref>,<xref ref-type="bibr" rid="pbio.2006687.ref051">51</xref>]. Isolated crypts were then dissociated into single cells using a DNase1/collagenase enzymatic cocktail (2.5 mg/mL DNase1, 2 mg/mL collagenase) at 37°C for 20 minutes. Crypt fragments were further mechanically dissociated into single cells using a 27.5-gauge needle. Cell suspensions were washed 2 times with cold PBS to remove debris and were enriched for live cells using a Miltenyi MACS dead cell removal kit. Live cell concentration was counted based on Trypan Blue positive cells, and a solution of 150,000 cells/mL was prepared for encapsulation. To maintain live cell viability, 18 ul of Optiprep was added per 100 ul of cell solution prior to encapsulation.</p>
<p>Dissociation of pancreatic buds from E14.5 control embryos was performed using previously published protocols [<xref ref-type="bibr" rid="pbio.2006687.ref052">52</xref>]. Briefly, pancreatic buds were dissected from control embryos and trypsinized followed by flow sorting. Single-cell suspensions from multiple embryonic buds were prepared, and a cell solution of 20,000 cells was prepared for encapsulation.</p>
<p>Single-cell encapsulation was performed using the inDrop platform (1CellBio) with an in vitro transcription library preparation protocol, as previously described [<xref ref-type="bibr" rid="pbio.2006687.ref001">1</xref>]. inDrop utilizes CEL-Seq in preparation for sequencing and is summarized as follows: (1) reverse transcription (RT), (2) ExoI nuclease digestion, (3) SPRI purification (SPRIP), (4) single strand synthesis, (5) SPRIP, (6) T7 in vitro transcription linear amplification, (7) SPRIP, (8) RNA fragmentation, (9) SPRIP, (10) primer ligation, (11) RT, and (12) library enrichment PCR. Number of cells encapsulated was calculated by approximating the density of single-cell suspension multiplied by bead loading efficiency during the duration of encapsulation. Each sample was estimated to contain approximately 2,500 encapsulated cells.</p>
<p>Following library preparation, as described above, the samples were sequenced using Nextseq 500 (Illumina) using a 150 bp paired-end sequencing kit in a customized sequencing run [<xref ref-type="bibr" rid="pbio.2006687.ref019">19</xref>]. After sequencing, reads were filtered, sorted by their designated barcode, and aligned to the reference transcriptome using InDrops pipeline. Mapped reads were quantified into UMI-filtered counts per gene, and barcodes that correspond to cells were retrieved based on previously established methods [<xref ref-type="bibr" rid="pbio.2006687.ref001">1</xref>]. From approximately 2,500 cells encapsulated, approximately 1,800 cells were retrieved per sample.</p>
</sec>
<sec id="sec025">
<title>Dissociation of colonic tumors</title>
<p>Dissociation of colonic adenomas was performed in a two-phase process. In the first stage, colon adenomas were dissected from the distal colon and washed in ice-cold PBS. The tumors were digested in DMEM containing 2 mg/mL collagenase type II at 37 °C for 1 hour or until fragments had dispersed. The tumor tissue suspension was washed in ice-cold PBS and filtered through a 40 μm filter. Tumor epithelial crypts retained by the filter were collected and resuspended in PBS while the flow-through was discarded. The tumor epithelial fraction was filtered again through a 100 μm filter to remove undigested fragments, and the flow-through was collected. In the second stage, isolated tumor epithelial crypts were further digested into single cells for encapsulation similar to above.</p>
</sec>
<sec id="sec026" sec-type="materials|methods">
<title>Experimental design</title>
<p>Technical replicates were different single-cell encapsulations collected from the same mouse colon but prepared and sequenced on different days. Biological replicates were tissues collected from different mice on different days but sequenced in the same run.</p>
</sec>
<sec id="sec027">
<title>Computational performance test of sc-UniFrac</title>
<p>sc-UniFrac was applied to two scRNA-seq datasets to test the time and memory cost, each composed of 25,507 genes and 1,000 cells. All tests were run without parallel computation on a Windows (Microsoft; <ext-link ext-link-type="uri" xlink:href="https://www.microsoft.com/en-us/" xlink:type="simple">https://www.microsoft.com/en-us/</ext-link>) desktop with an Intel(R) Xeon(R) CPU E5-2620 0 at 2 GHz and 32 GB memory.</p>
<p>With default parameters (500 highly variable genes, 4 PCs, and 10 clusters), sc-UniFrac took about 25 seconds to calculate the distance and statistical significance. The maximum memory used by sc-UniFrac was about 800 MB. The time and memory used only increased nominally with increasing numbers of clusters, increasing numbers of PCs, and increasing numbers of genes used. As expected, the running time increased linearly with the number of cells in each dataset (<xref ref-type="table" rid="pbio.2006687.t001">Table 1</xref>).</p>
<table-wrap id="pbio.2006687.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pbio.2006687.t001</object-id>
<label>Table 1</label> <caption><title>Computational time of sc-UniFrac on two datasets composed of 25,507 genes.</title></caption>
<alternatives>
<graphic id="pbio.2006687.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pbio.2006687.t001" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left">Number of cells in each dataset</th>
<th align="left">Running time</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">1,000</td>
<td align="left">25 s</td>
</tr>
<tr>
<td align="left">2,000</td>
<td align="left">49 s</td>
</tr>
<tr>
<td align="left">3,000</td>
<td align="left">76 s</td>
</tr>
<tr>
<td align="left">4,000</td>
<td align="left">99 s</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
</sec>
</sec>
<sec id="sec028">
<title>Supporting information</title>
<supplementary-material id="pbio.2006687.s001" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pbio.2006687.s001" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>t-SNE plot of two 1,000-cell populations simulated by resampling from CD4 and CD8 cells.</title>
<p>One cell population (N1) included only CD8 cells, while the other cell population N2 was composed of proportional mixtures of CD4 and CD8 cells (<xref ref-type="supplementary-material" rid="pbio.2006687.s012">S1 Data</xref>) [<xref ref-type="bibr" rid="pbio.2006687.ref025">25</xref>]. (A) N2 = 100% CD4 cells. (B) N2 = 100% CD8 cells. (C) N2 = 95% CD8 cells; 5% CD4 cells. (D) N2 = 50% CD8 cells; 50% CD4 cells.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pbio.2006687.s002" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pbio.2006687.s002" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Distribution of data when dataset size is imbalanced.</title>
<p>t-SNE plots of similar simulations as in <xref ref-type="supplementary-material" rid="pbio.2006687.s001">S1 Fig</xref>, with N2 being 100% CD8 cells, 50/50 CD8/CD4 cells, and 100% CD4 cells, going from left to right (<xref ref-type="supplementary-material" rid="pbio.2006687.s012">S1 Data</xref>). Altering the size of N2 to be (A) 500 and (B) 100. N1 remains at 1,000 cells.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pbio.2006687.s003" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pbio.2006687.s003" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Sensitivity and robustness analysis of sc-UniFrac using simulated sc-RNAseq data.</title>
<p>(A) Two groups (N1 and N2) of 500 cells were selected from erythrocyte and myeloid progenitor cells identified in the Paul and colleagues dataset (<xref ref-type="supplementary-material" rid="pbio.2006687.s013">S2</xref> and <xref ref-type="supplementary-material" rid="pbio.2006687.s014">S3</xref> Data) [<xref ref-type="bibr" rid="pbio.2006687.ref026">26</xref>]. N1 is always composed of 100% erythrocytes, while N2 is composed of erythrocytes and different proportions of myeloid progenitor cells (indicated on x-axis); y-axis is the sc-UniFrac distance calculated over <italic>n</italic> = 50 runs with k = 10. Boxes represent the first and third quartiles, and bars represent maximum and minimum values. (B) Sensitivity of sc-UniFrac evaluated by the fraction of incidences that a statistically significant sc-UniFrac distance was returned over <italic>n</italic> = 50 runs, as a function of increasing dissimilarity between N1 and N2 using the same simulation scheme as panel A. (C) Mean sc-UniFrac plotted as in panel A with varying k parameter. (D) Fraction significant sc-UniFrac detected plotted as in panel B with varying k parameter. (E) Mean sc-UniFrac plotted as in A with N1 = 500 but a varying N2 size to determine the effect of dataset size imbalance on sc-UniFrac. (F) Fraction significant sc-UniFrac detected plotted as in B with N1 = 500 and varying N2 size.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pbio.2006687.s004" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pbio.2006687.s004" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>Bulk analysis to demonstrate the ordering of similarity between scRNA-seq data from technical and biological replicates of the colon versus the pancreatic islet.</title>
<p>Gene correlation analysis in which scRNA-seq data were averaged to generate bulk values. Each data point (on the lower triangle plots) represents a gene whose log expression level was plotted between the two samples being compared. Upper triangle plots are calculated correlation coefficients.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pbio.2006687.s005" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pbio.2006687.s005" xlink:type="simple">
<label>S5 Fig</label>
<caption>
<title>Analysis of scRNA-seq data from technical and biological replicates of the colon, and the pancreatic islet.</title>
<p><italic>Krt20</italic> depicting the absorptive lineage, <italic>Muc2</italic> depicting the secretory lineage, and <italic>Cd8a</italic> depicting immune cells overlaid on t-SNE plots of scRNA-seq data generated from the adult murine colonic mucosa with (A) technical and (B) biological replicates. (C) Hierarchical clustering by sc-UniFrac of scRNA-seq landscapes of the E14.5 pancreatic islet and adult colonic mucosa (indicated by tissue label), with technical and biological replicates (indicated by mouse label). Heat represents sc-UniFrac distance between two samples.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pbio.2006687.s006" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pbio.2006687.s006" xlink:type="simple">
<label>S6 Fig</label>
<caption>
<title>Differences between trajectories constructed from continuous single-cell data revealed by p-Creode scoring.</title>
<p>(A) Scheme of old node-to-node projection strategy used for the previous p-Creode scoring approach [<xref ref-type="bibr" rid="pbio.2006687.ref019">19</xref>]. Dotted line represents Euclidean distance penalty of each transformation. Green and red nodes are from different trajectories. (B) Scheme of new node-to-edge projection strategy used for the current p-Creode scoring approach. (C) Demonstration of excess penalization using the previous p-Creode scoring strategy when there is an imbalance in dataset size resulting in different numbers of nodes in the trajectory (top) versus more realistic penalization with the current approach (bottom). (D) Hierarchical clustering by p-Creode scoring of trajectories generated from scRNA-seq data of E14.5 pancreatic islet (green—biological replicates) and adult colonic mucosa (red—technical and biological replicates). <italic>N</italic> = 100 resampled p-Creode runs for each dataset were performed and then analyzed together in a single clustering analysis. Heat represents the p-Creode score between two trajectories.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pbio.2006687.s007" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pbio.2006687.s007" xlink:type="simple">
<label>S7 Fig</label>
<caption>
<title>p-Creode trajectory analysis of scRNA-seq data from technical and biological replicates of the colon, and the pancreatic islet.</title>
<p>(A) <italic>Krt20</italic> depicting colonocytes, <italic>Reg4</italic> depicting deep crypt secretory cells, and <italic>Myc</italic> depicting stem and progenitor cells overlaid on a representative p-Creode trajectory of scRNA-seq data generated from the murine colonic epithelium. (B) Representative p-Creode trajectories depicting colonic and pancreatic islet differentiation. Outlined lineages were identified with canonical markers. Overlay of <italic>Muc2</italic> transcript level, which was not expressed in the pancreatic islet.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pbio.2006687.s008" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pbio.2006687.s008" xlink:type="simple">
<label>S8 Fig</label>
<caption>
<title>Gene signature extraction and single-cell landscape ordering using sc-UniFrac.</title>
<p>(A) Differential expressed gene identified by limma for each of the 10 groups in <xref ref-type="fig" rid="pbio.2006687.g005">Fig 5</xref>. (B) PCA plot of multiple replicates of single-cell data from the pancreas, colonic tumor, adjacent normal colon, and normal colon analyzed together as in <xref ref-type="fig" rid="pbio.2006687.g006">Fig 6A</xref>.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pbio.2006687.s009" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pbio.2006687.s009" xlink:type="simple">
<label>S9 Fig</label>
<caption>
<title>Comparing scRNA-seq data from frozen or freshly prepared samples from different batches.</title>
<p>Hierarchical clustering by sc-UniFrac of scRNA-seq data from cell lines that are prepared differently (GSE85534) [<xref ref-type="bibr" rid="pbio.2006687.ref035">35</xref>]. Heat depicts the sc-UniFrac distance between 2 samples. The results are consistent with the original study, which shows that the freezing process did not alter transcriptional profiles. In contrast, batch effects have a larger impact on the transcription profiles than the freezing process.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pbio.2006687.s010" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pbio.2006687.s010" xlink:type="simple">
<label>S10 Fig</label>
<caption>
<title>The effects of batch correction.</title>
<p>t-SNE analysis of scRNA-seq data from cell lines prepared from two batches (Frozen 1 and 2) [<xref ref-type="bibr" rid="pbio.2006687.ref035">35</xref>] (A) uncorrected, (B) corrected by ComBat, and (C) corrected by MNN. t-SNE analysis of scRNA-seq data from the colonic mucosa from two technical replicates (Replicates 1 and 2). sc-UniFrac distance between the samples and <italic>p</italic>-value noted.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pbio.2006687.s011" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pbio.2006687.s011" xlink:type="simple">
<label>S11 Fig</label>
<caption>
<title>Batch correction applied on data from different studies to align samples according to developmental time.</title>
<p>t-SNE analysis of scRNA-seq data depicting mouse gastrulation, with colors representing developmental time and shapes of data points representing the two studies [<xref ref-type="bibr" rid="pbio.2006687.ref036">36</xref>,<xref ref-type="bibr" rid="pbio.2006687.ref037">37</xref>]. For instance, all red data points should cluster together. Analysis performed on (A) uncorrected, (B) ComBat-corrected, (C) limma-corrected, and (D) MNN-corrected data.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pbio.2006687.s012" mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" position="float" xlink:href="info:doi/10.1371/journal.pbio.2006687.s012" xlink:type="simple">
<label>S1 Data</label>
<caption>
<title>Processed data supporting <xref ref-type="fig" rid="pbio.2006687.g002">Fig 2</xref>.</title>
<p>(XLSX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pbio.2006687.s013" mimetype="text/csv" position="float" xlink:href="info:doi/10.1371/journal.pbio.2006687.s013" xlink:type="simple">
<label>S2 Data</label>
<caption>
<title>Processed data (erythrocyte) supporting <xref ref-type="supplementary-material" rid="pbio.2006687.s003">S3 Fig</xref>.</title>
<p>(CSV)</p>
</caption>
</supplementary-material>
<supplementary-material id="pbio.2006687.s014" mimetype="text/csv" position="float" xlink:href="info:doi/10.1371/journal.pbio.2006687.s014" xlink:type="simple">
<label>S3 Data</label>
<caption>
<title>Processed data (myeloid progenitor) supporting <xref ref-type="supplementary-material" rid="pbio.2006687.s003">S3 Fig</xref>.</title>
<p>(CSV)</p>
</caption>
</supplementary-material>
<supplementary-material id="pbio.2006687.s015" mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" position="float" xlink:href="info:doi/10.1371/journal.pbio.2006687.s015" xlink:type="simple">
<label>S4 Data</label>
<caption>
<title>Processed data supporting <xref ref-type="fig" rid="pbio.2006687.g004">Fig 4</xref>.</title>
<p>(XLSX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pbio.2006687.s016" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pbio.2006687.s016" xlink:type="simple">
<label>S1 Report</label>
<caption>
<title>Example of sc-UniFrac-generated report.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>The authors would like to thank Dr. Olivia Koues and the VANTAGE core for technical assistance as well as members of the Vanderbilt Epithelial Biology Center and Quantitative Systems Biology Center for helpful discussions. We would also like to thank Dr. Rebecca Ihrie for her in-depth discussion on brain anatomy and development.</p>
</ack>
<glossary>
<title>Abbreviations</title>
<def-list>
<def-item><term>Apc</term>
<def><p>Adenomatous Polyposis Coli</p></def>
</def-item>
<def-item><term>CyTOF</term>
<def><p>cytometry time-of-flight</p></def>
</def-item>
<def-item><term>E</term>
<def><p>embryonic day</p></def>
</def-item>
<def-item><term>EMD</term>
<def><p>Earth Mover’s Distance</p></def>
</def-item>
<def-item><term>HEK293</term>
<def><p>human embryonic kidney 293</p></def>
</def-item>
<def-item><term>OPC</term>
<def><p>oligodendrocyte progenitor cell</p></def>
</def-item>
<def-item><term>PCA</term>
<def><p>principal component analysis</p></def>
</def-item>
<def-item><term>RT</term>
<def><p>reverse transcription</p></def>
</def-item>
<def-item><term>scRNA-seq</term>
<def><p>single-cell RNA-sequencing</p></def>
</def-item>
<def-item><term>SN-VTA</term>
<def><p>substantia nigra and ventral tegmental area</p></def>
</def-item>
<def-item><term>SPRIP</term>
<def><p>SPRI purification</p></def>
</def-item>
<def-item><term>t-SNE</term>
<def><p>t-distributed stochastic neighbor embedding</p></def>
</def-item>
</def-list>
</glossary>
<ref-list>
<title>References</title>
<ref id="pbio.2006687.ref001"><label>1</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Klein</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Mazutis</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Akartuna</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Tallapragada</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Veres</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>V</given-names></name>, <etal>et al</etal>. <article-title>Droplet Barcoding for Single-Cell Transcriptomics Applied to Embryonic Stem Cells</article-title>. <source>Cell</source>. <year>2015</year>;<volume>161</volume>(<issue>5</issue>):<fpage>1187</fpage>–<lpage>1201</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cell.2015.04.044" xlink:type="simple">10.1016/j.cell.2015.04.044</ext-link></comment> <object-id pub-id-type="pmid">26000487</object-id></mixed-citation></ref>
<ref id="pbio.2006687.ref002"><label>2</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Macosko</surname> <given-names>EZ</given-names></name>, <name name-style="western"><surname>Basu</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Satija</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Nemesh</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Shekhar</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Goldman</surname> <given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Highly Parallel Genome-wide Expression Profiling of Individual Cells Using Nanoliter Droplets</article-title>. <source>Cell</source>. <year>2015</year>;<volume>161</volume>(<issue>5</issue>):<fpage>1202</fpage>–<lpage>1214</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cell.2015.05.002" xlink:type="simple">10.1016/j.cell.2015.05.002</ext-link></comment> <object-id pub-id-type="pmid">26000488</object-id></mixed-citation></ref>
<ref id="pbio.2006687.ref003"><label>3</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Han</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Zhou</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Fei</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Sun</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Lai</surname> <given-names>S</given-names></name>, <etal>et al</etal>. <article-title>Mapping the Mouse Cell Atlas by Microwell-Seq</article-title>. <source>Cell</source>. <year>2018</year>;<volume>172</volume>(<issue>5</issue>):<fpage>1091</fpage>–<lpage>1107</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cell.2018.02.001" xlink:type="simple">10.1016/j.cell.2018.02.001</ext-link></comment> <object-id pub-id-type="pmid">29474909</object-id></mixed-citation></ref>
<ref id="pbio.2006687.ref004"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gierahn</surname> <given-names>TM</given-names></name>, <name name-style="western"><surname>Wadsworth</surname> <given-names>MH</given-names></name>, <name name-style="western"><surname>Hughes</surname> <given-names>TK</given-names></name>, <name name-style="western"><surname>Bryson</surname> <given-names>BD</given-names></name>, <name name-style="western"><surname>Butler</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Satija</surname> <given-names>R</given-names></name>, <etal>et al</etal>. <article-title>Seq-Well: Portable, low-cost rna sequencing of single cells at high throughput</article-title>. <source>Nat Methods</source>. <year>2017</year>;<volume>14</volume>(<issue>4</issue>):<fpage>395</fpage>–<lpage>398</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nmeth.4179" xlink:type="simple">10.1038/nmeth.4179</ext-link></comment> <object-id pub-id-type="pmid">28192419</object-id></mixed-citation></ref>
<ref id="pbio.2006687.ref005"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zheng</surname> <given-names>GXY</given-names></name>, <name name-style="western"><surname>Terry</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Belgrader</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Ryvkin</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Bent</surname> <given-names>ZW</given-names></name>, <name name-style="western"><surname>Wilson</surname> <given-names>R</given-names></name>, <etal>et al</etal>. <article-title>Massively parallel digital transcriptional profiling of single cells</article-title>. <source>Nat Commun</source>. <year>2017</year>;<volume>8</volume>:<fpage>14049</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ncomms14049" xlink:type="simple">10.1038/ncomms14049</ext-link></comment> <object-id pub-id-type="pmid">28091601</object-id></mixed-citation></ref>
<ref id="pbio.2006687.ref006"><label>6</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jaitin</surname> <given-names>DA</given-names></name>, <name name-style="western"><surname>Kenigsberg</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Keren-Shaul</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Elefant</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Paul</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Zaretsky</surname> <given-names>I</given-names></name>, <etal>et al</etal>. <article-title>Massively parallel single-cell RNA-seq for marker-free decomposition of tissues into cell types</article-title>. <source>Science</source>. <year>2014</year>;<volume>343</volume>(<issue>6172</issue>):<fpage>776</fpage>–<lpage>779</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.1247651" xlink:type="simple">10.1126/science.1247651</ext-link></comment> <object-id pub-id-type="pmid">24531970</object-id></mixed-citation></ref>
<ref id="pbio.2006687.ref007"><label>7</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Treutlein</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Brownfield</surname> <given-names>DG</given-names></name>, <name name-style="western"><surname>Wu</surname> <given-names>AR</given-names></name>, <name name-style="western"><surname>Neff</surname> <given-names>NF</given-names></name>, <name name-style="western"><surname>Mantalas</surname> <given-names>GL</given-names></name>, <name name-style="western"><surname>Espinoza</surname> <given-names>FH</given-names></name>, <etal>et al</etal>. <article-title>Reconstructing lineage hierarchies of the distal lung epithelium using single-cell RNA-seq</article-title>. <source>Nature</source>. <year>2014</year>;<volume>509</volume>(<issue>7500</issue>):<fpage>371</fpage>–<lpage>375</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature13173" xlink:type="simple">10.1038/nature13173</ext-link></comment> <object-id pub-id-type="pmid">24739965</object-id></mixed-citation></ref>
<ref id="pbio.2006687.ref008"><label>8</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Shalek</surname> <given-names>AK</given-names></name>, <name name-style="western"><surname>Satija</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Adiconis</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Gertner</surname> <given-names>RS</given-names></name>, <name name-style="western"><surname>Gaublomme</surname> <given-names>JT</given-names></name>, <name name-style="western"><surname>Raychowdhury</surname> <given-names>R</given-names></name>, <etal>et al</etal>. <article-title>Single-cell transcriptomics reveals bimodality in expression and splicing in immune cells</article-title>. <source>Nature</source>. <year>2013</year>;<volume>498</volume>(<issue>7453</issue>):<fpage>236</fpage>–<lpage>240</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature12172" xlink:type="simple">10.1038/nature12172</ext-link></comment> <object-id pub-id-type="pmid">23685454</object-id></mixed-citation></ref>
<ref id="pbio.2006687.ref009"><label>9</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Moon</surname> <given-names>KR</given-names></name>, <name name-style="western"><surname>Stanley</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Burkhardt</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>van Dijk</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Wolf</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Krishnaswamy</surname> <given-names>S</given-names></name>. <article-title>Manifold learning-based methods for analyzing single-cell RNA-sequencing data</article-title>. <source>Curr Opin Syst Biol</source>. <year>2017</year>;<volume>7</volume>:<fpage>36</fpage>–<lpage>46</lpage>.</mixed-citation></ref>
<ref id="pbio.2006687.ref010"><label>10</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Herring</surname> <given-names>CA</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>McKinley</surname> <given-names>ET</given-names></name>, <name name-style="western"><surname>Lau</surname> <given-names>KS</given-names></name>. <article-title>Single-Cell Computational Strategies for Lineage Reconstruction in Tissue Systems</article-title>. <source>Cell Mol Gastroenterol Hepatol</source>. <year>2018</year>;<volume>5</volume>(<issue>4</issue>):<fpage>539</fpage>–<lpage>548</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.jcmgh.2018.01.023" xlink:type="simple">10.1016/j.jcmgh.2018.01.023</ext-link></comment> <object-id pub-id-type="pmid">29713661</object-id></mixed-citation></ref>
<ref id="pbio.2006687.ref011"><label>11</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Van Der Maaten</surname> <given-names>LJP</given-names></name>, <name name-style="western"><surname>Hinton</surname> <given-names>GE</given-names></name>. <article-title>Visualizing high-dimensional data using t-sne</article-title>. <source>J Mach Learn Res</source>. <year>2008</year>;<volume>9</volume>:<fpage>2579</fpage>–<lpage>2605</lpage>.</mixed-citation></ref>
<ref id="pbio.2006687.ref012"><label>12</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mair</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Hartmann</surname> <given-names>FJ</given-names></name>, <name name-style="western"><surname>Mrdjen</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Tosevski</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Krieg</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Becher</surname> <given-names>B</given-names></name>. <article-title>The end of gating? An introduction to automated analysis of high dimensional cytometry data</article-title>. <source>Eur J Immunol</source>. <year>2016</year>;<volume>46</volume>(<issue>1</issue>):<fpage>34</fpage>–<lpage>43</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/eji.201545774" xlink:type="simple">10.1002/eji.201545774</ext-link></comment> <object-id pub-id-type="pmid">26548301</object-id></mixed-citation></ref>
<ref id="pbio.2006687.ref013"><label>13</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yan</surname> <given-names>KS</given-names></name>, <name name-style="western"><surname>Gevaert</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Zheng</surname> <given-names>GXY</given-names></name>, <name name-style="western"><surname>Anchang</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Probert</surname> <given-names>CS</given-names></name>, <name name-style="western"><surname>Larkin</surname> <given-names>KA</given-names></name>, <etal>et al</etal>. <article-title>Intestinal Enteroendocrine Lineage Cells Possess Homeostatic and Injury-Inducible Stem Cell Activity</article-title>. <source>Cell Stem Cell</source>. <year>2017</year>;<volume>21</volume>(<issue>1</issue>):<fpage>78</fpage>–<lpage>90</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.stem.2017.06.014" xlink:type="simple">10.1016/j.stem.2017.06.014</ext-link></comment> <object-id pub-id-type="pmid">28686870</object-id></mixed-citation></ref>
<ref id="pbio.2006687.ref014"><label>14</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bruggner</surname> <given-names>RV</given-names></name>, <name name-style="western"><surname>Bodenmiller</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Dill</surname> <given-names>DL</given-names></name>, <name name-style="western"><surname>Tibshirani</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Nolan</surname> <given-names>GP</given-names></name>. <article-title>Automated identification of stratifying signatures in cellular subpopulations</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2014</year>;<volume>111</volume>(<issue>26</issue>):<fpage>E2770</fpage>–<lpage>E2777</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1408792111" xlink:type="simple">10.1073/pnas.1408792111</ext-link></comment> <object-id pub-id-type="pmid">24979804</object-id></mixed-citation></ref>
<ref id="pbio.2006687.ref015"><label>15</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Boem</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Pellegrino</surname> <given-names>FA</given-names></name>, <name name-style="western"><surname>Fenu</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Parisini</surname> <given-names>T</given-names></name>. <article-title>Trajectory clustering by means of Earth Mover’s Distance</article-title>. <source>IFAC Proc Vol</source>. <year>2011</year>;<volume>44</volume>(<issue>1</issue>):<fpage>4741</fpage>–<lpage>4746</lpage>.</mixed-citation></ref>
<ref id="pbio.2006687.ref016"><label>16</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Orlova</surname> <given-names>DY</given-names></name>, <name name-style="western"><surname>Zimmerman</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Meehan</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Meehan</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Waters</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Ghosn</surname> <given-names>EEB</given-names></name>, <etal>et al</etal>. <article-title>Earth Mover’s Distance (EMD): A True Metric for Comparing Biomarker Expression Levels in Cell Populations</article-title>. <source>PLoS ONE</source>. <year>2016</year>;<volume>11</volume>(<issue>3</issue>):<fpage>e0151859</fpage>. <object-id pub-id-type="pmid">27008164</object-id></mixed-citation></ref>
<ref id="pbio.2006687.ref017"><label>17</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wang</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Zhu</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Pierson</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Ramazzotti</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Batzoglou</surname> <given-names>S</given-names></name>. <article-title>Visualization and analysis of single-cell RNA-seq data by kernel-based similarity learning</article-title>. <source>Nat Methods</source>. <year>2017</year>;<volume>14</volume>(<issue>4</issue>):<fpage>414</fpage>–<lpage>416</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nmeth.4207" xlink:type="simple">10.1038/nmeth.4207</ext-link></comment> <object-id pub-id-type="pmid">28263960</object-id></mixed-citation></ref>
<ref id="pbio.2006687.ref018"><label>18</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pierson</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Yau</surname> <given-names>C</given-names></name>. <article-title>ZIFA: Dimensionality reduction for zero-inflated single-cell gene expression analysis</article-title>. <source>Genome Biol</source>. <year>2015</year>;<volume>16</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>10</lpage>.</mixed-citation></ref>
<ref id="pbio.2006687.ref019"><label>19</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Herring</surname> <given-names>CA</given-names></name>, <name name-style="western"><surname>Banerjee</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>McKinley</surname> <given-names>ET</given-names></name>, <name name-style="western"><surname>Simmons</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Ping</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Roland</surname> <given-names>JT</given-names></name>, <etal>et al</etal>. <article-title>Unsupervised Trajectory Analysis of Single-Cell RNA-Seq and Imaging Data Reveals Alternative Tuft Cell Origins in the Gut</article-title>. <source>Cell Syst</source>. <year>2018</year>;<volume>6</volume>(<issue>1</issue>):<fpage>37</fpage>–<lpage>51</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cels.2017.10.012" xlink:type="simple">10.1016/j.cels.2017.10.012</ext-link></comment> <object-id pub-id-type="pmid">29153838</object-id></mixed-citation></ref>
<ref id="pbio.2006687.ref020"><label>20</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Alpert</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Moore</surname> <given-names>LS</given-names></name>, <name name-style="western"><surname>Dubovik</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Shen-Orr</surname> <given-names>SS</given-names></name>. <article-title>Alignment of single-cell trajectories to compare cellular expression dynamics</article-title>. <source>Nat Methods</source>. <year>2018</year>;<volume>15</volume>(<issue>4</issue>):<fpage>267</fpage>–<lpage>270</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nmeth.4628" xlink:type="simple">10.1038/nmeth.4628</ext-link></comment> <object-id pub-id-type="pmid">29529018</object-id></mixed-citation></ref>
<ref id="pbio.2006687.ref021"><label>21</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Butler</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Hoffman</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Smibert</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Papalexi</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Satija</surname> <given-names>R</given-names></name>. <article-title>Integrating single-cell transcriptomic data across different conditions, technologies, and species</article-title>. <source>Nat Biotechnol</source>. <year>2018</year>;<volume>36</volume>(<issue>5</issue>):<fpage>411</fpage>–<lpage>420</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nbt.4096" xlink:type="simple">10.1038/nbt.4096</ext-link></comment> <object-id pub-id-type="pmid">29608179</object-id></mixed-citation></ref>
<ref id="pbio.2006687.ref022"><label>22</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Buttner</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Miao</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Wolf</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Teichmann</surname> <given-names>SA</given-names></name>, <name name-style="western"><surname>Theis</surname> <given-names>FJ</given-names></name>. <article-title>Assessment of batch-correction methods for scRNA-seq data with a new test metric</article-title>; <year>2018</year>. <source>Preprint. bioRxiv</source>: <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1101/200345" xlink:type="simple">10.1101/200345</ext-link></comment></mixed-citation></ref>
<ref id="pbio.2006687.ref023"><label>23</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Baker</surname> <given-names>FB</given-names></name>. <article-title>Stability of Two Hierarchical Grouping Techniques Case 1: Sensitivity to Data Errors</article-title>. <source>J Am Stat Assoc</source>. <year>1974</year>;<volume>69</volume>(<issue>346</issue>):<fpage>440</fpage>–<lpage>445</lpage>.</mixed-citation></ref>
<ref id="pbio.2006687.ref024"><label>24</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Simmons</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Scurrah</surname> <given-names>CR</given-names></name>, <name name-style="western"><surname>McKinley</surname> <given-names>ET</given-names></name>, <name name-style="western"><surname>Herring</surname> <given-names>CA</given-names></name>, <name name-style="western"><surname>Irish</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Washington</surname> <given-names>MK</given-names></name>, <etal>et al</etal>. <article-title>Impaired coordination between signaling pathways is revealed in human colorectal cancer using single-cell mass cytometry of archival tissue blocks</article-title>. <source>Sci Signal</source>. <year>2016</year>;<volume>9</volume>(<issue>449</issue>):<fpage>rs11</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/scisignal.aah4413" xlink:type="simple">10.1126/scisignal.aah4413</ext-link></comment> <object-id pub-id-type="pmid">27729552</object-id></mixed-citation></ref>
<ref id="pbio.2006687.ref025"><label>25</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Setty</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Tadmor</surname> <given-names>MD</given-names></name>, <name name-style="western"><surname>Reich-Zeliger</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Angel</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Salame</surname> <given-names>TM</given-names></name>, <name name-style="western"><surname>Kathail</surname> <given-names>P</given-names></name>, <etal>et al</etal>. <article-title>Wishbone identifies bifurcating developmental trajectories from single-cell data</article-title>. <source>Nat Biotechnol</source>. <year>2016</year>;<volume>34</volume>(<issue>6</issue>):<fpage>637</fpage>–<lpage>645</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nbt.3569" xlink:type="simple">10.1038/nbt.3569</ext-link></comment> <object-id pub-id-type="pmid">27136076</object-id></mixed-citation></ref>
<ref id="pbio.2006687.ref026"><label>26</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Paul</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Arkin</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Giladi</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Jaitin</surname> <given-names>DA</given-names></name>, <name name-style="western"><surname>Kenigsberg</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Keren-Shaul</surname> <given-names>H</given-names></name>, <etal>et al</etal>. <article-title>Transcriptional Heterogeneity and Lineage Commitment in Myeloid Progenitors</article-title>. <source>Cell</source>. <year>2015</year>;<volume>163</volume>(<issue>7</issue>):<fpage>1663</fpage>–<lpage>1677</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cell.2015.11.013" xlink:type="simple">10.1016/j.cell.2015.11.013</ext-link></comment> <object-id pub-id-type="pmid">26627738</object-id></mixed-citation></ref>
<ref id="pbio.2006687.ref027"><label>27</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Powell</surname> <given-names>AE</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Poulin</surname> <given-names>EJ</given-names></name>, <name name-style="western"><surname>Means</surname> <given-names>AL</given-names></name>, <name name-style="western"><surname>Washington</surname> <given-names>MK</given-names></name>, <etal>et al</etal>. <article-title>The pan-ErbB negative regulator Lrig1 is an intestinal stem cell marker that functions as a tumor suppressor</article-title>. <source>Cell</source>. <year>2012</year>;<volume>149</volume>(<issue>1</issue>):<fpage>146</fpage>–<lpage>158</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cell.2012.02.042" xlink:type="simple">10.1016/j.cell.2012.02.042</ext-link></comment> <object-id pub-id-type="pmid">22464327</object-id></mixed-citation></ref>
<ref id="pbio.2006687.ref028"><label>28</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Powell</surname> <given-names>AE</given-names></name>, <name name-style="western"><surname>Vlacich</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Zhao</surname> <given-names>Z-Y</given-names></name>, <name name-style="western"><surname>McKinley</surname> <given-names>ET</given-names></name>, <name name-style="western"><surname>Washington</surname> <given-names>MK</given-names></name>, <name name-style="western"><surname>Manning</surname> <given-names>HC</given-names></name>, <etal>et al</etal>. <article-title>Inducible loss of one Apc allele in Lrig1-expressing progenitor cells results in multiple distal colonic tumors with features of familial adenomatous polyposis</article-title>. <source>Am J Physiol Gastrointest Liver Physiol</source>. <year>2014</year>;<volume>307</volume>(<issue>1</issue>):<fpage>G16</fpage>–<lpage>G23</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1152/ajpgi.00358.2013" xlink:type="simple">10.1152/ajpgi.00358.2013</ext-link></comment> <object-id pub-id-type="pmid">24833705</object-id></mixed-citation></ref>
<ref id="pbio.2006687.ref029"><label>29</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Marques</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Zeisel</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Codeluppi</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Van Bruggen</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Falcão</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Xiao</surname> <given-names>L</given-names></name>, <etal>et al</etal>. <article-title>Oligodendrocyte heterogneity in the mouse juvenile and adult central nervous system</article-title>. <source>Science</source>. <year>2016</year>;<volume>352</volume>(<issue>6291</issue>):<fpage>1326</fpage>–<lpage>1329</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.aaf6463" xlink:type="simple">10.1126/science.aaf6463</ext-link></comment> <object-id pub-id-type="pmid">27284195</object-id></mixed-citation></ref>
<ref id="pbio.2006687.ref030"><label>30</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Johnson</surname> <given-names>WE</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Rabinovic</surname> <given-names>A</given-names></name>. <article-title>Adjusting batch effects in microarray expression data using empirical Bayes methods</article-title>. <source>Biostatistics</source>. <year>2007</year>;<volume>8</volume>(<issue>1</issue>):<fpage>118</fpage>–<lpage>127</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/biostatistics/kxj037" xlink:type="simple">10.1093/biostatistics/kxj037</ext-link></comment> <object-id pub-id-type="pmid">16632515</object-id></mixed-citation></ref>
<ref id="pbio.2006687.ref031"><label>31</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lun</surname> <given-names>ATL</given-names></name>, <name name-style="western"><surname>Bach</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Marioni</surname> <given-names>JC</given-names></name>. <article-title>Pooling across cells to normalize single-cell RNA sequencing data with many zero counts</article-title>. <source>Genome Biol</source>. <year>2016</year>;<volume>17</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>14</lpage>.</mixed-citation></ref>
<ref id="pbio.2006687.ref032"><label>32</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ritchie</surname> <given-names>ME</given-names></name>, <name name-style="western"><surname>Phipson</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Wu</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Hu</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Law</surname> <given-names>CW</given-names></name>, <name name-style="western"><surname>Shi</surname> <given-names>W</given-names></name>, <etal>et al</etal>. <article-title>limma powers differential expression analyses for RNA-sequencing and microarray studies</article-title>. <source>Nucleic Acids Res</source>. <year>2015</year>;<volume>43</volume>(<issue>7</issue>):<fpage>e47</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gkv007" xlink:type="simple">10.1093/nar/gkv007</ext-link></comment> <object-id pub-id-type="pmid">25605792</object-id></mixed-citation></ref>
<ref id="pbio.2006687.ref033"><label>33</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Shaham</surname> <given-names>U</given-names></name>, <name name-style="western"><surname>Stanton</surname> <given-names>KP</given-names></name>, <name name-style="western"><surname>Zhao</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Raddassi</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Montgomery</surname> <given-names>R</given-names></name>, <etal>et al</etal>. <article-title>Removal of batch effects using distribution-matching residual networks</article-title>. <source>Bioinformatics</source>. <year>2017</year>;<volume>33</volume>(<issue>16</issue>):<fpage>2539</fpage>–<lpage>2546</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btx196" xlink:type="simple">10.1093/bioinformatics/btx196</ext-link></comment> <object-id pub-id-type="pmid">28419223</object-id></mixed-citation></ref>
<ref id="pbio.2006687.ref034"><label>34</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Haghverdi</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Lun</surname> <given-names>ATL</given-names></name>, <name name-style="western"><surname>Morgan</surname> <given-names>MD</given-names></name>, <name name-style="western"><surname>Marioni</surname> <given-names>JC</given-names></name>. <article-title>Batch effects in single-cell RNA-sequencing data are corrected by matching mutual nearest neighbors</article-title>. <source>Nat Biotechnol</source>. <year>2018</year>;<volume>36</volume>(<issue>5</issue>):<fpage>421</fpage>–<lpage>427</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nbt.4091" xlink:type="simple">10.1038/nbt.4091</ext-link></comment> <object-id pub-id-type="pmid">29608177</object-id></mixed-citation></ref>
<ref id="pbio.2006687.ref035"><label>35</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Guillaumet-Adkins</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Rodríguez-Esteban</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Mereu</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Mendez-Lago</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Jaitin</surname> <given-names>DA</given-names></name>, <name name-style="western"><surname>Villanueva</surname> <given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Single-cell transcriptome conservation in cryopreserved cells and tissues</article-title>. <source>Genome Biol</source>. <year>2017</year>;<volume>18</volume>(<issue>1</issue>):<fpage>45</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/s13059-017-1171-9" xlink:type="simple">10.1186/s13059-017-1171-9</ext-link></comment> <object-id pub-id-type="pmid">28249587</object-id></mixed-citation></ref>
<ref id="pbio.2006687.ref036"><label>36</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mohammed</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Hernando-Herraez</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Savino</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Scialdone</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Macaulay</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Mulas</surname> <given-names>C</given-names></name>, <etal>et al</etal>. <article-title>Single-Cell Landscape of Transcriptional Heterogeneity and Cell Fate Decisions during Mouse Early Gastrulation</article-title>. <source>Cell Rep</source>. <year>2017</year>;<volume>20</volume>(<issue>5</issue>):<fpage>1215</fpage>–<lpage>1228</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.celrep.2017.07.009" xlink:type="simple">10.1016/j.celrep.2017.07.009</ext-link></comment> <object-id pub-id-type="pmid">28768204</object-id></mixed-citation></ref>
<ref id="pbio.2006687.ref037"><label>37</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Scialdone</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Tanaka</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Jawaid</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Moignard</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Wilson</surname> <given-names>NK</given-names></name>, <name name-style="western"><surname>Macaulay</surname> <given-names>IC</given-names></name>, <etal>et al</etal>. <article-title>Resolving early mesoderm diversification through single-cell expression profiling</article-title>. <source>Nature</source>. <year>2016</year>;<volume>535</volume>(<issue>7611</issue>):<fpage>289</fpage>–<lpage>293</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature18633" xlink:type="simple">10.1038/nature18633</ext-link></comment> <object-id pub-id-type="pmid">27383781</object-id></mixed-citation></ref>
<ref id="pbio.2006687.ref038"><label>38</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lozupone</surname> <given-names>CA</given-names></name>, <name name-style="western"><surname>Knight</surname> <given-names>R</given-names></name>. <article-title>The UniFrac significance test is sensitive to tree topology</article-title>. <source>BMC Bioinformatics</source>. <year>2015</year>;<volume>16</volume>:<fpage>211</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/s12859-015-0640-y" xlink:type="simple">10.1186/s12859-015-0640-y</ext-link></comment> <object-id pub-id-type="pmid">26150095</object-id></mixed-citation></ref>
<ref id="pbio.2006687.ref039"><label>39</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tellez-Gabriel</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Ory</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Lamoureux</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Heymann</surname> <given-names>M-F</given-names></name>, <name name-style="western"><surname>Heymann</surname> <given-names>D</given-names></name>. <article-title>Tumour Heterogeneity: The Key Advantages of Single-Cell Analysis</article-title>. <source>Int J Mol Sci</source>. <year>2016</year>;<volume>17</volume>(<issue>12</issue>):<fpage>2142</fpage>.</mixed-citation></ref>
<ref id="pbio.2006687.ref040"><label>40</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Altschuler</surname> <given-names>SJ</given-names></name>, <name name-style="western"><surname>Wu</surname> <given-names>LF</given-names></name>. <article-title>Cellular heterogeneity: do differences make a difference?</article-title> <source>Cell</source>. <year>2010</year>;<volume>141</volume>(<issue>4</issue>):<fpage>559</fpage>–<lpage>563</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cell.2010.04.033" xlink:type="simple">10.1016/j.cell.2010.04.033</ext-link></comment> <object-id pub-id-type="pmid">20478246</object-id></mixed-citation></ref>
<ref id="pbio.2006687.ref041"><label>41</label><mixed-citation publication-type="journal" xlink:type="simple"><collab>The Cancer Genome Atlas Network</collab>. <article-title>Comprehensive molecular characterization of human colon and rectal cancer</article-title>. <source>Nature</source>. <year>2012</year>;<volume>487</volume>(<issue>7407</issue>):<fpage>330</fpage>–<lpage>337</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature11252" xlink:type="simple">10.1038/nature11252</ext-link></comment> <object-id pub-id-type="pmid">22810696</object-id></mixed-citation></ref>
<ref id="pbio.2006687.ref042"><label>42</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Shi</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Beauchamp</surname> <given-names>RD</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>B</given-names></name>. <article-title>A network-based gene expression signature informs prognosis and treatment for colorectal cancer patients</article-title>. <source>PLoS ONE</source>. <year>2012</year>;<volume>7</volume>(<issue>7</issue>):<fpage>e41292</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0041292" xlink:type="simple">10.1371/journal.pone.0041292</ext-link></comment> <object-id pub-id-type="pmid">22844451</object-id></mixed-citation></ref>
<ref id="pbio.2006687.ref043"><label>43</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Guinney</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Dienstmann</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>de Reyniès</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Schlicker</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Soneson</surname> <given-names>C</given-names></name>, <etal>et al</etal>. <article-title>The consensus molecular subtypes of colorectal cancer</article-title>. <source>Nat Med</source>. <year>2015</year>;<volume>21</volume>(<issue>11</issue>):<fpage>1350</fpage>–<lpage>1356</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nm.3967" xlink:type="simple">10.1038/nm.3967</ext-link></comment> <object-id pub-id-type="pmid">26457759</object-id></mixed-citation></ref>
<ref id="pbio.2006687.ref044"><label>44</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dienstmann</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Vermeulen</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Guinney</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Kopetz</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Tejpar</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Tabernero</surname> <given-names>J</given-names></name>. <article-title>Consensus molecular subtypes and the evolution of precision medicine in colorectal cancer</article-title>. <source>Nat Rev Cancer</source>. <year>2017</year>;<volume>17</volume>(<issue>2</issue>):<fpage>79</fpage>–<lpage>92</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nrc.2016.126" xlink:type="simple">10.1038/nrc.2016.126</ext-link></comment> <object-id pub-id-type="pmid">28050011</object-id></mixed-citation></ref>
<ref id="pbio.2006687.ref045"><label>45</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zhang</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Zhu</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Liu</surname> <given-names>Q</given-names></name>, <name name-style="western"><surname>Shi</surname> <given-names>Z</given-names></name>, <etal>et al</etal>. <article-title>Proteogenomic characterization of human colon and rectal cancer</article-title>. <source>Nature</source>. <year>2014</year>;<volume>513</volume>(<issue>7518</issue>):<fpage>382</fpage>–<lpage>387</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature13438" xlink:type="simple">10.1038/nature13438</ext-link></comment> <object-id pub-id-type="pmid">25043054</object-id></mixed-citation></ref>
<ref id="pbio.2006687.ref046"><label>46</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Li</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Courtois</surname> <given-names>ET</given-names></name>, <name name-style="western"><surname>Sengupta</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Tan</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>KH</given-names></name>, <name name-style="western"><surname>Goh</surname> <given-names>JJL</given-names></name>, <etal>et al</etal>. <article-title>Reference component analysis of single-cell transcriptomes elucidates cellular heterogeneity in human colorectal tumors</article-title>. <source>Nat Genet</source>. <year>2017</year>;<volume>49</volume>(<issue>5</issue>):<fpage>708</fpage>–<lpage>718</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ng.3818" xlink:type="simple">10.1038/ng.3818</ext-link></comment> <object-id pub-id-type="pmid">28319088</object-id></mixed-citation></ref>
<ref id="pbio.2006687.ref047"><label>47</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Caporaso</surname> <given-names>JG</given-names></name>, <name name-style="western"><surname>Kuczynski</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Stombaugh</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Bittinger</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Bushman</surname> <given-names>FD</given-names></name>, <name name-style="western"><surname>Costello</surname> <given-names>EK</given-names></name>, <etal>et al</etal>. <article-title>QIIME allows analysis of high-throughput community sequencing data</article-title>. <source>Nat Methods</source>. <year>2010</year>;<volume>7</volume>(<issue>5</issue>):<fpage>335</fpage>–<lpage>336</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nmeth.f.303" xlink:type="simple">10.1038/nmeth.f.303</ext-link></comment> <object-id pub-id-type="pmid">20383131</object-id></mixed-citation></ref>
<ref id="pbio.2006687.ref048"><label>48</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kiselev</surname> <given-names>VY</given-names></name>, <name name-style="western"><surname>Yiu</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Hemberg</surname> <given-names>M</given-names></name>. <article-title>scmap: projection of single-cell RNA-seq data across data sets</article-title>. <source>Nat Methods</source>. <year>2018</year>;<volume>15</volume>(<issue>5</issue>):<fpage>359</fpage>–<lpage>362</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nmeth.4644" xlink:type="simple">10.1038/nmeth.4644</ext-link></comment> <object-id pub-id-type="pmid">29608555</object-id></mixed-citation></ref>
<ref id="pbio.2006687.ref049"><label>49</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Risso</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Perraudeau</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Gribkova</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Dudoit</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Vert</surname> <given-names>J-P</given-names></name>. <article-title>A general and flexible method for signal extraction from single-cell RNA-seq data</article-title>. <source>Nat Commun</source>. <year>2018</year>;<volume>9</volume>(<issue>1</issue>):<fpage>284</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/s41467-017-02554-5" xlink:type="simple">10.1038/s41467-017-02554-5</ext-link></comment> <object-id pub-id-type="pmid">29348443</object-id></mixed-citation></ref>
<ref id="pbio.2006687.ref050"><label>50</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Azizi</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Prabhakaran</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Carr</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Pe’er</surname> <given-names>D</given-names></name>. <article-title>Bayesian inference for single-cell clustering and imputing</article-title>. <source>Genomics Comput Biol</source>. <year>2017</year>;<volume>3</volume>(<issue>1</issue>):<fpage>46</fpage>.</mixed-citation></ref>
<ref id="pbio.2006687.ref051"><label>51</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sato</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Van Es</surname> <given-names>JH</given-names></name>, <name name-style="western"><surname>Snippert</surname> <given-names>HJ</given-names></name>, <name name-style="western"><surname>Stange</surname> <given-names>DE</given-names></name>, <name name-style="western"><surname>Vries</surname> <given-names>RG</given-names></name>, <name name-style="western"><surname>V Den Born</surname></name>, <etal>et al</etal>. <article-title>Paneth cells constitute the niche for Lgr5 stem cells in intestinal crypts</article-title>. <source>Nature</source>. <year>2011</year>;<volume>469</volume>(<issue>7330</issue>):<fpage>415</fpage>–<lpage>418</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature09637" xlink:type="simple">10.1038/nature09637</ext-link></comment> <object-id pub-id-type="pmid">21113151</object-id></mixed-citation></ref>
<ref id="pbio.2006687.ref052"><label>52</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gu</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Wells</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Dombkowski</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Preffer</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Aronow</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Melton</surname> <given-names>DA</given-names></name>. <article-title>Global expression analysis of gene regulatory pathways during endocrine pancreatic development</article-title>. <source>Development</source>. <year>2004</year>;<volume>131</volume>(<issue>1</issue>):<fpage>165</fpage>–<lpage>179</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1242/dev.00921" xlink:type="simple">10.1242/dev.00921</ext-link></comment> <object-id pub-id-type="pmid">14660441</object-id></mixed-citation></ref>
</ref-list>
</back>
</article>