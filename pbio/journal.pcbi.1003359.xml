<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id><journal-title-group>
<journal-title>PLoS Computational Biology</journal-title></journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-13-00211</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1003359</article-id>
<article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Biology</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Biochemistry simulations</subject></subj-group></subj-group><subj-group><subject>Biophysics</subject><subj-group><subject>Biophysics simulations</subject></subj-group></subj-group><subj-group><subject>Computational biology</subject><subj-group><subject>Biochemical simulations</subject><subject>Biophysic al simulations</subject><subject>Regulatory networks</subject><subject>Synthetic biology</subject><subject>Systems biology</subject></subj-group></subj-group><subj-group><subject>Synthetic biology</subject></subj-group><subj-group><subject>Systems biology</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Computer science</subject><subj-group><subject>Computer modeling</subject></subj-group><subj-group><subject>Computing methods</subject><subj-group><subject>Mathematical computing</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Mathematics</subject><subj-group><subject>Algebra</subject><subj-group><subject>Linear algebra</subject></subj-group></subj-group><subj-group><subject>Applied mathematics</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group><subj-group><subject>Mathematical computing</subject></subj-group><subj-group><subject>Probability theory</subject><subj-group><subject>Markov model</subject><subject>Probability density</subject><subject>Probability distribution</subject><subject>Stochastic processes</subject></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Direct Solution of the Chemical Master Equation Using Quantized Tensor Trains</article-title>
<alt-title alt-title-type="running-head">Solution of the CME Using Quantized Tensor Trains</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Kazeev</surname><given-names>Vladimir</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Khammash</surname><given-names>Mustafa</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Nip</surname><given-names>Michael</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Schwab</surname><given-names>Christoph</given-names></name><xref ref-type="aff" rid="aff4"><sup>4</sup></xref></contrib>
</contrib-group>
<aff id="aff1"><label>1</label><addr-line>Seminar für Angewandte Mathematik, ETH Zürich, Zürich, Switzerland</addr-line></aff>
<aff id="aff2"><label>2</label><addr-line>Department of Biosystems Science and Engineering, ETH Zürich, Basel, Switzerland</addr-line></aff>
<aff id="aff3"><label>3</label><addr-line>Department of Mechanical Engineering, UC Santa Barbara, Santa Barbara, California, United States of America</addr-line></aff>
<aff id="aff4"><label>4</label><addr-line>Seminar für Angewandte Mathematik, ETH Zürich, Zürich, Switzerland</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Beard</surname><given-names>Daniel A.</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group>
<aff id="edit1"><addr-line>University of Michigan, United States of America</addr-line></aff>
<author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">mustafa.khammash@bsse.ethz.ch</email></corresp>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn>
<fn fn-type="con"><p>Conceived and designed the experiments: VK MN. Performed the experiments: VK MN. Analyzed the data: VK MN. Wrote the paper: VK MK MN CS. Conceived the approach: VK MK MN CS. Implemented hp-DG-QTT approach and the transposed QTT format: VK.</p></fn>
</author-notes>
<pub-date pub-type="collection"><month>3</month><year>2014</year></pub-date>
<pub-date pub-type="epub"><day>13</day><month>3</month><year>2014</year></pub-date>
<volume>10</volume>
<issue>3</issue>
<elocation-id>e1003359</elocation-id>
<history>
<date date-type="received"><day>5</day><month>2</month><year>2013</year></date>
<date date-type="accepted"><day>9</day><month>10</month><year>2013</year></date>
</history>
<permissions>
<copyright-year>2014</copyright-year>
<copyright-holder>Kazeev et al</copyright-holder><license xlink:type="simple"><license-p>This is an open-access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions>
<abstract>
<p>The Chemical Master Equation (CME) is a cornerstone of stochastic analysis and simulation of models of biochemical reaction networks. Yet direct solutions of the CME have remained elusive. Although several approaches overcome the infinite dimensional nature of the CME through projections or other means, a common feature of proposed approaches is their susceptibility to the curse of dimensionality, i.e. the exponential growth in memory and computational requirements in the number of problem dimensions. We present a novel approach that has the potential to “lift” this curse of dimensionality. The approach is based on the use of the recently proposed Quantized Tensor Train (QTT) formatted numerical linear algebra for the low parametric, numerical representation of tensors. The QTT decomposition admits both, algorithms for basic tensor arithmetics with complexity scaling linearly in the dimension (number of species) and sub-linearly in the mode size (maximum copy number), and a numerical tensor rounding procedure which is stable and quasi-optimal. We show how the CME can be represented in QTT format, then use the exponentially-converging <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e001" xlink:type="simple"/></inline-formula>-discontinuous Galerkin discretization in time to reduce the CME evolution problem to a set of QTT-structured linear equations to be solved at each time step using an algorithm based on Density Matrix Renormalization Group (DMRG) methods from quantum chemistry. Our method automatically adapts the “basis” of the solution at every time step guaranteeing that it is large enough to capture the dynamics of interest but no larger than necessary, as this would increase the computational complexity. Our approach is demonstrated by applying it to three different examples from systems biology: independent birth-death process, an example of enzymatic futile cycle, and a stochastic switch model. The numerical results on these examples demonstrate that the proposed QTT method achieves dramatic speedups and several orders of magnitude storage savings over direct approaches.</p>
</abstract>
<abstract abstract-type="summary"><title>Author Summary</title>
<p>Stochastic models of chemical networks are necessary to quantitatively describe random fluctuations and other probabilistic phenomena within living cells. The Chemical Master Equation (CME) describes the time evolution of molecular abundance probabilities in these models, and is a basis for many stochastic simulation and analysis methods. Yet the CME is difficult to solve directly except for very simple structures. Indeed current approaches are susceptible to the curse of dimensionality, that is, the exponential growth of memory and computational requirements in the number of problem dimensions. In this paper, we propose a novel approach that has the potential to overcome the curse of dimensionality. It is based on the use of the recently proposed Quantized Tensor Train (QTT) formatted numerical linear algebra for numerical representation of tensors, using algorithms for basic tensor arithmetics with complexity scaling linearly in the number of reacting species considered, and sub-linearly in the maximum allowed copy number per species. We present this approach and demonstrate its effectiveness by applying it to three problems from systems biology. Numerical experiments are reported which show that several orders of magnitude memory savings is typically afforded by the new approach presented here.</p>
</abstract>
<funding-group><funding-statement>The research was partially supported by the European Research Council (ERC) FP7 programme project AdG247277 (erc.europa.eu), and the US National Science Foundation Grant ECCS-0835847 (<ext-link ext-link-type="uri" xlink:href="http://www.nsf.gov" xlink:type="simple">www.nsf.gov</ext-link>) and the Human Frontier Science Program Grant RGP0061/2011 (<ext-link ext-link-type="uri" xlink:href="http://www.hfsp.org" xlink:type="simple">www.hfsp.org</ext-link>). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="19"/></counts></article-meta>
</front>
<body><sec id="s1">
<title/>
<disp-quote>
<p>This is a <italic>PLOS Computational Biology</italic> Methods article.</p>
</disp-quote></sec><sec id="s2">
<title>Introduction</title>
<p>In spite of the success of continuous-variable deterministic models in describing many biological phenomena, discrete stochastic models are often necessary to describe biological phenomena inside living cells where random motion of reacting species introduces randomness in both the order and timing of biochemical reactions. Such random effects become more pronounced when one factors in the discrete nature of reactants and the fact that they are often found in low copy numbers inside the cell. Manifestations of randomness vary from copy-number fluctuations among genetically identical cells <xref ref-type="bibr" rid="pcbi.1003359-Elowitz1">[1]</xref> to dramatically different cell fate decisions <xref ref-type="bibr" rid="pcbi.1003359-McAdams1">[2]</xref> leading to phenotypic differentiation within a clonal population. Characterizing and quantifying the effect of stochasticity and its role in the function of cells is a central problem in molecular systems biology.</p>
<p>In order to effectively capture this experimentally observed stochasticity, the evolution of the chemical species of interest are commonly modeled using jump Markov processes. Here, each state of the process corresponds to the copy number of one of the constituent species <xref ref-type="bibr" rid="pcbi.1003359-Gillespie1">[3]</xref>. Within this framework, the evolution of the probability density over the possible configurations of the reaction network is described by a Forward Kolmogorov Equation, frequently referred to as the Chemical Master Equation (CME) within the chemical literature. While analytical solutions can be obtained under specific assumptions about the structure of the chemical network <xref ref-type="bibr" rid="pcbi.1003359-Jahnke1">[4]</xref>, these assumptions prove so restrictive as to exclude the vast majority of biologically relevant systems. In most cases, the CME cannot be solved explicitly and various numerical simulation techniques have been proposed to approximately solve the time-evolution problem.</p>
<p>A first class of methods seeks to compute approximations of the CME solution instead by solving a truncated version of the original Markov process. These methods are advantageous in that they provide explicit error guarantees after simulation. This class includes the finite state projection <xref ref-type="bibr" rid="pcbi.1003359-Munsky1">[5]</xref> and sliding window abstraction <xref ref-type="bibr" rid="pcbi.1003359-Henzinger1">[6]</xref>. In these methods, the truncation is chosen so that both the number of states retained is small enough that it may be computed efficiently but large enough that it retains the majority of the probability mass over the time evolution. Clearly, these two objectives are not complementary. In order to guarantee that the approximation has low error, most biologically relevant reaction networks require truncations with so many states that they are completely intractable on available hardware. The finite buffer method <xref ref-type="bibr" rid="pcbi.1003359-Cao1">[7]</xref>, <xref ref-type="bibr" rid="pcbi.1003359-Cao2">[8]</xref> suggests a more sophisticated truncation to the states reachable from a given initial state assuming that only a prespecified finite number of molecules may be spontaneously created. However, its use is limited to explicit time-stepping schemes, in addition to requiring that the finite buffers be large to compute accurate solutions.</p>
<p>A second broad class of methods are the kinetic Monte Carlo approaches which instead seek to produce either exact or approximate realizations of the underlying Markov process <xref ref-type="bibr" rid="pcbi.1003359-Gillespie1">[3]</xref>, <xref ref-type="bibr" rid="pcbi.1003359-Gibson1">[9]</xref>, <xref ref-type="bibr" rid="pcbi.1003359-Gillespie2">[10]</xref>. By generating sufficiently many realizations, these methods obtain statistics for events that are biologically important. Unfortunately, in many systems, these important events occur rarely, so that producing enough realizations to estimate these statistics is prohibitive.</p>
<p>A third class of methods use asymptotic approximations to trade accuracy for computational or analytical tractability. This class includes the Moment Closure methods <xref ref-type="bibr" rid="pcbi.1003359-Hespanha1">[11]</xref>, <xref ref-type="bibr" rid="pcbi.1003359-GomezUribe1">[12]</xref>, the Linear Noise Approximation (LNA) <xref ref-type="bibr" rid="pcbi.1003359-vanKampen1">[13]</xref>, and Chemical Langevin Equation (CLE) treatments <xref ref-type="bibr" rid="pcbi.1003359-Gillespie3">[14]</xref>, <xref ref-type="bibr" rid="pcbi.1003359-Ethier1">[15]</xref>. Each of these methods replaces the discrete description of the population counts with a continuous one and can therefore perform poorly in situations where the discrete dynamics are difficult to capture with continuum models, e.g. when even one of the reacting species exhibits low population count or is constrained to have low population count, for instance, in the presence of conservation laws.</p>
<p>Some of the classes of methods described so far perform well in complementary regimes and recently there has been substantial effort to combine these methods resulting in the so-called hybrid methods. Several methods require a time-scale separation of the dynamics to split the system into fast and slow species and impose a quasi-stationary assumption for the fast reactions. An approximate method which can converge quickly to an accurate approximation of a stationary distribution such as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e002" xlink:type="simple"/></inline-formula>-leaping <xref ref-type="bibr" rid="pcbi.1003359-Puchalka1">[16]</xref> or the Chemical Langevin Equation <xref ref-type="bibr" rid="pcbi.1003359-Haseltine1">[17]</xref>, <xref ref-type="bibr" rid="pcbi.1003359-Salis1">[18]</xref> is used for the fast species, while the slower but more accurate Gillespie algorithm is used for the slow species. Rather than partitioning the species by time-scales of the associated reactions, other methods separate by average molecule count. The low count species are tracked by kinetic Monte Carlo while an ODE approximation is made for the dynamics of the high count species <xref ref-type="bibr" rid="pcbi.1003359-Hellander1">[19]</xref>, <xref ref-type="bibr" rid="pcbi.1003359-Jahnke2">[20]</xref>. While these methods allow faster simulations, speedups come at the cost of accuracy, as modeling errors are introduced by the partial replacement of the CME with cruder descriptions.</p>
<p>In order to provide methods that are both accurate and computationally efficient, several numerical techniques for compressing the dynamics and the solution have been explored in the recent literature. Attempts were made to expand the probability distribution as a linear combination of a small set of so-called “principal”, orthogonal basis functions <xref ref-type="bibr" rid="pcbi.1003359-Nip1">[21]</xref>–<xref ref-type="bibr" rid="pcbi.1003359-Jahnke3">[25]</xref>. Then, either a Galerkin projection was used to map the dynamics onto the lower dimensional subspace spanned by the basis functions (Method of Lines) or first a time discretization was used and then the basis at each time step was adapted by either adding or subtracting basis elements (Rothe's Method). These methods differ primarily in their choice of orthogonal basis. A common feature of these approaches is that they begin with a basis for probability distributions of a single variable and then use the corresponding tensor product basis for multivariate distributions. This means that they are susceptible to the so-called <italic>curse of dimensionality</italic> <xref ref-type="bibr" rid="pcbi.1003359-Bellman1">[26]</xref>, that is, the memory requirements and computational complexity of basic arithmetics grow exponentially in the number of dimensions. In the context of the CME, this means that all of these approaches can exhibit an exponential scaling of the complexity with the number of chemical species in the model.</p>
<p>Recent papers have attempted to address the curse of dimensionality by using a low-parametric representation of tensors known as <italic>canonical polyadic</italic> decomposition or <italic>CANDECOMP/PARAFAC</italic>, both notions being subsumed under the acronym <italic>CP</italic> <xref ref-type="bibr" rid="pcbi.1003359-Hitchcock1">[27]</xref>, <xref ref-type="bibr" rid="pcbi.1003359-Caroll1">[28]</xref>. CP is a methodology for generalizing the singular value decomposition (SVD) for matrices to tensors of dimension greater than two by representing the solution as sums of rank-one tensors (equivalently, linear combinations of distributions in which species counts are independent at each fixed time point). As long as the tensor rank of the solution to be approximated remains low, these approaches can be very computationally efficient as basic arithmetics for tensors in the CP format scales linearly in the number of tensor dimensions.</p>
<p>A key challenge in applying the CP decomposition to construct approximate CME solvers is to control the tensor rank of the computed solution. Basic algebraic tensor operations such as addition and matrix-vector multiplication generally increase rank and hence computational cost. In <xref ref-type="bibr" rid="pcbi.1003359-Hegland2">[29]</xref> it is suggested to recompute a lower rank CP decomposition after <italic>every</italic> arithmetic operation. This approach turned out to be problematic in practice. One reason is that the problem of tensor approximation (in the Frobenius norm) with a tensor of fixed rank is, in general, ill-posed <xref ref-type="bibr" rid="pcbi.1003359-deSilva1">[30]</xref>. Thus, the numerical algorithms for computing an approximate representation may easily fail. Another reason is that the problem is NP-hard <xref ref-type="bibr" rid="pcbi.1003359-Hstad1">[31]</xref>, <xref ref-type="bibr" rid="pcbi.1003359-Hillar1">[32]</xref> and there is no robust algorithm having any affordable complexity.</p>
<p>Another approach <xref ref-type="bibr" rid="pcbi.1003359-Jahnke4">[33]</xref>, related to the present work, attempts to avoid the problem of approximation in the CP format entirely by projecting the dynamics onto a manifold composed of all tensors with a CP decomposition of some predetermined maximal tensor rank. This procedure results in a set of coupled nonlinear differential equations which are then solved using available ODE solvers. While this effectively controls the tensor rank of the approximate solution, still, to the authors' knowledge, there is no way to estimate either theoretically (<italic>a priori</italic>) or numerically (<italic>a posteriori</italic>) the CP rank of the full CME solution as a function of given data.</p>
<p>In this paper we propose a new, deterministic computational methodology for the direct numerical solution of the CME, without modelling or asymptotic simplifications. The approach has complexity that scales favorably in terms of the number of different species considered and the maximum allowable copy number of each of these species. It is based on the recently proposed <italic>Quantized Tensor Train</italic> (QTT) formatted, numerical tensor algebra <xref ref-type="bibr" rid="pcbi.1003359-Oseledets1">[34]</xref>–<xref ref-type="bibr" rid="pcbi.1003359-Khoromskij1">[37]</xref> which operates on low-parametric, numerical representation of tensors, rather than on their CP representations. This decomposition admits both algorithms for basic tensor arithmetics that scale linearly in the dimension (the species number) and a robust adaptive numerical procedure for the tensor truncation, which is quasi-optimal in the Frobenius norm.</p>
<p>We show in the present paper how the CME can be represented in QTT format, then use <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e003" xlink:type="simple"/></inline-formula>-discontinuous Galerkin discretization in time to exploit the time-analyticity of the CME evolution and to reduce the CME evolution problem to a set of QTT structured linear equations that are solved at each time step <xref ref-type="bibr" rid="pcbi.1003359-Kazeev1">[38]</xref>. We then exploit an algorithm available for solving linear systems in this format that is based on Density Matrix Renormalization Group (DMRG) methods from quantum chemistry.</p>
<p>The numerical experiments reported below (see, in particular, <xref ref-type="table" rid="pcbi-1003359-t001">Table 1</xref>) show several orders of magnitude memory savings, which is typically afforded by the new approach presented here.</p>
<table-wrap id="pcbi-1003359-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003359.t001</object-id><label>Table 1</label><caption>
<title>Overview of the QTT compression of the storage needed for solutions (maximum throughout the time stepping) and CME operators.</title>
</caption><alternatives><graphic id="pcbi-1003359-t001-1" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003359.t001" xlink:type="simple"/>
<table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td colspan="2" align="left" rowspan="1">Direct Approach</td>
<td colspan="6" align="left" rowspan="1">Proposed Approach</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">run</td>
<td align="left" rowspan="1" colspan="1">solution</td>
<td align="left" rowspan="1" colspan="1">operator</td>
<td colspan="2" align="left" rowspan="1">solution</td>
<td colspan="2" align="left" rowspan="1">truncated solution</td>
<td colspan="2" align="left" rowspan="1">operator</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">Mem</td>
<td align="left" rowspan="1" colspan="1">Mem</td>
<td align="left" rowspan="1" colspan="1">Mem</td>
<td align="left" rowspan="1" colspan="1">ratio</td>
<td align="left" rowspan="1" colspan="1">Mem</td>
<td align="left" rowspan="1" colspan="1">ratio</td>
<td align="left" rowspan="1" colspan="1">Mem</td>
<td align="left" rowspan="1" colspan="1">ratio</td>
</tr>
</thead>
<tbody>
<tr>
<td colspan="9" align="left" rowspan="1"><italic>d</italic> independent birth-death processes</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>d</italic> = 1</td>
<td align="left" rowspan="1" colspan="1">4.10<bold><sub>3</sub></bold></td>
<td align="left" rowspan="1" colspan="1">1.68<bold><sub>7</sub></bold></td>
<td align="left" rowspan="1" colspan="1">736</td>
<td align="left" rowspan="1" colspan="1">1.80<sub>−<bold>1</bold></sub></td>
<td align="left" rowspan="1" colspan="1">264</td>
<td align="left" rowspan="1" colspan="1">6.45<sub>−<bold>2</bold></sub></td>
<td align="left" rowspan="1" colspan="1">992</td>
<td align="left" rowspan="1" colspan="1">5.91<sub>−<bold>5</bold></sub></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>d</italic> = 2</td>
<td align="left" rowspan="1" colspan="1">1.68<bold><sub>7</sub></bold></td>
<td align="left" rowspan="1" colspan="1">2.82<bold><sub>14</sub></bold></td>
<td align="left" rowspan="1" colspan="1">3858</td>
<td align="left" rowspan="1" colspan="1">2.30<sub>−<bold>4</bold></sub></td>
<td align="left" rowspan="1" colspan="1">528</td>
<td align="left" rowspan="1" colspan="1">3.15<sub>−<bold>5</bold></sub></td>
<td align="left" rowspan="1" colspan="1">2852</td>
<td align="left" rowspan="1" colspan="1">1.01<sub>−<bold>11</bold></sub></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>d</italic> = 3</td>
<td align="left" rowspan="1" colspan="1">6.87<bold><sub>10</sub></bold></td>
<td align="left" rowspan="1" colspan="1">4.72<bold><sub>21</sub></bold></td>
<td align="left" rowspan="1" colspan="1">7742</td>
<td align="left" rowspan="1" colspan="1">1.13<sub>−<bold>7</bold></sub></td>
<td align="left" rowspan="1" colspan="1">898</td>
<td align="left" rowspan="1" colspan="1">1.31<sub>−<bold>8</bold></sub></td>
<td align="left" rowspan="1" colspan="1">4800</td>
<td align="left" rowspan="1" colspan="1">1.02<sub>−<bold>18</bold></sub></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>d</italic> = 4</td>
<td align="left" rowspan="1" colspan="1">2.81<bold><sub>14</sub></bold></td>
<td align="left" rowspan="1" colspan="1">7.90<bold><sub>28</sub></bold></td>
<td align="left" rowspan="1" colspan="1">12176</td>
<td align="left" rowspan="1" colspan="1">4.33<sub>−<bold>11</bold></sub></td>
<td align="left" rowspan="1" colspan="1">1432</td>
<td align="left" rowspan="1" colspan="1">5.09<sub>−<bold>12</bold></sub></td>
<td align="left" rowspan="1" colspan="1">6748</td>
<td align="left" rowspan="1" colspan="1">8.52<sub>−<bold>26</bold></sub></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>d</italic> = 5</td>
<td align="left" rowspan="1" colspan="1">1.15<bold><sub>18</sub></bold></td>
<td align="left" rowspan="1" colspan="1">1.32<bold><sub>36</sub></bold></td>
<td align="left" rowspan="1" colspan="1">16262</td>
<td align="left" rowspan="1" colspan="1">1.41<sub>−<bold>14</bold></sub></td>
<td align="left" rowspan="1" colspan="1">1946</td>
<td align="left" rowspan="1" colspan="1">1.69<sub>−<bold>15</bold></sub></td>
<td align="left" rowspan="1" colspan="1">11032</td>
<td align="left" rowspan="1" colspan="1">8.30<sub>−<bold>33</bold></sub></td>
</tr>
<tr>
<td colspan="9" align="left" rowspan="1">genetic toggle switch</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">only</td>
<td align="left" rowspan="1" colspan="1">3.36<bold><sub>7</sub></bold></td>
<td align="left" rowspan="1" colspan="1">1.12<bold><sub>15</sub></bold></td>
<td align="left" rowspan="1" colspan="1">65264</td>
<td align="left" rowspan="1" colspan="1">1.95<sub>−<bold>3</bold></sub></td>
<td align="left" rowspan="1" colspan="1">–</td>
<td align="left" rowspan="1" colspan="1">–</td>
<td align="left" rowspan="1" colspan="1">10988</td>
<td align="left" rowspan="1" colspan="1">9.76<sub>−<bold>12</bold></sub></td>
</tr>
<tr>
<td colspan="9" align="left" rowspan="1">enzymatic futile cycle</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">(A)</td>
<td align="left" rowspan="1" colspan="1">4.19<bold><sub>6</sub></bold></td>
<td align="left" rowspan="1" colspan="1">1.76<bold><sub>13</sub></bold></td>
<td align="left" rowspan="1" colspan="1">18396</td>
<td align="left" rowspan="1" colspan="1">4.39<sub>−<bold>3</bold></sub></td>
<td align="left" rowspan="1" colspan="1">8472</td>
<td align="left" rowspan="1" colspan="1">2.02<sub>−<bold>3</bold></sub></td>
<td align="left" rowspan="1" colspan="1">25848</td>
<td align="left" rowspan="1" colspan="1">1.47<sub>−<bold>9</bold></sub></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">(D)</td>
<td align="left" rowspan="1" colspan="1">4.19<bold><sub>6</sub></bold></td>
<td align="left" rowspan="1" colspan="1">1.76<bold><sub>13</sub></bold></td>
<td align="left" rowspan="1" colspan="1">360332</td>
<td align="left" rowspan="1" colspan="1">8.59<sub>−<bold>2</bold></sub></td>
<td align="left" rowspan="1" colspan="1">290144</td>
<td align="left" rowspan="1" colspan="1">6.92<sub>−<bold>2</bold></sub></td>
<td align="left" rowspan="1" colspan="1">5584</td>
<td align="left" rowspan="1" colspan="1">3.17<sub>−<bold>10</bold></sub></td>
</tr>
</tbody>
</table>
</alternatives><table-wrap-foot><fn id="nt101"><label/><p>For details on “truncated solution” see <bold>Numerical experiments. Common details</bold>. Solution <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e004" xlink:type="simple"/></inline-formula> in the Direct Approach is the number of states taken into account in the FSP, which is equal to the number of entries, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e005" xlink:type="simple"/></inline-formula>, in the solution vector. For the CME operator, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e006" xlink:type="simple"/></inline-formula> is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e007" xlink:type="simple"/></inline-formula>, the number of entries in the matrix. In the Proposed QTT Approach, <italic>ratio</italic> indicates the memory storage compression ratio, i.e. the ratio of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e008" xlink:type="simple"/></inline-formula> in the Proposed QTT Approach to that in the Direct Approach. In the sparse representation of the CME operator the number of nonzero entries would be <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e009" xlink:type="simple"/></inline-formula> rather than <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e010" xlink:type="simple"/></inline-formula>. The exponents are given in boldface for the base <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e011" xlink:type="simple"/></inline-formula>.</p></fn></table-wrap-foot></table-wrap></sec><sec id="s3">
<title>Results/Discussion</title>
<p>We start our development by formulating the Chemical Master Equation (CME), arising from stochastically reacting chemical species. Then we will devote the remainder of the article for its proposed solution. A “well-stirred” solution of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e012" xlink:type="simple"/></inline-formula> chemically reacting molecules in thermal equilibrium can be described by a jump Markov process, where for each fixed time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e013" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e014" xlink:type="simple"/></inline-formula> is a random vector of nonnegative integers with each component representing the number of molecules of one chemical species present in the system. In <xref ref-type="bibr" rid="pcbi.1003359-Hegland2">[29]</xref> and the references therein, it is shown that, given an initial condition <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e015" xlink:type="simple"/></inline-formula>, the corresponding probability density function (PDF) <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e016" xlink:type="simple"/></inline-formula> of the process solves the Chemical Master Equation (CME):<disp-formula id="pcbi.1003359.e017"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003359.e017" xlink:type="simple"/><label>(1)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e018" xlink:type="simple"/></inline-formula> is the number of reactions in the system, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e019" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e020" xlink:type="simple"/></inline-formula> are the stoichiometric vector and propensity function of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e021" xlink:type="simple"/></inline-formula>th reaction, respectively. The CME is a system of coupled linear ordinary differential equations with one equation per state <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e022" xlink:type="simple"/></inline-formula>.</p>
<sec id="s3a">
<title>Our Approach to Solving the CME</title>
<p>We briefly outline our proposed methodology for the numerical solution of the CME. Since the state space of solutions is countably infinite, the main challenge to be overcome is the curse of dimensionality. As the state space of the CME is typically countably infinite, there is a countably infinite number of different possible states that could be reached by the chemical system. Our approach consists of employing efficient methods for tensor-structured, rank-adaptive numerical solution of very large but “finite state projection” truncations of the CME. In a nutshell, we are proposing to solve large, coupled systems of linear ODEs with a special, tensor structure inherited from the CME. We now give a general outline of our approach, followed by detailed descriptions of each of these steps.</p>
<sec id="s3a1">
<title>1. Truncate the CME to obtain a linear ODE with a finite state space</title>
<p>The CME describes the dynamics of probabilities of finding the chemical system in different states. In general the number of these different states is countably infinite, as it is not unknown <italic>a priori</italic> the maximum number of copies that each species can take. While this gives rise to an infinite number of state variables, each indicating the probability of a given chemical state, the vast majority of these probabilities are vanishingly small. This has motivated approaches for truncating the infinite number of state variables in the CME in a way that results in a finite number of state variables corresponding to chemical states that are likely to have high probability mass. The truncated CME consists of a system of linear ODEs with finite state space, that can <italic>in principle</italic> be solved. One such truncation approach which we will follow here is the Finite State Projection method. This truncation approach has the advantage of yielding bounds on the error between the solution of the truncated finite system and the original infinite set of ODEs (the CME). The Finite State Projection has been reported elsewhere <xref ref-type="bibr" rid="pcbi.1003359-Munsky1">[5]</xref>, but we give a brief description of the approach in this article for completeness.</p>
</sec><sec id="s3a2">
<title>2. Express the truncated CME using tensors; Employ numerical rank reduction and compression to save storage and to speed up algebraic operations</title>
<p>In conventional approaches to solving the CME, the state-space is enumerated by a “long” index and the corresponding probabilities are stacked into a vector <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e023" xlink:type="simple"/></inline-formula> that is then multiplied by the CME operator to form the right-hand side of the ODE: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e024" xlink:type="simple"/></inline-formula>. At all times <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e025" xlink:type="simple"/></inline-formula> the solution is an array indexed by a multi-index, e.g., <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e026" xlink:type="simple"/></inline-formula>, which is a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e027" xlink:type="simple"/></inline-formula>-tuple of indices <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e028" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e029" xlink:type="simple"/></inline-formula> ranges from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e030" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e031" xlink:type="simple"/></inline-formula>. We shall also refer to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e032" xlink:type="simple"/></inline-formula> as a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e033" xlink:type="simple"/></inline-formula>-dimensional <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e034" xlink:type="simple"/></inline-formula>-vector. Our approach is based on exploiting the high-dimensional structure of the vectors and matrices involved, related to the separation of the indices, instead of stacking all indices into a single “long” index.</p>
<p>Linear operators acting on these <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e035" xlink:type="simple"/></inline-formula>-dimensional <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e036" xlink:type="simple"/></inline-formula>-vectors can themselves be expressed using tensor notation. In our case, the action of the CME operator <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e037" xlink:type="simple"/></inline-formula> is one such operator. A key aspect of our approach is that both the tensor vector <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e038" xlink:type="simple"/></inline-formula> and the tensor operator <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e039" xlink:type="simple"/></inline-formula> arising from CME problems admit a dramatic level of compression. This tensor compression is achieved through the so called tensor train representation (TT). Tensor train compression goes beyond exploiting the sparsity structure, and actually exploits the rank structure of the tensor. This reduced rank compression is at the heart of our approach to the CME solution. The compression itself is analogous to the compression of the low-rank representation of usual matrices. Indeed, an <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e040" xlink:type="simple"/></inline-formula> matrix of rank <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e041" xlink:type="simple"/></inline-formula> can be stored using <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e042" xlink:type="simple"/></inline-formula> variables, while the approximation can be based, e.g., on the Singular Value Decomposition (SVD). In a similar fashion, the TT format is a generalization of this compression to multidimensional tensors. This is both true for tensors and linear operators acting on these. Further <italic>adaptive data reduction and compression</italic> is afforded by the so-called quantized tensor train (QTT) format. Both the TT and QTT formats will be discussed later in this article, along with simple examples demonstrating the compression that can be achieved by using these formats.</p>
</sec><sec id="s3a3">
<title>3. Employ <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e043" xlink:type="simple"/></inline-formula>-discontinuous Galerkin discretization in time to solve the truncated ODE</title>
<p>Once the problem has been represented in QTT format, we use <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e044" xlink:type="simple"/></inline-formula>-discontinous Galerkin (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e045" xlink:type="simple"/></inline-formula>-DG) discretization in time as the time-stepping scheme <xref ref-type="bibr" rid="pcbi.1003359-Kazeev1">[38]</xref> to solve the truncated ODE. Given a time mesh, the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e046" xlink:type="simple"/></inline-formula>-DG method finds an approximate solution to the initial value problem that is a polynomial when restricted to each subinterval of the time mesh and possibly discontinuous at each mesh point. This method allows adaptation of the size of each time step (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e047" xlink:type="simple"/></inline-formula>-adaptation), allowing good resolution of fast transients, as well as the order of the approximating polynomial on each time step (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e048" xlink:type="simple"/></inline-formula>-adaptation), or both simultaneously (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e049" xlink:type="simple"/></inline-formula>-adaptation). For linear ODE initial value problems like the projected CME, the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e050" xlink:type="simple"/></inline-formula>-DG approach achieves <italic>exponential rates of convergence</italic> to the classical solution with respect to the number of temporal degrees of freedom. Practically, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e051" xlink:type="simple"/></inline-formula>-DG discretization in time reduces the projected CME evolution problem to a sequence of systems of QTT structured linear equations that must be solved at each time step. Our computational method then exploits an algorithm available for solving linear systems in this format that is based on Density Matrix Renormalization Group (DMRG) methods from quantum chemistry.</p>
</sec></sec><sec id="s3b">
<title>CME Truncation: Separability and Finite State Projection of the CME Operator</title>
<p>Munsky and Khammash <xref ref-type="bibr" rid="pcbi.1003359-Munsky1">[5]</xref> rewrote the right-hand side of the CME (1) as the action of a linear operator <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e052" xlink:type="simple"/></inline-formula> on the probability density at the current time:<disp-formula id="pcbi.1003359.e053"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003359.e053" xlink:type="simple"/><label>(2)</label></disp-formula>Throughout this paper, we refer to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e054" xlink:type="simple"/></inline-formula> as the <italic>CME operator</italic>.</p>
<p>Hegland and Garcke introduced an explicit representation of the CME operator as sums and compositions of a few elementary linear operators <xref ref-type="bibr" rid="pcbi.1003359-Hegland2">[29]</xref>: let <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e055" xlink:type="simple"/></inline-formula> be the spatial shift of a probability density by a vector <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e056" xlink:type="simple"/></inline-formula> and let <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e057" xlink:type="simple"/></inline-formula> be multiplication by a real-valued function <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e058" xlink:type="simple"/></inline-formula>:<disp-formula id="pcbi.1003359.e059"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003359.e059" xlink:type="simple"/></disp-formula>Then the CME operator can be written as follows, with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e060" xlink:type="simple"/></inline-formula> denoting the identity operator:<disp-formula id="pcbi.1003359.e061"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003359.e061" xlink:type="simple"/><label>(3)</label></disp-formula>To simplify the exposition, we assume that all propensity functions are <italic>rank-one separable</italic>, i.e. they are of the form<disp-formula id="pcbi.1003359.e062"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003359.e062" xlink:type="simple"/><label>(4)</label></disp-formula>for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e063" xlink:type="simple"/></inline-formula>, where each <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e064" xlink:type="simple"/></inline-formula> is a nonnegative function in the single variable <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e065" xlink:type="simple"/></inline-formula>. Considering rank-one separable propensity functions is sufficient for all elementary reactions which occur as building blocks in more complicated reaction kinetics.</p>
<p>The CME (2) is posed on the (countably) infinite space <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e066" xlink:type="simple"/></inline-formula> of states. In this form, the CME (1) is an infinite-dimensional coupled evolution problem which necessitates truncation prior to numerical discretization. In the case of a particular class of monomolecular reactions, Jahnke and Huisinga were able to construct an explicit solution in terms of convolutions of products of Poisson and multinomial distributions <xref ref-type="bibr" rid="pcbi.1003359-Jahnke1">[4]</xref>.</p>
<p>In order to be able to address more complex systems computationally, Munsky and Khammash proposed the Finite State Projection Algorithm (FSP) <xref ref-type="bibr" rid="pcbi.1003359-Munsky1">[5]</xref> which seeks to truncate the countably infinite dimensional space <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e067" xlink:type="simple"/></inline-formula> of states of the process to its finite subset<disp-formula id="pcbi.1003359.e068"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003359.e068" xlink:type="simple"/><label>(5)</label></disp-formula>associated with a multi-index <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e069" xlink:type="simple"/></inline-formula>, so that the dynamics over <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e070" xlink:type="simple"/></inline-formula> are close to those of the original system; see Theorem 1. In practice, the truncation satisfying a given error tolerance may still require a very large number of states: the dimension of the FSP vector <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e071" xlink:type="simple"/></inline-formula> equals <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e072" xlink:type="simple"/></inline-formula> rendering a direct numerical solution of even the projected equation (S1.1) infeasible in many cases. The remainder of the paper presents a novel approach for the numerical solution of such FSP truncated systems that retain large numbers of states. For notational convenience, we drop the superscripts <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e073" xlink:type="simple"/></inline-formula> and the hat from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e074" xlink:type="simple"/></inline-formula> indicating the FSP since we will only consider systems which have already been truncated. Similarly, we now use the shift and multiplication operators in (3) restricted to the truncated state space without change of notation.</p>
<p>Assuming that a FSP has been performed, we henceforth treat <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e075" xlink:type="simple"/></inline-formula> as a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e076" xlink:type="simple"/></inline-formula>-dimensional <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e077" xlink:type="simple"/></inline-formula>-vector, i.e. as an array indexed by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e078" xlink:type="simple"/></inline-formula> which we identify with <italic>ordered</italic> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e079" xlink:type="simple"/></inline-formula>-tuples of indices <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e080" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e081" xlink:type="simple"/></inline-formula> ranges from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e082" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e083" xlink:type="simple"/></inline-formula>. Each dimension <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e084" xlink:type="simple"/></inline-formula> (alternatively referred to as a <italic>mode</italic> or <italic>level</italic>) has a corresponding <italic>mode size</italic> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e085" xlink:type="simple"/></inline-formula>, that is, the number of values which the index for that dimension can take. For our chemically reacting system, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e086" xlink:type="simple"/></inline-formula> corresponds to the maximum number of copies of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e087" xlink:type="simple"/></inline-formula>th species that is considered. For a more detailed introduction to basic tensor operations and terminology see, for example, <xref ref-type="bibr" rid="pcbi.1003359-Kolda1">[39]</xref>, <xref ref-type="bibr" rid="pcbi.1003359-Hackbusch1">[40]</xref>.</p>
<p>For the same ordering of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e088" xlink:type="simple"/></inline-formula>, consider the corresponding <italic>d</italic>-dimensional <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e089" xlink:type="simple"/></inline-formula>-vectors <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e090" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e091" xlink:type="simple"/></inline-formula>, containing the values of the propensities on <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e092" xlink:type="simple"/></inline-formula> to which we shall refer as <italic>propensity vectors</italic>:<disp-formula id="pcbi.1003359.e093"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003359.e093" xlink:type="simple"/><label>(6)</label></disp-formula>Within the projected CME (S1.1), the operators corresponding to weighting by the propensity functions, involved in (3), are finite matrices: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e094" xlink:type="simple"/></inline-formula>. Then, under the rank one separability assumption (4), with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e095" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e096" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e097" xlink:type="simple"/></inline-formula> there holds<disp-formula id="pcbi.1003359.e098"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003359.e098" xlink:type="simple"/><label>(7)</label></disp-formula></p>
</sec><sec id="s3c">
<title>Tensor Representation of the CME: TT and QTT Formats</title>
<sec id="s3c1">
<title>Tensor Train representation of vectors and matrices</title>
<p>Our approach to the direct numerical solution of the CME (2) is based on the structured, low-parametric representation of all vectors and matrices involved in the solution in the <italic>Tensor Train</italic> (TT) format <xref ref-type="bibr" rid="pcbi.1003359-Oseledets1">[34]</xref>, <xref ref-type="bibr" rid="pcbi.1003359-Oseledets4">[41]</xref> developed by Oseledets and Tyrtyshnikov. To present it, let us consider a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e099" xlink:type="simple"/></inline-formula>-dimensional <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e100" xlink:type="simple"/></inline-formula>-vector <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e101" xlink:type="simple"/></inline-formula> and assume that two- and three-dimensional arrays <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e102" xlink:type="simple"/></inline-formula> satisfy<disp-formula id="pcbi.1003359.e103"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003359.e103" xlink:type="simple"/><label>(8)</label></disp-formula>for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e104" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e105" xlink:type="simple"/></inline-formula>. Then <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e106" xlink:type="simple"/></inline-formula> is said to be represented in the TT decomposition in terms of the <italic>core tensors</italic> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e107" xlink:type="simple"/></inline-formula>. The summation indices <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e108" xlink:type="simple"/></inline-formula> and limits <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e109" xlink:type="simple"/></inline-formula> on the right-hand side of (8) are called, respectively, <italic>rank indices</italic> and <italic>ranks</italic> of the decomposition. See <xref ref-type="fig" rid="pcbi-1003359-g001">Figure 1</xref> for a schematic drawing.</p>
<fig id="pcbi-1003359-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003359.g001</object-id><label>Figure 1</label><caption>
<title>Schematic drawing of a TT decomposition of a five-dimensional array.</title>
<p>Each TT core can be visualized as a stack of matrices with the size of the stack equal to the corresponding mode size. The number of TT cores is equal to the number of dimensions of the array. Element <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e110" xlink:type="simple"/></inline-formula> of the full array is given by the (matrix) product of matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e111" xlink:type="simple"/></inline-formula> selected from core <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e112" xlink:type="simple"/></inline-formula>, matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e113" xlink:type="simple"/></inline-formula> from core <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e114" xlink:type="simple"/></inline-formula>, etc. Note that the size of each matrix within a core must be the same, but may differ between distinct cores. Note also that the number of matrices in each core depends on the corresponding mode size of the full tensor and generally differs between cores. Such an interpretation in the sense of a product of parametric matrices is widely used for the <italic>Matrix Product States</italic>, see <xref ref-type="bibr" rid="pcbi.1003359-White1">[46]</xref>–<xref ref-type="bibr" rid="pcbi.1003359-Vidal1">[48]</xref>.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003359.g001" position="float" xlink:type="simple"/></fig>
<p>The TT decomposition can potentially result in large compression of the tensor by exploiting the rank structure of the tensor. This is demonstrated in a simple example</p>
<p><bold>Example 1 (TT Compression)</bold> <italic>Consider a vector </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e115" xlink:type="simple"/></inline-formula><italic> of size </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e116" xlink:type="simple"/></inline-formula><italic> given elementwise by</italic><disp-formula id="pcbi.1003359.e117"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003359.e117" xlink:type="simple"/></disp-formula><italic>where </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e118" xlink:type="simple"/></inline-formula><italic>. By applying trigonometric identities, one obtains for all </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e119" xlink:type="simple"/></inline-formula><italic> the following row-matrix-column factorization:</italic><disp-formula id="pcbi.1003359.e120"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003359.e120" xlink:type="simple"/></disp-formula><italic>in which the indices are separated so that every factor depends on the corresponding index only. This factorization implies a TT representation of the form (8) with ranks </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e121" xlink:type="simple"/></inline-formula><italic> and the cores given for </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e122" xlink:type="simple"/></inline-formula><italic> by</italic><disp-formula id="pcbi.1003359.e123"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003359.e123" xlink:type="simple"/></disp-formula><italic>This TT decomposition involves </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e124" xlink:type="simple"/></inline-formula><italic> parameters instead of </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e125" xlink:type="simple"/></inline-formula><italic> required for the elementwise representation. The case of </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e126" xlink:type="simple"/></inline-formula><italic> dimensions is considered in </italic><xref ref-type="bibr" rid="pcbi.1003359-Oseledets5">[<italic>42, Theorem 4</italic>]</xref><italic>, the number of parameters being under </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e127" xlink:type="simple"/></inline-formula><italic> compared to </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e128" xlink:type="simple"/></inline-formula>.</p>
<p>Unlike CP, the TT format allows the construction of a decomposition, exact or <italic>approximate</italic>, through the low-rank representation of a sequence of single matrices; for example, by SVD. In particular, note that for every <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e129" xlink:type="simple"/></inline-formula> the decomposition (8) implies a rank-<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e130" xlink:type="simple"/></inline-formula> representation of an <italic>unfolding matrix</italic> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e131" xlink:type="simple"/></inline-formula> which consists of the entries<disp-formula id="pcbi.1003359.e132"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003359.e132" xlink:type="simple"/></disp-formula>Here, the overscore denotes the vectorization of multi-indices: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e133" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e134" xlink:type="simple"/></inline-formula>. Conversely, if the vector <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e135" xlink:type="simple"/></inline-formula> is such that the unfolding matrices <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e136" xlink:type="simple"/></inline-formula> are of ranks <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e137" xlink:type="simple"/></inline-formula> respectively, then the cores <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e138" xlink:type="simple"/></inline-formula>, such that (8) holds, do exist; see Theorem 2.1 in <xref ref-type="bibr" rid="pcbi.1003359-Oseledets4">[41]</xref>. The ranks of the unfolding matrices are the lowest possible ranks of a TT decomposition of the vector and, therefore, are called <italic>TT ranks of the vector</italic>.</p>
<p>What is more important is that the low-rank matrix structure of the unfolding matrices translates into the low-rank TT structure of the vector. Once the former can be approximated in the Frobenius norm with ranks <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e139" xlink:type="simple"/></inline-formula> and accuracies <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e140" xlink:type="simple"/></inline-formula>, the latter can be approximated in the same norm in the TT format with ranks <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e141" xlink:type="simple"/></inline-formula> and accuracy <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e142" xlink:type="simple"/></inline-formula>. The proof relies on the TT approximation algorithm. For details, we refer to Theorem 2.2 with the corollaries and to Algorithms 1 and 2 in <xref ref-type="bibr" rid="pcbi.1003359-Oseledets4">[41]</xref>. This low rank approximation of the unfolding matrices can be considered and is implemented as adaptive and compressive data representation at each stage of computation.</p>
<boxed-text id="pcbi-1003359-box001" position="float"><sec id="s4a">
<title/>
<p><bold>Algorithm 1.</bold> Assemble Projected CME Operator in QTT Matrix Format.</p>
<p><bold>Require:</bold> Rank-1 separable propensity functions <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e634" xlink:type="simple"/></inline-formula>, stoichiometric vectors <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e635" xlink:type="simple"/></inline-formula>, rectangular FSP truncation <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e636" xlink:type="simple"/></inline-formula>, propensity QTT compression tolerance <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e637" xlink:type="simple"/></inline-formula>, a QTT approximation subroutine <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e638" xlink:type="simple"/></inline-formula> implementing <xref ref-type="bibr" rid="pcbi.1003359-Jahnke1">[4, Algorithm 1]</xref> for quantized vectors.</p>
<p><bold>Ensure:</bold> Projected CME operator <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e639" xlink:type="simple"/></inline-formula> in QTT matrix format</p>
<list list-type="simple">
<list-item>
  <p>Initialize <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e640" xlink:type="simple"/></inline-formula>;</p>
</list-item><list-item>
  <p><bold>for</bold> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e641" xlink:type="simple"/></inline-formula> <bold>do</bold></p>
</list-item><list-item>
  <p>  <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e642" xlink:type="simple"/></inline-formula></p>
</list-item><list-item>
  <p>  <bold>for</bold> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e643" xlink:type="simple"/></inline-formula> <bold>do</bold></p>
</list-item><list-item>
  <p>   <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e644" xlink:type="simple"/></inline-formula> with tolerance <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e645" xlink:type="simple"/></inline-formula>;</p>
</list-item><list-item>
  <p>  <bold>end for</bold></p>
</list-item><list-item>
  <p>  <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e646" xlink:type="simple"/></inline-formula></p>
</list-item><list-item>
  <p>  </p>
</list-item><list-item>
  <p><bold>end for</bold></p>
</list-item>
</list>
</sec></boxed-text><boxed-text id="pcbi-1003359-box002" position="float"><sec id="s5a">
<title/>
<p><bold>Algorithm 2.</bold> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e647" xlink:type="simple"/></inline-formula>-DG-QTT CME Solver.</p>
<p><bold>Require:</bold> Projected CME operator <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e648" xlink:type="simple"/></inline-formula> in QTT format, time mesh <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e649" xlink:type="simple"/></inline-formula>, polynomial orders <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e650" xlink:type="simple"/></inline-formula>, basis of temporal shape functions <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e651" xlink:type="simple"/></inline-formula>, DMRG-solver tolerance <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e652" xlink:type="simple"/></inline-formula></p>
<p><bold>Ensure:</bold> Approximate solution <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e653" xlink:type="simple"/></inline-formula> of the evolution <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e654" xlink:type="simple"/></inline-formula></p>
<list list-type="simple">
<list-item>
  <p><bold>for</bold> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e655" xlink:type="simple"/></inline-formula> <bold>do</bold></p>
</list-item><list-item>
  <p>  <bold>for</bold> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e656" xlink:type="simple"/></inline-formula> <bold>do</bold></p>
</list-item><list-item>
  <p>   <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e657" xlink:type="simple"/></inline-formula></p>
</list-item><list-item>
  <p>   <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e658" xlink:type="simple"/></inline-formula></p>
</list-item><list-item>
  <p>  <bold>end for</bold></p>
</list-item><list-item>
  <p>  Solve <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e659" xlink:type="simple"/></inline-formula>, for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e660" xlink:type="simple"/></inline-formula></p>
</list-item><list-item>
  <p>  using DMRG-solver with tolerance <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e661" xlink:type="simple"/></inline-formula>;</p>
</list-item><list-item>
  <p>  <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e662" xlink:type="simple"/></inline-formula></p>
</list-item><list-item>
  <p><bold>end for</bold></p>
</list-item>
</list>
</sec></boxed-text>
<p><bold>Example 2 (Unfolding of a tensor)</bold> <italic>Consider a tensor </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e143" xlink:type="simple"/></inline-formula><italic> of size </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e144" xlink:type="simple"/></inline-formula><italic>. It has two unfolding matrices </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e145" xlink:type="simple"/></inline-formula><italic> and </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e146" xlink:type="simple"/></inline-formula><italic> given by</italic><disp-formula id="pcbi.1003359.e147"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003359.e147" xlink:type="simple"/></disp-formula><italic>While </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e148" xlink:type="simple"/></inline-formula><italic>, </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e149" xlink:type="simple"/></inline-formula><italic>, and </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e150" xlink:type="simple"/></inline-formula><italic> are structured differently, all have the same entries and represent the same data. The two TT ranks of </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e151" xlink:type="simple"/></inline-formula><italic> are exactly the (matrix) ranks of </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e152" xlink:type="simple"/></inline-formula><italic> and </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e153" xlink:type="simple"/></inline-formula>.</p>
<p>Note also that, unlike CP, the TT representation relies on a certain ordering of the dimensions so that <italic>reordering dimensions may affect the numerical values of TT ranks significantly</italic>. We discuss this issue in more detail in the transposed QTT section.</p>
<p>The TT representation may be applied to multidimensional matrices in a similar way as to vectors. Consider a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e154" xlink:type="simple"/></inline-formula>-dimensional <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e155" xlink:type="simple"/></inline-formula>-matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e156" xlink:type="simple"/></inline-formula>. Let us vectorize it and merge the corresponding row and column indices to obtain a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e157" xlink:type="simple"/></inline-formula>-dimensional <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e158" xlink:type="simple"/></inline-formula>-vector <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e159" xlink:type="simple"/></inline-formula>. Then the TT representation of the vector <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e160" xlink:type="simple"/></inline-formula>, given by the elementwise equality<disp-formula id="pcbi.1003359.e161"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003359.e161" xlink:type="simple"/><label>(9)</label></disp-formula>is called a TT representation of the matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e162" xlink:type="simple"/></inline-formula>, the cores <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e163" xlink:type="simple"/></inline-formula> are now three- and four-dimensional arrays. Our discussion of the efficiency and robustness of the TT decomposition of vectors also applies to the matrix case.</p>
<p>Note that the <italic>Hierarchical Tensor Representation</italic> <xref ref-type="bibr" rid="pcbi.1003359-Hackbusch2">[43]</xref>, <xref ref-type="bibr" rid="pcbi.1003359-Grasedyck1">[44]</xref> itself and coupled with the <italic>tensorization</italic> <xref ref-type="bibr" rid="pcbi.1003359-Grasedyck2">[45]</xref>, an extensive overview of which is available in <xref ref-type="bibr" rid="pcbi.1003359-Hackbusch1">[40]</xref>, are closely related counterparts of the TT and QTT formats respectively. Also, the structure called now TT decomposition has been known in theoretical chemistry as <italic>Matrix Product States (MPS)</italic>. It has been exploited by physicists to describe quantum spin systems theoretically and numerically for at least two decades now, see <xref ref-type="bibr" rid="pcbi.1003359-White1">[46]</xref>, <xref ref-type="bibr" rid="pcbi.1003359-Verstraete1">[47]</xref>, cf. <xref ref-type="bibr" rid="pcbi.1003359-Vidal1">[48]</xref>.</p>
<p>Basic operations of the numerical calculus with vectors and matrices in the TT format, such as addition, Hadamard and dot products, multi-dimensional contraction, matrix-vector multiplication, etc. are considered in detail in <xref ref-type="bibr" rid="pcbi.1003359-Oseledets4">[41]</xref>. Since the main aim of using tensor-structured approximations is to reduce the complexity of computations and avoid the curse of dimensionality, we emphasize that the storage cost and complexity of basic operations of the TT arithmetics, applied to the representation (8), can be bounded by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e164" xlink:type="simple"/></inline-formula> with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e165" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e166" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e167" xlink:type="simple"/></inline-formula>. This estimate is formally linear in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e168" xlink:type="simple"/></inline-formula>; however, the TT ranks <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e169" xlink:type="simple"/></inline-formula> in (8) may depend on <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e170" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e171" xlink:type="simple"/></inline-formula>. Showing that the TT ranks are moderate, e. g. constant or growing linearly with respect to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e172" xlink:type="simple"/></inline-formula> and constant or growing logarithmically with respect to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e173" xlink:type="simple"/></inline-formula>, is a crucial issue in the context of TT-structured methods and has been addressed so far mostly experimentally, see, e. g. <xref ref-type="bibr" rid="pcbi.1003359-Ballani1">[49]</xref>–<xref ref-type="bibr" rid="pcbi.1003359-Khoromskij2">[53]</xref>.</p>
<p>The TT approximation of a vector with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e174" xlink:type="simple"/></inline-formula> indices treated separately results in a decomposition with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e175" xlink:type="simple"/></inline-formula> TT ranks which may take different values. To characterize them, an aggregate characteristic such as the <italic>effective rank</italic> of the TT decomposition is used. Consider an <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e176" xlink:type="simple"/></inline-formula>-tensor is given in a TT decomposition with ranks <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e177" xlink:type="simple"/></inline-formula>. We call the positive root <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e178" xlink:type="simple"/></inline-formula> of the quadratic equation<disp-formula id="pcbi.1003359.e179"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003359.e179" xlink:type="simple"/><label>(10)</label></disp-formula>the <italic>effective rank of the decomposition</italic>. Note that, for integer values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e180" xlink:type="simple"/></inline-formula>, the definition (10) equates the memory needed to store two TT representations. The one corresponding to the left-hand side, is the given decomposition. The one corresponding to the right-hand side is of a vector with the same mode sizes, but with equal <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e181" xlink:type="simple"/></inline-formula> ranks <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e182" xlink:type="simple"/></inline-formula>. This renders <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e183" xlink:type="simple"/></inline-formula> “effective” with respect to memory. On the other hand, the complexity of some TT-structured operations, such as the matrix-vector multiplication and Hadamard product, can also be estimated with the use of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e184" xlink:type="simple"/></inline-formula>.</p>
</sec><sec id="s3c2">
<title>Quantized Tensor Train representation</title>
<p>So far, we have discussed the use of the TT format for extracting low-rank structure with respect to the “physical” dimensions, which are naturally distinguished in the data due to their meaning in the context of a particular problem. For the subject of the present paper, such dimensions represent the reacting species. However, every such a dimension can be unfolded, or <italic>quantized</italic>, into a few virtual dimensions representing its levels, or scales. Then the data can be represented in the TT format applied to all the virtual dimensions introduced. The use of quantization in the context of tensor decompositions dates back to <xref ref-type="bibr" rid="pcbi.1003359-Tyrtyshnikov1">[54]</xref>. For the TT format, it results in the <italic>Quantized Tensor Train</italic> (QTT) format <xref ref-type="bibr" rid="pcbi.1003359-Oseledets2">[35]</xref>–<xref ref-type="bibr" rid="pcbi.1003359-Khoromskij1">[37]</xref>. For the convenience of the reader, we provide a brief review and refer to <xref ref-type="bibr" rid="pcbi.1003359-Oseledets2">[35]</xref>–<xref ref-type="bibr" rid="pcbi.1003359-Khoromskij1">[37]</xref> for details.</p>
<p>Consider a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e185" xlink:type="simple"/></inline-formula>-dimensional vector of size <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e186" xlink:type="simple"/></inline-formula>. Assume that the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e187" xlink:type="simple"/></inline-formula>th mode size <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e188" xlink:type="simple"/></inline-formula> can be factorized as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e189" xlink:type="simple"/></inline-formula> in terms of integral factors <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e190" xlink:type="simple"/></inline-formula>. Then the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e191" xlink:type="simple"/></inline-formula>th mode index <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e192" xlink:type="simple"/></inline-formula> can be represented in a one-to-one fashion through a tuple <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e193" xlink:type="simple"/></inline-formula> of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e194" xlink:type="simple"/></inline-formula> <italic>virtual</italic> indices. Here, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e195" xlink:type="simple"/></inline-formula> runs from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e196" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e197" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e198" xlink:type="simple"/></inline-formula>. The index transformation rule can be defined in many ways.</p>
<p>In order to associate the virtual indices with the scales in the vector, the transformation <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e199" xlink:type="simple"/></inline-formula> can be chosen. This index (bijective) transformation is analogous to the positional notation for encoding numbers. In this work we indicate this by the overscore notation <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e200" xlink:type="simple"/></inline-formula>. In the most general case, the “virtual” mode factors <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e201" xlink:type="simple"/></inline-formula>, which are analogous to the bases in the positional notation, may differ for different positions <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e202" xlink:type="simple"/></inline-formula>.</p>
<p>In terms of the vector, such an index transformation is often called <italic>quantization</italic>. It is equivalent to folding, or reshaping, the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e203" xlink:type="simple"/></inline-formula>th mode of size <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e204" xlink:type="simple"/></inline-formula> into <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e205" xlink:type="simple"/></inline-formula> modes of sizes <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e206" xlink:type="simple"/></inline-formula>. When applied to all dimensions, this procedure transforms a<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e207" xlink:type="simple"/></inline-formula>-dimensional <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e208" xlink:type="simple"/></inline-formula>-vector indexed by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e209" xlink:type="simple"/></inline-formula> into an <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e210" xlink:type="simple"/></inline-formula>-dimensional <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e211" xlink:type="simple"/></inline-formula> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e212" xlink:type="simple"/></inline-formula> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e213" xlink:type="simple"/></inline-formula>-vector indexed by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e214" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e215" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e216" xlink:type="simple"/></inline-formula>. A TT decomposition of the quantized vector is referred to as <italic>QTT decomposition</italic> of the original vector; the ranks of this TT decomposition are called <italic>ranks of the QTT decomposition</italic> of the original vector. For details, we refer to the papers <xref ref-type="bibr" rid="pcbi.1003359-Oseledets2">[35]</xref>–<xref ref-type="bibr" rid="pcbi.1003359-Khoromskij1">[37]</xref> cited above.</p>
<p><bold>Example 3</bold> (QTT Compression) <italic>Consider a vector </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e217" xlink:type="simple"/></inline-formula><italic> of size </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e218" xlink:type="simple"/></inline-formula><italic> given elementwise by</italic><disp-formula id="pcbi.1003359.e219"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003359.e219" xlink:type="simple"/></disp-formula><italic>where </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e220" xlink:type="simple"/></inline-formula><italic>. Assume that </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e221" xlink:type="simple"/></inline-formula><italic>, where </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e222" xlink:type="simple"/></inline-formula><italic> and </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e223" xlink:type="simple"/></inline-formula><italic>. Then the index </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e224" xlink:type="simple"/></inline-formula><italic> running from 0 to </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e225" xlink:type="simple"/></inline-formula><italic> can be represented as </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e226" xlink:type="simple"/></inline-formula><italic> through </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e227" xlink:type="simple"/></inline-formula><italic> “virtual” indices </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e228" xlink:type="simple"/></inline-formula><italic> running from </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e229" xlink:type="simple"/></inline-formula><italic> to </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e230" xlink:type="simple"/></inline-formula><italic> each. The corresponding quantization </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e231" xlink:type="simple"/></inline-formula><italic> of </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e232" xlink:type="simple"/></inline-formula><italic> of size </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e233" xlink:type="simple"/></inline-formula><italic> is given by</italic><disp-formula id="pcbi.1003359.e234"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003359.e234" xlink:type="simple"/></disp-formula><italic>By applying the discussion of Example 1 to </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e235" xlink:type="simple"/></inline-formula><italic>, we see that the QTT format represents </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e236" xlink:type="simple"/></inline-formula><italic> with the cores and ranks given in Example 1 through </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e237" xlink:type="simple"/></inline-formula><italic> parameters intead of </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e238" xlink:type="simple"/></inline-formula><italic> required for the elementwise representation. The case of </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e239" xlink:type="simple"/></inline-formula><italic> virtual levels is considered in </italic><xref ref-type="bibr" rid="pcbi.1003359-Khoromskij1">[<italic>37, Lemma 2.5</italic>]</xref><italic> and </italic><xref ref-type="bibr" rid="pcbi.1003359-Oseledets5">[<italic>42, Theorem 7</italic>]</xref><italic>, the number of parameters being under </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e240" xlink:type="simple"/></inline-formula><italic> instead of </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e241" xlink:type="simple"/></inline-formula><italic>. In these paper, we use the binary quantization with </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e242" xlink:type="simple"/></inline-formula>.</p>
<p>If the natural ordering<disp-formula id="pcbi.1003359.e243"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003359.e243" xlink:type="simple"/><label>(11)</label></disp-formula>of the “virtual” indices is used for representing the quantized vector in the TT format, then the ranks of the QTT decomposition can be enumerated as follows:<disp-formula id="pcbi.1003359.e244"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003359.e244" xlink:type="simple"/></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e245" xlink:type="simple"/></inline-formula> are the TT ranks of the original tensor, i.e. the ranks of the separation of “physical” dimensions. That is, the TT ranks of a tensor are some of the QTT ranks of the same tensor, provided that the natrual ordering (11) is used.</p>
<p>Note that <xref ref-type="disp-formula" rid="pcbi.1003359.e103">equations (8)</xref> and <xref ref-type="disp-formula" rid="pcbi.1003359.e161">(9)</xref> can also be understood as QTT representations of a “one-dimensional” vector (i.e. a vector with a single “physical” index) <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e246" xlink:type="simple"/></inline-formula> and of a “one-dimensional” matrix (i.e. a matrix transforming such vectors) <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e247" xlink:type="simple"/></inline-formula> with entries <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e248" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e249" xlink:type="simple"/></inline-formula> respectively. In this case, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e250" xlink:type="simple"/></inline-formula> denotes the number of virtual dimensions corresponding to the single “physical” dimension.</p>
<p>As a QTT decomposition is a TT decomposition of an appropriately quantized (and possibly, as we discuss in a later section, transposed) tensor, the TT arithmetics referred to in the previous section, when applied to QTT decompositions, naturally provides the same basic operations in the QTT format.</p>
<p>Quantization is crucial for reducing the computational complexity further, as it allows the TT decomposition to resolve and represent more structure in the data by splitting the “virtual” dimensions introduced by the quantization, as well as the “physical” ones. In practice it appears the most efficient to use as fine a quantization (i.e. with small <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e251" xlink:type="simple"/></inline-formula>) as possible and to generate as many virtual modes as possible. For example, when <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e252" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e253" xlink:type="simple"/></inline-formula>, one may consider the “<italic>ultimate quantization</italic>” with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e254" xlink:type="simple"/></inline-formula> for all <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e255" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e256" xlink:type="simple"/></inline-formula>. In this case, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e257" xlink:type="simple"/></inline-formula>, where the indices <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e258" xlink:type="simple"/></inline-formula> take the values <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e259" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e260" xlink:type="simple"/></inline-formula>.</p>
<p>The storage cost and complexity of basic QTT-structured operations are estimated from above through <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e261" xlink:type="simple"/></inline-formula> with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e262" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e263" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e264" xlink:type="simple"/></inline-formula> is an upper bound on all the QTT ranks of the decomposition in question. Note that this estimate may be, depending on <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e265" xlink:type="simple"/></inline-formula>, logarithmic in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e266" xlink:type="simple"/></inline-formula> (also in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e267" xlink:type="simple"/></inline-formula>, which is an upper bound on the number of entries). The notion of the effective rank defined by (10) for TT decompositions applies verbatim to vectors and matrices represented in the QTT format.</p>
</sec><sec id="s3c3">
<title>Structure of the CME operator in the QTT format</title>
<p>In the following we consider the Finite State Projection of the CME, as described previously, with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e268" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e269" xlink:type="simple"/></inline-formula> and assume that the PDF <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e270" xlink:type="simple"/></inline-formula> of the truncated model and of the CME operator <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e271" xlink:type="simple"/></inline-formula> from (3) are represented in the QTT format outlined in the previous section. We use the ultimate quantization, so that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e272" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e273" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e274" xlink:type="simple"/></inline-formula>. In this section we mathematically establish rigorous upper bounds on the QTT ranks of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e275" xlink:type="simple"/></inline-formula> under certain assumptions on the propensity vectors <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e276" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e277" xlink:type="simple"/></inline-formula>, defined by (6).</p>
<p><bold>Theorem 4</bold> <italic>Consider the projected CME operator </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e278" xlink:type="simple"/></inline-formula><italic> defined by (3). Assume that for every </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e279" xlink:type="simple"/></inline-formula><italic> and </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e280" xlink:type="simple"/></inline-formula><italic> the one-dimensional vector </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e281" xlink:type="simple"/></inline-formula><italic> from</italic> (6)–(7) <italic>is given in a QTT decomposition of ranks bounded by </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e282" xlink:type="simple"/></inline-formula><italic>; and that </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e283" xlink:type="simple"/></inline-formula><italic> implies </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e284" xlink:type="simple"/></inline-formula><italic>. Then the CME operator </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e285" xlink:type="simple"/></inline-formula><italic> admits a QTT decomposition of ranks</italic><disp-formula id="pcbi.1003359.e286"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003359.e286" xlink:type="simple"/></disp-formula><italic>with </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e287" xlink:type="simple"/></inline-formula><italic> for </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e288" xlink:type="simple"/></inline-formula><italic> and</italic><disp-formula id="pcbi.1003359.e289"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003359.e289" xlink:type="simple"/></disp-formula><italic>for </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e290" xlink:type="simple"/></inline-formula>.</p>
<p><italic>The proof is provided at the end of <xref ref-type="supplementary-material" rid="pcbi.1003359.s001">Text S1</xref>.</italic></p>
<p>A crude upper bound on the QTT ranks of the CME operator, following from Theorem 4 in terms of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e291" xlink:type="simple"/></inline-formula>, equals <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e292" xlink:type="simple"/></inline-formula> and is still favorable, since it ensures the estimate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e293" xlink:type="simple"/></inline-formula> for the number of parameters, i.e. the storage cost, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e294" xlink:type="simple"/></inline-formula>. Note that if the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e295" xlink:type="simple"/></inline-formula>th factor <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e296" xlink:type="simple"/></inline-formula> of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e297" xlink:type="simple"/></inline-formula>-th propensity function is a polynomial of degree <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e298" xlink:type="simple"/></inline-formula>, then <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e299" xlink:type="simple"/></inline-formula> (7) can be represented in the QTT format with ranks bounded by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e300" xlink:type="simple"/></inline-formula> uniformly in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e301" xlink:type="simple"/></inline-formula>, see <xref ref-type="bibr" rid="pcbi.1003359-Grasedyck2">[45, Corollary 13]</xref> and <xref ref-type="bibr" rid="pcbi.1003359-Oseledets5">[42, Theorem 6]</xref>. In particular, this is the case when the reaction network is composed entirely of elementary reactions. Our numerical experiments show that the QTT ranks of propensity vectors corresponding to rational propensity functions are low as well, which results in low QTT ranks of the CME operator (in particular, see the toggle switch example).</p>
<p>The rank estimate of Theorem 4 is based on the construction of the CME operator, in which the reactions are treated independently, and the ranks of the terms corresponding to different reactions are summed. However, the bases of the QTT representation of these terms can be related so that the resulting decomposition of the CME operator can be reduced without introducing any error; for example, in the case of polynomial propensity functions. However, the rank bound of Theorem 4 is sharp for general vectors used as propensity vectors.</p>
</sec><sec id="s3c4">
<title>Transposed QTT representation</title>
<p>So far we have shown that the CME operator (3) under the FSP projection admits the low-parametric representation in the standard QTT format introduced previously. However, such a compressibility of the operator does not imply that the format is suitable for the efficient numerical solution of the CME. The example presented in Section S1.2 hints at a natural modification of the QTT decomposition. We represent in the TT format the quantized vector with virtual dimensions permuted so that the “virtual” indices corresponding to the same levels of quantization of different physical dimensions are adjacent; for example, for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e302" xlink:type="simple"/></inline-formula> instead of (11) we use the ordering<disp-formula id="pcbi.1003359.e303"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003359.e303" xlink:type="simple"/><label>(12)</label></disp-formula>When <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e304" xlink:type="simple"/></inline-formula> are not equal, in order to obtain a similar to (12) transposed ordering of indices, we introduce void indices <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e305" xlink:type="simple"/></inline-formula> with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e306" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e307" xlink:type="simple"/></inline-formula>, reorder all the “virtual” indices according to (12) and then drop the void ones. This modification of the QTT format, which we refer here to as <italic>quantized-and-transposed Tensor Train</italic>; shortly, <italic>transposed QTT</italic> or <italic>QT3</italic>. It was first applied to vectors in <xref ref-type="bibr" rid="pcbi.1003359-Oseledets6">[55]</xref>.</p>
<p>The index ordering (12) aims at the low-rank representation of such tensors, in which the physical dimensions are coupled on the corresponding virtual levels, i.e. <italic>scales</italic>, much more than different scales are within each single dimension. This is the case for the extreme example (S1.5), where we end up with a rank-one decomposition if we choose to separate the scales first, and the physical dimensions, then. Despite such a difference in approximation properties, from the algorithmic point of view, QT3 is a minor modification of the standard, widely used form of the QTT format. We do not imply any particular ordering of indices by referring simply to QTT.</p>
</sec><sec id="s3c5">
<title>Structure of the CME operator in the transposed QTT format</title>
<p>Similarly to Theorem 4, we can bound the ranks of the CME operator in the transposed QTT format relying on the ordering (12) of “virtual” indices.</p>
<p><bold>Theorem 5</bold> <italic>Consider the projected CME operator </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e308" xlink:type="simple"/></inline-formula><italic> defined by (3). Assume that for every </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e309" xlink:type="simple"/></inline-formula><italic> and </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e310" xlink:type="simple"/></inline-formula><italic> the one-dimensional vector </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e311" xlink:type="simple"/></inline-formula><italic> from </italic>(6)–(7)<italic> is given in a QTT decomposition of ranks bounded by </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e312" xlink:type="simple"/></inline-formula><italic>; and that </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e313" xlink:type="simple"/></inline-formula><italic> implies </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e314" xlink:type="simple"/></inline-formula><italic>. Then the CME operator </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e315" xlink:type="simple"/></inline-formula><italic> admits a QT3 decomposition of ranks bounded by</italic><disp-formula id="pcbi.1003359.e316"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003359.e316" xlink:type="simple"/></disp-formula><italic>where </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e317" xlink:type="simple"/></inline-formula>.</p>
<p><italic>The proof is given at the end of <xref ref-type="supplementary-material" rid="pcbi.1003359.s001">Text S1</xref>.</italic></p>
<p>We observe in the enzymatic futile cycle example below that the QT3 ranks of the CME operator may be significantly lower than the bound of Theorem 4.</p>
</sec></sec><sec id="s3d">
<title>Time Integration of the CME: hp-Discontinuous Galerkin Discretization</title>
<p>Let us consider the truncated CME (S1.1) with a state space <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e318" xlink:type="simple"/></inline-formula> on a finite interval <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e319" xlink:type="simple"/></inline-formula>. The Cauchy problem with an initial value <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e320" xlink:type="simple"/></inline-formula> reads as find a continuously differentiable function <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e321" xlink:type="simple"/></inline-formula> such that<disp-formula id="pcbi.1003359.e322"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003359.e322" xlink:type="simple"/><label>(13)</label></disp-formula>The solution to (13) is given theoretically by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e323" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e324" xlink:type="simple"/></inline-formula>, but the straightforward numerical evaluation of the matrix exponential involved is a very challenging task due to the “curse of dimensionality”. Instead, we use the QTT-structured <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e325" xlink:type="simple"/></inline-formula>-<italic>discontinuous Galerkin</italic> (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e326" xlink:type="simple"/></inline-formula><italic>-DG-QTT</italic> for short) time-stepping scheme, proposed in <xref ref-type="bibr" rid="pcbi.1003359-Kazeev1">[38]</xref>, to solve (13). The <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e327" xlink:type="simple"/></inline-formula>-DG time stepping was proposed earlier in <xref ref-type="bibr" rid="pcbi.1003359-Schotzau1">[56]</xref> for initial value problems for abstract, possibly non-linear, ODEs. We recapitulate the analysis results from <xref ref-type="bibr" rid="pcbi.1003359-Schotzau1">[56]</xref> for problems of the particular form (13), which have unique, analytic in time classical solutions. To discuss the tensor structure of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e328" xlink:type="simple"/></inline-formula>-DG-QTT approach, we revisit <xref ref-type="bibr" rid="pcbi.1003359-Kazeev1">[38]</xref>.</p>
<p>Let us denote by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e329" xlink:type="simple"/></inline-formula> the space of polynomials defined on a finite interval <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e330" xlink:type="simple"/></inline-formula>, of degree <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e331" xlink:type="simple"/></inline-formula> at most and with coefficients from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e332" xlink:type="simple"/></inline-formula>. Let <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e333" xlink:type="simple"/></inline-formula> be a partition of the time interval <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e334" xlink:type="simple"/></inline-formula> into subintervals <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e335" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e336" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e337" xlink:type="simple"/></inline-formula>. Consider the space<disp-formula id="pcbi.1003359.e338"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003359.e338" xlink:type="simple"/></disp-formula>of functions, which are polynomials of degree <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e339" xlink:type="simple"/></inline-formula> at most on <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e340" xlink:type="simple"/></inline-formula> for all <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e341" xlink:type="simple"/></inline-formula>. For all <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e342" xlink:type="simple"/></inline-formula> let <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e343" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e344" xlink:type="simple"/></inline-formula> for all feasible <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e345" xlink:type="simple"/></inline-formula>.</p>
<sec id="s3d1">
<title>Definition 6</title>
<p><italic>The </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e346" xlink:type="simple"/></inline-formula><italic>-DG formulation of (13), corresponding to the partition </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e347" xlink:type="simple"/></inline-formula><italic> of the time interval and the vector </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e348" xlink:type="simple"/></inline-formula><italic> of polynomial degrees, reads as follows: find </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e349" xlink:type="simple"/></inline-formula><italic> such that</italic><disp-formula id="pcbi.1003359.e350"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003359.e350" xlink:type="simple"/><label>(14)</label></disp-formula><italic>for all </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e351" xlink:type="simple"/></inline-formula><italic>, where </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e352" xlink:type="simple"/></inline-formula><italic> stands for the initial value </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e353" xlink:type="simple"/></inline-formula>.</p>
<p><xref ref-type="disp-formula" rid="pcbi.1003359.e350">Equation (14)</xref> can be understood as a time-stepping method: if for all <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e354" xlink:type="simple"/></inline-formula> from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e355" xlink:type="simple"/></inline-formula> up to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e356" xlink:type="simple"/></inline-formula> the polynomial <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e357" xlink:type="simple"/></inline-formula> is known through <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e358" xlink:type="simple"/></inline-formula> coefficients from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e359" xlink:type="simple"/></inline-formula>, then <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e360" xlink:type="simple"/></inline-formula> can be found as the solution to<disp-formula id="pcbi.1003359.e361"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003359.e361" xlink:type="simple"/><label>(15)</label></disp-formula>For <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e362" xlink:type="simple"/></inline-formula> let <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e363" xlink:type="simple"/></inline-formula> be a basis in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e364" xlink:type="simple"/></inline-formula>, then the corresponding temporal shape functions on <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e365" xlink:type="simple"/></inline-formula> are <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e366" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e367" xlink:type="simple"/></inline-formula>, where the affine map <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e368" xlink:type="simple"/></inline-formula> is defined by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e369" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e370" xlink:type="simple"/></inline-formula>. If <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e371" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e372" xlink:type="simple"/></inline-formula>, then (15) yields the following linear system on the coefficients:<disp-formula id="pcbi.1003359.e373"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003359.e373" xlink:type="simple"/><label>(16)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e374" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e375" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e376" xlink:type="simple"/></inline-formula>, while <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e377" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e378" xlink:type="simple"/></inline-formula>.</p>
<p>The <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e379" xlink:type="simple"/></inline-formula>-DG time discretization allows, on the one hand, to resolve fast transients in the evolution by the time-step and polynomial order adaptation for time-analytic solutions given through matrix exponentials of the CME operator. In particular, due to the time-analyticity of the solution, exponential rates of convergence in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e380" xlink:type="simple"/></inline-formula> are achieved; for example, for the “<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e381" xlink:type="simple"/></inline-formula>-version” with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e382" xlink:type="simple"/></inline-formula> the error bound of Proposition 3 of <xref ref-type="supplementary-material" rid="pcbi.1003359.s001">Text S1</xref> can be recast as<disp-formula id="pcbi.1003359.e383"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003359.e383" xlink:type="simple"/></disp-formula>with constants <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e384" xlink:type="simple"/></inline-formula> asymptotically independent of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e385" xlink:type="simple"/></inline-formula>, see <xref ref-type="bibr" rid="pcbi.1003359-Schotzau1">[56, Theorem 3.18]</xref>. This implies that a prescribed level of accuracy <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e386" xlink:type="simple"/></inline-formula> can be reached with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e387" xlink:type="simple"/></inline-formula> temporal degrees of freedom.</p>
<p>In the tensor representation of the system (16) we keep the QTT format used for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e388" xlink:type="simple"/></inline-formula> and attach the temporal index as a single dimension (without quantization) to the first “virtual” spatial index. In Section S1.3 we present this format in more detail.</p>
</sec><sec id="s3d2">
<title>Theorem 7</title>
<p><italic>Assume that </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e389" xlink:type="simple"/></inline-formula><italic> is represented in the QTT or QT3 format in terms of </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e390" xlink:type="simple"/></inline-formula><italic> cores with ranks </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e391" xlink:type="simple"/></inline-formula><italic>. Then the matrix of system </italic>(16)<italic> can be represented in the corresponding format in terms of </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e392" xlink:type="simple"/></inline-formula><italic> cores with ranks </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e393" xlink:type="simple"/></inline-formula>.</p>
<p><italic>The proof is given at the end of <xref ref-type="supplementary-material" rid="pcbi.1003359.s001">Text S1</xref>.</italic></p>
<p>As an alternative to the presently considered order and stepsize adaptive time-stepping, it has been proposed in <xref ref-type="bibr" rid="pcbi.1003359-Munsky1">[5]</xref> to use a low-order time discretization with a uniformly small step and rely on tensor-structured compression methods also for time-adaptivity. This approach leads to one large linear system with low-rank structure. We found this approach to be more demanding to the tensor-structured solvers, since the aggregate linear system for all time steps seems to be more difficult to solve. A remedy may be to partition the time interval into subintervals with possibly different time steps being used within each such subinterval, which already shifts the approach in the direction of the presently proposed <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e394" xlink:type="simple"/></inline-formula>-DG method. In the presence of time inhomogeneity the aggregate systems in general lose their low-rank structure rendering the space-time tensor approach less efficient, while the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e395" xlink:type="simple"/></inline-formula>-DG method would still perform well.</p>
</sec></sec><sec id="s3e">
<title>Algorithm Summary</title>
<p>Assuming we have a finite state projection of the CME, we summarize our approach to the CME solution by outlining the two main algorithms we propose for its subsequent efficient solution. Given a reaction network and a finite state projection Algorithm 1 (Box 1) approximates the CME operator in QTT format. Algorithm 2 (Box 2) then describes the time-stepping procedure for computing the solution. Note that the integrals in Algorithm 2 may be pre-computed depending on the choice of temporal basis functions. E.g. if one chooses the Legendre polynomials as the basis, then there are explicit solutions of the integrals involved.</p>
</sec><sec id="s3f">
<title>Comparison to Krylov Subspace Methods</title>
<p>The solution at a particular time of a finite state projection of the CME is given analytically by the matrix exponential, but the numerical computation of such solutions for large <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e396" xlink:type="simple"/></inline-formula> is often expensive. When <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e397" xlink:type="simple"/></inline-formula> is sparse, however, the Krylov subspace method <xref ref-type="bibr" rid="pcbi.1003359-Saad1">[57]</xref>, <xref ref-type="bibr" rid="pcbi.1003359-Saad2">[58]</xref> is one approach for performing the computation for the CME as described in <xref ref-type="bibr" rid="pcbi.1003359-MacNamara1">[59]</xref>. The method uses the Arnoldi iteration to compute the Krylov subspace up to some order of accuracy then computes the matrix exponential in that smaller space (by diagonal Padé approximation). The publicly available Expokit Toolbox by Sidje <xref ref-type="bibr" rid="pcbi.1003359-Sidje1">[60]</xref> provides an implementation of the algorithm.</p>
<p>It is important to note that the algorithm steps incrementally in time rather than jumping to the desired time step. In the context of the CME, this means that the faster the support of the pdf fills the set of reachable states, the more expensive this algorithm becomes to compute. When there is reason to believe the support of the pdf remains small, then the algorithm can be expected to compute efficiently over large time intervals. Generically, however,the support of the pdf quickly fills the set of reachable states which may include every state retained in the projection. This renders the Arnoldi iteration computationally expensive at each time step.</p>
<p>The QTT method effectively circumvents this problem by storing the computed solution at each time step in the QTT format and exploiting the fast algorithms for basic tensor arithmetic available in this format. While it is unknown whether a given reaction network and initial probability distribution will produce an evolution that can be represented well by a QTT formatted tensor with low QTT ranks, our numerical experiments find this often is the case and that the savings over using traditional sparse representations of vectors and matrices may be quite substantial.</p>
<p>Below we compare our method to the Krylov subspace approach in the toggle switch example which does not exhibit any pronounced structure favoring either one of the methods (rank-one separability and sparse structure respectively).</p>
</sec><sec id="s3g">
<title>Numerical experiments</title>
<sec id="s3g1">
<title>Common details</title>
<p>At the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e398" xlink:type="simple"/></inline-formula>th time step, after having obtained <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e399" xlink:type="simple"/></inline-formula> as an approximate solution of the corresponding linear system (16), we evaluate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e400" xlink:type="simple"/></inline-formula> and reapproximate it in the TT format with relative <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e401" xlink:type="simple"/></inline-formula>-accuracy <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e402" xlink:type="simple"/></inline-formula> in order to drop excessive QTT components. The values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e403" xlink:type="simple"/></inline-formula> and the complete set of parameters of the time discretization and of the DMRG solver are reported for each experiment in Section S1.7.</p>
<p>We compare the evaluated solution or its marginal to a reference data. By <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e404" xlink:type="simple"/></inline-formula> we denote the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e405" xlink:type="simple"/></inline-formula>-norm of the discrepancy. Generally we start with the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e406" xlink:type="simple"/></inline-formula>-norm, which can be easily computed even when the comparison is made only in the (Q)TT format and cannot be made in the full format (which is the case in the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e407" xlink:type="simple"/></inline-formula>-independent birth-death processes experiments for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e408" xlink:type="simple"/></inline-formula>). In some cases we compute also the discrepancy for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e409" xlink:type="simple"/></inline-formula> and the probability deficiency <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e410" xlink:type="simple"/></inline-formula>. The reference data is also obtained with a certain accuracy which cannot be reduced arbitrarily. Moreover, in some cases our solution appears to be more accurate, which accounts for using the term “discrepancy” instead of “error”.</p>
<p>In the first and third examples we reapproximate the solution once more, with relative <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e411" xlink:type="simple"/></inline-formula>-accuracy <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e412" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e413" xlink:type="simple"/></inline-formula> is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e414" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e415" xlink:type="simple"/></inline-formula> respectively. Below we refer to this procedure as <italic>truncation</italic>, and the approximated vector, as <italic>truncated solution</italic>. The procedure ensures that the relative discrepancy in the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e416" xlink:type="simple"/></inline-formula>-norm grows by the factor of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e417" xlink:type="simple"/></inline-formula> at most and shows what QTT ranks allow for our numerical solution, obtained without using any reference data, to ensure <italic>almost</italic> the same discrepancy from the reference data (which is related to the accuracy of both the solution and reference data) as before truncation.</p>
</sec><sec id="s3g2">
<title><italic>d</italic> independent birth-death processes</title>
<p>As a first example we consider a system composed of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e418" xlink:type="simple"/></inline-formula> chemical species with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e419" xlink:type="simple"/></inline-formula> a vector of random variables representing the species count of each. The dynamics of the random vector are governed by independent birth-death processes. For the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e420" xlink:type="simple"/></inline-formula>-th species, the corresponding reactions are given by<disp-formula id="pcbi.1003359.e421"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003359.e421" xlink:type="simple"/></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e422" xlink:type="simple"/></inline-formula> is the spontaneous creation rate and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e423" xlink:type="simple"/></inline-formula> is the destruction rate for species <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e424" xlink:type="simple"/></inline-formula>. This problem is perfectly separable in the sense that the dynamics of any one chemical species of this system is independent of the dynamics of all others. Given the initial condition <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e425" xlink:type="simple"/></inline-formula> for each <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e426" xlink:type="simple"/></inline-formula>, the marginal distribution for any one species <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e427" xlink:type="simple"/></inline-formula> at time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e428" xlink:type="simple"/></inline-formula> is given by:<disp-formula id="pcbi.1003359.e429"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003359.e429" xlink:type="simple"/></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e430" xlink:type="simple"/></inline-formula> is the Poisson distribution with parameter <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e431" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e432" xlink:type="simple"/></inline-formula> indicates the discrete convolution in variable <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e433" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e434" xlink:type="simple"/></inline-formula> the multinomial distribution with parameter <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e435" xlink:type="simple"/></inline-formula>, and the parameters <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e436" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e437" xlink:type="simple"/></inline-formula> evolve according to the reaction rate equations<disp-formula id="pcbi.1003359.e438"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003359.e438" xlink:type="simple"/></disp-formula>See <xref ref-type="bibr" rid="pcbi.1003359-Jahnke1">[4, Theorem 1]</xref> for details. Since <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e439" xlink:type="simple"/></inline-formula> are mutually independent, the joint PDF at time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e440" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e441" xlink:type="simple"/></inline-formula>, is the product of the marginals:<disp-formula id="pcbi.1003359.e442"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003359.e442" xlink:type="simple"/></disp-formula>that is, this system has an explicit formula for the solution regardless of the number of chemical species involved. We can, therefore, evaluate the accuracy and observe the complexity scaling of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e443" xlink:type="simple"/></inline-formula>-DG-QTT solver as the number of chemical species increases.</p>
<p>For numerical simulations we assume <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e444" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e445" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e446" xlink:type="simple"/></inline-formula> and consider the FSP with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e447" xlink:type="simple"/></inline-formula>. We solve the corresponding projected CME for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e448" xlink:type="simple"/></inline-formula> to check that in all these cases the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e449" xlink:type="simple"/></inline-formula>-DG-QTT method using the ordering (11) without transposition is capable of revealing the same low-rank QTT structure of the solution. For the CME operator we have <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e450" xlink:type="simple"/></inline-formula> up to accuracy <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e451" xlink:type="simple"/></inline-formula>. We compute the evolution of the PDF of the system for the zero initial value through <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e452" xlink:type="simple"/></inline-formula> time steps till <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e453" xlink:type="simple"/></inline-formula>.</p>
<p>The results, which are presented in <xref ref-type="fig" rid="pcbi-1003359-g002">Figure 2</xref> and <xref ref-type="table" rid="pcbi-1003359-t002">Table 2</xref>, show that the same low-rank structure of the solution is adaptively reconstructed by the algorithm for all <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e454" xlink:type="simple"/></inline-formula> considered. The transient phase causes the growth of QTT ranks, because at certain steps of every sweep the DMRG solver merges virtual dimensions corresponding to different species and attempts to reduce the numerical rank by re-separating these dimensions. As a consequence, during the transient phase numerical QTT ranks are overestimated, which does not affect the QTT structure of the numerical solution at larger times.</p>
<fig id="pcbi-1003359-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003359.g002</object-id><label>Figure 2</label><caption>
<title><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e455" xlink:type="simple"/></inline-formula> independent birth-death processes.</title>
<p>The maximum QTT ranks of the solutions, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e456" xlink:type="simple"/></inline-formula> for each <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e457" xlink:type="simple"/></inline-formula>. Markers are omitted for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e458" xlink:type="simple"/></inline-formula> in (a)–(c). (a) Relative discrepancy <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e459" xlink:type="simple"/></inline-formula> (after truncation) vs. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e460" xlink:type="simple"/></inline-formula>. (b) Cumulative computation time (in seconds) vs. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e461" xlink:type="simple"/></inline-formula>. (c) Effective QTT rank <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e462" xlink:type="simple"/></inline-formula> (after truncation) vs. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e463" xlink:type="simple"/></inline-formula>. (d) Relative discrepancy <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e464" xlink:type="simple"/></inline-formula> (blue) and total computation time (red) vs. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e465" xlink:type="simple"/></inline-formula>.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003359.g002" position="float" xlink:type="simple"/></fig><table-wrap id="pcbi-1003359-t002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003359.t002</object-id><label>Table 2</label><caption>
<title><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e466" xlink:type="simple"/></inline-formula> independent birth-death processes: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e467" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e468" xlink:type="simple"/></inline-formula>, computational <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e469" xlink:type="simple"/></inline-formula> in seconds; <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e470" xlink:type="simple"/></inline-formula> for all <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e471" xlink:type="simple"/></inline-formula>.</title>
</caption><alternatives><graphic id="pcbi-1003359-t002-2" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003359.t002" xlink:type="simple"/>
<table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>d</italic></td>
<td align="left" rowspan="1" colspan="1"><italic>N</italic></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e472" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e473" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><italic>r</italic><sub>eff</sub></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e474" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">TIME</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1">1</td>
<td align="left" rowspan="1" colspan="1">2<sup>12</sup></td>
<td align="left" rowspan="1" colspan="1">1.4<sub>+<bold>3</bold></sub></td>
<td align="left" rowspan="1" colspan="1">1.0<sub>−<bold>3</bold></sub></td>
<td align="left" rowspan="1" colspan="1">3.53</td>
<td align="left" rowspan="1" colspan="1">1.9<sub>−<bold>5</bold></sub></td>
<td align="left" rowspan="1" colspan="1">87</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">2</td>
<td align="left" rowspan="1" colspan="1">2<sup>24</sup></td>
<td align="left" rowspan="1" colspan="1">2.4<sub>+<bold>3</bold></sub></td>
<td align="left" rowspan="1" colspan="1">1.4<sub>−<bold>3</bold></sub></td>
<td align="left" rowspan="1" colspan="1">3.42</td>
<td align="left" rowspan="1" colspan="1">2.3<sub>−<bold>5</bold></sub></td>
<td align="left" rowspan="1" colspan="1">704</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">3</td>
<td align="left" rowspan="1" colspan="1">2<sup>36</sup></td>
<td align="left" rowspan="1" colspan="1">3.5<sub>+<bold>3</bold></sub></td>
<td align="left" rowspan="1" colspan="1">1.8<sub>−<bold>3</bold></sub></td>
<td align="left" rowspan="1" colspan="1">3.38</td>
<td align="left" rowspan="1" colspan="1">3.5<sub>−<bold>5</bold></sub></td>
<td align="left" rowspan="1" colspan="1">1548</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">4</td>
<td align="left" rowspan="1" colspan="1">2<sup>48</sup></td>
<td align="left" rowspan="1" colspan="1">4.5<sub>+<bold>3</bold></sub></td>
<td align="left" rowspan="1" colspan="1">2.0<sub>−<bold>3</bold></sub></td>
<td align="left" rowspan="1" colspan="1">3.37</td>
<td align="left" rowspan="1" colspan="1">3.6<sub>−<bold>5</bold></sub></td>
<td align="left" rowspan="1" colspan="1">2516</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">5</td>
<td align="left" rowspan="1" colspan="1">2<sup>60</sup></td>
<td align="left" rowspan="1" colspan="1">5.5<sub>+<bold>3</bold></sub></td>
<td align="left" rowspan="1" colspan="1">2.3<sub>−<bold>3</bold></sub></td>
<td align="left" rowspan="1" colspan="1">3.36</td>
<td align="left" rowspan="1" colspan="1">3.5<sub>−<bold>5</bold></sub></td>
<td align="left" rowspan="1" colspan="1">3544</td>
</tr>
</tbody>
</table>
</alternatives><table-wrap-foot><fn id="nt102"><label/><p><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e475" xlink:type="simple"/></inline-formula> is the number of states taken into account in the FSP. The exponents are given in boldface for the base <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e476" xlink:type="simple"/></inline-formula>.</p></fn></table-wrap-foot></table-wrap></sec><sec id="s3g3">
<title>Toggle switch</title>
<p>The next example models a synthetic gene-regulatory circuit designed to produce bistability over a wide range of parameter values <xref ref-type="bibr" rid="pcbi.1003359-Gardner1">[61]</xref>. The network consists of two promoters constructed in a mutually inhibitory configuration that implement a double negative feedback loop, causing the network to exhibit robust bistable behavior (see <xref ref-type="fig" rid="pcbi-1003359-g003">Figure 3</xref>). If the concentration of one repressor is high, this lowers the production rate of the other repressor, keeping its concentration low. This allows a high rate of production of the original repressor, thereby stabilizing its high concentration.</p>
<fig id="pcbi-1003359-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003359.g003</object-id><label>Figure 3</label><caption>
<title>Toggle Switch consisting of double negative feedback loop.</title>
<p>Species <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e477" xlink:type="simple"/></inline-formula> represses the production of species <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e478" xlink:type="simple"/></inline-formula> and vice versa.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003359.g003" position="float" xlink:type="simple"/></fig>
<p>A stochastic model of the toggle switch was considered in <xref ref-type="bibr" rid="pcbi.1003359-Munsky2">[62]</xref> and consists of the following four reactions:<disp-formula id="pcbi.1003359.e479"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003359.e479" xlink:type="simple"/></disp-formula><disp-formula id="pcbi.1003359.e480"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003359.e480" xlink:type="simple"/></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e481" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e482" xlink:type="simple"/></inline-formula> represent the two repressors. Denote the species counts of each by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e483" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e484" xlink:type="simple"/></inline-formula>, respectively. The stochastic model admits a bimodal stationary distribution over a wide range of values of the rate constants. We consider the set of parameters from <xref ref-type="bibr" rid="pcbi.1003359-Munsky2">[62]</xref> which were selected to test the efficiency of using available numerical algorithms to calculate matrix exponentials to solve low dimensional FSP approximations of the CME. We then scaled the parameters so that a larger set of states would be required to guarantee an FSP truncation with low approximation error. While a different set of parameters were considered in <xref ref-type="bibr" rid="pcbi.1003359-Deuflhard1">[23]</xref>, <xref ref-type="bibr" rid="pcbi.1003359-Sjberg1">[63]</xref>, which required a larger FSP truncation, this choice of values renders the system symmetric under interchange of the roles of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e485" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e486" xlink:type="simple"/></inline-formula>. This situation is less biologically relevant than what we consider here.</p>
<p>For this numerical example we assume <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e487" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e488" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e489" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e490" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e491" xlink:type="simple"/></inline-formula>. We consider the FSP with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e492" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e493" xlink:type="simple"/></inline-formula>, which allows to take into account <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e494" xlink:type="simple"/></inline-formula> states. The initial value is zero. We use the ordering (11) without transposition. For the CME operator we have <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e495" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e496" xlink:type="simple"/></inline-formula> up to accuracy <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e497" xlink:type="simple"/></inline-formula>. We compute the evolution of the PDF up to time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e498" xlink:type="simple"/></inline-formula> with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e499" xlink:type="simple"/></inline-formula> time steps.</p>
<p>The results are presented in <xref ref-type="fig" rid="pcbi-1003359-g004">Figure 4</xref>. At the terminal time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e500" xlink:type="simple"/></inline-formula> we have <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e501" xlink:type="simple"/></inline-formula>. The overall computation time is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e502" xlink:type="simple"/></inline-formula> seconds. The validation with the PDF based on 816 million Monte Carlo simulations (every 1000 draws taking on average over 360 seconds, adding up to the overall CPU time over <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e503" xlink:type="simple"/></inline-formula> seconds), indicates <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e504" xlink:type="simple"/></inline-formula>, and for the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e505" xlink:type="simple"/></inline-formula>- and Chebyshev norms we have <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e506" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e507" xlink:type="simple"/></inline-formula>. As for the ranks, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e508" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e509" xlink:type="simple"/></inline-formula>. <xref ref-type="fig" rid="pcbi-1003359-g004">Figure 4 (c)</xref> shows that after <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e510" xlink:type="simple"/></inline-formula> the norm of the time derivative stagnates at approximately <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e511" xlink:type="simple"/></inline-formula> determined by the accuracy parameters chosen, and the following time steps require negligible computational effort. At the same time, as we see in <xref ref-type="fig" rid="pcbi-1003359-g004">Figure 4 (b)</xref>, all QTT ranks stabilize under <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e512" xlink:type="simple"/></inline-formula>, but the transient phase preceding that moment involves far higher ranks. <xref ref-type="fig" rid="pcbi-1003359-g005">Figure 5 (a)</xref> presents a snapshot of the distribution.</p>
<fig id="pcbi-1003359-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003359.g004</object-id><label>Figure 4</label><caption>
<title>Genetic toggle switch.</title>
<p>The values are given vs. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e513" xlink:type="simple"/></inline-formula>. Markers are omitted for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e514" xlink:type="simple"/></inline-formula>. (a) Probability deficiency <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e515" xlink:type="simple"/></inline-formula>. (b) Maximum and effective QTT ranks of the computed solution. (c) Relative norm <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e516" xlink:type="simple"/></inline-formula> of the derivative (blue) and cumulative computation time (red, sec.)</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003359.g004" position="float" xlink:type="simple"/></fig><fig id="pcbi-1003359-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003359.g005</object-id><label>Figure 5</label><caption>
<title>Snapshots of solutions.</title>
<p>(a) Genetic toggle switch. The PDF for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e517" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e518" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e519" xlink:type="simple"/></inline-formula> (hor.) vs. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e520" xlink:type="simple"/></inline-formula> (vert.). As the process evolves, the probability mass becomes concentrated in two distinct regions. Contour coloring is logarithmically scaled with base <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e521" xlink:type="simple"/></inline-formula>. (b) Enzymatic futile cycle. The marginal PDF for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e522" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e523" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e524" xlink:type="simple"/></inline-formula> (vert.) vs. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e525" xlink:type="simple"/></inline-formula> (hor.). Black diagonal lines delimit the states reachable from the initial condition. The transposed QTT format automatically exploits this sparsity pattern <italic>of the full PDF</italic> for compression without special input from the user.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003359.g005" position="float" xlink:type="simple"/></fig></sec><sec id="s3g4">
<title>Comparison to the Krylov subspace approach</title>
<p>We compared the performance of our proposed method to that of the Krylov subspace approach implemented in Sidje's Expokit <xref ref-type="bibr" rid="pcbi.1003359-Sidje1">[60]</xref>. In order to make the comparison as fair as possible we further restricted the FSP truncation used by the Krylov approach to a <italic>hyperbolic cross</italic>, that is, we only kept states with indices <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e526" xlink:type="simple"/></inline-formula> satisfying the condition <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e527" xlink:type="simple"/></inline-formula>. Effectively, this reduces the states in the truncation from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e528" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e529" xlink:type="simple"/></inline-formula>, a reduction of about a third. A similar truncation was used for this model in <xref ref-type="bibr" rid="pcbi.1003359-Munsky2">[62]</xref>.</p>
<p>We emphasize that formulating this hyperbolic cross truncation requires special insight into the problem on the part of the modeler. In constrast, our proposed method is completely naive in this respect, instead relying on the adaptivity of the QTT compression.</p>
<p>For the FSP with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e530" xlink:type="simple"/></inline-formula> states considered we reach <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e531" xlink:type="simple"/></inline-formula> with the first <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e532" xlink:type="simple"/></inline-formula> time steps of our method in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e533" xlink:type="simple"/></inline-formula> seconds; with the Krylov subspace method restricted to the hyperbolic cross, in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e534" xlink:type="simple"/></inline-formula> seconds. For the discrepancy between the two solutions obtained we have <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e535" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e536" xlink:type="simple"/></inline-formula>.</p>
<p>At approximately <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e537" xlink:type="simple"/></inline-formula>, the decay of the relative norm of the solution becomes exponential; see <xref ref-type="fig" rid="pcbi-1003359-g004">Figure 4 (c)</xref>. That is exploited by our method in two ways. On the one hand, we adjust the time mesh manually, which reduces the overall number of time steps needed to reach <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e538" xlink:type="simple"/></inline-formula> from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e539" xlink:type="simple"/></inline-formula>: we take <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e540" xlink:type="simple"/></inline-formula> steps intead of approximately <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e541" xlink:type="simple"/></inline-formula> we would need if we had used a uniform time mesh for the long-term dynamics. On the other hand, what is more significant, the adaptive QTT representation used at each step yields a substantial speedup of the solution of linear systems, which is possible due to the rapid convergence of the solution to a stationary distribution. The Krylov subspace solver adapts the time mesh on its own, but employs no self-adaptivity for efficient storage of numerically computed states. As a result, the performance (in terms of the computational time vs. physical time of the system) decays much slower for the Krylov subspace solver, and our method excels even more in modelling the long-term dynamics. For example, our method achieves <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e542" xlink:type="simple"/></inline-formula>, when <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e543" xlink:type="simple"/></inline-formula> reaches <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e544" xlink:type="simple"/></inline-formula>, with the overall computation time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e545" xlink:type="simple"/></inline-formula> seconds compared to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e546" xlink:type="simple"/></inline-formula> seconds of the Krylov subspace solver, i.e. approximately <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e547" xlink:type="simple"/></inline-formula> times faster. For larger terminal times the advantage of our method becomes even more pronounced.</p>
</sec><sec id="s3g5">
<title>Enzymatic futile cycle</title>
<p>Futile cycles are composed of two metabolic or signaling pathways that work in opposite directions so that the products of one pathway are the precursors of the other and vice versa, see <xref ref-type="fig" rid="pcbi-1003359-g006">Figure 6</xref>. This biochemical network structure results in no net production of molecules and often results only in the dissipation of energy as heat <xref ref-type="bibr" rid="pcbi.1003359-Schwender1">[64]</xref>. Nevertheless, there is an abundance of known pathways that use this motif and it is thought to provide a highly tunable control mechanism with potentially high sensitivity <xref ref-type="bibr" rid="pcbi.1003359-Schwender1">[64]</xref>, <xref ref-type="bibr" rid="pcbi.1003359-Samoilov1">[65]</xref>.</p>
<fig id="pcbi-1003359-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003359.g006</object-id><label>Figure 6</label><caption>
<title>Enzymatic futile cycle.</title>
<p><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e548" xlink:type="simple"/></inline-formula> is transformed into <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e549" xlink:type="simple"/></inline-formula> and vice versa by enzymes <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e550" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e551" xlink:type="simple"/></inline-formula>, respectively.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003359.g006" position="float" xlink:type="simple"/></fig>
<p><xref ref-type="bibr" rid="pcbi.1003359-Samoilov1">[65]</xref> introduced a stochastic version of the model with just the essential network components required to model the dynamics. The stochastic model consists of six chemical species and six reactions:<disp-formula id="pcbi.1003359.e552"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003359.e552" xlink:type="simple"/></disp-formula><disp-formula id="pcbi.1003359.e553"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003359.e553" xlink:type="simple"/></disp-formula><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e554" xlink:type="simple"/></inline-formula> represent the forward substrate and product, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e555" xlink:type="simple"/></inline-formula> denote the forward and reverse enzymes, respectively. Note that this system is closed meaning that particles are neither created nor destroyed. We denote the random variables representing the molecule count of each species with italics.</p>
<p>For the particular set of initial conditions considered in <xref ref-type="bibr" rid="pcbi.1003359-Samoilov1">[65]</xref> the number of states that are reachable is large enough to render a direct numerical solution of the CME impractical. The authors instead used the Gillespie Direct SSA to generate a large number of sample paths to estimate the distribution. The authors also applied a diffusion approximation to their model which resulted in a SDE which produced qualitatively similar dynamics. To the authors' knowledge, no attempt has been made so far towards the direct numerical solution of the CME for this system.</p>
<p>At time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e556" xlink:type="simple"/></inline-formula>, let <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e557" xlink:type="simple"/></inline-formula> denote the total amount of both free and bound substrate, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e558" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e559" xlink:type="simple"/></inline-formula> the total forward and reverse enzymes, respectively. We observe the following conservation relations:<disp-formula id="pcbi.1003359.e560"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003359.e560" xlink:type="simple"/></disp-formula><disp-formula id="pcbi.1003359.e561"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003359.e561" xlink:type="simple"/></disp-formula><disp-formula id="pcbi.1003359.e562"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003359.e562" xlink:type="simple"/></disp-formula>Using the above, one can establish an upper and lower bound relating the species count of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e563" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e564" xlink:type="simple"/></inline-formula> that depends only on the total initial amount of substrate and the total initial amount of enzymes in the system<disp-formula id="pcbi.1003359.e565"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003359.e565" xlink:type="simple"/></disp-formula>Assuming that the initial quantity of enzymes <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e566" xlink:type="simple"/></inline-formula> is small, for a given copy number of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e567" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e568" xlink:type="simple"/></inline-formula> may take at most <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e569" xlink:type="simple"/></inline-formula> different values. Since <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e570" xlink:type="simple"/></inline-formula> is a conserved quantity, this means that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e571" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e572" xlink:type="simple"/></inline-formula> will be strongly anti-correlated with the set of reachable states having an affine structure. Under these circumstances, we find in our numerical experiments that the transposed QTT format is better suited than the standard QTT to efficiently represent the corresponding PDF, since the transposed format better utilizes the sparsity pattern of the full PDF for compression.</p>
<p>Following <xref ref-type="bibr" rid="pcbi.1003359-Samoilov1">[65]</xref>, we consider <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e573" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e574" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e575" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e576" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e577" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e578" xlink:type="simple"/></inline-formula>. For initial value we take <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e579" xlink:type="simple"/></inline-formula>. We consider the FSP projection with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e580" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e581" xlink:type="simple"/></inline-formula>, i.e. with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e582" xlink:type="simple"/></inline-formula> states. We present 4 runs: (A), (B) and (C) use the transposed QTT format, and (D), the standard QTT. Theorems 5 and 4 bound the exact QTT ranks of the CME operator by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e583" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e584" xlink:type="simple"/></inline-formula> respectively, and numerically for accuracy <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e585" xlink:type="simple"/></inline-formula> we have <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e586" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e587" xlink:type="simple"/></inline-formula> in (A)–(C) and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e588" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e589" xlink:type="simple"/></inline-formula> in (D). We compute the evolution of the PDF up to time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e590" xlink:type="simple"/></inline-formula> with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e591" xlink:type="simple"/></inline-formula> time steps.</p>
<p>For the runs (A) and (D), which differ in the format, we keep the same accuracy parameters. The runs (B) and (C) use the same format as (A), but different accuracy parameters, so that they yield, respectively, a more accurate and a cruder solution as compared to (A).</p>
<p>This experiment shows, in particular, that lower ranks of the operator do not necessarily lead to lower ranks of the solution, and that in this example the transposed QTT format actually ensures smaller ranks of the solution than the QTT format without transposition does and than Theorem 5 suggests. As for the solution, we observe that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e592" xlink:type="simple"/></inline-formula> reaches <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e593" xlink:type="simple"/></inline-formula> for (A) and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e594" xlink:type="simple"/></inline-formula> for (D).</p>
<p>For every <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e595" xlink:type="simple"/></inline-formula>, we validate our solution <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e596" xlink:type="simple"/></inline-formula> by comparing its marginal distribution <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e597" xlink:type="simple"/></inline-formula> to that based on <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e598" xlink:type="simple"/></inline-formula> Monte Carlo simulations (every 10000 draws taking at least 110 seconds, amounting to the overall CPU time over <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e599" xlink:type="simple"/></inline-formula> seconds). The discrepancy <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e600" xlink:type="simple"/></inline-formula> in the marginal distribution with respect to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e601" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e602" xlink:type="simple"/></inline-formula> is reported for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e603" xlink:type="simple"/></inline-formula> in <xref ref-type="fig" rid="pcbi-1003359-g007">Figure 7 (a)</xref> and <xref ref-type="table" rid="pcbi-1003359-t003">Table 3</xref>. With <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e604" xlink:type="simple"/></inline-formula> we use it for the discrepancy-based truncation, which, as <xref ref-type="fig" rid="pcbi-1003359-g007">Figure 7 (b)</xref> shows, does not affect the probability deficiency significantly.</p>
<fig id="pcbi-1003359-g007" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003359.g007</object-id><label>Figure 7</label><caption>
<title>Enzymatic futile cycle.</title>
<p>The values are given vs. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e605" xlink:type="simple"/></inline-formula>. Markers are omitted for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e606" xlink:type="simple"/></inline-formula> in (a)–(c). (a) Discrepancy <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e607" xlink:type="simple"/></inline-formula> (before truncation) from the marginal PDF based on Monte Carlo simulations. (b) Probability deficiency <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e608" xlink:type="simple"/></inline-formula>. (c) Cumulative computation time (sec.) (d) Relative norm <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e609" xlink:type="simple"/></inline-formula> of the derivative.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003359.g007" position="float" xlink:type="simple"/></fig><table-wrap id="pcbi-1003359-t003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003359.t003</object-id><label>Table 3</label><caption>
<title>Enzymatic futile cycle: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e610" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e611" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e612" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e613" xlink:type="simple"/></inline-formula> are given for the truncated solution <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e614" xlink:type="simple"/></inline-formula>; computational <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e615" xlink:type="simple"/></inline-formula> is given in seconds; <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e616" xlink:type="simple"/></inline-formula>.</title>
</caption><alternatives><graphic id="pcbi-1003359-t003-3" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003359.t003" xlink:type="simple"/>
<table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" rowspan="1" colspan="1">run</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e617" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><italic>r</italic><sub>eff</sub></td>
<td align="left" rowspan="1" colspan="1"><italic>r</italic><sub>max</sub></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e618" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">ERR<sub>Σ</sub></td>
<td align="left" rowspan="1" colspan="1">TIME</td>
</tr>
</thead>
<tbody>
<tr>
<td colspan="7" align="center" rowspan="1"><italic>m</italic> = 210, <italic>t<sub>m</sub></italic> = 0.1</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">(A)</td>
<td align="left" rowspan="1" colspan="1">3.5<sub>−<bold>4</bold></sub></td>
<td align="left" rowspan="1" colspan="1">13.17</td>
<td align="left" rowspan="1" colspan="1">27</td>
<td align="left" rowspan="1" colspan="1">5.7<sub>−<bold>4</bold></sub></td>
<td align="left" rowspan="1" colspan="1">2.3<sub>−<bold>5</bold></sub></td>
<td align="left" rowspan="1" colspan="1">1.07<sub>3</sub></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">(B)</td>
<td align="left" rowspan="1" colspan="1">6.5<sub>−<bold>5</bold></sub></td>
<td align="left" rowspan="1" colspan="1">12.14</td>
<td align="left" rowspan="1" colspan="1">25</td>
<td align="left" rowspan="1" colspan="1">4.6<sub>−<bold>5</bold></sub></td>
<td align="left" rowspan="1" colspan="1">6.1<sub>−<bold>7</bold></sub></td>
<td align="left" rowspan="1" colspan="1">1.60<bold><sub>3</sub></bold></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">(C)</td>
<td align="left" rowspan="1" colspan="1">1.3<sub>−<bold>1</bold></sub></td>
<td align="left" rowspan="1" colspan="1">12.16</td>
<td align="left" rowspan="1" colspan="1">24</td>
<td align="left" rowspan="1" colspan="1">2.3<sub>−<bold>3</bold></sub></td>
<td align="left" rowspan="1" colspan="1">2.1<sub>−<bold>3</bold></sub></td>
<td align="left" rowspan="1" colspan="1">9.87<bold><sub>2</sub></bold></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">(D)</td>
<td align="left" rowspan="1" colspan="1">4.1<sub>−<bold>4</bold></sub></td>
<td align="left" rowspan="1" colspan="1">60.06</td>
<td align="left" rowspan="1" colspan="1">109</td>
<td align="left" rowspan="1" colspan="1">1.1<sub>−<bold>4</bold></sub></td>
<td align="left" rowspan="1" colspan="1">1.0<sub>−<bold>4</bold></sub></td>
<td align="left" rowspan="1" colspan="1">9.23<bold><sub>3</sub></bold></td>
</tr>
<tr>
<td colspan="7" align="center" rowspan="1"><italic>m</italic> = <italic>M</italic> = 1322, <italic>t<sub>m</sub></italic> = <italic>T</italic> = 1</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">(A)</td>
<td align="left" rowspan="1" colspan="1">1.8<sub>−<bold>4</bold></sub></td>
<td align="left" rowspan="1" colspan="1">13.66</td>
<td align="left" rowspan="1" colspan="1">27</td>
<td align="left" rowspan="1" colspan="1">7.2<sub>−<bold>5</bold></sub></td>
<td align="left" rowspan="1" colspan="1">2.5<sub>−<bold>5</bold></sub></td>
<td align="left" rowspan="1" colspan="1">3.70<bold><sub>3</sub></bold></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">(B)</td>
<td align="left" rowspan="1" colspan="1">1.1<sub>−<bold>5</bold></sub></td>
<td align="left" rowspan="1" colspan="1">12.06</td>
<td align="left" rowspan="1" colspan="1">25</td>
<td align="left" rowspan="1" colspan="1">5.7<sub>−<bold>5</bold></sub></td>
<td align="left" rowspan="1" colspan="1">6.2<sub>−<bold>7</bold></sub></td>
<td align="left" rowspan="1" colspan="1">4.21<bold><sub>3</sub></bold></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">(C)</td>
<td align="left" rowspan="1" colspan="1">2.5<sub>−<bold>2</bold></sub></td>
<td align="left" rowspan="1" colspan="1">12.85</td>
<td align="left" rowspan="1" colspan="1">24</td>
<td align="left" rowspan="1" colspan="1">3.3<sub>−<bold>3</bold></sub></td>
<td align="left" rowspan="1" colspan="1">1.3<sub>−<bold>3</bold></sub></td>
<td align="left" rowspan="1" colspan="1">4.03<bold><sub>3</sub></bold></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">(D)</td>
<td align="left" rowspan="1" colspan="1">3.7<sub>−<bold>4</bold></sub></td>
<td align="left" rowspan="1" colspan="1">58.97</td>
<td align="left" rowspan="1" colspan="1">107</td>
<td align="left" rowspan="1" colspan="1">1.7<sub>−<bold>4</bold></sub></td>
<td align="left" rowspan="1" colspan="1">1.7<sub>−<bold>4</bold></sub></td>
<td align="left" rowspan="1" colspan="1">1.52<bold><sub>4</sub></bold></td>
</tr>
</tbody>
</table>
</alternatives><table-wrap-foot><fn id="nt103"><label/><p>The exponents are given in boldface for the base <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e619" xlink:type="simple"/></inline-formula>.</p></fn></table-wrap-foot></table-wrap>
<p><xref ref-type="fig" rid="pcbi-1003359-g007">Figure 7 (a)</xref> shows that the refined run (B) yields the smallest discrepancy, which suggests that the reference distribution is sufficiently accurate to allow for the discrepancy to represent the actual error in the results of (A), (B) and (C). As we can see from <xref ref-type="fig" rid="pcbi-1003359-g007">Figure 7 (d)</xref>, in all 4 runs the time derivative stagnates after <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e620" xlink:type="simple"/></inline-formula>, at lower levels for more accurate runs. Let us note that at that stage in (A)–(C) it exhibits relatively strong oscillations compared to (D), which happens due to different effect of the addition of random components in the DMRG solver in the presence and absence of the transposition. On the other hand, compared to (A), the run (D) yields a less accurate solution and reaches <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e621" xlink:type="simple"/></inline-formula> almost <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e622" xlink:type="simple"/></inline-formula> times later, the accuracy settings being the same in these two runs. In all, the transposition appears to make the QTT format far more efficient in this experiment, and we expect it to be even more so in larger systems of such type.</p>
<p>The results are given in <xref ref-type="fig" rid="pcbi-1003359-g007">Figures 7</xref> and <xref ref-type="fig" rid="pcbi-1003359-g008">8</xref> and in <xref ref-type="table" rid="pcbi-1003359-t003">Table 3</xref>. <xref ref-type="fig" rid="pcbi-1003359-g005">Figure 5 (b)</xref> presents a snapshot of the marginal distribution.</p>
<fig id="pcbi-1003359-g008" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003359.g008</object-id><label>Figure 8</label><caption>
<title>Enzymatic futile cycle.</title>
<p>QTT ranks of the solution. The values are given vs. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e623" xlink:type="simple"/></inline-formula>. Markers are omitted for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e624" xlink:type="simple"/></inline-formula>. (a) Effective QTT ranks <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e625" xlink:type="simple"/></inline-formula> for parameter set (A). (b) Maximum QTT ranks <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e626" xlink:type="simple"/></inline-formula> for parameter set (A). (c) Effective QTT ranks <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e627" xlink:type="simple"/></inline-formula> for parameter set (D). (d) Maximum QTT ranks <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e628" xlink:type="simple"/></inline-formula> for parameter set (D).</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003359.g008" position="float" xlink:type="simple"/></fig></sec></sec><sec id="s3h">
<title>Conclusion</title>
<p>We presented a novel, “ab-initio” computational methodology for the direct numerical solution of the CME. The methodology exploits the time-analytic nature of solutions to the CME and the low-rank, tensor structure of the CME operator by combining an <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e629" xlink:type="simple"/></inline-formula>-timestepping method that is order and step size adaptive, unconditionally stable and exponentially convergent with respect to the number of time discretization parameters, with novel, tensor-formatted linear algebra techniques for the numerical realization of the method. In particular, after an initial projection on a (sufficiently rich) finite state, the QTT representation allows for the dynamic adaptation of the effective state-space size, as well as of the principal components, or basis elements of the numerical representation of solution vectors in the numerical simulation of the time evolution of the CME solution. We emphasize that, while the performance of our approach is better when the solution can be approximated in the QTT format with a high degree of separability of the “physical” and “virtual” variables (i.e. with low TT ranks), the approach does not require a particular degree of separability, but instead reveals possibly present low TT rank in the solution at runtime. In the course of rank adaptation, the singular vectors, in the span of which the solution is approximated, are also adapted. Hence, the presently proposed approach is superior to fixed basis approaches (even when used with adaptivity), such as those reported in <xref ref-type="bibr" rid="pcbi.1003359-Hellander1">[19]</xref>, <xref ref-type="bibr" rid="pcbi.1003359-Engblom1">[22]</xref>, <xref ref-type="bibr" rid="pcbi.1003359-Deuflhard1">[23]</xref>, <xref ref-type="bibr" rid="pcbi.1003359-Jahnke5">[66]</xref>. The precise class of chemical reaction networks that lead to low TT rank in the solution tensor is currently unknown. To the extent that this rank increase during runtime, the effectiveness of the compression will be decreased, which could prove limiting for some problems. However, in this case other methods will be equally challenged. Identifying the architecture of the chemical reaction networks that lead to very low ranks is currently a research problem under investigation.</p>
<p>While the discussion following Theorem 4 relates to the case when the factors of the propensity functions are monomial, the approach presented herein applies equally well to models with propensity functions that are merely smooth enough. For example <xref ref-type="bibr" rid="pcbi.1003359-Kazeev2">[67]</xref>, gives bounds on the QTT ranks of the propensity functions and CME operator in the case of the stochastic mass-action and Michaelis–Menten kinetics with separable propensity functions. Also, the same work proves the bounds on the QTT ranks of product-form stationary distributions <xref ref-type="bibr" rid="pcbi.1003359-Anderson1">[68]</xref> of <italic>weakly-reversible</italic> reaction networks of <italic>zero deficiency in the sense of Feinberg</italic> <xref ref-type="bibr" rid="pcbi.1003359-Feinberg1">[69]</xref>. Those bounds explain some of the experimental observations made in the present paper. Furthermore, the approach proposed is suitable for non-separable propensity functions. However, in that case the characterization of the rank structure of the CME operator needs to rely on some extra assumptions ensuring moderate QTT ranks, even though more general than separability, and Algorithm 1 needs to be altered accordingly.</p>
<p>The performance of the approach proposed essentially relies on the efficiency of the numerical solution of TT-structured linear systems of equations. In particular, a globally (or “less strictly locally”) convergent iterative solver would allow us to take larger time steps and to exploit the exponential convergence of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e630" xlink:type="simple"/></inline-formula>-DG time discretization. We believe that while the presently reported numerical results which were obtained with the DMRG solver are quite encouraging, ongoing research on TT-structured linear system solvers holds the promise for a substantial efficiency increase of the present methodology. We only mention a family of alternating minimal energy methods which was announced very recently in <xref ref-type="bibr" rid="pcbi.1003359-Dolgov2">[70]</xref>.</p>
<p>We also mention that, of course, the choice of the tensor format and, possibly, index ordering, has an essential impact on the performance of the approach. The computational experiments reported in the present paper show that even a straightforward permutation of “virtual” indices produced by quantization may allow to exploit additional structure in the data and the QTT formatted CME solution and, therefore, may improve the performance of the QTT-structured approach dramatically. We point out that the TT format can be considered as a special case of <italic>tensor network states</italic>: TT formatted tensors belong to the class of simple, rooted tree-type tensor networks. Relating the architecture of the chemical reaction networks and appropriate tensor networks representing its states efficiently, i.e. with low ranks, is currently a research problem under development. The results of <xref ref-type="bibr" rid="pcbi.1003359-Kazeev2">[67]</xref> mentioned above can be considered as the first step in this direction.</p>
<p>A general discussion of tensor networks and their use in numerical simulations for quantum spin systems can be found in <xref ref-type="bibr" rid="pcbi.1003359-Verstraete2">[71]</xref>, <xref ref-type="bibr" rid="pcbi.1003359-Cirac1">[72]</xref>. As for the numerical solution of the CME, particular real-life problems might require more sophisticated tensor networks to be used to efficiently approximate reachable states of the systems in question. The mathematical investigation of the relative merits and drawbacks of tensor formats for particular applications is currently undergoing rather active development; we mention only the recent monograph <xref ref-type="bibr" rid="pcbi.1003359-Hackbusch1">[40]</xref> and the references there.</p>
<p>We finally mention that recently, and independently, TT formatted linear algebra methods for the CME were proposed in <xref ref-type="bibr" rid="pcbi.1003359-Dolgov3">[73]</xref>; a low order time stepping, and no transposition of tensor trains was used in that work. The CME examples presented in <xref ref-type="bibr" rid="pcbi.1003359-Dolgov3">[73]</xref> also included a toggle switch, but the authors mostly rely on the intrinsic convergence of their method without analyzing actual accuracies. The latter are reported only for moderate sized examples which are computationally tractable with the direct approach in the full format. However, no attempt is made to analyze the accuracy in comparison to other simulation methods, which are typically applied to larger problems featuring essential difficulties for the direct approach. In the present paper we give comparisons with a state-of-the-art, massively parallel stochastic simulation package. This allows us, on the one hand, to validate the accuracy of the QTT-based solutions obtained here and, on the other hand, to provide evidence of the dramatic increase in efficiency afforded by the new deterministic approach: Monte Carlo simulations on 1500 cores of a high-performance cluster were matched in accuracy and outperformed in the wall-clock time by a MATLAB implementation running on a notebook.</p>
</sec></sec><sec id="s4" sec-type="methods">
<title>Methods</title>
<p>To solve the initial value problem for (2), we exploit the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e631" xlink:type="simple"/></inline-formula>-DG-QTT algorithm proposed in <xref ref-type="bibr" rid="pcbi.1003359-Kazeev1">[38]</xref> and adapted to the CME as described above, implemented in MATLAB. It uses an implicit, exponentially convergent spectral time discretization of discontinuous Galerkin type. The resulting, time-discrete CME in “species space” is solved in the QTT format. Our implementation relies on the public domain <italic>TT Toolbox</italic> which provides basic TT-structured operations and solvers for linear systems in the QTT format. The TT toolbox is publicly available at <ext-link ext-link-type="uri" xlink:href="http://spring.inm.ras.ru/osel" xlink:type="simple">http://spring.inm.ras.ru/osel</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://github.com/oseledets/TT-Toolbox" xlink:type="simple">http://github.com/oseledets/TT-Toolbox</ext-link>; to be consistent, we use the GitHub version of July 12, 2012 in all examples below. We run the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e632" xlink:type="simple"/></inline-formula>-DG-QTT solver in MATLAB 7.12.0.635 (R2011a) on a laptop with a 2.7 GHz dual-core processor and 4 GB RAM, and report the computational time in seconds.</p>
<p>For the solution of the large, linear systems in the QTT and QT3 formats in each time step, we use the optimization solver, based on the DMRG approach <xref ref-type="bibr" rid="pcbi.1003359-White1">[46]</xref>–<xref ref-type="bibr" rid="pcbi.1003359-Vidal1">[48]</xref> and elaborated on in the context of the TT format in <xref ref-type="bibr" rid="pcbi.1003359-Oseledets7">[74]</xref> and available as the function dmrg_solve3 of the TT Toolbox. While the “DMRG” solver still lacks a rigorous theoretical foundation, it proves to be highly efficient in many applications, including our experiments. In <xref ref-type="bibr" rid="pcbi.1003359-Rohwedder1">[75]</xref> a closely related <italic>Alternating Least Squares (ALS)</italic> approach was mathematically analyzed and shown to converge locally. More on the mathematical ideas behind the ALS and DMRG optimization in the TT format can be found in <xref ref-type="bibr" rid="pcbi.1003359-Holtz1">[76]</xref>.</p>
<p>The “DMRG” solver, under certain restrictions on the time step, manages to find a parsimonious QTT formatted solution of the linear system (up to a specified tolerance). Moreover, the solver in effect automatically adapts both the QTT rank as well as the QTT “basis” of the solution at every time step guaranteeing that it is sufficiently rich in order to capture the principal dynamics of interest.</p>
<p>In the first numerical example the solution is symmetric and exactly rank-one separable, which allows us to use the standard MATLAB solver ode15 s in the sparse format to obtain the univariate factor of a reference solution. In other examples we used SPSens beta 3.4, a massively parallel package for the stochastic simulation of chemical networks (<ext-link ext-link-type="uri" xlink:href="http://sourceforge.net/projects/spsens/" xlink:type="simple">http://sourceforge.net/projects/spsens/</ext-link>) <xref ref-type="bibr" rid="pcbi.1003359-Sheppard1">[77]</xref>, to construct reference PDFs. The stochastic simulations were carried out on up to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003359.e633" xlink:type="simple"/></inline-formula> cores of Brutus, a high-performance cluster of ETH Zürich (<ext-link ext-link-type="uri" xlink:href="https://www1.ethz.ch/id/services/list/comp_zentral/cluster/index_EN" xlink:type="simple">https://www1.ethz.ch/id/services/list/comp_zentral/cluster/index_EN</ext-link>).</p>
</sec><sec id="s5">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1003359.s001" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003359.s001" position="float" xlink:type="simple"><label>Text S1</label><caption>
<p>Supplementary Material for direct solution of the Chemical Master Equations using Quantized Tensor Trains.</p>
<p>(PDF)</p>
</caption></supplementary-material></sec></body>
<back><ref-list>
<title>References</title>
<ref id="pcbi.1003359-Elowitz1"><label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Elowitz</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Levine</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Siggia</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Swain</surname><given-names>P</given-names></name> (<year>2002</year>) <article-title>Stochastic gene expression in a single cell</article-title>. <source>Nature</source> <volume>297</volume>: <fpage>1183</fpage>–<lpage>1186</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-McAdams1"><label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>McAdams</surname><given-names>HH</given-names></name>, <name name-style="western"><surname>Arkin</surname><given-names>A</given-names></name> (<year>1997</year>) <article-title>Stochastic mechanisms in gene expression</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source> <volume>94</volume>: <fpage>814</fpage>–<lpage>819</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Gillespie1"><label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gillespie</surname><given-names>DT</given-names></name> (<year>1976</year>) <article-title>A general method for numerically simulating the stochastic time evolution of coupled chemical reactions</article-title>. <source>Journal of Computational Physics</source> <volume>22</volume>: <fpage>403</fpage>–<lpage>434</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Jahnke1"><label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jahnke</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Huisinga</surname><given-names>W</given-names></name> (<year>2007</year>) <article-title>Solving the chemical master equation for monomolecular reaction systems analytically</article-title>. <source>Journal of Mathematical Biology</source> <volume>54</volume>: <fpage>1</fpage>–<lpage>26</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Munsky1"><label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Munsky</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Khammash</surname><given-names>M</given-names></name> (<year>2006</year>) <article-title>The finite state projection algorithm for the solution of the chemical master equation</article-title>. <source>The Journal of Chemical Physics</source> <volume>124</volume>: <fpage>044104</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Henzinger1"><label>6</label>
<mixed-citation publication-type="other" xlink:type="simple">Henzinger T, Mateescu M, Wolf V (2009) Sliding window abstraction for infinite markov chains. In: Bouajjani A, Maler O, editors, Computer Aided Verification, Springer Berlin/Heidelberg, volume 5643 of <italic>Lecture Notes in Computer Science</italic>. pp. 337–352. URL <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/978-3-642-02658-427" xlink:type="simple">http://dx.doi.org/10.1007/978-3-642-02658-422 7</ext-link>. 10.1007/978-3-642-02658-4-27.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Cao1"><label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cao</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Liang</surname><given-names>J</given-names></name> (<year>2008</year>) <article-title>Optimal enumeration of state space of finitely buffered stochastic molecular networks and exact computation of steady state landscape probability</article-title>. <source>BMC Systems Biology</source> <volume>2</volume>: <fpage>30</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Cao2"><label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cao</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Lu</surname><given-names>HM</given-names></name>, <name name-style="western"><surname>Liang</surname><given-names>J</given-names></name> (<year>2010</year>) <article-title>Probability landscape of heritable and robust epigenetic state of lysogeny in phage lambda</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source> <volume>107</volume>: <fpage>18445</fpage>–<lpage>18450</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Gibson1"><label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gibson</surname><given-names>MA</given-names></name>, <name name-style="western"><surname>Bruck</surname><given-names>J</given-names></name> (<year>2000</year>) <article-title>Efficient exact stochastic simulation of chemical systems with many species and many channels</article-title>. <source>The Journal of Physical Chemistry A</source> <volume>104</volume>: <fpage>1876</fpage>–<lpage>1889</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Gillespie2"><label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gillespie</surname><given-names>DT</given-names></name> (<year>2001</year>) <article-title>Approximate accelerated stochastic simulation of chemically reacting systems</article-title>. <source>The Journal of Chemical Physics</source> <volume>115</volume>: <fpage>1716</fpage>–<lpage>1733</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Hespanha1"><label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hespanha</surname><given-names>JP</given-names></name>, <name name-style="western"><surname>Singh</surname><given-names>A</given-names></name> (<year>2005</year>) <article-title>Stochastic models for chemically reacting systems using polynomial stochastic hybrid systems</article-title>. <source>Int J on Robust Control, Special Issue on Control at Small Scales</source> <volume>Issue 1 15</volume>: <fpage>669</fpage>–<lpage>689</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-GomezUribe1"><label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gomez-Uribe</surname><given-names>CA</given-names></name>, <name name-style="western"><surname>Verghese</surname><given-names>GC</given-names></name> (<year>2007</year>) <article-title>Mass fluctuation kinetics: Capturing stochastic effects in systems of chemical reactions through coupled mean-variance computations</article-title>. <source>The Journal of Chemical Physics</source> <volume>126</volume>: <fpage>024109</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-vanKampen1"><label>13</label>
<mixed-citation publication-type="book" xlink:type="simple">van Kampen NG (1992) Stochastic Processes in Physics and Chemistry. Amsterdam and New York: North-Holland.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Gillespie3"><label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gillespie</surname><given-names>DT</given-names></name> (<year>2000</year>) <article-title>The chemical langevin equation</article-title>. <source>The Journal of Chemical Physics</source> <volume>113</volume>: <fpage>297</fpage>–<lpage>306</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Ethier1"><label>15</label>
<mixed-citation publication-type="book" xlink:type="simple">Ethier SN, Kurtz TG (2005) Markov Processes: Characterization and Convergence. New York: Wiley-Interscience.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Puchalka1"><label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Puchalka</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Kierzek</surname><given-names>AM</given-names></name> (<year>2004</year>) <article-title>Bridging the gap between stochastic and deterministic regimes in the kinetic simulations of the biochemical reaction networks</article-title>. <source>Biophysical Journal</source> <volume>86</volume>: <fpage>1357</fpage>–<lpage>1372</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Haseltine1"><label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Haseltine</surname><given-names>EL</given-names></name>, <name name-style="western"><surname>Rawlings</surname><given-names>JB</given-names></name> (<year>2002</year>) <article-title>Approximate simulation of coupled fast and slow reactions for stochastic chemical kinetics</article-title>. <source>The Journal of Chemical Physics</source> <volume>117</volume>: <fpage>6959</fpage>–<lpage>6969</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Salis1"><label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Salis</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Kaznessis</surname><given-names>Y</given-names></name> (<year>2005</year>) <article-title>Accurate hybrid stochastic simulation of a system of coupled chemical or biochemical reactions</article-title>. <source>The Journal of Chemical Physics</source> <volume>122</volume>: <fpage>054103</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Hellander1"><label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hellander</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Lotstedt</surname><given-names>P</given-names></name> (<year>2007</year>) <article-title>Hybrid method for the chemical master equation</article-title>. <source>Journal of Computational Physics</source> <volume>227</volume>: <fpage>100</fpage>–<lpage>122</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Jahnke2"><label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jahnke</surname><given-names>T</given-names></name> (<year>2011</year>) <article-title>On reduced models for the chemical master equation</article-title>. <source>Multiscale Modeling and Simulation</source> <volume>9</volume>: <fpage>1646</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Nip1"><label>21</label>
<mixed-citation publication-type="other" xlink:type="simple">Nip M, Hespanha J, Khammash M (2012) A spectral methods-based solution of the chemical master equation for gene regulatory networks. In: Decision and Control (CDC), 2012 IEEE 51st Annual Conference on. pp. 5354–5360. doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/CDC.2012.6425804" xlink:type="simple">10.1109/CDC.2012.6425804</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Engblom1"><label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Engblom</surname><given-names>S</given-names></name> (<year>2009</year>) <article-title>Spectral approximation of solutions to the chemical master equation</article-title>. <source>Journal of Computational and Applied Mathematics</source> <volume>229</volume>: <fpage>208</fpage>–<lpage>221</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Deuflhard1"><label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Deuflhard</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Huisinga</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Jahnke</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Wulkow</surname><given-names>M</given-names></name> (<year>2008</year>) <article-title>Adaptive discrete Galerkin methods applied to the chemical master equation</article-title>. <source>SIAM Journal on Scientific Computing</source> <volume>30</volume>: <fpage>2990</fpage>–<lpage>3011</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Hegland1"><label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hegland</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Burden</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Santoso</surname><given-names>L</given-names></name>, <name name-style="western"><surname>MacNamara</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Booth</surname><given-names>H</given-names></name> (<year>2007</year>) <article-title>A solver for the stochastic master equation applied to gene regulatory networks</article-title>. <source>Journal of Computational and Applied Mathematics</source> <volume>205</volume>: <fpage>708</fpage>–<lpage>724</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Jahnke3"><label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jahnke</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Udrescu</surname><given-names>T</given-names></name> (<year>2010</year>) <article-title>Solving chemical master equations by adaptive wavelet compression</article-title>. <source>Journal of Computational Physics</source> <volume>229</volume>: <fpage>5724</fpage>–<lpage>5741</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Bellman1"><label>26</label>
<mixed-citation publication-type="book" xlink:type="simple">Bellman R, (1961) Adaptive Control Processes: A Guided Tour. Princeton, NJ: Princeton University Press.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Hitchcock1"><label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hitchcock</surname><given-names>FL</given-names></name> (<year>1926</year>) <article-title>The expression of a tensor or a polyadic as a sum of products</article-title>. <source>Journal of Mathematics and Physics</source> <volume>6</volume>: <fpage>164</fpage>–<lpage>189</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Caroll1"><label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Caroll</surname><given-names>JD</given-names></name>, <name name-style="western"><surname>Chang</surname><given-names>JJ</given-names></name> (<year>1970</year>) <article-title>Analysis of individual differences in multidimensional scaling via an n-way generalization of “Eckart-Young” decomposition</article-title>. <source>Psychometrika</source> <volume>35</volume>: <fpage>283</fpage>–<lpage>319</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Hegland2"><label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hegland</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Garcke</surname><given-names>J</given-names></name> (<year>2011</year>) <article-title>On the numerical solution of the chemical master equation with sums of rank one tensors</article-title>. <source>ANZIAM Journal</source> <volume>52</volume>: <fpage>C628</fpage>–<lpage>C643</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-deSilva1"><label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>de Silva</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Lim</surname><given-names>LH</given-names></name> (<year>2008</year>) <article-title>Tensor rank and the ill-posedness of the best low-rank approximation problem</article-title>. <source>SIAM Journal on Matrix Analysis and Applications</source> <volume>30</volume>: <fpage>1084</fpage>–<lpage>1127</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Hstad1"><label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Håstad</surname><given-names>J</given-names></name> (<year>1990</year>) <article-title>Tensor rank is NP-complete</article-title>. <source>Journal of Algorithms</source> <volume>11</volume>: <fpage>644</fpage>–<lpage>654</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Hillar1"><label>32</label>
<mixed-citation publication-type="other" xlink:type="simple">Hillar C, Lim LH (2009) Most tensor problems are NP hard. arXiv abs/0911.1393.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Jahnke4"><label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jahnke</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Huisinga</surname><given-names>W</given-names></name> (<year>2008</year>) <article-title>A dynamical low-rank approach to the chemical master equation</article-title>. <source>Bulletin of Mathematical Biology</source> <volume>70</volume>: <fpage>2283</fpage>–<lpage>2302</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Oseledets1"><label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Oseledets</surname><given-names>IV</given-names></name>, <name name-style="western"><surname>Tyrtyshnikov</surname><given-names>EE</given-names></name> (<year>2009</year>) <article-title>Breaking the curse of dimensionality, or how to use SVD in many dimensions</article-title>. <source>SIAM Journal on Scientific Computing</source> <volume>31</volume>: <fpage>3744</fpage>–<lpage>3759</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Oseledets2"><label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Oseledets</surname><given-names>I</given-names></name> (<year>2009</year>) <article-title>Approximation of matrices with logarithmic number of parameters</article-title>. <source>Doklady Mathematics</source> <volume>80</volume>: <fpage>653</fpage>–<lpage>654</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Oseledets3"><label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Oseledets</surname><given-names>IV</given-names></name> (<year>2010</year>) <article-title>Approximation of 2<italic><sup>d</sup></italic>×2<italic><sup>d</sup></italic> matrices using tensor decomposition</article-title>. <source>SIAM Journal on Matrix Analysis and Applications</source> <volume>31</volume>: <fpage>2130</fpage>–<lpage>2145</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Khoromskij1"><label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Khoromskij</surname><given-names>BN</given-names></name> (<year>2011</year>) <article-title>&lt;$&gt;\scale 80%\raster="rg4"\&lt;$&gt; (<italic>d</italic> log <italic>n</italic>)-quantics approximation of <italic>n-d</italic> tensors in high-dimensional numerical modeling</article-title>. <source>Constructive Approximation</source> <volume>34</volume>: <fpage>257</fpage>–<lpage>280</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Kazeev1"><label>38</label>
<mixed-citation publication-type="other" xlink:type="simple">Kazeev V, Reichmann O, Schwab C (2012) <italic>hp</italic>-DG-QTT solution of high-dimensional degenerate diffusion equations. Research Report 11, Seminar for Applied Mathematics, ETH Zürich. URL <ext-link ext-link-type="uri" xlink:href="http://www.sam.math.ethz.ch/reports/2012/11" xlink:type="simple">http://www.sam.math.ethz.ch/reports/2012/11</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Kolda1"><label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kolda</surname><given-names>TG</given-names></name>, <name name-style="western"><surname>Bader</surname><given-names>BW</given-names></name> (<year>2009</year>) <article-title>Tensor decompositions and applications</article-title>. <source>SIAM Review</source> <volume>51</volume>: <fpage>455</fpage>–<lpage>500</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Hackbusch1"><label>40</label>
<mixed-citation publication-type="other" xlink:type="simple">Hackbusch W (2012) Tensor Spaces and Numerical Tensor Calculus, volume 42 of <italic>Springer Series in Computational Mathematics.</italic> <italic>Springer</italic>. <italic>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/978-3-642-28027-6" xlink:type="simple">10.1007/978-3-642-28027-6</ext-link>. URL</italic> <ext-link ext-link-type="uri" xlink:href="http://www.springerlink.com/content/l62t86" xlink:type="simple">http://www.springerlink.com/content/l62t86</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Oseledets4"><label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Oseledets</surname><given-names>IV</given-names></name> (<year>2011</year>) <article-title>Tensor Train decomposition</article-title>. <source>SIAM Journal on Scientific Computing</source> <volume>33</volume>: <fpage>2295</fpage>–<lpage>2317</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Oseledets5"><label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Oseledets</surname><given-names>I</given-names></name> (<year>2013</year>) <article-title>Constructive representation of functions in low-rank tensor formats</article-title>. <source>Constructive Approximation</source> <volume>37</volume>: <fpage>1</fpage>–<lpage>18</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Hackbusch2"><label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hackbusch</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Kühn</surname><given-names>S</given-names></name> (<year>2009</year>) <article-title>A new scheme for the tensor representation</article-title>. <source>Journal of Fourier Analysis and Applications</source> <volume>15</volume>: <fpage>706</fpage>–<lpage>722</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Grasedyck1"><label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Grasedyck</surname><given-names>L</given-names></name> (<year>2010</year>) <article-title>Hierarchical Singular Value Decomposition of tensors</article-title>. <source>SIAM Journal on Matrix Analysis and Applications</source> <volume>31</volume>: <fpage>2029</fpage>–<lpage>2054</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Grasedyck2"><label>45</label>
<mixed-citation publication-type="other" xlink:type="simple">Grasedyck L (2010) Polynomial approximation in Hierarchical Tucker Format by vectortensorization. Preprint 308, Institut für Geometrie und Praktische Mathematik, RWTH Aachen. URL <ext-link ext-link-type="uri" xlink:href="http://www.igpm.rwth-aachen.de/Download/reports/pdf/IGPM308k.pdf" xlink:type="simple">http://www.igpm.rwth-aachen.de/Download/reports/pdf/I GP M 308k.pdf</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-White1"><label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>White</surname><given-names>SR</given-names></name> (<year>1993</year>) <article-title>Density-matrix algorithms for quantum renormalization groups</article-title>. <source>Phys Rev B</source> <volume>48</volume>: <fpage>10345</fpage>–<lpage>10356</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Verstraete1"><label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Verstraete</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Porras</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Cirac</surname><given-names>JI</given-names></name> (<year>2004</year>) <article-title>Density matrix renormalization group and periodic boundary conditions: A quantum information perspective</article-title>. <source>Phys Rev Lett</source> <volume>93</volume>: <fpage>227205</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Vidal1"><label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Vidal</surname><given-names>G</given-names></name> (<year>2003</year>) <article-title>Efficient classical simulation of slightly entangled quantum computations</article-title>. <source>Phys Rev Lett</source> <volume>91</volume>: <fpage>147902</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Ballani1"><label>49</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ballani</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Grasedyck</surname><given-names>L</given-names></name> (<year>2013</year>) <article-title>A projection method to solve linear systems in tensor format</article-title>. <source>Numerical Linear Algebra with Applications</source> <volume>20</volume>: <fpage>27</fpage>–<lpage>43</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Kressner1"><label>50</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kressner</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Tobler</surname><given-names>C</given-names></name> (<year>2011</year>) <article-title>Preconditioned low-rank methods for high-dimensional elliptic PDE eigenvalue problems</article-title>. <source>Computational Methods in Applied Mathematics</source> <volume>11</volume>: <fpage>363</fpage>–<lpage>381</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Dolgov1"><label>51</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dolgov</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Khoromskij</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Oseledets</surname><given-names>I</given-names></name> (<year>2012</year>) <article-title>Fast solution of parabolic problems in the tensor train/quantized tensor train format with initial application to the fokker–planck equation</article-title>. <source>SIAM Journal on Scientific Computing</source> <volume>34</volume>: <fpage>A3016</fpage>–<lpage>A3038</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Kressner2"><label>52</label>
<mixed-citation publication-type="other" xlink:type="simple">Kressner D, Tobler C (2010) Low-rank tensor Krylov subspace methods for parametrized lin- ear systems. Research Report 16, Seminar for Applied Mathematics, ETH Zürich. URL <ext-link ext-link-type="uri" xlink:href="http://www.sam.math.ethz.ch/reports/2010/16" xlink:type="simple">http://www.sam.math.ethz.ch/reports/2010/16</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Khoromskij2"><label>53</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Khoromskij</surname><given-names>BN</given-names></name>, <name name-style="western"><surname>Schwab</surname><given-names>C</given-names></name> (<year>2011</year>) <article-title>Tensor-structured Galerkin approximation of parametric and stochastic elliptic PDEs</article-title>. <source>SIAM Journal on Scientific Computing</source> <volume>33</volume>: <fpage>364</fpage>–<lpage>385</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Tyrtyshnikov1"><label>54</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tyrtyshnikov</surname><given-names>EE</given-names></name> (<year>2003</year>) <article-title>Tensor approximations of matrices generated by asymptotically smooth functions</article-title>. <source>Sbornik: Mathematics</source> <volume>194</volume>: <fpage>941</fpage>–<lpage>954</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Oseledets6"><label>55</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Oseledets</surname><given-names>IV</given-names></name> (<year>2010</year>) <article-title>QTT decomposition of the characteristic function of a simplex</article-title>. <source>Personal communication</source></mixed-citation>
</ref>
<ref id="pcbi.1003359-Schotzau1"><label>56</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schotzau</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Schwab</surname><given-names>C</given-names></name> (<year>2000</year>) <article-title>An hp a priori error analysis of the DG time-stepping method for initial value problems</article-title>. <source>Calcolo</source> <volume>37</volume>: <fpage>207</fpage>–<lpage>232</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Saad1"><label>57</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Saad</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Schultz</surname><given-names>M</given-names></name> (<year>1986</year>) <article-title>Gmres: A generalized minimal residual algorithm for solving nonsym- metric linear systems</article-title>. <source>SIAM Journal on Scientific and Statistical Computing</source> <volume>7</volume>: <fpage>856</fpage>–<lpage>869</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Saad2"><label>58</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Saad</surname><given-names>Y</given-names></name> (<year>1992</year>) <article-title>Analysis of some krylov subspace approximations to the matrix exponential operator</article-title>. <source>SIAM Journal on Numerical Analysis</source> <volume>29</volume>: <fpage>209</fpage>–<lpage>228</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-MacNamara1"><label>59</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>MacNamara</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Burrage</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Sidje</surname><given-names>R</given-names></name> (<year>2008</year>) <article-title>Multiscale modeling of chemical kinetics via the master equation</article-title>. <source>Multiscale Modeling &amp; Simulation</source> <volume>6</volume>: <fpage>1146</fpage>–<lpage>1168</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Sidje1"><label>60</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sidje</surname><given-names>RB</given-names></name> (<year>1998</year>) <article-title>Expokit: a software package for computing matrix exponentials</article-title>. <source>ACM Trans Math Softw</source> <volume>24</volume>: <fpage>130</fpage>–<lpage>156</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Gardner1"><label>61</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gardner</surname><given-names>TS</given-names></name>, <name name-style="western"><surname>Cantor</surname><given-names>CR</given-names></name>, <name name-style="western"><surname>Collins</surname><given-names>JJ</given-names></name> (<year>2000</year>) <article-title>Construction of a genetic toggle switch in Escherichia coli</article-title>. <source>Nature</source> <volume>403</volume>: <fpage>339</fpage>–<lpage>342</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Munsky2"><label>62</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Munsky</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Khammash</surname><given-names>M</given-names></name> (<year>2008</year>) <article-title>The finite state projection approach for the analysis of stochastic noise in gene networks</article-title>. <source>Automatic Control, IEEE Transactions on</source> <volume>53</volume>: <fpage>201</fpage>–<lpage>214</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Sjberg1"><label>63</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sjöberg</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Lötstedt</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Elf</surname><given-names>J</given-names></name> (<year>2009</year>) <article-title>Fokker–Planck approximation of the master equation in molecular biology</article-title>. <source>Computing and Visualization in Science</source> <volume>12</volume>: <fpage>37</fpage>–<lpage>50</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Schwender1"><label>64</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schwender</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Ohlrogge</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Shachar-Hill</surname><given-names>Y</given-names></name> (<year>2004</year>) <article-title>Understanding flux in plant metabolic networks</article-title>. <source>Current Opinion in Plant Biology</source> <volume>7</volume>: <fpage>309</fpage>–<lpage>317</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Samoilov1"><label>65</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Samoilov</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Plyasunov</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Arkin</surname><given-names>AP</given-names></name> (<year>2005</year>) <article-title>Stochastic amplification and signaling in enzymatic futile cycles through noise-induced bistability with oscillations</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source> <volume>102</volume>: <fpage>2310</fpage>–<lpage>2315</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Jahnke5"><label>66</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jahnke</surname><given-names>T</given-names></name> (<year>2010</year>) <article-title>An adaptive wavelet method for the chemical master equation</article-title>. <source>SIAM Journal on Scientific Computing</source> <volume>31</volume>: <fpage>4373</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Kazeev2"><label>67</label>
<mixed-citation publication-type="other" xlink:type="simple">Kazeev V, Schwab C (2013) Tensor approximation of stationary distributions of chemical reaction networks. Research Report 18, Seminar for Applied Mathematics, ETH Zürich. URL <ext-link ext-link-type="uri" xlink:href="http://www.sam.math.ethz.ch/reports/2013/18" xlink:type="simple">http://www.sam.math.ethz.ch/reports/2013/18</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Anderson1"><label>68</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Anderson</surname><given-names>DF</given-names></name>, <name name-style="western"><surname>Craciun</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Kurtz</surname><given-names>TG</given-names></name> (<year>2010</year>) <article-title>Product-form stationary distributions for deficiency zero chemical reaction networks</article-title>. <source>Bulletin of Mathematical Biology</source> <volume>72</volume>: <fpage>1947</fpage>–<lpage>1970</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Feinberg1"><label>69</label>
<mixed-citation publication-type="other" xlink:type="simple">Feinberg M (1979). Lectures on chemical reaction networks.URL <ext-link ext-link-type="uri" xlink:href="http://www.chbmeng.ohio-state.edu/feinberg/LecturesOnReactionNetworks" xlink:type="simple">http://www.chbmeng.ohio-state.edu/feinberg/LecturesOnReactionNetworks</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Dolgov2"><label>70</label>
<mixed-citation publication-type="other" xlink:type="simple">Dolgov SV, Savostyanov DV (2013) Alternating minimal energy methods for linear sys- tems in higher dimensions. Part I: SPD systems. arXiv preprint 1301.6068. URL <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1301.6068" xlink:type="simple">http://arxiv.org/abs/1301.6068</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Verstraete2"><label>71</label>
<mixed-citation publication-type="other" xlink:type="simple">Verstraete F, Cirac JI, Murg V (2009) Matrix Product States, Projected Entangled Pair States, and variational renormalization group methods for quantum spin systems. arXiv preprint 0907.2796. URL <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/0907.2796" xlink:type="simple">http://arxiv.org/abs/0907.2796</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Cirac1"><label>72</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cirac</surname><given-names>JI</given-names></name>, <name name-style="western"><surname>Verstraete</surname><given-names>F</given-names></name> (<year>2009</year>) <article-title>Renormalization and tensor product states in spin chains and lattices</article-title>. <source>Journal of Physics A: Mathematical and Theoretical</source> <volume>42</volume>: <fpage>504004</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Dolgov3"><label>73</label>
<mixed-citation publication-type="other" xlink:type="simple">Dolgov SV, Khoromskij BN (2012) Tensor-product approach to global time- space-parametric discretization of chemical master equation. Preprint 68, Max-Planck-Institut für Mathematik in den Naturwissenschaften. URL <ext-link ext-link-type="uri" xlink:href="http://www.mis.mpg.de/publications/preprints/2012/prepr2012-68.html" xlink:type="simple">http://www.mis.mpg.de/publications/preprints/2012/prepr2012 – 68.html</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Oseledets7"><label>74</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Oseledets</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Dolgov</surname><given-names>S</given-names></name> (<year>2012</year>) <article-title>Solution of linear systems and matrix inversion in the tt-format</article-title>. <source>SIAM Journal on Scientific Computing</source> <volume>34</volume>: <fpage>A2718</fpage>–<lpage>A2739</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Rohwedder1"><label>75</label>
<mixed-citation publication-type="other" xlink:type="simple">Rohwedder T, Uschmajew A (2012) Local convergence of alternating schemes for optimization of convex problems in the TT format. Preprint 112, DFG-Schwerpunktprogramm 1324. URL <ext-link ext-link-type="uri" xlink:href="http://www.dfg-spp1324.de/download/preprints/preprint112.pdf" xlink:type="simple">http://www.dfg-spp1324.de/download/preprints/preprint112.pdf</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Holtz1"><label>76</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Holtz</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Rohwedder</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Schneider</surname><given-names>R</given-names></name> (<year>2012</year>) <article-title>The alternating linear scheme for tensor optimization in the Tensor Train format</article-title>. <source>SIAM Journal on Scientific Computing</source> <volume>34</volume>: <fpage>A683</fpage>–<lpage>A713</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003359-Sheppard1"><label>77</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sheppard</surname><given-names>PW</given-names></name>, <name name-style="western"><surname>Rathinam</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Khammash</surname><given-names>M</given-names></name> (<year>2013</year>) <article-title>Spsens: a software package for stochastic parameter sensitivity analysis of biochemical reaction networks</article-title>. <source>Bioinformatics</source> <volume>29</volume>: <fpage>140</fpage>–<lpage>142</lpage>.</mixed-citation>
</ref>
</ref-list></back>
</article>