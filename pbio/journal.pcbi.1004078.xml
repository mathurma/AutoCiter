<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research-article">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-14-01148</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1004078</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>NEMix: Single-cell Nested Effects Models for Probabilistic Pathway Stimulation</article-title>
<alt-title alt-title-type="running-head">NEMix: Single-cell Nested Effects Models</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Siebourg-Polster</surname> <given-names>Juliane</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Mudrak</surname> <given-names>Daria</given-names></name>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Emmenlauer</surname> <given-names>Mario</given-names></name>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Rämö</surname> <given-names>Pauli</given-names></name>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Dehio</surname> <given-names>Christoph</given-names></name>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Greber</surname> <given-names>Urs</given-names></name>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Fröhlich</surname> <given-names>Holger</given-names></name>
<xref ref-type="aff" rid="aff005"><sup>5</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Beerenwinkel</surname> <given-names>Niko</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Department of Biosystems Science and Engineering, ETH Zurich, Basel, Switzerland</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>SIB Swiss Institute of Bioinformatics, Basel, Switzerland</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>Institute of Molecular Life Sciences, University of Zurich, Zurich, Switzerland</addr-line>
</aff>
<aff id="aff004">
<label>4</label>
<addr-line>Biozentrum, University of Basel, Basel, Switzerland</addr-line>
</aff>
<aff id="aff005">
<label>5</label>
<addr-line>Algorithmic Bioinformatics, Bonn-Aachen International Center for IT, University of Bonn, Bonn, Germany</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Miyano</surname> <given-names>Satoru</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>University of Tokyo, Japan</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con" id="contrib001">
<p>Conceived and designed the experiments: JSP CD UG HF NB. Performed the experiments: DM UG. Analyzed the data: JSP ME PR. Contributed reagents/materials/analysis tools: DM ME PR CD UG HF. Wrote the paper: JS HF NB. Designed and implemented statistical model: JSP HF NB.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">niko.beerenwinkel@bsse.ethz.ch</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>4</month>
<year>2015</year>
</pub-date>
<pub-date pub-type="epub">
<day>16</day>
<month>4</month>
<year>2015</year>
</pub-date>
<volume>11</volume>
<issue>4</issue>
<elocation-id>e1004078</elocation-id>
<history>
<date date-type="received">
<day>26</day>
<month>6</month>
<year>2014</year>
</date>
<date date-type="accepted">
<day>8</day>
<month>12</month>
<year>2014</year>
</date>
</history>
<permissions>
<copyright-year>2015</copyright-year>
<copyright-holder>Siebourg-Polster et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1004078" xlink:type="simple"/>
<abstract>
<p>Nested effects models have been used successfully for learning subcellular networks from high-dimensional perturbation effects that result from RNA interference (RNAi) experiments. Here, we further develop the basic nested effects model using high-content single-cell imaging data from RNAi screens of cultured cells infected with human rhinovirus. RNAi screens with single-cell readouts are becoming increasingly common, and they often reveal high cell-to-cell variation. As a consequence of this cellular heterogeneity, knock-downs result in variable effects among cells and lead to weak average phenotypes on the cell population level. To address this confounding factor in network inference, we explicitly model the stimulation status of a signaling pathway in individual cells. We extend the framework of nested effects models to probabilistic combinatorial knock-downs and propose NEMix, a nested effects mixture model that accounts for unobserved pathway activation. We analyzed the identifiability of NEMix and developed a parameter inference scheme based on the Expectation Maximization algorithm. In an extensive simulation study, we show that NEMix improves learning of pathway structures over classical NEMs significantly in the presence of hidden pathway stimulation. We applied our model to single-cell imaging data from RNAi screens monitoring human rhinovirus infection, where limited infection efficiency of the assay results in uncertain pathway stimulation. Using a subset of genes with known interactions, we show that the inferred NEMix network has high accuracy and outperforms the classical nested effects model without hidden pathway activity. NEMix is implemented as part of the R/Bioconductor package ‘nem’ and available at <ext-link ext-link-type="uri" xlink:type="simple" xlink:href="http://www.cbg.ethz.ch/software/NEMix">www.cbg.ethz.ch/software/NEMix</ext-link>.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>Experiments monitoring individual cells show that cells can behave differently even under same experimental conditions. Summarizing measurements over a population of cells can lead to weak and widely deviating signals, and subsequently applied modeling approaches, like network inference, will suffer from this information loss. Nested effects models, a method tailored to reconstruct signaling networks from high-dimensional read-outs of gene silencing experiments, have so far been only applied on the cell population level. These models assume the pathway under consideration to be activated in all cells. The signal flow is only disrupted, when genes are silenced. However, if this assumption is not met, inference results can be incorrect, because observed effects are interpreted wrongly. We extended nested effects models, to use the power of single-cell resolution data sets. We introduce a new unobserved factor, which describes the pathway activity of single cells. The pathway activity is learned for each cell during network inference. We apply our model to gene silencing screens, investigating human rhino virus infection of single cells from microscopy imaging features. Comparing the learned network to the known KEGG pathway of the genes shows that our method recovers networks significantly better than classical nested effects models without capturing of hidden signaling.</p>
</abstract>
<funding-group>
<funding-statement>CD, UG, and NB were supported by SystemsX.ch (<ext-link ext-link-type="uri" xlink:type="simple" xlink:href="http://www.systemsx.ch">www.systemsx.ch</ext-link>), the Swiss initiative in systems biology, under grant No. 51RT-0_126008 (InfectX), and CD and NB under grant No. 51RTP0_151029 (TargetInfectX). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="3"/>
<table-count count="1"/>
<page-count count="21"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability" xlink:type="simple">
<meta-name>Data Availability</meta-name>
<meta-value>Data are freely available as part of the R/Bioconductor package ‘nem’ at <ext-link ext-link-type="uri" xlink:type="simple" xlink:href="http://www.cbg.ethz.ch/software/NEMix">http://www.cbg.ethz.ch/software/NEMix</ext-link>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<disp-quote>
<p><italic>This is a PLOS Computational Biology Methods paper.</italic></p>
</disp-quote>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Network inference benefits substantially from perturbation experiments, such as RNA interference (RNAi) screens. Monitoring high-dimensional effects of gene silencing enables inference of non-transcriptional network structures that cannot be learned on observational data alone [<xref ref-type="bibr" rid="pcbi.1004078.ref001">1</xref>]. Nested effects models (NEMs) are a class of probabilistic graphical models that aim at learning hierarchical dependencies from such intervention experiments. Upon perturbing nodes in a signaling graph, their connectivity is inferred from the nested structure of observed downstream effects. The concept was first introduced in [<xref ref-type="bibr" rid="pcbi.1004078.ref002">2</xref>]. Since then, many further additions concerning, for example, parameter inference, structure learning, and data integration, were developed [<xref ref-type="bibr" rid="pcbi.1004078.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1004078.ref004">4</xref>]. In addition, dynamic models for time series data have been developed [<xref ref-type="bibr" rid="pcbi.1004078.ref005">5</xref>–<xref ref-type="bibr" rid="pcbi.1004078.ref007">7</xref>]. In [<xref ref-type="bibr" rid="pcbi.1004078.ref005">5</xref>], a first application of dynamic nested effects models to time laps microscopy data has been described, but the model can not handle single-cell data. A Bayesian network representation of NEMs in [<xref ref-type="bibr" rid="pcbi.1004078.ref008">8</xref>] introduces a probabilistic notation for signal propagation, but in practice the signaling is kept deterministic. In all previous NEM models and applications, the signaling pathway under observation is assumed to be active and the signal flow disrupted by silencing the signaling genes one by one.</p>
<p>In principle, RNAi experiments are a highly informative for learning NEMs. Perturbations are introduced by gene silencing in cells through RNA interference using siRNAs [<xref ref-type="bibr" rid="pcbi.1004078.ref009">9</xref>, <xref ref-type="bibr" rid="pcbi.1004078.ref010">10</xref>]. Effects of the knock-downs are then captured by high-dimensional down-stream observations. The screening data analyzed here, comprises imaging data of thousands of individual cells for genome-wide gene silencing. However, the experiments come at the cost of high noise levels, as well as biological and technical biases, including off-target effects [<xref ref-type="bibr" rid="pcbi.1004078.ref011">11</xref>, <xref ref-type="bibr" rid="pcbi.1004078.ref012">12</xref>]. These confounding factors complicate the analysis and interpretation of the screening results. On the other hand, RNAi screens currently reach very high resolution. Per knock-down, the present data sets comprise about 300 image features for several hundred individual cells, which allows for a very detailed analysis of a knock-down event. However, it has been shown that measurements from individual cells of the same experiment can differ widely, for example, due to local environmental differences [<xref ref-type="bibr" rid="pcbi.1004078.ref013">13</xref>, <xref ref-type="bibr" rid="pcbi.1004078.ref014">14</xref>]. Such variation on the single cell level needs to be accounted for. Otherwise, an ambiguous signal is obtained, when averaging over the cell population of a knock-down.</p>
<p>Here, we specifically investigate single-cell observations of pathogen infection screens [<xref ref-type="bibr" rid="pcbi.1004078.ref015">15</xref>–<xref ref-type="bibr" rid="pcbi.1004078.ref017">17</xref>]. The experiments monitor cells with an siRNA knock-down during infection with human rhinovirus (HRV). After siRNA knock-down, the pathogen is added to the cells, and the success of infection as well as many other cellular features are extracted from microscopy images taken of the cells from each experiment [<xref ref-type="bibr" rid="pcbi.1004078.ref018">18</xref>–<xref ref-type="bibr" rid="pcbi.1004078.ref020">20</xref>]. The aim is to infer a signaling cascade involved in pathogen entry in to the host cell. However, a challenge in the analysis of data from this experimental setup is that by experimental design even in mock controls (i.e., infection without knock-down) the infection rate is far from complete. In fact, the multiplicity of infection (MOI) of the assay was optimized to reach 30 to 50% infected cells, such that both infection-decreasing and infection-increasing hits can be detected. Which cells in the population finally get infected is, at least to some extent, the result of stochastic effects, since cellular processes can be differently manifested in different cells. The multi-functional nature of proteins, for instance, enables a single host factor to enhance a signaling cascade, and at the same time may antagonize other processes that support or inhibit infection. Obviously, infected cells were reached by a pathogen triggering some signal to get internalized. However, for uninfected cells, it is unknown whether a pathogen actually attempted to infect them, which is crucial for determining the effect that the gene knock-down had on these cells. Wrongly assuming that the pathway is active, even though it is not, can result in conflicting knock-down schemes. In the original NEM setting, individual cell observations are summarized for each signaling gene.</p>
<p>To address the problem of network learning when the activation state of the signaling pathway is unknown we introduce a new model, called NEMix, extending the existing NEM framework in several ways. First, we do not summarize the data across cells, but rather perform network inference using the single-cell observations directly. Furthermore, we model the unknown pathway activation with an additional hidden random variable in the graph of signaling genes. The activation state is then estimated for each individual cell. The pathway activity can be regarded as an additional hidden silencing event in the signaling graph. We introduce a general theoretical framework for probabilistic combinatorial knock-downs in NEMs. We develop our model for the most general case, not making any assumptions about the signal propagation. We have implemented the special case of one hidden variable with probabilistic knock-down, where the remaining network is kept deterministic. For inference of the hidden pathway state, we developed an EM algorithm [<xref ref-type="bibr" rid="pcbi.1004078.ref021">21</xref>]. This step is repeated for each proposal structure during the network search.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<sec id="sec003">
<title>Network inference under unknown pathway activity</title>
<p>We developed NEMix, a new model based on NEMs, which allows to estimate activity of a pathway in individual cells. A NEM is a graphical model, consisting of two graphs. The transitively closed graph Φ encodes dependencies among signaling gene nodes <italic>S</italic><sub><italic>s</italic></sub> ∊ <bold>𝓢</bold>, which are silenced one by one. The bipartite graph Θ connects a set of observable feature nodes <italic>E</italic><sub><italic>e</italic></sub> ∊ 𝓔 uniquely to the signaling genes (<xref ref-type="fig" rid="pcbi.1004078.g001">Fig. 1A</xref>). We seek the structure of Φ, i.e., the topology of the signaling pathway, by inferring it from the nested structure of observed effects. For a data set <bold>𝒟</bold> = (<italic>d</italic><sub><italic>ek</italic></sub>) of a set of knock-down experiments <italic>k</italic> ∊ {1, …, <italic>K</italic>} and observed features <italic>e</italic> ∊ {1, …, <italic>m</italic>}, the likelihood function given Φ and <italic>θ</italic> is
<disp-formula id="pcbi.1004078.e001"><alternatives><graphic id="pcbi.1004078.e001g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004078.e001"/><mml:math id="M1" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>𝒟</mml:mi> <mml:mo>∣</mml:mo> <mml:mo>Φ</mml:mo> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>e</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>m</mml:mi></mml:munderover> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>K</mml:mi></mml:munderover> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>e</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>∣</mml:mo> <mml:mo>Φ</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>e</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula>
where <italic>θ</italic><sub><italic>e</italic></sub> = <italic>s</italic> indicates that feature <italic>e</italic> is connected to signaling gene <italic>s</italic> ∊ <bold>𝓢</bold>.</p>
<fig id="pcbi.1004078.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004078.g001</object-id>
<label>Fig 1</label>
<caption>
<title>NEM versus NEMix.</title>
<p>A schematic example is shown comparing the classical nested effects model (NEM; panel <bold>A</bold>) with the new nested effects mixture model (NEMix; panel <bold>B</bold>) on six features observed in 15 individual cells. Blue nodes in the graph depict the signaling genes <italic>S</italic><sub>1</sub>, <italic>S</italic><sub>2</sub>, and <italic>S</italic><sub>3</sub> that have been silenced and whose dependency structure is sought. The observed features <italic>E</italic><sub>1</sub>, …, <italic>E</italic><sub>6</sub> are shown in green. Each box below the graphs indicates the observed (noisy) features (e.g., image-based read-outs) for a single cell. Within each box, dark entries indicate an effect of the knock-down on the feature, light entries indicate no effect. In cells 1 and 2 (left in both <bold>A</bold> and <bold>B</bold>), the pathway has been activated via <italic>S</italic><sub>2</sub>, whereas in cells 3, 4, and 5 (right in both <bold>A</bold> and <bold>B</bold>) it has remained inactivated. In the latter case, the effects of silencing <italic>S</italic><sub>2</sub> are masked and the resulting silencing scheme then differs from the one where the pathway is stimulated. Classic NEMs (<bold>A</bold>) could explain such a heterogeneous cell population only by two different signaling graphs Φ. By contrast, with the NEMix model proposed in this work (<bold>B</bold>), both observed patterns can be explained by the same signaling graph Φ, because the hidden pathway stimulation <italic>Z</italic> (shown in red) is modeled explicitly. In the NEMix model, <italic>Z</italic> is a hidden binary random variable indicating pathway activation (<italic>Z</italic> = 1), which occurs with probability <italic>P</italic>(<italic>Z</italic> = 1) = <italic>p</italic><sub>1</sub>.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004078.g001"/>
</fig>
<p>The NEMix model consists of the same two graphs Φ and Θ, but has an additional binary hidden variable <italic>Z</italic> added to the signaling graph Φ. Its connections to the signaling genes, as well as its overall knock-down probability <italic>p</italic><sub>0</sub> = <italic>P</italic>(<italic>Z</italic><sub><italic>kc</italic></sub> = 0), are unknown and inferred for each individual cell during the network reconstruction process. Given single cell data <bold>𝒟</bold> = (<italic>d</italic><sub><italic>ekc</italic></sub>) with <italic>c</italic> = 1, …, <italic>c</italic><sub><italic>k</italic></sub> cells in knock-down experiment <italic>k</italic>, the likelihood function of the NEMix model, given Φ and <italic>θ</italic>, is
<disp-formula id="pcbi.1004078.e002"><alternatives><graphic id="pcbi.1004078.e002g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004078.e002"/><mml:math id="M2" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>D</mml:mi> <mml:mo>∣</mml:mo> <mml:mo>Φ</mml:mo> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>e</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>m</mml:mi></mml:munderover> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>K</mml:mi></mml:munderover> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>c</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:msub><mml:mi>c</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:munderover> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>∊</mml:mo> <mml:mo>{</mml:mo> <mml:mn>0</mml:mn><mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>}</mml:mo></mml:mrow></mml:munder> <mml:msub><mml:mi>p</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>e</mml:mi> <mml:mi>k</mml:mi> <mml:mi>c</mml:mi></mml:mrow></mml:msub> <mml:mo>∣</mml:mo> <mml:mo>Φ</mml:mo><mml:mo>,</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>e</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi>s</mml:mi><mml:mo>,</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>c</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mi>j</mml:mi> <mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2)</label></disp-formula></p>
<p>A detailed derivation of the model and its implementation are given in the Models section. If a signal is activating a pathway, or parts of it, the signal flow is the same as in the NEM. Also the observed knock-down effects for the features <italic>E</italic><sub><italic>e</italic></sub> are the same. However, when the pathways input signal is inactivated, the knock-down pattern of the features changes (<xref ref-type="fig" rid="pcbi.1004078.g001">Fig. 1A and B</xref>, cells 7 to 15). Not accounting for the pathway disruption can mislead inference of the structure Φ (<xref ref-type="fig" rid="pcbi.1004078.g001">Fig. 1A</xref>, left model).</p>
<p>The connectivity of <italic>Z</italic> is learned in a greedy fashion during structure inference. For the knock-down probability of the hidden variable, <italic>p</italic><sub>0</sub>, we implemented an EM algorithm, which estimates jointly <italic>p</italic><sub>0</sub> from each cell’s observation and the connections of observations to signaling genes, <italic>θ</italic>. In the following, we show improved network inference with NEMix in simulations and then infer networks of high accuracy, from single cell gene silencing experiments.</p>
</sec>
<sec id="sec004">
<title>Simulation study</title>
<p>To test our model, we performed a large simulation study. We generated 30 network structures with 5 signaling genes, randomly sampled from KEGG pathway maps [<xref ref-type="bibr" rid="pcbi.1004078.ref022">22</xref>] as previously described in [<xref ref-type="bibr" rid="pcbi.1004078.ref006">6</xref>]. To each network the hidden input signal was attached randomly. The resulting 30 sample networks are shown in supplementary <xref ref-type="supplementary-material" rid="pcbi.1004078.s002">S1 Fig</xref>. From each network, we sampled 50 data sets on 300 observed features in the following way. For each gene, we simulated single knock-downs in 200 cells. To the observed features we added another 30 noise features, not attached to any signaling gene. The data sets were generated in the following way. We sampled effects from a normal distribution with mean <italic>m</italic><sub><italic>e</italic></sub> = 1 and non-effects from a normal distribution with mean <italic>m</italic><sub><italic>n</italic></sub> = 0. The standard deviation for each experiment was sampled uniformly between 2 and 2.5. We furthermore sampled 200 cells for control experiments. The negative control cells do not show any effects and are therefore drawn from the non-effect distribution. The positive control cells always show effects and hence are drawn from the effect distribution. The whole simulation process was repeated for five different fractions of pathway disruption, <italic>p</italic><sub>0</sub> ∊ {0, 0.3, 0.5, 0.8, 1}. NEMix inference was restarted for 16 initial networks. Each of them consists of the empty graph Φ plus a unique attachment of <italic>Z</italic> to the signaling genes. Setting the maximal out-degree of <italic>Z</italic> to two, there are 16 possible such attachments of <italic>Z</italic>. This regularization on the edges of <italic>Z</italic> reduces the search space significantly. During structure search we also imposed this restriction, but additionally allowed transitive edges that had to be added as a consequence of the insertion of any edge connecting <italic>Z</italic> to a gene (see <xref ref-type="sec" rid="sec007">Models</xref> section).</p>
<p>We compared NEMix to two other NEM models and, for a baseline comparison, to a random approach, where network edges are sampled uniformly with probability 1/<italic>n</italic>, where <italic>n</italic>∣Φ∣ is the number of signaling nodes. This probability was chosen as it creates networks with approximately the same number of edges as in the original graphs. To assess the impact that pathway disruption has on the cell population level, we ran the simulations on a standard NEM using the log-likelihood model introduced in [<xref ref-type="bibr" rid="pcbi.1004078.ref023">23</xref>]. For the NEM approach we had to summarize the single cell observations to the gene level. For these gene-level data sets we used p-values of a Wilcoxon test comparing the cell population of a knock-down to the control distribution. From the p-value distributions a Beta-Uniform-Mixture model was estimated. For each feature a density value is calculated from this model, indicating the effect strength of the knock-down. These density values are used as the input data, as previously introduced in [<xref ref-type="bibr" rid="pcbi.1004078.ref023">23</xref>]. The third approach, called single-cell NEM (sc-NEM). is a NEMix model on individual cell observations, but with fixed <italic>p</italic><sub>0</sub> = 0, i.e., a single-cell observation-based NEM without considering uncertain pathway activity. For all three models, we applied a uniform prior on the feature attachments <italic>θ</italic>, and no prior knowledge was added for the network structures Φ. The NEMix parameter <italic>p</italic><sub>0</sub> was initialized by drawing from a uniform distribution in each EM restart. As NEMix and sc-NEMs infer networks on single-cell observations, we calculated log odds ratios from each observation based on the positive and negative control distributions (see ‘Modeling the effect likelihoods’ in <xref ref-type="supplementary-material" rid="pcbi.1004078.s001">S1 Text</xref>). For NEMs and sc-NEMs, we used maximum likelihood estimation to infer <italic>θ</italic> and in the NEMix it is estimated by in an EM algorithm. Structure learning is performed using a greedy hill climbing algorithm, initialized with an empty network.</p>
<p>
<xref ref-type="fig" rid="pcbi.1004078.g002">Fig. 2A</xref> summarizes the overall performance for all methods and the different fractions of pathway signal perturbation <italic>p</italic><sub>0</sub>. We display accuracy of the edge recovery, for varying <italic>p</italic><sub>0</sub>. We also calculated the area under the ROC curve (AUC) based on the edge frequencies of the 50 replicate data sets, which yielded similar results in terms of accuracy (see supplementary <xref ref-type="supplementary-material" rid="pcbi.1004078.s003">S2 Fig</xref>). As expected, all methods performed equally well when there is no signal disruption (<italic>p</italic><sub>0</sub> = 0). However, when <italic>p</italic><sub>0</sub> is moderate to high, NEMix performs significantly better than the other methods. If the triggering signal is always turned off, performance of all methods drops drastically. Intuitively, this is because in such a special case, all features downstream of <italic>Z</italic> always show an effect and hence they cannot be used for structure learning. For example, if, in <xref ref-type="fig" rid="pcbi.1004078.g001">Fig. 1B</xref>, <italic>Z</italic> is inactive for each cell, we could not infer the structure among <italic>S</italic><sub>2</sub> and <italic>S</italic><sub>3</sub>. In reality though, permanent shut down of the pathway is very unlikely. For the infection screens <italic>p</italic><sub>0</sub> = 1 would mean that no cell is ever infected. Pathway activity estimates are also of overall high accuracy (<xref ref-type="fig" rid="pcbi.1004078.g002">Fig. 2B</xref>). Although simulation results demonstrate that the performance of learning <italic>Z</italic> and <italic>θ</italic> varies, depending on the network structure, the average performance is very good (<xref ref-type="supplementary-material" rid="pcbi.1004078.s004">S3 Fig</xref>, <xref ref-type="supplementary-material" rid="pcbi.1004078.s005">S4 Fig</xref>, <xref ref-type="supplementary-material" rid="pcbi.1004078.s006">S5 Fig</xref>).</p>
<fig id="pcbi.1004078.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004078.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Performance comparison of the simulations.</title>
<p>(A) Simulation results are summarized based on the accuracy of recovered edges for the compared methods. The methods are random, random edge sampling with rate <inline-formula id="pcbi.1004078.e003"><mml:math id="M3" display="inline" overflow="scroll"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn> <mml:mi>n</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula>; NEM, the normal NEM inference; sc-NEM, the cell level NEM and NEMix, using the NEMix inference with the hidden pathway state. All methods were run on 50 simulated data sets from 30 sample networks, repeated for different knock-down probabilities of the pathway state <italic>p</italic><sub>0</sub>. (B) For the NEMix model, the distributions of inferred <italic>p</italic><sub>0</sub> values are compared to the true <italic>p</italic><sub>0</sub>.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004078.g002"/>
</fig>
<p>Currently, one of the main obstacles for learning larger NEMix models is the fast growing run-time for <italic>n</italic> &gt; 5 network nodes. Run-time is further increased by a factor of <italic>n</italic>, when initiating the algorithm with each possible connection of <italic>Z</italic> to one of the knock-down genes. To assess its performance on larger networks, we ran a reduced simulation study on <italic>n</italic> = 5, 10, and 15 genes. The setup and results of the study are described in detail in <xref ref-type="supplementary-material" rid="pcbi.1004078.s007">S6 Fig</xref>. Larger networks of 15 nodes can still be estimated very well (<xref ref-type="supplementary-material" rid="pcbi.1004078.s007">S6 Fig</xref>. A) and estimation of the parameter <italic>p</italic><sub>0</sub> even improves (<xref ref-type="supplementary-material" rid="pcbi.1004078.s002">S1 Fig. D</xref>). However, the average time to estimate a 15-node network was 9.5 hours. This is substantially more than the average 1.9 hours needed for 10-node networks. Thus, in a highly parallelized computing environment, even larger networks can be estimated.</p>
<p>We also assessed the connection of features to the signaling genes in the inferred graph Θ. There can be situations, where attachment of features is equally likely for several signaling genes. In these cases, where no single gene is preferred, we counted a feature as correctly attached if it was connected to any of the signaling genes with equal likelihood. Accuracy of the <italic>θ</italic> estimates is high (&gt; 80%) for small <italic>p</italic><sub>0</sub> values and decreases with increasing <italic>p</italic><sub>0</sub>. For small <italic>p</italic><sub>0</sub>, also performance of the sc-NEMs is good, which shows the advantage of learning on the single-cell data level. However, NEMix stands out from the other methods for higher <italic>p</italic><sub>0</sub>. Recovery of noise features, i.e., correct filtering of the additionally added uninformative features, is not strongly affected by the hidden signal (see supplementary <xref ref-type="supplementary-material" rid="pcbi.1004078.s008">S7 Fig</xref>). Analyzing individual networks, one again observes high variation in performance (see supplementary <xref ref-type="supplementary-material" rid="pcbi.1004078.s009">S8 Fig</xref>).</p>
</sec>
<sec id="sec005">
<title>Application to pathogen infection experiments</title>
<p>We applied NEMix in the context of infection signaling, using the RNAi screening data monitoring HRV infection, mentioned in the introduction. Briefly, viruses were added to the siRNA transfected cells and after an incubation time, cells were fixated, stained, and then imaged. Subsequently, 360 cell features were extracted from the 9 images per knock-down experiment using the software CellProfiler [<xref ref-type="bibr" rid="pcbi.1004078.ref024">24</xref>]. For the whole experimental procedure the protocols of [<xref ref-type="bibr" rid="pcbi.1004078.ref017">17</xref>] were followed. The HRV assay is rather short with an infection time of only seven hours, resulting in measurements proximal to the infection event. The short time range is advantageous, because it leaves less room for confounding developments in the cells. Furthermore, the used antibody resulted in clean readouts, well to extract from the images.</p>
<p>Before using the data for network inference, we performed two additional filtering steps. For each knock-down, the well is split into 9 images. They are arranged in three rows and three columns. We used only the middle image, because it is of the highest quality. In this way we avoided too many out-of-focus cells, which bias especially the cell texture features. After this filtering step, we had around 200 to 300 cells per knock-down. A second filtering step concerns siRNA off-targets [<xref ref-type="bibr" rid="pcbi.1004078.ref025">25</xref>]. We sought to avoid confounding by this effect and therefore selected only genes with low predicted off-target effects as described in ‘siRNA filtering for off-targets’ of <xref ref-type="supplementary-material" rid="pcbi.1004078.s001">S1 Text</xref>.</p>
<p>We applied NEMix to a small subset of the screened genes, in order to recover a known pathway. We decided on the well-known MAP-Kinase signaling cascade as a proof of principle, for several reasons. First, it has been studied and validated in great detail [<xref ref-type="bibr" rid="pcbi.1004078.ref026">26</xref>–<xref ref-type="bibr" rid="pcbi.1004078.ref028">28</xref>], such that the available signaling network from the KEGG database [<xref ref-type="bibr" rid="pcbi.1004078.ref022">22</xref>] can be used as a reliable source to compare to. Second, the pathway is known to be involved in HVR infection signaling, where it is associated with asthmatic and COPD exacerbation [<xref ref-type="bibr" rid="pcbi.1004078.ref029">29</xref>–<xref ref-type="bibr" rid="pcbi.1004078.ref031">31</xref>]. Finally, we observed an enrichment for low off-target siRNAs in this pathway when performing a gene set enrichment analysis [<xref ref-type="bibr" rid="pcbi.1004078.ref032">32</xref>] (see supplementary <xref ref-type="supplementary-material" rid="pcbi.1004078.s010">S9 Fig</xref>). We then selected a small subset of 8 MAP-Kinase pathway genes for analysis based on the derived score for predicted off-target effects. Nodes of KEGG pathways can contain several genes. We selected genes such that they are all assigned to different KEGG nodes using a weighted maximum bipartite matching of low off-target siRNAs and unique KEGG nodes. After gene selection, we inferred networks for the 5 and 8 genes with lowest off-target score.</p>
<p>Like in the simulation study above, we compared the NEMix model to the NEM and the sc-NEM approach. As input data sets, the local effect likelihoods from the selected knock-down gene experiments were computed as follows. As the experiments lack reliable controls, we instead used a random sample of cells from the plate on which the gene was located, assuming that the majority of knock-downs will not have an effect. Like for the simulation study, we derived the cell population effects for the NEM from Wilcoxon tests, comparing the knock-down experiment to the control. From the resulting p-value distributions, effect strengths for the features were estimated using the Beta-Uniform-Mixture model. Log odds ratios for sc-NEMs and NEMix in this case are calculated only based on one control distribution (see <xref ref-type="sec" rid="sec007">Models</xref> section). NEMix inference again is repeated for the 16 initial networks of all possible connections of <italic>Z</italic> with maximal out-degree 2 to the empty graph Φ. Like in the simulation study, <italic>p</italic><sub>0</sub> was initialized by drawing randomly from a uniform distribution. Again we used uniform priors for <italic>θ</italic> and imposed no priors for the signaling networks other than the maximal out-degree of <italic>Z</italic> (plus the transitive edges that need to be added).</p>
<p>The known KEGG network and the inferred results for the top 5 signaling genes are displayed in <xref ref-type="fig" rid="pcbi.1004078.g003">Fig. 3A-E</xref>. Results for the top-8 gene network are given in <xref ref-type="supplementary-material" rid="pcbi.1004078.s011">S10 Fig</xref>. To assess robustness of the learned networks, we repeated the inference on 50 bootstrap samples of the original data set. Both networks show high AUC values and even better accuracy (see <xref ref-type="table" rid="pcbi.1004078.t001">Table 1</xref>). As can be seen from <xref ref-type="fig" rid="pcbi.1004078.g003">Fig. 3F</xref>, network inference was very robust for the top-5 gene network. For the top-8 gene network, performance had a slightly higher variation. Individual plots for sensitivity and specificity are given in supplementary <xref ref-type="supplementary-material" rid="pcbi.1004078.s012">S11 Fig. A, B</xref>. Also the estimate of <italic>p</italic><sub>0</sub> shows only little variation (<xref ref-type="supplementary-material" rid="pcbi.1004078.s012">S11 Fig. C</xref>). In all cases, the likelihood score of the known KEGG network is much lower than for the best inferred networks, indicating that under the assumptions of our model, the data and the KEGG database do not perfectly agree. Possible reasons for this observation include our model missing to explain part of the data correctly, the KEGG database being incomplete, and inaccuracies in the data generating process. Nevertheless, the accuracy value of 0.85 for the learned NEMix outperforms all other methods. All edges contained in the learned NEMix models are of high robustness (&gt; 80% for 5 genes, and &gt; 70% for 8 genes). Consensus networks of the bootstrap results are shown in supplementary <xref ref-type="supplementary-material" rid="pcbi.1004078.s013">S12 Fig</xref>.</p>
<fig id="pcbi.1004078.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004078.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Inferred MAPK networks on HRV infection data.</title>
<p>Best networks of the 5 top scoring siRNAs from the MAPK pathway for HRV infection for the different compared methods are displayed. (A) shows the known KEGG pathway. (B) is the inferred NEM and (C) the sc-NEM. (D) left shows the known network with the most likely attachment of the hidden variable <italic>Z</italic> (blue) and (E) is the inferred NEMix. For all networks their performance is summarized in <xref ref-type="table" rid="pcbi.1004078.t001">Table 1</xref>. Subfigure (F) summarizes robustness of the MAPK network inference. For the inferred MAPK signaling networks on the HRV infection data, we assessed robustness of the accuracy for edge recovery. Box-plots display the result of 50 bootstrap samples for the three compared methods, on the 5 gene (<italic>n</italic> = 5) and 8 gene (<italic>n</italic> = 8) network.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004078.g003"/>
</fig>
<table-wrap id="pcbi.1004078.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004078.t001</object-id>
<label>Table 1</label>
<caption>
<title>Performance summary of the 5 gene MAPK network.</title>
</caption>
<alternatives>
<graphic id="pcbi.1004078.t001g" mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004078.t001"/>
<table frame="box" rules="all" border="0">
<colgroup span="1">
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
</colgroup>
<thead>
<tr>
<th align="left" rowspan="1" colspan="1">Network</th>
<th align="left" rowspan="1" colspan="1">Likelihood</th>
<th align="left" rowspan="1" colspan="1">ACC</th>
<th align="left" rowspan="1" colspan="1">AUC</th>
<th align="left" rowspan="1" colspan="1">p0</th>
<th align="left" rowspan="1" colspan="1">Sub-figure</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1">True Graph</td>
<td align="char" char="." rowspan="1" colspan="1">2641.47</td>
<td align="left" rowspan="1" colspan="1">1</td>
<td align="left" rowspan="1" colspan="1">1</td>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">A</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">NEM</td>
<td align="char" char="." rowspan="1" colspan="1">2809.83</td>
<td align="left" rowspan="1" colspan="1">0.5</td>
<td align="left" rowspan="1" colspan="1">0.23</td>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">B</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">sc-NEM</td>
<td align="char" char="." rowspan="1" colspan="1">29410.81</td>
<td align="left" rowspan="1" colspan="1">0.65</td>
<td align="left" rowspan="1" colspan="1">0.47</td>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">C</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">True Graph + Z</td>
<td align="char" char="." rowspan="1" colspan="1">31768.94</td>
<td align="left" rowspan="1" colspan="1">1</td>
<td align="left" rowspan="1" colspan="1">1</td>
<td align="char" char="." rowspan="1" colspan="1">0.48</td>
<td align="left" rowspan="1" colspan="1">D</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">NEMix</td>
<td align="char" char="." rowspan="1" colspan="1">34982.87</td>
<td align="left" rowspan="1" colspan="1">0.9</td>
<td align="left" rowspan="1" colspan="1">0.84</td>
<td align="char" char="." rowspan="1" colspan="1">0.42</td>
<td align="left" rowspan="1" colspan="1">E</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t001fn001">
<p>The first column gives the log-likelihood for each model, showing that the true network is much less likely than the inferred networks. The second and third column show performance of the networks in terms of accuracy (ACC) and area under curve (AUC). The inferred <italic>p</italic><sub>0</sub> for the NEMix models is displayed in column four. Column five indicates the corresponding sub-figure of <xref ref-type="fig" rid="pcbi.1004078.g003">Fig. 3</xref>. The network ‘KEGG Graph + Z’ denotes the structure of the known KEGG network, where only the position of <italic>Z, p</italic><sub>0</sub>, and <italic>θ</italic> are inferred.</p></fn>
</table-wrap-foot>
</table-wrap>
<p>Furthermore, the hidden root <italic>Z</italic> is attached to the same nodes in both the known KEGG graph and the estimated network for 5 genes. Also the inferred 8 node network connects <italic>Z</italic> to the same three genes. As genes were selected based on small off-target effects of their targeting siRNAs, they are not necessarily hits for HRV infection. However, of the selected genes EGFR [<xref ref-type="bibr" rid="pcbi.1004078.ref033">33</xref>], TAB2 [<xref ref-type="bibr" rid="pcbi.1004078.ref034">34</xref>] and CACNA2D3 [<xref ref-type="bibr" rid="pcbi.1004078.ref035">35</xref>] have been shown to be involved in this process.</p>
<p>All models have a built-in filter for uninformative features, which has been previously introduced in [<xref ref-type="bibr" rid="pcbi.1004078.ref036">36</xref>]. A comparison shows that averaged over the bootstrap samples, for all three methods, the set of used features largely agrees (supplementary <xref ref-type="supplementary-material" rid="pcbi.1004078.s014">S13 Fig</xref> and <xref ref-type="supplementary-material" rid="pcbi.1004078.s015">S14 Fig</xref>). The maximum likelihood attachments of features to the knock-down genes and the null node are shown in supplementary <xref ref-type="supplementary-material" rid="pcbi.1004078.s016">S15 Fig</xref> and <xref ref-type="supplementary-material" rid="pcbi.1004078.s017">S16 Fig</xref>, together with a detailed description of the different feature types. The inferred signaling disruption of <italic>p</italic><sub>0</sub> = 0.42 seems rather high. We compared this to the average infection rate in mock experiments, i.e., cells without siRNA knock-down. These resemble cases, where <italic>Z</italic> can be perturbed but none of the other signaling genes in the network. Mock wells from plates of the 8 genes used here, actually have a much higher percentage of uninfected cells, roughly in the range of 75 to 81%. However, this comparison should be taken with caution since control wells of these screens might have suffered from strong plate location bias, as they were located on the margins of the plate.</p>
<p>As a general observation, NEMix-inferred networks were sparser than those obtained from NEMs, because spurious edges introduced in the latter are correctly explained by hidden pathway activity <italic>Z</italic> in NEMix. Therefore, NEMix networks have increased specificity, which might come at the cost of some missing true edges. Especially the 8-gene networks inferred by NEM and sc-NEM are much denser than the known KEGG network. A sparse network is beneficial in the sense that it allows to focus on a small set of highly specific edges. For validation experiments, it is desirable to have a low false positive rate in the predicted interactions as usually only very few of these dependencies can be experimentally tested.</p>
</sec>
</sec>
<sec id="sec006" sec-type="conclusions">
<title>Discussion</title>
<p>RNAi screens are known to be prone to many sources of noise and bias such that their analysis is highly challenging. Here, we have identified one confounding factor, namely heterogeneous signaling pathway activation within a cell population, and incorporated it directly into a novel probabilistic model for pathway reconstruction. To address the problem of unknown activation of signaling pathways during network inference, we have introduced a general framework, building on NEMs, to handle hidden combinatorial knock-downs in a probabilistic manner. With NEMix we provide an implementation for inference under unknown pathway stimulation. For the first time, image features are explicitly used on the single-cell level for NEM inference, acknowledging large cell-to-cell variation. We have demonstrated the advantages of NEMix over current NEMs in simulations and inferred highly accurate networks in a case study on HRV infection. Especially, when the underlying true signaling networks are expected to be sparse, NEMix is beneficial. It removes spurious edges introduced due to confounding factors and therefore reduces the false positive rate, a desired property when it comes to validation of edges.</p>
<p>A limitation of the current model formulation is the assumption of independent single cell observations. In reality, this assumption might not be met as cells can be biased due to their location and neighbors. Removing this bias either by normalization or explicit modeling, as for example in [<xref ref-type="bibr" rid="pcbi.1004078.ref014">14</xref>], could further improve the model. Furthermore, in the current data sets cells can be in different cell cycle states. Grouping them according their states may remove further biases, but this clustering task is itself very challenging.</p>
<p>Another general limitation of NEMs and NEMix models is that they cannot learn certain pathway features. From static data, NEMs cannot resolve any loop structures by construction. This is a general problem for network inference without time resolved data. Therefore, only performance statements based on comparing transitively closed pathways can be made. The sampled graphs in the simulation are already transitively closed and since the transitive closure is a feature inherent to all the models we compare, it should not influence the ranking based on their performance. Before comparing a network to the corresponding KEGG pathway, we also built its transitive closure. This fact should be considered when interpreting the inferred models. For example, the model does not allow for distinguishing a feed forward loop from a sequential cascade; however, the hierarchical order of genes in the network would remain the same, and this piece of information does already provide considerable insight into the biological processes. The way we have assessed performance here puts particular emphasis on this hierarchical structure of the network nodes.</p>
<p>Further improvements could be achieved during data preparation. Image segmentation is not always perfect and might introduce technical biases into data sets, adding more confounding factors. If data is not curated carefully, we risk to capture technical biases with the additional hidden variable in NEMix models. Another interesting aspect of the data sets deserving a more thorough analysis, is the nature of the image features themselves. Here, readouts have been used to infer the graph of signaling genes. However, one could investigate in more detail how features are grouped when attaching them to the signaling genes. Some features might not contribute useful information and could be filtered in advance, others might be redundant. Future projects could use the output of NEMix models and seek for biological interpretation of feature correlations.</p>
<p>In case of cell infection screens, infection efficacy was an obvious factor that needed to be addressed. However, the same idea could be applied to other sources of noise. For example, transfection efficacy of the knock-downs could be considered. Quality and efficacy of a knock-down can be quantified by mRNA levels (qPCR) or protein level (western blot analysis) of a gene. However, for high-throughput assays, such confirmation is not available for most gene knock-downs. In order to account for different siRNA transfection efficacies further hidden variables could be introduced. In contrast to the global <italic>Z</italic> variable introduced here, hidden knock-down rates would then be estimated for each gene individually. As a consequence, the complexity of the problem would increase substantially. Instead of one parameter, <italic>n</italic> (number of genes) parameters would have to be estimated. Furthermore, knock-down probabilities could only be estimated from a fraction of the observations (e.g., cells under the specific knock-down). Another drawback is that the increased number of hidden variables gives rise to identifiability problems when estimating infection efficacy in combination with the knock-down rates. For example, if the hidden variable <italic>Z</italic> was only attached to one signaling gene, effects of <italic>Z</italic> and a failed transfection could not be distinguished. Although extending the NEMix model to this situation would be an interesting future project, we believe that problems in the transfection process play an overall minor role. For the current experiments, KIF11 siRNAs (cell killers) were used to control transfection quality on the plate level. For the plates containing the cells used in our analysis, these controls show very high penetrance, i.e., out of an average of 2000 cells per well, on average only 7% of cells survive in these wells. Although this test does not make a statement about the efficacy of individual siRNAs, it ensures the general functioning of the transfection process. Additionally, the library vendor claims the knock-down efficacies achieved with their smart-pool siRNAs to be in the range of 70–95%. This proportion is a result of many possible sources of imperfect gene silencing, including non-transfected cells and off-target effects. Given the above facts in combination with our off-target filtering strategy, we are convinced that the analyzed data are of high quality.</p>
<p>We tried to minimize the general problem of confounding siRNA off-targets by considering only genes targeted by siRNAs with low predicted off-target effects. This selection step helps to achieve reasonably unbiased results with our model, but it also limits the gene sets we can analyze. Ideally, we want to be able to select any gene of interest. This scenario calls for models that can correct the off-target effects on the single-cell level. A potential solution to this issue could be delivered by NEMs directly. We could still learn the networks based on siRNA knock-downs directly, but handle the signal propagation differently. With NEMix it is already possible to use each siRNA as a combinatorial knock-down. In reality however, individual genes are knocked-down to different degrees by an siRNA. In a NEM, this would mean to split up the silencing signal of an siRNA into partial knock-downs of several genes. Then, signal propagation would have to be formulated in a fully probabilistic fashion and NEMs would have to be reformulated such that their nodes do not have binary states anymore. Further developing NEMix, by integrating the above mentioned shortcomings, will make the models more powerful for future network reconstruction tasks.</p>
<p>Especially in the light of single cell data sets, which show large heterogeneity among individual observations, our approach is beneficial. Such data sets are becoming more and more available, and they reveal that the high cell-to-cell variation has severe consequences when summarizing such heterogeneous observations. On the population level, the signal is potentially confounded as it is only contained in part of the observations. NEMix uses the full power of single-cell experiments, as it is applied on the single-cell level directly, avoiding any data averaging. Only at this data resolution, the heterogeneity within a cell population can be accounted for and it becomes possible to investigate potentially confounding factors, such as, for example, pathway activity. NEMix is the first NEM-based method with additional unknown components in the signaling graph Φ. It is capable of inferring these missing data and provides an estimate for the fraction of signal disruption. We find such ambiguous signaling in RNAi infection screens and we have demonstrated that NEMix can improve network inference substantially by accounting for the confounding factor.</p>
</sec>
<sec id="sec007" sec-type="materials|methods">
<title>Models</title>
<sec id="sec008">
<title>The NEM framework</title>
<p>A NEM, as introduced in [<xref ref-type="bibr" rid="pcbi.1004078.ref002">2</xref>], aims to infer the hidden dependency structure among a set of <italic>n</italic> binary signaling variables <bold>𝓢</bold> from the nested structure of <italic>m</italic> observed effect variables 𝓔 (features). It therefore consists of two directed graphs, one describing the dependencies among the signaling genes and one connecting the features to the genes.</p>
<p>The binary adjacency matrix of signaling genes is denoted Φ = (<italic>ϕ</italic><sub><italic>ks</italic></sub>), with <italic>ϕ</italic><sub><italic>ks</italic></sub> = 1 if gene <italic>k</italic> propagates its effects to gene <italic>s</italic> and using the convention Φ<sub><italic>k, k</italic></sub> = 1, for all <italic>k</italic>. The signaling graph Φ is thus always transitively closed. If a gene is silenced, the effect is propagated deterministically along the edges of Φ. The connection of features 𝓔 to the genes <bold>𝓢</bold> is given by parameters <italic>θ</italic><sub><italic>e</italic></sub>, where <italic>θ</italic><sub><italic>e</italic></sub> = <italic>s</italic> indicates that feature <italic>e</italic> is linked to gene <italic>s</italic>. For a gene <italic>k</italic> and a feature <italic>e</italic>, a NEM predicts an effect of <italic>k</italic> on <italic>e</italic> if there is a gene <italic>s</italic> such that <italic>ϕ</italic><sub><italic>ks</italic></sub> = 1 (i.e., <italic>k</italic> and <italic>s</italic> are connected), and <italic>θ</italic><sub><italic>e</italic></sub> = <italic>s</italic> (i.e., <italic>s</italic> has an effect on <italic>e</italic>). The observed data are denoted <italic>D</italic> = (<italic>d</italic><sub><italic>ek</italic></sub>), where each <italic>d</italic><sub><italic>ek</italic></sub> is the measurement of feature <italic>e</italic> under perturbation of <italic>k</italic> (<xref ref-type="fig" rid="pcbi.1004078.g001">Fig. 1A</xref>).</p>
<p>Given an external signal which affects one or more of the signaling genes, each of them will have a binary signaling state. The state value is 0 if the signaling is interrupted, i.e., does not reach the node, and 1 if the signal reaches the node, i.e., the natural state of a stimulated pathway.</p>
<p>For inferring the structure Φ among the signaling genes, we consider its posterior
<disp-formula id="pcbi.1004078.e004"><alternatives><graphic id="pcbi.1004078.e004g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004078.e004"/><mml:math id="M4" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>Φ</mml:mo> <mml:mo>∣</mml:mo> <mml:mi>D</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mi>P</mml:mi> <mml:mo>(</mml:mo> <mml:mi>D</mml:mi> <mml:mo>∣</mml:mo> <mml:mo>Φ</mml:mo> <mml:mo>)</mml:mo> <mml:mi>P</mml:mi> <mml:mo>(</mml:mo> <mml:mo>Φ</mml:mo> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>P</mml:mi> <mml:mo>(</mml:mo> <mml:mi>D</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(3)</label></disp-formula>
where the marginal likelihood <italic>P</italic>(<italic>D</italic>∣Φ) can be obtained by integrating out the connections of features to the genes,
<disp-formula id="pcbi.1004078.e005"><alternatives><graphic id="pcbi.1004078.e005g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004078.e005"/><mml:math id="M5" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>D</mml:mi> <mml:mo>∣</mml:mo> <mml:mo>Φ</mml:mo> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mo>∫</mml:mo> <mml:mi>θ</mml:mi></mml:msub> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>D</mml:mi> <mml:mo>∣</mml:mo> <mml:mo>Φ</mml:mo><mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>∣</mml:mo> <mml:mo>Φ</mml:mo> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>d</mml:mi> <mml:mi>θ</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(4)</label></disp-formula>
with prior distribution <italic>P</italic>(<italic>θ</italic>∣Φ). In the absence of further knowledge, the prior is usually set to the uniform distribution. Given the network structure and assuming conditional independence of the parameters <italic>θ</italic><sub><italic>e</italic></sub> and of the silencing experiments <italic>k</italic>, the marginal likelihood becomes
<disp-formula id="pcbi.1004078.e006"><alternatives><graphic id="pcbi.1004078.e006g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004078.e006"/><mml:math id="M6" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>D</mml:mi> <mml:mo>∣</mml:mo> <mml:mo>Φ</mml:mo> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>e</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>m</mml:mi></mml:munderover> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>s</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:munderover> <mml:mfenced separators="" open="[" close="]"><mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>K</mml:mi></mml:munderover> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>e</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>∣</mml:mo> <mml:mo>Φ</mml:mo><mml:mo>,</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>e</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfenced> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>e</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(5)</label></disp-formula></p>
<p>The local effect likelihoods <italic>P</italic>(<italic>d</italic><sub><italic>ek</italic></sub>∣Φ, <italic>θ</italic>) denote the probability of observing an effect in feature <italic>e</italic> under knock-down of gene <italic>k</italic>. They can usually be pre-computed from the data and different approaches have been proposed [<xref ref-type="bibr" rid="pcbi.1004078.ref002">2</xref>, <xref ref-type="bibr" rid="pcbi.1004078.ref023">23</xref>, <xref ref-type="bibr" rid="pcbi.1004078.ref036">36</xref>]. For the results presented below, log-odds ratios as introduced in [<xref ref-type="bibr" rid="pcbi.1004078.ref036">36</xref>] were used (see ‘Modeling the effect likelihoods’ in <xref ref-type="supplementary-material" rid="pcbi.1004078.s001">S1 Text</xref> for details).</p>
</sec>
<sec id="sec009">
<title>The NEMix model</title>
<p>We first define the NEMix model and then derive it in detail. A NEMix consists of a nested effects model with effects graph Θ and an extended signaling graph Φ. The signaling graph Φ describes the dependency structure among the signaling genes and has an additional binary hidden variable <italic>Z</italic> indicating pathway activity. <italic>Z</italic> is a root of Φ, i.e., it can be connected to any of its nodes and does not have any direct connections to features in <italic>θ</italic>. The silencing probability of <italic>Z</italic> is denoted by <italic>p</italic><sub>0</sub> and is a priory not known. For a set knock-down experiments <italic>k</italic> ∊ {1, …, <italic>K</italic>}, with single cell observations <italic>c</italic> ∊ {1, …, <italic>c</italic><sub><italic>k</italic></sub>} of signaling gens <italic>s</italic> ∊ {1, …, <italic>n</italic>} and features <italic>e</italic> ∊ {1, …, <italic>m</italic>}, the marginal likelihood of a NEMix is
<disp-formula id="pcbi.1004078.e007"><alternatives><graphic id="pcbi.1004078.e007g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004078.e007"/><mml:math id="M7" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>D</mml:mi> <mml:mo>∣</mml:mo> <mml:mo>Φ</mml:mo> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>e</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>m</mml:mi></mml:munderover> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>s</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:munderover> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>e</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>K</mml:mi></mml:munderover> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>c</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:msub><mml:mi>c</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:munderover> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>∊</mml:mo> <mml:mo>{</mml:mo> <mml:mn>0</mml:mn><mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>}</mml:mo></mml:mrow></mml:munder> <mml:msub><mml:mi>p</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>e</mml:mi> <mml:mi>k</mml:mi> <mml:mi>c</mml:mi></mml:mrow></mml:msub> <mml:mo>∣</mml:mo> <mml:mo>Φ</mml:mo><mml:mo>,</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>e</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi>s</mml:mi><mml:mo>,</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>c</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mi>j</mml:mi> <mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(6)</label></disp-formula>
where <italic>p</italic><sub><italic>j</italic></sub> = <italic>P</italic>(<italic>Z</italic><sub><italic>k</italic></sub> = <italic>j</italic>).</p>
<sec id="sec010">
<title>Probabilistic combinatorial knock-downs</title>
<p>We first extend the model to cope with several silenced genes at the same time. To achieve this goal, we condition the perturbation state of each gene on the states of its parents. For each knock-down experiment <italic>k</italic> ∊ {1, …, <italic>K</italic>}, let <bold>𝓢</bold><sub><italic>k</italic></sub> ⊆ <bold>𝓢</bold> be the set of genes knocked down at the same time in experiment <italic>k</italic>. We assume for combinatorial silencing events that we observe an effect on feature <italic>e</italic> if it can be reached by either of the genes in <bold>𝓢</bold><sub><italic>k</italic></sub> through a path in Φ. Let furthermore <italic>S</italic><sub><italic>sk</italic></sub> be the hidden binary random variable for the silencing state of gene <italic>s</italic> under knock-down of <bold>𝓢</bold><sub><italic>k</italic></sub>. Then <italic>S</italic><sub><italic>sk</italic></sub> = 0 if the gene is perturbed and <italic>S</italic><sub><italic>sk</italic></sub> = 1 if it is not. If <italic>s</italic> ∊ <bold>𝓢</bold><sub><italic>k</italic></sub>, then <italic>S</italic><sub><italic>sk</italic></sub> is set to zero but otherwise its value depends on the states of the parents of <italic>s, S</italic><sub><italic>pa</italic>(<italic>s</italic>)<italic>k</italic></sub> ∊ {0, 1}<sup>∣<italic>pa</italic>(<italic>s</italic>)∣</sup>, through the conditional probability <italic>P</italic>(<italic>S</italic><sub><italic>sk</italic></sub>∣<italic>S</italic><sub><italic>pa</italic>(<italic>s</italic>)<italic>k</italic></sub>).</p>
<p>The local effect likelihoods are then given by the marginalization over <italic>S</italic><sub><italic>sk</italic></sub>,
<disp-formula id="pcbi.1004078.e008"><alternatives><graphic id="pcbi.1004078.e008g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004078.e008"/><mml:math id="M8" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>e</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>∣</mml:mo> <mml:mo>Φ</mml:mo><mml:mo>,</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>e</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>x</mml:mi> <mml:mo>∊</mml:mo> <mml:mo>{</mml:mo> <mml:mn>0</mml:mn><mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>}</mml:mo></mml:mrow></mml:munder> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>e</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>∣</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>e</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi>s</mml:mi><mml:mo>,</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>s</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>s</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(7)</label></disp-formula>
where <italic>P</italic>(<italic>S</italic><sub><italic>sk</italic></sub>) is the probability of gene <italic>s</italic> being active in experiment <italic>k</italic>. If the state <italic>S</italic><sub><italic>sk</italic></sub> depends on the states of the parent nodes, one can deduce the marginal <italic>P</italic>(<italic>S</italic><sub><italic>sk</italic></sub>) from the joint distribution <italic>P</italic>(<italic>S</italic>) = <italic>P</italic>(<italic>S</italic><sub>1<italic>k</italic></sub>, …, <italic>S</italic><sub><italic>nk</italic></sub>) of the signaling graph Φ. The joint probability factorizes when conditioning on the parent nodes,
<disp-formula id="pcbi.1004078.e009"><alternatives><graphic id="pcbi.1004078.e009g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004078.e009"/><mml:math id="M9" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>s</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo> <mml:mo>…</mml:mo><mml:mo>,</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>s</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn><mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo> <mml:mspace width="0.166667em"/><mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>s</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn><mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo> <mml:mo>…</mml:mo><mml:mo>,</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo> <mml:mo>…</mml:mo><mml:mo>,</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(8)</label></disp-formula></p>
<p>However, for all signaling genes in <bold>𝓢</bold><sub><italic>k</italic></sub>, we know that their state is 0, independent of their parents. So in fact, we only need to sum over all genes <bold>𝓢</bold><sub><italic>a, k</italic></sub> = {<italic>S</italic><sub>1, <italic>k</italic></sub>, …, <italic>S</italic><sub><italic>s</italic>−1, <italic>k</italic></sub>, <italic>S</italic><sub><italic>s</italic>+1, <italic>k</italic></sub>, …, <italic>S</italic><sub><italic>n, k</italic></sub>} that are not in the set of knock-down genes <bold>𝓢</bold><sub><italic>k</italic></sub>, except for gene <italic>s</italic> itself:
<disp-formula id="pcbi.1004078.e010"><alternatives><graphic id="pcbi.1004078.e010g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004078.e010"/><mml:math id="M10" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>s</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:msub><mml:mi>𝓢</mml:mi> <mml:mi>a</mml:mi></mml:msub></mml:munder> <mml:munder><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>∉</mml:mo> <mml:msub><mml:mi>𝓢</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:munder> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>∣</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>p</mml:mi> <mml:mi>a</mml:mi> <mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:munder><mml:munder accentunder="true"><mml:mrow><mml:msub><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>∊</mml:mo> <mml:msub><mml:mi>𝓢</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:msub> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mo>︸</mml:mo></mml:munder> <mml:mrow><mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:munder><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(9)</label></disp-formula></p>
<p>If <italic>s</italic> ∊ <bold>𝓢</bold><sub><italic>k</italic></sub>, then <italic>P</italic>(<italic>S</italic><sub><italic>sk</italic></sub> = 0) = 1. Substituting (<xref ref-type="disp-formula" rid="pcbi.1004078.e008">7</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1004078.e010">9</xref>) into the marginal likelihood (<xref ref-type="disp-formula" rid="pcbi.1004078.e006">5</xref>) leads to
<disp-formula id="pcbi.1004078.e011"><alternatives><graphic id="pcbi.1004078.e011g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004078.e011"/><mml:math id="M11" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>D</mml:mi> <mml:mo>∣</mml:mo> <mml:mo>Φ</mml:mo> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>e</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>m</mml:mi></mml:munderover> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>s</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:munderover> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>e</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>K</mml:mi></mml:munderover> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>x</mml:mi> <mml:mo>∊</mml:mo> <mml:mo>{</mml:mo> <mml:mn>0</mml:mn><mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>}</mml:mo></mml:mrow></mml:munder> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>e</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>∣</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>e</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi>s</mml:mi><mml:mo>,</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>s</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:munder><mml:mo>∑</mml:mo> <mml:msub><mml:mi>𝓢</mml:mi> <mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:munder> <mml:munder><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>∉</mml:mo> <mml:msub><mml:mi>𝓢</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:munder> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>∣</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>p</mml:mi> <mml:mi>a</mml:mi> <mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(10)</label></disp-formula></p>
<p>The conditional local effect likelihoods <italic>P</italic>(<italic>d</italic><sub><italic>ek</italic></sub>∣<italic>θ</italic><sub><italic>e</italic></sub> = <italic>s, S</italic><sub><italic>sk</italic></sub> = <italic>x</italic>) can usually be pre-computed (see ‘Modeling the effect likelihoods’ in <xref ref-type="supplementary-material" rid="pcbi.1004078.s001">S1 Text</xref>).</p>
</sec>
<sec id="sec011">
<title>Deterministic combinatorial knock-downs</title>
<p>If we assume deterministic signaling and all knock-downs are known, then <italic>P</italic>(<italic>S</italic><sub><italic>sk</italic></sub>) will either be 0 or 1. As mentioned above, we assume a gene to be perturbed if at least one of its parents is perturbed, and unperturbed if none of the parents are perturbed. For transitively closed NEMs this also means <italic>S</italic><sub><italic>sk</italic></sub> = 0 if and only if <bold>𝓢</bold><sub><italic>k</italic></sub>∩<italic>pa</italic>(<italic>s</italic>) ≠ ∅, i.e., only if the parents of <italic>s</italic> contain one of the knocked-down genes, then <italic>s</italic> itself can be perturbed. Therefore, the conditional probabilities <italic>P</italic>(<italic>S</italic><sub><italic>sk</italic></sub>∣<italic>S</italic><sub><italic>pa</italic>(<italic>s</italic>)<italic>k</italic></sub>) are in this case
<disp-formula id="pcbi.1004078.e012"><alternatives><graphic id="pcbi.1004078.e012g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004078.e012"/><mml:math id="M12" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>∣</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfenced separators="" open="{" close=""><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mn>1</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext><mml:mspace width="4.pt"/><mml:mo>(</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mspace width="4.pt"/><mml:mtext>or</mml:mtext><mml:mspace width="4.pt"/><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>∅</mml:mi><mml:mo>)</mml:mo><mml:mspace width="4.pt"/><mml:mtext>and</mml:mtext><mml:mspace width="4.pt"/><mml:mi>s</mml:mi><mml:mo>∉</mml:mo><mml:msub><mml:mi>𝓢</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mtext>otherwise</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>∣</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>∣</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(11)</label></disp-formula></p>
<p>Since these probabilities are either 0 or 1, we use the following indicator function
<disp-formula id="pcbi.1004078.e013"><alternatives><graphic id="pcbi.1004078.e013g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004078.e013"/><mml:math id="M13" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>δ</mml:mi> <mml:mrow><mml:mi>s</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>≔</mml:mo> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>s</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>s</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>∣</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>p</mml:mi> <mml:mi>a</mml:mi> <mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(12)</label></disp-formula></p>
<p>The last equation holds, because for
<disp-formula id="pcbi.1004078.e014"><alternatives><graphic id="pcbi.1004078.e014g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004078.e014"/><mml:math id="M14" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>s</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>p</mml:mi> <mml:mi>a</mml:mi> <mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:munder> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>s</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>p</mml:mi> <mml:mi>a</mml:mi> <mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>p</mml:mi> <mml:mi>a</mml:mi> <mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:munder> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>s</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>∣</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>p</mml:mi> <mml:mi>a</mml:mi> <mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>p</mml:mi> <mml:mi>a</mml:mi> <mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(13)</label></disp-formula>
all terms <italic>P</italic>(<italic>S</italic><sub><italic>pa</italic>(<italic>s</italic>)<italic>k</italic></sub>) except for one parent configuration are zero. The local effect likelihoods can then be written as
<disp-formula id="pcbi.1004078.e015"><alternatives><graphic id="pcbi.1004078.e015g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004078.e015"/><mml:math id="M15" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>e</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>∣</mml:mo> <mml:mo>Φ</mml:mo><mml:mo>,</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>e</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>x</mml:mi> <mml:mo>∊</mml:mo> <mml:mo>{</mml:mo> <mml:mn>0</mml:mn><mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>}</mml:mo></mml:mrow></mml:munder> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>e</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>∣</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>e</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi>s</mml:mi><mml:mo>,</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>s</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>δ</mml:mi> <mml:mrow><mml:mi>s</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd> <mml:mtd><mml:mrow><mml:mo>=</mml:mo> <mml:mfenced separators="" open="{" close=""><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mi>P</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>e</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>∣</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>e</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi>s</mml:mi><mml:mo>,</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>s</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext> <mml:mspace width="4.pt"/><mml:msub><mml:mi>δ</mml:mi> <mml:mrow><mml:mi>s</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mi>P</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>e</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>∣</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>e</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi>s</mml:mi><mml:mo>,</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>s</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext> <mml:mspace width="4.pt"/><mml:msub><mml:mi>δ</mml:mi> <mml:mrow><mml:mi>s</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(14)</label></disp-formula>
which resembles the situation introduced in [<xref ref-type="bibr" rid="pcbi.1004078.ref006">6</xref>] for dynamic NEMs. However, in the following we make use of the more general case.</p>
</sec>
<sec id="sec012">
<title>Hidden pathway stimulation</title>
<p>We now turn to a special case, where exactly one (root) node of the network has probabilistic signaling and the others follow the deterministic rules above. Silencing experiments can be noisy for many different reasons and it might be unknown whether the signaling pathway of interest is actually activated during knock-down of a gene. To model this uncertainty, we consider an additional hidden binary random variable <italic>Z</italic><sub><italic>k</italic></sub>, indicating the state of an external signal that activates the pathway, where <italic>Z</italic><sub><italic>k</italic></sub> = 1 means active and <italic>Z</italic><sub><italic>k</italic></sub> = 0 means inactive in experiment <italic>k</italic>. The random variable <italic>Z</italic> can be viewed as an additional node in Φ that has only outgoing edges and can not have any observables directly attached to it (see <xref ref-type="fig" rid="pcbi.1004078.g001">Fig. 1B</xref> for an example). Let furthermore <italic>p</italic><sub>0</sub> = <italic>P</italic>(<italic>Z</italic><sub><italic>k</italic></sub> = 0) be the probability that the signaling pathway has not been activated, and <italic>p</italic><sub>1</sub> = <italic>P</italic>(<italic>Z</italic><sub><italic>k</italic></sub> = 1) = 1 − <italic>p</italic><sub>0</sub> the probability that it is active. The silencing of genes <bold>𝓢</bold><sub><italic>k</italic></sub> together with a unknown pathway stimulation can then be regarded as a hidden combinatorial knock-down event, where signaling genes <bold>𝓢</bold><sub><italic>k</italic></sub> are silenced deterministically and the external signal <italic>Z</italic><sub><italic>k</italic></sub> is inactivated with probability <italic>p</italic><sub>0</sub>. <xref ref-type="fig" rid="pcbi.1004078.g001">Fig. 1B</xref> illustrates a simple NEMix with the additional pathway state variable. Since <italic>Z</italic> has no parents, we can easily factorize <italic>p</italic><sub><italic>j</italic></sub> out of the joint probability of the states <italic>P</italic>(<italic>S</italic>) in (<xref ref-type="disp-formula" rid="pcbi.1004078.e010">9</xref>) to obtain
<disp-formula id="pcbi.1004078.e016"><alternatives><graphic id="pcbi.1004078.e016g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004078.e016"/><mml:math id="M16" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>s</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>∊</mml:mo> <mml:mo>{</mml:mo> <mml:mn>0</mml:mn><mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>}</mml:mo></mml:mrow></mml:munder> <mml:msub><mml:mi>p</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>∙</mml:mo> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>s</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>∣</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi>j</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>∊</mml:mo> <mml:mo>{</mml:mo> <mml:mn>0</mml:mn><mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>}</mml:mo></mml:mrow></mml:munder> <mml:msub><mml:mi>p</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>∙</mml:mo> <mml:msubsup><mml:mi>δ</mml:mi> <mml:mrow><mml:mi>s</mml:mi> <mml:mi>k</mml:mi></mml:mrow> <mml:mi>j</mml:mi></mml:msubsup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(15)</label></disp-formula>
where <inline-formula id="pcbi.1004078.e017"><mml:math id="M17" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>δ</mml:mi> <mml:mrow><mml:mi>s</mml:mi> <mml:mi>k</mml:mi></mml:mrow> <mml:mi>j</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:mi>P</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>s</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>∣</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi>j</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is again an indicator function for the state of <italic>s</italic> in experiment <italic>k</italic>, given that the pathway is in state <italic>j</italic>. Substituting this expression into the local effect likelihoods (<xref ref-type="disp-formula" rid="pcbi.1004078.e008">7</xref>) leads to
<disp-formula id="pcbi.1004078.e018"><alternatives><graphic id="pcbi.1004078.e018g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004078.e018"/><mml:math id="M18" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>e</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>∣</mml:mo> <mml:mo>Φ</mml:mo><mml:mo>,</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>e</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>s</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>∊</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:mn>0</mml:mn><mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:munder> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>e</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>∣</mml:mo> <mml:mo>Φ</mml:mo><mml:mo>,</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>e</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi>s</mml:mi><mml:mo>,</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>s</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>∊</mml:mo> <mml:mo>{</mml:mo> <mml:mn>0</mml:mn><mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>}</mml:mo></mml:mrow></mml:munder> <mml:msub><mml:mi>p</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>∙</mml:mo> <mml:msubsup><mml:mi>δ</mml:mi> <mml:mrow><mml:mi>s</mml:mi> <mml:mi>k</mml:mi></mml:mrow> <mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd> <mml:mtd><mml:mrow><mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>∊</mml:mo> <mml:mo>{</mml:mo> <mml:mn>0</mml:mn><mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>}</mml:mo></mml:mrow></mml:munder> <mml:msub><mml:mi>p</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>∙</mml:mo> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>e</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>∣</mml:mo> <mml:mo>Φ</mml:mo><mml:mo>,</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>e</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi>s</mml:mi><mml:mo>,</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi>j</mml:mi> <mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(16)</label></disp-formula>
and the marginal likelihood (<xref ref-type="disp-formula" rid="pcbi.1004078.e011">10</xref>) becomes
<disp-formula id="pcbi.1004078.e019"><alternatives><graphic id="pcbi.1004078.e019g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004078.e019"/><mml:math id="M19" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>D</mml:mi> <mml:mo>∣</mml:mo> <mml:mo>Φ</mml:mo> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>e</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>m</mml:mi></mml:munderover> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>s</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:munderover> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>e</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>K</mml:mi></mml:munderover> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>∊</mml:mo> <mml:mo>{</mml:mo> <mml:mn>0</mml:mn><mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>}</mml:mo></mml:mrow></mml:munder> <mml:msub><mml:mi>p</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>e</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>∣</mml:mo> <mml:mo>Φ</mml:mo><mml:mo>,</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>e</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi>s</mml:mi><mml:mo>,</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi>j</mml:mi> <mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(17)</label></disp-formula></p>
<p>For the RNAi infection experiments described in the introduction and the results, pathways of interest are those involved in infection signaling, i.e., pathways which are activated upon signals triggered by a pathogen. However, infection of a cell is a stochastic event, depending on many factors, for example, whether at all a pathogen docked on successfully to the cell. Consequently, in a cell with a silenced gene, there can be several explanations for why it stayed uninfected. It could be because the knocked-down gene was important for the infection signaling, but there is also a chance that other factors account for this, for example, no pathogen came within reach of the cell. In case a pathogen triggered a signal, the pathway is considered active (<italic>Z</italic><sub><italic>k</italic></sub> = 1), corresponding to a normal NEM. When no infection attempt was made, the infection pathway is inactive (<italic>Z</italic><sub><italic>k</italic></sub> = 0).</p>
<p>The population of cells in knock-down experiment <italic>k</italic> can be divided into infected and uninfected cells. For infected cells, the external input signal from the pathogen reached the cell and the signaling pathway is active (<italic>Z</italic><sub><italic>k</italic></sub> = 1). In these cases <italic>Z</italic> is observed. For uninfected cells, however the state of <italic>Z</italic><sub><italic>k</italic></sub> is unknown and no longer deterministic. So, for an infected cell, we have <italic>P</italic>(<italic>Z</italic><sub><italic>k</italic></sub> = 0) = 0 and <italic>P</italic>(<italic>Z</italic><sub><italic>k</italic></sub> = 1) = 1, whereas for an uninfected cell, we have <italic>P</italic>(<italic>Z</italic><sub><italic>k</italic></sub> = 0) = <italic>p</italic><sub>0</sub> and <italic>P</italic>(<italic>Z</italic><sub><italic>k</italic></sub> = 1) = <italic>p</italic><sub>1</sub>. Here, <italic>p</italic><sub>0</sub> is the probability that the signaling pathway has not been activated by the pathogen and <italic>p</italic><sub>0</sub> + <italic>p</italic><sub>1</sub> = 1. This is exactly the above situation of a hidden combinatorial knock-down and the additional model parameter <italic>p</italic><sub><italic>j</italic></sub>, <italic>j</italic> ∊ {0, 1} either needs to be estimated for each observation, or it has to be integrated out.</p>
</sec>
<sec id="sec013">
<title>Learning from single-cell data</title>
<p>As illustrated in the infection experiment example above, in general, the signaling state <italic>Z</italic><sub><italic>k</italic></sub> can be different for each individual cell <italic>c</italic> in an experiment <italic>k</italic>, and therefore we have to treat each cell as an individual observation. Regarding single cells as independent, for a given network structure Φ, the local likelihoods further decompose into
<disp-formula id="pcbi.1004078.e020"><alternatives><graphic id="pcbi.1004078.e020g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004078.e020"/><mml:math id="M20" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>e</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>∣</mml:mo> <mml:mo>Φ</mml:mo><mml:mo>,</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>e</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>c</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:msub><mml:mi>c</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:munderover> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>e</mml:mi> <mml:mi>k</mml:mi> <mml:mi>c</mml:mi></mml:mrow></mml:msub> <mml:mo>∣</mml:mo> <mml:mo>Φ</mml:mo><mml:mo>,</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>e</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(18)</label></disp-formula>
where <italic>c</italic><sub><italic>k</italic></sub> is the number of cells in experiment <italic>k</italic>. Instead of a single number, now <italic>S</italic><sub><italic>sk</italic></sub> = (<italic>S</italic><sub><italic>skc</italic></sub>)<sub><italic>c</italic> = 1, …, <italic>c</italic><sub><italic>k</italic></sub></sub> is a vector where each <italic>S</italic><sub><italic>skc</italic></sub> is the state of gene <italic>s</italic> in cell <italic>c</italic> under knock-down <italic>k</italic>. With this modification, the marginal likelihood expands to
<disp-formula id="pcbi.1004078.e021"><alternatives><graphic id="pcbi.1004078.e021g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004078.e021"/><mml:math id="M21" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>D</mml:mi> <mml:mo>∣</mml:mo> <mml:mo>Φ</mml:mo> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>e</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>m</mml:mi></mml:munderover> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>s</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:munderover> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>e</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>K</mml:mi></mml:munderover> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>c</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:msub><mml:mi>c</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:munderover> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>∊</mml:mo> <mml:mo>{</mml:mo> <mml:mn>0</mml:mn><mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>}</mml:mo></mml:mrow></mml:munder> <mml:msub><mml:mi>p</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>e</mml:mi> <mml:mi>k</mml:mi> <mml:mi>c</mml:mi></mml:mrow></mml:msub> <mml:mo>∣</mml:mo> <mml:mo>Φ</mml:mo><mml:mo>,</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>e</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi>s</mml:mi><mml:mo>,</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>c</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mi>j</mml:mi> <mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(19)</label></disp-formula></p>
<p>In other words, for each cell, there will be an effect of the perturbation set <bold>𝓢</bold><sub><italic>k</italic></sub> on feature <italic>e</italic> if any of the perturbations reach gene <italic>s</italic> and <italic>e</italic> is connected to <italic>s</italic>.</p>
</sec>
<sec id="sec014">
<title>Model identifiability</title>
<p>As shown in [<xref ref-type="bibr" rid="pcbi.1004078.ref036">36</xref>], NEMs have unidentifiable components. If two nodes share the same set of parents, then these two nodes are indistinguishable. Furthermore, NEMs are unique only up to reversals, i.e., different parametrizations can exist for the same model that explain the data equally well. Such equivalent representations are related by cyclic node permutations, ΦΘ = Φ′Θ′ with (Φ′, Θ′) = (Φ<italic>S</italic><sup>−1</sup>, <italic>S</italic>Θ) and permutation matrix <italic>S</italic> reversing cycles in Φ. This result still holds when adding the additional hidden pathway state <italic>Z</italic>.</p>
<p>Regarding inference of the new parameter <italic>p</italic><sub>0</sub>, there are only few situations in which <italic>p</italic> cannot be learned. For a NEMix model with given graphs Φ and Θ, the pathway inactivation probability <italic>p</italic><sub>0</sub> of its hidden pathway activity <italic>Z</italic> is not identifiable, if and only if either (1) there are no observables from 𝓔 attached downstream of <italic>Z</italic>, or (2) <italic>Z</italic> is connected only to sub-components of a network that are always perturbed (for a proof, see ‘Unidentifiable parameters’ in <xref ref-type="supplementary-material" rid="pcbi.1004078.s001">S1 Text</xref>). Both conditions are rather artificial cases. The first one describes the situation where some signaling genes do not have any features attached and <italic>Z</italic> is connected only to these. In this case, there are no observations from which <italic>p</italic><sub>0</sub> can be estimated. However, usually we assume a uniform attachment of features to the genes and models containing genes without any downstream features are hardly ever observed. The interpretation of the second condition is that only genes which receive a propagated signal from all other genes in the network are affected by the pathway deactivation. Here, <italic>p</italic><sub>0</sub> cannot be estimated because all observations downstream of <italic>Z</italic> will show an effect, independent of the state of <italic>Z</italic>. Again, it appears rather exceptional that only the final node of a signaling cascade is affected by a pathway deactivation.</p>
</sec>
</sec>
<sec id="sec015">
<title>NEMix inference</title>
<p>Structure learning is performed using a greedy heuristic to find an optimal network. Similar to the NEM procedure described in [<xref ref-type="bibr" rid="pcbi.1004078.ref003">3</xref>], edges are incrementally added if the likelihood is increased (see ‘Structure learning’ in <xref ref-type="supplementary-material" rid="pcbi.1004078.s001">S1 Text</xref>). In addition, our approach is restricted to structures without incoming edges into the hidden root <italic>Z</italic>. We initialize the algorithm with a set of initial networks. These consist of the empty graph and one edge connecting <italic>Z</italic> to one of the knock-down genes. Additionally, we limit the out-degree of <italic>Z</italic> to two. Here, by out-degree we mean only the non-transitive edges. We still allow the insertion of transitive edges from <italic>Z</italic> to any signaling gene, which has to be added in order to fulfill the transitivity requirement. This regularization reduces the search space and prevents that too many dependencies between genes are explained by <italic>Z</italic> alone.</p>
<p>As for classic NEMs, network structure scoring involves the marginal likelihood. For the NEMix model, <italic>P</italic>(<bold>𝒟</bold>∣Φ) cannot be optimized analytically. Marginalization over the feature attachments is omitted in our extended model. Instead, we estimate <italic>θ</italic> jointly with <italic>p</italic> during model inference. To do so, we approximate the marginal likelihood (<xref ref-type="disp-formula" rid="pcbi.1004078.e011">10</xref>) by the expectation of the complete data log-likelihood
<disp-formula id="pcbi.1004078.e022"><alternatives><graphic id="pcbi.1004078.e022g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004078.e022"/><mml:math id="M22" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>D</mml:mi><mml:mo>,</mml:mo> <mml:mi>Z</mml:mi> <mml:mo>∣</mml:mo> <mml:mo>Φ</mml:mo><mml:mo>,</mml:mo> <mml:mi>θ</mml:mi><mml:mo>,</mml:mo> <mml:mi>p</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>K</mml:mi></mml:munderover> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>c</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:msub><mml:mi>c</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:munderover> <mml:munder><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>∊</mml:mo> <mml:mo>{</mml:mo> <mml:mn>0</mml:mn><mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>}</mml:mo></mml:mrow></mml:munder> <mml:msup><mml:mfenced separators="" open="[" close="]"><mml:msub><mml:mi>p</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>e</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>m</mml:mi></mml:munderover> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>e</mml:mi> <mml:mi>k</mml:mi> <mml:mi>c</mml:mi></mml:mrow></mml:msub> <mml:mo>∣</mml:mo> <mml:mo>Φ</mml:mo><mml:mo>,</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>e</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi>s</mml:mi><mml:mo>,</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>c</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mi>j</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfenced> <mml:msubsup><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>c</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(20)</label></disp-formula>
with respect to <italic>Z</italic>, where <italic>θ</italic> and <italic>p</italic><sub>0</sub> need to be efficiently estimated. For this task we have developed an EM algorithm. A derivation of the expected hidden log-likelihood and the maximum likelihood estimates is given in ‘Estimating the hidden signal’ of <xref ref-type="supplementary-material" rid="pcbi.1004078.s001">S1 Text</xref>. When starting the EM algorithm, <italic>p</italic><sub>0</sub> is initialized with a random draw from the uniform distribution and for <italic>θ</italic> we use a uniform initial configuration.</p>
</sec>
<sec id="sec016">
<title>Implementation</title>
<p>The NEMix model is included as part of the R/Bioconductor package NEM as an additional inference type. It is invoked by calling the package’s main function NEM(data, inference = ‘NEM.greedy’, control) and choosing the inference type control$type = ‘NEMix’. (See ‘NEMix implementation in NEM package’ in <xref ref-type="supplementary-material" rid="pcbi.1004078.s001">S1 Text</xref> for more detailed instructions on the implementation and usage of NEMix in R). To record run-times of NEMix model estimation, simulations were run without any parallelization on a 1.7GHz Intel i7 machine. Only one starting configuration was used, and EM iterations were performed using three restarts to avoid local optima that are globally suboptimal. For realistic data sets of 300 features and 200 cells per knock-down, NEMix estimation took on average nine minutes for 5-gene networks, with an average of 13 iteration steps until convergence of the EM algorithm. For the 8-gene network, the average run-time was 66 minutes, while the average number of iterations per EM round remained 13 also for these larger networks. The longer run-times of NEMix models as compared to NEMs are primarily due to the hidden data estimation. Each structure scored once in a NEM inference, needs to be scored 40 times on average during NEMix estimation. In addition, the input data sets are roughly 200 times larger.</p>
</sec>
</sec>
<sec id="sec017">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1004078.s001" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004078.s001" mimetype="application/pdf" xlink:type="simple">
<label>S1 Text</label>
<caption>
<title>Supplementary texts.</title>
<p>The supplementary text contains additional information regarding the NEMIX model, description and pre-processing of the data sets, as well as a short usage description of the NEMIX code in the R package nem.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004078.s002" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004078.s002" mimetype="application/postscript" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Sample networks.</title>
<p>All 30 sample networks were randomly generated from the KEGG graph using a random walk along the edges. Unidentifiable structures were omitted. The blue node marks the randomly added hidden signal.</p>
<p>(EPS)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004078.s003" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004078.s003" mimetype="application/postscript" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Performance for varying <italic>p</italic><sub>0</sub>.</title>
<p>For each of the 30 generated networks, 50 data set were drawn. In (A) the area under the ROC curve (AUC) was calculated based on edge frequencies of the samples. The right most panel displays the result for all values of <italic>p</italic><sub>0</sub> jointly. Sub-figure (B) shows the area under the PR curve (AUPRC).</p>
<p>(EPS)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004078.s004" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004078.s004" mimetype="application/postscript" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Accuracy values per network.</title>
<p>For each of the 30 generated networks, 50 data sets were drawn. Then, the accuracy (ACC) was calculated based on edge frequencies of the samples.</p>
<p>(EPS)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004078.s005" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004078.s005" mimetype="application/postscript" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>Estimated values for <italic>p</italic><sub>0</sub>.</title>
<p>For each of the 30 generated networks, 50 data sets were drawn. The distribution of the estimated <italic>p</italic><sub>0</sub> per network is shown. Each row represents a different true signal disruption probability.</p>
<p>(EPS)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004078.s006" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004078.s006" mimetype="application/postscript" xlink:type="simple">
<label>S5 Fig</label>
<caption>
<title>Inferred pathway states <italic>Z</italic>.</title>
<p>For each of the 30 generated networks, 50 data sets were drawn. Percentage of correctly inferred state values of <italic>Z</italic> for the sample data sets is shown for each of generated networks.</p>
<p>(EPS)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004078.s007" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004078.s007" mimetype="application/postscript" xlink:type="simple">
<label>S6 Fig</label>
<caption>
<title>Performance for larger network sizes.</title>
<p>To assess the edge recovery performance for larger NEMix models, we ran a reduced simulation study. We sampled 30 random networks of network size <italic>n</italic> = 5, 10, and 15 genes. The hidden variable <italic>Z</italic> was again attached randomly to at most 2 of the signaling genes (plus additional transitive edges). We fixed <italic>p</italic><sub>0</sub> to 0.4, which is close to our application example. For each network, we then generated 30 data sets of 300 features from 200 cells per each knock-down. For run-time reasons we only initiated the structure search with the empty network and used just 2 restarts for the EM runs. This reduces performance of network learning but shows how the overall performance scales with growing network size. Even for larger networks performance is still very good as can be seen from the area under ROC curve (A), area under precision-recall curve (AUPRC; B) and accuracy (C). Estimation of <italic>p</italic><sub>0</sub> becomes even more precise for larger <italic>n</italic>, as shown in (D) by the absolute distance of the sampled from the estimated <italic>p</italic><sub>0</sub>. Run-time on the other hand increases substantially for larger networks. Panel (E) shows the run-times per network estimation in minutes.</p>
<p>(EPS)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004078.s008" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004078.s008" mimetype="application/postscript" xlink:type="simple">
<label>S7 Fig</label>
<caption>
<title>Performance of feature attachments <italic>θ</italic>.</title>
<p>For each of the 30 generated networks, 50 data sets were drawn. In (A) the percentage of correctly inferred feature attachments are displayed and (B) shows the percentage of correctly filtered uninformative features. Both plots show results for different fractions of signal disruption <italic>p</italic><sub>0</sub>.</p>
<p>(EPS)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004078.s009" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004078.s009" mimetype="application/postscript" xlink:type="simple">
<label>S8 Fig</label>
<caption>
<title>Network wise performance of feature attachments <italic>θ</italic>.</title>
<p>For each of the 30 generated networks, 50 data sets were drawn. In (A) the percentage of correctly inferred feature attachments are displayed and (B) shows the percentage of correctly filtered uninformative features, for each individual network.</p>
<p>(EPS)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004078.s010" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004078.s010" mimetype="application/postscript" xlink:type="simple">
<label>S9 Fig</label>
<caption>
<title>GSEA for reliable siRNAs.</title>
<p>To see if KEGG pathways are affected differently by off-targeting siRNAs, we performed a gene set enrichment analysis [<xref ref-type="bibr" rid="pcbi.1004078.ref032">32</xref>] on the siRNA scores, using the implementation in the R package ‘HTSanalyzR’ [<xref ref-type="bibr" rid="pcbi.1004078.ref037">37</xref>].</p>
<p>(EPS)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004078.s011" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004078.s011" mimetype="application/postscript" xlink:type="simple">
<label>S10 Fig</label>
<caption>
<title>Inferred 8 gene MAPK networks on HRV infection data.</title>
<p>Best networks of the 8 top scoring siRNAs from the MAPK pathway for HRV infection for the different compared methods are displayed. (A) shows the known KEGG pathway. (B) is the inferred NEM and (C) the sc-NEM. (D) left shows the known network with the most likely attachment of the hidden variable <italic>Z</italic> (blue) and (E) is the inferred NEMix. For all networks their performance is summarized in <xref ref-type="supplementary-material" rid="pcbi.1004078.s019">S1 Table</xref>.</p>
<p>(EPS)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004078.s012" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004078.s012" mimetype="application/postscript" xlink:type="simple">
<label>S11 Fig</label>
<caption>
<title>Performance of MAPK network inference.</title>
<p>We computed the specificity (A) and sensitivity (B) for all compared methods, based on 50 bootstrap samples. Both plots show the results for 5 and 8 signaling genes with top scoring siRNAs, using the HRV infection data. Sub-figure (C) shows robustness of inferred pathway activity. The estimated pathway activity for 5 and 8 gene networks, derived from the 50 bootstrap samples is shown. <italic>p</italic><sub>0</sub> shows little variation and is similar for both networks.</p>
<p>(EPS)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004078.s013" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004078.s013" mimetype="application/postscript" xlink:type="simple">
<label>S12 Fig</label>
<caption>
<title>Consensus networks for MAPK pathway.</title>
<p>Consensus networks for 5 genes (A) and 8 genes (B) are displays. Shown are all edges with frequency of at least 0.7 in the 50 bootstrap samples. NEMix inference was run using the 16 different starting configurations. For each bootstrap sample the best solution was chosen.</p>
<p>(EPS)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004078.s014" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004078.s014" mimetype="application/postscript" xlink:type="simple">
<label>S13 Fig</label>
<caption>
<title>Feature attachments for the 5 MAPK pathway genes.</title>
<p>Histograms show the selection frequencies for image features from 50 bootstrap samples on the HRV infection data.</p>
<p>(EPS)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004078.s015" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004078.s015" mimetype="application/postscript" xlink:type="simple">
<label>S14 Fig</label>
<caption>
<title>Shared feature usage for compared methods.</title>
<p>The Venn diagrams compare frequently attached features (left) and never attached features (right) based on the 50 bootstrap samples. Results for the 5 gene network are shown in the top row and for the 8 gene network in the bottom row.</p>
<p>(EPS)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004078.s016" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004078.s016" mimetype="application/postscript" xlink:type="simple">
<label>S15 Fig</label>
<caption>
<title>Uninformative features for the 5-gene network.</title>
<p>Each row shows the probability for one feature of being attached to each of the genes in the network or the null node. For all features in this plot, the null node had the highest probability, which means, they are filtered out. Features are colored by the channel they were measured from. These channels are, fluorescence of DNA in the nucleus (blue), fluorescence of actin (red), fluorescence of cell internal pathogens (green). Furthermore there are general location and orientation features (black). The measurements themselves then give information on intensity, shape, texture or neighbors of the objects segmented from the images. These objects are ‘Cells’: the cell body, ‘Nuclei’: the cell nuclei, ‘PeriNuclei’: a peripheral area around the nucleus, ‘VoronoiCells’: the area of the cell from a Voronoi-tessellation of the image. Many of the uninformative features are related to orientation of objects or their location, which are expected not to carry useful information for the network inference.</p>
<p>(EPS)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004078.s017" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004078.s017" mimetype="application/postscript" xlink:type="simple">
<label>S16 Fig</label>
<caption>
<title>Feature attachments in the 5-gene network.</title>
<p>Each row shows the probability for one feature of being attached to each of the genes in the network or the null node. Rows are sorted by the gene for which the attachment probability is highest. For a description of the different feature types see caption of supplementary <xref ref-type="supplementary-material" rid="pcbi.1004078.s016">S15 Fig</xref>.</p>
<p>(EPS)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004078.s018" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004078.s018" mimetype="application/postscript" xlink:type="simple">
<label>S17 Fig</label>
<caption>
<title>Illustration of a NEMix, with unidentifiable <italic>p</italic> = <italic>P</italic>(<italic>Z</italic>).</title>
<p>The hidden variable is attached only to signaling genes that are always perturbed. For models with such structure <italic>p</italic> cannot be inferred.</p>
<p>(EPS)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004078.s019" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004078.s019" mimetype="application/pdf" xlink:type="simple">
<label>S1 Table</label>
<caption>
<title>Performance summary of the 8 gene MAPK network.</title>
<p>The first column gives the log-likelihood for each model, showing that the true network is much less likely than the inferred networks. The second and third column show performance of the networks in terms of accuracy (ACC) and area under curve (AUC). The inferred <italic>p</italic><sub>0</sub> for the NEMix models is displayed in column four. Column five indicates the corresponding sub-figure of <xref ref-type="fig" rid="pcbi.1004078.g003">Fig. 3</xref>. The network ‘KEGG Graph + Z’ denotes the structure of the known KEGG network, where only the position of <italic>Z, p</italic><sub>0</sub>, and <italic>θ</italic> are inferred.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We thank all members of the InfectX and TargetInfectX consortium for stimulating discussions that helped making this work possible. Furthermore, this work was supported by Sybit (SystemsX) in terms of data management and storage. Finally, we thank Fabian Schmich for contributing the siRNA target prediction matrix.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1004078.ref001">
<label>1</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Markowetz</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Spang</surname> <given-names>R</given-names></name> (<year>2007</year>) <article-title>Inferring cellular networks—a review</article-title>. <source>BMC Bioinformatics</source> <volume>8</volume>: <fpage>S5</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2105-8-S6-S5" xlink:type="simple">10.1186/1471-2105-8-S6-S5</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004078.ref002">
<label>2</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Markowetz</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Bloch</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Spang</surname> <given-names>R</given-names></name> (<year>2005</year>) <article-title>Non-transcriptional pathway features reconstructed from secondary effects of RNA interference</article-title>. <source>Bioinformatics</source> <volume>21</volume>: <fpage>4026</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/bti662" xlink:type="simple">10.1093/bioinformatics/bti662</ext-link></comment> <object-id pub-id-type="pmid">16159925</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004078.ref003">
<label>3</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Fröhlich</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Tresch</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Beissbarth</surname> <given-names>T</given-names></name> (<year>2009</year>) <article-title>Nested effects models for learning signaling networks from perturbation data</article-title>. <source>Biometrical J</source> <volume>51</volume>: <fpage>304</fpage>–<lpage>323</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/bimj.200800185" xlink:type="simple">10.1002/bimj.200800185</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004078.ref004">
<label>4</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Niederberger</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Etzold</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Lidschreiber</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Maier</surname> <given-names>KC</given-names></name>, <name name-style="western"><surname>Martin</surname> <given-names>DE</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>MC EMiNEM Maps the Interaction Landscape of the Mediator</article-title>. <source>PLoS Comput Biol</source> <volume>8</volume>: <fpage>10</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1002568" xlink:type="simple">10.1371/journal.pcbi.1002568</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004078.ref005">
<label>5</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Failmezger</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Praveen</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Tresch</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Fröhlich</surname> <given-names>H</given-names></name> (<year>2013</year>) <article-title>Learning gene network structure from time laps cell imaging in RNAi Knock downs</article-title>. <source>Bioinformatics</source> <volume>29</volume>: <fpage>1534</fpage>–<lpage>1540</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btt179" xlink:type="simple">10.1093/bioinformatics/btt179</ext-link></comment> <object-id pub-id-type="pmid">23595660</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004078.ref006">
<label>6</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Fröhlich</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Praveen</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Tresch</surname> <given-names>A</given-names></name> (<year>2011</year>) <article-title>Fast and efficient dynamic nested effects models</article-title>. <source>Bioinformatics</source> <volume>27</volume>: <fpage>238</fpage>–<lpage>44</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btq631" xlink:type="simple">10.1093/bioinformatics/btq631</ext-link></comment> <object-id pub-id-type="pmid">21068003</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004078.ref007">
<label>7</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Anchang</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Sadeh</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Jacob</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Tresch</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Vlad</surname> <given-names>MO</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>Modeling the temporal interplay of molecular signaling and gene expression by using dynamic nested effects models</article-title>. <source>Proc Natl Acad Sci</source> <volume>106</volume>: <fpage>6447</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.0809822106" xlink:type="simple">10.1073/pnas.0809822106</ext-link></comment> <object-id pub-id-type="pmid">19329492</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004078.ref008">
<label>8</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Zeller</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Fröhlich</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Tresch</surname> <given-names>A</given-names></name> (<year>2009</year>) <article-title>A Bayesian network view on nested effects models</article-title>. <source>EURASIP J Bioinform Syst Biol</source> <volume>2009</volume>: <fpage>8</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1155/2009/195272" xlink:type="simple">10.1155/2009/195272</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004078.ref009">
<label>9</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Hannon</surname> <given-names>GJ</given-names></name> (<year>2002</year>) <article-title>RNA interference</article-title>. <source>Nature</source> <volume>418</volume>: <fpage>244</fpage>–<lpage>251</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/418244a" xlink:type="simple">10.1038/418244a</ext-link></comment> <object-id pub-id-type="pmid">12110901</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004078.ref010">
<label>10</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Elbashir</surname> <given-names>SM</given-names></name>, <name name-style="western"><surname>Harborth</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Lendeckel</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Yalcin</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Weber</surname> <given-names>K</given-names></name>, <etal>et al</etal>. (<year>2001</year>) <article-title>Duplexes of 21-nucleotide RNAs mediate RNA interference in cultured mammalian cells</article-title>. <source>Nature</source> <volume>411</volume>: <fpage>494</fpage>–<lpage>8</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/35078107" xlink:type="simple">10.1038/35078107</ext-link></comment> <object-id pub-id-type="pmid">11373684</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004078.ref011">
<label>11</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Schultz</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Marenstein</surname> <given-names>DR</given-names></name>, <name name-style="western"><surname>De Angelis</surname> <given-names>Da</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>WQ</given-names></name>, <name name-style="western"><surname>Nelander</surname> <given-names>S</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Off-target effects dominate a large-scale RNAi screen for modulators of the TGF-β pathway and reveal microRNA regulation of TGFBR2</article-title>. <source>Silence</source> <volume>2</volume>: <fpage>3</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1758-907X-2-3" xlink:type="simple">10.1186/1758-907X-2-3</ext-link></comment> <object-id pub-id-type="pmid">21401928</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004078.ref012">
<label>12</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Birmingham</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Selfors</surname> <given-names>LM</given-names></name>, <name name-style="western"><surname>Forster</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Wrobel</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Kennedy</surname> <given-names>CJ</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>Statistical methods for analysis of high-throughput RNA interference screens</article-title>. <source>Nat Methods</source> <volume>6</volume>: <fpage>569</fpage>–<lpage>575</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.1351" xlink:type="simple">10.1038/nmeth.1351</ext-link></comment> <object-id pub-id-type="pmid">19644458</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004078.ref013">
<label>13</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Snijder</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Sacher</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Rämö</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Liberali</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Mench</surname> <given-names>K</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Single-cell analysis of population context advances RNAi screening at multiple levels</article-title>. <source>Mol Syst Biol</source> <volume>8</volume>: <fpage>579</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/msb.2012.9" xlink:type="simple">10.1038/msb.2012.9</ext-link></comment> <object-id pub-id-type="pmid">22531119</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004078.ref014">
<label>14</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Knapp</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Rebhan</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Kumar</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Matula</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Kiani</surname> <given-names>Na</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Normalizing for individual cell population context in the analysis of high-content cellular screens</article-title>. <source>BMC Bioinformatics</source> <volume>12</volume>: <fpage>485</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2105-12-485" xlink:type="simple">10.1186/1471-2105-12-485</ext-link></comment> <object-id pub-id-type="pmid">22185194</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004078.ref015">
<label>15</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Jurgeit</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Moese</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Roulin</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Dorsch</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Lötzerich</surname> <given-names>M</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>An RNA replication-center assay for high content image-based quantifications of human rhinovirus and coxsackievirus infections</article-title>. <source>Virol J</source> <volume>7</volume>: <fpage>264</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1743-422X-7-264" xlink:type="simple">10.1186/1743-422X-7-264</ext-link></comment> <object-id pub-id-type="pmid">20937137</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004078.ref016">
<label>16</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Jurgeit</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>McDowell</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Moese</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Meldrum</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Schwendener</surname> <given-names>R</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Niclosamide is a proton carrier and targets acidic endosomes with broad antiviral effects</article-title>. <source>PLoS Pathog</source> <volume>8</volume>: <fpage>e1002976</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.ppat.1002976" xlink:type="simple">10.1371/journal.ppat.1002976</ext-link></comment> <object-id pub-id-type="pmid">23133371</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004078.ref017">
<label>17</label>
<mixed-citation xlink:type="simple" publication-type="other">Rämö P, Drewek A, Arrieumerlou C, Beerenwinkel N, Ben-Tekaya H, et al. (2014) Simultaneous analysis of large-scale RNAi screens for pathogen entry. BMC Genomics in press.</mixed-citation>
</ref>
<ref id="pcbi.1004078.ref018">
<label>18</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Conrad</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Gerlich</surname> <given-names>DW</given-names></name> (<year>2010</year>) <article-title>Automated microscopy for high-content RNAi screening</article-title>. <source>J Cell Biol</source> <volume>188</volume>: <fpage>453</fpage>–<lpage>61</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1083/jcb.200910105" xlink:type="simple">10.1083/jcb.200910105</ext-link></comment> <object-id pub-id-type="pmid">20176920</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004078.ref019">
<label>19</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Mohr</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Bakal</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Perrimon</surname> <given-names>N</given-names></name> (<year>2010</year>) <article-title>Genomic screening with RNAi: results and challenges</article-title>. <source>Annu Rev Biochem</source> <volume>79</volume>: <fpage>37</fpage>–<lpage>64</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1146/annurev-biochem-060408-092949" xlink:type="simple">10.1146/annurev-biochem-060408-092949</ext-link></comment> <object-id pub-id-type="pmid">20367032</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004078.ref020">
<label>20</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Mohr</surname> <given-names>SE</given-names></name>, <name name-style="western"><surname>Perrimon</surname> <given-names>N</given-names></name> (<year>2011</year>) <article-title>RNAi screening: new approaches, understandings, and organisms</article-title>. <source>Wiley Interdiscip Rev RNA</source> <volume>3</volume>: <fpage>145</fpage>–<lpage>58</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/wrna.110" xlink:type="simple">10.1002/wrna.110</ext-link></comment> <object-id pub-id-type="pmid">21953743</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004078.ref021">
<label>21</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Dempster</surname> <given-names>AP</given-names></name>, <name name-style="western"><surname>Laird</surname> <given-names>NM</given-names></name>, <name name-style="western"><surname>Rubin</surname> <given-names>DB</given-names></name> (<year>1977</year>) <article-title>Maximum likelihood from incomplete data via the EM algorithm</article-title>. <source>J R Stat Soc Ser B (Statistical Methodol</source> <volume>39</volume>: <fpage>1</fpage>–<lpage>38</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004078.ref022">
<label>22</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Kanehisa</surname> <given-names>M</given-names></name> (<year>2000</year>) <article-title>KEGG: Kyoto Encyclopedia of Genes and Genomes</article-title>. <source>Nucleic Acids Res</source> <volume>28</volume>: <fpage>27</fpage>–<lpage>30</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/28.1.27" xlink:type="simple">10.1093/nar/28.1.27</ext-link></comment> <object-id pub-id-type="pmid">10592173</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004078.ref023">
<label>23</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Fröhlich</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Fellmann</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Sueltmann</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Poustka</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Beissbarth</surname> <given-names>T</given-names></name> (<year>2007</year>) <article-title>Large scale statistical inference of signaling pathways from RNAi and microarray data</article-title>. <source>BMC Bioinformatics</source> <volume>8</volume>: <fpage>386</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2105-8-386" xlink:type="simple">10.1186/1471-2105-8-386</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004078.ref024">
<label>24</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Carpenter</surname> <given-names>AE</given-names></name>, <name name-style="western"><surname>Jones</surname> <given-names>TR</given-names></name>, <name name-style="western"><surname>Lamprecht</surname> <given-names>MR</given-names></name>, <name name-style="western"><surname>Clarke</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Kang</surname> <given-names>IH</given-names></name>, <etal>et al</etal>. (<year>2006</year>) <article-title>CellProfiler: image analysis software for identifying and quantifying cell phenotypes</article-title>. <source>Genome Biol</source> <volume>7</volume>: <fpage>R100</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/gb-2006-7-10-r100" xlink:type="simple">10.1186/gb-2006-7-10-r100</ext-link></comment> <object-id pub-id-type="pmid">17076895</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004078.ref025">
<label>25</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Seinen</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Burgerhof</surname> <given-names>JGM</given-names></name>, <name name-style="western"><surname>Jansen</surname> <given-names>RC</given-names></name>, <name name-style="western"><surname>Sibon</surname> <given-names>OCM</given-names></name> (<year>2010</year>) <article-title>RNAi experiments in D. melanogaster: solutions to the overlooked problem of off-targets shared by independent dsRNAs</article-title>. <source>PLoS One</source> <volume>5</volume>: <fpage>1</fpage>–<lpage>7</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0013119" xlink:type="simple">10.1371/journal.pone.0013119</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004078.ref026">
<label>26</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Seger</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Krebs</surname> <given-names>E</given-names></name> (<year>1995</year>) <article-title>The MAPK signaling cascade</article-title>. <source>FASEB J</source> <volume>9</volume>: <fpage>726</fpage>–<lpage>735</lpage>. <object-id pub-id-type="pmid">7601337</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004078.ref027">
<label>27</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Murphy</surname> <given-names>LO</given-names></name>, <name name-style="western"><surname>Blenis</surname> <given-names>J</given-names></name> (<year>2006</year>) <article-title>MAPK signal specificity: the right place at the right time</article-title>. <source>Trends Biochem Sci</source> <volume>31</volume>: <fpage>268</fpage>–<lpage>75</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.tibs.2006.03.009" xlink:type="simple">10.1016/j.tibs.2006.03.009</ext-link></comment> <object-id pub-id-type="pmid">16603362</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004078.ref028">
<label>28</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Dhillon</surname> <given-names>aS</given-names></name>, <name name-style="western"><surname>Hagan</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Rath</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Kolch</surname> <given-names>W</given-names></name> (<year>2007</year>) <article-title>MAP kinase signalling pathways in cancer</article-title>. <source>Oncogene</source> <volume>26</volume>: <fpage>3279</fpage>–<lpage>90</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/sj.onc.1210421" xlink:type="simple">10.1038/sj.onc.1210421</ext-link></comment> <object-id pub-id-type="pmid">17496922</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004078.ref029">
<label>29</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Wang</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Lau</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Wiehler</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Pow</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Mazzulli</surname> <given-names>T</given-names></name>, <etal>et al</etal>. (<year>2006</year>) <article-title>Syk Is Downstream of Intercellular Adhesion Molecule-1 and Mediates Human Rhinovirus Activation of p38 MAPK in Airway Epithelial Cells</article-title>. <source>J Immunol</source> <volume>177</volume>: <fpage>6859</fpage>–<lpage>6870</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.4049/jimmunol.177.10.6859" xlink:type="simple">10.4049/jimmunol.177.10.6859</ext-link></comment> <object-id pub-id-type="pmid">17082600</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004078.ref030">
<label>30</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Hall</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>Bates</surname> <given-names>ME</given-names></name>, <name name-style="western"><surname>Guar</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Cronan</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Korpi</surname> <given-names>N</given-names></name>, <etal>et al</etal>. (<year>2005</year>) <article-title>The Role of p38 MAPK in Rhinovirus-Induced Monocyte Chemoattractant Protein-1 Production by Monocytic-Lineage Cells</article-title>. <source>J Immunol</source> <volume>174</volume>: <fpage>8056</fpage>–<lpage>8063</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.4049/jimmunol.174.12.8056" xlink:type="simple">10.4049/jimmunol.174.12.8056</ext-link></comment> <object-id pub-id-type="pmid">15944313</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004078.ref031">
<label>31</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Laza-Stanca</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Stanciu</surname> <given-names>LA</given-names></name>, <name name-style="western"><surname>Message</surname> <given-names>SD</given-names></name>, <name name-style="western"><surname>Edwards</surname> <given-names>MR</given-names></name>, <name name-style="western"><surname>Gern</surname> <given-names>JE</given-names></name>, <etal>et al</etal>. (<year>2006</year>) <article-title>Rhinovirus replication in human macrophages induces NF-kappaB-dependent tumor necrosis factor alpha production</article-title>. <source>J Virol</source> <volume>80</volume>: <fpage>8248</fpage>–<lpage>58</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1128/JVI.00162-06" xlink:type="simple">10.1128/JVI.00162-06</ext-link></comment> <object-id pub-id-type="pmid">16873280</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004078.ref032">
<label>32</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Subramanian</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Tamayo</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Mootha</surname> <given-names>VK</given-names></name>, <name name-style="western"><surname>Mukherjee</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Ebert</surname> <given-names>BL</given-names></name>, <etal>et al</etal>. (<year>2005</year>) <article-title>Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>102</volume>: <fpage>15545</fpage>–<lpage>50</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.0506580102" xlink:type="simple">10.1073/pnas.0506580102</ext-link></comment> <object-id pub-id-type="pmid">16199517</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004078.ref033">
<label>33</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Zhu</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>PK</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>WM</given-names></name>, <name name-style="western"><surname>Zhao</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Yu</surname> <given-names>D</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>Rhinovirus-induced major airway mucin production involves a novel TLR3-EGFR-dependent pathway</article-title>. <source>Am J Respir Cell Mol Biol</source> <volume>40</volume>: <fpage>610</fpage>–<lpage>9</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1165/rcmb.2008-0223OC" xlink:type="simple">10.1165/rcmb.2008-0223OC</ext-link></comment> <object-id pub-id-type="pmid">18978302</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004078.ref034">
<label>34</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Schuler</surname> <given-names>BA</given-names></name>, <name name-style="western"><surname>Schreiber</surname> <given-names>MT</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Mokry</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Kingdon</surname> <given-names>ML</given-names></name>, <etal>et al</etal>. (<year>2014</year>) <article-title>Major and minor group rhinoviruses elicit differential signaling and cytokine responses as a function of receptor-mediated signal transduction</article-title>. <source>PLoS One</source> <volume>9</volume>: <fpage>e93897</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0093897" xlink:type="simple">10.1371/journal.pone.0093897</ext-link></comment> <object-id pub-id-type="pmid">24736642</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004078.ref035">
<label>35</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Triantafilou</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Kar</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>van Kuppeveld</surname> <given-names>FJM</given-names></name>, <name name-style="western"><surname>Triantafilou</surname> <given-names>M</given-names></name> (<year>2013</year>) <article-title>Rhinovirus-Induced Calcium Flux Triggers NLRP3 and NLRC5 Activation in Bronchial Cells</article-title>. <source>Am J Respir Cell Mol Biol</source>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1165/rcmb.2013-0032OC" xlink:type="simple">10.1165/rcmb.2013-0032OC</ext-link></comment> <object-id pub-id-type="pmid">23815151</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004078.ref036">
<label>36</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Tresch</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Markowetz</surname> <given-names>F</given-names></name> (<year>2008</year>) <article-title>Structure learning in nested effects models</article-title>. <source>Stat Appl Genet Mol Biol</source> <volume>7</volume>: <fpage>26</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004078.ref037">
<label>37</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Wang</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Terfve</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Rose</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Markowetz</surname> <given-names>F</given-names></name> (<year>2011</year>) <article-title>HTSanalyzeR: an R/Bioconductor package for integrated network analysis of high-throughput screens</article-title>. <source>Bioinformatics</source> <volume>27</volume>: <fpage>879</fpage>–<lpage>80</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btr028" xlink:type="simple">10.1093/bioinformatics/btr028</ext-link></comment> <object-id pub-id-type="pmid">21258062</object-id></mixed-citation>
</ref>
</ref-list>
</back>
</article>