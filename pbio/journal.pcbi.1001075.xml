<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN">
<front>
   <journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher>
         <publisher-name>Public Library of Science</publisher-name>
         <publisher-loc>San Francisco, USA</publisher-loc>
      </publisher></journal-meta>
   <article-meta><article-id pub-id-type="publisher-id">10-PLCB-RA-2492R3</article-id><article-id pub-id-type="doi">10.1371/journal.pcbi.1001075</article-id><article-categories>
         <subj-group subj-group-type="heading">
            <subject>Research Article</subject>
         </subj-group>
         <subj-group subj-group-type="Discipline">
<subject>Computational Biology/Macromolecular Structure Analysis</subject>
         </subj-group>
      </article-categories><title-group><article-title>A Mathematical Framework for Protein Structure Comparison</article-title><alt-title alt-title-type="running-head">Mathematical Framework for Structure Comparison</alt-title></title-group><contrib-group>
         <contrib contrib-type="author" xlink:type="simple">
            <name name-style="western"><surname>Liu</surname><given-names>Wei</given-names></name>
            <xref ref-type="aff" rid="aff1"/>
         </contrib>
         <contrib contrib-type="author" xlink:type="simple">
            <name name-style="western"><surname>Srivastava</surname><given-names>Anuj</given-names></name>
            <xref ref-type="aff" rid="aff1"/>
            <xref ref-type="corresp" rid="cor1"><sup>*</sup></xref>
         </contrib>
         <contrib contrib-type="author" xlink:type="simple">
            <name name-style="western"><surname>Zhang</surname><given-names>Jinfeng</given-names></name>
            <xref ref-type="aff" rid="aff1"/>
            <xref ref-type="corresp" rid="cor1"><sup>*</sup></xref>
         </contrib>
      </contrib-group><aff id="aff1">
         <addr-line>Department of Statistics, Florida State University, Tallahassee, Florida, United States of America</addr-line>
      </aff><contrib-group>
         <contrib contrib-type="editor" xlink:type="simple">
            <name name-style="western"><surname>Dunbrack</surname><given-names>Roland L.</given-names></name>
            <role>Editor</role><xref ref-type="aff" rid="edit1"/></contrib>
      </contrib-group><aff id="edit1">Fox Chase Cancer Center, United States of America</aff><author-notes>
         <corresp id="cor1">* E-mail: <email xlink:type="simple">asrivastava@fsu.edu</email> (AS); <email xlink:type="simple">jinfeng@stat.fsu.edu</email> (JZ)</corresp>
         <fn fn-type="con">
            <p>Conceived and designed the experiments: AS JZ. Performed the experiments: WL. Analyzed the data: WL. Contributed reagents/materials/analysis tools: WL. Wrote the paper: AS JZ.</p>
         </fn>
      <fn fn-type="conflict">
         <p>The authors have declared that no competing interests exist.</p>
      </fn></author-notes><pub-date pub-type="collection">
         <month>2</month>
         <year>2011</year>
      </pub-date><pub-date pub-type="epub">
         <day>3</day>
         <month>2</month>
         <year>2011</year>
      </pub-date><volume>7</volume><issue>2</issue><elocation-id>e1001075</elocation-id><history>
         <date date-type="received">
            <day>14</day>
            <month>7</month>
            <year>2010</year>
         </date>
         <date date-type="accepted">
            <day>4</day>
            <month>1</month>
            <year>2011</year>
         </date>
      </history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2011</copyright-year><copyright-holder>Liu et al</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract>
         <p>Comparison of protein structures is important for revealing the evolutionary relationship among proteins, predicting protein functions and predicting protein structures. Many methods have been developed in the past to align two or multiple protein structures. Despite the importance of this problem, rigorous mathematical or statistical frameworks have seldom been pursued for general protein structure comparison. One notable issue in this field is that with many different distances used to measure the similarity between protein structures, none of them are proper distances when protein structures of different sequences are compared. Statistical approaches based on those non-proper distances or similarity scores as random variables are thus not mathematically rigorous. In this work, we develop a mathematical framework for protein structure comparison by treating protein structures as three-dimensional curves. Using an elastic Riemannian metric on spaces of curves, geodesic distance, a proper distance on spaces of curves, can be computed for any two protein structures. In this framework, protein structures can be treated as random variables on the shape manifold, and means and covariance can be computed for populations of protein structures. Furthermore, these moments can be used to build Gaussian-type probability distributions of protein structures for use in hypothesis testing. The covariance of a population of protein structures can reveal the population-specific variations and be helpful in improving structure classification. With curves representing protein structures, the matching is performed using elastic shape analysis of curves, which can effectively model conformational changes and insertions/deletions. We show that our method performs comparably with commonly used methods in protein structure classification on a large manually annotated data set.</p>
      </abstract><abstract abstract-type="summary">
         <title>Author Summary</title>
         <p>Protein structure comparison is important for understanding the evolutionary relationships among proteins, predicting protein functions, and predicting protein structures. Despite its importance, there have been no rigorous mathematical or statistical frameworks for protein structure comparison. One notable issue in this field is that with many different similarity measures used in comparing protein structures, none of them are proper distances when protein structures of different sequences are compared. In this study, we develop a mathematical framework for protein structure comparison by treating protein structures as three dimensional curves. A formal distance, geodesic distance, can be computed for any two protein structures. In this framework, population-specific variations within protein families can be characterized through building probability distributions for structures of protein families. The mean and covariance computed from groups of protein structures can also help to improve the classifications of protein structures. With curves representing protein structures, the matching is performed using elastic shape analysis of curves, which can effectively model conformational changes and insertions/deletions.</p>
      </abstract><funding-group><funding-statement>JZ is supported in part by a COFRS award from FSU. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts>
<page-count count="10"/>
</counts></article-meta>
</front>
<body>
   <sec id="s1">
      <title>Introduction</title>
      <p>Comparison of protein structures (or structure alignment) is an important tool for understanding the evolutionary relationships between proteins, predicting protein structures and predicting protein functions <xref ref-type="bibr" rid="pcbi.1001075-Kolodny1">[1]</xref>, <xref ref-type="bibr" rid="pcbi.1001075-Hasegawa1">[2]</xref>. In annotating functions of new proteins, such as those solved in structural genomics projects, sequence alignment methods may not be sufficient to identify functionally related proteins when the sequence identities between the query protein and its related proteins are low (i.e. lower than 20%) <xref ref-type="bibr" rid="pcbi.1001075-Dobson1">[3]</xref>. Comparing their structures provides an effective means of annotating protein functions based on the structural similarity of proteins since homologous proteins are more conserved in their structures than sequences <xref ref-type="bibr" rid="pcbi.1001075-Illergard1">[4]</xref>. To organize proteins by the similarity of their backbone structures, databases, such as SCOP <xref ref-type="bibr" rid="pcbi.1001075-Murzin1">[5]</xref>, <xref ref-type="bibr" rid="pcbi.1001075-LoConte1">[6]</xref>, CATH <xref ref-type="bibr" rid="pcbi.1001075-Orengo1">[7]</xref>, <xref ref-type="bibr" rid="pcbi.1001075-Orengo2">[8]</xref> and FSSP <xref ref-type="bibr" rid="pcbi.1001075-Holm1">[9]</xref> were built for all proteins of known structures in the protein data bank (PDB) <xref ref-type="bibr" rid="pcbi.1001075-Berman1">[10]</xref> by manual annotation <xref ref-type="bibr" rid="pcbi.1001075-Murzin1">[5]</xref>, <xref ref-type="bibr" rid="pcbi.1001075-LoConte1">[6]</xref>, automatic classification <xref ref-type="bibr" rid="pcbi.1001075-Holm1">[9]</xref> or combination of the two <xref ref-type="bibr" rid="pcbi.1001075-Orengo1">[7]</xref>, <xref ref-type="bibr" rid="pcbi.1001075-Orengo2">[8]</xref>. As the structure information is increasing at an accelerated speed, human annotations have become more time and resource consuming. Automatic structure alignment methods developed in the past <xref ref-type="bibr" rid="pcbi.1001075-Holm2">[11]</xref>–<xref ref-type="bibr" rid="pcbi.1001075-Zhou1">[36]</xref> can be largely divided into several categories according to the specific similarity metrics (distances) they aim to optimize to achieve the best alignment. The particular metric used reflects the emphasis of the method on what constitutes a good alignment between two structures. When using the same similarity measures, methods differ by how they achieve the optimal solution through various search algorithms. Several studies have been performed to comprehensively compare different structure alignment methods <xref ref-type="bibr" rid="pcbi.1001075-Kolodny2">[37]</xref>–<xref ref-type="bibr" rid="pcbi.1001075-Mayr1">[39]</xref>. The conclusions from these studies are that there is still room for improvement in structure alignment and there is no common standard for assessing the quality of alignment. Different criteria tend to rank methods differently and for a particular purpose one method may work better than the others. But, in general, no one method works better than others for all purposes. Despite extensive studies in the past, structure alignment, especially flexible structural alignment (i.e. one of the structures has undergone some conformational changes), continues to be a very challenging problem <xref ref-type="bibr" rid="pcbi.1001075-Kolodny2">[37]</xref>–<xref ref-type="bibr" rid="pcbi.1001075-Mayr1">[39]</xref>. Another problem in structure alignment is to assess the statistical significance of the similarity between two protein structures. This problem is partly due to the lack of a proper metric for measuring the distance between two protein structures <xref ref-type="bibr" rid="pcbi.1001075-Koehl1">[40]</xref>. The root-mean-square-deviation (RMSD) of aligned parts between two structures has been commonly used to measure the similarity between pairs of protein structures after they are superposed. However, RMSD is not a proper distance when different sets of atoms are used to align different pairs of structures. Other similarity scores have also been used to derive statistical methods for evaluating significance of similarities. They suffer from the same drawback of RMSD as not being proper distances. In addition, a problem with many of the current metrics is that the best alignment between two structures, corresponding to the minimum value of the alignment metric used, cannot be obtained easily. Heuristic methods are often used to search the alignment space to find the best alignment, producing approximate minimum distances with possible biases.</p>
      <p>A previous study aiming to develop a statistical framework for structure alignment <xref ref-type="bibr" rid="pcbi.1001075-Levitt1">[41]</xref> inferred the probability distribution of similarities of unrelated proteins by performing large scale alignment of protein structures. The resulting pair-wise alignment scores are then fitted to an extreme value distribution. It has also been pointed out that in these frameworks, the commonly used metric RMSD does not lead to as reliable a measure of structural significance compared to some “less proper” distances such as the alignment scores <xref ref-type="bibr" rid="pcbi.1001075-Levitt1">[41]</xref>. This raised some concerns over these statistical frameworks.</p>
      <p>In this study, we develop a mathematical framework for protein structure comparison using a formal distance, a geodesic distance based on a particular Riemannian metric. Geodesic distances in elastic shape analysis have been used widely in shape analysis in computer vision <xref ref-type="bibr" rid="pcbi.1001075-Joshi1">[42]</xref>–<xref ref-type="bibr" rid="pcbi.1001075-Srivastava1">[45]</xref>. An advantage of this approach is that the dynamic-programming algorithm can efficiently compute the optimal alignment between two protein structures. In this framework, we consider protein backbones as continuous three-dimensional curves. The alignment of two protein structures then becomes alignment of the two curves derived from the two backbone structures. Curves can bend and stretch readily during alignment so that the flexibility of and variations among protein structures can be adequately accounted for. Our goal is to develop a <italic>comprehensive framework for statistical analysis of protein structures</italic>. This framework can: (1) Generate optimal matching of protein backbone structures using shape information, where a formal distance, geodesic distance, is computed as a measure of the dissimilarity between shapes of any two protein structures. The optimal matching of two structures, computed by dynamic programming algorithm, gives the minimum distance among all possible matchings of two structures. (2) Compute statistical averages of a collection of structures using geodesics and geodesic distances. Such tools can be further advanced to define statistical models for capturing variations in protein conformations and for classifying future discoveries into pre-determined classes. That is, one can generate mean and covariance associated with a set of protein structures and characterize the central behavior of a population. (3) Generate optimal deformation of one backbone into another using geodesic path in the shape space. This work is an extension of a recent framework for comparing shapes of curves in Euclidean spaces, called the <italic>elastic shape analysis</italic> <xref ref-type="bibr" rid="pcbi.1001075-Joshi1">[42]</xref>, <xref ref-type="bibr" rid="pcbi.1001075-Klassen1">[43]</xref>, <xref ref-type="bibr" rid="pcbi.1001075-Kurtek1">[46]</xref>.</p>
      <p>The rest of this paper is organized as follows. We first describe the mathematical framework that is behind our approach to protein structure comparison. We then use some examples to illustrate this method in pair-wise structure alignment and in computing mean and covariance of a group of protein structures. We further demonstrate the performance of our method using a large-scale classification of proteins in SCOP database and compare our performance with some commonly-used methods. Finally, we conclude the paper with discussions.</p>
   </sec>
   <sec id="s2" sec-type="methods">
      <title>Methods</title>
      <sec id="s2a">
         <title>The mathematical framework</title>
         <p>We treat the backbone structure of a protein as a parameterized curve in <italic>R</italic><sup>3</sup>. Given any two such parameterized curves, we desire a framework that can quantify the differences in shapes of these two curves. Since the comparisons involve shapes of proteins, the resulting quantifications should not depend on the rigid motions and parameterizations of these curves. We will use a Riemannian framework for this task and the basic idea in this approach is the following. We represent each parameterized curve by a special function called the <italic>square root velocity function</italic> (SRVF) and restrict to the manifold of such functions under the desired constraints. In order to compare shapes of curves, we have to remove all the shape-preserving transformations from this representation. This is done using an algebraic technique – we form a quotient space of the original manifold with respect to these shape-preserving transformation groups. In the resulting quotient space, called the <italic>shape space of elastic curves</italic>, one can perform statistical analysis of curves as if they are random variables. One can compare, match, and deform one curve into another, or compute averages and covariances of curve populations, and perform hypothesis testing and classification of curves according to their shapes. The mathematical details are provided next.</p>
         <sec id="s2a1">
            <title>Elastic representation of protein structures</title>
            <p>To derive a curve from a protein structure, we take the sequence of 3D coordinates of the backbone atoms N, CA and C from the PDB <xref ref-type="bibr" rid="pcbi.1001075-Berman1">[10]</xref> file and treat them as the coordinates <italic>β</italic>(<italic>t<sub>i</sub></italic>) = [<italic>β</italic><sub>1</sub>(<italic>t<sub>i</sub></italic>) <italic>β</italic><sub>2</sub>(<italic>t<sub>i</sub></italic>) <italic>β</italic><sub>3</sub>(<italic>t<sub>i</sub></italic>)], <italic>i</italic> = 1,2,…,<italic>n</italic>, for <italic>n</italic> atoms. We use <italic>t<sub>i</sub></italic> = <italic>i</italic>/<italic>n</italic> so that the parameter lies between [0,1]. These points become samples along the curve and we can compute <italic>β</italic>(<italic>t</italic>) for any <italic>t</italic> in [0,1] using interpolation. Note that in our method it is not necessary for the curve to be arc-length parameterized, i.e. the distances between <italic>β</italic> (<italic>t<sub>i</sub></italic>)s need not be same. Since we optimize over all re-parameterizations of the curves, any initial parameterization read from the PDB file is just fine.</p>
            <p>Let the parameterized curve in <italic>R</italic><sup>3</sup> derived from the backbone structure of a protein be denoted as <italic>β</italic> : [0, 1]<italic>→R</italic><sup>3</sup>. In order to analyze its shape, we will represent <italic>β</italic> by its square-root velocity function: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001075.e001" xlink:type="simple"/></inline-formula> in <italic>R</italic><sup>3</sup>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001075.e002" xlink:type="simple"/></inline-formula> is the standard Euclidean norm in <italic>R</italic><sup>3</sup>. The SRVF <italic>q</italic> includes both the instantaneous speed (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001075.e003" xlink:type="simple"/></inline-formula>) and direction (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001075.e004" xlink:type="simple"/></inline-formula>) of curve <italic>β</italic> at time <italic>t</italic>. The use of the time derivative makes SRVF invariant to any translation of curve <italic>β</italic>. Conversely, one can reconstruct the curve <italic>β</italic> from <italic>q</italic> up to a translation. In order for the shape analysis to be invariant to scales, we rescale each curve to length 1. With a slight abuse of notation, we will denote the rescaled curves by <italic>β</italic>. Since <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001075.e005" xlink:type="simple"/></inline-formula>, we have: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001075.e006" xlink:type="simple"/></inline-formula>. In other words, the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001075.e007" xlink:type="simple"/></inline-formula> norm of the SRVF is one. Restricting to the curves of interest, represented by their SRVFs, we obtain the set<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1001075.e008" xlink:type="simple"/><label>(1)</label></disp-formula><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001075.e009" xlink:type="simple"/></inline-formula> is called the <italic>preshape space</italic> and is the set of all SRVFs representing parameterized curves in <italic>R</italic><sup>3</sup> of length one. It is actually a unit sphere in the Hilbert space <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001075.e010" xlink:type="simple"/></inline-formula>.</p>
            <p>We have mentioned four shape-preserving transformations – translation, scale, rotation, and re-parameterization. Of these, we have already eliminated the first two from the representations, but the other two remain. Curves that are within a rotation and/or a re-parameterization of each other result in different elements of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001075.e011" xlink:type="simple"/></inline-formula> despite having the same shape. The removal of the remaining two transformations is performed algebraically as follows. Let <italic>SO</italic>(3) be the group of 3×3 rotation matrices and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001075.e012" xlink:type="simple"/></inline-formula> be the group of all re-parameterizations (they are actually positive diffeomorphisms of the interval <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001075.e013" xlink:type="simple"/></inline-formula>). For a curve <italic>β</italic>, a rotation <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001075.e014" xlink:type="simple"/></inline-formula> and a re-parameterization <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001075.e015" xlink:type="simple"/></inline-formula>, the transformed curve is given by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001075.e016" xlink:type="simple"/></inline-formula>. The SRVF of the transformed curve is given by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001075.e017" xlink:type="simple"/></inline-formula>. In order to unify all elements in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001075.e018" xlink:type="simple"/></inline-formula> that denote the same shape we define equivalence classes of the type: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001075.e019" xlink:type="simple"/></inline-formula>. Each such class [<italic>q</italic>] is associated with a shape uniquely and vice versa. The set of all these equivalence classes is called the <italic>shape space</italic> <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001075.e020" xlink:type="simple"/></inline-formula>. Mathematically, it is a quotient space of the preshape space: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001075.e021" xlink:type="simple"/></inline-formula> = <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001075.e022" xlink:type="simple"/></inline-formula>.</p>
         </sec>
         <sec id="s2a2">
            <title>Elastic metric</title>
            <p>When we deform one curve into another we are actually generating a continuous sequence of curves, or a path in the curve space, and a natural question is how long that path is. The length of this path also quantifies the amount of deformation in going from one curve to the other. The question changes to: what should be the metric to measure this path length. An elastic metric is a metric that measures the amount of bending and stretching between successive curves along the path and adds them up for the full path. Mio et al. <xref ref-type="bibr" rid="pcbi.1001075-Mio1">[44]</xref> defined a family of elastic metrics depending upon how much relative weight is attached to bending and stretching. Joshi et al. <xref ref-type="bibr" rid="pcbi.1001075-Joshi1">[42]</xref>, and more recently Srivastava et al. <xref ref-type="bibr" rid="pcbi.1001075-Srivastava1">[45]</xref>, proposed the SRVF that has the special property that under this representation, the elastic metric turns into (using a change of variables) the standard <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001075.e023" xlink:type="simple"/></inline-formula> metric. That is, one can alternatively compute the path lengths, or the sizes of deformations between curves, using the cumulative <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001075.e024" xlink:type="simple"/></inline-formula> norms of the differences between successive curves along the paths in the SRVF space. This turns out to be much simpler and a very effective strategy for comparing shapes of curves, by finding the paths with the least amounts of deformations between them, where the amount of deformation is measured by an elastic metric.</p>
            <p>Let <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001075.e025" xlink:type="simple"/></inline-formula> be the velocity function along a curve <italic>β</italic>(<italic>t</italic>) and let <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001075.e026" xlink:type="simple"/></inline-formula> a perturbation of that velocity function. A Riemannian metric is a metric that measures the norm of the perturbation ∥<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001075.e027" xlink:type="simple"/></inline-formula>∥. If we represent the vector <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001075.e028" xlink:type="simple"/></inline-formula>, where <italic>r</italic>(<italic>t</italic>) is the magnitude of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001075.e029" xlink:type="simple"/></inline-formula> and Θ(<italic>t</italic>) is the direction of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001075.e030" xlink:type="simple"/></inline-formula>. Rather than computing ∥<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001075.e031" xlink:type="simple"/></inline-formula>∥, one can separately compute the norms of these two components and that defines an elastic metric:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1001075.e032" xlink:type="simple"/><label>(2)</label></disp-formula>The first term in the square-root is the measurement of stretching and the second term is a measurement of bending in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001075.e033" xlink:type="simple"/></inline-formula> introduced by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001075.e034" xlink:type="simple"/></inline-formula>. Depending on the values of <italic>a</italic> and <italic>b</italic>, one gets a whole class of metrics called the elastic metrics. This metric is rather complicated to implement and use in shape analysis of curves. It was shown by Joshi et al <xref ref-type="bibr" rid="pcbi.1001075-Joshi1">[42]</xref> that if we represent a curve <italic>β</italic> by its SRVF <italic>q</italic>, then the corresponding norm on <italic>δq</italic>(<italic>t</italic>) is actually the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001075.e035" xlink:type="simple"/></inline-formula> norm. That is,<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1001075.e036" xlink:type="simple"/><label>(3)</label></disp-formula>Thus, the use of SRVF greatly simplifies the use of the elastic metric.</p>
            <p>The so-called preshape space <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001075.e037" xlink:type="simple"/></inline-formula> is a nonlinear manifold because it is a unit sphere. We cannot perform calculus on this space as if it is a vector space. Operations such as addition, subtraction, and multiplication are not available on nonlinear spaces. This means that we cannot use standard techniques in multivariate statistics for inferences on <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001075.e038" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001075.e039" xlink:type="simple"/></inline-formula>. This problem is solved by mapping points from the manifold to a plane that is tangent to the manifold (at a certain point), statistics are computed in the tangent space, and then mapped back to the manifold. Since the mapping back and forth is unique (under some appropriate constraints), such computations are well defined and the estimates are consistent. <italic>Tμ</italic>(<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001075.e040" xlink:type="simple"/></inline-formula>) is the notation for all the functions that are tangent to the manifold <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001075.e041" xlink:type="simple"/></inline-formula> at the point <italic>μ</italic>. In case of spherical manifolds, it is easy to visualize what the tangent spaces are.</p>
         </sec>
         <sec id="s2a3">
            <title>Shape comparisons and averaging</title>
            <p>Once we have a Riemannian manifold, we can compute distances between points in that manifold. For any two points, the distance between them is given by the length of the shortest path (called a <italic>geodesic</italic>) connecting them in that manifold. An interesting feature of this framework is that it not only provides a distance between two protein structures, thus quantifying differences between their shapes, but also a geodesic path between them in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001075.e042" xlink:type="simple"/></inline-formula>. This path has the interpretation that it provides the optimal deformation of one shape into another. The geodesics are actually computed using the differential geometry of the underlying space <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001075.e043" xlink:type="simple"/></inline-formula>. Consider two curves <italic>β</italic><sub>1</sub> and <italic>β</italic><sub>2</sub>, represented by their SRVFs <italic>q</italic><sub>1</sub> and <italic>q</italic><sub>2</sub>. In order to compute geodesics between their equivalence classes [<italic>q</italic><sub>1</sub>] and [<italic>q</italic><sub>2</sub>], we fix <italic>q</italic><sub>1</sub> and find the optimal rotation and re-parameterization of <italic>q</italic><sub>2</sub> to solve:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1001075.e044" xlink:type="simple"/><label>(4)</label></disp-formula>The optimization over rotation is straightforward, using SVD, but the optimization over the re-parameterization requires a dynamic programming algorithm. Please note that the optimal <italic>γ*</italic> is the <italic>matching function</italic> between the two backbone structures. Define <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001075.e045" xlink:type="simple"/></inline-formula> and compute a geodesic path between <italic>q</italic><sub>1</sub> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001075.e046" xlink:type="simple"/></inline-formula> in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001075.e047" xlink:type="simple"/></inline-formula>. Since <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001075.e048" xlink:type="simple"/></inline-formula> is a sphere, the geodesic between any two points is given by a great circle whose equation is:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1001075.e049" xlink:type="simple"/><label>(5)</label></disp-formula>where <italic>α</italic> is a geodesic path between the given two shapes such that it is in [<italic>q</italic><sub>1</sub>] at <italic>τ</italic> = 0 and in [<italic>q</italic><sub>2</sub>] at <italic>τ</italic> = 1. Here <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001075.e050" xlink:type="simple"/></inline-formula> is the distance between the two equivalence classes in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001075.e051" xlink:type="simple"/></inline-formula>, i.e. <italic>d</italic>([<italic>q</italic><sub>1</sub>], [<italic>q</italic><sub>2</sub>]) = <italic>θ</italic>. This <italic>θ</italic> is a <bold>proper distance</bold> in the shape space as it satisfies all the three properties of a distance function, including the triangle inequality. In practice, the matching function <italic>γ</italic> is represented as a set of discrete values along its domain. If we use <italic>n</italic> point to represent <italic>γ</italic>, then we can represent <italic>γ</italic> in a computer using the vector [<italic>γ</italic> (0), <italic>γ</italic> (1/<italic>n</italic> ), <italic>γ</italic> (2/<italic>n</italic> ), <italic>γ</italic> (3/<italic>n</italic> ),… <italic>γ</italic> (<italic>n</italic>−1/<italic>n</italic>), <italic>γ</italic> (1)]. To apply a re-parameterization <italic>γ</italic> to a curve <italic>β</italic>, we compute the new curve <italic>β</italic> (<italic>γ</italic> (<italic>i</italic>/<italic>n</italic>)), for <italic>i</italic> = 1,2,..,<italic>n</italic>. Since <italic>β</italic> values are available for only discrete <italic>t</italic>'s, we interpolate in between the given values to obtain the new <italic>β</italic>, which is done using bilinear interpolation.</p>
            <p><xref ref-type="fig" rid="pcbi-1001075-g001">Fig 1</xref> shows three simple examples of elastic matching using four small proteins (PDB IDs: 1MP6, 1G1J, 2K98 and 2EOW). In <xref ref-type="fig" rid="pcbi-1001075-g001">Fig 1a</xref>, protein 1MP6, a protein with a single helix, is matched to protein 1G1J, which also has a single helix but longer and bent in the middle. We can see that the helix of 1MP6 is matched to two relatively straight parts of the helix in 1G1J and the bent region is skipped. <xref ref-type="fig" rid="pcbi-1001075-g001">Fig 1b</xref> shows the matching between 1MP6 with 2K98, a protein with a helix-turn-helix structure. The helix in 1MP6 is matched to both helices in 2K98. This kind of matching cannot be achieved with rigid alignment methods. In <xref ref-type="fig" rid="pcbi-1001075-g001">Fig 1c</xref>, we match protein 1MP6 to protein 2EOW (residue 12–37) with an alpha helix and a beta sheet. We can see that a small portion of the chain at the end of 1MP6 is stretched to match with the sheet in 2EOW. Since the change of shape in this case is more than the matching in <xref ref-type="fig" rid="pcbi-1001075-g001">Fig 1a and 1b</xref>, the distance between 1MP6 and 2EOW (0.943) is larger than that of 1MP6 and 1G1J (0.668) and that of 1MP6 and 2K98 (0.895). Secondary structure information is not used in these matchings. It is possible to match only alpha helices with alpha helices and beta sheets with beta sheets when additional secondary structure information is incorporated (see <xref ref-type="sec" rid="s4">Discussion</xref>). It is worth mentioning that the matching of two conformations of the same protein (such as two NMR models of the same protein) produced by elastic shape analysis does not necessarily have the corresponding residues of the protein matched. This is so because matching of the corresponding residues is not a constraint in calculating the distance and thus may not be satisfied.</p>
            <fig id="pcbi-1001075-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1001075.g001</object-id><label>Figure 1</label>
               <caption>
                  <title>Examples of elastic geodesics.</title>
                  <p>a) Elastic matching between protein 1MP6 and 1G1J. b) Elastic matching between protein 1MP6 and 2K98. c) Matching between protein 1MP6 and 2EOW.</p>
               </caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1001075.g001" xlink:type="simple"/></fig>
            <p>In <xref ref-type="fig" rid="pcbi-1001075-g002">Fig 2</xref> we show the geodesic path from 1MP6 to 2K98. We can see that 1MP6, the left-most structure, transforms its shape to 2K98, the right-most structure, by bending the middle portion of the straight helical structure. Under the current elastic matching approach, there may not be a physically meaningful explanation of the geodesic path since we allow both bending and stretching of the curves. But with some restrictions on how the curves can be manipulated, geodesic paths may shed some light on the conformational changes or dynamics of protein structures when different conformations of the same protein are compared.</p>
            <fig id="pcbi-1001075-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1001075.g002</object-id><label>Figure 2</label>
               <caption>
                  <title>Geodesic path between protein 1MP6, the left-most structure, and protein 2K98, the right-most structure.</title>
               </caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1001075.g002" xlink:type="simple"/></fig>
            <p>Proteins are flexible molecules and conformational dynamics is important for protein functions <xref ref-type="bibr" rid="pcbi.1001075-Huang1">[47]</xref>, <xref ref-type="bibr" rid="pcbi.1001075-Zhang2">[48]</xref>. It has been proposed that protein structures should be characterized as ensembles of structures instead of single structures as seen in X-ray crystallography <xref ref-type="bibr" rid="pcbi.1001075-Furnham1">[49]</xref>, <xref ref-type="bibr" rid="pcbi.1001075-Zhang3">[50]</xref>. In NMR structure determination, multiple models are often used to describe protein structures in solution. One natural, and statistically appropriate, representation of an ensemble of structures would be a probability distribution, where the mean of the distribution is the mean structure of the ensemble and covariances characterize the structure variations at different parts of the structure. This representation allows one to compute statistics of shapes as if they are random variables. Different probability distributions, representing different protein families, can be compared using standard testing. Hypothesis testing on whether a protein structure belongs to a known family of proteins can be performed using likelihood-ratio tests. Structure variations within a protein family can also be studied under this mathematical framework. For example, given a few sample shapes from a population, this method can produce their average shape in a principled manner. Let <italic>β</italic><sub>1</sub>, <italic>β</italic><sub>2</sub>, <italic>…</italic>, <italic>β<sub>n</sub></italic> be a given set of structures, represented by their SRVFs <italic>q</italic><sub>1</sub>, <italic>q</italic><sub>2</sub>, <italic>…</italic>, <italic>q<sub>n</sub></italic>. Define their mean shape as the quantity:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1001075.e052" xlink:type="simple"/><label>(6)</label></disp-formula>where <italic>d</italic>([<italic>q</italic>],[<italic>q<sub>i</sub></italic>]) is the distance between <italic>q</italic> and <italic>q<sub>i</sub></italic>. The actual minimizer is found using an iterated gradient-approach that is not repeated here due to the lack of space but has been presented in many papers earlier (see e.g. <xref ref-type="bibr" rid="pcbi.1001075-Joshi1">[42]</xref>). Consider the 20 NMR structures of protein 2JVD obtained from the PDB (shown in <xref ref-type="fig" rid="pcbi-1001075-g003">Fig 3a</xref>). We have calculated the mean structure of these 20 NMR structures, and the result is shown in <xref ref-type="fig" rid="pcbi-1001075-g003">Fig 3b</xref>. Mean shapes of protein structure families/classes can be very useful in automatic classifications of new protein structures. For example, they can serve as filters to quickly narrow down the list of more likely protein families, which can then be studied in more details. In addition to the first central moment, i.e. sample means, we can also calculate covariances for a group of structures and even build a Gaussian-type probability distribution for this group by considering the available structures as a sample from the underlying distribution.</p>
            <fig id="pcbi-1001075-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1001075.g003</object-id><label>Figure 3</label>
               <caption>
                  <title>Mean structure and sampled structures.</title>
                  <p>a) 2JVD NMR structures. b) The mean structure of multiple 2JVD NMR structures. c) Samples from the probability distribution. d) Samples on the largest variation direction.</p>
               </caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1001075.g003" xlink:type="simple"/></fig>
         </sec>
         <sec id="s2a4">
            <title>Covariance and its use in structure classification</title>
            <p>One unique feature of the framework is its ability to calculate covariances for populations of protein structures. Covariances can reveal the population-specific variation among a group of protein structures and be used in classification of protein structures. From the covariances we can identify the directions with the largest variation within a group of protein structures. To define sample covariance we first approximate the shape space <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001075.e053" xlink:type="simple"/></inline-formula> in a neighborhood of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001075.e054" xlink:type="simple"/></inline-formula> by a flat space <italic>T<sub>μ</sub></italic>(<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001075.e055" xlink:type="simple"/></inline-formula>). Then, each of the observed structures, or rather its SRVF, is transferred to the flat space <italic>T<sub>μ</sub></italic>(<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001075.e056" xlink:type="simple"/></inline-formula>) using the mapping:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1001075.e057" xlink:type="simple"/></disp-formula>These <italic>v<sub>i</sub></italic>s are simply the directions of the geodesics from the mean <italic>μ</italic> to <italic>q<sub>i</sub></italic>s. We can compute the standard sample covariance matrix <italic>K</italic> of <italic>v<sub>i</sub></italic>s and take its singular value decomposition <italic>K</italic> = <italic>UΣU<sup>t</sup></italic>. Here <italic>Σ</italic> is a diagonal matrix of singular values (<italic>σ</italic><sub>1</sub>, <italic>σ</italic><sub>2</sub>, <italic>σ</italic><sub>3</sub>…) and <italic>U</italic> contains the corresponding singular vectors. If the singular values are arranged in a decreasing order, the first few, say <italic>k</italic>, columns of <italic>U</italic> represent the directions of major variation, or the principal components, in the underlying population. If we let <italic>z</italic><sub>1</sub>, <italic>z</italic><sub>2</sub>, … <italic>z<sub>k</sub></italic> be independent standard normal random variables, we can define a multivariate normal density on the direction <italic>v</italic> according to:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1001075.e058" xlink:type="simple"/></disp-formula>Then, this random direction can be converted into the SRVF of a random shape using the mapping<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1001075.e059" xlink:type="simple"/></disp-formula>which can be further converted into a shape using integration:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1001075.e060" xlink:type="simple"/></disp-formula>This defines a formal probability model on the shape space <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001075.e061" xlink:type="simple"/></inline-formula> and one can sample random structures from it using the steps outlined above. <xref ref-type="fig" rid="pcbi-1001075-g003">Fig 3c</xref> shows 10 randomly sampled structures from such distribution with parameters estimated from the given structures.</p>
            <p>If we set <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1001075.e062" xlink:type="simple"/></inline-formula> for some <italic>i</italic>, we can study the resulting shape changes in the direction of <italic>U<sub>i</sub></italic>. By computing the shapes for a range of <italic>t</italic> from −2 to 2, we can see the shape variability in the structures for that direction. For example, in <xref ref-type="fig" rid="pcbi-1001075-g003">Fig 3d</xref>, we sample 10 structures along the largest variation direction <italic>U</italic><sub>1</sub>. To display the rigid superposition of the structures we translate them so that their centres of mass coincide with that of the mean structure. The rotations were obtained through optimally matching the SRVFs of these structures to the mean structure. The variation can be decomposed to residue level and the flexibility (structure variation) of each residue can be analyzed. To obtain the variance for each residue, we sampled randomly 10 structures and align them with the mean shape. The distances of each residue of sampled structures with that of mean shape can then be calculated and used to compute variance of that particular residue. In <xref ref-type="fig" rid="pcbi-1001075-g004">Fig 4</xref>, we plot the variance of each residue for 2JVD. We can see clearly that those residues at the C terminal have much larger variation, which is consistent with observation from the multiple NMR structures.</p>
            <fig id="pcbi-1001075-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1001075.g004</object-id><label>Figure 4</label>
               <caption>
                  <title>Flexibilities at each residue of 2JVD.</title>
                  <p>X-axis is the indices of residues and y-axis is the variations of the residues.</p>
               </caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1001075.g004" xlink:type="simple"/></fig>
            <p>To illustrate how we can use the covariance for structure classification, we sampled two random structures from the distribution built using multiple NMR structures of protein 2JVD with the same geodesic distance to the mean structure, but along two different directions. The probabilities of the two structures under the calculated distribution are 0.0429 and 0.0048, respectively. Although they have the same distance to the mean structure, their probabilities are quite different. This is so because structure 1 lies in the direction with largest variability in the population and structure 2 lies in the direction with much smaller variability, as shown in <xref ref-type="fig" rid="pcbi-1001075-g005">Fig 5a</xref>. <xref ref-type="fig" rid="pcbi-1001075-g005">Fig 5b</xref> shows the superposition of the mean structure, structure 1 and structure 2. This can be a common scenario in structure classification in practice where by chance two proteins may be more similar in the parts that are not conserved within their own families, but less similar in the conserved parts. That will give a relatively small distance for the two proteins although they are not in the same family. Classification of such proteins can be improved using covariance structures of their corresponding families. In the sequence alignment, profiles can be built for families of sequences to achieve better sensitivity and accuracy <xref ref-type="bibr" rid="pcbi.1001075-Eddy1">[51]</xref>. However, profiles for protein structures are much harder to build. The current framework can readily account for the family-specific variations and use them in structure classifications.</p>
            <fig id="pcbi-1001075-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1001075.g005</object-id><label>Figure 5</label>
               <caption>
                  <title>Covariance in structure classification.</title>
                  <p>a) Illustration of two directions with different variations. b) Two structures sampled on the two directions of different variability but with similar distance to the mean shape.</p>
               </caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1001075.g005" xlink:type="simple"/></fig>
         </sec>
      </sec>
   </sec>
   <sec id="s3">
      <title>Results</title>
      <p>In this section, we present the performance of our method on a large scale protein structure classification using structures from SCOP database and compare our results with CE <xref ref-type="bibr" rid="pcbi.1001075-Shindyalov1">[12]</xref> and Matt <xref ref-type="bibr" rid="pcbi.1001075-Menke1">[25]</xref>. We selected a subset of non-homologous proteins from SCOP database with pair-wise sequence identity smaller than 40% from the four largest classes (with at least 5 members) at top level of SCOP hierarchy (all alpha, all beta, alpha/beta and alpha+beta). Classes at the bottom level (family level) with less than 20 members are ignored. This gave us a set of 1579 proteins in total. We calculated the pair-wise geodesic distances among these protein structures and clustered them into different classes. Hierarchical clustering is done using the cluster function in Matlab and average linkage is used to calculate distances among clusters. When number of clusters, <italic>n</italic>, is provided, the hierarchical clustering results can be easily divided into <italic>n</italic> classes. For CE and Matt, we used (1−score/score_max) as the distance, where score is either z-score provided by CE or a matching score provided by Matt, and score_max is the maximum z-score (for CE) or maximum matching score (for Matt) among all pairwise scores. Using the scores directly gave worse performances. We then used random index (RI) as a criterion to evaluate the accuracy of our classification. RI measures the percentage of correct decisions by looking at all pair-wise decisions, which is the ratio ((TP+TN)/(TP+TN+FP+FN)), where TP is true positive for a pair of proteins, which are in the same class in SCOP and classified into the same class, and TN (True Negative), FP (False Positive), FN (False Negative) are defined similarly. In <xref ref-type="table" rid="pcbi-1001075-t001">Table 1</xref>, we compare the performance of our method with CE and Matt. To show how the methods perform for different types of proteins classified at the top level, we also show the results for these classes. We can see from <xref ref-type="table" rid="pcbi-1001075-t001">Table 1</xref> that our method, without using any secondary structure information, is comparable with CE and Matt overall. It is interesting that these methods have quite different performances for some protein classes.</p>
      <table-wrap id="pcbi-1001075-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1001075.t001</object-id><label>Table 1</label><caption>
            <title>Performance comparison of elastic shape analysis (ESA) with Combinatorial Extension (CE) and Matt.</title>
         </caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1001075-t001-1" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1001075.t001" xlink:type="simple"/><table>
            <colgroup span="1">
               <col align="left" span="1"/>
               <col align="center" span="1"/>
               <col align="center" span="1"/>
               <col align="center" span="1"/>
               <col align="center" span="1"/>
               <col align="center" span="1"/>
               <col align="center" span="1"/>
            </colgroup>
            <thead>
               <tr>
                  <td align="left" colspan="1" rowspan="1"/>
                  <td align="left" colspan="2" rowspan="1">ESA</td>
                  <td align="left" colspan="2" rowspan="1">CE</td>
                  <td align="left" colspan="2" rowspan="1">Matt</td>
               </tr>
               <tr>
                  <td align="left" colspan="1" rowspan="1"/>
                  <td align="left" colspan="1" rowspan="1">TP/TN/FP/FN</td>
                  <td align="left" colspan="1" rowspan="1">RI</td>
                  <td align="left" colspan="1" rowspan="1">TP/TN/FP/FN</td>
                  <td align="left" colspan="1" rowspan="1">RI</td>
                  <td align="left" colspan="1" rowspan="1">TP/TN/FP/FN</td>
                  <td align="left" colspan="1" rowspan="1">RI</td>
               </tr>
            </thead>
            <tbody>
               <tr>
                  <td align="left" colspan="1" rowspan="1">A 229/9</td>
                  <td align="left" colspan="1" rowspan="1">2417/16880/6308/501</td>
                  <td align="left" colspan="1" rowspan="1">0.7392</td>
                  <td align="left" colspan="1" rowspan="1">2778/18721/4467/140</td>
                  <td align="left" colspan="1" rowspan="1">0.8235</td>
                  <td align="left" colspan="1" rowspan="1">2728/5643/17545/190</td>
                  <td align="left" colspan="1" rowspan="1">0.3207</td>
               </tr>
               <tr>
                  <td align="left" colspan="1" rowspan="1">B 516/13</td>
                  <td align="left" colspan="1" rowspan="1">10786/84675/35621/1788</td>
                  <td align="left" colspan="1" rowspan="1">0.7185</td>
                  <td align="left" colspan="1" rowspan="1">12193/91395/28901/381</td>
                  <td align="left" colspan="1" rowspan="1">0.7796</td>
                  <td align="left" colspan="1" rowspan="1">12137/97311/22985/437</td>
                  <td align="left" colspan="1" rowspan="1">0.8237</td>
               </tr>
               <tr>
                  <td align="left" colspan="1" rowspan="1">C 516/17</td>
                  <td align="left" colspan="1" rowspan="1">6624/98811/24907/2528</td>
                  <td align="left" colspan="1" rowspan="1">0.7935</td>
                  <td align="left" colspan="1" rowspan="1">8075/82681/41037/1077</td>
                  <td align="left" colspan="1" rowspan="1">0.6830</td>
                  <td align="left" colspan="1" rowspan="1">8827/106865/16853/325</td>
                  <td align="left" colspan="1" rowspan="1">0.8707</td>
               </tr>
               <tr>
                  <td align="left" colspan="1" rowspan="1">D 292/8</td>
                  <td align="left" colspan="1" rowspan="1">5728/34756/1324/678</td>
                  <td align="left" colspan="1" rowspan="1">0.9529</td>
                  <td align="left" colspan="1" rowspan="1">6361/30684/5396/45</td>
                  <td align="left" colspan="1" rowspan="1">0.8719</td>
                  <td align="left" colspan="1" rowspan="1">6406/36080/0/0</td>
                  <td align="left" colspan="1" rowspan="1">1</td>
               </tr>
               <tr>
                  <td align="left" colspan="1" rowspan="1">Total 1579/48</td>
                  <td align="left" colspan="1" rowspan="1">24409/1117980/96476/6966</td>
                  <td align="left" colspan="1" rowspan="1">0.9170</td>
                  <td align="left" colspan="1" rowspan="1">29431/1125707/88749/1944</td>
                  <td align="left" colspan="1" rowspan="1">0.9272</td>
                  <td align="left" colspan="1" rowspan="1">30042/1069181/145275/1333</td>
                  <td align="left" colspan="1" rowspan="1">0.8823</td>
               </tr>
            </tbody>
         </table></alternatives><table-wrap-foot>
            <fn id="nt101">
               <label/>
               <p>TP: true positive, TN: true negative, FP: false positive, FN: false negative. RI: random index scores.</p>
            </fn>
         </table-wrap-foot></table-wrap>
      <p>An example that illustrates the strength of our method is protein pair 1ycc and 1gu2, which have a small geodesic distance (0.84) and are correctly classified into the same family by our method. For these two proteins, CE gives a small z-score (2.6) and classifies them into different classes. DaliLite and Mammoth give z-scores of 3.2 and 1.6, respectively (small scores imply large distances). Matt, a method for flexible protein alignment, gives a <italic>p</italic>-value of 0.03 showing the two proteins have statistically significant similarities. The rigid alignment of the two proteins by Mammoth is shown in the left panel of <xref ref-type="fig" rid="pcbi-1001075-g006">Fig 6</xref> and matching of the two proteins by ESA is shown in the right of <xref ref-type="fig" rid="pcbi-1001075-g006">Fig 6</xref>. One can see that a rigid alignment aligns the two proteins rather poorly. On the other hand, flexible alignment methods like Matt and ours can match them quite well.</p>
      <fig id="pcbi-1001075-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1001075.g006</object-id><label>Figure 6</label>
         <caption>
            <title>Example of structure alignment by ESA.</title>
            <p>a) Rigid superposition of 1ycc and 1gu2. b) Matching of points along 1gu2 and 1ycc by elastic shape analysis. The red regions label helices, green regions label strands, and blue regions label coils.</p>
         </caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1001075.g006" xlink:type="simple"/></fig>
      <p>Finally we compared the running time of our method with several other methods. <xref ref-type="table" rid="pcbi-1001075-t002">Table 2</xref> shows the comparison of running time of CE, Matt, MUSTANG and ESA on three pairs of proteins with around 100, 200 and 300 residues, respectively. All the programs were run using the same computer.</p>
      <table-wrap id="pcbi-1001075-t002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1001075.t002</object-id><label>Table 2</label><caption>
            <title>Running time comparison of different methods.</title>
         </caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1001075-t002-2" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1001075.t002" xlink:type="simple"/><table>
            <colgroup span="1">
               <col align="left" span="1"/>
               <col align="center" span="1"/>
               <col align="center" span="1"/>
               <col align="center" span="1"/>
            </colgroup>
            <thead>
               <tr>
                  <td align="left" colspan="1" rowspan="1"/>
                  <td align="left" colspan="1" rowspan="1">∼100 residues</td>
                  <td align="left" colspan="1" rowspan="1">∼200 residues</td>
                  <td align="left" colspan="1" rowspan="1">∼300 residues</td>
               </tr>
            </thead>
            <tbody>
               <tr>
                  <td align="left" colspan="1" rowspan="1">CE</td>
                  <td align="left" colspan="1" rowspan="1">1.3</td>
                  <td align="left" colspan="1" rowspan="1">3.0</td>
                  <td align="left" colspan="1" rowspan="1">5.1</td>
               </tr>
               <tr>
                  <td align="left" colspan="1" rowspan="1">Matt</td>
                  <td align="left" colspan="1" rowspan="1">0.16</td>
                  <td align="left" colspan="1" rowspan="1">2.30</td>
                  <td align="left" colspan="1" rowspan="1">2.1</td>
               </tr>
               <tr>
                  <td align="left" colspan="1" rowspan="1">Mustang</td>
                  <td align="left" colspan="1" rowspan="1">1.2</td>
                  <td align="left" colspan="1" rowspan="1">2.6</td>
                  <td align="left" colspan="1" rowspan="1">15</td>
               </tr>
               <tr>
                  <td align="left" colspan="1" rowspan="1">ESA</td>
                  <td align="left" colspan="1" rowspan="1">0.74</td>
                  <td align="left" colspan="1" rowspan="1">1.04</td>
                  <td align="left" colspan="1" rowspan="1">1.54</td>
               </tr>
            </tbody>
         </table></alternatives><table-wrap-foot>
            <fn id="nt102">
               <label/>
               <p>All the times are in seconds.</p>
            </fn>
         </table-wrap-foot></table-wrap>
   </sec>
   <sec id="s4">
      <title>Discussion</title>
      <p>In summary, we have developed a mathematical framework for protein structure comparison based on elastic shape analysis, a method originally developed in the field of computer vision and image analysis. Under this framework, protein structures are compared as three dimensional elastic curves and can be treated as random variables for statistical analysis. Mean and covariance of a group of protein structures can be computed. Probability distributions can be built for a population of protein structures and hypothesis testing can be conducted for a protein structure against a known protein family/class. Although protein structures have been studies for many years and many computational methods have been developed for protein structure comparison, as far as we know, this is the first rigorous mathematical framework that can address the above computations.</p>
      <p>It is worth mentioning that although we consider protein structures as three dimensional curves in this study and ignore the sequence and local structure features (such as secondary structures), the framework can readily incorporate amino acid sequence or secondary structure information. Such additional information can be very helpful to achieve better alignment. For example, secondary structure information has been used by many structure alignment methods since secondary structure type is the major feature used in manual structure classification. To incorporate such auxiliary information we can construct continuous auxiliary functions along the curves, derived from the additional information. The matching and deformations can then be performed using the higher dimensional composite curves that are formed by concatenating the geometric and the auxiliary coordinates. The distances obtained are still proper distances on the higher dimensional space. In this matching, one needs to adjust the relative magnitude (weight) of the geometric and auxiliary coordinates, which can be problem dependent. With secondary structure type as auxiliary function, we can force protein fragments with the same secondary structure type to match with each other by giving a larger weight on the auxiliary secondary structure information, which may further improve the accuracy of structure classification. When using sequence as auxiliary information, one can perform alignment on both structure and sequence space by using an amino acid substitution matrix (for instance, BLOSUM62 matrix) as the distance measure for amino acid residues along the chains. One can also force all corresponding residues to match with each other when comparing two protein structures with the same sequence. The geodesic path (deformation from one structure to another) generated using such constraint may then have a more natural physical interpretation.</p>
      <p>In this study we focused mainly on pairwise protein structure comparison and studying the basic properties of a population of structures such as means and covariances. The framework can also be applied to study multiple structure comparison (multiple structure alignment) and provide an alignment of multiple structures if it is desirable. To do so, we can calculate the mean structure of the multiple structures and align each structure to the mean structure. The mathematical framework also provides principled ways to deal with more complex situations. For example, in the troublesome case that there is one or more structures that are very different from the rest of the structures to be aligned, outliers can be detected based on the mean and covariance structure of the population.</p>
      <p>In constructing a probability distribution from a group of structures, we chose the tangent space of our shape space and assumed Gaussian distribution on this space. The shape spaces (ours and most other formally defined shape spaces) are highly nonlinear manifolds and it is difficult to build distributions on them directly. On the other hand, it is a very common practice to impose probability distributions on the tangent space since they are linear (vector) spaces. The mapping between a tangent space and the manifold can be made a bijection by putting some appropriate constraints on the tangent space. As for the choice of Gaussian distribution, we have not validated it on the tangent spaces of our shape space. Our goal in this study is to demonstrate the computation of the second moment for observed shapes and to suggest the simplest probability model that captures the first two moments, i.e. a multivariate normal. One can easily extend this framework to include mixtures of Gaussian models <xref ref-type="bibr" rid="pcbi.1001075-Srivastava2">[52]</xref> or even generalized Gaussian models and we expect them to better match the observed variability of the protein structures. These extensions can be explored in future studies.</p>
      <p>Since we represent protein structures as curves, our method mainly deals with the type of structure comparison where sequence order of amino acid residues is relevant to the distances of structures (sequential structure alignment). In general, our method is not good at detecting related proteins whose differences are caused by changes such as domain swapping, or domain insertion/deletion. However, the method can be readily modified to compare circular permuted proteins <xref ref-type="bibr" rid="pcbi.1001075-Dundas1">[33]</xref> by linking the C-terminal and N-terminal ends of a protein (for example, using a straight line) and cutting the protein in the middle, preferably at residues linking domains or secondary structure fragments. To deal with domain insertion/deletion/swapping, we can use the algorithm in <xref ref-type="bibr" rid="pcbi.1001075-Dundas1">[33]</xref>, where this problem is formulated as a mixed-integer programming problem, to select near optimal combination of fragments before calculating geodesic distances. If domain swapping or deletion/insertion can be detected or predicted (i.e. using sequence based methods), cuts and reconnections can also be done at corresponding positions to allow for even more flexible structure comparisons.</p>
   </sec>
</body>
<back>
   <ref-list>
      <title>References</title>
      <ref id="pcbi.1001075-Kolodny1">
         <label>1</label>
         <element-citation publication-type="journal" xlink:type="simple">
            <person-group person-group-type="author">
               <name name-style="western"><surname>Kolodny</surname><given-names>R</given-names></name>
               <name name-style="western"><surname>Petrey</surname><given-names>D</given-names></name>
               <name name-style="western"><surname>Honig</surname><given-names>B</given-names></name>
            </person-group>
            <year>2006</year>
            <article-title>Protein structure comparison: implications for the nature of ‘fold space’, and structure and function prediction.</article-title>
            <source>Curr Opin Struct Biol</source>
            <volume>16</volume>
            <fpage>393</fpage>
            <lpage>398</lpage>
         </element-citation>
      </ref>
      <ref id="pcbi.1001075-Hasegawa1">
         <label>2</label>
         <element-citation publication-type="journal" xlink:type="simple">
            <person-group person-group-type="author">
               <name name-style="western"><surname>Hasegawa</surname><given-names>H</given-names></name>
               <name name-style="western"><surname>Holm</surname><given-names>L</given-names></name>
            </person-group>
            <year>2009</year>
            <article-title>Advances and pitfalls of protein structural alignment.</article-title>
            <source>Curr Opin Struct Biol</source>
            <volume>19</volume>
            <fpage>341</fpage>
            <lpage>348</lpage>
         </element-citation>
      </ref>
      <ref id="pcbi.1001075-Dobson1">
         <label>3</label>
         <element-citation publication-type="journal" xlink:type="simple">
            <person-group person-group-type="author">
               <name name-style="western"><surname>Dobson</surname><given-names>PD</given-names></name>
               <name name-style="western"><surname>Cai</surname><given-names>YD</given-names></name>
               <name name-style="western"><surname>Stapley</surname><given-names>BJ</given-names></name>
               <name name-style="western"><surname>Doig</surname><given-names>AJ</given-names></name>
            </person-group>
            <year>2004</year>
            <article-title>Prediction of protein function in the absence of significant sequence similarity.</article-title>
            <source>Curr Med Chem</source>
            <volume>11</volume>
            <fpage>2135</fpage>
            <lpage>2142</lpage>
         </element-citation>
      </ref>
      <ref id="pcbi.1001075-Illergard1">
         <label>4</label>
         <element-citation publication-type="journal" xlink:type="simple">
            <person-group person-group-type="author">
               <name name-style="western"><surname>Illergard</surname><given-names>K</given-names></name>
               <name name-style="western"><surname>Ardell</surname><given-names>DH</given-names></name>
               <name name-style="western"><surname>Elofsson</surname><given-names>A</given-names></name>
            </person-group>
            <year>2009</year>
            <article-title>Structure is three to ten times more conserved than sequence–a study of structural response in protein cores.</article-title>
            <source>Proteins</source>
            <volume>77</volume>
            <fpage>499</fpage>
            <lpage>508</lpage>
         </element-citation>
      </ref>
      <ref id="pcbi.1001075-Murzin1">
         <label>5</label>
         <element-citation publication-type="journal" xlink:type="simple">
            <person-group person-group-type="author">
               <name name-style="western"><surname>Murzin</surname><given-names>AG</given-names></name>
               <name name-style="western"><surname>Brenner</surname><given-names>SE</given-names></name>
               <name name-style="western"><surname>Hubbard</surname><given-names>T</given-names></name>
               <name name-style="western"><surname>Chothia</surname><given-names>C</given-names></name>
            </person-group>
            <year>1995</year>
            <article-title>SCOP: a structural classification of proteins database for the investigation of sequences and structures.</article-title>
            <source>J Mol Biol</source>
            <volume>247</volume>
            <fpage>536</fpage>
            <lpage>540</lpage>
         </element-citation>
      </ref>
      <ref id="pcbi.1001075-LoConte1">
         <label>6</label>
         <element-citation publication-type="journal" xlink:type="simple">
            <person-group person-group-type="author">
               <name name-style="western"><surname>Lo Conte</surname><given-names>L</given-names></name>
               <name name-style="western"><surname>Ailey</surname><given-names>B</given-names></name>
               <name name-style="western"><surname>Hubbard</surname><given-names>TJ</given-names></name>
               <name name-style="western"><surname>Brenner</surname><given-names>SE</given-names></name>
               <name name-style="western"><surname>Murzin</surname><given-names>AG</given-names></name>
               <etal/>
            </person-group>
            <year>2000</year>
            <article-title>SCOP: a structural classification of proteins database.</article-title>
            <source>Nucleic Acids Res</source>
            <volume>28</volume>
            <fpage>257</fpage>
            <lpage>259</lpage>
         </element-citation>
      </ref>
      <ref id="pcbi.1001075-Orengo1">
         <label>7</label>
         <element-citation publication-type="journal" xlink:type="simple">
            <person-group person-group-type="author">
               <name name-style="western"><surname>Orengo</surname><given-names>CA</given-names></name>
               <name name-style="western"><surname>Michie</surname><given-names>AD</given-names></name>
               <name name-style="western"><surname>Jones</surname><given-names>S</given-names></name>
               <name name-style="western"><surname>Jones</surname><given-names>DT</given-names></name>
               <name name-style="western"><surname>Swindells</surname><given-names>MB</given-names></name>
               <etal/>
            </person-group>
            <year>1997</year>
            <article-title>CATH - a hierarchic classification of protein domain structures.</article-title>
            <source>Structure</source>
            <volume>5</volume>
            <fpage>1093</fpage>
            <lpage>1108</lpage>
         </element-citation>
      </ref>
      <ref id="pcbi.1001075-Orengo2">
         <label>8</label>
         <element-citation publication-type="journal" xlink:type="simple">
            <person-group person-group-type="author">
               <name name-style="western"><surname>Orengo</surname><given-names>CA</given-names></name>
               <name name-style="western"><surname>Pearl</surname><given-names>FM</given-names></name>
               <name name-style="western"><surname>Thornton</surname><given-names>JM</given-names></name>
            </person-group>
            <year>2003</year>
            <article-title>The CATH domain structure database.</article-title>
            <source>Methods Biochem Anal</source>
            <volume>44</volume>
            <fpage>249</fpage>
            <lpage>271</lpage>
         </element-citation>
      </ref>
      <ref id="pcbi.1001075-Holm1">
         <label>9</label>
         <element-citation publication-type="journal" xlink:type="simple">
            <person-group person-group-type="author">
               <name name-style="western"><surname>Holm</surname><given-names>L</given-names></name>
               <name name-style="western"><surname>Ouzounis</surname><given-names>C</given-names></name>
               <name name-style="western"><surname>Sander</surname><given-names>C</given-names></name>
               <name name-style="western"><surname>Tuparev</surname><given-names>G</given-names></name>
               <name name-style="western"><surname>Vriend</surname><given-names>G</given-names></name>
            </person-group>
            <year>1992</year>
            <article-title>A database of protein structure families with common folding motifs.</article-title>
            <source>Protein Sci</source>
            <volume>1</volume>
            <fpage>1691</fpage>
            <lpage>1698</lpage>
         </element-citation>
      </ref>
      <ref id="pcbi.1001075-Berman1">
         <label>10</label>
         <element-citation publication-type="journal" xlink:type="simple">
            <person-group person-group-type="author">
               <name name-style="western"><surname>Berman</surname><given-names>HM</given-names></name>
               <name name-style="western"><surname>Westbrook</surname><given-names>J</given-names></name>
               <name name-style="western"><surname>Feng</surname><given-names>Z</given-names></name>
               <name name-style="western"><surname>Gilliland</surname><given-names>G</given-names></name>
               <name name-style="western"><surname>Bhat</surname><given-names>TN</given-names></name>
               <etal/>
            </person-group>
            <year>2000</year>
            <article-title>The Protein Data Bank.</article-title>
            <source>Nucleic Acids Res</source>
            <volume>28</volume>
            <fpage>235</fpage>
            <lpage>242</lpage>
         </element-citation>
      </ref>
      <ref id="pcbi.1001075-Holm2">
         <label>11</label>
         <element-citation publication-type="journal" xlink:type="simple">
            <person-group person-group-type="author">
               <name name-style="western"><surname>Holm</surname><given-names>L</given-names></name>
               <name name-style="western"><surname>Sander</surname><given-names>C</given-names></name>
            </person-group>
            <year>1996</year>
            <article-title>Mapping the protein universe.</article-title>
            <source>Science</source>
            <volume>273</volume>
            <fpage>595</fpage>
            <lpage>603</lpage>
         </element-citation>
      </ref>
      <ref id="pcbi.1001075-Shindyalov1">
         <label>12</label>
         <element-citation publication-type="journal" xlink:type="simple">
            <person-group person-group-type="author">
               <name name-style="western"><surname>Shindyalov</surname><given-names>IN</given-names></name>
               <name name-style="western"><surname>Bourne</surname><given-names>PE</given-names></name>
            </person-group>
            <year>1998</year>
            <article-title>Protein structure alignment by incremental combinatorial extension (CE) of the optimal path.</article-title>
            <source>Protein Eng</source>
            <volume>11</volume>
            <fpage>739</fpage>
            <lpage>747</lpage>
         </element-citation>
      </ref>
      <ref id="pcbi.1001075-Ortiz1">
         <label>13</label>
         <element-citation publication-type="journal" xlink:type="simple">
            <person-group person-group-type="author">
               <name name-style="western"><surname>Ortiz</surname><given-names>AR</given-names></name>
               <name name-style="western"><surname>Strauss</surname><given-names>CE</given-names></name>
               <name name-style="western"><surname>Olmea</surname><given-names>O</given-names></name>
            </person-group>
            <year>2002</year>
            <article-title>MAMMOTH (matching molecular models obtained from theory): an automated method for model comparison.</article-title>
            <source>Protein Sci</source>
            <volume>11</volume>
            <fpage>2606</fpage>
            <lpage>2621</lpage>
         </element-citation>
      </ref>
      <ref id="pcbi.1001075-Mosca1">
         <label>14</label>
         <element-citation publication-type="journal" xlink:type="simple">
            <person-group person-group-type="author">
               <name name-style="western"><surname>Mosca</surname><given-names>R</given-names></name>
               <name name-style="western"><surname>Brannetti</surname><given-names>B</given-names></name>
               <name name-style="western"><surname>Schneider</surname><given-names>TR</given-names></name>
            </person-group>
            <year>2008</year>
            <article-title>Alignment of protein structures in the presence of domain motions.</article-title>
            <source>BMC Bioinformatics</source>
            <volume>9</volume>
            <fpage>352</fpage>
         </element-citation>
      </ref>
      <ref id="pcbi.1001075-Mosca2">
         <label>15</label>
         <element-citation publication-type="journal" xlink:type="simple">
            <person-group person-group-type="author">
               <name name-style="western"><surname>Mosca</surname><given-names>R</given-names></name>
               <name name-style="western"><surname>Schneider</surname><given-names>TR</given-names></name>
            </person-group>
            <year>2008</year>
            <article-title>RAPIDO: a web server for the alignment of protein structures in the presence of conformational changes.</article-title>
            <source>Nucleic Acids Res</source>
            <volume>36</volume>
            <fpage>W42</fpage>
            <lpage>46</lpage>
         </element-citation>
      </ref>
      <ref id="pcbi.1001075-Krissinel1">
         <label>16</label>
         <element-citation publication-type="journal" xlink:type="simple">
            <person-group person-group-type="author">
               <name name-style="western"><surname>Krissinel</surname><given-names>E</given-names></name>
               <name name-style="western"><surname>Henrick</surname><given-names>K</given-names></name>
            </person-group>
            <year>2004</year>
            <article-title>Secondary-structure matching (SSM), a new tool for fast protein structure alignment in three dimensions.</article-title>
            <source>Acta Crystallogr D Biol Crystallogr</source>
            <volume>60</volume>
            <fpage>2256</fpage>
            <lpage>2268</lpage>
         </element-citation>
      </ref>
      <ref id="pcbi.1001075-Taylor1">
         <label>17</label>
         <element-citation publication-type="journal" xlink:type="simple">
            <person-group person-group-type="author">
               <name name-style="western"><surname>Taylor</surname><given-names>WR</given-names></name>
               <name name-style="western"><surname>Flores</surname><given-names>TP</given-names></name>
               <name name-style="western"><surname>Orengo</surname><given-names>CA</given-names></name>
            </person-group>
            <year>1994</year>
            <article-title>Multiple protein structure alignment.</article-title>
            <source>Protein Sci</source>
            <volume>3</volume>
            <fpage>1858</fpage>
            <lpage>1870</lpage>
         </element-citation>
      </ref>
      <ref id="pcbi.1001075-Zhu1">
         <label>18</label>
         <element-citation publication-type="journal" xlink:type="simple">
            <person-group person-group-type="author">
               <name name-style="western"><surname>Zhu</surname><given-names>J</given-names></name>
               <name name-style="western"><surname>Weng</surname><given-names>Z</given-names></name>
            </person-group>
            <year>2005</year>
            <article-title>FAST: a novel protein structure alignment algorithm.</article-title>
            <source>Proteins</source>
            <volume>58</volume>
            <fpage>618</fpage>
            <lpage>627</lpage>
         </element-citation>
      </ref>
      <ref id="pcbi.1001075-Kolbeck1">
         <label>19</label>
         <element-citation publication-type="journal" xlink:type="simple">
            <person-group person-group-type="author">
               <name name-style="western"><surname>Kolbeck</surname><given-names>B</given-names></name>
               <name name-style="western"><surname>May</surname><given-names>P</given-names></name>
               <name name-style="western"><surname>Schmidt-Goenner</surname><given-names>T</given-names></name>
               <name name-style="western"><surname>Steinke</surname><given-names>T</given-names></name>
               <name name-style="western"><surname>Knapp</surname><given-names>EW</given-names></name>
            </person-group>
            <year>2006</year>
            <article-title>Connectivity independent protein-structure alignment: a hierarchical approach.</article-title>
            <source>BMC Bioinformatics</source>
            <volume>7</volume>
            <fpage>510</fpage>
         </element-citation>
      </ref>
      <ref id="pcbi.1001075-Ilyin1">
         <label>20</label>
         <element-citation publication-type="journal" xlink:type="simple">
            <person-group person-group-type="author">
               <name name-style="western"><surname>Ilyin</surname><given-names>VA</given-names></name>
               <name name-style="western"><surname>Abyzov</surname><given-names>A</given-names></name>
               <name name-style="western"><surname>Leslin</surname><given-names>CM</given-names></name>
            </person-group>
            <year>2004</year>
            <article-title>Structural alignment of proteins by a novel TOPOFIT method, as a superimposition of common volumes at a topomax point.</article-title>
            <source>Protein Sci</source>
            <volume>13</volume>
            <fpage>1865</fpage>
            <lpage>1874</lpage>
         </element-citation>
      </ref>
      <ref id="pcbi.1001075-Ebert1">
         <label>21</label>
         <element-citation publication-type="journal" xlink:type="simple">
            <person-group person-group-type="author">
               <name name-style="western"><surname>Ebert</surname><given-names>J</given-names></name>
               <name name-style="western"><surname>Brutlag</surname><given-names>D</given-names></name>
            </person-group>
            <year>2006</year>
            <article-title>Development and validation of a consistency based multiple structure alignment algorithm.</article-title>
            <source>Bioinformatics</source>
            <volume>22</volume>
            <fpage>1080</fpage>
            <lpage>1087</lpage>
         </element-citation>
      </ref>
      <ref id="pcbi.1001075-Ye1">
         <label>22</label>
         <element-citation publication-type="journal" xlink:type="simple">
            <person-group person-group-type="author">
               <name name-style="western"><surname>Ye</surname><given-names>Y</given-names></name>
               <name name-style="western"><surname>Godzik</surname><given-names>A</given-names></name>
            </person-group>
            <year>2005</year>
            <article-title>Multiple flexible structure alignment using partial order graphs.</article-title>
            <source>Bioinformatics</source>
            <volume>21</volume>
            <fpage>2362</fpage>
            <lpage>2369</lpage>
         </element-citation>
      </ref>
      <ref id="pcbi.1001075-Shatsky1">
         <label>23</label>
         <element-citation publication-type="journal" xlink:type="simple">
            <person-group person-group-type="author">
               <name name-style="western"><surname>Shatsky</surname><given-names>M</given-names></name>
               <name name-style="western"><surname>Nussinov</surname><given-names>R</given-names></name>
               <name name-style="western"><surname>Wolfson</surname><given-names>HJ</given-names></name>
            </person-group>
            <year>2004</year>
            <article-title>A method for simultaneous alignment of multiple protein structures.</article-title>
            <source>Proteins</source>
            <volume>56</volume>
            <fpage>143</fpage>
            <lpage>156</lpage>
         </element-citation>
      </ref>
      <ref id="pcbi.1001075-Konagurthu1">
         <label>24</label>
         <element-citation publication-type="journal" xlink:type="simple">
            <person-group person-group-type="author">
               <name name-style="western"><surname>Konagurthu</surname><given-names>AS</given-names></name>
               <name name-style="western"><surname>Whisstock</surname><given-names>JC</given-names></name>
               <name name-style="western"><surname>Stuckey</surname><given-names>PJ</given-names></name>
               <name name-style="western"><surname>Lesk</surname><given-names>AM</given-names></name>
            </person-group>
            <year>2006</year>
            <article-title>MUSTANG: a multiple structural alignment algorithm.</article-title>
            <source>Proteins</source>
            <volume>64</volume>
            <fpage>559</fpage>
            <lpage>574</lpage>
         </element-citation>
      </ref>
      <ref id="pcbi.1001075-Menke1">
         <label>25</label>
         <element-citation publication-type="journal" xlink:type="simple">
            <person-group person-group-type="author">
               <name name-style="western"><surname>Menke</surname><given-names>M</given-names></name>
               <name name-style="western"><surname>Berger</surname><given-names>B</given-names></name>
               <name name-style="western"><surname>Cowen</surname><given-names>L</given-names></name>
            </person-group>
            <year>2008</year>
            <article-title>Matt: local flexibility aids protein multiple structure alignment.</article-title>
            <source>PLoS Comput Biol</source>
            <volume>4</volume>
            <fpage>e10</fpage>
         </element-citation>
      </ref>
      <ref id="pcbi.1001075-Zhang1">
         <label>26</label>
         <element-citation publication-type="journal" xlink:type="simple">
            <person-group person-group-type="author">
               <name name-style="western"><surname>Zhang</surname><given-names>Y</given-names></name>
               <name name-style="western"><surname>Skolnick</surname><given-names>J</given-names></name>
            </person-group>
            <year>2005</year>
            <article-title>TM-align: a protein structure alignment algorithm based on the TM-score.</article-title>
            <source>Nucleic Acids Res</source>
            <volume>33</volume>
            <fpage>2302</fpage>
            <lpage>2309</lpage>
         </element-citation>
      </ref>
      <ref id="pcbi.1001075-Sippl1">
         <label>27</label>
         <element-citation publication-type="journal" xlink:type="simple">
            <person-group person-group-type="author">
               <name name-style="western"><surname>Sippl</surname><given-names>MJ</given-names></name>
               <name name-style="western"><surname>Wiederstein</surname><given-names>M</given-names></name>
            </person-group>
            <year>2008</year>
            <article-title>A note on difficult structure alignment problems.</article-title>
            <source>Bioinformatics</source>
            <volume>24</volume>
            <fpage>426</fpage>
            <lpage>427</lpage>
         </element-citation>
      </ref>
      <ref id="pcbi.1001075-Gibrat1">
         <label>28</label>
         <element-citation publication-type="journal" xlink:type="simple">
            <person-group person-group-type="author">
               <name name-style="western"><surname>Gibrat</surname><given-names>JF</given-names></name>
               <name name-style="western"><surname>Madej</surname><given-names>T</given-names></name>
               <name name-style="western"><surname>Bryant</surname><given-names>SH</given-names></name>
            </person-group>
            <year>1996</year>
            <article-title>Surprising similarities in structure comparison.</article-title>
            <source>Curr Opin Struct Biol</source>
            <volume>6</volume>
            <fpage>377</fpage>
            <lpage>385</lpage>
         </element-citation>
      </ref>
      <ref id="pcbi.1001075-Zemla1">
         <label>29</label>
         <element-citation publication-type="journal" xlink:type="simple">
            <person-group person-group-type="author">
               <name name-style="western"><surname>Zemla</surname><given-names>A</given-names></name>
            </person-group>
            <year>2003</year>
            <article-title>LGA: A method for finding 3D similarities in protein structures.</article-title>
            <source>Nucleic Acids Res</source>
            <volume>31</volume>
            <fpage>3370</fpage>
            <lpage>3374</lpage>
         </element-citation>
      </ref>
      <ref id="pcbi.1001075-Shatsky2">
         <label>30</label>
         <element-citation publication-type="journal" xlink:type="simple">
            <person-group person-group-type="author">
               <name name-style="western"><surname>Shatsky</surname><given-names>M</given-names></name>
               <name name-style="western"><surname>Nussinov</surname><given-names>R</given-names></name>
               <name name-style="western"><surname>Wolfson</surname><given-names>HJ</given-names></name>
            </person-group>
            <year>2004</year>
            <article-title>FlexProt: alignment of flexible protein structures without a predefinition of hinge regions.</article-title>
            <source>J Comput Biol</source>
            <volume>11</volume>
            <fpage>83</fpage>
            <lpage>106</lpage>
         </element-citation>
      </ref>
      <ref id="pcbi.1001075-Dror1">
         <label>31</label>
         <element-citation publication-type="journal" xlink:type="simple">
            <person-group person-group-type="author">
               <name name-style="western"><surname>Dror</surname><given-names>O</given-names></name>
               <name name-style="western"><surname>Benyamini</surname><given-names>H</given-names></name>
               <name name-style="western"><surname>Nussinov</surname><given-names>R</given-names></name>
               <name name-style="western"><surname>Wolfson</surname><given-names>HJ</given-names></name>
            </person-group>
            <year>2003</year>
            <article-title>Multiple structural alignment by secondary structures: algorithm and applications.</article-title>
            <source>Protein Sci</source>
            <volume>12</volume>
            <fpage>2492</fpage>
            <lpage>2507</lpage>
         </element-citation>
      </ref>
      <ref id="pcbi.1001075-Teichert1">
         <label>32</label>
         <element-citation publication-type="journal" xlink:type="simple">
            <person-group person-group-type="author">
               <name name-style="western"><surname>Teichert</surname><given-names>F</given-names></name>
               <name name-style="western"><surname>Bastolla</surname><given-names>U</given-names></name>
               <name name-style="western"><surname>Porto</surname><given-names>M</given-names></name>
            </person-group>
            <year>2007</year>
            <article-title>SABERTOOTH: protein structural alignment based on a vectorial structure representation.</article-title>
            <source>BMC Bioinformatics</source>
            <volume>8</volume>
            <fpage>425</fpage>
         </element-citation>
      </ref>
      <ref id="pcbi.1001075-Dundas1">
         <label>33</label>
         <element-citation publication-type="journal" xlink:type="simple">
            <person-group person-group-type="author">
               <name name-style="western"><surname>Dundas</surname><given-names>J</given-names></name>
               <name name-style="western"><surname>Binkowski</surname><given-names>TA</given-names></name>
               <name name-style="western"><surname>DasGupta</surname><given-names>B</given-names></name>
               <name name-style="western"><surname>Liang</surname><given-names>J</given-names></name>
            </person-group>
            <year>2007</year>
            <article-title>Topology independent protein structural alignment.</article-title>
            <source>BMC Bioinformatics</source>
            <volume>8</volume>
            <fpage>388</fpage>
         </element-citation>
      </ref>
      <ref id="pcbi.1001075-Theobald1">
         <label>34</label>
         <element-citation publication-type="journal" xlink:type="simple">
            <person-group person-group-type="author">
               <name name-style="western"><surname>Theobald</surname><given-names>DL</given-names></name>
               <name name-style="western"><surname>Wuttke</surname><given-names>DS</given-names></name>
            </person-group>
            <year>2006</year>
            <article-title>THESEUS: maximum likelihood superpositioning and analysis of macromolecular structures.</article-title>
            <source>Bioinformatics</source>
            <volume>22</volume>
            <fpage>2171</fpage>
            <lpage>2172</lpage>
         </element-citation>
      </ref>
      <ref id="pcbi.1001075-Du1">
         <label>35</label>
         <element-citation publication-type="journal" xlink:type="simple">
            <person-group person-group-type="author">
               <name name-style="western"><surname>Du</surname><given-names>QS</given-names></name>
               <name name-style="western"><surname>Jiang</surname><given-names>ZQ</given-names></name>
               <name name-style="western"><surname>He</surname><given-names>WZ</given-names></name>
               <name name-style="western"><surname>Li</surname><given-names>DP</given-names></name>
               <name name-style="western"><surname>Chou</surname><given-names>KC</given-names></name>
            </person-group>
            <year>2006</year>
            <article-title>Amino Acid Principal Component Analysis (AAPCA) and its applications in protein structural class prediction.</article-title>
            <source>J Biomol Struct Dyn</source>
            <volume>23</volume>
            <fpage>635</fpage>
            <lpage>640</lpage>
         </element-citation>
      </ref>
      <ref id="pcbi.1001075-Zhou1">
         <label>36</label>
         <element-citation publication-type="journal" xlink:type="simple">
            <person-group person-group-type="author">
               <name name-style="western"><surname>Zhou</surname><given-names>X</given-names></name>
               <name name-style="western"><surname>Chou</surname><given-names>J</given-names></name>
               <name name-style="western"><surname>Wong</surname><given-names>ST</given-names></name>
            </person-group>
            <year>2006</year>
            <article-title>Protein structure similarity from Principle Component Correlation analysis.</article-title>
            <source>BMC Bioinformatics</source>
            <volume>7</volume>
            <fpage>40</fpage>
         </element-citation>
      </ref>
      <ref id="pcbi.1001075-Kolodny2">
         <label>37</label>
         <element-citation publication-type="journal" xlink:type="simple">
            <person-group person-group-type="author">
               <name name-style="western"><surname>Kolodny</surname><given-names>R</given-names></name>
               <name name-style="western"><surname>Koehl</surname><given-names>P</given-names></name>
               <name name-style="western"><surname>Levitt</surname><given-names>M</given-names></name>
            </person-group>
            <year>2005</year>
            <article-title>Comprehensive evaluation of protein structure alignment methods: scoring by geometric measures.</article-title>
            <source>J Mol Biol</source>
            <volume>346</volume>
            <fpage>1173</fpage>
            <lpage>1188</lpage>
         </element-citation>
      </ref>
      <ref id="pcbi.1001075-Berbalk1">
         <label>38</label>
         <element-citation publication-type="journal" xlink:type="simple">
            <person-group person-group-type="author">
               <name name-style="western"><surname>Berbalk</surname><given-names>C</given-names></name>
               <name name-style="western"><surname>Schwaiger</surname><given-names>CS</given-names></name>
               <name name-style="western"><surname>Lackner</surname><given-names>P</given-names></name>
            </person-group>
            <year>2009</year>
            <article-title>Accuracy analysis of multiple structure alignments.</article-title>
            <source>Protein Sci</source>
            <volume>18</volume>
            <fpage>2027</fpage>
            <lpage>2035</lpage>
         </element-citation>
      </ref>
      <ref id="pcbi.1001075-Mayr1">
         <label>39</label>
         <element-citation publication-type="journal" xlink:type="simple">
            <person-group person-group-type="author">
               <name name-style="western"><surname>Mayr</surname><given-names>G</given-names></name>
               <name name-style="western"><surname>Domingues</surname><given-names>FS</given-names></name>
               <name name-style="western"><surname>Lackner</surname><given-names>P</given-names></name>
            </person-group>
            <year>2007</year>
            <article-title>Comparative analysis of protein structure alignments.</article-title>
            <source>BMC Struct Biol</source>
            <volume>7</volume>
            <fpage>50</fpage>
         </element-citation>
      </ref>
      <ref id="pcbi.1001075-Koehl1">
         <label>40</label>
         <element-citation publication-type="journal" xlink:type="simple">
            <person-group person-group-type="author">
               <name name-style="western"><surname>Koehl</surname><given-names>P</given-names></name>
            </person-group>
            <year>2001</year>
            <article-title>Protein structure similarities.</article-title>
            <source>Curr Opin Struct Biol</source>
            <volume>11</volume>
            <fpage>348</fpage>
            <lpage>353</lpage>
         </element-citation>
      </ref>
      <ref id="pcbi.1001075-Levitt1">
         <label>41</label>
         <element-citation publication-type="journal" xlink:type="simple">
            <person-group person-group-type="author">
               <name name-style="western"><surname>Levitt</surname><given-names>M</given-names></name>
               <name name-style="western"><surname>Gerstein</surname><given-names>M</given-names></name>
            </person-group>
            <year>1998</year>
            <article-title>A unified statistical framework for sequence comparison and structure comparison.</article-title>
            <source>Proc Natl Acad Sci U S A</source>
            <volume>95</volume>
            <fpage>5913</fpage>
            <lpage>5920</lpage>
         </element-citation>
      </ref>
      <ref id="pcbi.1001075-Joshi1">
         <label>42</label>
         <element-citation publication-type="other" xlink:type="simple">
            <person-group person-group-type="author">
               <name name-style="western"><surname>Joshi</surname><given-names>SH</given-names></name>
               <name name-style="western"><surname>Klassen</surname><given-names>E</given-names></name>
               <name name-style="western"><surname>Srivastava</surname><given-names>A</given-names></name>
               <name name-style="western"><surname>Jermyn</surname><given-names>IH</given-names></name>
            </person-group>
            <year>2007</year>
            <article-title>A novel representation for Riemannian analysis of elastic curves in R<sup>n</sup>.</article-title>
            <fpage>1</fpage>
            <lpage>7</lpage>
            <comment>In: IEEE Conference on Computer Vision and Pattern Recognition 07</comment>
         </element-citation>
      </ref>
      <ref id="pcbi.1001075-Klassen1">
         <label>43</label>
         <element-citation publication-type="journal" xlink:type="simple">
            <person-group person-group-type="author">
               <name name-style="western"><surname>Klassen</surname><given-names>E</given-names></name>
               <name name-style="western"><surname>Srivastava</surname><given-names>A</given-names></name>
               <name name-style="western"><surname>Mio</surname><given-names>W</given-names></name>
               <name name-style="western"><surname>Joshi</surname><given-names>SH</given-names></name>
            </person-group>
            <year>2004</year>
            <article-title>Analysis of planar shapes using geodesic paths on shape spaces.</article-title>
            <source>IEEE T Pattern Anal</source>
            <volume>26</volume>
            <fpage>372</fpage>
            <lpage>383</lpage>
         </element-citation>
      </ref>
      <ref id="pcbi.1001075-Mio1">
         <label>44</label>
         <element-citation publication-type="journal" xlink:type="simple">
            <person-group person-group-type="author">
               <name name-style="western"><surname>Mio</surname><given-names>W</given-names></name>
               <name name-style="western"><surname>Srivastava</surname><given-names>A</given-names></name>
               <name name-style="western"><surname>Joshi</surname><given-names>S</given-names></name>
            </person-group>
            <year>2007</year>
            <article-title>On Shape of Plane Elastic Curves.</article-title>
            <source>Int J Comput Vision</source>
            <volume>73</volume>
            <fpage>307</fpage>
            <lpage>324</lpage>
         </element-citation>
      </ref>
      <ref id="pcbi.1001075-Srivastava1">
         <label>45</label>
         <element-citation publication-type="journal" xlink:type="simple">
            <person-group person-group-type="author">
               <name name-style="western"><surname>Srivastava</surname><given-names>A</given-names></name>
               <name name-style="western"><surname>Klassen</surname><given-names>E</given-names></name>
               <name name-style="western"><surname>Joshi</surname><given-names>SH</given-names></name>
               <name name-style="western"><surname>Jermyn</surname><given-names>IH</given-names></name>
            </person-group>
            <year>2010</year>
            <article-title>Shape Analysis of Elastic Curves in Euclidean Spaces.</article-title>
            <source>IEEE T Pattern Anal.</source>
            <comment>In press</comment>
         </element-citation>
      </ref>
      <ref id="pcbi.1001075-Kurtek1">
         <label>46</label>
         <element-citation publication-type="other" xlink:type="simple">
            <person-group person-group-type="author">
               <name name-style="western"><surname>Kurtek</surname><given-names>S</given-names></name>
               <name name-style="western"><surname>Srivastava</surname><given-names>A</given-names></name>
               <name name-style="western"><surname>Klassen</surname><given-names>E</given-names></name>
               <name name-style="western"><surname>Ding</surname><given-names>Z</given-names></name>
            </person-group>
            <year>2010</year>
            <article-title>A novel Riemannian framework for shape analysis of anatomical structures.</article-title>
            <source>IEEE T MedImaging.</source>
            <comment>In press</comment>
         </element-citation>
      </ref>
      <ref id="pcbi.1001075-Huang1">
         <label>47</label>
         <element-citation publication-type="journal" xlink:type="simple">
            <person-group person-group-type="author">
               <name name-style="western"><surname>Huang</surname><given-names>YJ</given-names></name>
               <name name-style="western"><surname>Montelione</surname><given-names>GT</given-names></name>
            </person-group>
            <year>2005</year>
            <article-title>Structural biology: proteins flex to function.</article-title>
            <source>Nature</source>
            <volume>438</volume>
            <fpage>36</fpage>
            <lpage>37</lpage>
         </element-citation>
      </ref>
      <ref id="pcbi.1001075-Zhang2">
         <label>48</label>
         <element-citation publication-type="journal" xlink:type="simple">
            <person-group person-group-type="author">
               <name name-style="western"><surname>Zhang</surname><given-names>J</given-names></name>
               <name name-style="western"><surname>Liu</surname><given-names>JS</given-names></name>
            </person-group>
            <year>2006</year>
            <article-title>On side-chain conformational entropy of proteins.</article-title>
            <source>PLoS Comput Biol</source>
            <volume>2</volume>
            <fpage>e168</fpage>
         </element-citation>
      </ref>
      <ref id="pcbi.1001075-Furnham1">
         <label>49</label>
         <element-citation publication-type="journal" xlink:type="simple">
            <person-group person-group-type="author">
               <name name-style="western"><surname>Furnham</surname><given-names>N</given-names></name>
               <name name-style="western"><surname>Blundell</surname><given-names>TL</given-names></name>
               <name name-style="western"><surname>DePristo</surname><given-names>MA</given-names></name>
               <name name-style="western"><surname>Terwilliger</surname><given-names>TC</given-names></name>
            </person-group>
            <year>2006</year>
            <article-title>Is one solution good enough?</article-title>
            <source>Nat Struct Mol Biol</source>
            <volume>13</volume>
            <fpage>184</fpage>
            <lpage>185</lpage>
         </element-citation>
      </ref>
      <ref id="pcbi.1001075-Zhang3">
         <label>50</label>
         <element-citation publication-type="journal" xlink:type="simple">
            <person-group person-group-type="author">
               <name name-style="western"><surname>Zhang</surname><given-names>J</given-names></name>
               <name name-style="western"><surname>Lin</surname><given-names>M</given-names></name>
               <name name-style="western"><surname>Chen</surname><given-names>R</given-names></name>
               <name name-style="western"><surname>Liang</surname><given-names>J</given-names></name>
               <name name-style="western"><surname>Liu</surname><given-names>JS</given-names></name>
            </person-group>
            <year>2007</year>
            <article-title>Monte Carlo sampling of near-native structures of proteins with applications.</article-title>
            <source>Proteins</source>
            <volume>66</volume>
            <fpage>61</fpage>
            <lpage>68</lpage>
         </element-citation>
      </ref>
      <ref id="pcbi.1001075-Eddy1">
         <label>51</label>
         <element-citation publication-type="journal" xlink:type="simple">
            <person-group person-group-type="author">
               <name name-style="western"><surname>Eddy</surname><given-names>SR</given-names></name>
            </person-group>
            <year>1998</year>
            <article-title>Profile hidden Markov models.</article-title>
            <source>Bioinformatics</source>
            <volume>14</volume>
            <fpage>755</fpage>
            <lpage>763</lpage>
         </element-citation>
      </ref>
      <ref id="pcbi.1001075-Srivastava2">
         <label>52</label>
         <element-citation publication-type="journal" xlink:type="simple">
            <person-group person-group-type="author">
               <name name-style="western"><surname>Srivastava</surname><given-names>A</given-names></name>
               <name name-style="western"><surname>Jain</surname><given-names>A</given-names></name>
               <name name-style="western"><surname>Joshi</surname><given-names>S</given-names></name>
               <name name-style="western"><surname>Kaziska</surname><given-names>D</given-names></name>
            </person-group>
            <year>2006</year>
            <article-title>Statistical Shape Models Using Elastic-String Representations.</article-title>
            <source>Proceedings of Asian Conference on Computer Vision</source>
            <volume>6</volume>
            <fpage>612</fpage>
            <lpage>621</lpage>
         </element-citation>
      </ref>
   </ref-list>
   
</back></article>