<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id><journal-title-group>
<journal-title>PLoS Computational Biology</journal-title></journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-13-00336</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1003276</article-id>
<article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group></article-categories>
<title-group>
<article-title>Novel Methods for Analysing Bacterial Tracks Reveal Persistence in <italic>Rhodobacter sphaeroides</italic></article-title>
<alt-title alt-title-type="running-head">Novel Methods for Analysing Bacterial Tracks</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Rosser</surname><given-names>Gabriel</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Fletcher</surname><given-names>Alexander G.</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Wilkinson</surname><given-names>David A.</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>de Beyer</surname><given-names>Jennifer A.</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Yates</surname><given-names>Christian A.</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Armitage</surname><given-names>Judith P.</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Maini</surname><given-names>Philip K.</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Baker</surname><given-names>Ruth E.</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib>
</contrib-group>
<aff id="aff1"><label>1</label><addr-line>Wolfson Centre for Mathematical Biology, Mathematical Institute, University of Oxford, Radcliffe Observatory Quarter, Oxford, United Kingdom</addr-line></aff>
<aff id="aff2"><label>2</label><addr-line>Oxford Centre for Integrative Systems Biology and Department of Biochemistry, University of Oxford, Oxford, United Kingdom</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Coombs</surname><given-names>Daniel</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group>
<aff id="edit1"><addr-line>University of British Columbia, Canada</addr-line></aff>
<author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">alexander.fletcher@maths.ox.ac.uk</email></corresp>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn>
<fn fn-type="con"><p>Conceived and designed the experiments: GR DAW. Performed the experiments: DAW JAdB. Analyzed the data: GR CAY. Contributed reagents/materials/analysis tools: JPA PKM. Wrote the paper: GR. Proposed and developed the analysis methods: GR AGF REB. Conceived and performed the simulation study: GR.</p></fn>
</author-notes>
<pub-date pub-type="collection"><month>10</month><year>2013</year></pub-date>
<pub-date pub-type="epub"><day>24</day><month>10</month><year>2013</year></pub-date>
<volume>9</volume>
<issue>10</issue>
<elocation-id>e1003276</elocation-id>
<history>
<date date-type="received"><day>25</day><month>2</month><year>2013</year></date>
<date date-type="accepted"><day>20</day><month>8</month><year>2013</year></date>
</history>
<permissions>
<copyright-year>2013</copyright-year>
<copyright-holder>Rosser et al</copyright-holder><license xlink:type="simple"><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions>
<related-article id="RA1" related-article-type="companion" ext-link-type="uri" vol="" page="e1002972" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pcbi.1002972"><article-title>New Methods Section in <italic>PLOS Computational Biology</italic></article-title></related-article>
<abstract>
<p>Tracking bacteria using video microscopy is a powerful experimental approach to probe their motile behaviour. The trajectories obtained contain much information relating to the complex patterns of bacterial motility. However, methods for the quantitative analysis of such data are limited. Most swimming bacteria move in approximately straight lines, interspersed with random reorientation phases. It is therefore necessary to segment observed tracks into swimming and reorientation phases to extract useful statistics. We present novel robust analysis tools to discern these two phases in tracks. Our methods comprise a simple and effective protocol for removing spurious tracks from tracking datasets, followed by analysis based on a two-state hidden Markov model, taking advantage of the availability of mutant strains that exhibit swimming-only or reorientating-only motion to generate an empirical prior distribution. Using simulated tracks with varying levels of added noise, we validate our methods and compare them with an existing heuristic method. To our knowledge this is the first example of a systematic assessment of analysis methods in this field. The new methods are substantially more robust to noise and introduce less systematic bias than the heuristic method. We apply our methods to tracks obtained from the bacterial species <italic>Rhodobacter sphaeroides</italic> and <italic>Escherichia coli</italic>. Our results demonstrate that <italic>R. sphaeroides</italic> exhibits persistence over the course of a tumbling event, which is a novel result with important implications in the study of this and similar species.</p>
</abstract>
<abstract abstract-type="summary"><title>Author Summary</title>
<p>Many species of planktonic bacteria are able to propel themselves through a liquid medium by the use of one or more helical flagella. Commonly, the observed motile behaviour consists of a series of approximately straight-line movements, interspersed with random, approximately stationary, reorientation events. This phenomenon is of current interest as it is known to be linked to important bacterial processes such as pathogenicity and biofilm formation. An accepted experimental approach for studying bacterial motility in approximately indigenous conditions is the tracking of cells using a microscope. However, there are currently no validated methods for the analysis of such tracking data. In particular, the identification of reorientation phases, which is complicated by various sources of noise in the data, remains an open challenge. In this paper we present novel methods for analysing large bacterial tracking datasets. We assess the performance of our new methods using computational simulations, and show that they are more reliable than a previously published method. We proceed to analyse previously unpublished tracks from the bacterial species <italic>Rhodobacter sphaeroides</italic>, an emerging model organism in the field of bacterial motility, and <italic>Escherichia coli</italic>, a well-studied model bacterium. The analysis demonstrates the novel result that <italic>R. sphaeroides</italic> exhibits directional persistence over the course of a reorientation event.</p>
</abstract>
<funding-group><funding-statement>GR is supported by an EPSRC-funded Life Sciences Interface Doctoral Training Centre Studentship (EP/E501605/1). AGF is funded by EPSRC (EP/I017909/1) and Microsoft Research Cambridge. DAW and AGF acknowledge the support of the OCISB project (BB/D020190/1). CAY would like to thank Christ Church College, University of Oxford for support through a Junior Research Fellowship. JPA is funded by BBSRC. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="18"/></counts></article-meta>
</front>
<body><sec id="s1">
<title/>
<disp-quote>
<p><bold>This is a </bold><bold><italic>PLOS Computational Biology</italic></bold><bold> Methods article.</bold></p>
</disp-quote></sec><sec id="s2">
<title>Introduction</title>
<p>The motile behaviour of bacteria underlies many important aspects of their actions, including pathogenicity, foraging efficiency, and ability to form biofilms. The study of this phenomenon is therefore of biomedical and industrial importance, with implications in the control of disease <xref ref-type="bibr" rid="pcbi.1003276-Jefferson1">[1]</xref> and biofouling <xref ref-type="bibr" rid="pcbi.1003276-Drr1">[2]</xref>. Owing to their small size, bacteria inhabit a world of low Reynolds number, in which viscous forces dominate over inertia <xref ref-type="bibr" rid="pcbi.1003276-Purcell1">[3]</xref>. Rotational Brownian motion prevents them from swimming continuously in a straight line, hence many motile species such as the multiflagellate <italic>Escherichia coli</italic> move in a series of approximately straight ‘runs’, interspersed by reorientating ‘tumbles’ in a process known as taxis <xref ref-type="bibr" rid="pcbi.1003276-Berg1">[4]</xref>. During a run, the flagellar motors in <italic>E. coli</italic> turn counter-clockwise, causing the helical flagella to form a rotating bundle that propels the cell forward. Tumbles are caused when one or more motors reverse their rotation, which disrupts the flagellar bundle and causes the cell to reorient randomly <xref ref-type="bibr" rid="pcbi.1003276-Berg1">[4]</xref>. A related motile mechanism exists in the uniflagellate bacterium <italic>Rhodobacter sphaeroides</italic>, in which reorientations are, instead, effected by stopping the flagellar motor <xref ref-type="bibr" rid="pcbi.1003276-Pilizota1">[5]</xref>. Upon ceasing to rotate, the single sub-polar flagellum <xref ref-type="bibr" rid="pcbi.1003276-Haya1">[6]</xref> undergoes a change of conformation, leading to reorientation by a mechanism that is not yet well understood <xref ref-type="bibr" rid="pcbi.1003276-Armitage1">[7]</xref>. The biochemical pathways responsible for chemotaxis in <italic>R. sphaeroides</italic> are less well studied than those in <italic>E. coli</italic>, and are known to be more complex <xref ref-type="bibr" rid="pcbi.1003276-Porter1">[8]</xref>.</p>
<p>The tracking of bacterial cells, as imaged under a microscope, is a well-established experimental technique for investigating bacterial motility. Such studies have been used to gain biological insight in the case of <italic>E. coli</italic> <xref ref-type="bibr" rid="pcbi.1003276-Berg1">[4]</xref>, <xref ref-type="bibr" rid="pcbi.1003276-Sager1">[9]</xref>, <italic>Pseudomonas putida</italic> <xref ref-type="bibr" rid="pcbi.1003276-Duffy1">[10]</xref>, <italic>Rhizobium meliloti</italic> <xref ref-type="bibr" rid="pcbi.1003276-Attmannspacher1">[11]</xref>, <italic>Vibrio alginolyticus</italic> <xref ref-type="bibr" rid="pcbi.1003276-Xie1">[12]</xref> and <italic>R. sphaeroides</italic> <xref ref-type="bibr" rid="pcbi.1003276-Poole1">[13]</xref>. A limitation of cell tracking is that a large number of tracks are required in order to ensure that any inferences drawn from observations are statistically representative of the population. Tracking experiments are therefore often laborious <xref ref-type="bibr" rid="pcbi.1003276-Hder1">[14]</xref>. Earlier experiments involved tracking a single bacterium at a time, either in a fixed field of view <xref ref-type="bibr" rid="pcbi.1003276-Poole1">[13]</xref>, or by mechanically shifting the microscope stage to keep the cell in focus <xref ref-type="bibr" rid="pcbi.1003276-Berg1">[4]</xref>. This approach suffers from subjective bias as the experimentalist is required to select which cells to track <xref ref-type="bibr" rid="pcbi.1003276-Hder1">[14]</xref>. More recently, simultaneous multiple target tracking has enabled the measurement of tracks from all bacteria visible in the field of view at any given time <xref ref-type="bibr" rid="pcbi.1003276-Xie2">[15]</xref>. This improves the efficiency of the experimental technique, allowing larger datasets to be obtained. It also reduces sampling bias, as all cells in the field of view are tracked. An experimental method related to tracking is differential dynamic microscopy (DDM), which enables the measurement of the distribution of swimming speeds and the fraction of motile cells in the observed population <xref ref-type="bibr" rid="pcbi.1003276-Martinez1">[16]</xref>. DDM records these statistics across very many bacteria, however it is an ensemble method and does not permit the measurement of the motile properties of individual bacteria.</p>
<p>Having acquired experimental tracking data, these must be analysed in order to extract quantities of interest. These include the distribution of swimming speeds <xref ref-type="bibr" rid="pcbi.1003276-Sager1">[9]</xref>, <xref ref-type="bibr" rid="pcbi.1003276-Poole1">[13]</xref>, <xref ref-type="bibr" rid="pcbi.1003276-Martinez1">[16]</xref>–<xref ref-type="bibr" rid="pcbi.1003276-Alon1">[18]</xref>, various measures of trajectory curvature <xref ref-type="bibr" rid="pcbi.1003276-Lauga1">[19]</xref>, <xref ref-type="bibr" rid="pcbi.1003276-Lemelle1">[20]</xref>, turning angles <xref ref-type="bibr" rid="pcbi.1003276-Berg1">[4]</xref>, <xref ref-type="bibr" rid="pcbi.1003276-Duffy1">[10]</xref>, the frequency of reorientations <xref ref-type="bibr" rid="pcbi.1003276-Alon1">[18]</xref>, <xref ref-type="bibr" rid="pcbi.1003276-Amsler1">[21]</xref>, <xref ref-type="bibr" rid="pcbi.1003276-Barbara1">[22]</xref> and the extent of accumulation near a surface <xref ref-type="bibr" rid="pcbi.1003276-Li1">[23]</xref>. The ability to obtain such statistics permits quantitative investigations into the response of bacterial populations to environmental stimuli, in addition to cross-species comparisons and the true variability across a population. The analysis method used to extract statistics of motion from the raw data must be robust to errors in the tracking protocol, for example when cell trajectories intersect and the wrong paths are joined <xref ref-type="bibr" rid="pcbi.1003276-Berg1">[4]</xref>, and experimental noise such as errors in finding the centre of a cell. In order to identify reorientation events in bacterial tracks, both manual analysis <xref ref-type="bibr" rid="pcbi.1003276-Sager1">[9]</xref>, <xref ref-type="bibr" rid="pcbi.1003276-Barbara1">[22]</xref>, <xref ref-type="bibr" rid="pcbi.1003276-Khan1">[24]</xref> and heuristic arguments <xref ref-type="bibr" rid="pcbi.1003276-Berg1">[4]</xref>, <xref ref-type="bibr" rid="pcbi.1003276-Duffy1">[10]</xref>, <xref ref-type="bibr" rid="pcbi.1003276-Alon1">[18]</xref>, <xref ref-type="bibr" rid="pcbi.1003276-Amsler1">[21]</xref>, <xref ref-type="bibr" rid="pcbi.1003276-Taboada1">[25]</xref>, <xref ref-type="bibr" rid="pcbi.1003276-Masson1">[26]</xref> have been used. The former is prohibitively time-consuming when dealing with large datasets and is subjective. Automated heuristic methods may be effective in some cases, however it is important to validate such methods, and to avoid the introduction of systematic bias. To our knowledge, all existing heuristic methods require one or more threshold parameters to be specified. The process of selecting optimal threshold parameters may be automatable, as is the case with the method we use for comparison in our study, however this is not a straightforward task and in most cases no guidelines are given as to how to select optimal values for threshold quantities. For example, the method used by Amsler <xref ref-type="bibr" rid="pcbi.1003276-Amsler1">[21]</xref> requires the user to specify a threshold inter-frame angular velocity, above which the bacterium is said to be in a reorientation phase. Furthermore, of all the cited studies, only that of Alon et al. <xref ref-type="bibr" rid="pcbi.1003276-Alon1">[18]</xref> includes an analysis of the sensitivity of the results to the various threshold parameters.</p>
<p>Here, we present novel methods for the automated, non-parametric analysis of large bacterial tracking datasets, based on a two-state model of the observed motion, which is compatible with any form of motile behaviour that is well-approximated by the run-and-stop or run-and-tumble models of motion. The data considered in this study are two-dimensional tracks, but the extension of the methods to three dimensions is straightforward. Our methods take advantage of the availability of non-chemotactic and non-motile mutants to gain empirical knowledge of the appearance of running and stopping phases in the observed motion. The methods are based on a modification to the hidden Markov model (HMM), and are applicable to any bacterial species where such mutants exist and sufficiently long reorientation events are discernible using video microscopy. In addition, we suggest a straightforward method that is applicable in the absence of a non-motile mutant. We use a simulation study to assess the performance of the new methods, and compare them with a heuristic approach. To our knowledge such a systematic comparison of methods has not previously been attempted in this field. In order to demonstrate the wide application of our methods, we apply them to analyse novel <italic>R. sphaeroides</italic> and <italic>E. coli</italic> datasets, acquired using a recently developed tracking protocol <xref ref-type="bibr" rid="pcbi.1003276-Wood1">[27]</xref>. We show how our new methods enable us to determine the previously unreported distribution of angle changes during a reorientation in <italic>R. sphaeroides</italic>, amongst other characteristics of the observed motion.</p>
</sec><sec id="s3">
<title>Results</title>
<p>Bacterial tracks of <italic>R. sphaeroides</italic> and <italic>E. coli</italic> were acquired as detailed in Materials and Methods. <xref ref-type="fig" rid="pcbi-1003276-g001">Figure 1</xref> shows a cartoon illustration of a single track. A bacterium swims in an approximately straight line, enters an approximately stationary stopped phase for some time, then swims off in a new direction. The crosses indicate observations made of the cell centroid at regular intervals, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e001" xlink:type="simple"/></inline-formula> (videos are typically captured at 50 frames per second). The primary focus of this study is the identification of stops as illustrated in <xref ref-type="fig" rid="pcbi-1003276-g001">Figure 1</xref>. This task is complicated by various sources of noise in the data. These include: (i) uncertainty in the position of the centroid of a cell in each image that may cause a track to appear jagged, for example when the cell body rotates whilst swimming; (ii) Brownian buffeting that may also cause departures from straight-line swimming, and lead to stops that are not perfectly stationary; (iii) tracking errors caused by incorrectly linking cells between consecutive frames, or by the disappearance of a cell for one or more frames, that may affect the appearance of a track. The identification of stopping phases in tracks is therefore a challenging process.</p>
<fig id="pcbi-1003276-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003276.g001</object-id><label>Figure 1</label><caption>
<title>Data representation in a track.</title>
<p>The thin black line represents the continuous trajectory of a cell. Crosses and circles denote running and stopping phases, respectively, and represent locations at which the position of the cell is recorded, separated by a constant time interval <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e002" xlink:type="simple"/></inline-formula>. Dashed black lines and notation illustrate the mathematical representation of the track.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003276.g001" position="float" xlink:type="simple"/></fig>
<p>Each track generated by the tracking procedure is represented in the form <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e003" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e004" xlink:type="simple"/></inline-formula> designates a two-dimensional position vector at time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e005" xlink:type="simple"/></inline-formula>, and the number of frames in the track is given by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e006" xlink:type="simple"/></inline-formula>. Note that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e007" xlink:type="simple"/></inline-formula> is considered a discrete quantity throughout, as time is measured in numbers of frames. In characterising running and stopping phases, we are concerned not with the positions of cells in each frame, but with the motion of cells between consecutive frames. The information of interest is thus the transitions between consecutive position vectors within a track. These form a list of displacement vectors, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e008" xlink:type="simple"/></inline-formula> with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e009" xlink:type="simple"/></inline-formula>. The framewise speed is defined as the observed speed of travel between two consecutive frames, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e010" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e011" xlink:type="simple"/></inline-formula> denotes the Euclidean norm. The angle changes <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e012" xlink:type="simple"/></inline-formula> between consecutive vectors, henceforth called framewise angle changes, are defined so that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e013" xlink:type="simple"/></inline-formula> gives the difference in polar angle between <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e014" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e015" xlink:type="simple"/></inline-formula>.</p>
<p>We assume a two-state model of cell motility, in which each displacement vector, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e016" xlink:type="simple"/></inline-formula>, corresponds to either a running or stopping state. The underlying state at time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e017" xlink:type="simple"/></inline-formula> is denoted <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e018" xlink:type="simple"/></inline-formula>, where we use the convention throughout that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e019" xlink:type="simple"/></inline-formula> corresponds to a stop and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e020" xlink:type="simple"/></inline-formula> corresponds to a run, hence for each track a state vector <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e021" xlink:type="simple"/></inline-formula> describes the sequence of states. We wish to assign to each displacement vector a probability of being in a running phase, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e022" xlink:type="simple"/></inline-formula>. Note that, since we assume a two-state model, we have <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e023" xlink:type="simple"/></inline-formula>.</p>
<p>We use our methods to analyse tracking data from <italic>R. sphaeroides</italic> and <italic>E. coli</italic>. In each case, data are obtained from three strains: a wildtype strain, which undergoes discrete running and reorientation phases, a non-chemotactic strain, which is always in the running phase and exhibits no reorientation events, and a non-motile strain, which is unable to propel itself.</p>
<sec id="s3a">
<title>Analysis methods</title>
<p>There is no well-established gold standard for identifying reorientation events in bacterial tracks; indeed several tracking studies make no attempt to extract quantitative information about the reorientation events in tracks <xref ref-type="bibr" rid="pcbi.1003276-Xie2">[15]</xref>, <xref ref-type="bibr" rid="pcbi.1003276-Thar1">[28]</xref>, <xref ref-type="bibr" rid="pcbi.1003276-Wu1">[29]</xref>, while others use ensemble measures such as angular velocity as a proxy for the rate of reorientation <xref ref-type="bibr" rid="pcbi.1003276-Khan1">[24]</xref>, <xref ref-type="bibr" rid="pcbi.1003276-Tisa1">[30]</xref>. Various heuristic methods requiring the specification of one or more threshold parameters have been used in tracking studies in bacteria (see the related discussion in Introduction). In this study we compare our methods with that of Taboada et al. <xref ref-type="bibr" rid="pcbi.1003276-Taboada1">[25]</xref>, which is sufficiently versatile to apply to our current data with little modification. This is henceforth denoted the heuristic method. The focus of the present work is the development and validation of our novel analysis methods, however we note that several other heuristic methods mentioned above may be applicable providing it is possible to automatically optimise the various threshold parameters involved. We do not consider these further as a complete survey of methods is beyond the scope of this paper.</p>
<p>We now describe the heuristic method and the two novel analysis methods considered throughout the rest of this work. In addition, we describe a ‘post-processing’ heuristic that can improve the performance of all of the methods and is particularly effective when combined with the heuristic method.</p>
<sec id="s3a1">
<title>Heuristic method</title>
<p>The intuitive approach used by Taboada et al. <xref ref-type="bibr" rid="pcbi.1003276-Taboada1">[25]</xref> is to define a cutoff speed parameter <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e024" xlink:type="simple"/></inline-formula> and denote each transition as a run if the framewise speed is greater than <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e025" xlink:type="simple"/></inline-formula>, so that<disp-formula id="pcbi.1003276.e026"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003276.e026" xlink:type="simple"/><label>(1)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e027" xlink:type="simple"/></inline-formula> denotes the Heaviside function. The key assumption underlying the heuristic method is that there is a substantial difference between the distribution of framewise speeds observed during runs and stops. The value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e028" xlink:type="simple"/></inline-formula> should be selected to maximise the number of correctly inferred transitions. We approach the problem of optimising <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e029" xlink:type="simple"/></inline-formula> by computing the observed framewise speeds for the non-chemotactic and non-motile strains. We estimate the true probability density function (pdf) of framewise speeds in each case using a kernel density estimate (KDE). We then take <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e030" xlink:type="simple"/></inline-formula> to be the point at which the two pdfs intersect. Note that this method is not guaranteed to minimise the crossover region between the two pdfs, but is a reasonable approximation. The implementation of the KDE by Botev et al. <xref ref-type="bibr" rid="pcbi.1003276-Botev1">[31]</xref> used in this study represents a non-parametric method for determining the kernel bandwidth, thus avoiding the need to select an arbitrary histogram bin width.</p>
<p>A problem associated with the heuristic method lies in the choice of the parameter <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e031" xlink:type="simple"/></inline-formula>. If there is any overlap between the framewise speed distribution for run phases and stop phases, due to the effects of noise and/or population heterogeneity, then this approach will cause spurious inference in the crossover region. Nevertheless, this approach is acceptable if the level of noise in the data is such that the distributions are well separated.</p>
</sec><sec id="s3a2">
<title>Hidden Markov model (HMM) methods</title>
<p>Our novel approach to the analysis of bacterial tracks utilises a state space model with an empirical prior to infer the state probabilities. We apply a HMM to the observed data. For brevity, we assume familiarity with the basic HMM; a detailed tutorial is given by Rabiner <xref ref-type="bibr" rid="pcbi.1003276-Rabiner1">[32]</xref>. Details of the numerical implementation of the HMM are given by Press et al. <xref ref-type="bibr" rid="pcbi.1003276-Press1">[33]</xref>; the notation used here is the same as in this reference. Methods based on the HMM have previously been successfully applied to data from DNA looping and single particle tracking experiments <xref ref-type="bibr" rid="pcbi.1003276-Beausang1">[34]</xref>, <xref ref-type="bibr" rid="pcbi.1003276-Das1">[35]</xref>. The application of the HMM to the analysis of bacterial tracks requires a modification to the standard HMM formulation, similar to those described by Beausang and Nelson <xref ref-type="bibr" rid="pcbi.1003276-Beausang1">[34]</xref> in their study of DNA looping dynamics.</p>
<p>We assume that the observed motion between sampling points in each track arises from a hidden two-state Markov chain, where the states correspond to running and stopping phases. We denote the transition matrix by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e032" xlink:type="simple"/></inline-formula>, with entries <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e033" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e034" xlink:type="simple"/></inline-formula> as previously discussed. In the absence of any chemoattractant or chemorepellent concentration gradient, we assume that the Markov chain is homogeneous, meaning that the probability of switching from a run to a stop (or <italic>vice versa</italic>) is independent of time and space. The initial state probabilities are denoted by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e035" xlink:type="simple"/></inline-formula>. The continuous observation pdf is denoted by<disp-formula id="pcbi.1003276.e036"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003276.e036" xlink:type="simple"/><label>(2)</label></disp-formula>which gives the pdf of observing the datum <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e037" xlink:type="simple"/></inline-formula> at time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e038" xlink:type="simple"/></inline-formula>, conditional on the system being in state <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e039" xlink:type="simple"/></inline-formula>. The observation pdf gives the prior probability density of observing a particular movement, conditional on the cell's state. It is obtained empirically from novel experimental data of non-motile and non-chemotactic strains. Full details on the form of the observation pdf are given below.</p>
<p>Implementation of the HMM requires the computation of two quantities, the forward and backward estimates. These are defined by<disp-formula id="pcbi.1003276.e040"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003276.e040" xlink:type="simple"/><label>(3)</label></disp-formula>and<disp-formula id="pcbi.1003276.e041"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003276.e041" xlink:type="simple"/><label>(4)</label></disp-formula>respectively for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e042" xlink:type="simple"/></inline-formula>. Note that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e043" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e044" xlink:type="simple"/></inline-formula> by convention. These two quantities may be used to define the probability of the state at time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e045" xlink:type="simple"/></inline-formula> being a run:<disp-formula id="pcbi.1003276.e046"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003276.e046" xlink:type="simple"/><label>(5)</label></disp-formula>We consider two variants of the HMM-based analysis approach, which differ in the way in which the observed data <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e047" xlink:type="simple"/></inline-formula> are represented. We first describe the full HMM method, in which both framewise speeds and angle changes are considered. We then describe a simplified variant, in which only speed data are used.</p>
<p>The full HMM approach uses both the framewise speed and the framewise angle as the observable data, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e048" xlink:type="simple"/></inline-formula>. Since we determine the observation pdf empirically, the only free parameters in the model are the state transition probabilities <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e049" xlink:type="simple"/></inline-formula>. We assume that switching from state <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e050" xlink:type="simple"/></inline-formula> to state <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e051" xlink:type="simple"/></inline-formula> occurs with a characteristic time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e052" xlink:type="simple"/></inline-formula>. The transition matrix is therefore given by<disp-formula id="pcbi.1003276.e053"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003276.e053" xlink:type="simple"/><label>(6)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e054" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e055" xlink:type="simple"/></inline-formula>, which are interpreted as the probability of stop-to-run and run-to-stop transitions, respectively. In order to ensure that both of these quantities are in the range <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e056" xlink:type="simple"/></inline-formula>, the camera frame rate must be set sufficiently high, so that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e057" xlink:type="simple"/></inline-formula>.</p>
<p>The observation pdf encodes our prior knowledge of the distribution of framewise speeds in the running and stopping states. We assume that the non-chemotactic mutant swims in the same way as a wildtype bacterium in a running phase, and that the motion of the non-motile mutant is similar to that of a wildtype bacterium in a stopping phase. Experimental justification of this assumption is given in <italic>Analysis of experimental data</italic>. The standard HMM formulation requires that the observation pdf is independent of all previous states: the single subscript in the observation pdf, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e058" xlink:type="simple"/></inline-formula>, refers to the current state. In order to incorporate angular information in our analysis, we must relax this requirement, so that the observation pdf may depend on both the current state and preceding states <xref ref-type="bibr" rid="pcbi.1003276-Beausang1">[34]</xref>. This modification is necessary because tracking cell movements is less accurate when the cell is in a stopped phase than when the cell is running, due to the smaller motions involved. As a result, the computed framewise angle changes contain a significant source of error. During a stop-to-run transition, the framewise angle change observed may differ a great deal from that predicted based on the previous, noisy observed direction of motion during the stop. Use of the standard HMM formulation could then lead to the stop-to-run transition being incorrectly classified as a stop-to-stop transition on the basis of an apparently large framewise angle change. We therefore define a modified observation pdf to account for this source of error, in which there is a dependence on the previous state, in addition to the current state, given by<disp-formula id="pcbi.1003276.e059"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003276.e059" xlink:type="simple"/><label>(7)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e060" xlink:type="simple"/></inline-formula>. The modified observation pdf <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e061" xlink:type="simple"/></inline-formula> does not break the Markov property of the process, since the dependence is limited to the current and previous states. Instead, using <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e062" xlink:type="simple"/></inline-formula> allows us to take experimental technicalities into account. For a further example of such a modification, see the study by Beausang and Nelson <xref ref-type="bibr" rid="pcbi.1003276-Beausang1">[34]</xref>. No modification is required to the transition matrix.</p>
<p>Including this modification in the conventional HMM formulation, <xref ref-type="disp-formula" rid="pcbi.1003276.e040">equation (3)</xref> becomes<disp-formula id="pcbi.1003276.e063"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003276.e063" xlink:type="simple"/><label>(8)</label></disp-formula>and the analogous expression for <xref ref-type="disp-formula" rid="pcbi.1003276.e041">equation (4)</xref> is given by<disp-formula id="pcbi.1003276.e064"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003276.e064" xlink:type="simple"/><label>(9)</label></disp-formula>We assume independence of speed and angular distributions so that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e065" xlink:type="simple"/></inline-formula> is separable,<disp-formula id="pcbi.1003276.e066"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003276.e066" xlink:type="simple"/><label>(10)</label></disp-formula>This simplifying assumption is necessary as we do not have sufficient data in the present study to estimate a joint distribution accurately. This may be possible in future studies; the modification of the current methods to use such a distribution is straightforward. Plots showing the form of the noisy joint distributions are provided in <xref ref-type="supplementary-material" rid="pcbi.1003276.s001">Figures S1</xref>, <xref ref-type="supplementary-material" rid="pcbi.1003276.s002">S2</xref>, <xref ref-type="supplementary-material" rid="pcbi.1003276.s003">S3</xref>, <xref ref-type="supplementary-material" rid="pcbi.1003276.s004">S4</xref> for reference. In <xref ref-type="disp-formula" rid="pcbi.1003276.e066">equation (10)</xref> the speed component, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e067" xlink:type="simple"/></inline-formula>, is independent of the previous state whereas the angular component, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e068" xlink:type="simple"/></inline-formula>, is not. Estimates for these components are obtained from experimental data acquired from mutant strains. The speed component is equal to the KDE of observed framewise speeds in the non-motile mutant when <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e069" xlink:type="simple"/></inline-formula> and the non-chemotactic mutant when <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e070" xlink:type="simple"/></inline-formula>. The angular component is equal to the KDE of observed framewise angle changes in the non-motile mutant when <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e071" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e072" xlink:type="simple"/></inline-formula>, or <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e073" xlink:type="simple"/></inline-formula>, and the non-chemotactic mutant when <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e074" xlink:type="simple"/></inline-formula>. Note that the modification is required to take into account the use of the non-motile distribution for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e075" xlink:type="simple"/></inline-formula>, as discussed above.</p>
<p>In order to implement the algorithm described above, one final detail is required. There is no guarantee that the empirical estimate for the speed component of the observation pdf is non-zero for all observed framewise speeds in the wildtype dataset, since those tracks are effectively hidden when we generate the empirical priors. It is important to avoid a situation in which the observation pdf is numerically equivalent to zero, which occurs when <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e076" xlink:type="simple"/></inline-formula>, since this causes the algorithm to fail by declaring that the track is in neither the running nor the stopping state, hence breaking the two-state assumption. This could occur if tracks in the wildtype dataset contain some high framewise speeds, relative to the non-chemotactic dataset. Such an eventuality is avoided by adding a small numerical constant to the speed component to ensure it is non-zero for all permissible speeds (see Materials and Methods for an explanation of why there is an upper bound to the permissible framewise speeds).</p>
<p>In the speed-only model, we consider only the framewise speed as the observable data. This is achieved by a straightforward modification to the full model, in which we impose the circular uniform distribution on the angular component of the observation pdf, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e077" xlink:type="simple"/></inline-formula>.</p>
<p>The two components describing the HMM are the observation pdf, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e078" xlink:type="simple"/></inline-formula>, and the transition probabilities, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e079" xlink:type="simple"/></inline-formula>. The observation pdf is independently determined from observations of non-chemotactic and non-motile strains, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e080" xlink:type="simple"/></inline-formula> is specified by the two parameters in <xref ref-type="disp-formula" rid="pcbi.1003276.e053">equation (6)</xref>, namely <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e081" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e082" xlink:type="simple"/></inline-formula>. It is possible to obtain a maximum likelihood estimate (MLE) <xref ref-type="bibr" rid="pcbi.1003276-Press1">[33]</xref> of these free parameters by maximising the likelihood of the data given the model, defined by<disp-formula id="pcbi.1003276.e083"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003276.e083" xlink:type="simple"/><label>(11)</label></disp-formula>We may use the MLE to estimate the dwell times, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e084" xlink:type="simple"/></inline-formula>, providing that the limitation <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e085" xlink:type="simple"/></inline-formula> is respected. Das et al. use a Markov chain Monte Carlo scheme to find the MLE of their rate parameters in a similar application to that described here <xref ref-type="bibr" rid="pcbi.1003276-Das1">[35]</xref>. In our case, the negative log-likelihood surface is always found to be smooth, with a unique minimum (data not shown), so that a deterministic optimisation routine is more computationally efficient. We use a MATLAB implementation of the trust-region-reflective algorithm to carry out a constrained numerical optimisation of the negative log-likelihood <xref ref-type="bibr" rid="pcbi.1003276-Conn1">[36]</xref>. The function to be minimised is defined by<disp-formula id="pcbi.1003276.e086"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003276.e086" xlink:type="simple"/><label>(12)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e087" xlink:type="simple"/></inline-formula> denotes the likelihood of the data from the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e088" xlink:type="simple"/></inline-formula> track, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e089" xlink:type="simple"/></inline-formula> is the total number of tracks in the dataset. As the likelihood is a function of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e090" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e091" xlink:type="simple"/></inline-formula>, the minimisation is carried out over a two-dimensional vector space. We estimate 95% two-tailed confidence intervals for our MLE of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e092" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e093" xlink:type="simple"/></inline-formula> using the basic bootstrap method <xref ref-type="bibr" rid="pcbi.1003276-Carpenter1">[37]</xref>, with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e094" xlink:type="simple"/></inline-formula> bootstrap iterations. The summation in <xref ref-type="disp-formula" rid="pcbi.1003276.e086">equation (12)</xref> pools the results from all of the tracks in the censored dataset, so that the MLE is an ensemble quantity. It is possible, in principle, to maximise the likelihood over each individual track, however the performance of this approach is poor when dealing with short tracks (data not shown). The optimised parameters are subsequently used to compute the run probabilities using <xref ref-type="disp-formula" rid="pcbi.1003276.e040">equations (3)</xref>–<xref ref-type="disp-formula" rid="pcbi.1003276.e046">(5)</xref>. We summarise the analysis pipeline in <xref ref-type="fig" rid="pcbi-1003276-g002">Figure 2</xref>.</p>
<fig id="pcbi-1003276-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003276.g002</object-id><label>Figure 2</label><caption>
<title>Flow diagram of the stages involved in analysing the experimental tracking data.</title>
<p>White boxes represent the raw datasets. The non-chemotactic and wildtype data are first censored to remove spurious tracks, as described in Materials and Methods. The two mutant strains are then used to generate an empirical prior, in the form of the observation functions. The empirical prior is used when analysing the wildtype dataset, in order to find the MLE of the transition probabilities and finally segment the track into discrete states by computing the state sequence, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e095" xlink:type="simple"/></inline-formula>.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003276.g002" position="float" xlink:type="simple"/></fig></sec><sec id="s3a3">
<title>Post-processing</title>
<p>Each of the analysis methods returns a vector for each track, containing the probability of a run between each observation point, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e096" xlink:type="simple"/></inline-formula>. In the case of the heuristic method, every value is equal to 1 or 0, whereas the HMM methods return values in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e097" xlink:type="simple"/></inline-formula>. In the latter case, we round all values to the nearest integer (0 or 1). The resulting vector can be considered to represent the run status (as opposed to run probability). This transformation is always carried out on the run probabilities computed using the HMM-based methods. In the case of the heuristic method, there is no distinction between the two properties. The difference between run probability and run status is illustrated in <xref ref-type="fig" rid="pcbi-1003276-g003">Figure 3</xref>.</p>
<fig id="pcbi-1003276-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003276.g003</object-id><label>Figure 3</label><caption>
<title>An illustration of the output of the analysis methods, post-processing and comparison with the true underlying state for a simulated track.</title>
<p>The upper panel shows the simulated track; the black circle shows the start point, dashed lines indicate the true underlying motion, and coloured lines indicate the observed motion after the addition of noise. Colours correspond to run probabilities, as inferred by the full HMM method, with a colour map that varies between green, denoting a run, and red, denoting a stop. The scale bar is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e098" xlink:type="simple"/></inline-formula> in length. The lower plots show (from bottom to top) the true underlying state, before and after discretisation, the run probabilities, and the run status, before and after post-processing. Crosses indicate sample points.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003276.g003" position="float" xlink:type="simple"/></fig>
<p>An additional heuristic step may be applied to the run status vector of each track, which smooths the inferred state path between the running and stopped phases. We define a run persistence parameter, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e099" xlink:type="simple"/></inline-formula>, and a stop persistence parameter, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e100" xlink:type="simple"/></inline-formula>, which correspond to the minimum permissible duration of running and stopped phases, respectively. Running phases that have durations shorter than <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e101" xlink:type="simple"/></inline-formula> are relabelled, and likewise for stopped phases shorter than <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e102" xlink:type="simple"/></inline-formula>, so that the whole track has a valid run status. Details of the implementation are given in Materials and Methods. These minimum permissible duration parameters should be selected appropriately for the system being studied and the parameters of the experimental protocol. For example, if the sampling rate is very rapid relative to the mean stopping duration, this would suggest that a large value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e103" xlink:type="simple"/></inline-formula> may be appropriate. We do not consider the process of selecting these parameters further as they are an optional addition to our analysis method; the main purpose of their inclusion in this study is to show how they may improve the output of the heuristic approach (see the following simulation study).</p>
</sec></sec><sec id="s3b">
<title>Simulation study of analysis methods</title>
<p>Prior to applying the heuristic method and our two novel methods to experimental data, we must evaluate and compare their ability to correctly infer stop phases in tracks affected by various levels of noise. A traditional means of evaluating this performance is to compare with the results of manual assignment of stopped phases in real tracks. This approach suffers from several key drawbacks, however. Manual tracking is a time-consuming and often difficult process; the stopped phases in microscope videos are by no means easy to discern unambiguously by eye. In addition, manual assessment of tracks is unavoidably subjective.</p>
<p>Here we use an alternative approach to manual analysis: a simulation study. This is a common means of assessing the performance of automated analysis methods <xref ref-type="bibr" rid="pcbi.1003276-Beausang1">[34]</xref>, <xref ref-type="bibr" rid="pcbi.1003276-Das1">[35]</xref>, <xref ref-type="bibr" rid="pcbi.1003276-Little1">[38]</xref>. We assume that experimentally-obtained wildtype tracks are the result of a run and stop velocity jump process <xref ref-type="bibr" rid="pcbi.1003276-Othmer1">[39]</xref>. Cells in the running phase travel in straight lines with a constant speed drawn from a Weibull distribution that closely approximates the observed non-chemotactic running speed distribution. After a random, exponentially distributed time interval with mean <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e104" xlink:type="simple"/></inline-formula>, cells enter a stopping phase and their speed is set to zero. Cells stop for a random period of time, exponentially distributed with mean <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e105" xlink:type="simple"/></inline-formula>, after which they switch to the running phase again with a new, Weibull distributed run speed. A new direction of travel is drawn at each reorientation event from the circular uniform distribution. We also simulate tracks describing the non-chemotactic mutant, in which no reorientation events occur, and the non-motile mutant, which is always in the stopped state. We define the sampling interval to be <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e106" xlink:type="simple"/></inline-formula> to match the frame capture rate of the microscope used to obtain experimental movies. We simulate 500 tracks for 250 frames each using the parameter values <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e107" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e108" xlink:type="simple"/></inline-formula>. These mean duration values are in close agreement with previous studies of <italic>E. coli</italic> <xref ref-type="bibr" rid="pcbi.1003276-Berg1">[4]</xref>, while the remaining simulation parameters have been chosen to match the experimental protocol used to acquire tracks in this study (see Materials and Methods).</p>
<p>We include a simplified model of the noise in the system by adding a normally distributed perturbation to each coordinate of every recorded position in a track, with zero mean and variance equal to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e109" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e110" xlink:type="simple"/></inline-formula> is varied to modulate the level of noise applied to the system. A random selection of simulated tracks with varying levels of noise are shown in <xref ref-type="supplementary-material" rid="pcbi.1003276.s005">Figure S5</xref>. We note that the use of uncorrelated Gaussian noise to simulate the type of noise exhibited in real experimental data may be an oversimplification, however the nature of the noise present in such cases is unknown and beyond the scope of this study. The true underlying state sequence in the simulations, which is continuous in time, is recorded for later comparison with the state inferred by the analysis methods. In carrying out the steps required to analyse the simulated datasets and compare their performance, we attempt to mimic as closely as possible the process that we use when analysing real data (see <xref ref-type="fig" rid="pcbi-1003276-g002">Figure 2</xref>). We infer the values of all model parameters based on the three simulated datasets; none of the parameters of the true underlying processes are known to the analysis methods.</p>
<p>Before commencing the simulation study, we verify that the methods do not produce spurious results when applied to tracks generated from an incompatible underlying model of motion. This test is carried out by analysing tracks from a non-chemotactic simulated dataset. Such tracks contain no stops; the aim of this initial test is to ensure that the analysis methods do not infer stopping phases falsely. In practice, we find that the optimisation routine fails to find a MLE for the transition rate parameters because the negative log-likelihood is independent of the parameter <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e111" xlink:type="simple"/></inline-formula> (see <xref ref-type="supplementary-material" rid="pcbi.1003276.s006">Figure S6</xref> and <xref ref-type="supplementary-material" rid="pcbi.1003276.s014">Text S1</xref> for details). This indicates that the HMM-based methods cannot be applied blindly to tracks that contain no stops.</p>
<p><xref ref-type="fig" rid="pcbi-1003276-g004">Figure 4</xref> illustrates the MLE values and 95% two-tailed confidence intervals of the mean running and stopping durations, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e112" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e113" xlink:type="simple"/></inline-formula>, respectively, for a range of values of the noise level, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e114" xlink:type="simple"/></inline-formula>. When the level of added noise is low, the two parameters are estimated correctly by both methods. The MLE value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e115" xlink:type="simple"/></inline-formula> is overestimated by around 20% by both methods in the absence of noise. In the case of the full HMM method, the MLE value decreases with increasing noise level, which initially causes the estimate to become more accurate. At the highest noise level considered here, the MLE <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e116" xlink:type="simple"/></inline-formula> is around 60% of the true value. In contrast, the speed-only method MLE <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e117" xlink:type="simple"/></inline-formula> increases with noise level. At the highest noise level, the MLE is around double the true value. The full method estimates the value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e118" xlink:type="simple"/></inline-formula> accurately throughout the range of noise levels considered, whereas the speed-only method increasingly overestimates the same parameter as the noise level increases. At the highest noise level, the speed-only MLE <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e119" xlink:type="simple"/></inline-formula> is around threefold greater than the true value. Since the noise model incorporated in our simulations may differ from the sources of noise in the experimental tracks, the precise quantification of the error in the MLE is not of real interest here. However, this result suggests that parameters estimated from highly noisy data may be unreliable, and that the full HMM method generally provides better estimates.</p>
<fig id="pcbi-1003276-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003276.g004</object-id><label>Figure 4</label><caption>
<title>MLE mean durations and 95% confidence intervals, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e120" xlink:type="simple"/></inline-formula> (black) and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e121" xlink:type="simple"/></inline-formula> (red), computed with simulated tracks by minimising the negative log-likelihood.</title>
<p>(Top plot) HMM full; (bottom plot) HMM speed-only. Dashed lines indicate the true values used in the simulation.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003276.g004" position="float" xlink:type="simple"/></fig>
<p>All of the analysis methods output a run status vector for each track, which is discrete in time. The true underlying state path is, by contrast, continuous in time. In order to facilitate a comparison between the inferred state sequence and the ground truth, we discretise the ground truth over intervals of duration <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e122" xlink:type="simple"/></inline-formula>. Any such interval that contains part of a stop phase is designated a stop in the discretised true state sequence. The inferred state sequence is a series of stopping phases and running phases, with the convention that an inferred stop corresponds to a positive result. A false positive (FP) therefore corresponds to an inferred stopping phase where none is present in the true underlying state sequence, while a false negative (FN) corresponds to an inferred running phase where none is present in the true underlying state sequence. <xref ref-type="fig" rid="pcbi-1003276-g003">Figure 3</xref> illustrates this; compare the true, discretised run status with the inferred run status. There are several discrepancies. A stop lasting two frames is inferred at the start of the track, where none is present in the true state. This is a FP; there is another at around <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e123" xlink:type="simple"/></inline-formula>. Conversely, at approximately <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e124" xlink:type="simple"/></inline-formula> a true stopping event is missed by the analysis method. This is a FN. As noted previously, the application of the post-processing method with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e125" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e126" xlink:type="simple"/></inline-formula> both greater than one corrects the second FP. For each level of added noise, we compute the mean rate of FPs and FNs as the ratio of the total number of FPs and FNs to the total number of actual stop events in the true underlying state. This is computed as the average over all tracks in the simulated dataset.</p>
<p><xref ref-type="fig" rid="pcbi-1003276-g005">Figure 5(a)</xref> shows the mean FP and FN rates produced by the three analysis methods. In the case of the heuristic method, we test the results with and without post-processing with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e127" xlink:type="simple"/></inline-formula>. The application of post-processing made no significant difference to the results from the HMM methods (data not shown). A FP rate of one means that the average number of false stops equals the number of true stops, while a FP rate of zero indicates that no FPs are observed. The heuristic method is highly sensitive to low levels of noise, generating significantly higher FP rates than the methods based on the HMM. The heuristic FP rate is reduced somewhat by the application of post-processing, however it still remains significantly higher than either of the HMM methods. The full HMM method has a higher FP rate than the speed-only method, though the discrepancy only becomes large when <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e128" xlink:type="simple"/></inline-formula>. The speed-only method has an approximately constant low FP rate throughout the full range of noise levels considered here. In contrast, the speed-only method generates the largest FN rate, with the full HMM and heuristic methods exhibiting a similar, lower FN rate. These results suggest that the full HMM method is better able to identify stops, with the disadvantage that it is also more sensitive to noise and more prone to false positives. On the other hand, the speed-only method detects fewer stops, but makes fewer false declarations.</p>
<fig id="pcbi-1003276-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003276.g005</object-id><label>Figure 5</label><caption>
<title>Assessing the performance of the analysis methods using simulated data.</title>
<p>(a) Mean FP and FN rate per simulated track at different levels of additive noise. (◊) heuristic, no post-processing; (□) heuristic with post-processing; (+) HMM speed-only, no post-processing; (×) HMM full, no post-processing. (b) and (c) Histograms of the inferred stopwise angle changes computed using the full HMM method (b) and the heuristic method (c) on the simulated dataset with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e129" xlink:type="simple"/></inline-formula>. Black bars show data for all inferred stops, grey bars show which of these are due to FPs. The results are similar when the speed-only method is used, or if post-processing is applied.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003276.g005" position="float" xlink:type="simple"/></fig>
<p>We further assess the accuracy of the HMM methods in <xref ref-type="fig" rid="pcbi-1003276-g005">Figure 5(b)</xref> by plotting the histogram of all inferred angle changes over the course of a stopping phase (henceforth denoted stopwise angle changes), overlaid with the histogram of stopwise angle changes due to FPs. We use a simulated dataset with an intermediate level of additive noise (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e130" xlink:type="simple"/></inline-formula>) for this purpose, as this is similar to the value of the translational diffusion coefficient estimated from the experimental data (approximately <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e131" xlink:type="simple"/></inline-formula>; see <xref ref-type="supplementary-material" rid="pcbi.1003276.s010">Figure S10</xref> and <xref ref-type="supplementary-material" rid="pcbi.1003276.s014">Text S1</xref>). The result changes very little for noise levels up to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e132" xlink:type="simple"/></inline-formula> (data not shown). The true underlying distribution of stopwise angle changes is uniform. This figure shows that FPs tend to produce small stopwise angle changes, which introduces some bias into the process. However, the number of FPs is low and the bias is not significant over a range of intermediate noise levels. As <xref ref-type="fig" rid="pcbi-1003276-g005">Figure 5(c)</xref> illustrates, the bias is significantly higher when the heuristic method is used. This study indicates that the novel HMM methods developed here represent a demonstrable improvement over the heuristic method for the identification of stopping phases in tracks. In particular, the level of FPs and degree of systematic bias introduced by the heuristic method are unacceptable, as they would lead us to draw erroneous conclusions from our data.</p>
</sec><sec id="s3c">
<title>Analysis of experimental tracking data</title>
<p>In this section, we restrict our attention to the HMM-based methods, as the simulation study demonstrated that the FP level is unacceptable using the heuristic method when even low levels of noise are present. Our aim is to demonstrate the broad relevance of our methods to various species of motile bacteria. To this end, we consider two novel datasets, obtained for <italic>R. sphaeroides</italic> and <italic>E. coli</italic> as described in Materials and Methods. Results from the analysis of <italic>R. sphaeroides</italic> are shown in full. Many previous studies have considered the motile behaviour of <italic>E. coli</italic> <xref ref-type="bibr" rid="pcbi.1003276-Berg1">[4]</xref>, <xref ref-type="bibr" rid="pcbi.1003276-Sager1">[9]</xref>, <xref ref-type="bibr" rid="pcbi.1003276-Block1">[40]</xref>, therefore for reasons of space we only present the main results from this dataset.</p>
<p>We use the non-chemotactic and non-motile datasets to form the empirical prior in the HMM-based methods. This is achieved by computing the framewise speeds and angle changes in both cases and applying the KDE to estimate the observation pdfs, as described previously. The emprirical prior for the <italic>R. sphaeroides</italic> dataset is plotted in <xref ref-type="fig" rid="pcbi-1003276-g006">Figure 6</xref>.</p>
<fig id="pcbi-1003276-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003276.g006</object-id><label>Figure 6</label><caption>
<title>Observed distributions extracted from the non-motile (white bars) and non-chemotactic (black bars) <italic>R. sphaeroides</italic> mutants, after censoring.</title>
<p>Grey bars denote overlapping regions. (a) Framewise speeds. (b) Framewise angle changes.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003276.g006" position="float" xlink:type="simple"/></fig>
<p>The inferred maximum likelihood parameters are shown in <xref ref-type="table" rid="pcbi-1003276-t001">Table 1</xref> along with other values reported in the literature. Our simulation study indicated that both HMM-based methods generated MLEs that differed from the true values, with the speed-only method likely to overestimate both <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e133" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e134" xlink:type="simple"/></inline-formula> and the accuracy of the full method depending on the level of noise. This is borne out in our analysis, with the speed-only method generating larger MLEs for both <italic>R. sphaeroides</italic> and <italic>E. coli</italic>. The discrepancy between the two methods in the inferred transition rates is thus an indication that our estimates of the transition rates should be treated with caution.</p>
<table-wrap id="pcbi-1003276-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003276.t001</object-id><label>Table 1</label><caption>
<title>Mean duration of running and stopped states.</title>
</caption><alternatives><graphic id="pcbi-1003276-t001-1" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003276.t001" xlink:type="simple"/>
<table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" rowspan="1" colspan="1">Reference</td>
<td align="left" rowspan="1" colspan="1">Species</td>
<td align="left" rowspan="1" colspan="1">Method</td>
<td align="left" rowspan="1" colspan="1"><italic>τ</italic><sub>12</sub> (s)</td>
<td align="left" rowspan="1" colspan="1"><italic>τ</italic><sub>21</sub> (s)</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1"><xref ref-type="bibr" rid="pcbi.1003276-Berg1">[4]</xref></td>
<td align="left" rowspan="1" colspan="1"><italic>E. coli</italic></td>
<td align="left" rowspan="1" colspan="1">Single cell tracking</td>
<td align="left" rowspan="1" colspan="1">0.14±0.19</td>
<td align="left" rowspan="1" colspan="1">0.86±1.18</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><xref ref-type="bibr" rid="pcbi.1003276-Berry1">[41]</xref></td>
<td align="left" rowspan="1" colspan="1"><italic>R. sphaeroides</italic></td>
<td align="left" rowspan="1" colspan="1">Tethered cell</td>
<td align="left" rowspan="1" colspan="1">0.27</td>
<td align="left" rowspan="1" colspan="1">1.69</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><xref ref-type="bibr" rid="pcbi.1003276-Brown1">[42]</xref></td>
<td align="left" rowspan="1" colspan="1"><italic>R. sphaeroides</italic></td>
<td align="left" rowspan="1" colspan="1">Tethered cell</td>
<td align="left" rowspan="1" colspan="1">0.66±1.01</td>
<td align="left" rowspan="1" colspan="1">3.23</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><xref ref-type="bibr" rid="pcbi.1003276-Packer2">[62]</xref></td>
<td align="left" rowspan="1" colspan="1"><italic>R. sphaeroides</italic></td>
<td align="left" rowspan="1" colspan="1">Tethered cell</td>
<td align="left" rowspan="1" colspan="1">1.04±3.18</td>
<td align="left" rowspan="1" colspan="1">4.54</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">This study</td>
<td align="left" rowspan="1" colspan="1"><italic>R. sphaeroides</italic></td>
<td align="left" rowspan="1" colspan="1">Tracking (full)</td>
<td align="left" rowspan="1" colspan="1">0.40±0.02</td>
<td align="left" rowspan="1" colspan="1">1.16±0.06</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">This study</td>
<td align="left" rowspan="1" colspan="1"><italic>R. sphaeroides</italic></td>
<td align="left" rowspan="1" colspan="1">Tracking (speed-only)</td>
<td align="left" rowspan="1" colspan="1">0.50±0.02</td>
<td align="left" rowspan="1" colspan="1">1.59±0.08</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">This study</td>
<td align="left" rowspan="1" colspan="1"><italic>E. coli</italic></td>
<td align="left" rowspan="1" colspan="1">Tracking (full)</td>
<td align="left" rowspan="1" colspan="1">0.19±0.01</td>
<td align="left" rowspan="1" colspan="1">0.35±0.01</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">This study</td>
<td align="left" rowspan="1" colspan="1"><italic>E. coli</italic></td>
<td align="left" rowspan="1" colspan="1">Tracking (speed-only)</td>
<td align="left" rowspan="1" colspan="1">0.31±0.01</td>
<td align="left" rowspan="1" colspan="1">0.53±0.02</td>
</tr>
</tbody>
</table>
</alternatives><table-wrap-foot><fn id="nt101"><label/><p>Summarised literature values of transition rates between the running and stopped states in <italic>R. sphaeroides</italic> and <italic>E. coli</italic>. Standard deviations are given where they are available; note that standard deviations provided for the analysis methods refer to the optimisation procedure rather than the difference between individual tracks. The terms ‘full’ and ‘speed-only’ refer to the HMM method used to analyse the data.</p></fn></table-wrap-foot></table-wrap>
<p>A wide range of transition rates have been recorded in the studies cited in <xref ref-type="table" rid="pcbi-1003276-t001">Table 1</xref>, despite the superficially similar experimental protocols. A few of the many possible explanations include the use of different wildtype strains, small differences in the composition of the motility buffer, and differences in the analysis methods. Comparing with our results, we see that the inferred value of the mean stop duration in <italic>R. sphaeroides</italic> is in reasonable agreement with the findings of Berry et al. <xref ref-type="bibr" rid="pcbi.1003276-Berry1">[41]</xref>. The results suggest that running phases occur for a shorter mean duration in our datasets than those of Brown <xref ref-type="bibr" rid="pcbi.1003276-Brown1">[42]</xref> or Packer et al. <xref ref-type="bibr" rid="pcbi.1003276-Packer1">[43]</xref>, as indicated by the smaller value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e135" xlink:type="simple"/></inline-formula>. Results for <italic>E. coli</italic> are in reasonable agreement with those of Berg and Brown <xref ref-type="bibr" rid="pcbi.1003276-Berg1">[4]</xref>. The tethered cell and tracking protocols differ a great deal, as observed by Poole and coworkers <xref ref-type="bibr" rid="pcbi.1003276-Poole1">[13]</xref>, who noted that the use of antibody to tether <italic>R. sphaeroides</italic> to a microscope slide by their flagella substantially reduced their rotation speed and decreased the number of observed stops. This is consistent with our findings, as we estimate a smaller value for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e136" xlink:type="simple"/></inline-formula>, corresponding to shorter runs and an increased number of stopping phases.</p>
<p>Furthermore, we note that our MLEs are computed for pooled data, so that individual variations between tracks are averaged over an entire dataset. There is considerable heterogeneity in switching rates within a bacterial population <xref ref-type="bibr" rid="pcbi.1003276-Packer1">[43]</xref>. However, considering each track separately would result in insufficient data being available for shorter tracks, or those containing no run-stop-run transitions, so we do not consider that problem here. It is for this reason that the estimate of the error in the MLEs is low in comparison with the other results cited; this is because we use bootstrapping of our ensemble sample to generate this estimate (see Materials and Methods for details). The error estimated in our study is therefore a reflection of the nature of the negative log-likelihood surface close to the MLE, rather than an estimate of the deviation between individual tracks. It may be possible to investigate population heterogeneity by applying the HMM-based methods to individual tracks obtained using single-cell tracking methods, as these tracks are generally longer.</p>
<p>In contrast with our simulation study, we have no ground truth with which to compare the result of the analysis of the experimental datasets. Nevertheless, a manual inspection of the inferred state sequence of tracks readily identifies some tracks in which the analysis appears to be successful, in addition to some tracks in which the inferred state sequence is unrealistic. A selection of wildtype <italic>R. sphaeroides</italic> tracks in which the analysis has been manually identified as successful is shown in <xref ref-type="fig" rid="pcbi-1003276-g007">Figure 7</xref> (left panel). Several well-defined stopping regions within the tracks have been expanded for greater clarity. Note that, although the speed-only HMM method was used to compute the run probabilities in this figure, the results for these tracks are almost indistinguishable when the full HMM method is used. The track shown in <xref ref-type="fig" rid="pcbi-1003276-g007">Figure 7</xref> (right panel) arises from a bacterium swimming slowly in an exaggerated helical trajectory, and appears to contain a single genuine stopping event. Both analysis methods incorrectly identify several of the helical turns as stopping phases, leading to an unrealistically rapidly oscillating state sequence. Application of post-processing to either HMM analysis method circumvents this issue. The presence of such a track in the censored dataset motivated a manual examination of all tracks exhibiting either high median curvature or containing a large number of inferred stopping phases. This indicated that, of the 2780 tracks included in the wildtype dataset, fewer than five are clearly identifiable as highly tortuous. Any effects from this minority of tracks, after pooling all analysed data, will be insignificant. A similar outcome is observed in <italic>E. coli</italic>, although the proportion of tortuous tracks appears to be higher (data not shown). We provide the analogous plot to <xref ref-type="fig" rid="pcbi-1003276-g007">Figure 7</xref> for <italic>E. coli</italic> in <xref ref-type="supplementary-material" rid="pcbi.1003276.s011">Figure S11</xref>.</p>
<fig id="pcbi-1003276-g007" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003276.g007</object-id><label>Figure 7</label><caption>
<title>Manual inspection of <italic>R. sphaeroides</italic> tracks to assess the performance of the analysis methods.</title>
<p>(Left) A selection of tracks that were manually verified to contain stopping phases correctly identified by the speed-only HMM method. Green indicates a running phase, red indicates a stopping phase, small circles indicate the starting position of the track, and pairs of arrows show the direction of travel of the bacterium immediately prior to and after a stop. Larger circles indicate regions of the track that have been expanded in the nearby inset plots. (Right) A track from a bacterium swimming in a helical trajectory, as analysed by (i) full HMM, (ii) speed-only HMM, (iii) full HMM with post-processing, and (iv) speed-only HMM with post-processing. The black bar is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e137" xlink:type="simple"/></inline-formula> long, otherwise the plot is interpreted as for the left-hand side.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003276.g007" position="float" xlink:type="simple"/></fig>
<p>In <xref ref-type="fig" rid="pcbi-1003276-g008">Figure 8(a)</xref> we provide a verification of our assumption that wildtype bacterial motility in <italic>R. sphaeroides</italic> may be approximated as consisting of runs, which are equivalent to those of the non-chemotactic strain, and stops, equivalent to the behaviour of the non-motile strain. This figure shows the observed distribution of framewise speeds in the phases identified as running and stopping by the analysis methods. These are qualitatively similar to those in <xref ref-type="fig" rid="pcbi-1003276-g006">Figure 6</xref>, suggesting that the form of our empirical prior is appropriate. Furthermore, the similarity of the distributions estimated by the speed-only and full methods indicate that the two methods are in close agreement.</p>
<fig id="pcbi-1003276-g008" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003276.g008</object-id><label>Figure 8</label><caption>
<title>Characteristics of the motile behaviour of wildtype <italic>R. sphaeroides</italic> extracted using the HMM-based analysis methods.</title>
<p>(a) Observed distribution of framewise speeds in the running (black bars) and stopping states (white bars), computed using the full HMM method without post-processing. Application of post-processing and/or using the speed-only method makes no significant difference to the results. (b) Observed distribution of absolute stopwise angle changes computed using the full (black bars) and speed-only HMM method (white bars) without post-processing. Application of post-processing makes no significant difference to the results. (c) As (b), but for <italic>E. coli</italic>. In all plots, grey bars denote overlapping regions.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003276.g008" position="float" xlink:type="simple"/></fig>
<p><xref ref-type="fig" rid="pcbi-1003276-g008">Figures 8(b) and 8(c)</xref> show the estimated distribution of absolute stopwise angle changes in <italic>R. sphaeroides</italic> and <italic>E. coli</italic>, respectively, as computed using the speed-only and full HMM methods without post-processing. Plotting angles rather than absolute angles does not affect the results, as the distribution is symmetric (data not shown). We consider this novel result an important demonstration of the application of our analysis protocol; such a distribution has not been recorded previously for <italic>R. sphaeroides</italic>. Again, the methodological variants are all in close agreement. The distribution is unimodal, containing a single peak at the origin. We carried out a two-sided Kuiper test <xref ref-type="bibr" rid="pcbi.1003276-Watson1">[44]</xref> on the <italic>R. sphaeroides</italic> dataset to compare the simulated distribution of inferred stopwise angles (shown in <xref ref-type="fig" rid="pcbi-1003276-g005">Figure 5(b)</xref>) with the experimentally-observed distribution. If these two distributions are similar, we are unable to determine whether the observed experimental distribution is significant, or whether it arises as a result of the bias inherent in our analysis method. Analysis of the experimental <italic>R. sphaeroides</italic> data indicates that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e138" xlink:type="simple"/></inline-formula> (see <xref ref-type="supplementary-material" rid="pcbi.1003276.s010">Figure S10</xref> and <xref ref-type="supplementary-material" rid="pcbi.1003276.s014">Text S1</xref>); we use the conservative value <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e139" xlink:type="simple"/></inline-formula> in our simulations. A two-sided Kuiper test reveals that the two distributions differ significantly (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e140" xlink:type="simple"/></inline-formula>, see <xref ref-type="supplementary-material" rid="pcbi.1003276.s014">Text S1</xref> for details of the calculation). The result in <xref ref-type="fig" rid="pcbi-1003276-g008">Figure 8(b)</xref> is therefore more significant than the small bias introduced by the analysis methods, indicating that <italic>R. sphaeroides</italic> exhibit persistence over reorientation phases.</p>
</sec></sec><sec id="s4">
<title>Discussion</title>
<p>In this work we have demonstrated the effective application of novel analysis methods based on a modified HMM to tracking data acquired using a simple and relatively inexpensive experimental protocol. The result is a high-throughput method to characterise bacterial motion. We applied our methods to two species of bacteria that exhibit quite different motile behaviour and showed that we are able to estimate certain key distributions, such as the pdf of stopwise angle changes, plotted in <xref ref-type="fig" rid="pcbi-1003276-g008">Figures 8(b) and 8(c)</xref>. This result has not been measured before in <italic>R. sphaeroides</italic>, and provides significant evidence that this bacterium exhibits persistence over reorientation events, which has important consequences for the modelling of their motion, and that of related flagellate bacteria. We note that persistence is a consequence of any reorientation process that occurs over a stochastic duration if some reorientation phases are sufficiently brief that the direction has not been fully randomised. Therefore, we propose that shorter reorientation events in the two species considered here lead to a greater degree of persistence. Testing this hypothesis is the topic of ongoing work.</p>
<p>The stopwise angle change distribution in <italic>E. coli</italic> (<xref ref-type="fig" rid="pcbi-1003276-g008">Figure 8(c)</xref>) has been measured previously by Berg and Brown <xref ref-type="bibr" rid="pcbi.1003276-Berg1">[4]</xref> (see <xref ref-type="fig" rid="pcbi-1003276-g003">Figure 3</xref> in that reference for comparison). In contrast with the bimodal distribution centred at approximately <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e141" xlink:type="simple"/></inline-formula> found in Berg and Brown's study, we find that the distributions in both <italic>E. coli</italic> and <italic>R. sphaeroides</italic> is unimodal and peaked about the origin. In addition, there is no significant difference between the distribution for these two species. For further comparison, Xie et al. measured the distribution of stopwise angle changes in <italic>V. alginolyticus</italic>, a bacterium that undergoes reversal events, and showed that the distribution is bimodal, with peaks at around 90 and 180 degrees <xref ref-type="bibr" rid="pcbi.1003276-Xie1">[12]</xref>. The difference between the analysis methods used to extract stopping events in our study and that of Berg and Brown may provide an explanation for the discrepancy in our results. In the earlier study, a heuristic method is applied in which the framewise angle change must exceed 35 degrees for more than one frame to be labelled as a stop <xref ref-type="bibr" rid="pcbi.1003276-Berg1">[4]</xref>. This may bias the analysis towards detecting stopping events with larger angle changes.</p>
<p>A further explanation for the discrepancy between this study and that of Berg and Brown may be the substantially different experimental protocols used in the two studies. Berg and Brown track individual bacteria at a frame rate of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e142" xlink:type="simple"/></inline-formula>, while we simultaneously track multiple bacteria at a frame rate of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e143" xlink:type="simple"/></inline-formula>. As a result, our datasets contain significantly more tracks: we analyse 1758 tracks in the <italic>E. coli</italic> wildtype dataset, compared with the 35 recorded by Berg and Brown <xref ref-type="bibr" rid="pcbi.1003276-Berg1">[4]</xref>. Duffy and Ford <xref ref-type="bibr" rid="pcbi.1003276-Duffy1">[10]</xref> more recently used the same tracking apparatus to study <italic>P. putida</italic>, obtaining 80 tracks. However, the tracks we acquire have a lower mean duration: Berg and Brown <xref ref-type="bibr" rid="pcbi.1003276-Berg1">[4]</xref> present a wildtype track 29.5 seconds in duration; by comparison the mean duration of our tracks is 1.5 seconds in the <italic>R. sphaeroides</italic> dataset and 6 seconds in the <italic>E. coli</italic> dataset. This difference in mean track duration is due to the lower magnification used in acquiring the <italic>E. coli</italic> dataset, in addition to the lower swimming speed of this species.</p>
<p>The duration of tracks is limited by the size of the focal plane and the fact that bacteria may swim out of focus, thus terminating the track. This reduction in track duration is a consequence of the high-throughput, unsupervised protocol used in this study, and is a limitation generally present in many recently-developed multiple cell tracking protocols <xref ref-type="bibr" rid="pcbi.1003276-Xie2">[15]</xref>, <xref ref-type="bibr" rid="pcbi.1003276-Wu1">[29]</xref>. Whilst we obtain fewer measurements for each individual, we are able to measure significantly more robust population-wide statistics. As each cell is observed over a randomly-selected time interval in its lifetime, the shorter duration of the tracks has no consequences for our population measurements. Further work is required to determine whether shorter duration tracks reduce our ability to discern variations in the motile behaviour of an individual bacterium. By way of preliminary comment, we note that the appearance of the tracks with the longest duration (around 10 seconds) in the current dataset suggests that the motile behaviour observed in our tracks is not significantly different over a single order of magnitude of timescales. Furthermore, our approach is less subject to bias than a human-operated single-cell tracking protocol, as we image all cells within the field of view and discard tracks using a small number of well-justified censoring parameters. In contrast, any protocol in which the experimentalist may select which cells to track may be systematically biased in favour of a certain, idealised, type of motile behaviour.</p>
<p>A second novel contribution of the present work is the use of a systematic simulation study to validate our analysis methods and compare them with an established method. To our knowledge, no studies have previously compared analysis methods applicable to bacterial tracking data. The comparison indicates that the methods based on the HMM are significantly more robust to noise than the established heuristic method, generating significantly fewer FPs. Furthermore, the simulation study allowed us to determine the extent to which the results are biased by FPs (see <xref ref-type="fig" rid="pcbi-1003276-g005">Figure 5(b)</xref>). We used the results from our simulation study to show that the distribution of stopwise angle changes obtained from experimental data in <italic>R. sphaeroides</italic> (<xref ref-type="fig" rid="pcbi-1003276-g008">Figure 8(b)</xref>) differs from the distribution of FP stopwise angle changes obtained from simulated tracks (<xref ref-type="fig" rid="pcbi-1003276-g005">Figure 5(b)</xref>) with very high statistical significance. A quantification of the inherent bias in the analysis methodology has not been carried out in previous bacterial tracking studies <xref ref-type="bibr" rid="pcbi.1003276-Berg1">[4]</xref>, <xref ref-type="bibr" rid="pcbi.1003276-Frymier1">[45]</xref>, thus it is unclear to what extent the statistics may be biased. We believe that our simulation approach therefore represents an important advance in the field of bacterial tracking.</p>
<p>An important caveat associated with the high-throughput tracking of many cells simultaneously is the inevitable presence of many tracks that do not appear to conform to the well-studied run-and-tumble model of motility. For example, a non-motile subpopulation has been observed in several similar studies <xref ref-type="bibr" rid="pcbi.1003276-Berg2">[46]</xref>–<xref ref-type="bibr" rid="pcbi.1003276-Parkinson1">[48]</xref>. Whilst these tracks may be of general interest, the present analysis methods are specifically developed to extract information about bacteria undergoing run-and-tumble motion, hence it is necessary to filter out incongruous tracks. In Materials and Methods, we have presented censoring approaches that mitigate such issues. In particular, the minimum bounding diameter and tortuosity are very useful characteristics for censoring tracks that might otherwise lead to spurious inferences. In particular, we discard the top 5% of tracks, ordered by tortuosity. This approach allows us to apply the same censoring method to multiple datasets without the need to specify multiple thresholds, and therefore permits unbiased comparisons to be made.</p>
<p>Manual inspection of the segmented tracks revealed a selection of tracks in which the new analysis methods appear to have performed well (see <xref ref-type="fig" rid="pcbi-1003276-g007">Figures 7</xref> and <xref ref-type="supplementary-material" rid="pcbi.1003276.s011">S11</xref>). These tracks were manually selected from the dataset because they appear easy to interpret, with clear running and stopping phases. In addition, an example of a helical <italic>R. sphaeroides</italic> track was shown, for which both analysis methods clearly failed to infer the correct state sequence. The inclusion of post-processing helped to correct the inferred run probabilities.</p>
<p>The HMM approach takes advantage of the availability of non-motile and non-chemotactic mutant strains to obtain empirical prior information on the motion of the bacteria. Such strains are available for many bacterial species not considered in this study, for example <italic>Campylobacter jejuni</italic> <xref ref-type="bibr" rid="pcbi.1003276-Takata1">[49]</xref>, and <italic>Caulobacter crescentus</italic> <xref ref-type="bibr" rid="pcbi.1003276-Ely1">[50]</xref>. The protocol developed is theoretically applicable to any bacterium that undergoes approximately discrete reorientation events of sufficient duration so as to be captured with a video microscope. It is encouraging that our analysis methods have proved applicable to two very different species of bacteria. There are substantial differences in the reorientation mechanisms of the two species: <italic>E. coli</italic> undergoes rapid, active reorientation, achieved by the displacement of individual flagellar helices from a peritrichous flagellar bundle, whereas <italic>R. sphaeroides</italic> reorientates more slowly, by halting the rotation of its single flagellum <xref ref-type="bibr" rid="pcbi.1003276-Pilizota1">[5]</xref>. The mean stop duration parameter, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e144" xlink:type="simple"/></inline-formula>, is larger in <italic>R. sphaeroides</italic>, as expected. Further work is required to determine whether all such bacteria are amenable to analysis in this way, however. For example, <italic>Bacillus subtilis</italic> is believed to accelerate into a running phase <xref ref-type="bibr" rid="pcbi.1003276-Cisneros1">[51]</xref>, which could contravene our two-state model of motion if the acceleration stage is long relative to the timescale of the microscopy.</p>
<p>A further possible application of the methods presented in this study is to the motion of certain eukaryotic species, such as the alga <italic>Chlamydomonas</italic>, which is known to exhibit motion that is superficially similar to the random swimming of bacteria <xref ref-type="bibr" rid="pcbi.1003276-Polin1">[52]</xref>. However, this alga is approximately an order of magnitude larger than bacteria, and therefore exhibits significantly different properties, such as inertia and spatial sensing. Further work is needed to test whether our methods are applicable to such species.</p>
<p>The methods presented here may also be applied in situations where no mutant strains are available. The motion of non-motile bacteria may be reasonably approximated by a diffusive process, as is the case for the non-motile <italic>R. sphaeroides</italic> and <italic>E. coli</italic> in the present study <xref ref-type="bibr" rid="pcbi.1003276-Rosser1">[53]</xref>. Furthermore, it is possible to generate an estimate of the behaviour of bacteria in a running phase by manually selecting running phases in a wildtype dataset, although this is a subjective procedure that potentially biases the analysis. Whilst the present study concerns the analysis of a single, identified species of bacteria at any one time, there is also a demand to analyse samples containing multiple unknown bacterial species <xref ref-type="bibr" rid="pcbi.1003276-Mitchell1">[54]</xref>. Further work is required to determine whether our analysis methods are applicable in these situations. For example, minor modifications should allow the HMM methods to be used to determine the likelihood that a given observed track arises from a reference model of motion.</p>
<p>The current experimental approach produces two-dimensional position coordinates for the cell centroids. We have therefore implicitly projected the true three-dimensional motion of the bacteria swimming in the bulk onto the microscope's image plane. Hill and Häder <xref ref-type="bibr" rid="pcbi.1003276-Hill1">[55]</xref> analysed the effect of projection of tracks onto a two-dimensional plane and concluded that, for their purposes, the error introduced in the observed mean speed is small (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e145" xlink:type="simple"/></inline-formula>). The authors assume an infinite focal depth for their calculation, whereas the focal depth in our setup is small compared to the dimensions of the image plane. We therefore expect the errors caused by projection in our case to be substantially smaller. A further consequence of performing tracking away from a surface within a single focal plane is that bacteria may freely swim out of focus, causing the track to be terminated and leading to tracks of relatively short duration <xref ref-type="bibr" rid="pcbi.1003276-Ahmed1">[17]</xref>. It is possible to track bacteria in three dimensions, and several groups have made use of various three-dimensional tracking methods to investigate bacterial swimming <xref ref-type="bibr" rid="pcbi.1003276-Berg1">[4]</xref>, <xref ref-type="bibr" rid="pcbi.1003276-Duffy1">[10]</xref>, <xref ref-type="bibr" rid="pcbi.1003276-Thar1">[28]</xref>, <xref ref-type="bibr" rid="pcbi.1003276-Wu1">[29]</xref>, <xref ref-type="bibr" rid="pcbi.1003276-Frymier1">[45]</xref>, <xref ref-type="bibr" rid="pcbi.1003276-Brown2">[56]</xref>, <xref ref-type="bibr" rid="pcbi.1003276-Vigeant1">[57]</xref>. The process for obtaining three-dimensional tracks is, however, generally more complex than the method we use and in many cases this leads to a reduced number of tracks available for analysis. Digital holographic microscopy is a promising recent development that could potentially allow the tracking of multiple bacteria simultaneously in three dimensions in a fixed field of view <xref ref-type="bibr" rid="pcbi.1003276-Sheng1">[58]</xref>. The HMM-based approaches presented here can be extended in a straightforward manner to deal with three-dimensional data.</p>
<p>Software implementing the methods described in this study is provided in the supporting file <xref ref-type="supplementary-material" rid="pcbi.1003276.s013">Software S1</xref>. It is fully documented and written in Python to make it compatible with all major operating systems. The applications of the analysis methods presented here are of potential benefit in a wide variety of bacterial research, including studies of pathogenicity, biofilm formation, and the response of bacteria to chemoattractants and changing environments. In particular, the field of microfluidics is a promising area for further development, as it allows the tracking of bacteria in a well-defined concentration gradient of chemoattractant, as demonstrated by Ahmed and Stocker <xref ref-type="bibr" rid="pcbi.1003276-Ahmed1">[17]</xref>. In this case, a modification would be required to incorporate the spatial variation of the transition matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e146" xlink:type="simple"/></inline-formula>, reflecting the heterogeneous chemoattractant concentration. The ability to quickly assess and compare the motility of a variety of related bacterial strains, or different species, is a powerful addition to the methodological toolbox of the bacteriologist.</p>
</sec><sec id="s5" sec-type="materials|methods">
<title>Materials and Methods</title>
<sec id="s5a">
<title>Acquisition of bacterial tracks</title>
<p>Imaging and tracking was performed on three different strains of <italic>R. sphaeroides</italic>: wildtype (WS8N), a non-motile mutant (JPA467) and a non-chemotactic mutant that is incapable of stopping (JPA1353). Details of the experimental protocol used to create the mutant strains, and the growth conditions, are given in <xref ref-type="bibr" rid="pcbi.1003276-Pilizota1">[5]</xref>. Some typical raw footage of <italic>R. sphaeroides</italic> is provided in <xref ref-type="supplementary-material" rid="pcbi.1003276.s015">Video S1</xref>. Three strains of <italic>E. coli</italic> were also used: wildtype (RP437), non-motile (CheY<sup>**</sup>), and non-chemotactic (ΔCheY). Bacteria were imaged in a homogeneous solution of motility buffer using a tunnel slide. Imaging was performed at 50 frames per second using a Nikon phase contrast microscope with a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e147" xlink:type="simple"/></inline-formula> magnification objective lens in the case of <italic>R. sphaeroides</italic> and a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e148" xlink:type="simple"/></inline-formula> objective in the case of <italic>E. coli</italic>. The images are captured in 256 level greyscale, 640 pixels (px) wide and 480 px in height, equivalent to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e149" xlink:type="simple"/></inline-formula> wide and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e150" xlink:type="simple"/></inline-formula> high in the case of <italic>R. sphaeroides</italic> and twice those dimensions for <italic>E. coli</italic>. For comparison, a typical <italic>R. sphaeroides</italic> cell is approximately ellipsoidal, with axial and equatorial diameters of around <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e151" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e152" xlink:type="simple"/></inline-formula>, respectively. Imaging was performed with the microscope focused approximately <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e153" xlink:type="simple"/></inline-formula> below the top coverslip, and at least this distance from the bottom surface of the microscope slide. This is sufficiently far from either surface that we may neglect surface effects, which are known to cause bacteria to swim in arcing trajectories <xref ref-type="bibr" rid="pcbi.1003276-Frymier1">[45]</xref> The observed cells are swimming freely in the medium and may stray out of the focal plane. Typically between 10 and 20 minutes of footage are acquired for each strain, from each of which we obtain between 3000 and 7000 tracks. The tracking procedure is able to cope with a large variation in the density of cells within the field of view, and this value changes depending on the level of magnification used. We typically aimed for around 20–40 cells visible within the field of view in the case of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e154" xlink:type="simple"/></inline-formula> magnification, and 50–80 cells in the case of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e155" xlink:type="simple"/></inline-formula> magnification. Both magnification levels used provided sufficient spatial resolution to find centroids with acceptable accuracy. Further work is necessary to determine whether even lower levels of magnification would allow us to increase the throughput of the experiment without compromising on accuracy. The frame rate of the camera should be sufficiently rapid that reorientation events can be imaged, and preferably so that most events last for greater than a single frame.</p>
<p>We performed cell tracking in two stages. First, in the object detection stage, each frame in a video was processed to establish the centroids of each visible cell. Second, in the data association stage, centroids in each frame were connected to form tracks. The object detection stage is carried out in several steps:</p>
<list list-type="order"><list-item>
<p>compute the background value of each pixel as its mean intensity over all frames;</p>
</list-item><list-item>
<p>subtract the background intensity from all frames;</p>
</list-item><list-item>
<p>find pixels in each frame with intensities after background subtraction above the threshold value <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e156" xlink:type="simple"/></inline-formula> and below the threshold value <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e157" xlink:type="simple"/></inline-formula>;</p>
</list-item><list-item>
<p>cluster groups of pixels that are 4-connected, meaning that every pixel in a cluster has another pixel in the same cluster in one of the four neighbouring sites around it;</p>
</list-item><list-item>
<p>discard any clusters containing fewer than a defined number of pixels, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e158" xlink:type="simple"/></inline-formula>;</p>
</list-item><list-item>
<p>find the centroid (centre of mass) of each of the remaining clusters.</p>
</list-item></list>
<p>The centroids computed using this method represent the targets present in each frame. The initial background subtraction ensures that any static image artefacts, such as dust on the microscope lens or impurities stuck to the coverslip, are removed from the video. The parameters <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e159" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e160" xlink:type="simple"/></inline-formula> were selected separately for each video based on manual verification that the process correctly segmented cells in the images. The values of these parameters were chosen to minimise the number of missed detections, at the expense of producing additional FPs, as the data association routine is robust to high levels of FPs <xref ref-type="bibr" rid="pcbi.1003276-Wood1">[27]</xref>. The minimum cluster size constraint was applied to the region data to remove spurious targets, which are too small to be cells. The minimum cluster size was fixed at <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e161" xlink:type="simple"/></inline-formula> px, which is substantially below the mean cross-sectional area of a cell. This resulted in the removal of a significant number of FPs whilst having no effect on true positives. Some errors arise in the process of computing the cell centroid, due to the relatively low contrast of the microscope images. We estimate that such errors should be no greater than half the diameter of a cell body. In order to manually confirm that cell centroid calculation is sufficiently robust for our purposes, tracks from non-chemotactic cells were examined to ensure that they mainly showed smooth swimming, with no overly jagged sections. A further consequence of the low contrast images is that it is not possible to determine cell orientation on this scale; this parameter must therefore be inferred from the angle change between each triplet of consecutive centroids.</p>
<p>The data association method used in this study is a multitarget tracking scheme based on the probability hypothesis density filter. We use an implementation described in <xref ref-type="bibr" rid="pcbi.1003276-Wood1">[27]</xref>, which has been applied to microscope videos similar to those used in this study. <xref ref-type="supplementary-material" rid="pcbi.1003276.s016">Video S2</xref> shows the raw microscopy footage of <italic>R. sphaeroides</italic> overlaid with tracks. As described in <italic>Analysis methods</italic>, the tracker performs less well when cells are in a stopped phase, as the errors in centroid detection are more significant. Manual inspection of tracks shows well-defined stopping phases in the wildtype strains, however the apparent trajectory during a stop is not accurate. This provides the basis for the modification to the HMM, discussed in the section <italic>Hidden Markov model methods</italic>.</p>
</sec><sec id="s5b">
<title>Bootstrapping method for estimation of transition probability confidence intervals</title>
<p>When optimising the value of the transition parameters <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e162" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e163" xlink:type="simple"/></inline-formula>, we require an estimate of the uncertainty in our final MLE. This is achieved using simple bootstrapping <xref ref-type="bibr" rid="pcbi.1003276-Carpenter1">[37]</xref>, in which we resample the tracking dataset by drawing the same number of tracks randomly with replacement. The optimisation procedure is then repeated on the new selected dataset, to achieve a new MLE. This process is repeated for 1000 iterations, after which we sort the bootstrapped MLE transition parameters. We finally use the 2.5th and 97.5th percentile values from the sorted list of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e164" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e165" xlink:type="simple"/></inline-formula> as estimates of the confidence interval.</p>
</sec><sec id="s5c">
<title>Censoring tracking datasets</title>
<p>Preliminary scrutinisation of our <italic>R. sphaeroides</italic> and <italic>E. coli</italic> tracking data reveals that a significant proportion of tracks that do not appear to be well described by the run-and-tumble motility described in previous studies <xref ref-type="bibr" rid="pcbi.1003276-Berg1">[4]</xref>, <xref ref-type="bibr" rid="pcbi.1003276-Armitage2">[59]</xref>. These tracks are either very jagged in their appearance, exhibit unrealistically large movements between frames, or seem to arise from a diffusing object, rather than an actively swimming cell. Possible causes of such tracks include errors in the tracking process, non-motile bacteria, and bacteria with defective motility apparatus. First, the process used to extract tracks from microscope videos may occasionally produce a failed track, for example by linking the trajectories of two different cells, or incorporating a false detection into the trajectory. This is a particular concern if the failed track displays behaviour that differs substantially from the true motion of the observed bacteria, since even a small number of failed tracks may dramatically affect the inferences that are drawn. In order to avoid this issue, tracks containing one or more framewise speeds greater than a threshold value, denoted <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e166" xlink:type="simple"/></inline-formula>, are considered to be anomalous and discarded from the dataset. The value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e167" xlink:type="simple"/></inline-formula> is determined by considering the observed distribution of framewise speeds in the non-chemotactic strain; this gives an indication of the range of speeds exhibited. An upper threshold is then selected that causes outliers to be discarded. In the case of <italic>R. sphaeroides</italic>, whose mean swimming speed is approximately <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e168" xlink:type="simple"/></inline-formula>, we select <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e169" xlink:type="simple"/></inline-formula>. The mean swimming speed of <italic>E. coli</italic> is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e170" xlink:type="simple"/></inline-formula> and we choose <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e171" xlink:type="simple"/></inline-formula>. In both cases, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e172" xlink:type="simple"/></inline-formula> is significantly greater than the mean swimming speed. We allow such a large margin for variation in the framewise speed as small errors in consecutive frames can generate large fluctuations in the apparent framewise speed. We do not wish to discard tracks containing a few instances of such inaccuracies, since these quantities will not dominate the population average. This effect is expected to be minor when all tracks in a dataset are considered, and we note that over- and underestimation of the framewise speed are equally probable. Observed framewise speeds above the cutoff value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e173" xlink:type="simple"/></inline-formula> are unlikely to arise from such a source of noise; these are instead treated as a tracking error and the whole track is discarded.</p>
<p>In addition to tracker errors, a second consideration is the presence of a significant portion of non-motile tracked cells, as is usually observed in experiments of this kind <xref ref-type="bibr" rid="pcbi.1003276-Berg2">[46]</xref>–<xref ref-type="bibr" rid="pcbi.1003276-Parkinson1">[48]</xref>. Reasons for a lack of motility include cell death, a defective component in the cellular motility machinery, and cell damage due to experimental handling. <xref ref-type="fig" rid="pcbi-1003276-g009">Figure 9</xref> provides evidence for the presence of a non-motile subpopulation in the non-chemotactic <italic>R. sphaeroides</italic> strain by comparison with the non-motile strain. As <xref ref-type="fig" rid="pcbi-1003276-g009">Figure 9(a)</xref> demonstrates, the observed distribution of framewise speeds for the non-chemotactic strain is bimodal, with a peak at low speeds that overlaps almost exactly with the non-motile distribution. This suggests that the low speed subpopulation in the non-chemotactic strain is due to non-motile cells. Similarly, in <xref ref-type="fig" rid="pcbi-1003276-g009">Figure 9(b)</xref>, non-chemotactic <italic>R. sphaeroides</italic> bacteria exhibit a bimodal distribution of median curvatures. The subpopulation with higher median curvatures corresponds very closely to the non-motile population.</p>
<fig id="pcbi-1003276-g009" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003276.g009</object-id><label>Figure 9</label><caption>
<title>Motile characteristics extracted from the non-motile and non-chemotactic <italic>R. sphaeroides</italic> tracking datasets.</title>
<p>(a) Histogram of framewise speeds for the non-chemotactic (black bars) and non-motile (white bars) datasets. Overlapping regions are shown in grey. The distributions have been scaled so their maxima coincide. (b) Histogram of median curvature (defined below in <xref ref-type="disp-formula" rid="pcbi.1003276.e177">equation (13)</xref> ) computed for all tracks in the non-chemotactic (black bars) and non-motile (white bars) datasets. Intersecting regions are shown in grey. Note that the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e174" xlink:type="simple"/></inline-formula>axis is broken; the density at low curvatures dominates the non-chemotactic histogram. The datasets have been censored to remove failed tracks (see text for details).</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003276.g009" position="float" xlink:type="simple"/></fig>
<p>A third way in which the experimental data differ from the simulated data is the wide range of tortuosities exhibited by real tracks, due to variation within the populations of bacteria being studied. Several tracks appear to be highly tortuous, possibly as a result of bacteria swimming in severely helical paths or with substantial cell body motion. Possible causes for tortuous tracks include damaged or defective flagella, and two bacterial cells swimming whilst stuck together, prior to cell division. None of the analysis methods discussed herein are able to cope with highly tortuous tracks, as these exhibit many large framewise angle changes and low framewise speeds in the running phase. It is therefore challenging to discern stopping phases in such tracks, either automatically or by manual inspection. Tortuous tracks are apparent in the non-chemotactic and wildtype datasets and it is necessary to remove them from the dataset before performing any further analysis.</p>
<p>Our approach to censoring tracks is based on a two-variable representation of a track used by Miño et al. <xref ref-type="bibr" rid="pcbi.1003276-Mio1">[47]</xref>. Each track is summarised in terms of the mean absolute framewise angle change (MAC), and the normalised effective mean speed (NEMS). The NEMS is defined as the ratio of the effective mean speed (EMS) to the mean framewise speed. The EMS is in turn given by the diameter of the smallest circle that encloses the entire track (denoted the minimum bounding diameter, MBD) divided by the total duration of the track. Thus the NEMS takes values between zero and one, and quantifies how straight the track is, with one interpreted as a line that doesn't deviate from a straight path and smaller values indicating increasingly undirected motion.</p>
<p>Miño et al. note that a population consisting of self-propelled particles (which is a good model for motile bacteria) and non-motile diffusing particles exhibits a well-separated bimodal distribution in the MAC-NEMS plot <xref ref-type="bibr" rid="pcbi.1003276-Mio1">[47]</xref>. <xref ref-type="fig" rid="pcbi-1003276-g010">Figure 10(a)</xref> shows such a plot for the non-chemotactic strain of <italic>R. sphaeroides</italic>, before any censoring. Two modes are clearly visible, one with high MAC and low NEMS corresponding to non-motile cells, and one with low MAC and high NEMS corresponding to motile cells. We use this representation of tracks to determine the effectiveness of our censoring approach.</p>
<fig id="pcbi-1003276-g010" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003276.g010</object-id><label>Figure 10</label><caption>
<title>Results illustrating the censoring process in <italic>R. sphaeroides</italic>.</title>
<p>(a) MAC-NEMS plot for the non-chemotactic dataset, before censoring. (b) MAC-NEMS plot for the non-chemotactic dataset, after censoring. (c) A random selection of 40 tracks from the wildtype dataset, with censored tracks shown in grey and remaining tracks shown in black.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003276.g010" position="float" xlink:type="simple"/></fig>
<p>We also require a measure of the tortuosity of a track, as this is a useful property for the purposes of filtering the dataset. Several methods have been proposed for estimating tortuosity <xref ref-type="bibr" rid="pcbi.1003276-Grisan1">[60]</xref>; we employ a method proposed by Lewiner et al., in which a three-point estimator of the curvature of a track is used as a measure of the tortuosity <xref ref-type="bibr" rid="pcbi.1003276-Lewiner1">[61]</xref>. The curvature is defined for a given position, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e175" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e176" xlink:type="simple"/></inline-formula>, in a track by<disp-formula id="pcbi.1003276.e177"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003276.e177" xlink:type="simple"/><label>(13)</label></disp-formula>where the notation is introduced in the Results section and illustrated in <xref ref-type="fig" rid="pcbi-1003276-g001">Figure 1</xref>. The curvature is undefined for the first and last points in a track, as we require three adjacent points to estimate it. We use the median value of the absolute curvature of a track as a summary statistic, as this has been used previously to characterise trajectories <xref ref-type="bibr" rid="pcbi.1003276-Lemelle1">[20]</xref>.</p>
<p>The non-motile tracks are not censored beyond the application of the threshold <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e178" xlink:type="simple"/></inline-formula>, as any further censoring would remove all of the remaining tracks. For the non-chemotactic and wildtpe strains we censor tracks in two stages. We first filter out non-motile tracks by imposing a minimum value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e179" xlink:type="simple"/></inline-formula> for the MBD, and discard tracks whose MBD is lower than this cutoff value. This ensures that tracks that do not cover a sufficiently large region of the field of view are removed from the dataset; in practice, tracks that do not meet this threshold are non-motile or of very short duration. Finally, the top five percent of tracks, ordered by median curvature, are discarded, following Alon et al. <xref ref-type="bibr" rid="pcbi.1003276-Alon1">[18]</xref>. This stage is necessary to remove the remaining non-motile and anomalously tortuous tracks. Discarding an arbitrary proportion of tracks may lead to anomalous tracks remaining in the dataset, or tracks of interest being removed. Nonetheless, this approach has the advantage that the same parameters may be used to censor a wide range of datasets. In this study, for example, we use the same censoring parameters to remove defective tracks from both <italic>R. sphaeroides</italic> and <italic>E. coli</italic> tracking data.</p>
<p><xref ref-type="fig" rid="pcbi-1003276-g010">Figure 10(b)</xref> shows the MAC-NEMS plot for the non-chemotactic <italic>R. sphaeroides</italic> strain following censoring. The density at high MAC has been filtered out, leaving mainly tracks that lie in the correct region of the plot corresponsing to motile cells. Similar plots for wildtype <italic>R. sphaeroides</italic> and both non-chemotactic and wildtype <italic>E. coli</italic> are shown in <xref ref-type="supplementary-material" rid="pcbi.1003276.s007">Figures S7</xref>, <xref ref-type="supplementary-material" rid="pcbi.1003276.s008">S8</xref>, <xref ref-type="supplementary-material" rid="pcbi.1003276.s009">S9</xref>; in all cases, the censoring process removes tracks that lie in the high MAC, low NEMS region.</p>
<p>The number of tracks in each of the datasets before and after the censoring stages is given in <xref ref-type="table" rid="pcbi-1003276-t002">Table 2</xref>. The censoring stage removes a large proportion of the initial tracks, with most failing on the minimum MBD criterion. This is an important stage of the analysis process, as most of these tracks are due to non-motile cells or very short duration tracks, neither of which are desirable in the final dataset. <xref ref-type="fig" rid="pcbi-1003276-g010">Figure 10(c)</xref> shows a representative sample of tracks before and after the censoring process. The dataset initially contains a large proportion of tracks from non-motile or motility-defective bacteria. After censoring, these tracks have been removed, whilst still retaining longer tracks that exhibit stops.</p>
<table-wrap id="pcbi-1003276-t002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003276.t002</object-id><label>Table 2</label><caption>
<title>Effect of censoring the datasets.</title>
</caption><alternatives><graphic id="pcbi-1003276-t002-2" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003276.t002" xlink:type="simple"/>
<table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" rowspan="1" colspan="1">Dataset</td>
<td align="left" rowspan="1" colspan="1"><italic>Rs</italic> nm</td>
<td align="left" rowspan="1" colspan="1"><italic>Rs</italic> nc</td>
<td align="left" rowspan="1" colspan="1"><italic>Rs</italic> wt</td>
<td align="left" rowspan="1" colspan="1"><italic>Ec</italic> nm</td>
<td align="left" rowspan="1" colspan="1"><italic>Ec</italic> nc</td>
<td align="left" rowspan="1" colspan="1"><italic>Ec</italic> wt</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1"><bold>Initial number tracks</bold></td>
<td align="left" rowspan="1" colspan="1">5627</td>
<td align="left" rowspan="1" colspan="1">3773</td>
<td align="left" rowspan="1" colspan="1">6832</td>
<td align="left" rowspan="1" colspan="1">3669</td>
<td align="left" rowspan="1" colspan="1">3562</td>
<td align="left" rowspan="1" colspan="1">5757</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><bold>Number above</bold> <italic>ρ</italic><sub>FS</sub></td>
<td align="left" rowspan="1" colspan="1">47</td>
<td align="left" rowspan="1" colspan="1">212</td>
<td align="left" rowspan="1" colspan="1">706</td>
<td align="left" rowspan="1" colspan="1">500</td>
<td align="left" rowspan="1" colspan="1">492</td>
<td align="left" rowspan="1" colspan="1">979</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><bold>Number below minimum MBD</bold></td>
<td align="left" rowspan="1" colspan="1">-</td>
<td align="left" rowspan="1" colspan="1">1859</td>
<td align="left" rowspan="1" colspan="1">2928</td>
<td align="left" rowspan="1" colspan="1">-</td>
<td align="left" rowspan="1" colspan="1">1219</td>
<td align="left" rowspan="1" colspan="1">2811</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><bold>5% removed by median curvature</bold></td>
<td align="left" rowspan="1" colspan="1">-</td>
<td align="left" rowspan="1" colspan="1">86</td>
<td align="left" rowspan="1" colspan="1">160</td>
<td align="left" rowspan="1" colspan="1">-</td>
<td align="left" rowspan="1" colspan="1">93</td>
<td align="left" rowspan="1" colspan="1">99</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><bold>Number remaining</bold></td>
<td align="left" rowspan="1" colspan="1">5580</td>
<td align="left" rowspan="1" colspan="1">1616</td>
<td align="left" rowspan="1" colspan="1">3038</td>
<td align="left" rowspan="1" colspan="1">3169</td>
<td align="left" rowspan="1" colspan="1">1758</td>
<td align="left" rowspan="1" colspan="1">1868</td>
</tr>
</tbody>
</table>
</alternatives><table-wrap-foot><fn id="nt102"><label/><p>The number of tracks in each of the datasets considered, before and after censoring. <italic>Rs</italic> denotes <italic>R. sphaeroides</italic>, <italic>Ec</italic> is <italic>E. coli</italic>, nm is non-motile, nc is non-chemotactic, wt is wildtype. Dashes indicate that a stage of the censoring is not applicable.</p></fn></table-wrap-foot></table-wrap></sec><sec id="s5d">
<title>Post-processing</title>
<p>Post-processing is implemented as follows:</p>
<list list-type="order"><list-item>
<p>find the duration of all inferred running phases;</p>
</list-item><list-item>
<p>convert all running phases with duration less than <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e180" xlink:type="simple"/></inline-formula> to stops;</p>
</list-item><list-item>
<p>recalculate to find the duration of all stopping phases;</p>
</list-item><list-item>
<p>convert all stopping phases with duration less than <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e181" xlink:type="simple"/></inline-formula> to runs.</p>
</list-item></list>
<p>The process is illustrated in <xref ref-type="fig" rid="pcbi-1003276-g003">Figure 3</xref>, in which the short stop inferred at around <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e182" xlink:type="simple"/></inline-formula> is removed by the application of post-processing. The relabelling of short runs before short stops introduces a bias towards stops when sustained rapid oscillations occur between the two states (the short run sections will first be converted to stops, resulting in a larger stopped section). We choose to proceed in this fashion as we place greater importance on identifying every stop, possibly at the expense of including some false positives or inferring overly long stopping phases.</p>
</sec></sec><sec id="s6">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1003276.s001" mimetype="application/postscript" xlink:href="info:doi/10.1371/journal.pcbi.1003276.s001" position="float" xlink:type="simple"><label>Figure S1</label><caption>
<p><bold>Joint and marginal estimated observation pdfs for the non-chemotactic strain of </bold><bold><italic>R. sphaeroides</italic></bold><bold>.</bold></p>
<p>(EPS)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003276.s002" mimetype="application/postscript" xlink:href="info:doi/10.1371/journal.pcbi.1003276.s002" position="float" xlink:type="simple"><label>Figure S2</label><caption>
<p><bold>Joint and marginal estimated observation pdfs for the non-motile strain of </bold><bold><italic>R. sphaeroides</italic></bold><bold>.</bold></p>
<p>(EPS)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003276.s003" mimetype="application/postscript" xlink:href="info:doi/10.1371/journal.pcbi.1003276.s003" position="float" xlink:type="simple"><label>Figure S3</label><caption>
<p><bold>Joint and marginal estimated observation pdfs for the non-chemotactic strain of </bold><bold><italic>R. sphaeroides</italic></bold><bold>, rescaled to show noise.</bold></p>
<p>(EPS)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003276.s004" mimetype="application/postscript" xlink:href="info:doi/10.1371/journal.pcbi.1003276.s004" position="float" xlink:type="simple"><label>Figure S4</label><caption>
<p><bold>Joint and marginal estimated observation pdfs for the non-motile strain of </bold><bold><italic>R. sphaeroides</italic></bold><bold>, rescaled to show noise.</bold></p>
<p>(EPS)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003276.s005" mimetype="application/postscript" xlink:href="info:doi/10.1371/journal.pcbi.1003276.s005" position="float" xlink:type="simple"><label>Figure S5</label><caption>
<p><bold>Plot showing simulated tracks with varying levels of added noise.</bold> (a) <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e183" xlink:type="simple"/></inline-formula>, (b) <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e184" xlink:type="simple"/></inline-formula>, (c) <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e185" xlink:type="simple"/></inline-formula>, (d) <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e186" xlink:type="simple"/></inline-formula>.</p>
<p>(EPS)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003276.s006" mimetype="application/postscript" xlink:href="info:doi/10.1371/journal.pcbi.1003276.s006" position="float" xlink:type="simple"><label>Figure S6</label><caption>
<p><bold>Observed distributions extracted from simulated non-motile (white bars) and non-chemotactic (black bars) tracks.</bold> Grey bars denote overlapping regions. Noise is applied with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e187" xlink:type="simple"/></inline-formula>. (a) Framewise speeds. (b) Framewise angle changes.</p>
<p>(EPS)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003276.s007" mimetype="application/postscript" xlink:href="info:doi/10.1371/journal.pcbi.1003276.s007" position="float" xlink:type="simple"><label>Figure S7</label><caption>
<p><bold>The negative log likelihood surface for a simulated non-chemotactic dataset.</bold></p>
<p>(EPS)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003276.s008" mimetype="application/postscript" xlink:href="info:doi/10.1371/journal.pcbi.1003276.s008" position="float" xlink:type="simple"><label>Figure S8</label><caption>
<p><bold>MAC-NEMS plots for wildtype </bold><bold><italic>R. sphaeroides</italic></bold><bold> before (a) and after (b) censoring.</bold></p>
<p>(EPS)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003276.s009" mimetype="application/postscript" xlink:href="info:doi/10.1371/journal.pcbi.1003276.s009" position="float" xlink:type="simple"><label>Figure S9</label><caption>
<p><bold>MAC-NEMS plots for non-chemotactic </bold><bold><italic>E. coli</italic></bold><bold> before (a) and after (b) censoring.</bold></p>
<p>(EPS)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003276.s010" mimetype="application/postscript" xlink:href="info:doi/10.1371/journal.pcbi.1003276.s010" position="float" xlink:type="simple"><label>Figure S10</label><caption>
<p><bold>MAC-NEMS plots for wildtype </bold><bold><italic>E. coli</italic></bold><bold> before before (a) and after (b) censoring.</bold></p>
<p>(EPS)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003276.s011" mimetype="application/postscript" xlink:href="info:doi/10.1371/journal.pcbi.1003276.s011" position="float" xlink:type="simple"><label>Figure S11</label><caption>
<p><bold>Estimation of the level of noise in the experimental data.</bold> Mean squared displacement of the non-motile <italic>R. sphaeroides</italic> dataset (solid line), overlaid with a linear fit to the data from time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e188" xlink:type="simple"/></inline-formula> onwards (dashed line). The gradient of the dashed line is approximately <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e189" xlink:type="simple"/></inline-formula>.</p>
<p>(EPS)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003276.s012" mimetype="application/postscript" xlink:href="info:doi/10.1371/journal.pcbi.1003276.s012" position="float" xlink:type="simple"><label>Figure S12</label><caption>
<p><bold>Manual inspection of wildtype </bold><bold><italic>E. coli</italic></bold><bold> tracks, analysed with the speed-only HMM method.</bold> Tracks appear similar when the full method is used (data not shown). Green indicates a running phase, red indicates a stopping phase, small circles indicate the starting position of the track, and pairs of arrows show the direction of travel of the bacterium immediately prior to and after a stop. The top plot shows tracks where the methods appear to have performed well. The lower plot shows tracks for which the state sequence shows very many transitions over the course of each track; these appear to arise from highly tumbly swimmers, and are likely to be among the most tortuous tracks remaining in the dataset following the censoring approach. All tracks are plotted on the same scale; the plot is approximately <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003276.e190" xlink:type="simple"/></inline-formula> wide.</p>
<p>(EPS)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003276.s013" mimetype="application/zip" xlink:href="info:doi/10.1371/journal.pcbi.1003276.s013" position="float" xlink:type="simple"><label>Software S1</label><caption>
<p><bold>Zipped folder containing Python implementation of the analysis method described in this study, together with experimental data.</bold> Details for how to install the software is given in the doc subfolder, while a thoroughly documented example of how to run the code is provided in the file usage_example.py. Further documentation of this software is provided online at <ext-link ext-link-type="uri" xlink:href="http://www.2020science.net/software/bacterial-motility-analysis-tool" xlink:type="simple">http://www.2020science.net/software/bacterial-motility-analysis-tool</ext-link>.</p>
<p>(ZIP)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003276.s014" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003276.s014" position="float" xlink:type="simple"><label>Text S1</label><caption>
<p><bold>Supplementary text providing further details on: assessing whether our analysis methods may be blindly applied to tracks from a movement model that does not fit the two-state model assumed for our HMM method; estimating the level of noise present in our experimental data; and testing for statistical significance of the observed stopwise angle change distribution.</bold></p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003276.s015" mimetype="video/x-msvideo" xlink:href="info:doi/10.1371/journal.pcbi.1003276.s015" position="float" xlink:type="simple"><label>Video S1</label><caption>
<p><bold>Short clip of the raw microscopy video data obtained for wildtype </bold><bold><italic>R. sphaeroides</italic></bold><bold>.</bold> Details of the experimental protocol are provided in the main text and <xref ref-type="bibr" rid="pcbi.1003276-Pilizota1">[5]</xref>.</p>
<p>(AVI)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003276.s016" mimetype="video/mpeg" xlink:href="info:doi/10.1371/journal.pcbi.1003276.s016" position="float" xlink:type="simple"><label>Video S2</label><caption>
<p><bold>The same footage presented in Video S1, but overlaid with cell tracks obtained using a multitarget tracking scheme based on the probability hypothesis density filter.</bold> The implementation of this scheme are described in <xref ref-type="bibr" rid="pcbi.1003276-Wood1">[27]</xref>.</p>
<p>(MPG)</p>
</caption></supplementary-material></sec></body>
<back>
<ack>
<p>We would like to thank Dr Trevor M. Wood for his invaluable help in adapting his tracking algorithm to make it suitable for our application and for helpful discussions.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1003276-Jefferson1"><label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jefferson</surname><given-names>K</given-names></name> (<year>2004</year>) <article-title>What drives bacteria to produce a biofilm?</article-title> <source>FEMS Microbiol Lett</source> <volume>236</volume>: <fpage>163</fpage>–<lpage>173</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003276-Drr1"><label>2</label>
<mixed-citation publication-type="other" xlink:type="simple">Dürr S, Thomason J (2009) Biofouling. Wiley-Blackwell, first edition.</mixed-citation>
</ref>
<ref id="pcbi.1003276-Purcell1"><label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Purcell</surname><given-names>EM</given-names></name> (<year>1977</year>) <article-title>Life at low reynolds number</article-title>. <source>Am J Phys</source> <volume>45</volume>: <fpage>3</fpage>–<lpage>11</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003276-Berg1"><label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Berg</surname><given-names>HC</given-names></name>, <name name-style="western"><surname>Brown</surname><given-names>DA</given-names></name> (<year>1972</year>) <article-title>Chemotaxis in <italic>Escherichia coli</italic> analysed by three-dimensional tracking</article-title>. <source>Nature</source> <volume>239</volume>: <fpage>500</fpage>–<lpage>504</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003276-Pilizota1"><label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pilizota</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Brown</surname><given-names>MT</given-names></name>, <name name-style="western"><surname>Leake</surname><given-names>MC</given-names></name>, <name name-style="western"><surname>Branch</surname><given-names>RW</given-names></name>, <name name-style="western"><surname>Berry</surname><given-names>RM</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>A molecular brake, not a clutch, stops the <italic>Rhodobacter sphaeroides</italic> flagellar motor</article-title>. <source>PNAS</source> <volume>106</volume>: <fpage>11582</fpage>–<lpage>11587</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003276-Haya1"><label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Haya</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Tokumaru</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Abe</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Kaneko</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Aizawa</surname><given-names>SI</given-names></name> (<year>2011</year>) <article-title>Characterization of lateral flagella of <italic>Selenomonas ruminantium</italic></article-title>. <source>Appl Environ Microbiol</source> <volume>77</volume>: <fpage>2799</fpage>–<lpage>2802</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003276-Armitage1"><label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Armitage</surname><given-names>JP</given-names></name>, <name name-style="western"><surname>Pitta</surname><given-names>TP</given-names></name>, <name name-style="western"><surname>Vigeant</surname><given-names>MA</given-names></name>, <name name-style="western"><surname>Packer</surname><given-names>HL</given-names></name>, <name name-style="western"><surname>Ford</surname><given-names>RM</given-names></name> (<year>1999</year>) <article-title>Transformations in flagellar structure of <italic>Rhodobacter sphaeroides</italic> and possible relationship to changes in swimming speed</article-title>. <source>J Bacteriol</source> <volume>181</volume>: <fpage>4825</fpage>–<lpage>4833</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003276-Porter1"><label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Porter</surname><given-names>SL</given-names></name>, <name name-style="western"><surname>Wadhams</surname><given-names>GH</given-names></name>, <name name-style="western"><surname>Armitage</surname><given-names>JP</given-names></name> (<year>2008</year>) <article-title><italic>Rhodobacter sphaeroides</italic>: complexity in chemotactic signalling</article-title>. <source>Trends Microbiol</source> <volume>16</volume>: <fpage>251</fpage>–<lpage>260</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003276-Sager1"><label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sager</surname><given-names>BM</given-names></name>, <name name-style="western"><surname>Sekelsky</surname><given-names>JJ</given-names></name>, <name name-style="western"><surname>Matsumura</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Adler</surname><given-names>J</given-names></name> (<year>1988</year>) <article-title>Use of a computer to assay motility in bacteria</article-title>. <source>Anal Biochem</source> <volume>173</volume>: <fpage>271</fpage>–<lpage>277</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003276-Duffy1"><label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Duffy</surname><given-names>KJ</given-names></name>, <name name-style="western"><surname>Ford</surname><given-names>RM</given-names></name> (<year>1997</year>) <article-title>Turn angle and run time distributions characterize swimming behavior for <italic>Pseudomonas putida</italic></article-title>. <source>J Bacteriol</source> <volume>179</volume>: <fpage>1428</fpage>–<lpage>1430</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003276-Attmannspacher1"><label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Attmannspacher</surname><given-names>U</given-names></name>, <name name-style="western"><surname>Scharf</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Schmitt</surname><given-names>R</given-names></name> (<year>2005</year>) <article-title>Control of speed modulation (chemokinesis) in the unidirectional rotary motor of <italic>Sinorhizobium meliloti</italic></article-title>. <source>Mol Microbiol</source> <volume>56</volume>: <fpage>708</fpage>–<lpage>718</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003276-Xie1"><label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Xie</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Altindal</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Chattopadhyay</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Wu</surname><given-names>XLL</given-names></name> (<year>2011</year>) <article-title>Bacterial flagellum as a propeller and as a rudder for efficient chemotaxis</article-title>. <source>PNAS</source> <volume>108</volume>: <fpage>2246</fpage>–<lpage>2251</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003276-Poole1"><label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Poole</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Sinclair</surname><given-names>DR</given-names></name>, <name name-style="western"><surname>Armitage</surname><given-names>JP</given-names></name> (<year>1988</year>) <article-title>Real time computer tracking of free-swimming and tethered rotating cells</article-title>. <source>Anal Biochem</source> <volume>175</volume>: <fpage>52</fpage>–<lpage>58</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003276-Hder1"><label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Häder</surname><given-names>DP</given-names></name>, <name name-style="western"><surname>Lebert</surname><given-names>M</given-names></name> (<year>1985</year>) <article-title>Real time computer-controlled tracking of motile microorganisms</article-title>. <source>Photochem Photobiol</source> <volume>42</volume>: <fpage>509</fpage>–<lpage>514</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003276-Xie2"><label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Xie</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Khan</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Shah</surname><given-names>M</given-names></name> (<year>2009</year>) <article-title>Automatic tracking of <italic>Rhodobacter sphaeroides</italic> in phase-contrast microscopy video</article-title>. <source>IEEE T Bio-Med Eng</source> <volume>56</volume>: <fpage>390</fpage>–<lpage>399</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003276-Martinez1"><label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Martinez</surname><given-names>VA</given-names></name>, <name name-style="western"><surname>Besseling</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Croze</surname><given-names>OA</given-names></name>, <name name-style="western"><surname>Tailleur</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Reufer</surname><given-names>M</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Differential dynamic microscopy: A high-throughput method for characterizing the motility of microorganisms</article-title>. <source>Biophys J</source> <volume>103</volume>: <fpage>1637</fpage>–<lpage>1647</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003276-Ahmed1"><label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ahmed</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Stocker</surname><given-names>R</given-names></name> (<year>2008</year>) <article-title>Experimental verification of the behavioral foundation of bacterial transport parameters using microfluidics</article-title>. <source>Biophys J</source> <volume>95</volume>: <fpage>4481</fpage>–<lpage>4493</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003276-Alon1"><label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Alon</surname><given-names>U</given-names></name>, <name name-style="western"><surname>Camarena</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Surette</surname><given-names>MG</given-names></name>, <name name-style="western"><surname>Aguera</surname></name>, <name name-style="western"><surname>Liu</surname><given-names>Y</given-names></name>, <etal>et al</etal>. (<year>1998</year>) <article-title>Response regulator output in bacterial chemotaxis</article-title>. <source>EMBO</source> <volume>17</volume>: <fpage>4238</fpage>–<lpage>4248</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003276-Lauga1"><label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lauga</surname><given-names>E</given-names></name>, <name name-style="western"><surname>DiLuzio</surname><given-names>WR</given-names></name>, <name name-style="western"><surname>Whitesides</surname><given-names>GM</given-names></name>, <name name-style="western"><surname>Stone</surname><given-names>HA</given-names></name> (<year>2006</year>) <article-title>Swimming in circles: motion of bacteria near solid boundaries</article-title>. <source>Biophys J</source> <volume>90</volume>: <fpage>400</fpage>–<lpage>412</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003276-Lemelle1"><label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lemelle</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Palierne</surname><given-names>JFF</given-names></name>, <name name-style="western"><surname>Chatre</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Place</surname><given-names>C</given-names></name> (<year>2010</year>) <article-title>Counterclockwise circular motion of bacteria swimming at the air-liquid interface</article-title>. <source>J Bacteriol</source> <volume>192</volume>: <fpage>6307</fpage>–<lpage>6308</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003276-Amsler1"><label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Amsler</surname><given-names>C</given-names></name> (<year>1996</year>) <article-title>Use of computer-assisted motion analysis for quantitative measurements of swimming behavior in peritrichously flagellated bacteria</article-title>. <source>Anal Biochem</source> <volume>235</volume>: <fpage>20</fpage>–<lpage>25</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003276-Barbara1"><label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Barbara</surname><given-names>GM</given-names></name>, <name name-style="western"><surname>Mitchell</surname><given-names>JG</given-names></name> (<year>2003</year>) <article-title>Bacterial tracking of motile algae</article-title>. <source>FEMS Microbiol Ecol</source> <volume>44</volume>: <fpage>79</fpage>–<lpage>87</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003276-Li1"><label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Li</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Bensson</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Nisimova</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Munger</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Mahautmr</surname><given-names>P</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Accumulation of swimming bacteria near a solid surface</article-title>. <source>Phys Rev E</source> <volume>84</volume>: <fpage>041932</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003276-Khan1"><label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Khan</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Castellano</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Spudich</surname><given-names>JL</given-names></name>, <name name-style="western"><surname>McCray</surname><given-names>JA</given-names></name>, <name name-style="western"><surname>Goody</surname><given-names>RS</given-names></name>, <etal>et al</etal>. (<year>1993</year>) <article-title>Excitatory signaling in bacterial probed by caged chemoeffectors</article-title>. <source>Biophys J</source> <volume>65</volume>: <fpage>2368</fpage>–<lpage>2382</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003276-Taboada1"><label>25</label>
<mixed-citation publication-type="other" xlink:type="simple">Taboada B, Poggio S, Camarena L, Corkidi G (2003) Automatic tracking and analysis system for free-swimming bacteria. In: Proceedings of the 25th Annual International Conference of the IEEE; 17–21 September 2003; Cancun, Mexico. Available: <ext-link ext-link-type="uri" xlink:href="http://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&amp;arnumber=1279912" xlink:type="simple">http://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&amp;arnumber=1279912</ext-link>. Accessed 1 February2013.</mixed-citation>
</ref>
<ref id="pcbi.1003276-Masson1"><label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Masson</surname><given-names>JB</given-names></name>, <name name-style="western"><surname>Voisinne</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Wong-Ng</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Celani</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Vergassola</surname><given-names>M</given-names></name> (<year>2012</year>) <article-title>Noninvasive inference of the molecular chemotactic response using bacterial trajectories</article-title>. <source>PNAS</source> <volume>109</volume>: <fpage>1802</fpage>–<lpage>1807</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003276-Wood1"><label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wood</surname><given-names>TM</given-names></name>, <name name-style="western"><surname>Yates</surname><given-names>CA</given-names></name>, <name name-style="western"><surname>Wilkinson</surname><given-names>DA</given-names></name>, <name name-style="western"><surname>Rosser</surname><given-names>G</given-names></name> (<year>2012</year>) <article-title>Simplified multitarget tracking using the PHD filter for microscopic video data</article-title>. <source>IEEE T Circ Syst Vid</source> <volume>22</volume>: <fpage>702</fpage>–<lpage>713</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003276-Thar1"><label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Thar</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Blackburn</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Kuhl</surname><given-names>M</given-names></name> (<year>2000</year>) <article-title>A new system for three-dimensional tracking of motile microorganisms</article-title>. <source>Appl Environ Microbiol</source> <volume>66</volume>: <fpage>2238</fpage>–<lpage>2242</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003276-Wu1"><label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wu</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Roberts</surname><given-names>JW</given-names></name>, <name name-style="western"><surname>Kim</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Koch</surname><given-names>DL</given-names></name>, <name name-style="western"><surname>DeLisa</surname><given-names>MP</given-names></name> (<year>2006</year>) <article-title>Collective bacterial dynamics revealed using a three-dimensional population-scale defocused particle tracking technique</article-title>. <source>Appl Env Microbiol</source> <volume>72</volume>: <fpage>4987</fpage>–<lpage>4994</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003276-Tisa1"><label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tisa</surname><given-names>LS</given-names></name>, <name name-style="western"><surname>Olivera</surname><given-names>BM</given-names></name>, <name name-style="western"><surname>Adler</surname><given-names>J</given-names></name> (<year>1993</year>) <article-title>Inhibition of <italic>Escherichia coli</italic> chemotaxis by omega-conotoxin, a calcium ion channel blocker</article-title>. <source>J Bacteriol</source> <volume>175</volume>: <fpage>1235</fpage>–<lpage>1238</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003276-Botev1"><label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Botev</surname><given-names>ZI</given-names></name>, <name name-style="western"><surname>Grotowski</surname><given-names>JF</given-names></name>, <name name-style="western"><surname>Kroese</surname><given-names>DP</given-names></name> (<year>2010</year>) <article-title>Kernel density estimation via diffusion</article-title>. <source>Ann Stat</source> <volume>38</volume>: <fpage>2916</fpage>–<lpage>2957</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003276-Rabiner1"><label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rabiner</surname><given-names>LR</given-names></name> (<year>1989</year>) <article-title>A tutorial on hidden Markov models and selected applications in speech recognition</article-title>. <source>Proc IEEE</source> <volume>77</volume>: <fpage>257</fpage>–<lpage>286</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003276-Press1"><label>33</label>
<mixed-citation publication-type="other" xlink:type="simple">Press WH, Teukolsky SA, Vetterling WT, Flannery BP (2007) Numerical recipes: the art of scientific computing. Cambridge University Press.</mixed-citation>
</ref>
<ref id="pcbi.1003276-Beausang1"><label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Beausang</surname><given-names>JF</given-names></name>, <name name-style="western"><surname>Nelson</surname><given-names>PC</given-names></name> (<year>2007</year>) <article-title>Diffusive hidden Markov model characterization of DNA looping dynamics in tethered particle experiments</article-title>. <source>Phys Biol</source> <volume>4</volume>: <fpage>205</fpage>–<lpage>219</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003276-Das1"><label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Das</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Cairo</surname><given-names>CW</given-names></name>, <name name-style="western"><surname>Coombs</surname><given-names>D</given-names></name> (<year>2009</year>) <article-title>A hidden Markov model for single particle tracks quantifies dynamic interactions between LFA-1 and the actin cytoskeleton</article-title>. <source>PLoS Comput Biol</source> <volume>5</volume>: <fpage>e1000556+</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003276-Conn1"><label>36</label>
<mixed-citation publication-type="other" xlink:type="simple">Conn AR, Gould NIM, Toint PL (1987) Trust-Region Methods. Society for Industrial and Applied Mathematics.</mixed-citation>
</ref>
<ref id="pcbi.1003276-Carpenter1"><label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Carpenter</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Bithell</surname><given-names>J</given-names></name> (<year>2000</year>) <article-title>Bootstrap confidence intervals: when, which, what? a practical guide for medical statisticians</article-title>. <source>Stat Med</source> <volume>19</volume>: <fpage>1141</fpage>–<lpage>1164</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003276-Little1"><label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Little</surname><given-names>MA</given-names></name>, <name name-style="western"><surname>Steel</surname><given-names>BC</given-names></name>, <name name-style="western"><surname>Bai</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Sowa</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Bilyard</surname><given-names>T</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Steps and bumps: precision extraction of discrete states of molecular machines</article-title>. <source>Biophys J</source> <volume>101</volume>: <fpage>477</fpage>–<lpage>485</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003276-Othmer1"><label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Othmer</surname><given-names>HG</given-names></name>, <name name-style="western"><surname>Dunbar</surname><given-names>SR</given-names></name>, <name name-style="western"><surname>Alt</surname><given-names>W</given-names></name> (<year>1988</year>) <article-title>Models of dispersal in biological systems</article-title>. <source>J Math Biol</source> <volume>26</volume>: <fpage>263</fpage>–<lpage>298</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003276-Block1"><label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Block</surname><given-names>SM</given-names></name>, <name name-style="western"><surname>Segall</surname><given-names>JE</given-names></name>, <name name-style="western"><surname>Berg</surname><given-names>HC</given-names></name> (<year>1983</year>) <article-title>Adaptation kinetics in bacterial chemotaxis</article-title>. <source>J Bacteriol</source> <volume>154</volume>: <fpage>312</fpage>–<lpage>323</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003276-Berry1"><label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Berry</surname><given-names>RM</given-names></name>, <name name-style="western"><surname>Armitage</surname><given-names>JP</given-names></name> (<year>2000</year>) <article-title>Response kinetics of tethered <italic>Rhodobacter sphaeroides</italic> to changes in light intensity</article-title>. <source>Biophys J</source> <volume>78</volume>: <fpage>1207</fpage>–<lpage>1215</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003276-Brown1"><label>42</label>
<mixed-citation publication-type="other" xlink:type="simple">Brown MT (2009). Control of the unidirectional motor in <italic>Rhodobacter sphaeroides</italic> [PhD dissertation]. Oxford: Department of Biochemistry, University of Oxford. 141 p. [<ext-link ext-link-type="uri" xlink:href="http://ora.ox.ac.uk/objects/uuid:1e9aa2bb-0e16-45df-9164-fd859a724157" xlink:type="simple">http://ora.ox.ac.uk/objects/uuid:1e9aa2bb-0e16-45df-9164-fd859a724157</ext-link>].</mixed-citation>
</ref>
<ref id="pcbi.1003276-Packer1"><label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Packer</surname><given-names>HL</given-names></name>, <name name-style="western"><surname>Lawther</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Armitage</surname><given-names>JP</given-names></name> (<year>1997</year>) <article-title>The <italic>Rhodobacter sphaeroides</italic> flagellar motor is a variable-speed rotor</article-title>. <source>FEBS Lett</source> <volume>409</volume>: <fpage>37</fpage>–<lpage>40</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003276-Watson1"><label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Watson</surname><given-names>GS</given-names></name> (<year>1961</year>) <article-title>Goodness-of-fit tests on a circle</article-title>. <source>Biometrika</source> <volume>48</volume>: <fpage>109</fpage>–<lpage>114</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003276-Frymier1"><label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Frymier</surname><given-names>PD</given-names></name>, <name name-style="western"><surname>Ford</surname><given-names>RM</given-names></name>, <name name-style="western"><surname>Berg</surname><given-names>HC</given-names></name>, <name name-style="western"><surname>Cummings</surname><given-names>PT</given-names></name> (<year>1995</year>) <article-title>Three-dimensional tracking of motile bacteria near a solid planar surface</article-title>. <source>PNAS</source> <volume>92</volume>: <fpage>6195</fpage>–<lpage>6199</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003276-Berg2"><label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Berg</surname><given-names>HC</given-names></name>, <name name-style="western"><surname>Turner</surname><given-names>L</given-names></name> (<year>1990</year>) <article-title>Chemotaxis of bacteria in glass capillary arrays. <italic>Rhodobacter sphaeroides</italic>, motility, microchannel plate, and light scattering</article-title>. <source>Biophys J</source> <volume>58</volume>: <fpage>919</fpage>–<lpage>930</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003276-Mio1"><label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Miño</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Mallouk</surname><given-names>TE</given-names></name>, <name name-style="western"><surname>Darnige</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Hoyos</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Dauchet</surname><given-names>J</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Enhanced diffusion due to active swimmers at a solid surface</article-title>. <source>Phys Rev Lett</source> <volume>106</volume>: <fpage>48102+</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003276-Parkinson1"><label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Parkinson</surname><given-names>JS</given-names></name> (<year>1987</year>) <article-title>Doing behavioral genetics with bacteria</article-title>. <source>Genetics</source> <volume>116</volume>: <fpage>499</fpage>–<lpage>500</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003276-Takata1"><label>49</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Takata</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Fujimoto</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Amako</surname><given-names>K</given-names></name> (<year>1992</year>) <article-title>Isolation of nonchemotactic mutants of <italic>Campylobacter jejuni</italic> and their colonization of the mouse intestinal tract</article-title>. <source>Infect Immun</source> <volume>60</volume>: <fpage>3596</fpage>–<lpage>3600</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003276-Ely1"><label>50</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ely</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Gerardot</surname><given-names>CJ</given-names></name>, <name name-style="western"><surname>Fleming</surname><given-names>DL</given-names></name>, <name name-style="western"><surname>Gomes</surname><given-names>SL</given-names></name>, <name name-style="western"><surname>Frederikse</surname><given-names>P</given-names></name>, <etal>et al</etal>. (<year>1986</year>) <article-title>General nonchemotactic mutants of <italic>Caulobacter crescentus</italic></article-title>. <source>Genetics</source> <volume>114</volume>: <fpage>717</fpage>–<lpage>730</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003276-Cisneros1"><label>51</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cisneros</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Dombrowski</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Goldstein</surname><given-names>RE</given-names></name>, <name name-style="western"><surname>Kessler</surname><given-names>JO</given-names></name> (<year>2006</year>) <article-title>Reversal of bacterial locomotion at an obstacle</article-title>. <source>Phys Rev E</source> <volume>73</volume>.</mixed-citation>
</ref>
<ref id="pcbi.1003276-Polin1"><label>52</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Polin</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Tuval</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Drescher</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Gollub</surname><given-names>JP</given-names></name>, <name name-style="western"><surname>Goldstein</surname><given-names>RE</given-names></name> (<year>2009</year>) <article-title>Chlamydomonas swims with two gears in a eukaryotic version of run-and-tumble locomotion</article-title>. <source>Science</source> <volume>325</volume>: <fpage>487</fpage>–<lpage>490</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003276-Rosser1"><label>53</label>
<mixed-citation publication-type="other" xlink:type="simple">Rosser G (2013). Mathematical modelling and analysis of aspects of planktonic bacterial motility [PhD dissertation]. Oxford: Mathematical Institute, University of Oxford. 258 p.</mixed-citation>
</ref>
<ref id="pcbi.1003276-Mitchell1"><label>54</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mitchell</surname><given-names>JG</given-names></name>, <name name-style="western"><surname>Pearson</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Dillon</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Kantalis</surname><given-names>K</given-names></name> (<year>1995</year>) <article-title>Natural assemblages of marine bacteria exhibiting high-speed motility and large accelerations</article-title>. <source>Appl Env Microbiol</source> <volume>61</volume>: <fpage>4436</fpage>–<lpage>4440</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003276-Hill1"><label>55</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hill</surname><given-names>NA</given-names></name>, <name name-style="western"><surname>Häder</surname><given-names>DP</given-names></name> (<year>1997</year>) <article-title>A biased random walk model for the trajectories of swimming microorganisms</article-title>. <source>J Theor Biol</source> <volume>186</volume>: <fpage>503</fpage>–<lpage>526</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003276-Brown2"><label>56</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Brown</surname><given-names>DA</given-names></name>, <name name-style="western"><surname>Berg</surname><given-names>HC</given-names></name> (<year>1974</year>) <article-title>Temporal stimulation of chemotaxis in <italic>Escherichia coli</italic></article-title>. <source>Proc Natl Acad Sci USA</source> <volume>71</volume>: <fpage>1388</fpage>–<lpage>1392</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003276-Vigeant1"><label>57</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Vigeant</surname><given-names>MA</given-names></name>, <name name-style="western"><surname>Ford</surname><given-names>RM</given-names></name> (<year>1997</year>) <article-title>Interactions between motile <italic>Rhodobacter sphaeroides</italic> and glass in media with various ionic strengths, as observed with a three-dimensional-tracking microscope</article-title>. <source>Appl Environ Microbiol</source> <volume>63</volume>: <fpage>3474</fpage>–<lpage>3479</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003276-Sheng1"><label>58</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sheng</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Malkiel</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Katz</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Adolf</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Belas</surname><given-names>R</given-names></name>, <etal>et al</etal>. (<year>2007</year>) <article-title>Digital holographic microscopy reveals prey-induced changes in swimming behavior of predatory dinoflagellates</article-title>. <source>PNAS</source> <volume>104</volume>: <fpage>17512</fpage>–<lpage>17517</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003276-Armitage2"><label>59</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Armitage</surname><given-names>JP</given-names></name>, <name name-style="western"><surname>Macnab</surname><given-names>RM</given-names></name> (<year>1987</year>) <article-title>Unidirectional, intermittent rotation of the flagellum of <italic>Rhodobacter sphaeroides</italic></article-title>. <source>J Bacteriol</source> <volume>169</volume>: <fpage>514</fpage>–<lpage>518</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003276-Grisan1"><label>60</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Grisan</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Foracchia</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Ruggeri</surname><given-names>A</given-names></name> (<year>2008</year>) <article-title>A novel method for the automatic grading of retinal vessel tortuosity</article-title>. <source>IEEE Trans Med Imaging</source> <volume>27</volume>: <fpage>310</fpage>–<lpage>319</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003276-Lewiner1"><label>61</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lewiner</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Gomes</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Lopes</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Craizer</surname><given-names>M</given-names></name> (<year>2005</year>) <article-title>Curvature and torsion estimators based on parametric curve fitting</article-title>. <source>Comput Graph</source> <volume>29</volume>: <fpage>641</fpage>–<lpage>655</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003276-Packer2"><label>62</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Packer</surname><given-names>HL</given-names></name>, <name name-style="western"><surname>Gauden</surname><given-names>DE</given-names></name>, <name name-style="western"><surname>Armitage</surname><given-names>JP</given-names></name> (<year>1996</year>) <article-title>The behavioural response of anaerobic <italic>Rhodobacter sphaeroides</italic> to temporal stimuli</article-title>. <source>Microbiol</source> <volume>142</volume>: <fpage>593</fpage>–<lpage>599</lpage>.</mixed-citation>
</ref>
</ref-list></back>
</article>