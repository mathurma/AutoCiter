<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN"><front><journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="publisher">pcbi</journal-id><journal-id journal-id-type="flc">plcb</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher><publisher-name>Public Library of Science</publisher-name><publisher-loc>San Francisco, USA</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.1371/journal.pcbi.0020051</article-id><article-id pub-id-type="publisher-id">05-PLCB-RA-0268R2</article-id><article-id pub-id-type="sici">plcb-02-05-09</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline"><subject>Computational Biology</subject><subject>Genetics and Genomics/Gene Expression</subject><subject>Computational Biology/Systems Biology</subject></subj-group><subj-group subj-group-type="System Taxonomy"><subject>Drosophila</subject></subj-group></article-categories><title-group><article-title>Reverse Engineering the Gap Gene Network of <named-content content-type="genus-species" xlink:type="simple">Drosophila melanogaster</named-content> </article-title><alt-title alt-title-type="running-head">Reverse Engineering the Gap Gene Network</alt-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Perkins</surname><given-names>Theodore J</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Jaeger</surname><given-names>Johannes</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff3"><sup>3</sup></xref><xref ref-type="fn" rid="n105"><sup>¤</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Reinitz</surname><given-names>John</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff3"><sup>3</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Glass</surname><given-names>Leon</given-names></name><xref ref-type="aff" rid="aff4"><sup>4</sup></xref></contrib></contrib-group><aff id="aff1">
				<label>1</label><addr-line> McGill Centre for Bioinformatics, McGill University, Montreal, Quebec, Canada
			</addr-line></aff><aff id="aff2">
				<label>2</label><addr-line> Department of Applied Mathematics and Statistics, Stony Brook University, Stony Brook, New York, United States of America
			</addr-line></aff><aff id="aff3">
				<label>3</label><addr-line> Center for Developmental Genetics, Stony Brook University, Stony Brook, New York, United States of America
			</addr-line></aff><aff id="aff4">
				<label>4</label><addr-line> Centre for Nonlinear Dynamics, Department of Physiology, McGill University, Montreal, Quebec, Canada
			</addr-line></aff><contrib-group><contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Bryant</surname><given-names>Barbara</given-names></name><role>Editor</role><xref ref-type="aff" rid="edit1"/></contrib></contrib-group><aff id="edit1">Millennium Pharmaceuticals, United States of America</aff><author-notes><fn fn-type="con" id="ack1"><p>TJP, JJ, JR, and LG analyzed the data. JJ contributed reagents/materials/analysis tools. TJP, JJ, JR, and LG wrote the paper.</p></fn><corresp id="cor1">* To whom correspondence should be addressed. E-mail: <email xlink:type="simple">perkins@mcb.mcgill.ca</email></corresp><fn fn-type="current-aff" id="n105"><p>¤ Current address: Department of Zoology, University of Cambridge, Cambridge, United Kingdom</p></fn><fn fn-type="conflict" id="n106"><p> The authors have declared that no competing interests exist.</p></fn></author-notes><pub-date pub-type="ppub"><month>5</month><year>2006</year></pub-date><pub-date pub-type="epub"><day>19</day><month>5</month><year>2006</year></pub-date><volume>2</volume><issue>5</issue><elocation-id>e51</elocation-id><history><date date-type="received"><day>20</day><month>12</month><year>2005</year></date><date date-type="accepted"><day>30</day><month>3</month><year>2006</year></date></history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2006</copyright-year><copyright-holder>Perkins et al</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract><p>A fundamental problem in functional genomics is to determine the structure and dynamics of genetic networks based on expression data. We describe a new strategy for solving this problem and apply it to recently published data on early <named-content content-type="genus-species" xlink:type="simple">Drosophila melanogaster</named-content> development. Our method is orders of magnitude faster than current fitting methods and allows us to fit different types of rules for expressing regulatory relationships. Specifically, we use our approach to fit models using a smooth nonlinear formalism for modeling gene regulation (gene circuits) as well as models using logical rules based on activation and repression thresholds for transcription factors. Our technique also allows us to infer regulatory relationships de novo or to test network structures suggested by the literature. We fit a series of models to test several outstanding questions about gap gene regulation, including regulation of and by <italic>hunchback</italic> and the role of autoactivation. Based on our modeling results and validation against the experimental literature, we propose a revised network structure for the gap gene system. Interestingly, some relationships in standard textbook models of gap gene regulation appear to be unnecessary for or even inconsistent with the details of gap gene expression during wild-type development.</p></abstract><abstract abstract-type="synopsis"><title>Synopsis</title><p>Modeling dynamical systems involves determining which elements of the system interact with which, and what is the nature of the interaction. In the context of modeling gene expression dynamics, this question equates to determining regulatory relationships between genes. Perkins and colleagues present a new computational method for fitting differential equation models of time series data, and apply it to expression data from the well-known segmentation network of <italic>Drosophila melanogaster.</italic> The method is orders of magnitude faster than other approaches that produce fits of comparable quality, such as Simulated Annealing. The authors show that it is possible to detect interactions de novo as well as to test existing regulatory hypotheses, and they propose a revised network structure for the gap gene system, based on their modeling efforts and on other experimental literature.</p></abstract><funding-group><funding-statement>This work was supported in part by a grant from the NSERC of Canada (LG), and by the US National Science Foundation under a grant awarded in 2002 (TJP). JJ and JR were supported by grant RR07801 from the US NIH.</funding-statement></funding-group><counts><page-count count="12"/></counts><!--===== Restructure custom-meta-wrap to custom-meta-group =====--><custom-meta-group><custom-meta><meta-name>citation</meta-name><meta-value>Perkins TJ, Jaeger J, Reinitz J, Glass L (2006) Reverse engineering the gap gene network of <named-content content-type="genus-species" xlink:type="simple">Drosophila melanogaster</named-content>. PLoS Comput Biol 2(5): e51. DOI: <ext-link ext-link-type="doi" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.0020051" xlink:type="simple">10.1371/journal.pcbi.0020051</ext-link></meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1"><title>Introduction</title><p>The segmented body pattern of <named-content content-type="genus-species" xlink:type="simple">Drosophila melanogaster</named-content> is established by the expression of segmentation genes during the blastoderm stage of development (reviewed in [<xref ref-type="bibr" rid="pcbi-0020051-b001">1</xref>,<xref ref-type="bibr" rid="pcbi-0020051-b002">2</xref>]). The polarity of the embryo along its anterior–posterior (A–P) axis is established by maternal gradients of the Bicoid (Bcd), Hunchback (Hb), and Caudal (Cad) transcription factors (<xref ref-type="fig" rid="pcbi-0020051-g001">Figure 1</xref>A–<xref ref-type="fig" rid="pcbi-0020051-g001">1</xref>C). The trunk gap genes, <italic>hunchback (hb), Krüppel (Kr)</italic>, <italic>knirps (kni),</italic> and <italic>giant (gt),</italic> are among the earliest targets of these maternal gradients. They show broad, overlapping expression domains (<xref ref-type="fig" rid="pcbi-0020051-g001">Figure 1</xref>E–<xref ref-type="fig" rid="pcbi-0020051-g001">1</xref>H). Gap genes together with maternal factors then regulate the expression of downstream targets, such as pair-rule and segment-polarity genes, which establish the segmental periodicity of the <italic>Drosophila</italic> body plan.</p><fig id="pcbi-0020051-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0020051.g001</object-id><label>Figure 1</label><caption><title>Maternal and Gap Gene Expression</title><p>(A–C) <italic>Drosophila</italic> embryos at early blastoderm stage (cleavage cycle 13) fluorescently stained for Bcd (A), Cad (B), and Hb (C) protein.</p><p>(D–H) <italic>Drosophila</italic> embryos at late blastoderm stage (late cleavage cycle 14A) fluorescently stained for Tll (D), Hb (E), Kr (F), Kni (G), and Gt (H) protein. Anterior is to the left, dorsal is up. Black bars indicate the A–P extent we model.</p><p>(I–L) Mean relative gap protein concentration as a function of A–P position (measured in percent embryo length) for Hb (I), Kr (J), Kni (K), and Gt(L). Expression levels are from images and are unitless, ranging from 0 to 255. Images and expression profiles are from the FlyEx database [<xref ref-type="bibr" rid="pcbi-0020051-b018">18</xref>]. Embryo IDs: bd3 (A,B), hz30 (C), tb6 (D), kf9 (E), kd17 (F), fq1 (G), nk5 (H).</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020051.g001" xlink:type="simple"/></fig><p>The gap gene network has been studied extensively by means such as the analysis of transcription factor binding sites on the DNA and the measurement of gene expression under wild-type and mutant conditions. These studies are the basis of qualitative regulatory models (e.g., [<xref ref-type="bibr" rid="pcbi-0020051-b003">3</xref>,<xref ref-type="bibr" rid="pcbi-0020051-b004">4</xref>]), which assert activating or repressing regulatory relationships between genes. These models provide a useful summary of the interactions within the network. However, ambiguities in the primary data can lead to different qualitative models. For example, if deleting a gene <italic>A</italic> results in decreased expression of a gene <italic>B,</italic> is <italic>A</italic> necessarily an activator of <italic>B</italic>? Or, could <italic>A</italic> be a repressor of some other gene <italic>C,</italic> which in turn represses <italic>B</italic>? This particular type of confusion has resulted in conflicting models of at least two relationships in the gap gene system, regarding the effect of Hb on <italic>Kr</italic> and the effect of Kr on <italic>kni</italic>. Qualitative models are also limited in that they usually do not specify precisely how conflicting regulatory signals (e.g., activation and repression) are resolved, leaving one without means for predicting the results of genetic or pharmacological interventions, for example. Further, qualitative models typically provide little or no explanation of the timing or dynamics of expression, which are key questions in processes such as development.</p><p>The increasing availability of quantitative gene expression data raises the possibility of detailed mathematical modeling of the regulatory relationships between genes. Indeed, recent work has shown that model parameters and even the existence of regulatory relationships can be automatically inferred from expression time series data [<xref ref-type="bibr" rid="pcbi-0020051-b005">5</xref>–<xref ref-type="bibr" rid="pcbi-0020051-b009">9</xref>]. Quantitative models can sometimes resolve ambiguities in qualitative models, offer much more specific predictions, and allow in-depth analysis of temporal changes in expression and the dynamical roles of regulatory relationships. For example, recent work on the gap gene system [<xref ref-type="bibr" rid="pcbi-0020051-b006">6</xref>] has highlighted previously unappreciated effects of known regulatory relationships in shifting the expression domains of <italic>Kr, kni,</italic> and <italic>gt</italic>.</p><p>Unfortunately, fitting quantitative dynamical models can be computationally challenging. Only two techniques [<xref ref-type="bibr" rid="pcbi-0020051-b005">5</xref>,<xref ref-type="bibr" rid="pcbi-0020051-b010">10</xref>–<xref ref-type="bibr" rid="pcbi-0020051-b012">12</xref>] have so far proven capable of fitting satisfactory models of the spatio–temporal segmentation gene expression data that we study, and both involve very long running times. Fitting all the models for the recent Jaeger et al. study [<xref ref-type="bibr" rid="pcbi-0020051-b006">6</xref>,<xref ref-type="bibr" rid="pcbi-0020051-b007">7</xref>], for example, which was done by parallel simulated annealing [<xref ref-type="bibr" rid="pcbi-0020051-b005">5</xref>,<xref ref-type="bibr" rid="pcbi-0020051-b010">10</xref>,<xref ref-type="bibr" rid="pcbi-0020051-b011">11</xref>], required an estimated 20,000 CPU hours, or approximately two CPU years. Because of these intensive computing requirements, alternative regulatory explanations were not explicitly explored, and it has not been established whether previously proposed regulatory models (e.g., [<xref ref-type="bibr" rid="pcbi-0020051-b003">3</xref>]) are equally capable of capturing the data. Long fitting times also make it difficult to explore alternative mathematical forms for the model. Gene regulation is an enormously complex process, and it is unclear in general how much of the biochemistry can be simplified away while retaining the key properties of the system. At a coarse level, the behavior of some genetic networks appears adequately captured by Boolean (on/off) models of gene expression [<xref ref-type="bibr" rid="pcbi-0020051-b013">13</xref>–<xref ref-type="bibr" rid="pcbi-0020051-b015">15</xref>]. However, detailed analysis of some genes has revealed more complex behavior which may well be functionally relevant [<xref ref-type="bibr" rid="pcbi-0020051-b016">16</xref>,<xref ref-type="bibr" rid="pcbi-0020051-b017">17</xref>]. Thus, it is advantageous to be able to easily experiment with different forms of models.</p><p>We use a novel strategy for fitting network models to spatio–temporal gene expression data that is compatible with a variety of modeling formalisms and, by combining function approximation techniques with simulation-based optimization, is vastly faster than previous methods [<xref ref-type="bibr" rid="pcbi-0020051-b005">5</xref>,<xref ref-type="bibr" rid="pcbi-0020051-b010">10</xref>–<xref ref-type="bibr" rid="pcbi-0020051-b012">12</xref>]. The increased efficiency of the algorithm enables the fitting of many more models, allowing us to explore alternative modeling formalisms and assumptions about regulatory relationships between genes. We applied this strategy to fit four models to gap gene expression data [<xref ref-type="bibr" rid="pcbi-0020051-b018">18</xref>]. Together, these models demonstrate different modeling formalisms and address alternative regulatory explanations for gap gene expression. Specifically, we show that both a smooth nonlinear representation of gene regulation (gene circuits [<xref ref-type="bibr" rid="pcbi-0020051-b005">5</xref>–<xref ref-type="bibr" rid="pcbi-0020051-b007">7</xref>]) and a discontinuous logical formalism based on activation and repression thresholds are capable of reproducing the observed gap gene expression dynamics, and that such models can efficiently be fit to the data. We show that it is possible to infer the activating and repressing relationships between genes directly from the data, as well as to test specific network structures, namely the model of Rivera-Pomar and Jäckle [<xref ref-type="bibr" rid="pcbi-0020051-b003">3</xref>]. We find that the Rivera-Pomar and Jäckle model does not correctly capture all the major features of gap gene expression and requires additional regulatory links. Further, our optimizations consistently eliminate certain links in the Rivera-Pomar and Jäckle model, suggesting that those links are incorrect. (In <xref ref-type="supplementary-material" rid="pcbi-0020051-sd001">Protocol S1</xref>, we also report on fits using the more recent but similar Sanchez and Thieffry network structure [<xref ref-type="bibr" rid="pcbi-0020051-b004">4</xref>], and find similar conclusions.) We summarize our findings in a Combined network model that includes a core of regulatory relationships found in all of our models in addition to regulatory relationships that are supported by some models and that are consistent with other experimental work.</p></sec><sec id="s2"><title>Results/Discussion</title><sec id="s2a"><title>Modeling Gap Gene Expression Dynamics</title><p>Gap gene expression is established in the trunk region of the embryo, indicated by the black bars in <xref ref-type="fig" rid="pcbi-0020051-g001">Figure 1</xref>, during cleavage cycles 13 and 14A (before cellularization), a span of approximately 70 min. We model the wild-type expression of the four trunk gap genes, <italic>hb, Kr, kni,</italic> and <italic>gt</italic> (<xref ref-type="fig" rid="pcbi-0020051-g001">Figure 1</xref>C and <xref ref-type="fig" rid="pcbi-0020051-g001">1</xref>E–<xref ref-type="fig" rid="pcbi-0020051-g001">1</xref>H). We do not model the expression of <italic>bcd, cad,</italic> or <italic>tailless (tll),</italic> a terminal gap gene (<xref ref-type="fig" rid="pcbi-0020051-g001">Figure 1</xref>A, <xref ref-type="fig" rid="pcbi-0020051-g001">1</xref>B, and 1D). However, we allow the observed expression values for these genes to act as regulatory input to our models of the trunk gap genes. Expression of these genes is largely invariant along the dorsal–ventral axis of the embryo. Thus, we model expression as a function of time and of position along the A–P axis (<xref ref-type="fig" rid="pcbi-0020051-g001">Figure 1</xref>I–<xref ref-type="fig" rid="pcbi-0020051-g001">1</xref>L). At the start of cleavage cycle 13, there is some <italic>hb</italic> expression in the anterior, due to maternally deposited <italic>hb</italic> mRNA. There is no unambiguously detectable expression for the other three gap genes. By the end of cleavage cycle 14A, there are six main gap expression peaks, two each for <italic>hb</italic> and <italic>gt</italic> and one each for <italic>Kr</italic> and <italic>kni</italic>.</p><p>We represent gap gene dynamics using a reaction–diffusion partial differential equation [<xref ref-type="bibr" rid="pcbi-0020051-b012">12</xref>]:</p><disp-formula id="pcbi-0020051-e001"><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020051.e001" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mfrac><mml:mrow><mml:mo>&part;</mml:mo><mml:msup><mml:mi>v</mml:mi><mml:mi>a</mml:mi></mml:msup><mml:mo stretchy='false'>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy='false'>)</mml:mo></mml:mrow><mml:mrow><mml:mo>&part;</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>&equals;</mml:mo><mml:mi>&zeta;</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:msup><mml:mi>P</mml:mi><mml:mi>a</mml:mi></mml:msup><mml:mo stretchy='false'>(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo stretchy='false'>)</mml:mo><mml:mo>&minus;</mml:mo><mml:msup><mml:mi>&lambda;</mml:mi><mml:mi>a</mml:mi></mml:msup><mml:msup><mml:mi>v</mml:mi><mml:mi>a</mml:mi></mml:msup><mml:mo stretchy='false'>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>&plus;</mml:mo><mml:msup><mml:mi>D</mml:mi><mml:mi>a</mml:mi></mml:msup><mml:mfrac><mml:mrow><mml:msup><mml:mo>&part;</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>v</mml:mi><mml:mi>a</mml:mi></mml:msup><mml:mo stretchy='false'>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy='false'>)</mml:mo></mml:mrow><mml:mrow><mml:mo>&part;</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math> --></disp-formula><p>where <italic>v<sup>a</sup></italic>(<italic>x</italic>,<italic>t</italic>) denotes the relative concentration of gap protein a (unitless, ranging from 0 to 255) at space point <italic>x</italic> (from 35% to 92% of embryo length) and time <italic>t</italic> (0 min to 68 min after the start of cleavage cycle 13). The three terms on the right-hand side account for production, decay, and diffusion of protein, respectively. <italic>λ<sup>a</sup></italic> and <italic>D<sup>a</sup></italic> are decay and diffusion rates. The model combines the processes of transcription and translation into a single production process. <italic>P<sup>a</sup></italic> specifies the production rate of protein <italic>a,</italic> as a function of the vector of concentrations of all proteins (including Bcd, Cad, and Tll) at the same point in space and time, <italic>v</italic>(<italic>x</italic>,<italic>t</italic>). The factor <italic>ζ</italic>(<italic>t</italic>) accounts for changes in transcribing gene density, due to the shutdown of transcription during mitosis [<xref ref-type="bibr" rid="pcbi-0020051-b019">19</xref>] and due to the doubling of nuclei (see <xref ref-type="sec" rid="s3">Materials and Methods</xref> for details).</p><p>We fit a total of four models, resulting from two different choices for the form of the production rate functions, <italic>P<sup>a</sup>,</italic> and two different sets of constraints on the regulatory relationships between genes. The first model uses a gene circuit formalism identical to the one used by Jaeger et al. [<xref ref-type="bibr" rid="pcbi-0020051-b006">6</xref>,<xref ref-type="bibr" rid="pcbi-0020051-b007">7</xref>] for the production rate functions.</p><disp-formula id="pcbi-0020051-e002"><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020051.e002" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:msup><mml:mi>P</mml:mi><mml:mi>a</mml:mi></mml:msup><mml:mo stretchy='false'>(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo stretchy='false'>)</mml:mo><mml:mo>&equals;</mml:mo><mml:msup><mml:mi>R</mml:mi><mml:mi>a</mml:mi></mml:msup><mml:mi>g</mml:mi><mml:mrow><mml:mo stretchy='true'>(</mml:mo><mml:mrow><mml:mstyle displaystyle='true'><mml:munder><mml:mo>&sum;</mml:mo><mml:mi>b</mml:mi></mml:munder></mml:mstyle><mml:mtext>&thinsp;</mml:mtext><mml:msup><mml:mi>T</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mi>v</mml:mi><mml:mi>b</mml:mi></mml:msup><mml:mo stretchy='false'>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>&plus;</mml:mo><mml:msup><mml:mi>h</mml:mi><mml:mi>a</mml:mi></mml:msup></mml:mrow><mml:mo stretchy='true'>)</mml:mo></mml:mrow><mml:mtext>&thinsp;</mml:mtext><mml:mo>,</mml:mo></mml:mrow></mml:math> --></disp-formula><p>where <italic>R<sup>a</sup></italic> is the maximum production rate, <italic>b</italic> ranges over the seven genes {<italic>bcd, cad, hb, Kr, gt, kni, tll</italic>}, and <inline-formula id="pcbi-0020051-ex001"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020051.ex001" xlink:type="simple"/></inline-formula>
					. The regulatory weights, <italic>T<sup>ab</sup>,</italic> encode the effect protein <italic>b</italic> has on the production rate of protein <italic>a</italic>. If <italic>T<sup>ab</sup></italic> &gt; 0, then we interpret gene <italic>b</italic> as being an activator of gene <italic>a</italic>. If <italic>T<sup>ab</sup></italic> &lt; 0, then we say it is a repressor. We place no restrictions on the signs of the regulatory weights, so that the optimization determines the qualitative regulatory relationships between the genes. We call the resulting model Unc-GC, for unconstrained gene circuit. Following Jaeger et al. [<xref ref-type="bibr" rid="pcbi-0020051-b006">6</xref>,<xref ref-type="bibr" rid="pcbi-0020051-b007">7</xref>], we fix the bias, or offset, terms <italic>h<sup>a</sup></italic> = −3.5 for all <italic>a</italic>.
				</p><p>While our first model tests the feasibility of inferring regulatory relationships de novo, our second model tests the ability of an established regulatory model to reproduce the data. In our second gene circuit model, regulatory relationships are limited to those in the model of Rivera-Pomar and Jäckle [<xref ref-type="bibr" rid="pcbi-0020051-b003">3</xref>], with one exception. Rivera-Pomar and Jäckle did not consider the posterior <italic>hb</italic> domain, and their regulatory relationships cannot reproduce this domain (unpublished data). So, we added Tll activation of <italic>hb,</italic> which was sufficient to activate a posterior <italic>hb</italic> domain. We call this set of activation and repression relationships the RPJ network structure. The weights that represent these relationships are constrained to be positive or negative for relationships that are respectively activating or repressing. An additional complication in the RPJ network structure is that <italic>Kr</italic> is activated by low levels of Hb but repressed by high levels of Hb. We model this by allowing two weights for describing the effect of Hb on <italic>Kr</italic>—a positive weight that is multiplied by <italic>v<sup>hb</sup></italic>(<italic>x</italic>,<italic>t</italic>) and a negative weight that is multiplied by (<italic>v<sup>hb</sup></italic>(<italic>x</italic>,<italic>t</italic>))<sup>2</sup>/255. We call the resulting model RPJ-GC.</p><p>Previous analyses suggest that the general regulatory principle of the gap gene system is that genes are activated in broad regions by maternal gradients, but that repression from other gap genes can locally overwhelm general activation [<xref ref-type="bibr" rid="pcbi-0020051-b003">3</xref>,<xref ref-type="bibr" rid="pcbi-0020051-b007">7</xref>]. Our final two models rely on logical rules for the production rate functions that implement this general plan. Specifically, we assume that gap protein <italic>a</italic> is produced at rate <italic>R<sup>a</sup></italic> if at least one of its activators exceeds an activation threshold and none of its repressors exceed their repression thresholds. For example, the rule</p><disp-formula id="pcbi-0020051-e003"><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020051.e003" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:msup><mml:mi>P</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msup><mml:mo stretchy='false'>(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo stretchy='false'>)</mml:mo><mml:mo>&equals;</mml:mo><mml:mrow><mml:mo stretchy='true'>&lcub;</mml:mo><mml:mtable columnalign='left'><mml:mtr><mml:mtd><mml:msup><mml:mi>R</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msup><mml:mtext>&emsp;if&thinsp;</mml:mtext><mml:mo stretchy='false'>(</mml:mo><mml:mo stretchy='false'>(</mml:mo><mml:msup><mml:mi>v</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>c</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msup><mml:mo stretchy='false'>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>&ge;</mml:mo><mml:mn>20</mml:mn><mml:mo stretchy='false'>)</mml:mo><mml:mtext>&thinsp;or&thinsp;</mml:mtext><mml:mo stretchy='false'>(</mml:mo><mml:msup><mml:mi>v</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msup><mml:mo stretchy='false'>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>&ge;</mml:mo><mml:mn>90</mml:mn><mml:mo stretchy='false'>)</mml:mo><mml:mo stretchy='false'>)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext>&thinsp;and&thinsp;&thinsp;</mml:mtext><mml:mo stretchy='false'>(</mml:mo><mml:msup><mml:mi>v</mml:mi><mml:mrow><mml:mi>K</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msup><mml:mo stretchy='false'>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>&le;</mml:mo><mml:mn>140</mml:mn><mml:mo stretchy='false'>)</mml:mo><mml:mtext> </mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width='-8.6pc'/><mml:mn>0</mml:mn><mml:mtext>&emsp;otherwise</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:math> --></disp-formula><p>states that Bcd is an activator of <italic>hb, hb</italic> is autoactivating, and Kr is a repressor. If there is enough Bcd or Hb and not too much Kr, as determined by the activation and repression thresholds, then there is production of Hb at the rate <italic>R<sup>hb</sup></italic>.</p><p>For our logical models, fitting the production rate functions means finding values for the <italic>R<sup>a</sup></italic> and for the activation and repression thresholds. We do not attempt to optimize which relationships are activating and which are repressing, although the optimization can change a threshold so that the activating or repressing effect is effectively eliminated. Our Unc-Logic model employs the regulatory structure discovered by our unconstrained gene circuit fit, except that we remove Gt activation of <italic>hb</italic> and Kni activation of <italic>gt</italic> (see <xref ref-type="sec" rid="s3">Materials and Methods</xref> for justification). Our RPJ-Logic model uses the RPJ regulatory relationships.</p></sec><sec id="s2b"><title>Model Fitting</title><p>We fit all four models using the same general strategy outlined in <xref ref-type="fig" rid="pcbi-0020051-g002">Figure 2</xref> and described in greater detail in Materials and Methods and <xref ref-type="supplementary-material" rid="pcbi-0020051-sd002">Protocol S2</xref>. In short, the strategy has three stages. Stage 1 produces an initial estimate of the decay and diffusion parameters for each gene and the spatial and temporal extents of protein production associated with each expression domain, without any regulatory explanation (<xref ref-type="fig" rid="pcbi-0020051-g002">Figure 2</xref>A and <xref ref-type="fig" rid="pcbi-0020051-g002">2</xref>B). Stage 2 produces an initial estimate of the regulatory parameters by attempting to fit the estimated protein production rate at each space–time point (from Stage 1) in terms of the observed protein levels present (<xref ref-type="fig" rid="pcbi-0020051-g002">Figure 2</xref>C). In Stage 3, all model parameters are optimized using a local search procedure, starting from the initial regulatory, decay, and diffusion parameter estimates produced in the first two stages. The optimization approach we use in the third stage is much simpler than the approach used by Jaeger et al. [<xref ref-type="bibr" rid="pcbi-0020051-b005">5</xref>–<xref ref-type="bibr" rid="pcbi-0020051-b007">7</xref>,<xref ref-type="bibr" rid="pcbi-0020051-b010">10</xref>,<xref ref-type="bibr" rid="pcbi-0020051-b011">11</xref>]. However, if the initial parameter estimates are sufficiently good, then it can produce results of comparable quality and can do so relatively quickly.</p><fig id="pcbi-0020051-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0020051.g002</object-id><label>Figure 2</label><caption><title>Outline of the Optimization Approach</title><p>In Stage 1, protein production associated to each domain is assumed to fall within a quadrilateral-shaped region of space–time (A) (darkness indicates rate of production), whose boundaries are optimized so that simulated expression (B) matches observed data (<xref ref-type="fig" rid="pcbi-0020051-g003">Figure 3</xref>B).</p><p>In Stage 2, regulatory parameters are estimated by trying to fit the quadrilateral production regions (A) based on the observed levels of transcription factors present at each space–time point (C).</p><p>In Stage 3, local search, starting from the parameter values estimated in Stage 2, is used to optimize a fully coupled partial differential equation model of gene expression, so that simulated expression (<xref ref-type="fig" rid="pcbi-0020051-g003">Figure 3</xref>C–<xref ref-type="fig" rid="pcbi-0020051-g003">3</xref>F) matches observed expression (<xref ref-type="fig" rid="pcbi-0020051-g003">Figure 3</xref>B).</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020051.g002" xlink:type="simple"/></fig><fig id="pcbi-0020051-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0020051.g003</object-id><label>Figure 3</label><caption><title>Observed and Simulated Expression at Five Time Points</title><p>(A) Observed expression of <italic>bcd, cad,</italic> and <italic>tll,</italic> which are not modeled, but which are allowed to act as exogenous inputs to the trunk gap gene models.</p><p>(B) Observed expression of the trunk gap genes.</p><p>(C–F) Simulated expression produced by the models Unc-GC, Unc-Logic, RPJ-GC, and RPJ-Logic, respectively. The horizontal axis in each plot is A–P position, ranging from 35% to 92% of embryo length. The vertical axis represents relative protein concentration corresponding to fluorescence intensity from quantitative gene expression data [<xref ref-type="bibr" rid="pcbi-0020051-b018">18</xref>] (units arbitrary).</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020051.g003" xlink:type="simple"/></fig></sec><sec id="s2c"><title>Optimization Results</title><p>The observed expression data is shown in <xref ref-type="fig" rid="pcbi-0020051-g003">Figure 3</xref>A and <xref ref-type="fig" rid="pcbi-0020051-g003">3</xref>B. Simulated gap gene expression from our best-fitting models of each type is shown in <xref ref-type="fig" rid="pcbi-0020051-g003">Figure 3</xref>C–<xref ref-type="fig" rid="pcbi-0020051-g003">3</xref>F. The root mean squared errors (RMS error; see <xref ref-type="sec" rid="s3">Materials and Methods</xref>) of these models are, in order of best to worst, 12.29 (Unc-GC), 14.83 (Unc-Logic), 15.88 (RPJ-GC), and 21.91 (RPJ-Logic). The Unc-GC and Unc-Logic models reproduce all six expression domains in approximately the right locations and with approximately the right timing (<xref ref-type="fig" rid="pcbi-0020051-g003">Figure 3</xref>C and <xref ref-type="fig" rid="pcbi-0020051-g003">3</xref>D). The RPJ-Logic model suffers a major failure. It begins to form, but does not sustain, the posterior <italic>gt</italic> domain (<xref ref-type="fig" rid="pcbi-0020051-g003">Figure 3</xref>F). This accounts for much of the difference in RMS error between that model and the other four. The RPJ-GC model also contains a significant error, although it eventually reproduces all six domains. At the early time points, Kr production extends through the whole front of the embryo (<xref ref-type="fig" rid="pcbi-0020051-g003">Figure 3</xref>E, <italic>t</italic> = 11,24 min). Only later does repression from Hb eliminate production in the anterior, so that <italic>Kr</italic> is expressed in the correct region. The RPJ-GC model also creates a small erroneous <italic>Kr</italic> domain in the posterior half of the trunk (<xref ref-type="fig" rid="pcbi-0020051-g003">Figure 3</xref>E, <italic>t</italic> = 62 min). This is discussed further below.</p><sec id="s2c1"><title>Summary of regulatory mechanisms in the models.</title><p>The exact parameters for the best-fitting models of each type can be found in <xref ref-type="supplementary-material" rid="pcbi-0020051-sd003">Protocol S3</xref>. The qualitative relationships they represent, as well as the relationships in some previously published models, are summarized in <xref ref-type="fig" rid="pcbi-0020051-g004">Figure 4</xref>A. <xref ref-type="fig" rid="pcbi-0020051-g005">Figures 5</xref>–<xref ref-type="fig" rid="pcbi-0020051-g008">8</xref> provide detailed snapshots of the regulatory action between genes at different times. The models agree on many of the qualitative relationships between genes and never contradict each other, in the sense of one model claiming a relationship is activating while another claims it is repressing.</p><fig id="pcbi-0020051-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0020051.g004</object-id><label>Figure 4</label><caption><title>Regulatory Relationships in Our Models and Previously Published Models</title><p>(A) Qualitative regulatory relationships in our four models after optimization (Unc-Gc, Unc-Logic, RPJ-GC, and RPJ-Logic), a Combined model (see text for details), and the relationships posed by Rivera-Pomar and Jäckle (R-P &amp; J) [<xref ref-type="bibr" rid="pcbi-0020051-b003">3</xref>], Sanchez and Thieffry (S &amp; T) [<xref ref-type="bibr" rid="pcbi-0020051-b004">4</xref>], and Jaeger et al. [<xref ref-type="bibr" rid="pcbi-0020051-b006">6</xref>,<xref ref-type="bibr" rid="pcbi-0020051-b007">7</xref>]. “+” represents activation, “−” represents repression, “+−” represents activation at low levels of the regulator and repression at high levels, “·” represents no regulatory relationship. For Jaeger et al., “0” represents a regulatory relationship that was eliminated by optimization. For our models, we use “⊕” and “⊝” to denote activating and repressing relationships, respectively, that were eliminated by optimization. For the gene circuit models, a regulatory relationship was considered eliminated if the corresponding weight was 0.0001 or less in magnitude. For the logical models, an activation or repression term was considered to be eliminated if removing it resulted in no change in simulated expression.</p><p>(B) Diagram of the Combined network model. Boxes represent trunk gap gene domains, with endings “-a” or “-p” denoting the anterior and posterior domains, respectively, for <italic>hb</italic> and <italic>gt</italic>. Arrows (→) indicate activation while T-connectors (<inline-formula id="pcbi-0020051-ex009"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020051.ex009" xlink:type="simple"/></inline-formula>) represent repression.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020051.g004" xlink:type="simple"/></fig><fig id="pcbi-0020051-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0020051.g005</object-id><label>Figure 5</label><caption><title>Simulated Gap Gene Expression, Production, and Regulatory Effects in the Unc-GC Model</title><p>(A) Simulated expression at five of the 10 times for which we have observed data.</p><p>(B–E) Production rates of Hb, Kr, Gt, and Kni, respectively, as a fraction of maximum (black curve) along with the production rate that would result when individual regulatory inputs are removed (colored curves). For example, in the plot for Hb at time <italic>t</italic> = 62 min, the yellow curve below the black curve shows what the production rate of Hb would be if, at that moment, Hb autoactivation were removed from the model, and the red curve shows what the production rate would be if repression by Kni were removed.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020051.g005" xlink:type="simple"/></fig><fig id="pcbi-0020051-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0020051.g006</object-id><label>Figure 6</label><caption><title>Simulated Gap Gene Expression, Production, and Regulatory Effects in the Unc-Logic Model</title><p>In each plot in columns B–E, the black bar indicates the spatial extent of production. Colored bars above the black bar represent regions in which the corresponding activatory input is above threshold (at least one activator must be above threshold for production to occur). Colored bars below the black bar represent regions in which the corresponding repressive input is above threshold (production only occurs if no repressors are above threshold).</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020051.g006" xlink:type="simple"/></fig><fig id="pcbi-0020051-g007" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0020051.g007</object-id><label>Figure 7</label><caption><title>Simulated Gap Gene Expression, Production, and Regulatory Effects in the RPJ-GC Model</title></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020051.g007" xlink:type="simple"/></fig><fig id="pcbi-0020051-g008" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0020051.g008</object-id><label>Figure 8</label><caption><title>Simulated Gap Gene Expression, Production, and Regulatory Effects in the RPJ-Logic Model</title></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020051.g008" xlink:type="simple"/></fig><p><xref ref-type="fig" rid="pcbi-0020051-g004">Figure 4</xref> also includes a Combined network model and diagram, which represents our best estimate of the regulatory relationships in the real system. The Combined model includes a regulatory relationship if it was deemed significant in all of our models or if it was significant in it at least some of our models, performing a correct function, and is supported by other experimental evidence, such as binding site analysis or mutant or overexpression studies. Weights in a gene circuit model are considered insignificant if they are smaller than 0.0001 in magnitude. Terms in a logical model are considered insignificant if their removal results in no change in simulated expression. We adopted these stringent conditions on insignificance because we preferred to make decisions about weak/borderline interactions based on other experimental evidence rather than, for example, choosing some arbitrary threshold. (See the final paragraph of the <xref ref-type="sec" rid="s2c6">Results and Discussion</xref> section for more information.) The regulatory structure of the Combined model is itself sufficient to reproduce all six gap gene domains using either the gene circuit or logical formalisms for production rate functions (<xref ref-type="supplementary-material" rid="pcbi-0020051-sd004">Protocol S4</xref>). We first cite support for our Combined model, and then consider the results of the individual models in light of several outstanding questions about gap gene regulation.</p><p>The maternal proteins Bcd and Cad are largely responsible for activating the trunk gap genes, with Bcd being more important for the anterior domains and Cad more important for the posterior domains. Bcd is a primary activator of the anterior <italic>hb</italic> domain [<xref ref-type="bibr" rid="pcbi-0020051-b020">20</xref>,<xref ref-type="bibr" rid="pcbi-0020051-b021">21</xref>], the anterior <italic>gt</italic> domain [<xref ref-type="bibr" rid="pcbi-0020051-b022">22</xref>], and the <italic>Kr</italic> domain [<xref ref-type="bibr" rid="pcbi-0020051-b023">23</xref>,<xref ref-type="bibr" rid="pcbi-0020051-b024">24</xref>]. Cad activates posterior <italic>gt</italic> [<xref ref-type="bibr" rid="pcbi-0020051-b025">25</xref>]. The <italic>kni</italic> domain is present in <italic>bcd</italic> mutants and in <italic>cad</italic> mutants, but not in <italic>bcd</italic>;<italic>cad</italic> double mutants. This suggests redundant activation by the two maternal factors. Such redundant activation of <italic>kni</italic> is present in our Unc-GC model. For the other models, the optimization selected one or the other as activators, but not both. Tll is crucial for activating the posterior <italic>hb</italic> domain [<xref ref-type="bibr" rid="pcbi-0020051-b026">26</xref>–<xref ref-type="bibr" rid="pcbi-0020051-b028">28</xref>], while it represses <italic>Kr, kni,</italic> and <italic>gt,</italic> preventing their expression in the extreme posterior [<xref ref-type="bibr" rid="pcbi-0020051-b022">22</xref>,<xref ref-type="bibr" rid="pcbi-0020051-b029">29</xref>–<xref ref-type="bibr" rid="pcbi-0020051-b034">34</xref>]. All the regulatory relationships between the gap genes in our Combined model are repressive. The complementary gap gene pairs, <italic>hb</italic>–<italic>kni</italic> and <italic>Kr</italic>–<italic>gt</italic> are strongly mutually repressive [<xref ref-type="bibr" rid="pcbi-0020051-b022">22</xref>,<xref ref-type="bibr" rid="pcbi-0020051-b032">32</xref>,<xref ref-type="bibr" rid="pcbi-0020051-b035">35</xref>–<xref ref-type="bibr" rid="pcbi-0020051-b038">38</xref>], as was found in nearly all of our models. (Repression of <italic>hb</italic> by Kni is not part of the RPJ regulatory relationships, but our Unc-GC and Unc-Logic models included the link.) Our models also suggest that mutual repression between <italic>hb</italic> and <italic>Kr</italic> helps to set the boundary between those two domains [<xref ref-type="bibr" rid="pcbi-0020051-b038">38</xref>–<xref ref-type="bibr" rid="pcbi-0020051-b041">41</xref>]. A chain of repressive relationships, <italic>hb⊣gt⊣kni⊣Kr</italic> [<xref ref-type="bibr" rid="pcbi-0020051-b006">6</xref>,<xref ref-type="bibr" rid="pcbi-0020051-b007">7</xref>], causes the shifts in the <italic>Kr, kni,</italic> and posterior <italic>gt</italic> domains. Autoactivation by <italic>hb</italic> is well-established [<xref ref-type="bibr" rid="pcbi-0020051-b042">42</xref>], and there is also some evidence for autoactivation by <italic>Kr</italic> [<xref ref-type="bibr" rid="pcbi-0020051-b043">43</xref>] and <italic>gt</italic> [<xref ref-type="bibr" rid="pcbi-0020051-b022">22</xref>].</p></sec><sec id="s2c2"><title>Does Hb have a dual regulatory effect on <italic>Kr</italic>?</title><p>There is a long-running debate about whether or not low levels of Hb activate <italic>Kr</italic>. In <italic>hb</italic> mutants, the <italic>Kr</italic> domain expands anteriorly, suggesting that Hb represses <italic>Kr</italic> [<xref ref-type="bibr" rid="pcbi-0020051-b039">39</xref>]. However, <italic>Kr</italic> expression in these mutants is lower than in wild-type [<xref ref-type="bibr" rid="pcbi-0020051-b031">31</xref>] and expands posteriorly in embryos overexpressing Hb [<xref ref-type="bibr" rid="pcbi-0020051-b036">36</xref>]. Further, in embryos lacking Bcd and Hb, the <italic>Kr</italic> domain is absent, but can be restored in a dosage-dependent manner by reintroducing Hb [<xref ref-type="bibr" rid="pcbi-0020051-b044">44</xref>,<xref ref-type="bibr" rid="pcbi-0020051-b045">45</xref>]. These observations suggest that Hb activates <italic>Kr</italic>. It has been suggested, therefore, that low levels of Hb activate <italic>Kr</italic> while high levels repress it [<xref ref-type="bibr" rid="pcbi-0020051-b036">36</xref>,<xref ref-type="bibr" rid="pcbi-0020051-b044">44</xref>,<xref ref-type="bibr" rid="pcbi-0020051-b045">45</xref>]. An alternative explanation, however, is that the apparently activating effects of Hb are indirect, via Hb's repression of <italic>kni</italic> and Kni's repression of <italic>Kr</italic> [<xref ref-type="bibr" rid="pcbi-0020051-b007">7</xref>]. Optimization of the Unc-GC model, which could have resulted in activation or repression of <italic>Kr</italic> by Hb, but not both, resulted in repression (<xref ref-type="fig" rid="pcbi-0020051-g004">Figure 4</xref>A). The RPJ models allow for a dual effect, but activation by Hb was eliminated during optimization of the RPJ-Logic model. The RPJ-GC model retained functional activation and repression of <italic>Kr</italic> by Hb. However, <italic>Kr</italic> expression in this model is defective. <italic>Kr</italic> is not properly repressed in the anterior (<xref ref-type="fig" rid="pcbi-0020051-g003">Figure 3</xref>E, <italic>t</italic> = 11,24 min). Further, <italic>Kr</italic> is ectopically expressed in a small domain in the posterior of the embryo (<xref ref-type="fig" rid="pcbi-0020051-g003">Figure 3</xref>E, <italic>t</italic> = 62 min and <xref ref-type="fig" rid="pcbi-0020051-g007">Figure 7</xref>C, <italic>t</italic> = 62 min). Thus, our models provide no support for activation of <italic>Kr</italic> by Hb. The only support we find, which is crucial in all models except Unc-Logic and also consistent with the mutant and overexpression studies cited above, is for repression of <italic>Kr</italic> by Hb.</p></sec><sec id="s2c3"><title>What represses <italic>hb</italic> between the anterior and posterior domains?</title><p>Another point of disagreement in the literature is what prevents the expression of <italic>hb</italic> between its two domains. In the model of Rivera-Pomar and Jäckle [<xref ref-type="bibr" rid="pcbi-0020051-b003">3</xref>], repression by Kr is the explanation. Our RPJ models confirm that this mechanism is sufficient. Specifically, in these models Kr repression prevents <italic>hb</italic> expression just to the posterior of the anterior <italic>hb</italic> domain (<xref ref-type="fig" rid="pcbi-0020051-g007">Figures 7</xref>B and <xref ref-type="fig" rid="pcbi-0020051-g008">8</xref>B, <italic>t</italic> = 37,49,62 min). Between the <italic>Kr</italic> and posterior <italic>hb</italic> domains, there is no explicit repression of <italic>hb</italic>. Rather, Hb is not produced simply because of a lack of activating factors. In contrast, the models of Jaeger et al. [<xref ref-type="bibr" rid="pcbi-0020051-b006">6</xref>,<xref ref-type="bibr" rid="pcbi-0020051-b007">7</xref>] detected no effect of Kr and attributed repression solely to Kni. Our Unc-GC and Unc-Logic models found repression by Kni, but in addition to repression by Kr, not instead of it (<xref ref-type="fig" rid="pcbi-0020051-g005">Figures 5</xref>B and <xref ref-type="fig" rid="pcbi-0020051-g006">6</xref>B). Kr is more responsible for repression near the anterior <italic>hb</italic> domain and Kni is more responsible for repression near the posterior <italic>hb</italic> domain. This is consistent with observations of expression in mutant embryos. Embryos mutant for <italic>Kr</italic> show slight expansion of the anterior <italic>hb</italic> domain [<xref ref-type="bibr" rid="pcbi-0020051-b038">38</xref>], while <italic>kni</italic> embryos show expansion of the posterior <italic>hb</italic> domain [<xref ref-type="bibr" rid="pcbi-0020051-b039">39</xref>]. In <italic>Kr</italic>;<italic>kni</italic> double mutants, <italic>hb</italic> is completely derepressed between its two usual domains [<xref ref-type="bibr" rid="pcbi-0020051-b038">38</xref>]. This suggests, as seen in our Unc-GC and Unc-Logic models, that Kr and Kni are both repressors of <italic>hb</italic>, that their activity is redundant in the center of the trunk, and that Kr and Kni are the dominant repressors for setting the boundaries of the anterior and posterior domains, respectively. This interpretation was also favored by Jaeger et al. [<xref ref-type="bibr" rid="pcbi-0020051-b006">6</xref>,<xref ref-type="bibr" rid="pcbi-0020051-b007">7</xref>], on the basis of the mutant data, even though their models did not find repression by Kr.</p></sec><sec id="s2c4"><title>The posterior <italic>hb</italic> domain.</title><p>In all of our models, the posterior <italic>hb</italic> domain is activated by Tll and sustained by Tll and <italic>hb</italic> autoactivation (<xref ref-type="fig" rid="pcbi-0020051-g005">Figures 5</xref>–<xref ref-type="fig" rid="pcbi-0020051-g008">8</xref>B, <italic>t</italic> = 37,49,62 min). Rivera-Pomar and Jäckle [<xref ref-type="bibr" rid="pcbi-0020051-b003">3</xref>] did not consider the posterior <italic>hb</italic> domain, and did not include activation by Tll in their model. We added that link to the RPJ network structure because otherwise it was not possible to capture the posterior <italic>hb</italic> domain (unpublished data). The model of Jaeger et al. [<xref ref-type="bibr" rid="pcbi-0020051-b006">6</xref>,<xref ref-type="bibr" rid="pcbi-0020051-b007">7</xref>] captured the domain without Tll activation by substituting activation from <italic>cad</italic>. However, there is no confirming evidence for such an interaction. The absence of posterior <italic>hb</italic> in <italic>tll</italic> mutants [<xref ref-type="bibr" rid="pcbi-0020051-b026">26</xref>–<xref ref-type="bibr" rid="pcbi-0020051-b028">28</xref>] and the inability of our models to explain posterior <italic>hb</italic> by other means, leads us to believe the straightforward hypothesis that Tll activates posterior <italic>hb</italic>. Posterior <italic>hb</italic> is unique in that the domain begins to form later than the other five domains we model (<xref ref-type="fig" rid="pcbi-0020051-g003">Figure 3</xref>B, <italic>t</italic> = 37 min). In our RPJ models, this happens simply because high levels of Tll are needed to activate <italic>hb</italic>—levels that are reached only at about <italic>t</italic> = 30 min (<xref ref-type="fig" rid="pcbi-0020051-g003">Figure 3</xref>A, <italic>t</italic> = 24,37 min). The Unc-GC and Unc-Logic models also employ repression by Cad to slightly delay Hb production in the posterior (<xref ref-type="fig" rid="pcbi-0020051-g005">Figures 5</xref>B, <italic>t</italic> = 24 min, and 6B, <italic>t</italic> = 24 min). However, there is no confirming evidence for such repression, and we omit it from our Combined model.</p></sec><sec id="s2c5"><title>Shifting of the <italic>Kr, kni,</italic> and posterior <italic>gt</italic> domains.</title><p>Domain shifting was first observed by Jaeger et al. [<xref ref-type="bibr" rid="pcbi-0020051-b006">6</xref>,<xref ref-type="bibr" rid="pcbi-0020051-b007">7</xref>] and attributed to a chain of repressive regulatory relationships, <italic>hb⊣gt⊣kni⊣Kr</italic>. Our models largely support the importance of this regulatory chain, particularly the final two links. Repression of <italic>Kr</italic> by Kni was significant in all of our models (<xref ref-type="fig" rid="pcbi-0020051-g004">Figure 4</xref>A). Repression of <italic>kni</italic> by Gt was present in all models except RPJ-Logic, where it would be of little impact anyway, as RPJ-Logic has a defective posterior <italic>gt</italic> domain. Consistent with these findings, Kni binds to the regulatory region of <italic>Kr</italic> [<xref ref-type="bibr" rid="pcbi-0020051-b029">29</xref>], and the <italic>Kr</italic> domain expands towards the posterior in <italic>kni</italic> mutants [<xref ref-type="bibr" rid="pcbi-0020051-b039">39</xref>,<xref ref-type="bibr" rid="pcbi-0020051-b040">40</xref>]. Similarly, the <italic>kni</italic> domain expands posteriorly in <italic>gt</italic> mutants [<xref ref-type="bibr" rid="pcbi-0020051-b022">22</xref>], while embryos overexpressing <italic>gt</italic> show reduced <italic>kni</italic> expression [<xref ref-type="bibr" rid="pcbi-0020051-b035">35</xref>].</p><p>Repression of <italic>gt</italic> by Hb is not as well supported by our models. The Unc-GC model included the link, though the regulatory weight was the smallest of all those in the model (<xref ref-type="supplementary-material" rid="pcbi-0020051-sd003">Protocol S3</xref>). The link was eliminated from Unc-Logic and, of course, not present in the RPJ network structure. Instead, the models utilized decreasing activation by Cad (Unc-GC, Unc-Logic) and repression by Tll (Unc-GC, RPJ-GC) to shift the posterior <italic>gt</italic> domain (<xref ref-type="fig" rid="pcbi-0020051-g005">Figures 5</xref>–<xref ref-type="fig" rid="pcbi-0020051-g007">7</xref>D). Even with these links, however, shifting of the domain is not well-captured (<xref ref-type="fig" rid="pcbi-0020051-g003">Figure 3</xref>C, <xref ref-type="fig" rid="pcbi-0020051-g003">3</xref>D, and 3F). RPJ-GC appears to capture the posterior <italic>gt</italic> shift best (<xref ref-type="fig" rid="pcbi-0020051-g003">Figure 3</xref>E). However, it relies on its small ectopic <italic>Kr</italic> domain to repress <italic>gt,</italic> a completely incorrect mechanism (<xref ref-type="fig" rid="pcbi-0020051-g007">Figure 7</xref>D, <italic>t</italic> = 62 min). Interestingly, a gene circuit fit using the network structure of Sanchez and Thieffry [<xref ref-type="bibr" rid="pcbi-0020051-b004">4</xref>] (<xref ref-type="supplementary-material" rid="pcbi-0020051-sd001">Protocol S1</xref>), captured the shift of posterior <italic>gt</italic> better than any of our other models, and it did so using repression of <italic>gt</italic> by Hb, providing additional modeling support for the relationship. There also is strong mutant evidence in favor of the relationship. In <italic>hb</italic> mutants, the posterior <italic>gt</italic> domain does not retract from the posterior pole [<xref ref-type="bibr" rid="pcbi-0020051-b022">22</xref>,<xref ref-type="bibr" rid="pcbi-0020051-b032">32</xref>,<xref ref-type="bibr" rid="pcbi-0020051-b046">46</xref>]. Further, Gt is absent in embryos that have ubiquitous Hb, such as maternal <italic>oskar</italic> or <italic>nanos</italic> mutants [<xref ref-type="bibr" rid="pcbi-0020051-b022">22</xref>,<xref ref-type="bibr" rid="pcbi-0020051-b032">32</xref>] or embryos expressing Hb ubiquitously under a heat-shock promoter [<xref ref-type="bibr" rid="pcbi-0020051-b033">33</xref>]. Thus, we find sufficient evidence to include a repressive link from <italic>hb</italic> to <italic>gt</italic> in our Combined model.</p><p>Activating or repressing links that oppose the direction of the repressive chain were eliminated by optimization of the Unc-Logic, RPJ-GC, and RPJ-Logic models (<xref ref-type="fig" rid="pcbi-0020051-g004">Figure 4</xref>A). In agreement with this result, the boundaries of the <italic>kni</italic> and posterior <italic>gt</italic> domains are correctly positioned in <italic>Kr</italic> and <italic>kni</italic> mutants, respectively [<xref ref-type="bibr" rid="pcbi-0020051-b022">22</xref>,<xref ref-type="bibr" rid="pcbi-0020051-b031">31</xref>,<xref ref-type="bibr" rid="pcbi-0020051-b037">37</xref>,<xref ref-type="bibr" rid="pcbi-0020051-b046">46</xref>]. Thus, the simplest picture supported by our models and consistent with the mutant studies is that there is no regulation from <italic>Kr</italic>, <italic>kni,</italic> or posterior <italic>gt</italic> to any of their immediate posterior neighbors, and that the repressive chain highlighted by Jaeger et al. [<xref ref-type="bibr" rid="pcbi-0020051-b006">6</xref>,<xref ref-type="bibr" rid="pcbi-0020051-b007">7</xref>] is indeed responsible for domain shifting.</p></sec><sec id="s2c6"><title>Do gap genes autoregulate?</title><p>All four of our models include autoactivation by <italic>hb</italic>. This is supported by the observation that late anterior <italic>hb</italic> expression is absent in embryos lacking maternal and early zygotic Hb [<xref ref-type="bibr" rid="pcbi-0020051-b047">47</xref>]. Our models suggest <italic>hb</italic> autoactivation also plays a crucial role in sustaining the posterior domain, once it has been initiated by Tll (<xref ref-type="fig" rid="pcbi-0020051-g005">Figures 5</xref>–<xref ref-type="fig" rid="pcbi-0020051-g008">8</xref>B, <italic>t</italic> = 37–62), a role not previously emphasized. Autoactivation for the other genes was found by our Unc-GC model, but is not part of the RPJ network structure (<xref ref-type="fig" rid="pcbi-0020051-g004">Figure 4</xref>A). We included autoactivation only for <italic>Kr</italic> and <italic>gt</italic> in our Combined model, on the basis of a weakened and narrowed <italic>Kr</italic> domain in embryos producing defective <italic>Kr</italic> protein [<xref ref-type="bibr" rid="pcbi-0020051-b043">43</xref>] and a delay in <italic>gt</italic> expression in embryos producing defective <italic>gt</italic> protein [<xref ref-type="bibr" rid="pcbi-0020051-b022">22</xref>]. Interestingly, the gene circuit models of Jaeger et al. [<xref ref-type="bibr" rid="pcbi-0020051-b006">6</xref>,<xref ref-type="bibr" rid="pcbi-0020051-b007">7</xref>] also found autoactivation for all four gap genes, but they considered autoactivation by <italic>gt</italic> to be the weakest and least certain. In contrast, our Unc-Logic model retained <italic>gt</italic> autoactivation while eliminating autoactivation for <italic>Kr</italic> and <italic>kni</italic> (<xref ref-type="fig" rid="pcbi-0020051-g004">Figure 4</xref>A). The RPJ-Logic model was unable to reproduce the posterior <italic>gt</italic> domain. However, we found that by adding <italic>gt</italic> autoactivation to the model, it was able to create and sustain posterior <italic>gt</italic> correctly, bringing the error of the model down to 15.34 (unpublished data). This suggests that, after <italic>hb, gt</italic> is the most likely candidate for autoactivation. However, even this is not strictly necessary. The RPJ-GC model is able to reproduce and sustain the posterior <italic>gt</italic> domain without autoactivation by relying on cooperative activation from Bcd and Cad (<xref ref-type="fig" rid="pcbi-0020051-g007">Figure 7</xref>D).</p></sec></sec><sec id="s2d"><title>Conclusions</title><sec id="s2d1"><title>Comparison of regulatory architectures<italic>.</italic></title><p>The regulatory relationships proposed by Rivera-Pomar and Jäckle [<xref ref-type="bibr" rid="pcbi-0020051-b003">3</xref>] are not fully consistent with the data and require amending. Repression of <italic>gt</italic> by Kni, which contradicts the mechanism of domain shifts described by Jaeger et al. [<xref ref-type="bibr" rid="pcbi-0020051-b006">6</xref>,<xref ref-type="bibr" rid="pcbi-0020051-b007">7</xref>], was eliminated by the optimization in both of our models based on the RPJ regulators. We also never observed activation of <italic>kni</italic> by Kr. We found no support for a dual regulatory effect of Hb on <italic>Kr</italic>. Activation of <italic>Kr</italic> at low levels of Hb was eliminated in the RPJ-Logic model. It was retained in the RPJ-GC model, but resulted in serious patterning defects. Inclusion of Tll as an activator of <italic>hb</italic> was sufficient to produce the posterior <italic>hb</italic> domain. Based on our fits and the primary experimental literature, there are likely other regulatory links missing from the model of Rivera-Pomar and Jäckle, though they are not strictly required to reproduce the wild-type gap gene patterns. Foremost is repression of <italic>hb</italic> by Kni, which appears important for eliminating <italic>hb</italic> expression anterior of the posterior domain. Fits based on the Sanchez and Thieffry regulatory relationships [<xref ref-type="bibr" rid="pcbi-0020051-b004">4</xref>] (<xref ref-type="supplementary-material" rid="pcbi-0020051-sd001">Protocol S1</xref>) also support these conclusions.</p><p>In contrast, the regulatory relationships in our Combined model and both the Unc-GC and Unc-Logic models are able to capture the wild-type gap patterns without gross defects. The relationships in the Unc-GC model are very similar to those obtained by Jaeger et al. [<xref ref-type="bibr" rid="pcbi-0020051-b006">6</xref>,<xref ref-type="bibr" rid="pcbi-0020051-b007">7</xref>]. For example, the regulation of <italic>Kr</italic> and <italic>kni</italic> is qualitatively equivalent in both models, and there is a single minor difference in the regulation of <italic>gt</italic> (<xref ref-type="fig" rid="pcbi-0020051-g004">Figure 4</xref>A). Our optimizations correctly identified activation of <italic>hb</italic> by Tll, which was missed by Jaeger et al. [<xref ref-type="bibr" rid="pcbi-0020051-b006">6</xref>,<xref ref-type="bibr" rid="pcbi-0020051-b007">7</xref>], though our models did less well at capturing shifting of the posterior <italic>gt</italic> domain. These regulatory relationships are also similar to those found by Gursky et al. [<xref ref-type="bibr" rid="pcbi-0020051-b012">12</xref>], though that study was based on gap gene expression data with much lower accuracy and temporal resolution than the data used here [<xref ref-type="bibr" rid="pcbi-0020051-b005">5</xref>,<xref ref-type="bibr" rid="pcbi-0020051-b018">18</xref>]. These similarities show that differences in the mathematical formulations of these models—as ordinary versus partial differential equations, how diffusion and nuclei doubling are modeled, and choice of boundary conditions and other simulation parameters—are not important for the reproduction of the gap gene patterns nor for the inference of regulatory relationships from the data.</p></sec><sec id="s2d2"><title>Comparison of gene circuit and logical formalisms<italic>.</italic></title><p>Both of our gene circuit models fit the data better than the corresponding logical models. Although both types of models grossly simplify the complexity of gene regulation, this suggests that the gene circuit formalism is a better description of gap gene regulation than the logical formalism. However, the Unc-Logic model shows that the logical formalism can correctly capture the main features of gap gene expression. Of greater concern is that the strict on/off nature of the logical rules renders many regulatory inputs completely redundant, effectively eliminating them from the regulatory structure (<xref ref-type="fig" rid="pcbi-0020051-g004">Figures 4</xref>A, <xref ref-type="fig" rid="pcbi-0020051-g006">6</xref>, and 8). In sparsely connected gene networks, this may be a useful bias. In a densely connected network like the gap gene system, it results in the elimination of many correct regulatory links. Another serious drawback of the logical models is that we could not find a satisfactory method for inferring the regulatory structure as part of the optimization process. We were forced to set the activators and repressors in the Unc-Logic model from the Unc-GC findings, and were able only to optimize the strengths of the regulatory relationships, represented by the activation and repression thresholds. Resolving this problem is an important avenue for further work.</p></sec><sec id="s2d3"><title>Speed and accuracy of the fitting method<italic>.</italic></title><p>The RMS errors in simulated expression for the Jaeger et al. [<xref ref-type="bibr" rid="pcbi-0020051-b006">6</xref>,<xref ref-type="bibr" rid="pcbi-0020051-b007">7</xref>] model and our Unc-GC model are comparable, so both optimization algorithms are equally successful in fitting the models to the data (<xref ref-type="supplementary-material" rid="pcbi-0020051-sd005">Protocol S5</xref>). An important advantage of our technique, however, is speed. Each run of the algorithm used by Jaeger et al. [<xref ref-type="bibr" rid="pcbi-0020051-b005">5</xref>–<xref ref-type="bibr" rid="pcbi-0020051-b007">7</xref>,<xref ref-type="bibr" rid="pcbi-0020051-b010">10</xref>,<xref ref-type="bibr" rid="pcbi-0020051-b011">11</xref>] took approximately 3–10 days on a 10-processor machine, for a total of approximately two years of CPU time for their study. In contrast, it took on the order of a day or two to optimize each of our models, on a single-processor machine running unoptimized, uncompiled MATLAB code. The relative speed of our technique was crucial to our study because it allowed us to rapidly explore alternative modeling formalisms and to test specific network structures. The strength of our technique (see <xref ref-type="sec" rid="s3">Materials and Methods</xref>) lies in the approach it uses to produce initial estimates of the regulatory, decay, and diffusion parameters. With good initial estimates, the models can easily be fined-tuned by a straightforward search algorithm. Indeed, the simplicity of the procedures we used to solve each of the three stages speaks to the power of the decomposition. However, it is certainly possible to substitute other, more sophisticated methods for solving each stage. For example, Stage 2 comprises a set of function approximation problems, for which many fitting techniques are available. The optimization approach of Gursky et al. [<xref ref-type="bibr" rid="pcbi-0020051-b012">12</xref>] is quite fast when given a good starting point, and it would be interesting to use their algorithm for Stage 3 of our approach.</p></sec><sec id="s2d4"><title>Limitations of the models.</title><p>While our models, particularly Unc-GC, Unc-Logic, and the Combined model, capture the main features of gap gene expression dynamics, some failings are common to all the models. For example, none of the models capture well the shifting of the posterior <italic>gt</italic> domain (<xref ref-type="fig" rid="pcbi-0020051-g003">Figure 3</xref>). A gene circuit model based on the Sanchez and Thieffry regulatory relationships [<xref ref-type="bibr" rid="pcbi-0020051-b004">4</xref>] (<xref ref-type="supplementary-material" rid="pcbi-0020051-sd001">Protocol S1</xref>) does capture the shift, and by the expected mechanism, Hb repression of <italic>gt</italic>. However, the failure of the Unc-GC, Unc-Logic, and Combined models to capture the shift, despite including the necessary link, we can only attribute to imperfect optimization of the parameters. Our models also show defects in the early establishment of the domains, particularly the posterior <italic>gt</italic> domain (<xref ref-type="fig" rid="pcbi-0020051-g003">Figure 3</xref>C–<xref ref-type="fig" rid="pcbi-0020051-g003">3</xref>F, <italic>t</italic> = 11 min; similar defects were observed in [<xref ref-type="bibr" rid="pcbi-0020051-b007">7</xref>]). This may be because the data is sampled less often early on, and so the RMS error effectively puts less weight on the correctness of the models early on. It may also be due to our simplification of transcription and translation into a single production process with no delay. At the start of cleavage cycle 13, gap gene transcripts begin to accumulate in the absence of gap proteins (except the Hb from maternally deposited mRNA). Thus, there should be no regulation between gap genes during the first few minutes of the time series. Our models allow regulation from the start of the time series, and this may be impacting the early expression patterns. Finally, none of the models capture the late parasegment 4-specific expression stripe of the anterior <italic>hb</italic> domain. This is visible as a small peak on top of the main anterior <italic>hb</italic> peak (<xref ref-type="fig" rid="pcbi-0020051-g001">Figure 1</xref>I or <xref ref-type="fig" rid="pcbi-0020051-g003">Figure 3</xref>B, <italic>t</italic> = 62 min). This expression stripe is due to a second <italic>hb</italic> promoter, different from the promoter responsible for the rest of the anterior <italic>hb</italic> domain [<xref ref-type="bibr" rid="pcbi-0020051-b047">47</xref>]. It is likely that our gene circuit and logical models are simply incapable of capturing this phenomenon with a single production rate function, and would need to be generalized, perhaps by allowing <italic>hb</italic> production to be the sum of two separate production rate functions, to recreate the stripe.</p><p>Our models largely capture the wild-type expression patterns, and the regulatory relationships they rely on are consistent with mutant studies. However, our models do not in general display correct mutant expression patterns (see <xref ref-type="supplementary-material" rid="pcbi-0020051-sd006">Protocol S6</xref> for an example of simulating a <italic>Kr</italic> knockout mutant). The problem may point to a mismatch between biological reality and our modeling assumptions—for example, the mathematical forms of our production rate functions, our omission of production delays, or our treatment of protein concentrations as unitless numbers between 0 and 255. (Our expression data comes from images. Actual concentrations for the proteins are not known and may not even be of the same order of magnitude.) On the other hand, it is possible that the wild-type data to which the models were fit do not contain sufficient information to generalize to mutant organisms—although some gene circuit models fit to wild-type data do successfully predict mutant expression patterns [<xref ref-type="bibr" rid="pcbi-0020051-b048">48</xref>]. Our fitting approach allows for rapid testing of alternative modeling assumptions, which may lead to models with improved predictions of mutant expression patterns. However, an important question for future research is whether we can find a way to incorporate the wealth of already available mutant expression data—which is often qualitative and not as temporally resolved as our wild-type data—into our fitting procedure.</p><p>Our models, particularly the Unc-GC model, includes a number of weak regulatory relationships, the significance of which is difficult to determine. Some of the links may arise from overfitting the data, or they may be compensating for incorrect modeling assumptions or for other missing or imperfectly modeled regulatory factors. However, it is difficult to say precisely which links should be ignored. Our data comprises a single space–time series, with strong correlations between datapoints. Resampling approaches for estimating significance, such as cross-validation or bootstrapping, are not useful in such cases. Jaeger et al. [<xref ref-type="bibr" rid="pcbi-0020051-b007">7</xref>] deemed weights smaller in magnitude than a chosen threshold to be insignificant. However, the magnitudes of weights do not always reflect their importance to the model. For example, in the Unc-GC model, Tll activation of <italic>hb</italic> receives the smallest weight of any of <italic>hb'</italic>s regulators, and yet this link is crucial for the formation of the posterior <italic>hb</italic> domain. In contrast, some links that receive larger weights in the Unc-GC model are dispensible, as shown for example by the success of the RPJ-GC model at reproducing the <italic>hb</italic> expression patterns. For these reasons, we used stringent criteria for dismissing links based on modeling alone. (Gene circuit weights of magnitude less than 0.0001 and logical terms that have absolutely no effect on expression were discarded.) Instead, we turned to external validation, admitting links to our Combined model only if they are additionally supported by other experimental evidence. However, it is also possible that some of the weak links in the Unc-GC or other models are correct. Regulatory effects between the gap genes can be subtle. For example, some studies have found changes in <italic>kni</italic> expression in <italic>gt</italic> underexpression and overexpression conditions [<xref ref-type="bibr" rid="pcbi-0020051-b022">22</xref>,<xref ref-type="bibr" rid="pcbi-0020051-b035">35</xref>], while other studies did not detect any change [<xref ref-type="bibr" rid="pcbi-0020051-b033">33</xref>,<xref ref-type="bibr" rid="pcbi-0020051-b037">37</xref>]. Additional, careful quantitative measurements of gap gene expression in wild-type as well as mutant organisms will be necessary to resolve the existence of the weaker links in our models.</p></sec></sec></sec><sec id="s3"><title>Materials and Methods</title><sec id="s3a"><title>Quantitative gene expression data.</title><p>Quantitative gene expression data used in this study are available online in the FlyEx database <ext-link ext-link-type="uri" xlink:href="http://urchin.spbcas.ru/flyex" xlink:type="simple">http://urchin.spbcas.ru/flyex</ext-link> or <ext-link ext-link-type="uri" xlink:href="http://flyex.ams.sunysb.edu/flyex" xlink:type="simple">http://flyex.ams.sunysb.edu/flyex</ext-link> [<xref ref-type="bibr" rid="pcbi-0020051-b018">18</xref>]. Methods for data acquisition and processing are described in detail elsewhere [<xref ref-type="bibr" rid="pcbi-0020051-b049">49</xref>–<xref ref-type="bibr" rid="pcbi-0020051-b052">52</xref>]. The data include quantitative wild-type concentration profiles for the protein products of <italic>bcd, cad, hb, Kr, kni, gt,</italic> and <italic>tll</italic> during cleavage cycles 13 and 14A, which constitute the late syncytial blastoderm stage of <italic>Drosophila</italic> development [<xref ref-type="bibr" rid="pcbi-0020051-b053">53</xref>,<xref ref-type="bibr" rid="pcbi-0020051-b054">54</xref>]. This covers a time of approximately 70 min between the first unambiguous detection of gap protein [<xref ref-type="bibr" rid="pcbi-0020051-b007">7</xref>] and the onset of gastrulation [<xref ref-type="bibr" rid="pcbi-0020051-b054">54</xref>]. Expression data from cleavage cycle 12 are used for the initial concentration of Hb at <italic>t</italic> = 0. Initial concentrations of Kr, Kni, and Gt are zero. The data represent expression at ten times, two during cleavage cycle 13 (<italic>t</italic> = 0 and 11 min) and eight during cleavage cycle 14A (<italic>t</italic> = 24,30,37,43,49,55,62, and 68 min). These times differ slightly from the ones used in [<xref ref-type="bibr" rid="pcbi-0020051-b007">7</xref>], because we use a fixed time step of one minute for simulating our models (see below). The exact data are available as <xref ref-type="supplementary-material" rid="pcbi-0020051-sd007">Dataset S1</xref>.</p></sec><sec id="s3b"><title>Model-fitting strategy.</title><p>Here we describe our three-stage approach to fitting the parameters of the partial differential equations. Details of how this strategy was applied for each model can be found in <xref ref-type="supplementary-material" rid="pcbi-0020051-sd002">Protocol S2</xref>. The ultimate goal is to produce a partial differential equation model [<xref ref-type="bibr" rid="pcbi-0020051-b012">12</xref>]:</p><disp-formula id="pcbi-0020051-e004"><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020051.e004" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mfrac><mml:mrow><mml:mo>&part;</mml:mo><mml:msup><mml:mi>v</mml:mi><mml:mi>a</mml:mi></mml:msup><mml:mo stretchy='false'>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy='false'>)</mml:mo></mml:mrow><mml:mrow><mml:mo>&part;</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>&equals;</mml:mo><mml:mi>&zeta;</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:msup><mml:mi>P</mml:mi><mml:mi>a</mml:mi></mml:msup><mml:mo stretchy='false'>(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>,</mml:mo><mml:msup><mml:mi>&Thetas;</mml:mi><mml:mi>a</mml:mi></mml:msup><mml:mo stretchy='false'>)</mml:mo><mml:mo>&minus;</mml:mo><mml:msup><mml:mi>&lambda;</mml:mi><mml:mi>a</mml:mi></mml:msup><mml:msup><mml:mi>v</mml:mi><mml:mi>a</mml:mi></mml:msup><mml:mo stretchy='false'>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>&plus;</mml:mo><mml:msup><mml:mi>D</mml:mi><mml:mi>a</mml:mi></mml:msup><mml:mfrac><mml:mrow><mml:msup><mml:mo>&part;</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>v</mml:mi><mml:mi>a</mml:mi></mml:msup><mml:mo stretchy='false'>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy='false'>)</mml:mo></mml:mrow><mml:mrow><mml:mo>&part;</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mtext>&thinsp;</mml:mtext><mml:mo>.</mml:mo></mml:mrow></mml:math> --></disp-formula><p>This is essentially the same as Equation 1, except that we have made explicit the regulatory parameters Θ<italic><sup>a</sup></italic> that need to be optimized. Θ<italic><sup>a</sup></italic> comprises <italic>R<sup>a</sup></italic> and either the weights of a gene circuit model or thresholds of a logical model. The term <italic>ζ</italic>(<italic>t</italic>) models the doubling of nuclei and shutdown of transcription during mitosis as follows.</p><disp-formula id="pcbi-0020051-e005"><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020051.e005" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mi>&zeta;</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>&equals;</mml:mo><mml:mrow><mml:mo stretchy='true'>&lcub;</mml:mo> <mml:mtable columnalign='left'><mml:mtr><mml:mtd><mml:mspace width="-.35pc"/><mml:mn>0.5</mml:mn><mml:mtext>&emsp;</mml:mtext><mml:mn>0</mml:mn><mml:mi>min</mml:mi><mml:mo></mml:mo><mml:mo>&le;</mml:mo><mml:mi>t</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>16</mml:mn><mml:mi>min</mml:mi><mml:mo></mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn><mml:mtext>&emsp;16 min</mml:mtext><mml:mo>&le;</mml:mo><mml:mi>t</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>21</mml:mn><mml:mi>min</mml:mi><mml:mo></mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="-2.6pc"/><mml:mn>1</mml:mn><mml:mtext>&emsp;</mml:mtext><mml:mi>t</mml:mi><mml:mo>&ge;</mml:mo><mml:mtext>21 min</mml:mtext></mml:mtd></mml:mtr></mml:mtable> </mml:mrow></mml:mrow></mml:math> --></disp-formula><p>From the experience of Jaeger et al. [<xref ref-type="bibr" rid="pcbi-0020051-b006">6</xref>,<xref ref-type="bibr" rid="pcbi-0020051-b007">7</xref>], it would appear that direct optimization of the parameters, Θ<italic><sup>a</sup>, λ<sup>a</sup>,</italic> and <italic>D<sup>a</sup></italic> is difficult. The first two stages of our approach are intended to produce good initial estimates of these parameters. The third stage is a direct optimization approach that fine-tunes the initial estimates to produce a good fit to the data (see <xref ref-type="fig" rid="pcbi-0020051-g002">Figure 2</xref> for a summary).</p></sec><sec id="s3c"><title>Stage 1.</title><p>In the first stage, we estimate <italic>λ<sup>a</sup>, D<sup>a</sup></italic> and the spatial and temporal extents of production associated with each domain. Peaks in gap protein expression are symmetrical, flat-topped, and have steeply sloping sides. It is reasonable to assume that, at any point in time, the rate of protein production associated with a particular peak is constant in some interval along the A–P axis and zero outside of that interval. However, it is not clear from the data exactly where such boundaries should be. It is also not clear exactly when production begins and when (or if) it ends.</p><p>We use a set of seven parameters to describe the conditions of protein production associated with each of the six gap protein peaks: <italic>ρ,</italic> a production rate; <italic>τ<sub>start</sub>,</italic> the time at which production begins; <italic>τ<sub>end</sub>,</italic> the time at which production ends; <italic>x<sub>s,a</sub>,</italic> the anterior-most extent of production at time <italic>τ<sub>start</sub>; x<sub>s,p</sub>,</italic> the posterior-most extent of production at time <italic>τ<sub>start</sub>; x<sub>e,a</sub>,</italic> the anterior-most extent of production at time <italic>τ<sub>end</sub>;</italic> and <italic>x<sub>e,p</sub>,</italic> the posterior-most extent of production at time <italic>τ<sub>end</sub></italic>. The last six parameters define a quadrilateral region of space–time (<xref ref-type="fig" rid="pcbi-0020051-g002">Figure 2</xref>A). Within this quadrilateral, we take protein production to occur at rate <italic>ρ</italic>. Genes with multiple peaks are assigned one quadrilateral per peak. At space–time points that do not fall in any of the quadrilaterals for a particular protein, the rate of protein production is assumed to be zero. Thus, for a single-domain gene, the production rate function has the form</p><disp-formula id="pcbi-0020051-e006"><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020051.e006" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>&equals;</mml:mo><mml:mrow><mml:mo stretchy='true'>&lcub;</mml:mo><mml:mtable columnalign='left'><mml:mtr><mml:mtd><mml:mi>&rho;</mml:mi></mml:mtd><mml:mtd><mml:mspace width='-8.55pc'/><mml:mtext>if&thinsp;&thinsp;</mml:mtext><mml:msub><mml:mi>&tau;</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>&le;</mml:mo><mml:mi>t</mml:mi><mml:mo>&le;</mml:mo><mml:msub><mml:mi>&tau;</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd></mml:mtd><mml:mtd><mml:mspace width='-1.6pc' height='1.25pc'/><mml:mtext>and&thinsp;</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle scriptlevel='+1'><mml:mfrac><mml:mrow><mml:msub><mml:mi>&tau;</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>&minus;</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>&tau;</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>&minus;</mml:mo><mml:msub><mml:mi>&tau;</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>&plus;</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle scriptlevel='+1'><mml:mfrac><mml:mrow><mml:mi>t</mml:mi><mml:mo>&minus;</mml:mo><mml:msub><mml:mi>&tau;</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>&tau;</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>&minus;</mml:mo><mml:msub><mml:mi>&tau;</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd></mml:mtd><mml:mtd><mml:mspace width='1.5pc' height='1.25pc'/><mml:mo>&le;</mml:mo><mml:mi>x</mml:mi><mml:mo>&le;</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle scriptlevel='+1'><mml:mfrac><mml:mrow><mml:msub><mml:mi>&tau;</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>&minus;</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>&tau;</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>&minus;</mml:mo><mml:msub><mml:mi>&tau;</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>&plus;</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle scriptlevel='+1'><mml:mfrac><mml:mrow><mml:mi>t</mml:mi><mml:mo>&minus;</mml:mo><mml:msub><mml:mi>&tau;</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>&tau;</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>&minus;</mml:mo><mml:msub><mml:mi>&tau;</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mspace width='-10.5pc' height='.75pc'/><mml:mtext>otherwise</mml:mtext></mml:mtd></mml:mtr></mml:mtable> </mml:mrow></mml:mrow></mml:math> --></disp-formula><p>For a two-domain gene, the production rate function is the maximum of two such functions. In either case, the dynamical model of the expression of protein <italic>a</italic> is</p><disp-formula id="pcbi-0020051-e007"><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020051.e007" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mstyle scriptlevel='+1'><mml:mfrac><mml:mrow><mml:mo>&part;</mml:mo><mml:msup><mml:mi>v</mml:mi><mml:mi>a</mml:mi></mml:msup><mml:mo stretchy='false'>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy='false'>)</mml:mo></mml:mrow><mml:mrow><mml:mo>&part;</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>&equals;</mml:mo><mml:mi>&zeta;</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mn>1</mml:mn><mml:mi>a</mml:mi></mml:msubsup><mml:mo stretchy='false'>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>&Thetas;</mml:mi><mml:mn>1</mml:mn><mml:mi>a</mml:mi></mml:msubsup><mml:mo stretchy='false'>)</mml:mo><mml:mo>&minus;</mml:mo><mml:msup><mml:mi>&lambda;</mml:mi><mml:mi>a</mml:mi></mml:msup><mml:msup><mml:mi>v</mml:mi><mml:mi>a</mml:mi></mml:msup><mml:mo stretchy='false'>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>&plus;</mml:mo><mml:msup><mml:mi>D</mml:mi><mml:mi>a</mml:mi></mml:msup><mml:mstyle scriptlevel='+1'><mml:mfrac><mml:mrow><mml:msup><mml:mo>&part;</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>v</mml:mi><mml:mi>a</mml:mi></mml:msup><mml:mo stretchy='false'>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy='false'>)</mml:mo></mml:mrow><mml:mrow><mml:mo>&part;</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mstyle><mml:mtext>&thinsp;</mml:mtext><mml:mo>,</mml:mo></mml:mrow></mml:math> --></disp-formula><p>where <inline-formula id="pcbi-0020051-ex002"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020051.ex002" xlink:type="simple"/></inline-formula>
					 are parameters that specify the spatial extent of production and production rates for the expression domain or domains of protein <italic>a</italic>. To fully specify Equation 7 requires nine parameters for a single-domain gene and 16 parameters for a two-domain gene—a decay rate, a diffusion rate, and seven parameters describing the production conditions for each domain. The system of partial differential equations is decoupled—the genes do not interact—so the parameters for each gene can be optimized independently. We optimize the parameters for each gene to minimize the RMS error between simulated and observed expression, <inline-formula id="pcbi-0020051-ex003"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020051.ex003" xlink:type="simple"/></inline-formula>
					, where <italic>v<sup>a</sup></italic>(<italic>x</italic>,<italic>t</italic>) is the simulated expression of protein <italic>a</italic>, <italic>y<sup>a</sup></italic>(<italic>x</italic>,<italic>t</italic>), is the observed expression, and <italic>N<sub>d</sub></italic> is the number of space–time points. We used a standard, repeated first-improvement local search with randomized order of neighbor examination to optimize the parameters for each gene. Stage 1 is performed only once for all four models, as it does not depend on the form of the <italic>P<sup>a</sup></italic> or the regulatory structure or parameters.
				</p></sec><sec id="s3d"><title>Stage 2.</title><p>Next, we generate an initial estimate of the regulatory parameters for each gene by searching for Θ<sup>a</sup> that minimize the error function <inline-formula id="pcbi-0020051-ex004"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020051.ex004" xlink:type="simple"/></inline-formula>
					, where <italic>N<sub>d</sub></italic> is the number of space–time points, <inline-formula id="pcbi-0020051-ex005"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020051.ex005" xlink:type="simple"/></inline-formula>
					 is the Stage 1 estimate for the production rate of protein <italic>a</italic> at space–time point (<italic>x</italic>,<italic>t</italic>), and <italic>P<sup>a</sup></italic> is the production function for protein <italic>a</italic> (as in Equation 4, but with the observed expression values given as input). In other words, we search for regulatory parameters which fit, as closely as possible, the quadrilateral production regions found in Stage 1. Parameters can be optimized separately for each gene. This is just a problem in function approximation (also known as regression or supervised learning)—we seek a set of parameters Θ<sup>a</sup> so that <italic>P<sup>a</sup></italic> reproduces as well as possible the input–output pairs <inline-formula id="pcbi-0020051-ex006"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020051.ex006" xlink:type="simple"/></inline-formula>
					. Many techniques are available for solving this sort of problem. For our gene circuit models, the error function is differentiable with respect to Θ<italic><sup>a</sup></italic>. We optimize the parameters using repeated runs of an adaptive step-size gradient descent procedure. For our logical models, the regulatory parameters are optimized using a repeated first-improvement local search with randomized order of neighborhood examination.
				</p><p>Although the Unc-GC model includes Gt activation of <italic>hb</italic> and Kni activation of <italic>gt,</italic> we disallowed these links in the Unc-Logic model. There is no support in the literature for these links and we found that their removal improved our fits.</p></sec><sec id="s3e"><title>Stage 3.</title><p>Finally, we combine the decay and diffusion constants estimated in Stage 1 with the regulatory parameters estimated in Stage 2 in a fully coupled partial differential equation model (Equation 4). Starting from these initial parameters, we perform repeated first-improvement local search with randomized order of neighbor examination, seeking parameters that minimize the RMS error <inline-formula id="pcbi-0020051-ex007"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020051.ex007" xlink:type="simple"/></inline-formula>
					, where <italic>N<sub>d</sub></italic> is the number of genes modeled (4) times the number of space–time points, <italic>v<sup>a</sup></italic>(<italic>x</italic>,<italic>t</italic>) is the simulated expression from the model, and <italic>y<sup>a</sup></italic>(<italic>x</italic>,<italic>t</italic>) is the observed expression.
				</p></sec><sec id="s3f"><title>Numerical solution of the partial differential equations.</title><p>We simulate using a fixed time step of one minute and a spatial grid of 58 points (one space point for each 1% of embryo length between 35% and 92%). For each step, we calculate the production rates for each gene at each space point and add them to the expression values. This corresponds to one minute of constant-rate production with no decay or diffusion. For Equation 1 (or 4), in which production rates depend on the protein levels present, the simulated gap protein levels and the observed <italic>bcd, cad,</italic> and <italic>tll</italic> levels are used to calculate production. Values of <italic>bcd, cad,</italic> and <italic>tll</italic> are linearly interpolated in time for simulation times between the times for which we have observed values. We then calculate the result of one minute of decay and diffusion on the updated expression values. Equations 1 (or 4) and 7 can be solved analytically if there is no production. We assume reflecting boundary conditions <inline-formula id="pcbi-0020051-ex008"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020051.ex008" xlink:type="simple"/></inline-formula>
					 at the anterior boundary (the 35% line), because that boundary splits the anterior Hb and Gt peaks. Any protein diffusing out across the 35% line should be matched by protein diffusing in across the 35% line from the parts of the peaks not modeled. At the posterior boundary (the 92% line), we use an absorbing boundary condition (<italic>v<sup>a</sup></italic>(<italic>x</italic>,<italic>t</italic>) = 0), because that boundary does not intersect any of the gap gene peaks.
				</p></sec></sec><sec id="s4"><title>Supporting Information</title><supplementary-material id="pcbi-0020051-sd007" mimetype="text/plain" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020051.sd007" xlink:type="simple"><label>Dataset S1</label><caption><title>Observed Expression Data</title><p>(41 KB DOC)</p></caption></supplementary-material><supplementary-material id="pcbi-0020051-sd001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020051.sd001" xlink:type="simple"><label>Protocol S1</label><caption><title>Fits Based on the Sanchez–Thieffry Network Structure</title><p>(58 KB PDF)</p></caption></supplementary-material><supplementary-material id="pcbi-0020051-sd002" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020051.sd002" xlink:type="simple"><label>Protocol S2</label><caption><title>Optimization Method Details</title><p>(75 KB PDF)</p></caption></supplementary-material><supplementary-material id="pcbi-0020051-sd003" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020051.sd003" xlink:type="simple"><label>Protocol S3</label><caption><title>Estimated Parameter Values</title><p>(10 KB PDF)</p></caption></supplementary-material><supplementary-material id="pcbi-0020051-sd004" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020051.sd004" xlink:type="simple"><label>Protocol S4</label><caption><title>Fits Based on Combined Structure Network</title><p>(56 KB PDF)</p></caption></supplementary-material><supplementary-material id="pcbi-0020051-sd005" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020051.sd005" xlink:type="simple"><label>Protocol S5</label><caption><title>Comparison of Errors in the Jaeger et al. Model and Unc-GC</title><p>(38 KB PDF)</p></caption></supplementary-material><supplementary-material id="pcbi-0020051-sd006" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020051.sd006" xlink:type="simple"><label>Protocol S6</label><caption><title>Simulating a Mutant <italic>Kr</italic>- Embryo</title><p>(59 KB PDF)</p></caption></supplementary-material></sec></body><back><ack><p>Any opinions, findings, and conclusions or recommendations expressed in this publication are those of the authors and do not necessarily reflect the views of the National Science Foundation.</p></ack><glossary><title>Abbreviations</title><def-list><def-item><term>A–P</term><def><p>anterior–posterior</p></def></def-item><def-item><term>Bcd</term><def><p>Bicoid</p></def></def-item><def-item><term><italic>bcd</italic></term><def><p><italic>bicoid</italic></p></def></def-item><def-item><term>Cad</term><def><p>Caudal</p></def></def-item><def-item><term><italic>cad</italic></term><def><p><italic>caudal</italic></p></def></def-item><def-item><term><italic>gt</italic></term><def><p><italic>giant</italic></p></def></def-item><def-item><term><italic>Hb</italic></term><def><p><italic>hunchback</italic></p></def></def-item><def-item><term><italic>kni</italic></term><def><p><italic>knirps</italic></p></def></def-item><def-item><term><italic>Kr</italic></term><def><p><italic>Krüppel</italic></p></def></def-item><def-item><term>RPJ network structure</term><def><p>Rivera-Pomar and Jäckle network structure</p></def></def-item><def-item><term>Tll</term><def><p>tailless</p></def></def-item><def-item><term><italic>tll</italic></term><def><p><italic>tailless</italic></p></def></def-item></def-list></glossary><ref-list><title>References</title><ref id="pcbi-0020051-b001"><label>1</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Akam</surname><given-names>M</given-names></name></person-group>
					<year>1987</year>
					<article-title>The molecular basis for metameric pattern in the <italic>Drosophila</italic> embryo.</article-title>
					<source>Development</source>
					<volume>101</volume>
					<fpage>1</fpage>
					<lpage>22</lpage>
				</element-citation></ref><ref id="pcbi-0020051-b002"><label>2</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Ingham</surname><given-names>PW</given-names></name></person-group>
					<year>1988</year>
					<article-title>The molecular genetics of embryonic pattern formation in <italic>Drosophila</italic>.</article-title>
					<source>Nature</source>
					<volume>335</volume>
					<fpage>25</fpage>
					<lpage>34</lpage>
				</element-citation></ref><ref id="pcbi-0020051-b003"><label>3</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Rivera-Pomar</surname><given-names>R</given-names></name><name name-style="western"><surname>Jäckle</surname><given-names>H</given-names></name></person-group>
					<year>1996</year>
					<article-title>From gradients to stripes in <italic>Drosophila</italic> embryogenesis: Filling in the gaps.</article-title>
					<source>Trends Genet</source>
					<volume>12</volume>
					<fpage>478</fpage>
					<lpage>483</lpage>
				</element-citation></ref><ref id="pcbi-0020051-b004"><label>4</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Sanchez</surname><given-names>L</given-names></name><name name-style="western"><surname>Thieffry</surname><given-names>D</given-names></name></person-group>
					<year>2001</year>
					<article-title>A logical analysis of the gap gene system.</article-title>
					<source>J Theor Biol</source>
					<volume>211</volume>
					<fpage>115</fpage>
					<lpage>141</lpage>
				</element-citation></ref><ref id="pcbi-0020051-b005"><label>5</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Reinitz</surname><given-names>J</given-names></name><name name-style="western"><surname>Sharp</surname><given-names>DH</given-names></name></person-group>
					<year>1995</year>
					<article-title>Mechanism of <italic>eve</italic> stripe formation.</article-title>
					<source>Mechanisms of Development</source>
					<volume>49</volume>
					<fpage>133</fpage>
					<lpage>158</lpage>
				</element-citation></ref><ref id="pcbi-0020051-b006"><label>6</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Jaeger</surname><given-names>J</given-names></name><name name-style="western"><surname>Surkova</surname><given-names>S</given-names></name><name name-style="western"><surname>Blagov</surname><given-names>M</given-names></name><name name-style="western"><surname>Janssens</surname><given-names>H</given-names></name><name name-style="western"><surname>Kosman</surname><given-names>D</given-names></name><etal/></person-group>
					<year>2004</year>
					<article-title>Dynamic control of positional information in the early <italic>Drosophila</italic> embryo.</article-title>
					<source>Nature</source>
					<volume>430</volume>
					<fpage>368</fpage>
					<lpage>371</lpage>
				</element-citation></ref><ref id="pcbi-0020051-b007"><label>7</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Jaeger</surname><given-names>J</given-names></name><name name-style="western"><surname>Blagov</surname><given-names>M</given-names></name><name name-style="western"><surname>Kosman</surname><given-names>D</given-names></name><name name-style="western"><surname>Kozlov</surname><given-names>KN</given-names></name><name name-style="western"><surname>Manu</surname></name><etal/></person-group>
					<year>2004</year>
					<article-title>Dynamical analysis of regulatory interactions in the gap gene system of <named-content content-type="genus-species" xlink:type="simple">Drosophila melanogaster</named-content>.</article-title>
					<source>Genetics</source>
					<volume>167</volume>
					<fpage>1721</fpage>
					<lpage>1737</lpage>
				</element-citation></ref><ref id="pcbi-0020051-b008"><label>8</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>D'Haeseleer</surname><given-names>P</given-names></name><name name-style="western"><surname>Wen</surname><given-names>X</given-names></name><name name-style="western"><surname>Fuhrman</surname><given-names>S</given-names></name><name name-style="western"><surname>Somogyi</surname><given-names>R</given-names></name></person-group>
					<year>1999</year>
					<article-title>Linear modeling of mRNA expression levels during CNS development and injury.</article-title>
					<source>Pac Symp Biocomput</source>
					<volume>3</volume>
					<fpage>41</fpage>
					<lpage>52</lpage>
				</element-citation></ref><ref id="pcbi-0020051-b009"><label>9</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Yeung</surname><given-names>MKS</given-names></name><name name-style="western"><surname>Tegner</surname><given-names>J</given-names></name><name name-style="western"><surname>Collins</surname><given-names>JJ</given-names></name></person-group>
					<year>2002</year>
					<article-title>Reverse engineering gene networks using singular value decomposition and robust regression.</article-title>
					<source>Proc Natl Acad Sci U S A</source>
					<volume>99</volume>
					<fpage>6163</fpage>
					<lpage>6168</lpage>
				</element-citation></ref><ref id="pcbi-0020051-b010"><label>10</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Chu</surname><given-names>KW</given-names></name><name name-style="western"><surname>Deng</surname><given-names>Y</given-names></name><name name-style="western"><surname>Reinitz</surname><given-names>J</given-names></name></person-group>
					<year>1999</year>
					<article-title>Parallel simulated annealing by mixing of states.</article-title>
					<source>J Comput Phys</source>
					<volume>148</volume>
					<fpage>646</fpage>
					<lpage>662</lpage>
				</element-citation></ref><ref id="pcbi-0020051-b011"><label>11</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Chu</surname><given-names>KW</given-names></name></person-group>
					<year>2001</year>
					<source>The existence and estimation of an optimal mixing regime [thesis]</source>
					<publisher-loc>Stony Brook (New York)</publisher-loc>
					<publisher-name>State University of New York at Stony Brook</publisher-name>
				</element-citation></ref><ref id="pcbi-0020051-b012"><label>12</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Gursky</surname><given-names>VV</given-names></name><name name-style="western"><surname>Jaeger</surname><given-names>J</given-names></name><name name-style="western"><surname>Kozlov</surname><given-names>KN</given-names></name><name name-style="western"><surname>Reinitz</surname><given-names>J</given-names></name><name name-style="western"><surname>Samsonov</surname><given-names>AM</given-names></name></person-group>
					<year>2004</year>
					<article-title>Pattern formation and nuclear divisions are uncoupled in <italic>Drosophila</italic> segmentation: Comparison of spatially discrete and continuous models.</article-title>
					<source>Physica D</source>
					<volume>197</volume>
					<fpage>286</fpage>
					<lpage>302</lpage>
				</element-citation></ref><ref id="pcbi-0020051-b013"><label>13</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Mendoza</surname><given-names>L</given-names></name><name name-style="western"><surname>Alvarez-Buylla</surname><given-names>ER</given-names></name></person-group>
					<year>1998</year>
					<article-title>Dynamics of the genetic regulatory network for <named-content content-type="genus-species" xlink:type="simple">Arabidopsis thaliana</named-content> flower morphogenesis.</article-title>
					<source>J Theor Biol</source>
					<volume>193</volume>
					<fpage>307</fpage>
					<lpage>319</lpage>
				</element-citation></ref><ref id="pcbi-0020051-b014"><label>14</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Mendoza</surname><given-names>L</given-names></name><name name-style="western"><surname>Thieffry</surname><given-names>D</given-names></name><name name-style="western"><surname>Alvarez-Buylla</surname><given-names>ER</given-names></name></person-group>
					<year>1999</year>
					<article-title>Genetic control of flower morphogenesis in arabidopsis thaliana: A logical analysis.</article-title>
					<source>Bioinformatics</source>
					<volume>14</volume>
					<fpage>593</fpage>
					<lpage>696</lpage>
				</element-citation></ref><ref id="pcbi-0020051-b015"><label>15</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Albert</surname><given-names>R</given-names></name><name name-style="western"><surname>Othmer</surname><given-names>HG</given-names></name></person-group>
					<year>2003</year>
					<article-title>The topology of the regulatory interactions predicts the expression pattern of the segment polarity genes in <named-content content-type="genus-species" xlink:type="simple">Drosophila melanogaster</named-content>.</article-title>
					<source>J Theor Biol</source>
					<volume>223</volume>
					<fpage>1</fpage>
					<lpage>18</lpage>
				</element-citation></ref><ref id="pcbi-0020051-b016"><label>16</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Yuh</surname><given-names>CH</given-names></name><name name-style="western"><surname>Bolouri</surname><given-names>H</given-names></name><name name-style="western"><surname>Davidson</surname><given-names>EH</given-names></name></person-group>
					<year>1998</year>
					<article-title>Genomic cis-regulatory logic: Experimental and computational analysis of a sea urchin gene.</article-title>
					<source>Science</source>
					<volume>279</volume>
					<fpage>1896</fpage>
					<lpage>1902</lpage>
				</element-citation></ref><ref id="pcbi-0020051-b017"><label>17</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Setty</surname><given-names>Y</given-names></name><name name-style="western"><surname>Mayo</surname><given-names>AE</given-names></name><name name-style="western"><surname>Surette</surname><given-names>MG</given-names></name><name name-style="western"><surname>Alon</surname><given-names>U</given-names></name></person-group>
					<year>2003</year>
					<article-title>Detailed map of a cis-regulatory input function.</article-title>
					<source>Proc Natl Acad Sci U S A</source>
					<volume>100</volume>
					<fpage>7702</fpage>
					<lpage>7707</lpage>
				</element-citation></ref><ref id="pcbi-0020051-b018"><label>18</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Poustelnikova</surname><given-names>E</given-names></name><name name-style="western"><surname>Pisarev</surname><given-names>A</given-names></name><name name-style="western"><surname>Blagov</surname><given-names>M</given-names></name><name name-style="western"><surname>Samsonova</surname><given-names>M</given-names></name><name name-style="western"><surname>Reinitz</surname><given-names>J</given-names></name></person-group>
					<year>2004</year>
					<article-title>A database for management of gene expression data in situ.</article-title>
					<source>Bioinformatics</source>
					<volume>20</volume>
					<fpage>2212</fpage>
					<lpage>2221</lpage>
				</element-citation></ref><ref id="pcbi-0020051-b019"><label>19</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Shermoen</surname><given-names>AW</given-names></name><name name-style="western"><surname>O'Farrell</surname><given-names>PH</given-names></name></person-group>
					<year>1991</year>
					<article-title>Progression of the cell cycle through mitosis leads to abortion of nascent transcripts.</article-title>
					<source>Cell</source>
					<volume>97</volume>
					<fpage>303</fpage>
					<lpage>310</lpage>
				</element-citation></ref><ref id="pcbi-0020051-b020"><label>20</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Driever</surname><given-names>W</given-names></name><name name-style="western"><surname>Nüsslein-Volhard</surname><given-names>C</given-names></name></person-group>
					<year>1989</year>
					<article-title>The Bicoid protein is a positive regulator of <italic>hunchback</italic> transcription in the early <italic>Drosophila</italic> embryo.</article-title>
					<source>Nature</source>
					<volume>337</volume>
					<fpage>138</fpage>
					<lpage>143</lpage>
				</element-citation></ref><ref id="pcbi-0020051-b021"><label>21</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Tautz</surname><given-names>D</given-names></name></person-group>
					<year>1988</year>
					<article-title>Regulation of the <italic>Drosophila</italic> segmentation gene <italic>hunchback</italic> by two maternal morphogenetic centres.</article-title>
					<source>Nature</source>
					<volume>332</volume>
					<fpage>281</fpage>
					<lpage>284</lpage>
				</element-citation></ref><ref id="pcbi-0020051-b022"><label>22</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Eldon</surname><given-names>ED</given-names></name><name name-style="western"><surname>Pirrotta</surname><given-names>V</given-names></name></person-group>
					<year>1991</year>
					<article-title>Interactions of the <italic>Drosophila</italic> gap gene <italic>giant</italic> with maternal and zygotic pattern-forming genes.</article-title>
					<source>Development</source>
					<volume>111</volume>
					<fpage>367</fpage>
					<lpage>378</lpage>
				</element-citation></ref><ref id="pcbi-0020051-b023"><label>23</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Hoch</surname><given-names>M</given-names></name><name name-style="western"><surname>Schröder</surname><given-names>C</given-names></name><name name-style="western"><surname>Seifert</surname><given-names>E</given-names></name><name name-style="western"><surname>Jäckle</surname><given-names>H</given-names></name></person-group>
					<year>1990</year>
					<article-title>Cis-acting control elements for <italic>Krüppel</italic> expression in the <italic>Drosophila</italic> embryo.</article-title>
					<source>EMBO J</source>
					<volume>9</volume>
					<fpage>2587</fpage>
					<lpage>2595</lpage>
				</element-citation></ref><ref id="pcbi-0020051-b024"><label>24</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Hoch</surname><given-names>M</given-names></name><name name-style="western"><surname>Seifert</surname><given-names>E</given-names></name><name name-style="western"><surname>Jäckle</surname><given-names>H</given-names></name></person-group>
					<year>1991</year>
					<article-title>Gene expression mediated by cis-acting sequences of the <italic>Krüppel</italic> gene in response to the <italic>Drosophila</italic> morphogens Bicoid and Hunchback.</article-title>
					<source>EMBO J</source>
					<volume>10</volume>
					<fpage>2267</fpage>
					<lpage>2278</lpage>
				</element-citation></ref><ref id="pcbi-0020051-b025"><label>25</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Rivera-Pomar</surname><given-names>R</given-names></name><name name-style="western"><surname>Lu</surname><given-names>X</given-names></name><name name-style="western"><surname>Perrimon</surname><given-names>N</given-names></name><name name-style="western"><surname>Taubert</surname><given-names>H</given-names></name><name name-style="western"><surname>Jäckle</surname><given-names>H</given-names></name></person-group>
					<year>1995</year>
					<article-title>Activation of posterior gap gene expression in the <italic>Drosophila</italic> blastoderm.</article-title>
					<source>Nature</source>
					<volume>376</volume>
					<fpage>253</fpage>
					<lpage>256</lpage>
				</element-citation></ref><ref id="pcbi-0020051-b026"><label>26</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Casanova</surname><given-names>J</given-names></name></person-group>
					<year>1990</year>
					<article-title>Pattern formation under the control of the terminal system in the <italic>Drosophila</italic> embryo.</article-title>
					<source>Development</source>
					<volume>110</volume>
					<fpage>621</fpage>
					<lpage>628</lpage>
				</element-citation></ref><ref id="pcbi-0020051-b027"><label>27</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Reinitz</surname><given-names>J</given-names></name><name name-style="western"><surname>Levine</surname><given-names>M</given-names></name></person-group>
					<year>1990</year>
					<article-title>Control of the initiation of homeotic gene expression by the gap genes giant and tailless in Drosophila.</article-title>
					<source>Dev Biol</source>
					<volume>140</volume>
					<fpage>57</fpage>
					<lpage>72</lpage>
				</element-citation></ref><ref id="pcbi-0020051-b028"><label>28</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Brönner</surname><given-names>G</given-names></name><name name-style="western"><surname>Jäckle</surname><given-names>H</given-names></name></person-group>
					<year>1991</year>
					<article-title>Control and function of terminal gap gene activity in the posterior pole region of the <italic>Drosophila</italic> embryo.</article-title>
					<source>Mech Dev</source>
					<volume>35</volume>
					<fpage>205</fpage>
					<lpage>211</lpage>
				</element-citation></ref><ref id="pcbi-0020051-b029"><label>29</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Hoch</surname><given-names>M</given-names></name><name name-style="western"><surname>Gerwin</surname><given-names>N</given-names></name><name name-style="western"><surname>Taubert</surname><given-names>H</given-names></name><name name-style="western"><surname>Jäckle</surname><given-names>H</given-names></name></person-group>
					<year>1992</year>
					<article-title>Competition for overlapping sites in the regulatory region of the <italic>Drosophila</italic> gene <italic>Krüppel</italic>.</article-title>
					<source>Science</source>
					<volume>256</volume>
					<fpage>94</fpage>
					<lpage>97</lpage>
				</element-citation></ref><ref id="pcbi-0020051-b030"><label>30</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Pankratz</surname><given-names>MJ</given-names></name><name name-style="western"><surname>Busch</surname><given-names>M</given-names></name><name name-style="western"><surname>Hoch</surname><given-names>M</given-names></name><name name-style="western"><surname>Seifert</surname><given-names>E</given-names></name><name name-style="western"><surname>Jäckle</surname><given-names>H</given-names></name></person-group>
					<year>1992</year>
					<article-title>Spatial control of the gap gene <italic>knirps</italic> in the <italic>Drosophila</italic> embryo by posterior morphogen system.</article-title>
					<source>Science</source>
					<volume>255</volume>
					<fpage>986</fpage>
					<lpage>989</lpage>
				</element-citation></ref><ref id="pcbi-0020051-b031"><label>31</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Pankratz</surname><given-names>MJ</given-names></name><name name-style="western"><surname>Hoch</surname><given-names>M</given-names></name><name name-style="western"><surname>Seifert</surname><given-names>E</given-names></name><name name-style="western"><surname>Jäckle</surname><given-names>H</given-names></name></person-group>
					<year>1989</year>
					<article-title><italic>Krüppel</italic> requirement for <italic>knirps</italic> enhancement reflects overlapping gap gene activities in the <italic>Drosophila</italic> embryo.</article-title>
					<source>Nature</source>
					<volume>341</volume>
					<fpage>337</fpage>
					<lpage>340</lpage>
				</element-citation></ref><ref id="pcbi-0020051-b032"><label>32</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Kraut</surname><given-names>R</given-names></name><name name-style="western"><surname>Levine</surname><given-names>M</given-names></name></person-group>
					<year>1991</year>
					<article-title>Spatial regulation of the gap gene <italic>giant</italic> during <italic>Drosophila</italic> development.</article-title>
					<source>Development</source>
					<volume>111</volume>
					<fpage>601</fpage>
					<lpage>609</lpage>
				</element-citation></ref><ref id="pcbi-0020051-b033"><label>33</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Kraut</surname><given-names>R</given-names></name><name name-style="western"><surname>Levine</surname><given-names>M</given-names></name></person-group>
					<year>1991</year>
					<article-title>Mutually repressive interactions between the gap genes <italic>giant</italic> and <italic>Krüppel</italic> define middle body regions of the <italic>Drosophila</italic> embryo.</article-title>
					<source>Development</source>
					<volume>111</volume>
					<fpage>611</fpage>
					<lpage>621</lpage>
				</element-citation></ref><ref id="pcbi-0020051-b034"><label>34</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Steingrimsson</surname><given-names>E</given-names></name><name name-style="western"><surname>Pignoni</surname><given-names>F</given-names></name><name name-style="western"><surname>Liaw</surname><given-names>GJ</given-names></name><name name-style="western"><surname>Lengyel</surname><given-names>JA</given-names></name></person-group>
					<year>1991</year>
					<article-title>Dual role of the <italic>Drosophila</italic> pattern gene <italic>tailless</italic> in embryonic termini.</article-title>
					<source>Science</source>
					<volume>254</volume>
					<fpage>418</fpage>
					<lpage>421</lpage>
				</element-citation></ref><ref id="pcbi-0020051-b035"><label>35</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Capovilla</surname><given-names>M</given-names></name><name name-style="western"><surname>Eldon</surname><given-names>ED</given-names></name><name name-style="western"><surname>Pirrotta</surname><given-names>V</given-names></name></person-group>
					<year>1992</year>
					<article-title>The <italic>giant</italic> gene of <italic>Drosophila</italic> encodes a b-ZIP DNA-binding protein that regulates the expression of other segmentation gap genes.</article-title>
					<source>Development</source>
					<volume>114</volume>
					<fpage>99</fpage>
					<lpage>112</lpage>
				</element-citation></ref><ref id="pcbi-0020051-b036"><label>36</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Hülskamp</surname><given-names>M</given-names></name><name name-style="western"><surname>Pfeifle</surname><given-names>C</given-names></name><name name-style="western"><surname>Tautz</surname><given-names>D</given-names></name></person-group>
					<year>1990</year>
					<article-title>A morphogenetic gradient of Hunchback protein organizes the expression of the gap genes <italic>Krüppel</italic> and <italic>knirps</italic> in the early <italic>Drosophila</italic> embryo.</article-title>
					<source>Nature</source>
					<volume>346</volume>
					<fpage>577</fpage>
					<lpage>580</lpage>
				</element-citation></ref><ref id="pcbi-0020051-b037"><label>37</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Rothe</surname><given-names>M</given-names></name><name name-style="western"><surname>Wimmer</surname><given-names>EA</given-names></name><name name-style="western"><surname>Pankratz</surname><given-names>MJ</given-names></name><name name-style="western"><surname>González-Gaitán</surname><given-names>M</given-names></name><name name-style="western"><surname>Jäckle</surname><given-names>H</given-names></name></person-group>
					<year>1994</year>
					<article-title>Identical transacting factor requirement for <italic>knirps</italic> and <italic>knirps-related</italic> gene expression in the anterior but not in the posterior region of the <italic>Drosophila</italic> embryo.</article-title>
					<source>Mech Dev</source>
					<volume>46</volume>
					<fpage>169</fpage>
					<lpage>181</lpage>
				</element-citation></ref><ref id="pcbi-0020051-b038"><label>38</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Clyde</surname><given-names>DE</given-names></name><name name-style="western"><surname>Corado</surname><given-names>MSG</given-names></name><name name-style="western"><surname>Wu</surname><given-names>X</given-names></name><name name-style="western"><surname>Paré</surname><given-names>A</given-names></name><name name-style="western"><surname>Papatsenko</surname><given-names>D</given-names></name><etal/></person-group>
					<year>2003</year>
					<article-title>A self-organizing system of repressor gradients establishes segmental complexity in <italic>Drosophila</italic>.</article-title>
					<source>Nature</source>
					<volume>426</volume>
					<fpage>849</fpage>
					<lpage>853</lpage>
				</element-citation></ref><ref id="pcbi-0020051-b039"><label>39</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Jäckle</surname><given-names>H</given-names></name><name name-style="western"><surname>Tautz</surname><given-names>D</given-names></name><name name-style="western"><surname>Schuh</surname><given-names>R</given-names></name><name name-style="western"><surname>Seifert</surname><given-names>E</given-names></name><name name-style="western"><surname>Lehmann</surname><given-names>R</given-names></name></person-group>
					<year>1986</year>
					<article-title>Cross-regulatory interactions among the gap genes of <italic>Drosophila</italic>.</article-title>
					<source>Nature</source>
					<volume>324</volume>
					<fpage>668</fpage>
					<lpage>670</lpage>
				</element-citation></ref><ref id="pcbi-0020051-b040"><label>40</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Gaul</surname><given-names>U</given-names></name><name name-style="western"><surname>Jäckle</surname><given-names>H</given-names></name></person-group>
					<year>1987</year>
					<article-title>Pole region-dependent repression of the <italic>Drosophila</italic> gap gene <italic>Krüppel</italic> by maternal gene products.</article-title>
					<source>Cell</source>
					<volume>51</volume>
					<fpage>549</fpage>
					<lpage>555</lpage>
				</element-citation></ref><ref id="pcbi-0020051-b041"><label>41</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Gaul</surname><given-names>U</given-names></name><name name-style="western"><surname>Jäckle</surname><given-names>H</given-names></name></person-group>
					<year>1989</year>
					<article-title>Analysis of maternal effect mutant combinations elucidates regulation and function of the overlap of <italic>hunchback</italic> and <italic>Krüppel</italic> gene expression in the <italic>Drosophila</italic> blastoderm embryo.</article-title>
					<source>Development</source>
					<volume>120</volume>
					<fpage>3155</fpage>
					<lpage>3171</lpage>
				</element-citation></ref><ref id="pcbi-0020051-b042"><label>42</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Simpson-Brose</surname><given-names>M</given-names></name><name name-style="western"><surname>Treisman</surname><given-names>J</given-names></name><name name-style="western"><surname>Desplan</surname><given-names>C</given-names></name></person-group>
					<year>1994</year>
					<article-title>Synergy between the Hunchback and Bicoid morphogens is required for anterior patterning in <italic>Drosophila</italic>.</article-title>
					<source>Cell</source>
					<volume>78</volume>
					<fpage>855</fpage>
					<lpage>865</lpage>
				</element-citation></ref><ref id="pcbi-0020051-b043"><label>43</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Warrior</surname><given-names>R</given-names></name><name name-style="western"><surname>Levine</surname><given-names>M</given-names></name></person-group>
					<year>1990</year>
					<article-title>Dose-dependent regulation of pair-rule stripes by gap proteins and the initiation of segment polarity.</article-title>
					<source>Development</source>
					<volume>110</volume>
					<fpage>759</fpage>
					<lpage>767</lpage>
				</element-citation></ref><ref id="pcbi-0020051-b044"><label>44</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Struhl</surname><given-names>G</given-names></name><name name-style="western"><surname>Johnston</surname><given-names>P</given-names></name><name name-style="western"><surname>Lawrence</surname><given-names>PA</given-names></name></person-group>
					<year>1992</year>
					<article-title>Control of <italic>Drosophila</italic> body pattern by the <italic>hunchback</italic> morphogen gradient.</article-title>
					<source>Cell</source>
					<volume>69</volume>
					<fpage>237</fpage>
					<lpage>249</lpage>
				</element-citation></ref><ref id="pcbi-0020051-b045"><label>45</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Schulz</surname><given-names>C</given-names></name><name name-style="western"><surname>Tautz</surname><given-names>D</given-names></name></person-group>
					<year>1994</year>
					<article-title>Autonomous concentration-dependent activation and repression of <italic>Krüppel</italic> by <italic>hunchback</italic> in the <italic>Drosophila</italic> embryo.</article-title>
					<source>Development</source>
					<volume>120</volume>
					<fpage>3043</fpage>
					<lpage>3049</lpage>
				</element-citation></ref><ref id="pcbi-0020051-b046"><label>46</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Mohler</surname><given-names>J</given-names></name><name name-style="western"><surname>Eldon</surname><given-names>ED</given-names></name><name name-style="western"><surname>Pirrotta</surname><given-names>V</given-names></name></person-group>
					<year>1989</year>
					<article-title>A novel spatial transcription pattern associated with the segmentation gene, <italic>giant</italic>, of <italic>Drosophila</italic>.</article-title>
					<source>EMBO J</source>
					<volume>8</volume>
					<fpage>1539</fpage>
					<lpage>1548</lpage>
				</element-citation></ref><ref id="pcbi-0020051-b047"><label>47</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Tautz</surname><given-names>D</given-names></name><name name-style="western"><surname>Lehmann</surname><given-names>R</given-names></name><name name-style="western"><surname>Schnürch</surname><given-names>H</given-names></name><name name-style="western"><surname>Schuh</surname><given-names>R</given-names></name><name name-style="western"><surname>Seifert</surname><given-names>E</given-names></name><etal/></person-group>
					<year>1987</year>
					<article-title>Finger protein of novel structure encoded by <italic>hunchback</italic>, a second member of the gap class of <italic>Drosophila</italic> segmentation genes.</article-title>
					<source>Nature</source>
					<volume>327</volume>
					<fpage>383</fpage>
					<lpage>389</lpage>
				</element-citation></ref><ref id="pcbi-0020051-b048"><label>48</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Sharp</surname><given-names>DH</given-names></name><name name-style="western"><surname>Reinitz</surname><given-names>J</given-names></name></person-group>
					<year>1998</year>
					<article-title>Prediction of mutant expression patterns using gene circuits.</article-title>
					<source>Biosystems</source>
					<volume>47</volume>
					<fpage>79</fpage>
					<lpage>90</lpage>
				</element-citation></ref><ref id="pcbi-0020051-b049"><label>49</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Kosman</surname><given-names>D</given-names></name><name name-style="western"><surname>Small</surname><given-names>S</given-names></name><name name-style="western"><surname>Reinitz</surname><given-names>J</given-names></name></person-group>
					<year>1998</year>
					<article-title>Rapid preparation of a panel of polyclonal antibodies to <italic>Drosophila</italic> segmentation proteins.</article-title>
					<source>Dev Genes Evol</source>
					<volume>208</volume>
					<fpage>290</fpage>
					<lpage>294</lpage>
				</element-citation></ref><ref id="pcbi-0020051-b050"><label>50</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Myasnikova</surname><given-names>E</given-names></name><name name-style="western"><surname>Samsonova</surname><given-names>A</given-names></name><name name-style="western"><surname>Kozlov</surname><given-names>K</given-names></name><name name-style="western"><surname>Samsonova</surname><given-names>M</given-names></name><name name-style="western"><surname>Reinitz</surname><given-names>J</given-names></name></person-group>
					<year>2001</year>
					<article-title>Registration of the expression patterns of <italic>Drosophila</italic> segmentation genes by two independent methods.</article-title>
					<source>Bioinformatics</source>
					<volume>17</volume>
					<fpage>3</fpage>
					<lpage>12</lpage>
				</element-citation></ref><ref id="pcbi-0020051-b051"><label>51</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Janssens</surname><given-names>H</given-names></name><name name-style="western"><surname>Kosman</surname><given-names>D</given-names></name><name name-style="western"><surname>Vanario-Alonso</surname><given-names>CE</given-names></name><name name-style="western"><surname>Jaeger</surname><given-names>J</given-names></name><name name-style="western"><surname>Samsonova</surname><given-names>M</given-names></name><etal/></person-group>
					<year>2005</year>
					<article-title>A high-throughput method for quantifying gene expression data from early <italic>Drosophila</italic> embryos.</article-title>
					<source>Dev Genes Evol</source>
					<volume>215</volume>
					<fpage>374</fpage>
					<lpage>381</lpage>
				</element-citation></ref><ref id="pcbi-0020051-b052"><label>52</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Myasnikova</surname><given-names>E</given-names></name><name name-style="western"><surname>Samsonova</surname><given-names>M</given-names></name><name name-style="western"><surname>Kosman</surname><given-names>D</given-names></name><name name-style="western"><surname>Reinitz</surname><given-names>J</given-names></name></person-group>
					<year>2005</year>
					<article-title>Removal of background signal from in situ data on the expression of segmentation gene in <italic>Drosophila</italic>.</article-title>
					<source>Dev Genes Evol</source>
					<volume>215</volume>
					<fpage>320</fpage>
					<lpage>326</lpage>
				</element-citation></ref><ref id="pcbi-0020051-b053"><label>53</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Foe</surname><given-names>VE</given-names></name><name name-style="western"><surname>Alberts</surname><given-names>BM</given-names></name></person-group>
					<year>1983</year>
					<article-title>Studies of nuclear and cytoplasmic behaviour during the five mitotic cycles that precede gastrulation in <italic>Drosophila</italic> embryogenesis.</article-title>
					<source>J Cell Sci</source>
					<volume>61</volume>
					<fpage>31</fpage>
					<lpage>70</lpage>
				</element-citation></ref><ref id="pcbi-0020051-b054"><label>54</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Campos-Ortega</surname><given-names>JA</given-names></name><name name-style="western"><surname>Hartenstein</surname><given-names>V</given-names></name></person-group>
					<year>1985</year>
					<source>The Embryonic Development of <italic><named-content content-type="genus-species" xlink:type="simple">Drosophila melanogaster</named-content></italic></source>
					<publisher-loc>Heidelberg (Germany)</publisher-loc>
					<publisher-name>Springer</publisher-name>
					<!--===== Restructure page-count as size[@units="page"] =====--><size units="page">227</size>
					<comment>p.</comment>
				</element-citation></ref></ref-list></back></article>