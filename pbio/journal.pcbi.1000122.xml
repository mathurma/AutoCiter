<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN"><front><journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher><publisher-name>Public Library of Science</publisher-name><publisher-loc>San Francisco, USA</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">07-PLCB-RA-0833R2</article-id><article-id pub-id-type="doi">10.1371/journal.pcbi.1000122</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline"><subject>Chemical Biology</subject><subject>Computational Biology/Systems Biology</subject><subject>Computer Science/Numerical Analysis and Theoretical Computing</subject></subj-group></article-categories><title-group><article-title>Memory Switches in Chemical Reaction Space</article-title><alt-title alt-title-type="running-head">Biochemical Switches</alt-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Ramakrishnan</surname><given-names>Naren</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Bhalla</surname><given-names>Upinder S.</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib></contrib-group><aff id="aff1"><label>1</label><addr-line>Department of Computer Science, Virginia Tech, Blacksburg, Virginia, United States of America</addr-line>       </aff><aff id="aff2"><label>2</label><addr-line>Institute of Bioinformatics and Applied Biotechnology, Bangalore, India</addr-line>       </aff><aff id="aff3"><label>3</label><addr-line>National Centre for Biological Sciences, Tata Institute of Fundamental Research, Bangalore, India</addr-line>       </aff><contrib-group><contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Sauro</surname><given-names>Herbert M.</given-names></name><role>Editor</role><xref ref-type="aff" rid="edit1"/></contrib></contrib-group><aff id="edit1">University of Washington, United States of America</aff><author-notes><corresp id="cor1">* E-mail: <email xlink:type="simple">bhalla@ncbs.res.in</email></corresp><fn fn-type="con"><p>Conceived and designed the experiments: NR UB. Performed the experiments: NR UB. Analyzed the data: NR UB. Contributed reagents/materials/analysis tools: NR UB. Wrote the paper: NR UB.</p></fn><fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn></author-notes><pub-date pub-type="collection"><month>7</month><year>2008</year></pub-date><pub-date pub-type="epub"><day>18</day><month>7</month><year>2008</year></pub-date><volume>4</volume><issue>7</issue><elocation-id>e1000122</elocation-id><history><date date-type="received"><day>31</day><month>12</month><year>2007</year></date><date date-type="accepted"><day>10</day><month>6</month><year>2008</year></date></history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2008</copyright-year><copyright-holder>Ramakrishnan, Bhalla</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract><p>Just as complex electronic circuits are built from simple Boolean gates, diverse biological functions, including signal transduction, differentiation, and stress response, frequently use biochemical switches as a functional module. A relatively small number of such switches have been described in the literature, and these exhibit considerable diversity in chemical topology. We asked if biochemical switches are indeed rare and if there are common chemical motifs and family relationships among such switches. We performed a systematic exploration of chemical reaction space by generating all possible stoichiometrically valid chemical configurations up to 3 molecules and 6 reactions and up to 4 molecules and 3 reactions. We used Monte Carlo sampling of parameter space for each such configuration to generate specific models and checked each model for switching properties. We found nearly 4,500 reaction topologies, or about 10% of our tested configurations, that demonstrate switching behavior. Commonly accepted topological features such as feedback were poor predictors of bistability, and we identified new reaction motifs that were likely to be found in switches. Furthermore, the discovered switches were related in that most of the larger configurations were derived from smaller ones by addition of one or more reactions. To explore even larger configurations, we developed two tools: the “bistabilizer,” which converts almost-bistable systems into bistable ones, and frequent motif mining, which helps rank untested configurations. Both of these tools increased the coverage of our library of bistable systems. Thus, our systematic exploration of chemical reaction space has produced a valuable resource for investigating the key signaling motif of bistability.</p></abstract><abstract abstract-type="summary"><title>Author Summary</title><p>How does a cell know what type of cell it is supposed to become? How do external chemical signals change the underlying “state” of the cell? How are response pathways triggered on the application of a stress? Such questions of differentiation, signal transduction, and stress response, while seemingly diverse, all pertain to the storage of state information, or “memory,” by biochemical switches. Just as a computer memory unit can store a bit of 0 or 1 through electrical signals, a biochemical switch can be in one of two states, where chemical signals are on or off. This lets the cell record the presence/absence of an environmental stimulus, the level of a signaling molecule, or the result of a cell fate decision. There are a small number of published ways by which a group of chemical reactions come together to realize a switch. We undertook an exhaustive computational exploration to see if chemical switches are indeed rare and found, surprisingly, that they are actually abundant, highly diverse, but related to one another. Our catalog of switches opens up new bioinformatics approaches to understanding cellular decision making and cellular memory.</p></abstract><funding-group><funding-statement>This work was supported in part by grants from the National Centre for Biological Sciences and a Department of Atomic Energy, Science Research Council, India, award to USB and the US National Science Foundation (grant CNS-0615181) to NR. The sponsors were not involved in the design and planning of the study, the analysis of results, the preparation of the manuscript, or with the decision to submit this manuscript. All findings and conclusions presented here are those of the authors and should not be construed as being endorsed by the National Centre for Biological Sciences, the Department of Atomic Energy, India, or the US National Science Foundation.</funding-statement></funding-group><counts><page-count count="9"/></counts></article-meta></front><body><sec id="s1"><title>Introduction</title><p>Most chemical reaction systems have a single steady state, but a few interesting cases are known to oscillate <xref ref-type="bibr" rid="pcbi.1000122-Kuramoto1">[1]</xref>, form spatial patterns <xref ref-type="bibr" rid="pcbi.1000122-Shoji1">[2]</xref>, or have multiple stable states <xref ref-type="bibr" rid="pcbi.1000122-Angeli1">[3]</xref>,<xref ref-type="bibr" rid="pcbi.1000122-Tyson1">[4]</xref>. Aside from their intrinsic mathematical and chemical significance, systems with multiple stable states are of particular biological interest because they can retain a “memory” of past inputs and cellular decisions <xref ref-type="bibr" rid="pcbi.1000122-Angeli1">[3]</xref>,<xref ref-type="bibr" rid="pcbi.1000122-Tyson1">[4]</xref>. Bistability is a particularly interesting case of multi-stability, as it leads to switch-like behavior. Chemical stimuli can trigger a state change from one stable state to another. The current state of the chemical system is therefore a “memory” of this earlier stimulus.</p><p>A few biochemical switches have been extensively analyzed, including complex enzyme mechanisms <xref ref-type="bibr" rid="pcbi.1000122-Craciun1">[5]</xref>,<xref ref-type="bibr" rid="pcbi.1000122-Brandman1">[6]</xref>, kinase feedback <xref ref-type="bibr" rid="pcbi.1000122-Ferrell1">[7]</xref>,<xref ref-type="bibr" rid="pcbi.1000122-Bhalla1">[8]</xref>, dual phosphorylation <xref ref-type="bibr" rid="pcbi.1000122-Markevich1">[9]</xref>, the cell cycle <xref ref-type="bibr" rid="pcbi.1000122-Novak1">[10]</xref>, triggering of caspases <xref ref-type="bibr" rid="pcbi.1000122-Eissing1">[11]</xref>, and synaptic memory switches <xref ref-type="bibr" rid="pcbi.1000122-Miller1">[12]</xref>–<xref ref-type="bibr" rid="pcbi.1000122-Kuroda1">[14]</xref>. Two observations emerge from this set of known switches. First, relatively few switches are known. A recent computational exploration yielded only about 2% bistable models among those tested <xref ref-type="bibr" rid="pcbi.1000122-Paladugu1">[15]</xref>. Furthermore, no entries are annotated as bistable in either KEGG (331 pathways) or BIOCARTA (355 pathways). Somewhat at odds with this absence of bistable pathways in pathway databases, kinetic models of bistable pathways are more common. There are several bistable models in the signaling model databases DOQCS (10/69; <xref ref-type="bibr" rid="pcbi.1000122-Sivakumaran1">[16]</xref>) and BioModels.net (12/147; <xref ref-type="bibr" rid="pcbi.1000122-LeNovre1">[17]</xref>), coming to about 10% of recorded models. This may be an overrepresentation, due to modeling interest in bistability. In particular, there are several signaling models that explore bistability as a basis for synaptic memory <xref ref-type="bibr" rid="pcbi.1000122-Miller1">[12]</xref>–<xref ref-type="bibr" rid="pcbi.1000122-Kuroda1">[14]</xref>.</p><p>A second observation about the known bistable switches is that they are quite different in their chemical topologies. While feedback loops are a recurring motif <xref ref-type="bibr" rid="pcbi.1000122-Angeli1">[3]</xref>,<xref ref-type="bibr" rid="pcbi.1000122-Thomas1">[18]</xref>, there are some cases where enzyme saturation appears to play a role <xref ref-type="bibr" rid="pcbi.1000122-Hayer1">[13]</xref>, and others where the balance between competing reactions itself generates bistability <xref ref-type="bibr" rid="pcbi.1000122-Markevich1">[9]</xref>.</p><p>While signaling models tend to result in rather complex reaction systems, a distinct approach to the study of chemical bistability is driven from theoretical analyses of enzyme kinetics and flux reaction systems <xref ref-type="bibr" rid="pcbi.1000122-Angeli1">[3]</xref>,<xref ref-type="bibr" rid="pcbi.1000122-Craciun1">[5]</xref>. These studies show that very few reactions are needed to achieve bistability. This raises the interesting question of whether there are core sets of reactions, or motifs, that are embedded in all bistable chemical reaction systems, despite their diversity. A corollary is whether such a set of motifs may help to detect bistable sub-systems in complex biological signaling networks.</p><p>Necessary conditions for bistability, such as positive loops in the system Jacobian, have been well characterized <xref ref-type="bibr" rid="pcbi.1000122-Thomas1">[18]</xref>. Earlier work by Clarke <xref ref-type="bibr" rid="pcbi.1000122-Clarke1">[19]</xref> parametrically defines all steady states of a given reaction system, but does not yield specific solutions when concentrations and rate constants are given. Recent studies detect chemical switches by testing for correlates of bistability <xref ref-type="bibr" rid="pcbi.1000122-Angeli1">[3]</xref>,<xref ref-type="bibr" rid="pcbi.1000122-Craciun1">[5]</xref> or by looking for properties that frequently co-occur with bistability and, optionally, engineering bistability by minor modifications to such networks <xref ref-type="bibr" rid="pcbi.1000122-Paladugu1">[15]</xref>,<xref ref-type="bibr" rid="pcbi.1000122-Ferrell2">[20]</xref>,<xref ref-type="bibr" rid="pcbi.1000122-Guidi1">[21]</xref>. We sought to identify bistable systems without placing any “top-down” requirement on the mechanistic details, and use this unbiased search to reconstruct relationships between the switches.</p><p>Here we systematically explore chemical reaction space to show that bistable chemical switches are remarkably common. We show that all small bistable systems are related, and that larger ones frequently share motifs that may be predictive of bistability.</p></sec><sec id="s2"><title>Results</title><sec id="s2a"><title>Bistables Are Common</title><p>In our first phase of analysis, we began with a basis set of 12 reactions (<xref ref-type="fig" rid="pcbi-1000122-g001">Figure 1A</xref>) and systematically tested all reaction configurations involving 2 molecules, 3 molecules from 1 to 6 reactions, and 4 molecules from 1 to 3 reactions. In our second phase of analysis, we sampled a subset of possible reaction configurations involving 3 molecules from 7 to 15 reactions, 4 molecules from 4 to 5 reactions, and 5 molecules from 1 to 4 reactions. The number of possible configurations rose rapidly with the number of molecules and reactions (<xref ref-type="fig" rid="pcbi-1000122-g001">Figure 1D</xref>), and it took longer to test each configuration for bistability, hence we sampled a small subset of configurations for the second phase of analysis. For each configuration we generated ∼100 models using Monte Carlo assignment of concentration and rate parameters (see <xref ref-type="sec" rid="s4">Methods</xref> section) and tested each for bistability. The propensity of a configuration for bistability was defined as the fraction of tested models for that configuration that exhibited two or more stable steady states.</p><fig id="pcbi-1000122-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000122.g001</object-id><label>Figure 1</label><caption><title>Finding Bistability.</title><p>(A) Basis set of reactions with signatures and examples. Reactions C, D, J, K, and L are enzymatic and the enzyme name is at the bend of the arrow. (B) Flowchart for finding bistability. (C) Example of steps 1–4 in the flowchart. (D) Number of possible configurations rises steeply with increasing number of molecules and initially also with the number of reactions. Shaded region indicates configurations fully sampled in this study, the remainder were subsampled. (E) Bistable configurations initially become more common with increasing numbers of reactions, and for 3 molecules the percentage declines for more than 6 reactions. (F) Bistability must persist over a wide parameter range to be detected. Fraction of parameter range = <sup>#parameters</sup>√(Propensity). Model class is expressed as m×n where m is the number of molecules and n is the number of reactions. (G) Frequency of occurrence of bistability as a function of propensity. Some configurations exhibit bistability over 30% of any parameter set in our selected range.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000122.g001" xlink:type="simple"/></fig><p>We observed a large number of bistable systems even with our very sparse sampling of reaction parameter space (<xref ref-type="fig" rid="pcbi-1000122-g001">Figure 1E</xref>). 3,562 of the fully sampled configurations (∼10%) had at least one bistable model, and 918 of the larger reaction systems (∼5%) did. This large percentage was surprising for two reasons. First, known bistable configurations from biology are rare, as discussed above. Second, our sampling of parameter space was very sparse, so we would be likely to detect bistable configurations only if they remained bistable in a substantial portion of parameter space. Most known chemical bistable switches exhibit bistability in a relatively narrow range of parameters rarely exceeding a factor of two <xref ref-type="bibr" rid="pcbi.1000122-Markevich1">[9]</xref>,<xref ref-type="bibr" rid="pcbi.1000122-Bhalla2">[22]</xref>. While a factor of two may be substantial from a biological viewpoint, we required a 30-fold range to detect bistability. This was because even small models have a large number of parameters. For instance, a 3 molecule, 3 reaction system has 7 parameters. In order to obtain bistability in 1% of tested models of this configuration, bistability would have to be present over approximately half the sampling range (<xref ref-type="fig" rid="pcbi-1000122-g001">Figure 1F</xref>) for each parameter: (0.5)<sup>7</sup>∼0.01. Our logarithmic sampling spanned 3 orders of magnitude, so half this range is about 30-fold for each parameter. A few configurations had a propensity of over 50% (<xref ref-type="fig" rid="pcbi-1000122-g001">Figure 1G</xref>). This suggests that bistability in these systems is very robust.</p><p>Admittedly, due to our sparse sampling of parameter space, there could be undetected bistables in the space of systems sampled here. While a single configuration is sufficient to prove that a network has the capability for exhibiting bistability, our analysis methods do not support an impossibility proof for bistability. The range in which a system exhibits bistability can depend intricately on how the phase space is structured in terms of the system parameters such as molecule concentrations and rate constants. Bifurcation analysis can shed insight into parameter ranges feasible for realizing bistability. Nevertheless, even with the possibility of false negatives, it is significant that nearly 10% of explored systems are bistable and this percentage can only improve with greater analysis and exploration.</p></sec><sec id="s2b"><title>Bistables Are Diverse</title><p>The simplest bistable system (3×2M101) involved 3 molecules and 2 reactions (<xref ref-type="fig" rid="pcbi-1000122-g002">Figure 2A</xref>). We tested its switch-like behavior by introducing perturbations from its stable states (<xref ref-type="fig" rid="pcbi-1000122-g002">Figure 2C</xref>). Small perturbations in 3×2M101 (small arrows in <xref ref-type="fig" rid="pcbi-1000122-g002">Figure 2C</xref>) caused transients which return to the originating stable state whereas large perturbations (large arrows) caused state flips. An intuitively appealing simpler system with only 2 molecules (<xref ref-type="fig" rid="pcbi-1000122-g002">Figure 2B</xref>) turned out not to be bistable with our mass-action formulation for enzymes (<xref ref-type="supplementary-material" rid="pcbi.1000122.s001">Text S1</xref>).</p><fig id="pcbi-1000122-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000122.g002</object-id><label>Figure 2</label><caption><title>Example Bistable Models.</title><p>(A) The simplest configuration, 3×2M101, i.e., having 3 molecules, 2 reactions, and being the 101st configuration in this class. (B) A simpler model that is bistable with Michaelis–Menten/Briggs–Haldane kinetics, but not with a mass action explicit representation of the enzyme-substrate complex. (C) Time-course of response of 3×2M101 to perturbations. (D) Stability diagram of 3×2M101, as a function of c0 (initial concentration of c). The bistable region is shaded. The specific model in panel A has c0 indicated by the dashed line. (E) All the 3×3 bistable configurations. (F) Two configurations with bistability propensity &gt;70%. Model 3×3M445 in (E) is also over 70%. Note the model similarities and symmetry. (G) Three non-autocatalytic configurations with propensity 26%, 23%, and 16%, respectively. (H) Schematic of stability curve for an autocatalytic reaction (inset, thin arrow). There is a stable point at 0, and a saddle at 1. Addition of a rapidly saturating fast back-reaction (inset, thick arrow, and graph, crosses) converts this to a bistable model with the same configuration as (A). Now the stability curve (thick line) has a stable at 0, a saddle at ∼0.05, and another stable at ∼0.9.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000122.g002" xlink:type="simple"/></fig><p>Positive feedback loops, such as autocatalysis and catalytic loops, have been implicated as a common motif leading to bistability in signaling <xref ref-type="bibr" rid="pcbi.1000122-Angeli1">[3]</xref>,<xref ref-type="bibr" rid="pcbi.1000122-Thomas1">[18]</xref>,<xref ref-type="bibr" rid="pcbi.1000122-Kholodenko1">[23]</xref>. In our study, autocatalysis (reactions D and L) was frequently present in bistable models, but it was not necessary. When we excluded autocatalysis from small reaction systems with only 3 molecules, there were fewer possible reaction configurations and a ten-fold reduction in percentage of bistable configurations. However, autocatalysis had little effect on the percentage of bistable configurations for 4 and 5 molecules (<xref ref-type="fig" rid="pcbi-1000122-g003">Figure 3</xref>).</p><fig id="pcbi-1000122-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000122.g003</object-id><label>Figure 3</label><caption><title>Effects of Autocatalysis.</title><p>(A) Number of nonautocatalytic configurations as a function of number of reactions. (B) Percentage of bistable configurations for 3, 4, and 5 molecules as a function of number of reactions. Same symbols as in (A). (C) Comparison of bistability percentage for entire dataset (<italic>x</italic> axis) and set without autocatalysis (<italic>y</italic> axis). The thick line indicates equal percentages. 3-molecule systems have fewer bistables without autocatalysis, but 4 and 5 molecule systems have nearly equal bistables if autocatalytic reactions are excluded. The different points on each plot are for numbers of reactions. As bistability declines for large reaction numbers for 3 molecules, this curve folds back on itself.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000122.g003" xlink:type="simple"/></fig><p>In addition to autocatalysis, we found several cases where bistability arose from more subtle chemical interactions (e.g., <xref ref-type="fig" rid="pcbi-1000122-g002">Figure 2G and 2F</xref> and <xref ref-type="fig" rid="pcbi-1000122-g003">3</xref>×3M40 in <xref ref-type="fig" rid="pcbi-1000122-g002">Figure 2E</xref>). Such reaction sets would have been difficult to identify as bistable by searching for similarities to published networks <xref ref-type="bibr" rid="pcbi.1000122-Milo1">[24]</xref>,<xref ref-type="bibr" rid="pcbi.1000122-Prill1">[25]</xref>. Interestingly, all our switches had exactly two stable states; the lack of higher levels of multi-stability may simply be due to our sparse sampling of parameter combinations.</p></sec><sec id="s2c"><title>Uniqueness of Bistables</title><p>Are all discovered bistables distinct? Because isomorphisms were removed at the time of generating possible reaction signatures, we ensured that each discovered bistable mapped to a unique signature composed of the 12 basic reaction types. A remaining concern was that there might be equivalences in terms of the underlying dynamical system when the chemical systems were converted to mathematical models. We investigated this possibility by reducing all the composite reactions to approximate equivalences in the form of either a single reactant-single product reaction (type A) or a double reactant-single product reaction (type E) (see <xref ref-type="sec" rid="s4">Methods</xref> section and <xref ref-type="supplementary-material" rid="pcbi.1000122.s003">Figure S2</xref>). We emphasize that these are “approximate” equivalences, for the following three reasons. First, many higher-order reactions required the inclusion of intermediate molecular species which were not present in the mathematical formulation of the original basis reactions. Second, the expanded reactions treated enzyme-substrate complexes as distinct molecular species having their own trajectories beginning from non-zero concentrations, whereas E-S complexes in the original reactions were initialized to zero in our modeling (see <xref ref-type="sec" rid="s4">Methods</xref>). Third, backward rates from the E-S complexes to the reactants were assumed to be zero in our original modeling (e.g., for reactions C, D, J) whereas in the expanded modeling all reactions (forward and backward) have non-zero reaction rates. With these caveats in mind, we found situations where configurations were isomorphic according to our approximate mappings and both were bistable (<xref ref-type="supplementary-material" rid="pcbi.1000122.s003">Figure S2</xref>, frame B), and also cases where the configurations were approximately equivalent but one was bistable, and the others were not (<xref ref-type="supplementary-material" rid="pcbi.1000122.s003">Figure S2</xref>, frames C and D). These examples reveal that composite reactions such as are commonly used in biochemistry and in our study, complicate stability analysis in two ways. First, they may hide mechanistic similarities between systems. This can be addressed by expanding composite reactions into more basic steps, as we have done. Second, they may hide key assumptions such as intermediate species and fundamental reaction steps, which may cause major differences in the dynamical behavior of the reaction system. While this issue is important from a rigorous mathematical viewpoint, we point out that such approximations are inevitable when translating cellular biochemistry into idealized mathematical forms. We suggest that in many cases bistability is indeed preserved across approximations (e.g., <xref ref-type="supplementary-material" rid="pcbi.1000122.s003">Figure S2</xref>, frame B). Our study provides a framework for further systematic analysis of this question.</p></sec><sec id="s2d"><title>Bistables Are Related</title><p>Does bistability “run” in families of related reaction topologies? To test this hypothesis, we constructed a directed acyclic graph (DAG) of configurations where each bistable configuration was a node, and each addition/removal of a reaction between nodes was an edge. We found that almost all bistable configurations from the first phase (3,415/3,562 = 95.9%) formed a single, highly interconnected set, i.e., a giant component. Most of the 147 “orphans” occurred at the boundaries of our sampling (98 at 3×6 and 47 at 4×3). These may simply represent novel ‘roots’ that connect further up in the reaction hierarchy. In <xref ref-type="fig" rid="pcbi-1000122-g004">Figure 4A</xref>, the DAG is represented as a multiply rooted “banyan-tree” like diagram where there is one main root (3×2M101) and multiple higher-order roots linked to the primary root through more complex, bistable “branches”. We may have missed low-propensity bistable configurations, so it is possible that isolated islands of lower propensity may be present. Conversely, it is also possible that finer sampling may uncover intermediate bistable systems that link orphan configurations into the DAG. We constructed a radial diagram restricted to those configurations that were derived from the simplest bistable configuration (3×2M101, <xref ref-type="fig" rid="pcbi-1000122-g004">Figure 4B</xref>). In <xref ref-type="fig" rid="pcbi-1000122-g004">Figure 4A and 4B</xref>, there was an apparent clustering of high-propensity nodes. We investigated this further by comparing projections of <xref ref-type="fig" rid="pcbi-1000122-g004">Figure 4A</xref> onto high-propensity nodes. A giant component persisted even when we increased the threshold for bistability propensity from &gt;0 to ≥0.3 (<xref ref-type="supplementary-material" rid="pcbi.1000122.s002">Figure S1</xref>, frame A). This showed that highly bistable systems form a connected subgraph in the graph of all bistable systems. The much smaller non-autocatalytic subset of bistables was also multiply rooted with a giant component and a few separated nodes (<xref ref-type="supplementary-material" rid="pcbi.1000122.s002">Figure S1</xref>, frame B).</p><fig id="pcbi-1000122-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000122.g004</object-id><label>Figure 4</label><caption><title>Bistability Runs in Families.</title><p>(A,B) Representations of relationships between bistable configurations. Node color represents bistability propensity. Color scales for (A) and (B) are the same. (A) “Banyan tree” diagram showing multiple “root” bistable configurations that cannot be generated by addition of a single reaction to a smaller bistable configuration but are connected through larger configurations. Model classes are labeled on the left. Nodes are staggered vertically within bands for visualization. “Root” edges are in sky blue and deeper edges are in green. On the left are orphan models. (B) Minimum spanning tree rooted at 3×2M101. Inner nodes with smaller reaction sizes are drawn as larger circles. A few 3×3 bistables and the primarily low propensity systems they derive are not shown to minimize crowding. The “pie” denotes restriction of exploration of 4 molecule systems to only 3 reactions in this study. (C) The number of novel bistables drops sharply in larger reaction systems.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000122.g004" xlink:type="simple"/></fig><p>These graphs suggested that most bistable systems were derived from smaller ones. As reactions were added (<xref ref-type="fig" rid="pcbi-1000122-g004">Figure 4C</xref>), we encountered a decreasing number of novel bistables (i.e., cases that could not be derived by addition of a reaction to a smaller bistable configuration). This suggests that bistable systems involving small numbers of molecules may form the architectural core of more complex reaction networks that are also bistable.</p></sec><sec id="s2e"><title>Relationship to Published Bistables</title><p>We tested two implications of the “bistables are related” observation. First, we asked if we could take a large published bistable system and remove one reaction at a time without losing bistability. If we could continue this process till we ended up at a bistable configuration present in our dataset, then we had a continuous trajectory from our known DAG of bistables to the published model. Second, we asked if the large bistable system was a superset of a known bistable configuration, without requiring that there were intermediate bistables between the two. We performed this analysis on several known bistable reaction systems from published work (<xref ref-type="fig" rid="pcbi-1000122-g005">Figure 5</xref>). We found that in four of these cases, the published bistables were either already among our catalog, or had a subset of reactions that was bistable. In the remaining three configurations, there was neither a connection between the published models to the tree, nor was there a subset of reactions that was bistable in the DAG.</p><fig id="pcbi-1000122-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000122.g005</object-id><label>Figure 5</label><caption><title>Known Bistables.</title><p>(A,B) Published bistables from <xref ref-type="bibr" rid="pcbi.1000122-Ferrell2">[20]</xref>. These are already present in our DAG. (C,D) Published bistables from <xref ref-type="bibr" rid="pcbi.1000122-Brandman1">[6]</xref> and <xref ref-type="bibr" rid="pcbi.1000122-Markevich1">[9]</xref>. These can be reduced to smaller models and have some bistable motifs from our dataset. (E,F) Bistables from <xref ref-type="bibr" rid="pcbi.1000122-Craciun1">[5]</xref>. (G) Bistable from <xref ref-type="bibr" rid="pcbi.1000122-Eissing1">[11]</xref>. None of (E), (F), and (G) had motifs from our dataset.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000122.g005" xlink:type="simple"/></fig><p>We therefore hypothesized that the DAG of bistables may be nearly complete for small systems, but the increasing degrees of freedom afforded by greater numbers of molecules and reactions helped realize bistability in new, unseen, ways. We developed two analysis tools that work in complementary ways to explore such larger configurations.</p></sec><sec id="s2f"><title>The “Bistabilizer”</title><p>A suggestive observation from our first phase was that a large fraction of configurations (∼60%) contained saddle points and line solutions (<xref ref-type="supplementary-material" rid="pcbi.1000122.s001">Text S1</xref>). Most of these saddles (80.8% of the non-bistable set) occurred when the concentration of all but one molecule in the system was zero. A simple example of this is in <xref ref-type="fig" rid="pcbi-1000122-g002">Figure 2H</xref>, where molecule <bold>b</bold> catalyzes its own formation from <bold>a</bold>. When <bold>b</bold> is at zero, <bold>a</bold> does not change – it is metastable. However, the addition of a small amount of <bold>b</bold> causes the system to ‘fall’ into a truly stable state where all molecules have been converted into <bold>b</bold>. As has been previously analyzed <xref ref-type="bibr" rid="pcbi.1000122-Ferrell2">[20]</xref> a rapid but saturating back-reaction is one way to convert this into a true stable system. This can be done using an enzyme to remove <bold>b</bold> more rapidly than it builds up, at low levels of <bold>b</bold> (<xref ref-type="fig" rid="pcbi-1000122-g002">Figure 2H</xref>). In this case, we reconstruct our original simplest bistable system (compare <xref ref-type="fig" rid="pcbi-1000122-g002">Figure 2A and 2H</xref>). We developed an algorithm that introduced several reactions to achieve bistability using this approach, in a general but not necessarily minimal manner. Due to the added reaction complexity, we generated bistables from non-bistable systems involving only 3 molecules and up to 5 reactions. The bistabilizer added at least 2 molecules, 3 enzymes and a reaction for each converted saddle point. We were able to generate a 5-fold higher proportion of bistables than were present in the source configurations in a sample of 70,000 models. This construction may usefully complement bifurcation discovery tools <xref ref-type="bibr" rid="pcbi.1000122-Chickarmane1">[26]</xref> to generate and refine bistable configurations.</p></sec><sec id="s2g"><title>Frequent Motif Mining</title><p>Our second tool used motif matching. We analyzed the configurations of smaller bistables plus the sparsely sampled larger bistables to find frequently occurring groups of reactions, and then searched for these motifs in unexplored configurations. We analyzed bistables in each configuration class (3 molecules, 4 molecules, 5 molecules) separately for frequent motifs. A motif must occur with sufficient frequency in the given class to be detected (see <xref ref-type="supplementary-material" rid="pcbi.1000122.s001">Text S1</xref> for frequency thresholds used). Because motifs are subsets of chemical reaction systems, they may not quite have the same number of molecules as the class of systems from which they are mined; for instance, a motif mined from 5-molecule bistable systems may not itself have 5 molecules. Furthermore, observe that while a motif is a subset of reactions that is well-represented in bistable systems, it may not be bistable. We found the greatest number of motifs (1615) from 3-molecule systems, and smaller numbers for 4 and 5 molecules (143 and 28, respectively), probably because our initial harvesting of bistables in the larger systems had yielded fewer confirmed bistables to scan for motifs.</p><p>The motifs were mostly independent and only one motif occurred in all three reaction classes. Coincidentally, this common, two-reaction, motif (composed of reactions DabX and Jbca) was identical to a bistable found both in our analysis and in previous work (<xref ref-type="bibr" rid="pcbi.1000122-Ferrell2">[20]</xref>; <xref ref-type="fig" rid="pcbi-1000122-g002">Figure 2A</xref> and <xref ref-type="fig" rid="pcbi-1000122-g005">5A</xref>). This motif/bistable also occurred in the top-5 motifs mined for each class when the motifs were ranked by their frequencies (<xref ref-type="fig" rid="pcbi-1000122-g006">Figure 6A–C</xref>). Interestingly, four of the top-5 motifs in the 3 molecule case contained at least one of reaction D or reaction J and all of the top-5 motifs in the 4 molecule case contained at least one of these two reactions. In the case of 5 molecules, only two of the top-5 motifs involved either D or J, though our much smaller sample set may have led to skewed results in this case. The remaining top-5 motif among the 3 molecule systems and the three other top-5 motifs in the 5-molecule systems utilized basic reversible reaction types such as A, B, F, G, H, and I that did not involve autocatalysis or even basic enzyme catalysis.</p><fig id="pcbi-1000122-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000122.g006</object-id><label>Figure 6</label><caption><title>Motifs in Bistable Switches.</title><p>(A–C) Top 5 motifs mined for 3-molecule, 4-molecule, and 5-molecule bistable systems. (D) Motifs improve search for bistables by about 7-fold, for each of the reaction classes tested. (E) Venn diagram of motifs among different classes of reaction configurations. The one motif shared by all classes of configurations is the same as the smallest bistable, model M101.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000122.g006" xlink:type="simple"/></fig><p>Just as a motif occurred in multiple bistable systems, a given bistable system could exhibit many distinct motifs. We used this property to advantage to help rank untested configurations for their potential to exhibit bistability. In each configuration class (3-molecule, 4-molecule, or 5-molecule systems), we searched for motifs specific to that class, and ranked the (untested) configurations in terms of the number of motifs they exhibited. We evaluated ≥100 of the top configurations for each class, exploring 120 parameter sets for each. We found bistability in 96% of the 3 molecule systems (214/222), 49% of the 4 molecule systems (49/100), and 13% of the 5 molecule systems (82/641). These numbers significantly improved upon the random sampling results of the second phase of analysis (<xref ref-type="fig" rid="pcbi-1000122-g006">Figure 6D</xref>).</p><p>Finally, we compared the motifs across the three classes (3, 4, and 5 molecule systems) to investigate whether there were any overlaps in mechanisms by which 3-molecule, 4-molecule, and 5-molecule systems exhibit bistability. On face value, there was little overlap between the motif sets taken pairwise (<xref ref-type="fig" rid="pcbi-1000122-g006">Figure 6E</xref>). To understand the distinctions better, we searched for all three sets of motifs in all three classes of bistable systems. For each motif, we counted its frequency in each class and identified the absolute value of the difference in frequencies across classes. The median difference in frequency is cataloged in <xref ref-type="table" rid="pcbi-1000122-t001">Table 1</xref> which shows that the motifs in 4-molecule systems were more similar to those in 5-molecule systems than either to 3-molecule systems. This suggests that there are qualitatively different mechanisms for bistability vis-à-vis 3 molecule systems and higher molecular systems.</p><table-wrap id="pcbi-1000122-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000122.t001</object-id><label>Table 1</label><caption><title>Median Difference in Frequency of Motif Sets Searched across Different Classes of Bistable Systems.</title></caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1000122-t001-1" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000122.t001" xlink:type="simple"/><table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup><thead><tr><td align="left" colspan="1" rowspan="1"/><td align="left" colspan="1" rowspan="1">3xn</td><td align="left" colspan="1" rowspan="1">4xn</td><td align="left" colspan="1" rowspan="1">5xn</td></tr></thead><tbody><tr><td align="left" colspan="1" rowspan="1">3xn</td><td align="left" colspan="1" rowspan="1">–</td><td align="left" colspan="1" rowspan="1">15%</td><td align="left" colspan="1" rowspan="1">29%</td></tr><tr><td align="left" colspan="1" rowspan="1">4xn</td><td align="left" colspan="1" rowspan="1">21.5%</td><td align="left" colspan="1" rowspan="1">–</td><td align="left" colspan="1" rowspan="1">1.6%</td></tr><tr><td align="left" colspan="1" rowspan="1">5xn</td><td align="left" colspan="1" rowspan="1">45%</td><td align="left" colspan="1" rowspan="1">3.5%</td><td align="left" colspan="1" rowspan="1">–</td></tr></tbody></table></alternatives><table-wrap-foot><fn id="nt101"><label/><p>Rows: Motif set. Columns: Class of bistable systems.</p></fn></table-wrap-foot></table-wrap></sec></sec><sec id="s3"><title>Discussion</title><p>Our study draws the first stability map of chemical reaction space. We find that bistables are common, especially in smaller reaction systems. They are also very robust, i.e., we find many configurations that are bistable over a very wide parameter range. Smaller bistables are all related to each other in a tree-like manner. While the overall configurations that support bistability are very diverse, there are frequently recurring motifs of reaction groupings in such configurations. These motifs serve to identify promising candidates in higher order systems.</p><sec id="s3a"><title>A Resource for Studying Bistability</title><p>Signaling motifs have been regarded as a good way to abstract out the chemical complexity of signaling <xref ref-type="bibr" rid="pcbi.1000122-Tyson1">[4]</xref>,<xref ref-type="bibr" rid="pcbi.1000122-Milo1">[24]</xref>. Specifically, positive feedback loops have long been considered good indicators for bistability. Our study shows that such broad network features are inadequate. The simplest form of positive feedback, that is, autocatalysis, is a good predictor for bistability only in very small reaction sets. In reactions with 4 or 5 molecules the proportion of bistables does not seem to depend on the presence or absence of autocatalysis (<xref ref-type="fig" rid="pcbi-1000122-g003">Figure 3</xref>). Instead we propose that our library of bistable configurations is a more complete and stronger approach. Our catalog, available from the DOCSS (Database of Chemical Stability Space) website at <ext-link ext-link-type="uri" xlink:href="http://docss.ncbs.res.in" xlink:type="simple">http://docss.ncbs.res.in</ext-link>, provides complete model descriptions in chemical reaction signature format, as well as selected bistables in SBML format. Together with recent methods to reduce chemical networks to their core reactions <xref ref-type="bibr" rid="pcbi.1000122-Liu1">[27]</xref>,<xref ref-type="bibr" rid="pcbi.1000122-Maurya1">[28]</xref>, our catalog may open up chemical and bioinformatics approaches to searching for bistability in biochemical signaling pathways.</p></sec><sec id="s3b"><title>Evolutionary Implications</title><p>Bistable switches are important in biology in maintaining cellular history and decisions. Our study shows that there is a large repertoire of such switches for natural selection to draw upon, including many very simple switches. Furthermore, several of these switches are highly robust with respect to parameter variations. This has two implications for evolution. First, it is easy for evolving biochemical networks to stumble upon parameters that will give a switch. Second, such switches themselves will work effectively over a wide range of parameter conditions. The relatedness of the switches through addition or removal of individual reactions is also a good substrate for evolutionary modification. For example, a mutation that adds another enzyme regulator to a bistable switch is, by this argument, quite likely to retain the original bistability, along with the new regulatory properties. Overall, our survey of chemical topologies hints at an interconnected and rather well-populated terrain of bistability in a biologically biased region of chemical space.</p></sec></sec><sec id="s4"><title>Methods</title><sec id="s4a"><title>Modeling Chemical Reaction Space</title><p>We selected a set of 12 primary chemical reaction steps (<xref ref-type="fig" rid="pcbi-1000122-g001">Figure 1A</xref>) as the “alphabet” from which we performed our exhaustive search of chemical reaction space. In principle a small set of reactions may suffice to build up to arbitrary reaction schemes. For instance, using two reactions of type E<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000122.e001" xlink:type="simple"/></disp-formula>we can realize the higher order enzymatic reaction<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000122.e002" xlink:type="simple"/></disp-formula>which is reaction J in our system, by modeling it as a composite of<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000122.e003" xlink:type="simple"/></disp-formula></p><p>Our choice of primary chemical steps was biologically-inspired. In other words, we found a different proportion of bistables than we would see if we used, say, only the most elementary reactions such as type A and type E (<xref ref-type="supplementary-material" rid="pcbi.1000122.s003">Figure S2</xref>). Instead we reduced the parameter space by using biologically-inspired composite reactions, and hence sampled more completely in biological chemistry space. From this set of 12 primary chemical reaction steps, we constructed all possible reaction configurations involving 2 or 3 molecules, 4 molecules up to 5 reactions, and 5 molecules up to 4 reactions. This was a total of ∼2,800,000 configurations. These reaction configurations were topological: they defined the molecules and chemical steps, but did not specify concentrations or kinetic parameters.</p><p>We constructed reaction architectures involving <italic>m</italic> molecules as follows. We first selected one reaction out of the set of 12 reactions. We then assigned molecules to the slots of the reaction. For example, the reaction <italic>J</italic> has three slots, so we could assign molecules a, b, and c to this reaction. Having set up the first reaction, we then repeated the process <italic>n</italic> – 1 times to obtain a configuration of <italic>m</italic> molecules and <italic>n</italic> reactions (<xref ref-type="fig" rid="pcbi-1000122-g001">Figure 1</xref>). We eliminated all stoichiometrically invalid configurations by row-reducing the augmented stoichiometric matrix and checking for conserved moieties <xref ref-type="bibr" rid="pcbi.1000122-Sauro1">[29]</xref>. We repeated this entire process for all possible permutations of the <italic>m</italic> molecules. Similar approaches have been employed at a more elementary level of chemical reactive species to computationally analyze reaction systems <xref ref-type="bibr" rid="pcbi.1000122-Nmeth1">[30]</xref>,<xref ref-type="bibr" rid="pcbi.1000122-Fic1">[31]</xref>.</p></sec><sec id="s4b"><title>Signature Typing</title><p>We signed each reaction with a terse unique 4-character string that completely specified all reactants and products, so that the first character of a reaction signature denotes one of the 12 reaction types (A–L), and the remaining two or three characters denote the molecular species participating in various roles in the reaction. The signature for a reaction architecture was obtained by concatenating the signatures for the constitutent reactions. We checked for isomorphic signatures (see <xref ref-type="supplementary-material" rid="pcbi.1000122.s001">Text S1</xref>) and only one signature per unique system was retained. The number of such unique, stoichiometrically valid reaction architectures was combinatorially large (<xref ref-type="fig" rid="pcbi-1000122-g001">Figure 1D</xref>). As further reactions were added, the number of possible configurations peaked and then declined because of stoichiometric constraints and symmetry (<xref ref-type="fig" rid="pcbi-1000122-g001">Figure 1D</xref>).</p><p>Our set of configurations did not deal with two cases that have previously been analyzed for bistability: continuous flux and buffered systems <xref ref-type="bibr" rid="pcbi.1000122-Guidi1">[21]</xref>. Instead our reactions required that there was mass conservation among the named molecules, but did permit the presence of ‘hidden’ molecules that were folded into the rate terms. Thus we represented a kinase reaction as an elementary enzymatic step, by “hiding” the ATP and ADP exchange: Substrate–Kinase → Product.</p><p>In this manner our reaction systems also accommodated steady state cases where continuous metabolic input was necessary to sustain stability. We stipulated that these ‘hidden’ molecules were stoichiometrically balanced within individual reactions, such as the enzymatic step above. We were able to approximate many cases of buffering simply by having a high concentration of the ‘buffered’ species.</p></sec><sec id="s4c"><title>Parameterization</title><p>In order to assess bistability we needed to work with specific models, with all parameters specified. We generated at least 100 models for each configuration we tested. Each model was generated from one of the configurations using Monte Carlo sampling to assign rate constants and concentrations. We chose concentrations using logarithmic sampling in the range 10 nM to 10 µM. This spans the concentration range of most biochemical reagents. We chose rate constants using logarithmic sampling in the range 0.01 µM<sup>−<italic>N</italic></sup> s<sup>−1</sup> to 10 µM<sup>−<italic>N</italic></sup> s<sup>−1</sup>, where <italic>N</italic> was the order of the reaction from 0 to 4. Again, these rates were chosen to span the common range of biochemical reaction parameters.</p><p>Due to computational limitations we sampled only the smaller reaction sets completely for bistability. We completely sampled all configurations with 2 molecules, 3 molecules up to 6 reactions, and 4 molecules up to 3 reactions (<xref ref-type="fig" rid="pcbi-1000122-g001">Figure 1A–C</xref> and <xref ref-type="supplementary-material" rid="pcbi.1000122.s001">Text S1</xref>). This amounted to a total of 100,000 configurations and ∼20e6 models, sampling at least 100 models per configuration. We sampled the remaining reaction sets more sparsely, mostly 1 in 100, but we used 1 in 1,000 sampling for the very large 4×5 and 5×4 reaction sets.</p></sec><sec id="s4d"><title>Identifying Steady States</title><p>We found steady states for each model using two distinct methods: homotopy continuation <xref ref-type="bibr" rid="pcbi.1000122-Sommese1">[32]</xref> and time course analysis (<xref ref-type="supplementary-material" rid="pcbi.1000122.s001">Text S1</xref>). Briefly, homotopy continuation finds steady states by tracking solution paths of systems of simultaneous equations. Time-course analysis simulates models from a number of distinct initial conditions toward steady states. Neither of these methods determined the global bifurcation behavior of the reaction system: they only identified fixed points of the fully parameterized model. We classified solutions as <italic>stable</italic>, <italic>saddle</italic>, or <italic>other</italic> using eigenvalue calculation and simulation around steady states (<xref ref-type="supplementary-material" rid="pcbi.1000122.s001">Text S1</xref>).</p></sec></sec><sec id="s5"><title>Supporting Information</title><supplementary-material id="pcbi.1000122.s001" mimetype="application/msword" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000122.s001" xlink:type="simple"><label>Text S1</label><caption><p>Supplementary Information about Methods and Algorithms To Accompany the Main Text of the Paper.</p><p>(0.11 MB DOC)</p></caption></supplementary-material><supplementary-material id="pcbi.1000122.s002" mimetype="application/postscript" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000122.s002" xlink:type="simple"><label>Figure S1</label><caption><p>Minimum Spanning Tree (A) and Banyan Tree Graph (B). (A) Minimum spanning tree derived from high propensity configurations (rooted at 3×3M445). Inner nodes with smaller reaction sizes are drawn as larger circles. Four levels of the giant component are shown that shrinks but remains connected as the propensity threshold is raised. Dark blue is the range 0&lt;propensity&lt;0.1, white is propensity ≥0.3. (B) “Banyan tree” graph of nonautocatalytic models, with a few orphan systems. Color scale indicates propensity of configurations.</p><p>(1.29 MB EPS)</p></caption></supplementary-material><supplementary-material id="pcbi.1000122.s003" mimetype="application/postscript" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000122.s003" xlink:type="simple"><label>Figure S2</label><caption><p>Isomorphic Mappings. (A) Table of Isomorphic Mappings from the Original 12-Reaction Set to a Minimal Set Consisting of Reactions A and E. Note that many mappings require the formation of intermediate molecular species and that enzyme reactions become bidirectional during the expansion. (B) An example of an isomorphic mapping where bistability is preserved, despite the change from unidirectional enzyme to two bidirectional conversion reactions. (C,D) Examples of isomorphic mappings that lose bistability. In both cases, the bistability is lost because the expanded form of an enzyme contains two bidirectional reactions, which can also be mapped to an enzyme with the reverse direction.</p><p>(0.24 MB EPS)</p></caption></supplementary-material></sec></body><back><ack><p>We thank Sanjay Jain, Dennis Bray, Charles Wampler II, and Layne Watson for many ideas on the project. Vishal Surana and Evan Maxwell helped verify the results obtained from frequent motif mining. We acknowledge the use of the Anantham and System X clusters at Virginia Tech on which our simulations were conducted. We thank Harsha Rani for setting up the DOCSS web page and SBML conversions of models.</p></ack><ref-list><title>References</title><ref id="pcbi.1000122-Kuramoto1"><label>1</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Kuramoto</surname><given-names>Y</given-names></name></person-group>             <year>2003</year>             <article-title>Chemical Oscillations, Waves and Turbulence.</article-title>             <publisher-loc>Mineola (New York)</publisher-loc>             <publisher-name>Dover Publications</publisher-name>          </element-citation></ref><ref id="pcbi.1000122-Shoji1"><label>2</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Shoji</surname><given-names>H</given-names></name><name name-style="western"><surname>Iwasa</surname><given-names>Y</given-names></name><name name-style="western"><surname>Kondo</surname><given-names>S</given-names></name></person-group>             <year>2003</year>             <article-title>Stripes, spots, or reversed spots in two-dimensional Turing systems.</article-title>             <source>J Theor Biol</source>             <volume>224 (3)</volume>             <fpage>339</fpage>             <lpage>350</lpage>          </element-citation></ref><ref id="pcbi.1000122-Angeli1"><label>3</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Angeli</surname><given-names>D</given-names></name><name name-style="western"><surname>Ferrell</surname><given-names>JE</given-names></name><name name-style="western"><surname>Sontag</surname><given-names>ED</given-names></name></person-group>             <year>2004</year>             <article-title>Detection of multistability, bifurcations, and hysteresis in a large class of biological positive-feedback systems.</article-title>             <source>Proc Natl Acad Sci USA</source>             <volume>101 (7)</volume>             <fpage>1822</fpage>             <lpage>1827</lpage>          </element-citation></ref><ref id="pcbi.1000122-Tyson1"><label>4</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Tyson</surname><given-names>JJ</given-names></name><name name-style="western"><surname>Chen</surname><given-names>KC</given-names></name><name name-style="western"><surname>Novak</surname><given-names>B</given-names></name></person-group>             <year>2003</year>             <article-title>Sniffers, buzzers, toggles and blinkers: dynamics of regulatory and signaling pathways in the cell.</article-title>             <source>Curr Opin Cell Biol</source>             <volume>15 (2)</volume>             <fpage>221</fpage>             <lpage>231</lpage>          </element-citation></ref><ref id="pcbi.1000122-Craciun1"><label>5</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Craciun</surname><given-names>G</given-names></name><name name-style="western"><surname>Tang</surname><given-names>Y</given-names></name><name name-style="western"><surname>Feinberg</surname><given-names>M</given-names></name></person-group>             <year>2006</year>             <article-title>Understanding bistability in complex enzyme-driven reaction networks.</article-title>             <source>Proc Natl Acad Sci USA</source>             <volume>103 (23)</volume>             <fpage>8697</fpage>             <lpage>8702</lpage>          </element-citation></ref><ref id="pcbi.1000122-Brandman1"><label>6</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Brandman</surname><given-names>O</given-names></name><name name-style="western"><surname>Ferrell</surname><given-names>JE</given-names><suffix>Jr</suffix></name><name name-style="western"><surname>Li</surname><given-names>R</given-names></name><name name-style="western"><surname>Meyer</surname><given-names>T</given-names></name></person-group>             <year>2005</year>             <article-title>Positive feedback loops drive reliable cell decisions.</article-title>             <source>Science</source>             <volume>310 (5747)</volume>             <fpage>496</fpage>             <lpage>498</lpage>          </element-citation></ref><ref id="pcbi.1000122-Ferrell1"><label>7</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Ferrell</surname><given-names>JE</given-names></name><name name-style="western"><surname>Machleder</surname><given-names>EM</given-names></name></person-group>             <year>1998</year>             <article-title>The biochemical basis of an all-or-none cell fate switch in Xenopus oocytes.</article-title>             <source>Science</source>             <volume>280 (5365)</volume>             <fpage>895</fpage>             <lpage>898</lpage>          </element-citation></ref><ref id="pcbi.1000122-Bhalla1"><label>8</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Bhalla</surname><given-names>US</given-names></name><name name-style="western"><surname>Ram</surname><given-names>PT</given-names></name><name name-style="western"><surname>Iyengar</surname><given-names>R</given-names></name></person-group>             <year>2002</year>             <article-title>MAP kinase phosphotase as a locus of flexibility in a mitogen-activated protein kinase signaling network.</article-title>             <source>Science</source>             <volume>297 (5583)</volume>             <fpage>1018</fpage>             <lpage>1023</lpage>          </element-citation></ref><ref id="pcbi.1000122-Markevich1"><label>9</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Markevich</surname><given-names>NI</given-names></name><name name-style="western"><surname>Hoek</surname><given-names>JB</given-names></name><name name-style="western"><surname>Kholodenko</surname><given-names>BN</given-names></name></person-group>             <year>2004</year>             <article-title>Signaling switches and bistability arising from multisite phosphorylation in protein kinase cascades.</article-title>             <source>J Cell Biol</source>             <volume>164 (3)</volume>             <fpage>353</fpage>             <lpage>359</lpage>          </element-citation></ref><ref id="pcbi.1000122-Novak1"><label>10</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Novak</surname><given-names>B</given-names></name><name name-style="western"><surname>Tyson</surname><given-names>JJ</given-names></name></person-group>             <year>2004</year>             <article-title>A model for restriction point control of the mammalian cell cycle.</article-title>             <source>J Theor Biol</source>             <volume>230 (4)</volume>             <fpage>563</fpage>             <lpage>579</lpage>          </element-citation></ref><ref id="pcbi.1000122-Eissing1"><label>11</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Eissing</surname><given-names>T</given-names></name><name name-style="western"><surname>Conzelmann</surname><given-names>H</given-names></name><name name-style="western"><surname>Gilles</surname><given-names>ED</given-names></name><name name-style="western"><surname>Allgower</surname><given-names>F</given-names></name><name name-style="western"><surname>Bullinger</surname><given-names>E</given-names></name><etal/></person-group>             <year>2005</year>             <article-title>Bistability analyses of a caspase activation model for receptor-induced apoptosis.</article-title>             <source>J Biol Chem</source>             <volume>279 (35)</volume>             <fpage>36892</fpage>             <lpage>36897</lpage>          </element-citation></ref><ref id="pcbi.1000122-Miller1"><label>12</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Miller</surname><given-names>P</given-names></name><name name-style="western"><surname>Zhabotinsky</surname><given-names>AM</given-names></name><name name-style="western"><surname>Lisman</surname><given-names>JE</given-names></name><name name-style="western"><surname>Wang</surname><given-names>X-J</given-names></name></person-group>             <year>2005</year>             <article-title>The stability of a stochastic CaMKII switch: dependence on the number of enzyme molecules and protein turnover.</article-title>             <source>PLoS Biol</source>             <volume>3 (4)</volume>             <fpage>e107. doi:10.1371/journal.pbio.0030107</fpage>          </element-citation></ref><ref id="pcbi.1000122-Hayer1"><label>13</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Hayer</surname><given-names>A</given-names></name><name name-style="western"><surname>Bhalla</surname><given-names>US</given-names></name></person-group>             <year>2005</year>             <article-title>Molecular switches at the synapse emerge from receptor and kinase traffic.</article-title>             <source>PLoS Comput Biol</source>             <volume>1 (2)</volume>             <fpage>137</fpage>             <lpage>154</lpage>          </element-citation></ref><ref id="pcbi.1000122-Kuroda1"><label>14</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Kuroda</surname><given-names>S</given-names></name><name name-style="western"><surname>Schweighofer</surname><given-names>N</given-names></name><name name-style="western"><surname>Kawato</surname><given-names>M</given-names></name></person-group>             <year>2001</year>             <article-title>Exploration of signal transduction pathways in cerebellar long-term depression by kinetic simulation.</article-title>             <source>J Neurosci</source>             <volume>21 (15)</volume>             <fpage>5693</fpage>             <lpage>5702</lpage>          </element-citation></ref><ref id="pcbi.1000122-Paladugu1"><label>15</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Paladugu</surname><given-names>SR</given-names></name><name name-style="western"><surname>Chickarmane</surname><given-names>V</given-names></name><name name-style="western"><surname>Deckard</surname><given-names>A</given-names></name><name name-style="western"><surname>Frumkin</surname><given-names>JP</given-names></name><name name-style="western"><surname>McCormack</surname><given-names>M</given-names></name><etal/></person-group>             <year>2006</year>             <article-title>In silico evolution of functional modules in biochemical networks.</article-title>             <source>IEE Proc Syst Biol</source>             <volume>153 (4)</volume>             <fpage>223</fpage>             <lpage>235</lpage>          </element-citation></ref><ref id="pcbi.1000122-Sivakumaran1"><label>16</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Sivakumaran</surname><given-names>S</given-names></name><name name-style="western"><surname>Hariharaputran</surname><given-names>S</given-names></name><name name-style="western"><surname>Mishra</surname><given-names>J</given-names></name><name name-style="western"><surname>Bhalla</surname><given-names>US</given-names></name></person-group>             <year>2003</year>             <article-title>The database of quantitative cellular signaling: management and analysis of chemical kinetic models of signaling networks.</article-title>             <source>Bioinformatics</source>             <volume>19 (3)</volume>             <fpage>408</fpage>             <lpage>415</lpage>          </element-citation></ref><ref id="pcbi.1000122-LeNovre1"><label>17</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Le Novère</surname><given-names>N</given-names></name><name name-style="western"><surname>Bornstein</surname><given-names>B</given-names></name><name name-style="western"><surname>Broicher</surname><given-names>A</given-names></name><name name-style="western"><surname>Courtot</surname><given-names>M</given-names></name><name name-style="western"><surname>Donizelli</surname><given-names>M</given-names></name><etal/></person-group>             <year>2006</year>             <article-title>BioModels database: a free, centralized database of curated, published, quantitative kinetic models of biochemical and cellular systems.</article-title>             <source>Nucleic Acids Res</source>             <volume>34</volume>             <fpage>D689</fpage>             <lpage>D691</lpage>          </element-citation></ref><ref id="pcbi.1000122-Thomas1"><label>18</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Thomas</surname><given-names>R</given-names></name></person-group>             <year>1994</year>             <article-title>The role of feedback circuits: Positive feedback circuits are a necessary condition for positive real eigenvalues of the Jacobian matrix.</article-title>             <source>Ber Bunsenges Phys Chem</source>             <volume>98 (9)</volume>             <fpage>1148</fpage>             <lpage>1151</lpage>          </element-citation></ref><ref id="pcbi.1000122-Clarke1"><label>19</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Clarke</surname><given-names>BL</given-names></name></person-group>             <year>1981</year>             <article-title>Complete set of steady states for the general stoichiometric dynamical system.</article-title>             <source>J Chem Phys</source>             <volume>75 (10)</volume>             <fpage>4970</fpage>             <lpage>4979</lpage>          </element-citation></ref><ref id="pcbi.1000122-Ferrell2"><label>20</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Ferrell</surname><given-names>JE</given-names></name><name name-style="western"><surname>Xiong</surname><given-names>W</given-names></name></person-group>             <year>2001</year>             <article-title>Bistability in cell signaling: how to make continuous processes discontinuous, and reversible processes irreversible.</article-title>             <source>Chaos</source>             <volume>11 (1)</volume>             <fpage>227</fpage>             <lpage>236</lpage>          </element-citation></ref><ref id="pcbi.1000122-Guidi1"><label>21</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Guidi</surname><given-names>GM</given-names></name><name name-style="western"><surname>Goldbeter</surname><given-names>A</given-names></name></person-group>             <year>1997</year>             <article-title>Bistability without hysteresis in chemical reaction systems: a theoretical analysis of irreversible transitions between multiple steady states.</article-title>             <source>J Phys Chem A</source>             <volume>101 (49)</volume>             <fpage>9367</fpage>             <lpage>9376</lpage>          </element-citation></ref><ref id="pcbi.1000122-Bhalla2"><label>22</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Bhalla</surname><given-names>US</given-names></name><name name-style="western"><surname>Iyengar</surname><given-names>R</given-names></name></person-group>             <year>2001</year>             <article-title>Robustness of the bistable behavior of a biological signaling feedback loop.</article-title>             <source>Chaos</source>             <volume>11 (1)</volume>             <fpage>221</fpage>             <lpage>226</lpage>          </element-citation></ref><ref id="pcbi.1000122-Kholodenko1"><label>23</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Kholodenko</surname><given-names>BN</given-names></name></person-group>             <year>2006</year>             <article-title>Cell-signaling dynamics in time and space.</article-title>             <source>Nat Rev Mol Cell Biol</source>             <volume>7 (3)</volume>             <fpage>165</fpage>             <lpage>176</lpage>          </element-citation></ref><ref id="pcbi.1000122-Milo1"><label>24</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Milo</surname><given-names>R</given-names></name><name name-style="western"><surname>Shen-Orr</surname><given-names>S</given-names></name><name name-style="western"><surname>Itzkovitz</surname><given-names>S</given-names></name><name name-style="western"><surname>Kashtan</surname><given-names>N</given-names></name><name name-style="western"><surname>Chklovskii</surname><given-names>D</given-names></name><etal/></person-group>             <year>2002</year>             <article-title>Network motifs: simple building blocks of complex networks.</article-title>             <source>Science</source>             <volume>298 (5594)</volume>             <fpage>824</fpage>             <lpage>827</lpage>          </element-citation></ref><ref id="pcbi.1000122-Prill1"><label>25</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Prill</surname><given-names>RJ</given-names></name><name name-style="western"><surname>Iglesias</surname><given-names>PA</given-names></name><name name-style="western"><surname>Levchenko</surname><given-names>A</given-names></name></person-group>             <year>2005</year>             <article-title>Dynamic properties of network motifs contribute to biological network organization.</article-title>             <source>PLoS Biol</source>             <volume>3 (11)</volume>             <fpage>e343. doi:10.1371/journal.pbio.0030343</fpage>          </element-citation></ref><ref id="pcbi.1000122-Chickarmane1"><label>26</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Chickarmane</surname><given-names>V</given-names></name><name name-style="western"><surname>Paladugu</surname><given-names>SR</given-names></name><name name-style="western"><surname>Bergmann</surname><given-names>F</given-names></name><name name-style="western"><surname>Sauro</surname><given-names>HM</given-names></name></person-group>             <year>2005</year>             <article-title>Bifurcation discovery tool.</article-title>             <source>Bioinformatics</source>             <volume>21 (18)</volume>             <fpage>3688</fpage>             <lpage>3690</lpage>          </element-citation></ref><ref id="pcbi.1000122-Liu1"><label>27</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Liu</surname><given-names>G</given-names></name><name name-style="western"><surname>Swihart</surname><given-names>MT</given-names></name><name name-style="western"><surname>Neelamegham</surname><given-names>S</given-names></name></person-group>             <year>2005</year>             <article-title>Sensitivity, principal component and flux analysis applied to signal transduction: the case of epidermal growth factor mediated signaling.</article-title>             <source>Bioinformatics</source>             <volume>21 (7)</volume>             <fpage>1194</fpage>             <lpage>1202</lpage>          </element-citation></ref><ref id="pcbi.1000122-Maurya1"><label>28</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Maurya</surname><given-names>MR</given-names></name><name name-style="western"><surname>Bornheimer</surname><given-names>SJ</given-names></name><name name-style="western"><surname>Venkatasubramanian</surname><given-names>V</given-names></name><name name-style="western"><surname>Subramaniam</surname><given-names>S</given-names></name></person-group>             <year>2005</year>             <article-title>Reduced-order modelling of biochemical networks: application to the GTPase-cycle signaling module.</article-title>             <source>IEE Proc Syst Biol</source>             <volume>152 (4)</volume>             <fpage>229</fpage>             <lpage>242</lpage>          </element-citation></ref><ref id="pcbi.1000122-Sauro1"><label>29</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Sauro</surname><given-names>HM</given-names></name><name name-style="western"><surname>Ingalls</surname><given-names>B</given-names></name></person-group>             <year>2004</year>             <article-title>Conservation analysis in biochemical networks: computational issues for software writers.</article-title>             <source>Biophys Chem</source>             <volume>109 (1)</volume>             <fpage>1</fpage>             <lpage>15</lpage>          </element-citation></ref><ref id="pcbi.1000122-Nmeth1"><label>30</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Németh</surname><given-names>A</given-names></name><name name-style="western"><surname>Vidóczy</surname><given-names>T</given-names></name><name name-style="western"><surname>Héberger</surname><given-names>H</given-names></name><name name-style="western"><surname>Kúti</surname><given-names>Z</given-names></name><name name-style="western"><surname>Wágner</surname><given-names>J</given-names></name></person-group>             <year>2002</year>             <article-title>MECHGEN: computer aided generation and reduction of reaction mechanisms.</article-title>             <source>J Chem Inf Comput Sci</source>             <volume>42 (2)</volume>             <fpage>208</fpage>             <lpage>214</lpage>          </element-citation></ref><ref id="pcbi.1000122-Fic1"><label>31</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Fic</surname><given-names>G</given-names></name><name name-style="western"><surname>Nowak</surname><given-names>G</given-names></name></person-group>             <year>2001</year>             <article-title>Implementation of similarity model in the CSB system for chemical reaction predictions.</article-title>             <source>Comput Chem</source>             <volume>25 (2)</volume>             <fpage>177</fpage>             <lpage>186</lpage>          </element-citation></ref><ref id="pcbi.1000122-Sommese1"><label>32</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Sommese</surname><given-names>AJ</given-names></name><name name-style="western"><surname>Wampler</surname><given-names>CW</given-names><suffix>II</suffix></name></person-group>             <year>2005</year>             <article-title>The Numerical Solution of Systems of Polynomials Arising in Engineering and Science.</article-title>             <publisher-loc>Singapore</publisher-loc>             <publisher-name>World Scientific</publisher-name>          </element-citation></ref></ref-list></back></article>