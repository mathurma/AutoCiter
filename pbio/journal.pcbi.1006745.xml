<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-18-01606</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1006745</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Probability theory</subject><subj-group><subject>Random variables</subject><subj-group><subject>Covariance</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Discrete mathematics</subject><subj-group><subject>Combinatorics</subject><subj-group><subject>Permutation</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Blood cells</subject><subj-group><subject>White blood cells</subject><subj-group><subject>T cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Immune cells</subject><subj-group><subject>White blood cells</subject><subj-group><subject>T cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Immunology</subject><subj-group><subject>Immune cells</subject><subj-group><subject>White blood cells</subject><subj-group><subject>T cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Immunology</subject><subj-group><subject>Immune cells</subject><subj-group><subject>White blood cells</subject><subj-group><subject>T cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Animal studies</subject><subj-group><subject>Experimental organism systems</subject><subj-group><subject>Model organisms</subject><subj-group><subject>Caenorhabditis elegans</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Model organisms</subject><subj-group><subject>Caenorhabditis elegans</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Animal studies</subject><subj-group><subject>Experimental organism systems</subject><subj-group><subject>Animal models</subject><subj-group><subject>Caenorhabditis elegans</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Organisms</subject><subj-group><subject>Eukaryota</subject><subj-group><subject>Animals</subject><subj-group><subject>Invertebrates</subject><subj-group><subject>Nematoda</subject><subj-group><subject>Caenorhabditis</subject><subj-group><subject>Caenorhabditis elegans</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Data visualization</subject><subj-group><subject>Infographics</subject><subj-group><subject>Graphs</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Phenotypes</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Mathematical and statistical techniques</subject><subj-group><subject>Fourier analysis</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Developmental biology</subject><subj-group><subject>Cell differentiation</subject></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Maps of variability in cell lineage trees</article-title>
<alt-title alt-title-type="running-head">Maps of variability in cell lineage trees</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-8322-9983</contrib-id>
<name name-style="western">
<surname>Hicks</surname> <given-names>Damien G.</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-5403-7998</contrib-id>
<name name-style="western">
<surname>Speed</surname> <given-names>Terence P.</given-names></name>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Yassin</surname> <given-names>Mohammed</given-names></name>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Russell</surname> <given-names>Sarah M.</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Centre for Micro-Photonics, Department of Physics and Astronomy, Swinburne University of Technology, Hawthorn, Victoria 3122, Australia</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Bioinformatics Division, Walter &amp; Eliza Hall Institute of Medical Research, Parkville, Victoria 3052, Australia</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>Peter MacCallum Cancer Centre, Parkville, Victoria 3052, Australia</addr-line>
</aff>
<aff id="aff004">
<label>4</label>
<addr-line>Department of Pathology and Sir Peter MacCallum Department of Oncology, University of Melbourne, Parkville, Victoria 3050, Australia</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Najarian</surname> <given-names>Kayvan</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>University of Michigan, UNITED STATES</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">dghicks@swin.edu.au</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>2</month>
<year>2019</year>
</pub-date>
<pub-date pub-type="epub">
<day>12</day>
<month>2</month>
<year>2019</year>
</pub-date>
<volume>15</volume>
<issue>2</issue>
<elocation-id>e1006745</elocation-id>
<history>
<date date-type="received">
<day>17</day>
<month>9</month>
<year>2018</year>
</date>
<date date-type="accepted">
<day>2</day>
<month>1</month>
<year>2019</year>
</date>
</history>
<permissions>
<copyright-year>2019</copyright-year>
<copyright-holder>Hicks et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1006745"/>
<abstract>
<p>New approaches to lineage tracking have allowed the study of differentiation in multicellular organisms over many generations of cells. Understanding the phenotypic variability observed in these lineage trees requires new statistical methods. Whereas an invariant cell lineage, such as that for the nematode <italic>Caenorhabditis elegans</italic>, can be described by a lineage map, defined as the pattern of phenotypes overlaid onto the binary tree, a traditional lineage map is static and does not describe the variability inherent in the cell lineages of higher organisms. Here, we introduce lineage variability maps which describe the pattern of second-order variation in lineage trees. These maps can be undirected graphs of the partial correlations between every lineal position, or directed graphs showing the dynamics of bifurcated patterns in each subtree. We show how to infer these graphical models for lineages of any depth from sample sizes of only a few pedigrees. This required developing the generalized spectral analysis for a binary tree, the natural framework for describing tree-structured variation. When tested on pedigrees from <italic>C. elegans</italic> expressing a marker for pharyngeal differentiation potential, the variability maps recover essential features of the known lineage map. When applied to highly-variable pedigrees monitoring cell size in T lymphocytes, the maps show that most of the phenotype is set by the founder naive T cell. Lineage variability maps thus elevate the concept of the lineage map to the population level, addressing questions about the potency and dynamics of cell lineages and providing a way to quantify the progressive restriction of cell fate with increasing depth in the tree.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>Multicellular organisms develop from a single fertilized egg by sequential cell divisions. The progeny from these divisions adopt different traits that are transmitted and modified through many generations. By tracking how cell traits change with each successive cell division throughout the family, or lineage, tree, it has been possible to understand where and how these modifications are controlled at the single-cell level. This helps address questions about, for example, the developmental origin of tissues, the sources of differentiation in immune cells, or the relationship between primary tumors and metastases. Such lineages often show large variability, with apparently similar founder cells giving rise to different patterns of descendants. In addition, questions about the range of accessible cell types at different stages of the lineage tree are actually questions about lineage variability. To characterize this variation, and thus understand the lineage at the population level, we introduce lineage variability maps. Using data from worm and mammalian cell lineages we show how these maps provide quantifiable answers to questions about any developing lineage, such as the potency of progenitor cells and the restriction of cell fate at different stages of the tree.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution>Australian Research Council</institution>
</funding-source>
<award-id>FT140101104</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-8322-9983</contrib-id>
<name name-style="western">
<surname>Hicks</surname> <given-names>Damien G.</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution>National Health and Medical Research Council of Australia</institution>
</funding-source>
<award-id>Program Grant 1054618</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-5403-7998</contrib-id>
<name name-style="western">
<surname>Speed</surname> <given-names>Terence P.</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award003">
<funding-source>
<institution>National Health and Medical Research Council of Australia</institution>
</funding-source>
<award-id>620500</award-id>
</award-group>
<award-group id="award004">
<funding-source>
<institution>National Health and Medical Research Council of Australia</institution>
</funding-source>
<award-id>APP1099140</award-id>
</award-group>
<award-group id="award005">
<funding-source>
<institution>Australian Research Council</institution>
</funding-source>
<award-id>FT0990405</award-id>
</award-group>
<funding-statement>This work was supported in part by Australian Research Council (ARC) grant FT140101104 to DGH, the National Health and Medical Research Council of Australia (NHMRC) Program Grant 1054618 to TPS, and NHMRC grants 620500 and APP1099140 and ARC grant FT0990405 to SMR. The sponsors or funders had no role in the study design, data collection and analysis, decision to publish, or preparation of the manuscript. ARC - <ext-link ext-link-type="uri" xlink:href="https://www.arc.gov.au/" xlink:type="simple">https://www.arc.gov.au/</ext-link> NHMRC - <ext-link ext-link-type="uri" xlink:href="https://www.nhmrc.gov.au/" xlink:type="simple">https://www.nhmrc.gov.au/</ext-link></funding-statement>
</funding-group>
<counts>
<fig-count count="11"/>
<table-count count="2"/>
<page-count count="32"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2019-02-25</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant data are within the manuscript and its Supporting Information files. The source code is available on Github: <ext-link ext-link-type="uri" xlink:href="https://github.com/hicksd/Lineage-Variability-Maps" xlink:type="simple">https://github.com/hicksd/Lineage-Variability-Maps</ext-link>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>The cells of developing organisms differentiate into their specialized types by integrating signals from their present surroundings with instructions inherited from their ancestors. This interplay of mechanisms generates the pattern of phenotypes that emerges in the cell lineage tree [<xref ref-type="bibr" rid="pcbi.1006745.ref001">1</xref>]. Measuring this phenotypic pattern requires recording two types of information: the phenotype of each cell and the family relationships between the cells. The result is called a lineage map [<xref ref-type="bibr" rid="pcbi.1006745.ref002">2</xref>]. Lineage maps illustrate the successive bifurcations in phenotypes that underpin a particular differentiation pathway, providing an invaluable guide for experiments investigating the mechanisms involved in fate determination [<xref ref-type="bibr" rid="pcbi.1006745.ref003">3</xref>]. Development in the nematode <italic>Caenorhabditis elegans</italic> is the classic example of how the lineage map can help untangle the roles of pre-programmed instruction and cell-to-cell communication [<xref ref-type="bibr" rid="pcbi.1006745.ref004">4</xref>–<xref ref-type="bibr" rid="pcbi.1006745.ref006">6</xref>] in cellular differentiation.</p>
<p>A crucial use of the lineage map is to identify the common ancestors of cells sharing a particular fate. This indicates how deeply within the lineage that fate was specified. Successfully locating common ancestors depends first on being able to identify the subclones associated with a phenotype. If a phenotype is clonal, meaning exclusive to a single subclone, we can associate that phenotype with a single bifurcation at the most recent common ancestor; if it is non-clonal, bifurcations at multiple ancestors were likely involved (note that even for simple organisms like <italic>C. elegans</italic>, most phenotypes are non-clonal—see <xref ref-type="table" rid="pcbi.1006745.t001">Table 1</xref>). Much of the logic for interpreting lineage maps and inferring differentiation pathways can be automated [<xref ref-type="bibr" rid="pcbi.1006745.ref007">7</xref>, <xref ref-type="bibr" rid="pcbi.1006745.ref008">8</xref>]. However, these techniques are difficult to implement in the presence of phenotypic variability.</p>
<table-wrap id="pcbi.1006745.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006745.t001</object-id>
<label>Table 1</label>
<caption>
<title>Characteristics of some cell lineage patterns.</title>
<p>Organisms are listed in order of increasing complexity. Lineages are characterized in terms of whether cell fate is exclusive to a subclone, the degree of phenotypic variability, and whether the lineage tree measurement is ordered. Lineages from higher organisms are generally unordered, have high variability, and may or may not be clonal.</p>
</caption>
<alternatives>
<graphic id="pcbi.1006745.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006745.t001" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center"><italic>Species</italic></th>
<th align="center"><italic>Cell origin (tissue)</italic></th>
<th align="center"><italic>Clonal</italic></th>
<th align="center"><italic>Variability</italic></th>
<th align="center"><italic>Ordered</italic></th>
<th align="center"><italic>Ref</italic>.</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center" rowspan="2">Worm</td>
<td align="center">Embryonic (germ)</td>
<td align="center">✔</td>
<td align="center">low</td>
<td align="center">✔</td>
<td align="center">[<xref ref-type="bibr" rid="pcbi.1006745.ref005">5</xref>]</td>
</tr>
<tr>
<td align="center">Embryonic (pharynx)</td>
<td align="center">✘</td>
<td align="center">low</td>
<td align="center">✔</td>
<td align="center">[<xref ref-type="bibr" rid="pcbi.1006745.ref005">5</xref>]</td>
</tr>
<tr>
<td align="center">Leech</td>
<td align="center">Embryonic (epidermis)</td>
<td align="center">✘</td>
<td align="center">low</td>
<td align="center">✔</td>
<td align="center">[<xref ref-type="bibr" rid="pcbi.1006745.ref011">11</xref>]</td>
</tr>
<tr>
<td align="center">Zebrafish</td>
<td align="center">Embryonic (various)</td>
<td align="center">✘</td>
<td align="center">high</td>
<td align="center">✘</td>
<td align="center">[<xref ref-type="bibr" rid="pcbi.1006745.ref019">19</xref>]</td>
</tr>
<tr>
<td align="center" rowspan="3">Mouse</td>
<td align="center">Embryonic (various)</td>
<td align="center">✘</td>
<td align="center">high</td>
<td align="center">✘</td>
<td align="center">[<xref ref-type="bibr" rid="pcbi.1006745.ref020">20</xref>]</td>
</tr>
<tr>
<td align="center">Lymphoma</td>
<td align="center">✔</td>
<td align="center">high</td>
<td align="center">✘</td>
<td align="center">[<xref ref-type="bibr" rid="pcbi.1006745.ref021">21</xref>]</td>
</tr>
<tr>
<td align="center">B-lymphocyte</td>
<td align="center">✘</td>
<td align="center">high</td>
<td align="center">✘</td>
<td align="center">[<xref ref-type="bibr" rid="pcbi.1006745.ref014">14</xref>]</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<sec id="sec002">
<title>Variability in cell lineages</title>
<p>The lineage map is a concept born from the study of invariant lineages, such as that for <italic>C. elegans</italic>, where the fixed pattern of phenotypes can be found, in principle, by tracking the family tree, or pedigree, from a single founder cell. When pedigrees are highly variable, however, seemingly identical founder cells can give rise to different patterns of descendants. Which of these represents the lineage map? Simply averaging the phenotype at each lineal position by pooling across multiple pedigrees may not give a representative pattern since the averaging will suppress correlations between lineal positions. Furthermore, the variability between pedigrees, which reflects the potency of founder cells, is an important quantity itself and cannot be represented in a lineage map. While lineage variability is minimal in simple organisms such as <italic>C. elegans</italic> [<xref ref-type="bibr" rid="pcbi.1006745.ref009">9</xref>, <xref ref-type="bibr" rid="pcbi.1006745.ref010">10</xref>] and leech [<xref ref-type="bibr" rid="pcbi.1006745.ref011">11</xref>], it is greater in higher organisms such as insects and vertebrates [<xref ref-type="bibr" rid="pcbi.1006745.ref001">1</xref>, <xref ref-type="bibr" rid="pcbi.1006745.ref012">12</xref>] and is significant in mammalian cells of clinical importance such as stem cells [<xref ref-type="bibr" rid="pcbi.1006745.ref013">13</xref>] and lymphocytes [<xref ref-type="bibr" rid="pcbi.1006745.ref014">14</xref>, <xref ref-type="bibr" rid="pcbi.1006745.ref015">15</xref>]. Such increased variability likely plays a role in being able to respond effectively to environmental changes. Given the additional variation inherent in molecular-level measurements [<xref ref-type="bibr" rid="pcbi.1006745.ref016">16</xref>] it is becoming increasingly important to extend the concept of the lineage map to account for variability.</p>
<p>A fundamental property of any lineage tree measurement, which is crucial when studying variability, is whether it is ordered or unordered. We define a lineage tree to be <italic>ordered</italic> if the labels used to distinguish the lineal positions of two daughter cells (sisters) are meaningful. This gives each daughter a unique identity. The tree is <italic>unordered</italic> if these labels are arbitrary, making the daughter positions unidentifiable. This distinction has significant consequences in a statistical analysis. For example, in an unordered tree consisting of a mother <italic>A</italic> and its arbitrarily-labeled daughters <italic>B</italic> and <italic>C</italic>, we should not distinguish between the properties of positions <italic>B</italic> and <italic>C</italic> when comparing different pedigrees; nor should we distinguish between the mother-daughter relationships <italic>A-B</italic> and <italic>A-C</italic>.</p>
<p>The <italic>C. elegans</italic> lineage is an example of an ordered lineage. Here each daughter is labeled by its orientation, at the time of division, with respect to the developing organism [<xref ref-type="bibr" rid="pcbi.1006745.ref004">4</xref>, <xref ref-type="bibr" rid="pcbi.1006745.ref005">5</xref>, <xref ref-type="bibr" rid="pcbi.1006745.ref017">17</xref>]. Daughters thus have meaningful labels. For example, a mother labeled ‘Epl’ divides into ‘Epla’, the anterior daughter, and ‘Eplp’ the posterior daughter. In higher organisms, it can be difficult or impossible to find a meaningful way to label each daughter in a pair. For example, in the <italic>in vitro</italic> murine T-lymphocyte pedigrees discussed in this paper, the orientation of the mouse, even if it were known, can hardly be expected to be a useful way to distinguish between daughter cells.</p>
<p>Now, if the phenotype pattern is invariant, a single complete pedigree measurement represents the lineage map and being unordered (or not) does not matter. However, when comparing variable pedigrees, the unidentifiability of daughter positions can significantly affect the ability to detect phenotypic patterns. For example, simply averaging different pedigrees to enhance subtle bifurcation patterns risks instead canceling these patterns if the pedigrees are not ordered the same way [<xref ref-type="bibr" rid="pcbi.1006745.ref018">18</xref>].</p>
<p>Since the majority of pedigree measurements from higher organisms are both variable and unordered [<xref ref-type="bibr" rid="pcbi.1006745.ref001">1</xref>] (see <xref ref-type="table" rid="pcbi.1006745.t001">Table 1</xref>), an important question is whether the concept of a lineage map is even useful anymore. How can we associate fate specification with fixed lineal positions when the pattern of descendants varies from one apparently identical founder to the next? Clearly a statistical approach is required.</p>
</sec>
<sec id="sec003">
<title>Previous statistical approaches</title>
<p>A number of statistical methods have been developed to analyze variable, unordered lineage trees. Though these approaches do not directly address the question of how to construct a lineage map, many of them address aspects of the problem.</p>
<p>The bifurcating autoregressive model [<xref ref-type="bibr" rid="pcbi.1006745.ref022">22</xref>, <xref ref-type="bibr" rid="pcbi.1006745.ref023">23</xref>] was developed to estimate mother-daughter and daughter-daughter correlations using a sample of unordered pedigrees from either <italic>E. coli</italic> or tumor cultures. The model was later used to analyze data from ordered pedigrees to test for lineage asymmetry [<xref ref-type="bibr" rid="pcbi.1006745.ref024">24</xref>, <xref ref-type="bibr" rid="pcbi.1006745.ref025">25</xref>]. This stationary, parametric model allowed for daughters to be conditionally dependent (with respect to their common mother) but forced cousins and more distant relatives to be conditionally independent (with respect to their most recent common ancestor). The subsequent discovery that cousins could be conditionally dependent motivated a theory of cellular inheritance involving deterministic, nonlinear dynamics in lymphoblasts [<xref ref-type="bibr" rid="pcbi.1006745.ref026">26</xref>]. However, such distant intragenerational dependence might instead be interpreted as a delay between fate specification and expression, where a phenotype that has been specified in a mother and its daughters is not expressed until its four granddaughters. These analyses illustrate the importance of having lineages that are large enough, and a model that is general enough, to examine correlations of distant relatives [<xref ref-type="bibr" rid="pcbi.1006745.ref027">27</xref>]. They also remind us that simple branching process models, which we here define to be those assuming conditional independence of daughters, do not properly represent the correlations in a lineage, a fact that was established in early lineage analyses [<xref ref-type="bibr" rid="pcbi.1006745.ref028">28</xref>, <xref ref-type="bibr" rid="pcbi.1006745.ref029">29</xref>]. Although population numbers can be satisfactorily modeled using branching processes [<xref ref-type="bibr" rid="pcbi.1006745.ref030">30</xref>], allowing for sibling correlations can affect the inferred population dynamics [<xref ref-type="bibr" rid="pcbi.1006745.ref014">14</xref>, <xref ref-type="bibr" rid="pcbi.1006745.ref031">31</xref>].</p>
<p>As we indicated earlier, identifying a subtree, or subclone, of shared phenotypes is the first step to inferring where fate is specified. This idea forms the basis of methods to study cell state transitions in bacterial cells or mouse embryonic stem cells [<xref ref-type="bibr" rid="pcbi.1006745.ref032">32</xref>, <xref ref-type="bibr" rid="pcbi.1006745.ref033">33</xref>], where phenotypic similarity among relatives in the same generation was used to infer how much earlier in the pedigree a transition occurred. A similar idea was used in hematopoietic stem cells to infer the multi-generational delay between when an invisible molecular decision occurred and when its effect was expressed as a surface marker [<xref ref-type="bibr" rid="pcbi.1006745.ref034">34</xref>]. These models assume that cell states transition over timescales that are slow compared to the cell cycle duration; alternatively they could be synchronized to cell divisions [<xref ref-type="bibr" rid="pcbi.1006745.ref035">35</xref>]. Note that, in a lineage map, the generation of a cell is a meaningful quantity, representing the number of divisions since the founder cell, whether that be a zygote, a naive lymphocyte, or some progenitor initiated with a particular stimulus. Thus any model of a developing lineage must be non-stationary.</p>
<p>Several other approaches to statistical lineage analysis have been reported recently. A factor graph method was used to model conditional dependence between daughters [<xref ref-type="bibr" rid="pcbi.1006745.ref036">36</xref>], with the goal of testing whether pre-programmed instruction or differential cell death was responsible for differentiation of hematopoietic progenitor cells; direct inference of Nanog expression, a pluripotency factor, was used to understand its dynamics in embryonic stem cell lineages [<xref ref-type="bibr" rid="pcbi.1006745.ref037">37</xref>]; and, a parametric characterization of lineage patterns has been applied to achieve early identification of hematopoietic stem cells [<xref ref-type="bibr" rid="pcbi.1006745.ref038">38</xref>]. However, these methods are of less relevance to our question of how to build a statistical lineage map.</p>
</sec>
<sec id="sec004">
<title>Outline</title>
<p>Major efforts are underway to improve the throughput and quality of lineage measurements (see reviews [<xref ref-type="bibr" rid="pcbi.1006745.ref013">13</xref>, <xref ref-type="bibr" rid="pcbi.1006745.ref039">39</xref>–<xref ref-type="bibr" rid="pcbi.1006745.ref042">42</xref>] and commentary [<xref ref-type="bibr" rid="pcbi.1006745.ref043">43</xref>–<xref ref-type="bibr" rid="pcbi.1006745.ref045">45</xref>]). Recent breakthroughs have resulted in a wealth of data from automated microscopy-based [<xref ref-type="bibr" rid="pcbi.1006745.ref019">19</xref>, <xref ref-type="bibr" rid="pcbi.1006745.ref046">46</xref>–<xref ref-type="bibr" rid="pcbi.1006745.ref048">48</xref>] and sequencing-based [<xref ref-type="bibr" rid="pcbi.1006745.ref020">20</xref>, <xref ref-type="bibr" rid="pcbi.1006745.ref049">49</xref>–<xref ref-type="bibr" rid="pcbi.1006745.ref057">57</xref>] techniques. While the technological barriers for these measurements are severe, there are significant barriers to the analysis of the data as well. As we have discussed, there is currently no way to construct a useful lineage map from variable, unordered pedigrees. Yet, according to Shapiro [<xref ref-type="bibr" rid="pcbi.1006745.ref040">40</xref>], “Central unresolved problems in human biology and medicine are in fact questions about the human cell lineage tree: its structure, dynamics, and variability during development, growth, renewal, aging and disease.” It is important then to find a way to generalize the concept of the lineage map to the population level.</p>
<p>In this paper we propose a solution by introducing lineage variability maps. These involve the variances of, and covariances between, every position in the tree. A key idea is that, to interpret lineage patterns, it is not only the phenotypic values at each lineal position that are important, but also the phenotypic associations between different lineal positions. By developing a generalized spectral analysis for binary trees, we show how to estimate variability maps for a lineage of any depth using measurements from only a few, unordered pedigrees. For complete data, our approach is a non-parametric one, involving first and second moments of the data but assuming no distribution function. We could thus, alternatively, refer to these maps as second order lineage maps.</p>
<p>The rest of the paper is organized as follows. In the Methods section we describe essential aspects of the data used in this paper, the analysis framework and labeling convention, and how to estimate all pairwise associations by employing constraints on symmetry and sparsity. In the Results section we interpret the covariance matrix in terms of graphical models, called lineage variability maps, and show how these can be used to understand fate restriction and expression throughout the lineage. In the Discussion section we examine the implications and future prospects of this analysis.</p>
</sec>
</sec>
<sec id="sec005" sec-type="materials|methods">
<title>Methods</title>
<sec id="sec006">
<title>Ethics statement</title>
<p>All experiments using mice were performed in accordance with the Animal Experimentation Ethics Committee of the Peter MacCallum Cancer Centre (Approval E427) and mice were sacrificed by anaesthetic overdose.</p>
</sec>
<sec id="sec007">
<title>Lineage data</title>
<p>Data from 3 types of lineages are analyzed in this paper. Experimental data from T cells provide an example of a lineage with significant variability and no obvious structure. Previously-published data from <italic>C. elegans</italic> are the example of a lineage with complicated but highly-reproducible structure. Finally, a simulated, stationary branching process provides the benchmark of a featureless, variable lineage and to test the accuracy of the inference procedure. In more detail:</p>
<list list-type="simple">
<list-item>
<p><bold>T cells</bold> New lineage measurement on CD8<sup>+</sup> T cells from GFP:OT-1 transgenic mice. Naive cells, expressing a T cell receptor for SIINFEKL peptide from ovalbumin, interact with peptide-pulsed bone marrow-derived dendritic cells to activate clonal expansion [<xref ref-type="bibr" rid="pcbi.1006745.ref058">58</xref>]. Cells and their descendants are tracked using time-lapse fluorescence microscopy and analyzed using custom software [<xref ref-type="bibr" rid="pcbi.1006745.ref059">59</xref>]. Although multiple phenotypic traits were recorded, in this paper the only trait analyzed is the average area of a dividing cell over its lifetime. Note that only dividing cells were used in the analysis; cells whose fate is unknown, or which died, were counted as missing data. For the early generations used in this study, the numbers of cell deaths were negligible so there was no need to account for cell death explicitly. 19 replicate families were used.</p>
</list-item>
<list-item>
<p><bold>Worm</bold> Published [<xref ref-type="bibr" rid="pcbi.1006745.ref060">60</xref>] embryonic lineage data from the RW10425 transgenic strain of <italic>C. elegans</italic>. In this strain the <italic>PHA-4</italic> gene for pharyngeal and intestinal tissue is tagged with green fluorescent protein whose lifetime-averaged expression intensity is used as the phenotypic trait in our analysis. Gut differentiation occurs early during embryogenesis, with <italic>PHA-4</italic> expression beginning by generations 7 and 8. There are 10 replicate pedigrees. Note that, although these lineage data are ordered, we treat them as unordered in order to compare results with the other unordered datasets in this study.</p>
</list-item>
<list-item>
<p><bold>Branching Process</bold> Simulated lineages from a stationary branching process. 20 replicate pedigrees are used, with a missing data fraction of 20% assumed. Here we define a branching process to be one where the correlation between mothers and daughters is <italic>h</italic> and daughters are conditionally independent with respect to their common mother. Then, the correlation between any two lineal positions <italic>ς</italic> and <italic>ς</italic>′ is <italic>h</italic><sup><italic>D</italic>(<italic>ς</italic>,<italic>ς</italic>′)</sup>, where <italic>D</italic>(<italic>ς</italic>, <italic>ς</italic>′) is the lineage distance between them. For example, the correlation between sisters is <italic>h</italic><sup>2</sup> and between cousins is <italic>h</italic><sup>4</sup> and so on. In this study we assume <italic>h</italic> = 0.8. As will be shown in Section “Lineage variability maps”, the underlying graphical model of partial correlations for this branching process is a binary tree. This is generally not the case for real lineages.</p>
</list-item>
</list>
<p>Sample pedigrees from these 3 lineage types are shown in <xref ref-type="fig" rid="pcbi.1006745.g001">Fig 1</xref> while the expression of each phenotype as a function of generation is shown in <xref ref-type="fig" rid="pcbi.1006745.g002">Fig 2</xref>.</p>
<fig id="pcbi.1006745.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006745.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Illustration of pedigree data.</title>
<p>Shown are 5 sample pedigrees from each of the 3 lineage types. Each pedigree originates from a different founder cell and is, for compactness, drawn as a radial tree. Each node on the tree represents a cell, where node color reflects the strength of the cell phenotype under analysis (liftetime-averaged cell size for T cells, <italic>PHA-4</italic> expression intensity for <italic>C. elegans</italic>). For T cells the root node is the naive cell while for the worm lineage the root node is the zygote (labelled P0). The absence of a node on the tree represents a missing data point. Labels for each worm cell position are given in Section S1.6 in <xref ref-type="supplementary-material" rid="pcbi.1006745.s001">S1 Appendix</xref>. Data shown here, and throughout the paper, are provided in the supporting information. Note how the worm pedigrees display clear, invariant patterns whereas the T-cell pedigrees (and the branching process) have no obvious repeatable structure.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006745.g001" xlink:type="simple"/>
</fig>
<fig id="pcbi.1006745.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006745.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Expression of each phenotype as a function of generation.</title>
<p>The vertical axis represents the strength of expression for each measured phenotype. For T cells this is the lifetime-averaged cell area in <italic>μ</italic>m<sup>2</sup>; for <italic>C</italic>. <italic>elegans</italic> it is the lifetime-averaged intensity of green fluorescent protein used to tag <italic>PHA-4</italic> expression.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006745.g002" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec008">
<title>Analysis framework and labeling conventions</title>
<p>In this study, lineage data are regarded as repeated measurements on pedigrees arising from individual founder cells, each selected at random from a population of similar cells. We restrict our attention to modeling a single trait from pedigrees subject to the same conditions. A sample consisting of multiple replicate pedigrees can then be represented by a two-factor array (<italic>Y</italic><sub><italic>ij</italic></sub>), where <italic>i</italic> has <italic>n</italic> levels corresponding to the number of pedigrees and <italic>j</italic> has <italic>p</italic> levels corresponding to the number of lineal positions within a pedigree. With no meaningful distinctions among pedigrees (they are all of the same cell type and subject to the same conditions) we assume they are independent and identically-distributed replicates. The data can thus be represented by a matrix <bold><italic>Y</italic></bold> with <italic>n</italic> replicates (rows) and <italic>p</italic> variables (columns).</p>
<p>Each of the <italic>p</italic> dimensions corresponds to a lineal position. We use a binary number to label each position so that, for example, the first 3 generations are labeled as founder (<monospace>1</monospace>), daughters (<monospace>10</monospace>, <monospace>11</monospace>), and granddaughters (<monospace>100</monospace>, <monospace>101</monospace>, <monospace>110</monospace>, <monospace>111</monospace>), where each label thus encodes the lineal position. We will also need to define a nomenclature for generations and subtrees. Generations, <italic>g</italic>, refer to the depth in the tree where the founder cell is defined to be at generation <italic>g</italic> = 1. Subtrees are defined by two indices, (<italic>ℓ</italic>, <italic>τ</italic>), where <italic>ℓ</italic> refers to the longitudinal coordinate and <italic>τ</italic> to the transverse coordinate of the root node (see <xref ref-type="fig" rid="pcbi.1006745.g003">Fig 3</xref>). In our convention, the subtree at <italic>ℓ</italic> = 1 is the entire tree. As we will show, subtrees will be associated with sources of variation, and we need to define a ‘subtree’ at <italic>ℓ</italic> = 0 that sits outside the lineage and represents variation among lineages. This concept does not exist for a lineage map but is essential for a lineage variability map since different pedigrees may not be the same.</p>
<fig id="pcbi.1006745.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006745.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Labeling convention for a lineage tree.</title>
<p>(a) Each lineal position is labeled with a binary number. The founder of the tree is located at generation <italic>g</italic> = 1. (b) Each subtree is labeled with two indices (<italic>ℓ</italic>, <italic>τ</italic>) representing the longitudinal (<italic>ℓ</italic>) and transverse (<italic>τ</italic>) coordinates of its root. Because, as we discuss later, roots of subtrees are associated with sources of variation we need to create a ‘subtree’ located outside the lineage, called (0, 0) (in red), to represent variation among pedigrees. Note that, in an unordered tree, <italic>τ</italic> values are unidentifiable and will often be ignored.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006745.g003" xlink:type="simple"/>
</fig>
<p>Often in lineage measurements there are many more lineal positions (<italic>p</italic>) than there are pedigrees (<italic>n</italic>). Thus <italic>p</italic> ≳ <italic>n</italic>, with the disparity getting exponentially worse with the number of generations studied. Performing reliable inference when <italic>p</italic>/<italic>n</italic> &gt; 1 is an open research question [<xref ref-type="bibr" rid="pcbi.1006745.ref061">61</xref>]. Best results are achieved when prior knowledge of the problem can be incorporated.</p>
<p>In the next section we describe increasingly more sophisticated steps to reduce the effective dimensionality of the inference calculation, first by exploiting known symmetry properties and then by using observed sparsity properties. Our goal is to identify a scheme where the number of replicates required is independent of the number of generations studied. This will allow variability maps over many generations to be constructed using data from only a few pedigrees.</p>
</sec>
<sec id="sec009">
<title>Covariance estimation</title>
<p>The essential idea for this analysis is to measure second-order variation throughout the lineage by estimating the variance of, and covariance between, every lineal position. This population covariance matrix <bold>Σ</bold> for the lineage involves no assumption about the underlying distribution. It involves just the first and second order moments of the data.</p>
<sec id="sec010">
<title>Unstructured covariance</title>
<p>Let <bold><italic>y</italic></bold> be a <italic>p</italic>-dimensional random variable representing the single trait for each lineal position. A naive method for estimating the covariance matrix for <bold><italic>y</italic></bold> is to assume it has no structure. This means that only data from the same lineal position in different pedigrees can be pooled. The sample mean (<inline-formula id="pcbi.1006745.e001"><alternatives><graphic id="pcbi.1006745.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e001" xlink:type="simple"/><mml:math display="inline" id="M1"><mml:mover><mml:mi mathvariant="bold-italic">y</mml:mi> <mml:mo>¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula>) and (biased) sample covariance (<bold><italic>S</italic></bold>) are given by
<disp-formula id="pcbi.1006745.e002"><alternatives><graphic id="pcbi.1006745.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e002" xlink:type="simple"/><mml:math display="block" id="M2"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">y</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>n</mml:mi></mml:mfrac> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:munderover> <mml:msub><mml:mi mathvariant="bold-italic">Y</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mspace width="1.em"/><mml:mi mathvariant="bold-italic">S</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>n</mml:mi></mml:mfrac> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:munderover> <mml:msub><mml:mi mathvariant="bold-italic">Y</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:msubsup><mml:mi mathvariant="bold-italic">Y</mml:mi> <mml:mi>i</mml:mi> <mml:mo>′</mml:mo></mml:msubsup> <mml:mo>-</mml:mo> <mml:mover><mml:mi mathvariant="bold-italic">y</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mspace width="0.166667em"/><mml:msup><mml:mover><mml:mi mathvariant="bold-italic">y</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>′</mml:mo></mml:msup> <mml:mo>,</mml:mo> <mml:mspace width="1.em"/><mml:mspace width="1.em"/><mml:msub><mml:mi mathvariant="bold-italic">Y</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="double-struck">R</mml:mi> <mml:mi>p</mml:mi></mml:msup> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mo>⋯</mml:mo> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula>
where <bold><italic>Y</italic></bold><sub><italic>i</italic></sub> is the data vector from pedigree <italic>i</italic>. This results in the usual estimates of the population mean, <bold><italic>μ</italic></bold>, and population covariance matrix, <inline-formula id="pcbi.1006745.e003"><alternatives><graphic id="pcbi.1006745.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:mover accent="true"><mml:mo>Σ</mml:mo> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>,
<disp-formula id="pcbi.1006745.e004"><alternatives><graphic id="pcbi.1006745.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e004" xlink:type="simple"/><mml:math display="block" id="M4"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">μ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mover><mml:mi mathvariant="bold-italic">y</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>,</mml:mo> <mml:mspace width="1.em"/><mml:mover accent="true"><mml:mo mathvariant="bold">Σ</mml:mo> <mml:mo>^</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mi mathvariant="bold-italic">S</mml:mi> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2)</label></disp-formula></p>
<p>This is not a practical way to estimate <bold>Σ</bold> since, as is well known, <bold><italic>S</italic></bold> will not be positive definite unless <italic>n</italic> &gt; <italic>p</italic>. To appreciate why this is a prohibitive limitation for lineage data, we examine the complexity of the problem using 3 measures: the effective number of dimensions <italic>p</italic><sub>eff</sub>, the number of unknown variance-covariance parameters <inline-formula id="pcbi.1006745.e005"><alternatives><graphic id="pcbi.1006745.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:msub><mml:mi mathvariant="script">N</mml:mi> <mml:mo>Σ</mml:mo></mml:msub></mml:math></alternatives></inline-formula>, and the minimum number of replicates <italic>n</italic><sub>min</sub> required to ensure <inline-formula id="pcbi.1006745.e006"><alternatives><graphic id="pcbi.1006745.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:mover accent="true"><mml:mo>Σ</mml:mo> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is positive definite. These are given by
<disp-formula id="pcbi.1006745.e007"><alternatives><graphic id="pcbi.1006745.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e007" xlink:type="simple"/><mml:math display="block" id="M7"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>p</mml:mi> <mml:mtext>eff</mml:mtext></mml:msub></mml:mtd> <mml:mtd><mml:mrow><mml:mo>=</mml:mo> <mml:mi>p</mml:mi> <mml:mo>,</mml:mo> <mml:mspace width="1.em"/><mml:msub><mml:mi mathvariant="script">N</mml:mi> <mml:mo>Σ</mml:mo></mml:msub> <mml:mo>=</mml:mo> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>p</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn> <mml:mo>,</mml:mo> <mml:mspace width="1.em"/><mml:msub><mml:mi>n</mml:mi> <mml:mtext>min</mml:mtext></mml:msub> <mml:mo>=</mml:mo> <mml:mi>p</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(3)</label></disp-formula></p>
<p>Now because the number of lineal positions for a complete tree of <italic>G</italic> generations grows exponentially as <italic>p</italic> = 2<sup><italic>G</italic></sup> − 1, this means that the number of dimensions, the number of unknowns, and, most importantly, the number of replicates required, <italic>n</italic><sub>min</sub>, increases exponentially with the number of generations being studied. This makes the unstructured covariance matrix impractical for analyzing trees. As we invoke more constraints, we will examine the reduction in these complexity measures. For example, although <italic>p</italic><sub>eff</sub> = <italic>p</italic> for this unstructured case, with symmetry structure <italic>p</italic><sub>eff</sub> &lt; <italic>p</italic>.</p>
<p>For the analysis to be practical, <italic>n</italic><sub>min</sub> should be small and independent of <italic>G</italic>. Then <bold>Σ</bold> can be estimated up to any generation <italic>G</italic> with a modest number of pedigrees <italic>n</italic><sub>min</sub>. To achieve this, our approach is to identify constraints associated with symmetry and sparsity that are specific to the problem of tree-structured variation.</p>
</sec>
<sec id="sec011">
<title>Symmetry</title>
<p>To understand how symmetry invariance constrains tree-structured variation, we start with intuitive arguments for why certain covariance matrix elements must be equal in an unordered tree. This gives rise to a particular structured form for <bold>Σ</bold>. We then describe how the framework of symmetry invariance formalizes this intuition and reveals the independent (orthogonal) components underlying this structured form. The result is a nonparametric spectral analysis for trees that facilitates both inference and interpretation in tree-structured data.</p>
</sec>
<sec id="sec012">
<title>Structured covariance matrix</title>
<p>To reduce the number of unknowns in <bold>Σ</bold>, we begin by identifying a pattern of shared means, variances, and covariances that arise in the unordered tree. This allows pooling of data within a pedigree, in addition to the pooling between pedigrees already used in the unstructured covariance estimate.</p>
<p>For the case of first moments, the pattern of shared elements is found by recognizing that, for an unordered tree, lineal positions within the same generation are unidentifiable. Equivalently, we could say that the labels identifying members of the same generation are not meaningful. Thus all members within a generation must be assigned the same mean. For example, the mean vector for a 3-generation tree is
<disp-formula id="pcbi.1006745.e008"><alternatives><graphic id="pcbi.1006745.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e008" xlink:type="simple"/><mml:math display="block" id="M8"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow/></mml:mtd> <mml:mtd><mml:mn mathvariant="monospace">1</mml:mn></mml:mtd> <mml:mtd><mml:mrow><mml:mn mathvariant="monospace">10</mml:mn></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mn mathvariant="monospace">11</mml:mn></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mn mathvariant="monospace">100</mml:mn></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mn mathvariant="monospace">101</mml:mn></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mn mathvariant="monospace">110</mml:mn></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mn mathvariant="monospace">111</mml:mn></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">μ</mml:mi> <mml:mi mathvariant="script">G</mml:mi></mml:msub> <mml:mo>=</mml:mo></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mi>q</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>q</mml:mi> <mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>q</mml:mi> <mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>q</mml:mi> <mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>q</mml:mi> <mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>q</mml:mi> <mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>q</mml:mi> <mml:mn>3</mml:mn></mml:msub> <mml:mo stretchy="false">)</mml:mo> <mml:mo>′</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(4)</label></disp-formula>
where the subscript <inline-formula id="pcbi.1006745.e009"><alternatives><graphic id="pcbi.1006745.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:mi mathvariant="script">G</mml:mi></mml:math></alternatives></inline-formula> denotes a quantity with symmetry structure, <italic>q</italic><sub><italic>g</italic></sub> is the mean of a cell in generation <italic>g</italic>, and we have explicitly written the cell labels above each element. It is self-evident that data can be pooled within generations to improve the estimate of these shared means.</p>
<p>Note how, because the tree is unordered, the only information in the first moment of the data is the average of each generation. Other details about the lineage pattern have been lost. <italic>Thus, in unordered trees, we must look at second moments of the data if we want to understand lineage patterns at the population level</italic>.</p>
<p>For the case of second moments, the pattern of shared elements is found by recognizing which relationships are equivalent. For example, as we mentioned in the introduction, the two mother-daughter relationships between generation 1 and 2 must be assigned the same covariance since there is no way to distinguish between the two. We can generalize this intuition by adopting a labeling scheme that incorporates the generation of each cell in a pair and the generation of their Most Recent Common Ancestor (MRCA). For example, the pair of cells <monospace>10</monospace> and <monospace>110</monospace>, which have <monospace>1</monospace> as their MRCA, should be identified with the 3-index ‘231’, where the first two indices specify the generation of each cell (2 and 3) and the third index specifies the generation of their MRCA (1). Now since the 3-index for a different cell pair <monospace>11</monospace> and <monospace>101</monospace> is also ‘231’, the two covariances must be equal.</p>
<p>Note how our 3-index scheme identifies the specific generations of both cells and their MRCA, not just the lineage distance between the two cells. This is necessary because, for non-stationary variation in a tree, specific generations are meaningful, not just generational differences. For example, we need to allow for the possibility that sisters in generation 3 have a different statistical association than do sisters in generation 2, even though the lineage distance (between sisters) is the same.</p>
<p>Applying this labeling scheme to each variance and covariance element, the following structured covariance matrix emerges for a 3-generation tree
<disp-formula id="pcbi.1006745.e127"><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e127" xlink:type="simple"/><label>(5)</label></disp-formula>
where the subscript <inline-formula id="pcbi.1006745.e010"><alternatives><graphic id="pcbi.1006745.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:mi mathvariant="script">G</mml:mi></mml:math></alternatives></inline-formula> denotes a covariance matrix with shared elements. Improved covariance estimation can thus be achieved by pooling across matrix elements which have the same 3-index.</p>
<p>Note that the outer product of the structured mean, <inline-formula id="pcbi.1006745.e011"><alternatives><graphic id="pcbi.1006745.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e011" xlink:type="simple"/><mml:math display="inline" id="M11"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">μ</mml:mi> <mml:mi mathvariant="script">G</mml:mi></mml:msub> <mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow> <mml:mi mathvariant="script">G</mml:mi> <mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, has a pattern of shared elements that are bounded by the lines in <xref ref-type="disp-formula" rid="pcbi.1006745.e127">Eq 5</xref>. The shared parameters in this less complex pattern are identified by the first two indices of the 3-index in <xref ref-type="disp-formula" rid="pcbi.1006745.e127">Eq 5</xref>. This highlights how <inline-formula id="pcbi.1006745.e012"><alternatives><graphic id="pcbi.1006745.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e012" xlink:type="simple"/><mml:math display="inline" id="M12"><mml:msub><mml:mo>Σ</mml:mo> <mml:mi mathvariant="script">G</mml:mi></mml:msub></mml:math></alternatives></inline-formula> describes the structure of variation that is <italic>in addition to</italic> that due to generational trends seen in <xref ref-type="fig" rid="pcbi.1006745.g002">Fig 2</xref>.</p>
<p>We emphasize that assuming shared variances and covariances is necessary because, in an unordered tree, we have no information to assume otherwise. <italic>We are certainly not assuming that the biology of the lineage tree is symmetric</italic>. When we assume shared parameters for an unordered tree we are following the same reasoning as when we assume random effects, rather than fixed effects, for batched data when the labels for different batches are not meaningful (see e.g. p.21 [<xref ref-type="bibr" rid="pcbi.1006745.ref062">62</xref>]).</p>
</sec>
<sec id="sec013">
<title>Permutation invariance</title>
<p>This pattern of shared means, variances and covariances can be found more formally from symmetry considerations. An object is defined to have a symmetry if it remains invariant under the actions of a group (see Weyl [<xref ref-type="bibr" rid="pcbi.1006745.ref063">63</xref>] for the classic introduction). A lineage tree has a symmetry because (the action of) permuting daughter subtrees does not change the relationships between any of the lineal positions. After the permutation, every cell still has the same mother, daughters, cousins and so on (see <xref ref-type="fig" rid="pcbi.1006745.g004">Fig 4</xref>). The permutation has changed no essential information about the tree.</p>
<fig id="pcbi.1006745.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006745.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Permutation symmetry of a tree.</title>
<p>Here the 8 allowed permutations of a tree with 3 generations are shown. These permutations, which involve the swapping of labels starting from the original arrangement in the top left corner, are allowed because they do not change the relationships in the tree. For example, consider the swapping of labels between sisters <monospace>101</monospace> and <monospace>100</monospace> (second from left in top row). Despite the swap, those lineal positions still have the same sister and mother. After any of the 8 permutations shown here, every lineal position still has the same mother, sister, cousins, granddaughters etc. In other words, the lineage tree relationships are invariant to this set of permutations.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006745.g004" xlink:type="simple"/>
</fig>
<p>For our purposes, the key idea is that <bold>Σ</bold> remains invariant under such permutations of subtrees (since the symmetry group of <bold>Σ</bold> is a subgroup of the symmetry group of <bold><italic>μμ</italic></bold>′ we can focus our attention on the symmetry group of <bold>Σ</bold>). Quantifying this intuitive idea involves group representation theory, where matrix multiplications are used to represent symmetry operations [<xref ref-type="bibr" rid="pcbi.1006745.ref064">64</xref>]. For example, if <bold><italic>D</italic></bold><sub><italic>s</italic></sub> is the (<italic>p</italic>-dimensional) permutation matrix representing the action <italic>s</italic> of the group <inline-formula id="pcbi.1006745.e013"><alternatives><graphic id="pcbi.1006745.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e013" xlink:type="simple"/><mml:math display="inline" id="M13"><mml:mi mathvariant="script">G</mml:mi></mml:math></alternatives></inline-formula>, then the permutation <italic>s</italic> of the variables in <bold><italic>y</italic></bold> is represented by <bold><italic>D</italic></bold><sub><italic>s</italic></sub> <bold><italic>y</italic></bold>. The same permutation of variables in the matrix <bold>Σ</bold> is represented by <inline-formula id="pcbi.1006745.e014"><alternatives><graphic id="pcbi.1006745.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e014" xlink:type="simple"/><mml:math display="inline" id="M14"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">D</mml:mi> <mml:mi>s</mml:mi></mml:msub> <mml:mo mathvariant="bold">Σ</mml:mo> <mml:msubsup><mml:mi mathvariant="bold-italic">D</mml:mi> <mml:mi>s</mml:mi> <mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, where such conjugation by <bold><italic>D</italic></bold><sub><italic>s</italic></sub> is necessary to permute both rows and columns.</p>
<p>The condition that <bold>Σ</bold> be invariant under the action of any member of <inline-formula id="pcbi.1006745.e015"><alternatives><graphic id="pcbi.1006745.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e015" xlink:type="simple"/><mml:math display="inline" id="M15"><mml:mi mathvariant="script">G</mml:mi></mml:math></alternatives></inline-formula> can thus be stated as
<disp-formula id="pcbi.1006745.e016"><alternatives><graphic id="pcbi.1006745.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e016" xlink:type="simple"/><mml:math display="block" id="M16"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">D</mml:mi> <mml:mi>s</mml:mi></mml:msub> <mml:mo>Σ</mml:mo> <mml:msubsup><mml:mi mathvariant="bold-italic">D</mml:mi> <mml:mi>s</mml:mi> <mml:mo>′</mml:mo></mml:msubsup> <mml:mo>=</mml:mo> <mml:mo mathvariant="bold">Σ</mml:mo> <mml:mo>,</mml:mo> <mml:mspace width="1.em"/><mml:mo>∀</mml:mo> <mml:mi>s</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="script">G</mml:mi> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(6)</label></disp-formula></p>
<p>Any symmetry-invariant (i.e. <inline-formula id="pcbi.1006745.e017"><alternatives><graphic id="pcbi.1006745.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e017" xlink:type="simple"/><mml:math display="inline" id="M17"><mml:mi mathvariant="script">G</mml:mi></mml:math></alternatives></inline-formula>-invariant) <bold>Σ</bold> thus belongs to the set
<disp-formula id="pcbi.1006745.e018"><alternatives><graphic id="pcbi.1006745.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e018" xlink:type="simple"/><mml:math display="block" id="M18"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="script">W</mml:mi> <mml:mi mathvariant="script">G</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:mi mathvariant="bold-italic">M</mml:mi> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="double-struck">R</mml:mi> <mml:mrow><mml:mi>p</mml:mi> <mml:mo>×</mml:mo> <mml:mi>p</mml:mi></mml:mrow></mml:msup> <mml:mo>|</mml:mo> <mml:mspace width="0.277778em"/><mml:msub><mml:mi mathvariant="bold-italic">D</mml:mi> <mml:mi>s</mml:mi></mml:msub> <mml:mi mathvariant="bold-italic">M</mml:mi> <mml:msubsup><mml:mi mathvariant="bold-italic">D</mml:mi> <mml:mi>s</mml:mi> <mml:mo>′</mml:mo></mml:msubsup> <mml:mo>=</mml:mo> <mml:mi mathvariant="bold-italic">M</mml:mi> <mml:mspace width="1.em"/><mml:mo>∀</mml:mo> <mml:mi>s</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="script">G</mml:mi> <mml:mo>}</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(7)</label></disp-formula>
referred to as the fixed point subspace of the group <inline-formula id="pcbi.1006745.e019"><alternatives><graphic id="pcbi.1006745.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e019" xlink:type="simple"/><mml:math display="inline" id="M19"><mml:mi mathvariant="script">G</mml:mi></mml:math></alternatives></inline-formula> [<xref ref-type="bibr" rid="pcbi.1006745.ref065">65</xref>]. This is the set of all matrices that are invariant with respect to the group.</p>
</sec>
<sec id="sec014">
<title>Group-averaged covariance</title>
<p>A standard technique for transforming an unconstrained matrix <bold>Σ</bold> into one that is symmetry invariant is the group-average or Reynolds operator (see p. 74 [<xref ref-type="bibr" rid="pcbi.1006745.ref066">66</xref>]) given by
<disp-formula id="pcbi.1006745.e020"><alternatives><graphic id="pcbi.1006745.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e020" xlink:type="simple"/><mml:math display="block" id="M20"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="double-struck">P</mml:mi> <mml:mi mathvariant="script">G</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mo mathvariant="bold">Σ</mml:mo> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mo>|</mml:mo> <mml:mi mathvariant="script">G</mml:mi> <mml:mo>|</mml:mo></mml:mrow></mml:mfrac> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>s</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="script">G</mml:mi></mml:mrow></mml:munder> <mml:msub><mml:mi mathvariant="bold-italic">D</mml:mi> <mml:mi>s</mml:mi></mml:msub> <mml:mo mathvariant="bold">Σ</mml:mo> <mml:msubsup><mml:mi mathvariant="bold-italic">D</mml:mi> <mml:mi>s</mml:mi> <mml:mo>′</mml:mo></mml:msubsup> <mml:mo>,</mml:mo> <mml:mspace width="1.em"/><mml:msub><mml:mi mathvariant="double-struck">P</mml:mi> <mml:mi mathvariant="script">G</mml:mi></mml:msub> <mml:mo>:</mml:mo> <mml:msup><mml:mi mathvariant="double-struck">R</mml:mi> <mml:mrow><mml:mi>p</mml:mi> <mml:mo>×</mml:mo> <mml:mi>p</mml:mi></mml:mrow></mml:msup> <mml:mo>→</mml:mo> <mml:msub><mml:mi mathvariant="script">W</mml:mi> <mml:mi mathvariant="script">G</mml:mi></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:msub><mml:mo mathvariant="bold">Σ</mml:mo> <mml:mi mathvariant="script">G</mml:mi></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(8)</label></disp-formula>
where <inline-formula id="pcbi.1006745.e021"><alternatives><graphic id="pcbi.1006745.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e021" xlink:type="simple"/><mml:math display="inline" id="M21"><mml:mrow><mml:mo>|</mml:mo> <mml:mi mathvariant="script">G</mml:mi> <mml:mo>|</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is the order of the group (the number of group elements). This projects the matrix onto the fixed point subspace by averaging over shared elements (referred to as the orbits) of <bold>Σ</bold>. It is straightforward to check that the pattern that arises from <inline-formula id="pcbi.1006745.e022"><alternatives><graphic id="pcbi.1006745.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e022" xlink:type="simple"/><mml:math display="inline" id="M22"><mml:mrow><mml:msub><mml:mi mathvariant="double-struck">P</mml:mi> <mml:mi mathvariant="script">G</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mo mathvariant="bold">Σ</mml:mo> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, when <inline-formula id="pcbi.1006745.e023"><alternatives><graphic id="pcbi.1006745.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e023" xlink:type="simple"/><mml:math display="inline" id="M23"><mml:mi mathvariant="script">G</mml:mi></mml:math></alternatives></inline-formula> is the symmetry group of the tree, is the same as that shown in <xref ref-type="disp-formula" rid="pcbi.1006745.e127">Eq 5</xref>. Thus, averaging <bold>Σ</bold> over all its allowed permutations (members of the group) generates a structured covariance matrix that is invariant to (any further) permutations of the group.</p>
<p>Although the group-average (<xref ref-type="disp-formula" rid="pcbi.1006745.e020">Eq 8</xref>) automatically generates the correct structured covariance for the symmetry group, it is not a practical method for tree-structured data since the number of permutations, <inline-formula id="pcbi.1006745.e024"><alternatives><graphic id="pcbi.1006745.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e024" xlink:type="simple"/><mml:math display="inline" id="M24"><mml:mrow><mml:mo>|</mml:mo> <mml:mi mathvariant="script">G</mml:mi> <mml:mo>|</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, grows super-exponentially with <italic>G</italic> [<xref ref-type="bibr" rid="pcbi.1006745.ref067">67</xref>]. The method is thus more of a conceptual bridge, connecting the symmetry formalism to the covariance structure, than a practical method for deriving the covariance structure itself.</p>
<p>To convert from unstructured to structured means, variances and covariances it is more practical to pool elements by following the shared index structure derived previously (Eqs <xref ref-type="disp-formula" rid="pcbi.1006745.e008">4</xref> and <xref ref-type="disp-formula" rid="pcbi.1006745.e127">5</xref>). Nevertheless, we will still refer to this action of pooling across shared elements as the operation <inline-formula id="pcbi.1006745.e025"><alternatives><graphic id="pcbi.1006745.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e025" xlink:type="simple"/><mml:math display="inline" id="M25"><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi> <mml:mo>(</mml:mo> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, however it is accomplished in practice. Thus, to find the structured sample mean and covariance,
<disp-formula id="pcbi.1006745.e026"><alternatives><graphic id="pcbi.1006745.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e026" xlink:type="simple"/><mml:math display="block" id="M26"><mml:msub><mml:mover><mml:mi mathvariant="bold-italic">y</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi mathvariant="script">G</mml:mi></mml:msub> <mml:mrow><mml:mo>=</mml:mo> <mml:mi mathvariant="double-struck">P</mml:mi> <mml:mo>(</mml:mo> <mml:mover><mml:mi mathvariant="bold-italic">y</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>)</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(9)</label></disp-formula> <disp-formula id="pcbi.1006745.e027"><alternatives><graphic id="pcbi.1006745.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e027" xlink:type="simple"/><mml:math display="block" id="M27"><mml:msub><mml:mi mathvariant="bold-italic">S</mml:mi> <mml:mi mathvariant="script">G</mml:mi></mml:msub> <mml:mrow><mml:mo>=</mml:mo> <mml:mi mathvariant="double-struck">P</mml:mi> <mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">S</mml:mi> <mml:mo>)</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(10)</label></disp-formula></p>
</sec>
<sec id="sec015">
<title>Generalized spectral analysis</title>
<p>The true benefit of the symmetry formalism is in how it can reduce the original high-dimensional problem into independent lower-dimensional problems that have scientific meaning (see p.161 [<xref ref-type="bibr" rid="pcbi.1006745.ref068">68</xref>]). This is achieved through a linear transformation from the set of original variables to the set of natural variables defined by the symmetry of the system. The most well-known example of this is the spectral decomposition of stationary time series data where the underlying symmetry is cyclic and the corresponding natural variables are the Fourier components. Decomposition of a system into its natural variables is thus called generalized spectral analysis, or simply spectral (or harmonic) analysis [<xref ref-type="bibr" rid="pcbi.1006745.ref068">68</xref>] and has been used in many areas of science and engineering [<xref ref-type="bibr" rid="pcbi.1006745.ref064">64</xref>].</p>
<p>Formal application of generalized spectral analysis to covariance estimation has been discussed recently [<xref ref-type="bibr" rid="pcbi.1006745.ref065">65</xref>, <xref ref-type="bibr" rid="pcbi.1006745.ref069">69</xref>]. To motivate its application to a complete tree, here we briefly summarize two well-known types of spectral decomposition, Fourier analysis and the analysis of variance (ANOVA), showing how the underlying symmetry of the system defines a linear transformation that diagonalizes the structured covariance matrix.</p>
<p><italic>Fourier analysis</italic>. Consider the 4-variable system with the cyclic symmetry shown in <xref ref-type="fig" rid="pcbi.1006745.g005">Fig 5a</xref>. These variables could be a temporal sequence where the absolute value of time is not meaningful. Any cyclic shifting of the variables, which does not change in their relative ordering, does not change the system. The covariance matrix then has a circulant structure
<disp-formula id="pcbi.1006745.e028"><alternatives><graphic id="pcbi.1006745.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e028" xlink:type="simple"/><mml:math display="block" id="M28"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msubsup><mml:mrow><mml:mo mathvariant="bold">Σ</mml:mo></mml:mrow> <mml:mi mathvariant="script">G</mml:mi> <mml:mi>F</mml:mi></mml:msubsup></mml:mtd> <mml:mtd><mml:mrow><mml:mo>=</mml:mo> <mml:mo>[</mml:mo> <mml:mtable><mml:mtr><mml:mtd><mml:mi>a</mml:mi></mml:mtd> <mml:mtd><mml:mi>b</mml:mi></mml:mtd> <mml:mtd><mml:mi>c</mml:mi></mml:mtd> <mml:mtd><mml:mi>b</mml:mi></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mi>b</mml:mi></mml:mtd> <mml:mtd><mml:mi>a</mml:mi></mml:mtd> <mml:mtd><mml:mi>b</mml:mi></mml:mtd> <mml:mtd><mml:mi>c</mml:mi></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mi>c</mml:mi></mml:mtd> <mml:mtd><mml:mi>b</mml:mi></mml:mtd> <mml:mtd><mml:mi>a</mml:mi></mml:mtd> <mml:mtd><mml:mi>b</mml:mi></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mi>b</mml:mi></mml:mtd> <mml:mtd><mml:mi>c</mml:mi></mml:mtd> <mml:mtd><mml:mi>b</mml:mi></mml:mtd> <mml:mtd><mml:mi>a</mml:mi></mml:mtd></mml:mtr></mml:mtable> <mml:mo>]</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(11)</label></disp-formula></p>
<fig id="pcbi.1006745.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006745.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Cyclic and tree-structured symmetries.</title>
<p>(a) A cyclic symmetry structure is one that remains invariant under a shift of all the variables (around the circle in the figure shown) that preserves their relative ordering. This cyclic symmetry defines the discrete Fourier transform. (b) A tree symmetry structure is one that remains invariant under permutations within groups and permutations of groups. This symmetry gives rise to ANOVA for nested pairs and also defines the Haar wavelet transform. It is applicable when it is just the leaf nodes that are of interest. (c) When all the nodes of a tree are of interest, the underlying symmetry is still that for the tree. The associated transformation is derived in this paper and discussed in the next section.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006745.g005" xlink:type="simple"/>
</fig>
<p>It is well-known that the circulant structure defines a unitary transformation matrix called the discrete Fourier transform (DFT) matrix which, for 4 variables, is given by
<disp-formula id="pcbi.1006745.e029"><alternatives><graphic id="pcbi.1006745.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e029" xlink:type="simple"/><mml:math display="block" id="M29"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="bold-italic">F</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:mo>[</mml:mo> <mml:mtable><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd> <mml:mtd><mml:mn>1</mml:mn></mml:mtd> <mml:mtd><mml:mn>1</mml:mn></mml:mtd> <mml:mtd><mml:mn>1</mml:mn></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd> <mml:mtd><mml:mrow><mml:mo>-</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mtd> <mml:mtd><mml:mi>i</mml:mi></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd> <mml:mtd><mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mtd> <mml:mtd><mml:mn>1</mml:mn></mml:mtd> <mml:mtd><mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd> <mml:mtd><mml:mi>i</mml:mi></mml:mtd> <mml:mtd><mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mo>-</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable> <mml:mo>]</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(12)</label></disp-formula></p>
<p>Each column represents a natural variable for the cyclic symmetry group, better known as a Fourier basis vector. Using <bold><italic>F</italic></bold> to transform <inline-formula id="pcbi.1006745.e030"><alternatives><graphic id="pcbi.1006745.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e030" xlink:type="simple"/><mml:math display="inline" id="M30"><mml:msubsup><mml:mrow><mml:mo mathvariant="bold">Σ</mml:mo></mml:mrow> <mml:mi mathvariant="script">G</mml:mi> <mml:mi>F</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> into this natural basis results in a diagonal matrix
<disp-formula id="pcbi.1006745.e031"><alternatives><graphic id="pcbi.1006745.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e031" xlink:type="simple"/><mml:math display="block" id="M31"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mrow><mml:mo mathvariant="bold">Σ</mml:mo></mml:mrow> <mml:mo>Ω</mml:mo> <mml:mi>F</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">F</mml:mi></mml:mrow> <mml:mo>†</mml:mo></mml:msup> <mml:msubsup><mml:mrow><mml:mo mathvariant="bold">Σ</mml:mo></mml:mrow> <mml:mi mathvariant="script">G</mml:mi> <mml:mi>F</mml:mi></mml:msubsup> <mml:mi mathvariant="bold-italic">F</mml:mi> <mml:mo>=</mml:mo> <mml:mo>[</mml:mo> <mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>a</mml:mi> <mml:mo>+</mml:mo> <mml:mn>2</mml:mn> <mml:mi>b</mml:mi> <mml:mo>+</mml:mo> <mml:mi>c</mml:mi></mml:mrow></mml:mtd> <mml:mtd><mml:mo>·</mml:mo></mml:mtd> <mml:mtd><mml:mo>·</mml:mo></mml:mtd> <mml:mtd><mml:mo>·</mml:mo></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mo>·</mml:mo></mml:mtd> <mml:mtd><mml:mrow><mml:mi>a</mml:mi> <mml:mo>-</mml:mo> <mml:mi>c</mml:mi></mml:mrow></mml:mtd> <mml:mtd><mml:mo>·</mml:mo></mml:mtd> <mml:mtd><mml:mo>·</mml:mo></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mo>·</mml:mo></mml:mtd> <mml:mtd><mml:mo>·</mml:mo></mml:mtd> <mml:mtd><mml:mrow><mml:mi>a</mml:mi> <mml:mo>-</mml:mo> <mml:mn>2</mml:mn> <mml:mi>b</mml:mi> <mml:mo>+</mml:mo> <mml:mi>c</mml:mi></mml:mrow></mml:mtd> <mml:mtd><mml:mo>·</mml:mo></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mo>·</mml:mo></mml:mtd> <mml:mtd><mml:mo>·</mml:mo></mml:mtd> <mml:mtd><mml:mo>·</mml:mo></mml:mtd> <mml:mtd><mml:mrow><mml:mi>a</mml:mi> <mml:mo>-</mml:mo> <mml:mi>c</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable> <mml:mo>]</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(13)</label></disp-formula>
called the spectral covariance, where the diagonal elements represent the spectrum. Thus, the circulant-structured matrix is transformed into the spectral covariance using the DFT matrix.</p>
<p><italic>ANOVA on nested pairs (Haar wavelet analysis)</italic>. Now consider a system consisting of nested batches of variables, a standard problem in the analysis of variance, or variance components analysis. Consider the case of 2 batches each containing 2 variables. This structure can be depicted as the leaves on a binary tree shown in <xref ref-type="fig" rid="pcbi.1006745.g005">Fig 5b</xref>. The symmetry operations for this structure are the permutations within groups and permutations of groups, or, as we discussed earlier, the exchange of daughter subtrees. The covariance matrix invariant under these symmetry operations has the form
<disp-formula id="pcbi.1006745.e032"><alternatives><graphic id="pcbi.1006745.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e032" xlink:type="simple"/><mml:math display="block" id="M32"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msubsup><mml:mrow><mml:mo mathvariant="bold">Σ</mml:mo></mml:mrow> <mml:mi mathvariant="script">G</mml:mi> <mml:mi>H</mml:mi></mml:msubsup></mml:mtd> <mml:mtd><mml:mrow><mml:mo>=</mml:mo> <mml:mo>[</mml:mo> <mml:mtable><mml:mtr><mml:mtd><mml:mi>a</mml:mi></mml:mtd> <mml:mtd><mml:mi>b</mml:mi></mml:mtd> <mml:mtd><mml:mi>c</mml:mi></mml:mtd> <mml:mtd><mml:mi>c</mml:mi></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mi>b</mml:mi></mml:mtd> <mml:mtd><mml:mi>a</mml:mi></mml:mtd> <mml:mtd><mml:mi>c</mml:mi></mml:mtd> <mml:mtd><mml:mi>c</mml:mi></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mi>c</mml:mi></mml:mtd> <mml:mtd><mml:mi>c</mml:mi></mml:mtd> <mml:mtd><mml:mi>a</mml:mi></mml:mtd> <mml:mtd><mml:mi>b</mml:mi></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mi>c</mml:mi></mml:mtd> <mml:mtd><mml:mi>c</mml:mi></mml:mtd> <mml:mtd><mml:mi>b</mml:mi></mml:mtd> <mml:mtd><mml:mi>a</mml:mi></mml:mtd></mml:mtr></mml:mtable> <mml:mo>]</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(14)</label></disp-formula>
which was given in the bottom right corner of <xref ref-type="disp-formula" rid="pcbi.1006745.e127">Eq 5</xref>. The matrix that diagonalizes this structure,
<disp-formula id="pcbi.1006745.e033"><alternatives><graphic id="pcbi.1006745.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e033" xlink:type="simple"/><mml:math display="block" id="M33"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="bold-italic">H</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:mo>[</mml:mo> <mml:mtable><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd> <mml:mtd><mml:mn>1</mml:mn></mml:mtd> <mml:mtd><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd> <mml:mtd><mml:mn>1</mml:mn></mml:mtd> <mml:mtd><mml:mrow><mml:mo>-</mml:mo> <mml:msqrt><mml:mn>2</mml:mn></mml:msqrt></mml:mrow></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd> <mml:mtd><mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd> <mml:mtd><mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mrow><mml:mo>-</mml:mo> <mml:msqrt><mml:mn>2</mml:mn></mml:msqrt></mml:mrow></mml:mtd></mml:mtr></mml:mtable> <mml:mo>]</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(15)</label></disp-formula>
is known as the Haar (wavelet) transform matrix. Each column defines a natural variable for the tree symmetry and represents a source of variation or a wavelet component. Using <bold><italic>H</italic></bold> to transform <inline-formula id="pcbi.1006745.e034"><alternatives><graphic id="pcbi.1006745.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e034" xlink:type="simple"/><mml:math display="inline" id="M34"><mml:msubsup><mml:mrow><mml:mo mathvariant="bold">Σ</mml:mo></mml:mrow> <mml:mi mathvariant="script">G</mml:mi> <mml:mi>H</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> into this natural basis results in a (diagonalized) spectral covariance
<disp-formula id="pcbi.1006745.e035"><alternatives><graphic id="pcbi.1006745.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e035" xlink:type="simple"/><mml:math display="block" id="M35"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msubsup><mml:mrow><mml:mo mathvariant="bold">Σ</mml:mo></mml:mrow> <mml:mo>Ω</mml:mo> <mml:mi>H</mml:mi></mml:msubsup></mml:mtd> <mml:mtd><mml:mrow><mml:mo>=</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">H</mml:mi></mml:mrow> <mml:mo>†</mml:mo></mml:msup> <mml:msubsup><mml:mrow><mml:mo mathvariant="bold">Σ</mml:mo></mml:mrow> <mml:mi mathvariant="script">G</mml:mi> <mml:mi>H</mml:mi></mml:msubsup> <mml:mi mathvariant="bold-italic">H</mml:mi> <mml:mo>=</mml:mo> <mml:mo>[</mml:mo> <mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>a</mml:mi> <mml:mo>+</mml:mo> <mml:mi>b</mml:mi> <mml:mo>+</mml:mo> <mml:mn>2</mml:mn> <mml:mi>c</mml:mi></mml:mrow></mml:mtd> <mml:mtd><mml:mo>·</mml:mo></mml:mtd> <mml:mtd><mml:mo>·</mml:mo></mml:mtd> <mml:mtd><mml:mo>·</mml:mo></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mo>·</mml:mo></mml:mtd> <mml:mtd><mml:mrow><mml:mi>a</mml:mi> <mml:mo>+</mml:mo> <mml:mi>b</mml:mi> <mml:mo>-</mml:mo> <mml:mn>2</mml:mn> <mml:mi>c</mml:mi></mml:mrow></mml:mtd> <mml:mtd><mml:mo>·</mml:mo></mml:mtd> <mml:mtd><mml:mo>·</mml:mo></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mo>·</mml:mo></mml:mtd> <mml:mtd><mml:mo>·</mml:mo></mml:mtd> <mml:mtd><mml:mrow><mml:mi>a</mml:mi> <mml:mo>-</mml:mo> <mml:mi>b</mml:mi></mml:mrow></mml:mtd> <mml:mtd><mml:mo>·</mml:mo></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mo>·</mml:mo></mml:mtd> <mml:mtd><mml:mo>·</mml:mo></mml:mtd> <mml:mtd><mml:mo>·</mml:mo></mml:mtd> <mml:mtd><mml:mrow><mml:mi>a</mml:mi> <mml:mo>-</mml:mo> <mml:mi>b</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable> <mml:mo>]</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(16)</label></disp-formula>
where the diagonal elements are known as the components of variance (if we regard this from the ANOVA perspective), or the Haar wavelet spectrum (if we regard this as wavelet analysis). Here there are 3 sources of variation: between trees (<italic>a</italic> + <italic>b</italic> + 2<italic>c</italic>), within trees (<italic>a</italic> + <italic>b</italic> − 2<italic>c</italic>), and within subtrees (<italic>a</italic> − <italic>b</italic>).</p>
<p>We emphasize that the change-of-basis matrices <bold><italic>F</italic></bold> and <bold><italic>H</italic></bold> are defined by the symmetry of each system. They transform the original variables into a set of non-interacting natural variables (Fourier or Haar wavelet components) which define the meaningful components of variance. It was Tukey [<xref ref-type="bibr" rid="pcbi.1006745.ref070">70</xref>] who first showed that Fourier decomposition can be regarded as a branch of variance components analysis (see Speed [<xref ref-type="bibr" rid="pcbi.1006745.ref071">71</xref>] for more extensive discussion).</p>
<p>It is worth pointing out how this diagonalization, or eigendecomposition, of the covariance matrix, relates to traditional principal components analysis. In generalized spectral analysis, the eigenvectors (given by the columns in <bold><italic>F</italic></bold> and <bold><italic>H</italic></bold>), or, more precisely, the eigenspaces, are determined by the <italic>structure</italic> of <bold>Σ</bold> and do not depend on its entries. In addition, the eigenvalues are linear functions of the entries. Neither of these properties are true, in general, for principal components analysis.</p>
</sec>
<sec id="sec016">
<title>Generalized spectral analysis of a complete tree</title>
<p>Having examined the case of a tree where only the leaf nodes are of interest (<xref ref-type="fig" rid="pcbi.1006745.g005">Fig 5b</xref>), we now examine the case where all positions in the tree are of interest (<xref ref-type="fig" rid="pcbi.1006745.g005">Fig 5c</xref>). For the complete tree, we already know the structured covariance <inline-formula id="pcbi.1006745.e036"><alternatives><graphic id="pcbi.1006745.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e036" xlink:type="simple"/><mml:math display="inline" id="M36"><mml:msub><mml:mo mathvariant="bold">Σ</mml:mo> <mml:mi mathvariant="script">G</mml:mi></mml:msub></mml:math></alternatives></inline-formula> (see <xref ref-type="disp-formula" rid="pcbi.1006745.e127">Eq 5</xref>). Our tasks then are to derive the change-of-basis matrix, interpret the natural variables, and calculate the spectral covariance.</p>
<p>Formal derivation of the change-of-basis matrix, <bold><italic>T</italic></bold>, for a complete tree is shown in Section S1.2 in <xref ref-type="supplementary-material" rid="pcbi.1006745.s001">S1 Appendix</xref>. This represents the generalization of the Haar transform matrix <bold><italic>H</italic></bold> to a complete tree. For a 3-generation tree it is given by
<disp-formula id="pcbi.1006745.e128"><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e128" xlink:type="simple"/><label>(17)</label></disp-formula>
where the columns, as usual, define the natural variables.</p>
<p>There are two equivalent ways to interpret these natural variables: from the ANOVA perspective, and from the wavelet perspective. From the nested ANOVA perspective, each natural variable is associated with a source of variation (<italic>ℓ</italic>, <italic>τ</italic>) located at the root of a subtree. From the wavelet perspective, <italic>ℓ</italic> and <italic>τ</italic> correspond to the dilation and translation indices, respectively, for the wavelet coefficients (see e.g. [<xref ref-type="bibr" rid="pcbi.1006745.ref072">72</xref>]). In both perspectives, because we are considering a tree with multiple generations, we need a third index, <italic>g</italic>, specifying the generation in which the variation is observed in order to uniquely identify each natural variable (see <xref ref-type="fig" rid="pcbi.1006745.g003">Fig 3</xref> for the labeling convention). The 3-index label (<italic>ℓ</italic>, <italic>τ</italic>, <italic>g</italic>) is given above each column in <xref ref-type="disp-formula" rid="pcbi.1006745.e128">Eq 17</xref>, with vertical lines used to partition the different <italic>ℓ</italic>.</p>
<p>Extending the change-of-basis matrix to 4 generations gives
<disp-formula id="pcbi.1006745.e037"><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e037" xlink:type="simple"/></disp-formula></p>
<p>A visual representation of how these natural variables are constructed from the original variables is shown in <xref ref-type="fig" rid="pcbi.1006745.g006">Fig 6</xref> for the case of a 4-generation tree. This emphasizes how the <italic>ℓ</italic>-coordinate of the source of variation characterizes the scale of the pattern. <xref ref-type="fig" rid="pcbi.1006745.g007">Fig 7</xref> shows a few examples of the natural variables to illustrate how they are convenient, elemental components for describing tree-structured variation.</p>
<fig id="pcbi.1006745.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006745.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Construction of the natural variables for a tree with 4 generations.</title>
<p>Each natural variable is identified by a source of variation (<italic>ℓ</italic>, <italic>τ</italic>), corresponding to the root of a subtree, and a generation <italic>g</italic>. The + and − at each lineal position illustrate how the original variables are combined to form a natural variable. The 15 natural variables thus defined by the 3-tuple (<italic>ℓ</italic>, <italic>τ</italic>, <italic>g</italic>) are listed in the bottom row. Since the <italic>τ</italic> coordinates are indistinguishable, only 10 of the natural variables (those with <italic>τ</italic> = 0, say) are unique.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006745.g006" xlink:type="simple"/>
</fig>
<fig id="pcbi.1006745.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006745.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Bifurcated subtrees.</title>
<p>Patterns on a tree can be described in terms of natural variables, or elemental components, examples of which are shown here. Each component is a bifurcated pattern centered on a subtree (<italic>ℓ</italic>, <italic>τ</italic>) and expressed in a generation <italic>g</italic> (where <italic>τ</italic> is ignored in an unordered tree). For example, the blue/non-blue bifurcated pattern occupies a subtree rooted at <italic>ℓ</italic> = 3 and observed at generations 5, 6, and 7. Note that <italic>ℓ</italic> = 1 variation (on the right) is a bifurcation across the whole pedigree. Variation among different pedigrees would be labeled with <italic>ℓ</italic> = 0.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006745.g007" xlink:type="simple"/>
</fig>
<p>The natural variables thus correspond to patterns of bifurcated expression on subtrees, or, more succinctly, <italic>bifurcated subtrees</italic>. These are the analogs to Fourier components, and could in fact be referred to as generalized Fourier components for the tree. Thus it is not subtrees that are the fundamental units of expression in a binary tree but rather bifurcated subtrees.</p>
<p>The natural variables are not particularly surprising: they are just those one would define in a nested ANOVA or Haar wavelet analysis if each generation were considered separately. Perhaps more surprising is their arrangement in <bold><italic>T</italic></bold>: although <xref ref-type="disp-formula" rid="pcbi.1006745.e128">Eq 17</xref> contains every column of the Haar transform matrix for generations 2 (dotted lines) and 3 (dashed lines), these matrices are not incorporated simply as a direct sum. Instead, representation theory demands that we group the natural variables by (<italic>ℓ</italic>, <italic>τ</italic>). When we do this and apply <bold><italic>T</italic></bold> to <inline-formula id="pcbi.1006745.e038"><alternatives><graphic id="pcbi.1006745.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e038" xlink:type="simple"/><mml:math display="inline" id="M38"><mml:msub><mml:mo mathvariant="bold">Σ</mml:mo> <mml:mi mathvariant="script">G</mml:mi></mml:msub></mml:math></alternatives></inline-formula> from <xref ref-type="disp-formula" rid="pcbi.1006745.e127">Eq 5</xref> we get a <italic>block</italic>-diagonalized spectral covariance,
<disp-formula id="pcbi.1006745.e039"><alternatives><graphic id="pcbi.1006745.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e039" xlink:type="simple"/><mml:math display="block" id="M39"><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow> <mml:msub><mml:mrow><mml:mstyle displaystyle="true"><mml:mo mathvariant="bold">Σ</mml:mo></mml:mstyle></mml:mrow><mml:mrow><mml:mo>Ω</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:msup><mml:mi mathvariant="bold-italic">T</mml:mi> <mml:mo>†</mml:mo></mml:msup> <mml:msub><mml:mrow><mml:mstyle displaystyle="true"><mml:mo mathvariant="bold">Σ</mml:mo></mml:mstyle></mml:mrow> <mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="bold-italic">T</mml:mi></mml:mrow></mml:mtd></mml:mtr> <mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:menclose notation="box"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>ξ</mml:mi> <mml:mrow><mml:mn>11</mml:mn></mml:mrow> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mn>0</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msubsup><mml:mi>ξ</mml:mi> <mml:mrow><mml:mn>12</mml:mn></mml:mrow> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mn>0</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msubsup><mml:mi>ξ</mml:mi> <mml:mrow><mml:mn>13</mml:mn></mml:mrow> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mn>0</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>ξ</mml:mi> <mml:mrow><mml:mn>12</mml:mn></mml:mrow> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mn>0</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msubsup><mml:mi>ξ</mml:mi> <mml:mrow><mml:mn>22</mml:mn></mml:mrow> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mn>0</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msubsup><mml:mi>ξ</mml:mi> <mml:mrow><mml:mn>23</mml:mn></mml:mrow> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mn>0</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>ξ</mml:mi> <mml:mrow><mml:mn>13</mml:mn></mml:mrow> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mn>0</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msubsup><mml:mi>ξ</mml:mi> <mml:mrow><mml:mn>23</mml:mn></mml:mrow> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mn>0</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msubsup><mml:mi>ξ</mml:mi> <mml:mrow><mml:mn>33</mml:mn></mml:mrow> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mn>0</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:menclose></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mo>.</mml:mo></mml:mtd> <mml:mtd><mml:mo>.</mml:mo></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mo>.</mml:mo></mml:mtd> <mml:mtd><mml:mo>.</mml:mo></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mo>.</mml:mo></mml:mtd> <mml:mtd><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mo>.</mml:mo></mml:mtd> <mml:mtd><mml:mo>.</mml:mo></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mo>.</mml:mo></mml:mtd> <mml:mtd><mml:mo>.</mml:mo></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mo>.</mml:mo></mml:mtd> <mml:mtd><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mo>.</mml:mo></mml:mtd> <mml:mtd><mml:mo>.</mml:mo></mml:mtd> <mml:mtd><mml:mo>.</mml:mo></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mo>.</mml:mo></mml:mtd> <mml:mtd><mml:mo>.</mml:mo></mml:mtd> <mml:mtd><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:menclose notation="box"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>ξ</mml:mi> <mml:mrow><mml:mn>22</mml:mn></mml:mrow> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mn>1</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msubsup><mml:mi>ξ</mml:mi> <mml:mrow><mml:mn>23</mml:mn></mml:mrow> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mn>1</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>ξ</mml:mi> <mml:mrow><mml:mn>23</mml:mn></mml:mrow> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mn>1</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msubsup><mml:mi>ξ</mml:mi> <mml:mrow><mml:mn>33</mml:mn></mml:mrow> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mn>1</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:menclose></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mo>.</mml:mo></mml:mtd> <mml:mtd><mml:mo>.</mml:mo></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mo>.</mml:mo></mml:mtd> <mml:mtd><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mo>.</mml:mo></mml:mtd> <mml:mtd><mml:mo>.</mml:mo></mml:mtd> <mml:mtd><mml:mo>.</mml:mo></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mo>.</mml:mo></mml:mtd> <mml:mtd><mml:mo>.</mml:mo></mml:mtd> <mml:mtd><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mo>.</mml:mo></mml:mtd> <mml:mtd><mml:mo>.</mml:mo></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mo>.</mml:mo></mml:mtd> <mml:mtd><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:menclose notation="box"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>ξ</mml:mi> <mml:mrow><mml:mn>33</mml:mn></mml:mrow> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mn>2</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mtd> <mml:mtd><mml:mo>.</mml:mo></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mo>.</mml:mo></mml:mtd> <mml:mtd><mml:mrow><mml:msubsup><mml:mi>ξ</mml:mi> <mml:mrow><mml:mn>33</mml:mn></mml:mrow> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mn>2</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:menclose></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives> <label>(18)</label></disp-formula>
where each block corresponds to a source of variation <italic>ℓ</italic> and its associated generations <italic>g</italic>, where <italic>g</italic> &gt; <italic>ℓ</italic>. Here we label matrix elements as <inline-formula id="pcbi.1006745.e040"><alternatives><graphic id="pcbi.1006745.e040g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e040" xlink:type="simple"/><mml:math display="inline" id="M40"><mml:msubsup><mml:mi>ξ</mml:mi> <mml:mrow><mml:mi>g</mml:mi> <mml:msup><mml:mi>g</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ℓ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> where subscripts refer to the pair of interacting generations, <italic>g</italic> and <italic>g</italic>′ (there is no need to use <italic>τ</italic> as a label since elements differing only in <italic>τ</italic> have identical values). Note how the components of variation that we encountered on the diagonal in <inline-formula id="pcbi.1006745.e041"><alternatives><graphic id="pcbi.1006745.e041g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e041" xlink:type="simple"/><mml:math display="inline" id="M41"><mml:msubsup><mml:mrow><mml:mo mathvariant="bold">Σ</mml:mo></mml:mrow> <mml:mo>Ω</mml:mo> <mml:mi>H</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> (<xref ref-type="disp-formula" rid="pcbi.1006745.e035">Eq 16</xref>), where only third generation variables were of interest, are here labeled as <inline-formula id="pcbi.1006745.e042"><alternatives><graphic id="pcbi.1006745.e042g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e042" xlink:type="simple"/><mml:math display="inline" id="M42"><mml:msubsup><mml:mi>ξ</mml:mi> <mml:mrow><mml:mn>33</mml:mn></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1006745.e043"><alternatives><graphic id="pcbi.1006745.e043g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e043" xlink:type="simple"/><mml:math display="inline" id="M43"><mml:msubsup><mml:mi>ξ</mml:mi> <mml:mrow><mml:mn>33</mml:mn></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>, and <inline-formula id="pcbi.1006745.e044"><alternatives><graphic id="pcbi.1006745.e044g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e044" xlink:type="simple"/><mml:math display="inline" id="M44"><mml:msubsup><mml:mi>ξ</mml:mi> <mml:mrow><mml:mn>33</mml:mn></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>. They are still on the diagonal but are grouped with their counterparts from generations 1 and 2.</p>
<p>To better appreciate the block-diagonal structure of <bold>Σ</bold><sub>Ω</sub>, we show it as a heat map for the case of a 4-generation tree (<xref ref-type="fig" rid="pcbi.1006745.g008">Fig 8b</xref>) along with the corresponding <inline-formula id="pcbi.1006745.e045"><alternatives><graphic id="pcbi.1006745.e045g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e045" xlink:type="simple"/><mml:math display="inline" id="M45"><mml:msub><mml:mo mathvariant="bold">Σ</mml:mo> <mml:mi mathvariant="script">G</mml:mi></mml:msub></mml:math></alternatives></inline-formula> (<xref ref-type="fig" rid="pcbi.1006745.g008">Fig 8a</xref>). This emphasizes how each block <italic>ℓ</italic> is further block-diagonalized by <italic>τ</italic>. In the terminology of group representation theory, <italic>ℓ</italic> identifies an isotypic subspace while <italic>τ</italic> identifies an irreducible subspace—a subset of the isotypic subspace. In <xref ref-type="fig" rid="pcbi.1006745.g008">Fig 8b</xref>, the isotypic blocks are bounded by dashed lines, while the irreducible blocks are bounded by dotted lines.</p>
<fig id="pcbi.1006745.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006745.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Heat maps of <inline-formula id="pcbi.1006745.e046"><alternatives><graphic id="pcbi.1006745.e046g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e046" xlink:type="simple"/><mml:math display="inline" id="M46"><mml:msub><mml:mo>Σ</mml:mo> <mml:mi mathvariant="script">G</mml:mi></mml:msub></mml:math></alternatives></inline-formula> and Σ<sub>Ω</sub> for a complete tree.</title>
<p>This example was taken from the first 4 generations of the branching process. Natural variables along the axes of <bold>Σ</bold><sub>Ω</sub> are given in the format (<italic>ℓ</italic>, <italic>τ</italic>, <italic>g</italic>). Isotypic blocks are bounded by dashed squares and correspond to a given <italic>ℓ</italic>. Irreducible blocks correspond to a source of variation (<italic>ℓ</italic>, <italic>τ</italic>) and are bounded by a dotted square. For <italic>ℓ</italic> = 0 and 1 the isotypic and irreducible blocks coincide since there is only one <italic>τ</italic> index value.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006745.g008" xlink:type="simple"/>
</fig>
<p>The primary benefit of identifying the spectral transformation for the complete tree is that <bold>Σ</bold><sub>Ω</sub> contains all the information in <inline-formula id="pcbi.1006745.e047"><alternatives><graphic id="pcbi.1006745.e047g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e047" xlink:type="simple"/><mml:math display="inline" id="M47"><mml:msub><mml:mo mathvariant="bold">Σ</mml:mo> <mml:mi mathvariant="script">G</mml:mi></mml:msub></mml:math></alternatives></inline-formula> but in a much simpler form. Having pooled data to estimate <inline-formula id="pcbi.1006745.e048"><alternatives><graphic id="pcbi.1006745.e048g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e048" xlink:type="simple"/><mml:math display="inline" id="M48"><mml:msub><mml:mover accent="true"><mml:mo mathvariant="bold">Σ</mml:mo> <mml:mo>^</mml:mo></mml:mover> <mml:mi mathvariant="script">G</mml:mi></mml:msub></mml:math></alternatives></inline-formula> one simply performs the linear transformation to get <inline-formula id="pcbi.1006745.e049"><alternatives><graphic id="pcbi.1006745.e049g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e049" xlink:type="simple"/><mml:math display="inline" id="M49"><mml:msub><mml:mover accent="true"><mml:mo mathvariant="bold">Σ</mml:mo> <mml:mo>^</mml:mo></mml:mover> <mml:mo>Ω</mml:mo></mml:msub></mml:math></alternatives></inline-formula>.</p>
<p>We pause briefly to examine how this generalized spectral analysis for a complete tree is analogous to traditional Fourier analysis for a time series. As we mentioned, bifurcated subtrees are the natural variables for a binary tree and are thus analogous to sine and cosine waves. Any pattern on a tree, whether or not it is clonal, can thus be defined as a superposition of bifurcated subtrees. This idea is useful when trying to interpret non-clonal lineage patterns: whereas a clonal pattern is associated with a single subtree, a non-clonal pattern is a superposition of multiple subtrees.</p>
<p>Another analogy is between the ordering of the tree and the phase of a time series. Our ability to average different trees regardless of their ordering is similar to the ability to average the spectra of different time series each having unknown (and potentially different) starting phases. One knows that to pool data across different time series, one should average their spectra, not the different time series themselves. Other analogies are shown in <xref ref-type="table" rid="pcbi.1006745.t002">Table 2</xref>.</p>
<table-wrap id="pcbi.1006745.t002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006745.t002</object-id>
<label>Table 2</label>
<caption>
<title>Generalized spectral analysis.</title>
<p>Well-known quantities in Fourier analysis have their direct analogs in the spectral analysis of a tree.</p>
</caption>
<alternatives>
<graphic id="pcbi.1006745.t002g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006745.t002" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center"><italic>Fourier analysis</italic></th>
<th align="center"><italic>Tree analysis</italic></th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">Sine, Cosine waves</td>
<td align="center">Bifurcated subtrees</td>
</tr>
<tr>
<td align="center">Phase</td>
<td align="center">Ordering of the tree</td>
</tr>
<tr>
<td align="center">Auto-covariance</td>
<td align="center">Structured covariance, <inline-formula id="pcbi.1006745.e050"><alternatives><graphic id="pcbi.1006745.e050g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e050" xlink:type="simple"/><mml:math display="inline" id="M50"><mml:msub><mml:mo mathvariant="bold">Σ</mml:mo> <mml:mi mathvariant="script">G</mml:mi></mml:msub></mml:math></alternatives></inline-formula> (<xref ref-type="disp-formula" rid="pcbi.1006745.e002">Eq 1</xref>)</td>
</tr>
<tr>
<td align="center">Discrete Fourier Transform matrix</td>
<td align="center">Change-of-basis matrix, <bold><italic>T</italic></bold> (<xref ref-type="disp-formula" rid="pcbi.1006745.e128">Eq 17</xref>)</td>
</tr>
<tr>
<td align="center">Power spectrum</td>
<td align="center">Spectral covariance, <bold>Σ</bold><sub>Ω</sub> (<xref ref-type="disp-formula" rid="pcbi.1006745.e039">Eq 18</xref>)</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
</sec>
<sec id="sec017">
<title>Complexity of the structured covariance</title>
<p>Spectral decomposition shows that the high-dimensional covariance estimation problem involving shared parameters in <inline-formula id="pcbi.1006745.e051"><alternatives><graphic id="pcbi.1006745.e051g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e051" xlink:type="simple"/><mml:math display="inline" id="M51"><mml:msub><mml:mover accent="true"><mml:mo mathvariant="bold">Σ</mml:mo> <mml:mo>^</mml:mo></mml:mover> <mml:mi mathvariant="script">G</mml:mi></mml:msub></mml:math></alternatives></inline-formula> is equivalent to several, lower-dimensional covariance estimation problems given by the irreducible blocks in <inline-formula id="pcbi.1006745.e052"><alternatives><graphic id="pcbi.1006745.e052g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e052" xlink:type="simple"/><mml:math display="inline" id="M52"><mml:msub><mml:mover accent="true"><mml:mo mathvariant="bold">Σ</mml:mo> <mml:mo>^</mml:mo></mml:mover> <mml:mo>Ω</mml:mo></mml:msub></mml:math></alternatives></inline-formula>. We can use this to calculate the complexity of <inline-formula id="pcbi.1006745.e053"><alternatives><graphic id="pcbi.1006745.e053g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e053" xlink:type="simple"/><mml:math display="inline" id="M53"><mml:msub><mml:mover accent="true"><mml:mo mathvariant="bold">Σ</mml:mo> <mml:mo>^</mml:mo></mml:mover> <mml:mo>Ω</mml:mo></mml:msub></mml:math></alternatives></inline-formula> as we did for the unstructured covariance (<xref ref-type="disp-formula" rid="pcbi.1006745.e007">Eq 3</xref>).</p>
<p>Because each unique irreducible block is an independent, unstructured estimate of a covariance matrix, the effective number of dimensions, <italic>p</italic><sub>eff</sub>, is given by summing the number of dimensions for each <italic>unique</italic> irreducible subspace. The number of free parameters in the covariance matrix, <inline-formula id="pcbi.1006745.e054"><alternatives><graphic id="pcbi.1006745.e054g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e054" xlink:type="simple"/><mml:math display="inline" id="M54"><mml:msub><mml:mi mathvariant="script">N</mml:mi> <mml:mo mathvariant="bold">Σ</mml:mo></mml:msub></mml:math></alternatives></inline-formula>, is found by summing the number of parameters in each <italic>unique</italic> irreducible block. The minimum number of replicates required, <italic>n</italic><sub>min</sub>, is found from the dimensionality of the largest irreducible block (<italic>ℓ</italic> = 0). Thus
<disp-formula id="pcbi.1006745.e055"><alternatives><graphic id="pcbi.1006745.e055g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e055" xlink:type="simple"/><mml:math display="block" id="M55"><mml:msub><mml:mi>p</mml:mi> <mml:mtext>eff</mml:mtext></mml:msub> <mml:mrow><mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>ℓ</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow> <mml:mrow><mml:mi>G</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:munderover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>G</mml:mi> <mml:mo>-</mml:mo> <mml:mi>ℓ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mi>G</mml:mi> <mml:mo>(</mml:mo> <mml:mi>G</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:mfrac> <mml:mo>=</mml:mo> <mml:mi mathvariant="script">O</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>G</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(19)</label></disp-formula> <disp-formula id="pcbi.1006745.e056"><alternatives><graphic id="pcbi.1006745.e056g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e056" xlink:type="simple"/><mml:math display="block" id="M56"><mml:msub><mml:mi mathvariant="script">N</mml:mi> <mml:mo>Σ</mml:mo></mml:msub> <mml:mrow><mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>ℓ</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow> <mml:mrow><mml:mi>G</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:munderover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>G</mml:mi> <mml:mo>-</mml:mo> <mml:mi>ℓ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>G</mml:mi> <mml:mo>-</mml:mo> <mml:mi>ℓ</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mi>G</mml:mi> <mml:mn>6</mml:mn></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>G</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>G</mml:mi> <mml:mo>+</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi mathvariant="script">O</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>G</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(20)</label></disp-formula> <disp-formula id="pcbi.1006745.e057"><alternatives><graphic id="pcbi.1006745.e057g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e057" xlink:type="simple"/><mml:math display="block" id="M57"><mml:msub><mml:mi>n</mml:mi> <mml:mtext>min</mml:mtext></mml:msub> <mml:mrow><mml:mo>=</mml:mo> <mml:mi>G</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>=</mml:mo> <mml:mi mathvariant="script">O</mml:mi> <mml:mo>(</mml:mo> <mml:mi>G</mml:mi> <mml:mo>)</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(21)</label></disp-formula></p>
<p>The group-symmetric model is thus significantly more constrained than the unstructured model, with the number of parameters growing polynomially with <italic>G</italic> instead of exponentially (compare <xref ref-type="disp-formula" rid="pcbi.1006745.e007">Eq 3</xref>). Note how <italic>p</italic><sub>eff</sub> &lt; <italic>p</italic> (when <italic>G</italic> ≥ 3), a reduction in the effective number of dimensions that was not apparent from <inline-formula id="pcbi.1006745.e058"><alternatives><graphic id="pcbi.1006745.e058g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e058" xlink:type="simple"/><mml:math display="inline" id="M58"><mml:msub><mml:mo mathvariant="bold">Σ</mml:mo> <mml:mi mathvariant="script">G</mml:mi></mml:msub></mml:math></alternatives></inline-formula> alone.</p>
<p>Nevertheless, even with these symmetry constraints, <italic>n</italic><sub>min</sub> still grows with <italic>G</italic>, albeit linearly (<xref ref-type="disp-formula" rid="pcbi.1006745.e057">Eq 21</xref>) instead of exponentially (<xref ref-type="disp-formula" rid="pcbi.1006745.e007">Eq 3</xref>). This means that, for a fixed set of <italic>n</italic> replicates, there will always be a limit to the number of generations that can be analyzed. We need an additional constraint.</p>
</sec>
<sec id="sec018">
<title>Sparsity</title>
<p>The additional constraint comes from imposing a sparsity requirement on each irreducible subspace by restricting the Markov order, <inline-formula id="pcbi.1006745.e059"><alternatives><graphic id="pcbi.1006745.e059g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e059" xlink:type="simple"/><mml:math display="inline" id="M59"><mml:mi mathvariant="script">M</mml:mi></mml:math></alternatives></inline-formula>, of each time series. This constraint represents a simple case of a decomposable graphical model and results in a Markov-constrained spectral covariance estimate, <inline-formula id="pcbi.1006745.e060"><alternatives><graphic id="pcbi.1006745.e060g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e060" xlink:type="simple"/><mml:math display="inline" id="M60"><mml:msub><mml:mover accent="true"><mml:mo mathvariant="bold">Σ</mml:mo> <mml:mo>^</mml:mo></mml:mover> <mml:mo>Ω</mml:mo></mml:msub></mml:math></alternatives></inline-formula> and structured covariance estimate <inline-formula id="pcbi.1006745.e061"><alternatives><graphic id="pcbi.1006745.e061g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e061" xlink:type="simple"/><mml:math display="inline" id="M61"><mml:msub><mml:mover accent="true"><mml:mo mathvariant="bold">Σ</mml:mo> <mml:mo>^</mml:mo></mml:mover> <mml:mi mathvariant="script">G</mml:mi></mml:msub></mml:math></alternatives></inline-formula>. As shown in Section S1.3 in <xref ref-type="supplementary-material" rid="pcbi.1006745.s001">S1 Appendix</xref>, the minimum number of replicates required to ensure positive definiteness is now <inline-formula id="pcbi.1006745.e062"><alternatives><graphic id="pcbi.1006745.e062g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e062" xlink:type="simple"/><mml:math display="inline" id="M62"><mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mtext>min</mml:mtext></mml:msub> <mml:mo>=</mml:mo> <mml:mi mathvariant="script">M</mml:mi> <mml:mo>+</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, which, as desired, is independent of <italic>G</italic>. Thus, if <inline-formula id="pcbi.1006745.e063"><alternatives><graphic id="pcbi.1006745.e063g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e063" xlink:type="simple"/><mml:math display="inline" id="M63"><mml:mrow><mml:mi mathvariant="script">M</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> for example, only <italic>n</italic> ≥ 3 pedigrees are required to ensure <inline-formula id="pcbi.1006745.e064"><alternatives><graphic id="pcbi.1006745.e064g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e064" xlink:type="simple"/><mml:math display="inline" id="M64"><mml:mover accent="true"><mml:mo mathvariant="bold">Σ</mml:mo> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is positive definite, regardless of the number of generations analyzed.</p>
</sec>
<sec id="sec019">
<title>Missing data</title>
<p>The covariance estimates described above assume complete data. In reality, some measurements are missing, often because data collection is imperfect but also because cells die and have no descendants (although in the datasets analyzed in the paper, cell death is essentially negligible). A simple solution is to apply the Expectation-Maximization (EM) algorithm [<xref ref-type="bibr" rid="pcbi.1006745.ref073">73</xref>], assuming a multivariate Gaussian to impute the missing data. This is described in Section S1.4 in <xref ref-type="supplementary-material" rid="pcbi.1006745.s001">S1 Appendix</xref>.</p>
<p>We remark that, until now, the covariance estimation procedure we have described is distribution-free, providing a non-parametric estimate of second-order variation. It is only to account for missing data that we invoke a distributional assumption. In Section S1.5 in <xref ref-type="supplementary-material" rid="pcbi.1006745.s001">S1 Appendix</xref> we show that the maximum likelihood estimate (MLE) for a multivariate Gaussian with the symmetry and Markovian constraints discussed above is in fact the covariance estimate we have already found.</p>
</sec>
<sec id="sec020">
<title>Summary of algorithm</title>
<p>Here we summarize the complete algorithm for estimating the mean and covariance of a complete tree, showing how the symmetry and sparsity constraints are incorporated into the EM algorithm to account for missing data:</p>
<boxed-text id="pcbi.1006745.box001" position="float">
<list list-type="order">
<list-item>
<p>Initialize <inline-formula id="pcbi.1006745.e065"><alternatives><graphic id="pcbi.1006745.e065g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e065" xlink:type="simple"/><mml:math display="inline" id="M65"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">μ</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006745.e066"><alternatives><graphic id="pcbi.1006745.e066g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e066" xlink:type="simple"/><mml:math display="inline" id="M66"><mml:mover accent="true"><mml:mo mathvariant="bold">Σ</mml:mo> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> with a starting guess.</p>
</list-item>
<list-item>
<p><italic>Expectation step</italic>. Estimate the expected value of the sufficient statistics for each replicate by accounting for missing data using the current estimates for <inline-formula id="pcbi.1006745.e067"><alternatives><graphic id="pcbi.1006745.e067g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e067" xlink:type="simple"/><mml:math display="inline" id="M67"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">μ</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006745.e068"><alternatives><graphic id="pcbi.1006745.e068g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e068" xlink:type="simple"/><mml:math display="inline" id="M68"><mml:mover accent="true"><mml:mo mathvariant="bold">Σ</mml:mo> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> in Eqs S13, S14. Calculate the resulting (unstructured) sample mean, <inline-formula id="pcbi.1006745.e069"><alternatives><graphic id="pcbi.1006745.e069g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e069" xlink:type="simple"/><mml:math display="inline" id="M69"><mml:mover><mml:mi mathvariant="bold-italic">y</mml:mi> <mml:mo>¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, and covariance, <bold><italic>S</italic></bold>, using Eq S15.</p>
</list-item>
<list-item>
<p><italic>Maximization step</italic>.</p>
<list list-type="alpha-lower">
<list-item>
<p>Impose the symmetry constraint by pooling over shared elements: <inline-formula id="pcbi.1006745.e070"><alternatives><graphic id="pcbi.1006745.e070g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e070" xlink:type="simple"/><mml:math display="inline" id="M70"><mml:mrow><mml:msub><mml:mover><mml:mi mathvariant="bold-italic">y</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi mathvariant="script">G</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi mathvariant="double-struck">P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mover><mml:mi mathvariant="bold-italic">y</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006745.e071"><alternatives><graphic id="pcbi.1006745.e071g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e071" xlink:type="simple"/><mml:math display="inline" id="M71"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">S</mml:mi> <mml:mi mathvariant="script">G</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi mathvariant="double-struck">P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">S</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> (Eqs <xref ref-type="disp-formula" rid="pcbi.1006745.e026">9</xref> and <xref ref-type="disp-formula" rid="pcbi.1006745.e027">10</xref>). The estimated mean is then <inline-formula id="pcbi.1006745.e072"><alternatives><graphic id="pcbi.1006745.e072g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e072" xlink:type="simple"/><mml:math display="inline" id="M72"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">μ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:msub><mml:mover><mml:mi mathvariant="bold-italic">y</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi mathvariant="script">G</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>.</p>
</list-item>
<list-item>
<p>Transform to the sample spectral covariance, <inline-formula id="pcbi.1006745.e073"><alternatives><graphic id="pcbi.1006745.e073g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e073" xlink:type="simple"/><mml:math display="inline" id="M73"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">S</mml:mi> <mml:mo>Ω</mml:mo></mml:msub> <mml:mo>=</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">T</mml:mi></mml:mrow> <mml:mo>†</mml:mo></mml:msup> <mml:msub><mml:mi mathvariant="bold-italic">S</mml:mi> <mml:mi mathvariant="script">G</mml:mi></mml:msub> <mml:mi mathvariant="bold-italic">T</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>.</p>
</list-item>
<list-item>
<p>From each unique irreducible block, <inline-formula id="pcbi.1006745.e074"><alternatives><graphic id="pcbi.1006745.e074g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e074" xlink:type="simple"/><mml:math display="inline" id="M74"><mml:msubsup><mml:mi mathvariant="bold-italic">S</mml:mi> <mml:mo>Ω</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ℓ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>, estimate <inline-formula id="pcbi.1006745.e075"><alternatives><graphic id="pcbi.1006745.e075g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e075" xlink:type="simple"/><mml:math display="inline" id="M75"><mml:msubsup><mml:mover accent="true"><mml:mo mathvariant="bold">Σ</mml:mo> <mml:mo>^</mml:mo></mml:mover> <mml:mo>Ω</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ℓ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> using S9 and S10, assuming a Markov chain of order <inline-formula id="pcbi.1006745.e076"><alternatives><graphic id="pcbi.1006745.e076g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e076" xlink:type="simple"/><mml:math display="inline" id="M76"><mml:mi mathvariant="script">M</mml:mi></mml:math></alternatives></inline-formula>.</p>
</list-item>
<list-item>
<p>Construct the spectral covariance estimate <inline-formula id="pcbi.1006745.e077"><alternatives><graphic id="pcbi.1006745.e077g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e077" xlink:type="simple"/><mml:math display="inline" id="M77"><mml:msub><mml:mover accent="true"><mml:mo mathvariant="bold">Σ</mml:mo> <mml:mo>^</mml:mo></mml:mover> <mml:mo>Ω</mml:mo></mml:msub></mml:math></alternatives></inline-formula> from a direct sum of irreducible blocks <inline-formula id="pcbi.1006745.e078"><alternatives><graphic id="pcbi.1006745.e078g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e078" xlink:type="simple"/><mml:math display="inline" id="M78"><mml:msubsup><mml:mover accent="true"><mml:mo mathvariant="bold">Σ</mml:mo> <mml:mo>^</mml:mo></mml:mover> <mml:mo>Ω</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ℓ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> (Eq S11).</p>
</list-item>
<list-item>
<p>Inverse transform to the structured covariance estimate, <inline-formula id="pcbi.1006745.e079"><alternatives><graphic id="pcbi.1006745.e079g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e079" xlink:type="simple"/><mml:math display="inline" id="M79"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mo mathvariant="bold">Σ</mml:mo> <mml:mo>^</mml:mo></mml:mover> <mml:mi mathvariant="script">G</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi mathvariant="bold-italic">T</mml:mi> <mml:msub><mml:mover accent="true"><mml:mo mathvariant="bold">Σ</mml:mo> <mml:mo>^</mml:mo></mml:mover> <mml:mo>Ω</mml:mo></mml:msub> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">T</mml:mi></mml:mrow> <mml:mo>†</mml:mo></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>. This is the new covariance estimate, <inline-formula id="pcbi.1006745.e080"><alternatives><graphic id="pcbi.1006745.e080g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e080" xlink:type="simple"/><mml:math display="inline" id="M80"><mml:mrow><mml:mover accent="true"><mml:mo mathvariant="bold">Σ</mml:mo> <mml:mo>^</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:msub><mml:mover accent="true"><mml:mo mathvariant="bold">Σ</mml:mo> <mml:mo>^</mml:mo></mml:mover> <mml:mi mathvariant="script">G</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>.</p>
</list-item>
</list>
</list-item>
<list-item>
<p>Return to Step 2 until convergence.</p>
</list-item>
</list>
</boxed-text>
</sec>
</sec>
</sec>
<sec id="sec021" sec-type="results">
<title>Results</title>
<p>Our method for estimating <inline-formula id="pcbi.1006745.e081"><alternatives><graphic id="pcbi.1006745.e081g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e081" xlink:type="simple"/><mml:math display="inline" id="M81"><mml:mover accent="true"><mml:mo mathvariant="bold">Σ</mml:mo> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> described above can in principle be applied to lineages with any number of generations and needs only a few replicates (pedigrees) to ensure positive definiteness. We now turn to the problem of interpreting <inline-formula id="pcbi.1006745.e082"><alternatives><graphic id="pcbi.1006745.e082g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e082" xlink:type="simple"/><mml:math display="inline" id="M82"><mml:mover accent="true"><mml:mo mathvariant="bold">Σ</mml:mo> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> and using it to answer questions about a lineage.</p>
<sec id="sec022">
<title>Lineage variability maps</title>
<p>We can visualize <inline-formula id="pcbi.1006745.e083"><alternatives><graphic id="pcbi.1006745.e083g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e083" xlink:type="simple"/><mml:math display="inline" id="M83"><mml:msub><mml:mover accent="true"><mml:mo mathvariant="bold">Σ</mml:mo> <mml:mo>^</mml:mo></mml:mover> <mml:mi mathvariant="script">G</mml:mi></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006745.e084"><alternatives><graphic id="pcbi.1006745.e084g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e084" xlink:type="simple"/><mml:math display="inline" id="M84"><mml:msub><mml:mover accent="true"><mml:mo mathvariant="bold">Σ</mml:mo> <mml:mo>^</mml:mo></mml:mover> <mml:mo>Ω</mml:mo></mml:msub></mml:math></alternatives></inline-formula> using graphical models to produce different ‘maps’ of the variation in the lineage. We call these lineage variability maps. To depict <inline-formula id="pcbi.1006745.e085"><alternatives><graphic id="pcbi.1006745.e085g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e085" xlink:type="simple"/><mml:math display="inline" id="M85"><mml:msub><mml:mover accent="true"><mml:mo mathvariant="bold">Σ</mml:mo> <mml:mo>^</mml:mo></mml:mover> <mml:mi mathvariant="script">G</mml:mi></mml:msub></mml:math></alternatives></inline-formula> we use undirected graphs, since lineal positions within a generation have no ordering. We call the result a lineage correlation map. To depict <inline-formula id="pcbi.1006745.e086"><alternatives><graphic id="pcbi.1006745.e086g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e086" xlink:type="simple"/><mml:math display="inline" id="M86"><mml:msub><mml:mover accent="true"><mml:mo mathvariant="bold">Σ</mml:mo> <mml:mo>^</mml:mo></mml:mover> <mml:mo>Ω</mml:mo></mml:msub></mml:math></alternatives></inline-formula> we can use directed graphs, since the natural variables in an irreducible subspace are ordered in a sequence. <italic>Thus the spectral transformation enables the undirected graph to be converted into a directed one</italic>. This graph, which we call a dynamic lineage map, compactly represents the dynamics of the bifurcated expression pattern in each subtree.</p>
<sec id="sec023">
<title>Lineage correlation map</title>
<p>To visualize the network of statistical associations between different lineal positions we use undirected graphs [<xref ref-type="bibr" rid="pcbi.1006745.ref074">74</xref>, <xref ref-type="bibr" rid="pcbi.1006745.ref075">75</xref>] defined either by marginal or by conditional associations. For the network of marginal associations the strength of an edge between a pair of variables is defined by the Pearson correlation coefficient, <inline-formula id="pcbi.1006745.e087"><alternatives><graphic id="pcbi.1006745.e087g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e087" xlink:type="simple"/><mml:math display="inline" id="M87"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub> <mml:mo>/</mml:mo> <mml:msqrt><mml:mrow><mml:msub><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>σ</mml:mi> <mml:mrow><mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:msqrt></mml:mrow></mml:math></alternatives></inline-formula> where <italic>σ</italic><sub><italic>jj</italic>′</sub> is an element of <inline-formula id="pcbi.1006745.e088"><alternatives><graphic id="pcbi.1006745.e088g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e088" xlink:type="simple"/><mml:math display="inline" id="M88"><mml:mover accent="true"><mml:mo mathvariant="bold">Σ</mml:mo> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>. For the network of conditional associations the strength of an edge is determined by the partial correlation <inline-formula id="pcbi.1006745.e089"><alternatives><graphic id="pcbi.1006745.e089g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e089" xlink:type="simple"/><mml:math display="inline" id="M89"><mml:mrow><mml:msub><mml:mi>ϱ</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mrow><mml:mo>|</mml:mo> <mml:mi>V</mml:mi> <mml:mo>\</mml:mo></mml:mrow> <mml:mrow><mml:mo>{</mml:mo> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:msub><mml:mi>κ</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub> <mml:mo>/</mml:mo> <mml:msqrt><mml:mrow><mml:msub><mml:mi>κ</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>κ</mml:mi> <mml:mrow><mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:msqrt></mml:mrow></mml:math></alternatives></inline-formula> where <italic>κ</italic><sub><italic>jj</italic>′</sub> is an element of <inline-formula id="pcbi.1006745.e090"><alternatives><graphic id="pcbi.1006745.e090g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e090" xlink:type="simple"/><mml:math display="inline" id="M90"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">K</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, and <italic>V</italic>∖{<italic>j</italic>, <italic>j</italic>′} refers to the set of variables excluding <italic>j</italic> and <italic>j</italic>′.</p>
<p>Both types of undirected graphs are shown in <xref ref-type="fig" rid="pcbi.1006745.g009">Fig 9</xref> for the 3 lineage types. The network of conditional associations identifies direct interactions between variables, conditioned on all other variables, and, as expected, generally provides a sparser representation than does the network of marginal associations.</p>
<fig id="pcbi.1006745.g009" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006745.g009</object-id>
<label>Fig 9</label>
<caption>
<title>Lineage correlation maps.</title>
<p>These are undirected graphs in the original variables (shown as binary numbers). Each generation is arranged in an arc centered on the root node. The color of edges in each graph corresponds to the correlation (top row) or partial correlation (bottom row) between pairs of lineal positions. To avoid clutter, only the first 4 generations are shown. Note how the graph (f) of partial correlations for the simulated branching process, where daughters are conditionally uncorrelated, is a binary tree. This is not the case for the real lineages.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006745.g009" xlink:type="simple"/>
</fig>
<p>Note how a binary tree is revealed in the graph of partial correlations for the branching process (<xref ref-type="fig" rid="pcbi.1006745.g009">Fig 9f</xref>). This is expected since our branching process defined daughters to be conditionally uncorrelated. In the network of partial correlations this assumption reveals itself as the lack of an edge between sisters. In contrast, in the partial correlation graphs for T-cell (<xref ref-type="fig" rid="pcbi.1006745.g009">Fig 9d</xref>) and worm (<xref ref-type="fig" rid="pcbi.1006745.g009">Fig 9e</xref>) lineages, sisters are often joined by edges. This arises when the correlation between sisters is greater or less than the squared correlation between mother and daughter, a long-documented observation in cell lineages (see e.g. [<xref ref-type="bibr" rid="pcbi.1006745.ref028">28</xref>, <xref ref-type="bibr" rid="pcbi.1006745.ref029">29</xref>]). This is the simplest demonstration of the fact that phenotypic variation in real lineages cannot be modeled as a branching process.</p>
<p>The graphs in <xref ref-type="fig" rid="pcbi.1006745.g009">Fig 9</xref> allow us to examine how the network of <italic>phenotypic</italic> associations compares with the network of <italic>lineal</italic> relationships; though the latter is a binary tree, the former may not be. This emphasizes that, although we must assume that phenotypic variation in an unordered tree has the <italic>symmetry</italic> of a binary tree, we do not assume it has the <italic>sparsity</italic> of a binary tree.</p>
<p>A problem with representing each lineal position as a node is that the graph appears cluttered since there are many edges and nodes with similar strengths. This problem gets exponentially worse with increasing generations. Such redundancies disappear when examining the tree over its natural variables.</p>
</sec>
<sec id="sec024">
<title>Dynamic lineage map</title>
<p>The spectral transformation dramatically simplifies the lineage variability map, decomposing the (potentially) complete graph over all lineal positions shown in the previous section into a set of <italic>G</italic> independent graphs, each of which is a time series. Since the natural variables in an irreducible subspace have a clear ordering (by generation), an irreducible block can be represented by a directed graph [<xref ref-type="bibr" rid="pcbi.1006745.ref076">76</xref>–<xref ref-type="bibr" rid="pcbi.1006745.ref078">78</xref>], with each of its variables conditioned on the past only (rather than on both the past and the future).</p>
<p>To construct such a directed graph, consider the vector of natural variables, <bold><italic>z</italic></bold><sub><italic>ℓ</italic></sub>, belonging to each irreducible subspace, <italic>ℓ</italic>. The irreducible block is then given by
<disp-formula id="pcbi.1006745.e091"><alternatives><graphic id="pcbi.1006745.e091g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e091" xlink:type="simple"/><mml:math display="block" id="M91"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mrow><mml:mo mathvariant="bold">Σ</mml:mo></mml:mrow> <mml:mo>Ω</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ℓ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:mi mathvariant="double-struck">E</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>z</mml:mi> <mml:mi>ℓ</mml:mi></mml:msub> <mml:msubsup><mml:mrow><mml:mi>z</mml:mi></mml:mrow> <mml:mi>ℓ</mml:mi> <mml:mo>′</mml:mo></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(22)</label></disp-formula></p>
<p>Since the variables in <bold><italic>z</italic></bold><sub><italic>ℓ</italic></sub> comprise a time series, they can be modeled using a linear structural equation:
<disp-formula id="pcbi.1006745.e092"><alternatives><graphic id="pcbi.1006745.e092g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e092" xlink:type="simple"/><mml:math display="block" id="M92"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>z</mml:mi> <mml:mrow><mml:mi>ℓ</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mtd> <mml:mtd><mml:mrow><mml:mo>=</mml:mo> <mml:msub><mml:mi>ε</mml:mi> <mml:mrow><mml:mi>ℓ</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>=</mml:mo> <mml:mi>ℓ</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:munderover> <mml:msub><mml:mi>β</mml:mi> <mml:mrow><mml:mi>ℓ</mml:mi> <mml:mi>j</mml:mi> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub> <mml:msub><mml:mi>z</mml:mi> <mml:mrow><mml:mi>ℓ</mml:mi> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:mspace width="1.em"/><mml:mtext>for</mml:mtext> <mml:mspace width="4.pt"/><mml:mi>ℓ</mml:mi> <mml:mo>&lt;</mml:mo> <mml:mi>j</mml:mi> <mml:mo>≤</mml:mo> <mml:mi>G</mml:mi> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(23)</label></disp-formula>
where, for a given irreducible subspace <italic>ℓ</italic>, <italic>z</italic><sub><italic>ℓ</italic> <italic>j</italic></sub> is the natural variable for generation <italic>j</italic>, <italic>β</italic><sub><italic>ℓ</italic> <italic>jj</italic>′</sub> is the regression coefficient of generation <italic>j</italic> on <italic>j</italic>′, and <italic>ε</italic><sub><italic>ℓ</italic> <italic>j</italic></sub> is an independent random variable describing variation originating at generation <italic>j</italic> that has a mean of zero and expected variance <inline-formula id="pcbi.1006745.e093"><alternatives><graphic id="pcbi.1006745.e093g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e093" xlink:type="simple"/><mml:math display="inline" id="M93"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi> <mml:mo>(</mml:mo> <mml:msubsup><mml:mi>ε</mml:mi> <mml:mrow><mml:mi>ℓ</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. To determine these model parameters, we start by rewriting <xref ref-type="disp-formula" rid="pcbi.1006745.e092">Eq 23</xref> in terms of a lower-triangular matrix <bold><italic>B</italic></bold><sub><italic>ℓ</italic></sub> = (<italic>b</italic><sub><italic>ℓ</italic> <italic>jj</italic>′</sub>):
<disp-formula id="pcbi.1006745.e094"><alternatives><graphic id="pcbi.1006745.e094g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e094" xlink:type="simple"/><mml:math display="block" id="M94"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">B</mml:mi> <mml:mi>ℓ</mml:mi></mml:msub> <mml:msub><mml:mi mathvariant="bold-italic">z</mml:mi> <mml:mi>ℓ</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">ε</mml:mi> <mml:mi>ℓ</mml:mi></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(24)</label></disp-formula> <disp-formula id="pcbi.1006745.e095"><alternatives><graphic id="pcbi.1006745.e095g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e095" xlink:type="simple"/><mml:math display="block" id="M95"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>b</mml:mi> <mml:mrow><mml:mi>ℓ</mml:mi> <mml:mi>j</mml:mi> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mtd> <mml:mtd><mml:mrow><mml:mo>=</mml:mo> <mml:mo>{</mml:mo> <mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mn>1</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext> <mml:mspace width="4.pt"/><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext> <mml:mspace width="4.pt"/><mml:mi>j</mml:mi> <mml:mo>-</mml:mo> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>&lt;</mml:mo> <mml:mn>0</mml:mn> <mml:mspace width="4.pt"/><mml:mtext>or</mml:mtext> <mml:mspace width="4.pt"/><mml:mi>j</mml:mi> <mml:mo>-</mml:mo> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>&gt;</mml:mo> <mml:mi mathvariant="script">M</mml:mi></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mo>-</mml:mo> <mml:msub><mml:mi>β</mml:mi> <mml:mrow><mml:mi>ℓ</mml:mi> <mml:mi>j</mml:mi> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mtext>otherwise</mml:mtext> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable> <mml:mo/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(25)</label></disp-formula></p>
<p>Now, the modified Cholesky decomposition of <inline-formula id="pcbi.1006745.e096"><alternatives><graphic id="pcbi.1006745.e096g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e096" xlink:type="simple"/><mml:math display="inline" id="M96"><mml:msubsup><mml:mrow><mml:mo mathvariant="bold">Σ</mml:mo></mml:mrow> <mml:mo>Ω</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ℓ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> is
<disp-formula id="pcbi.1006745.e097"><alternatives><graphic id="pcbi.1006745.e097g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e097" xlink:type="simple"/><mml:math display="block" id="M97"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mrow><mml:mo mathvariant="bold">Σ</mml:mo></mml:mrow> <mml:mo>Ω</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ℓ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">L</mml:mi> <mml:mi>ℓ</mml:mi></mml:msub> <mml:msub><mml:mo mathvariant="bold">Φ</mml:mo> <mml:mi>ℓ</mml:mi></mml:msub> <mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">L</mml:mi></mml:mrow> <mml:mi>ℓ</mml:mi> <mml:mo>′</mml:mo></mml:msubsup> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(26)</label></disp-formula>
where <bold>Φ</bold><sub><italic>ℓ</italic></sub> is diagonal and <bold><italic>L</italic></bold><sub><italic>ℓ</italic></sub> is lower triangular. Combining this with <xref ref-type="disp-formula" rid="pcbi.1006745.e091">Eq 22</xref> and then <xref ref-type="disp-formula" rid="pcbi.1006745.e094">Eq 24</xref>, we see that
<disp-formula id="pcbi.1006745.e098"><alternatives><graphic id="pcbi.1006745.e098g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e098" xlink:type="simple"/><mml:math display="block" id="M98"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">L</mml:mi> <mml:mi>ℓ</mml:mi></mml:msub> <mml:msub><mml:mo mathvariant="bold">Φ</mml:mo> <mml:mi>ℓ</mml:mi></mml:msub> <mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">L</mml:mi></mml:mrow> <mml:mi>ℓ</mml:mi> <mml:mo>′</mml:mo></mml:msubsup> <mml:mo>=</mml:mo> <mml:mi mathvariant="double-struck">E</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">z</mml:mi> <mml:mi>ℓ</mml:mi></mml:msub> <mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow> <mml:mi>ℓ</mml:mi> <mml:mo>′</mml:mo></mml:msubsup> <mml:mo>)</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(27)</label></disp-formula> <disp-formula id="pcbi.1006745.e099"><alternatives><graphic id="pcbi.1006745.e099g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e099" xlink:type="simple"/><mml:math display="block" id="M99"><mml:mrow><mml:mo>=</mml:mo> <mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow> <mml:mi>ℓ</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mi mathvariant="double-struck">E</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">ε</mml:mi> <mml:mi>ℓ</mml:mi></mml:msub> <mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">ε</mml:mi></mml:mrow> <mml:mi>ℓ</mml:mi> <mml:mo>′</mml:mo></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi mathvariant="bold-italic">B</mml:mi> <mml:mi>ℓ</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>′</mml:mo></mml:msup> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(28)</label></disp-formula></p>
<p>Thus the parameters in the structural equation model are found directly from the modified Cholesky decomposition:
<disp-formula id="pcbi.1006745.e100"><alternatives><graphic id="pcbi.1006745.e100g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e100" xlink:type="simple"/><mml:math display="block" id="M100"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi mathvariant="bold-italic">B</mml:mi> <mml:mi>ℓ</mml:mi></mml:msub></mml:mtd> <mml:mtd><mml:mrow><mml:mo>=</mml:mo> <mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">L</mml:mi></mml:mrow> <mml:mi>ℓ</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:mspace width="1.em"/><mml:mi mathvariant="double-struck">E</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">ε</mml:mi> <mml:mi>ℓ</mml:mi></mml:msub> <mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">ε</mml:mi></mml:mrow> <mml:mi>ℓ</mml:mi> <mml:mo>′</mml:mo></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mo mathvariant="bold">Φ</mml:mo> <mml:mi>ℓ</mml:mi></mml:msub> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(29)</label></disp-formula></p>
<p>The directed graph can then be defined with edge weights given by <italic>β</italic><sub><italic>ℓ</italic> <italic>jj</italic>′</sub> and node sizes given by <inline-formula id="pcbi.1006745.e101"><alternatives><graphic id="pcbi.1006745.e101g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e101" xlink:type="simple"/><mml:math display="inline" id="M101"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi> <mml:mo>(</mml:mo> <mml:msubsup><mml:mi>ε</mml:mi> <mml:mrow><mml:mi>ℓ</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. The edge weights represent transmission of variation while the node sizes represent innovations. If |<italic>β</italic><sub><italic>jj</italic>′</sub>|&lt;1 then transmission is regressive, with descendants gradually losing memory of previous generations. However, if |<italic>β</italic><sub><italic>jj</italic>′</sub>|&gt;1 then variation from source (<italic>ℓ</italic>) observed at generation <italic>j</italic>′ is <italic>amplified</italic> during transmission to generation <italic>j</italic>. Thus large variation can either arise directly from a large innovation or it can be the result of strong amplification of small variation (or both).</p>
<p>These directed graphs compactly summarize the dynamics of phenotypic variation along each subtree. Examples for the 3 lineages types are shown in <xref ref-type="fig" rid="pcbi.1006745.g010">Fig 10</xref>. Each connected component, given by a row, represents how the bifurcated expression pattern associated with a subtree <italic>ℓ</italic> propagates down successive generations.</p>
<fig id="pcbi.1006745.g010" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006745.g010</object-id>
<label>Fig 10</label>
<caption>
<title>Dynamic lineage maps.</title>
<p>These directed graphs in the natural variables show the dynamics of the bifurcated expression pattern in each subtree <italic>ℓ</italic>. The color (and thickness) of an edge between node <italic>j</italic> and <italic>j</italic>′ corresponds to the transmission strength, <italic>β</italic><sub><italic>ℓ</italic> <italic>jj</italic>′</sub>. The size of the node corresponds to the innovation strength, <inline-formula id="pcbi.1006745.e102"><alternatives><graphic id="pcbi.1006745.e102g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e102" xlink:type="simple"/><mml:math display="inline" id="M102"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi> <mml:mo>(</mml:mo> <mml:msubsup><mml:mi>ε</mml:mi> <mml:mrow><mml:mi>ℓ</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006745.g010" xlink:type="simple"/>
</fig>
<p>As expected, the worm graph has the most distinct structure (<xref ref-type="fig" rid="pcbi.1006745.g010">Fig 10b</xref>). Transmission and innovation is small for the first few generations of each subtree, before “turning on” after generation 6. This means that the bifurcated expression of a subtree is silent for many generations before appearing simultaneously in multiple descendants at a later generation. Note how transmission and innovation for <italic>ℓ</italic> = 0 are weak, indicating little inter-pedigree variation, as expected for a totipotent cell. Strong transmission is observed in particular subtrees at certain generations. For example, transmission is highest for <italic>ℓ</italic> = 2 between generations 6 and 7, and for <italic>ℓ</italic> = 5 between generations 7 and 8. We will discuss these features later when we assess the fate restriction associated with each subtree.</p>
<p>Although, for the worm, these characteristics could have been inferred just by visualizing the pedigrees directly, the point is that we now have a statistical method to extract such features when the lineage is variable. For example, the primary feature of the graph for T cells, which was not obvious from just looking at the lineages, is that subtree <italic>ℓ</italic> = 0 has the largest innovations and consistently strong transmission between generations (the exception is from generation 1, whose phenotype is not transmitted). This indicates that much of the variation is between pedigrees, rather than within the pedigree as it was for the worm. We will describe this in more detail in the next section.</p>
<p>Finally, we note that the graph for the branching process is essentially featureless across all generations and in all subtrees, as would be expected for a stationary process.</p>
</sec>
</sec>
<sec id="sec025">
<title>Fate profiles</title>
<p>Lineage variability maps describe the pattern of phenotypic associations throughout the lineage. However, as with lineage maps, our interest is often in using them to infer where fate is specified. In the introduction, we described how this involves identifying the most recent common ancestor of cells with shared fate. For a clonal pattern, where a cell fate is exclusive to a single subtree, we would infer that fate was specified at (or near) a single lineal position—the root of that subtree. For a non-clonal pattern, where cell fate is expressed in multiple subtrees, we would infer that fate was specified at multiple lineal positions. In <italic>C. elegans</italic> these inferences can be made visually [<xref ref-type="bibr" rid="pcbi.1006745.ref005">5</xref>]. Here we show how, by knowing the lineage variability map <bold>Σ</bold>, we can make these inferences statistically, overcoming the problem of how to identify subtrees with shared phenotypes when lineages are variable.</p>
<p>Before we begin, we must define what we mean by cell fate. In this study we define cell fate to be the measured phenotype of a cell at the latest generation studied, <italic>G</italic>. This practical definition allows us to analyze cell fate whether or not the phenotype in the last generation is actually a terminal fate. Also, by defining cell fate as the phenotype itself rather than as a cell type (determined by that phenotype), we can use the phenotypic measurements as is, without having to cluster or threshold them. Such discretization procedures can be difficult to define when phenotypes exist on a continuum of differentiation, as is often the case [<xref ref-type="bibr" rid="pcbi.1006745.ref079">79</xref>].</p>
<p>Having defined fate, we turn now to explaining its variability in terms of aspects of the lineage. We first partition the variability among the subtrees, or sources of variation. This quantifies how much of a cell’s fate is restricted by, or specified by, each subtree. We then examine the correlation of a cell’s fate with the phenotypes of its ancestors. This identifies the earlier generations over which a phenotypic fate has been stably expressed. Together these two measures, of fate restriction and fate expression, make up what we call fate profiles.</p>
<sec id="sec026">
<title>Fate restriction by subtree</title>
<p>To determine how much cell fate is restricted by (i.e. specified by) each subtree, we partition the fate variability among the different sources of variation, each of which is located at the root of a <italic>bifurcated</italic> subtree. This is just the traditional problem of variance components analysis in nested groups (see <xref ref-type="fig" rid="pcbi.1006745.g005">Fig 5b</xref>). Since we have already calculated the spectral covariance matrix, we need only locate the appropriate components of variance along its diagonal (see <xref ref-type="disp-formula" rid="pcbi.1006745.e039">Eq 18</xref>).</p>
<p>Consider the variance of a cell in generation <italic>G</italic>, given by <italic>σ</italic><sub><italic>GGG</italic></sub> (see <xref ref-type="disp-formula" rid="pcbi.1006745.e127">Eq 5</xref>). This can be written as the the sum of independent contributions from each source (<italic>ℓ</italic>, <italic>τ</italic>). These are known as the (normalized) components of variance in a classical ANOVA [<xref ref-type="bibr" rid="pcbi.1006745.ref071">71</xref>]. A convenient way to show this decomposition in our framework is to perform the inverse spectral transform of <bold>Σ</bold><sub>Ω</sub> (for an example, see Section S1.2.9 in <xref ref-type="supplementary-material" rid="pcbi.1006745.s001">S1 Appendix</xref>). The result is
<disp-formula id="pcbi.1006745.e103"><alternatives><graphic id="pcbi.1006745.e103g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e103" xlink:type="simple"/><mml:math display="block" id="M103"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>G</mml:mi> <mml:mi>G</mml:mi> <mml:mi>G</mml:mi></mml:mrow></mml:msub></mml:mtd> <mml:mtd><mml:mrow><mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:msub><mml:mi>N</mml:mi> <mml:mtext>src</mml:mtext></mml:msub></mml:mfrac> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>ℓ</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow> <mml:mrow><mml:mi>G</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:munderover> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>τ</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow> <mml:mrow><mml:msub><mml:mi>d</mml:mi> <mml:mi>ℓ</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:munderover> <mml:msubsup><mml:mi>ξ</mml:mi> <mml:mrow><mml:mi>G</mml:mi> <mml:mi>G</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ℓ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:mspace width="1.em"/><mml:mspace width="1.em"/><mml:msub><mml:mi>d</mml:mi> <mml:mi>ℓ</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mo>{</mml:mo> <mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mn>1</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext> <mml:mspace width="4.pt"/><mml:mi>ℓ</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mn>2</mml:mn> <mml:mrow><mml:mi>ℓ</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext> <mml:mspace width="4.pt"/><mml:mi>ℓ</mml:mi> <mml:mo>≥</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable> <mml:mo/></mml:mrow></mml:mtd></mml:mtr> <mml:mtr/></mml:mtable></mml:math></alternatives> <label>(30)</label></disp-formula> <disp-formula id="pcbi.1006745.e104"><alternatives><graphic id="pcbi.1006745.e104g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e104" xlink:type="simple"/><mml:math display="block" id="M104"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd><mml:mrow><mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:msub><mml:mi>N</mml:mi> <mml:mtext>src</mml:mtext></mml:msub></mml:mfrac> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>ℓ</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow> <mml:mrow><mml:mi>G</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:munderover> <mml:msubsup><mml:mi>ξ</mml:mi> <mml:mrow><mml:mi>G</mml:mi> <mml:mi>G</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ℓ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:msub><mml:mi>d</mml:mi> <mml:mi>ℓ</mml:mi></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(31)</label></disp-formula>
where <italic>d</italic><sub><italic>ℓ</italic></sub> is the number of transverse sources of variation at a given <italic>ℓ</italic>, and <inline-formula id="pcbi.1006745.e105"><alternatives><graphic id="pcbi.1006745.e105g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e105" xlink:type="simple"/><mml:math display="inline" id="M105"><mml:mrow><mml:msub><mml:mi>N</mml:mi> <mml:mtext>src</mml:mtext></mml:msub> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>ℓ</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow> <mml:mrow><mml:mi>G</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:msub><mml:mi>d</mml:mi> <mml:mi>ℓ</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msup><mml:mn>2</mml:mn> <mml:mi>G</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> is the total number of sources of variation in a <italic>G</italic>-generation tree. The component of variance corresponding to source <italic>ℓ</italic> is thus given by <inline-formula id="pcbi.1006745.e106"><alternatives><graphic id="pcbi.1006745.e106g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e106" xlink:type="simple"/><mml:math display="inline" id="M106"><mml:mrow><mml:msubsup><mml:mi>ξ</mml:mi> <mml:mrow><mml:mi>G</mml:mi> <mml:mi>G</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ℓ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:msub><mml:mi>d</mml:mi> <mml:mi>ℓ</mml:mi></mml:msub> <mml:mo>/</mml:mo> <mml:msub><mml:mi>N</mml:mi> <mml:mtext>src</mml:mtext></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> where <inline-formula id="pcbi.1006745.e107"><alternatives><graphic id="pcbi.1006745.e107g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e107" xlink:type="simple"/><mml:math display="inline" id="M107"><mml:msubsup><mml:mi>ξ</mml:mi> <mml:mrow><mml:mi>G</mml:mi> <mml:mi>G</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ℓ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> is found along the diagonal of <bold>Σ</bold><sub>Ω</sub>.</p>
<p>The resulting proportion of variance attributable to the <italic>ℓ</italic>-th source for a cell in generation <italic>G</italic> is given by
<disp-formula id="pcbi.1006745.e108"><alternatives><graphic id="pcbi.1006745.e108g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e108" xlink:type="simple"/><mml:math display="block" id="M108"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi>η</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ℓ</mml:mi> <mml:mo>|</mml:mo> <mml:mi>G</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msubsup><mml:mi>ξ</mml:mi> <mml:mrow><mml:mi>G</mml:mi> <mml:mi>G</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ℓ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:msub><mml:mi>d</mml:mi> <mml:mi>ℓ</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:msup><mml:mi>ℓ</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow> <mml:mrow><mml:mi>G</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:msubsup><mml:mi>ξ</mml:mi> <mml:mrow><mml:mi>G</mml:mi> <mml:mi>G</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>ℓ</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:msub><mml:mi>d</mml:mi> <mml:msup><mml:mi>ℓ</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo> <mml:mspace width="1.em"/><mml:mn>0</mml:mn> <mml:mo>≤</mml:mo> <mml:mi>ℓ</mml:mi> <mml:mo>&lt;</mml:mo> <mml:mi>G</mml:mi> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(32)</label></disp-formula></p>
<p>This measures the relative importance of each source of variation <italic>ℓ</italic> in explaining cell fate. Equivalently, it measures how much cell fate is restricted by subtree <italic>ℓ</italic>.</p>
<p>It will also be useful to calculate the cumulative proportion of total variance attributable to subtrees from 0 to <italic>ℓ</italic>, inclusive,
<disp-formula id="pcbi.1006745.e109"><alternatives><graphic id="pcbi.1006745.e109g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e109" xlink:type="simple"/><mml:math display="block" id="M109"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>η</mml:mi> <mml:mtext>cml</mml:mtext> <mml:mn>2</mml:mn></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ℓ</mml:mi> <mml:mo>|</mml:mo> <mml:mi>G</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:msup><mml:mi>ℓ</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow> <mml:mi>ℓ</mml:mi></mml:msubsup> <mml:msubsup><mml:mi>ξ</mml:mi> <mml:mrow><mml:mi>G</mml:mi> <mml:mi>G</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>ℓ</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:msub><mml:mi>d</mml:mi> <mml:msup><mml:mi>ℓ</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub></mml:mrow> <mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:msup><mml:mi>ℓ</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow> <mml:mrow><mml:mi>G</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:msubsup><mml:mi>ξ</mml:mi> <mml:mrow><mml:mi>G</mml:mi> <mml:mi>G</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>ℓ</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:msub><mml:mi>d</mml:mi> <mml:msup><mml:mi>ℓ</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo> <mml:mspace width="1.em"/><mml:mn>0</mml:mn> <mml:mo>≤</mml:mo> <mml:mi>ℓ</mml:mi> <mml:mo>&lt;</mml:mo> <mml:mi>G</mml:mi> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(33)</label></disp-formula></p>
<p>This gives a running total of the cell fate restricted by each successive subtree, starting at <italic>ℓ</italic> = 0 and is related to the intraclass correlation.</p>
<p>An obvious question is whether <italic>η</italic><sup>2</sup>(<italic>ℓ</italic>|<italic>G</italic>) would differ if we had simply performed a variance components analysis on the single generation <italic>G</italic>, ignoring measurements in the other generations. With complete data, our method would give the identical result to a variance components calculation: using a decomposable model for a Markov chain ensures that estimates of diagonal elements in <bold>Σ</bold><sub>Ω</sub> (the components of variance) are given by the corresponding diagonal elements in <bold><italic>S</italic></bold><sub>Ω</sub>. If there were incomplete data however, data from other generations would help to estimate the missing data in generation <italic>G</italic>, improving the estimate of <italic>η</italic><sup>2</sup>(<italic>ℓ</italic>|<italic>G</italic>).</p>
</sec>
<sec id="sec027">
<title>Fate expression by generation</title>
<p>Having determined how much fate is restricted by each subtree, we now determine how much cell fate is expressed in each earlier generation. We do this by correlating the phenotype of a cell in generation <italic>G</italic> with those of its direct ancestors. The degree to which earlier generations are correlated with the last is a measure of when fate becomes expressed.</p>
<p>This definition of fate expression emphasizes the stability, or persistence, of a phenotypic fate rather than the absolute value of a phenotypic measurement. We have chosen this definition since our analysis should be general enough to work on data with substantial variability, where it may be difficult to define a cell fate in terms of some threshold level of expression.</p>
<p>Given a lineal position in generation <italic>G</italic> and its direct ancestor in generation <italic>g</italic>, the proportion of explained variance is just the squared correlation coefficient, or coefficient of determination,
<disp-formula id="pcbi.1006745.e110"><alternatives><graphic id="pcbi.1006745.e110g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e110" xlink:type="simple"/><mml:math display="block" id="M110"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi>R</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>g</mml:mi> <mml:mo>|</mml:mo> <mml:mi>G</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>g</mml:mi> <mml:mi>G</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mrow><mml:msub><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>g</mml:mi> <mml:mi>g</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>G</mml:mi> <mml:mi>G</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>ρ</mml:mi> <mml:mrow><mml:mi>g</mml:mi> <mml:mi>G</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>,</mml:mo> <mml:mspace width="1.em"/><mml:mn>1</mml:mn> <mml:mo>≤</mml:mo> <mml:mi>g</mml:mi> <mml:mo>&lt;</mml:mo> <mml:mi>G</mml:mi> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(34)</label></disp-formula></p>
<p>In the subscripts we have simplified the 3-index notation from <xref ref-type="disp-formula" rid="pcbi.1006745.e127">Eq 5</xref> by ignoring the third index. This does not cause confusion since in this context we are only concerned with direct ancestors.</p>
<p>Generalizing to prediction using multiple generations of direct ancestors up to and including that in generation <italic>g</italic> gives
<disp-formula id="pcbi.1006745.e111"><alternatives><graphic id="pcbi.1006745.e111g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e111" xlink:type="simple"/><mml:math display="block" id="M111"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>R</mml:mi> <mml:mtext>cml</mml:mtext> <mml:mn>2</mml:mn></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>g</mml:mi> <mml:mo>|</mml:mo> <mml:mi>G</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mo mathvariant="bold">Σ</mml:mo> <mml:mrow><mml:mi>G</mml:mi> <mml:mi mathvariant="bold-italic">g</mml:mi></mml:mrow></mml:msub> <mml:msubsup><mml:mrow><mml:mo mathvariant="bold">Σ</mml:mo></mml:mrow> <mml:mrow><mml:mi mathvariant="bold-italic">g</mml:mi> <mml:mi mathvariant="bold-italic">g</mml:mi></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:msub><mml:mo mathvariant="bold">Σ</mml:mo> <mml:mrow><mml:mi mathvariant="bold-italic">g</mml:mi> <mml:mi>G</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:msub><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>G</mml:mi> <mml:mi>G</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(35)</label></disp-formula>
where <bold><italic>g</italic></bold> represents a vector of direct ancestors of the cell in generation <italic>G</italic> that are from generations 1 to <italic>g</italic> inclusive. Note that <xref ref-type="disp-formula" rid="pcbi.1006745.e111">Eq 35</xref> accounts for possible dependencies in the variation between ancestors. Unlike for the case of components of variance, contributions from different ancestral generations are not (in general) orthogonal.</p>
</sec>
<sec id="sec028">
<title>Comparing fate restriction and fate expression</title>
<p>Our measures of fate restriction and fate expression are complementary ways of explaining the variation of cell fate: <italic>η</italic><sup>2</sup>(<italic>ℓ</italic>|<italic>G</italic>) explains fate in terms of shared ancestry (subtrees) while <italic>R</italic><sup>2</sup>(<italic>g</italic>|<italic>G</italic>) explains fate in terms of ancestral phenotypes. We call these fate profiles. Both are plotted in <xref ref-type="fig" rid="pcbi.1006745.g011">Fig 11</xref>, with the top row giving the explained variance and the bottom row giving the cumulative explained variance.</p>
<fig id="pcbi.1006745.g011" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006745.g011</object-id>
<label>Fig 11</label>
<caption>
<title>Fate profiles for different lineages.</title>
<p>Explained variance (top row) and the cumulative explained variance (bottom row). <italic>η</italic><sup>2</sup>(<italic>ℓ</italic>|<italic>G</italic>) (blue) measures how much the fate of a cell at generation <italic>G</italic> is restricted by each subtree <italic>ℓ</italic>. <italic>R</italic><sup>2</sup>(<italic>g</italic>|<italic>G</italic>) (orange) measures how much a generation-<italic>G</italic> cell’s phenotype is correlated with its direct ancestor in generation <italic>g</italic>. Note that because the Markov process is assumed to be first order (see Section ‘Sparsity.’), <inline-formula id="pcbi.1006745.e112"><alternatives><graphic id="pcbi.1006745.e112g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e112" xlink:type="simple"/><mml:math display="inline" id="M112"><mml:mrow><mml:msup><mml:mi>R</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>R</mml:mi> <mml:mtext>cml</mml:mtext> <mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>. For the case of the simulated branching process the exact result is also shown. This illustrates the accuracy of the inference procedure.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006745.g011" xlink:type="simple"/>
</fig>
<p><italic>η</italic><sup>2</sup>(<italic>ℓ</italic>|<italic>G</italic>) (blue line, top row) shows how much variation in <italic>G</italic> is restricted by each of the subtrees <italic>ℓ</italic>. For T cells, <italic>ℓ</italic> = 0 is by far the most important “subtree” for explaining fate (at <italic>G</italic> = 5). This is consistent with a cell that has limited potency, where the choice of founder cell severely restricts the range of fates available. In this case, any founder cell has already had 80% of its cell fate restricted. For the worm, cell fate is restricted by all subtrees <italic>except</italic> <italic>ℓ</italic> = 0. Each zygote thus has 100% of its cell fate potential. This is consistent with the behavior for a totipotent cell. All subsequent subtrees contribute to cell fate, with <italic>ℓ</italic> = 2, 3, 5 being particularly important. This spread of fate specification over different subtrees might have been expected given the non-clonal expression pattern of <italic>PHA-4</italic>. While a clonal pattern is projected onto a single subtree, non-clonal patterns are projected onto multiple subtrees. For the branching process, contributions from all subtrees are comparable, as expected. Each subtree is, roughly speaking, equally important.</p>
<p><italic>R</italic><sup>2</sup>(<italic>g</italic>|<italic>G</italic>) (orange line, top row) gives the correlation of a cell in generation <italic>G</italic> with its direct ancestor in generation <italic>g</italic>. For T cells, <italic>R</italic><sup>2</sup>(<italic>g</italic>|<italic>G</italic>)≃0 for <italic>g</italic> = 1 indicating that, even though most cell fate (at least at <italic>G</italic> = 5) is set by the choice of founder cell, the founder does not actually resemble its descendants. For the worm, <italic>R</italic><sup>2</sup>(<italic>g</italic>|<italic>G</italic>)≃0 for 1 ≤ <italic>g</italic> ≤ 6. Thus none of the complicated structure in <italic>η</italic><sup>2</sup> for 0 ≤ <italic>ℓ</italic> ≤ 6 is reflected in <italic>R</italic><sup>2</sup>.</p>
<p>This difference between fate restriction and fate expression is highlighted by the cumulative explained variance shown in the bottom row of <xref ref-type="fig" rid="pcbi.1006745.g011">Fig 11</xref>. For the worm, <inline-formula id="pcbi.1006745.e113"><alternatives><graphic id="pcbi.1006745.e113g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e113" xlink:type="simple"/><mml:math display="inline" id="M113"><mml:msubsup><mml:mi>η</mml:mi> <mml:mtext>cml</mml:mtext> <mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula> increases with each subtree (for <italic>ℓ</italic> &gt; 0) while <inline-formula id="pcbi.1006745.e114"><alternatives><graphic id="pcbi.1006745.e114g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e114" xlink:type="simple"/><mml:math display="inline" id="M114"><mml:mrow><mml:msubsup><mml:mi>R</mml:mi> <mml:mtext>cml</mml:mtext> <mml:mn>2</mml:mn></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>g</mml:mi> <mml:mo>|</mml:mo> <mml:mi>G</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> remains zero until <italic>g</italic> = 7. For the T cell, <inline-formula id="pcbi.1006745.e115"><alternatives><graphic id="pcbi.1006745.e115g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e115" xlink:type="simple"/><mml:math display="inline" id="M115"><mml:msubsup><mml:mi>η</mml:mi> <mml:mtext>cml</mml:mtext> <mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula> starts high at <italic>ℓ</italic> = 0, while <inline-formula id="pcbi.1006745.e116"><alternatives><graphic id="pcbi.1006745.e116g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e116" xlink:type="simple"/><mml:math display="inline" id="M116"><mml:mrow><mml:msubsup><mml:mi>R</mml:mi> <mml:mtext>cml</mml:mtext> <mml:mn>2</mml:mn></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>g</mml:mi> <mml:mo>|</mml:mo> <mml:mi>G</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> starts at zero and increases slowly with each generation. Contrast this with the branching process where <inline-formula id="pcbi.1006745.e117"><alternatives><graphic id="pcbi.1006745.e117g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e117" xlink:type="simple"/><mml:math display="inline" id="M117"><mml:msubsup><mml:mi>η</mml:mi> <mml:mtext>cml</mml:mtext> <mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006745.e118"><alternatives><graphic id="pcbi.1006745.e118g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e118" xlink:type="simple"/><mml:math display="inline" id="M118"><mml:msubsup><mml:mi>R</mml:mi> <mml:mtext>cml</mml:mtext> <mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula> both start near zero and increase steadily in a similar fashion. Clearly a T cell lineage cannot be modeled as a branching process.</p>
<p>In the worm lineage, such <italic>fate restriction before fate expression</italic> captures what is perhaps obvious from the lineage map. Looking at <xref ref-type="fig" rid="pcbi.1006745.g001">Fig 1b</xref> we see how <italic>PHA-4</italic> expression is negligible until generation 7 whereupon it appears simultaneously across multiple subtrees. This implies that cells across those subtrees coordinated their fates before expressing them. Thus, for the worm, the fate profile merely restates, albeit in a quantitative way, what can be visualized in a single (invariant) pedigree. However, the advantage of the fate profile is that it can be applied to variable lineages, when simple visualization fails.</p>
</sec>
</sec>
</sec>
<sec id="sec029" sec-type="conclusions">
<title>Discussion</title>
<p>The lineage map, which has been instrumental in the discovery of fate specification mechanisms in simple organisms, was born from the study of invariant lineages and is not a particularly useful concept for understanding the more ubiquitous case of variable lineages. To address this limitation, we have introduced lineage variability maps, which provide a way to describe lineages at the population level. Whereas the lineage map is a description of the fixed pattern of phenotypes across a pedigree, the lineage variability map describes the pattern of phenotypic associations across a pedigree. This map of phenotypic associations, <bold>Σ</bold>, provides quantitative answers to essential scientific questions such as those about cell potency, fate restriction, and the sources of variation in a lineage.</p>
<p>We have constructed lineage variability maps from a sample of highly-variable pedigrees from CD8<sup>+</sup> T-lymphocytes up to five generations. These show that most of the variation in cell fate, defined here to be average cell size at generation 5, is explained by the choice of naive cell. Yet, despite the pivotal role played by this founder in restricting cell fate, its phenotype is not predictive of fate: though a naive cell may specify that its descendants be large, it may not be large itself (at least on average).</p>
<p>Although we expect to apply our technique primarily to variable pedigrees which are difficult to interpret by visualization alone, we can also apply it to invariant lineages to check our results. In fact, by constructing lineage variability maps from sample wild-type pedigrees from <italic>C. elegans</italic> marked for pharyngeal expression, we successfully recovered essential information in the known lineage map, identifying global features such as the small degree of inter-pedigree variation characteristic of a totipotent zygote, and the several-generation delay between fate specification and expression.</p>
<p>Yet our lineage variability maps capture important finer detail as well. Consider the peak in fate restriction at <italic>ℓ</italic> = 2 observed in <xref ref-type="fig" rid="pcbi.1006745.g011">Fig 11b</xref>. This arises from the strong bifurcation of fate traced back to the division of both P1 and of AB, progenitors located at <italic>ℓ</italic> = 2 (see Section S1.6 in <xref ref-type="supplementary-material" rid="pcbi.1006745.s001">S1 Appendix</xref> for the labeling of lineal positions in the worm). That only a single daughter from P1 and from AB exhibit pharyngeal fate results in the spike in fate restriction that we observe. Interestingly, this phenomenon, of pharyngeal fate ensuing from two cousins at generation 3 (ABa and EMS) but not from their sisters, is a phenomenon that has been investigated in detail [<xref ref-type="bibr" rid="pcbi.1006745.ref080">80</xref>]. Such work laid the foundation for further studies leading to the understanding of the molecular and cellular mechanisms for specification of pharyngeal tissue [<xref ref-type="bibr" rid="pcbi.1006745.ref081">81</xref>]. This demonstrates how, even though we may be ignorant of the ordering of the lineage, we can still detect a fate bifurcation event of biological relevance that had previously required knowledge of this ordering. In other words, although we must assume lineage relationships are symmetric, this does not prevent us from detecting the effects of asymmetric lineage patterns from the ‘boost’ they give to the variance in particular subtrees.</p>
<p>Recent technological innovations have introduced a variety of methods for recording lineage data, involving both advanced imaging [<xref ref-type="bibr" rid="pcbi.1006745.ref019">19</xref>, <xref ref-type="bibr" rid="pcbi.1006745.ref046">46</xref>–<xref ref-type="bibr" rid="pcbi.1006745.ref048">48</xref>] and genetic barcoding [<xref ref-type="bibr" rid="pcbi.1006745.ref020">20</xref>, <xref ref-type="bibr" rid="pcbi.1006745.ref049">49</xref>, <xref ref-type="bibr" rid="pcbi.1006745.ref051">51</xref>–<xref ref-type="bibr" rid="pcbi.1006745.ref057">57</xref>] techniques. With the statistical lineage mapping and fate profiling methods described in this manuscript, it should be possible to quantify fundamental properties of these lineages, such as the potency of progenitors, whether heterogeneity is clonal, and at what depth such heterogeneity appears. Just as the visual identification of fate bifurcations in the worm lineage map enabled the location of fate specification events to be discovered, the capacity to perform systematic screens to rapidly identify the important stages of fate restriction should contribute to a deeper understanding of the mechanisms of fate specification in more complex, more variable systems.</p>
</sec>
<sec id="sec030">
<title>Supporting information</title>
<supplementary-material id="pcbi.1006745.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006745.s001" xlink:type="simple">
<label>S1 Appendix</label>
<caption>
<title>Supplemental derivations and nomenclature.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006745.s002" mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006745.s002" xlink:type="simple">
<label>S1 Data</label>
<caption>
<title>Lineage data.</title>
<p>(XLSX)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We thank Raz Shimoni for enabling assembly of the T-cell pedigrees and Alan Rubin for suggesting we test our method on the <italic>C. elegans</italic> lineage.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1006745.ref001">
<label>1</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Chisholm</surname> <given-names>AD</given-names></name>. <chapter-title>Cell Lineage</chapter-title>. In: <name name-style="western"><surname>Brenner</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Miller</surname> <given-names>JH</given-names></name>, editors. <source>Encyclopedia of Genetics</source>. <publisher-loc>New York</publisher-loc>: <publisher-name>Academic Press</publisher-name>; <year>2001</year>. p. <fpage>302</fpage>–<lpage>310</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="https://www.sciencedirect.com/science/article/pii/B0122270800001725" xlink:type="simple">https://www.sciencedirect.com/science/article/pii/B0122270800001725</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006745.ref002">
<label>2</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Klein</surname> <given-names>SL</given-names></name>, <name name-style="western"><surname>Moody</surname> <given-names>SA</given-names></name>. <chapter-title>Chapter Six—When Family History Matters: The Importance of Lineage Analyses and Fate Maps for Explaining Animal Development</chapter-title>. In: <name name-style="western"><surname>Wassarman</surname> <given-names>PM</given-names></name>, editor. <source>Essays on Developmental Biology, Part B. vol. 117 of Current Topics in Developmental Biology</source>. <publisher-name>Academic Press</publisher-name>; <year>2016</year>. p. <fpage>93</fpage>–<lpage>112</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.sciencedirect.com/science/article/pii/S007021531500109X" xlink:type="simple">http://www.sciencedirect.com/science/article/pii/S007021531500109X</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006745.ref003">
<label>3</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Moody</surname> <given-names>SA</given-names></name>, editor. <source>Cell Lineage and Fate Determination</source>. <publisher-loc>London, UK</publisher-loc>: <publisher-name>Academic Press</publisher-name>; <year>1999</year>. Available from: <ext-link ext-link-type="uri" xlink:href="https://books.google.com.au/books?id=wOob2ShSTv4C" xlink:type="simple">https://books.google.com.au/books?id=wOob2ShSTv4C</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006745.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sulston</surname> <given-names>JE</given-names></name>, <name name-style="western"><surname>Horvitz</surname> <given-names>HR</given-names></name>. <article-title>Post-embryonic cell lineages of the nematode, Caenorhabditis elegans</article-title>. <source>Developmental Biology</source>. <year>1977</year>;<volume>56</volume>(<issue>1</issue>):<fpage>110</fpage>–<lpage>156</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/0012-1606(77)90158-0" xlink:type="simple">https://doi.org/10.1016/0012-1606(77)90158-0</ext-link> <object-id pub-id-type="pmid">838129</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sulston</surname> <given-names>JE</given-names></name>, <name name-style="western"><surname>Schierenberg</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>White</surname> <given-names>JG</given-names></name>, <name name-style="western"><surname>Thomson</surname> <given-names>JN</given-names></name>. <article-title>The embryonic cell lineage of the nematode Caenorhabditis elegans</article-title>. <source>Developmental Biology</source>. <year>1983</year>;<volume>100</volume>(<issue>1</issue>):<fpage>64</fpage>–<lpage>119</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/0012-1606(83)90201-4" xlink:type="simple">10.1016/0012-1606(83)90201-4</ext-link></comment> <object-id pub-id-type="pmid">6684600</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sternberg</surname> <given-names>PW</given-names></name>. <article-title>Forty years of cellular clues from worms</article-title>. <source>Nature</source>. <year>2017</year>;<volume>543</volume>:<fpage>628</fpage> EP –. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/543628a" xlink:type="simple">10.1038/543628a</ext-link></comment> <object-id pub-id-type="pmid">28358092</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Du</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Santella</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>He</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Tiongson</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Bao</surname> <given-names>Z</given-names></name>. <article-title>De Novo Inference of Systems-Level Mechanistic Models of Development from Live-Imaging-Based Phenotype Analysis</article-title>. <source>Cell</source>. <year>2014</year>;<volume>156</volume>(<issue>1</issue>):<fpage>359</fpage>–<lpage>372</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cell.2013.11.046" xlink:type="simple">10.1016/j.cell.2013.11.046</ext-link></comment> <object-id pub-id-type="pmid">24439388</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Murray</surname> <given-names>JI</given-names></name>. <article-title>Systems biology of embryonic development: Prospects for a complete understanding of the Caenorhabditis elegans embryo</article-title>. <source>Wiley Interdisciplinary Reviews: Developmental Biology</source>. <year>2018</year>;<volume>7</volume>(<issue>3</issue>):<fpage>e314</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/wdev.314" xlink:type="simple">10.1002/wdev.314</ext-link></comment> <object-id pub-id-type="pmid">29369536</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bao</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Zhao</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Boyle</surname> <given-names>TJ</given-names></name>, <name name-style="western"><surname>Murray</surname> <given-names>JI</given-names></name>, <name name-style="western"><surname>Waterston</surname> <given-names>RH</given-names></name>. <article-title>Control of cell cycle timing during C. elegans embryogenesis</article-title>. <source>Developmental Biology</source>. <year>2008</year>;<volume>318</volume>(<issue>1</issue>):<fpage>65</fpage>–<lpage>72</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.ydbio.2008.02.054" xlink:type="simple">https://doi.org/10.1016/j.ydbio.2008.02.054</ext-link> <object-id pub-id-type="pmid">18430415</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gritti</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Kienle</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Filina</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>van Zon</surname> <given-names>JS</given-names></name>. <article-title>Long-term time-lapse microscopy of C. elegans post-embryonic development</article-title>. <source>Nature Communications</source>. <year>2016</year>;<volume>7</volume>:<fpage>12500</fpage> EP –. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ncomms12500" xlink:type="simple">10.1038/ncomms12500</ext-link></comment> <object-id pub-id-type="pmid">27558523</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gline</surname> <given-names>SE</given-names></name>, <name name-style="western"><surname>Kuo</surname> <given-names>DH</given-names></name>, <name name-style="western"><surname>Stolfi</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Weisblat</surname> <given-names>DA</given-names></name>. <article-title>High resolution cell lineage tracing reveals developmental variability in leech</article-title>. <source>Developmental Dynamics</source>. <year>2009</year>;<volume>238</volume>(<issue>12</issue>):<fpage>3139</fpage>–<lpage>3151</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/dvdy.22158" xlink:type="simple">10.1002/dvdy.22158</ext-link></comment> <object-id pub-id-type="pmid">19924812</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Stent</surname> <given-names>GS</given-names></name>. <article-title>Developmental cell lineage</article-title>. <source>Int J Dev Biol</source>. <year>1998</year>;<volume>42</volume>:<fpage>237</fpage>–<lpage>241</lpage>. <object-id pub-id-type="pmid">9654003</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Skylaki</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Hilsenbeck</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Schroeder</surname> <given-names>T</given-names></name>. <article-title>Challenges in long-term imaging and quantification of single-cell dynamics</article-title>. <source>Nature Biotechnology</source>. <year>2016</year>;<volume>34</volume>:<fpage>1137</fpage> EP –. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nbt.3713" xlink:type="simple">10.1038/nbt.3713</ext-link></comment> <object-id pub-id-type="pmid">27824848</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hawkins</surname> <given-names>ED</given-names></name>, <name name-style="western"><surname>Markham</surname> <given-names>JF</given-names></name>, <name name-style="western"><surname>McGuinness</surname> <given-names>LP</given-names></name>, <name name-style="western"><surname>Hodgkin</surname> <given-names>PD</given-names></name>. <article-title>A single-cell pedigree analysis of alternative stochastic lymphocyte fates</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2009</year>;. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.0905629106" xlink:type="simple">10.1073/pnas.0905629106</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kinjyo</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Qin</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Tan</surname> <given-names>SY</given-names></name>, <name name-style="western"><surname>Wellard</surname> <given-names>CJ</given-names></name>, <name name-style="western"><surname>Mrass</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Ritchie</surname> <given-names>W</given-names></name>, <etal>et al</etal>. <article-title>Real-time tracking of cell cycle progression during CD8+ effector and memory T-cell differentiation</article-title>. <source>Nature Communications</source>. <year>2015</year>;<volume>6</volume>:<fpage>6301</fpage> EP –. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ncomms7301" xlink:type="simple">10.1038/ncomms7301</ext-link></comment> <object-id pub-id-type="pmid">25709008</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hadjantonakis</surname> <given-names>AK</given-names></name>, <name name-style="western"><surname>Arias</surname> <given-names>AM</given-names></name>. <article-title>Single-Cell Approaches: Pandora’s Box of Developmental Mechanisms</article-title>. <source>Developmental Cell</source>. <year>2016</year>;<volume>38</volume>(<issue>6</issue>):<fpage>574</fpage>–<lpage>578</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.devcel.2016.09.012" xlink:type="simple">https://doi.org/10.1016/j.devcel.2016.09.012</ext-link> <object-id pub-id-type="pmid">27676428</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref017">
<label>17</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Giurumescu</surname> <given-names>CA</given-names></name>, <name name-style="western"><surname>Chisholm</surname> <given-names>AD</given-names></name>. <chapter-title>Chapter 12—Cell Identification and Cell Lineage Analysis</chapter-title>. In: <name name-style="western"><surname>Rothman</surname> <given-names>JH</given-names></name>, <name name-style="western"><surname>Singson</surname> <given-names>A</given-names></name>, editors. <source>Caenorhabditis elegans: Molecular Genetics and Development. vol. 106 of Methods in Cell Biology</source>. <publisher-name>Academic Press</publisher-name>; <year>2011</year>. p. <fpage>323</fpage>–<lpage>341</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.sciencedirect.com/science/article/pii/B9780125441728000128" xlink:type="simple">http://www.sciencedirect.com/science/article/pii/B9780125441728000128</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006745.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zernicka-Goetz</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Huang</surname> <given-names>S</given-names></name>. <article-title>Stochasticity versus determinism in development: a false dichotomy?</article-title> <source>Nat Rev Genet</source>. <year>2010</year>;<volume>11</volume>(<issue>11</issue>):<fpage>743</fpage>–<lpage>744</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nrg2886" xlink:type="simple">10.1038/nrg2886</ext-link></comment> <object-id pub-id-type="pmid">20877326</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Olivier</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Luengo-Oroz</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Duloquin</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Faure</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Savy</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Veilleux</surname> <given-names>I</given-names></name>, <etal>et al</etal>. <article-title>Cell Lineage Reconstruction of Early Zebrafish Embryos Using Label-Free Nonlinear Microscopy</article-title>. <source>Science</source>. <year>2010</year>;<volume>329</volume>(<issue>5994</issue>):<fpage>967</fpage>–<lpage>971</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.1189428" xlink:type="simple">10.1126/science.1189428</ext-link></comment> <object-id pub-id-type="pmid">20724640</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wasserstrom</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Adar</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Shefer</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Frumkin</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Itzkovitz</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Stern</surname> <given-names>T</given-names></name>, <etal>et al</etal>. <article-title>Reconstruction of Cell Lineage Trees in Mice</article-title>. <source>PLOS ONE</source>. <year>2008</year>;<volume>3</volume>(<issue>4</issue>):<fpage>1</fpage>–<lpage>11</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0001939" xlink:type="simple">10.1371/journal.pone.0001939</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Frumkin</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Wasserstrom</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Itzkovitz</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Stern</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Harmelin</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Eilam</surname> <given-names>R</given-names></name>, <etal>et al</etal>. <article-title>Cell Lineage Analysis of a Mouse Tumor</article-title>. <source>Cancer Research</source>. <year>2008</year>;<volume>68</volume>(<issue>14</issue>):<fpage>5924</fpage>–<lpage>5931</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1158/0008-5472.CAN-07-6216" xlink:type="simple">10.1158/0008-5472.CAN-07-6216</ext-link></comment> <object-id pub-id-type="pmid">18632647</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cowan</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Staudte</surname> <given-names>R</given-names></name>. <article-title>The Bifurcating Autoregression Model in Cell Lineage Studies</article-title>. <source>Biometrics</source>. <year>1986</year>;<volume>42</volume>(<issue>4</issue>):<fpage>769</fpage>–<lpage>783</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.2307/2530692" xlink:type="simple">10.2307/2530692</ext-link></comment> <object-id pub-id-type="pmid">3814722</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Huggins</surname> <given-names>RM</given-names></name>, <name name-style="western"><surname>Staudte</surname> <given-names>RG</given-names></name>. <article-title>Variance Components Models for Dependent Cell Populations</article-title>. <source>Journal of the American Statistical Association</source>. <year>1994</year>;<volume>89</volume>(<issue>425</issue>):<fpage>19</fpage>–<lpage>29</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1080/01621459.1994.10476442" xlink:type="simple">10.1080/01621459.1994.10476442</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Guyon</surname> <given-names>J</given-names></name>. <article-title>Limit theorems for bifurcating Markov chains. Application to the detection of cellular aging</article-title>. <source>Ann Appl Probab</source>. <year>2007</year>;<volume>17</volume>(<issue>5/6</issue>):<fpage>1538</fpage>–<lpage>1569</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1214/105051607000000195" xlink:type="simple">10.1214/105051607000000195</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>de Saporta</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Gégout-Petit</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Marsalle</surname> <given-names>L</given-names></name>. <article-title>Statistical study of asymmetry in cell lineage data</article-title>. <source>Computational Statistics &amp; Data Analysis</source>. <year>2014</year>;<volume>69</volume>:<fpage>15</fpage>–<lpage>39</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.csda.2013.07.025" xlink:type="simple">https://doi.org/10.1016/j.csda.2013.07.025</ext-link></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sandler</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Mizrahi</surname> <given-names>SP</given-names></name>, <name name-style="western"><surname>Weiss</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Agam</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Simon</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Balaban</surname> <given-names>NQ</given-names></name>. <article-title>Lineage correlations of single cell division time as a probe of cell-cycle dynamics</article-title>. <source>Nature</source>. <year>2015</year>;<volume>519</volume>(<issue>7544</issue>):<fpage>468</fpage>–<lpage>471</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature14318" xlink:type="simple">10.1038/nature14318</ext-link></comment> <object-id pub-id-type="pmid">25762143</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hilfinger</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Paulsson</surname> <given-names>J</given-names></name>. <article-title>Defiant daughters and coordinated cousins</article-title>. <source>Nature</source>. <year>2015</year>;<volume>519</volume>:<fpage>422</fpage> EP –. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature14210" xlink:type="simple">10.1038/nature14210</ext-link></comment> <object-id pub-id-type="pmid">25762142</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Powell</surname> <given-names>EO</given-names></name>. <article-title>Some Features of the Generation Times of Individual Bacteria</article-title>. <source>Biometrika</source>. <year>1955</year>;<volume>42</volume>(<issue>1-2</issue>):<fpage>16</fpage>–<lpage>44</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/biomet/42.1-2.16" xlink:type="simple">10.1093/biomet/42.1-2.16</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Schaechter</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Williamson</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Hood</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>Koch</surname> <given-names>AL</given-names></name>. <article-title>Growth, Cell and Nuclear Divisions in some Bacteria</article-title>. <source>Microbiology</source>. <year>1962</year>;<volume>29</volume>(<issue>3</issue>):<fpage>421</fpage>–<lpage>434</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006745.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hawkins</surname> <given-names>ED</given-names></name>, <name name-style="western"><surname>Turner</surname> <given-names>ML</given-names></name>, <name name-style="western"><surname>Dowling</surname> <given-names>MR</given-names></name>, <name name-style="western"><surname>van Gend</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Hodgkin</surname> <given-names>PD</given-names></name>. <article-title>A model of immune regulation as a consequence of randomized lymphocyte division and death times</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2007</year>;<volume>104</volume>(<issue>12</issue>):<fpage>5032</fpage>–<lpage>5037</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.0700026104" xlink:type="simple">10.1073/pnas.0700026104</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wellard</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Markham</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Hawkins</surname> <given-names>ED</given-names></name>, <name name-style="western"><surname>Hodgkin</surname> <given-names>PD</given-names></name>. <article-title>The effect of correlations on the population dynamics of lymphocytes</article-title>. <source>Journal of Theoretical Biology</source>. <year>2010</year>;<volume>264</volume>(<issue>2</issue>):<fpage>443</fpage>–<lpage>449</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.jtbi.2010.02.019" xlink:type="simple">https://doi.org/10.1016/j.jtbi.2010.02.019</ext-link> <object-id pub-id-type="pmid">20171973</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hormoz</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Desprat</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Shraiman</surname> <given-names>BI</given-names></name>. <article-title>Inferring epigenetic dynamics from kin correlations</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2015</year>;<volume>112</volume>(<issue>18</issue>):<fpage>E2281</fpage>–<lpage>E2289</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1504407112" xlink:type="simple">10.1073/pnas.1504407112</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hormoz</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Singer</surname> <given-names>ZS</given-names></name>, <name name-style="western"><surname>Linton</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Antebi</surname> <given-names>YE</given-names></name>, <name name-style="western"><surname>Shraiman</surname> <given-names>BI</given-names></name>, <name name-style="western"><surname>Elowitz</surname> <given-names>MB</given-names></name>. <article-title>Inferring Cell-State Transition Dynamics from Lineage Trees and Endpoint Single-Cell Measurements</article-title>. <source>Cell Systems</source>. <year>2016</year>;<volume>3</volume>(<issue>5</issue>):<fpage>419</fpage>—<lpage>433.e8</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cels.2016.10.015" xlink:type="simple">10.1016/j.cels.2016.10.015</ext-link></comment> <object-id pub-id-type="pmid">27883889</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Strasser</surname> <given-names>MK</given-names></name>, <name name-style="western"><surname>Hoppe</surname> <given-names>PS</given-names></name>, <name name-style="western"><surname>Loeffler</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Kokkaliaris</surname> <given-names>KD</given-names></name>, <name name-style="western"><surname>Schroeder</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Theis</surname> <given-names>FJ</given-names></name>, <etal>et al</etal>. <article-title>Lineage marker synchrony in hematopoietic genealogies refutes the PU.1/GATA1 toggle switch paradigm</article-title>. <source>Nature Communications</source>. <year>2018</year>;<volume>9</volume>(<issue>1</issue>):<fpage>2697</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/s41467-018-05037-3" xlink:type="simple">10.1038/s41467-018-05037-3</ext-link></comment> <object-id pub-id-type="pmid">30002371</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kuzmanovska</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Milias-Argeitis</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Mikelson</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Zechner</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Khammash</surname> <given-names>M</given-names></name>. <article-title>Parameter inference for stochastic single-cell dynamics from lineage tree data</article-title>. <source>BMC Systems Biology</source>. <year>2017</year>;<volume>11</volume>(<issue>1</issue>):<fpage>52</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/s12918-017-0425-1" xlink:type="simple">10.1186/s12918-017-0425-1</ext-link></comment> <object-id pub-id-type="pmid">28446158</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Niederberger</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Failmezger</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Uskat</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Poron</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Glauche</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Scherf</surname> <given-names>N</given-names></name>, <etal>et al</etal>. <article-title>Factor graph analysis of live cell–imaging data reveals mechanisms of cell fate decisions</article-title>. <source>Bioinformatics</source>. <year>2015</year>;<volume>31</volume>(<issue>11</issue>):<fpage>1816</fpage>–<lpage>1823</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btv040" xlink:type="simple">10.1093/bioinformatics/btv040</ext-link></comment> <object-id pub-id-type="pmid">25638814</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref037">
<label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Feigelman</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Ganscha</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Hastreiter</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Schwarzfischer</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Filipczyk</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Schroeder</surname> <given-names>T</given-names></name>, <etal>et al</etal>. <article-title>Analysis of Cell Lineage Trees by Exact Bayesian Inference Identifies Negative Autoregulation of Nanog in Mouse Embryonic Stem Cells</article-title>. <source>Cell Systems</source>. <year>2016</year>;<volume>3</volume>(<issue>5</issue>):<fpage>480</fpage>–<lpage>490.e13</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cels.2016.11.001" xlink:type="simple">10.1016/j.cels.2016.11.001</ext-link></comment> <object-id pub-id-type="pmid">27883891</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref038">
<label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Stadler</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Skylaki</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Kokkaliaris</surname> <given-names>KD</given-names></name>, <name name-style="western"><surname>Schroeder</surname> <given-names>T</given-names></name>. <article-title>On the statistical analysis of single cell lineage trees</article-title>. <source>Journal of Theoretical Biology</source>. <year>2018</year>;<volume>439</volume>:<fpage>160</fpage>–<lpage>165</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.jtbi.2017.11.023" xlink:type="simple">https://doi.org/10.1016/j.jtbi.2017.11.023</ext-link> <object-id pub-id-type="pmid">29208470</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref039">
<label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Schroeder</surname> <given-names>T</given-names></name>. <article-title>Long-term single-cell imaging of mammalian stem cells</article-title>. <source>Nature Methods</source>. <year>2011</year>;<volume>8</volume>:<fpage>S30</fpage> EP –. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nmeth.1577" xlink:type="simple">10.1038/nmeth.1577</ext-link></comment> <object-id pub-id-type="pmid">21451514</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref040">
<label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Shapiro</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Biezuner</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Linnarsson</surname> <given-names>S</given-names></name>. <article-title>Single-cell sequencing-based technologies will revolutionize whole-organism science</article-title>. <source>Nature Reviews Genetics</source>. <year>2013</year>;<volume>14</volume>:<fpage>618</fpage> EP –. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nrg3542" xlink:type="simple">10.1038/nrg3542</ext-link></comment> <object-id pub-id-type="pmid">23897237</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref041">
<label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Woodworth</surname> <given-names>MB</given-names></name>, <name name-style="western"><surname>Girskis</surname> <given-names>KM</given-names></name>, <name name-style="western"><surname>Walsh</surname> <given-names>CA</given-names></name>. <article-title>Building a lineage from single cells: genetic techniques for cell lineage tracking</article-title>. <source>Nature Reviews Genetics</source>. <year>2017</year>;<volume>18</volume>:<fpage>230</fpage> EP –. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nrg.2016.159" xlink:type="simple">10.1038/nrg.2016.159</ext-link></comment> <object-id pub-id-type="pmid">28111472</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref042">
<label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kester</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>van Oudenaarden</surname> <given-names>A</given-names></name>. <article-title>Single-Cell Transcriptomics Meets Lineage Tracing</article-title>. <source>Cell Stem Cell</source>. <year>2018</year>;<volume>23</volume>(<issue>2</issue>):<fpage>166</fpage>–<lpage>179</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.stem.2018.04.014" xlink:type="simple">https://doi.org/10.1016/j.stem.2018.04.014</ext-link> <object-id pub-id-type="pmid">29754780</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref043">
<label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Callaway</surname> <given-names>E</given-names></name>. <article-title>The Trickiest Family Tree in Biology</article-title>. <source>Nature</source>. <year>2017</year>;<volume>547</volume>:<fpage>20</fpage>–<lpage>22</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/547020a" xlink:type="simple">10.1038/547020a</ext-link></comment> <object-id pub-id-type="pmid">28682346</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref044">
<label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Shapiro</surname> <given-names>E</given-names></name>. <article-title>On the journey from nematode to human, scientists dive by the zebrafish cell lineage tree</article-title>. <source>Genome Biology</source>. <year>2018</year>;<volume>19</volume>(<issue>1</issue>):<fpage>63</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/s13059-018-1453-x" xlink:type="simple">10.1186/s13059-018-1453-x</ext-link></comment> <object-id pub-id-type="pmid">29843775</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref045">
<label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Marx</surname> <given-names>V</given-names></name>. <article-title>Stem cells: lineage tracing lets single cells talk about their past</article-title>. <source>Nature Methods</source>. <year>2018</year>;<volume>15</volume>(<issue>6</issue>):<fpage>411</fpage>–<lpage>414</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/s41592-018-0016-0" xlink:type="simple">10.1038/s41592-018-0016-0</ext-link></comment> <object-id pub-id-type="pmid">29855571</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref046">
<label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Keller</surname> <given-names>PJ</given-names></name>, <name name-style="western"><surname>Schmidt</surname> <given-names>AD</given-names></name>, <name name-style="western"><surname>Wittbrodt</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Stelzer</surname> <given-names>EHK</given-names></name>. <article-title>Reconstruction of Zebrafish Early Embryonic Development by Scanned Light Sheet Microscopy</article-title>. <source>Science</source>. <year>2008</year>;<volume>322</volume>(<issue>5904</issue>):<fpage>1065</fpage>–<lpage>1069</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.1162493" xlink:type="simple">10.1126/science.1162493</ext-link></comment> <object-id pub-id-type="pmid">18845710</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref047">
<label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Amat</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Lemon</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Mossing</surname> <given-names>DP</given-names></name>, <name name-style="western"><surname>McDole</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Wan</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Branson</surname> <given-names>K</given-names></name>, <etal>et al</etal>. <article-title>Fast, accurate reconstruction of cell lineages from large-scale fluorescence microscopy data</article-title>. <source>Nature Methods</source>. <year>2014</year>;<volume>11</volume>:<fpage>951</fpage> EP –. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nmeth.3036" xlink:type="simple">10.1038/nmeth.3036</ext-link></comment> <object-id pub-id-type="pmid">25042785</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref048">
<label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Stegmaier</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Amat</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Lemon</surname> <given-names>WC</given-names></name>, <name name-style="western"><surname>McDole</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Wan</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Teodoro</surname> <given-names>G</given-names></name>, <etal>et al</etal>. <article-title>Real-Time Three-Dimensional Cell Segmentation in Large-Scale Microscopy Data of Developing Embryos</article-title>. <source>Developmental Cell</source>. <year>2016</year>;<volume>36</volume>(<issue>2</issue>):<fpage>225</fpage>–<lpage>240</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.devcel.2015.12.028" xlink:type="simple">10.1016/j.devcel.2015.12.028</ext-link></comment> <object-id pub-id-type="pmid">26812020</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref049">
<label>49</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Frumkin</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Wasserstrom</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Kaplan</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Feige</surname> <given-names>U</given-names></name>, <name name-style="western"><surname>Shapiro</surname> <given-names>E</given-names></name>. <article-title>Genomic Variability within an Organism Exposes Its Cell Lineage Tree</article-title>. <source>PLOS Computational Biology</source>. <year>2005</year>;<volume>1</volume>(<issue>5</issue>):<fpage>1</fpage>–<lpage>13</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.0010050" xlink:type="simple">10.1371/journal.pcbi.0010050</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref050">
<label>50</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Salipante</surname> <given-names>SJ</given-names></name>, <name name-style="western"><surname>Horwitz</surname> <given-names>MS</given-names></name>. <article-title>Phylogenetic fate mapping</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2006</year>;<volume>103</volume>(<issue>14</issue>):<fpage>5448</fpage>–<lpage>5453</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.0601265103" xlink:type="simple">10.1073/pnas.0601265103</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref051">
<label>51</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>McKenna</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Findlay</surname> <given-names>GM</given-names></name>, <name name-style="western"><surname>Gagnon</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Horwitz</surname> <given-names>MS</given-names></name>, <name name-style="western"><surname>Schier</surname> <given-names>AF</given-names></name>, <name name-style="western"><surname>Shendure</surname> <given-names>J</given-names></name>. <article-title>Whole-organism lineage tracing by combinatorial and cumulative genome editing</article-title>. <source>Science</source>. <year>2016</year>;<volume>353</volume> (<issue>6298</issue>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.aaf7907" xlink:type="simple">10.1126/science.aaf7907</ext-link></comment> <object-id pub-id-type="pmid">27229144</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref052">
<label>52</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Frieda</surname> <given-names>KL</given-names></name>, <name name-style="western"><surname>Linton</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Hormoz</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Choi</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Chow</surname> <given-names>KHK</given-names></name>, <name name-style="western"><surname>Singer</surname> <given-names>ZS</given-names></name>, <etal>et al</etal>. <article-title>Synthetic recording and in situ readout of lineage information in single cells</article-title>. <source>Nature</source>. <year>2016</year>;<volume>541</volume>: <fpage>107</fpage> EP –. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature20777" xlink:type="simple">10.1038/nature20777</ext-link></comment> <object-id pub-id-type="pmid">27869821</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref053">
<label>53</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Schmidt</surname> <given-names>ST</given-names></name>, <name name-style="western"><surname>Zimmerman</surname> <given-names>SM</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>SK</given-names></name>, <name name-style="western"><surname>Quake</surname> <given-names>SR</given-names></name>. <article-title>Quantitative Analysis of Synthetic Cell Lineage Tracing Using Nuclease Barcoding</article-title>. <source>ACS Synthetic Biology</source>. <year>2017</year>;<volume>6</volume>(<issue>6</issue>):<fpage>936</fpage>–<lpage>942</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1021/acssynbio.6b00309" xlink:type="simple">10.1021/acssynbio.6b00309</ext-link></comment> <object-id pub-id-type="pmid">28264564</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref054">
<label>54</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Alemany</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Florescu</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Baron</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Peterson-Maduro</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>van Oudenaarden</surname> <given-names>A</given-names></name>. <article-title>Whole-organism clone tracing using single-cell sequencing</article-title>. <source>Nature</source>. <year>2018</year>;<volume>556</volume>:<fpage>108</fpage> EP –. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature25969" xlink:type="simple">10.1038/nature25969</ext-link></comment> <object-id pub-id-type="pmid">29590089</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref055">
<label>55</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Spanjaard</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Hu</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Mitic</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Olivares-Chauvet</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Janjuha</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Ninov</surname> <given-names>N</given-names></name>, <etal>et al</etal>. <article-title>Simultaneous lineage tracing and cell-type identification using CRISPR–Cas9-induced genetic scars</article-title>. <source>Nature Biotechnology</source>. <year>2018</year>;<volume>36</volume>:<fpage>469</fpage> EP –. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nbt.4124" xlink:type="simple">10.1038/nbt.4124</ext-link></comment> <object-id pub-id-type="pmid">29644996</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref056">
<label>56</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Raj</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Wagner</surname> <given-names>DE</given-names></name>, <name name-style="western"><surname>McKenna</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Pandey</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Klein</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Shendure</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Simultaneous single-cell profiling of lineages and cell types in the vertebrate brain</article-title>. <source>Nature Biotechnology</source>. <year>2018</year>;<volume>36</volume>:<fpage>442</fpage> EP –. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nbt.4103" xlink:type="simple">10.1038/nbt.4103</ext-link></comment> <object-id pub-id-type="pmid">29608178</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref057">
<label>57</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wagner</surname> <given-names>DE</given-names></name>, <name name-style="western"><surname>Weinreb</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Collins</surname> <given-names>ZM</given-names></name>, <name name-style="western"><surname>Briggs</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Megason</surname> <given-names>SG</given-names></name>, <name name-style="western"><surname>Klein</surname> <given-names>AM</given-names></name>. <article-title>Single-cell mapping of gene expression landscapes and lineage in the zebrafish embryo</article-title>. <source>Science</source>. <year>2018</year>;<volume>360</volume>(<issue>6392</issue>):<fpage>981</fpage>–<lpage>987</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.aar4362" xlink:type="simple">10.1126/science.aar4362</ext-link></comment> <object-id pub-id-type="pmid">29700229</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref058">
<label>58</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Oliaro</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Van Ham</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Sacirbegovic</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Pasam</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Bomzon</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Pham</surname> <given-names>K</given-names></name>, <etal>et al</etal>. <article-title>Asymmetric Cell Division of T Cells upon Antigen Presentation Uses Multiple Conserved Mechanisms</article-title>. <source>The Journal of Immunology</source>. <year>2010</year>;<volume>185</volume>(<issue>1</issue>):<fpage>367</fpage>–<lpage>375</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.4049/jimmunol.0903627" xlink:type="simple">10.4049/jimmunol.0903627</ext-link></comment> <object-id pub-id-type="pmid">20530266</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref059">
<label>59</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Shimoni</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Pham</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Yassin</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Gu</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Russell</surname> <given-names>SM</given-names></name>. <article-title>TACTICS, an interactive platform for customized high-content bioimaging analysis</article-title>. <source>Bioinformatics</source>. <year>2013</year>;<volume>29</volume>(<issue>6</issue>):<fpage>817</fpage>–<lpage>818</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btt035" xlink:type="simple">10.1093/bioinformatics/btt035</ext-link></comment> <object-id pub-id-type="pmid">23341500</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref060">
<label>60</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Santella</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Kovacevic</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Herndon</surname> <given-names>LA</given-names></name>, <name name-style="western"><surname>Hall</surname> <given-names>DH</given-names></name>, <name name-style="western"><surname>Du</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Bao</surname> <given-names>Z</given-names></name>. <article-title>Digital development: a database of cell lineage differentiation in C. elegans with lineage phenotypes, cell-specific gene functions and a multiscale model</article-title>. <source>Nucleic Acids Research</source>. <year>2016</year>;<volume>44</volume>(<issue>D1</issue>):<fpage>D781</fpage>–<lpage>D785</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gkv1119" xlink:type="simple">10.1093/nar/gkv1119</ext-link></comment> <object-id pub-id-type="pmid">26503254</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref061">
<label>61</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Hastie</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Tibshirani</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Wainwright</surname> <given-names>M</given-names></name>. <source>Statistical learning with sparsity: the lasso and generalizations</source>. <publisher-name>CRC press</publisher-name>; <year>2015</year>. Available from: <ext-link ext-link-type="uri" xlink:href="https://web.stanford.edu/~hastie/StatLearnSparsity/" xlink:type="simple">https://web.stanford.edu/~hastie/StatLearnSparsity/</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006745.ref062">
<label>62</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gelman</surname> <given-names>A</given-names></name>. <article-title>Analysis of variance—why it is more important than ever</article-title>. <source>Ann Statist</source>. <year>2005</year>;<volume>33</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>53</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1214/009053604000001048" xlink:type="simple">10.1214/009053604000001048</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref063">
<label>63</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Weyl</surname> <given-names>H</given-names></name>. <chapter-title>Symmetry</chapter-title>. <source>Princeton paperbacks</source>. <publisher-name>Princeton University Press</publisher-name>; <year>1952</year>. Available from: <ext-link ext-link-type="uri" xlink:href="https://books.google.com.au/books?id=T43Cmu_EaZAC" xlink:type="simple">https://books.google.com.au/books?id=T43Cmu_EaZAC</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006745.ref064">
<label>64</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Stiefel</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Fässler</surname> <given-names>A</given-names></name>. <source>Group Theoretical Methods and Their Applications</source>. <publisher-name>Birkhäuser</publisher-name> <publisher-loc>Boston</publisher-loc>; <year>1992</year>. Available from: <ext-link ext-link-type="uri" xlink:href="https://books.google.com.au/books?id=bMKBllvEDTkC" xlink:type="simple">https://books.google.com.au/books?id=bMKBllvEDTkC</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006745.ref065">
<label>65</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Shah</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Chandrasekaran</surname> <given-names>V</given-names></name>. <article-title>Group symmetry and covariance regularization</article-title>. <source>Electron J Statist</source>. <year>2012</year>;<volume>6</volume>:<fpage>1600</fpage>–<lpage>1640</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1214/12-EJS723" xlink:type="simple">10.1214/12-EJS723</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref066">
<label>66</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Olver</surname> <given-names>PJ</given-names></name>. <chapter-title>Classical Invariant Theory</chapter-title>. <source>Classical Invariant Theory</source>. <publisher-name>Cambridge University Press</publisher-name>; <year>1999</year>. Available from: <ext-link ext-link-type="uri" xlink:href="https://books.google.com.au/books?id=1GlHYhNRAqEC" xlink:type="simple">https://books.google.com.au/books?id=1GlHYhNRAqEC</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006745.ref067">
<label>67</label>
<mixed-citation publication-type="other" xlink:type="simple">To show this, let <inline-formula id="pcbi.1006745.e119"><alternatives><graphic id="pcbi.1006745.e119g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e119" xlink:type="simple"/><mml:math display="inline" id="M119"><mml:mi mathvariant="script">A</mml:mi></mml:math></alternatives></inline-formula> be the number of ancestors in the tree, where ancestor refers to any lineal position that has daughters. Let each ancestor be in one of two ‘states’: having its daughter subtrees exchanged or not. For a tree with <italic>G</italic> generations and thus <inline-formula id="pcbi.1006745.e120"><alternatives><graphic id="pcbi.1006745.e120g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e120" xlink:type="simple"/><mml:math display="inline" id="M120"><mml:mrow><mml:mi mathvariant="script">A</mml:mi> <mml:mo>=</mml:mo> <mml:msup><mml:mn>2</mml:mn> <mml:mrow><mml:mi>G</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> ancestors, there are <inline-formula id="pcbi.1006745.e121"><alternatives><graphic id="pcbi.1006745.e121g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e121" xlink:type="simple"/><mml:math display="inline" id="M121"><mml:msup><mml:mn>2</mml:mn> <mml:mi mathvariant="script">A</mml:mi></mml:msup></mml:math></alternatives></inline-formula> unique configurations of all ancestor states that keep the lineage relationships invariant. These configurations form the complete set of elements in the group of order <inline-formula id="pcbi.1006745.e122"><alternatives><graphic id="pcbi.1006745.e122g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e122" xlink:type="simple"/><mml:math display="inline" id="M122"><mml:msup><mml:mn>2</mml:mn> <mml:mi mathvariant="script">A</mml:mi></mml:msup></mml:math></alternatives></inline-formula>. Thus, for a 3-generation tree, <inline-formula id="pcbi.1006745.e123"><alternatives><graphic id="pcbi.1006745.e123g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e123" xlink:type="simple"/><mml:math display="inline" id="M123"><mml:mrow><mml:mi mathvariant="script">A</mml:mi> <mml:mo>=</mml:mo> <mml:mn>3</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> (corresponding to members <monospace>1</monospace>, <monospace>10</monospace>, and <monospace>11</monospace>) and <inline-formula id="pcbi.1006745.e124"><alternatives><graphic id="pcbi.1006745.e124g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e124" xlink:type="simple"/><mml:math display="inline" id="M124"><mml:mrow><mml:mrow><mml:mo>|</mml:mo> <mml:mi mathvariant="script">G</mml:mi> <mml:mo>|</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msup><mml:mn>2</mml:mn> <mml:mn>3</mml:mn></mml:msup> <mml:mo>=</mml:mo> <mml:mn>8</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, where the 8 permutations were shown in Fig 4. For trees with 4 or 5 generations, <inline-formula id="pcbi.1006745.e125"><alternatives><graphic id="pcbi.1006745.e125g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e125" xlink:type="simple"/><mml:math display="inline" id="M125"><mml:mrow><mml:mo>|</mml:mo> <mml:mi mathvariant="script">G</mml:mi> <mml:mo>|</mml:mo> <mml:mo>=</mml:mo> <mml:mn>128</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006745.e126"><alternatives><graphic id="pcbi.1006745.e126g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006745.e126" xlink:type="simple"/><mml:math display="inline" id="M126"><mml:mrow><mml:mo>|</mml:mo> <mml:mi mathvariant="script">G</mml:mi> <mml:mo>|</mml:mo> <mml:mo>=</mml:mo> <mml:mn>32768</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, respectively, and the number of permutations quickly becomes unmanageable.;.</mixed-citation>
</ref>
<ref id="pcbi.1006745.ref068">
<label>68</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Diaconis</surname> <given-names>P</given-names></name>. <chapter-title>Group Representations in Probability and Statistics</chapter-title>. <source>Lecture notes-monograph series</source>. <publisher-name>Institute of Mathematical Statistics</publisher-name>; <year>1988</year>. Available from: <ext-link ext-link-type="uri" xlink:href="https://books.google.com.au/books?id=LKvvAAAAMAAJ" xlink:type="simple">https://books.google.com.au/books?id=LKvvAAAAMAAJ</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006745.ref069">
<label>69</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Soloveychik</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Trushin</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Wiesel</surname> <given-names>A</given-names></name>. <article-title>Group Symmetric Robust Covariance Estimation</article-title>. <source>IEEE Transactions on Signal Processing</source>. <year>2016</year>;<volume>64</volume>(<issue>1</issue>):<fpage>244</fpage>–<lpage>257</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1109/TSP.2015.2486739" xlink:type="simple">10.1109/TSP.2015.2486739</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref070">
<label>70</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tukey</surname> <given-names>JW</given-names></name>. <article-title>Discussion, Emphasizing the Connection between Analysis of Variance and Spectrum Analysis</article-title>. <source>Technometrics</source>. <year>1961</year>;<volume>3</volume>(<issue>2</issue>):<fpage>191</fpage>–<lpage>219</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1080/00401706.1961.10489940" xlink:type="simple">10.1080/00401706.1961.10489940</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref071">
<label>71</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Speed</surname> <given-names>TP</given-names></name>. <article-title>What is an Analysis of Variance?</article-title> <source>Ann Statist</source>. <year>1987</year>;<volume>15</volume>(<issue>3</issue>):<fpage>885</fpage>–<lpage>910</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1214/aos/1176350472" xlink:type="simple">10.1214/aos/1176350472</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref072">
<label>72</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Strang</surname> <given-names>G</given-names></name>. <article-title>Wavelet transforms versus Fourier transforms</article-title>. <source>Bull Amer Math Soc</source>. <year>1993</year>;<volume>28</volume>:<fpage>288</fpage>–<lpage>305</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1090/S0273-0979-1993-00390-2" xlink:type="simple">10.1090/S0273-0979-1993-00390-2</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref073">
<label>73</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dempster</surname> <given-names>AP</given-names></name>, <name name-style="western"><surname>Laird</surname> <given-names>NM</given-names></name>, <name name-style="western"><surname>Rubin</surname> <given-names>DB</given-names></name>. <article-title>Maximum Likelihood from Incomplete Data via the EM Algorithm</article-title>. <source>Journal of the Royal Statistical Society Series B (Methodological)</source>. <year>1977</year>;<volume>39</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>38</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/j.2517-6161.1977.tb01600.x" xlink:type="simple">10.1111/j.2517-6161.1977.tb01600.x</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref074">
<label>74</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Speed</surname> <given-names>TP</given-names></name>, <name name-style="western"><surname>Kiiveri</surname> <given-names>HT</given-names></name>. <article-title>Gaussian Markov Distributions over Finite Graphs</article-title>. <source>Ann Statist</source>. <year>1986</year>;<volume>14</volume>(<issue>1</issue>):<fpage>138</fpage>–<lpage>150</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1214/aos/1176349846" xlink:type="simple">10.1214/aos/1176349846</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref075">
<label>75</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Lauritzen</surname> <given-names>SL</given-names></name>. <chapter-title>Graphical Models</chapter-title>. <source>Oxford Statistical Science Series</source>. <publisher-name>Clarendon Press</publisher-name>; <year>1996</year>. Available from: <ext-link ext-link-type="uri" xlink:href="https://books.google.com.au/books?id=mGQWkx4guhAC" xlink:type="simple">https://books.google.com.au/books?id=mGQWkx4guhAC</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006745.ref076">
<label>76</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wermuth</surname> <given-names>N</given-names></name>. <article-title>Linear Recursive Equations, Covariance Selection, and Path Analysis</article-title>. <source>Journal of the American Statistical Association</source>. <year>1980</year>;<volume>75</volume>(<issue>372</issue>):<fpage>963</fpage>–<lpage>972</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1080/01621459.1980.10477580" xlink:type="simple">10.1080/01621459.1980.10477580</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref077">
<label>77</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kiiveri</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Speed</surname> <given-names>TP</given-names></name>, <name name-style="western"><surname>Carlin</surname> <given-names>JB</given-names></name>. <article-title>Recursive causal models</article-title>. <source>Journal of the Australian Mathematical Society Series A Pure Mathematics and Statistics</source>. <year>1984</year>;<volume>36</volume>(<issue>1</issue>):<fpage>30</fpage>–<lpage>52</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006745.ref078">
<label>78</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Pearl</surname> <given-names>J</given-names></name>. <chapter-title>Probabilistic Reasoning in Intelligent Systems: Networks of Plausible Inference</chapter-title>. <source>Morgan Kaufmann series in representation and reasoning</source>. <publisher-name>Morgan Kaufmann Publishers</publisher-name>; <year>1988</year>. Available from: <ext-link ext-link-type="uri" xlink:href="https://books.google.com.au/books?id=Db4eHj9ZL4UC" xlink:type="simple">https://books.google.com.au/books?id=Db4eHj9ZL4UC</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006745.ref079">
<label>79</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Macaulay</surname> <given-names>IC</given-names></name>, <name name-style="western"><surname>Svensson</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Labalette</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Ferreira</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Hamey</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Voet</surname> <given-names>T</given-names></name>, <etal>et al</etal>. <article-title>Single-Cell RNA-Sequencing Reveals a Continuous Spectrum of Differentiation in Hematopoietic Cells</article-title>. <source>Cell Reports</source>. <year>2016</year>;<volume>14</volume>(<issue>4</issue>):<fpage>966</fpage>–<lpage>977</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.celrep.2015.12.082" xlink:type="simple">10.1016/j.celrep.2015.12.082</ext-link></comment> <object-id pub-id-type="pmid">26804912</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref080">
<label>80</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Priess</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>Thomson</surname> <given-names>JN</given-names></name>. <article-title>Cellular interactions in early C. elegans embryos</article-title>. <source>Cell</source>. <year>1987</year>;<volume>48</volume>(<issue>2</issue>):<fpage>241</fpage>–<lpage>250</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/0092-8674(87)90427-2" xlink:type="simple">https://doi.org/10.1016/0092-8674(87)90427-2</ext-link> <object-id pub-id-type="pmid">3802194</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006745.ref081">
<label>81</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Mango</surname> <given-names>SE</given-names></name>. <chapter-title>The <italic>C. elegans</italic> pharynx: a model for organogenesis</chapter-title>. In: <source>Wormbook</source>. <publisher-name>The C. elegans Research Community</publisher-name>; <year>2007</year>. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.wormbook.org" xlink:type="simple">http://www.wormbook.org</ext-link>.</mixed-citation>
</ref>
</ref-list>
</back>
</article>