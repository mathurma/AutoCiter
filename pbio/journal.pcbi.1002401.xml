<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN">
  <front>
    <journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher>
        <publisher-name>Public Library of Science</publisher-name>
        <publisher-loc>San Francisco, USA</publisher-loc>
      </publisher></journal-meta>
    <article-meta><article-id pub-id-type="publisher-id">PCOMPBIOL-D-11-00891</article-id><article-id pub-id-type="doi">10.1371/journal.pcbi.1002401</article-id><article-categories>
        <subj-group subj-group-type="heading">
          <subject>Research Article</subject>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Biology</subject>
          <subj-group>
            <subject>Computational biology</subject>
          </subj-group>
          <subj-group>
            <subject>Neuroscience</subject>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Probability theory</subject>
          </subj-group>
          <subj-group>
            <subject>Statistics</subject>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline">
          <subject>Computational Biology</subject>
          <subject>Neuroscience</subject>
          <subject>Mathematics</subject>
        </subj-group>
      </article-categories><title-group><article-title>A Self-Organizing State-Space-Model Approach for Parameter Estimation in Hodgkin-Huxley-Type Models of Single Neurons</article-title><alt-title alt-title-type="running-head">Parameter Estimation in Hodgkin-Huxley-Type Models</alt-title></title-group><contrib-group>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Vavoulis</surname>
            <given-names>Dimitrios V.</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
          <xref ref-type="corresp" rid="cor1">
            <sup>*</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Straub</surname>
            <given-names>Volko A.</given-names>
          </name>
          <xref ref-type="aff" rid="aff2">
            <sup>2</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Aston</surname>
            <given-names>John A. D.</given-names>
          </name>
          <xref ref-type="aff" rid="aff3">
            <sup>3</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Feng</surname>
            <given-names>Jianfeng</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
          <xref ref-type="aff" rid="aff4">
            <sup>4</sup>
          </xref>
          <xref ref-type="corresp" rid="cor1">
            <sup>*</sup>
          </xref>
        </contrib>
      </contrib-group><aff id="aff1"><label>1</label><addr-line>Department of Computer Science, University of Warwick, Coventry, United Kingdom</addr-line> </aff><aff id="aff2"><label>2</label><addr-line>Department of Cell Physiology and Pharmacology, University of Leicester, Leicester, United Kingdom</addr-line> </aff><aff id="aff3"><label>3</label><addr-line>Department of Statistics, University of Warwick, Coventry, United Kingdom</addr-line> </aff><aff id="aff4"><label>4</label><addr-line>Centre for Computational Systems Biology, Fudan University, Shanghai, PR China</addr-line> </aff><contrib-group>
        <contrib contrib-type="editor" xlink:type="simple">
          <name name-style="western">
            <surname>Graham</surname>
            <given-names>Lyle J.</given-names>
          </name>
          <role>Editor</role>
          <xref ref-type="aff" rid="edit1"/>
        </contrib>
      </contrib-group><aff id="edit1">Université Paris Descartes, Centre National de la Recherche Scientifique, France</aff><author-notes>
        <corresp id="cor1">* E-mail: <email xlink:type="simple">Dimitris.Vavoulis@dcs.warwick.ac.uk</email> (DVV); <email xlink:type="simple">Jianfeng.Feng@warwick.ac.uk</email> (JF)</corresp>
        <fn fn-type="con">
          <p>Conceived and designed the experiments: DVV VAS JADA JF. Performed the experiments: DVV VAS. Analyzed the data: DVV VAS. Contributed reagents/materials/analysis tools: DVV VAS JF. Wrote the paper: DVV VAS JADA JF.</p>
        </fn>
      <fn fn-type="conflict">
        <p>The authors have declared that no competing interests exist.</p>
      </fn></author-notes><pub-date pub-type="collection">
        <month>3</month>
        <year>2012</year>
      </pub-date><pub-date pub-type="epub">
        <day>1</day>
        <month>3</month>
        
        <year>2012</year>
      </pub-date><volume>8</volume><issue>3</issue><elocation-id>e1002401</elocation-id><history>
        <date date-type="received">
          <day>20</day>
          <month>6</month>
          <year>2011</year>
        </date>
        <date date-type="accepted">
          <day>12</day>
          <month>1</month>
          <year>2012</year>
        </date>
      </history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2012</copyright-year><copyright-holder>Vavoulis et al</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract>
        <p>Traditional approaches to the problem of parameter estimation in biophysical models of neurons and neural networks usually adopt a global search algorithm (for example, an evolutionary algorithm), often in combination with a local search method (such as gradient descent) in order to minimize the value of a cost function, which measures the discrepancy between various features of the available experimental data and model output. In this study, we approach the problem of parameter estimation in conductance-based models of single neurons from a different perspective. By adopting a hidden-dynamical-systems formalism, we expressed parameter estimation as an inference problem in these systems, which can then be tackled using a range of well-established statistical inference methods. The particular method we used was Kitagawa's self-organizing state-space model, which was applied on a number of Hodgkin-Huxley-type models using simulated or actual electrophysiological data. We showed that the algorithm can be used to estimate a large number of parameters, including maximal conductances, reversal potentials, kinetics of ionic currents, measurement and intrinsic noise, based on low-dimensional experimental data and sufficiently informative priors in the form of pre-defined constraints imposed on model parameters. The algorithm remained operational even when very noisy experimental data were used. Importantly, by combining the self-organizing state-space model with an adaptive sampling algorithm akin to the Covariance Matrix Adaptation Evolution Strategy, we achieved a significant reduction in the variance of parameter estimates. The algorithm did not require the explicit formulation of a cost function and it was straightforward to apply on compartmental models and multiple data sets. Overall, the proposed methodology is particularly suitable for resolving high-dimensional inference problems based on noisy electrophysiological data and, therefore, a potentially useful tool in the construction of biophysical neuron models.</p>
      </abstract><abstract abstract-type="summary">
        <title>Author Summary</title>
        <p>Parameter estimation is a problem of central importance and, perhaps, the most laborious task in biophysical modeling of neurons and neural networks. An emerging trend is to treat parameter estimation in this context as yet another statistical inference problem, which can be tackled using well-established methods from Computational Statistics. Inspired by these recent advances, we adopted a self-organizing state-space-model approach augmented with an adaptive sampling algorithm akin to the Covariance Matrix Adaptation Evolution Strategy in order to estimate a large number of parameters in a number of Hodgkin-Huxley-type models of single neurons. Parameter estimation was based on noisy electrophysiological data and involved the maximal conductances, reversal potentials, levels of noise and, unlike most mainstream work, the kinetics of ionic currents in the examined models. Our main conclusion was that parameters in complex, conductance-based neuron models can be inferred using the aforementioned methodology, if sufficiently informative priors regarding the unknown model parameters are available. Importantly, the use of an adaptive algorithm for sampling new parameter vectors significantly reduced the variance of parameter estimates. Flexibility and scalability are additional advantages of the proposed method, which is particularly suited to resolve high-dimensional inference problems.</p>
      </abstract><funding-group><funding-statement>This study was supported by the Future and Emerging Technologies (FET) European Commission program BION (number 213219). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts>
        <page-count count="1"/>
      </counts></article-meta>
  </front>
  <body>
    <sec id="s1">
      <title>Introduction</title>
      <p>Among several tools at the disposal of neuroscientists today, data-driven computational models have come to hold an eminent position for studying the electrical activity of single neurons and the significance of this activity for the operation of neural circuits <xref ref-type="bibr" rid="pcbi.1002401-Herz1">[1]</xref>–<xref ref-type="bibr" rid="pcbi.1002401-Marder1">[4]</xref>. Typically, these models depend on a large number of parameters, such as the maximal conductances and kinetics of gated ion channels. Estimating appropriate values for these parameters based on the available experimental data is an issue of central importance and, at the same time, the most laborious task in single-neuron and circuit modeling.</p>
      <p>Ideally, all unknown parameters in a model should be determined directly from experimental data analysis. For example, based on a set of voltage-clamp recordings, the type, kinetics and maximal conductances of the voltage-gated ionic currents flowing through the cell membrane could be determined <xref ref-type="bibr" rid="pcbi.1002401-Willms1">[5]</xref> and, then, combined in a conductance-based model, which replicates the activity of the biological neuron of interest under current-clamp conditions with sufficient accuracy. Unfortunately, this is not always possible, especially for complex compartmental models, which contain a large number of ionic currents.</p>
      <p>A first problem arises from the fact that not all parameters can be estimated within an acceptable error margin, especially for small currents and large levels of noise. A second problem arises from the practice of estimating different sets of parameters based on data collected from different neurons of a particular type, instead of estimating all unknown parameters using data collected from a single neuron. Different neurons of the same type may have quite different compositions of ionic currents <xref ref-type="bibr" rid="pcbi.1002401-Goldman1">[6]</xref>–<xref ref-type="bibr" rid="pcbi.1002401-Prinz2">[9]</xref> (but, see also <xref ref-type="bibr" rid="pcbi.1002401-Nowotny1">[10]</xref>). This implies that combining ionic currents measured from different neurons in the same model or even using the average of several parameters calculated over a population of neurons of the same type will not necessarily result in a model that expresses the experimentally recorded patterns of electrical activity under current-clamp conditions. Usually, only some parameters are well characterized, while others are difficult or impossible to measure directly. Thus, most modeling studies rely on a mixture of experimentally determined parameters and estimates of the remaining unknown ones using automated optimization methodology (see, for example, <xref ref-type="bibr" rid="pcbi.1002401-Lepora1">[11]</xref>–<xref ref-type="bibr" rid="pcbi.1002401-Vanier1">[22]</xref>). Typically, these methods require the construction of a cost function (for measuring the discrepancy between various features of the experimental data and the output of the model) and an automated parameter selection method, which iteratively generates new sets of parameters, such that the value of the cost function progressively decreases during the course of the simulation (see <xref ref-type="bibr" rid="pcbi.1002401-VanGeit1">[23]</xref> for a review). Popular choices of such methods are evolutionary algorithms, simulated annealing and gradient descent methods. Often, a global search method (i.e. an evolutionary algorithm) is combined with local search (gradient descent) for locating multiple minima of the cost function with high precision. Since a poorly designed cost function (for example, one that merely matches model and experimental membrane potential trajectories) can seriously impede optimization, the construction of this function often requires particular attention (see, for example, <xref ref-type="bibr" rid="pcbi.1002401-LeMasson1">[24]</xref>). Nevertheless, these computationally intensive methodologies have gained much popularity, particularly due to the availability of powerful personal computers at consumer-level prices and the development of specialized optimization software (e.g. <xref ref-type="bibr" rid="pcbi.1002401-VanGeit2">[25]</xref>).</p>
      <p>Alternative approaches also exist as, for example, methods based on the concept of synchronization between model dynamics and experimental data <xref ref-type="bibr" rid="pcbi.1002401-Tokuda1">[26]</xref>. An emerging trend in parameter estimation methodologies for models in Computational Biology is to recast parameter estimation as an inference problem in hidden dynamical systems and then adopt standard Computational Statistics techniques to resolve it <xref ref-type="bibr" rid="pcbi.1002401-Lillacci1">[27]</xref>, <xref ref-type="bibr" rid="pcbi.1002401-Huys1">[28]</xref>. For example, a particular study following this approach makes use of Sequential Monte Carlo methods (<italic>particle filters</italic>) embedded in an Expectation Maximization (EM) framework <xref ref-type="bibr" rid="pcbi.1002401-Huys1">[28]</xref>. Given a set of electrophysiological recordings and a set of dynamic equations that govern the evolution of the hidden states, at each iteration of the algorithm the expected joint log-likelihood of the hidden states and the data is approximated using particle filters (Expectation Step). At a second stage during each iteration (Maximization Step), the log-likelihood is locally maximized with respect to the unknown parameters. The advantage of these methods, beyond the fact that they recast the estimation problem in a well-established statistical framework, is that they can handle various types of noisy biophysical data made available by recent advances in voltage and calcium imaging techniques.</p>
      <p>Inspired by this emerging approach, we present a method for estimating a large number of parameters in Hodgkin-Huxley-type models of single neurons. The method is a version of Kitagawa's self-organizing state-space model <xref ref-type="bibr" rid="pcbi.1002401-Kitagawa1">[29]</xref> combined with an adaptive algorithm for selecting new sets of model parameters. The adaptive algorithm we have used is akin to the Covariance Matrix Adaption (CMA) Evolution Strategy <xref ref-type="bibr" rid="pcbi.1002401-Igel1">[30]</xref>, but other methods (e.g. Differential Evolution as described in <xref ref-type="bibr" rid="pcbi.1002401-Price1">[31]</xref>) may be used instead. We demonstrate the applicability of the algorithm on a range of models using simulated or actual electrophysiological data. We show that the algorithm can be used successfully with very noisy data and it is straightforward to apply on compartmental models and multiple datasets. An interesting result from this study is that by using the self-organizing state-space model in combination with a CMA-like algorithm, we managed to achieve a dramatic reduction in the variance of the inferred parameter values. Our main conclusion is that a large number of parameters in a conductance-based model of a neuron (including maximal conductances, reversal potentials and kinetics of gated ionic currents) can be inferred from low-dimensional experimental data (typically, a single or a few recordings of membrane potential activity) using the algorithm, if sufficiently informative priors are available, for example in the form of well-defined ranges of valid parameter values.</p>
    </sec>
    <sec id="s2" sec-type="methods">
      <title>Methods</title>
      <sec id="s2a">
        <title>Modeling Framework</title>
        <p>We begin by presenting the current conservation equation that describes the time evolution of the membrane potential for a single-compartment model neuron:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e001" xlink:type="simple"/><label>(1)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e002" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e003" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e004" xlink:type="simple"/></inline-formula> are all functions of time. In the above equation, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e005" xlink:type="simple"/></inline-formula> is the membrane capacitance, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e006" xlink:type="simple"/></inline-formula> is the membrane potential, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e007" xlink:type="simple"/></inline-formula> is the externally applied (injected) current, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e008" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e009" xlink:type="simple"/></inline-formula> are the maximal conductance and reversal potential of the leakage current, respectively, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e010" xlink:type="simple"/></inline-formula> is the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e011" xlink:type="simple"/></inline-formula> transmembrane ionic current. A voltage-gated current <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e012" xlink:type="simple"/></inline-formula> can be modeled according to the Hodgkin-Huxley formalism, as follows:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e013" xlink:type="simple"/><label>(2)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e014" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e015" xlink:type="simple"/></inline-formula> are both functions of time. In the above expression, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e016" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e017" xlink:type="simple"/></inline-formula> are the maximal conductance and reversal potential of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e018" xlink:type="simple"/></inline-formula> ionic current, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e019" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e020" xlink:type="simple"/></inline-formula> are dynamic gating variables, which model the voltage-dependent activation and inactivation of the current, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e021" xlink:type="simple"/></inline-formula> is a small positive integer power (usually, not taking values larger than 4). The product <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e022" xlink:type="simple"/></inline-formula> is the proportion of open channels in the membrane that carry the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e023" xlink:type="simple"/></inline-formula> current. The gating variables <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e024" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e025" xlink:type="simple"/></inline-formula> obey first-order relaxation kinetics, as shown below:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e026" xlink:type="simple"/><label>(3)</label></disp-formula>where the steady states (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e027" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e028" xlink:type="simple"/></inline-formula>) and relaxation times (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e029" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e030" xlink:type="simple"/></inline-formula>) are all functions of voltage.</p>
        <p>Using vector notation, we can write the above system of Ordinary Differential Equations (ODEs) in more concise form:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e031" xlink:type="simple"/><label>(4)</label></disp-formula>where the state vector <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e032" xlink:type="simple"/></inline-formula> is composed of the time-evolving state variables <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e033" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e034" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e035" xlink:type="simple"/></inline-formula> and the vector-valued function <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e036" xlink:type="simple"/></inline-formula>, which describes the evolution of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e037" xlink:type="simple"/></inline-formula> in time, is formed by the right-hand sides of Eqs. 1 and 3. Notice that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e038" xlink:type="simple"/></inline-formula> also depends on a parameter vector <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e039" xlink:type="simple"/></inline-formula>, which for now is dropped from Eq. 4 for notational clarity. Components of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e040" xlink:type="simple"/></inline-formula> are the maximal conductances <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e041" xlink:type="simple"/></inline-formula>, the reversal potentials <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e042" xlink:type="simple"/></inline-formula> and the various parameters that control the voltage-dependence of the steady states and relaxation times in Eq. 3.</p>
        <p>The above deterministic model does not capture the inherent variability in the electrical activity of neurons, but rather some average behavior of intrinsically stochastic events. In general, this variability originates from various sources, such as the random opening and shutting of transmembrane ion channels or the random bombardment of the neuron with external (e.g. synaptic) stimuli <xref ref-type="bibr" rid="pcbi.1002401-Faisal1">[32]</xref>. Here, we model the inherent variability in single-neuron activity by augmenting Eq. 4 with a noisy term and re-writing as follows:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e043" xlink:type="simple"/><label>(5)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e044" xlink:type="simple"/></inline-formula> is a covariance matrix and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e045" xlink:type="simple"/></inline-formula> is a standard Wiener process over the state space of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e046" xlink:type="simple"/></inline-formula>. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e047" xlink:type="simple"/></inline-formula> may be a diagonal matrix of variances (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e048" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e049" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e050" xlink:type="simple"/></inline-formula>) corresponding to each component of the state vector.</p>
        <p>Typically, we assume that the above model is coupled to a measurement “device”, which permits indirect observations of the hidden state <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e051" xlink:type="simple"/></inline-formula>:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e052" xlink:type="simple"/><label>(6)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e053" xlink:type="simple"/></inline-formula> is an observation noise vector. In the simplest case, the vector of observations <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e054" xlink:type="simple"/></inline-formula> is one-dimensional and it may consist of noisy measurements of the membrane potential:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e055" xlink:type="simple"/><label>(7)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e056" xlink:type="simple"/></inline-formula> is the standard deviation of the observation noise and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e057" xlink:type="simple"/></inline-formula> a random number sampled from a Gaussian distribution with zero mean and standard deviation equal to unity. More complicated non-linear, non-Gaussian observation functions may be used when, for example, the measurements are recordings of the intracellular calcium concentration, simultaneous recordings of the membrane potential and the intracellular calcium concentration or simultaneous recordings of the membrane potential from multiple sites (e.g. soma and dendrites) of a neuron.</p>
        <p>Assuming that time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e058" xlink:type="simple"/></inline-formula> is partitioned in a very large number <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e059" xlink:type="simple"/></inline-formula> of time steps <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e060" xlink:type="simple"/></inline-formula>, such that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e061" xlink:type="simple"/></inline-formula> and the corresponding states are <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e062" xlink:type="simple"/></inline-formula>, we can approximate the solution to Eq. 5 using the following difference equation:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e063" xlink:type="simple"/><label>(8)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e064" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e065" xlink:type="simple"/></inline-formula> is a random vector with components sampled from a normal distribution with zero mean and unit variance. The above expression implements a simple rule for computing the membrane potential, activation and inactivation variables at each point <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e066" xlink:type="simple"/></inline-formula> of the discretized time based on information at the previous time point <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e067" xlink:type="simple"/></inline-formula> and it can be considered as a specific instantiation of the Euler-Maruyama method for the numerical solution of Stochastic Differential Equations <xref ref-type="bibr" rid="pcbi.1002401-Kloeden1">[33]</xref>.</p>
        <p>Then, the observation model becomes:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e068" xlink:type="simple"/><label>(9)</label></disp-formula>In general, measurements do not take place at every point <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e069" xlink:type="simple"/></inline-formula> of the discretized time, but rather at intervals of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e070" xlink:type="simple"/></inline-formula> time steps (depending on the resolution of the measurement device), thus generating a total of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e071" xlink:type="simple"/></inline-formula> measurements. For simplicity in the above description, we have assumed that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e072" xlink:type="simple"/></inline-formula>. However, all the models we consider in the <xref ref-type="sec" rid="s3">Results</xref> section assume <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e073" xlink:type="simple"/></inline-formula>.</p>
        <p>In terms of probability density functions, the non-linear state-space model defined by Eqs. 8 and 9 (known as the <italic>dynamics model</italic>) and the <italic>observation model</italic>, respectively) can be written as:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e074" xlink:type="simple"/><label>(10)</label></disp-formula><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e075" xlink:type="simple"/><label>(11)</label></disp-formula>where the initial state <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e076" xlink:type="simple"/></inline-formula> is distributed according to a prior density <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e077" xlink:type="simple"/></inline-formula>. The above formulas are known as the <italic>state transition</italic> and <italic>observation</italic> densities, respectively <xref ref-type="bibr" rid="pcbi.1002401-Cappe1">[34]</xref>.</p>
      </sec>
      <sec id="s2b">
        <title>Simulation-Based Filtering and Smoothing</title>
        <p>In many inference problems involving state-space models, a primary concern is the sequential estimation of the following two conditional probability densities <xref ref-type="bibr" rid="pcbi.1002401-Kitagawa1">[29]</xref>: (a) <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e078" xlink:type="simple"/></inline-formula> and (b) <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e079" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e080" xlink:type="simple"/></inline-formula>, i.e. the set of observations (for example, a sequence of measurements of the membrane potential) up to the time point <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e081" xlink:type="simple"/></inline-formula>. Density (a), known as the <italic>filter</italic> density, models the distribution of state <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e082" xlink:type="simple"/></inline-formula> given all observations up to and including the time point <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e083" xlink:type="simple"/></inline-formula>, while density (b), known as the <italic>smoother</italic> density, models the distribution of state <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e084" xlink:type="simple"/></inline-formula> given the whole set of observations up to the final time point <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e085" xlink:type="simple"/></inline-formula>.</p>
        <p>In principle, the filter density can be estimated recursively at each time point <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e086" xlink:type="simple"/></inline-formula> using Bayes' rule appropriately <xref ref-type="bibr" rid="pcbi.1002401-Kitagawa1">[29]</xref>:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e087" xlink:type="simple"/><label>(12)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e088" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e089" xlink:type="simple"/></inline-formula> are the state transition and observation densities, respectively, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e090" xlink:type="simple"/></inline-formula> is the filter density at the previous time step <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e091" xlink:type="simple"/></inline-formula>.</p>
        <p>Then, the smoother density can be obtained by using the following general recursive formula:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e092" xlink:type="simple"/><label>(13)</label></disp-formula>which evolves backwards in time and makes use of the pre-calculated filter, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e093" xlink:type="simple"/></inline-formula>. Given either of the above posterior densities, we can compute the expectation of any useful function of the hidden model state as:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e094" xlink:type="simple"/><label>(14)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e095" xlink:type="simple"/></inline-formula> is either the filter or the smoother density. Common examples of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e096" xlink:type="simple"/></inline-formula> are <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e097" xlink:type="simple"/></inline-formula> itself (giving the mean <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e098" xlink:type="simple"/></inline-formula>) and the squared difference from the mean (giving the covariance of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e099" xlink:type="simple"/></inline-formula>).</p>
        <p>In practice, the computations defined by the above formulas can be performed analytically only for linear Gaussian models using the Kalman smoother/filter and for finite state-space hidden Markov models. For non-linear models, the extended Kalman filter is a popular approach, which however can fail when non-Gaussian or multimodal density functions are involved <xref ref-type="bibr" rid="pcbi.1002401-Cappe1">[34]</xref>. A more generally applicable, albeit computationally more intensive approach, approximates the filter and smoother densities using Sequential Monte Carlo (SMC) methods, also known as <italic>particle filters</italic> <xref ref-type="bibr" rid="pcbi.1002401-Cappe1">[34]</xref>, <xref ref-type="bibr" rid="pcbi.1002401-Doucet1">[35]</xref>. Within the SMC framework, the filter density at each time point is approximated by a large number <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e100" xlink:type="simple"/></inline-formula> of discrete samples or <italic>particles</italic>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e101" xlink:type="simple"/></inline-formula>, and associated non-negative importance weights, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e102" xlink:type="simple"/></inline-formula>:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e103" xlink:type="simple"/><label>(15)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e104" xlink:type="simple"/></inline-formula> is the Dirac delta function centered at the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e105" xlink:type="simple"/></inline-formula> particle, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e106" xlink:type="simple"/></inline-formula>.</p>
        <p>Given an initial set of particles sampled from a prior distribution and their associated weights, a simple update rule involves the following steps <xref ref-type="bibr" rid="pcbi.1002401-Kitagawa1">[29]</xref>:</p>
        <p><bold>Step 1:</bold> For <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e107" xlink:type="simple"/></inline-formula>, sample a new set of particles from the <italic>proposal transition density function</italic>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e108" xlink:type="simple"/></inline-formula>. In general, one has enormous freedom in choosing the form of this density and even condition it on future observations, if these are available (see, for example, <xref ref-type="bibr" rid="pcbi.1002401-vanLeeuwen1">[36]</xref>). However, the simplest (and a quite common) choice is to use the transition density as the proposal, i.e. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e109" xlink:type="simple"/></inline-formula>. This is the approach we follow in this paper.</p>
        <p><bold>Step 2:</bold> For each new particle <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e110" xlink:type="simple"/></inline-formula>, evaluate the importance weight:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e111" xlink:type="simple"/><label>(16)</label></disp-formula>Notice that when <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e112" xlink:type="simple"/></inline-formula>, then the computation of the importance weights is significantly simplified, i.e. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e113" xlink:type="simple"/></inline-formula>.</p>
        <p><bold>Step 3:</bold> Normalize the computed importance weights, by dividing each of them with their sum, i.e.<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e114" xlink:type="simple"/><label>(17)</label></disp-formula>The derived set of weighted samples <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e115" xlink:type="simple"/></inline-formula> is considered an approximation of the filter density <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e116" xlink:type="simple"/></inline-formula>.</p>
        <p>In practice, the above algorithm is augmented with a re-sampling step (preceding Step 1), during which <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e117" xlink:type="simple"/></inline-formula> particles are sampled from the set of weighted particles computed at the previous iteration with probabilities proportional to their weights <xref ref-type="bibr" rid="pcbi.1002401-Cappe1">[34]</xref>, <xref ref-type="bibr" rid="pcbi.1002401-Doucet1">[35]</xref>. All re-sampled particles are given weights equal to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e118" xlink:type="simple"/></inline-formula>. This step results in discarding particles with small weights and multiplying particles with large weights, thus compensating for the gradual degeneration of the particle filter i.e. the situation where all particles but one have weights equal to zero. For performance reasons, the resampling step may be applied only when the effective number of particles drops below a threshold value, e.g. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e119" xlink:type="simple"/></inline-formula>. An estimation of the effective number of particles is given by<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e120" xlink:type="simple"/><label>(18)</label></disp-formula></p>
        <p>The above filter can be extended to a fixed-lag smoother, if instead of resampling just the particles at the current time step, we store and resample all particles up to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e121" xlink:type="simple"/></inline-formula> time steps before the current time step, i.e. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e122" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pcbi.1002401-Kitagawa1">[29]</xref>. The resampled particles can be considered a realization from a posterior density <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e123" xlink:type="simple"/></inline-formula>, which is an approximation of the smoother density <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e124" xlink:type="simple"/></inline-formula>, for sufficiently large values of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e125" xlink:type="simple"/></inline-formula>.</p>
        <p>Within this Monte Carlo framework, the expectation in Eq. 14 can be approximated as:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e126" xlink:type="simple"/><label>(19)</label></disp-formula>for a large number <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e127" xlink:type="simple"/></inline-formula> of weighted samples.</p>
      </sec>
      <sec id="s2c">
        <title>Simultaneous Estimation of Hidden States and Parameters</title>
        <p>It is possible to apply the above standard filtering and smoothing techniques to parameter estimation problems involving state-space models. The key idea <xref ref-type="bibr" rid="pcbi.1002401-Kitagawa1">[29]</xref> is to define an extended state vector <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e128" xlink:type="simple"/></inline-formula> by augmenting the state vector <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e129" xlink:type="simple"/></inline-formula> with the model parameters, i.e. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e130" xlink:type="simple"/></inline-formula>. Then, the time evolution of the extended state-space model becomes:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e131" xlink:type="simple"/><label>(20)</label></disp-formula>while the observational model remains unaltered:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e132" xlink:type="simple"/><label>(21)</label></disp-formula>The marginal posterior density of the parameter vector <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e133" xlink:type="simple"/></inline-formula> is given by:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e134" xlink:type="simple"/><label>(22)</label></disp-formula>and, subsequently, the expectation of any function of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e135" xlink:type="simple"/></inline-formula> can be computed as in Eq. 14:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e136" xlink:type="simple"/><label>(23)</label></disp-formula>Furthermore, given a set of particles and associated weights, which approximate the smoother density <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e137" xlink:type="simple"/></inline-formula> as outlined in the previous section, i.e. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e138" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e139" xlink:type="simple"/></inline-formula>, the above expectation can be approximated as:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e140" xlink:type="simple"/><label>(24)</label></disp-formula>for large <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e141" xlink:type="simple"/></inline-formula>.</p>
        <p>Under this formulation, parameter estimation, which is traditionally treated as an optimization problem, is reduced to an integration problem, which can be tackled using filtering and smoothing methodologies for state-space models, a well-studied subject in the field of Computational Statistics.</p>
      </sec>
      <sec id="s2d">
        <title>Connection to Evolutionary Algorithms</title>
        <p>It should be emphasized that although in Eq. 20 the parameter vector <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e142" xlink:type="simple"/></inline-formula> was assumed constant, i.e. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e143" xlink:type="simple"/></inline-formula>, the same methodology applies in the case of parameters that are naturally evolving in time, such as a time-varying externally injected current <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e144" xlink:type="simple"/></inline-formula>. A particularly interesting case arises when an artificial evolution rule is imposed on a parameter vector, which is otherwise constant by definition. Such a rule allows sampling new parameter vectors based on samples at the previous time step, i.e. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e145" xlink:type="simple"/></inline-formula>, and generating a sequence <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e146" xlink:type="simple"/></inline-formula>, which explores the parameter space and, ideally converges in a small optimal subset of it, after a sufficiently large number of iterations. It is at this point that the opportunity to use techniques borrowed from the domain of Evolutionary Algorithms arises. Here, we assume that the artificial evolution of the parameter vector <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e147" xlink:type="simple"/></inline-formula> is governed by a version of the Covariance Matrix Adaptation algorithm <xref ref-type="bibr" rid="pcbi.1002401-Igel1">[30]</xref>, a well-known Evolution Strategy, although the modeler is free to make other choices (e.g. Differential Evolution <xref ref-type="bibr" rid="pcbi.1002401-Price1">[31]</xref>). For the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e148" xlink:type="simple"/></inline-formula> particle, we write:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e149" xlink:type="simple"/><label>(25)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e150" xlink:type="simple"/></inline-formula> is a random vector with elements sampled from a normal distribution with zero mean and unit variance. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e151" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e152" xlink:type="simple"/></inline-formula> are a mean vector and covariance matrix respectively, which are computed as follows:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e153" xlink:type="simple"/><label>(26)</label></disp-formula><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e154" xlink:type="simple"/><label>(27)</label></disp-formula>In the above expressions, a and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e155" xlink:type="simple"/></inline-formula> are small adaptation constants and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e156" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e157" xlink:type="simple"/></inline-formula> are the expectation and covariance of the weighted sample of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e158" xlink:type="simple"/></inline-formula>, respectively. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e159" xlink:type="simple"/></inline-formula> is a scale parameter that evolves according to a log-normal update rule:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e160" xlink:type="simple"/><label>(28)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e161" xlink:type="simple"/></inline-formula> is a small adaptation constant and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e162" xlink:type="simple"/></inline-formula> is a normally distributed random number with zero mean and unit variance.</p>
        <p>According to Eq. 25, the parameter vector <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e163" xlink:type="simple"/></inline-formula> is sampled at each iteration of the algorithm from a multivariate normal distribution, which is centered at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e164" xlink:type="simple"/></inline-formula> and has a covariance matrix equal to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e165" xlink:type="simple"/></inline-formula>:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e166" xlink:type="simple"/><label>(29)</label></disp-formula>Both <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e167" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e168" xlink:type="simple"/></inline-formula> are slowly adapting to the sample mean <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e169" xlink:type="simple"/></inline-formula> and covariance <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e170" xlink:type="simple"/></inline-formula>, with an adaptation rate determined by the constants <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e171" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e172" xlink:type="simple"/></inline-formula>. Notice that by switching off the adaptation process (i.e. by setting <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e173" xlink:type="simple"/></inline-formula>), <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e174" xlink:type="simple"/></inline-formula> evolves according to a multivariate Gaussian distribution, which is centered at the previous parameter vector and has a covariance matrix equal to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e175" xlink:type="simple"/></inline-formula>:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e176" xlink:type="simple"/><label>(30)</label></disp-formula>Therefore, given an initial set of weighted particles <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e177" xlink:type="simple"/></inline-formula> sampled from some prior density function and an initial covariance matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e178" xlink:type="simple"/></inline-formula>, which may be set equal to the identity matrix, the smoothing algorithm presented earlier becomes:</p>
        <p><bold>Step 1a:</bold> Compute the expectation <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e179" xlink:type="simple"/></inline-formula> and covariance <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e180" xlink:type="simple"/></inline-formula> of the weighted sample of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e181" xlink:type="simple"/></inline-formula></p>
        <p><bold>Step 1b:</bold> For <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e182" xlink:type="simple"/></inline-formula>, compute the scale factor <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e183" xlink:type="simple"/></inline-formula> according to Eq. 28. Notice that this scale factor is now part of the extended state <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e184" xlink:type="simple"/></inline-formula> for each particle</p>
        <p><bold>Step 1c:</bold> For <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e185" xlink:type="simple"/></inline-formula>, compute the mean vector <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e186" xlink:type="simple"/></inline-formula>, as shown in Eq. 26</p>
        <p><bold>Step 1d:</bold> Compute the covariance matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e187" xlink:type="simple"/></inline-formula>, as shown in Eq. 27</p>
        <p><bold>Step 1e:</bold> For <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e188" xlink:type="simple"/></inline-formula>, sample <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e189" xlink:type="simple"/></inline-formula>, as shown in Eq. 25</p>
        <p><bold>Step 1f:</bold> For <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e190" xlink:type="simple"/></inline-formula>, sample a new set of state vectors from the proposal density <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e191" xlink:type="simple"/></inline-formula>, thus completing sampling the extended vectors <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e192" xlink:type="simple"/></inline-formula>. Notice that the proposal density <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e193" xlink:type="simple"/></inline-formula> is conditioned on the updated parameter vector <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e194" xlink:type="simple"/></inline-formula>.</p>
        <p><bold>Step 2–3:</bold> Execute steps 2 and 3 as described previously</p>
        <p>Notice that in the algorithm outlined above, the order in which the components of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e195" xlink:type="simple"/></inline-formula> are sampled is important. First, we sample the scaling factor <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e196" xlink:type="simple"/></inline-formula>. Then, we sample the parameter vector <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e197" xlink:type="simple"/></inline-formula> given the updated <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e198" xlink:type="simple"/></inline-formula>. Finally, we sample the state vector <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e199" xlink:type="simple"/></inline-formula> from a proposal, which is conditioned on the updated parameter vector <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e200" xlink:type="simple"/></inline-formula>. When resampling occurs, the state vectors <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e201" xlink:type="simple"/></inline-formula> with large importance weights are selected and multiplied with high probability along with their associated parameter vectors and scaling factors, thus resulting in a gradual self-adaptation process. This self-adaptation mechanism is very common in the Evolution Strategies literature.</p>
      </sec>
      <sec id="s2e">
        <title>Implementation</title>
        <p>The algorithm described in the previous section was implemented in MATLAB and C (source code available as Supplementary Material; unmaintained FORTRAN code is also available upon request from the first author) and tested on parameter inference problems using simulated or actual electrophysiological data and a number of Hodgkin-Huxley-type models: (a) a single-compartment model (derived from the classic Hodgkin-Huxley model of neural excitability) containing a leakage, transient sodium and delayed rectifier potassium current, (b) a two-compartment model of a cat spinal motoneuron <xref ref-type="bibr" rid="pcbi.1002401-Booth1">[37]</xref> and (c) a model of a B4 motoneuron in the Central Nervous System of the pond snail <italic>Lymnaea stagnalis</italic> <xref ref-type="bibr" rid="pcbi.1002401-Straub1">[38]</xref>, which was developed as part of this study. Each of these models is described in detail in the <xref ref-type="sec" rid="s3">Results</xref> section. Models (a) and (b) were used for generating noisy voltage traces at a sampling rate of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e202" xlink:type="simple"/></inline-formula> (one sample every <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e203" xlink:type="simple"/></inline-formula>). The simulated data was subsequently used as input to the algorithm in order to estimate a large number of parameters; typically, maximal conductances of ionic currents, reversal potentials, the parameters governing the activation and inactivation kinetics of ionic currents, as well as the levels of intrinsic and observation noise. Estimated parameter values were subsequently compared against the true parameter values in the model. The MATLAB environment was used for visualization and analysis of simulation results. For the estimation of the unknown parameters in model (c), actual electrophysiological data were used, as described in the next section.</p>
        <p>Prior information was incorporated in the smoother by assuming that parameter values were not allowed to exceed well-defined upper or lower limits (see <xref ref-type="table" rid="pcbi-1002401-t001">Tables 1</xref>, <xref ref-type="table" rid="pcbi-1002401-t002">2</xref> and <xref ref-type="table" rid="pcbi-1002401-t003">3</xref>). For example, maximal conductances never received negative values, while time constants were always larger than zero. At the beginning of each simulation, the initial population of particles was uniformly sampled from within the acceptable range of parameter values and, during each simulation, parameters were forced to remain within their pre-defined limits.</p>
        <table-wrap id="pcbi-1002401-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1002401.t001</object-id><label>Table 1</label><caption>
            <title>True and estimated values and prior intervals used during smoothing for all parameters in the single-compartment conductance-based model.</title>
          </caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1002401-t001-1" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.t001" xlink:type="simple"/><table>
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" colspan="1" rowspan="1">#</td>
                <td align="left" colspan="1" rowspan="1">Parameter</td>
                <td align="left" colspan="1" rowspan="1">Unit</td>
                <td align="left" colspan="1" rowspan="1">True Value</td>
                <td align="left" colspan="1" rowspan="1">Estimated Value<xref ref-type="table-fn" rid="nt101">1</xref></td>
                <td align="left" colspan="1" rowspan="1">Lower Bound</td>
                <td align="left" colspan="1" rowspan="1">Upper Bound</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" colspan="1" rowspan="1">1</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e204" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e205" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e206" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e207" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e208" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e209" xlink:type="simple"/></inline-formula>
                </td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">2</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e210" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e211" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e212" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e213" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e214" xlink:type="simple"/></inline-formula>1</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e215" xlink:type="simple"/></inline-formula>
                </td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">3</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e216" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e217" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e218" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e219" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e220" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e221" xlink:type="simple"/></inline-formula>
                </td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">4</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e222" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e223" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e224" xlink:type="simple"/></inline-formula>.0</td>
                <td align="left" colspan="1" rowspan="1">34.3</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e225" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e226" xlink:type="simple"/></inline-formula>
                </td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">5</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e227" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e228" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e229" xlink:type="simple"/></inline-formula>.0</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e230" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e231" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e232" xlink:type="simple"/></inline-formula>
                </td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">6</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e233" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e234" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e235" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e236" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e237" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e238" xlink:type="simple"/></inline-formula>
                </td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">7</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e239" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e240" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e241" xlink:type="simple"/></inline-formula>.0</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e242" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e243" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e244" xlink:type="simple"/></inline-formula>
                </td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">8</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e245" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e246" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e247" xlink:type="simple"/></inline-formula>.0</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e248" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e249" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e250" xlink:type="simple"/></inline-formula>
                </td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">9</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e251" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e252" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e253" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e254" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e255" xlink:type="simple"/></inline-formula> <bold>(−45.0)</bold><xref ref-type="table-fn" rid="nt102">2</xref></td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e256" xlink:type="simple"/></inline-formula> <bold>(−35.0)</bold></td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">10</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e257" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e258" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e259" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e260" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e261" xlink:type="simple"/></inline-formula> <bold>(−65.0)</bold></td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e262" xlink:type="simple"/></inline-formula> <bold>(−55.0)</bold></td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">11</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e263" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e264" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e265" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e266" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e267" xlink:type="simple"/></inline-formula> <bold>(−55.0)</bold></td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e268" xlink:type="simple"/></inline-formula> <bold>(−45.0)</bold></td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">12</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e269" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e270" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e271" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e272" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e273" xlink:type="simple"/></inline-formula> <bold>(5.0)</bold></td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e274" xlink:type="simple"/></inline-formula> <bold>(10.0)</bold></td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">13</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e275" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e276" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e277" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e278" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e279" xlink:type="simple"/></inline-formula> <bold>(−10.0)</bold></td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e280" xlink:type="simple"/></inline-formula> <bold>(−5.0)</bold></td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">14</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e281" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e282" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e283" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e284" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e285" xlink:type="simple"/></inline-formula> <bold>(10.0)</bold></td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e286" xlink:type="simple"/></inline-formula> <bold>(20.0)</bold></td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">15</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e287" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e288" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e289" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e290" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e291" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e292" xlink:type="simple"/></inline-formula>
                </td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">16</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e293" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e294" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e295" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e296" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e297" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e298" xlink:type="simple"/></inline-formula>
                </td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">17</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e299" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e300" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e301" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e302" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e303" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e304" xlink:type="simple"/></inline-formula>
                </td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">18</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e305" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e306" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e307" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e308" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e309" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e310" xlink:type="simple"/></inline-formula>
                </td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">19</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e311" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e312" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e313" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e314" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e315" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e316" xlink:type="simple"/></inline-formula>
                </td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">20</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e317" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e318" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e319" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e320" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e321" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e322" xlink:type="simple"/></inline-formula>
                </td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">21</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e323" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">-</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e324" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e325" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e326" xlink:type="simple"/></inline-formula> <bold>(0.0)</bold></td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e327" xlink:type="simple"/></inline-formula> <bold>(0.5)</bold></td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">22</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e328" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">-</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e329" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e330" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e331" xlink:type="simple"/></inline-formula> <bold>(0.0)</bold></td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e332" xlink:type="simple"/></inline-formula> <bold>(0.5)</bold></td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">23</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e333" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">-</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e334" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e335" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e336" xlink:type="simple"/></inline-formula> <bold>(0.5)</bold></td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e337" xlink:type="simple"/></inline-formula> <bold>(1.0)</bold></td>
              </tr>
            </tbody>
          </table></alternatives><table-wrap-foot>
            <fn id="nt101">
              <label>1</label>
              <p>These parameter values were estimated when we used the broad prior intervals (see <xref ref-type="fig" rid="pcbi-1002401-g007">Fig. 7Di</xref>).</p>
            </fn>
            <fn id="nt102">
              <label>2</label>
              <p>Values in bold indicate the narrow prior intervals we used for generating <xref ref-type="fig" rid="pcbi-1002401-g007">Fig. 7Dii</xref> (and Supplementary <xref ref-type="supplementary-material" rid="pcbi.1002401.s003">Fig. S3</xref>).</p>
            </fn>
          </table-wrap-foot></table-wrap>
        <table-wrap id="pcbi-1002401-t002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1002401.t002</object-id><label>Table 2</label><caption>
            <title>True and estimated values and prior intervals used during smoothing for all parameters in the two-compartment conductance-based model.</title>
          </caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1002401-t002-2" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.t002" xlink:type="simple"/><table>
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" colspan="1" rowspan="1">#</td>
                <td align="left" colspan="1" rowspan="1">Parameter</td>
                <td align="left" colspan="1" rowspan="1">Unit</td>
                <td align="left" colspan="1" rowspan="1">True Value</td>
                <td align="left" colspan="1" rowspan="1">Estimated Value<xref ref-type="table-fn" rid="nt103">1</xref></td>
                <td align="left" colspan="1" rowspan="1">Lower Bound</td>
                <td align="left" colspan="1" rowspan="1">Upper Bound</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" colspan="1" rowspan="1">1</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e338" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e339" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e340" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e341" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e342" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e343" xlink:type="simple"/></inline-formula>
                </td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">2</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e344" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e345" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e346" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e347" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e348" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e349" xlink:type="simple"/></inline-formula>
                </td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">3</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e350" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e351" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e352" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e353" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e354" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e355" xlink:type="simple"/></inline-formula>
                </td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">4</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e356" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e357" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e358" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e359" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e360" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e361" xlink:type="simple"/></inline-formula>
                </td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">5</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e362" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e363" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e364" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e365" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e366" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e367" xlink:type="simple"/></inline-formula>
                </td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">6</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e368" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e369" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e370" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e371" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e372" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e373" xlink:type="simple"/></inline-formula>
                </td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">7</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e374" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e375" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e376" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e377" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e378" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e379" xlink:type="simple"/></inline-formula>
                </td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">8</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e380" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e381" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e382" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e383" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e384" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e385" xlink:type="simple"/></inline-formula>
                </td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">9</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e386" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e387" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e388" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e389" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e390" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e391" xlink:type="simple"/></inline-formula>
                </td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">10</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e392" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e393" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e394" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e395" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e396" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e397" xlink:type="simple"/></inline-formula>
                </td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">11</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e398" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e399" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">−35.0</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e400" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">−60.0 <bold>(−45.0)</bold><xref ref-type="table-fn" rid="nt104">2</xref></td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e401" xlink:type="simple"/></inline-formula> <bold>(−25.0)</bold></td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">12</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e402" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e403" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e404" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e405" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">−60.0 <bold>(−65.0)</bold></td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e406" xlink:type="simple"/></inline-formula> <bold>(−45.0)</bold></td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">13</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e407" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e408" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e409" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e410" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">−60.0 <bold>(−40.0)</bold></td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e411" xlink:type="simple"/></inline-formula> <bold>(−20.0)</bold></td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">14</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e412" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e413" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e414" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e415" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">−60.0 <bold>(−40.0)</bold></td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e416" xlink:type="simple"/></inline-formula> <bold>(−20.0)</bold></td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">15</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e417" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e418" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e419" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e420" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">−60.0 <bold>(−55.0)</bold></td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e421" xlink:type="simple"/></inline-formula> <bold>(−35.0)</bold></td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">16</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e422" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e423" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e424" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e425" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">−60.0 <bold>(−50.0)</bold></td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e426" xlink:type="simple"/></inline-formula> <bold>(−30.0)</bold></td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">17</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e427" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e428" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e429" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e430" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e431" xlink:type="simple"/></inline-formula> <bold>(5.0)</bold></td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e432" xlink:type="simple"/></inline-formula> <bold>(10.0)</bold></td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">18</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e433" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e434" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e435" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e436" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e437" xlink:type="simple"/></inline-formula> <bold>(−10.0)</bold></td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e438" xlink:type="simple"/></inline-formula> <bold>(−5.0)</bold></td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">19</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e439" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e440" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e441" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e442" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e443" xlink:type="simple"/></inline-formula> <bold>(10.0)</bold></td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e444" xlink:type="simple"/></inline-formula> <bold>(20.0)</bold></td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">20</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e445" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e446" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e447" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e448" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e449" xlink:type="simple"/></inline-formula> <bold>(3.0)</bold></td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e450" xlink:type="simple"/></inline-formula> <bold>(8.0)</bold></td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">21</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e451" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e452" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e453" xlink:type="simple"/></inline-formula>0</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e454" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e455" xlink:type="simple"/></inline-formula> <bold>(−8.0)</bold></td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e456" xlink:type="simple"/></inline-formula> <bold>(−3.0)</bold></td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">22</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e457" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e458" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e459" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e460" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e461" xlink:type="simple"/></inline-formula> <bold>(5.0)</bold></td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e462" xlink:type="simple"/></inline-formula> <bold>(10.0)</bold></td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">23</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e463" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e464" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e465" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e466" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e467" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e468" xlink:type="simple"/></inline-formula>
                </td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">24</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e469" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e470" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e471" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e472" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e473" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e474" xlink:type="simple"/></inline-formula>
                </td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">25</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e475" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e476" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e477" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e478" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e479" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e480" xlink:type="simple"/></inline-formula>
                </td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">26</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e481" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">-</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e482" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e483" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e484" xlink:type="simple"/></inline-formula> <bold>(0.5)</bold></td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e485" xlink:type="simple"/></inline-formula> <bold>(1.0)</bold></td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">27</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e486" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">-</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e487" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e488" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e489" xlink:type="simple"/></inline-formula> <bold>(0.5)</bold></td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e490" xlink:type="simple"/></inline-formula> <bold>(1.0)</bold></td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">28</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e491" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e492" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e493" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e494" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e495" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e496" xlink:type="simple"/></inline-formula>
                </td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">29</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e497" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e498" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e499" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e500" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e501" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e502" xlink:type="simple"/></inline-formula>
                </td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">30</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e503" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e504" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e505" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e506" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e507" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e508" xlink:type="simple"/></inline-formula>
                </td>
              </tr>
            </tbody>
          </table></alternatives><table-wrap-foot>
            <fn id="nt103">
              <label>1</label>
              <p>These parameter values were estimated when we used the broad prior intervals (see <xref ref-type="fig" rid="pcbi-1002401-g011">Fig. 11Ai</xref>).</p>
            </fn>
            <fn id="nt104">
              <label>2</label>
              <p>Values in bold indicate the narrow prior intervals we used for generating <xref ref-type="fig" rid="pcbi-1002401-g011">Figs. 11Aii, 11B, 11C</xref> (and Supplementary <xref ref-type="supplementary-material" rid="pcbi.1002401.s004">Figs. S4</xref> and <xref ref-type="supplementary-material" rid="pcbi.1002401.s005">S5</xref>).</p>
            </fn>
          </table-wrap-foot></table-wrap>
        <table-wrap id="pcbi-1002401-t003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1002401.t003</object-id><label>Table 3</label><caption>
            <title>Estimated mean values and prior limits used during smoothing for all parameters in the B4 model.</title>
          </caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1002401-t003-3" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.t003" xlink:type="simple"/><table>
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" colspan="1" rowspan="1">#</td>
                <td align="left" colspan="1" rowspan="1">Parameter</td>
                <td align="left" colspan="1" rowspan="1">Unit</td>
                <td align="left" colspan="1" rowspan="1">Estimated Mean Value<xref ref-type="table-fn" rid="nt105">1</xref><sup>,</sup><xref ref-type="table-fn" rid="nt106">2</xref></td>
                <td align="left" colspan="1" rowspan="1">Lower Bound</td>
                <td align="left" colspan="1" rowspan="1">Upper Bound</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" colspan="1" rowspan="1">1</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e509" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e510" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e511" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e512" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e513" xlink:type="simple"/></inline-formula>
                </td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">2</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e514" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e515" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e516" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e517" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e518" xlink:type="simple"/></inline-formula>
                </td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">3</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e519" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e520" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e521" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e522" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e523" xlink:type="simple"/></inline-formula>
                </td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">4</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e524" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e525" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e526" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e527" xlink:type="simple"/></inline-formula> <bold>(−40.0)</bold></td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e528" xlink:type="simple"/></inline-formula> <bold>(−20.0)</bold></td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">5</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e529" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e530" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e531" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e532" xlink:type="simple"/></inline-formula> <bold>(−40.0)</bold></td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e533" xlink:type="simple"/></inline-formula> <bold>(−20.0)</bold></td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">6</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e534" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e535" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e536" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e537" xlink:type="simple"/></inline-formula> <bold>(−40.0)</bold></td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e538" xlink:type="simple"/></inline-formula> <bold>(−20.0)</bold></td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">7</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e539" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e540" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e541" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e542" xlink:type="simple"/></inline-formula> <bold>(−20.0)</bold></td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e543" xlink:type="simple"/></inline-formula> <bold>(0.0)</bold></td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">8</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e544" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e545" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e546" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e547" xlink:type="simple"/></inline-formula> <bold>(−70.0)</bold></td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e548" xlink:type="simple"/></inline-formula> <bold>(−40.0)</bold></td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">9</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e549" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e550" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e551" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e552" xlink:type="simple"/></inline-formula> <bold>(5.0)</bold></td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e553" xlink:type="simple"/></inline-formula> <bold>(10.0)</bold></td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">10</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e554" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e555" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e556" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e557" xlink:type="simple"/></inline-formula> <bold>(−10.0)</bold></td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e558" xlink:type="simple"/></inline-formula> <bold>(−5.0)</bold></td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">11</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e559" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e560" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e561" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e562" xlink:type="simple"/></inline-formula> <bold>(10.0)</bold></td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e563" xlink:type="simple"/></inline-formula> <bold>(15.0)</bold></td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">12</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e564" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e565" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e566" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e567" xlink:type="simple"/></inline-formula> <bold>(5.0)</bold></td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e568" xlink:type="simple"/></inline-formula> <bold>(10.0)</bold></td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">13</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e569" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e570" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e571" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e572" xlink:type="simple"/></inline-formula> <bold>(−25.0)</bold></td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e573" xlink:type="simple"/></inline-formula> <bold>(−15.0)</bold></td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">14</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e574" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e575" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e576" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e577" xlink:type="simple"/></inline-formula> <bold>(15.0)</bold></td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e578" xlink:type="simple"/></inline-formula> <bold>(25.0)</bold></td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">15</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e579" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e580" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e581" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e582" xlink:type="simple"/></inline-formula> <bold>(25.0)</bold></td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e583" xlink:type="simple"/></inline-formula> <bold>(35.0)</bold></td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">16</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e584" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e585" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e586" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e587" xlink:type="simple"/></inline-formula> <bold>(25.0)</bold></td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e588" xlink:type="simple"/></inline-formula> <bold>(35.0)</bold></td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">17</td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e589" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e590" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1">
                  <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e591" xlink:type="simple"/></inline-formula>
                </td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e592" xlink:type="simple"/></inline-formula> <bold>(35.0)</bold></td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e593" xlink:type="simple"/></inline-formula> <bold>(60.0)</bold></td>
              </tr>
            </tbody>
          </table></alternatives><table-wrap-foot>
            <fn id="nt105">
              <label>1</label>
              <p>These parameter values were estimated when we used the narrow prior intervals (in bold; see <xref ref-type="fig" rid="pcbi-1002401-g012">Fig. 12</xref>).</p>
            </fn>
            <fn id="nt106">
              <label>2</label>
              <p>The parameter posteriors estimated when we used the broad prior intervals are illustrated in Supplementary <xref ref-type="supplementary-material" rid="pcbi.1002401.s007">Fig. S7</xref>.</p>
            </fn>
          </table-wrap-foot></table-wrap>
        <p>All simulations were performed on an Intel dual-core i5 processor with 4 GB of memory running Ubuntu Linux. The number of particles used in each simulation was typically <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e594" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e595" xlink:type="simple"/></inline-formula> was the dimensionality of the extended state <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e596" xlink:type="simple"/></inline-formula> (equal to the number of free parameters and dynamic states in the model). The time step <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e597" xlink:type="simple"/></inline-formula> in the Euler-Maruyama method was set equal to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e598" xlink:type="simple"/></inline-formula>. The parameter <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e599" xlink:type="simple"/></inline-formula> of the fixed-lag smoother was set equal to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e600" xlink:type="simple"/></inline-formula> (unless stated otherwise), which is equivalent to a time window <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e601" xlink:type="simple"/></inline-formula> wide (since data were sampled every <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e602" xlink:type="simple"/></inline-formula>). The adaptation constants <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e603" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e604" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e605" xlink:type="simple"/></inline-formula> in Eqs. 26, 27 and 28 were all set equal to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e606" xlink:type="simple"/></inline-formula>, unless stated otherwise. Depending on the size of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e607" xlink:type="simple"/></inline-formula>, the complexity of the model and the length of the (actual or simulated) electrophysiological recordings, simulation times ranged from a few minutes up to more than <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e608" xlink:type="simple"/></inline-formula> hours.</p>
      </sec>
      <sec id="s2f">
        <title>Electrophysiology</title>
        <p>As part of this study, we developed a single-compartment Hodgkin-Huxley-type model of a B4 neuron in the pond-snail <italic>Lymnaea stagnalis</italic> <xref ref-type="bibr" rid="pcbi.1002401-Straub1">[38]</xref>. B4 neurons are part of the neural circuit that controls the rhythmic movements of the feeding muscles via which the animal captures and ingests its food. The <italic>Lymnaea</italic> central nervous system was dissected from adult animals (shell length <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e609" xlink:type="simple"/></inline-formula>) that were bred at the University of Leicester as described previously <xref ref-type="bibr" rid="pcbi.1002401-Straub2">[39]</xref>. All dissections were carried out in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e610" xlink:type="simple"/></inline-formula>-buffered saline containing (in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e611" xlink:type="simple"/></inline-formula>) <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e612" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e613" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e614" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e615" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e616" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e617" xlink:type="simple"/></inline-formula>, in distilled water. All chemicals were purchased from Sigma. The buccal ganglia containing the B4 neurons were separated from the rest of the nervous system by cutting the cerebral buccal connectives and the buccal-buccal connective was crushed to eliminate electrical coupling between B4 neurons in the left and right buccal ganglion. Prior to recording, excess saline was removed from the dish and small crystals of protease type XIV were placed directly on top of the buccal ganglia to soften the connective tissue and aid the impalement of individual neurons. The protease crystals were washed of after about <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e618" xlink:type="simple"/></inline-formula> with multiple changes of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e619" xlink:type="simple"/></inline-formula>-buffered saline. The B4 neuron was visually identified based on its size and position and impaled with two sharp intracellular electrodes filled with a mixture of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e620" xlink:type="simple"/></inline-formula> potassium acetate and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e621" xlink:type="simple"/></inline-formula> potassium chloride (resistance <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e622" xlink:type="simple"/></inline-formula>). During the recording, the preparation was bathed in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e623" xlink:type="simple"/></inline-formula>-buffered saline plus <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e624" xlink:type="simple"/></inline-formula> hexamethonium chloride to block cholinergic synaptic inputs and suppress spontaneous fictive feeding activity.</p>
        <p>The signals from the two intracellular electrodes were amplified using a Multiclamp 900A amplifier (Molecular Devices), digitized at a sampling frequency of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e625" xlink:type="simple"/></inline-formula> using a CED1401plus A/D converter (Cambridge Electronic Devices) and recorded on a PC using Spike2 version 6 software (Cambridge Electronic Devices). A custom set of instructions using the Spike2 scripting language was used to generate sequences of current pulses consisting of individual random steps ranging in amplitude from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e626" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e627" xlink:type="simple"/></inline-formula> and a duration from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e628" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e629" xlink:type="simple"/></inline-formula>. The current signal was injected through one of the recording electrodes whilst the second electrode was used to measure the resulting changes in membrane potential.</p>
      </sec>
    </sec>
    <sec id="s3">
      <title>Results</title>
      <sec id="s3a">
        <title>Hidden States, Intrinsic and Observational Noise are Simultaneously Estimated Using the Fixed-Lag Smoother</title>
        <p>The applicability of the fixed-lag smoother presented above was demonstrated on a range of Hodgkin-Huxley-type models using simulated or actual electrophysiological data. The first model we examined consisted of a single compartment containing leakage, sodium and potassium currents, as shown below:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e630" xlink:type="simple"/></disp-formula><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e631" xlink:type="simple"/><label>(32)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e632" xlink:type="simple"/></inline-formula>. Notice the absence of noise in the dynamics of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e633" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e634" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e635" xlink:type="simple"/></inline-formula>, which is valid if we assume a very large number of channels (see Supplementary Material and Supplementary <xref ref-type="supplementary-material" rid="pcbi.1002401.s001">Figures S1</xref> and <xref ref-type="supplementary-material" rid="pcbi.1002401.s002">S2</xref> for the case were noise is present in the dynamics of these variables). The steady states and relaxation times of the activation and inactivation gating variables were voltage-dependent, as shown below (e.g. <xref ref-type="bibr" rid="pcbi.1002401-Willms1">[5]</xref>):<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e636" xlink:type="simple"/><label>(33)</label></disp-formula>and<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e637" xlink:type="simple"/><label>(34)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e638" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e639" xlink:type="simple"/></inline-formula>. The parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e640" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e641" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e642" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e643" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e644" xlink:type="simple"/></inline-formula> in Eqs. 33 and 34 were chosen such that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e645" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e646" xlink:type="simple"/></inline-formula> fit closely the corresponding steady-states and relaxation times of the classic Hodgkin-Huxley model of neural excitability in the giant squid axon <xref ref-type="bibr" rid="pcbi.1002401-Koch1">[40]</xref>. Observations consisted of noisy measurements of the membrane potential, as shown in Eq. 7. The full set of parameter values in the above model is given in <xref ref-type="table" rid="pcbi-1002401-t001">Table 1</xref>.</p>
        <p>First, we used the fixed-lag smoother to simultaneously infer the hidden states (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e647" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e648" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e649" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e650" xlink:type="simple"/></inline-formula>) and standard deviations of the intrinsic (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e651" xlink:type="simple"/></inline-formula>) and observation (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e652" xlink:type="simple"/></inline-formula>) noise based on <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e653" xlink:type="simple"/></inline-formula>-long simulated recordings of the membrane potential <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e654" xlink:type="simple"/></inline-formula>. These recordings were generated by assuming a time-dependent <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e655" xlink:type="simple"/></inline-formula> in Eq. 31, which consisted of a sequence of current steps with amplitude randomly distributed between <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e656" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e657" xlink:type="simple"/></inline-formula> and random duration up to a maximum of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e658" xlink:type="simple"/></inline-formula>. Two simulated voltage recordings were generated corresponding to two different levels of observation noise, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e659" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e660" xlink:type="simple"/></inline-formula>, respectively. The second value (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e661" xlink:type="simple"/></inline-formula>) was rather extreme and it was chosen in order to illustrate the applicability of the method even at very high levels of observation noise. Simulated data points were sampled every <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e662" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e663" xlink:type="simple"/></inline-formula>). The standard deviation of the intrinsic noise was set at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e664" xlink:type="simple"/></inline-formula>. The injected current <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e665" xlink:type="simple"/></inline-formula> and the induced voltage trace (for either value of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e666" xlink:type="simple"/></inline-formula>) were then used as input to the smoother, during the inference phase. At this stage, all other parameters in the model (conductances, reversal potentials, and ionic current kinetics) were assumed known, thus the extended state vector took the form <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e667" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e668" xlink:type="simple"/></inline-formula> was a scale factor as in Eq. 25. New samples for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e669" xlink:type="simple"/></inline-formula> were taken from a log-normal distribution (Eq. 28), while new samples for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e670" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e671" xlink:type="simple"/></inline-formula> were drawn from an adaptive bivariate Gaussian distribution at each iteration of the algorithm (Eq. 25). For each data set, smoothing was repeated for two different values of the smoothing lag, i.e. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e672" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e673" xlink:type="simple"/></inline-formula>. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e674" xlink:type="simple"/></inline-formula> corresponds to filtering, while <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e675" xlink:type="simple"/></inline-formula> corresponds to smoothing with a fixed lag equal to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e676" xlink:type="simple"/></inline-formula>. Our results from this set of simulations are summarized in <xref ref-type="fig" rid="pcbi-1002401-g001">Fig. 1</xref>.</p>
        <fig id="pcbi-1002401-g001" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002401.g001</object-id>
          <label>Figure 1</label>
          <caption>
            <title>Simultaneous estimation of hidden states, intrinsic and observation noise.</title>
            <p>Estimation was based on a simulated recording of membrane potential with duration <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e677" xlink:type="simple"/></inline-formula>. For clarity, only <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e678" xlink:type="simple"/></inline-formula> of activity are shown in A and Bi,ii. (<bold>A</bold>) Smoothing of the membrane potential (the observed variable), when observation noise was low (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e679" xlink:type="simple"/></inline-formula>). High-fidelity smoothing was achieved for either small (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e680" xlink:type="simple"/></inline-formula>) or large (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e681" xlink:type="simple"/></inline-formula>) values of the fixed smoothing lag <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e682" xlink:type="simple"/></inline-formula>. Simulated and smoothed data are difficult to distinguish due to their overlap. (<bold>Bi</bold>) Smoothing of the membrane potential at high levels of observation noise (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e683" xlink:type="simple"/></inline-formula>). A large value of the smoothing lag (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e684" xlink:type="simple"/></inline-formula>) was required for high-fidelity smoothing. (<bold>Bii</bold>) Inference of the unobserved activation (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e685" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e686" xlink:type="simple"/></inline-formula>) and inactivation (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e687" xlink:type="simple"/></inline-formula>) variables for sodium and potassium currents as functions of time, during smoothing of the data shown in Bi for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e688" xlink:type="simple"/></inline-formula>. (<bold>Ci</bold>) Inference of the standard deviations for the intrinsic and observation noise (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e689" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e690" xlink:type="simple"/></inline-formula>, respectively) during smoothing of the data shown in Bi for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e691" xlink:type="simple"/></inline-formula>. Dashed lines indicate the true values of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e692" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e693" xlink:type="simple"/></inline-formula>. (<bold>Cii</bold>) Histograms of the time series for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e694" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e695" xlink:type="simple"/></inline-formula> in Ci. Again, dashed lines indicate the true values of the corresponding parameters. At this stage, maximal conductances, reversal potentials and kinetic parameters in the model were assumed known. The number of particles was <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e696" xlink:type="simple"/></inline-formula>. Also, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e697" xlink:type="simple"/></inline-formula>. The scaling factors in Eq. 25 were all considered equal to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e698" xlink:type="simple"/></inline-formula>.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.g001" xlink:type="simple"/>
        </fig>
        <p>We observed that at low levels of observation noise (<xref ref-type="fig" rid="pcbi-1002401-g001">Fig. 1A</xref>), the inferred expectation of the voltage (solid blue and red lines) closely matched the underlying (true) signal (solid black line). This was true for both values of the fixed lag <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e699" xlink:type="simple"/></inline-formula> used for smoothing. However, at high levels of observation noise (<xref ref-type="fig" rid="pcbi-1002401-g001">Fig. 1Bi</xref>), the true voltage was inferred with high fidelity when a large value of the fixed lag (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e700" xlink:type="simple"/></inline-formula>) was used (solid red line), but not when <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e701" xlink:type="simple"/></inline-formula> (solid blue line). Furthermore, the inferred expectations of the unobserved dynamic variables <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e702" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e703" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e704" xlink:type="simple"/></inline-formula> (solid red lines in <xref ref-type="fig" rid="pcbi-1002401-g001">Fig. 1Bii</xref>) also matched the true hidden time series (solid black lines in the same figure) remarkably well, when <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e705" xlink:type="simple"/></inline-formula>.</p>
        <p>We repeat that during these simulations an artificial update rule was imposed on the two free standard deviations <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e706" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e707" xlink:type="simple"/></inline-formula>, as shown in Eq. 25. The artificial evolution of these parameters is illustrated in <xref ref-type="fig" rid="pcbi-1002401-g001">Fig. 1Ci</xref>, where the inferred expectations of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e708" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e709" xlink:type="simple"/></inline-formula> are presented as functions of time. These expectations converged immediately, fluctuating around the true values of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e710" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e711" xlink:type="simple"/></inline-formula> (dashed lines in <xref ref-type="fig" rid="pcbi-1002401-g001">Fig. 1Ci</xref>). This is also illustrated by the histograms in <xref ref-type="fig" rid="pcbi-1002401-g001">Fig. 1Cii</xref>, which were constructed from the data points in <xref ref-type="fig" rid="pcbi-1002401-g001">Fig. 1Ci</xref>. We observed that the peaks of these histograms were located quite closely to the true values of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e712" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e713" xlink:type="simple"/></inline-formula> (dashed lines in <xref ref-type="fig" rid="pcbi-1002401-g001">Fig. 1Cii</xref>).</p>
        <p>In summary, the fixed-lag smoother was able to recover the hidden states and standard deviations of the intrinsic and observation noise in the model based on noisy observations of the membrane potential. This was true even at high levels of observation noise, subject to the condition that a sufficiently large smoothing lag <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e714" xlink:type="simple"/></inline-formula> was adopted during the simulation.</p>
      </sec>
      <sec id="s3b">
        <title>Adaptive Sampling Reduces the Variance of Inferred Parameter Distributions and Accelerates Convergence of the Algorithm</title>
        <p>Next, we treated two more parameters in the model as unknown, i.e. the maximal conductances of the transient sodium (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e715" xlink:type="simple"/></inline-formula>) and delayed rectifier potassium (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e716" xlink:type="simple"/></inline-formula>) currents. The extended state vector, thus, took the form <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e717" xlink:type="simple"/></inline-formula>. As in the previous section, new samples for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e718" xlink:type="simple"/></inline-formula> were drawn from a log-normal distribution (Eq. 28), while <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e719" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e720" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e721" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e722" xlink:type="simple"/></inline-formula> were sampled by default from an adaptive multivariate Gaussian distribution at each iteration of the algorithm (Eq. 25).</p>
        <p>In order to examine the effect of this adaptive sampling approach on the variance of the inferred parameter distributions, we repeated fixed-lag smoothing on <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e723" xlink:type="simple"/></inline-formula>-long simulated recordings of the membrane potential assuming each time that different aspects of the adaptive sampling process were switched off, as illustrated in <xref ref-type="fig" rid="pcbi-1002401-g002">Fig. 2</xref>. First, we assumed that no adaptation was imposed on <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e724" xlink:type="simple"/></inline-formula> or the “unknown” noise parameters and maximal conductances, i.e. the constants <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e725" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e726" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e727" xlink:type="simple"/></inline-formula> in Eqs. 26–28 were all set equal to zero. In this case, the multivariate Gaussian distribution from which new samples of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e728" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e729" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e730" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e731" xlink:type="simple"/></inline-formula> were drawn from reduced to Eq. 30. In addition, we assumed that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e732" xlink:type="simple"/></inline-formula> in the same equation was equal to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e733" xlink:type="simple"/></inline-formula>, for all samples <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e734" xlink:type="simple"/></inline-formula>. Under these conditions, the true values of the free parameters were correctly estimated through application of the fixed-lag smoother, as illustrated for the case of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e735" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e736" xlink:type="simple"/></inline-formula> in <xref ref-type="fig" rid="pcbi-1002401-g002">Figs. 2Ai and 2Aii</xref>.</p>
        <fig id="pcbi-1002401-g002" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002401.g002</object-id>
          <label>Figure 2</label>
          <caption>
            <title>The effect of adaptive parameter sampling on the variance of parameter estimates.</title>
            <p>Merging the fixed-lag smoother with an adaptive sampling algorithm akin to the Covariance Matrix Adaptation Evolution Strategy reduced significantly the variance of parameter estimates. At this stage, the maximal conductances for the sodium (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e737" xlink:type="simple"/></inline-formula>) and potassium (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e738" xlink:type="simple"/></inline-formula>) currents were assumed unknown. Estimation was based on a simulated recording of membrane potential with duration <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e739" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e740" xlink:type="simple"/></inline-formula>. (<bold>A</bold>) Inference of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e741" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e742" xlink:type="simple"/></inline-formula> during smoothing, when new parameter samples were drawn from a non-adaptive multi-variate normal distribution (Eq. 30). Dashed lines indicate the true parameter values. (<bold>B</bold>) Inference of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e743" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e744" xlink:type="simple"/></inline-formula> during smoothing, when new samples were drawn from a multi-variate normal distribution (Eq. 25) with an adaptive scaling factor <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e745" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e746" xlink:type="simple"/></inline-formula> in Eq. 28). (<bold>C</bold>) Inference of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e747" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e748" xlink:type="simple"/></inline-formula> during smoothing, when new samples were drawn from a multi-variate normal distribution (Eq. 25) with adaptive scaling (as in B) and mean (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e749" xlink:type="simple"/></inline-formula> in Eq. 26). (<bold>D</bold>) Inference of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e750" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e751" xlink:type="simple"/></inline-formula> during smoothing, when new samples were drawn from a multi-variate normal distribution with adaptive scaling (as in B), mean (as in C) and covariance (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e752" xlink:type="simple"/></inline-formula> in Eq. 27). The histograms in the right plots were constructed from the time series in the left plots. Membrane potential, activation and inactivation variables, intrinsic and observation noise were also subject to estimation, as in <xref ref-type="fig" rid="pcbi-1002401-g001">Fig. 1</xref>. Smoothing lag and number of particles were <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e753" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e754" xlink:type="simple"/></inline-formula>, respectively. The prior interval of the scaling factors <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e755" xlink:type="simple"/></inline-formula> was <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e756" xlink:type="simple"/></inline-formula>.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.g002" xlink:type="simple"/>
        </fig>
        <p>Subsequently, we repeated smoothing assuming that the scale factor <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e757" xlink:type="simple"/></inline-formula> evolved according to the log-normal update rule given by Eq. 28 with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e758" xlink:type="simple"/></inline-formula>, while <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e759" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e760" xlink:type="simple"/></inline-formula> were again set equal to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e761" xlink:type="simple"/></inline-formula>. As illustrated in <xref ref-type="fig" rid="pcbi-1002401-g002">Figs. 2Bi and 2Bii</xref> for parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e762" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e763" xlink:type="simple"/></inline-formula>, by imposing this simple adaptation rule on the multivariate Gaussian distribution from which the free parameters in the model were sampled, we managed again to estimate correctly their values, but this time the variance of the inferred parameter distributions (the width of the histograms in <xref ref-type="fig" rid="pcbi-1002401-g002">Fig. 2Bii</xref>) was drastically reduced.</p>
        <p>By further letting the mean and covariance of the proposal Gaussian distribution in Eq. 25 adapt (by setting <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e764" xlink:type="simple"/></inline-formula> in Eqs. 26 and 27), we achieved a further decrease in the spread of the inferred parameter distributions (<xref ref-type="fig" rid="pcbi-1002401-g002">Figs. 2C and 2D</xref>). Parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e765" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e766" xlink:type="simple"/></inline-formula> and the hidden states <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e767" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e768" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e769" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e770" xlink:type="simple"/></inline-formula> were also inferred with very high fidelity in all cases (as in <xref ref-type="fig" rid="pcbi-1002401-g001">Fig. 1</xref>), but the variance of the estimated posteriors for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e771" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e772" xlink:type="simple"/></inline-formula> followed the same pattern as the variance of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e773" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e774" xlink:type="simple"/></inline-formula>.</p>
        <p>It is worth observing that when all three adaptation processes were switched on (i.e. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e775" xlink:type="simple"/></inline-formula>), the algorithm converged to a single point in parameter space within the first <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e776" xlink:type="simple"/></inline-formula> of simulation, which coincided with the true parameter values in the model (see <xref ref-type="fig" rid="pcbi-1002401-g002">Fig. 2D</xref> for the case of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e777" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e778" xlink:type="simple"/></inline-formula>). At this point, the covariance matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e779" xlink:type="simple"/></inline-formula> became very small (i.e. all its elements were less than <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e780" xlink:type="simple"/></inline-formula>, although the matrix itself remained non-singular) and the mean <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e781" xlink:type="simple"/></inline-formula> was very close to the true parameter vector <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e782" xlink:type="simple"/></inline-formula>. We note that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e783" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e784" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e785" xlink:type="simple"/></inline-formula> stands for the expectation computed over the population of particles. In this case, it is not strictly correct to claim that the chains in <xref ref-type="fig" rid="pcbi-1002401-g002">Fig. 2Di</xref> approximate the posteriors of the unknown parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e786" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e787" xlink:type="simple"/></inline-formula>; since repeating the simulation many times would result in convergence at slightly different points clustered tightly around the true parameter values, it would be more reasonable to claim that these optimal points are random samples from the posterior parameter distribution and they can be treated as estimates of its mode.</p>
        <p>Depending on the situation, one may wish to estimate the full posteriors of the unknown parameters or just an optimal set of parameter values, which can be used in a subsequent predictive simulation. In <xref ref-type="fig" rid="pcbi-1002401-g003">Fig. 3A</xref>, we examined in more detail how the scale factor <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e788" xlink:type="simple"/></inline-formula> affects the variance of the final estimates, assuming that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e789" xlink:type="simple"/></inline-formula>. We repeat that each particle <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e790" xlink:type="simple"/></inline-formula> contains <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e791" xlink:type="simple"/></inline-formula> as a component of its extended state. Each scaling factor <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e792" xlink:type="simple"/></inline-formula> is updated at each iteration of the algorithm following a lognormal rule (Eq. 28, Step 1b of the algorithm in the <xref ref-type="sec" rid="s2">Methods</xref> section). Sampling new parameter vectors is conditioned on these updated scaling factors (Eq. 25, Step 1e of the algorithm). When at a later stage weighting (and resampling) of the particles occurs, the scaling factors that are associated with high-weight parameters and hidden states are likely to survive into subsequent iterations (or “generations”) of the algorithm. During the course of this adaptive process, the scaling factors <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e793" xlink:type="simple"/></inline-formula> are allowed to fluctuate only within predefines limits, similarly to the other components of the extended state vector.</p>
        <fig id="pcbi-1002401-g003" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002401.g003</object-id>
          <label>Figure 3</label>
          <caption>
            <title>The effect of the size of the scaling factor </title>
            <p><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e794" xlink:type="simple"/></inline-formula><bold> and the number of particles </bold><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e795" xlink:type="simple"/></inline-formula><bold> on the variance of the estimates.</bold> Large minimal values of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e796" xlink:type="simple"/></inline-formula> and small values of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e797" xlink:type="simple"/></inline-formula> imply large variance of the estimates. (<bold>A</bold>) Resampling of particles (see <xref ref-type="sec" rid="s2">Methods</xref>) implies adaptation of (among others) the scaling factors <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e798" xlink:type="simple"/></inline-formula>, which gradually approach the lower bound of their prior interval (red lines in Ai,ii). A prior interval with zero lower bound (i.e. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e799" xlink:type="simple"/></inline-formula>) leads to estimates with negligible variance (Ai). A prior interval with relatively large lower bound (e.g. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e800" xlink:type="simple"/></inline-formula>) leads to estimates with non-zero variance (Aii). Notice that the expectation <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e801" xlink:type="simple"/></inline-formula> in Ai does not actually take the value <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e802" xlink:type="simple"/></inline-formula> (instead it becomes approximately equal to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e803" xlink:type="simple"/></inline-formula>). (<bold>B</bold>) A small number of particles (Bi, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e804" xlink:type="simple"/></inline-formula>) implies estimates with large variance (compare to Bii, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e805" xlink:type="simple"/></inline-formula>). Notice that the difference between Aii (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e806" xlink:type="simple"/></inline-formula>) and Bii (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e807" xlink:type="simple"/></inline-formula>) is negligible, implying the presence of a ceiling effect, when the number of particles becomes very large. In these simulations, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e808" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e809" xlink:type="simple"/></inline-formula>.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.g003" xlink:type="simple"/>
        </fig>
        <p>In <xref ref-type="fig" rid="pcbi-1002401-g003">Fig. 3Ai</xref>, we demonstrate the case where the scaling factors <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e810" xlink:type="simple"/></inline-formula> were allowed to take values from the prior interval <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e811" xlink:type="simple"/></inline-formula>. We observed that during the course of the simulation (which utilized <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e812" xlink:type="simple"/></inline-formula>-long simulated membrane potential recordings), the average value of the scaling factor, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e813" xlink:type="simple"/></inline-formula>, decreased gradually towards <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e814" xlink:type="simple"/></inline-formula> and this was accompanied by a dramatic decrease in the variance of the inferred parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e815" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e816" xlink:type="simple"/></inline-formula>, which eventually “collapsed” to a point in parameter space located very close to their true values. This situation was the same as the one illustrated in <xref ref-type="fig" rid="pcbi-1002401-g002">Fig. 2D</xref>. Notice that although <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e817" xlink:type="simple"/></inline-formula> decreased towards zero, it never actually took this value; it merely became very small (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e818" xlink:type="simple"/></inline-formula>). When we used a prior interval for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e819" xlink:type="simple"/></inline-formula> with non-zero lower bound (i.e. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e820" xlink:type="simple"/></inline-formula>]; see <xref ref-type="fig" rid="pcbi-1002401-g003">Fig. 3Aii</xref>), the final estimates had a larger variance, providing an approximation of the full posteriors of the “unknown” parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e821" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e822" xlink:type="simple"/></inline-formula>. Thus, controlling the lower bound of the prior interval for the scaling factors <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e823" xlink:type="simple"/></inline-formula> provides a simple method for controlling the variance of the final estimates. Notice that the variance of the final estimates also depends on the number of particles (<xref ref-type="fig" rid="pcbi-1002401-g003">Fig. 3B</xref>). A smaller number of particles resulted in a larger variance of the estimates (compare <xref ref-type="fig" rid="pcbi-1002401-g003">Fig. 3Bi to Fig. 3Bii</xref>). However, when a large number of particles was already in use, further increasing their number did not significantly affect the variance of the estimates or the rate of convergence (compare <xref ref-type="fig" rid="pcbi-1002401-g003">Fig. 3Bii to Fig. 3Aii</xref>), indicating the presence of a ceiling effect.</p>
        <p>The adaptive sampling of the scaling factors <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e824" xlink:type="simple"/></inline-formula> further depends on parameter <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e825" xlink:type="simple"/></inline-formula> in Eq. 28, which determines the width of the lognormal distribution from which new samples are drawn. The value of this parameter provides a simple way to control the rate of convergence of the algorithm; larger values of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e826" xlink:type="simple"/></inline-formula> resulted in faster convergence, when processing <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e827" xlink:type="simple"/></inline-formula>-long simulated recordings (compare <xref ref-type="fig" rid="pcbi-1002401-g004">Fig. 4A to Fig. 4B</xref>). The rate of convergence also depends on the number of particles in use (compare <xref ref-type="fig" rid="pcbi-1002401-g004">Fig. 4A to Fig. 4C</xref>), although it is more sensitive to changes in parameter <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e828" xlink:type="simple"/></inline-formula>; dividing the value of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e829" xlink:type="simple"/></inline-formula> by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e830" xlink:type="simple"/></inline-formula> (<xref ref-type="fig" rid="pcbi-1002401-g004">Fig. 4B</xref>) had a larger effect on the rate of convergence than dividing the number of particles by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e831" xlink:type="simple"/></inline-formula> (<xref ref-type="fig" rid="pcbi-1002401-g004">Fig. 4C</xref>).</p>
        <fig id="pcbi-1002401-g004" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002401.g004</object-id>
          <label>Figure 4</label>
          <caption>
            <title>The effect of adaptation of the scaling factor </title>
            <p><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e832" xlink:type="simple"/></inline-formula><bold> and the number of particles </bold><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e833" xlink:type="simple"/></inline-formula><bold> on the speed of convergence.</bold> A slow rate of adaptation for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e834" xlink:type="simple"/></inline-formula> and a small number of particles <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e835" xlink:type="simple"/></inline-formula> imply slow convergence of the algorithm. The rate at which <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e836" xlink:type="simple"/></inline-formula> adapts depends on the parameter <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e837" xlink:type="simple"/></inline-formula> in Eq. 28. Reducing <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e838" xlink:type="simple"/></inline-formula> in half results in a significant decrease in the rate of convergence (compare A to B). Also, reducing the number of particles by a factor of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e839" xlink:type="simple"/></inline-formula> slows down the speed of convergence (compare A to C), but not as much as when parameter <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e840" xlink:type="simple"/></inline-formula> was adjusted. The plots on the right illustrate the profile of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e841" xlink:type="simple"/></inline-formula> associated with the estimation of the parameters on the left plots. In these simulations, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e842" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e843" xlink:type="simple"/></inline-formula> and the prior interval for the scaling factors <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e844" xlink:type="simple"/></inline-formula> was <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e845" xlink:type="simple"/></inline-formula>.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.g004" xlink:type="simple"/>
        </fig>
        <p>In summary, by assuming an adaptive sampling process for the unknown parameters in the model, we managed to achieve a significant reduction in the spread of the inferred posterior distributions of these parameters. Furthermore, adjusting the prior interval and adaptation rate <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e846" xlink:type="simple"/></inline-formula> of the scaling factors <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e847" xlink:type="simple"/></inline-formula> provides a straightforward way to control the variance of the estimated posteriors and the rate of convergence of the algorithm. Alternatively, we could have set <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e848" xlink:type="simple"/></inline-formula>, i.e. set it to the same constant value for all particles <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e849" xlink:type="simple"/></inline-formula> and time steps <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e850" xlink:type="simple"/></inline-formula> (as in <xref ref-type="fig" rid="pcbi-1002401-g002">Fig. 2A</xref>). However, by permitting <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e851" xlink:type="simple"/></inline-formula> to adapt within a predefined interval, we potentially allow this parameter and, thus, the covariance matrices <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e852" xlink:type="simple"/></inline-formula> take large values, which in turn would permit the algorithm to escape local optima in the parameter space. For example, the time profiles of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e853" xlink:type="simple"/></inline-formula> in <xref ref-type="fig" rid="pcbi-1002401-g003">Figs. 3</xref> and <xref ref-type="fig" rid="pcbi-1002401-g004">4</xref> indicate that, early during the simulations, this quantity had relatively large values, which were associated with large variances of the posterior parameter estimates. During this initial period, the algorithm has the potential to “jump” away from local optima and towards more optimal regions of the parameter space. One may see, here, a distant analogy to simulated annealing, where a fictitious “temperature” control variable is gradually decreased, thus allowing the system to escape local minima and gradually settle to more optimal regions of the energy landscape.</p>
      </sec>
      <sec id="s3c">
        <title>Increasing Observation Noise Reduces the Accuracy and Precision of the Fixed-Lag Smoother</title>
        <p>In a subsequent stage, we treated as unknown two more parameters in the model, i.e. the reversal potentials for the sodium and potassium currents, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e854" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e855" xlink:type="simple"/></inline-formula>, respectively. Thus, the extended state vector became <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e856" xlink:type="simple"/></inline-formula>. This time, we wanted to examine how increasing levels of observation noise (i.e. the value of parameter <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e857" xlink:type="simple"/></inline-formula>) affect the inference of unknown quantities in the model based on the fixed-lag smoother. For this reason, we repeated smoothing on four <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e858" xlink:type="simple"/></inline-formula>-long simulated data sets (i.e. recordings of membrane potential and the associated <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e859" xlink:type="simple"/></inline-formula>) corresponding to increasing values of the standard deviation of the observation noise <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e860" xlink:type="simple"/></inline-formula>, i.e. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e861" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e862" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e863" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e864" xlink:type="simple"/></inline-formula>.</p>
        <p>The results from this set of simulations are summarized in <xref ref-type="fig" rid="pcbi-1002401-g005">Fig. 5</xref>. For <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e865" xlink:type="simple"/></inline-formula>, the expectations of the four parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e866" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e867" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e868" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e869" xlink:type="simple"/></inline-formula> (red solid lines in <xref ref-type="fig" rid="pcbi-1002401-g005">Figs. 5Ai–iv</xref>) eventually converged to their true values (dashed lines in the aforementioned figures). For <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e870" xlink:type="simple"/></inline-formula>, the expectations of these parameters (light red solid lines in <xref ref-type="fig" rid="pcbi-1002401-g005">Figs. 5Ai–iv</xref>) also converged, although the expectations for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e871" xlink:type="simple"/></inline-formula> (<xref ref-type="fig" rid="pcbi-1002401-g005">Fig. 5Ai</xref>) and, to a lesser degree, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e872" xlink:type="simple"/></inline-formula> (<xref ref-type="fig" rid="pcbi-1002401-g005">Fig. 5Aii</xref>) deviated noticeably from their true values. As expected, at higher levels of noise, the variance of the final estimates was larger, although the rate of convergence did not seem to be affected, due to the large number of particles we used (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e873" xlink:type="simple"/></inline-formula>; see ceiling effect in <xref ref-type="fig" rid="pcbi-1002401-g003">Fig. 3Bii</xref>). The inferred parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e874" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e875" xlink:type="simple"/></inline-formula> (not illustrated for clarity) followed a similar convergence pattern.</p>
        <fig id="pcbi-1002401-g005" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002401.g005</object-id>
          <label>Figure 5</label>
          <caption>
            <title>The effect of observation noise on the accuracy and precision of parameter estimates.</title>
            <p>Increasing observation noise decreases the accuracy and precision of the fixed-lag smoother. At this stage, the reversal potentials for the sodium and potassium currents (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e876" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e877" xlink:type="simple"/></inline-formula>, respectively) were also considered unknown. Estimation was based on a simulated recording of membrane potential with duration 2 s. The noise parameters were <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e878" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e879" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e880" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e881" xlink:type="simple"/></inline-formula> or <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e882" xlink:type="simple"/></inline-formula>. (<bold>A</bold>) Inference of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e883" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e884" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e885" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e886" xlink:type="simple"/></inline-formula> during smoothing. The accuracy of the estimates decreases and their variance increases with increasing observation noise. (<bold>B</bold>) The box plot of the time series in A for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e887" xlink:type="simple"/></inline-formula>. Data were first normalized according to Eq. 35. The reduction in the accuracy and precision at higher levels of observation noise were more prominent in the case of the maximal conductances (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e888" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e889" xlink:type="simple"/></inline-formula>) and less prominent in the case of reversal potentials (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e890" xlink:type="simple"/></inline-formula> and, particularly <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e891" xlink:type="simple"/></inline-formula>). The membrane potential, activation and inactivation variables, intrinsic and observation noise were also subject to estimation, as in <xref ref-type="fig" rid="pcbi-1002401-g001">Fig. 1</xref>. In these simulations, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e892" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e893" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e894" xlink:type="simple"/></inline-formula> and the prior interval of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e895" xlink:type="simple"/></inline-formula> was <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e896" xlink:type="simple"/></inline-formula>.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.g005" xlink:type="simple"/>
        </fig>
        <p>In <xref ref-type="fig" rid="pcbi-1002401-g005">Fig. 5B</xref>, we show, for each tested value of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e897" xlink:type="simple"/></inline-formula>, the box plots of the above four parameters, which were computed from the data points (as in <xref ref-type="fig" rid="pcbi-1002401-g005">Fig. 5A</xref>) corresponding to time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e898" xlink:type="simple"/></inline-formula>. For each parameter and each value of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e899" xlink:type="simple"/></inline-formula>, the data were first normalized as follows:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e900" xlink:type="simple"/><label>(35)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e901" xlink:type="simple"/></inline-formula>. The box plots in <xref ref-type="fig" rid="pcbi-1002401-g005">Fig. 5B</xref> were constructed from the normalized data points <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e902" xlink:type="simple"/></inline-formula>. The above normalization was necessary since it made possible the comparison between different data sets, each characterized by its own mean, variance and unit of measurement. In the box plots in <xref ref-type="fig" rid="pcbi-1002401-g005">Fig. 5B</xref>, zero (i.e. the dashed lines) corresponds to the true parameter values, while discrepancies from the true parameter values along the y-axis are given in relation to the average <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e903" xlink:type="simple"/></inline-formula>. We may observe that for very low levels of observation noise (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e904" xlink:type="simple"/></inline-formula>), the posteriors of the four examined parameters were clustered tightly around their true values, but for larger levels of noise (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e905" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e906" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e907" xlink:type="simple"/></inline-formula>), we observed larger discrepancies from the true parameter values and broader inferred posteriors. The parameters following more noticeably this trend were the conductances <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e908" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e909" xlink:type="simple"/></inline-formula>, while <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e910" xlink:type="simple"/></inline-formula> and, particularly, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e911" xlink:type="simple"/></inline-formula> were less affected. This indicates that smoothing is more sensitive to changes in some model parameters than others and this is why these parameters were tightly controlled. In summary, increasing the levels of measurement noise (i.e. the value of parameter <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e912" xlink:type="simple"/></inline-formula>) decreased the accuracy and precision of the algorithm, but it did not significantly affect the rate of convergence due to the large number of particles used during the simulations.</p>
      </sec>
      <sec id="s3d">
        <title>High-Dimensional Inference Problems are Resolved Given Sufficiently Informative Priors</title>
        <p>At the next stage, we treated all parameters in the model (a total of 23 parameters; see <xref ref-type="table" rid="pcbi-1002401-t001">Table 1</xref>) as unknown. Therefore, the extended state vector took the following (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e913" xlink:type="simple"/></inline-formula>-dimensional) form:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e914" xlink:type="simple"/></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e915" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e916" xlink:type="simple"/></inline-formula>. These parameters included the standard deviations of intrinsic and observation noise (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e917" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e918" xlink:type="simple"/></inline-formula>, respectively), the maximal conductances <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e919" xlink:type="simple"/></inline-formula> and reversal potentials <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e920" xlink:type="simple"/></inline-formula> of all currents in the model and the parameters controlling the steady-states and relaxation times of activation and inactivation for the sodium and potassium currents (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e921" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e922" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e923" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e924" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e925" xlink:type="simple"/></inline-formula>). The results from this simulation are illustrated in <xref ref-type="fig" rid="pcbi-1002401-g006">Fig. 6</xref>.</p>
        <fig id="pcbi-1002401-g006" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002401.g006</object-id>
          <label>Figure 6</label>
          <caption>
            <title>Estimation of all parameters in a single-compartment conductance-based model using the fixed-lag smoother.</title>
            <p>Estimation was based on a simulated recording of the membrane potential with duration <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e926" xlink:type="simple"/></inline-formula>. Noise parameters were <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e927" xlink:type="simple"/></inline-formula>. For clarity, only <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e928" xlink:type="simple"/></inline-formula> of activity are illustrated in Ai,ii. (<bold>A</bold>) Smoothing of the membrane potential (Ai) and the unobserved activation and inactivation variables for the sodium and potassium currents (Aii). (<bold>B, C</bold>) Estimated posteriors for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e929" xlink:type="simple"/></inline-formula> (B), <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e930" xlink:type="simple"/></inline-formula> (Ci,ii) and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e931" xlink:type="simple"/></inline-formula> (Ciii,iv). The histograms on the right were constructed form the data on left. (<bold>D</bold>) Box plot of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e932" xlink:type="simple"/></inline-formula> estimated parameter posteriors in the model. These included the standard deviations of intrinsic and observation noise, maximal conductances, reversal potentials and kinetics of all currents in the model (see <xref ref-type="table" rid="pcbi-1002401-t001">Table 1</xref>). The estimates were first normalized according to Eq. 35. Parameter identification numbers are as in <xref ref-type="table" rid="pcbi-1002401-t001">Table 1</xref>. In these simulations, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e933" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e934" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e935" xlink:type="simple"/></inline-formula> and the prior interval for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e936" xlink:type="simple"/></inline-formula> was <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e937" xlink:type="simple"/></inline-formula>.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.g006" xlink:type="simple"/>
        </fig>
        <p>We observed that the true signal (membrane potential) was inferred with very high fidelity (<xref ref-type="fig" rid="pcbi-1002401-g006">Fig. 6Ai</xref>). The sodium activation <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e938" xlink:type="simple"/></inline-formula> was also recovered with very high accuracy, while estimation of the hidden states <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e939" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e940" xlink:type="simple"/></inline-formula> (sodium inactivation and potassium activation, respectively) was also satisfactory (despite significant deviations, the general form of the true hidden states was recovered without any observable impact on the dynamics of the membrane potential), as shown in <xref ref-type="fig" rid="pcbi-1002401-g006">Fig. 6Aii</xref>. Among the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e941" xlink:type="simple"/></inline-formula> estimated parameters, we illustrate (in <xref ref-type="fig" rid="pcbi-1002401-g006">Figs. 6B and 6C</xref>) the estimated posteriors for the reversal potential of sodium <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e942" xlink:type="simple"/></inline-formula> (<xref ref-type="fig" rid="pcbi-1002401-g006">Fig. 6B</xref>) and for parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e943" xlink:type="simple"/></inline-formula> (<xref ref-type="fig" rid="pcbi-1002401-g006">Figs. 6Ci,ii</xref>) and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e944" xlink:type="simple"/></inline-formula> (<xref ref-type="fig" rid="pcbi-1002401-g006">Figs. 6Ciii,iv</xref>), which control the activation of sodium and potassium currents, respectively. We focus on these parameters, because they represent three different characteristic cases. The posteriors of parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e945" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e946" xlink:type="simple"/></inline-formula> are unimodal (see <xref ref-type="fig" rid="pcbi-1002401-g006">Figs. 6Bii and 6Cii</xref>) and they were estimated with relatively high accuracy. Particularly, the posterior for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e947" xlink:type="simple"/></inline-formula> was estimated with very high precision and accuracy, despite its broad prior interval (the y-axis in <xref ref-type="fig" rid="pcbi-1002401-g006">Fig. 6Ci</xref> and the x-axis in <xref ref-type="fig" rid="pcbi-1002401-g006">Fig. 6Cii</xref>). On the other hand, the estimated posterior of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e948" xlink:type="simple"/></inline-formula> covered a large part of its prior interval (the y-axis in <xref ref-type="fig" rid="pcbi-1002401-g006">Fig. 6Ciii</xref> and the x-axis in <xref ref-type="fig" rid="pcbi-1002401-g006">Fig. 6Civ</xref>), its main mode was located at a slightly larger value than the true parameter value, while at least two minor modes seem to be present near the upper bound of the prior interval (the arrow in <xref ref-type="fig" rid="pcbi-1002401-g006">Fig. 6Civ</xref>). These results reiterate our previous conclusion that smoothing may be particularly sensitive to some parameters, but not to others. The posteriors of parameters in the former category are very precise and narrow (as in the case of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e949" xlink:type="simple"/></inline-formula> and, especially, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e950" xlink:type="simple"/></inline-formula>), while the parameters in the latter category are characterized by broader posteriors. Also, we can observe that the fixed-lag smoother has the capability to provide a global approximation of the unknown posteriors, including their variance and the location of major and minor modes (i.e. global and local optima). An overview of all inferred posteriors is given by the box plot in <xref ref-type="fig" rid="pcbi-1002401-g006">Fig. 6D</xref>, which was constructed after all data (as in <xref ref-type="fig" rid="pcbi-1002401-g006">Figs. 6Bi, 6Ci and 6Ciii</xref>) were normalized according to Eq. 35. Again, it may be observed that while some of the estimated parameter posteriors are quite precise and accurate, such as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e951" xlink:type="simple"/></inline-formula> (parameter <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e952" xlink:type="simple"/></inline-formula>), <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e953" xlink:type="simple"/></inline-formula> (parameter <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e954" xlink:type="simple"/></inline-formula>) and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e955" xlink:type="simple"/></inline-formula> (parameter <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e956" xlink:type="simple"/></inline-formula>), others are less precise and accurate, such as the maximal conductances (parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e957" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e958" xlink:type="simple"/></inline-formula>), <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e959" xlink:type="simple"/></inline-formula> (parameter <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e960" xlink:type="simple"/></inline-formula>) and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e961" xlink:type="simple"/></inline-formula> (parameter <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e962" xlink:type="simple"/></inline-formula>).</p>
        <p>The simulation results presented above were obtained by assuming a prior interval for the scaling factors <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e963" xlink:type="simple"/></inline-formula> equal to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e964" xlink:type="simple"/></inline-formula>. When we repeated the simulation using the prior interval <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e965" xlink:type="simple"/></inline-formula>, the true underlying membrane potential was again inferred with very high fidelity (<xref ref-type="fig" rid="pcbi-1002401-g007">Fig. 7Ai</xref>), while the hidden states <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e966" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e967" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e968" xlink:type="simple"/></inline-formula> were also estimated with sufficient accuracy (<xref ref-type="fig" rid="pcbi-1002401-g007">Fig. 7Aii</xref>). In this case, however, the estimates of the “unknown” parameters converged to single points in parameter space (as illustrated, for example, for parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e969" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e970" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e971" xlink:type="simple"/></inline-formula> in <xref ref-type="fig" rid="pcbi-1002401-g007">Figs. 7Bi–ii</xref>), which fall within the support of the posteriors illustrated in <xref ref-type="fig" rid="pcbi-1002401-g006">Figs. 6B and 6C</xref>. The activation and inactivation steady states (<xref ref-type="fig" rid="pcbi-1002401-g007">Fig. 7Ci</xref>, red solid lines) and relaxation times (<xref ref-type="fig" rid="pcbi-1002401-g007">Fig. 7Cii</xref>, red solid lines) as functions of voltage, which were computed from these estimates, were also similar to their corresponding true functions, with the curves for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e972" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e973" xlink:type="simple"/></inline-formula> manifesting the largest deviation from truth (black solid lines in <xref ref-type="fig" rid="pcbi-1002401-g007">Figs. 7Ci,ii</xref>). An overview of the estimated parameter values (after normalizing using Eq. 35) is given in <xref ref-type="fig" rid="pcbi-1002401-g007">Fig. 7Di</xref>. As stated previously, some estimates were close to their true counterparts, while others were not. For example, the activation of the sodium current <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e974" xlink:type="simple"/></inline-formula> (<xref ref-type="fig" rid="pcbi-1002401-g007">Fig. 7Aii</xref>) and its steady state <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e975" xlink:type="simple"/></inline-formula> (<xref ref-type="fig" rid="pcbi-1002401-g007">Fig. 7Ci</xref>), which are important for the correct onset of the action potentials, were inferred with relatively high accuracy. On the other hand, larger errors were observed, for example, in the inference of sodium inactivation (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e976" xlink:type="simple"/></inline-formula>; <xref ref-type="fig" rid="pcbi-1002401-g007">Fig. 7Aii</xref>) or in the estimation of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e977" xlink:type="simple"/></inline-formula> (parameter <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e978" xlink:type="simple"/></inline-formula>; <xref ref-type="fig" rid="pcbi-1002401-g007">Fig. 7Di</xref>), the maximal conductance for the sodium current.</p>
        <fig id="pcbi-1002401-g007" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002401.g007</object-id>
          <label>Figure 7</label>
          <caption>
            <title>The effect of prior parameter intervals on the accuracy of the fixed-lag smoother.</title>
            <p>Estimation was based on a simulated recording of the membrane potential with duration <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e979" xlink:type="simple"/></inline-formula>. Noise parameters were <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e980" xlink:type="simple"/></inline-formula>. For clarity, only <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e981" xlink:type="simple"/></inline-formula> of activity are illustrated in Ai,ii. Unlike <xref ref-type="fig" rid="pcbi-1002401-g006">Fig. 6</xref>, the prior interval for the scaling factors <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e982" xlink:type="simple"/></inline-formula> was now assumed equal to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e983" xlink:type="simple"/></inline-formula>. (<bold>A</bold>) Smoothing of the membrane potential (Ai) and the unobserved activation and inactivation variables for the sodium and potassium currents (Aii). (<bold>B</bold>) Estimates for parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e984" xlink:type="simple"/></inline-formula> (Bi), <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e985" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e986" xlink:type="simple"/></inline-formula> (Bii). Convergence to an optimal parameter vector was achieved after approximately <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e987" xlink:type="simple"/></inline-formula> of activity. Notice that this optimal parameter vector falls within the support of the corresponding parameter posteriors (see <xref ref-type="fig" rid="pcbi-1002401-g006">Figs. 6Bii, 6Cii and 6Civ</xref>). (<bold>C</bold>) Inferred steady states (Ci) and relaxation times (Cii) for the activation and inactivation variables of sodium and potassium currents (red lines) against their true counterparts (black lines). (<bold>D</bold>) Inferred parameter values when broad (Di) or narrow (Dii) prior intervals were used for the parameters controlling the kinetics of sodium and potassium ionic currents (see <xref ref-type="table" rid="pcbi-1002401-t001">Table 1</xref>). Plots A, B and C correspond to plot Di. In Dii, we also illustrate the estimated parameter values when very noisy data were used (see also Supplementary <xref ref-type="supplementary-material" rid="pcbi.1002401.s003">Fig. S3</xref>). In these simulations, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e988" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e989" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e990" xlink:type="simple"/></inline-formula>.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.g007" xlink:type="simple"/>
        </fig>
        <p>Given the fact that the data on which inference was based (a single noisy recording of the membrane potential) was of much lower dimensionality than the extended state we aimed to infer, the observed discrepancies between inferred and true model quantities were unlikely to vanish unless we imposed more strict constraints on the model. When we repeated the previous simulation using more narrow prior intervals for some of the parameters controlling the kinetics of the sodium and potassium currents in the model (see red dashed boxes in <xref ref-type="fig" rid="pcbi-1002401-g007">Fig. 7Dii</xref> and bold intervals in <xref ref-type="table" rid="pcbi-1002401-t001">Table 1</xref>), the estimated parameters settled closer to their true values (<xref ref-type="fig" rid="pcbi-1002401-g007">Fig. 7Dii</xref>). This was true even for parameters on which more narrow intervals were not directly applied, such as the maximal conductances (i.e. parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e991" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e992" xlink:type="simple"/></inline-formula> in <xref ref-type="fig" rid="pcbi-1002401-g007">Fig. 7Dii</xref>), and even when data with higher levels of observation noise were used (<xref ref-type="fig" rid="pcbi-1002401-g007">Fig. 7Dii</xref>, data points indicated with crosses; see also <xref ref-type="supplementary-material" rid="pcbi.1002401.s003">Fig. S3</xref>). It is important to mention that using more narrow prior constraints only affected the accuracy of the final estimates, not the quality of fitting the experimental data, which in all cases was of very high fidelity. Alternatively, we could have constrained the model by increasing the dimensionality of the observed signal, e.g. by using simultaneously more that one unique voltage traces (each generated under different conditions of injected current) during smoothing. We examine the use of multiple data sets simultaneously as input to the fixed-lag smoother later in the <xref ref-type="sec" rid="s3">Results</xref> section.</p>
        <p>In summary, the smoothing algorithm can be used to resolve high-dimensional inference problems. In combination with sufficient prior information (in the form of bounded regions within which parameters are allowed to fluctuate; see <xref ref-type="table" rid="pcbi-1002401-t001">Table 1</xref>), the fixed-lag smoother can provide estimates of the intrinsic and observation noise, maximal conductances, reversal potentials and kinetics of ionic currents in a single-compartment Hodgkin-Huxley-type neuron model, based on low-dimensional noisy experimental data.</p>
      </sec>
      <sec id="s3e">
        <title>Parameter Estimation in Compartmental Models is Straightforward Using the Fixed-Lag Smoother</title>
        <p>Next, we tested whether the fixed-lag smoother could be successfully applied on inference problems involving more complex models than the one we used in the previous sections. For this reason, we focused on a two-compartment model of a vertebrate motoneuron containing sodium, potassium and calcium currents and intracellular calcium dynamics, which were differentially distributed among a soma and a dendritic compartment <xref ref-type="bibr" rid="pcbi.1002401-Booth1">[37]</xref>. The model (modified appropriately to include intrinsic noise terms) is summarized below:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e993" xlink:type="simple"/><label>(36)</label></disp-formula><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e994" xlink:type="simple"/><label>(37)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e995" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e996" xlink:type="simple"/></inline-formula> is the membrane potential at the soma and dendritic compartments, respectively, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e997" xlink:type="simple"/></inline-formula>. The leakage conductance and reversal potential were <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e998" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e999" xlink:type="simple"/></inline-formula>, respectively. The coupling conductance was <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1000" xlink:type="simple"/></inline-formula> and the ratio of the soma area to the total surface area of the cell was <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1001" xlink:type="simple"/></inline-formula>. The various ionic currents in the above model were as follows: (a) a transient sodium current, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1002" xlink:type="simple"/></inline-formula>, (b) a delayed rectifier potassium current, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1003" xlink:type="simple"/></inline-formula>, (c) a calcium-activated potassium current, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1004" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1005" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1006" xlink:type="simple"/></inline-formula> (the half-saturation constant), (d) an N-type calcium current, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1007" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1008" xlink:type="simple"/></inline-formula> and (e) an L-type calcium current, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1009" xlink:type="simple"/></inline-formula>. The various activation and inactivation dynamic variables in the above model were modeled using first-order relaxation kinetics (as in Eq. 32), where the various steady states were assumed to be sigmoid functions of voltage (Eq. 33). Notice, that the activation of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1010" xlink:type="simple"/></inline-formula> was assumed instantaneous and therefore, it was given at any time by the voltage-dependent steady state <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1011" xlink:type="simple"/></inline-formula>. The relaxation times for sodium inactivation and potassium activation were also functions of voltage as in Eq. 34:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1012" xlink:type="simple"/><label>(38)</label></disp-formula><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1013" xlink:type="simple"/><label>(39)</label></disp-formula>where the parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1014" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1015" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1016" xlink:type="simple"/></inline-formula> (with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1017" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1018" xlink:type="simple"/></inline-formula>) were chosen by fitting the above expressions to the original model in <xref ref-type="bibr" rid="pcbi.1002401-Booth1">[37]</xref>. The relaxation times for the remaining activation and inactivation variables were constant. All parameters values in the model are given in <xref ref-type="table" rid="pcbi-1002401-t002">Table 2</xref>.</p>
        <p>The intracellular calcium concentration at either the soma or the dendritic compartment was also modeled by a first-order differential equation, as follows:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1019" xlink:type="simple"/><label>(40)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1020" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1021" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1022" xlink:type="simple"/></inline-formula>. The total calcium current is <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1023" xlink:type="simple"/></inline-formula> at the soma (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1024" xlink:type="simple"/></inline-formula>) and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1025" xlink:type="simple"/></inline-formula> at the dendritic compartment (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1026" xlink:type="simple"/></inline-formula>).</p>
        <p>The observation model assumed simultaneous noisy recordings of the membrane potential from both the soma and dendritic compartments, as follows:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1027" xlink:type="simple"/><label>(41)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1028" xlink:type="simple"/></inline-formula> with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1029" xlink:type="simple"/></inline-formula>. Notice that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1030" xlink:type="simple"/></inline-formula> is the same for both compartments.</p>
        <p>In the above model, the externally injected currents <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1031" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1032" xlink:type="simple"/></inline-formula> were sequences of random current steps with duration up to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1033" xlink:type="simple"/></inline-formula> (instead of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1034" xlink:type="simple"/></inline-formula> as in the single-compartment model, due to the presence of slower currents in the two-compartment model) and magnitude between <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1035" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1036" xlink:type="simple"/></inline-formula>. Current was injected in both the dendritic compartment and the soma (instead of just in the soma), because preliminary simulations indicated that this experimental setting facilitated parameter estimation, presumably due to the generation of a more variable (and, thus, information-rich) data set. The injected currents and the induced noisy voltage traces <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1037" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1038" xlink:type="simple"/></inline-formula> comprised the simulated data on which parameter estimation was based.</p>
        <p>First, we aimed to infer the noise parameters and maximal conductances of all voltage- and calcium-gated currents in the model, assuming that the kinetics of these currents were known. This implied an extended-state vector with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1039" xlink:type="simple"/></inline-formula> components as shown below<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1040" xlink:type="simple"/></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1041" xlink:type="simple"/></inline-formula>. The results from this simulation are illustrated in <xref ref-type="fig" rid="pcbi-1002401-g008">Figs. 8</xref> and <xref ref-type="fig" rid="pcbi-1002401-g009">9</xref>. The fixed-lag smoother managed to recover the hidden dynamic states (including the time-evolution of the intracellular calcium; <xref ref-type="fig" rid="pcbi-1002401-g008">Fig. 8</xref>), the standard deviations of the intrinsic and observation noise (<xref ref-type="fig" rid="pcbi-1002401-g009">Figs. 9Ai,ii</xref>) and the true values of all the gated maximal conductances (<xref ref-type="fig" rid="pcbi-1002401-g009">Figs. 9Bi–iv</xref>) in the model using approximately <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1042" xlink:type="simple"/></inline-formula> of simulated data and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1043" xlink:type="simple"/></inline-formula> particles. Notice that, in <xref ref-type="fig" rid="pcbi-1002401-g008">Figs. 8Ci–iv</xref>, the inferred hidden gating states (dashed red lines) coincide extremely well with the true ones (solid black lines), which is not surprising, since the voltage-dependent kinetics of these states were assumed known and the true membrane potential at the soma and dendritic compartment was recovered with very high fidelity (<xref ref-type="fig" rid="pcbi-1002401-g008">Figs. 8Ai,ii</xref>). Also, notice that, in <xref ref-type="fig" rid="pcbi-1002401-g009">Figs. 9Aii, 9Biii and 9Biv</xref>, the estimation of the standard deviation of the intrinsic noise, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1044" xlink:type="simple"/></inline-formula>, and the maximal conductances of calcium and calcium-dependent currents in the dendritic compartment (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1045" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1046" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1047" xlink:type="simple"/></inline-formula>) was improved after injecting current in both the soma and the dendritic compartment (compare the grey solid lines, which correspond to injection in the soma only, to the color ones in the aforementioned figures).</p>
        <fig id="pcbi-1002401-g008" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002401.g008</object-id>
          <label>Figure 8</label>
          <caption>
            <title>Simultaneous estimation of hidden model states (including intracellular calcium concentrations) and maximal conductances in a two-compartment model of a vertebrate motoneuron (I).</title>
            <p>Estimation was based on two <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1048" xlink:type="simple"/></inline-formula>-long simulated recordings of the membrane potential, each recorded simultaneously from the soma and the dendritic compartment. Only part of the recorded activity is illustrated in A, B and C for clarity. Notice the different time scales between the right and left panels. (<bold>A</bold>) High-fidelity smoothing of the membrane potential at the soma (Ai) and the dendritic compartment (Aii). (<bold>B</bold>) Inference of the unobserved calcium concentrations at the soma (Bi) and the dendrite (Bii). (<bold>C</bold>) Inference of the unobserved activation and inactivation variables for the sodium and potassium currents (Ci) and the N-type calcium current (Ciii) at the soma and the N-type (Cii) and L-type (Civ) calcium currents at the dendritic compartment. Notice the almost complete overlap between true (black lines) and inferred (red lines) dynamic variables in Ci–iv. This was not surprising since we assumed, at this stage, that the kinetics of all gated currents were known. In these simulations, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1049" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1050" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1051" xlink:type="simple"/></inline-formula> and the prior interval for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1052" xlink:type="simple"/></inline-formula> was <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1053" xlink:type="simple"/></inline-formula>.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.g008" xlink:type="simple"/>
        </fig>
        <fig id="pcbi-1002401-g009" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002401.g009</object-id>
          <label>Figure 9</label>
          <caption>
            <title>Simultaneous estimation of hidden model states (including intracellular calcium concentrations) and maximal conductances in a two-compartment model of a vertebrate motoneuron (II).</title>
            <p>Inference of maximal conductances and noise parameters during fixed-lag smoothing. (<bold>A</bold>) The standard deviations of the observation (Ai) and the intrinsic (Aii) noise at the soma and the dendrite. (<bold>B</bold>) Inferred maximal conductances of the sodium and potassium currents at the soma (Bi), of the N-type calcium current and the calcium-activated potassium current at the soma (Bii), of the calcium-activated potassium current at the dendrite (Biii) and of the N-type and L-type calcium currents at the dendrite (Biv). In all cases, parameter expectations gradually converged towards the true parameter values (dashed lines) after less than <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1054" xlink:type="simple"/></inline-formula>. The grey lines in Aii, Biii and Biv correspond to estimated parameters, when current was injected in the soma only. In these simulations, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1055" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1056" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1057" xlink:type="simple"/></inline-formula> and the prior interval for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1058" xlink:type="simple"/></inline-formula> was <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1059" xlink:type="simple"/></inline-formula>.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.g009" xlink:type="simple"/>
        </fig>
        <p>In a second stage, we assumed that the kinetics of all voltage-gated ionic currents were also unknown, implying an extended state vector with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1060" xlink:type="simple"/></inline-formula> components, as follows:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1061" xlink:type="simple"/></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1062" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1063" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1064" xlink:type="simple"/></inline-formula>. Our results from this simulation are summarized in <xref ref-type="fig" rid="pcbi-1002401-g010">Figs. 10</xref> and <xref ref-type="fig" rid="pcbi-1002401-g011">11</xref>. Again, the membrane potential at the soma and the dendrite were inferred with very high fidelity (<xref ref-type="fig" rid="pcbi-1002401-g010">Fig. 10Ai,ii</xref>). However, the estimated hidden dynamics of most ionic currents and intracellular calcium concentrations in the model deviated significantly from their true counterparts (<xref ref-type="fig" rid="pcbi-1002401-g010">Fig. 10B,C</xref>). The expectations of all estimated parameters are illustrated in <xref ref-type="fig" rid="pcbi-1002401-g011">Fig. 11Ai</xref>. As in the case of the single-compartment model, by imposing tighter prior constraints on some of the parameters controlling the kinetics of ionic currents in the model (see red dashed box in <xref ref-type="fig" rid="pcbi-1002401-g011">Fig. 11Aii</xref> and <xref ref-type="table" rid="pcbi-1002401-t002">Table 2</xref>), we managed to reduce the discrepancies of the estimates from their true values (<xref ref-type="fig" rid="pcbi-1002401-g011">Fig. 11Aii</xref> and Supplementary <xref ref-type="supplementary-material" rid="pcbi.1002401.s004">Fig. S4</xref>). This was true even for parameters on which stricter priors were not directly applied. The inference was completed after processing almost <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1065" xlink:type="simple"/></inline-formula> of data, as shown in <xref ref-type="fig" rid="pcbi-1002401-g011">Fig. 11B</xref> for the maximal conductances of sodium and potassium currents at the soma. Interestingly, the algorithm seems to temporarily settle at local optima (see arrows in <xref ref-type="fig" rid="pcbi-1002401-g011">Fig. 11B</xref>) before “jumping” away and, eventually, converge at the final estimates. The inferred voltage-dependent steady-states of the sodium, potassium and calcium currents (<xref ref-type="fig" rid="pcbi-1002401-g011">Figs. 11Ci,ii</xref>) and the relaxation times for the sodium inactivation and potassium activation (<xref ref-type="fig" rid="pcbi-1002401-g011">Fig. 11Ciii</xref>) were also very similar to their true corresponding functions. The algorithm remained operational when more noisy data were used, as illustrated in <xref ref-type="fig" rid="pcbi-1002401-g011">Fig. 11Aii</xref> and in Supplementary <xref ref-type="supplementary-material" rid="pcbi.1002401.s005">Fig. S5</xref>.</p>
        <fig id="pcbi-1002401-g010" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002401.g010</object-id>
          <label>Figure 10</label>
          <caption>
            <title>Simultaneous estimation of hidden model states, maximal conductances and kinetic parameters in a two-compartment model of a vertebrate motoneuron (I).</title>
            <p>Estimation was based on two simulated <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1066" xlink:type="simple"/></inline-formula>-long simultaneous recordings of the membrane potential from the soma and dendritic compartment. Only part of this data is illustrated for clarity. Notice the different time scales between the left and right panels. (<bold>A</bold>) High-fidelity smoothing of the observed voltage at the soma (Ai) and the dendrite (Aii). (<bold>B</bold>) Inference of unobserved calcium concentrations at the soma (Bi) and dendritic compartment (Bii). (<bold>C</bold>) Inference of the unobserved activation and inactivation variables for all voltage-gated currents at the soma and the dendrite. Since the kinetics of voltage-gated currents were assumed unknown, the difference between true (black lines) and inferred (red lines) dynamic variables was significant (compare to <xref ref-type="fig" rid="pcbi-1002401-g008">Fig. 8</xref>). The inferred parameters are shown in <xref ref-type="fig" rid="pcbi-1002401-g007">Fig. 7Ai</xref>. In these simulations, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1067" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1068" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1069" xlink:type="simple"/></inline-formula> and the prior interval for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1070" xlink:type="simple"/></inline-formula> was <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1071" xlink:type="simple"/></inline-formula>.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.g010" xlink:type="simple"/>
        </fig>
        <fig id="pcbi-1002401-g011" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002401.g011</object-id>
          <label>Figure 11</label>
          <caption>
            <title>Simultaneous estimation of hidden model states, maximal conductances and kinetic parameters in a two-compartment model of a vertebrate motoneuron (II).</title>
            <p>Inference of maximal conductances, noise and kinetic parameters during smoothing. (<bold>A</bold>) Inferred parameters in the model using broad or narrow prior intervals and high or low levels of observation noise. Estimates were normalized according to Eq. 35. Parameter identification numbers are as in <xref ref-type="table" rid="pcbi-1002401-t002">Table 2</xref>. The estimates in Ai were obtained using broad prior intervals (see <xref ref-type="table" rid="pcbi-1002401-t002">Table 2</xref>). The maximal conductance <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1072" xlink:type="simple"/></inline-formula> (parameter #7) converged to zero and, for this reason, it is indicated with a red square. These estimates correspond to the results shown in <xref ref-type="fig" rid="pcbi-1002401-g010">Fig. 10</xref>. Estimates in Aii were obtained using narrow prior intervals for some of the parameters controlling the kinetics of ionic currents (see red dashed boxes) at either low (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1073" xlink:type="simple"/></inline-formula>) or high (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1074" xlink:type="simple"/></inline-formula>) levels of observation noise (see also Supplementary <xref ref-type="supplementary-material" rid="pcbi.1002401.s004">Figs. S4</xref> and <xref ref-type="supplementary-material" rid="pcbi.1002401.s005">S5</xref>). (<bold>B</bold>) Inferred maximal conductances for sodium (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1075" xlink:type="simple"/></inline-formula>) and potassium (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1076" xlink:type="simple"/></inline-formula>) when narrow prior intervals and low levels of observation noise were used (circles in Aii). Notice the temporary convergence of the estimates (arrows) before jumping away towards their final values. (<bold>C</bold>) True (black lines) and inferred (red lines) activation and inactivation steady-states for the sodium and potassium currents (Ci) and the N-type and L-type calcium currents (Cii) and for the relaxation times for sodium inactivation and potassium activation (Ciii), when narrow prior intervals and low levels of observation noise were used (circles in Aii). In these simulations, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1077" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1078" xlink:type="simple"/></inline-formula> and the prior interval for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1079" xlink:type="simple"/></inline-formula> was <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1080" xlink:type="simple"/></inline-formula>. The number of particles was <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1081" xlink:type="simple"/></inline-formula> in Ai and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1082" xlink:type="simple"/></inline-formula> in Aii, B and C (see main text for further comments).</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.g011" xlink:type="simple"/>
        </fig>
        <p>An interesting fact regarding the simulation results presented in <xref ref-type="fig" rid="pcbi-1002401-g010">Figs. 10</xref> and <xref ref-type="fig" rid="pcbi-1002401-g011">11Ai</xref> was that, in order to obtain high-fidelity estimates of the true membrane potential at the soma and dendritic compartment (as shown in <xref ref-type="fig" rid="pcbi-1002401-g010">Figs. 10Ai,ii</xref>) we had to use more than <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1083" xlink:type="simple"/></inline-formula> particles, the number calculated by the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1084" xlink:type="simple"/></inline-formula> rule (see <xref ref-type="sec" rid="s2">Methods</xref>). In particular, we used <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1085" xlink:type="simple"/></inline-formula> particles, although we cannot exclude that a smaller number may have sufficed. After applying more narrow prior constraints (<xref ref-type="fig" rid="pcbi-1002401-g011">Figs. 11Aii, B, C</xref>, <xref ref-type="supplementary-material" rid="pcbi.1002401.s004">S4</xref> and <xref ref-type="supplementary-material" rid="pcbi.1002401.s005">S5</xref>), using the number of particles calculated by the above simple heuristic (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1086" xlink:type="simple"/></inline-formula> in this case) was again sufficient for accurately inferring the true membrane potential (see <xref ref-type="supplementary-material" rid="pcbi.1002401.s004">Fig. S4Ai,ii</xref> and <xref ref-type="supplementary-material" rid="pcbi.1002401.s005">S5Ai,ii</xref>). This implies that as the complexity (and dimensionality) of the estimation problem increases, a non-linearly growing number of particles may be required in order to obtain acceptable results, but this situation may be compensated for by providing highly informative priors. It should be mentioned that the two-compartment model allows for the physical separation of currents and as such it is a slightly better approximation of a real neuron with differential expression of individual currents in different cellular compartments. However, in no way does it capture the full morphological complexity of a real neuron. As such, current injection into the dendritic compartment can not be replicated accurately in a real neuron, as current injection in the model will have a uniform effect on all currents in that compartment, whilst current injection into the dendrite of a neuron would have far more complex effects on dendritic currents, which potentially would be dependent on the distance from the injection site. Thus, whilst it would be possible, albeit challenging, to carry out dual recordings from the soma and dendrites in a real neuron this would not be the same as the dual current injection in the model. In this case, application of the fixed-lag smoother on a more spatially detailed model would be necessary (and feasible). In principle, the method can also assimilate other types of spatial data, such as calcium imaging data, in case recordings from multiple neuron locations are not available (although we do not examine this case in detail in this paper).</p>
        <p>Given the large number of unknown parameters and hidden states in combination with the low dimensionality of the data (notice that the intracellular calcium concentration was assumed unobserved), it was truly remarkable that the algorithm managed to recover much of the extended state vector with relatively satisfactory accuracy. However, it should be noted that in our simulations we assumed knowledge of important information, such as the passive conductances <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1087" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1088" xlink:type="simple"/></inline-formula> and the reversal potentials of sodium, potassium and calcium currents. This and the fact that the availability of prior information in the form of more narrow parameter boundaries improved significantly the accuracy of the final estimates emphasizes our previous conclusion that prior information is important for the successful inference of unknown model parameters and hidden model states using the fixed-lag smoother. Given such information, inference in complex compartmental models based on simultaneous recordings from several neuron locations and, possibly, measurements of intracellular calcium, can be naturally achieved via appropriate formulation of the extended state vector and application of the fixed-lag smoother.</p>
      </sec>
      <sec id="s3f">
        <title>Parameters in a Model of an Invertebrate Motoneuron were Inferred from Actual Electrophysiological Data Using the Fixed-Lag Smoother</title>
        <p>In a final set of simulations, we applied the smoother on actual electrophysiological data in order to estimate the unknown parameters in a single-compartment model of the B4 motoneuron from the nervous system of the pond snail, <italic>Lymnaea stagnalis</italic> <xref ref-type="bibr" rid="pcbi.1002401-Straub1">[38]</xref>. This neuron is part of a population of motoneurons, which receive rhythmic electrical input from upstream Central Pattern Generator interneurons and in turn innervate and control the movements of the feeding muscles via which the animal captures and ingests its food. Previous studies in these neurons have demonstrated the presence of a transient inward sodium current <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1089" xlink:type="simple"/></inline-formula>, a delayed outward potassium current <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1090" xlink:type="simple"/></inline-formula> and a transient outward potassium current <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1091" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pcbi.1002401-Vehovszky1">[41]</xref>. A hyperpolarization-activated current <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1092" xlink:type="simple"/></inline-formula> was conditional on the presence of serotonin in the solution <xref ref-type="bibr" rid="pcbi.1002401-Straub1">[38]</xref> and, therefore, this current was not included in this instance of the B4 model. Thus, the current conservation equation for a single-compartment model of the B4 motoneuron (appropriately modified to include an intrinsic noise term) took the following form:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1093" xlink:type="simple"/><label>(42)</label></disp-formula>where the leakage conductance, leakage reversal potential and membrane capacitance in the above model were estimated <italic>a priori</italic> based on neuron responses to negative current pulses (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1094" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1095" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1096" xlink:type="simple"/></inline-formula>, respectively). The voltage-activated currents that appear in the above expression were modeled as follows: (a) <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1097" xlink:type="simple"/></inline-formula>, (b) <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1098" xlink:type="simple"/></inline-formula> and (c) <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1099" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1100" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1101" xlink:type="simple"/></inline-formula> as in <xref ref-type="bibr" rid="pcbi.1002401-Vehovszky1">[41]</xref>. The dynamic activation and inactivation variables of these currents (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1102" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1103" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1104" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1105" xlink:type="simple"/></inline-formula>) obeyed first-order relaxation kinetics (as in Eq. 32) with voltage-dependent steady-states (Eq. 33) and relaxation times (Eq. 34 with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1106" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1107" xlink:type="simple"/></inline-formula>), similarly to previously published neuron models in the central nervous system of <italic>Lymnaea</italic> <xref ref-type="bibr" rid="pcbi.1002401-Vavoulis1">[42]</xref>. The observation model was as in Eq. 7.</p>
        <p>The raw data we used for inferring the parameters in the above model took the form of four independent <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1108" xlink:type="simple"/></inline-formula>-long recordings of the membrane potential from the same B4 motoneuron. Each recording was taken while injecting an external current in the neuron consisting of a sequence of random steps ranging in amplitude between <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1109" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1110" xlink:type="simple"/></inline-formula> and with duration between <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1111" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1112" xlink:type="simple"/></inline-formula>. A particular characteristic of the data generated under these conditions was the presence of brief bursts of spikes, which were interrupted by relatively long intervals of non-activity (corresponding to sub-threshold excitatory and inhibitory current injections, respectively; see <xref ref-type="fig" rid="pcbi-1002401-g012">Figs. 12Ai–iv</xref>). These long intervals of inactivity were not informative and they negatively affected the performance of the smoother by permitting the random drift of particles towards non-optimal regions of the parameter space (see Supplementary <xref ref-type="supplementary-material" rid="pcbi.1002401.s006">Fig. S6</xref>). However, when the four recordings are considered together, the intervals of inactivity at any single voltage trace overlap with intervals of activity at the remaining three voltage traces, resulting in a four-dimensional data set, where the overall intervals of inactivity were minimized. This four-dimensional data set was used as input to the smoother during the inference phase.</p>
        <fig id="pcbi-1002401-g012" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002401.g012</object-id>
          <label>Figure 12</label>
          <caption>
            <title>Parameter estimation in a model invertebrate motoneuron based on actual electrophysiological data.</title>
            <p>Estimation was based on four independent <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1113" xlink:type="simple"/></inline-formula>-long recordings of the membrane potential from the same B4 motoneuron. (<bold>A</bold>) Simultaneous, high-fidelity smoothing of the four membrane potential recordings. (<bold>B</bold>) A total of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1114" xlink:type="simple"/></inline-formula> free parameters in the model were inferred during smoothing (see <xref ref-type="table" rid="pcbi-1002401-t003">Table 3</xref>), including the maximal conductances of the transient sodium and potassium and persistent potassium currents (Bi), the half steady-state activation values (Bii) and the relaxation times for the activation of the potassium currents (Biii). The remaining inferred parameters are not illustrated for clarity, but they follow a similar convergence pattern. (<bold>C</bold>) Box plot of all inferred parameters in the model. Parameter identification numbers are as in <xref ref-type="table" rid="pcbi-1002401-t003">Table 3</xref>. Estimates were normalized as explained in the main text (the non-normalized mean parameter values are given in <xref ref-type="table" rid="pcbi-1002401-t003">Table 3</xref>). In this simulation, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1115" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1116" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1117" xlink:type="simple"/></inline-formula> and the prior interval for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1118" xlink:type="simple"/></inline-formula> was <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1119" xlink:type="simple"/></inline-formula>.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.g012" xlink:type="simple"/>
        </fig>
        <p>Thus, the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1120" xlink:type="simple"/></inline-formula>-dimensional extended state vector became:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1121" xlink:type="simple"/></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1122" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1123" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1124" xlink:type="simple"/></inline-formula>. Notice the presence of four groups of hidden dynamic states, {<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1125" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1126" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1127" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1128" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1129" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1130" xlink:type="simple"/></inline-formula>}, where each group corresponds to a different voltage trace (and associated externally injected current, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1131" xlink:type="simple"/></inline-formula>). The evolution of all four groups of dynamic variables was governed by a common (shared) set of parameters. In total, we had to estimate <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1132" xlink:type="simple"/></inline-formula> unknown parameters. The boundaries within which the values of these parameters were allowed to fluctuate are given in <xref ref-type="table" rid="pcbi-1002401-t003">Table 3</xref> (indicated in bold) and they were chosen from within the support of the posteriors in Supplementary <xref ref-type="supplementary-material" rid="pcbi.1002401.s007">Fig. S7</xref> (after a few trial-and-error simulations), which were obtained by using the broader prior intervals given in <xref ref-type="table" rid="pcbi-1002401-t003">Table 3</xref>. Notice that the marginal distributions illustrated in <xref ref-type="supplementary-material" rid="pcbi.1002401.s007">Fig. S7</xref> have large variance and multiple modes and, although they provide a global view of the structure of the parameter space, they cannot be used to identify a single combination of optimal parameters values, since they do not include any information regarding correlations between parameters. Using the major modes of the inferred posteriors did not lead to an accurate (or even spiking) predictive model. Thus, the estimation was based on using more narrow prior intervals, which helped us estimate unimodal posteriors with small variance (see <xref ref-type="fig" rid="pcbi-1002401-g012">Fig. 12C</xref>) and, thus, identify a single combination of optimal parameters that could be used in predictive simulations. We cannot prove that other optimal combinations of parameters do not exist, but we were not able to find any (i.e. by choosing different narrow prior intervals) after a reasonable amount of time. Also, notice that the standard deviations of the intrinsic and observation noise were not subject to estimation, but instead they were given (through trial and error) the minimal fixed values <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1133" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1134" xlink:type="simple"/></inline-formula>, respectively. If left free during smoothing, the values of these parameters fluctuated uncontrollably, masking the contribution of the remaining parameters in the model and, thus, achieving an almost perfect (but meaningless) smoothing of the experimental data. This is an indication that the B4 model we used may be missing one or more relevant components, such as additional currents and compartments (see below for further analysis of this point). We did not observe this effect in the cases examined in the previous sections, where simulated data was used, because the models responsible for the generation of this data were, by definition, precisely known.</p>
        <p>Our results from this set of simulations are illustrated in <xref ref-type="fig" rid="pcbi-1002401-g012">Fig. 12</xref>. Simultaneous smoothing of all four data sets was again accomplished with high fidelity, as illustrated in <xref ref-type="fig" rid="pcbi-1002401-g012">Figs. 12Ai–iv</xref>. The artificial evolution of the expectations of the conductances for the transient sodium, persistent potassium and transient potassium currents, as well as of some of the kinetic parameters that were estimated in the model is illustrated in <xref ref-type="fig" rid="pcbi-1002401-g012">Figs. 12Bi–iii</xref>. The distributions of all inferred parameters (normalized after replacing <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1135" xlink:type="simple"/></inline-formula> in Eq. 35 with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1136" xlink:type="simple"/></inline-formula>, for each tested parameter) are also illustrated in <xref ref-type="fig" rid="pcbi-1002401-g012">Fig. 12C</xref>. The inferred expectations of all parameters are given in <xref ref-type="table" rid="pcbi-1002401-t003">Table 3</xref>.</p>
        <p>In order to examine the predictive value of the model given the estimated parameter expectations in <xref ref-type="table" rid="pcbi-1002401-t003">Table 3</xref>, we compared its activity to that of the biological B4 neuron, when both were injected with a <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1137" xlink:type="simple"/></inline-formula>-long random current consisting of a sequence of current pulses with amplitude ranging from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1138" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1139" xlink:type="simple"/></inline-formula> and duration from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1140" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1141" xlink:type="simple"/></inline-formula>. Our results from this simulation are illustrated in <xref ref-type="fig" rid="pcbi-1002401-g013">Fig. 13</xref>. We observed that the overall pattern of activity of the model was similar to that of the biological neuron (<xref ref-type="fig" rid="pcbi-1002401-g013">Fig. 13A</xref>). Whilst the model overall generated more action potentials, some individual spikes were absent in the simulated data. A more detailed examination of our data revealed specific differences between the biological and model neurons, which explain the differences in the overall activity between the two (<xref ref-type="fig" rid="pcbi-1002401-g013">Fig. 13B, C</xref>). The spike shape of the model neuron was quite similar to that of its biological counterpart (<xref ref-type="fig" rid="pcbi-1002401-g013">Fig. 13Bi</xref>), including spike threshold, peak, trough and height (i.e. trough-to-peak amplitude; <xref ref-type="fig" rid="pcbi-1002401-g013">Fig. 13Biii</xref>), but the simulated spike had a slightly longer duration than the biological one (half-width: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1142" xlink:type="simple"/></inline-formula> vs <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1143" xlink:type="simple"/></inline-formula>; <xref ref-type="fig" rid="pcbi-1002401-g013">Fig. 13Bii</xref>).</p>
        <fig id="pcbi-1002401-g013" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002401.g013</object-id>
          <label>Figure 13</label>
          <caption>
            <title>Comparison between B4 model activity and the biological neuron.</title>
            <p>(<bold>A</bold>) Response of the model and the biological B4 motoneuron to a sequence of current steps with random amplitude and duration. Current step amplitudes were from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1144" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1145" xlink:type="simple"/></inline-formula> and current step durations from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1146" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1147" xlink:type="simple"/></inline-formula>. Intrinsic and observation noise in the model were <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1148" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1149" xlink:type="simple"/></inline-formula>, respectively. (<bold>B</bold>) Comparison between model and biological B4 action potentials. The width of the spikes was measured at half their peak amplitude. (<bold>C</bold>) Current-Voltage (IV) and Current-Frequency (IF) relations for the model and biological B4 neurons. In order to construct these relations both the model and biological neurons were injected with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1150" xlink:type="simple"/></inline-formula>-long current pulses with amplitude between <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1151" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1152" xlink:type="simple"/></inline-formula>.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.g013" xlink:type="simple"/>
        </fig>
        <p>In a second set of experiments, both the biological and model neurons were injected with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1153" xlink:type="simple"/></inline-formula>-long current pulses ranging from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1154" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1155" xlink:type="simple"/></inline-formula> and their current-voltage (IV) and current-frequency (IF) relations were constructed (<xref ref-type="fig" rid="pcbi-1002401-g013">Fig. 13C</xref>). The IV plot showed some non-linear behavior in response to negative current pulses in the experimental data (probably due to the presence of a residual <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1156" xlink:type="simple"/></inline-formula> current), which was not present in the simulations (<xref ref-type="fig" rid="pcbi-1002401-g013">Fig. 13Ci</xref>). As a result, the slope of the part of the IV curve corresponding to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1157" xlink:type="simple"/></inline-formula> was more shallow in the simulations than in the experimental data. Moreover, the rheobase was lower in the experimental data than in the model, but the slope of the IF curve was steeper in the simulated data, which resulted in higher firing rates for the model at injected currents larger than approximately <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1158" xlink:type="simple"/></inline-formula> (<xref ref-type="fig" rid="pcbi-1002401-g013">Fig. 13Cii</xref>). This feature can account for the overall level of spiking in the model neuron when compared to the biological one (<xref ref-type="fig" rid="pcbi-1002401-g013">Fig. 13A</xref>).</p>
        <p>Overall, this analysis illustrates that the assumed B4 model did not capture all the aspects of the real neuron. However, this does not mean that our estimation method is flawed. It just shows that the model is actually missing some relevant components, such as additional ionic currents or compartments, which would be necessary for approximating more accurately the spatial structure and biophysical properties of the biological neuron. In the first part of the manuscript we have demonstrated that if the underlying model is complete, then our method produced accurate estimates of the true parameter values, given sufficient informative priors. Thus, it is safe to assume that the observed differences between the biological and model neurons can be minimized, if the fixed-lag smoother is applied on a more complex model of the B4 motoneuron.</p>
        <p>In summary, we used the fixed-lag smoother to estimate the unknown parameters in a single-compartment model of an invertebrate motoneuron based on actual electrophysiological data. The model, although a simplification of the actual biological system, was still quite complex containing a number of non-linearly interacting components and a total of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1159" xlink:type="simple"/></inline-formula> unknown parameters. By using the methodologies outlined in the previous sections, we managed to estimate the values of these parameters, such that the resulting model mimicked with satisfactory accuracy the overall activity of its biological counterpart. Furthermore, we demonstrated the flexibility of the fixed-lag smoother by showing how it can be used to process simultaneously multiple data sets, given an appropriate formulation of the extended state vector.</p>
      </sec>
    </sec>
    <sec id="s4">
      <title>Discussion</title>
      <p>Parameter estimation in conductance-based neuron models traditionally involves a global optimization algorithm (for example, an evolutionary algorithm), usually in combination with a local search method (such as gradient descent), in order to find combinations of model parameters that minimize a pre-defined cost function. In this paper, we have addressed the problem of parameter estimation in Hodgkin-Huxley-type models of single neurons from a different perspective. By adopting a hidden-dynamical-systems formalism and expressing parameter estimation as an inference problem in these systems, we made possible the application of a range of well-established inference methods from the field of Computational Statistics. Although it is usually assumed that the kinetics of ionic currents in a conductance-based model are known <italic>a priori</italic>, here we assumed that this was not the case and, typically, we estimated kinetic parameters, along with the maximal conductances and reversal potentials of ionic currents in the models we examined.</p>
      <p>The particular method we used was Kitagawa's self-organizing state-space model, which was implemented as a fixed-lag smoother. The smoother was combined with an adaptive algorithm for sampling new sets of parameters akin to the Covariance Matrix Adaptation Evolution Strategy. Alternatively, we could have approximated the smoother distribution (Eq. 13) with a two-pass algorithm, consisting of a forward filter followed by a backward smoothing phase, which would make use of the precomputed filter <xref ref-type="bibr" rid="pcbi.1002401-Cappe1">[34]</xref>. This would require storing the filter for the whole duration of the smoothed data, which in turn would have very high memory requirements when large numbers of particles or high-dimensional problems are considered. In contrast, the fixed-lag smoother has the advantage that only the particles up to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1160" xlink:type="simple"/></inline-formula> time steps in the past need to be stored, which is less demanding in memory size and computationally more efficient. Moreover, the fixed-lag smoother, being a single-pass algorithm, was more natural to use in the context of on-line parameter estimation.</p>
      <p>The applicability of the algorithm was demonstrated on a number of conductance-based models using noisy simulated or actual electrophysiological data. In a recent study, it was found that increasing observation noise led to an increase in the variance of parameter estimates and a decrease in the rate of convergence of the algorithm <xref ref-type="bibr" rid="pcbi.1002401-Huys1">[28]</xref>. Similarly, we observed that at high levels of observation noise, although the algorithm remained functional, its accuracy and precision were reduced (<xref ref-type="fig" rid="pcbi-1002401-g005">Fig. 5</xref>). It is emphasized that, at a particular level of observation noise, the outcome of the algorithm is an approximation of the posterior distributions of hidden states and unknown parameters in the model, given the available experimental data and prior information. In general, these approximate posteriors provide an overview of the structure of the parameter space and they potentially have multiple modes (or local optima). By taking advantage of the adaptive nature of the fixed-lag smoother (and, in particular, by controlling the scaling factor that determines the width of the proposal distribution in Eq. 25), we managed to reduce the variance of these posteriors and, in the limit case, we could force the algorithm to converge to a single optimal point (belonging to the support of the parameter posteriors), which could subsequently be used in predictive simulations (e.g. see <xref ref-type="fig" rid="pcbi-1002401-g007">Figs. 7D</xref> and <xref ref-type="fig" rid="pcbi-1002401-g011">11A</xref>). Unlike the study in <xref ref-type="bibr" rid="pcbi.1002401-Huys1">[28]</xref>, we did not observe any significant reduction in the rate of convergence of the algorithm at high levels of observation noise, which was attributed to a ceiling effect due to the large number of particles we used in our simulations (typically, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1161" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1162" xlink:type="simple"/></inline-formula> was the dimensionality of the estimation problem; see <xref ref-type="fig" rid="pcbi-1002401-g003">Figs. 3B</xref> and <xref ref-type="fig" rid="pcbi-1002401-g004">4C</xref>). Thus, we cannot exclude observing such a reduction in the rate of convergence, if a smaller number of particles is used and/or problems of higher dimension are examined. Furthermore, the proposed method requires only a single forward pass of the experimental data, instead of multiple passes, as in the case of off-line estimation methods, including the Expectation Maximization (EM) algorithm. On the other hand, this means that, in general, the proposed algorithm requires processing longer data time series in order to converge. In addition, unlike off-line estimation methods, it does not take into account the complete data trace at each iteration, but at most <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1163" xlink:type="simple"/></inline-formula> past data points (but, also, see <xref ref-type="bibr" rid="pcbi.1002401-vanLeeuwen1">[36]</xref> for a partial “remedy” of this situation). In principle, it would be possible to combine previous work on parameter estimation (e.g. <xref ref-type="bibr" rid="pcbi.1002401-Haufler1">[43]</xref>, <xref ref-type="bibr" rid="pcbi.1002401-Huys2">[44]</xref>) within an EM inference framework in order to estimate various types of parameters (including maximal conductances and channel kinetics) in conductance-based neuron models. This could be an interesting topic for further research.</p>
      <p>Our main conclusion was that, using this algorithm and a set of low-dimensional experimental data (typically, one or more traces of membrane potential activity), it was possible to fit complex compartmental models to this data with high fidelity and, simultaneously, estimate the hidden dynamic states and optimal values of a large number of parameters in these models. Based on simulation experiments using simulated data, we found that the estimated optimal parameter values and hidden states were close to their true counterparts, as long as sufficient prior information was made available to the algorithm. This information took the form of knowledge of the values of particular parameters (for example, the passive properties of the membrane) or of relatively narrow ranges of permissible parameter values. Such prior information could have included the kinetics of the ion currents that flow through the membrane or the spatial distribution of various parameter values along different neuron compartments (e.g. the ratio of maximal conductance A between compartment 1 and compartment 2). In real-life situations, such information may become available through current- or voltage-clamp experiments. For example, the passive properties in the B4 model (membrane capacitance, leakage maximal conductance and reversal potential) were inferred from current-clamp data and, thus, they were fixed during the subsequent smoothing phase.</p>
      <p>It has been demonstrated that this requirement for prior information may be relaxed, if the data set used as input was sufficiently variable to tease apart the relative contribution of different parameters in a model <xref ref-type="bibr" rid="pcbi.1002401-Hobbs1">[15]</xref>. A well-established result in conductance-based modeling is that the same pattern of electrical activity may be produced by different parameter configurations of the same model <xref ref-type="bibr" rid="pcbi.1002401-Goldman1">[6]</xref>–<xref ref-type="bibr" rid="pcbi.1002401-Prinz2">[9]</xref>. This implies that it is impossible to identify, during the course of an optimization procedure, a unique set of parameters using just this single pattern of activity as input to the method. For example, as we observed in the case of the B4 model, the posteriors of the estimated parameters may be characterized by multiple modes (i.e. local optima) or quite large variances, which makes identification of a unique set of optimal parameter values for use in predictive simulations rather difficult (Supplementary <xref ref-type="supplementary-material" rid="pcbi.1002401.s007">Fig. S7</xref>). A more variable data set would be necessary in order to constrain the model under study, thus forcing the optimization process to converge towards a unique solution. It should be noted that this conclusion was reached by treating as unknown only the maximal conductances in a conductance-based model <xref ref-type="bibr" rid="pcbi.1002401-Hobbs1">[15]</xref>. Although it is reasonable to assume that this holds true when the kinetics of ion channels are also treated as unknown, it still needs to be demonstrated whether the generation of a data set sufficiently variable to constrain both the maximal conductances and kinetics of ion channels in a complex conductance-based model is practical or even feasible. A more pragmatic approach would be to rely on a mixture of prior information and one or more sufficiently variable electrophysiological recordings as input to the optimization algorithm. It was shown in this study that both the injection of prior information (in the form mentioned above) and the simultaneous assimilation of multiple data sets is straightforward using the proposed algorithm.</p>
      <p>It is important to notice that, unlike more traditional approaches, explicitly defining a cost or fitness function was not required by the fixed-lag smoother. Given the fact that the efficiency of any optimizer can be seriously impeded by a poorly designed cost function, bypassing the need to define such a function may be viewed as an advantage of the proposed method. As in previous studies <xref ref-type="bibr" rid="pcbi.1002401-Haufler1">[43]</xref>, <xref ref-type="bibr" rid="pcbi.1002401-Huys2">[44]</xref>, here lies the implicit assumption that by fitting (or smoothing) with high fidelity the raw experimental data (for example, one or more recordings of the membrane potential), the estimated model would capture a whole range of features embedded in this data, such as the current-frequency response of the neuron. Although this is a reasonable assumption, we found that it did not hold completely true, when our knowledge of the form of the underlying model was not exact, as in the case of the B4 neuron. In this case, although we could achieve a very good smoothing of the experimental data, subsequent predictive simulations using the inferred model parameters revealed discrepancies between simulation output and experimental data. It is likely that these discrepancies will be minimized, if important missing components are added to the model, such as additional ionic currents or, importantly, an approximation of the spatial structure of the biological neuron.</p>
      <p>An important outcome of this study was to demonstrate the intimate relation between the self-organizing state-space model and evolutionary algorithms. When used for parameter estimation, the self-organizing state-space model undergoes at each iteration a process of new particle (individual) generation (mutation/recombination) and resampling (selection and multiplication), which parallels similar processes in evolutionary algorithms. At the root of this parallelism is the fact that we need to impose an artificial evolution on model parameters as part of the formulation of the self-organizing state-space model (see <xref ref-type="sec" rid="s2">Methods</xref>), thus providing a unique opportunity to merge the two classes of algorithms. Here, we decided to combine the self-organizing state-space model with an adaptive algorithm similar to the Covariance Matrix Adaptation Evolution Strategy <xref ref-type="bibr" rid="pcbi.1002401-Igel1">[30]</xref> and by following this adaptive strategy, we managed to achieve a dramatic reduction in the variance of parameter estimates. However, this choice is by no means exclusive and other evolutionary algorithms may be chosen instead, e.g. the Differential Evolution algorithm <xref ref-type="bibr" rid="pcbi.1002401-Price1">[31]</xref>. This is a topic open to further exploration. Notice that, similarly to Evolutionary Algorithms, the proposed method has, in principle, the ability to estimate the possibly multi-modal posterior distribution of the unknown parameters in the examined model, i.e. it is a global estimation method (for example, see <xref ref-type="fig" rid="pcbi-1002401-g006">Fig. 6C</xref>, <xref ref-type="fig" rid="pcbi-1002401-g011">11B</xref> and <xref ref-type="supplementary-material" rid="pcbi.1002401.s007">S7</xref>). At each iteration, the algorithm retains a population of particles, which are characterized by a degree of variability and, thus, give the algorithm the opportunity to randomly explore a wide range of the parameter space, spending on average more time in the vicinity of optimal regions. By imposing narrow prior constraints on some of the unknown parameters, we are effectively reducing the dimensionality of the problem and we force the algorithm to converge towards a particular optimum, which can be later used in predictive simulations.</p>
      <p>A point of potential improvement concerns our choice of the proposal density, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1164" xlink:type="simple"/></inline-formula>. Here, we made the common and straightforward choice to use the transition density <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1165" xlink:type="simple"/></inline-formula> as our proposal. However, the modeler is free to make other choices. For example, a recent study demonstrated that the efficiency of particle filters can be significantly increased by conditioning the proposal density on future observations <xref ref-type="bibr" rid="pcbi.1002401-vanLeeuwen1">[36]</xref>.</p>
      <p>An important practical aspect of the proposed algorithm was its high computational cost. This cost increased as a function of the number <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1166" xlink:type="simple"/></inline-formula> of particles used during smoothing, the length of the fixed smoothing lag <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1167" xlink:type="simple"/></inline-formula>, the complexity of the model and the number of unknown parameters in the model. Our simulations on an Intel dual-core i5 processor with four gigabytes of memory took from a few minutes to more than 12 hours to complete. An emerging trend in Scientific Computing is the use of modern massively parallel Graphics Processing Units (GPUs) in order to accelerate general purpose computations, as those presented in this paper. The utility of this approach in achieving significant accelerations of Monte Carlo simulations has been recently demonstrated <xref ref-type="bibr" rid="pcbi.1002401-Lee1">[45]</xref> and it has even been applied recently on parameter estimation problems in conductance-based models of single neurons <xref ref-type="bibr" rid="pcbi.1002401-Quinn1">[46]</xref>. Preliminary results using a GPU-accelerated version of the fixed-lag smoother (data not shown) have indeed demonstrated reduced simulation times, but the accelerations we observed were not as dramatic as those reported in the literature <xref ref-type="bibr" rid="pcbi.1002401-Lee1">[45]</xref>, <xref ref-type="bibr" rid="pcbi.1002401-Quinn1">[46]</xref>. This can always be attributed to the fact that our implementation of the algorithm was not optimized. On the other hand, we observed significant accelerations in our simulations involving the serial implementation of the fixed-lag smoother, just by switching from an open-source compiler (GNU) to a commercial one (Intel), which presumably emitted better optimized machine code for the underlying hardware. Nevertheless, the use of GPUs for general purpose computing is becoming common and it is likely to become quite popular with the advent of cheaper hardware and, importantly, more flexible and programmer-friendly Application Programming Interfaces (APIs).</p>
      <p>Overall, our results point towards a generic four-stage heuristic for parameter estimation in conductance-based models of single neurons: (a) First, the general structure of the model is decided, such as the number of ionic currents and compartments it should include. (b) Second, prior information is exploited in order to fix as many parameters as possible in the model and tightly constrain the remaining ones. For example, the capacitance, reversal potentials and leakage conductance in the model may be fixed to values estimated from current-clamp data. By further exploiting current– and voltage-clamp data, narrow constraints may be imposed on the remaining free (e.g. kinetic) parameters in the model. (c) At a third stage, more precise parameter value distributions are estimated by applying the fixed-lag smoother on current-clamp data, such as one or more recordings of the electrical activity of the membrane induced by random current injections. (d) Finally, the predictive value of the model is assessed through comparison to independent data sets and the model is modified, if necessary. It is important to notice that the techniques outlined in this paper are applicable on a wide range of research domains and that they provide a disciplined way to merge complex stochastic dynamic models, noisy data and prior information under a common inference framework.</p>
      <p>In conclusion, the class of statistical estimation methods, which the algorithm presented in this paper belongs to, in combination with Monte Carlo approximation techniques are particularly suitable to address high-dimensional inference problems in a disciplined manner. This makes them potentially useful tools at the disposal of biophysical modelers of neurons and neural networks and it is predicted that these methodologies will become more popular in the future among this research community.</p>
    </sec>
    <sec id="s5">
      <title>Supporting Information</title>
      <supplementary-material id="pcbi.1002401.s001" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.s001" xlink:type="simple">
        <label>Figure S1</label>
        <caption>
          <p><bold>Simultaneous estimation of hidden states and channel noise in a stochastic single-compartment model.</bold> Estimation was based on a simulated <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1168" xlink:type="simple"/></inline-formula>-long recording of membrane potential generated by Supplementary Eqs. S1, S2 and S4. For clarity, only <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1169" xlink:type="simple"/></inline-formula> of activity are shown in Figs. Ai,ii. Notice that in these simulations, we assumed the absence of synaptic input (i.e. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1170" xlink:type="simple"/></inline-formula>). Activity in the model neuron was driven by a random sequence of current steps <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1171" xlink:type="simple"/></inline-formula> with amplitude between <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1172" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1173" xlink:type="simple"/></inline-formula> and duration up to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1174" xlink:type="simple"/></inline-formula>. (<bold>A</bold>) Simultaneous inference of the observed membrane potential (Ai) and the hidden activation (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1175" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1176" xlink:type="simple"/></inline-formula>) and inactivation (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1177" xlink:type="simple"/></inline-formula>) gating variables for the sodium and potassium currents. (<bold>B</bold>) Inference of the standard deviation of the observation noise <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1178" xlink:type="simple"/></inline-formula> (Bi) and the parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1179" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1180" xlink:type="simple"/></inline-formula>, which control the variance of the sodium and potassium channel noise (Bii). Estimates converged to their final values after approximately <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1181" xlink:type="simple"/></inline-formula>. The dashed lines indicate the true values of these parameters. The y-axes in Bi,ii indicate the width of the prior intervals imposed on the corresponding parameters. Simulation parameters were: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1182" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1183" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1184" xlink:type="simple"/></inline-formula>. The prior interval for the scaling factors <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1185" xlink:type="simple"/></inline-formula> was <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1186" xlink:type="simple"/></inline-formula>.</p>
          <p>(TIFF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002401.s002" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.s002" xlink:type="simple">
        <label>Figure S2</label>
        <caption>
          <p><bold>Simultaneous estimation of hidden states, channel noise and presynaptic firing rates in a stochastic single-compartment model.</bold> Estimation was based on a simulated <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1187" xlink:type="simple"/></inline-formula>-long recording of membrane potential generated by Eqs. S1, S2 and S4 with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1188" xlink:type="simple"/></inline-formula>. For clarity, only <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1189" xlink:type="simple"/></inline-formula> of activity are shown in Figs. Ai,ii. (<bold>A</bold>) Simultaneous inference of the observed membrane potential (Ai) and the hidden activation (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1190" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1191" xlink:type="simple"/></inline-formula>) and inactivation (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1192" xlink:type="simple"/></inline-formula>) gating variables for the sodium and potassium currents (Aii). (<bold>B</bold>) Inference of the standard deviation of the observation noise <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1193" xlink:type="simple"/></inline-formula> (Bi), parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1194" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1195" xlink:type="simple"/></inline-formula>, which control the variance of the sodium and potassium channel noise (Bii) and the presynaptic firing rates <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1196" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1197" xlink:type="simple"/></inline-formula> (Biii). Estimates converged to their final values after approximately <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1198" xlink:type="simple"/></inline-formula> of activity. The dashed lines indicate the true values of the parameters. The y-axes in B and C indicate the width of the prior intervals imposed on the corresponding parameters. Discrepancies from the true values in B are due to the overlapping effects of different parameters controlling observation, channel and synaptic noise. Simulation parameters were: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1199" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1200" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1201" xlink:type="simple"/></inline-formula>. The prior interval for the scaling factors <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1202" xlink:type="simple"/></inline-formula> was <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1203" xlink:type="simple"/></inline-formula>.</p>
          <p>(TIFF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002401.s003" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.s003" xlink:type="simple">
        <label>Figure S3</label>
        <caption>
          <p><bold>Simultaneous inference of hidden states and unknown parameters in the single compartment model (see main text) at high levels of observation noise.</bold> This figure corresponds to <xref ref-type="fig" rid="pcbi-1002401-g007">Fig. 7Dii</xref> in the main text for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1204" xlink:type="simple"/></inline-formula>. (<bold>A</bold>) Inferred membrane potential (Ai) and unobserved gating variables (Aii). (<bold>B</bold>) Examples of simultaneously inferred parameters, such as maximal conductances (Bi,ii) and reversal potentials (Biii,iv). The y-axes in Bi–iv indicate the prior intervals of the corresponding parameters. Simulation details are as in <xref ref-type="fig" rid="pcbi-1002401-g007">Fig. 7</xref> in the main text.</p>
          <p>(TIFF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002401.s004" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.s004" xlink:type="simple">
        <label>Figure S4</label>
        <caption>
          <p><bold>Simultaneous inference of hidden states in the two-compartment model (see main text) at low levels of observation noise.</bold> This figure corresponds to <xref ref-type="fig" rid="pcbi-1002401-g011">Figs. 11Aii</xref> for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1205" xlink:type="simple"/></inline-formula>, 11B and 11C in the main text. (<bold>A</bold>) Inference of the membrane potential at the soma (Ai) and the dendritic compartment (Aii). (<bold>B</bold>) Inference of the unobserved concentration of intracellular calcium at the soma (Bi) and the dendritic compartment (Bii). (<bold>C</bold>) Inference of the unobserved gating variables for the sodium and potassium currents at the soma (Ci), the N-type calcium current at the soma (Ciii), the N-type calcium current at the dendritic compartment (Cii) and the L-type calcium current at the dendritic compartment (Civ). Simulation details are as in <xref ref-type="fig" rid="pcbi-1002401-g011">Fig. 11</xref> in the main text.</p>
          <p>(TIFF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002401.s005" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.s005" xlink:type="simple">
        <label>Figure S5</label>
        <caption>
          <p><bold>Simultaneous inference of hidden states in the two-compartment model (see main text) at high levels of observation noise.</bold> This figure corresponds to <xref ref-type="fig" rid="pcbi-1002401-g011">Fig. 11Aii</xref> for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1206" xlink:type="simple"/></inline-formula>. (<bold>A</bold>) Inference of the membrane potential at the soma (Ai) and the dendritic compartment (Aii). (<bold>B</bold>) Inference of the unobserved concentration of intracellular calcium at the soma (Bi) and the dendritic compartment (Bii). (<bold>C</bold>) Inference of the unobserved gating variables for the sodium and potassium currents at the soma (Ci), the N-type calcium current at the soma (Ciii), the N-type calcium current at the dendritic compartment (Cii) and the L-type calcium current at the dendritic compartment (Civ). Simulation details are as in <xref ref-type="fig" rid="pcbi-1002401-g011">Fig. 11</xref> in the main text.</p>
          <p>(TIFF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002401.s006" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.s006" xlink:type="simple">
        <label>Figure S6</label>
        <caption>
          <p><bold>Inference in the B4 model using a single recording of the membrane potential.</bold> A single <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1207" xlink:type="simple"/></inline-formula>-long recording of B4 activity induced by injecting a sequence of random current steps in the neuron was used during smoothing. Random current amplitude was between <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1208" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1209" xlink:type="simple"/></inline-formula> and random step duration was between <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1210" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1211" xlink:type="simple"/></inline-formula>. (<bold>A</bold>) Inference of the membrane potential (Ai) and the unobserved gating variables for the sodium and potassium currents in the model (Aii). (<bold>B</bold>) Examples of simultaneously inferred model parameters: maximal conductances of all currents (Bi), half steady-state activation voltages for all currents (Bii) and maximal relaxation times for the activation of the potassium currents in the model (Biii). Notice that in all cases the parameter estimates converge exactly to the middle of their prior intervals (indicated by the y-axes in Bi–iii). This convergence takes place while the algorithm processes the “inactive” region of the data (approximately, from second <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1212" xlink:type="simple"/></inline-formula> to second 3 in Ai). Based on these converged estimates, the model incorrectly emits spikes later during smoothing (see arrows in Ai), indicating that the estimated parameters are not optimal for smoothing during the whole duration of experimental data. Simulation parameters were as follows: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1213" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1214" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1215" xlink:type="simple"/></inline-formula>. The prior interval for the scaling factors <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1216" xlink:type="simple"/></inline-formula> was <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1217" xlink:type="simple"/></inline-formula>. For the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1218" xlink:type="simple"/></inline-formula> free parameters in the model, we used the narrow prior intervals in <xref ref-type="table" rid="pcbi-1002401-t003">Table 3</xref>.</p>
          <p>(TIFF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002401.s007" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.s007" xlink:type="simple">
        <label>Figure S7</label>
        <caption>
          <p><bold>Inferred posterior distributions of all unknown parameters in the B4 model using the broad prior intervals in </bold><xref ref-type="table" rid="pcbi-1002401-t003"><bold>Table 3</bold></xref><bold>.</bold> Inference was based on simultaneously smoothing four <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1219" xlink:type="simple"/></inline-formula>-long voltage recordings from the B4 neuron as in <xref ref-type="fig" rid="pcbi-1002401-g012">Fig. 12A</xref> in the main text. As in that case, data smoothing was accomplished with very high fidelity, as illustrated in <xref ref-type="fig" rid="pcbi-1002401-g012">Fig. 12A</xref>. (<bold>A</bold>) Inferred maximal conductances. (<bold>B</bold>) Inferred half steady-state activation and inactivation voltages. (<bold>C</bold>) Inferred activation (Ci) and inactivation (Cii) voltage sensitivities (parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002401.e1220" xlink:type="simple"/></inline-formula> in the model). (<bold>D</bold>) Activation and inactivation relaxation times. The x-axes in all plots indicate the prior parameter intervals we used (<xref ref-type="table" rid="pcbi-1002401-t003">Table 3</xref>). Notice that most posteriors are very broad (covering a large portion of the prior interval) and not unimodal. Simulation parameters were as described in <xref ref-type="fig" rid="pcbi-1002401-g012">Fig. 12</xref> of the main text.</p>
          <p>(TIFF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002401.s008" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.s008" xlink:type="simple">
        <label>Text S1</label>
        <caption>
          <p><bold>Supplementary text analysing in more detail several points in the manuscript.</bold> To be read in conjuction with the accompanying supplementary figures.</p>
          <p>(PDF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002401.s009" mimetype="application/x-bzip2" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002401.s009" xlink:type="simple">
        <label>Text S2</label>
        <caption>
          <p>
            <bold>The MATLAB/C99 source code we used in this study.</bold>
          </p>
          <p>(BZ2)</p>
        </caption>
      </supplementary-material>
    </sec>
  </body>
  <back>
    <ack>
      <p>The authors would like to thank four anonymous reviewers, whose constructive criticism helped substantially improve this paper.</p>
    </ack>
    <ref-list>
      <title>References</title>
      <ref id="pcbi.1002401-Herz1">
        <label>1</label>
        <element-citation publication-type="journal" xlink:type="simple"> <person-group person-group-type="author"><name name-style="western"><surname>Herz</surname><given-names>AVM</given-names></name><name name-style="western"><surname>Gollisch</surname><given-names>T</given-names></name><name name-style="western"><surname>Machens</surname><given-names>CK</given-names></name><name name-style="western"><surname>Jaeger</surname><given-names>D</given-names></name></person-group> <year>2006</year> <article-title>Modeling single-neuron dynamics and computations: a balance of detail and abstraction.</article-title> <source>Science</source> <volume>314</volume> <fpage>80</fpage> <lpage>5</lpage> </element-citation>
      </ref>
      <ref id="pcbi.1002401-DeSchutter1">
        <label>2</label>
        <element-citation publication-type="journal" xlink:type="simple"> <person-group person-group-type="author"><name name-style="western"><surname>De Schutter</surname><given-names>E</given-names></name><name name-style="western"><surname>Ekeberg</surname><given-names>O</given-names></name><name name-style="western"><surname>Kotaleski</surname><given-names>JH</given-names></name><name name-style="western"><surname>Achard</surname><given-names>P</given-names></name><name name-style="western"><surname>Lansner</surname><given-names>A</given-names></name></person-group> <year>2005</year> <article-title>Biophysically detailed modelling of microcircuits and beyond.</article-title> <source>Trends Neurosci</source> <volume>28</volume> <fpage>562</fpage> <lpage>9</lpage> </element-citation>
      </ref>
      <ref id="pcbi.1002401-Grillner1">
        <label>3</label>
        <element-citation publication-type="journal" xlink:type="simple"> <person-group person-group-type="author"><name name-style="western"><surname>Grillner</surname><given-names>S</given-names></name></person-group> <year>2003</year> <article-title>The motor infrastructure: from ion channels to neuronal networks.</article-title> <source>Nat Rev Neurosci</source> <volume>4</volume> <fpage>573</fpage> <lpage>86</lpage> </element-citation>
      </ref>
      <ref id="pcbi.1002401-Marder1">
        <label>4</label>
        <element-citation publication-type="journal" xlink:type="simple"> <person-group person-group-type="author"><name name-style="western"><surname>Marder</surname><given-names>E</given-names></name><name name-style="western"><surname>Calabrese</surname><given-names>RL</given-names></name></person-group> <year>1996</year> <article-title>Principles of rhythmic motor pattern generation.</article-title> <source>Physiol Rev</source> <volume>76</volume> <fpage>687</fpage> <lpage>717</lpage> </element-citation>
      </ref>
      <ref id="pcbi.1002401-Willms1">
        <label>5</label>
        <element-citation publication-type="journal" xlink:type="simple"> <person-group person-group-type="author"><name name-style="western"><surname>Willms</surname><given-names>AR</given-names></name><name name-style="western"><surname>Baro</surname><given-names>DJ</given-names></name><name name-style="western"><surname>Harris-Warrick</surname><given-names>RM</given-names></name><name name-style="western"><surname>Guckenheimer</surname><given-names>J</given-names></name></person-group> <year>1999</year> <article-title>An improved parameter estimation method for hodgkin-huxley models.</article-title> <source>J Comput Neurosci</source> <volume>6</volume> <fpage>145</fpage> <lpage>68</lpage> </element-citation>
      </ref>
      <ref id="pcbi.1002401-Goldman1">
        <label>6</label>
        <element-citation publication-type="journal" xlink:type="simple"> <person-group person-group-type="author"><name name-style="western"><surname>Goldman</surname><given-names>MS</given-names></name><name name-style="western"><surname>Golowasch</surname><given-names>J</given-names></name><name name-style="western"><surname>Marder</surname><given-names>E</given-names></name><name name-style="western"><surname>Abbott</surname><given-names>LF</given-names></name></person-group> <year>2001</year> <article-title>Global structure, robustness, and modulation of neuronal models.</article-title> <source>J Neurosci</source> <volume>21</volume> <fpage>5229</fpage> <lpage>38</lpage> </element-citation>
      </ref>
      <ref id="pcbi.1002401-Golowasch1">
        <label>7</label>
        <element-citation publication-type="journal" xlink:type="simple"> <person-group person-group-type="author"><name name-style="western"><surname>Golowasch</surname><given-names>J</given-names></name><name name-style="western"><surname>Goldman</surname><given-names>MS</given-names></name><name name-style="western"><surname>Abbott</surname><given-names>LF</given-names></name><name name-style="western"><surname>Marder</surname><given-names>E</given-names></name></person-group> <year>2002</year> <article-title>Failure of averaging in the construction of a conductance-based neuron model.</article-title> <source>J Neurophysiol</source> <volume>87</volume> <fpage>1129</fpage> <lpage>31</lpage> </element-citation>
      </ref>
      <ref id="pcbi.1002401-Prinz1">
        <label>8</label>
        <element-citation publication-type="journal" xlink:type="simple"> <person-group person-group-type="author"><name name-style="western"><surname>Prinz</surname><given-names>AA</given-names></name><name name-style="western"><surname>Billimoria</surname><given-names>CP</given-names></name><name name-style="western"><surname>Marder</surname><given-names>E</given-names></name></person-group> <year>2003</year> <article-title>Alternative to hand-tuning conductance-based models: construction and analysis of databases of model neurons.</article-title> <source>J Neurophysiol</source> <volume>90</volume> <fpage>3998</fpage> <lpage>4015</lpage> </element-citation>
      </ref>
      <ref id="pcbi.1002401-Prinz2">
        <label>9</label>
        <element-citation publication-type="journal" xlink:type="simple"> <person-group person-group-type="author"><name name-style="western"><surname>Prinz</surname><given-names>AA</given-names></name><name name-style="western"><surname>Bucher</surname><given-names>D</given-names></name><name name-style="western"><surname>Marder</surname><given-names>E</given-names></name></person-group> <year>2004</year> <article-title>Similar network activity from disparate circuit parameters.</article-title> <source>Nat Neurosci</source> <volume>7</volume> <fpage>1345</fpage> <lpage>52</lpage> </element-citation>
      </ref>
      <ref id="pcbi.1002401-Nowotny1">
        <label>10</label>
        <element-citation publication-type="journal" xlink:type="simple"> <person-group person-group-type="author"><name name-style="western"><surname>Nowotny</surname><given-names>T</given-names></name><name name-style="western"><surname>Szücs</surname><given-names>A</given-names></name><name name-style="western"><surname>Levi</surname><given-names>R</given-names></name><name name-style="western"><surname>Selverston</surname><given-names>AI</given-names></name></person-group> <year>2007</year> <article-title>Models wagging the dog: are circuits constructed with disparate parameters?</article-title> <source>Neural Comput</source> <volume>19</volume> <fpage>1985</fpage> <lpage>2003</lpage> </element-citation>
      </ref>
      <ref id="pcbi.1002401-Lepora1">
        <label>11</label>
        <element-citation publication-type="journal" xlink:type="simple"> <person-group person-group-type="author"><name name-style="western"><surname>Lepora</surname><given-names>NF</given-names></name><name name-style="western"><surname>Overton</surname><given-names>PG</given-names></name><name name-style="western"><surname>Gurney</surname><given-names>K</given-names></name></person-group> <year>2011</year> <article-title>Efficient fitting of conductance-based model neurons from somatic current clamp.</article-title> <source>J Comput Neurosci.</source> <comment>E-pub ahead of print</comment> </element-citation>
      </ref>
      <ref id="pcbi.1002401-Hendrickson1">
        <label>12</label>
        <element-citation publication-type="journal" xlink:type="simple"> <person-group person-group-type="author"><name name-style="western"><surname>Hendrickson</surname><given-names>EB</given-names></name><name name-style="western"><surname>Edgerton</surname><given-names>JR</given-names></name><name name-style="western"><surname>Jaeger</surname><given-names>D</given-names></name></person-group> <year>2011</year> <article-title>The use of automated parameter searches to improve ion channel kinetics for neural modeling.</article-title> <source>J Comput Neurosci</source> <volume>31</volume> <fpage>329</fpage> <lpage>46</lpage> </element-citation>
      </ref>
      <ref id="pcbi.1002401-Keren1">
        <label>13</label>
        <element-citation publication-type="journal" xlink:type="simple"> <person-group person-group-type="author"><name name-style="western"><surname>Keren</surname><given-names>N</given-names></name><name name-style="western"><surname>Bar-Yehuda</surname><given-names>D</given-names></name><name name-style="western"><surname>Korngreen</surname><given-names>A</given-names></name></person-group> <year>2009</year> <article-title>Experimentally guided modelling of dendritic excitability in rat neocortical pyramidal neurones.</article-title> <source>J Physiol</source> <volume>587</volume> <fpage>1413</fpage> <lpage>37</lpage> </element-citation>
      </ref>
      <ref id="pcbi.1002401-Pospischil1">
        <label>14</label>
        <element-citation publication-type="journal" xlink:type="simple"> <person-group person-group-type="author"><name name-style="western"><surname>Pospischil</surname><given-names>M</given-names></name><name name-style="western"><surname>Toledo-Rodriguez</surname><given-names>M</given-names></name><name name-style="western"><surname>Monier</surname><given-names>C</given-names></name><name name-style="western"><surname>Piwkowska</surname><given-names>Z</given-names></name><name name-style="western"><surname>Bal</surname><given-names>T</given-names></name><etal/></person-group> <year>2008</year> <article-title>Minimal hodgkinhuxley type models for different classes of cortical and thalamic neurons.</article-title> <source>Biol Cybern</source> <volume>99</volume> <fpage>427</fpage> <lpage>41</lpage> </element-citation>
      </ref>
      <ref id="pcbi.1002401-Hobbs1">
        <label>15</label>
        <element-citation publication-type="journal" xlink:type="simple"> <person-group person-group-type="author"><name name-style="western"><surname>Hobbs</surname><given-names>KH</given-names></name><name name-style="western"><surname>Hooper</surname><given-names>SL</given-names></name></person-group> <year>2008</year> <article-title>Using complicated, wide dynamic range driving to develop models of single neurons in single recording sessions.</article-title> <source>J Neurophysiol</source> <volume>99</volume> <fpage>1871</fpage> <lpage>83</lpage> </element-citation>
      </ref>
      <ref id="pcbi.1002401-Nowotny2">
        <label>16</label>
        <element-citation publication-type="journal" xlink:type="simple"> <person-group person-group-type="author"><name name-style="western"><surname>Nowotny</surname><given-names>T</given-names></name><name name-style="western"><surname>Levi</surname><given-names>R</given-names></name><name name-style="western"><surname>Selverston</surname><given-names>AI</given-names></name></person-group> <year>2008</year> <article-title>Probing the dynamics of identified neurons with a datadriven modeling approach.</article-title> <source>PLoS One</source> <volume>3</volume> <fpage>e2627</fpage> </element-citation>
      </ref>
      <ref id="pcbi.1002401-Reid1">
        <label>17</label>
        <element-citation publication-type="journal" xlink:type="simple"> <person-group person-group-type="author"><name name-style="western"><surname>Reid</surname><given-names>MS</given-names></name><name name-style="western"><surname>Brown</surname><given-names>EA</given-names></name><name name-style="western"><surname>DeWeerth</surname><given-names>SP</given-names></name></person-group> <year>2007</year> <article-title>A parameter-space search algorithm tested on a hodgkinhuxley model.</article-title> <source>Biol Cybern</source> <volume>96</volume> <fpage>625</fpage> <lpage>634</lpage> </element-citation>
      </ref>
      <ref id="pcbi.1002401-Druckmann1">
        <label>18</label>
        <element-citation publication-type="journal" xlink:type="simple"> <person-group person-group-type="author"><name name-style="western"><surname>Druckmann</surname><given-names>S</given-names></name><name name-style="western"><surname>Banitt</surname><given-names>Y</given-names></name><name name-style="western"><surname>Gidon</surname><given-names>A</given-names></name><name name-style="western"><surname>Schürmann</surname><given-names>F</given-names></name><name name-style="western"><surname>Markram</surname><given-names>H</given-names></name><etal/></person-group> <year>2007</year> <article-title>A novel multiple objective optimization framework for constraining conductance-based neuron models by experimental data.</article-title> <source>Front Neurosci</source> <volume>1</volume> <fpage>7</fpage> <lpage>18</lpage> </element-citation>
      </ref>
      <ref id="pcbi.1002401-Achard1">
        <label>19</label>
        <element-citation publication-type="journal" xlink:type="simple"> <person-group person-group-type="author"><name name-style="western"><surname>Achard</surname><given-names>P</given-names></name><name name-style="western"><surname>De Schutter</surname><given-names>E</given-names></name></person-group> <year>2006</year> <article-title>Complex parameter landscape for a complex neuron model.</article-title> <source>PLoS Comput Biol</source> <volume>2</volume> <fpage>e94</fpage> </element-citation>
      </ref>
      <ref id="pcbi.1002401-Keren2">
        <label>20</label>
        <element-citation publication-type="journal" xlink:type="simple"> <person-group person-group-type="author"><name name-style="western"><surname>Keren</surname><given-names>N</given-names></name><name name-style="western"><surname>Peled</surname><given-names>N</given-names></name><name name-style="western"><surname>Korngreen</surname><given-names>A</given-names></name></person-group> <year>2005</year> <article-title>Constraining compartmental models using multiple voltage recordings and genetic algorithms.</article-title> <source>J Neurophysiol</source> <volume>94</volume> <fpage>3730</fpage> <lpage>42</lpage> </element-citation>
      </ref>
      <ref id="pcbi.1002401-Tabak1">
        <label>21</label>
        <element-citation publication-type="journal" xlink:type="simple"> <person-group person-group-type="author"><name name-style="western"><surname>Tabak</surname><given-names>J</given-names></name><name name-style="western"><surname>Murphey</surname><given-names>CR</given-names></name><name name-style="western"><surname>Moore</surname><given-names>LE</given-names></name></person-group> <year>2000</year> <article-title>Parameter estimation methods for single neuron models.</article-title> <source>J Comput Neurosci</source> <volume>9</volume> <fpage>215</fpage> <lpage>236</lpage> </element-citation>
      </ref>
      <ref id="pcbi.1002401-Vanier1">
        <label>22</label>
        <element-citation publication-type="journal" xlink:type="simple"> <person-group person-group-type="author"><name name-style="western"><surname>Vanier</surname><given-names>MC</given-names></name><name name-style="western"><surname>Bower</surname><given-names>JM</given-names></name></person-group> <year>1999</year> <article-title>A comparative survey of automated parameter-search methods for compartmental neural models.</article-title> <source>J Comput Neurosci</source> <volume>7</volume> <fpage>149</fpage> <lpage>71</lpage> </element-citation>
      </ref>
      <ref id="pcbi.1002401-VanGeit1">
        <label>23</label>
        <element-citation publication-type="journal" xlink:type="simple"> <person-group person-group-type="author"><name name-style="western"><surname>Van Geit</surname><given-names>W</given-names></name><name name-style="western"><surname>De Schutter</surname><given-names>E</given-names></name><name name-style="western"><surname>Achard</surname><given-names>P</given-names></name></person-group> <year>2008</year> <article-title>Automated neuron model optimization techniques: a review.</article-title> <source>Biol Cybern</source> <volume>99</volume> <fpage>241</fpage> <lpage>51</lpage> </element-citation>
      </ref>
      <ref id="pcbi.1002401-LeMasson1">
        <label>24</label>
        <element-citation publication-type="other" xlink:type="simple"> <person-group person-group-type="author"><name name-style="western"><surname>LeMasson</surname><given-names>G</given-names></name><name name-style="western"><surname>Maex</surname><given-names>R</given-names></name></person-group> <year>2001</year> <source>Computational Neuroscience: realistic modelling for experimentalists</source> <publisher-name>CRC Press</publisher-name> <fpage>1</fpage> <lpage>25</lpage> </element-citation>
      </ref>
      <ref id="pcbi.1002401-VanGeit2">
        <label>25</label>
        <element-citation publication-type="journal" xlink:type="simple"> <person-group person-group-type="author"><name name-style="western"><surname>Van Geit</surname><given-names>W</given-names></name><name name-style="western"><surname>Achard</surname><given-names>P</given-names></name><name name-style="western"><surname>De Schutter</surname><given-names>E</given-names></name></person-group> <year>2007</year> <article-title>Neurofitter: a parameter tuning package for a wide range of electrophysiological neuron models.</article-title> <source>Front Neuroinform</source> <volume>1</volume> <fpage>1</fpage> </element-citation>
      </ref>
      <ref id="pcbi.1002401-Tokuda1">
        <label>26</label>
        <element-citation publication-type="other" xlink:type="simple"> <person-group person-group-type="author"><name name-style="western"><surname>Tokuda</surname><given-names>I</given-names></name><name name-style="western"><surname>Parlitz</surname><given-names>U</given-names></name><name name-style="western"><surname>Illing</surname><given-names>L</given-names></name><name name-style="western"><surname>Kennel</surname><given-names>M</given-names></name><name name-style="western"><surname>Abarbanel</surname><given-names>HD</given-names></name></person-group> <year>2003</year> <article-title>Parameter estimation for neuron models.</article-title> <fpage>251</fpage> <lpage>256</lpage> <comment>In: Experimental Chaos: 7th Experimental Chaos Conference. volume 676</comment> </element-citation>
      </ref>
      <ref id="pcbi.1002401-Lillacci1">
        <label>27</label>
        <element-citation publication-type="journal" xlink:type="simple"> <person-group person-group-type="author"><name name-style="western"><surname>Lillacci</surname><given-names>G</given-names></name><name name-style="western"><surname>Khammash</surname><given-names>M</given-names></name></person-group> <year>2010</year> <article-title>Parameter estimation and model selection in computational biology.</article-title> <source>PLoS Comput Biol</source> <volume>6</volume> <fpage>e1000696</fpage> </element-citation>
      </ref>
      <ref id="pcbi.1002401-Huys1">
        <label>28</label>
        <element-citation publication-type="journal" xlink:type="simple"> <person-group person-group-type="author"><name name-style="western"><surname>Huys</surname><given-names>QJM</given-names></name><name name-style="western"><surname>Paninski</surname><given-names>L</given-names></name></person-group> <year>2009</year> <article-title>Smoothing of, and parameter estimation from, noisy biophysical recordings.</article-title> <source>PLoS Comput Biol</source> <volume>5</volume> <fpage>e1000379</fpage> </element-citation>
      </ref>
      <ref id="pcbi.1002401-Kitagawa1">
        <label>29</label>
        <element-citation publication-type="journal" xlink:type="simple"> <person-group person-group-type="author"><name name-style="western"><surname>Kitagawa</surname><given-names>G</given-names></name></person-group> <year>1998</year> <article-title>A self-organizing state-space model.</article-title> <source>J Am Stat Assoc</source> <volume>93</volume> <fpage>1203</fpage> <lpage>1215</lpage> </element-citation>
      </ref>
      <ref id="pcbi.1002401-Igel1">
        <label>30</label>
        <element-citation publication-type="journal" xlink:type="simple"> <person-group person-group-type="author"><name name-style="western"><surname>Igel</surname><given-names>C</given-names></name><name name-style="western"><surname>Hansen</surname><given-names>N</given-names></name><name name-style="western"><surname>Roth</surname><given-names>S</given-names></name></person-group> <year>2007</year> <article-title>Covariance matrix adaptation for multi-objective optimization.</article-title> <source>Evol Comput</source> <volume>15</volume> <fpage>1</fpage> <lpage>28</lpage> </element-citation>
      </ref>
      <ref id="pcbi.1002401-Price1">
        <label>31</label>
        <element-citation publication-type="other" xlink:type="simple"> <person-group person-group-type="author"><name name-style="western"><surname>Price</surname><given-names>KV</given-names></name><name name-style="western"><surname>Storn</surname><given-names>RM</given-names></name><name name-style="western"><surname>Lampinen</surname><given-names>JA</given-names></name></person-group> <year>2005</year> <source>Differential evolution: a practical approach to global optimization</source> <publisher-name>Springer</publisher-name> <fpage>558 p</fpage> </element-citation>
      </ref>
      <ref id="pcbi.1002401-Faisal1">
        <label>32</label>
        <element-citation publication-type="journal" xlink:type="simple"> <person-group person-group-type="author"><name name-style="western"><surname>Faisal</surname><given-names>AA</given-names></name><name name-style="western"><surname>Selen</surname><given-names>LPJ</given-names></name><name name-style="western"><surname>Wolpert</surname><given-names>DM</given-names></name></person-group> <year>2008</year> <article-title>Noise in the nervous system.</article-title> <source>Nat Rev Neurosci</source> <volume>9</volume> <fpage>292</fpage> <lpage>303</lpage> </element-citation>
      </ref>
      <ref id="pcbi.1002401-Kloeden1">
        <label>33</label>
        <element-citation publication-type="other" xlink:type="simple"> <person-group person-group-type="author"><name name-style="western"><surname>Kloeden</surname><given-names>PE</given-names></name><name name-style="western"><surname>Platen</surname><given-names>E</given-names></name></person-group> <year>1999</year> <source>Numerical Solution of Stochastic Differential Equations</source> <publisher-name>Springer</publisher-name> </element-citation>
      </ref>
      <ref id="pcbi.1002401-Cappe1">
        <label>34</label>
        <element-citation publication-type="journal" xlink:type="simple"> <person-group person-group-type="author"><name name-style="western"><surname>Cappe</surname><given-names>O</given-names></name><name name-style="western"><surname>Godsill</surname><given-names>SJ</given-names></name><name name-style="western"><surname>Moulines</surname><given-names>E</given-names></name></person-group> <year>2007</year> <article-title>An overview of existing methods and recent advances in sequential monte carlo.</article-title> <source>P IEEE</source> <volume>95</volume> <fpage>899</fpage> <lpage>924</lpage> </element-citation>
      </ref>
      <ref id="pcbi.1002401-Doucet1">
        <label>35</label>
        <element-citation publication-type="other" xlink:type="simple"> <person-group person-group-type="editor"><name name-style="western"><surname>Doucet</surname><given-names>A</given-names></name><name name-style="western"><surname>de Freitas</surname><given-names>N</given-names></name><name name-style="western"><surname>Gordon</surname><given-names>N</given-names></name></person-group> <year>2001</year> <source>Sequential Monte Carlo Methods in Practice</source> <publisher-name>Springer</publisher-name> </element-citation>
      </ref>
      <ref id="pcbi.1002401-vanLeeuwen1">
        <label>36</label>
        <element-citation publication-type="journal" xlink:type="simple"> <person-group person-group-type="author"><name name-style="western"><surname>van Leeuwen</surname><given-names>PJ</given-names></name></person-group> <year>2010</year> <article-title>Nonlinear data assimilation in geosciences: an extremely efficient particle filter.</article-title> <source>Q J R Meteorol Soc</source> <volume>136</volume> <fpage>1991</fpage> <lpage>1999</lpage> </element-citation>
      </ref>
      <ref id="pcbi.1002401-Booth1">
        <label>37</label>
        <element-citation publication-type="journal" xlink:type="simple"> <person-group person-group-type="author"><name name-style="western"><surname>Booth</surname><given-names>V</given-names></name><name name-style="western"><surname>Rinzel</surname><given-names>J</given-names></name><name name-style="western"><surname>Kiehn</surname><given-names>O</given-names></name></person-group> <year>1997</year> <article-title>Compartmental model of vertebrate motoneurons for ca2+- dependent spiking and plateau potentials under pharmacological treatment.</article-title> <source>J Neurophysiol</source> <volume>78</volume> <fpage>3371</fpage> <lpage>85</lpage> </element-citation>
      </ref>
      <ref id="pcbi.1002401-Straub1">
        <label>38</label>
        <element-citation publication-type="journal" xlink:type="simple"> <person-group person-group-type="author"><name name-style="western"><surname>Straub</surname><given-names>VA</given-names></name><name name-style="western"><surname>Benjamin</surname><given-names>PR</given-names></name></person-group> <year>2001</year> <article-title>Extrinsic modulation and motor pattern generation in a feeding network: a cellular study.</article-title> <source>J Neurosci</source> <volume>21</volume> <fpage>1767</fpage> <lpage>78</lpage> </element-citation>
      </ref>
      <ref id="pcbi.1002401-Straub2">
        <label>39</label>
        <element-citation publication-type="journal" xlink:type="simple"> <person-group person-group-type="author"><name name-style="western"><surname>Straub</surname><given-names>VA</given-names></name><name name-style="western"><surname>Grant</surname><given-names>J</given-names></name><name name-style="western"><surname>O'Shea</surname><given-names>M</given-names></name><name name-style="western"><surname>Benjamin</surname><given-names>PR</given-names></name></person-group> <year>2007</year> <article-title>Modulation of serotonergic neurotransmission by nitric oxide.</article-title> <source>J Neurophysiol</source> <volume>97</volume> <fpage>1088</fpage> <lpage>99</lpage> </element-citation>
      </ref>
      <ref id="pcbi.1002401-Koch1">
        <label>40</label>
        <element-citation publication-type="other" xlink:type="simple"> <person-group person-group-type="author"><name name-style="western"><surname>Koch</surname><given-names>C</given-names></name></person-group> <year>2005</year> <source>Biophysics of computation: information processing in single neurons</source> <publisher-name>Oxford University Press</publisher-name> <fpage>588 p</fpage> </element-citation>
      </ref>
      <ref id="pcbi.1002401-Vehovszky1">
        <label>41</label>
        <element-citation publication-type="journal" xlink:type="simple"> <person-group person-group-type="author"><name name-style="western"><surname>Vehovszky</surname><given-names>A</given-names></name><name name-style="western"><surname>Szabó</surname><given-names>H</given-names></name><name name-style="western"><surname>Elliott</surname><given-names>CJH</given-names></name></person-group> <year>2005</year> <article-title>Octopamine increases the excitability of neurons in the snail feeding system by modulation of inward sodium current but not outward potassium currents.</article-title> <source>BMC Neurosci</source> <volume>6</volume> <fpage>70</fpage> </element-citation>
      </ref>
      <ref id="pcbi.1002401-Vavoulis1">
        <label>42</label>
        <element-citation publication-type="journal" xlink:type="simple"> <person-group person-group-type="author"><name name-style="western"><surname>Vavoulis</surname><given-names>DV</given-names></name><name name-style="western"><surname>Nikitin</surname><given-names>ES</given-names></name><name name-style="western"><surname>Kemenes</surname><given-names>I</given-names></name><name name-style="western"><surname>Marra</surname><given-names>V</given-names></name><name name-style="western"><surname>Feng</surname><given-names>J</given-names></name><etal/></person-group> <year>2010</year> <article-title>Balanced plasticity and stability of the electrical properties of a molluscan modulatory interneuron after classical conditioning: a computational study.</article-title> <source>Front Behav Neurosci</source> <volume>4</volume> <fpage>19</fpage> </element-citation>
      </ref>
      <ref id="pcbi.1002401-Haufler1">
        <label>43</label>
        <element-citation publication-type="journal" xlink:type="simple"> <person-group person-group-type="author"><name name-style="western"><surname>Haufler</surname><given-names>D</given-names></name><name name-style="western"><surname>Morin</surname><given-names>F</given-names></name><name name-style="western"><surname>C</surname><given-names>LJ</given-names></name><name name-style="western"><surname>K</surname><given-names>SF</given-names></name></person-group> <year>2007</year> <article-title>Parameter estimation in single-compartment neuron models using a synchronization-based method.</article-title> <source>Neurocomputing</source> <volume>70</volume> <fpage>1605</fpage> <lpage>1610</lpage> </element-citation>
      </ref>
      <ref id="pcbi.1002401-Huys2">
        <label>44</label>
        <element-citation publication-type="journal" xlink:type="simple"> <person-group person-group-type="author"><name name-style="western"><surname>Huys</surname><given-names>QJM</given-names></name><name name-style="western"><surname>Ahrens</surname><given-names>MB</given-names></name><name name-style="western"><surname>Paninski</surname><given-names>L</given-names></name></person-group> <year>2006</year> <article-title>Efficient estimation of detailed single-neuron models.</article-title> <source>J Neurophysiol</source> <volume>96</volume> <fpage>872</fpage> <lpage>90</lpage> </element-citation>
      </ref>
      <ref id="pcbi.1002401-Lee1">
        <label>45</label>
        <element-citation publication-type="journal" xlink:type="simple"> <person-group person-group-type="author"><name name-style="western"><surname>Lee</surname><given-names>A</given-names></name><name name-style="western"><surname>Yau</surname><given-names>C</given-names></name><name name-style="western"><surname>Giles</surname><given-names>MB</given-names></name><name name-style="western"><surname>Doucet</surname><given-names>A</given-names></name><name name-style="western"><surname>Holmes</surname><given-names>CC</given-names></name></person-group> <year>2010</year> <article-title>On the utility of graphics cards to perform massively parallel simulation of advanced monte carlo methods.</article-title> <source>J Comput Graph Stat</source> <volume>19</volume> <fpage>769</fpage> <lpage>789</lpage> </element-citation>
      </ref>
      <ref id="pcbi.1002401-Quinn1">
        <label>46</label>
        <element-citation publication-type="other" xlink:type="simple"> <person-group person-group-type="author"><name name-style="western"><surname>Quinn</surname><given-names>JC</given-names></name><name name-style="western"><surname>Abarbanel</surname><given-names>HD</given-names></name></person-group> <year>2011</year> <article-title>Data assimilation using a gpu accelerated path integral monte carlo approach.</article-title> <comment>arXiv : <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1103.4887" xlink:type="simple">http://arxiv.org/abs/1103.4887</ext-link></comment> </element-citation>
      </ref>
    </ref-list>
    
  </back>
</article>