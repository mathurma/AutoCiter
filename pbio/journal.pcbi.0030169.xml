<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN"><front><journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="publisher">pcbi</journal-id><journal-id journal-id-type="allenpress-id">plcb</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher><publisher-name>Public Library of Science</publisher-name><publisher-loc>San Francisco, USA</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.1371/journal.pcbi.0030169</article-id><article-id pub-id-type="publisher-id">06-PLCB-RA-0387R4</article-id><article-id pub-id-type="sici">plcb-03-08-21</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline"><subject>Computational Biology</subject><subject>Neuroscience</subject><subject>Physiology</subject></subj-group><subj-group subj-group-type="System Taxonomy"><subject>Rattus (rat)</subject></subj-group></article-categories><title-group><article-title>A Numerical Approach to Ion Channel Modelling Using Whole-Cell Voltage-Clamp Recordings and a Genetic Algorithm</article-title><alt-title alt-title-type="running-head">Channel Modelling</alt-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Gurkiewicz</surname><given-names>Meron</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Korngreen</surname><given-names>Alon</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib></contrib-group><aff id="aff1">
				<label>1</label><addr-line> The Mina and Everard Goodman Faculty of Life Sciences, Bar-Ilan University, Ramat-Gan, Israel
			</addr-line></aff><aff id="aff2">
				<label>2</label><addr-line> The Leslie and Susan Gonda Multidisciplinary Brain Research Center, Bar-Ilan University, Ramat-Gan, Israel
			</addr-line></aff><contrib-group><contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Graham</surname><given-names>Lyle J</given-names></name><role>Editor</role><xref ref-type="aff" rid="edit1"/></contrib></contrib-group><aff id="edit1">UFR Biomédicale de l'Université René Descartes, France</aff><author-notes><fn fn-type="con" id="ack1"><p>MG and AK conceived and designed the experiments, performed the experiments, analyzed the data, and wrote the paper.</p></fn><corresp id="cor1">* To whom correspondence should be addressed. E-mail: <email xlink:type="simple">korngra@mail.biu.ac.il</email></corresp><fn fn-type="conflict" id="ack3"><p> The authors have declared that no competing interests exist.</p></fn></author-notes><pub-date pub-type="ppub"><month>8</month><year>2007</year></pub-date><pub-date pub-type="epub"><day>31</day><month>8</month><year>2007</year></pub-date><pub-date pub-type="epreprint"><day>18</day><month>7</month><year>2007</year></pub-date><volume>3</volume><issue>8</issue><elocation-id>e169</elocation-id><history><date date-type="received"><day>11</day><month>9</month><year>2006</year></date><date date-type="accepted"><day>16</day><month>7</month><year>2007</year></date></history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2007</copyright-year><copyright-holder>Gurkiewicz and Korngreen</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract><p>The activity of trans-membrane proteins such as ion channels is the essence of neuronal transmission. The currently most accurate method for determining ion channel kinetic mechanisms is single-channel recording and analysis. Yet, the limitations and complexities in interpreting single-channel recordings discourage many physiologists from using them. Here we show that a genetic search algorithm in combination with a gradient descent algorithm can be used to fit whole-cell voltage-clamp data to kinetic models with a high degree of accuracy. Previously, ion channel stimulation traces were analyzed one at a time, the results of these analyses being combined to produce a picture of channel kinetics. Here the entire set of traces from all stimulation protocols are analysed simultaneously. The algorithm was initially tested on simulated current traces produced by several Hodgkin-Huxley–like and Markov chain models of voltage-gated potassium and sodium channels. Currents were also produced by simulating levels of noise expected from actual patch recordings. Finally, the algorithm was used for finding the kinetic parameters of several voltage-gated sodium and potassium channels models by matching its results to data recorded from layer 5 pyramidal neurons of the rat cortex in the nucleated outside-out patch configuration. The minimization scheme gives electrophysiologists a tool for reproducing and simulating voltage-gated ion channel kinetics at the cellular level.</p></abstract><abstract abstract-type="summary"><title>Author Summary</title><sec id="st1"><title/><p>Voltage-gated ion channels affect neuronal integration of information. Some neurons express more than ten different types of voltage-gated ion channels, making information processing a highly convoluted process. Kinetic modelling of ion channels is an important method for unravelling the role of each channel type in neuronal function. However, the most commonly used analysis techniques suffer from shortcomings that limit the ability of researchers to rapidly produce physiologically relevant models of voltage-gated ion channels and of neuronal physiology. We show that conjugating a stochastic search algorithm with ionic currents measured using multiple voltage-clamp protocols enables the semi-automatic production of models of voltage-gated ion channels. Once fully automated, this approach may be used for high throughput analysis of voltage-gated currents. This in turn will greatly shorten the time required for building models of neuronal physiology to facilitate our understanding of neuronal behaviour.</p></sec></abstract><funding-group><funding-statement>This research was supported by the German Israeli Foundation (748–158.1/2002).</funding-statement></funding-group><counts><page-count count="15"/></counts><!--===== Restructure custom-meta-wrap to custom-meta-group =====--><custom-meta-group><custom-meta><meta-name>citation</meta-name><meta-value>Gurkiewicz M, Korngreen A (2007) A numerical approach to ion channel modelling using whole-cell voltage-clamp recordings and a genetic algorithm. PLoS Comput Biol 3(8): e169. doi:<ext-link ext-link-type="doi" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.0030169" xlink:type="simple">10.1371/journal.pcbi.0030169</ext-link></meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1"><title>Introduction</title><p>Ion channels are trans-membrane proteins that close and open in reaction to changes in membrane potential, among other factors, thus leading to a change in ion flow across the membrane. Membrane potential may be the most significant factor affecting the activity of ion channels, for not only do the kinetics of many channels depend on membrane potential but also changes in membrane potential are the main instigator of neuronal activity [<xref ref-type="bibr" rid="pcbi-0030169-b001">1</xref>,<xref ref-type="bibr" rid="pcbi-0030169-b002">2</xref>]. The kinetics of these voltage-dependent ion channels are complex, requiring the construction of intricate kinetic models to understand ion channel behaviour.</p><p>The dominant paradigm for ion transport over the past 50 years is based on the seminal experiments of Hodgkin and Huxley [<xref ref-type="bibr" rid="pcbi-0030169-b003">3</xref>–<xref ref-type="bibr" rid="pcbi-0030169-b008">8</xref>]. Their detailed kinetic models derived from the giant axon of <italic>Loligo</italic> are still extremely useful in studies of ion channels and of neuronal physiology. However, a much more detailed picture of the mechanisms underlying membrane excitation has emerged over the years, emphasizing several disagreements with the Hodgkin-Huxley model. These include their proposed lack of connectivity between the activating and inactivating “gates” of the voltage-dependent sodium channel [<xref ref-type="bibr" rid="pcbi-0030169-b009">9</xref>] and their premise that the inactivation gate voltage dependence is due to its coupling to the activation process; i.e., the inactivation gate can close only after the activation gate opens [<xref ref-type="bibr" rid="pcbi-0030169-b010">10</xref>,<xref ref-type="bibr" rid="pcbi-0030169-b011">11</xref>]. Nevertheless, the Hodgkin-Huxley model is still predominant in many simulations of neuronal physiology, mostly due to its ease of use and conceptualization combined with the relative small number of free parameters needing estimation for the quantification of channel behavior.</p><p>Most models proposed to replace the Hodgkin-Huxley model still use the same kinetic formalism and are only satisfactory in explaining certain aspects of channel behaviour but fail in others. For example, the classical Hodgkin-Huxley paradigm does not consider interactions between varying kinetic states, particularly that between activation and inactivation. This failure leads to an erroneous estimation of the kinetic parameters and thus of the predicted channel dynamics [<xref ref-type="bibr" rid="pcbi-0030169-b012">12</xref>]. The best method, so far, for discovering the kinetics of ionic channels is by analysis of single-channel recordings [<xref ref-type="bibr" rid="pcbi-0030169-b013">13</xref>]. However, single-channel recording and analysis suffer from several problems. One needs to accurately subtract the capacity of the electrodes, and the analysis of first latencies is extremely difficult [<xref ref-type="bibr" rid="pcbi-0030169-b013">13</xref>–<xref ref-type="bibr" rid="pcbi-0030169-b018">18</xref>]. Most data on neuronal voltage-gated conductances obtained in studies of cellular physiology have thus been collected when many channels were activated simultaneously, either in the whole-cell mode or in excised patches containing many channels. That is, most models of voltage-gated channels that aim to explain the physiological function of the channels are generated by analysing simultaneous activity in many channels.</p><p>Here we propose a method for analyzing whole-cell recordings of voltage-gated channels. Our working hypothesis is that it is possible to verify the viability of voltage-dependent ion channel models using a genetic optimization algorithm concurrently with a full-trace fit of experimental data to the model. We therefore scanned several of the better-known models of voltage-gated sodium and potassium channels to examine their accuracy in predicting and reproducing measured currents. Though the data provided for this paper derive from somata of L5 pyramidal neurons of the rat cortex, the method suggested here is applicable to all types of voltage-clamp recordings from different neuron classes. Note that our data were obtained using the nucleated patch configuration; thus, the models proposed here are not as detailed as those that may be obtained using single-channel recording. However, they are functionally significant models which allow us (and hopefully future researchers) to predict, simulate, and analyze neuronal physiology.</p></sec><sec id="s2" sec-type="methods"><title>Methods</title><sec id="s2a"><title>Simulation Environment</title><p>The model and the genetic algorithm (GA) were programmed using NEURON 5.7 and 5.8 [<xref ref-type="bibr" rid="pcbi-0030169-b019">19</xref>]. We parallelized the process using a cluster of ten Pentium 4 computers with a 3 GHz clock speed sharing the same network file system (NFS). One of the machines functioned as a master, submitting and managing the jobs using a Parallel Virtual Machine (PVM), while the rest were slaves, reading and writing information from a shared directory in the network file system. Ion channel models were implemented using the NMODL extension of NEURON [<xref ref-type="bibr" rid="pcbi-0030169-b020">20</xref>]. Results were analyzed using custom procedures written in IgorPro 5.01 (Wavemetrics, <ext-link ext-link-type="uri" xlink:href="http://www.wavemetrics.com/" xlink:type="simple">http://www.wavemetrics.com/</ext-link>).</p></sec><sec id="s2b"><title>Genetic Algorithm</title><p>A GA is a search algorithm based on the mechanisms of Darwinian evolution. It uses random mutation, crossover, and selection operators to breed better models or solutions (individuals) from an originally random starting population [<xref ref-type="bibr" rid="pcbi-0030169-b021">21</xref>]. In this study, we started each search with a random population that was at least 20 times larger than the number of free parameters in the fitted model. Each individual in the population described a parameter set and the model was evaluated for each one of them. A search space was defined for each parameter; this avoided parameter combinations causing instability to the set of differential equations, while covering most of the physiological range expected for the parameters. Thus, for rate constants (k) the range was set from zero to 2,000 s<sup>−1</sup>, for voltage-dependence parameters (z) from zero to 2000 V<sup>−1</sup>, and zero to 100 pS for the conductance. Only in model C, where a parameter describing a voltage shift was required, was the range set from zero to +100 mV, disregarding the negative range of this parameter, since the expected value for this parameter was positive in both the simulated and the real data.</p><p>The population was sorted according to the value of the cost function (<xref ref-type="disp-formula" rid="pcbi-0030169-e001">Equation 1</xref>) of each individual, and a new generation was created using selection, crossover, and mutation as operators. Selection used a tournament in which two pairs of individuals were randomly selected and the individual with the better score from each pair was transferred to the next generation. This procedure was repeated N/2 times (where N is the size of the population) until the new population was full. The one exception to this selection process (and later to the crossover and mutation operators) was the best individual that was transferred unchanged to the next generation to prevent a genetic drift.</p><p>Each pair selected for transfer to the new population was subjected to a one-point crossover operator with a probability of 0.5. After the new population was created, each parameter value in the new population was subjected to mutation with a probability of 0.01. This allowed, albeit with a low occurrence frequency, the creation of double and even triple mutations to the same individual, thus increasing the variability in the new population. As detailed in <xref ref-type="fig" rid="pcbi-0030169-g001">Figures 1</xref> and <xref ref-type="fig" rid="pcbi-0030169-g002">2</xref>, two types of mutation operators were used. The first was a substitution of the parameter value with a random value drawn from a flat random number distribution that spanned the entire search space of the parameter. The second mutation operator, depicted in <xref ref-type="fig" rid="pcbi-0030169-g002">Figure 2</xref>, was a relative operator which changed the value of a parameter relative to its current value using a random number drawn from a Gaussian distribution centred on the current value of the parameter with a relative variance of 5%. We tested several values of mutation and crossover probabilities and found these values to be the optimal for the current project.</p><fig id="pcbi-0030169-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030169.g001</object-id><label>Figure 1</label><caption><title>Progression of the Best Individual</title><p>(A) The relative changes in the values of the parameters in the best individual were calculated by the following equation <italic>F</italic> = 100 · (<italic>P<sub>j</sub></italic><sub>,<italic>N</italic></sub> − <italic>P<sub>j</sub></italic><sub>,<italic>N</italic>−1</sub>)/<italic>P<sub>j</sub></italic><sub>,N−1</sub> where <italic>P<sub>j</sub></italic><sub>,N</sub> denotes the value of the <italic>j</italic><sup>th</sup> parameter of the best individual in generation <italic>N</italic> and <italic>P<sub>j</sub></italic><sub>,N−1</sub> denotes the value of the same parameter in the previous generation. The values were multiplied by 100 to display percentage changes. The graph contains the analysis of all parameters in a nine-parameter model without differentiating between them.</p><p>(B) Same graph as in (A) with a longer generation scale and a zoom in on the parameter deviation scale.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030169.g001" xlink:type="simple"/></fig><fig id="pcbi-0030169-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030169.g002</object-id><label>Figure 2</label><caption><title>Modification of the Genetic Algorithm</title><p>(A) A schematic drawing of the changes made to the GA as described in the text.</p><p>(B) Convergence of the GA when the algorithm searched the entire search domain (smooth line) and when the search domain was focused around the current best values 200 generations after the start of the search (dashed line).</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030169.g002" xlink:type="simple"/></fig><p>Ideally, the termination criterion should be that some cost function reaches a value of zero. In practice this is not possible since the run time of the process is limited and reaching this score can take a long time. The simulations ranged from less than an hour for a simple model with a small amount of data (see also the demonstration code in <xref ref-type="supplementary-material" rid="pcbi-0030169-sd001"> Text S1</xref>, which takes two hours on a single Pentium 4 with a 3 GHz clock speed and less than 20 minutes on our cluster and the animation of the convergence of the GA to a model of a voltage-gated ion channel in <xref ref-type="supplementary-material" rid="pcbi-0030169-sv001">Video S1</xref>) to more than a week for a 20-parameter model fitting many experimental points. Therefore, the process was terminated when the value of the best individual had not changed for several hundred generations. Depending on the complexity of the model, this occurred after 1,000–30,000 generations.</p><p>The cost function calculated root mean distance between the target and the test ionic current:
					<disp-formula id="pcbi-0030169-e001"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030169.e001" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:msup><mml:mi>&psi;</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>&equals;</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>M</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:mstyle displaystyle='true'><mml:munderover><mml:mo>&sum;</mml:mo><mml:mi>i</mml:mi><mml:mi>M</mml:mi></mml:munderover></mml:mstyle><mml:mstyle displaystyle='true'><mml:munderover><mml:mo>&sum;</mml:mo><mml:mi>j</mml:mi><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy='false'>(</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>&minus;</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy='false'>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mstyle></mml:mrow></mml:math> --></disp-formula>where <italic>T</italic> represents the target data set and <italic>t</italic> the test dataset. <italic>N</italic> was the total number of points in each simulated ionic current trace and <italic>M</italic> the number of voltage-clamp sweeps simulated in the model.
				</p><p>To rank the ability of various models to fit the data, we used the Log Error Ratio (LER):
					<disp-formula id="pcbi-0030169-e002"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030169.e002" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mi>L</mml:mi><mml:mi>E</mml:mi><mml:mi>R</mml:mi><mml:mo>&equals;</mml:mo><mml:mi>log</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>&chi;</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:msub><mml:mi>&chi;</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math> --></disp-formula>where <italic>χ<sub>A</sub></italic> and <italic>χ<sub>B</sub></italic> are the sum of squared errors for fitting the data to models A and B, respectively [<xref ref-type="bibr" rid="pcbi-0030169-b022">22</xref>]. <xref ref-type="disp-formula" rid="pcbi-0030169-e002">Equation 2</xref> applies in theory to models containing a similar number of parameters. This can be corrected for by using the asymptotic information criterion <italic>AIC</italic> = 2 · (<italic>NP<sub>A</sub></italic> − <italic>NP<sub>B</sub></italic>) / <italic>n</italic> [<xref ref-type="bibr" rid="pcbi-0030169-b023">23</xref>], where <italic>NP<sub>A</sub></italic> and <italic>NP<sub>B</sub></italic> are the number of free parameters in each model and <italic>n</italic> is the number of data points. In this study a large dataset with 15,000–30,000 data points was used for fitting. Therefore, the <italic>AIC</italic> correction was small and not applied in the calculations. Only LER values are reported.
				</p></sec><sec id="s2c"><title>Channel Models</title><p>The models used to generate simulated currents are described below. Some minor changes to these models were made when voltage-gated K<sup>+</sup> currents recorded from nucleated patches were analyzed. The modifications are noted in <xref ref-type="table" rid="pcbi-0030169-t001">Table 1</xref>. Moreover, many published models contain mathematical expressions that hinder the proper use of minimization algorithms. For example, a common expression of a rate constant in a model for a voltage-gated channel can often be seen to assume the general form, <italic>k</italic> = <italic>A</italic>exp(−<italic>z</italic>(<italic>V</italic> − <italic>V</italic><sub>1/2</sub>)). However, the expression exp(<italic>zV</italic><sub>1/2</sub>) can also be expressed as part of the pre-exponential value leading to a simpler equation <italic>k</italic> = <italic>A′</italic>exp(−<italic>zV</italic>). Using the former expression in a minimization scheme invariably leads the algorithm astray due to the interchangeability of the pre-exponential and the fixed parameters in the exponent. Therefore, in all the models we have taken from the modeling literature and that appear below we verified that such interchangeability was eliminated by modifying the formal description of the model.</p><table-wrap content-type="1col" id="pcbi-0030169-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030169.t001</object-id><label>Table 1</label><caption><p>Models Tested in the Fit of the K<sup>+</sup> Currents Displayed in <xref ref-type="fig" rid="pcbi-0030169-g010">Figure 10</xref></p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030169.t001" xlink:type="simple"/><!-- <table frame="hsides" rules="none"><colgroup><col id="tb1col1" align="left" charoff="0" char=""/><col id="tb1col2" align="left" charoff="0" char=""/><col id="tb1col3" align="char" charoff="0" char="."/><col id="tb1col4" align="left" charoff="0" char=""/></colgroup><thead><tr><td align="left"><hr/>Model</td><td><hr/>Rate Constant</td><td><hr/>Number of Free Parameters</td><td><hr/>LER</td></tr></thead><tbody><tr><td>1<sup>st</sup> order HH</td><td>A*exp(&minus;z<sup>.</sup>V<sub>m</sub>)&plus;b</td><td>9</td><td>0.35</td></tr><tr><td>2<sup>nd</sup> order HH</td><td>A*exp(&minus;z<sup>.</sup>V<sub>m</sub>)&plus;b</td><td>9</td><td>0.23</td></tr><tr><td>3<sup>rd</sup> order HH</td><td>A*exp(&minus;z<sup>.</sup>V<sub>m</sub>)&plus;b</td><td>9</td><td>0.39</td></tr><tr><td>1<sup>st</sup> order HH</td><td>A/(1&plus;exp(&minus;z(V<sub>m</sub>&plus;V<sub>1/2</sub>)))&plus;B</td><td>11</td><td>1.97</td></tr><tr><td>C&equals;C&equals;O</td><td>A*exp(&minus;z<sup>.</sup>V<sub>m</sub>)</td><td>11</td><td>0.03</td></tr><tr><td>C&equals;C&equals;O</td><td>A*exp(&minus;z<sup>.</sup>V<sub>m</sub>)&plus;b</td><td>15</td><td>0.25</td></tr><tr><td>C&equals;C&equals;C&equals;O</td><td>A*exp(&minus;z<sup>.</sup>V<sub>m</sub>)</td><td>15</td><td>0.94</td></tr><tr><td>C&equals;C&equals;C&equals;O</td><td>A*exp(&minus;z<sup>.</sup>V<sub>m</sub>)&plus;b</td><td>21</td><td>0</td></tr></tbody></table> --><!-- <table-wrap-foot><fn id="nt101"><p>The LER was calculated relative to the best fit obtained.</p></fn></table-wrap-foot> --></table-wrap><sec id="s2c1"><title>Model A.</title><p>A nine-parameter potassium channel Markov model consisting of two closed states and one open state. Rate constants were defined as
						<disp-formula id="pcbi-0030169-e003"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030169.e003" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mi>C</mml:mi><mml:munderover><mml:mo>&rlhar;</mml:mo><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:mi>C</mml:mi><mml:munderover><mml:mo>&rlhar;</mml:mo><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:mi>O</mml:mi></mml:mrow></mml:math> --><!-- <mml:math display='block'><mml:mtable columnalign='left'><mml:mtr><mml:mtd><mml:msub><mml:mi>g</mml:mi><mml:mi>K</mml:mi></mml:msub><mml:mo>&equals;</mml:mo><mml:msub><mml:mover accent='true'><mml:mi>g</mml:mi><mml:mo>&macr;</mml:mo></mml:mover><mml:mi>K</mml:mi></mml:msub><mml:mo>&sdot;</mml:mo><mml:mi>O</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>&equals;</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>&sdot;</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&equals;</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>&minus;</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&sdot;</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext>where</mml:mtext><mml:mspace width="3pt"/><mml:msub><mml:mover accent='true'><mml:mi>g</mml:mi><mml:mo>&macr;</mml:mo></mml:mover><mml:mi>K</mml:mi></mml:msub><mml:mspace width="3pt"/><mml:mtext>defined in</mml:mtext><mml:mspace width="3pt"/><mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>S</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mi>&mu;</mml:mi><mml:msup><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext>and</mml:mtext><mml:mspace width="2pt"/><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math> --></disp-formula>
					</p><p>The values of each component of the rate constants for this model were 0.05, while the maximal conductance value was 20 (<xref ref-type="fig" rid="pcbi-0030169-g003">Figure 3</xref>).</p><fig id="pcbi-0030169-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030169.g003</object-id><label>Figure 3</label><caption><title>Constraining a Nine-Parameter Voltage-Gated K<sup>+</sup> Channel Model</title><p>(A) Activation of the conductance of Model A (see <xref ref-type="sec" rid="s2">Methods</xref>) simulated in response to depolarizing voltage steps from −40 to +60 mV in steps of 20 mV.</p><p>(B) Deactivation of the conductance of Model A. Following a 20-ms activation to +60 mV, deactivation was simulated by lowering potential to −120 mV to −20 mV in steps of 10 mV.</p><p>(C) The errors in the best parameter set obtained by the GA (left) and GA followed by PrAxis (right) are plotted relative to their target values (dotted lines).</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030169.g003" xlink:type="simple"/></fig></sec><sec id="s2c2"><title>Model B.</title><p>A 13-parameter potassium channel Markov model consisting of three closed states and one open state. Rate constants were defined as
						<disp-formula id="pcbi-0030169-e005"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030169.e005" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mi>C</mml:mi><mml:munderover><mml:mo>&rlhar;</mml:mo><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:mi>C</mml:mi><mml:munderover><mml:mo>&rlhar;</mml:mo><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:mi>C</mml:mi><mml:munderover><mml:mo>&rlhar;</mml:mo><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:mi>O</mml:mi></mml:mrow></mml:math> --><!-- <mml:math display='block'><mml:mtable columnalign='left'><mml:mtr><mml:mtd><mml:msub><mml:mi>g</mml:mi><mml:mi>K</mml:mi></mml:msub><mml:mo>&equals;</mml:mo><mml:msub><mml:mover accent='true'><mml:mi>g</mml:mi><mml:mo>&macr;</mml:mo></mml:mover><mml:mi>K</mml:mi></mml:msub><mml:mo>&sdot;</mml:mo><mml:mi>O</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>&equals;</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>&sdot;</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&equals;</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>&minus;</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&sdot;</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext>where</mml:mtext><mml:mspace width="3pt"/><mml:msub><mml:mover accent='true'><mml:mi>g</mml:mi><mml:mo>&macr;</mml:mo></mml:mover><mml:mi>K</mml:mi></mml:msub><mml:mspace width="3pt"/><mml:mtext>defined in</mml:mtext><mml:mspace width="3pt"/><mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>S</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mi>&mu;</mml:mi><mml:msup><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext>and</mml:mtext><mml:mspace width="3pt"/><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math> --></disp-formula>
					</p><p>The values of each component of the rate constants for this model were 0.05, while the maximal conductance value was 20 (<xref ref-type="fig" rid="pcbi-0030169-g004">Figure 4</xref>).</p><fig id="pcbi-0030169-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030169.g004</object-id><label>Figure 4</label><caption><title>Constraining a 13-Parameter Voltage-Gated K<sup>+</sup> Channel Model</title><p>(A) Activation of the conductance of Model B (see <xref ref-type="sec" rid="s2">Methods</xref>) simulated in response to depolarizing voltage steps from −40 to +60 mV in steps of 20 mV.</p><p>(B) Deactivation of the conductance of Model A. Following a 20 ms activation to +60 mV, deactivation to potentials ranging from −120 to −20 mV in steps of 10 mV was simulated.</p><p>(C) The errors in the best parameter set obtained by the GA (left) and GA followed by PrAxis (right) plotted relative to their target values (dotted lines).</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030169.g004" xlink:type="simple"/></fig></sec><sec id="s2c3"><title>Model C.</title><p>A 16-parameter Hodgkin-Huxley–like model based on the retinal ganglion cell voltage–dependent sodium channel model [<xref ref-type="bibr" rid="pcbi-0030169-b024">24</xref>]. Some changes were made to the original model due to mathematical redundancies which, as detailed above, may lead to an infinite number of variable combinations producing correct fits. We therefore changed the model as follows for our simulated experiments (<xref ref-type="fig" rid="pcbi-0030169-g005">Figure 5</xref>):
						<disp-formula id="pcbi-0030169-e007"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030169.e007" xlink:type="simple"/><!-- <mml:math display='block'><mml:mtable columnalign='left'><mml:mtr><mml:mtd><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>&equals;</mml:mo><mml:msub><mml:mover accent='true'><mml:mi>g</mml:mi><mml:mo>&macr;</mml:mo></mml:mover><mml:mrow><mml:mi>N</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>&sdot;</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mi>h</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>a</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>&equals;</mml:mo><mml:mrow><mml:mrow><mml:mn>0.5</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>&plus;</mml:mo><mml:mn>29</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>&minus;</mml:mo><mml:mi>exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>&minus;</mml:mo><mml:mn>0.18</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>&plus;</mml:mo><mml:mn>29</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>b</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>&equals;</mml:mo><mml:mn>0.3</mml:mn><mml:mi>exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>&minus;</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mn>15</mml:mn></mml:mrow></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>a</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>&equals;</mml:mo><mml:mn>0.014</mml:mn><mml:mi>exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>&minus;</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mn>20</mml:mn></mml:mrow></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>b</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>&equals;</mml:mo><mml:mrow><mml:mrow><mml:mn>2.8</mml:mn></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>&plus;</mml:mo><mml:mi>exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>&minus;</mml:mo><mml:mn>0.1</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>&plus;</mml:mo><mml:mn>20</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext>and</mml:mtext><mml:mspace width="3pt"/><mml:msub><mml:mover accent='true'><mml:mi>g</mml:mi><mml:mo>&macr;</mml:mo></mml:mover><mml:mrow><mml:mi>N</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mspace width="3pt"/><mml:mtext> defined in</mml:mtext><mml:mspace width="3pt"/><mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>S</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mi>&mu;</mml:mi><mml:msup><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math> --></disp-formula>
					</p><fig id="pcbi-0030169-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030169.g005</object-id><label>Figure 5</label><caption><title>Constraining a 15-Parameter Model of a Voltage-Gated Na<sup>+</sup> Channel</title><p>(A) Simulated activation of a Hodgkin-Huxley–like model of the voltage-gated Na<sup>+</sup> current (Model C, [<xref ref-type="bibr" rid="pcbi-0030169-b024">24</xref>]) in response to depolarizing voltage commands.</p><p>(B) Simulated deactivation protocol.</p><p>(C) Simulated steady-state inactivation.</p><p>(D) Simulated pulse inactivation.</p><p>(E) Simulated recovery from inactivation.</p><p>(F) The errors in the best parameter set obtained by the GA (left) and GA followed by PrAxis (right) plotted relative to their target values (dotted lines).</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030169.g005" xlink:type="simple"/></fig><p>This produces a model with ten variables instead of twelve. Five additional parameters were the maximal conductances for each of the simulated voltage stimulation protocols, which were given the same value as in Models A and B in the simulated experiments. The reversal potential for sodium ions was defined as the sixteenth variable when the model was fit to experimental data, producing the equations:
						<disp-formula id="pcbi-0030169-e008"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030169.e008" xlink:type="simple"/><!-- <mml:math display='block'><mml:mtable columnalign='left'><mml:mtr><mml:mtd><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>&equals;</mml:mo><mml:msub><mml:mover accent='true'><mml:mi>g</mml:mi><mml:mo>&macr;</mml:mo></mml:mover><mml:mrow><mml:mi>N</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>&sdot;</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mi>h</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>a</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>&equals;</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>&minus;</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>&minus;</mml:mo><mml:mi>exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>&minus;</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>&minus;</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>b</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>&equals;</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mi>exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>&minus;</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>a</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>&equals;</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mi>exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>&minus;</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>b</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>&equals;</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>&plus;</mml:mo><mml:mi>exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>&minus;</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>&plus;</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mover accent='true'><mml:mi>g</mml:mi><mml:mo>&macr;</mml:mo></mml:mover><mml:mrow><mml:mi>N</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mspace width="3pt"/><mml:mtext>defined in</mml:mtext><mml:mspace width="3pt"/><mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>S</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mi>&mu;</mml:mi><mml:msup><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext>and</mml:mtext><mml:mspace width="3pt"/><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mspace width="3pt"/><mml:mtext>defined in</mml:mtext><mml:mspace width="3pt"/><mml:mi>m</mml:mi><mml:mi>V</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd></mml:mtd></mml:mtr></mml:mtable></mml:math> --></disp-formula>
					</p></sec><sec id="s2c4"><title>Model D.</title><p>A 20-parameter model based on the voltage-dependent sodium channel model [<xref ref-type="bibr" rid="pcbi-0030169-b025">25</xref>]. Several modifications were made to this model to rid it of mathematical redundancies. First, redundancies such as those mentioned in Model C were eliminated. The next step was to make sure, through basic arithmetic, that in each Boltzmann-like rate constant the denominator would consist of a 1 added to an exponent (i.e., <italic>a</italic>/(1 + <italic>b</italic> · exp(<italic>v</italic>/<italic>c</italic>)), thus eliminating additional redundancies. Finally, in simulated experiments, the temperature variable was set to 22 °C and calculated accordingly, producing the equations:
						<disp-formula id="pcbi-0030169-e009"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030169.e009" xlink:type="simple"/><!-- <mml:math display='block'><mml:mtable columnalign='left'><mml:mtr><mml:mtd><mml:mtext> </mml:mtext><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:munderover><mml:mo>&rlhar;</mml:mo><mml:mrow><mml:msub><mml:mi mathsize="12pt">k</mml:mi><mml:mrow><mml:mn mathsize="12pt">2</mml:mn><mml:mo>,</mml:mo><mml:mn mathsize="12pt">1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathsize="12pt">k</mml:mi></mml:mrow><mml:mrow><mml:mn mathsize="12pt">1</mml:mn><mml:mo>,</mml:mo><mml:mn mathsize="12pt">2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:munderover><mml:mo>&rlhar;</mml:mo><mml:mrow><mml:msub><mml:mi mathsize="12pt">k</mml:mi><mml:mrow><mml:mn mathsize="12pt">3</mml:mn><mml:mo>,</mml:mo><mml:mn mathsize="12pt">2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi mathsize="12pt">k</mml:mi><mml:mrow><mml:mn mathsize="12pt">2</mml:mn><mml:mo>,</mml:mo><mml:mn mathsize="12pt">3</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:mi>O</mml:mi></mml:mtd></mml:mtr><mml:mtr></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo>&darr;</mml:mo><mml:mo>&uarr;</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn >4</mml:mn></mml:mrow></mml:msub><mml:mo>&darr;</mml:mo><mml:mo>&uarr;</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn >4</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo>&darr;</mml:mo><mml:mo>&uarr;</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>I</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:munderover><mml:mo>&rlhar;</mml:mo><mml:mrow><mml:msub><mml:mi mathsize="12pt">k</mml:mi><mml:mrow><mml:mn mathsize="12pt">2</mml:mn><mml:mo>,</mml:mo><mml:mn mathsize="12pt">1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi mathsize="12pt">k</mml:mi><mml:mrow><mml:mn mathsize="12pt">1</mml:mn><mml:mo>,</mml:mo><mml:mn mathsize="12pt">2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:msub><mml:mi>I</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:munderover><mml:mo>&rlhar;</mml:mo><mml:mrow><mml:msub><mml:mi mathsize="12pt">k</mml:mi><mml:mrow><mml:mn mathsize="12pt">2</mml:mn><mml:mo>,</mml:mo><mml:mn mathsize="12pt">3</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi mathsize="12pt">k</mml:mi><mml:mrow><mml:mn mathsize="12pt">2</mml:mn><mml:mo>,</mml:mo><mml:mn mathsize="12pt">3</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:msub><mml:mi>I</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:math> --><!-- <mml:math display='block'><mml:mtable columnalign='left'><mml:mtr><mml:mtd><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>&equals;</mml:mo><mml:msub><mml:mover accent='true'><mml:mi>g</mml:mi><mml:mo>&macr;</mml:mo></mml:mover><mml:mrow><mml:mi>N</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>&sdot;</mml:mo><mml:mi>O</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>&equals;</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mi>exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>&sdot;</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&equals;</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mi>exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>&minus;</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&sdot;</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>&equals;</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mn>3</mml:mn><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>&plus;</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mn>3</mml:mn><mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mi>exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>&minus;</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>&sdot;</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>&equals;</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mn>2</mml:mn><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>&plus;</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mn>2</mml:mn><mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mi>exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>&sdot;</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo>&equals;</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mn>4</mml:mn><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>&plus;</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mn>4</mml:mn><mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mi>exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>&minus;</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo>&sdot;</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&equals;</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mi>exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>&minus;</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&sdot;</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math> --></disp-formula>Maximal conductances for simulated experiments were defined as previously described. Again, when fitting experimental data the reversal potential for sodium ions was added as the twentieth variable (<xref ref-type="fig" rid="pcbi-0030169-g006">Figure 6</xref>)
					</p><fig id="pcbi-0030169-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030169.g006</object-id><label>Figure 6</label><caption><title>Fitting a Model to Experimentally Recorded Voltage-Gated Na<sup>+</sup> Currents from Neocortical Pyramidal Neurons</title><p>Results of fitting a dataset containing three pulse protocols to two models, Model D [<xref ref-type="bibr" rid="pcbi-0030169-b025">25</xref>], left column, and Model E [<xref ref-type="bibr" rid="pcbi-0030169-b016">16</xref>], right column. Data are shown as black lines, the fit in red. Pre-pulses and long stretches of data recorded at the holding potential were removed from the data traces to reduce possible bias to the fit. The activation traces (top traces) are inward currents recorded from a nucleated patch. A 100-ms pulse to −110 mV followed by a 20-ms pulse to voltages between −30 and +35 mV at 5-mV increments. Steady-state inactivation is shown in the middle traces. The inward currents were generated by a 20-ms voltage step to zero following a 100-ms pre-pulse to voltages between −105 mV and −5 mV at 10-mV increments. In pulse inactivation (bottom traces), the inward currents were generated in response to a voltage step to −50 mV (following a 100-ms pre-pulse to −110 mV) for varying durations from 0 ms to 45 ms in increments of 5 ms, followed by another voltage step to 0 ms for 30 ms. Data in all traces were filtered at 10 kHz and sampled at 20 kHz. The parameters generating the fit of Model D were: g<sub>Na,act</sub> = 20.65; g<sub>Na,SSI</sub> = 20.44; g<sub>Na,onset</sub> = 12.15; a<sub>1,2</sub> = 12.27; z<sub>1,2</sub> = 0.038; a<sub>2,1</sub> = 0.01; z<sub>2,1</sub> = 0.246; a<sub>2,3a</sub> = 21.55; a<sub>2,3b</sub> = 1.42; z<sub>2,3</sub> = 0.130; a<sub>3,2a</sub> = 1428; a<sub>3,2b</sub> = 234.5; z<sub>3,2</sub> = 0.0047; a<sub>1,4a</sub> = 3.9; a<sub>1,4b</sub> = 1.72; z<sub>1,4</sub> = 0.08; a<sub>4,1</sub> = 0.015; z<sub>4,1</sub> = 0.031; and E<sub>Na</sub>=59.7 mV.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030169.g006" xlink:type="simple"/></fig></sec><sec id="s2c5"><title>Model E.</title><p>A 16-parameter Markov model designed for the giant squid axon sodium conductance [<xref ref-type="bibr" rid="pcbi-0030169-b016">16</xref>]. As before, redundancies were eliminated. However, we used Patlak's calculations and assumptions to reduce the number of exponential variables to three. Further, while the rate constants and exponential variables were defined as previously described, the nomenclature for the pre-exponential variables was that used by Patlak, producing the equations:
						<disp-formula id="pcbi-0030169-e011"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030169.e011" xlink:type="simple"/><!-- <mml:math display='block'><mml:mtable columnalign='left'><mml:mtr><mml:mtd><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:munderover><mml:mo>&rlhar;</mml:mo><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:munderover><mml:mo>&rlhar;</mml:mo><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:msub><mml:mi>C</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:munderover><mml:mo>&rlhar;</mml:mo><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:msub><mml:mi>C</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:munderover><mml:mo>&rlhar;</mml:mo><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:mi>O</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>7</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo>&uarr;</mml:mo><mml:mo>&darr;</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>6</mml:mn><mml:mo>,</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mo>&uarr;</mml:mo><mml:mo>&darr;</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>I</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:munderover><mml:mo>&rlhar;</mml:mo><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>6</mml:mn><mml:mo>,</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>7</mml:mn><mml:mo>,</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:msub><mml:mi>I</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:math> --><!-- <mml:math display='block'><mml:mtable columnalign='left'><mml:mtr><mml:mtd><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>&equals;</mml:mo><mml:msub><mml:mover accent='true'><mml:mi>g</mml:mi><mml:mo>&macr;</mml:mo></mml:mover><mml:mrow><mml:mi>N</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>&sdot;</mml:mo><mml:mi>O</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>&equals;</mml:mo><mml:mi>k</mml:mi><mml:mi>a</mml:mi><mml:mi>p</mml:mi><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mo>&sdot;</mml:mo><mml:mi>exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&sdot;</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&equals;</mml:mo><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mi>b</mml:mi><mml:mi>d</mml:mi><mml:mi>a</mml:mi><mml:mo>&sdot;</mml:mo><mml:mi>exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>&minus;</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>&sdot;</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>&equals;</mml:mo><mml:mn>3</mml:mn><mml:mo>&sdot;</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>&sdot;</mml:mo><mml:mi>exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&sdot;</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>&equals;</mml:mo><mml:mn>2</mml:mn><mml:mo>&sdot;</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>&sdot;</mml:mo><mml:mi>exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>&minus;</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>&sdot;</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo>&equals;</mml:mo><mml:mn>2</mml:mn><mml:mo>&sdot;</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>&sdot;</mml:mo><mml:mi>exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&sdot;</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>&equals;</mml:mo><mml:mn>3</mml:mn><mml:mo>&sdot;</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>&sdot;</mml:mo><mml:mi>exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>&minus;</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>&sdot;</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mo>&equals;</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>7</mml:mn><mml:mo>,</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo>&equals;</mml:mo><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mo>&sdot;</mml:mo><mml:mi>exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&sdot;</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo>&equals;</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>6</mml:mn><mml:mo>,</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:msub><mml:mo>&equals;</mml:mo><mml:mi>g</mml:mi><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mo>&sdot;</mml:mo><mml:mi>exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>&minus;</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>&sdot;</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo>&equals;</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:msub><mml:mo>&equals;</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>&sdot;</mml:mo><mml:mi>exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>&minus;</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>&sdot;</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>6</mml:mn><mml:mo>,</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mo>&equals;</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>7</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo>&equals;</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>&sdot;</mml:mo><mml:mi>exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>&sdot;</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math> --></disp-formula>
					</p><p>As in preceding models, four maximal conductances were added to the model for each stimulation protocol. Finally, when fitting experimental data the reversal potential for sodium ions was added as the sixteenth variable (<xref ref-type="fig" rid="pcbi-0030169-g006">Figure 6</xref>).</p></sec><sec id="s2c6"><title>Model F.</title><p>A 15-parameter Hodgkin-Huxley–like model was based on disjoint analysis of voltage-gated Na<sup>+</sup> currents recorded from nucleated patches in L5 pyramidal neurons and used for simulating back-propagating action potentials in bitufted interneurons [<xref ref-type="bibr" rid="pcbi-0030169-b026">26</xref>].
						<disp-formula id="pcbi-0030169-e013"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030169.e013" xlink:type="simple"/><!-- <mml:math display='block'><mml:mtable columnalign='left'><mml:mtr><mml:mtd><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>&equals;</mml:mo><mml:msub><mml:mover accent='true'><mml:mi>g</mml:mi><mml:mo>&macr;</mml:mo></mml:mover><mml:mrow><mml:mi>N</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>&sdot;</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mi>h</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>m</mml:mi><mml:mi>&tau;</mml:mi></mml:msub><mml:mo>&equals;</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&plus;</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mi>exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>&minus;</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>m</mml:mi><mml:mi>&infin;</mml:mi></mml:msub><mml:mo>&equals;</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>&plus;</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mi>exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>&minus;</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>h</mml:mi><mml:mi>&tau;</mml:mi></mml:msub><mml:mo>&equals;</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&plus;</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mi>exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>&minus;</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>h</mml:mi><mml:mi>&infin;</mml:mi></mml:msub><mml:mo>&equals;</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>&plus;</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mi>exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>&minus;</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math> --></disp-formula>As in preceding models, four maximal conductances were added to the model for each stimulation protocol. Finally, when fitting experimental data the reversal potential for sodium ions was added as the sixteenth variable.
					</p></sec></sec><sec id="s2d"><title>Slice Preparation</title><p>Slices (sagittal, 300 μm thick) were prepared from the somatosensory cortex of 13–15 days old Wistar rats that were killed by rapid decapitation, according to the guidelines of the Bar-Ilan University animal welfare committee. Slice preparation followed Stuart [<xref ref-type="bibr" rid="pcbi-0030169-b027">27</xref>]. Slices were perfused throughout the experiment with an oxygenated artificial cerebrospinal fluid (ACSF) containing: (mM) 125 NaCl, 25 NaHCO<sub>3</sub>, 2.5 KCl, 1.25 NaH<sub>2</sub>PO<sub>4</sub>, 1 MgCl<sub>2</sub>, 2 CaCl<sub>2</sub>, and 25 Glucose (pH 7.4 with 5% CO<sub>2</sub>). All experiments were carried out at room temperature (20–22 °C). Pyramidal neurones from L5 in the somatosensory cortex were visually identified using infrared differential interference contrast (IR-DIC) videomicroscopy [<xref ref-type="bibr" rid="pcbi-0030169-b027">27</xref>].</p><p>To record voltage-gated K<sup>+</sup> currents, the standard pipette solution contained (mM): 125 K-gluconate, 20 KCl, 10 HEPES, 4 MgATP, 10 Na-phosphocreatine, 0.5 EGTA, and 0.3 GTP (pH 7.2 with KOH). 10 mM 4-AP was included in the bath solution to reduce the amplitude of the A-type K<sup>+</sup> conductance [<xref ref-type="bibr" rid="pcbi-0030169-b028">28</xref>]. The pipette solution for recording voltage-gated Na<sup>+</sup> currents contained (mM) 120 Cs-gluconate, 20 CsCl, 10 HEPES, 4 MgATP, 10 Na-phosphocreatine, 1 EGTA, and 0.3 GTP (pH 7.2 with CsOH). In addition, 30 mM TEA was added to the bath solution to reduce residual K<sup>+</sup> current amplitude. A similar amount of NaCl was removed from the bath solution to maintain constant osmolarity.</p></sec><sec id="s2e"><title>Nucleated Outside-Out Patches</title><p>Nucleated outside-out patches [<xref ref-type="bibr" rid="pcbi-0030169-b029">29</xref>] were extracted from the soma of L5 pyramidal neurons. Briefly, negative pressure (180–230 mbar) was applied when recording in the whole-cell configuration, and the pipette was slowly retracted. Gentle and continuous retraction created large patches of membrane engulfing the nucleus of the neuron. Following extraction of the patch, the pressure was reduced to 20–40 mBar for the duration of the experiment. All measurements from nucleated and cell-attached patches were carried out with the Axopatch-200B amplifier (Axon Instruments, <ext-link ext-link-type="uri" xlink:href="http://www.axon.com" xlink:type="simple">http://www.axon.com</ext-link>). The capacitive compensation circuit of the amplifier reduced capacitive transients. Nucleated patches were held at −60 mV unless otherwise stated. Linear leak and capacitive currents were subtracted off-line by scaling of 20–30 average pulses measured during hyperpolarization (−80 to −100 mV). Currents were filtered at 5–10 kHz and sampled at rates two to ten times higher than the filtering frequency. The reference electrode was an Ag-AgCl pellet placed in the pipette solution and connected to the experimental chamber via an agar bridge containing 150 mM KCl. Under these conditions, the total voltage offset due to electrode and liquid junction potentials [<xref ref-type="bibr" rid="pcbi-0030169-b030">30</xref>] was 2 mV. Membrane potential was not corrected for this potential difference. Recordings were made with fire-polished Sylgard-coated (General Electric, RTV615) pipettes (5–8 MΩ).</p></sec></sec><sec id="s3"><title>Results</title><p>One of the main issues concerning GAs (or any minimizing algorithm) is computing power and, consequently, execution times. One of the main goals, when dealing with minimization algorithms, is therefore to produce algorithms which are non-cumbersome, while retaining their ability to efficiently sample the parameter space. A common method for achieving this goal is to limit the parameter search space, for example by adaptive trimming down of the ranges for parameter search [<xref ref-type="bibr" rid="pcbi-0030169-b031">31</xref>]. These methods did not reduce the complexity and time detriments of our algorithm.</p><p>Instead, while running and analyzing the performance of the GA, we observed a recurring behavior. In 14 preliminary runs, the GA demonstrated a comparable pattern of convergence, where after several hundred generations the best individual in each generation quickly converged to a region in the parameter space. This is illustrated in <xref ref-type="fig" rid="pcbi-0030169-g001">Figure 1</xref>, which describes the steps taken by each parameter of the best individual in each generation in a nine-parameter model. The steps toward each target value are displayed as the percentage change from that parameter value in the previous generation. <xref ref-type="fig" rid="pcbi-0030169-g001">Figure 1</xref>A displays the steps taken by the parameters over the first two hundred generations of the GA progress. During the first fifty generations, large changes were observed in the values of some of the parameters in the best individual vector.</p><p>In the further generations, parameter values in the best individual changed only in small steps. <xref ref-type="fig" rid="pcbi-0030169-g001">Figure 1</xref>B shows a detailed view of the algorithm convergence presented above, showing clearly that after several hundred generations the parameters have mutated to only a few percent from their values in the previous generation. Since the parameter search space remained constant, the small changes in value as parameters converged became more insignificant in comparison with the full range of the parameter search space.</p><p>We solved this problem by defining a new range for each parameter mutation search space using a Gaussian centered on the best value of that parameter obtained in the previous generation with a relative variance of 5%. The randomly picked value was then multiplied by the current value of each individual found by the GA, providing a new value limited to ∼±22% of the current value of each individual (<xref ref-type="fig" rid="pcbi-0030169-g002">Figure 2</xref>A). The Gaussian range was implemented only after the GA went through at least 500 generations, taking advantage of the fast convergence observed in the initial stages of the run. This new adaptive range for parameter mutation search space proved more efficient than the previously attempted fixed ranges. It increases the probability of the algorithm searching for better individuals around the best value of the individual found so far, as was indeed observed in the preliminary runs. At the same time the possibility of a better individual existing farther away is not dismissed (as the Gaussian is infinite on both ends). A comparison between the GA with and without the adaptive Gaussian range revealed that, while the original algorithm gradually converged and reached a score of 0.1 after 10,000 generations (<xref ref-type="fig" rid="pcbi-0030169-g002">Figure 2</xref>B, smooth line) for the nine-parameter Model A described in the <xref ref-type="sec" rid="s2">Methods</xref>, the new GA converged after 1,000 generations to a score of 10<sup>−4</sup> (<xref ref-type="fig" rid="pcbi-0030169-g002">Figure 2</xref>B, dashed line).</p><p>Subsequently, we simulated potassium currents using several basic kinetic models for potassium channels (see the Channel Models section in <xref ref-type="sec" rid="s2">Methods</xref>). The potassium current data were saved and used as a reference for the GA convergence. We initially tested a nine-parameter model (Model A) with equal value parameters. This did not prevent the resulting simulated currents from resembling experimentally recorded ones. <xref ref-type="fig" rid="pcbi-0030169-g003">Figure 3</xref>A displays the activation of the conductance in response to 20 mV voltages steps from −80 to +60 mV. <xref ref-type="fig" rid="pcbi-0030169-g003">Figure 3</xref>B shows the deactivation of the conductance after 20 ms activation to +60 mV from potentials ranging from −120 mV to −20 mV in steps of 10 mV. This entire set of data was used as the target dataset for calculating the score function (<xref ref-type="disp-formula" rid="pcbi-0030169-e001">Equation 1</xref>) for each individual generated by the GA. After approximately 5,000 generations, the GA converged all of the nine parameters to within 40% of their true target (<xref ref-type="fig" rid="pcbi-0030169-g003">Figure 3</xref>C).</p><p>After the GA run was stopped, the data were run through a hill-climbing Principle Axis algorithm (PrAxis) [<xref ref-type="bibr" rid="pcbi-0030169-b032">32</xref>], which is part of the NEURON simulation environment. This converged the remaining parameters to 1%–2% of the target values (<xref ref-type="fig" rid="pcbi-0030169-g003">Figure 3</xref>C). To determine the efficiency of the PrAxis routine alone, we generated 100 random parameter vectors and used them as starting guesses for this routine. In none of the cases was the PrAxis routine able to provide even a rough fit of the data. Thus, it is only the combination of the GA followed by the PrAxis that produced a good fit.</p><p>We further simulated potassium currents using a thirteen-parameter model (Model B). Again, the potassium current data for activation (<xref ref-type="fig" rid="pcbi-0030169-g004">Figure 4</xref>A) and deactivation (<xref ref-type="fig" rid="pcbi-0030169-g004">Figure 4</xref>B) was saved and used as the target dataset for the GA convergence. As in the previous experiment, after ∼5,000 generations the GA converged all but two parameters to within 40% of their target values (the remaining two reaching values less than 200% of their target value). Once more, <inline-formula id="pcbi-0030169-ex001"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0030169.ex001" xlink:type="simple"/></inline-formula>
				 (being independent of membrane potential) converged to within a few hundredths of a percent from its target value. As before, the GA data were run through PrAxis, producing a fit that was only a few percent from the target value for all parameters (<xref ref-type="fig" rid="pcbi-0030169-g004">Figure 4</xref>C). Similar results were obtained for several different target parameters sets.
			</p><p>Using the dataset produced by Models A and B, we also investigated the ability of simulated annealing (SA) and random sampling to replace the GA scheme we present here. The SA algorithm performed as efficiently as the GA in some cases and much worse in others (simulations not shown). Analysis of the simulations revealed that, unlike the GA, the cooling scheme of the SA algorithm had to be repeatedly fine-tuned to properly constrain the parameters of different models. We also tested the ability of extensive random sampling as a substitute for the GA. After 1,000,000 iterations, the best score obtained for Model B was ∼6,000, at least two orders of magnitude bigger than the score obtained by the GA after a similar number of iterations.</p><p>Since our analysis uses a large amount of data, we tested its accuracy in converging on the target parameters using varying amounts of data. We compared the accuracy of the combined convergence of the GA and PrAxis for an increasing number of stimulation sweeps (<xref ref-type="fig" rid="pcbi-0030169-g009">Figure 9</xref>) previously used with Model B to produce the activation traces in <xref ref-type="fig" rid="pcbi-0030169-g004">Figure 4</xref>A. The score function produced a seemingly near-perfect fit when using a small number of stimulation sweeps, but its divergence from zero increased as the number of sweeps grew (<xref ref-type="fig" rid="pcbi-0030169-g007">Figure 7</xref>A). However, an opposing trend was observed when comparing the mean deviation of the best parameter values reached by the GA and PrAxis from their target values (<xref ref-type="fig" rid="pcbi-0030169-g007">Figure 7</xref>B). We therefore conclude that an increasing number of data sweeps is needed for an accurate estimate of the kinetic parameters of a model and does not lead to overfitting of the model. This conclusion was further supported by simulations run on Model C, which proved that an increasing number of stimulation protocols, expressing varying aspects of channel kinetics, also add to the accuracy of the process (unpublished data).</p><fig id="pcbi-0030169-g007" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030169.g007</object-id><label>Figure 7</label><caption><title>Effect of Increasing Number of Sweeps on GA Performance</title><p>(A) Best GA and PrAxis fit function score versus an increasing number of activation stimulation sweeps using Model B (as depicted in <xref ref-type="fig" rid="pcbi-0030169-g004">Figure 4</xref>A).</p><p>(B) Mean deviation of calculated parameter values from their target values versus increasing number of activation stimulation sweeps.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030169.g007" xlink:type="simple"/></fig><p>As our aim was to use our GA in fitting a model to currents recorded from neurons, we needed to test our GA's ability to converge in the presence of noise. We therefore created several simulations consisting of randomly generated noise of varying amplitudes. We first tested a 14-parameter model with equal parameters in the presence of random noise whose amplitude was 5% of the current value. (This model was identical to the 13-parameter Model B plus a maximal conduction density for the deactivation protocol, simulating variability between consecutive recordings or, alternatively, data obtained from two different recordings.) The final convergence of both GA and PrAxis resulted in a fit of an average of 5% from the true values (fit not shown). We then ran three similar experiments with constant amplitude noise varying between ±10, ±20, and ±30 pA in each experiment. The results illustrate the GA's ability to converge in spite of the noisy data (<xref ref-type="fig" rid="pcbi-0030169-g008">Figure 8</xref>). The average distance of the parameters from their target values was 1.4%, 2.5%, and 1.4% for the three noise levels respectively.</p><fig id="pcbi-0030169-g008" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030169.g008</object-id><label>Figure 8</label><caption><title>Effect of Noise on GA Performance</title><p>The errors in the best parameter set obtained by the GA followed by PrAxis plotted relative to their target values (dotted lines) for three cases of increasing white noise added to the simulated currents.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030169.g008" xlink:type="simple"/></fig><p>The response of voltage-gated channels to changes in membrane potential is traditionally measured using a step change in the membrane potential. This is the essence of the voltage-clamp method, which stems from the relative ease of analytically solving the differential equations describing channel relaxation following step activation. Here we have used numerical methods to solve the equations describing channel activation. Therefore, it occurred to us that the GA may also be able to estimate the parameters of a model using a set of data obtained with not-so-standard voltage-clamp protocols. One such protocol is the voltage ramp, which is appealing mainly from the experimental point of view. The voltage ramp is a very useful protocol since it allows the experimentalist a glimpse of the full voltage dependence of a channel using one fast protocol. Furthermore, of all voltage-clamp protocols, the voltage ramp is unique in that during the ramp the contribution of the capacitance to the current is constant. This allows simpler and cleaner leak subtraction than when a square pulse is applied and the capacitive current approaches infinity at the onset of the pulse.</p><p><xref ref-type="fig" rid="pcbi-0030169-g009">Figure 9</xref>A displays the activation (top traces) of a nine-parameter model of a voltage-gated K<sup>+</sup> channel (Model A) in response to ramps of varying duration with potential ranging from −100 mV to +50 mV (<xref ref-type="fig" rid="pcbi-0030169-g009">Figure 9</xref>A, bottom traces). <xref ref-type="fig" rid="pcbi-0030169-g009">Figure 9</xref>B displays the response of the same model to deactivating voltage ramps from +50 mV to −100 mV (following a 50-ms step to +50 mV to fully activate the conductance). The dataset displayed in <xref ref-type="fig" rid="pcbi-0030169-g009">Figure 9</xref>A and <xref ref-type="fig" rid="pcbi-0030169-g009">9</xref>B was used as target dataset to the GA to determine whether it can be used to constrain the parameters of Model A. After 5,000 generations, the error in the parameters, relative to the target parameters, ranged between 0.01 to 42% (<xref ref-type="fig" rid="pcbi-0030169-g009">Figure 9</xref>C). When this set of parameters was used as an initial guess for the PrAxis hill-climbing algorithm, the error range was reduced to between 10<sup>−4</sup>% to 5% (<xref ref-type="fig" rid="pcbi-0030169-g009">Figure 9</xref>C). Similar results were obtained when Model B was used to generate the target dataset. Thus, this set of simulations demonstrated that the GA could locate the global minimum even when the target dataset was generated using non-classical voltage-clamp protocols.</p><p>Following our successful simulations of potassium channel models, we proceeded to more complex simulations of sodium channels. One model tested was based on the sodium current recorded from retinal ganglion cells [<xref ref-type="bibr" rid="pcbi-0030169-b024">24</xref>]. The small changes we made to the model (Model C in <xref ref-type="sec" rid="s2">Methods</xref>) were necessary to eliminate redundancy in the original model, which would have prevented the GA from constraining the parameters to the appropriate values. When considering a voltage-gated channel that displays both activation and inactivation, the repertoire of voltage protocols increases substantially. The five basic voltage protocols routinely applied in such cases are activation (<xref ref-type="fig" rid="pcbi-0030169-g005">Figure 5</xref>A), deactivation (<xref ref-type="fig" rid="pcbi-0030169-g005">Figure 5</xref>B), steady-state inactivation (<xref ref-type="fig" rid="pcbi-0030169-g005">Figure 5</xref>C), pulse inactivation (<xref ref-type="fig" rid="pcbi-0030169-g005">Figure 5</xref>D), and recovery from inactivation (<xref ref-type="fig" rid="pcbi-0030169-g005">Figure 5</xref>E). Using this target dataset, the GA, after ∼11,000 generations, generated a parameter set that deviated from the target parameter set by 10%–200% (<xref ref-type="fig" rid="pcbi-0030169-g005">Figure 5</xref>F). Using this set of parameters as an initial guess for the PrAxis hill-climbing algorithm reduced the error range from 10<sup>−4</sup>% to 10<sup>−2</sup>%, practically a perfect fit (<xref ref-type="fig" rid="pcbi-0030169-g005">Figure 5</xref>F).</p><p>Next we tested the GA on voltage-gated K<sup>+</sup> currents recorded in nucleated outside-out patches extracted from layer 5 neocortical pyramidal neurons. These neurons contain several voltage-gated K<sup>+</sup> channels [<xref ref-type="bibr" rid="pcbi-0030169-b028">28</xref>,<xref ref-type="bibr" rid="pcbi-0030169-b033">33</xref>]. To reduce the number of channels, we blocked the A-type K<sup>+</sup> channel with 10 mM 4-AP. The residual current, the slow voltage-gated K<sup>+</sup> channel [<xref ref-type="bibr" rid="pcbi-0030169-b028">28</xref>,<xref ref-type="bibr" rid="pcbi-0030169-b033">33</xref>], was activated by voltage steps from −80 to +40 mV (<xref ref-type="fig" rid="pcbi-0030169-g010">Figure 10</xref>A). All the traces in <xref ref-type="fig" rid="pcbi-0030169-g010">Figure 10</xref> were recorded with an extracellular K<sup>+</sup> concentration of 6.5 mM to generate larger deactivating tail currents. The activation and deactivation data traces were used as the target dataset for the GA, and the fitness of several models was tested. Following convergence of the GA, the best parameter set was used as an initial guess for the PrAxis routine. The results of these minimizations are summarized in <xref ref-type="table" rid="pcbi-0030169-t001">Table 1</xref> where models are compared using their LER [<xref ref-type="bibr" rid="pcbi-0030169-b022">22</xref>]. The best fit was obtained for a model with three closed states and one open state in which the rate constants were exponential. However, the fitness of this model, containing 21 free parameters, did not differ substantially from a model with two closed states and only 11 parameters. Thus, to avoid overfitting, we decided that the latter model produced the best fit for this dataset. This fit is shown in <xref ref-type="fig" rid="pcbi-0030169-g010">Figure 10</xref>A and <xref ref-type="fig" rid="pcbi-0030169-g010">10</xref>B as red lines. Similar results were obtained in two more patches.</p><p>Next, we investigated whether the model obtained in this way could predict the response of the conductance to other, less traditional, voltage-clamp protocols. Responses to activation ramps from −100 mV to +40 mV, with varying durations starting from 40 ms and increasing in steps of 10 ms (blue lines), were simulated. These were compared with currents recorded from the patch used in <xref ref-type="fig" rid="pcbi-0030169-g010">Figure 10</xref>A and <xref ref-type="fig" rid="pcbi-0030169-g010">10</xref>B using identical voltage-clamp protocols (<xref ref-type="fig" rid="pcbi-0030169-g010">Figure 10</xref>C). Simulations of responses to deactivation ramps from +40 mV to −80 mV with durations increasing in 5-ms steps from 2 ms (blue lines) were similarly compared with recorded current traces (<xref ref-type="fig" rid="pcbi-0030169-g010">Figure 10</xref>D). <xref ref-type="fig" rid="pcbi-0030169-g010">Figure 10</xref>E and <xref ref-type="fig" rid="pcbi-0030169-g010">10</xref>F depict a further comparison of data recorded from the patch and data simulated on the best model using the stimulation protocols shown in <xref ref-type="fig" rid="pcbi-0030169-g010">Figure 10</xref>A and <xref ref-type="fig" rid="pcbi-0030169-g010">10</xref>B. The voltage-clamp protocols in <xref ref-type="fig" rid="pcbi-0030169-g010">Figure 10</xref>E and <xref ref-type="fig" rid="pcbi-0030169-g010">10</xref>F were sine waves from −70 mV to +70 mV with a frequency of 50 Hz and 100 Hz, respectively. Again, the blue lines depict the current produced by Model A which had the best fit to the activation and deactivation data in <xref ref-type="fig" rid="pcbi-0030169-g010">Figure 10</xref>A and <xref ref-type="fig" rid="pcbi-0030169-g010">10</xref>B.</p><fig id="pcbi-0030169-g009" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030169.g009</object-id><label>Figure 9</label><caption><title>Constraining a Model Using Voltage Ramps</title><p>(A) The activation (top traces) of a nine-parameter model of a voltage-gated K<sup>+</sup> channel (Model A) in response to ramps from −100 mV to +50 mV with varying duration (bottom traces).</p><p>(B) The response of the same model to deactivating voltage ramps from +50 to −100 mV (following a 50-ms step to +50 mV to allow for full-channel activation).</p><p>(C) The errors in the best parameter set obtained by the GA (left) and GA followed by PrAxis (right) plotted relative to their target values (dotted lines).</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030169.g009" xlink:type="simple"/></fig><fig id="pcbi-0030169-g010" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030169.g010</object-id><label>Figure 10</label><caption><title>Fitting a Model to Experimentally Recorded Voltage-Gated K<sup>+</sup> Currents from Neocortical Pyramidal Neurons</title><p>(A) Outward currents recorded from a nucleated patch. 400-ms pulse to −110 mV followed by a 90-ms pulse to voltages between −80 mV and +80 mV at 20-mV increments. The −110 mV pre-pulse was truncated to facilitate the display of the outward current. Sampled at 20 kHz and filtered at 5 kHz. Leak was subtracted off-line. The red lines are the fit obtained by GA followed by PrAxis for a model with two closed states and one open state (see the text and <xref ref-type="table" rid="pcbi-0030169-t001">Table 1</xref>).</p><p>(B) The outward current was generated by a 20-ms voltage step to +80 mV following a 400-ms pre-pulse to −110 mV (truncated). The voltage was then stepped from −120 mV in steps of 10 mV to record the deactivation kinetics. The bath solution contained 10 mM 4-AP and 65 mM K<sup>+</sup>. Leak was subtracted off-line. Filtered at 10 kHz and sampled at 50 kHz. The red lines are the fit obtained by GA followed by PrAxis for a model with two closed states and one open state (see the text and <xref ref-type="table" rid="pcbi-0030169-t001">Table 1</xref>). The parameters that generated the fit of Model A were: g<sub>K,act</sub> = 5.95; g<sub>K,deact</sub> = 4.52; a<sub>1,2</sub> = 0.07; z<sub>1,2</sub> = 0.041; a<sub>2,1</sub> = 0.434; z<sub>2,1</sub> = 0.021; a<sub>2,3</sub> = 0.056; z<sub>2,3</sub> = 0.025; a<sub>3,2</sub> = 0.011; and z<sub>3,2</sub> = 0.0317.</p><p>(C) The outward current was generated by a 500-ms pulse to −100 mV (truncated) followed by voltage ramps to +40 mV. Ramp duration started at 40-ms duration and was increased in steps of 10 ms. The blue lines are the simulated currents produced in response to an identical protocol using Model A with the parameter values detailed in (B).</p><p>(D) The outward current was generated by deactivating voltage ramps from +40 mV to −80 mV. Ramp duration started at 2 ms and increased in steps of 5 ms (following a 40-ms step to +40 mV to allow for full-channel activation). The blue lines are the simulated currents produced in response to an identical protocol using Model A with the parameter values detailed in (B). Filtered at 5 kHz and sampled at 10 kHz.</p><p>(E) The outward current was generated using a sinusoidal voltage change following a 600-ms pre-pulse to −100 mV (truncated). The sine wave ranged from +70 mV to −70 mV with a frequency of 50 Hz. The blue lines are the simulated currents produced in response to an identical protocol using Model A with the parameter values detailed in (B). Filtered at 5 kHz and sampled at 10 kHz.</p><p>(F) The outward current was generated using a sinusoidal voltage change following a 600-ms pre-pulse to −100 mV (truncated). The sine wave ranged between +70 mV to −70 mV with a frequency of 100 Hz. The blue lines are the simulated currents produced in response to an identical protocol using Model A with the parameter values detailed in (B). Filtered at 5 kHz and sampled at 10 kHz.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030169.g010" xlink:type="simple"/></fig><p>Subsequently, we used the GA on voltage-gated Na<sup>+</sup> currents recorded in nucleated outside-out patches extracted from layer 5 neocortical pyramidal neurons. Data traces from activation, steady-state inactivation, pulse inactivation, and recovery from inactivation were used as the target dataset for the GA, and the fitness of several models was tested. The activation, steady-state inactivation, and pulse inactivation currents of the voltage-gated Na<sup>+</sup> channel are shown in <xref ref-type="fig" rid="pcbi-0030169-g006">Figure 6</xref>. The activation currents were produced in response to voltage steps from −30 to +35 mV in steps of 5 mV from a holding potential of −110 mV. The steady-state inactivation currents were produced in response to a voltage step to 0 from holding potentials varying from −105 mV to −5 mV in 10-mV increments. The pulse inactivation currents were produced in response to a voltage step to −50 mV (from a holding potential of −110 mV) for durations varying from 0 ms to 45 ms in increments of 5 ms followed by another voltage step to 0 ms for 30 ms. After convergence of the GA, the best parameter set was used as an initial guess for the PrAxis routine. The results of these minimizations are summarized in <xref ref-type="table" rid="pcbi-0030169-t002">Table 2</xref> where models are compared using their LER. The best fit was obtained for a model containing two closed states, an open state, and two inactivated states (Model D, see <xref ref-type="fig" rid="pcbi-0030169-g006">Figure 6</xref>). Examination of the visual fit reveals that Model D has a more accurate description of the channel inactivation, while Model E (<xref ref-type="fig" rid="pcbi-0030169-g006">Figure 6</xref>) is slightly better in depicting the channel activation.</p><table-wrap content-type="1col" id="pcbi-0030169-t002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030169.t002</object-id><label>Table 2</label><caption><p>Models Tested in the Fit of the Na<sup>+</sup> Currents Displayed in <xref ref-type="fig" rid="pcbi-0030169-g006">Figure 6</xref></p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030169.t002" xlink:type="simple"/><!-- <table frame="hsides" rules="none"><colgroup><col id="tb2col1" align="left" charoff="0" char=""/><col id="tb2col2" align="left" charoff="0" char=""/><col id="tb2col3" align="left" charoff="0" char=""/></colgroup><thead><tr><td align="left"><hr/>Model</td><td><hr/>Number of free Parameters</td><td><hr/>LER</td></tr></thead><tbody><tr><td>Model C</td><td>16</td><td>1.01</td></tr><tr><td>Model D</td><td>20</td><td>0</td></tr><tr><td>Model E</td><td>16</td><td>0.08</td></tr><tr><td>Model F</td><td>15</td><td>0.37</td></tr></tbody></table> --><!-- <table-wrap-foot><fn id="nt201"><p>The LER was calculated relative to the best fit obtained and the models are described in Methods.</p></fn></table-wrap-foot> --></table-wrap></sec><sec id="s4"><title>Discussion</title><p>Our study describes a method for analyzing voltage-dependent ionic currents. We tested and affirmed the ability of the GA presented here to fit current traces using the full-trace analysis method. The GA was then used to test the fit of various previously published and new voltage-dependent ion channel models (<xref ref-type="fig" rid="pcbi-0030169-g003">Figures 3</xref>,<xref ref-type="fig" rid="pcbi-0030169-g004">4</xref>,<xref ref-type="fig" rid="pcbi-0030169-g007">7</xref>–<xref ref-type="fig" rid="pcbi-0030169-g009">9</xref>). The models were further used to produce currents equivalent to the potassium (<xref ref-type="fig" rid="pcbi-0030169-g010">Figure 10</xref>) and sodium currents (<xref ref-type="fig" rid="pcbi-0030169-g006">Figure 6</xref>) measured in patch-clamp experiments. We conclude that it is possible to verify the viability of voltage-dependent ion channel models using a genetic optimization algorithm concurrently with a full-trace fit of experimental data to the model.</p><p>The advantage of our scheme over the more commonly used gradient descent algorithms is that GAs do not require an initial guess of the parameters [<xref ref-type="bibr" rid="pcbi-0030169-b012">12</xref>,<xref ref-type="bibr" rid="pcbi-0030169-b034">34</xref>,<xref ref-type="bibr" rid="pcbi-0030169-b035">35</xref>]. With a large enough dataset, it is possible to arrive at the global minimum even from a random starting point. This is very important since, given wrong starting parameters, gradient descent algorithms may arrive at a local minimum. However, although this study obtained good results in almost all cases, this does not constitute a proof that this method will work each time, since there may be a random combination of parameters that defy the GA. Still, our results show that a useable and functionally significant ion channel model describing whole-cell currents may be produced using a GA with a dataset containing a “complete” whole-cell activation of the channel as its input.</p><p>In contrast to the <italic>disjoint</italic> conventional method, the approach to data analysis and model fitting used here has been designated global curve fitting or the <italic>full-trace</italic> method [<xref ref-type="bibr" rid="pcbi-0030169-b012">12</xref>,<xref ref-type="bibr" rid="pcbi-0030169-b034">34</xref>]. However, the analysis presented here shows several important differences from previously suggested full-trace analyses. The most obvious difference is the use of multiple stimulation protocols; previous full-trace analyses used only activation and deactivation protocols for their data and fit [<xref ref-type="bibr" rid="pcbi-0030169-b012">12</xref>,<xref ref-type="bibr" rid="pcbi-0030169-b034">34</xref>,<xref ref-type="bibr" rid="pcbi-0030169-b035">35</xref>]. Furthermore, while using the full current trace, previous analyses still made the same basic assumptions as their predecessors using the disjoint method, namely the number of gates in a model, the values of m<sub>0</sub> and h<sub>∞</sub> in relation to time constants and peak conductance (when dealing with Hodgkin-Huxley–like channel models). Additionally, either due to experimental constraints or ease of use, the same description for rate functions employed by the disjoint method has been used in previous full-trace analysis experiments. Also, independent time constants were used for each potential step in full-trace fits, much as they are commonly used by the disjoint method.</p><p>The analysis presented here made no assumptions similar to those used by the disjoint method, thus negating any possible predispositions toward certain time constant–voltage dependencies, stimulation protocols, or other rate-function–limiting conditions. In addition, it is not necessary to consider each voltage step on its own when calculating the time constant dependence on voltage. As all the voltage steps are simulated and fit at once, the resulting time constants should and do fit the target data at all voltage steps. Also, not only does the full-trace analysis presented here take advantage of the full range of stimulation protocols used for voltage-dependent ion channels (<xref ref-type="fig" rid="pcbi-0030169-g005">Figure 5</xref>), but diverse methods of stimulation can also be considered (<xref ref-type="fig" rid="pcbi-0030169-g009">Figure 9</xref>).</p><p>The more complex the channel model (i.e., the more parameters it contained), the longer it took and the more difficult it was for the GA to fit the data to the model within a similar time frame. Markov models took longer for the algorithm to locate and converge on the global minimum area in the parameter space. It is also worth noticing that though our experiments show decent fits within reasonable time frames for models with up to 21 parameters, it would probably be prudent not to use such methods for models consisting of more than fifteen parameters when limited by time and computational overhead (especially considering that neither the maximal conductances nor the reversal potential are voltage-dependent and that the search for their global minimum in the parameter space was much quicker than for the corresponding area of the voltage-dependent parameters). Moreover, it is probably best not to try and fit Markov models with many sequential closed states. The kinetic time constants of closed states that do not contribute to the actual whole-cell current will probably be hard to estimate. To investigate such complex models, it is clear that single-channel analysis is more suitable than the approach we have used [<xref ref-type="bibr" rid="pcbi-0030169-b013">13</xref>].</p><p>Even though we present here a relatively good fit of several models, these models are phenomenological and may not fully describe the gating of the channels. A much more detailed investigation is required to produce a more accurate model of any channel. Such investigation will most probably entail both whole-cell and single-channel recording and analysis. Moreover, sequencing of the channel cDNA and introducing deletions or mutations to the sequence may be required in order to fully determine the structure–function relationship. However, our approach may be used for rapid evaluation of models, which may speed the production of physiologically relevant models.</p><p>One forte of the presented approach is most visible when comparing the fit of two models to the same dataset (<xref ref-type="fig" rid="pcbi-0030169-g006">Figure 6</xref>). Both Model D and Model E fit the activation of the channels reasonably well. However, Model D also fits the steady-state inactivation and pulse-inactivation data, whereas Model E fails to fit this portion of the data. Had we used only a dataset containing the activation in the fit, these differences between the two models would not have been exposed. This emphasizes that no fitting routine can replace a rigorous investigation of channel kinetics. Such investigation is crucially required to determine the extent of the dataset required to faithfully represent all the kinetic behavior of the channel. For example, using only activation and deactivation protocols would do injustice to complex processes such as C-type inactivation of voltage-gated K<sup>+</sup> channels [<xref ref-type="bibr" rid="pcbi-0030169-b036">36</xref>,<xref ref-type="bibr" rid="pcbi-0030169-b037">37</xref>], the slow inactivation of T-type Ca<sup>2+</sup> channels [<xref ref-type="bibr" rid="pcbi-0030169-b038">38</xref>], the dependence of channel gating on the concentration of ions in the solution [<xref ref-type="bibr" rid="pcbi-0030169-b039">39</xref>,<xref ref-type="bibr" rid="pcbi-0030169-b040">40</xref>], and many other unique kinetic properties.</p><p>Our approach also allows the use of nonstandard voltage-clamp protocols. As recently noted [<xref ref-type="bibr" rid="pcbi-0030169-b015">15</xref>], some parameters that may appear in models of voltage-gated channels may be better constrained when the fit is carried out on currents recorded using action-potential trains as a voltage-clamp command instead of the standard voltage-clamp protocol. Admittedly, the standard voltage-clamp protocols facilitate intuitive analysis of the data. Thus, a combination of standard voltage-clamp protocols, used for initial identification of the investigated conductance, with less-standard protocols, used for constraining a model for that conductance, may prove a beneficial approach for future investigations of voltage-gated conductances.</p><p>Finally, our analysis technique is automatic. Thus, while the GA searches parameter space for the best combination, the investigator is free to perform more experiments or to design additional models. This is an improvement over the previous disjoint method where every trace had to be manually analyzed, which is inefficient and needlessly time-consuming.</p></sec><sec id="s5"><title>Supporting Information</title><supplementary-material id="pcbi-0030169-sd001" mimetype="application/zip" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030169.sd001" xlink:type="simple"><label>Text S1</label><caption><title>Demonstration Code</title><p>A functional NEURON code of the GA described in the manuscript.</p><p>(569 KB ZIP)</p></caption></supplementary-material><supplementary-material id="pcbi-0030169-sv001" mimetype="application/x-msvideo" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030169.sv001" xlink:type="simple"><label>Video S1</label><caption><title>Genetic Algorithm Animation</title><p>Animation of the convergence of the GA to a model of a voltage-gated ion channel.</p><p>(1.0 MB AVI)</p></caption></supplementary-material></sec></body><back><glossary><title>Abbreviations</title><def-list><def-item><term>GA</term><def><p>genetic algorithm: LER, Log Error Ratio</p></def></def-item><def-item><term>PrAxis</term><def><p>Principle Axis algorithm</p></def></def-item><def-item><term>SA</term><def><p>simulated annealing</p></def></def-item></def-list></glossary><ref-list><title>References</title><ref id="pcbi-0030169-b001"><label>1</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Bean</surname><given-names>BP</given-names></name></person-group>
					<year>2007</year>
					<article-title>The action potential in mammalian central neurons.</article-title>
					<source>Nat Rev Neurosci</source>
					<volume>8</volume>
					<fpage>451</fpage>
					<lpage>465</lpage>
				</element-citation></ref><ref id="pcbi-0030169-b002"><label>2</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Llinás</surname><given-names>RR</given-names></name></person-group>
					<year>1988</year>
					<article-title>The intrinsic electrophysiological properties of mammalian neurons: Insights into central nervous system function.</article-title>
					<source>Science</source>
					<volume>242</volume>
					<fpage>1654</fpage>
					<lpage>1664</lpage>
				</element-citation></ref><ref id="pcbi-0030169-b003"><label>3</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Hodgkin</surname><given-names>AL</given-names></name><name name-style="western"><surname>Huxley</surname><given-names>AF</given-names></name></person-group>
					<year>1952</year>
					<article-title>A quantitative description of membrane current and its application to conduction and excitation in nerve.</article-title>
					<source>J Physiol</source>
					<volume>117</volume>
					<fpage>500</fpage>
					<lpage>544</lpage>
				</element-citation></ref><ref id="pcbi-0030169-b004"><label>4</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Hodgkin</surname><given-names>AL</given-names></name><name name-style="western"><surname>Huxley</surname><given-names>AF</given-names></name></person-group>
					<year>1952</year>
					<article-title>The dual effect of membrane potential on sodium conductance in the giant axon of Loligo.</article-title>
					<source>J Physiol</source>
					<volume>116</volume>
					<fpage>497</fpage>
					<lpage>506</lpage>
				</element-citation></ref><ref id="pcbi-0030169-b005"><label>5</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Hodgkin</surname><given-names>AL</given-names></name><name name-style="western"><surname>Huxley</surname><given-names>AF</given-names></name></person-group>
					<year>1952</year>
					<article-title>The components of membrane conductance in the giant axon of Loligo.</article-title>
					<source>J Physiol</source>
					<volume>116</volume>
					<fpage>473</fpage>
					<lpage>496</lpage>
				</element-citation></ref><ref id="pcbi-0030169-b006"><label>6</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Hodgkin</surname><given-names>AL</given-names></name><name name-style="western"><surname>Huxley</surname><given-names>AF</given-names></name></person-group>
					<year>1952</year>
					<article-title>Currents carried by sodium and potassium ions through the membrane of the giant axon of Loligo.</article-title>
					<source>J Physiol</source>
					<volume>116</volume>
					<fpage>449</fpage>
					<lpage>472</lpage>
				</element-citation></ref><ref id="pcbi-0030169-b007"><label>7</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Hodgkin</surname><given-names>AL</given-names></name><name name-style="western"><surname>Huxley</surname><given-names>AF</given-names></name></person-group>
					<year>1952</year>
					<article-title>Movement of sodium and potassium ions during nervous activity.</article-title>
					<source>Cold Spring Harb Symp Quant Biol</source>
					<volume>17</volume>
					<fpage>43</fpage>
					<lpage>52</lpage>
				</element-citation></ref><ref id="pcbi-0030169-b008"><label>8</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Hodgkin</surname><given-names>AL</given-names></name><name name-style="western"><surname>Huxley</surname><given-names>AF</given-names></name><name name-style="western"><surname>Katz</surname><given-names>B</given-names></name></person-group>
					<year>1952</year>
					<article-title>Measurement of current-voltage relations in the membrane of the giant axon of Loligo.</article-title>
					<source>J Physiol</source>
					<volume>116</volume>
					<fpage>424</fpage>
					<lpage>448</lpage>
				</element-citation></ref><ref id="pcbi-0030169-b009"><label>9</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Goldman</surname><given-names>L</given-names></name><name name-style="western"><surname>Schauf</surname><given-names>CL</given-names></name></person-group>
					<year>1972</year>
					<article-title>Inactivation of the sodium current in Myxicola giant axons. Evidence for coupling to the activation process.</article-title>
					<source>J Gen Physiol</source>
					<volume>59</volume>
					<fpage>659</fpage>
					<lpage>675</lpage>
				</element-citation></ref><ref id="pcbi-0030169-b010"><label>10</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Armstrong</surname><given-names>CM</given-names></name><name name-style="western"><surname>Bezanilla</surname><given-names>F</given-names></name></person-group>
					<year>1977</year>
					<article-title>Inactivation of the sodium channel. II. Gating current experiments.</article-title>
					<source>J Gen Physiol</source>
					<volume>70</volume>
					<fpage>567</fpage>
					<lpage>590</lpage>
				</element-citation></ref><ref id="pcbi-0030169-b011"><label>11</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Bezanilla</surname><given-names>F</given-names></name><name name-style="western"><surname>Armstrong</surname><given-names>CM</given-names></name></person-group>
					<year>1977</year>
					<article-title>Inactivation of the sodium channel. I. Sodium current experiments.</article-title>
					<source>J Gen Physiol</source>
					<volume>70</volume>
					<fpage>549</fpage>
					<lpage>566</lpage>
				</element-citation></ref><ref id="pcbi-0030169-b012"><label>12</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Willms</surname><given-names>AR</given-names></name><name name-style="western"><surname>Baro</surname><given-names>DJ</given-names></name><name name-style="western"><surname>Harris-Warrick</surname><given-names>RM</given-names></name><name name-style="western"><surname>Guckenheimer</surname><given-names>J</given-names></name></person-group>
					<year>1999</year>
					<article-title>An improved parameter estimation method for Hodgkin-Huxley models.</article-title>
					<source>J Comput Neurosci</source>
					<volume>6</volume>
					<fpage>145</fpage>
					<lpage>168</lpage>
				</element-citation></ref><ref id="pcbi-0030169-b013"><label>13</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Sakmann</surname><given-names>B</given-names></name><name name-style="western"><surname>Neher</surname><given-names>E</given-names></name></person-group>
					<year>1995</year>
					<source>Single-channel recording</source>
					<publisher-loc>New York</publisher-loc>
					<publisher-name>Plenum</publisher-name>
				</element-citation></ref><ref id="pcbi-0030169-b014"><label>14</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Gurkiewicz</surname><given-names>M</given-names></name><name name-style="western"><surname>Korngreen</surname><given-names>A</given-names></name></person-group>
					<year>2006</year>
					<article-title>Recording, analysis, and function of dendritic voltage-gated channels.</article-title>
					<source>Pflugers Arch</source>
					<volume>453</volume>
					<fpage>283</fpage>
					<lpage>292</lpage>
				</element-citation></ref><ref id="pcbi-0030169-b015"><label>15</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Cannon</surname><given-names>RC</given-names></name><name name-style="western"><surname>D'Alessandro</surname><given-names>G</given-names></name></person-group>
					<year>2006</year>
					<article-title>The ion channel inverse problem: Neuroinformatics meets biophysics.</article-title>
					<source>PLoS Comput Biol</source>
					<volume>2</volume>
					<fpage>391</fpage>
					<comment>doi:<ext-link ext-link-type="doi" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.0020091" xlink:type="simple">10.1371/journal.pcbi.0020091</ext-link>.</comment>
				</element-citation></ref><ref id="pcbi-0030169-b016"><label>16</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Patlak</surname><given-names>J</given-names></name></person-group>
					<year>1991</year>
					<article-title>Molecular kinetics of voltage-dependent Na<sup>+</sup> channels.</article-title>
					<source>Physiol Rev</source>
					<volume>71</volume>
					<fpage>1047</fpage>
					<lpage>1080</lpage>
				</element-citation></ref><ref id="pcbi-0030169-b017"><label>17</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Magleby</surname><given-names>KL</given-names></name></person-group>
					<year>1992</year>
					<article-title>Ion channels. Preventing artifacts and reducing errors in single-channel analysis.</article-title>
					<source>Methods Enzymol</source>
					<volume>207</volume>
					<fpage>763</fpage>
					<lpage>791</lpage>
				</element-citation></ref><ref id="pcbi-0030169-b018"><label>18</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Sigworth</surname><given-names>FJ</given-names></name><name name-style="western"><surname>Zhou</surname><given-names>J</given-names></name></person-group>
					<year>1992</year>
					<article-title>Ion channels. Analysis of nonstationary single-channel currents.</article-title>
					<source>Methods Enzymol</source>
					<volume>207</volume>
					<fpage>746</fpage>
					<lpage>762</lpage>
				</element-citation></ref><ref id="pcbi-0030169-b019"><label>19</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Hines</surname><given-names>ML</given-names></name><name name-style="western"><surname>Carnevale</surname><given-names>NT</given-names></name></person-group>
					<year>1997</year>
					<article-title>The NEURON simulation environment.</article-title>
					<source>Neural Computation</source>
					<volume>9</volume>
					<fpage>1179</fpage>
					<lpage>1209</lpage>
				</element-citation></ref><ref id="pcbi-0030169-b020"><label>20</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Hines</surname><given-names>ML</given-names></name><name name-style="western"><surname>Carnevale</surname><given-names>NT</given-names></name></person-group>
					<year>2000</year>
					<article-title>Expanding NEURON's repertoire of mechanisms with NMODL.</article-title>
					<source>Neural Computation</source>
					<volume>12</volume>
					<fpage>995</fpage>
					<lpage>1007</lpage>
				</element-citation></ref><ref id="pcbi-0030169-b021"><label>21</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Mitchell</surname><given-names>M</given-names></name></person-group>
					<year>1996</year>
					<source>An introduction to genetic algorithms</source>
					<publisher-loc>Cambridge (Massachussetts)</publisher-loc>
					<publisher-name>MIT Press</publisher-name>
				</element-citation></ref><ref id="pcbi-0030169-b022"><label>22</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Horn</surname><given-names>R</given-names></name></person-group>
					<year>1987</year>
					<article-title>Statistical methods for model discrimination. Applications to gating kinetics and permeation of the acetylcholine receptor channel.</article-title>
					<source>Biophys J</source>
					<volume>51</volume>
					<fpage>255</fpage>
					<lpage>263</lpage>
				</element-citation></ref><ref id="pcbi-0030169-b023"><label>23</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Akaike</surname><given-names>H</given-names></name></person-group>
					<year>1974</year>
					<article-title>A new look at the statistical model identification.</article-title>
					<source>IEEE Trans Autom Contr AC-19</source>
					<fpage>716</fpage>
					<lpage>723</lpage>
				</element-citation></ref><ref id="pcbi-0030169-b024"><label>24</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Benison</surname><given-names>G</given-names></name><name name-style="western"><surname>Keizer</surname><given-names>J</given-names></name><name name-style="western"><surname>Chalupa</surname><given-names>LM</given-names></name><name name-style="western"><surname>Robinson</surname><given-names>DW</given-names></name></person-group>
					<year>2001</year>
					<article-title>Modeling temporal behavior of postnatal cat retinal ganglion cells.</article-title>
					<source>J Theor Biol</source>
					<volume>210</volume>
					<fpage>187</fpage>
					<lpage>199</lpage>
				</element-citation></ref><ref id="pcbi-0030169-b025"><label>25</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Baranauskas</surname><given-names>G</given-names></name><name name-style="western"><surname>Martina</surname><given-names>M</given-names></name></person-group>
					<year>2006</year>
					<article-title>Sodium currents activate without a Hodgkin-and-Huxley–type delay in central mammalian neurons.</article-title>
					<source>J Neurosci</source>
					<volume>26</volume>
					<fpage>671</fpage>
					<lpage>684</lpage>
				</element-citation></ref><ref id="pcbi-0030169-b026"><label>26</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Korngreen</surname><given-names>A</given-names></name><name name-style="western"><surname>Kaiser</surname><given-names>KM</given-names></name><name name-style="western"><surname>Zilberter</surname><given-names>Y</given-names></name></person-group>
					<year>2005</year>
					<article-title>Subthreshold inactivation of voltage-gated K<sup>+</sup> channels modulates action potentials in neocortical bitufted interneurones from rats.</article-title>
					<source>J Physiol</source>
					<volume>562</volume>
					<fpage>421</fpage>
					<lpage>437</lpage>
				</element-citation></ref><ref id="pcbi-0030169-b027"><label>27</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Stuart</surname><given-names>GJ</given-names></name><name name-style="western"><surname>Dodt</surname><given-names>HU</given-names></name><name name-style="western"><surname>Sakmann</surname><given-names>B</given-names></name></person-group>
					<year>1993</year>
					<article-title>Patch-clamp recordings from the soma and dendrites of neurons in brain slices using infrared video microscopy.</article-title>
					<source>Pflugers Archiv Eur J Physiol</source>
					<volume>423</volume>
					<fpage>511</fpage>
					<lpage>518</lpage>
				</element-citation></ref><ref id="pcbi-0030169-b028"><label>28</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Korngreen</surname><given-names>A</given-names></name><name name-style="western"><surname>Sakmann</surname><given-names>B</given-names></name></person-group>
					<year>2000</year>
					<article-title>Voltage-gated K<sup>+</sup> channels in layer 5 neocortical pyramidal neurones from young rats: Subtypes and gradients.</article-title>
					<source>J Physiol</source>
					<volume>523</volume>
					<fpage>621</fpage>
					<lpage>639</lpage>
				</element-citation></ref><ref id="pcbi-0030169-b029"><label>29</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Sather</surname><given-names>W</given-names></name><name name-style="western"><surname>Dieudonne</surname><given-names>S</given-names></name><name name-style="western"><surname>MacDonald</surname><given-names>JF</given-names></name><name name-style="western"><surname>Ascher</surname><given-names>P</given-names></name></person-group>
					<year>1992</year>
					<article-title>Activation and desensitization of N-methyl-D-aspartate receptors in nucleated outside-out patches from mouse neurones.</article-title>
					<source>J Physiol</source>
					<volume>450</volume>
					<fpage>643</fpage>
					<lpage>672</lpage>
				</element-citation></ref><ref id="pcbi-0030169-b030"><label>30</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Neher</surname><given-names>E</given-names></name></person-group>
					<year>1992</year>
					<article-title>Correction for liquid junction potentials in patch clamp experiments.</article-title>
					<source>Methods Enzymol</source>
					<volume>207</volume>
					<fpage>123</fpage>
					<lpage>131</lpage>
				</element-citation></ref><ref id="pcbi-0030169-b031"><label>31</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Oyama</surname><given-names>A</given-names></name><name name-style="western"><surname>Obayashi</surname><given-names>S</given-names></name><name name-style="western"><surname>Nakamura</surname><given-names>T</given-names></name></person-group>
					<year>2001</year>
					<article-title>Real-coded adaptive range genetic algorithm applied to transonic wing optimization.</article-title>
					<source>Appl Soft Comp J</source>
					<volume>1</volume>
					<fpage>179</fpage>
					<lpage>187</lpage>
				</element-citation></ref><ref id="pcbi-0030169-b032"><label>32</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Press</surname><given-names>WH</given-names></name><name name-style="western"><surname>Teukolsky</surname><given-names>SA</given-names></name><name name-style="western"><surname>Vetterling</surname><given-names>WT</given-names></name><name name-style="western"><surname>Flannery</surname><given-names>BP</given-names></name></person-group>
					<year>1992</year>
					<source>Numerical recipes in C, the art of scientific computing. 2nd edition</source>
					<publisher-loc>Cambridge (United Kingdom)</publisher-loc>
					<publisher-name>Cambridge University Press</publisher-name>
				</element-citation></ref><ref id="pcbi-0030169-b033"><label>33</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Bekkers</surname><given-names>JM</given-names></name></person-group>
					<year>2000</year>
					<article-title>Properties of voltage-gated potassium currents in nucleated patches from large layer 5 cortical pyramidal neurons of the rat.</article-title>
					<source>J Physiol</source>
					<volume>525</volume>
					<issue>Part 3</issue>
					<fpage>593</fpage>
					<lpage>609</lpage>
				</element-citation></ref><ref id="pcbi-0030169-b034"><label>34</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Willms</surname><given-names>AR</given-names></name></person-group>
					<year>2002</year>
					<article-title>NEUROFIT: Software for fitting Hodgkin-Huxley models to voltage-clamp data.</article-title>
					<source>J Neurosci Methods</source>
					<volume>121</volume>
					<fpage>139</fpage>
					<lpage>150</lpage>
				</element-citation></ref><ref id="pcbi-0030169-b035"><label>35</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Milescu</surname><given-names>LS</given-names></name><name name-style="western"><surname>Akk</surname><given-names>G</given-names></name><name name-style="western"><surname>Sachs</surname><given-names>F</given-names></name></person-group>
					<year>2005</year>
					<article-title>Maximum likelihood estimation of ion channel kinetics from macroscopic currents.</article-title>
					<source>Biophys J</source>
					<volume>88</volume>
					<fpage>2494</fpage>
					<lpage>2515</lpage>
				</element-citation></ref><ref id="pcbi-0030169-b036"><label>36</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Aldrich</surname><given-names>RW</given-names><suffix>Jr</suffix></name><name name-style="western"><surname>Getting</surname><given-names>PA</given-names></name><name name-style="western"><surname>Thompson</surname><given-names>SH</given-names></name></person-group>
					<year>1979</year>
					<article-title>Inactivation of delayed outward current in molluscan neurone somata.</article-title>
					<source>J Physiol</source>
					<volume>291</volume>
					<fpage>507</fpage>
					<lpage>530</lpage>
				</element-citation></ref><ref id="pcbi-0030169-b037"><label>37</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Marom</surname><given-names>S</given-names></name><name name-style="western"><surname>Levitan</surname><given-names>IB</given-names></name></person-group>
					<year>1994</year>
					<article-title>State-dependent inactivation of the Kv3 potassium channel.</article-title>
					<source>Biophys J</source>
					<volume>67</volume>
					<fpage>579</fpage>
					<lpage>589</lpage>
				</element-citation></ref><ref id="pcbi-0030169-b038"><label>38</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Hering</surname><given-names>J</given-names></name><name name-style="western"><surname>Feltz</surname><given-names>A</given-names></name><name name-style="western"><surname>Lambert</surname><given-names>RC</given-names></name></person-group>
					<year>2004</year>
					<article-title>Slow inactivation of the Ca<sub>V</sub>3.1 isotype of T-type calcium channels.</article-title>
					<source>J Physiol</source>
					<volume>555</volume>
					<fpage>331</fpage>
					<lpage>344</lpage>
				</element-citation></ref><ref id="pcbi-0030169-b039"><label>39</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Levy</surname><given-names>DI</given-names></name><name name-style="western"><surname>Deutsch</surname><given-names>C</given-names></name></person-group>
					<year>1996</year>
					<article-title>Recovery from C-type inactivation is modulated by extracellular potassium.</article-title>
					<source>Biophys J</source>
					<volume>70</volume>
					<fpage>798</fpage>
					<lpage>805</lpage>
				</element-citation></ref><ref id="pcbi-0030169-b040"><label>40</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Starkus</surname><given-names>JG</given-names></name><name name-style="western"><surname>Kuschel</surname><given-names>L</given-names></name><name name-style="western"><surname>Rayner</surname><given-names>MD</given-names></name><name name-style="western"><surname>Heinemann</surname><given-names>SH</given-names></name></person-group>
					<year>1997</year>
					<article-title>Ion conduction through C-type inactivated Shaker channels.</article-title>
					<source>J Gen Physiol</source>
					<volume>110</volume>
					<fpage>539</fpage>
					<lpage>550</lpage>
				</element-citation></ref></ref-list></back></article>