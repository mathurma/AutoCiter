<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN">
  <front>
    <journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher>
        <publisher-name>Public Library of Science</publisher-name>
        <publisher-loc>San Francisco, USA</publisher-loc>
      </publisher></journal-meta>
    <article-meta><article-id pub-id-type="publisher-id">PCOMPBIOL-D-11-00723</article-id><article-id pub-id-type="doi">10.1371/journal.pcbi.1002262</article-id><article-categories>
        <subj-group subj-group-type="heading">
          <subject>Research Article</subject>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Biology</subject>
          <subj-group>
            <subject>Computational biology</subject>
            <subj-group>
              <subject>Metabolic networks</subject>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline">
          <subject>Computational Biology</subject>
        </subj-group>
      </article-categories><title-group><article-title>Identification of Biochemical Network Modules Based on Shortest Retroactive Distances</article-title><alt-title alt-title-type="running-head">Biochemical Network Modules</alt-title></title-group><contrib-group>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Sridharan</surname>
            <given-names>Gautham Vivek</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Hassoun</surname>
            <given-names>Soha</given-names>
          </name>
          <xref ref-type="aff" rid="aff2">
            <sup>2</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Lee</surname>
            <given-names>Kyongbum</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
          <xref ref-type="corresp" rid="cor1">
            <sup>*</sup>
          </xref>
        </contrib>
      </contrib-group><aff id="aff1"><label>1</label><addr-line>Department of Chemical and Biological Engineering, Tufts University, Medford, Massachusetts, United States of America</addr-line>       </aff><aff id="aff2"><label>2</label><addr-line>Department of Computer Science, Tufts University, Medford, Massachusetts, United States of America</addr-line>       </aff><contrib-group>
        <contrib contrib-type="editor" xlink:type="simple">
          <name name-style="western">
            <surname>Papin</surname>
            <given-names>Jason A.</given-names>
          </name>
          <role>Editor</role>
          <xref ref-type="aff" rid="edit1"/>
        </contrib>
      </contrib-group><aff id="edit1">University of Virginia, United States of America</aff><author-notes>
        <corresp id="cor1">* E-mail: <email xlink:type="simple">kyongbum.lee@tufts.edu</email></corresp>
        <fn fn-type="con">
          <p>Conceived and designed the experiments: GVS SH KL. Performed the experiments: GVS SH. Analyzed the data: GVS SH KL. Contributed reagents/materials/analysis tools: GVS SH KL. Wrote the paper: GVS SH KL. Wrote the program code used in the analysis: GVS SH.</p>
        </fn>
      <fn fn-type="conflict">
        <p>The authors have declared that no competing interests exist.</p>
      </fn></author-notes><pub-date pub-type="collection">
        <month>11</month>
        <year>2011</year>
      </pub-date><pub-date pub-type="epub">
        <day>10</day>
        <month>11</month>
        <year>2011</year>
      </pub-date><volume>7</volume><issue>11</issue><elocation-id>e1002262</elocation-id><history>
        <date date-type="received">
          <day>23</day>
          <month>5</month>
          <year>2011</year>
        </date>
        <date date-type="accepted">
          <day>21</day>
          <month>9</month>
          <year>2011</year>
        </date>
      </history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2011</copyright-year><copyright-holder>Sridharan et al</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract>
        <p>Modularity analysis offers a route to better understand the organization of cellular biochemical networks as well as to derive practically useful, simplified models of these complex systems. While there is general agreement regarding the qualitative properties of a biochemical module, there is no clear consensus on the quantitative criteria that may be used to systematically derive these modules. In this work, we investigate cyclical interactions as the defining characteristic of a biochemical module. We utilize a round trip distance metric, termed Shortest Retroactive Distance (ShReD), to characterize the retroactive connectivity between any two reactions in a biochemical network and to group together network components that mutually influence each other. We evaluate the metric on two types of networks that feature feedback interactions: (i) epidermal growth factor receptor (EGFR) signaling and (ii) liver metabolism supporting drug transformation. For both networks, the ShReD partitions found hierarchically arranged modules that confirm biological intuition. In addition, the partitions also revealed modules that are less intuitive. In particular, ShReD-based partition of the metabolic network identified a ‘redox’ module that couples reactions of glucose, pyruvate, lipid and drug metabolism through shared production and consumption of NADPH. Our results suggest that retroactive interactions arising from feedback loops and metabolic cycles significantly contribute to the modularity of biochemical networks. For metabolic networks, cofactors play an important role as allosteric effectors that mediate the retroactive interactions.</p>
      </abstract><abstract abstract-type="summary">
        <title>Author Summary</title>
        <p>Mathematical models are powerful tools to understand and predict the behavior of complex systems. However, the complexity presents many challenges in developing such models. In the case of a biological cell, a fully detailed and comprehensive model of a major function such as signaling and metabolism remains out of reach, due to the very large number of interdependent biochemical reactions that are required to carry out the function. In this regard, one practical approach is to develop simplified models that nevertheless preserve the essential features of the cell as a complex system by better understanding the chemical organization of the cell, or the layout of the biochemical network. In this work, we describe a computational method to systematically identify closely interacting groups of biochemical reactions by recognizing the modular hierarchy inherent in biochemical networks. We focus on cyclical interactions based on the rationale that reactions that mutually influence each other belong in the same group. We demonstrate our method on a signaling and metabolic network and show that the results confirm biological intuition as well as provide new insights into the coordination of biochemical pathways. Prospectively, our modularization method could be used to systematically derive simplified and practically useful models of complex biological networks.</p>
      </abstract><funding-group><funding-statement>The authors gratefully acknowledge support by the National Science Foundation award number 0829899. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts>
        <page-count count="14"/>
      </counts></article-meta>
  </front>
  <body>
    <sec id="s1">
      <title>Introduction</title>
      <p>Hierarchical modularity has emerged as an organizational principle of biochemical networks, where larger less cohesive clusters of network components (e.g. metabolic enzymes or signaling molecules) comprise functionally distinct sub-clusters <xref ref-type="bibr" rid="pcbi.1002262-Papin1">[1]</xref>, <xref ref-type="bibr" rid="pcbi.1002262-Ravasz1">[2]</xref>. For example, Ihmels and coworkers analyzed the co-expression patterns of metabolic genes in <italic>Saccharomyces cerevisiae</italic> to find coordinated regulation of individual pathways as well as higher-order functions such as biosynthesis and stress response that require multiple feeder pathways <xref ref-type="bibr" rid="pcbi.1002262-Ihmels1">[3]</xref>. Hierarchical organization was also observed by Gutteridge and coworkers for metabolic regulatory networks, where hub metabolites regulating many enzymes connect to modules of spoke metabolites that are chemically similar and/or regulate functionally related enzymes <xref ref-type="bibr" rid="pcbi.1002262-Gutteridge1">[4]</xref>.</p>
      <p>In recent years, observations on modularity have prompted metabolic engineers and synthetic biologists to consider whole pathways, rather than individual genes, as modular building units for cellular design <xref ref-type="bibr" rid="pcbi.1002262-Panke1">[5]</xref>. An emerging design rule is to assemble and express a coherent set of genes that encode the desired biochemical pathway along with regulatory mechanisms that modulate the activity of the pathway <xref ref-type="bibr" rid="pcbi.1002262-Andrianantoandro1">[6]</xref>. Modularity analysis also offers a route to build practically useful, simplified models of complex biological systems. The size and complexity of biochemical networks reconstructed from genome databases has greatly increased over the years <xref ref-type="bibr" rid="pcbi.1002262-Kanehisa1">[7]</xref>, <xref ref-type="bibr" rid="pcbi.1002262-Kanehisa2">[8]</xref>, <xref ref-type="bibr" rid="pcbi.1002262-Kanehisa3">[9]</xref>, rendering the estimation of kinetic or regulatory parameters either impractical or outright infeasible. In this regard, the modularity of a biochemical network should allow the system to be partitioned into minimally interdependent parts, enabling systematic derivation of coarse-grained, yet comprehensive models. Such coarse-grained models could greatly simplify the parameter estimation problem by substituting detailed reaction kinetics with less detailed module kinetics <xref ref-type="bibr" rid="pcbi.1002262-vanRiel1">[10]</xref>.</p>
      <p>While there is general agreement that a biochemical module should represent a group of connected network components, and that the arrangement of modules in the network is hierarchical, there is less consensus on the criteria that should be used to systematically extract biologically meaningful modules <xref ref-type="bibr" rid="pcbi.1002262-Barrett1">[11]</xref>, . One recent argument was to focus on cyclical, or ‘retroactive,’ interactions between network components, as opposed to simple connectivity <xref ref-type="bibr" rid="pcbi.1002262-SaezRodriguez1">[15]</xref>. Biochemical pathways operate with direction, where upstream components (e.g. concentration of reactants) influence downstream components (e.g. concentration of products). In the case where a downstream component also influences an upstream component (e.g. via a feedback regulatory mechanism), the two components participate in a cycle and thus interact retroactively. Placing such components into the same module reduces the interdependence between different modules, consistent with the intuitive definition of a biological module. Indeed, metabolic cycles and feedback loops have been shown to confer robustness <xref ref-type="bibr" rid="pcbi.1002262-Kitano1">[16]</xref> by isolating external perturbations and attenuating their propagation through the entire network <xref ref-type="bibr" rid="pcbi.1002262-Stelling1">[17]</xref>.</p>
      <p>In this paper, we extend the concept of retroactivity to account for cyclical interactions spanning distant parts of a biochemical network as exemplified by feedback loops of signaling and metabolic pathways. In earlier work <xref ref-type="bibr" rid="pcbi.1002262-Andrianantoandro1">[6]</xref>, retroactivity was only considered for interactions between nearest neighbors in a network. To investigate hierarchy, we adopted Newman's algorithm for community detection <xref ref-type="bibr" rid="pcbi.1002262-Newman1">[18]</xref> to successively partition a network into modules containing cyclical interactions based on a round trip distance metric, which we call Shortest Retroactive Distance (ShReD). Applied to test models of a signaling network <xref ref-type="bibr" rid="pcbi.1002262-Oda1">[19]</xref> (<xref ref-type="fig" rid="pcbi-1002262-g001">Figure 1</xref>) and a metabolic network (<xref ref-type="fig" rid="pcbi-1002262-g002">Figure 2</xref>), the ShReD-based partitions produced hierarchically arranged modules that confirm biological knowledge. In addition, the partitions also revealed modules that are less intuitive. For the metabolic network, we also examined the role of allosteric regulators and cofactors as network elements that determine the number of cyclical interactions and the hierarchical depth of modules.</p>
      <fig id="pcbi-1002262-g001" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1002262.g001</object-id>
        <label>Figure 1</label>
        <caption>
          <title>Graph image of the signaling network.</title>
          <p>Each reaction in the network was <italic>a priori</italic> assigned to one of 11 canonical signaling pathways as described in <xref ref-type="sec" rid="s4">Methods</xref>. The pathway assignments are indicated by the color of the reaction vertex in the network. (NA: not assigned; SGTP: small guanosine triphosphatase mediated signaling; PIP: phosphatidylinositol polyphosphate signaling; REC: recycling; ENDO: endocytosis; DEG: degradation; CELLC: cell cycle; MAPK: mitogen-activated protein kinase cascade; TRANS: transcription; CAS: Ca<sup>2+</sup> signaling; GPCR: G-protein coupled receptor mediated signaling; ERBB: erythroblastic leukemia viral oncogene homolog receptor signaling).</p>
        </caption>
        <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002262.g001" xlink:type="simple"/>
      </fig>
      <fig id="pcbi-1002262-g002" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1002262.g002</object-id>
        <label>Figure 2</label>
        <caption>
          <title>Graph image of the metabolic network.</title>
          <p>Each reaction in the network was <italic>a priori</italic> assigned to one of 10 textbook pathways as described in <xref ref-type="sec" rid="s4">Methods</xref>. The pathway assignments are indicated by the color of the reaction vertex in the network. (TRANS: transport; DETOX: detoxification; GLYCO: glucose metabolism; PYRU: pyruvate metabolism; TCA: tca cycle; UREA: urea cycle; ROP: oxidative phosphorylation; LIPID: lipid metabolism; AA: amino acid metabolism; KET: ketone body metabolism).</p>
        </caption>
        <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002262.g002" xlink:type="simple"/>
      </fig>
    </sec>
    <sec id="s2">
      <title>Results</title>
      <sec id="s2a">
        <title>Effect of Retroactive Interactions on Modularity: Signaling Network</title>
        <p>To examine the effect of cyclical, i.e. retroactive, interactions on modularity, we compared the partitions of the EGFR signaling network obtained using Newman's connectivity (<xref ref-type="fig" rid="pcbi-1002262-g003">Figure 3a</xref>) and the ShReD metric (<xref ref-type="fig" rid="pcbi-1002262-g003">Figure 3b</xref>). Several qualitative similarities between the two partitions are evident. In both partitions, modules that possess a large fraction of reactions from phosphatidylinositol polyphosphate (PIP) signaling coupled to either intracellular Ca<sup>2+</sup> signaling (CAS) or small guanosine triphosphatase (SGTP) were identified. Quantitatively, both partitions reach a hierarchical depth of 6 and become more homogeneous closer to the terminal nodes of the partition tree. From the root to terminal nodes, the canonical group compositions of the modules (represented by the pie colors) trend toward a single, dominant group (<xref ref-type="fig" rid="pcbi-1002262-g004">Figure 4a</xref>). At the terminal nodes (height zero), the fraction of reactions in a module belonging to a single canonical group, on average, exceeds 80% for both Newman and ShReD partitions.</p>
        <fig id="pcbi-1002262-g003" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002262.g003</object-id>
          <label>Figure 3</label>
          <caption>
            <title>Hierarchical partitions of EGFR signaling network.</title>
            <p>(A) Partitions obtained using Newman's connectivity metric. The GPCR dominated module (ID: 22202) has 36 reactions and 28 cycles. (B) Partitions obtained using the ShReD metric. The GPCR dominated module (ID: 22203) has 39 reactions and 167 cycles. The terminal node (ID: 22219) has 99 reactions, but only 10 cycles.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002262.g003" xlink:type="simple"/>
        </fig>
        <fig id="pcbi-1002262-g004" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002262.g004</object-id>
          <label>Figure 4</label>
          <caption>
            <title>Effects of the partition metric on the properties of EGFR signaling network modules.</title>
            <p>(A) Homogeneity of modules as a function of partition height (see text in <xref ref-type="sec" rid="s4">Methods</xref> for definition of homogeneity index). (B) Average number of cycles in a module as a function of network depth. Error bars represent one standard deviation.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002262.g004" xlink:type="simple"/>
        </fig>
        <p>There are also notable differences between the two partitions. While both partitions extract modules predominantly consisting of G-Protein coupled Receptor (GPCR) activation reactions, the ShReD partition identifies greater hierarchy stemming from those modules. In the Newman partition, there are several terminal leaf nodes that predominantly comprise Mitogen Activated Protein Kinase (MAPK) reactions. Analogous terminal nodes are not present in the ShReD partition. The ShReD partition yields a large terminal node consisting of 99 reactions (Supplementary <xref ref-type="supplementary-material" rid="pcbi.1002262.s003">Figure S1b</xref>, ID: 22219), whereas the largest terminal node of the Newman partition consists of 36 reactions (<xref ref-type="supplementary-material" rid="pcbi.1002262.s003">Figure S1a</xref>, ID: 22202). The largest terminal node in the Newman partition (ID: 22202) predominantly comprises GPCR transactivation reactions, whereas the largest terminal node in the ShReD partition (ID: 22219) comprises several signaling functions, including MAPK cascade, endocytosis, and cell cycle. Another notable difference is that while the average number of cycles in a module decreases with increasing depth for both partitions, a larger number of cycles are preserved in the ShReD partition at greater depths (<xref ref-type="fig" rid="pcbi-1002262-g004">Figure 4b</xref>).</p>
      </sec>
      <sec id="s2b">
        <title>Effect of Retroactive Interactions on Modularity: Metabolic Network</title>
        <p>We next compared the Newman (<xref ref-type="fig" rid="pcbi-1002262-g005">Figure 5a</xref>) and ShReD partitions (<xref ref-type="fig" rid="pcbi-1002262-g005">Figure 5b</xref>) for the liver metabolic network, complete with regulatory edges and cofactors. As was the case for the EGFR network, both partitions lead to modules that generally increase in homogeneity from the root node to the terminal nodes (<xref ref-type="fig" rid="pcbi-1002262-g006">Figure 6</xref>). However, unlike the EGFR network, the arrangement and compositions of the two partitions are drastically different (<xref ref-type="fig" rid="pcbi-1002262-g005">Figure 5</xref>). In contrast to the Newman partition, the ShReD partition generates modules with hierarchical depth, similar to the GPCR dominated modules of the EGFR network. In the case of the metabolic network, hierarchical depth was greatest for modules comprising reactions in and around glycolysis (GLYCO). Moreover, the terminal node modules of the ShReD partition reach greater homogeneity compared to the Newman partition (<xref ref-type="fig" rid="pcbi-1002262-g006">Figure 6</xref>, <xref ref-type="supplementary-material" rid="pcbi.1002262.s004">Figure S2</xref>).</p>
        <fig id="pcbi-1002262-g005" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002262.g005</object-id>
          <label>Figure 5</label>
          <caption>
            <title>Hierarchical partitions of hepatocyte metabolic network.</title>
            <p>(A) Partitions obtained using Newman's connectivity metric. (B) Partitions obtained using the ShReD. Details of the reactions in the boxed modules are shown in <xref ref-type="fig" rid="pcbi-1002262-g009">Figures 9a and 9b</xref>. The other boxed module (ID: 15939) contains pyruvate kinase.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002262.g005" xlink:type="simple"/>
        </fig>
        <fig id="pcbi-1002262-g006" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002262.g006</object-id>
          <label>Figure 6</label>
          <caption>
            <title>Effects of the partition metric on the properties of hepatocyte network modules.</title>
            <p>Homogeneity index is shown as a function of partition height. The height of the root node in the Newman partition tree is 2, whereas the height of the ShReD tree is 7. Error bars represent one standard deviation.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002262.g006" xlink:type="simple"/>
        </fig>
      </sec>
      <sec id="s2c">
        <title>Impact of Allosteric Regulation</title>
        <p>The impact of metabolic regulation on ShReD-based modularity was investigated by comparing the partitions for the metabolic network model with (<xref ref-type="fig" rid="pcbi-1002262-g005">Figure 5b</xref>) and without the allosteric interactions (<xref ref-type="fig" rid="pcbi-1002262-g007">Figure 7a</xref>). The two models yield qualitatively similar hierarchical partitions with subtle differences in the placement of reactions into modules (<xref ref-type="supplementary-material" rid="pcbi.1002262.s001">Dataset S1</xref>). These differences include the placement of reactions coupled to the pyruvate kinase reaction, which is subject to a high degree of allosteric regulation relative to other reactions in the network. The quantitative impact of regulation is observed by comparing the number of ShReDs present in the network prior to the partition. At depth zero, there are approximately 250 additional ShReDs in the model with allosteric regulation compared to the model without regulation (<xref ref-type="fig" rid="pcbi-1002262-g008">Figure 8a</xref>). However, there is no obvious difference in the number of ShReDs between the two models at greater depths. There is also no obvious difference in the average ShReD at most depths, with the exception of depth zero, where the average ShReD is approximately 7% shorter for the model with allosteric regulation compared to the model without regulation (<xref ref-type="fig" rid="pcbi-1002262-g008">Figure 8b</xref>).</p>
        <fig id="pcbi-1002262-g007" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002262.g007</object-id>
          <label>Figure 7</label>
          <caption>
            <title>ShReD partitions of modified hepatocyte metabolic models.</title>
            <p>(A) Metabolic network with cofactors, but no regulatory edges. The boxed module (ID: 15982) contains pyruvate kinase. (B) Metabolic network with regulatory edges, but no cofactors. Note the absence of a redox module coupling detoxification reactions with lipid synthesis.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002262.g007" xlink:type="simple"/>
        </fig>
        <fig id="pcbi-1002262-g008" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002262.g008</object-id>
          <label>Figure 8</label>
          <caption>
            <title>Effects of regulatory edges on module properties.</title>
            <p>(A) Number of finite ShReDs in a module as a function of partition depth. (B) Average ShReD of a module as a function of partition depth. Error bars represent one standard deviation.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002262.g008" xlink:type="simple"/>
        </fig>
      </sec>
      <sec id="s2d">
        <title>Impact of Cofactors</title>
        <p>We next assessed the impact of cofactors such as ATP, NADH, and NADPH on ShReD-based modularity by comparing the partition generated for the complete metabolic model (<xref ref-type="fig" rid="pcbi-1002262-g005">Figure 5b</xref>) to the partition for a partial model with regulatory edges, but lacking any interactions resulting from cofactors (<xref ref-type="fig" rid="pcbi-1002262-g007">Figure 7b</xref>). Qualitatively, the partitions reveal similar canonical groupings. Both partitions identify modules predominantly characterized by glucose metabolism (GLYCO) and modules predominantly characterized by amino acid metabolism (AA). Both partitions also group together reactions of the TCA cycle (TCA), urea cycle (UREA) and pyruvate metabolism (PYRU). A major difference between the two partitions involves the reactions of lipid metabolism (LIPID) and detoxification (DETOX). For the complete model, the ShReD partition identifies a module consisting of reactions from LIPID, DETOX, GLYCO, and PYRU (<xref ref-type="fig" rid="pcbi-1002262-g005">Figures 5b</xref> and <xref ref-type="fig" rid="pcbi-1002262-g009">9b:</xref> ID: 15995), whereas no analogous module is identified for the model without cofactors. The reactions of module 15995 either produce or consume NADPH to support detoxification and lipid synthesis (<xref ref-type="fig" rid="pcbi-1002262-g009">Figure 9b</xref>). Quantitatively, the number of ShReDs trends lower when the cofactors are absent, with the largest difference observed at zero depth (<xref ref-type="fig" rid="pcbi-1002262-g010">Figure 10a</xref>). Conversely, the average ShReD of a module is generally larger when the cofactors are absent, with the largest difference again observed at zero depth (<xref ref-type="fig" rid="pcbi-1002262-g010">Figure 10b</xref>). At greater depths (&gt;3), the average ShReD plateaus to a value between 2 and 3 edges for both models.</p>
        <fig id="pcbi-1002262-g009" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002262.g009</object-id>
          <label>Figure 9</label>
          <caption>
            <title>Redox modules.</title>
            <p>Detailed composition of modules boxed in <xref ref-type="fig" rid="pcbi-1002262-g005">Figure 5b</xref>. (A) Coupled reactions of the TCA cycle and oxidative phosphorylation (highlighted in bold type) metabolizing NADH and FADH<sub>2</sub>. (B) Coupled reactions metabolizing NADPH.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002262.g009" xlink:type="simple"/>
        </fig>
        <fig id="pcbi-1002262-g010" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002262.g010</object-id>
          <label>Figure 10</label>
          <caption>
            <title>Effects of regulatory edges on module properties.</title>
            <p>(A) Number of finite ShReDs in a module as a function of partition depth. (B) Average ShReD of a module as a function of partition depth. Error bars represent one standard deviation.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002262.g010" xlink:type="simple"/>
        </fig>
      </sec>
      <sec id="s2e">
        <title>Comparison with Local Retroactivity</title>
        <p>For completeness sake, we compared the partitions based on ShReD with partitions based on local, or nearest neighbor, retroactivity. To obtain local retroactivity partitions, the size of cycles was restricted to two edges, effectively eliminating all retroactive paths involving non-neighboring vertices. Algorithmically, <italic>ShReD<sub>ij</sub></italic> was set to infinity, if <italic>ShReD<sub>ij</sub></italic> was greater than 2. Biochemically, a locally retroactive interaction represented either a reversible reaction catalyzed by a single enzyme or two irreversible reactions with opposite stoichiometry. For all cases, including the EGFR signaling network as well as various versions of the hepatocyte metabolic network, partitions based on local retroactivity failed to generate any modules.</p>
      </sec>
    </sec>
    <sec id="s3">
      <title>Discussion</title>
      <p>In this paper, we introduce the use of ShReD as a round trip distance metric, which can be combined with a partition algorithm (adapted from Newman's earlier work on community detection) to systematically identify biochemical reaction modules that feature cyclical interactions. The notion of grouping together network components based on “retroactivity” was first proposed by Saez-Rodriguez and coworkers, who hypothesized that a strictly downstream component should have little impact on the activity of an upstream component unless there is a feedback or retroactive relationship <xref ref-type="bibr" rid="pcbi.1002262-SaezRodriguez1">[15]</xref>. It has been suggested that such feedback relationships contribute to robustness with respect to external perturbation, notably in signal transduction networks <xref ref-type="bibr" rid="pcbi.1002262-Kitano1">[16]</xref>. The ShReD metric accounts for cyclical interactions that span multiple reaction steps, and thus significantly extends on the prior work on retroactivity, which focused on local interactions between neighboring components. Previously, (shortest) path lengths between network components have been used to identify reaction modules by clustering, but without consideration of directionality and retroactivity <xref ref-type="bibr" rid="pcbi.1002262-Ma1">[20]</xref>.</p>
      <p>To evaluate the performance of ShReD as a module-detection metric, we performed two sets of comparisons. One set of comparisons involved the community detection algorithm presented by Newman, which also formed the basis for our partitioning algorithm. Newman's original algorithm partitioned based on connectivity, and favored the placement of a pair of network elements (vertices in the graph representation) into the same module if the number of connections between the two elements exceeded the expected (e.g. average) number of connections assuming an equivalent network with edges placed at random. The second set of comparisons involved the special case of local feedback loops or cycles arising from reversible reactions. The results of these comparisons were used to investigate how multi-step signaling loops or metabolic cycles, as opposed to conventional connectivity or reaction reversibility, contribute to the modular organization of biochemical networks.</p>
      <p>Applied to a model network of EGFR signaling, the ShReD-based partitions generated modules with a greater number of cyclical interactions across all depths compared to Newman's connectivity-based partitions (<xref ref-type="fig" rid="pcbi-1002262-g004">Figure 4b</xref>), consistent with the premise of the ShReD metric. Our results suggest that the total number of cyclical interactions in a network or module at least partially dictates the hierarchical depth of ShReD-based partitions. The ShReD-based partitions of the EGFR model generated one large terminal module with 99 reactions (<xref ref-type="fig" rid="pcbi-1002262-g003">Figure 3b</xref>, ID 22219), which could not be further modularized due to the relatively small number of cycles (a total of 10) in the module (∼0.5 ShReDs per reaction). In contrast, the GPCR dominated module (ID 22203) has 167 cycles and 774 ShReDs connecting just 39 reactions (∼20 ShReDs per reaction), and can be further partitioned to generate 4 additional levels of hierarchy.</p>
      <p>In the case of the liver metabolic network, which has a substantially greater number of cycles (arising from allosteric feedback loops) compared to the EGFR signaling network, the difference between ShReD and Newman partitions is more dramatic. ShRed partitions again lead to greater hierarchy, reaching a depth of 7, whereas Newman's partition only reaches a depth of 3. The greater hierarchy achieved using the ShReD metric is significant, because the partition algorithm is essentially identical to Newman's algorithm, i.e. the only difference is the metric used to calculate the modularity score <italic>Q</italic>. For both metrics, a module is further partitioned only if the <italic>Q</italic> score is positive after the partition. Indeed, the scoring criterion based on the ShReD metric is actually more stringent, because the algorithm performs an additional test to ensure that the modules resulting from a partition each has at least one cycle. In this regard, the greater hierarchy generated by the ShReD (as opposed to the partition algorithm) gives credence to the metric for being able to identify hierarchical modules based on the preservation of cycles.</p>
      <p>The retroactive interactions captured by ShReD include not only reaction reversibility (as in previous work <xref ref-type="bibr" rid="pcbi.1002262-SaezRodriguez1">[15]</xref>), but also cycles and feedback loops involving multiple reactions and allosteric effectors. Feedback loops resulting from allosteric regulation of an upstream enzyme by a downstream product represent an important regulatory motif that is common to biochemical networks. To examine the impact of feedback loops on modularity, ShReD partitions were obtained for the metabolic network with and without allosteric regulation. While qualitatively similar, the partitions differed in the placement of highly regulated reactions. For example, biochemistry textbooks generally associate pyruvate kinase (PK) with glycolysis, where the enzyme catalyzes the terminal step. The enzyme's activity is subject to allosteric regulation by several sugar phosphates produced upstream in glycolysis. On the other hand, the enzyme's product, pyruvate, is highly connected to the TCA cycle and amino acid pathways through anaplerosis and transamination reactions. When regulatory edges are absent, ShReD partitions place PK in one of the terminal leaf nodes along with reactions of lipid metabolism, pyruvate metabolism, the TCA cycle, oxidative phosphorylation and ketone body synthesis (<xref ref-type="fig" rid="pcbi-1002262-g007">Figure 7a</xref>, ID: 15982). When regulatory edges are present in the model, however, the partitions place PK in a module dominated by reactions of sugar metabolism (<xref ref-type="fig" rid="pcbi-1002262-g005">Figure 5b</xref>, ID 15939), consistent with textbook biochemistry. In this regard, the ShReD metric captures the impact of both stoichiometric connectivity and feedback regulation in determining modularity.</p>
      <p>As many of the allosteric regulators were energy currency metabolites, we also examined the partitions for a partial metabolic model that lacks these cofactors. The resulting network contains fewer ShReDs, presumably reflecting an overall decrease in the total number of paths. Compared to the complete model, the corresponding ShReDs (connecting the same reaction vertices) of the partial model are ∼30% <italic>longer</italic>, indicating that allosteric feedback and other cofactor-dependent interactions more tightly couple the reactions in the network. In the present study, abstracting the metabolic network as a reaction-centric graph greatly facilitated the inclusion of cofactors in the modularity analysis, identifying both intuitive and non-canonical groupings that could not be identified by removing interactions effected by cofactors. For example, not including the cofactors in the model would completely isolate the oxidative phosphorylation reactions and carbamoyl phosphate production reaction from the rest of the metabolic network as disconnected components. Including the cofactors allows these reactions to be placed into modules; for the complete metabolic model, these reactions are kept together at a height of 2 (<xref ref-type="supplementary-material" rid="pcbi.1002262.s001">Dataset S1</xref>). Another example of cofactor-dependent modularity involves the association of NADH and FADH<sub>2</sub> oxidation with different reactions in and around the TCA cycle (<xref ref-type="fig" rid="pcbi-1002262-g009">Figure 9a</xref>). The partitions place NADH oxidation into a module (ID: 15984) that also contains isocitrate and alpha-keto glutarate dehydrogenases, which are NADH producing reactions in the TCA cycle. Similarly, FADH<sub>2</sub> oxidation is placed in a module (ID: 15985) containing succinate dehydrogenase, which reduces FAD<sup>+</sup> to FADH<sub>2</sub>. The coupling between TCA cycle reactions and oxidative phosphorylation is intuitive. However, the TCA cycle reactions are also highly connected to reactions in glutamate metabolism and β-oxidation, associations that may be subjectively less intuitive. In this light, ShReD partitions reflect an emphasis on cyclical interactions mediated by the cofactors. A third example of an intuitive, yet non-canonical grouping involves the drug transformation reactions. In the present study, the metabolic model included reactions that are induced by troglitazone, a hydrophobic anti-diabetic compound withdrawn from the market due to severe hepaotoxicity. Module 15995 illustrates the cyclical interactions coordinating reactions of several different canonical pathways, including glutathione, lipid, glucose, and pyruvate metabolism (<xref ref-type="fig" rid="pcbi-1002262-g009">Figure 9b</xref>). A dominant characteristic (exhibited by seven of the nine reactions) of this module is the production and consumption of NADPH, again underscoring the significance of the cofactors in determining the modularity.</p>
      <p>To examine whether the influence of the cofactors reflected the relatively small size of the model network (comprising ca. 150 reactions), we also applied the ShReD-based modularity analysis to a larger model of the human liver (comprising ca. 2500 reactions) <xref ref-type="bibr" rid="pcbi.1002262-Gille1">[21]</xref>. The analysis again identified cofactor modules centered on NADH and NADPH consumption and production, similar to the smaller liver model (<xref ref-type="supplementary-material" rid="pcbi.1002262.s005">Figure S3</xref>, <xref ref-type="supplementary-material" rid="pcbi.1002262.s002">Dataset S2</xref>). Many of the terminal modules for the larger model comprised reactions that were grouped into analogous modules for the smaller model, suggesting that the size of the model did not qualitatively alter the structural organization of the metabolic network. Quantitatively, the maximum hierarchical depth was greater for the larger network, increasing from 7 to 16. The increased depth was presumably due to the greater detail of the HepatoNet1 model, which includes many additional pathways of amino acid, lipid and nucleotide metabolism.</p>
      <p>In conclusion, this paper presents a novel methodology for modularity analysis that enables hierarchical partitions of biochemical networks by preserving feedback loops and other cyclical interactions. To the best of our knowledge, the present study is the first to build a module detection method that focuses on cycles or feedback loops as the key structural feature. The present study is also the first to account for cofactors in modularity analysis, further emphasizing the role of pathway regulation in network modularity. Previously, studies on modularity have generally ignored cofactors, citing methodological challenges arising from having to place these highly connected hub metabolites into particular modules <xref ref-type="bibr" rid="pcbi.1002262-Ma1">[20]</xref>, <xref ref-type="bibr" rid="pcbi.1002262-Holme1">[22]</xref>. It should be noted that the current analysis, which does not weight the edges in calculating the ShReDs, implicitly assumes that all reactions in the network are equally engaged. Clearly, the levels of engagement can be expected to vary across different reactions, and should ideally be weighted appropriately, by using quantitative activity data such as metabolic flux. For example, a high glycolytic flux may confer a larger weight to edges representing PK regulation, which in turn may impact the overall modularity of the network. Moreover, cells subjected to different chemical or genetic perturbations will likely exhibit different flux dynamics, which would need to be reflected in the metric to obtain partitions that meaningfully analyze the modularity of a dynamic system such as the biological cell. A thorough examination of the role of reaction engagements in modularity analysis is beyond the scope of this study, and warrants further work in a future study.</p>
    </sec>
    <sec id="s4" sec-type="methods">
      <title>Methods</title>
      <sec id="s4a">
        <title>Network Representation</title>
        <p>A common way to model a biochemical network using a graph is to represent the components as vertices and their interactions as edges. In this study, the focus is on understanding the hierarchical and modular relationship among reactions, treating metabolites as shared resources among modules. We therefore use a directed graph with vertices representing reactions and edges indicating a directional interaction between the connected reactions. Edges are drawn between two reactions (<xref ref-type="fig" rid="pcbi-1002262-g011">Figure 11a</xref>) if the product of one reaction is either a reactant (<xref ref-type="fig" rid="pcbi-1002262-g011">Figure 11b</xref>) or allosteric effector of another reaction (<xref ref-type="fig" rid="pcbi-1002262-g011">Figure 11c</xref>). For reversible reactions, reactant-product relationships are considered in both directions.</p>
        <fig id="pcbi-1002262-g011" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002262.g011</object-id>
          <label>Figure 11</label>
          <caption>
            <title>Network representation.</title>
            <p>(A) A reaction-centric representation of two different cases (B and C) where one reaction is upstream of another. (B) Reaction R<sub>1</sub> produces a metabolite M<sub>2</sub> that is consumed by reaction R<sub>2</sub>. (C) Reaction R<sub>1</sub> produces a metabolite M<sub>2</sub> that is an allosteric effector of the enzyme catalyzing reaction R<sub>2</sub>.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002262.g011" xlink:type="simple"/>
        </fig>
      </sec>
      <sec id="s4b">
        <title>Shortest Retroactive Distance</title>
        <p>We utilize round trip distance as a metric, which we call <underline>Sh</underline>ortest <underline>Re</underline>troactive <underline>D</underline>istance (ShReD), to characterize the connectivity between two vertices that interact retroactively. A retroactive interaction exists between two vertices <italic>i</italic> and <italic>j</italic>, if and only if there is a directional path from vertex <italic>i</italic> to <italic>j and</italic> a return path from vertex <italic>j</italic> to <italic>i</italic>. The retroactive interaction represents a mechanism for mutual feedback, and thus expresses interdependence. The ShReD of vertices <italic>i</italic> and <italic>j</italic> (<italic>ShReD<sub>ij</sub></italic>) is the sum of the <italic>shortest path</italic> distance from node <italic>i</italic> to <italic>j</italic> and the shortest return path distance from node <italic>j</italic> to <italic>i</italic>. In the example network of <xref ref-type="fig" rid="pcbi-1002262-g012">Figure 12</xref>, <italic>ShReD<sub>1,3</sub></italic> is 3 because there are two edges along the shortest path from R<sub>1</sub> to R<sub>3</sub> and there is one edge from R<sub>3</sub> to R<sub>1</sub>. There is another cycle connecting the two reaction vertices, which also involves R<sub>4</sub>, R<sub>5</sub> and R<sub>6</sub>. This cycle, however, is not the ShReD, as its length of 6 exceeds the ShReD value of 3. For a given network (or sub-network) a ShReD value is computed for every pair of vertices in the network (or sub-network). To compute the ShReD values, we first calculated the shortest distances between all pairs of vertices using the Floyd-Warshall algorithm <xref ref-type="bibr" rid="pcbi.1002262-Floyd1">[23]</xref>. The resulting all-pairs shortest path matrix was then added to its own transpose to generate a symmetrical ShReD matrix. When there is no path or no return path between two vertices, the ShReD value between these two vertices is infinity. The ShReD between a node and itself is zero. For the example network in <xref ref-type="fig" rid="pcbi-1002262-g012">Figure 12</xref>, the ShReD matrix is as follows:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002262.e001" xlink:type="simple"/><label>(1)</label></disp-formula></p>
        <fig id="pcbi-1002262-g012" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002262.g012</object-id>
          <label>Figure 12</label>
          <caption>
            <title>Example illustrating ShReD-based network partition.</title>
            <p>(A) The example network comprises 8 reactions and 1 allosteric inhibition. (B) Graph representation of the reaction-to-reaction interactions in the example network.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002262.g012" xlink:type="simple"/>
        </fig>
      </sec>
      <sec id="s4c">
        <title>Partitioning Algorithm</title>
        <p>Partitions were obtained by adapting Newman's community detection algorithm <xref ref-type="bibr" rid="pcbi.1002262-Newman1">[18]</xref>, which was modified to generate partitions based on the ShReD metric, as opposed to simple connectivity. An overview of the algorithm flow is shown in <xref ref-type="fig" rid="pcbi-1002262-g013">Figure 13</xref>. The initial step is to find the connected subnetworks in the parent network using a breadth-first traversal algorithm <xref ref-type="bibr" rid="pcbi.1002262-Cormen1">[24]</xref>, as it is possible that the parent network, represented as a reaction centric graph, may not be connected. For the search, the network is represented as an undirected graph, as we are interested in identifying the connectivity of vertices, regardless of direction. Each connected subnetwork is then partitioned into two daughter subnetworks to maximize a “modularity score” while ensuring that each subnetwork resulting from a partition retains at least one retroactive interaction, i.e. cycle. Applied recursively, the algorithm produces a hierarchical tree of binary partitions.</p>
        <fig id="pcbi-1002262-g013" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002262.g013</object-id>
          <label>Figure 13</label>
          <caption>
            <title>Schematic illustrating the flow of the partitioning algorithm.</title>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002262.g013" xlink:type="simple"/>
        </fig>
        <p>In Newman's algorithm, the modularity score was computed as the difference between the actual and expected number of <italic>connections</italic> between two components. In this study, we computed the difference between the actual and expected ShReD to determine the modularity score. The expected ShReD between <italic>i</italic> and <italic>j</italic>, <italic>P<sub>ij</sub></italic>, is computed as the arithmetic mean of the average of all non-zero and non-infinite ShReDs involving <italic>i</italic> and the average of all non-zero and non-infinite ShReDs involving <italic>j</italic>:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002262.e002" xlink:type="simple"/><label>(2)</label></disp-formula>where <italic>D<sub>i</sub></italic> and <italic>D<sub>j</sub></italic> are the number of non-zero and non-infinite ShReDs involving <italic>i</italic> and <italic>j</italic> respectively, and <italic>n</italic> is the total number of vertices in the network (or sub-network). We define a <italic>ShReD-based modularity matrix</italic>, <bold>G</bold>, as follows:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002262.e003" xlink:type="simple"/><label>(3)</label></disp-formula>The diagonal entries of <bold>G</bold> are set to zero, because both the expected and actual ShReD between a vertex and itself are zero. An entry <italic>G<sub>ij</sub></italic> is also set to zero, if <italic>ShReD<sub>ij</sub></italic> is infinity. For the example network in <xref ref-type="fig" rid="pcbi-1002262-g012">Figure 12</xref>, the average ShReD of R<sub>1</sub> and R<sub>2</sub> are both 4.8. The expected ShReD between R<sub>1</sub> and R<sub>2</sub>, <italic>P<sub>12</sub></italic>, is thus 4.8, and <italic>G<sub>12</sub></italic> is 1.8. The full matrix <bold>G</bold> for the example network is shown below. The ShReD-based modularity matrix differs from Newman's <italic>connectivity-based modularity matrix</italic>, which does not take into account the direction of an interaction.<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002262.e004" xlink:type="simple"/><label>(4)</label></disp-formula>Defining the modularity score <italic>Q</italic> based on the ShReD-based modularity matrix <bold>G</bold>, we wish to find a vector <bold>s</bold>, which assigns each vertex in the network to one of the two partitioned sub-networks to maximize <italic>Q</italic>:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002262.e005" xlink:type="simple"/><label>(5)</label></disp-formula>where <italic>s<sub>i</sub></italic> is an element of a vector <bold>s</bold>. Each <italic>s<sub>i</sub></italic> has a value of either −1 or 1. An increase in <italic>Q</italic> is obtained in two cases: if <italic>G<sub>ij</sub></italic> is positive and the vertices <italic>i</italic> and <italic>j</italic> are assigned to the same sub-network (<italic>s<sub>i</sub></italic> = <italic>s<sub>j</sub></italic> = 1 or <italic>s<sub>i</sub></italic> = <italic>s<sub>j</sub></italic> = −1), or if <italic>G<sub>ij</sub></italic> is negative and the two vertices are assigned to different subnetworks (<italic>s<sub>i</sub></italic> = 1 and <italic>s<sub>j</sub></italic> = −1 or vice versa). The vector <bold>s</bold> maximizing <italic>Q</italic> can be found using spectral partitioning methods <xref ref-type="bibr" rid="pcbi.1002262-Pothen1">[25]</xref> as described by Newman <xref ref-type="bibr" rid="pcbi.1002262-Newman1">[18]</xref>. The solution to the maximization problem can be approximated by the leading eigenvector of <bold>G</bold>. For our example network (<xref ref-type="fig" rid="pcbi-1002262-g012">Figure 12</xref>), the leading eigenvector of <bold>G</bold> (Equation 4) is given by <bold>v</bold> = [−0.41, −0.41, −0.41, 0.41, 0.41, 0.41, 0, 0], from which <bold>s</bold> is approximated as <bold>s</bold> = [−1, −1, −1, 1, 1,1, −1, −1]. All non-positive entries, including zero, in the eigenvector are assigned the value −1. This partition assigns R<sub>1</sub>, R<sub>2</sub>, R<sub>3</sub>, R<sub>7</sub> and R<sub>8</sub> to one module, and R<sub>4</sub>, R<sub>5</sub> and R<sub>6</sub> to the other module. The reactions in the first module are not fully connected, which gives rise to two disconnected components, one comprising R<sub>1</sub>, R<sub>2</sub> and R<sub>3</sub> and the other comprising R<sub>7</sub> and R<sub>8</sub>. In this example, a single binary partition generated three separate modules, each consisting of a single cycle.</p>
        <p>In Newman's original community detection algorithm, partitioning of a subnetwork continues if the modularity score <italic>Q</italic> is greater than zero and the leading eigenvector <bold>s</bold> of the modularity matrix <bold>G</bold> has at least one positive and one negative element; otherwise the subnetwork is not further partitioned. The algorithm terminates if there is no subnetwork that can be further partitioned. In our algorithm, we modified the termination criterion to also check that there is a cycle in each subnetwork resulting from a partition operation. The check for a cycle was performed using an algorithm similar to topological sort <xref ref-type="bibr" rid="pcbi.1002262-Kahn1">[26]</xref>. For a given module abstracted as a directed graph, the number of incoming edges is computed for each vertex. A vertex with zero incoming edges is removed from the graph along with its outgoing edges. The number of incoming edges is then recalculated for the remaining vertices. The process repeats until there are no more vertices, in which case the graph has no cycles, or until there are no vertices with zero incoming edges, indicating the presence of a cycle. In our example, the <italic>Q</italic> score for the first partition is greater than zero (<italic>Q</italic> = 43.2) and each resulting subnetwork contained at least one cycle. Thus, the partitioned subnetworks are accepted as modules and the algorithm continues by finding the connected subnetworks in each module. The module comprising R<sub>1</sub>, R<sub>2</sub>, R<sub>3</sub>, R<sub>7</sub> and R<sub>8</sub> is not fully connected, and two subnetworks are found, one comprising R<sub>1</sub>, R<sub>2</sub>, and R<sub>3</sub> and the other comprising R<sub>7</sub> and R<sub>8</sub>. Neither subnetwork can be further partitioned, as every element in the leading eigenvector of the corresponding modularity matrix has the same sign. Similarly, the module comprising R<sub>4</sub>, R<sub>5</sub> and R<sub>6</sub> cannot be further partitioned, as every element in the leading eigenvector of the corresponding modularity matrix has the same sign, and the algorithm terminates.</p>
      </sec>
      <sec id="s4d">
        <title>Hierarchical Tree of Partitions</title>
        <p>The partitioning results are reported in the form of a hierarchical tree annotated with several properties. Each module is represented as a pie chart, where the size of each slice is proportional to the fraction of reactions that belong to the corresponding, pre-assigned canonical (textbook) grouping. The <italic>homogeneity index</italic> of a module corresponds to the fraction occupied by the largest slice in the pie chart. The homogeneity index therefore ranges from 0 to 1, where a larger number indicates greater homogeneity in terms of composition based on the canonical group assignments. The black lines connecting the nodes in the hierarchical tree represent ShReD-based partitions, whereas the red lines represent the formation of components from partitions that include disconnected components. The depth of a module is determined as the number of black edges traversed from the root node to the module. The height of a module is determined as the largest possible number of black edges traversed from the module to a terminal leaf node.</p>
        <p>The <italic>number of cycles</italic> within a module is used to compare the partitions obtained based on the ShReD and Newman's connectivity metrics. While standard algorithms exist for counting the number of cycles in a graph <xref ref-type="bibr" rid="pcbi.1002262-Johnson1">[27]</xref>, the run time is proportional to the number of (non-unique) cycles. The number of cycles may be exponential in the number of vertices, and renders cycle counting as computationally inefficient. The cycle count is thus reported up to 1,000 unique cycles. Any count above 1,000 is effectively reported as 1,000. In addition to cycles, we also determined the number of <italic>non-infinite</italic> shortest retroactive paths in a module as well as the mean ShReD of the module. The mean ShReD of a module is calculated by averaging the corresponding non-infinite entries in the corresponding ShReD matrix.</p>
      </sec>
      <sec id="s4e">
        <title>Models</title>
        <p>As case studies, we examined two types of biochemical networks that feature directed interactions and feedback loops.</p>
        <sec id="s4e1">
          <title>Signaling model</title>
          <p>The signaling network was reconstructed based on a published model of epidermal growth factor receptor (EGFR) signaling <xref ref-type="bibr" rid="pcbi.1002262-Oda1">[19]</xref>. The model was downloaded as an SBML file and cast into the form of a stoichiometric matrix based on the directional interactions between signaling molecules defined in the SBML file. The model consisted of 322 signaling molecules (metabolites and proteins) participating in 211 signaling reactions. In addition to the signaling reactions, the model includes 238 allosteric interactions between the signaling molecules and reactions. The reactions in this model were <italic>a priori</italic> assigned to groups based on their previously catalogued function <xref ref-type="bibr" rid="pcbi.1002262-Oda1">[19]</xref>. For example, the reactions that convert ERK1/2 and PKB/akt into their active forms were assigned to the MAPK cascade and PIP signaling, respectively. This initial grouping, which reflects historical knowledge of signaling modularity, provided a basis for comparison between biological knowledge-driven, canonical associations versus partition-driven, systematically obtained network modules.</p>
        </sec>
        <sec id="s4e2">
          <title>Metabolic model</title>
          <p>A stoichiometric network model of human hepatocyte metabolism was reconstructed from the KEGG reaction database and further augmented by the addition of xenobiotic transformation reactions, as well as regulatory interactions mediated by allosteric effectors. The model comprised 159 reactions, 146 metabolites, and 61 regulatory interactions. The xenobiotic transformation reactions were added to describe the metabolism of the anti-diabetic compound troglitazone (TGZ), including steps needed to supply conjugation substrates such as glutathione (GSH). The regulatory interactions in the model reflect known allosteric effects of metabolites on reaction activity as described in a standard biochemistry textbook <xref ref-type="bibr" rid="pcbi.1002262-Lehninger1">[28]</xref>. Information about the allosteric effects of metabolites was organized into a regulatory matrix, where the columns and rows represented the effector metabolites and reactions regulated by these metabolites, respectively. The inhibition or activation of a reaction <italic>j</italic> by an allosteric effector <italic>i</italic> was denoted by a negative one (−1) or positive one (+1), respectively, in the matrix element (<italic>i</italic>, <italic>j</italic>). For all other cases where there were no known allosteric interactions, a zero (0) was entered into the corresponding matrix element. For example, the TCA cycle intermediate citrate allosterically inhibits phosphofructokinase I (PFK) to regulate the flux of glucose-derived substrates into the TCA cycle. In the regulatory matrix, this feedback inhibition is denoted by the value (−1) in the matrix element corresponding to (<italic>citrate</italic>, <italic>PFK</italic>). Similar to the EGFR signaling model, the reactions of the metabolic model were assigned into one of the following groups based on their canonical memberships as defined in standard biochemistry textbooks: transport (TRANS), detoxification (DETOX), sugar metabolism (encompassing glycolysis, gluconeogenesis, pentose phosphate shunt, and glycogen metabolism) (GLYCO), pyruvate metabolism (PYRU), TCA cycle (TCA), urea cycle (UREA), oxidative phosphorylation (ROP), lipid metabolism (LIPID), amino acid synthesis and degradation (AA), and ketone body production (KET). To test the impact of allosteric regulation on modularity, separate graph models were constructed by either omitting regulatory edges altogether, or just removing the cofactors (i.e. ATP, NADH and NADPH), which represented the majority of allosteric effectors. The cofactors were removed from the stoichiometric network model by deleting the corresponding rows of the stoichiometric matrix, which eliminated the regulatory edges reflecting cofactor-driven dependencies between reactions.</p>
        </sec>
        <sec id="s4e3">
          <title>HepatoNet1</title>
          <p>To investigate the effect of scale, a more detailed graph model of human liver metabolism was constructed from a previously published model (HepatoNet1) <xref ref-type="bibr" rid="pcbi.1002262-Gille1">[21]</xref>. The HepatoNet1 model was downloaded as an SBML file and cast into the form of a stoichiometric matrix based on the reaction definitions in the SBML file. The model comprised 2539 reactions and 777 metabolites. This model was used as is, without further addition of allosteric regulatory interactions.</p>
        </sec>
      </sec>
    </sec>
    <sec id="s5">
      <title>Supporting Information</title>
      <supplementary-material id="pcbi.1002262.s001" mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002262.s001" xlink:type="simple">
        <label>Dataset S1</label>
        <caption>
          <p>Partition report for the hepatocyte metabolic model. The report includes the reaction definitions, regulatory interactions, and stoichiometric matrix for the model.</p>
          <p>(XLSX)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002262.s002" mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002262.s002" xlink:type="simple">
        <label>Dataset S2</label>
        <caption>
          <p>Partition report for the Hepatonet1 model. The report includes the reaction definitions and stoichiometric matrix for the model.</p>
          <p>(XLSX)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002262.s003" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002262.s003" xlink:type="simple">
        <label>Figure S1</label>
        <caption>
          <p>Network of terminal modules from the partitioning of the EGFR signaling network using Newman's connectivity (A) and ShReD (B). The interactions between modules represent interactions between reactions in the respective modules. The size of a module is proportional to the number of reactions in the module. As the networks correspond to the terminal nodes of the respective partitioning trees, hierarchical information can be inferred from the presence of multiple modules assigned to the same canonical signaling pathway. For example, panel B shows multiple GPCR transactivation modules (dark blue) of varying sizes. In the same panel, MAPK cascade (light blue) is present as a component of a larger composite module with multiple canonical signaling pathways.</p>
          <p>(TIF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002262.s004" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002262.s004" xlink:type="simple">
        <label>Figure S2</label>
        <caption>
          <p>Network of terminal modules from the partitioning of the hepatocyte metabolic network based on both Newman's connectivity metric (A) and ShReD (B). The interactions between modules represent interactions between reactions in the respective modules. The size of a module is proportional to the number of reactions in the module.</p>
          <p>(TIF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002262.s005" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002262.s005" xlink:type="simple">
        <label>Figure S3</label>
        <caption>
          <p>ShReD based partitioning of Hepatonet1 model. Boxes highlight modules centered on NADH (module ID: 253956) and NADPH (module ID: 254789) consumption and production. The two modules share a number of reactions with identical main (carbon) reactants but different cofactors. For example, malate oxidation in the mitochondria (r0057) is in the NADH module, whereas malate oxidation in the cytosol (r0058) is in the NADPH module.</p>
          <p>(TIF)</p>
        </caption>
      </supplementary-material>
    </sec>
  </body>
  <back>
    <ack>
      <p>The authors thank Douglas Weaver for his lively discussions towards the development of ShReD as a metric, Sean Sullivan for his assistance in writing code for the hierarchical tree visuals, Michael Yi for his assistance in generating the HepatoNet1 partitions, and Richard Mondello and Marshall Moutenot for their help in implementing Newman's community detection algorithm.</p>
    </ack>
    <ref-list>
      <title>References</title>
      <ref id="pcbi.1002262-Papin1">
        <label>1</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Papin</surname><given-names>JA</given-names></name><name name-style="western"><surname>Reed</surname><given-names>JL</given-names></name><name name-style="western"><surname>Palsson</surname><given-names>BO</given-names></name></person-group>             <year>2004</year>             <article-title>Hierarchical thinking in network biology: the unbiased modularization of biochemical networks.</article-title>             <source>Trends Biochem Sci</source>             <volume>29</volume>             <fpage>641</fpage>             <lpage>647</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002262-Ravasz1">
        <label>2</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Ravasz</surname><given-names>E</given-names></name><name name-style="western"><surname>Somera</surname><given-names>AL</given-names></name><name name-style="western"><surname>Mongru</surname><given-names>DA</given-names></name><name name-style="western"><surname>Oltvai</surname><given-names>ZN</given-names></name><name name-style="western"><surname>Barabasi</surname><given-names>AL</given-names></name></person-group>             <year>2002</year>             <article-title>Hierarchical organization of modularity in metabolic networks.</article-title>             <source>Science</source>             <volume>297</volume>             <fpage>1551</fpage>             <lpage>1555</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002262-Ihmels1">
        <label>3</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Ihmels</surname><given-names>J</given-names></name><name name-style="western"><surname>Levy</surname><given-names>R</given-names></name><name name-style="western"><surname>Barkai</surname><given-names>N</given-names></name></person-group>             <year>2004</year>             <article-title>Principles of transcriptional control in the metabolic network of Saccharomyces cerevisiae.</article-title>             <source>Nat Biotechnol</source>             <volume>22</volume>             <fpage>86</fpage>             <lpage>92</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002262-Gutteridge1">
        <label>4</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Gutteridge</surname><given-names>A</given-names></name><name name-style="western"><surname>Kanehisa</surname><given-names>M</given-names></name><name name-style="western"><surname>Goto</surname><given-names>S</given-names></name></person-group>             <year>2007</year>             <article-title>Regulation of metabolic networks by small molecule metabolites.</article-title>             <source>BMC Bioinformatics</source>             <volume>8</volume>             <fpage>88</fpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002262-Panke1">
        <label>5</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Panke</surname><given-names>S</given-names></name><name name-style="western"><surname>Heinemann</surname><given-names>M</given-names></name></person-group>             <year>2006</year>             <article-title>Synthetic biology - putting engineering into biology.</article-title>             <source>Bioinformatics</source>             <volume>22</volume>             <fpage>2790</fpage>             <lpage>2799</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002262-Andrianantoandro1">
        <label>6</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Andrianantoandro</surname><given-names>E</given-names></name><name name-style="western"><surname>Basu</surname><given-names>S</given-names></name><name name-style="western"><surname>Karig</surname><given-names>DK</given-names></name><name name-style="western"><surname>Weiss</surname><given-names>R</given-names></name></person-group>             <year>2006</year>             <article-title>Synthetic biology: new engineering rules for an emerging discipline.</article-title>             <source>Mol Syst Biol</source>             <volume>2</volume>             <fpage>2006 0028</fpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002262-Kanehisa1">
        <label>7</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Kanehisa</surname><given-names>M</given-names></name><name name-style="western"><surname>Goto</surname><given-names>S</given-names></name></person-group>             <year>2000</year>             <article-title>KEGG: kyoto encyclopedia of genes and genomes.</article-title>             <source>Nucleic Acids Res</source>             <volume>28</volume>             <fpage>27</fpage>             <lpage>30</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002262-Kanehisa2">
        <label>8</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Kanehisa</surname><given-names>M</given-names></name><name name-style="western"><surname>Goto</surname><given-names>S</given-names></name><name name-style="western"><surname>Furumichi</surname><given-names>M</given-names></name><name name-style="western"><surname>Tanabe</surname><given-names>M</given-names></name><name name-style="western"><surname>Hirakawa</surname><given-names>M</given-names></name></person-group>             <year>2010</year>             <article-title>KEGG for representation and analysis of molecular networks involving diseases and drugs.</article-title>             <source>Nucleic Acids Res</source>             <volume>38</volume>             <fpage>D355</fpage>             <lpage>360</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002262-Kanehisa3">
        <label>9</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Kanehisa</surname><given-names>M</given-names></name><name name-style="western"><surname>Goto</surname><given-names>S</given-names></name><name name-style="western"><surname>Hattori</surname><given-names>M</given-names></name><name name-style="western"><surname>Aoki-Kinoshita</surname><given-names>KF</given-names></name><name name-style="western"><surname>Itoh</surname><given-names>M</given-names></name><etal/></person-group>             <year>2006</year>             <article-title>From genomics to chemical genomics: new developments in KEGG.</article-title>             <source>Nucleic Acids Res</source>             <volume>34</volume>             <fpage>D354</fpage>             <lpage>357</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002262-vanRiel1">
        <label>10</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>van Riel</surname><given-names>NA</given-names></name><name name-style="western"><surname>Sontag</surname><given-names>ED</given-names></name></person-group>             <year>2006</year>             <article-title>Parameter estimation in models combining signal transduction and metabolic pathways: the dependent input approach.</article-title>             <source>Syst Biol (Stevenage)</source>             <volume>153</volume>             <fpage>263</fpage>             <lpage>274</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002262-Barrett1">
        <label>11</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Barrett</surname><given-names>CL</given-names></name><name name-style="western"><surname>Herrgard</surname><given-names>MJ</given-names></name><name name-style="western"><surname>Palsson</surname><given-names>B</given-names></name></person-group>             <year>2009</year>             <article-title>Decomposing complex reaction networks using random sampling, principal component analysis and basis rotation.</article-title>             <source>BMC Syst Biol</source>             <volume>3</volume>             <fpage>30</fpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002262-Ederer1">
        <label>12</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Ederer</surname><given-names>M</given-names></name><name name-style="western"><surname>Sauter</surname><given-names>T</given-names></name><name name-style="western"><surname>Bullinger</surname><given-names>E</given-names></name><name name-style="western"><surname>Gilles</surname><given-names>ED</given-names></name><name name-style="western"><surname>Allgower</surname><given-names>F</given-names></name></person-group>             <year>2003</year>             <article-title>An approach for dividing models of biological reaction networks into functional units.</article-title>             <source>Simul-T Soc Mod Sim</source>             <volume>79</volume>             <fpage>703</fpage>             <lpage>716</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002262-Schuster1">
        <label>13</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Schuster</surname><given-names>S</given-names></name><name name-style="western"><surname>Pfeiffer</surname><given-names>T</given-names></name><name name-style="western"><surname>Moldenhauer</surname><given-names>F</given-names></name><name name-style="western"><surname>Koch</surname><given-names>I</given-names></name><name name-style="western"><surname>Dandekar</surname><given-names>T</given-names></name></person-group>             <year>2002</year>             <article-title>Exploring the pathway structure of metabolism: decomposition into subnetworks and application to Mycoplasma pneumoniae.</article-title>             <source>Bioinformatics</source>             <volume>18</volume>             <fpage>351</fpage>             <lpage>361</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002262-Zhao1">
        <label>14</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Zhao</surname><given-names>J</given-names></name><name name-style="western"><surname>Yu</surname><given-names>H</given-names></name><name name-style="western"><surname>Luo</surname><given-names>JH</given-names></name><name name-style="western"><surname>Cao</surname><given-names>ZW</given-names></name><name name-style="western"><surname>Li</surname><given-names>YX</given-names></name></person-group>             <year>2006</year>             <article-title>Hierarchical modularity of nested bow-ties in metabolic networks.</article-title>             <source>BMC bioinformatics</source>             <volume>7</volume>             <fpage>386</fpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002262-SaezRodriguez1">
        <label>15</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Saez-Rodriguez</surname><given-names>J</given-names></name><name name-style="western"><surname>Gayer</surname><given-names>S</given-names></name><name name-style="western"><surname>Ginkel</surname><given-names>M</given-names></name><name name-style="western"><surname>Gilles</surname><given-names>ED</given-names></name></person-group>             <year>2008</year>             <article-title>Automatic decomposition of kinetic models of signaling networks minimizing the retroactivity among modules.</article-title>             <source>Bioinformatics</source>             <volume>24</volume>             <fpage>i213</fpage>             <lpage>219</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002262-Kitano1">
        <label>16</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Kitano</surname><given-names>H</given-names></name></person-group>             <year>2004</year>             <article-title>Biological robustness.</article-title>             <source>Nat Rev Genet</source>             <volume>5</volume>             <fpage>826</fpage>             <lpage>837</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002262-Stelling1">
        <label>17</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Stelling</surname><given-names>J</given-names></name><name name-style="western"><surname>Sauer</surname><given-names>U</given-names></name><name name-style="western"><surname>Szallasi</surname><given-names>Z</given-names></name><name name-style="western"><surname>Doyle</surname><given-names>FJ</given-names><suffix>3rd</suffix></name><name name-style="western"><surname>Doyle</surname><given-names>J</given-names></name></person-group>             <year>2004</year>             <article-title>Robustness of cellular functions.</article-title>             <source>Cell</source>             <volume>118</volume>             <fpage>675</fpage>             <lpage>685</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002262-Newman1">
        <label>18</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Newman</surname><given-names>ME</given-names></name></person-group>             <year>2006</year>             <article-title>Modularity and community structure in networks.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>103</volume>             <fpage>8577</fpage>             <lpage>8582</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002262-Oda1">
        <label>19</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Oda</surname><given-names>K</given-names></name><name name-style="western"><surname>Matsuoka</surname><given-names>Y</given-names></name><name name-style="western"><surname>Funahashi</surname><given-names>A</given-names></name><name name-style="western"><surname>Kitano</surname><given-names>H</given-names></name></person-group>             <year>2005</year>             <article-title>A comprehensive pathway map of epidermal growth factor receptor signaling.</article-title>             <source>Mol Syst Biol</source>             <volume>1</volume>             <fpage>2005 0010</fpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002262-Ma1">
        <label>20</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Ma</surname><given-names>HW</given-names></name><name name-style="western"><surname>Zhao</surname><given-names>XM</given-names></name><name name-style="western"><surname>Yuan</surname><given-names>YJ</given-names></name><name name-style="western"><surname>Zeng</surname><given-names>AP</given-names></name></person-group>             <year>2004</year>             <article-title>Decomposition of metabolic network into functional modules based on the global connectivity structure of reaction graph.</article-title>             <source>Bioinformatics</source>             <volume>20</volume>             <fpage>1870</fpage>             <lpage>1876</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002262-Gille1">
        <label>21</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Gille</surname><given-names>C</given-names></name><name name-style="western"><surname>Bolling</surname><given-names>C</given-names></name><name name-style="western"><surname>Hoppe</surname><given-names>A</given-names></name><name name-style="western"><surname>Bulik</surname><given-names>S</given-names></name><name name-style="western"><surname>Hoffmann</surname><given-names>S</given-names></name><etal/></person-group>             <year>2010</year>             <article-title>HepatoNet1: a comprehensive metabolic reconstruction of the human hepatocyte for the analysis of liver physiology.</article-title>             <source>Mol Syst Biol</source>             <volume>6</volume>             <fpage>411</fpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002262-Holme1">
        <label>22</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Holme</surname><given-names>P</given-names></name></person-group>             <year>2009</year>             <article-title>Model validation of simple-graph representations of metabolism.</article-title>             <source>J R Soc Interface</source>             <volume>6</volume>             <fpage>1027</fpage>             <lpage>1034</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002262-Floyd1">
        <label>23</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Floyd</surname><given-names>RW</given-names></name></person-group>             <year>1962</year>             <article-title>Algorithm-97 - Shortest Path.</article-title>             <source>Commun Acm</source>             <volume>5</volume>             <fpage>345</fpage>             <lpage>345</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002262-Cormen1">
        <label>24</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Cormen</surname><given-names>TH</given-names></name></person-group>             <year>2009</year>             <source>Introduction to algorithms</source>             <publisher-loc>Cambridge, , Mass.</publisher-loc>             <publisher-name>MIT Press</publisher-name> <comment>xix, 1292</comment>           </element-citation>
      </ref>
      <ref id="pcbi.1002262-Pothen1">
        <label>25</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Pothen</surname><given-names>A</given-names></name><name name-style="western"><surname>Simon</surname><given-names>HD</given-names></name><name name-style="western"><surname>Liou</surname><given-names>KP</given-names></name></person-group>             <year>1990</year>             <article-title>Partitioning Sparse Matrices with Eigenvectors of Graphs.</article-title>             <source>Siam J Matrix Anal A</source>             <volume>11</volume>             <fpage>430</fpage>             <lpage>452</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002262-Kahn1">
        <label>26</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Kahn</surname><given-names>AB</given-names></name></person-group>             <year>1962</year>             <article-title>Topological Sorting of Large Networks.</article-title>             <source>Commun Acm</source>             <volume>5</volume>             <fpage>558</fpage>             <lpage>562</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002262-Johnson1">
        <label>27</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Johnson</surname><given-names>DB</given-names></name></person-group>             <year>1977</year>             <article-title>Efficient Algorithms for Shortest Paths in Sparse Networks.</article-title>             <source>J Acm</source>             <volume>24</volume>             <fpage>1</fpage>             <lpage>13</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002262-Lehninger1">
        <label>28</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Lehninger</surname><given-names>AL</given-names></name><name name-style="western"><surname>Nelson</surname><given-names>DL</given-names></name><name name-style="western"><surname>Cox</surname><given-names>MM</given-names></name></person-group>             <year>2005</year>             <source>Lehninger principles of biochemistry</source>             <publisher-loc>New York</publisher-loc>             <publisher-name>W.H. Freeman</publisher-name>          </element-citation>
      </ref>
    </ref-list>
    
  </back>
</article>