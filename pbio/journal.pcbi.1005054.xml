<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article article-type="research-article" dtd-version="1.1d3" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-16-00610</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1005054</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Neural networks</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neural networks</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Surgical and invasive medical procedures</subject><subj-group><subject>Functional electrical stimulation</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Membrane potential</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Membrane potential</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Neurons</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cellular neuroscience</subject><subj-group><subject>Neurons</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cognitive science</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Learning</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Learning</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Social sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Learning</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Learning and memory</subject><subj-group><subject>Learning</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Probability theory</subject><subj-group><subject>Probability distribution</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Optimization</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cognitive science</subject><subj-group><subject>Artificial intelligence</subject><subj-group><subject>Machine learning</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Artificial intelligence</subject><subj-group><subject>Machine learning</subject></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Autonomous Optimization of Targeted Stimulation of Neuronal Networks</article-title>
<alt-title alt-title-type="running-head">Autonomous Optimization of Targeted Stimulation of Neuronal Networks</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Kumar</surname> <given-names>Sreedhar S.</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Wülfing</surname> <given-names>Jan</given-names></name>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Okujeni</surname> <given-names>Samora</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Boedecker</surname> <given-names>Joschka</given-names></name>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Riedmiller</surname> <given-names>Martin</given-names></name>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
<xref ref-type="fn" rid="currentaff001"><sup>¤</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-4583-0425</contrib-id>
<name name-style="western">
<surname>Egert</surname> <given-names>Ulrich</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Laboratory of Biomicrotechnology, IMTEK - Department of Microsystems Engineering, University of Freiburg, Freiburg, Germany</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Bernstein Center Freiburg, University of Freiburg, Freiburg, Germany</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>Machine Learning Lab, Department of Computer Science, University of Freiburg, Freiburg, Germany</addr-line>
</aff>
<aff id="aff004">
<label>4</label>
<addr-line>BrainLinks-BrainTools Cluster of Excellence, University of Freiburg, Freiburg, Germany</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Jbabdi</surname> <given-names>Saad</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Oxford University, UNITED KINGDOM</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con">
<p>
<list list-type="simple">
<list-item><p><bold>Conceived and designed the experiments:</bold> SK UE MR JW JB.</p></list-item>
<list-item><p><bold>Performed the experiments:</bold> SK JW SO.</p></list-item>
<list-item><p><bold>Analyzed the data:</bold> SK JW.</p></list-item>
<list-item><p><bold>Contributed reagents/materials/analysis tools:</bold> SO MR.</p></list-item>
<list-item><p><bold>Wrote the paper:</bold> SK UE JW JB.</p></list-item>
<list-item><p>Designed the software used in analysis: SK JW.</p></list-item></list></p>
</fn>
<fn fn-type="current-aff" id="currentaff001">
<label>¤</label> <p>Current address: Google DeepMind, London, United Kingdom</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">egert@imtek.uni-freiburg.de</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>8</month>
<year>2016</year>
</pub-date>
<pub-date pub-type="epub">
<day>10</day>
<month>8</month>
<year>2016</year>
</pub-date>
<volume>12</volume>
<issue>8</issue>
<elocation-id>e1005054</elocation-id>
<history>
<date date-type="received">
<day>15</day>
<month>4</month>
<year>2016</year>
</date>
<date date-type="accepted">
<day>9</day>
<month>7</month>
<year>2016</year>
</date>
</history>
<permissions>
<copyright-year>2016</copyright-year>
<copyright-holder>Kumar et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1005054"/>
<abstract>
<p>Driven by clinical needs and progress in neurotechnology, targeted interaction with neuronal networks is of increasing importance. Yet, the dynamics of interaction between intrinsic ongoing activity in neuronal networks and their response to stimulation is unknown. Nonetheless, electrical stimulation of the brain is increasingly explored as a therapeutic strategy and as a means to artificially inject information into neural circuits. Strategies using regular or event-triggered fixed stimuli discount the influence of ongoing neuronal activity on the stimulation outcome and are therefore not optimal to induce specific responses reliably. Yet, without suitable mechanistic models, it is hardly possible to optimize such interactions, in particular when desired response features are network-dependent and are initially unknown. In this proof-of-principle study, we present an experimental paradigm using reinforcement-learning (RL) to optimize stimulus settings autonomously and evaluate the learned control strategy using phenomenological models. We asked how to (1) capture the interaction of ongoing network activity, electrical stimulation and evoked responses in a quantifiable ‘state’ to formulate a well-posed control problem, (2) find the optimal state for stimulation, and (3) evaluate the quality of the solution found. Electrical stimulation of generic neuronal networks grown from rat cortical tissue <italic>in vitro</italic> evoked bursts of action potentials (responses). We show that the dynamic interplay of their magnitudes and the probability to be intercepted by spontaneous events defines a trade-off scenario with a network-specific unique optimal latency maximizing stimulus efficacy. An RL controller was set to find this optimum autonomously. Across networks, stimulation efficacy increased in 90% of the sessions after learning and learned latencies strongly agreed with those predicted from open-loop experiments. Our results show that autonomous techniques can exploit quantitative relationships underlying activity-response interaction in biological neuronal networks to choose optimal actions. Simple phenomenological models can be useful to validate the quality of the resulting controllers.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>Electrical stimulation of the brain is increasingly used to alleviate the symptoms of a range of neurological disorders and as a means to artificially inject information into neural circuits in neuroprosthetic applications. Machine learning has been proposed to find optimal stimulation settings autonomously. However, this approach is impeded by the complexity of the interaction between the stimulus and the activity of the network, which makes it difficult to test how good the result actually is. We used phenomenological models of the interaction between stimulus and spontaneous activity in a neuronal network to design a testable machine learning challenge and evaluate the quality of the solution found by the algorithm. In this task, the learning algorithm had to find a solution that balances competing interdependencies of ongoing neuronal activity with opposing effects on the efficacy of stimulation. We show that machine learning can successfully solve this task and that the solutions found are close to the optimal settings to maximize the efficacy of stimulation. Since the paradigm involves several typical problems found in other settings, such concepts could help to formalize machine learning problems in more complex biological networks and to test the quality of their performance.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution>Bundesministerium für Bildung und Forschung (DE)</institution>
</funding-source>
<award-id>Bernstein Focus Neurotechnology Freiburg-Tübingen 01GQ0830</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-4583-0425</contrib-id>
<name name-style="western">
<surname>Egert</surname> <given-names>Ulrich</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001659</institution-id>
<institution>Deutsche Forschungsgemeinschaft</institution>
</institution-wrap>
</funding-source>
<award-id>Brain-Links-BrainTools Cluster of Excellence (EXC 1086)</award-id>
</award-group>
<funding-statement>This work was supported by the Bundesministerium für Bildung und Forschung, Germany (<ext-link ext-link-type="uri" xlink:href="https://www.bmbf.de" xlink:type="simple">https://www.bmbf.de</ext-link>, FKZ 01GQ0830 - Bernstein Focus Neurotechnology Freiburg-Tübingen; UE) and by the German Research Foundation through the Brain-Links-BrainTools Cluster of Excellence (DFG, EXC 1086, <ext-link ext-link-type="uri" xlink:href="http://www.dfg.de" xlink:type="simple">www.dfg.de</ext-link>; UE, MR). Article processing charges were funded by the DFG and the University of Freiburg (Open Access Publishing program). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="8"/>
<table-count count="0"/>
<page-count count="22"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>Data are deposited in the University of Freiburg institutional data repository at <ext-link ext-link-type="uri" xlink:href="https://www.freidok.uni-freiburg.de/data/11107" xlink:type="simple">https://www.freidok.uni-freiburg.de/data/11107</ext-link> (DOI: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.6094/UNIFR/11107" xlink:type="simple">10.6094/UNIFR/11107</ext-link>).</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Electrical stimulation of the brain is considered an effective strategy to manage the symptoms of an increasing range of neurological disorders like essential tremor [<xref ref-type="bibr" rid="pcbi.1005054.ref001">1</xref>, <xref ref-type="bibr" rid="pcbi.1005054.ref002">2</xref>], dystonia [<xref ref-type="bibr" rid="pcbi.1005054.ref003">3</xref>] and Parkinson’s disease (PD) [<xref ref-type="bibr" rid="pcbi.1005054.ref004">4</xref>–<xref ref-type="bibr" rid="pcbi.1005054.ref007">7</xref>], and as a possible means to artificially inject information into neural circuits, e.g. towards neurotechnical prostheses with sensory feedback [<xref ref-type="bibr" rid="pcbi.1005054.ref008">8</xref>]. The response elicited, however, typically results from interaction of the stimulus with uncontrolled ongoing neuronal activity. The changes of neuronal activity induced by the stimulus are thus not only added to the continuing dynamics of neuronal activity but may be modulated by it. Under these circumstances, using constant stimulation would elicit very different responses in each trial [<xref ref-type="bibr" rid="pcbi.1005054.ref009">9</xref>, <xref ref-type="bibr" rid="pcbi.1005054.ref010">10</xref>] and is therefore unsuitable to induce defined response features. To achieve stable responses, or to modulate them predictably, stimulation settings would need to adapt to the dynamics of the brain’s activity.</p>
<p>Without suitable models to capture the interaction between stimulus and ongoing activity and to characterize the underlying network mode, it is not possible to adjust stimulation such that a desired response is consistently achieved. Biologically mechanistic and analytically tractable models are, however, challenging to develop for a variety of reasons: Interactions may be non-linear, and may depend on network modes, on the dynamics of individual neurons and other factors [<xref ref-type="bibr" rid="pcbi.1005054.ref011">11</xref>–<xref ref-type="bibr" rid="pcbi.1005054.ref013">13</xref>]. Experiments in <italic>in vivo</italic> model systems show that the measured response of a network is strongly modulated by its state at the time of stimulation [<xref ref-type="bibr" rid="pcbi.1005054.ref014">14</xref>, <xref ref-type="bibr" rid="pcbi.1005054.ref015">15</xref>]. Network states are, however, problematic to define explicitly because of the non-stationary nature of activity dynamics, uncertainty about the relevant spatial and temporal scales of influence and partial observability of the system. They are typically identified in retrospect. To illustrate this, consider UP and DOWN states observed in the neocortex [<xref ref-type="bibr" rid="pcbi.1005054.ref016">16</xref>–<xref ref-type="bibr" rid="pcbi.1005054.ref018">18</xref>] as network modes. The UP (resp. DOWN) state can be quite clearly identified based on intracellular recordings of the membrane potential and spike activity. Based on extracellular recordings of spikes alone, however, it would not be known during an inter-spike interval if the network had already transitioned to the DOWN (resp. UP) state at the time of stimulation. The momentary state of the network would be invisible, thus making it difficult to adjust stimulus settings online. Repetitive stimulation may even lead to interaction between responses. Furthermore, as studies <italic>in vitro</italic> suggest, this influence may affect responses across several scales of organization, from individual neurons [<xref ref-type="bibr" rid="pcbi.1005054.ref019">19</xref>] to networks [<xref ref-type="bibr" rid="pcbi.1005054.ref020">20</xref>, <xref ref-type="bibr" rid="pcbi.1005054.ref021">21</xref>].</p>
<p>Despite the challenges, promising results from recent studies even with simple feedback strategies make a compelling case for closed-loop neurostimulation devices. Experiments on a primate model of PD indicated that even simple adaptive methods were superior to conventional open-loop Deep Brain Stimulation (DBS) [<xref ref-type="bibr" rid="pcbi.1005054.ref022">22</xref>]. Furthermore, the first report of event-driven DBS on human patients with PD [<xref ref-type="bibr" rid="pcbi.1005054.ref023">23</xref>] demonstrated an improvement in symptoms compared to standard DBS, with a simultaneous reduction in stimulation time. Such event-driven paradigms monitor a pre-determined indicator function in the spontaneous activity. In the most simple version, these indicators trigger fixed stimuli [<xref ref-type="bibr" rid="pcbi.1005054.ref022">22</xref>, <xref ref-type="bibr" rid="pcbi.1005054.ref023">23</xref>] but do not modify the stimulus parameters as such. Where the quantitative input-output relations are known, predefined controllers could be successful. Keren and Marom [<xref ref-type="bibr" rid="pcbi.1005054.ref021">21</xref>], for example, achieved stable response probabilities with a PI controller to adjust the stimulus based on responses elicited by previous stimuli since, under the conditions selected, the input-output dependence was nearly linear.</p>
<p>Because of a lack of quantitative models that could be used to predict the ideal stimulus settings for the systems studied, the notion of optimality does not exist in these stimulation paradigms. Further, the nature of the problem in these examples was such that it was possible to define a singular target value a priori, i.e. to stop oscillatory activity [<xref ref-type="bibr" rid="pcbi.1005054.ref022">22</xref>] or to achieve a quantitatively predefined response feature, here, a fixed probability for a response [<xref ref-type="bibr" rid="pcbi.1005054.ref021">21</xref>]. When the quantitative value of the target response cannot be clearly defined, is intrinsically variable, or where multiple interacting objectives have to be balanced, e.g. a cost function exists, these approaches cannot be applied. To address such problems, we propose a reinforcement learning (RL) based closed-loop paradigm to autonomously choose optimal control policies without the need for a model of the system and its interaction with electrical stimulation.</p>
<p>The objective of this paper is to demonstrate in a proof-of-principle study how an RL based controller may be used to autonomously adjust stimulus settings to maximize stimulus efficacy in interaction with a generic network of neurons. The approach poses the following questions: (1) How to represent the interaction of network activity, stimulus and response as a quantifiable ‘state’ so that a well posed control problem may be formulated for variable conditions without predefining a singular target value, (2) how to find the optimal state for stimulation autonomously, (3) how to evaluate the quality of the solution found.</p>
<p>To develop the concept and techniques, we employed generic neuronal networks <italic>in vitro</italic> on substrate integrated microelectrode arrays as a model system. Previous studies offer a partial understanding of the dynamics in such networks and of the rules governing their interaction with electrical stimuli [<xref ref-type="bibr" rid="pcbi.1005054.ref020">20</xref>], which allowed us to test for the quality of the solutions found by an RL-based controller.</p>
<p>Neuronal networks in cell culture exhibit activity characterized by intermittent network-wide spontaneous bursts (SB), separated by periods of reduced activity. Electrical stimulation of the network also evokes bursts of action potentials (responses). Response strengths depend on the stimulus latency relative to the previous SB, and can be described by a saturating exponential model [<xref ref-type="bibr" rid="pcbi.1005054.ref020">20</xref>]. For this system we thus posed the following optimization problem: find the stimulus latency that would maximize the stimulation efficacy measured as the number of spikes evoked per SB in the face of ongoing network activity. The achievable efficacy is thus not known a priori and further properties of the network may be relevant to its value, i.e. dependencies may be incompletely captured in the model. According to [<xref ref-type="bibr" rid="pcbi.1005054.ref020">20</xref>], choosing longer latencies to stimulate ensure that longer responses are evoked, but are more prone to interruption by the next SB and thereby affects stimulation efficacy adversely by losing out on opportunities to stimulate. Choosing shorter latencies, on the other hand, ensures that stimuli are delivered more often without interruption by SBs, but at the cost of evoking weaker responses. To maximize stimulation efficacy in this context, we thus need to balance the trade-off between these opposing strategies. In this study, we asked if an RL based controller can autonomously find the ideal balance in this trade-off and identify the optimal stimulus latency.</p>
<p>The control problem thus formulated has several interesting features that make it pertinent to the problem at hand. To find the optimal time, a controller would have to reconcile the dynamic interplay of multiple biological processes, namely: a) the initiation of synchronous SBs in the network, b) recovery of the network excitability after SB termination, and c) the overall level of excitability of the network.</p>
<p>The controller has also to account for the modulation of system dynamics over a broad-range of time-scales. Furthermore, though these networks are similar w.r.t. statistical properties, every network has distinct dynamic features and unique connectivity. The controller thus needs to be able to operate robustly over a range of activity modes. Out of a high dimensional spatial and temporal feature space available in the recording, a relevant low dimensional quantitative state feature has to be abstracted and a strategy to converge toward optimal performance worked out. For these reasons, we argue that this toy problem captures many of the relevant challenges faced by closed-loop paradigms in biological frameworks and by RL based controllers in a complex adaptive environment. Finally, drawing on simple quantitative notions from previous studies, we computed network-specific optimal stimulation latencies [<xref ref-type="bibr" rid="pcbi.1005054.ref020">20</xref>] from open-loop data to independently validate the optimality of the learned controller. We observed that the learned stimulation latencies and achieved stimulation efficacies correlate strongly with the offline optimal values estimated for these networks.</p>
<p>Our results demonstrate the capacity of autonomous techniques to exploit underlying quantitative relationships in neurotechnical interaction with neuronal networks to choose optimal actions and illustrate how phenomenological models can be used to help formulate the RL problem and validate the performance of the resulting controllers.</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Materials and Methods</title>
<sec id="sec003">
<title>Model system</title>
<p>The dynamics of neuronal activity <italic>in vivo</italic> is dependent on a multitude of factors including and not limited to cross-structural influences and specific anatomy and connectivity of the region of interest. Biological complexity in this scale makes it difficult to glean a consistent understanding of signal relationships between the network and an external stimulus, a crucial step in developing feedback control techniques [<xref ref-type="bibr" rid="pcbi.1005054.ref024">24</xref>]. In order to develop our concepts and algorithms, we used a model that while being generic and independent of specific functions and/or modalities preserves the biophysical complexity of the neuronal ensemble and relevant challenges an autonomous controller would face in a more complex context.</p>
<p>Neuronal networks grown on substrate integrated microelectrode arrays are a suitable model in that they are easily accessible generic neuronal networks that can be maintained in a controlled environment, exhibit spontaneous activity known to influence the network’s interaction with external stimuli, and are known to operate in distinct network modes across a wide-range of time scales. Furthermore controlling such biological neuronal networks poses many interesting challenges for research in RL such as potentially high dimensional state spaces, continuous action spaces and non-stationary dynamics.</p>
<p>Frontal cortical tissue was dissected from newborn Wistar rats (obtained from the breeding facilities of the University of Freiburg) after decapitation, enzymatically dissociated, and cultured on polyethyleneimine (Sigma-Aldrich, St. Louis, MO)-coated microelectrode arrays (MEAs; Multi Channel Systems, Reutlingen, Germany). The culture medium (1 ml) consisted of minimal essential medium supplemented with 5% heat-inactivated horse serum, 0.5 mM L-glutamine, and 20 mM glucose (all compounds from Gibco Invitrogen, Life Technologies, Grand Island, NY). Cultures were stored in a humidified atmosphere at 37°C and 5% CO<sub>2</sub>—95% air. Medium was partially replaced twice per week. Neuronal density after the first day <italic>in vitro</italic> (DIV) ranged between 1500 and 4000 neurons/mm<sup>2</sup>. The final density after 21 DIV settled at 1500–2000 neurons/mm<sup>2</sup>, independent of the initial density. At the time of recording, network size thus amounted to 5 − 6 × 10<sup>5</sup> neurons. Animal treatment was according to the Freiburg University (Freiburg, Germany) and German guidelines on the use of animals in research. The protocol was approved by the Regierungspräsidium Freiburg and the BioMed Zentrum, University Clinic Freiburg (permit nos. X-12/08D and X-15/01H).</p>
</sec>
<sec id="sec004">
<title>Electrophysiology</title>
<p>Neuronal activity was recorded inside a dry incubator with MEAs with 59 titanium nitride (TiN) electrodes of 30 μm diameter and 500 μm pitch (rectangular 6x10 grid). One larger electrode served as reference. The primary signal was amplified (gain 1100, 1–3500 Hz) and sampled at 25 kHz/12 bit (MEA 1060-BC; Multi Channel Systems). Online spike detection was done with MEABench (version 1.1.4) [<xref ref-type="bibr" rid="pcbi.1005054.ref025">25</xref>] at six to eightfold root mean square noise level for spike threshold.</p>
<p>Such networks of dissociated neurons <italic>in vitro</italic> exhibit spontaneous activity characterized by intermittent network-wide synchronous bursts separated by periods of reduced activity. Inter-burst intervals (IBI) in these networks fit an approximate lognormal distribution. Stimulating the network also evokes bursts of action potentials (response). The length of these responses at a chosen recording electrode can be modulated by the latency of the stimuli relative to the SB at that channel. Their relationship was shown by [<xref ref-type="bibr" rid="pcbi.1005054.ref020">20</xref>] to fit a saturating exponential model.</p>
</sec>
<sec id="sec005">
<title>Trade-off problem</title>
<p>The optimization problem was defined as the following: what is the optimal stimulus latency relative to the end of the previous SB at a selected recording electrode (RE) that would maximize the number of spikes evoked at that site per SB? To illustrate the problem, consider the following opposing strategies: A) choosing a long latency: Based on the saturating recovery model, longer latencies would elicit to longer responses (<xref ref-type="fig" rid="pcbi.1005054.g001">Fig 1</xref>). However, such a strategy would prove futile in the long run; long latencies are prone to interruptions by succeeding SBs and opportunities to stimulate will be forfeited. This would lower the count of evoked spikes per SB. B) choosing short latencies: this strategy would ensure that stimuli are delivered more often, but at the cost of evoking shorter responses. Optimization involves finding the trade-off between these opposing strategies. We asked that an RL based controller autonomously find the optimal time for stimulation to balance this trade-off for individual biological networks based only on the activity at the RE.</p>
<fig id="pcbi.1005054.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005054.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Stimulating the network at an electrode evokes a burst of activity. Response strengths were dependent on the period of inactivity preceding the stimulus.</title>
<p>(A) Raster shows responses at one chosen recording channel in a network to 50 stimuli at the same electrode. Stimuli were delivered periodically, and thus at random latencies relative to the previous SB. Stimulation cycled through five pre-selected electrodes at 10 s intervals. Stimulus properties: -0.7 V, 0.4 ms, monophasic against common ground. Trials were aligned to the time of stimulation (red line) and sorted by the count of spikes within the designated response window (see magenta overlay). A response window of 2 s was chosen for this network. The diagram exposes the relationship of response strengths to the period of prior inactivity. The first 200 ms post-stimulus is zoomed in panel (B). Responses typically consisted of an early (≤ 20 ms post-stimulus) and late (≥ 50 ms post-stimulus) component. (C) The relationship between response strengths and periods of prior inactivity can be captured in a saturating exponential model similar to the dependency of response length [<xref ref-type="bibr" rid="pcbi.1005054.ref020">20</xref>].</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005054.g001" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec006">
<title>Experimental procedure</title>
<p>Experiments were performed on 20 networks between day <italic>in vitro</italic> (DIV) 19 and 35 (‘network’ denotes a culture at a specific point in time). Each experiment began with one hour of recording spontaneous activity, from which bursts were detected offline. A statistical model of SB occurrence was estimated by fitting a lognormal function to the IBI distribution to extract the location and scale parameters (<italic>μ</italic> and <italic>σ</italic> respectively).</p>
<sec id="sec007">
<title>Selection of stimulation and evaluation ssites</title>
<p>Spontaneous data were further analyzed to identify MEA electrodes that would serve as sites of stimulation and of evaluation of the responses. As candidate stimulation electrodes (SE) we selected sites that were more likely to participate early in SBs [<xref ref-type="bibr" rid="pcbi.1005054.ref020">20</xref>]. This procedure identified the so-called “major burst leaders” [<xref ref-type="bibr" rid="pcbi.1005054.ref026">26</xref>, <xref ref-type="bibr" rid="pcbi.1005054.ref027">27</xref>]. For open-loop stimulation, monophasic, negative voltage pulses of 400 μs width and 0.7 V amplitude were delivered at candidate SEs at 0.1 Hz. Final SE and RE pairs were typically selected based on peri-stimulus time histograms (PSTH) from positions with responses consisting of both early (≤ 25 ms) and late (≥ 50 ms) components.</p>
</sec>
<sec id="sec008">
<title>Response strength</title>
<p>Following the choice of SE and RE we identified the dependence of response strengths on the periods of inactivity preceding stimuli for a given network. The number of spikes at the recording channel in a 500 ms window following a stimulus was typically defined as the response strength (RS). This data was used to estimate the parameters <italic>A</italic>, <italic>B</italic> and <italic>λ</italic> of the recovery model by least square fitting.</p>
</sec>
<sec id="sec009">
<title>Closed-loop stimulation</title>
<p>Closed-loop episodic learning sessions were performed using RE and SE positions identified as above. The controller was designed to learn in episodes that commenced at the termination of each SB (<xref ref-type="fig" rid="pcbi.1005054.g002">Fig 2A and 2B</xref>). The closed-loop architecture was realized by interfacing the data acquisition software (MEABench) with the closed-loop control software, CLS<sup>2</sup> (Closed-loop Simulation System, <xref ref-type="fig" rid="pcbi.1005054.g002">Fig 2C</xref>). Learning sessions proceeded in alternating training and testing rounds. During training, the controller was free to explore the state-action space and learn a control law using the RL algorithm described in the following section, while during testing it always behaved optimally based on the knowledge hitherto acquired. Subsequent to the closed-loop session, spontaneous activity was recorded for one hour to check for non-stationarity in the IBI distribution. The stimulus properties were as during open-loop stimulation.</p>
<fig id="pcbi.1005054.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005054.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Stimulation trials and the closed-loop architecture.</title>
<p>(A) A trial started with the end of a spontaneous burst (SB). The trial was terminated either by the next SB (dotted box) or a stimulation. In our paradigm, reward was defined as the number of spikes in the response. Interruptions by SBs led to neutral rewards (punishment). (B) The time within each trial was discretized into 0.5 s steps, corresponding to states 1, …, <italic>N</italic>. At each state, the controller could choose between two actions: to wait or to stimulate. A ‘stimulate’ action led to one of the terminal states <italic>T</italic><sub><italic>i</italic></sub>, with <italic>i</italic> indicating the strength of the response. Terminal state <italic>F</italic> was reached if the trial was interrupted by ongoing activity. (C) Schematic visualization of the closed-loop architecture.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005054.g002" xlink:type="simple"/>
</fig>
</sec>
</sec>
<sec id="sec010">
<title>Reinforcement learning</title>
<p>Learning a controller for a given task with RL requires formalizing it as a Markov Decision Process (MDP). An MDP is defined as a five-tuple (<inline-formula id="pcbi.1005054.e001"><alternatives><graphic id="pcbi.1005054.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005054.e001" xlink:type="simple"/><mml:math display="inline" id="M1"><mml:mi mathvariant="script">S</mml:mi></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1005054.e002"><alternatives><graphic id="pcbi.1005054.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005054.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:mi mathvariant="script">A</mml:mi></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1005054.e003"><alternatives><graphic id="pcbi.1005054.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005054.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:mi mathvariant="script">T</mml:mi></mml:math></alternatives></inline-formula>, <italic>R</italic>, <italic>P</italic>), where <inline-formula id="pcbi.1005054.e004"><alternatives><graphic id="pcbi.1005054.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005054.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:mi mathvariant="script">S</mml:mi></mml:math></alternatives></inline-formula> is a set of states, <inline-formula id="pcbi.1005054.e005"><alternatives><graphic id="pcbi.1005054.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005054.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:mi mathvariant="script">A</mml:mi></mml:math></alternatives></inline-formula> a set of actions and <inline-formula id="pcbi.1005054.e006"><alternatives><graphic id="pcbi.1005054.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005054.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:mi mathvariant="script">T</mml:mi></mml:math></alternatives></inline-formula> a finite set of discrete time points (finite horizon). The reward function <inline-formula id="pcbi.1005054.e007"><alternatives><graphic id="pcbi.1005054.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005054.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:mrow><mml:mi>R</mml:mi> <mml:mo>:</mml:mo> <mml:mi mathvariant="script">S</mml:mi> <mml:mo>×</mml:mo> <mml:mi mathvariant="script">A</mml:mi> <mml:mo>×</mml:mo> <mml:mi mathvariant="script">S</mml:mi> <mml:mo>→</mml:mo> <mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> defines the reward an RL controller receives when it applies action <inline-formula id="pcbi.1005054.e008"><alternatives><graphic id="pcbi.1005054.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005054.e008" xlink:type="simple"/><mml:math display="inline" id="M8"><mml:mrow><mml:msub><mml:mi>a</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>∈</mml:mo> <mml:mi mathvariant="script">A</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> in state <inline-formula id="pcbi.1005054.e009"><alternatives><graphic id="pcbi.1005054.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005054.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:mrow><mml:msub><mml:mi>s</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>∈</mml:mo> <mml:mi mathvariant="script">S</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> and transitions into <inline-formula id="pcbi.1005054.e010"><alternatives><graphic id="pcbi.1005054.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005054.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:mrow><mml:msub><mml:mi>s</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>∈</mml:mo> <mml:mi mathvariant="script">S</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> at time <inline-formula id="pcbi.1005054.e011"><alternatives><graphic id="pcbi.1005054.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005054.e011" xlink:type="simple"/><mml:math display="inline" id="M11"><mml:mrow><mml:mi>t</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="script">T</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>. The probabilistic transition model <italic>P</italic> (<italic>s<sub>t+1</sub> | s<sub>t</sub></italic>, <italic>a<sub>t</sub></italic>) defines the conditional probability of transitioning from state <italic>s</italic><sub><italic>t</italic></sub> to state <italic>s</italic><sub><italic>t</italic>+1</sub> under the action <italic>a</italic><sub><italic>t</italic></sub>. The goal of RL is now to find a control law (policy) <inline-formula id="pcbi.1005054.e012"><alternatives><graphic id="pcbi.1005054.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005054.e012" xlink:type="simple"/><mml:math display="inline" id="M12"><mml:mrow><mml:mi>π</mml:mi> <mml:mo>:</mml:mo> <mml:mi mathvariant="script">S</mml:mi> <mml:mo>→</mml:mo> <mml:mi mathvariant="script">A</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> which maximizes the expected accumulated reward <inline-formula id="pcbi.1005054.e013"><alternatives><graphic id="pcbi.1005054.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005054.e013" xlink:type="simple"/><mml:math display="inline" id="M13"><mml:mrow><mml:msup><mml:mi>V</mml:mi> <mml:mi>π</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi mathvariant="double-struck">E</mml:mi> <mml:mrow><mml:mo>{</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow> <mml:mi>T</mml:mi></mml:msubsup> <mml:mrow><mml:msup><mml:mi>γ</mml:mi> <mml:mi>t</mml:mi></mml:msup> <mml:mi>R</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mi>π</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mo>|</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mi>s</mml:mi> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> where <italic>γ</italic> is a discounting factor on future rewards. Value Iteration is commonly used to find <italic>V</italic> if the transition model <italic>P</italic> is available. Although in this proof-of-concept study a model is available and used to verify the solution found by the RL controller a-posteriori, for biological systems in general we can not assume that a model is known. We therefore consider a model-free setting and use Q-learning [<xref ref-type="bibr" rid="pcbi.1005054.ref028">28</xref>] to learn an action-value function <italic>Q</italic>(<italic>s</italic>, <italic>a</italic>) (<inline-formula id="pcbi.1005054.e014"><alternatives><graphic id="pcbi.1005054.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005054.e014" xlink:type="simple"/><mml:math display="inline" id="M14"><mml:mrow><mml:mi>Q</mml:mi> <mml:mo>:</mml:mo> <mml:mi mathvariant="script">S</mml:mi> <mml:mo>×</mml:mo> <mml:mi mathvariant="script">A</mml:mi> <mml:mo>→</mml:mo> <mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>) which represents the value of choosing action <italic>a</italic> in state <italic>s</italic>. The greedy policy <italic>π</italic> can then be derived as <italic>π</italic>(<italic>s</italic>) = arg max<sub><italic>a</italic></sub> <italic>Q</italic>(<italic>s</italic>, <italic>a</italic>). To apply Q-learning we first have to define the state and action space as well as a suitable reward function.</p>
<sec id="sec011">
<title>State space definition</title>
<p>Our definition of <inline-formula id="pcbi.1005054.e015"><alternatives><graphic id="pcbi.1005054.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005054.e015" xlink:type="simple"/><mml:math display="inline" id="M15"><mml:mi mathvariant="script">S</mml:mi></mml:math></alternatives></inline-formula> is motivated by the following considerations. Solving the trade-off problem involves reconciling the dynamic interplay of the initiation of synchronous SBs in the network and the recovery of network excitability after SB termination. A simple statistical model of the initiation of synchronous SBs is a lognormal function of the period of inactivity between SBs. The cumulative of this distribution indicates the probability of SB initiation as a function of time after the preceding SB (<xref ref-type="disp-formula" rid="pcbi.1005054.e022">Eq 4</xref>). At the same time, recovery can equally be modeled by an exponential function of the time after the end of an SB (<xref ref-type="disp-formula" rid="pcbi.1005054.e023">Eq 5</xref>). Stimulation at a certain latency thus effectively probes the level of recovery at that time. This latency was defined as the quantitative state variable accessible to the learned controller, providing information on the dynamics of both processes. Therefore the time after SB termination is a simple and intuitive choice of a low dimensional state feature. We discretized this latency in 0.5 s steps, corresponding to states 1, …, <italic>N</italic>. These make up the set of states <inline-formula id="pcbi.1005054.e016"><alternatives><graphic id="pcbi.1005054.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005054.e016" xlink:type="simple"/><mml:math display="inline" id="M16"><mml:mi mathvariant="script">S</mml:mi></mml:math></alternatives></inline-formula> together with terminal states that reflect the outcome of the stimulation <italic>T</italic><sub><italic>i</italic></sub> (<italic>i</italic> indicating the response strength) or an “interruption” state <italic>F</italic>.</p>
</sec>
<sec id="sec012">
<title>Reward function</title>
<p>In order to learn the optimal stimulus latency, the controller needs to be appropriately rewarded/punished (<xref ref-type="disp-formula" rid="pcbi.1005054.e018">Eq 1</xref>). In <xref ref-type="fig" rid="pcbi.1005054.g002">Fig 2B</xref>, within an episode, at each state the controller could choose between two actions: to ‘wait’ or to ‘stimulate’ which make up the action set <inline-formula id="pcbi.1005054.e017"><alternatives><graphic id="pcbi.1005054.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005054.e017" xlink:type="simple"/><mml:math display="inline" id="M17"><mml:mi mathvariant="script">A</mml:mi></mml:math></alternatives></inline-formula>. An episode terminated either when a preset maximum number of states (i.e. maximal latency) was reached, an SB occurred or when a ‘stimulate’ action was chosen. After each episode, the controller received a terminal reward proportional to the strength of the evoked response. Alternatively, if an SB had occurred or the maximum number of cycles was reached it received a neutral reward (punishment):
<disp-formula id="pcbi.1005054.e018"><alternatives><graphic id="pcbi.1005054.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005054.e018" xlink:type="simple"/><mml:math display="block" id="M18"><mml:mrow><mml:mi>R</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>a</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfenced close="" open="{" separators=""><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mspace width="4.pt"/><mml:mtext>if</mml:mtext> <mml:mspace width="4.pt"/><mml:msub><mml:mi>s</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi> <mml:mo>∈</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mtext>otherwise</mml:mtext> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mrow></mml:math></alternatives> <label>(1)</label></disp-formula></p>
</sec>
<sec id="sec013">
<title>Q-Learning</title>
<p>As a learning algorithm, we used online Q-learning with a tabular representation of the Q-function. To guarantee full exploration of the state and action space the controller follows a random policy <italic>π</italic><sub>explore</sub> during training that uniformly chooses the state of stimulation. The Q-function is iteratively updated during training sessions as:
<disp-formula id="pcbi.1005054.e019"><alternatives><graphic id="pcbi.1005054.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005054.e019" xlink:type="simple"/><mml:math display="block" id="M19"><mml:mrow><mml:msub><mml:mi>Q</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>a</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>Q</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>a</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>α</mml:mi> <mml:mfenced close="]" open="[" separators=""><mml:mi>R</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>a</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>γ</mml:mi> <mml:munder><mml:mo form="prefix" movablelimits="true">max</mml:mo> <mml:mi>a</mml:mi></mml:munder> <mml:msub><mml:mi>Q</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:mi>a</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msub><mml:mi>Q</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>a</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mfenced> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
where we set the learning rate to <italic>α</italic> = 0.5 and use no discounting (<italic>γ</italic> = 1) since we consider a finite horizon problem. During testing sessions the controller follows a greedy policy (<xref ref-type="disp-formula" rid="pcbi.1005054.e020">Eq 2</xref>) without exploration:
<disp-formula id="pcbi.1005054.e020"><alternatives><graphic id="pcbi.1005054.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005054.e020" xlink:type="simple"/><mml:math display="block" id="M20"><mml:mrow><mml:mi>π</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo form="prefix">arg max</mml:mo> <mml:mi>a</mml:mi></mml:munder> <mml:mi>Q</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>,</mml:mo> <mml:mi>a</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(2)</label></disp-formula></p>
</sec>
</sec>
<sec id="sec014">
<title>Data analysis</title>
<p>Offline burst detection was performed for spontaneous data using the following algorithm: For spikes recorded from each electrode: a) interspike interval (ISI) had to be ≤ 100 ms, b) an interval ≤200 ms was allowed at the end of a burst and defined the minimal IBI, and c) the minimum number of spikes in a burst was set to three. Furthermore, at least three recording sites had to have burst onsets within 100 ms, and only one larger onset interval ≤200 ms was allowed [<xref ref-type="bibr" rid="pcbi.1005054.ref020">20</xref>].</p>
<p>For online burst detection at a single chosen channel, an individual ISI threshold was defined for each network based on spontaneous activity at the channel of interest prior to the closed-loop session. The ISI distribution of spontaneous activity was typically bimodal, with a strong first peak corresponding to ISI within SBs and a second peak for the intervals between bursts. The minimum between the intra- and inter-burst intervals was chosen as the threshold. The minimum number of spikes in a burst was set to three.</p>
<p>Parameters extracted from the fitting procedures were used to compute <italic>t</italic>*, the open-loop parametric estimate of the optimal latency (Eqs <xref ref-type="disp-formula" rid="pcbi.1005054.e021">3</xref>–<xref ref-type="disp-formula" rid="pcbi.1005054.e026">7</xref>). To compare the predicted and realized improvement in stimulation efficacy after learning we estimated the stimulation efficacy of a strategy using random stimulation latencies taken from the objective function as the baseline model. The efficacy of this strategy corresponds to the mean of the objective function of each network.</p>
</sec>
</sec>
<sec id="sec015" sec-type="results">
<title>Results</title>
<p>To analyze the performance of closed-loop autonomous control systems for neurotechnical interaction with neuronal networks we designed a reduced model system that captures several general aspects of the problem setting. Networks of cortical neurons in culture develop robust spontaneous activity that influence the outcome of stimulation in non-trivial ways. In addition, this activity exhibits non-stationarities that any control system needs to cope with. We further defined a target function whose quantity was not known to the control system a priori but needed to be identified autonomously. State and action space were restricted to keep the dimensionality of the paradigm low and allow quantitative validation of the optimization problem.</p>
<sec id="sec016">
<title>Properties of spontaneous network activity and response to electrical stimulation</title>
<p>Neuronal networks cultured on MEAs display spontaneous activity that consists of synchronized network-wide spontaneous bursts (SB) separated by periods of inactivity. Burst-lengths ranged between hundreds of milliseconds to few seconds. SBs were detected using an algorithm that combined an inter-spike-interval threshold and the number of simultaneously active sites (<xref ref-type="fig" rid="pcbi.1005054.g003">Fig 3A</xref>). Inter-burst-intervals (IBIs) were approximately lognormal distributed (<xref ref-type="fig" rid="pcbi.1005054.g003">Fig 3B</xref>). Fitting algorithms yielded the location and scale parameters (<italic>μ</italic> and <italic>σ</italic>) of the corresponding lognormal distribution. The cumulative of this distribution was used to estimate the probability of another SB occurring given the period of inactivity that elapsed—or what we term the ‘probability of interruption’ following an SB (<xref ref-type="fig" rid="pcbi.1005054.g003">Fig 3B</xref>, red line).</p>
<fig id="pcbi.1005054.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005054.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Identification of network specific objective functions.</title>
<p>(A) Networks of dissociated neurons <italic>in vitro</italic> exhibit activity characterized by intermittent network-wide spontaneous bursts (SB) separated by periods of reduced activity (raster plot for 60 channels in a DIV 27 network). The shading marks the limits of individual SBs as detected by the burst-detection algorithm. (B) The distribution of Inter-Burst Intervals (IBIs) is approximately lognormal. The histogram shows the IBI distribution for the network in (A). The cumulative of this distribution (red) is predictive of the probability of being interrupted by ongoing activity given the elapsed period of inactivity, i.e. the current state <italic>s</italic><sub><italic>t</italic></sub>. (C) Such a distribution was used to weight response strengths so that each dot represents the mean response strengths that can be evoked over a set of trials, including those that did not lead to stimulation, for a given stimulation latency. The fit predicts the objective function of the optimization problem. The example shows the data for the network shown in <xref ref-type="fig" rid="pcbi.1005054.g001">Fig 1C</xref>. The curve reveals a quasiconcave dependency, a unique global maximum and an optimal latency of ≈ 2.5 s in this network. (D) Fits to the probability of avoiding an interruption (blue), response strengths prediction (orange), and the resulting weighted response curve (orange, dotted) shown for another network. An optimal latency of ≈ 1.5 s emerges in this case. (E) All predicted objective functions for each of the 20 networks studied were quasiconcave and unique choices of optimal stimulus latencies were available. The objective functions were normalized to peak magnitude.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005054.g003" xlink:type="simple"/>
</fig>
<p>Stimulating a network at a channel evoked a burst of activity at others. For our experiments, we selected one stimulating and recording channel each. Weihberger et al. [<xref ref-type="bibr" rid="pcbi.1005054.ref020">20</xref>] showed that the greater the duration of network inactivity, the longer the responses at a chosen site will be, according to a saturating exponential model. In order to verify this relationship and extract the parameters of the corresponding model, stimuli were delivered at random latencies relative to the previous SB (open-loop stimulation). <xref ref-type="fig" rid="pcbi.1005054.g001">Fig 1A</xref> shows responses at the recording channel to 50 such trials in an example network. Responses typically consisted of an early (≤20 ms post-stimulus) and late (&gt;50 ms post-stimulus) component. The early component, presumably reflecting responses to antidromic stimulation, was characterized by temporally precise and reliable responses while the late component, presumably reflecting responses to orthodromic, transsynaptic activation, was both variable and unreliable (<xref ref-type="fig" rid="pcbi.1005054.g001">Fig 1B</xref>).</p>
<p>A least square fit of the response strengths to a saturating exponential model with stimulus latency as the independent variable was carried out. The fitting function was of the form <italic>A</italic>(1 − <italic>e</italic><sup>−<italic>λ</italic> <italic>t</italic></sup>) + <italic>B</italic> (in red in <xref ref-type="fig" rid="pcbi.1005054.g001">Fig 1C</xref>). We then weighted all response strengths with the probability of being able to deliver a stimulus at the corresponding latencies, without being interrupted by ongoing activity. The weighted response strength curve (objective function) thus provides an estimate of the average number of response spikes that can be evoked for each SB (<xref ref-type="fig" rid="pcbi.1005054.g003">Fig 3C and 3D</xref>). A solution that maximizes this estimate is therefore the optimal solution to the proposed trade-off problem, namely, to find the stimulus latency that maximizes the number of response spikes per SB.</p>
<p>We observed that a unique optimal stimulus latency exists for each of the 20 networks we studied (<xref ref-type="fig" rid="pcbi.1005054.g003">Fig 3E</xref>). The optimal latency emerges as the result of interaction of processes underlying ongoing and stimulus evoked activity dynamics of the network. Quantitative insights from previous studies [<xref ref-type="bibr" rid="pcbi.1005054.ref020">20</xref>] allowed us to extract relevant parameters from recorded data. We then constructed a simple parametric model to compute the network-specific optimal latency offline, before we let the RL controller explore the problem in a closed-loop.</p>
</sec>
<sec id="sec017">
<title>Dependency of optimal stimulus latencies on properties of network activity</title>
<p>To understand the emergence of the optimal stimulus latencies from interacting biological processes and visualize the nature of the input–output relations and their relationship with the underlying parameter space, we considered simplified phenomenological models of each of the major contributing processes. Input, in the context of this problem refers to the period of inactivity/latency after which a stimulus is delivered, and output—the average number of response spikes evoked for every SB—the response feature of interest. The recovery of post-burst network excitability was modeled as a saturating exponential function (<xref ref-type="disp-formula" rid="pcbi.1005054.e021">Eq 3</xref>). A statistical model of the temporal occurrence of SB events was considered (<xref ref-type="disp-formula" rid="pcbi.1005054.e022">Eq 4</xref>). The corresponding model parameters were extracted from spontaneous and evoked activity recorded from each network.The model equations were:
<disp-formula id="pcbi.1005054.e021"><alternatives><graphic id="pcbi.1005054.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005054.e021" xlink:type="simple"/><mml:math display="block" id="M21"><mml:mrow><mml:mi>R</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mspace width="1pt"/> <mml:mo>=</mml:mo> <mml:mspace width="1pt"/> <mml:mi>A</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>−</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>−</mml:mo> <mml:mi>λ</mml:mi> <mml:mtext> </mml:mtext> <mml:mi>t</mml:mi></mml:mrow></mml:msup> <mml:mo stretchy="false">)</mml:mo> <mml:mo>+</mml:mo> <mml:mi>B</mml:mi> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(3)</label></disp-formula>
<disp-formula id="pcbi.1005054.e022"><alternatives><graphic id="pcbi.1005054.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005054.e022" xlink:type="simple"/><mml:math display="block" id="M22"><mml:mrow><mml:mi>I</mml:mi> <mml:mi>B</mml:mi> <mml:mi>I</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mspace width="1pt"/> <mml:mo>=</mml:mo> <mml:mspace width="1pt"/> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mi>t</mml:mi> <mml:mi>σ</mml:mi> <mml:msqrt><mml:mrow><mml:mn>2</mml:mn> <mml:mi>π</mml:mi></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>−</mml:mo> <mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi>l</mml:mi> <mml:mi>n</mml:mi> <mml:mtext> </mml:mtext> <mml:mi>t</mml:mi> <mml:mo>−</mml:mo> <mml:mi>μ</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow> <mml:mrow><mml:mn>2</mml:mn> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:msup> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(4)</label></disp-formula>
<disp-formula id="pcbi.1005054.e023"><alternatives><graphic id="pcbi.1005054.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005054.e023" xlink:type="simple"/><mml:math display="block" id="M23"><mml:mrow><mml:mover accent="true"><mml:mi>I</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mspace width="1pt"/> <mml:mo>=</mml:mo> <mml:mspace width="1pt"/> <mml:mn>1</mml:mn> <mml:mo>−</mml:mo> <mml:mo>Φ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mfrac><mml:mrow><mml:mi>l</mml:mi> <mml:mi>n</mml:mi> <mml:mtext> </mml:mtext> <mml:mi>t</mml:mi> <mml:mo>−</mml:mo> <mml:mi>μ</mml:mi></mml:mrow> <mml:mi>σ</mml:mi></mml:mfrac></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(5)</label></disp-formula>
<disp-formula id="pcbi.1005054.e024"><alternatives><graphic id="pcbi.1005054.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005054.e024" xlink:type="simple"/><mml:math display="block" id="M24"><mml:mrow><mml:mtext>where </mml:mtext> <mml:mo>Φ</mml:mo> <mml:mo stretchy="false">(</mml:mo> <mml:mi>x</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mspace width="1pt"/> <mml:mo>=</mml:mo> <mml:mspace width="1pt"/> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt> <mml:mi>π</mml:mi></mml:mrow></mml:mfrac> <mml:mstyle displaystyle="true"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mo>−</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mi>x</mml:mi></mml:msubsup> <mml:mrow><mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>−</mml:mo> <mml:mfrac><mml:mrow><mml:msup><mml:mi>t</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow> <mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mstyle> <mml:mi>d</mml:mi> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
<disp-formula id="pcbi.1005054.e025"><alternatives><graphic id="pcbi.1005054.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005054.e025" xlink:type="simple"/><mml:math display="block" id="M25"><mml:mrow><mml:mi>f</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mspace width="1pt"/> <mml:mo>=</mml:mo> <mml:mspace width="1pt"/> <mml:mover accent="true"><mml:mi>I</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo>·</mml:mo> <mml:mi>R</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(6)</label></disp-formula> <disp-formula id="pcbi.1005054.e026"><alternatives><graphic id="pcbi.1005054.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005054.e026" xlink:type="simple"/><mml:math display="block" id="M26"><mml:mrow><mml:msup><mml:mi>t</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mspace width="1pt"/> <mml:mo>=</mml:mo> <mml:mspace width="1pt"/> <mml:mtext>arg</mml:mtext> <mml:munder><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow> <mml:mi>t</mml:mi></mml:munder> <mml:mi>f</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(7)</label></disp-formula></p>
<p><italic>R</italic>(<italic>t</italic>) and <italic>IBI</italic>(<italic>t</italic>) are the response strengths and the IBI respectively, modeled as a function of the period of inactivity, <italic>t</italic> (input). <inline-formula id="pcbi.1005054.e027"><alternatives><graphic id="pcbi.1005054.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005054.e027" xlink:type="simple"/><mml:math display="inline" id="M27"><mml:mrow><mml:mover accent="true"><mml:mi>I</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is the computed probability of avoiding an interruption, given a period of inactivity, <italic>t</italic>, and <italic>f</italic>(<italic>t</italic>) the appropriately weighted response strength model—the objective function (the input–output relationship). <italic>f</italic>(<italic>t</italic>)|<italic>t</italic> then gives the stimulus efficacy for repeated stimulation at latency <italic>t</italic>. The optimal latency <italic>t</italic>* is the maximizer of this function.</p>
<p>In order to visualize the dependence of the input-output relations on the contributing parameters, we numerically computed objective functions and the corresponding <italic>t</italic>*, while varying one or more parameters and holding the remaining constant. Initially, <italic>A</italic> was allowed to vary while parameters <italic>B</italic>, <italic>λ</italic>, <italic>μ</italic>, <italic>σ</italic> were held constant. <xref ref-type="fig" rid="pcbi.1005054.g004">Fig 4A and 4B</xref> shows the family of recovery functions considered and the corresponding family of objective functions. In general, all objective functions shared the property of being quasiconcave and permitted a unique maximum. These maxima (marked as dots) were the desired outputs and the corresponding stimulus latencies <italic>t</italic>*, the desired optimal latency. The desired output– or equivalently the desired latency– increased non-linearly with <italic>A</italic> (<xref ref-type="fig" rid="pcbi.1005054.g004">Fig 4B</xref>).</p>
<fig id="pcbi.1005054.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005054.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Dependence of optimal latency on parameters that capture the network’s response to stimuli.</title>
<p>Dependence of the objective function on parameters that capture the network’s response to stimuli. In all panels the parameters <italic>λ</italic>, <italic>μ</italic> and <italic>σ</italic> were set to 6.67, 1, 0.6 and 1, respectively. (A) Changes of response strength with the gain <italic>A</italic> of the response strength model within the range observed experimentally (5 ≤ <italic>A</italic> ≤ 40, <italic>B</italic> = 6.67; <italic>t</italic>: stimulus latency) (B) The optimal latencies <italic>t</italic>* (dots), i.e. the maxima of the objective function <italic>f</italic>(<italic>t</italic>) increased non-linearly with the gain parameter <italic>A</italic> (dashed line). Color code as in panel A (<italic>B</italic> = 6.67). (C) Changes of optimal timing <italic>t</italic>* as a function of gain <italic>A</italic> and y-intercept <italic>B</italic> within the range observed experimentally (-10 ≤ <italic>B</italic> ≤20). <italic>B</italic> influences the relationship of <italic>t</italic>* with <italic>A</italic> and was trivial at <italic>B</italic> = 0. Black dots and dashed line indicate the case <italic>B</italic> = 6.67 shown in panel B. Note that <italic>A</italic> + <italic>B</italic> &gt; 0 was imposed to ensure that the maximal responses were strictly positive.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005054.g004" xlink:type="simple"/>
</fig>
<p>Within the parameter range observed for <italic>A</italic> (mean and standard deviation 15.5 ± 9.3) and <italic>B</italic> (mean and standard deviation 4 ± 5.8) in our networks, the nature of the objective function family was preserved; a unique optimal latency existed, and monotonically increased or decreased non-linearly with <italic>A</italic>, depending on the value of <italic>B</italic> (<xref ref-type="fig" rid="pcbi.1005054.g004">Fig 4C</xref>). <xref ref-type="fig" rid="pcbi.1005054.g005">Fig 5A</xref>, summarizes the dependence of <italic>t</italic>* on the <italic>A</italic> − <italic>B</italic> plane. Each color coded plane corresponds to a different value of the time constant <italic>λ</italic>. <italic>λ</italic> was allowed to vary in the range observed experimentally (0.2 ≤ <italic>λ</italic> ≤ 1.2).</p>
<fig id="pcbi.1005054.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005054.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Dependence of the optimal latency on properties of the network’s activity dynamics.</title>
<p>(A) Dependence of the optimal stimulus latency <italic>t</italic>* on the <italic>A</italic> − <italic>B</italic> plane. Each plane corresponds to a different value of the time constant <italic>λ</italic> of the recovery function within the range observed experimentally (0.2 ≤ <italic>λ</italic> ≤ 1.2). (inset) Zoom-in to −2 ≤ <italic>B</italic> ≤ 6.67 to reveal the monotonic rise of <italic>t</italic>* (dots and dashed line) that corresponds to the case described in <xref ref-type="fig" rid="pcbi.1005054.g004">Fig 4B</xref> (<italic>λ</italic> = 1). (B) Dependence of the gain in stimulation efficacy by using <italic>t</italic>* over random stimulation latencies on the time constant <italic>λ</italic> of the recovery function. <italic>μ</italic>, <italic>A</italic>, <italic>B</italic>, and <italic>σ</italic> were set to 0.6, 20, 6.67, and 1 respectively. (C) IBI distributions for the range of values observed experimentally of the location parameter <italic>μ</italic> (0.6 ≤ <italic>μ</italic> ≤ 2) for <italic>A</italic>, <italic>B</italic>, <italic>λ</italic>, <italic>σ</italic> set to 20, 6.67, 1 and 1 respectively. (D) The family of objective functions corresponding to the IBI distributions in (C) shows the near linear relationship of the optimal latencies with <italic>μ</italic> (dots and dashed line) (<italic>A</italic>, <italic>B</italic>, <italic>λ</italic>, <italic>σ</italic> were 20, 6.67, 1 and 1 respectively; colors as in (C)). (E) Summary of the dependence of the optimal stimulus latency on the <italic>A</italic>–<italic>B</italic>–<italic>μ</italic> space for <italic>λ</italic> = 1. Each plane corresponds to a different value of the location parameter <italic>μ</italic> of the IBI distribution. (inset) Zoom-in to −2 ≤ <italic>B</italic> ≤ 6.67) to reveal the rise of <italic>t</italic>* (dots and dashed line) that corresponds to the case described in <xref ref-type="fig" rid="pcbi.1005054.g004">Fig 4B</xref> (<italic>λ</italic> = 1, <italic>μ</italic> = 0.6).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005054.g005" xlink:type="simple"/>
</fig>
<p>Next, we varied the location and scale parameters, <italic>μ</italic> and <italic>σ</italic> respectively—see <xref ref-type="disp-formula" rid="pcbi.1005054.e022">Eq 4</xref> of the IBI distribution. The corresponding input–output relations were still quasiconcave, thus ensuring the existence of a unique maximum. The optimal latency depended almost linearly on <italic>μ</italic> (<xref ref-type="fig" rid="pcbi.1005054.g005">Fig 5D</xref>). <xref ref-type="fig" rid="pcbi.1005054.g005">Fig 5E</xref> illustrates how the optimal latency is modulated in the <italic>A</italic> − <italic>B</italic> − <italic>μ</italic> space for <italic>λ</italic> = 1. The scale parameter <italic>σ</italic>, however, had no significant effects on the shapes of the objective functions and hence the corresponding optimal times (<xref ref-type="supplementary-material" rid="pcbi.1005054.s001">S1B Fig</xref>). The model thus allowed us to predict the optimal stimulus latency based on the individual properties of spontaneous and evoked activity of each network.</p>
</sec>
<sec id="sec018">
<title>RL based strategy to learn optimal latencies</title>
<p>We then proceeded with the closed-loop learning session. The session proceeded in alternating pairs of training and testing rounds. During training rounds, the controller was free to explore the state-action space and update its action-value function estimates, while in a testing round, it always chose an optimal policy based on the knowledge hitherto acquired. The time taken to run through with the experiment varied across networks, but was typically around 3–5 hours, typically covering 1000 SBs. This variability was due to differences in the average burst rate between networks. The latency chosen by the algorithm during the final testing session was considered the learned latency. To test the stability of the learned latency some of the sessions were run with up to 3000 SB in further training and testing rounds. <xref ref-type="fig" rid="pcbi.1005054.g006">Fig 6</xref> illustrates a typical session in an example network. In this case learning proceeded in three pairs of 200 training and 50 testing trials. Note that a trial in our paradigm refers to the period between SBs where stimulation can potentially be delivered. Each trial is therefore initiated by ongoing activity (SB termination) and not by stimuli. Some of the trials were interrupted by ongoing activity, resulting in stimulus counts less than the planned number.</p>
<fig id="pcbi.1005054.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005054.g006</object-id>
<label>Fig 6</label>
<caption>
<title>A closed-loop learning session in an example network.</title>
<p>A closed-loop learning session in an example network. The session consisted of 1000 trials (200 training (T<sub>i</sub>, red), 50 testing (X<sub>i</sub>, green) trials and 4 such pairs) (A) Raster diagram showing the activity at the recording channel around the time of stimulation. Trials interrupted by ongoing activity are left empty at <italic>t</italic> &gt; 0 s. The spikes of the interrupting SB were removed in (A) and (B) for clarity. Successful stimuli evoked responses at <italic>t</italic> &gt; 0 s. Blue lines mark the period of latency prior to the stimulus at <italic>t</italic> = 0 s Magenta triangles indicate stimuli delivered in preceding trials. Within training rounds, the controller was free to explore the state space. Note that these rounds are in closed-loop mode but with a random sequence of stimulation latencies. The strategy in this example was non-greedy. During testing rounds the hitherto best policy was chosen. After the final round, a latency of ≈ 1.4 s was learned. Stimulus properties were as in <xref ref-type="fig" rid="pcbi.1005054.g001">Fig 1</xref>. (B) Zoom-in on responses evoked throughout the session. Interrupted trials appear as empty rows; in this example all stimuli elicited responses. (C) Stimulus efficacy estimated as the response strength per SB (RS/SB) computed over each of the training/testing rounds. RS/SB improved considerably during testing compared to the training rounds. The fraction of trials interrupted in each round is shown as red circles and numerically. The dashed line was added for clarity.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005054.g006" xlink:type="simple"/>
</fig>
<p>To analyze the closed-loop sessions, we first looked at the model parameters of the recovery function, <italic>A</italic>, <italic>B</italic> and <italic>λ</italic> and compared values predicted from open-loop sessions with those recovered from fits to the closed-loop data. Note that in this paradigm responses are available only at fixed latencies corresponding to the state definition (<xref ref-type="fig" rid="pcbi.1005054.g007">Fig 7A</xref>). The gain of the network, <italic>A</italic>, showed a strong positive correlation to the open-loop ones (r = 0.91, p &lt;10 <sup>-5</sup>, n = 15 networks, <xref ref-type="fig" rid="pcbi.1005054.g007">Fig 7A and 7B</xref>), indicating relative stationarity of the quantitative relationship and its accessibility for the controller. Parameter <italic>B</italic>, which can be interpreted as the excitability threshold for SB termination, too showed positive correlation (r = 0.66, p = 0.003, n = 18 networks, <xref ref-type="fig" rid="pcbi.1005054.g007">Fig 7C</xref>), but weaker than model parameter <italic>A</italic>, suggesting that SB termination may depend on additional factors not captured by the model. Parameter <italic>λ</italic> showed a still weaker correlation (<xref ref-type="supplementary-material" rid="pcbi.1005054.s001">S1C Fig</xref>). Across networks, closed-loop estimates of the recovery model were thus mostly consistent with open-loop estimates.</p>
<fig id="pcbi.1005054.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005054.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Comparison of open-loop predictions with autonomously learned strategies.</title>
<p>(A) Dependence of response strengths on pre-stimulus inactivities in data during a closed-loop session in an example network. Each box shows the statistics of response strengths recorded at one discrete state. The central measures are median and the edges with 25<sup>th</sup> and 75<sup>th</sup> percentiles. Whiskers extend to the most extreme data points not considered outliers, and outliers are plotted individually. The fit (red) was made to the medians. The minimal latency for burst termination was 0.4 s in this example, which was thus the earliest state available for stimulation. (B) Across networks, closed-loop estimates of the gain <italic>A</italic> correlated strongly with open-loop estimates (r = 0.91, p&lt;10<sup>-5</sup>, n = 15 networks), indicating that <italic>A</italic> was mostly stable during the experiments. (C) Similarly, closed-loop estimates of <italic>B</italic> were in agreement with open-loop ones (r = 0.66, p = 0.003, n = 18 networks), although to a lesser degree. (D) Across networks, learned stimulus latencies show a positive correlation with predicted optimal values (r = 0.94, p&lt;10<sup>-8</sup>, n = 17 networks). (E) In spite of some variability in Panels B-D the magnitudes of the modeled objective functions for predicted and learned latencies matched closely (green dots), indicating that the network/stimulator system was performing at a near optimal regime, regardless of slight discrepancies in the latencies. Exact optima were likely unreachable owing to the coarse discretization (0.5 s) of states. Red dots denote the corresponding magnitudes at <italic>t</italic><sub><italic>rand</italic></sub> for a strategy delivering stimuli at random latencies estimated as the mean of the objective function. (F) The distribution of errors between learned and predicted latencies is centered around the predicted optimum and confined to within 2 discrete steps from it.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005054.g007" xlink:type="simple"/>
</fig>
<p>We then compared the learned stimulus latencies with those predicted from open-loop sessions. Overall, stimulus latencies learned by the controller showed a strong positive correlation with the optimal latencies estimated from open-loop experiments (r = 0.94, p&lt;10<sup>-8</sup>, n = 17 networks, <xref ref-type="fig" rid="pcbi.1005054.g007">Fig 7D</xref>). Nevertheless, in some networks learned latencies differed from predicted ones, as visible in their distances to the diagonal in <xref ref-type="fig" rid="pcbi.1005054.g007">Fig 7D</xref>. Next, we compared the measure being maximized—stimulation efficacy estimated as the response strength per SB, corresponding to learned and estimated latencies. The network-specific model of the objective function, <italic>f</italic>(<italic>t</italic>) (<xref ref-type="disp-formula" rid="pcbi.1005054.e025">Eq 6</xref>) was used to estimate the maximal stimulation efficacy <italic>f</italic>(<italic>t</italic>)|<italic>t</italic> achievable with the predicted optimal latency vs. the one learned for a given network. Values of this measure were in strong agreement (<xref ref-type="fig" rid="pcbi.1005054.g007">Fig 7E</xref>), indicating that the control goal was achieved despite errors in predicted latencies (<xref ref-type="fig" rid="pcbi.1005054.g007">Fig 7D</xref>). One possible source of errors could be the discretization of the controller’s state space into 0.5 s steps. Indeed, the error distribution showed that 74% of the networks studied fell within ±0.5 s around the optimum (<xref ref-type="fig" rid="pcbi.1005054.g007">Fig 7F</xref>).</p>
<p>Finally, the performance of the controller was evaluated with respect to the defined goal: to maximize stimulation efficacy measured as the total number of response spikes evoked for every detected SB in the network. A session-by-session analysis showed that in 94.2% of the sessions (n = 52 sessions with non-greedy training, 11 networks), the percentage of interrupted events per session diminished post learning (<xref ref-type="fig" rid="pcbi.1005054.g008">Fig 8A</xref>). IBI distributions of spontaneous activity prior and subsequent to closed-loop sessions showed small changes in only a few networks (p&lt;0.001 in 6/20 networks, two sample Kolmogorov-Smirnov test <xref ref-type="supplementary-material" rid="pcbi.1005054.s004">S4 Fig</xref>) and in these, the frequency of IBIs less than 5 s could change in both directions.</p>
<fig id="pcbi.1005054.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005054.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Performance evaluation of the controller.</title>
<p>(A) The percentage of interrupted trials during training (x-axis) and testing (y-axis) sessions (n = 52 pairs across 11 networks). This percentage decreased sharply after learning in 94.2% of the recorded sessions. (B) The mean RS evoked per stimulus was, however, preserved in both sessions. (C) The variability in RS per stimulus decreased significantly (p = 0.01, two-sample t-test). (D) Comparison of the optimal stimulus efficacies predicted from our models with the efficacies achieved during the final closed-loop testing sessions. Vertical bars represent 99% confidence intervals corresponding to the models fitted for each network. Achieved values fall within the interval in 8/11 networks studied. (E) Mean rewards were calculated over trials in the final training and testing rounds to compare the controller’s performance. After learning, mean rewards increased in each network, which is indicative of the improvement in stimulation efficacy. The rewards across the sequence of trials in each round were drawn from distinct distributions in every network (p&lt;0.002, two-sample Kolmogorov-Smirnov test). The individual distributions are shown in <xref ref-type="supplementary-material" rid="pcbi.1005054.s002">S2</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005054.s003">S3</xref> Figs. (F) Summary of learning across networks on a normalized RS/stimulus vs. interruption probability plane (11 networks). Only final training and testing rounds were considered. Normalization for interruptions was performed relative to the model-based estimate of interruption probabilities, corresponding to stimulation at random latencies for each network. The RS/stimulus measure was similarly normalized to the model-based estimates of the efficacy assuming a random stimulation strategy. The improvement in performance clearly separates the data points in the plane. Of the two modalities that contribute to stimulus efficacy, the improvement was dominated by reduction of interruption probabilities.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005054.g008" xlink:type="simple"/>
</fig>
<p>While the number of spikes in a response did not significantly change across sessions (<xref ref-type="fig" rid="pcbi.1005054.g008">Fig 8B</xref>) the standard deviation across stimuli in a session decreased (<xref ref-type="fig" rid="pcbi.1005054.g008">Fig 8C</xref>) (p = 0.01, two-sample t-test). Concurrently, in 90% of the cases (n = 52 sessions, 11 networks), the stimulus efficacy had increased after learning, supporting the effectiveness of the learning algorithm.</p>
<p>The models used to estimate the objective functions were derived from fits to spontaneous activity and noisy samples of responses in open-loop experiments. The quality of the predictions thus depended on the reliability of these fits. Comparison of the optimal stimulus efficacies predicted from our models with the efficacies achieved during the final closed-loop testing sessions showed that achieved efficacies were within the 99% confidence interval for the models fitted for each network (<xref ref-type="fig" rid="pcbi.1005054.g008">Fig 8D</xref>). Achieved stimulus efficacies fall within the interval in 8 of 11 networks studied.</p>
<p>Learning clearly improved performance in each network (p&lt;0.001, two-sample Kolmogorov-Smirnov test). The amount of improvement, however, varied across networks (<xref ref-type="fig" rid="pcbi.1005054.g008">Fig 8E</xref>). To compare performance across networks, we captured each network on a normalized response-per-stimulus vs. interruption probability plane (<xref ref-type="fig" rid="pcbi.1005054.g008">Fig 8F</xref>). Each network is shown before and after learning. Only the last pairs of sessions were used for this plot (n = 11 networks). The distribution shows a clear separation of the mixed-mode performance before and after learning, indicating the improvement of stimulation efficacy. The improvement was almost exclusively due to a reduction in interruption probability (<xref ref-type="supplementary-material" rid="pcbi.1005054.s002">S2</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005054.s003">S3</xref> Figs). This, however, also says that the controller learns to avoid losing in response magnitude by not further reducing the interruption probability, i.e. it balances the trade-off.</p>
</sec>
</sec>
<sec id="sec019" sec-type="conclusions">
<title>Discussion</title>
<p>Closed-loop stimulation has been proposed as a promising strategy to intervene in the dynamics of pathological networks while adapting to ongoing activity. The selection of signal features to close such a loop and strategies to identify optimal stimulus settings given a desired network response, remain open problems. We propose methods of reinforcement learning to autonomously choose optimal control policies given a pre-defined goal. In this study, we present proof of principle of such a controller interacting in a goal directed manner with generic neuronal networks <italic>in vitro</italic>, boundary conditions for such interactions and an analysis of the optimality of the learned controller.</p>
<p>Our results demonstrate the capacity of RL based techniques to autonomously exploit quantitative relationships underlying a complex network of neurons to find optimal actions. Drawing on previous studies, we identified a simple verifiable trade-off scenario in which the dynamics of spontaneous activity in these networks interact with external electrical stimuli [<xref ref-type="bibr" rid="pcbi.1005054.ref020">20</xref>]. The temporal relationship of SB events in these networks may be approximated by a lognormal function. Moreover, response strengths to electrical stimuli have been shown to quantitatively fit a saturating exponential model, dependent on the stimulus latency subsequent to an SB event. Interaction of these underlying processes gives rise to an abstract objective function predicting a network specific and unique stimulus latency relative to a SB that maximizes the number of response spikes evoked per SB across repeated stimulation. The goal set for the RL controller was to autonomously identify this optimal stimulus latency.</p>
<p>Response strength was defined as the number of spikes detected in a predefined temporal window (typically 500 ms) from stimulus onset. Note that while [<xref ref-type="bibr" rid="pcbi.1005054.ref020">20</xref>] define response lengths as the time to the last spike of the detected response, our data showed that the spike counts in a temporal window post stimulus is proportional to the response lengths measured in time and hence can be used as an alternative variable.</p>
<p>This toy problem for the model system captures some of the major challenges that closed-loop paradigms would face in a biomedical application, i.e. in a very complex, adaptive environment. Balancing the trade-off of response magnitude and interruptions involves finding the dependence of response magnitudes on stimulus latencies and adjusting at the same time to the distribution of ongoing activity. With every network being distinct in the properties of its spontaneous dynamics and response to stimuli, the paradigm was tested for robust operation over a range of parameters. Furthermore, the ongoing activity is highly variable and subject to unpredictable modulation at a wide range of time scales. Plasticity of synaptic coupling could lead to further challenges. Prior studies on such networks enable us to model this interplay using parametric models under the assumption of system stationarity. This provided us with the convenient situation where an open-loop prediction of the network-specific optimal stimulus latency could be calculated to evaluate the quality of the controller’s learned strategy. Furthermore, both main processes involved could be modeled as a function of only the latency following an SB event, which thus became an informative and quantifiable low-dimensional state feature for the RL controller. Other contributing factors could have been the recent history of spontaneous activity. Offline analyses, however, did not show an influence of this on the quality of the response properties.</p>
<p>We used numerical models of the system to identify the interactions of variations in the model parameters. The numerical approach revealed the multi-modal nature of the control problem—in that two separate measurable modalities are simultaneously involved– the exponential recovery function and the statistical model of ongoing event occurrence. Combining them enabled us to visualize the non-linear quasi convex input–output dependence <italic>f</italic>(<italic>t</italic>). The desired metric <italic>f</italic>(<italic>t</italic>*), was unique, distinct for each network and necessarily attainable, because the corresponding <italic>t</italic>* always belonged to the domain of interest (0–10 s) throughout the span of parameter values observed experimentally. Each network, being a static parameter combination, would therefore map to a single non-linear input–output curve that belonged to the set of objective functions described earlier. In other words, an optimal solution was possible for all parameter sets within the observed range. Open-loop estimates of the saturating exponential model parameters <italic>A</italic> and <italic>B</italic> correlated positively with fits to data from closed-loop sessions. This indicates that the quantitative relationship is stable and accessible to the controller during the learning phase. Note that the temporal stability of the model is a precondition to the controller being able to converge to the same optimal stimulus latencies as the open-loop estimates. Indeed we observed across networks, that the learned optimal stimulus latencies agreed with those predicted from open-loop studies. The controller apparently robustly and autonomously exploited the underlying stimulus-response relationships in the network by interacting with it and adapting appropriately to ongoing activity dynamics.</p>
<p>In this study, stationarity of system dynamics was a necessary assumption in order to be able to compare optimal stimulus latencies predicted from open-loop data at one point in time, to those learned later in closed-loop sessions. However, this might not necessarily be the case. Neuronal networks <italic>in vitro</italic> are known to undergo activity dependent plastic changes [<xref ref-type="bibr" rid="pcbi.1005054.ref029">29</xref>]. The model parameters of the exponential recovery function are likely time dependent as well. Differences in the magnitudes of correlations between parameters <italic>A</italic> (strongly correlated), <italic>B</italic> (less positively correlated) and <italic>λ</italic>(no correlation) in open vs. closed-loop data fits are possible indicators that some parameters are perhaps more strongly modulated over time than others. For slow fluctuations, the RL paradigm could easily be modified to update the controller, provided the temporal resolution of the state-space is high enough to sample the impact of fluctuations and that the update intervals are adjusted accordingly. It would, however, not be possible to monitor these modulations of network properties during testing in the current paradigm. We would therefore not be able to validate the optimality of resulting controller.</p>
<p>In spite of such sources of variability, the correlation of the learned latencies of the controller with the preceding, temporally distant, open-loop predictions is strong. One reason for this could be the resolution of the controller—the state-space discretization chosen for the controller was relatively coarse at 0.5 s. From our parametric model of the trade-off situation (Figs <xref ref-type="fig" rid="pcbi.1005054.g004">4</xref> and <xref ref-type="fig" rid="pcbi.1005054.g005">5</xref>), it can be seen that the impact of parameter fluctuations on optimal latencies would be small relative to this resolution of the state-space. The actual optimum, thus, could fall in the neighborhood of the learned latencies. Such a tendency is indeed visible in the error between the learned and optimal times (<xref ref-type="fig" rid="pcbi.1005054.g007">Fig 7F</xref>), which are centered around the optimum. Therefore, by coarse graining the state-space discretization we compensate to some degree for non-stationarities in the system. An additional factor contributing to the strong correlation could be rapid parameter fluctuations, which could average out within the duration of the experiment.</p>
<p>In all networks the achieved stimulation efficacy increased after learning, but individually could be below or above the predicted levels <xref ref-type="fig" rid="pcbi.1005054.g008">Fig 8D</xref>. This was probably due to the quality of fits of the recovery function and to non-stationarities in network activity that built up between the time of the original estimate of the objective function and the training/testing sessions eventually available for evaluation. Further contributions to variability could come from the choice of the range of latencies available to the controller for exploration. Longer latencies would lead to increasing probabilities for interruptions during training, biasing the relative success of the learned controller. In this study we set maximal latencies to 10 s, which ensured that recovery would saturate in most networks. Moreover, as Figs <xref ref-type="fig" rid="pcbi.1005054.g005">5B</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005054.s001">S1A</xref> illustrate, the time-constants of these functions also influence the achieved gain in stimulus efficacies.</p>
<p>Although our control goal was drawn on previous studies on the model system, this insight was not implemented into the controller and was used only to validate its performance. However, it must be conceded that our understanding of the underlying relationship did inform the definition of the low-dimensional state-space for the controller, i.e. that the delay of the stimulus to the preceding burst is relevant for the magnitude of the response. This on the one hand was essential to validate the controller’s quality but also reduced the number of trials needed for the controller to converge. In turn, our model cannot capture processes depending on the serial structure of the stimulation sequence, e.g. the rate of stimulation, activity dependent plasticity or even damage to neurons.</p>
<p>Our choice of Q-learning with a tabular representation of the Q-function was motivated as follows. For one, Q-learning allows us to learn a Q-function without having a model of the system dynamics, which in general is not available when dealing with biological systems. Secondly, since the state space for the control task at hand could be defined as a single discrete variable, a tabular representation of the Q-function was applicable, which guarantees convergence [<xref ref-type="bibr" rid="pcbi.1005054.ref028">28</xref>] (we note that convergence can also be achieved in some cases where the Q-function is approximated, see e.g. Szepesvári [<xref ref-type="bibr" rid="pcbi.1005054.ref030">30</xref>] for an overview). A tabular representation of the Q-function is a suitable choice as long as the biological system can be described by low-dimensional discretized states. If a different control problem or biological system demands a moderately finer discretization of the state space, tabular Q-learning could still be applied. However, if the control problem requires a state-action space that is high-dimensional or continuous, a tabular representation of the Q-function is not advisable due to the so called curse of dimensionality (exponentially growing memory demand). For our long-term goal of general control of neuronal networks using RL controllers this would clearly be the case.</p>
<p>To this end, future work should further investigate the possibility of feature based approximate RL using e.g. artificial neural networks (ANNs) [<xref ref-type="bibr" rid="pcbi.1005054.ref031">31</xref>, <xref ref-type="bibr" rid="pcbi.1005054.ref032">32</xref>] or Random Forests [<xref ref-type="bibr" rid="pcbi.1005054.ref033">33</xref>, <xref ref-type="bibr" rid="pcbi.1005054.ref034">34</xref>]. As features, such approaches could utilize statistics summarizing network activity in terms of previous burst and response characteristics, adapt features learned from offline data sets from multiple networks [<xref ref-type="bibr" rid="pcbi.1005054.ref034">34</xref>], or use a machine learning approach to automatically find descriptive features.</p>
<p>In this proof-of-principle study, we show that an RL based autonomous strategy can find optimal stimulation settings in the context of a dynamic neuronal system. Extending on special applications, in which the aim of stimulation is to abolish some type of event, such as epileptic events or oscillations in Parkinson’s Disease, the system studied here represents a more general situation in that the optimal response is initially numerically undefined, i.e. it can take different values depending on the properties of a network that are unknown to the experimenter. It also extends beyond the response clamp paradigm [<xref ref-type="bibr" rid="pcbi.1005054.ref021">21</xref>] in that it takes into account not only the probability to induce a response but both its magnitude and the probability of being interrupted by spontaneous activity. Our paradigm is thus related to the idea of inducing desired network activity, e.g. towards sensory feedback by stimulation from neuroprosthetic devices, or adjusting the activity dynamics of a network to a desired working mode. In the context of our study, we focused on this specific multi-modal trade-off problem to maximize a derived feature of the response (response strength per SB event). We could show that a unique optimal strategy exists for each network and thus verify that the controller autonomously found the optimum of the objective function given the limitations of our data. Where RL paradigms are applied to more general situations, phenomenological models of their interaction with biological neuronal networks could nonetheless help to estimate the quality of the controllers when full mechanistic descriptions of the system are not available.</p>
</sec>
<sec id="sec020">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1005054.s001" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005054.s001" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Dependence of the optimal stimulation latency on the slope of the recovery function and the location and scale parameters of the IBI distributions.</title>
<p>(A) <italic>t</italic>* depends on the shape of the recovery function. <italic>t</italic>* shifts to later times with increasing recovery slope (<italic>λ</italic> increases) when average inter-burst intervals <italic>μ</italic> are short, i.e. spontaneous activity is high and the probability for interruption is high. In low activity regimes, however, the probability of interruption is low, hence <italic>t</italic>* is late and increasing the slope will lead to a decrease of the stimulus efficacy with increasing latencies since increasing interruption probability then outweighs the gain in spikes/stimulus. Because of the saturation of recovery changes in the probability for interruptions have a dominating influence on <italic>t</italic>*. (<italic>inset</italic>) <italic>t</italic>* shifts to later latencies with increasing <italic>μ</italic> for a given <italic>λ</italic> (boxed). <italic>A</italic>, <italic>B</italic> and <italic>σ</italic> were set to 20, 6.67, 1 respectively. (B) Scale parameter, <italic>σ</italic> of the IBI distribution had little impact on the optimal stimulation latency. <italic>A</italic>, <italic>B</italic> and <italic>λ</italic> and <italic>μ</italic> were set to 20, 6.67, 1 and 0.6 respectively. (C) Across networks, values of <italic>λ</italic> recovered from fits to closed-loop data were uncorrelated with open-loop estimates.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005054.s002" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005054.s002" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Reward probability distributions for all networks.</title>
<p>In each training trial the controller received a reward according to the number of spikes elicited by the stimulus. In trials interrupted by SBs this resulted in neutral reward (−10<sup>−3</sup>), pooled with trials eliciting 0 spikes in the histograms. After learning, the probability for very high rewards was reduced but this was outweighed by the lower frequency of 0 and neutral rewards.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005054.s003" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005054.s003" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Empirical cumulative distribution of rewards for all networks.</title>
<p>The Empirical cumulative distribution function (ECDF) of the rewards clearly shows that the improvements by learning were dominated by reduced probabilities to receive 0 or neutral rewards.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005054.s004" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005054.s004" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>Distributions of IBIs before and after closed-loop sessions.</title>
<p>Distributions of IBIs in spontaneous activity recorded before (blue) and after (yellow) closed-loop sessions. A two-sample Kolmogorov-Smirnov test showed that the IBIs were drawn from distinct distributions in 6/20 networks (p&lt;0.001, bold axes).</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>The authors thank Ute Riede for technical assistance in cell culturing and Arvind Kumar for suggestions on the manuscript.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1005054.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Koller</surname> <given-names>WC</given-names></name>, <name name-style="western"><surname>Lyons</surname> <given-names>KE</given-names></name>, <name name-style="western"><surname>Wilkinson</surname> <given-names>SB</given-names></name>, <name name-style="western"><surname>Pahwa</surname> <given-names>R</given-names></name>. <article-title>Efficacy of unilateral deep brain stimulation of the vim nucleus of the thalamus for essential head tremor</article-title>. <source>Movement Disorders</source>. <year>1999</year>;<volume>14</volume>(<issue>5</issue>):<fpage>847</fpage>–<lpage>850</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/1531-8257(199909)14:5%3C847::AID-MDS1021%3E3.0.CO;2-G" xlink:type="simple">10.1002/1531-8257(199909)14:5%3C847::AID-MDS1021%3E3.0.CO;2-G</ext-link></comment> <object-id pub-id-type="pmid">10495050</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005054.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rehncrona</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Johnels</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Widner</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Törnqvist</surname> <given-names>AL</given-names></name>, <name name-style="western"><surname>Hariz</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Sydow</surname> <given-names>O</given-names></name>. <article-title>Long-term efficacy of thalamic deep brain stimulation for tremor: Double-blind assessments</article-title>. <source>Movement Disorders</source>. <year>2003</year>;<volume>18</volume>(<issue>2</issue>):<fpage>163</fpage>–<lpage>170</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/mds.10309" xlink:type="simple">10.1002/mds.10309</ext-link></comment> <object-id pub-id-type="pmid">12539209</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005054.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Vidailhet</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Vercueil</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Houeto</surname> <given-names>JL</given-names></name>, <name name-style="western"><surname>Krystkowiak</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Benabid</surname> <given-names>AL</given-names></name>, <name name-style="western"><surname>Cornu</surname> <given-names>P</given-names></name>, <etal>et al</etal>. <article-title>Bilateral Deep-Brain Stimulation of the Globus Pallidus in Primary Generalized Dystonia</article-title>. <source>New England Journal of Medicine</source>. <year>2005</year>;<volume>352</volume>(<issue>5</issue>):<fpage>459</fpage>–<lpage>467</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1056/NEJMoa042187" xlink:type="simple">10.1056/NEJMoa042187</ext-link></comment> <object-id pub-id-type="pmid">15689584</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005054.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Krack</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Batir</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Van Blercom</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Chabardes</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Fraix</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Ardouin</surname> <given-names>C</given-names></name>, <etal>et al</etal>. <article-title>Five-Year Follow-up of Bilateral Stimulation of the Subthalamic Nucleus in Advanced Parkinson’s Disease</article-title>. <source>New England Journal of Medicine</source>. <year>2003</year>;<volume>349</volume>(<issue>20</issue>):<fpage>1925</fpage>–<lpage>1934</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1056/NEJMoa035275" xlink:type="simple">10.1056/NEJMoa035275</ext-link></comment> <object-id pub-id-type="pmid">14614167</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005054.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bittar</surname> <given-names>RG</given-names></name>, <name name-style="western"><surname>Burn</surname> <given-names>SC</given-names></name>, <name name-style="western"><surname>Bain</surname> <given-names>PG</given-names></name>, <name name-style="western"><surname>Owen</surname> <given-names>SL</given-names></name>, <name name-style="western"><surname>Joint</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Shlugman</surname> <given-names>D</given-names></name>, <etal>et al</etal>. <article-title>Deep brain stimulation for movement disorders and pain</article-title>. <source>Journal of Clinical Neuroscience</source>. <year>2005</year>;<volume>12</volume>(<issue>4</issue>):<fpage>457</fpage>–<lpage>463</lpage>. <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jocn.2004.09.001" xlink:type="simple">http://dx.doi.org/10.1016/j.jocn.2004.09.001</ext-link>. <object-id pub-id-type="pmid">15925782</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005054.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sarem-Aslani</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Mullett</surname> <given-names>K</given-names></name>. <article-title>Industrial perspective on deep brain stimulation: history, current state, and future developments</article-title>. <source>Frontiers in integrative neuroscience</source>. <year>2011</year>; <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.3389/fnint.2011.00046" xlink:type="simple">10.3389/fnint.2011.00046</ext-link></comment> <object-id pub-id-type="pmid">21991248</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005054.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kringelbach</surname> <given-names>ML</given-names></name>, <name name-style="western"><surname>Jenkinson</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Owen</surname> <given-names>SLF</given-names></name>, <name name-style="western"><surname>Aziz</surname> <given-names>TZ</given-names></name>. <article-title>Translational principles of deep brain stimulation</article-title>. <source>Nat Rev Neurosci</source>. <year>2007</year>;<volume>8</volume>(<issue>8</issue>):<fpage>623</fpage>–<lpage>635</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nrn2196" xlink:type="simple">10.1038/nrn2196</ext-link></comment> <object-id pub-id-type="pmid">17637800</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005054.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Raspopovic</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Capogrosso</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Petrini</surname> <given-names>FM</given-names></name>, <name name-style="western"><surname>Bonizzato</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Rigosa</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Di Pino</surname> <given-names>G</given-names></name>, <etal>et al</etal>. <article-title>Restoring Natural Sensory Feedback in Real-Time Bidirectional Hand Prostheses</article-title>. <source>Science Translational Medicine</source>. <year>2014</year>;<volume>6</volume>(<issue>222</issue>):<fpage>222ra19</fpage>–<lpage>222ra19</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/scitranslmed.3006820" xlink:type="simple">10.1126/scitranslmed.3006820</ext-link></comment> <object-id pub-id-type="pmid">24500407</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005054.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Azouz</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Gray</surname> <given-names>CM</given-names></name>. <article-title>Cellular Mechanisms Contributing to Response Variability of Cortical Neurons In Vivo</article-title>. <source>The Journal of Neuroscience</source>. <year>1999</year>;<volume>19</volume>(<issue>6</issue>):<fpage>2209</fpage>–<lpage>2223</lpage>. <object-id pub-id-type="pmid">10066274</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005054.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Jones</surname> <given-names>LM</given-names></name>, <name name-style="western"><surname>Fontanini</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Sadacca</surname> <given-names>BF</given-names></name>, <name name-style="western"><surname>Miller</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Katz</surname> <given-names>DB</given-names></name>. <article-title>Natural stimuli evoke dynamic sequences of states in sensory cortical ensembles</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2007</year>;<volume>104</volume>(<issue>47</issue>):<fpage>18772</fpage>–<lpage>18777</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.0705546104" xlink:type="simple">10.1073/pnas.0705546104</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005054.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>He</surname> <given-names>BJ</given-names></name>. <article-title>Spontaneous and Task-Evoked Brain Activity Negatively Interact</article-title>. <source>The Journal of Neuroscience</source>. <year>2013</year>;<volume>33</volume>(<issue>11</issue>):<fpage>4672</fpage>–<lpage>4682</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.2922-12.2013" xlink:type="simple">10.1523/JNEUROSCI.2922-12.2013</ext-link></comment> <object-id pub-id-type="pmid">23486941</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005054.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Petersen</surname> <given-names>CCH</given-names></name>, <name name-style="western"><surname>Hahn</surname> <given-names>TTG</given-names></name>, <name name-style="western"><surname>Mehta</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Grinvald</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Sakmann</surname> <given-names>B</given-names></name>. <article-title>Interaction of sensory responses with spontaneous depolarization in layer 2/3 barrel cortex</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2003</year>;<volume>100</volume>(<issue>23</issue>):<fpage>13638</fpage>–<lpage>13643</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.2235811100" xlink:type="simple">10.1073/pnas.2235811100</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005054.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kisley</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Gerstein</surname> <given-names>GL</given-names></name>. <article-title>Trial-to-Trial Variability and State-Dependent Modulation of Auditory-Evoked Responses in Cortex</article-title>. <source>The Journal of Neuroscience</source>. <year>1999</year>;<volume>19</volume>(<issue>23</issue>):<fpage>10451</fpage>–<lpage>10460</lpage>. <object-id pub-id-type="pmid">10575042</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005054.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Arieli</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Sterkin</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Grinvald</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Aertsen</surname> <given-names>A</given-names></name>. <article-title>Dynamics of Ongoing Activity: Explanation of the Large Variability in Evoked Cortical Responses</article-title>. <source>Science</source>. <year>1996</year>;<volume>273</volume>(<issue>5283</issue>):<fpage>1868</fpage>–<lpage>1871</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.273.5283.1868" xlink:type="simple">10.1126/science.273.5283.1868</ext-link></comment> <object-id pub-id-type="pmid">8791593</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005054.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hasenstaub</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Sachdev</surname> <given-names>RNS</given-names></name>, <name name-style="western"><surname>McCormick</surname> <given-names>DA</given-names></name>. <article-title>State Changes Rapidly Modulate Cortical Neuronal Responsiveness</article-title>. <source>The Journal of Neuroscience</source>. <year>2007</year>;<volume>27</volume>(<issue>36</issue>):<fpage>9607</fpage>–<lpage>9622</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.2184-07.2007" xlink:type="simple">10.1523/JNEUROSCI.2184-07.2007</ext-link></comment> <object-id pub-id-type="pmid">17804621</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005054.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cossart</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Aronov</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Yuste</surname> <given-names>R</given-names></name>. <article-title>Attractor dynamics of network UP states in the neocortex</article-title>. <source>Nature</source>. <year>2003</year>;<volume>419</volume>:<fpage>283</fpage>–<lpage>287</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature01614" xlink:type="simple">10.1038/nature01614</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005054.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Shu</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Hasenstaub</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>McCormick</surname> <given-names>DA</given-names></name>. <article-title>Turning on and off recurrent balanced cortical activity</article-title>. <source>Nature</source>. <year>2003</year>;<volume>419</volume>:<fpage>288</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature01616" xlink:type="simple">10.1038/nature01616</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005054.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Holcman</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Tsodyks</surname> <given-names>M</given-names></name>. <article-title>The Emergence of Up and Down States in Cortical Networks</article-title>. <source>PLoS Comput Biol</source>. <year>2006</year>;<volume>2</volume>(<issue>3</issue>):<fpage>1</fpage>–<lpage>8</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.0020023" xlink:type="simple">10.1371/journal.pcbi.0020023</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005054.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gal</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Eytan</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Wallach</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Sandler</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Schiller</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Marom</surname> <given-names>S</given-names></name>. <article-title>Dynamics of Excitability over Extended Timescales in Cultured Cortical Neurons</article-title>. <source>The Journal of Neuroscience</source>. <year>2010</year>;<volume>30</volume>(<issue>48</issue>):<fpage>16332</fpage>–<lpage>16342</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.4859-10.2010" xlink:type="simple">10.1523/JNEUROSCI.4859-10.2010</ext-link></comment> <object-id pub-id-type="pmid">21123579</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005054.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Weihberger</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Okujeni</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Mikkonen</surname> <given-names>JE</given-names></name>, <name name-style="western"><surname>Egert</surname> <given-names>U</given-names></name>. <article-title>Quantitative examination of stimulus-response relations in cortical networks in vitro</article-title>. <source>Journal of neurophysiology</source>. <year>2013</year>;<volume>109</volume>(<issue>7</issue>):<fpage>1764</fpage>–<lpage>1774</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1152/jn.00481.2012" xlink:type="simple">10.1152/jn.00481.2012</ext-link></comment> <object-id pub-id-type="pmid">23274313</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005054.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Keren</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Marom</surname> <given-names>S</given-names></name>. <article-title>Controlling neural network responsiveness: tradeoffs and constraints</article-title>. <source>Frontiers in Neuroengineering</source>. <year>2014</year>; <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.3389/fneng.2014.00011" xlink:type="simple">10.3389/fneng.2014.00011</ext-link></comment> <object-id pub-id-type="pmid">24808860</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005054.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rosin</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Slovik</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Mitelman</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Michal</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Haber</surname> <given-names>SN</given-names></name>, <name name-style="western"><surname>Israel</surname> <given-names>Z</given-names></name>, <etal>et al</etal>. <article-title>Closed-loop deep brain stimulation is superior in ameliorating parkinsonism</article-title>. <source>Neuron</source>. <year>2011</year>;<volume>72</volume>(<issue>2</issue>):<fpage>370</fpage>–<lpage>384</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuron.2011.08.023" xlink:type="simple">10.1016/j.neuron.2011.08.023</ext-link></comment> <object-id pub-id-type="pmid">22017994</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005054.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Little</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Pogosyan</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Neal</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Zavala</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Zrinzo</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Hariz</surname> <given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Adaptive deep brain stimulation in advanced Parkinson disease</article-title>. <source>Annals of neurology</source>. <year>2013</year>;<volume>74</volume>(<issue>3</issue>):<fpage>449</fpage>–<lpage>457</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/ana.23951" xlink:type="simple">10.1002/ana.23951</ext-link></comment> <object-id pub-id-type="pmid">23852650</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005054.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kermany</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Gal</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Lyakhov</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Meir</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Marom</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Eytan</surname> <given-names>D</given-names></name>. <article-title>Tradeoffs and Constraints on Neural Representation in Networks of Cortical Neurons</article-title>. <source>The Journal of Neuroscience</source>. <year>2010</year>;<volume>30</volume>(<issue>28</issue>):<fpage>9588</fpage>–<lpage>9596</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.0661-10.2010" xlink:type="simple">10.1523/JNEUROSCI.0661-10.2010</ext-link></comment> <object-id pub-id-type="pmid">20631187</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005054.ref025">
<label>25</label>
<mixed-citation publication-type="other" xlink:type="simple">Wagenaar D, DeMarse TB, Potter SM. MeaBench: A toolset for multi-electrode data acquisition and on-line analysis. In: Conference Proceedings. 2nd International IEEE EMBS Conference on Neural Engineering. 2005. p. 518–521.</mixed-citation>
</ref>
<ref id="pcbi.1005054.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Eytan</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Marom</surname> <given-names>S</given-names></name>. <article-title>Dynamics and Effective Topology Underlying Synchronization in Networks of Cortical Neurons</article-title>. <source>The Journal of Neuroscience</source>. <year>2006</year>;<volume>26</volume>(<issue>33</issue>):<fpage>8465</fpage>–<lpage>8476</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.1627-06.2006" xlink:type="simple">10.1523/JNEUROSCI.1627-06.2006</ext-link></comment> <object-id pub-id-type="pmid">16914671</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005054.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ham</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Bettencourt</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>McDaniel</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Gross</surname> <given-names>G</given-names></name>. <article-title>Spontaneous coordinated activity in cultured networks: Analysis of multiple ignition sites, primary circuits, and burst phase delay distributions</article-title>. <source>Journal of Computational Neuroscience</source>. <year>2008</year>;<volume>24</volume>(<issue>3</issue>):<fpage>346</fpage>–<lpage>357</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s10827-007-0059-1" xlink:type="simple">10.1007/s10827-007-0059-1</ext-link></comment> <object-id pub-id-type="pmid">18066657</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005054.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Watkins</surname> <given-names>CJ</given-names></name>, <name name-style="western"><surname>Dayan</surname> <given-names>P</given-names></name>. <article-title>Q-learning</article-title>. <source>Machine learning</source>. <year>1992</year>;<volume>8</volume>(<issue>3</issue>):<fpage>279</fpage>–<lpage>292</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1023/A:1022676722315" xlink:type="simple">10.1023/A:1022676722315</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005054.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Minerbi</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Kahana</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Goldfeld</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Kaufman</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Marom</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Ziv</surname> <given-names>NE</given-names></name>. <article-title>Long-Term Relationships between Synaptic Tenacity, Synaptic Remodeling, and Network Activity</article-title>. <source>PLoS Biol</source>. <year>2009</year>;<volume>7</volume>(<issue>6</issue>):<fpage>e1000136</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pbio.1000136" xlink:type="simple">10.1371/journal.pbio.1000136</ext-link></comment> <object-id pub-id-type="pmid">19554080</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005054.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Szepesvári</surname> <given-names>C</given-names></name>. <article-title>Algorithms for reinforcement learning</article-title>. <source>Synthesis lectures on artificial intelligence and machine learning</source>. <year>2010</year>;<volume>4</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>103</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.2200/S00268ED1V01Y201005AIM009" xlink:type="simple">10.2200/S00268ED1V01Y201005AIM009</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005054.ref031">
<label>31</label>
<mixed-citation publication-type="other" xlink:type="simple">Riedmiller M. Neural Fitted Q Iteration—First experiences with a data efficient neural Reinforcement Learning Method. In: Lecture Notes in Computer Science: Proc. of the European Conference on Machine Learning, ECML 2005. Porto, Portugal; 2005. p. 317–328.</mixed-citation>
</ref>
<ref id="pcbi.1005054.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mnih</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Kavukcuoglu</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Silver</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Rusu</surname> <given-names>AA</given-names></name>, <name name-style="western"><surname>Veness</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Bellemare</surname> <given-names>MG</given-names></name>, <etal>et al</etal>. <article-title>Human-level control through deep reinforcement learning</article-title>. <source>Nature</source>. <year>2015</year>;<volume>518</volume>(<issue>7540</issue>):<fpage>529</fpage>–<lpage>533</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature14236" xlink:type="simple">10.1038/nature14236</ext-link></comment> <object-id pub-id-type="pmid">25719670</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005054.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ernst</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Geurts</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Wehenkel</surname> <given-names>L</given-names></name>. <article-title>Tree-based batch mode reinforcement learning</article-title>. <source>Journal of Machine Learning Research</source>. <year>2005</year>;<volume>6</volume>(<issue>Apr</issue>):<fpage>503</fpage>–<lpage>556</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005054.ref034">
<label>34</label>
<mixed-citation publication-type="other" xlink:type="simple">Guez A, Vincent RD, Avoli M, Pineau J. Adaptive Treatment of Epilepsy via Batch-mode Reinforcement Learning. In: Proceedings of the Twenty-Third AAAI Conference on Artificial Intelligence, AAAI 2008, Chicago, Illinois, USA, July 13–17; 2008. p. 1671–1678. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.aaai.org/Library/IAAI/2008/iaai08-008.php" xlink:type="simple">http://www.aaai.org/Library/IAAI/2008/iaai08-008.php</ext-link>.</mixed-citation>
</ref>
</ref-list>
</back>
</article>