<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN">
  <front>
    <journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher>
        <publisher-name>Public Library of Science</publisher-name>
        <publisher-loc>San Francisco, USA</publisher-loc>
      </publisher></journal-meta>
    <article-meta><article-id pub-id-type="publisher-id">PCOMPBIOL-D-11-01165</article-id><article-id pub-id-type="doi">10.1371/journal.pcbi.1002373</article-id><article-categories>
        <subj-group subj-group-type="heading">
          <subject>Research Article</subject>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Biology</subject>
          <subj-group>
            <subject>Computational biology</subject>
            <subj-group>
              <subject>Genomics</subject>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Genomics</subject>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline">
          <subject>Genetics and Genomics</subject>
          <subject>Computational Biology</subject>
        </subj-group>
      </article-categories><title-group><article-title>Joint Analysis of Multiple Metagenomic Samples</article-title><alt-title alt-title-type="running-head">Joint Analysis of Multiple Metagenomic Samples</alt-title></title-group><contrib-group>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Baran</surname>
            <given-names>Yael</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Halperin</surname>
            <given-names>Eran</given-names>
          </name>
          <xref ref-type="aff" rid="aff2">
            <sup>2</sup>
          </xref>
          <xref ref-type="aff" rid="aff3">
            <sup>3</sup>
          </xref>
          <xref ref-type="corresp" rid="cor1">
            <sup>*</sup>
          </xref>
        </contrib>
      </contrib-group><aff id="aff1"><label>1</label><addr-line>School of Computer Science, Tel-Aviv University, Tel-Aviv, Israel</addr-line>       </aff><aff id="aff2"><label>2</label><addr-line>School of Computer Science and the Department of Molecular Microbiology and Biotechnology, Tel-Aviv University, Tel-Aviv, Israel</addr-line>       </aff><aff id="aff3"><label>3</label><addr-line>International Computer Science Institute, Berkeley, California, Unites States of America</addr-line>       </aff><contrib-group>
        <contrib contrib-type="editor" xlink:type="simple">
          <name name-style="western">
            <surname>Ponting</surname>
            <given-names>Chris P.</given-names>
          </name>
          <role>Editor</role>
          <xref ref-type="aff" rid="edit1"/>
        </contrib>
      </contrib-group><aff id="edit1">University of Oxford, United Kingdom</aff><author-notes>
        <corresp id="cor1">* E-mail: <email xlink:type="simple">heran@post.tau.ac.il</email></corresp>
        <fn fn-type="con">
          <p>Conceived and designed the experiments: YB EH. Performed the experiments: YB. Analyzed the data: YB. Wrote the paper: YB EH.</p>
        </fn>
      <fn fn-type="conflict">
        <p>The authors have declared that no competing interests exist.</p>
      </fn></author-notes><pub-date pub-type="collection">
        <month>2</month>
        <year>2012</year>
      </pub-date><pub-date pub-type="epub">
        <day>16</day>
        <month>2</month>
        <year>2012</year>
      </pub-date><volume>8</volume><issue>2</issue><elocation-id>e1002373</elocation-id><history>
        <date date-type="received">
          <day>5</day>
          <month>8</month>
          <year>2011</year>
        </date>
        <date date-type="accepted">
          <day>20</day>
          <month>12</month>
          <year>2011</year>
        </date>
      </history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2012</copyright-year><copyright-holder>Baran, Halperin</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract>
        <p>The availability of metagenomic sequencing data, generated by sequencing DNA pooled from multiple microbes living jointly, has increased sharply in the last few years with developments in sequencing technology. Characterizing the contents of metagenomic samples is a challenging task, which has been extensively attempted by both supervised and unsupervised techniques, each with its own limitations. Common to practically all the methods is the processing of single samples only; when multiple samples are sequenced, each is analyzed separately and the results are combined. In this paper we propose to perform a combined analysis of a set of samples in order to obtain a better characterization of each of the samples, and provide two applications of this principle. First, we use an unsupervised probabilistic mixture model to infer hidden components shared across metagenomic samples. We incorporate the model in a novel framework for studying association of microbial sequence elements with phenotypes, analogous to the genome-wide association studies performed on human genomes: We demonstrate that stratification may result in false discoveries of such associations, and that the components inferred by the model can be used to correct for this stratification. Second, we propose a novel read clustering (also termed “binning”) algorithm which operates on multiple samples simultaneously, leveraging on the assumption that the different samples contain the same microbial species, possibly in different proportions. We show that integrating information across multiple samples yields more precise binning on each of the samples. Moreover, for both applications we demonstrate that given a fixed depth of coverage, the average per-sample performance generally increases with the number of sequenced samples as long as the per-sample coverage is high enough.</p>
      </abstract><abstract abstract-type="summary">
        <title>Author Summary</title>
        <p>Microorganisms are extremely abundant and diverse, and occupy almost every habitat on earth. Most of these habitats contain a complex mixture of many different microorganisms, and the characterization of these metagenomic mixtures, in terms of both taxonomy and function, is of great interest to science and medicine. Current sequencing technologies produce large numbers of short DNA reads copied from the genomes of a metagenomic sample, which can be used to obtain a high resolution characterization of such samples. However, the analysis of such data is complicated by the fact that one cannot tell which sequencing reads originated from the same genome. We show that the joint analysis of multiple metagenomic samples, which takes advantage of the fact that the samples share common microbial types, achieves better single-sample characterization compared to the current analysis methods that operate on single samples only. We demonstrate how this approach can be used to infer microbial components without the use of external sequence data, and to cluster sequencing reads according to their species of origin. In both cases we show that the joint analysis enhances the average single-sample performance, thus providing better sample characterization.</p>
      </abstract><funding-group><funding-statement>E.H. is a faculty fellow of the Edmond J. Safra Bioinformatics program at Tel-Aviv University. Y.B. was supported by the Edmond J. Safra fellowship. E.H. and Y.B were also supported by the Israel Science Foundation grant no. 04514831. Y.B was also supported by the IBM Open Collaborative Research Program. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts>
        <page-count count="11"/>
      </counts></article-meta>
  </front>
  <body>
    <sec id="s1">
      <title>Introduction</title>
      <p>Metagenomic samples are pooled samples of the genomes of multiple microorganisms living in the same environment. They can be taken either from the outer environment or from microbial populations colonizing other living organisms. Metagenomic studies focus on the taxonomic and functional characterization of the microbial populations contained in such samples. These studies have been boosted by advances in Next Generation Sequencing (NGS) technologies. Particularly, Whole Genome Shotgun (WGS) sequencing provides reads sampled randomly along the genomes, and enables simultaneous phylogenetic and functional analysis of the samples. Although WGS datasets contain plenty of information, they are hard to decipher, as we will further explain below. In a nutshell, the natural way to explore their composition is by aligning the sequencing reads against known databases of whole genomes or of marker genes, however these databases are seriously limited and biased. In addition, one cannot a-priori tell which reads originated from the same genome, and therefore many methods attempt to cluster the reads according to species of origin as a preliminary stage; unsupervised binning methods face an especially hard challenge, and are currently practiced mostly on extremely simple or simulated datasets.</p>
      <p>Along with the increasing availability of single-metagenome WGS datasets, datasets consisting of multiple metagenomic samples are also becoming abundant. These datasets typically include samples taken from similar environments, such as ocean water sampled from different locations or depths <xref ref-type="bibr" rid="pcbi.1002373-Rusch1">[1]</xref>, or microbiomic samples taken from a group of human individuals <xref ref-type="bibr" rid="pcbi.1002373-Qin1">[2]</xref>. To date, the primary analysis of the resulting sequences is performed separately for each sample. Our principal observation is that combining information from multiple samples improves the characterization of each of the samples. We give two demonstrations of this principle: First, we present a method for the unsupervised characterization and quantification of shared hidden components across samples. Second, we present a binning method that operates on multiple samples simultaneously in order to achieve high per-sample precision.</p>
      <p>We consider an unsupervised learning approach, in which we aim at learning the shared components of the different samples in an attempt to answer the prominent question of metagenomics, “what's in the mix”, without relying on any prior knowledge. While the use of stored sequences of whole genomes <xref ref-type="bibr" rid="pcbi.1002373-Huson1">[3]</xref> or of marker genes, such as the 16S rRNA subunit <xref ref-type="bibr" rid="pcbi.1002373-Hamady1">[4]</xref>, is currently the most effective way of analyzing large-scale metagenomic samples, it is considerably hindered by the incompleteness of existing databases: In addition to including only a small fraction of the species expected to be found in the samples, the set of species which these databases do include is highly biased, and this bias in turn causes a bias in the analysis results. Supervised analyses also often assume that the properties of the samples which are of biological or medical interest correspond to known taxonomic or functional annotations, although this is not necessarily the case. An intriguing counter-example is the recently discovered <italic>enterotype</italic> classes <xref ref-type="bibr" rid="pcbi.1002373-Arumugam1">[5]</xref>, which are three robust classes to which human gut metagenomic samples can be classified. Although generated using a supervised technique, these classes are characterized by a complex combination of the abundance of many bacterial species, which do not correspond to specific taxonomic units.</p>
      <p>Aiming to avoid these disadvantages, we developed a method for the inference of hidden components within the data, which leverages on the fact that these unknown components are shared by the different samples. Each of the components is characterized by its sequence composition pattern, specifically the frequency of different short <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e001" xlink:type="simple"/></inline-formula>-mer words in the sequence, which is known to characterize bacteria at different phylogenetic scales <xref ref-type="bibr" rid="pcbi.1002373-Karlin1">[6]</xref>, <xref ref-type="bibr" rid="pcbi.1002373-Takahashi1">[7]</xref>. Due to the unsupervised nature of the method, we do not expect the components to represent any easily-interpretable biological entity, but instead to provide a composite characterization of the samples. Unlike the enterotypes clustering procedure, our method does not require an alignment stage and does not classify the samples to distinct classes. Instead, we search for the best components that explain the data, and each sample is assigned a distribution over these components; this is done by utilizing Probabilistic Latent Semantic Analysis (PLSA) <xref ref-type="bibr" rid="pcbi.1002373-Hofmann1">[8]</xref>, a technique applied to fields such as information retrieval and natural language processing. Despite these differences, there are some correlations between the inferred components and the enterotypes, which we mention in the Discussion.</p>
      <p>Unsupervised component estimation can be used for multiple purposes, and we choose to demonstrate its applicability to a new paradigm for studying statistical association between metagenomic content and phenotypes, which we now introduce. We look for DNA words - long <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e002" xlink:type="simple"/></inline-formula>-mers - whose abundance in the sequencing reads of the different samples correlate with the phenotype at question. For large enough <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e003" xlink:type="simple"/></inline-formula>, differences in the abundance of certain <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e004" xlink:type="simple"/></inline-formula>-mers would capture differences in the abundance of specific species, genes or functional domains which cause the phenotype or are affected by it.</p>
      <p>The proposed framework is analogous to the widely used paradigm of Genome Wide Association Studies (GWAS), which is used to test for associations between genetic variants in the human genome and phenotypes. In a typical GWAS the frequency of millions of variants, spanning the entire genome, is compared between a group of cases and a group of controls, and variants whose frequencies differ significantly between the two are considered to be statistically associated with the condition. In the context of metagenomic association, the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e005" xlink:type="simple"/></inline-formula>-mers are analogous to the genetic variants studied in GWAS, and in both applications the goal is to find statistically significant associations between the measured variants and the condition. However, while GWAS searches for specific mutations which are associated with increased risk for the condition, we aim to capture modifications in the bacterial composition - functional or taxonomic - which are associated with the disease. As in the case of GWAS, the advantages of our approach are its computational efficiency, statistical rigor, cross-study comparability, and the fact that it does not require a supervised stage or comparison to existing databases.</p>
      <p>Interestingly, when testing this approach on a publicly available dataset <xref ref-type="bibr" rid="pcbi.1002373-Qin1">[2]</xref> containing 124 deeply sequenced samples of human gut microbiomes collected as part of the MetaHIT (Metagenomics of the Human Intestinal Tract) project, we found that the abundance of a large fraction of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e006" xlink:type="simple"/></inline-formula>-mers vary with some of the phenotypes, even for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e007" xlink:type="simple"/></inline-formula> as small as 3. In the GWAS context this is known as a case of stratification: the null hypothesis of equal distribution between phenotype groups does not hold for the typical variant. For example, when the case and control groups have different ethnic composition, the minor allele frequency of an exceptionally large number of Single Nucleotide Polymorphisms (SNPs) may appear correlated with the disease, but these correlations reflect the fundamental genetic difference between the groups, instead of being relevant to the disease.</p>
      <p>In order to correct for the stratification and conduct a proper association analysis, we integrate into the association test the estimates provided by the probabilistic model, specifically the estimated proportion of each component within each sample. We chose to characterize the components according to the short <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e008" xlink:type="simple"/></inline-formula>-mers distribution in the samples. Recently, Meinicke et al. <xref ref-type="bibr" rid="pcbi.1002373-Meinicke1">[9]</xref> propose to model the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e009" xlink:type="simple"/></inline-formula>-mers distribution of a single metagenomic sample as a mixture over the distributions of already-sequenced genomes; however, the use of multiple samples in our method allows our method to remain unsupervised.</p>
      <p>As a second demonstration of the joint analysis approach we consider the task of binning sequence reads into an unknown set of species. Binning is an important preliminary step for further metagenomic analysis, and has been heavily investigated in the past few years, including the development of multiple unsupervised methods <xref ref-type="bibr" rid="pcbi.1002373-Teeling1">[10]</xref>–<xref ref-type="bibr" rid="pcbi.1002373-Wu1">[16]</xref>; however, all existing methods operate on single samples only. We suggest an unsupervised coverage-based approach, and demonstrate that when the samples share a common species core, information can be integrated between them to improve binning precision. In other words, if one wishes to bin a given sample, then the simultaneous binning of other samples would yield better precision for the original sample. Moreover, we show that for a fixed depth of coverage, dividing the sequencing reads between additional related samples improves precision on the sample of interest.</p>
    </sec>
    <sec id="s2" sec-type="methods">
      <title>Methods</title>
      <sec id="s2a">
        <title>Association test for metagenomes</title>
        <p>Over the last few years, there have been many reports of associations between the content of metagenomic samples, especially human microbiomic samples, and phenotypes. Different studies report associations with different properties of the samples, such as the abundance of certain taxonomic units, mostly phyla and species, the overall taxonomic and functional diversity of the samples, and the abundance of certain genes or groups of genes, such as those participating in specific metabolic pathways (see Turnbaugh et al. <xref ref-type="bibr" rid="pcbi.1002373-Turnbaugh1">[17]</xref> for a comprehensive study of obesity which tested most of these properties). In addition, dimensionality reduction techniques such as PCA <xref ref-type="bibr" rid="pcbi.1002373-Jolliffe1">[18]</xref> are often used on top of the raw data. While examining many properties of the samples allows to capture a wide range of associations, it is not always possible to accumulate results over different studies, in order to perform meta-analysis. In addition, it is hard to perform a rigorous statistical analysis, and especially to control for multiple hypotheses, when many different types of tests are carried out.</p>
        <p>As a more rigorous approach, we propose to test the abundance of all possible DNA words of a fixed length for association with the phenotype. This test examines a limited but well-defined group of variants, and hence while it is not expected to capture the entire spectrum of possible associations, its results are statistically robust and easy to compare across studies and accumulate for future meta-analysis studies. It does not require alignment or comparison against any existing database, and therefore it can capture associations with unannotated sequences; due to the latter, the test is also fast and easy to implement.</p>
        <p>Formally, for a given value of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e010" xlink:type="simple"/></inline-formula>, the number of occurrences of all <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e011" xlink:type="simple"/></inline-formula>-mers across each of the samples are normalized to obtain sample-specific relative abundances. The counts of complementary <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e012" xlink:type="simple"/></inline-formula>-mers are summed together as they are indistinguishable in the sequencing data. We denote by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e013" xlink:type="simple"/></inline-formula> the relative abundance of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e014" xlink:type="simple"/></inline-formula>-mer <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e015" xlink:type="simple"/></inline-formula> in sample <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e016" xlink:type="simple"/></inline-formula>, and by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e017" xlink:type="simple"/></inline-formula> the phenotype of sample <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e018" xlink:type="simple"/></inline-formula>. We test the association between the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e019" xlink:type="simple"/></inline-formula>-mer and the phenotype by fitting a regression model of the form<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e020" xlink:type="simple"/><label>(1)</label></disp-formula>For a given phenotype <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e021" xlink:type="simple"/></inline-formula> we solve the model for each <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e022" xlink:type="simple"/></inline-formula>-mer <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e023" xlink:type="simple"/></inline-formula> by generating the appropriate vector <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e024" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e025" xlink:type="simple"/></inline-formula> is the number of samples. We use simple regression and logistic regression for continuous and dichotomous phenotypes respectively.</p>
        <p>In the Results section we report that some phenotypes are correlated with a large fraction of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e026" xlink:type="simple"/></inline-formula>-mers. These correlations reflect large-scale differences in the genetic composition of the samples between the phenotype groups; specifically, a plausible assumption is that there exists a group of common microbial components, and that each sample is a mixture of these components, in unique proportions. The components might be, for example, different bacterial phyla, and a certain phenotype might correlate with a higher proportion of a certain phylum; since there are differences in sequence composition between the phyla, this would cause phenotype-correlated differences in the distributions of many <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e027" xlink:type="simple"/></inline-formula>-mers. However, we are interested not in the large-scale variation, but in the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e028" xlink:type="simple"/></inline-formula>-mers which remain correlated with the phenotype after taking this variation into account. Assuming there are <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e029" xlink:type="simple"/></inline-formula> components and denoting by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e030" xlink:type="simple"/></inline-formula> the proportion of component <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e031" xlink:type="simple"/></inline-formula> in sample <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e032" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e033" xlink:type="simple"/></inline-formula>, the estimation of the matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e034" xlink:type="simple"/></inline-formula> would allow us to construct a corrected model:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e035" xlink:type="simple"/><label>(2)</label></disp-formula></p>
        <p>This equation is similar to equation 1 but includes the additional confounding components as covariates. For a given phenotype <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e036" xlink:type="simple"/></inline-formula>, we again solve the model for each k-mer while keeping the covariate expressions fixed. Due to this addition, the association of a <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e037" xlink:type="simple"/></inline-formula>-mer whose association with the phenotype is explained by the covariates will not be statistically significant, as desired. Note that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e038" xlink:type="simple"/></inline-formula> is not included in the equation because of the linear dependency <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e039" xlink:type="simple"/></inline-formula>.</p>
      </sec>
      <sec id="s2b">
        <title>Probabilistic model for stratification</title>
        <p>In order to estimate <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e040" xlink:type="simple"/></inline-formula> we use the following probabilistic model. We assume that the sequencing reads for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e041" xlink:type="simple"/></inline-formula> metagenomic samples are given, and that the DNA content of the samples is composed of a common set of components; each read has originated from one of the components, and each component is characterized by a typical distribution over the group of all possible <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e042" xlink:type="simple"/></inline-formula>-mers in the sequence, for some fixed small value of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e043" xlink:type="simple"/></inline-formula> (e.g., <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e044" xlink:type="simple"/></inline-formula>). The model is parametrized by two row-stochastic matrices, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e045" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e046" xlink:type="simple"/></inline-formula>: the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e047" xlink:type="simple"/></inline-formula>th row of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e048" xlink:type="simple"/></inline-formula>, denoted <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e049" xlink:type="simple"/></inline-formula>, defines a sample-specific multinomial distribution over all components, and the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e050" xlink:type="simple"/></inline-formula>th row of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e051" xlink:type="simple"/></inline-formula>, denoted <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e052" xlink:type="simple"/></inline-formula>, defines a component-specific multinomial distribution over <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e053" xlink:type="simple"/></inline-formula>, the group of all <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e054" xlink:type="simple"/></inline-formula>-mers. When we sample a short <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e055" xlink:type="simple"/></inline-formula>-mer from a random position on the reads of sample <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e056" xlink:type="simple"/></inline-formula>, we first sample a component <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e057" xlink:type="simple"/></inline-formula> according to the distribution <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e058" xlink:type="simple"/></inline-formula>, and then sample the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e059" xlink:type="simple"/></inline-formula>-mer according to the distribution <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e060" xlink:type="simple"/></inline-formula>. Being defined as general multinomial distribution, some entries in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e061" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e062" xlink:type="simple"/></inline-formula> may have a zero value; in particular, some components might not be represented in some of the samples.</p>
        <p>We note that while the previous subsection discussed long <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e063" xlink:type="simple"/></inline-formula>-mers (e.g., <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e064" xlink:type="simple"/></inline-formula>), which are each tested for association with the phenotypes, in this section we use short <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e065" xlink:type="simple"/></inline-formula>-mers as characteristics of the components we attempt to learn. Specifically, we chose to use <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e066" xlink:type="simple"/></inline-formula> = 4 since it has been shown that 4-mer distributions are characteristic of phylogenetic units <xref ref-type="bibr" rid="pcbi.1002373-Karlin1">[6]</xref>, <xref ref-type="bibr" rid="pcbi.1002373-Takahashi1">[7]</xref>, and since the 4-mer distribution captures both the codon distribution and possible codon biases.</p>
        <p>We now turn to calculate the likelihood of the metagenomic data. Since the model explains the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e067" xlink:type="simple"/></inline-formula>-mer distribution in the reads, we extract the first <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e068" xlink:type="simple"/></inline-formula>-mer from each read, and denote by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e069" xlink:type="simple"/></inline-formula> the number of times <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e070" xlink:type="simple"/></inline-formula>-mer <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e071" xlink:type="simple"/></inline-formula> was extracted from sample <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e072" xlink:type="simple"/></inline-formula>. The likelihood of the counts data <italic>R</italic> is<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e073" xlink:type="simple"/><label>(3)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e074" xlink:type="simple"/></inline-formula> is the number of samples, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e075" xlink:type="simple"/></inline-formula> is the number of components, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e076" xlink:type="simple"/></inline-formula> is the group of all possible <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e077" xlink:type="simple"/></inline-formula>-mers, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e078" xlink:type="simple"/></inline-formula> as the counts for complementary <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e079" xlink:type="simple"/></inline-formula>-mers are joined. Our goal is to estimate the distributions in the matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e080" xlink:type="simple"/></inline-formula>, which are the distributions over the components for each sample.</p>
        <p>We note that there is a simple relation between <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e081" xlink:type="simple"/></inline-formula> and the above notation, given by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e082" xlink:type="simple"/></inline-formula>. Furthermore, under the model assumptions, we have that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e083" xlink:type="simple"/></inline-formula>. One can verify that if there is a solution such that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e084" xlink:type="simple"/></inline-formula>, then this solution maximizes the likelihood in Equation 3. Thus, we can view the maximization of the likelihood function as an approximation of the factorization of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e085" xlink:type="simple"/></inline-formula> matrix, which is row-stochastic, into two other row-stochastic matrices:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e086" xlink:type="simple"/></disp-formula>This factorization corresponds to a set of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e087" xlink:type="simple"/></inline-formula> linear equations, to which each additional sample adds <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e088" xlink:type="simple"/></inline-formula> variables but also a much larger number of equations - <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e089" xlink:type="simple"/></inline-formula>; this could serve as an intuition for the advantage conveyed by sample multiplicity. In addition, this factorization is a variant of the non-negative matrix factorization (NMF) technique, with the added stochasticity constraints (so that the sum of each row in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e090" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e091" xlink:type="simple"/></inline-formula> is 1). NMF is used to unveil hidden structures within data, and its major advantage over methods such as the widely-used PCA is the high interpretability of the inferred components <xref ref-type="bibr" rid="pcbi.1002373-Lee1">[19]</xref>. A recent paper <xref ref-type="bibr" rid="pcbi.1002373-Jiang1">[20]</xref> used NMF in a metagenomic context, however the factorized data matrix was generated using alignment to sequenced genomes, in contrast to our method which does not rely on prior knowledge. The stochasticity constraints turn our model to an exact instantiation of PLSA <xref ref-type="bibr" rid="pcbi.1002373-Hofmann1">[8]</xref>, <xref ref-type="bibr" rid="pcbi.1002373-Hofmann2">[21]</xref>, a generative model from the statistical literature. PLSA was originally applied to the field of text analysis for the discovery of topics in a corpus of documents <xref ref-type="bibr" rid="pcbi.1002373-Hofmann3">[22]</xref>. Due to its great flexibility, it was successfully applied to multiple problems in the field of text learning <xref ref-type="bibr" rid="pcbi.1002373-Cohn1">[23]</xref>–<xref ref-type="bibr" rid="pcbi.1002373-Brants1">[25]</xref> as well as to image content analysis tasks <xref ref-type="bibr" rid="pcbi.1002373-Sivic1">[26]</xref>.While strong similarities exist between PLSA and NMF, the fact that PLSA is based on a probabilistic model allows us to refine the model to better match the properties of the sequencing data, as we do below.</p>
        <p>In the above procedure we extract only the first <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e092" xlink:type="simple"/></inline-formula>-mer from each read because the model assumes that the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e093" xlink:type="simple"/></inline-formula>-mers are sampled independently according to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e094" xlink:type="simple"/></inline-formula>, conditioned on the read's component. Extracting multiple <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e095" xlink:type="simple"/></inline-formula>-mers would result in a deviation from the model due to the dependencies between neighboring <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e096" xlink:type="simple"/></inline-formula>-mers on the same read, as well as dependencies between <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e097" xlink:type="simple"/></inline-formula>-mers extracted from multiple reads covering the same genomic region.</p>
        <p>Interestingly, the simulations presented in the Results section demonstrate that extracting multiple <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e098" xlink:type="simple"/></inline-formula>-mers from the same read improves performance, despite the dependencies. The reason is that under reasonable coverage and when <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e099" xlink:type="simple"/></inline-formula> is not too large, the relative abundances <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e100" xlink:type="simple"/></inline-formula> approach a constant value, and the exact sampling strategy has no effect on the final counts data. It is therefore of benefit to extract multiple <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e101" xlink:type="simple"/></inline-formula>-mers from each read when processing the sequencing reads, however it turns out that the best strategy is to choose not all <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e102" xlink:type="simple"/></inline-formula>-mers present on the read but only a subset, while using a slightly different model, as we explain next.</p>
        <sec id="s2b1">
          <title>A refined model</title>
          <p>Once multiple <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e103" xlink:type="simple"/></inline-formula>-mers from the same read are used, the model can be refined to reflect the fact that all <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e104" xlink:type="simple"/></inline-formula>-mers extracted from the same read were sampled from the same component. The likelihood function below entails this information:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e105" xlink:type="simple"/><label>(4)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e106" xlink:type="simple"/></inline-formula> is the set of all reads sampled from sample <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e107" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e108" xlink:type="simple"/></inline-formula> is the multiset of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e109" xlink:type="simple"/></inline-formula>-mers extracted from read <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e110" xlink:type="simple"/></inline-formula>.</p>
          <p>The refined model, like the previous model, assumes that the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e111" xlink:type="simple"/></inline-formula>-mers on a read are sampled independently given the component, but unlike the previous model, the refined model is sensitive to deviations from this assumption. The reason is that the refined model assigns each read to a component, as opposed to each <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e112" xlink:type="simple"/></inline-formula>-mer, and is therefore more prone to local distortions in the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e113" xlink:type="simple"/></inline-formula>-mer distribution which result from the dependencies. As we show in the Results section, an effective way to alleviate this problem is to sample a smaller number of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e114" xlink:type="simple"/></inline-formula>-mers which are more sparsely dispersed along the read. As a result, sampling a relatively small number of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e115" xlink:type="simple"/></inline-formula>-mers from each read and using the refined model turns out to be an effective strategy for using the sequencing reads in order to estimate <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e116" xlink:type="simple"/></inline-formula>.</p>
        </sec>
      </sec>
      <sec id="s2c">
        <title>Parameter estimation using EM</title>
        <p>We use Expectation-Maximization algorithms in order to approximate the maximum likelihood solutions of both the original model (defined in Equation 3) and the refined model (Equation 4), beginning with the refined. The observed variables are groups of extracted <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e117" xlink:type="simple"/></inline-formula>-mers, one group for each read, and the latent variables are the assignments of a component to each of the reads. Let <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e118" xlink:type="simple"/></inline-formula> be the unknown assignments, and let <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e119" xlink:type="simple"/></inline-formula> be the number of occurrences of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e120" xlink:type="simple"/></inline-formula>-mer <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e121" xlink:type="simple"/></inline-formula> in the multiset of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e122" xlink:type="simple"/></inline-formula>-mers extracted from read <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e123" xlink:type="simple"/></inline-formula>, denoted <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e124" xlink:type="simple"/></inline-formula>. The algorithm can now be written as</p>
        <p><bold>E-step:</bold><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e125" xlink:type="simple"/></disp-formula>where<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e126" xlink:type="simple"/></disp-formula><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e127" xlink:type="simple"/></disp-formula></p>
        <p>
          <bold>M-step:</bold>
          <disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e128" xlink:type="simple"/></disp-formula>
          <disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e129" xlink:type="simple"/></disp-formula>
        </p>
        <p>The running time of each iteration of the above algorithm is <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e130" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e131" xlink:type="simple"/></inline-formula> being the number of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e132" xlink:type="simple"/></inline-formula>-mers extracted from each read. For realistic values of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e133" xlink:type="simple"/></inline-formula> this is time consuming. In addition, for large datasets the entire data cannot fit in memory. Consider, for example, the case where the number of individuals is <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e134" xlink:type="simple"/></inline-formula>, the number of reads per individual is <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e135" xlink:type="simple"/></inline-formula>, and all non-overlapping <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e136" xlink:type="simple"/></inline-formula>-mers from reads of length <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e137" xlink:type="simple"/></inline-formula> bp are used. In this case, the amount of memory required is at least <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e138" xlink:type="simple"/></inline-formula> GB, even if every nucleotide letter is stored in two bits. We note that by changing the order of the summation, one can use a considerably smaller amount of memory, however in each iteration of the EM the entire dataset will have to be read again to memory. Therefore, when analyzing large datasets we recommend to use the simpler model, described by Equation 3, which ignores the relation between <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e139" xlink:type="simple"/></inline-formula>-mers on the same read. The input counts <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e140" xlink:type="simple"/></inline-formula> are extracted in a single pass through the data. The latent variables <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e141" xlink:type="simple"/></inline-formula> are the assignments of each pair (sample, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e142" xlink:type="simple"/></inline-formula>-mer) to a component, and the EM algorithm is as follows:</p>
        <p><bold>E-step:</bold><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e143" xlink:type="simple"/></disp-formula>where<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e144" xlink:type="simple"/></disp-formula><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e145" xlink:type="simple"/></disp-formula></p>
        <p>The M-step is similar to the one described for the refined model. Note that the running time of each iteration of the EM algorithm is now <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e146" xlink:type="simple"/></inline-formula>, and it is therefore very efficient as long as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e147" xlink:type="simple"/></inline-formula> is fixed.</p>
      </sec>
      <sec id="s2d">
        <title>Binning algorithm</title>
        <p>The model we presented infers common components in the samples but does not assign the reads to these components; it provides for each read a probability distribution over the components that could be used for an assignment, but in general is not optimized for this goal. Such assignment, or binning, is an important preliminary step in the analysis of metagenomic samples, especially binning according to species of origin. We therefore devised an unsupervised algorithm which performs binning over multiple samples simultaneously, again leveraging on sample similarity, this time assuming a common species core. Most previous unsupervised binning methods are based on sequence composition <xref ref-type="bibr" rid="pcbi.1002373-Teeling1">[10]</xref>–<xref ref-type="bibr" rid="pcbi.1002373-Leung1">[15]</xref>. For example, CompostBin <xref ref-type="bibr" rid="pcbi.1002373-Chatterji1">[11]</xref> computes for each read its 6-mer distribution, similarly to the process performed by our component inference algorithm, and clusters these distributions using spectral methods. The main limitation of composition-based approaches is that they require relatively long reads (1000 bp in the case of CompostBin) due to the variance in sequence properties along the genome. Recently, a coverage-based method, AbundanceBin, was developed <xref ref-type="bibr" rid="pcbi.1002373-Wu1">[16]</xref> with the advantage of being able to bin even very short reads (as small as 75 bp). Since it relies on abundance differences for binning, AbundanceBin is only able to discern between species whose abundance levels are considerably different (they report that a ratio of 2∶1 is required). Our algorithm is also coverage-based, but because it operates on multiple samples it can use abundance difference in any of the samples to tell between such species.</p>
        <p>Assume we are given <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e148" xlink:type="simple"/></inline-formula> metagenomic sequencing samples, consisting of a total of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e149" xlink:type="simple"/></inline-formula> bacterial species. We wish to divide the reads in all samples into <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e150" xlink:type="simple"/></inline-formula> bins that correspond to the species from which they were sequenced. The binning algorithm, which we term MultiBin, proceeds as follows:</p>
        <list list-type="order">
          <list-item>
            <p>Pool the reads from all the samples together, and perform pairwise alignment between all pairs. For each pair, check whether the alignment shows a long overlap between the two sequence reads, suggesting that the two reads originated from the same genome. Put differently, we generate a graph <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e151" xlink:type="simple"/></inline-formula>, where the set <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e152" xlink:type="simple"/></inline-formula> corresponds to the reads, and the set of edges <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e153" xlink:type="simple"/></inline-formula> corresponds to pairs of reads with a substantial overlap. In our experiments we demanded an overlap of at least 50 bases per sequence.</p>
          </list-item>
          <list-item>
            <p>Greedily find a maximal independent set in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e154" xlink:type="simple"/></inline-formula>. We call the reads in this set <italic>tags</italic> and denote it by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e155" xlink:type="simple"/></inline-formula>. Following this process each read <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e156" xlink:type="simple"/></inline-formula> is either a tag, or is affiliated with a single tag which substantially overlaps it, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e157" xlink:type="simple"/></inline-formula>. For each tag read <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e158" xlink:type="simple"/></inline-formula>, we denote by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e159" xlink:type="simple"/></inline-formula> the number of reads from sample <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e160" xlink:type="simple"/></inline-formula> which substantially overlap it (but are not necessarily tagged by it), and by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e161" xlink:type="simple"/></inline-formula> the vector <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e162" xlink:type="simple"/></inline-formula>.</p>
          </list-item>
          <list-item>
            <p>Perform k-medoids clustering on the set of vectors <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e163" xlink:type="simple"/></inline-formula>, starting from a random choice of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e164" xlink:type="simple"/></inline-formula> centers. Wait for convergence and divide the tags into bins according to the clustering result. Assign every non-tag read <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e165" xlink:type="simple"/></inline-formula> to the same bin to which <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e166" xlink:type="simple"/></inline-formula> was assigned.</p>
          </list-item>
        </list>
        <p>In the last stage, the distance between every two vectors <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e167" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e168" xlink:type="simple"/></inline-formula> was computed as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e169" xlink:type="simple"/></inline-formula>. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e170" xlink:type="simple"/></inline-formula>-medoids clustering was performed using a local search procedure, in which we start from a random choice of centers and attempt to improve the solution by swapping at least one of the centers with another vertex, until no further improvement can be made.</p>
        <p>The initial stage of distance computation takes <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e171" xlink:type="simple"/></inline-formula>, and each iteration of the clustering algorithm takes <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e172" xlink:type="simple"/></inline-formula>; in our experiments convergence was reached within three iterations or less. The running time of the alignment stage, as well as the size of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e173" xlink:type="simple"/></inline-formula>, depends on the composition of the mixtures. We note that clustering is performed only on the tag reads, whose number is approximately bounded by the sum of the genome sizes in the samples divided by the read length.</p>
        <p>The above procedure assumes that the number of species in the samples <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e174" xlink:type="simple"/></inline-formula> in known. In the Results section we describe a procedure for determining the number of species based on examining the clustering results for different numbers of bins.</p>
      </sec>
    </sec>
    <sec id="s3">
      <title>Results</title>
      <p>We evaluated our methods using both real data and simulated data. We used the MetaHIT dataset (downloaded from EBI, accession ERA000116), which includes over 0.5 terabases of sequence generated from the gut microbiomes of 124 European individuals using the Illumina Genome Analyzer technology. The average amount of sequence per individual is 4.5 gigabases, and the paired-end read length is 44 or 74, depending on the sample. We used the publicly available raw reads, which were obtained after filtering human and Illumina adapter contaminant reads and low quality reads. The sampled individuals vary on the following variables: country of origin (Denmark/Spain), age, BMI (Body Mass Index), gender, and status for infectious bowl diseases (Ulcerative Colitis/Crohn's disease/disease free). In the context of this paper all the variables will be referred to as phenotypes of the human host, although country and age are in fact determinants of the metagenomic content, instead of being affected by it.</p>
      <sec id="s3a">
        <title>Large differences in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e175" xlink:type="simple"/></inline-formula>-mer distributions between phenotype groups</title>
        <p>In the initial stage we simply compared, for each <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e176" xlink:type="simple"/></inline-formula>-mer, its relative abundance in different phenotype groups using a two-sample <italic>t</italic>-test. Surprisingly, the relative frequencies of many of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e177" xlink:type="simple"/></inline-formula>-mers are significantly correlated with many of the phenotypes. This is true even for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e178" xlink:type="simple"/></inline-formula> as small as 3: for example, the frequency of 69% of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e179" xlink:type="simple"/></inline-formula>-mers and of 61% of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e180" xlink:type="simple"/></inline-formula>-mers differs between the Spanish and the Danish samples at the 0.05 level. To the best of our knowledge, such dramatic differences in sequence composition between samples from different countries have not been observed previously. This effect might be partially due to differences in sample preparation and DNA extraction procedures, which are known to exist between the MetaHIT samples from the two countries; however, we also observed significant differences across phenotypes within each country: The frequency of 40% of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e181" xlink:type="simple"/></inline-formula>-mers differs between the Crohn and the healthy Spanish samples, and the frequency of 18% of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e182" xlink:type="simple"/></inline-formula>-mers differs between the 10 highest- and lowest-BMI Danish groups. Permuting the phenotype labels <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e183" xlink:type="simple"/></inline-formula> times yielded p-values of 0.0027, 0.0521 respectively for these fractions of rejected nulls.</p>
        <p>A possible concern regarding the counts statistics are possible biases in the GC content distribution of the reads. We note that unlike different single-genome samples, different metagenomic samples are not expected to contain the same sequence composition characteristics, and therefore normalizing for such biases is a challenging task. We note that in the context of an association study between a phenotype and the metagenome, it is possible to avoid this problem using a permutation test, at the expense of power reduction.</p>
      </sec>
      <sec id="s3b">
        <title>Multi-sample modeling of bacterial stratification</title>
        <p>The majority of the correlations between <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e184" xlink:type="simple"/></inline-formula>-mers and phenotypes are false positives resulting from a hidden stratification which confounds the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e185" xlink:type="simple"/></inline-formula>-mer distributions. In order to reveal the components and to quantify them, we solved the probabilistic model described in the Methods section. Because the MetaHIT dataset is large, we used the more efficient version of the algorithm (which solves Equation 3). The input to the algorithm is a counts matrix of size [124×136], detailing for each of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e186" xlink:type="simple"/></inline-formula> samples how many occurrences of each possible <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e187" xlink:type="simple"/></inline-formula>-mer it includes (there are only <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e188" xlink:type="simple"/></inline-formula> possible <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e189" xlink:type="simple"/></inline-formula>-mers, instead of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e190" xlink:type="simple"/></inline-formula>, because complementary strings are indistinguishable in the sequencing data). Since extracting multiple <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e191" xlink:type="simple"/></inline-formula>-mers from each read did not seem to considerably change the results in this particular case (this does not hold in general, as illustrated later), we used only the first, highest-quality <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e192" xlink:type="simple"/></inline-formula>-mer. The model was solved for three components (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e193" xlink:type="simple"/></inline-formula> = 3) by running EM multiple times from random starting points and choosing <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e194" xlink:type="simple"/></inline-formula> from the maximum-likelihood run. The solution <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e195" xlink:type="simple"/></inline-formula> provides, for each sample <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e196" xlink:type="simple"/></inline-formula>, the components proportions <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e197" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e198" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e199" xlink:type="simple"/></inline-formula>, such that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e200" xlink:type="simple"/></inline-formula>.</p>
        <p>We first tested each of the components <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e201" xlink:type="simple"/></inline-formula> for correlation with each of the phenotypes in the following regression model:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e202" xlink:type="simple"/><label>(5)</label></disp-formula>We solved this model for each phenotype <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e203" xlink:type="simple"/></inline-formula> and for each cluster <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e204" xlink:type="simple"/></inline-formula>, attempting to discover biologically meaningful components. Simple regression and logistic regression are used for continuous and dichotomous phenotypes, respectively. As can be seen in <xref ref-type="table" rid="pcbi-1002373-t001">Table 1</xref>, highly significant p-values were obtained for predicting country among healthy individuals and for predicting BMI among the Danish. These results remain consistent also after correcting for the other measured phenotypes by entering them as covariates into the regression models. Results significant at the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e205" xlink:type="simple"/></inline-formula> level were obtained also for predicting colitis and Crohn status among the Spanish. In the case of Crohn's disease, the power of the regression model was limited due to the small number of cases (only <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e206" xlink:type="simple"/></inline-formula>), but <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e207" xlink:type="simple"/></inline-formula> permutations yielded a p-value of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e208" xlink:type="simple"/></inline-formula>. <xref ref-type="fig" rid="pcbi-1002373-g001">Figure 1</xref> visually demonstrates the separation of Crohn cases and controls on the plane defined by the components proportions.</p>
        <fig id="pcbi-1002373-g001" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002373.g001</object-id>
          <label>Figure 1</label>
          <caption>
            <title>Crohn's disease status separates with components proportions.</title>
            <p>Each marker corresponds to an individual, red for Crohn-free and filled black for Crohn cases. The markers are positioned on the two-dimensional plane defined by the components proportions (there are three components but only two dimensions because the proportions sum to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e209" xlink:type="simple"/></inline-formula>). The Crohn-free individual at the bottom part of the figure is a colitis case.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002373.g001" xlink:type="simple"/>
        </fig>
        <table-wrap id="pcbi-1002373-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1002373.t001</object-id><label>Table 1</label><caption>
            <title>Significant correlations between components proportions and phenotypes.</title>
          </caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1002373-t001-1" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002373.t001" xlink:type="simple"/><table>
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" colspan="1" rowspan="1">predicted variable</td>
                <td align="left" colspan="1" rowspan="1">component 1</td>
                <td align="left" colspan="1" rowspan="1">component 2</td>
                <td align="left" colspan="1" rowspan="1">component 3</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" colspan="1" rowspan="1">country within healthy</td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e210" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e211" xlink:type="simple"/></inline-formula>)</td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e212" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e213" xlink:type="simple"/></inline-formula>)</td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e214" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e215" xlink:type="simple"/></inline-formula>)</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">BMI within Denmark</td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e216" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e217" xlink:type="simple"/></inline-formula>)</td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e218" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e219" xlink:type="simple"/></inline-formula>)</td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e220" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e221" xlink:type="simple"/></inline-formula>)</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">Colitis within Spain</td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e222" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e223" xlink:type="simple"/></inline-formula>)</td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e224" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e225" xlink:type="simple"/></inline-formula>)</td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e226" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e227" xlink:type="simple"/></inline-formula>)</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">Crohn within Spain</td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e228" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e229" xlink:type="simple"/></inline-formula>)</td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e230" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e231" xlink:type="simple"/></inline-formula>)</td>
                <td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e232" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e233" xlink:type="simple"/></inline-formula>)</td>
              </tr>
            </tbody>
          </table></alternatives><table-wrap-foot>
            <fn id="nt101">
              <label/>
              <p>The predicted variables were regressed on the proportions of each component separately. The table gives the regression p-values, and in parentheses the empirical p-values obtained by permuting the components proportions <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e234" xlink:type="simple"/></inline-formula> times while keeping the phenotypes constant.</p>
            </fn>
          </table-wrap-foot></table-wrap>
        <p>We note that we also solved the model for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e235" xlink:type="simple"/></inline-formula>. In these cases we found that the smallest per-component p-values, as well as the proportions of explained phenotypic variance captured by all components together, were similar to those obtained for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e236" xlink:type="simple"/></inline-formula>. We therefore report the estimates for three components throughout the paper.</p>
      </sec>
      <sec id="s3c">
        <title>The components estimates correct for stratification</title>
        <p>The results from the last section, showing that the components proportions are correlated with some of the phenotypes, suggest they indeed may be used to correct the association between these phenotypes and long <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e237" xlink:type="simple"/></inline-formula>-mers; we therefore attempted to perform this correction on <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e238" xlink:type="simple"/></inline-formula>-mers.</p>
        <p><xref ref-type="fig" rid="pcbi-1002373-g002">Figure 2</xref> demonstrates such a successful correction. Two quantile-quantile curves compare the uniform distribution to the distribution of the p-values obtained by testing association between all possible <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e239" xlink:type="simple"/></inline-formula>-mers and BMI within the Danish samples. The black curve shows the uncorrected p-values, and its shape reflects the fact that they are highly deflated. The red curve shows the p-values obtained by adding the components proportions to the regression equation; this curve approaches the identity, indicating that these statistics capture the variance in the phenotype explained by most of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e240" xlink:type="simple"/></inline-formula>-mers.</p>
        <fig id="pcbi-1002373-g002" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002373.g002</object-id>
          <label>Figure 2</label>
          <caption>
            <title>Association between </title>
            <p><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e241" xlink:type="simple"/></inline-formula><bold>-mers relative abundances and BMI can be corrected using the components proportions.</bold> Quantile-quantile curves comparing the uniform distribution to the distribution of the p-values for association between all <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e242" xlink:type="simple"/></inline-formula>-mers and BMI within the Danish samples. The uncorrected p-values are highly deflated (black), indicating that the abundance of many <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e243" xlink:type="simple"/></inline-formula>-mers is correlated with BMI. However, when the components proportions are added the the regression equation (red), the correlation disappears for most <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e244" xlink:type="simple"/></inline-formula>-mers.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002373.g002" xlink:type="simple"/>
        </fig>
      </sec>
      <sec id="s3d">
        <title>A comparison between the likelihood models</title>
        <p>We compared the precision of the two models, the original and the refined, utilizing different strategies for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e245" xlink:type="simple"/></inline-formula>-mer extraction. Performance was tested on simulated data, each simulation consisting of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e246" xlink:type="simple"/></inline-formula> mixtures of the following <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e247" xlink:type="simple"/></inline-formula> bacterial species: <italic>Listeria monocytogenes</italic> (phylum Firmicutes), <italic>Bacteroides vulgatus</italic> (phylum Bacteroidetes), <italic>Bifidobacterium longum</italic> (phylum Actinobacteria), <italic>Pseudomonas stutzeri</italic> (phylum Proteobacteria). The components distributions matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e248" xlink:type="simple"/></inline-formula> was randomly drawn from the uniform distribution and normalized to row-stochastic, and the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e249" xlink:type="simple"/></inline-formula>-mer distributions matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e250" xlink:type="simple"/></inline-formula> was computed from the actual genomes. For each sample 1,000 sequencing reads of length 100 bp were simulated by sampling a bacterium according to P, and then a random position in the genome of that bacterium as the starting point of the read. We chose a read length of 100 bp since it is currently a length that is obtained by most high-throughput sequencing technologies.</p>
        <p><xref ref-type="fig" rid="pcbi-1002373-g003">Figure 3</xref> compares the effect of extracting different subgroups of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e251" xlink:type="simple"/></inline-formula>-mers along each read and using them either in the original or in the refined model. Under the original model, extracting multiple <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e252" xlink:type="simple"/></inline-formula>-mers improves estimation precision of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e253" xlink:type="simple"/></inline-formula> compared with extracting only the first <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e254" xlink:type="simple"/></inline-formula>-mer; this is the case even when these <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e255" xlink:type="simple"/></inline-formula>-mers overlap, and are therefore highly correlated. Shifting to the refined model greatly improves the estimation precision when choosing all non-overlapping <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e256" xlink:type="simple"/></inline-formula>-mers along the read; however, even better results are obtained when using only nine sparsely dispersed <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e257" xlink:type="simple"/></inline-formula>-mers along the read, as using a small number of distant <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e258" xlink:type="simple"/></inline-formula>-mers decreases the dependencies of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e259" xlink:type="simple"/></inline-formula>-mer sequence between and within reads.</p>
        <fig id="pcbi-1002373-g003" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002373.g003</object-id>
          <label>Figure 3</label>
          <caption>
            <title>Strategies for </title>
            <p><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e260" xlink:type="simple"/></inline-formula><bold>-mer choice under the different models.</bold> Error is measured as the sum of squared differences between true and estimated <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e261" xlink:type="simple"/></inline-formula> matrices. The plot presents, for different error thresholds, the number of runs out of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e262" xlink:type="simple"/></inline-formula> which yielded a precision at least as small as the threshold. Using the original model, we extracted from each 100 bp read either the first <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e263" xlink:type="simple"/></inline-formula>-mer, 9 sparely dispersed <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e264" xlink:type="simple"/></inline-formula>-mer along it, 24 non-overlapping <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e265" xlink:type="simple"/></inline-formula>-mers or 96 overlapping <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e266" xlink:type="simple"/></inline-formula>-mers. Extracting multiple <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e267" xlink:type="simple"/></inline-formula>-mers can be seen to increase precision considerably. Shifting to the refined model yields an even better precision; since this model is more sensitive to dependencies between <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e268" xlink:type="simple"/></inline-formula>-mers, extracting only the fewer dispersed <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e269" xlink:type="simple"/></inline-formula>-mers is preferable over extracting all non-overlapping <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e270" xlink:type="simple"/></inline-formula>-mers.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002373.g003" xlink:type="simple"/>
        </fig>
      </sec>
      <sec id="s3e">
        <title>A comparison between PLSA and PCA</title>
        <p>PLSA is a dimensionality reduction method, and we therefore compared its performance to the widely used principal component analysis (PCA). PCA has been extensively used in metagenomic studies <xref ref-type="bibr" rid="pcbi.1002373-Qin1">[2]</xref>, <xref ref-type="bibr" rid="pcbi.1002373-Arumugam1">[5]</xref> for sample visualization and classification. We used the simplified setting in which the counts matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e271" xlink:type="simple"/></inline-formula> is generated from mixtures of multinomials: Setting <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e272" xlink:type="simple"/></inline-formula> we generated <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e273" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e274" xlink:type="simple"/></inline-formula> by drawing their entries from the uniform distribution followed by normalizing to row-stochastic, and then generated the counts matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e275" xlink:type="simple"/></inline-formula> by sampling each row <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e276" xlink:type="simple"/></inline-formula> according to the multinomial distribution specified in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e277" xlink:type="simple"/></inline-formula>, with varying numbers of counts per sample.</p>
        <p>Both PLSA and PCA were tested in the task of estimating the matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e278" xlink:type="simple"/></inline-formula>. Since PCA operates with no stochasticity constraints, we estimates precision as the average squared correlation coefficient (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e279" xlink:type="simple"/></inline-formula>) between the true vectors <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e280" xlink:type="simple"/></inline-formula> and either the three strongest principal components (for PCA) or the vectors <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e281" xlink:type="simple"/></inline-formula> (for PLSA). For both methods we chose the ordering of the components that yielded the highest score.</p>
        <p><xref ref-type="fig" rid="pcbi-1002373-g004">Figure 4</xref> shows that PLSA's estimates of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e282" xlink:type="simple"/></inline-formula> are considerably more accurate than those obtained by PCA. This result confirms that PLSA is indeed a more appropriate method for characterizing mixture components in our context.</p>
        <fig id="pcbi-1002373-g004" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002373.g004</object-id>
          <label>Figure 4</label>
          <caption>
            <title>PLSA approximates mixture coefficient better than PCA.</title>
            <p>PCA and PLSA were performed on a simulated counts matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e283" xlink:type="simple"/></inline-formula> with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e284" xlink:type="simple"/></inline-formula> and different number of per-sample counts. The plot shows the average squared correlation coefficient between the true vectors <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e285" xlink:type="simple"/></inline-formula> and the three strongest principal components (in the case of PCA) or PLSA estimates <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e286" xlink:type="simple"/></inline-formula>. For each per-sample counts value 20 experiments were performed, and the plot gives the mean result and the standard error of the mean. The estimates obtained by PLSA show higher correlation with the true mixture proportions.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002373.g004" xlink:type="simple"/>
        </fig>
      </sec>
      <sec id="s3f">
        <title>Joint binning over multiple samples</title>
        <p>Nine datasets, each consisting of five metagenomic samples, were generated using MetaSim <xref ref-type="bibr" rid="pcbi.1002373-Richter1">[27]</xref>. All samples in a given dataset contained the same set of bacterial species in different, randomly drawn proportions. The datasets differed in the number of species they contain, ranging from 2 species to 10 species in each sample of the most complex dataset. The species distribution of a sample containing <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e287" xlink:type="simple"/></inline-formula> species was generated incrementally by adding a random number sampled uniformly from [0,1] to the species proportions of an existing <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e288" xlink:type="simple"/></inline-formula> sample and normalizing to 1. In the first experiment we generated <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e289" xlink:type="simple"/></inline-formula> reads of length <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e290" xlink:type="simple"/></inline-formula> bp from each sample, and in the second experiment <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e291" xlink:type="simple"/></inline-formula> reads of length <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e292" xlink:type="simple"/></inline-formula> bp each. Overlaps between reads were determined by running BLAT <xref ref-type="bibr" rid="pcbi.1002373-Kent1">[28]</xref> and requiring an exact match at the edges of the reads; the BLAT parameters we used restricted the results to matches of length <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e293" xlink:type="simple"/></inline-formula> bp and above. Precision was computed as the fraction of reads assigned to the correct species, averaged over all species.</p>
        <p>We compared the precision obtained by MultiBin to the performance of AbundanceBin, a program implementing the equivalent coverage-based approach which was shown to perform precise binning of species exhibiting different abundance levels using reads of lengths 400 and 75 bp. AbundanceBin operates on single samples only, and therefore was run separately on each sample, while MultiBin was run on all five samples in each dataset simultaneously. We note that the separate execution of AbundanceBin conveys no information about the correspondence between the bins across samples, and so we chose the best matching between the bins and the species in each sample so as to maximize the total precision.</p>
        <p>As can be seen in <xref ref-type="fig" rid="pcbi-1002373-g005">Figure 5</xref>, MultiBin performs better than AbundanceBin over both read lengths and over all dataset complexities. For the 400 bp reads MultiBin maintains a precision of over 0.8 even for mixtures of five species. MultiBin is also able to bin the 75 bp reads, although with lesser success; we note that the ability to bin short reads is unique to coverage-based approaches, and that in principle there is no advantage in having longer reads, assuming the coverage is high enough. As for AbundanceBin, its performance on the simple mixtures exhibits high variation between samples because of its reliance on large abundance differences within each sample. AbundanceBin's performance also deteriorates more rapidly as the number of species per sample increases compared with MultiBin.</p>
        <fig id="pcbi-1002373-g005" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002373.g005</object-id>
          <label>Figure 5</label>
          <caption>
            <title>Simultaneous binning over multiple samples achieves higher precision compared with the equivalent single-sample approach.</title>
            <p>MultiBin and AbundanceBin were both run on datasets of increasing complexity. Each dataset is composed of 5 mixtures of the specified number of species. The specified precision is the proportion of reads correctly assigned to a bin, averaged over all species. For MultiBin (red) the curves show average precision over 10 random starts of the clustering algorithm, and the error bars give the standard error of the mean. For AbundanceBin (blue) the curves show the average precision over the 5 samples in the dataset, and the dashed lines give the highest and lowest result of the 5. MultiBin achieves consistently better precision over both read lengths and over all sample complexities. AbundanceBin's performance exhibits high between-sample variability, and also deteriorate more rapidly as the number of species increase.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002373.g005" xlink:type="simple"/>
        </fig>
        <p>We went on to evaluate MultiBin under the realistic scenario in which the reads have sequencing errors. To do so, we adjusted the alignment stage of MultiBin, currently performed by BLAT, to be more permissive. We tested this modification by again generating for the above datasets <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e294" xlink:type="simple"/></inline-formula> reads of length 400 bp, this time introducing base substitutions into the reads. When the substitution rate was increased to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e295" xlink:type="simple"/></inline-formula> and then to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e296" xlink:type="simple"/></inline-formula>, the precision for mixtures of two species decreased from 1.0000 to 0.9975 and then to 0.9966. Overall we conclude that the effect of these errors is not dramatic, and that for realistic error rates they could be largely moderated by adjusting the alignment procedure.</p>
        <p>We note that integrating information across samples enables MultiBin to perform precise binning even when the variance in species distribution across the samples is relatively small. For example, when simulating 400 bp reads from five nearly-balanced mixtures of two species - the relative abundance of the more abundant species were 0.57, 0.55, 0.70, 0.53 and 0.56 - AbundanceBin still obtained a precision of 0.93. These results also demonstrate that MultiBin achieves precise binning on nearly-balanced samples; in contrast, a coverage-based method which did not integrate information across samples would produce extremely poor results on each of these samples alone.</p>
        <p>Determining the number of clusters is an issue widely explored in the literature, and particularly, several approaches exist and have been tested for similar problems <xref ref-type="bibr" rid="pcbi.1002373-Chiang1">[29]</xref>. We found that running the algorithm multiple times for different values of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e297" xlink:type="simple"/></inline-formula>, measuring the Hartigan index <xref ref-type="bibr" rid="pcbi.1002373-Chiang1">[29]</xref>, <xref ref-type="bibr" rid="pcbi.1002373-Hartigan1">[30]</xref> for each value and choosing the value at which the index decreases sharply and reaches a plateau gave accurate results, as long as the binning itself was accurate enough (precision of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e298" xlink:type="simple"/></inline-formula> and above).</p>
      </sec>
      <sec id="s3g">
        <title>Sample multiplicity in the design phase</title>
        <p>Our results so far demonstrate that joint modeling of multiple metagenomic samples can be helpful in the analysis stage. A further question has to do with the design stage: Given a fixed coverage depth and a potential pool of related metagenomic samples, how many of the samples should be sequenced in order to achieve optimal characterization of the underlying microbial composition? There seems to be a tradeoff between sequencing with high coverage a small number of samples and the superficial sequencing of many samples. We tested this tradeoff in both the components estimation problem and the binning task.</p>
        <p>For components estimation, our task is to best characterize the components, or in other words to estimate the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e299" xlink:type="simple"/></inline-formula> matrix; the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e300" xlink:type="simple"/></inline-formula> matrix varies with the number of samples and therefore cannot be compared here. We simulated instances of the proposed probabilistic model by uniformly drawing the P and F matrices followed by normalization to row-stochastic, and then drawing observations from the corresponding multinomial distributions. We used <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e301" xlink:type="simple"/></inline-formula> components, each defined by a multinomial distribution over <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e302" xlink:type="simple"/></inline-formula> possible results. Initially, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e303" xlink:type="simple"/></inline-formula> was defined for 1,000 samples, and for each sample 1,000 counts were drawn. The model was then solved for a decreasing number of samples by joining samples together to obtain 1000, 500, 200, 100, 50, 20, 10, 5, 2 and 1 samples. As can be seen in <xref ref-type="fig" rid="pcbi-1002373-g006">Figure 6(a)</xref>, the optimal estimation of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e304" xlink:type="simple"/></inline-formula> was achieved for 50 samples, each including 20,000 counts: Increasing the number of samples further past this point does not allow enough data to be gathered from each sample, resulting in a decrease in performance.</p>
        <fig id="pcbi-1002373-g006" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002373.g006</object-id>
          <label>Figure 6</label>
          <caption>
            <title>Increasing the number of samples for a fixed depth of coverage improves both components characterization and binning precision.</title>
            <p><bold>Left:</bold> A fixed number of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e305" xlink:type="simple"/></inline-formula> counts were generated from a model defined by uniformly drawn <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e306" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e307" xlink:type="simple"/></inline-formula> matrices using <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e308" xlink:type="simple"/></inline-formula>. The value of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e309" xlink:type="simple"/></inline-formula>, the number of samples, varied from 1 to 1000, and 100 trials were performed for each value. The highest average precision of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e310" xlink:type="simple"/></inline-formula> estimation is obtained for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e311" xlink:type="simple"/></inline-formula>. <bold>Right:</bold> A fixed number of 8,192,000 reads of length 400 bp were sampled from different numbers of samples, each consisting of 15 species in uniformly drawn proportions. The smallest average error over all samples was obtained when 32 samples are sequenced. In both plots the error bars give the standard error of the mean.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002373.g006" xlink:type="simple"/>
        </fig>
        <p>For the binning task, we ran our algorithm on mixtures of 15 species and reads of length 400 bp. Due to efficiency considerations we did not produce actual reads using MetaSim, but instead drew read start positions randomly along the genomes, and determined an overlap for reads which physically overlapped by more than 100 bp at the edges. <xref ref-type="fig" rid="pcbi-1002373-g006">Figure 6(b)</xref> shows the resulting precision when binning is performed over a fixed number of 8,192,000 reads allocated to an increasing number of samples, in which the species proportions are again uniformly drawn. The highest precision is obtained for 32 samples.</p>
        <p>Both plots demonstrate that sample multiplicity is an advantage given a fixed coverage: as long as the per-sample coverage is reasonable, allocating the sequencing reads to as many samples as possible improves components characterization and binning precision.</p>
      </sec>
    </sec>
    <sec id="s4">
      <title>Discussion</title>
      <p>We demonstrated the advantage in joint modeling of multiple metagenomic samples, by showing that it allows the unsupervised inference of hidden genetic component, and increases the precision of coverage-based binning. This advantage holds for both the analysis and the design stage; as for the latter, the results suggest that when wishing to characterize a given metagenomic sample, it is useful to divide the coverage between additional samples from similar environments. It might also be possible to apply a biological or chemical treatment to some of the samples, which would further accentuate the differences between them; when the samples are analyzed jointly, these differences are expected to further enhance performance. Similarly, sequencing data available from previous experiments can be used to improve the analysis of new samples. A similar tradeoff between the number of samples and per-sample coverage has been observed for testing the power of rare variant discovery in sequencing data <xref ref-type="bibr" rid="pcbi.1002373-Wendl1">[31]</xref>, and sample multiplicity is likely to become a key issue in the future design of both standard and metagenomic sequencing studies.</p>
      <p>We note that the components estimates obtained by solving the probabilistic model are interesting by themselves, outside of the context of association correction; particularly, they can allow for the characterization of variability patterns in metagenomic samples and for sample classification. Different estimates will be obtained by setting the parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e312" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e313" xlink:type="simple"/></inline-formula> to different values; our choice of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e314" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e315" xlink:type="simple"/></inline-formula> was meant to capture a high-level division, possibly taxonomic, of the microbial population, as it is known that bacterial phyla have characteristic sequence composition. A recent paper <xref ref-type="bibr" rid="pcbi.1002373-Arumugam1">[5]</xref> identified metagenomic variability components using a supervised approach and divided the Danish samples accordingly to discrete classes termed <italic>enterotypes</italic>; interestingly, there are some correlations between these enterotypes and the components we obtain. For example, samples belonging to the first enterotype have a low proportion of the fourth component (p-value = <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e316" xlink:type="simple"/></inline-formula>) when solving the model for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e317" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e318" xlink:type="simple"/></inline-formula>, and those belonging to the second enterotype have a low proportion of the first component (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e319" xlink:type="simple"/></inline-formula>) when solving the model for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e320" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e321" xlink:type="simple"/></inline-formula>. However, as explained in the Methods, our algorithm is fundamentally different from the PCA used to identify the enterotypes, and is expected to yield components of different nature, on top of it being unsupervised.</p>
      <p>As for the proposed binning algorithm, unlike most other algorithms it can be used on datasets containing short reads, since the reads need only be long enough so as to determine unique sequence overlaps between them. In addition, the algorithm can be further improved to use not only coverage information but also other features, such as sequence composition, by adding them to the vectors on which clustering is performed.</p>
      <p>Lastly, the implementation of the proposed association test for the MetaHIT dataset was limited by the sequencing quality, which forced us to extract only the first <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e322" xlink:type="simple"/></inline-formula>-mer from each read and therefore to examine only relatively short <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e323" xlink:type="simple"/></inline-formula>-mers (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002373.e324" xlink:type="simple"/></inline-formula>), otherwise the counts data would become too sparse. We believe that this problem could be addressed by the integration of sequencing uncertainties into the counts data. With the expected improvements in high-throughput sequencing technology in terms of read length and read accuracy, these issues may be of lesser importance in the future.</p>
    </sec>
  </body>
  <back>
    <ack>
      <p>We wish to thank Dr. Junjie Qin from BGI-Shenzhen bioinformatics center for assisting us in accessing the BGI dataset, and for providing us with detailed explanations regarding the data generation process.</p>
    </ack>
    <ref-list>
      <title>References</title>
      <ref id="pcbi.1002373-Rusch1">
        <label>1</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Rusch</surname><given-names>D</given-names></name><name name-style="western"><surname>Halpern</surname><given-names>A</given-names></name><name name-style="western"><surname>Sutton</surname><given-names>G</given-names></name><name name-style="western"><surname>Heidelberg</surname><given-names>K</given-names></name><name name-style="western"><surname>Williamson</surname><given-names>S</given-names></name><etal/></person-group>             <year>2007</year>             <article-title>The sorcerer II global ocean sampling expedition: northwest atlantic through eastern tropical pacific.</article-title>             <source>PLoS Bio</source>             <volume>5</volume>             <fpage>e77</fpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002373-Qin1">
        <label>2</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Qin</surname><given-names>J</given-names></name><name name-style="western"><surname>Li</surname><given-names>R</given-names></name><name name-style="western"><surname>Raes</surname><given-names>J</given-names></name><name name-style="western"><surname>Arumugam</surname><given-names>M</given-names></name><name name-style="western"><surname>Burgdorf</surname><given-names>K</given-names></name><etal/></person-group>             <year>2010</year>             <article-title>A human gut microbial gene catalogue established by metagenomic sequencing.</article-title>             <source>Nature</source>             <volume>464</volume>             <fpage>59</fpage>             <lpage>65</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002373-Huson1">
        <label>3</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Huson</surname><given-names>D</given-names></name><name name-style="western"><surname>Auch</surname><given-names>A</given-names></name><name name-style="western"><surname>Qi</surname><given-names>J</given-names></name><name name-style="western"><surname>Schuster</surname><given-names>S</given-names></name></person-group>             <year>2007</year>             <article-title>MEGAN analysis of metagenomic data.</article-title>             <source>Genome Res</source>             <volume>17</volume>             <fpage>377</fpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002373-Hamady1">
        <label>4</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Hamady</surname><given-names>M</given-names></name><name name-style="western"><surname>Walker</surname><given-names>J</given-names></name><name name-style="western"><surname>Harris</surname><given-names>J</given-names></name><name name-style="western"><surname>Gold</surname><given-names>N</given-names></name><name name-style="western"><surname>Knight</surname><given-names>R</given-names></name></person-group>             <year>2008</year>             <article-title>Error-correcting barcoded primers for pyrosequencing hundreds of samples in multiplex.</article-title>             <source>Nat Methods</source>             <volume>5</volume>             <fpage>235</fpage>             <lpage>237</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002373-Arumugam1">
        <label>5</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Arumugam</surname><given-names>M</given-names></name><name name-style="western"><surname>Raes</surname><given-names>J</given-names></name><name name-style="western"><surname>Pelletier</surname><given-names>E</given-names></name><name name-style="western"><surname>Le Paslier</surname><given-names>D</given-names></name><name name-style="western"><surname>Yamada</surname><given-names>T</given-names></name><etal/></person-group>             <year>2011</year>             <article-title>Enterotypes of the human gut microbiome.</article-title>             <source>Nature</source>             <volume>473</volume>             <fpage>174</fpage>             <lpage>180</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002373-Karlin1">
        <label>6</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Karlin</surname><given-names>S</given-names></name><name name-style="western"><surname>Mrazek</surname><given-names>J</given-names></name><name name-style="western"><surname>Campbell</surname><given-names>A</given-names></name></person-group>             <year>1997</year>             <article-title>Compositional biases of bacterial genomes and evolutionary implications.</article-title>             <source>J Bacteriol</source>             <volume>179</volume>             <fpage>3899</fpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002373-Takahashi1">
        <label>7</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Takahashi</surname><given-names>M</given-names></name><name name-style="western"><surname>Kryukov</surname><given-names>K</given-names></name><name name-style="western"><surname>Saitou</surname><given-names>N</given-names></name></person-group>             <year>2009</year>             <article-title>Estimation of bacterial species phylogeny through oligonucleotide frequency distances.</article-title>             <source>Genomics</source>             <volume>93</volume>             <fpage>525</fpage>             <lpage>533</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002373-Hofmann1">
        <label>8</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Hofmann</surname><given-names>T</given-names></name></person-group>             <year>1999</year>             <article-title>Probabilistic latent semantic indexing.</article-title>             <fpage>50</fpage>             <lpage>57</lpage>             <comment>In: Proceedings of the 22nd annual international ACM SIGIR conference on Research and development in information retrieval;15–19 August 1999; Berkeley, California, United States. SIGIR 99. Available: <ext-link ext-link-type="uri" xlink:href="http://dl.acm.org/citation.cfm?id=312649" xlink:type="simple">http://dl.acm.org/citation.cfm?id=312649</ext-link>. ACM</comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002373-Meinicke1">
        <label>9</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Meinicke</surname><given-names>P</given-names></name><name name-style="western"><surname>Aßhauer</surname><given-names>K</given-names></name><name name-style="western"><surname>Lingner</surname><given-names>T</given-names></name></person-group>             <year>2011</year>             <article-title>Mixture models for analysis of the taxonomic composition of metagenomes.</article-title>             <source>Bioinformatics</source>             <volume>27</volume>             <fpage>1618</fpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002373-Teeling1">
        <label>10</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Teeling</surname><given-names>H</given-names></name><name name-style="western"><surname>Waldmann</surname><given-names>J</given-names></name><name name-style="western"><surname>Lombardot</surname><given-names>T</given-names></name><name name-style="western"><surname>Bauer</surname><given-names>M</given-names></name><name name-style="western"><surname>Glöckner</surname><given-names>F</given-names></name></person-group>             <year>2004</year>             <article-title>TETRA: a web-service and a stand-alone program for the analysis and comparison of tetranucleotide usage patterns in DNA sequences.</article-title>             <source>BMC Bioinformatics</source>             <volume>5</volume>             <fpage>163</fpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002373-Chatterji1">
        <label>11</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Chatterji</surname><given-names>S</given-names></name><name name-style="western"><surname>Yamazaki</surname><given-names>I</given-names></name><name name-style="western"><surname>Bai</surname><given-names>Z</given-names></name><name name-style="western"><surname>Eisen</surname><given-names>J</given-names></name></person-group>             <year>2008</year>             <article-title>CompostBin: A DNA compositionbased algorithm for binning environmental shotgun reads.</article-title>             <fpage>17</fpage>             <lpage>28</lpage>             <comment>In: Proceedings of the 12th annual international conference on Research in computational molecular biology; 30 March–2 April, 2008; Singapore. RECOMB 2008. Available: <ext-link ext-link-type="uri" xlink:href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.186.4259&amp;rep=rep1&amp;type=pdf" xlink:type="simple">http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.186.4259&amp;rep=rep1&amp;type=pdf</ext-link>. ISCB</comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002373-Chan1">
        <label>12</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Chan</surname><given-names>C</given-names></name><name name-style="western"><surname>Hsu</surname><given-names>A</given-names></name><name name-style="western"><surname>Tang</surname><given-names>S</given-names></name><name name-style="western"><surname>Halgamuge</surname><given-names>S</given-names></name></person-group>             <year>2008</year>             <article-title>Using growing self-organising maps to improve the binning process in environmental whole-genome shotgun sequencing.</article-title>             <source>J Biomed Biotechnol</source>             <volume>2008</volume>             <fpage>513701</fpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002373-Kislyuk1">
        <label>13</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Kislyuk</surname><given-names>A</given-names></name><name name-style="western"><surname>Bhatnagar</surname><given-names>S</given-names></name><name name-style="western"><surname>Dushoff</surname><given-names>J</given-names></name><name name-style="western"><surname>Weitz</surname><given-names>J</given-names></name></person-group>             <year>2009</year>             <article-title>Unsupervised statistical clustering of environmental shotgun sequences.</article-title>             <source>BMC Bioinformatics</source>             <volume>10</volume>             <fpage>316</fpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002373-Yang1">
        <label>14</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Yang</surname><given-names>B</given-names></name><name name-style="western"><surname>Peng</surname><given-names>Y</given-names></name><name name-style="western"><surname>Leung</surname><given-names>H</given-names></name><name name-style="western"><surname>Yiu</surname><given-names>S</given-names></name><name name-style="western"><surname>Chen</surname><given-names>J</given-names></name><etal/></person-group>             <year>2010</year>             <article-title>Unsupervised binning of environmental genomic fragments based on an error robust selection of l-mers.</article-title>             <source>BMC Bioinformatics</source>             <volume>11</volume>             <fpage>S5</fpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002373-Leung1">
        <label>15</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Leung</surname><given-names>H</given-names></name><name name-style="western"><surname>Yiu</surname><given-names>S</given-names></name><name name-style="western"><surname>Yang</surname><given-names>B</given-names></name><name name-style="western"><surname>Peng</surname><given-names>Y</given-names></name><name name-style="western"><surname>Wang</surname><given-names>Y</given-names></name><etal/></person-group>             <year>2011</year>             <article-title>A robust and accurate binning algorithm for metagenomic sequences with arbitrary species abundance ratio.</article-title>             <source>Bioinformatics</source>             <volume>27</volume>             <fpage>1489</fpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002373-Wu1">
        <label>16</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Wu</surname><given-names>Y</given-names></name><name name-style="western"><surname>Ye</surname><given-names>Y</given-names></name></person-group>             <year>2010</year>             <article-title>A novel abundance-based algorithm for binning metagenomic sequences using l-tuples.</article-title>             <fpage>535</fpage>             <lpage>549</lpage>             <comment>In: Proceedings of the 14th Annual International Conference on Research in Computational Molecular Biology; 12–15 August, 2010; Lisbon, Portugal. RECOMB 2010. Available: <ext-link ext-link-type="uri" xlink:href="http://www.springerlink.com/content/201300170l185173" xlink:type="simple">http://www.springerlink.com/content/201300170l185173</ext-link>. ISCB</comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002373-Turnbaugh1">
        <label>17</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Turnbaugh</surname><given-names>P</given-names></name><name name-style="western"><surname>Hamady</surname><given-names>M</given-names></name><name name-style="western"><surname>Yatsunenko</surname><given-names>T</given-names></name><name name-style="western"><surname>Cantarel</surname><given-names>B</given-names></name><name name-style="western"><surname>Duncan</surname><given-names>A</given-names></name><etal/></person-group>             <year>2008</year>             <article-title>A core gut microbiome in obese and lean twins.</article-title>             <source>Nature</source>             <volume>457</volume>             <fpage>480</fpage>             <lpage>484</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002373-Jolliffe1">
        <label>18</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Jolliffe</surname><given-names>I</given-names></name></person-group>             <year>2002</year>             <article-title>Principal component analysis.</article-title>             <source>Springer Series in Statistics, 2nd edition</source> <!--===== Restructure page-count as size[@units="page"] =====--><size units="page">502</size>           </element-citation>
      </ref>
      <ref id="pcbi.1002373-Lee1">
        <label>19</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Lee</surname><given-names>D</given-names></name><name name-style="western"><surname>Seung</surname><given-names>H</given-names></name></person-group>             <year>1999</year>             <article-title>Learning the parts of objects by non-negative matrix factorization.</article-title>             <source>Nature</source>             <volume>401</volume>             <fpage>788</fpage>             <lpage>791</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002373-Jiang1">
        <label>20</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Jiang</surname><given-names>X</given-names></name><name name-style="western"><surname>Weitz</surname><given-names>J</given-names></name><name name-style="western"><surname>Dushoff</surname><given-names>J</given-names></name></person-group>             <year>2011</year>             <article-title>A non-negative matrix factorization framework for identifying modular patterns in metagenomic profile data.</article-title>             <source>J Math Biol [Epub ahead of print]</source>          </element-citation>
      </ref>
      <ref id="pcbi.1002373-Hofmann2">
        <label>21</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Hofmann</surname><given-names>T</given-names></name></person-group>             <year>1999</year>             <article-title>Probabilistic latent semantic analysis.</article-title>             <fpage>289</fpage>             <lpage>296</lpage>             <comment>In: Proceedings of the Fifteenth Conference on Uncertainty in Artificial Intelligence; 30 July–1 August 1999; Stockholm, Sweden. UAI 99. Available: <ext-link ext-link-type="uri" xlink:href="http://uai.sis.pitt.edu/papers/99/p289-hofmann.pdf" xlink:type="simple">http://uai.sis.pitt.edu/papers/99/p289-hofmann.pdf</ext-link>. AUAI</comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002373-Hofmann3">
        <label>22</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Hofmann</surname><given-names>T</given-names></name></person-group>             <year>2001</year>             <article-title>Unsupervised learning by probabilistic latent semantic analysis.</article-title>             <source>Mach Learn</source>             <volume>42</volume>             <fpage>177</fpage>             <lpage>196</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002373-Cohn1">
        <label>23</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Cohn</surname><given-names>D</given-names></name><name name-style="western"><surname>Chang</surname><given-names>H</given-names></name></person-group>             <year>2000</year>             <article-title>Learning to probabilistically identify authoritative documents.</article-title>             <fpage>167</fpage>             <lpage>174</lpage>             <comment>In: Proceedings of the Seventeenth International Conference on Machine Learning; 29 June–2 July, 2000; Stanford University, Stanford, CA, USA. ICML 2000. Available: <ext-link ext-link-type="uri" xlink:href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.28.2691&amp;rep=rep1&amp;type=pdf" xlink:type="simple">http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.28.2691&amp;rep=rep1&amp;type=pdf</ext-link>. ACM</comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002373-Cohn2">
        <label>24</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Cohn</surname><given-names>D</given-names></name><name name-style="western"><surname>Hofmann</surname><given-names>T</given-names></name></person-group>             <year>2001</year>             <article-title>The missing link-a probabilistic model of document content and hypertext connectivity.</article-title>             <fpage>430</fpage>             <lpage>436</lpage>             <comment>In: Advances in neural information processing systems 13: proceedings of the 2000 conference; 27 November–2 December, 2000; Denver, Colorado, United States. NIPS 2000.Available: <ext-link ext-link-type="uri" xlink:href="http://citeseer.ist.psu.edu/viewdoc/summary?doi=10.1.1.33.6843" xlink:type="simple">http://citeseer.ist.psu.edu/viewdoc/summary?doi=10.1.1.33.6843</ext-link>. NIPS</comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002373-Brants1">
        <label>25</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Brants</surname><given-names>T</given-names></name><name name-style="western"><surname>Chen</surname><given-names>F</given-names></name><name name-style="western"><surname>Tsochantaridis</surname><given-names>I</given-names></name></person-group>             <year>2002</year>             <article-title>Topic-based document segmentation with probabilistic latent semantic analysis.</article-title>             <fpage>211</fpage>             <lpage>218</lpage>             <comment>In: Proceedings of the eleventh international conference on Information and knowledge management; 4–9 November, 2002; McLean, Virginia, United States. CIKM 02. Available: <ext-link ext-link-type="uri" xlink:href="http://dl.acm.org/citation.cfm?id=584829&amp;bnc=1" xlink:type="simple">http://dl.acm.org/citation.cfm?id=584829&amp;bnc=1</ext-link>. ACM</comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002373-Sivic1">
        <label>26</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Sivic</surname><given-names>J</given-names></name><name name-style="western"><surname>Russell</surname><given-names>B</given-names></name><name name-style="western"><surname>Efros</surname><given-names>A</given-names></name><name name-style="western"><surname>Zisserman</surname><given-names>A</given-names></name><name name-style="western"><surname>Freeman</surname><given-names>W</given-names></name></person-group>             <year>2005</year>             <article-title>Discovering objects and their location in images.</article-title>             <fpage>370</fpage>             <lpage>377</lpage>             <comment>In: Proceedings of the tenth IEEE International Conference on Computer VisionComputer Vision. 17–20 October, 2005. Beijing, China. ICCV 2005. <ext-link ext-link-type="uri" xlink:href="http://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&amp;arnumber=1541280" xlink:type="simple">http://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&amp;arnumber=1541280</ext-link>. IEEE, volume 1</comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002373-Richter1">
        <label>27</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Richter</surname><given-names>D</given-names></name><name name-style="western"><surname>Ott</surname><given-names>F</given-names></name><name name-style="western"><surname>Auch</surname><given-names>A</given-names></name><name name-style="western"><surname>Schmid</surname><given-names>R</given-names></name><name name-style="western"><surname>Huson</surname><given-names>D</given-names></name></person-group>             <year>2008</year>             <article-title>Metasim - a sequencing simulator for genomics and metagenomics.</article-title>             <source>PLoS One</source>             <volume>3</volume>             <fpage>e3373</fpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002373-Kent1">
        <label>28</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Kent</surname><given-names>W</given-names></name></person-group>             <year>2002</year>             <article-title>BLAT - the BLAST-like alignment tool.</article-title>             <source>Genome Res</source>             <volume>12</volume>             <fpage>656</fpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002373-Chiang1">
        <label>29</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Chiang</surname><given-names>M</given-names></name><name name-style="western"><surname>Mirkin</surname><given-names>B</given-names></name></person-group>             <year>2007</year>             <article-title>Experiments for the number of clusters in k-means.</article-title>             <source>Progress in Artificial Intelligence</source>             <volume>4874</volume>             <fpage>395</fpage>             <lpage>405</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002373-Hartigan1">
        <label>30</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Hartigan</surname><given-names>J</given-names></name></person-group>             <year>1975</year>             <source>Clustering Algorithms</source>             <publisher-loc>New York</publisher-loc>             <publisher-name>J. Wiley &amp; Sons</publisher-name> <!--===== Restructure page-count as size[@units="page"] =====--><size units="page">366</size>           </element-citation>
      </ref>
      <ref id="pcbi.1002373-Wendl1">
        <label>31</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Wendl</surname><given-names>M</given-names></name><name name-style="western"><surname>Wilson</surname><given-names>R</given-names></name></person-group>             <year>2009</year>             <article-title>The theory of discovering rare variants via DNA sequencing.</article-title>             <source>BMC Genomics</source>             <volume>10</volume>             <fpage>485</fpage>          </element-citation>
      </ref>
    </ref-list>
    
  </back>
</article>