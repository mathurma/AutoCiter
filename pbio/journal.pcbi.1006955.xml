<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-18-01460</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1006955</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Pathology and laboratory medicine</subject><subj-group><subject>Pathogens</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Evolutionary biology</subject><subj-group><subject>Evolutionary processes</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Epidemiology</subject><subj-group><subject>Genetic epidemiology</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Statistics</subject><subj-group><subject>Statistical data</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Epidemiology</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Diagnostic medicine</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Epidemiology</subject><subj-group><subject>Epidemiological methods and statistics</subject><subj-group><subject>Epidemiological statistics</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Model diagnostics and refinement for phylodynamic models</article-title>
<alt-title alt-title-type="running-head">Model diagnostics and refinement for phylodynamic models</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-0420-9736</contrib-id>
<name name-style="western">
<surname>Lau</surname> <given-names>Max S. Y.</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Grenfell</surname> <given-names>Bryan T.</given-names></name>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Worby</surname> <given-names>Colin J.</given-names></name>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-8203-0083</contrib-id>
<name name-style="western">
<surname>Gibson</surname> <given-names>Gavin J.</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Department of Ecology and Evolutionary Biology, Princeton University, New Jersey, USA</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Fogarty International Center, National Institute of Health, Bethesda, MD, USA</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>Broad Institute, Cambridge, MA 02142, USA</addr-line>
</aff>
<aff id="aff004">
<label>4</label>
<addr-line>Maxwell Institute for Mathematical Sciences, School of Mathematical and Computer Sciences, Heriot-Watt University, Edinburgh, EH14 4AS, UK</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Rasmussen</surname> <given-names>David A</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Duke University, UNITED STATES</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">msylau@princeton.edu</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>4</month>
<year>2019</year>
</pub-date>
<pub-date pub-type="epub">
<day>5</day>
<month>4</month>
<year>2019</year>
</pub-date>
<volume>15</volume>
<issue>4</issue>
<elocation-id>e1006955</elocation-id>
<history>
<date date-type="received">
<day>22</day>
<month>8</month>
<year>2018</year>
</date>
<date date-type="accepted">
<day>18</day>
<month>3</month>
<year>2019</year>
</date>
</history>
<permissions>
<copyright-year>2019</copyright-year>
<copyright-holder>Lau et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1006955"/>
<abstract>
<p>Phylodynamic modelling, which studies the joint dynamics of epidemiological and evolutionary processes, has made significant progress in recent years due to increasingly available genomic data and advances in statistical modelling. These advances have greatly improved our understanding of transmission dynamics of many important pathogens. Nevertheless, there remains a lack of effective, targetted diagnostic tools for systematically detecting model mis-specification. Development of such tools is essential for model criticism, refinement, and calibration. The idea of utilising <italic>latent residuals</italic> for model assessment has already been exploited in general spatio-temporal epidemiological settings. Specifically, by proposing appropriately designed non-centered, re-parameterizations of a given epidemiological process, one can construct latent residuals with known sampling distributions which can be used to quantify evidence of model mis-specification. In this paper, we extend this idea to formulate a novel model-diagnostic framework for phylodynamic models. Using simulated examples, we show that our framework may effectively detect a particular form of mis-specification in a phylodynamic model, particularly in the event of superspreading. We also exemplify our approach by applying the framework to a dataset describing a local foot-and-mouth (FMD) outbreak in the UK, eliciting strong evidence against the assumption of no within-host-diversity in the outbreak. We further demonstrate that our framework can facilitate model calibration in real-life scenarios, by proposing a within-host-diversity model which appears to offer a better fit to data than one that assumes no within-host-diversity of FMD virus.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>Integrated modelling of conventional epidemiological data and modern genomic data (i.e. phylodynamics) has made significant progress in recent years, due to the ever-increasing availability of genomic data and development of statistical methods. However, there is a lack of tools for carrying out effective diagnostics for phylodynamic models. We propose a novel model diagnostic framework that involves a latent residual process which is <italic>a priori</italic> independent of model assumptions and which can be used to quantify, and reveal the nature of, model inadequacy. Our results suggest that our framework may systematically detect deviation from a particular model assumption and greatly facilitate subsequent model calibration.</p>
</abstract>
<funding-group>
<funding-statement>We thank the Bill &amp; Melinda Gates Foundation (OPP1091919) and the Fogarty International Centre and National Institutes of Health (NIH) for their financial support. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="5"/>
<table-count count="1"/>
<page-count count="17"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2019-04-17</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>Relevant codes are available on <ext-link ext-link-type="uri" xlink:href="https://github.com/msylau" xlink:type="simple">https://github.com/msylau</ext-link>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Pathogen dynamics are shaped collectively and interdependently by biological processes occurring at the epidemiological, immunological and evolutionary levels. Conventionally, however, each of these processes has been studied independently, revealing only a partial picture of the pathogen dynamics. Phylodynamics studies how these biological processes at various levels act together to shape the phylogeny and transmission of the pathogens [<xref ref-type="bibr" rid="pcbi.1006955.ref001">1</xref>]. Studies of pathogen phylodynamics are facilitated greatly by increasingly available data sources (particularly, genomic data) [<xref ref-type="bibr" rid="pcbi.1006955.ref002">2</xref>] and the concurrent development of statistical tools for data integration. In particular, major advances in statistical models that integrate epidemiological and genomic data have been made (e.g., [<xref ref-type="bibr" rid="pcbi.1006955.ref003">3</xref>–<xref ref-type="bibr" rid="pcbi.1006955.ref013">13</xref>]). These models have proved very useful for obtaining more comprehensive and detailed pictures of pathogens dynamics− in populations of human, animals and plants. For example, joint epidemiological-evolutionary models have enabled more accurate estimation of transmission histories and a better understanding of the interconnectedness between epidemiological and evolutionary processes.</p>
<p>Despite these advances in model construction and inference, there has been very little development of bespoke diagnostic frameworks for model criticism and, importantly, for <italic>systematically</italic> detecting suspected deviations from particular assumptions in a phylodynamic model in order to guide model refinement. Such a diagnostic framework is crucial given the increasing complexity and diversity of phylodynamic model components and assumptions. In particular, while many phylodynamic frameworks for inferring a transmission history have been proposed [<xref ref-type="bibr" rid="pcbi.1006955.ref003">3</xref>–<xref ref-type="bibr" rid="pcbi.1006955.ref005">5</xref>, <xref ref-type="bibr" rid="pcbi.1006955.ref007">7</xref>, <xref ref-type="bibr" rid="pcbi.1006955.ref010">10</xref>–<xref ref-type="bibr" rid="pcbi.1006955.ref012">12</xref>, <xref ref-type="bibr" rid="pcbi.1006955.ref014">14</xref>–<xref ref-type="bibr" rid="pcbi.1006955.ref017">17</xref>], various simplifying assumptions made in these models remain to be tested. For example, as it is generally challenging to incorporate and infer within-host-diversity explicitly in a phylodynamic model, many studies assume no pathogen diversity within individual hosts [<xref ref-type="bibr" rid="pcbi.1006955.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1006955.ref005">5</xref>, <xref ref-type="bibr" rid="pcbi.1006955.ref007">7</xref>, <xref ref-type="bibr" rid="pcbi.1006955.ref014">14</xref>–<xref ref-type="bibr" rid="pcbi.1006955.ref017">17</xref>]. It is often assumed that, within a host, there is a single, dominant pathogen strain at any time <italic>t</italic> and potential within-host-diversity is thereby ignored. Within-host evolution is a known phenomenon for many pathogens (e.g., foot-and-mouth, HIV, Ebola and influenza [<xref ref-type="bibr" rid="pcbi.1006955.ref018">18</xref>–<xref ref-type="bibr" rid="pcbi.1006955.ref021">21</xref>]), so that the appropriateness of the single-dominant-strain (s-d-s) approximation in any given scenario should be assessed.</p>
<p>We propose a framework for answering the following questions: (1) <italic>How can we quantify the evidence against model assumptions in a phylodynamic model?</italic>, (2) <italic>If strong evidence is observed, can we discern the nature of model mis-specification so that a more adequate model may be proposed?</italic> Such a framework will greatly facilitate model criticism, refinement and calibration. The notion of using Bayesian <italic>latent residuals</italic> to assess mis-specifications in a spatio-temporal epidemiological model was proposed and exploited in [<xref ref-type="bibr" rid="pcbi.1006955.ref022">22</xref>, <xref ref-type="bibr" rid="pcbi.1006955.ref023">23</xref>]. By proposing appropriately designed <italic>non-centered (re-)parametrizations</italic> of the underlying process, in [<xref ref-type="bibr" rid="pcbi.1006955.ref022">22</xref>] the authors construct latent residuals whose prior sampling properties are known, and whose posterior samples are sensitive to mis-specifications of the components of a general spatio-temporal epidemiological model. Inferred samples from the posterior distributions of the latent residuals are then assessed against their known sampling distributions, quantifying evidence against model assumptions. The ‘latent–residuals’ approach complements established model-testing tools (e.g., the DIC [<xref ref-type="bibr" rid="pcbi.1006955.ref024">24</xref>]), allowing diagnostics to be targetted at particular aspects of model formulation. Moreover, for spatio-temporal dynamic models of infectious diseases, it may offer a more sensitive test and more interpretable diagnostics [<xref ref-type="bibr" rid="pcbi.1006955.ref022">22</xref>, <xref ref-type="bibr" rid="pcbi.1006955.ref025">25</xref>].</p>
<p>In this paper, we innovate a model-diagnostic framework for phylodynamic models, utilising and extending the idea of latent residuals. First, we outline generally how latent residuals may be tailored to quantify the evidence against model assumptions in a joint epidemiological-evolutionary spatio-temporal model. Then, we introduce the idea of <italic>marked latent residuals</italic> where we associate an epidemiological quantity (or ‘mark’) with each residual. The marks may then be used to specify subsets of residuals that may potentially be most informative regarding particular mis-specifications of the evolutionary process. Specifically, using simulated data, we show how the marked latent residuals can be used to identify parts of the phylogenetic/epidemic trajectory where modelling assumptions may respectively under- or over-estimate the importance of the within-host evolution of the pathogen. We then apply our diagnostic framework to data describing a localised foot-and-mouth outbreak in the UK, conclusively highlighting the importance of within-host-diversity in modelling the outbreak. In parallel with the model assessment work, we propose a more general model, with an associated pseudo-likelihood, to represent within-host-diversity and significantly improve model fit.</p>
</sec>
<sec id="sec002">
<title>Models and methods</title>
<p>In this section we give details of phylodynamic models we use in the paper, how these are fitted to data, and the construction of the latent residual process used to assess the quality of model fit.</p>
<sec id="sec003">
<title>The null model <italic>M</italic><sub>0</sub>: A joint epidemiological-evolutionary spatio-temporal model</title>
<sec id="sec004">
<title>Epidemic process</title>
<p>We model the epidemic process with a general spatio-temporal stochastic SEIR epidemic model with susceptible (S), exposed (E), infectious (I) and removed (R) compartments. An individual <italic>j</italic> becomes infected (exposed) via background infection with rate <italic>α</italic> and from an infectious individual <italic>i</italic> with rate <italic>βK</italic>(<italic>d</italic><sub><italic>ij</italic></sub>;<italic>κ</italic>). <italic>K</italic>(<italic>d</italic><sub><italic>ij</italic></sub>;<italic>κ</italic>) is the spatial kernel function which characterizes the spatially-dependent infectious challenge from infective <italic>i</italic> to susceptible <italic>j</italic> as a function of distance between them <italic>d</italic><sub><italic>ij</italic></sub> [<xref ref-type="bibr" rid="pcbi.1006955.ref026">26</xref>, <xref ref-type="bibr" rid="pcbi.1006955.ref027">27</xref>]. Here, we assume <italic>K</italic>(<italic>d</italic><sub><italic>ij</italic></sub>;<italic>κ</italic>) = exp(−<italic>κd</italic><sub><italic>ij</italic></sub>). We use a <italic>Gamma</italic>(<italic>a</italic>, <italic>b</italic>) distribution parameterized by the shape <italic>a</italic> and scale <italic>b</italic> to model the time spent in class <italic>E</italic> (i.e. the latent period), and a <italic>Weibull</italic>(<italic>c</italic>, <italic>d</italic>) parameterized by the shape <italic>c</italic> and scale <italic>d</italic> to model the time spent in class <italic>I</italic> (i.e. the infectious period). In applying to the FMD data, we use <italic>Exponential</italic>(<italic>μ</italic>) for the infectious period, for matching the assumptions of [<xref ref-type="bibr" rid="pcbi.1006955.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1006955.ref005">5</xref>]. In simulation studies, we assume <italic>α</italic> = 4 × 10<sup>−4</sup>, <italic>β</italic> = 8, <italic>a</italic> = 8, <italic>b</italic> = 0.5, <italic>c</italic> = 2, <italic>d</italic> = 2 and <italic>κ</italic> = 0.02.</p>
</sec>
<sec id="sec005">
<title>Molecular evolutionary process</title>
<p>The molecular evolutionary process of the pathogen is modelled at the level of nucleotide substitutions and is assumed to be conditionally independent of the epidemic parameters given the complete set of epidemic events. This, in effect, means that that genetic evolution does not influence the epidemic parameters so that, for example, there is no selection of increasingly virulent strains. A nucleotide sequence is assembled from bases belong to <italic>purines</italic> (e.g., adenine (<italic>A</italic>) and guanine (<italic>G</italic>)) and <italic>pyrimidines</italic> (e.g., thymine (<italic>U</italic>) and cytosine (<italic>C</italic>)). Substitution between bases in the same category is called <italic>transition</italic> and the substitution between bases from different categories is called <italic>transversion</italic>. Nucleotide bases at different positions of a sequence are assumed to evolve independently according to a continuous-time Markov process. Specifically we use the two-parameter <italic>Kimura model</italic> (Ref. [<xref ref-type="bibr" rid="pcbi.1006955.ref028">28</xref>]) which allows for different rates of transition and transversion. Under the Kimura model, a nucleotide base <italic>x</italic> mutates to a different nucleotide base <italic>y</italic> within an interval of arbitrary length △<italic>t</italic> with the probability described by <xref ref-type="disp-formula" rid="pcbi.1006955.e014">Eq 3</xref>. We assume that there is a single dominating strain (s-d-s) at each infectious individual at any time point. Upon infection, a newly infected individual is infected with the s-d-s from the source individual. This assumption is consistent with the assumption of no within-host diversity made by other authors [<xref ref-type="bibr" rid="pcbi.1006955.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1006955.ref005">5</xref>, <xref ref-type="bibr" rid="pcbi.1006955.ref007">7</xref>, <xref ref-type="bibr" rid="pcbi.1006955.ref014">14</xref>–<xref ref-type="bibr" rid="pcbi.1006955.ref017">17</xref>]. In simulation studies, we assume <italic>μ</italic><sub>1</sub> = 1 × 10<sup>−4</sup> and <italic>μ</italic><sub>2</sub> = 5 × 10<sup>−5</sup> where <italic>μ</italic><sub>1</sub> and <italic>μ</italic><sub>2</sub> represent mutation rates for <italic>transition</italic> and <italic>transversion</italic> respectively.</p>
</sec>
</sec>
<sec id="sec006">
<title>A phylodynamic model <italic>M</italic><sub>1</sub> for simulating within-host-diversity</title>
<p>In order to assess the effectiveness of our methods we require a mechanism for generating epidemics where within-host diversity is present in the pathogen population. We consider a within-host-diversity model <bold><italic>M</italic></bold><sub>1</sub> with the same epidemic process component used in <bold><italic>M</italic></bold><sub>0</sub>. The molecular evolutionary process in each host is described by a continuous-time birth-death process which governs pathogen population growth and death, with mutation occurring along branches. Denote by <italic>N</italic><sub><italic>t</italic></sub> the current total pathogen population size (of all existing strains) in an infected host. The population size of any strain grows at rate <italic>ν</italic>. We assume there is an equilibrium population size <italic>N</italic><sub><italic>e</italic></sub> in a host − such an assumption may reflect the fact that there is competition between strains for limited resources in the host [<xref ref-type="bibr" rid="pcbi.1006955.ref029">29</xref>, <xref ref-type="bibr" rid="pcbi.1006955.ref030">30</xref>]. Death occurs at a rate <italic>ν</italic> × <italic>N</italic><sub><italic>t</italic></sub>/<italic>N</italic><sub><italic>e</italic></sub>, so that the equilibrium population size <italic>N</italic><sub><italic>e</italic></sub> is reached and maintained [<xref ref-type="bibr" rid="pcbi.1006955.ref029">29</xref>, <xref ref-type="bibr" rid="pcbi.1006955.ref030">30</xref>]. Mutations arise at rate <italic>ω</italic> × <italic>N</italic><sub><italic>t</italic></sub>, where <italic>ω</italic> is per-pathogen mutation rate without distinguishing <italic>transition</italic> and <italic>transversion</italic>. An event occurs (i.e., birth, death or mutation) according to their relative rates, and a strain is randomly chosen to experience this event, according to the current population sizes of existing strains. Mutation on the chosen (ancestor) strain creates a new strain (with initial population 1). The new strain has one (randomly chosen) nucleotide position that is different to the ancestor strain. Upon infection, <italic>N</italic><sub><italic>B</italic></sub> pathogens are randomly chosen (i.e. <italic>N</italic><sub><italic>B</italic></sub> is the transmission bottleneck) and may be transmitted into the newly infected host in which the pathogen population undergoes the birth-death-mutation process just described. We assume <italic>N</italic><sub><italic>e</italic></sub> = 3000, <italic>ν</italic> = 3, <italic>ω</italic> = 0.08 and <italic>N</italic><sub><italic>B</italic></sub> = 200.</p>
</sec>
<sec id="sec007">
<title>Latent residuals construction for molecular evolutionary process</title>
<sec id="sec008">
<title>General framework</title>
<p>The construction of latent residuals has its roots in a simple, frequently applied idea which can be illustrated by the following example. Suppose we observe a random sample of observations <italic>y</italic><sub>1</sub>, …, <italic>y</italic><sub><italic>n</italic></sub> believed to arise from a continuous distribution with distribution function <italic>F</italic><sub><italic>Y</italic></sub>(<italic>y</italic>; <italic>θ</italic>). Then, using the standard tool of inversion of the distribution function, we can consider each <inline-formula id="pcbi.1006955.e001"><alternatives><graphic id="pcbi.1006955.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e001" xlink:type="simple"/><mml:math display="inline" id="M1"><mml:mrow><mml:msub><mml:mi>y</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>F</mml:mi> <mml:mi>Y</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>q</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> where <italic>q</italic><sub><italic>i</italic></sub> is the quantile associated with <italic>y</italic><sub><italic>i</italic></sub> and, accordingly, <italic>q</italic><sub>1</sub>, …, <italic>q</italic><sub><italic>n</italic></sub> is a random sample from a <italic>Unif</italic>(0, 1) distribution. One can then test the fit of the observed <italic>y</italic><sub>1</sub>, …, <italic>y</italic><sub><italic>n</italic></sub> to the model <italic>F</italic><sub><italic>Y</italic></sub> by assessing the fit of <italic>q</italic><sub>1</sub>, …, <italic>q</italic><sub><italic>n</italic></sub> to the <italic>Unif</italic>(0, 1) distribution. These quantiles then represent a set of residuals whose sampling distribution is not dependent on <italic>F</italic><sub><italic>Y</italic></sub> or any model parameter <italic>θ</italic>. Our constructions utilise this basic idea—suitably adapted to accommodate the discrete outcomes, unobserved processes, and parameter uncertainty inherent in the epidemic setting—and embed it within a Bayesian framework. Moreover, we exploit the fact that residuals can be designed, and tested, in a multiplicity of ways to obtain tests targeted at suspected forms of mis-specification.</p>
<p>In the epidemic setting, let <bold><italic>z</italic></bold> denote the complete set of events (unobserved and observed) randomly generated from a phylodynamic model <bold><italic>M</italic></bold> parameterized by <bold><italic>θ</italic></bold>. Then, as long as the sampling properties of the phylodynamic model are preserved, we can consider <bold><italic>z</italic></bold> to be generated in non-unique ways. In particular, we consider <bold><italic>z</italic></bold> as a deterministic function <inline-formula id="pcbi.1006955.e002"><alternatives><graphic id="pcbi.1006955.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:mrow><mml:msub><mml:mi>h</mml:mi> <mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> where <inline-formula id="pcbi.1006955.e003"><alternatives><graphic id="pcbi.1006955.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is a random sample from a known distribution, and plays the role of a latent residual process. This representation is essentially a <italic>functional model</italic> as in [<xref ref-type="bibr" rid="pcbi.1006955.ref031">31</xref>], and exemplifies the concept of generalised residuals proposed in [<xref ref-type="bibr" rid="pcbi.1006955.ref032">32</xref>]. The process of inversion of the distribution function outlined above provides a simple example of a functional model. Symbolically, we have
<disp-formula id="pcbi.1006955.e004"><alternatives><graphic id="pcbi.1006955.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e004" xlink:type="simple"/><mml:math display="block" id="M4"><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi> <mml:mo>=</mml:mo> <mml:msub><mml:mi>h</mml:mi> <mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(1)</label></disp-formula>
Note that, for any <bold><italic>M</italic></bold>, the selection of a residual process <inline-formula id="pcbi.1006955.e005"><alternatives><graphic id="pcbi.1006955.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> and a function <italic>h</italic><sub><bold><italic>M</italic></bold>,<bold><italic>θ</italic></bold></sub>(.), can be effected in a multiplicity of ways − and can be tailored to be sensitive to a suspected mode of mis-specification.</p>
<p>In a Bayesian data-augmentation framework, given a random draw (<bold><italic>θ</italic></bold>′, <bold><italic>z</italic></bold>′) from the posterior distribution <italic>π</italic>(<bold><italic>θ</italic></bold>, <bold><italic>z</italic></bold>|<bold><italic>y</italic></bold>) (where <bold><italic>y</italic></bold> denotes the observed data) it is generally straightforward to invert <xref ref-type="disp-formula" rid="pcbi.1006955.e004">Eq 1</xref> to impute the corresponding residual <inline-formula id="pcbi.1006955.e006"><alternatives><graphic id="pcbi.1006955.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:mover accent="true"><mml:msup><mml:mi>r</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> by sampling it from the set <inline-formula id="pcbi.1006955.e007"><alternatives><graphic id="pcbi.1006955.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:mrow><mml:msubsup><mml:mi>h</mml:mi> <mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>z</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, the set of residual vectors mapped to <bold><italic>z</italic></bold>′ by <italic>h</italic><sub><bold><italic>M</italic></bold>,<bold><italic>θ</italic></bold></sub>. Under the hypothesis that the fitted model is correct, then <italic>a priori</italic> <inline-formula id="pcbi.1006955.e008"><alternatives><graphic id="pcbi.1006955.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e008" xlink:type="simple"/><mml:math display="inline" id="M8"><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> follows the known distribution. We may therefore apply a classical test for consistency with the theoretical distribution to the imputed <inline-formula id="pcbi.1006955.e009"><alternatives><graphic id="pcbi.1006955.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:mover accent="true"><mml:msup><mml:mi>r</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> (e.g., <italic>Anderson-Darling</italic> hypothesis test [<xref ref-type="bibr" rid="pcbi.1006955.ref033">33</xref>]) and obtain a posterior distribution of <italic>p-values</italic> <inline-formula id="pcbi.1006955.e010"><alternatives><graphic id="pcbi.1006955.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:mrow><mml:mi>π</mml:mi> <mml:mo>(</mml:mo> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>|</mml:mo> <mml:mi mathvariant="bold-italic">y</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, summarizing evidence against the modelling assumptions. This distribution represents the posterior distribution of a p-value obtained by a classical observer of <inline-formula id="pcbi.1006955.e011"><alternatives><graphic id="pcbi.1006955.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e011" xlink:type="simple"/><mml:math display="inline" id="M11"><mml:mover accent="true"><mml:msup><mml:mi>r</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> who tests its compliance with its assumed distribution. Should this posterior distribution place high probability on the p-value taking small values, then with high posterior probability the classical observer would reject the hypothesised model for <inline-formula id="pcbi.1006955.e012"><alternatives><graphic id="pcbi.1006955.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e012" xlink:type="simple"/><mml:math display="inline" id="M12"><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula>. The general approach is discussed in more detail in [<xref ref-type="bibr" rid="pcbi.1006955.ref034">34</xref>].</p>
<p>The latent–residual approach extends the ideas underlying posterior predictive checking [<xref ref-type="bibr" rid="pcbi.1006955.ref035">35</xref>] and can be viewed in that general context. We note that posterior predictive checking has been previously applied in the phylogenetic setting. For example, in [<xref ref-type="bibr" rid="pcbi.1006955.ref036">36</xref>] the fit of a phylogenetic model is assessed by comparing clustering properties of observed trees with the distribution of clustering properties on trees simulated from the posterior predictive distribution. Our approach builds on the standard approach to posterior predictive checking through its use of discrepency variables defined in terms of imputed, rather than directly observed processes, exploiting the freedom afforded by the Bayesian approach to tailor the imputed latent processes so that tests can be targetted at specific modes of model inadequacy. A further difference lies in the use of the full posterior distribution of the resulting imputed p-value to summarise evidence against the model—rather than its expectation as expressed by the usual posterior predictive p-value. Finally we note that, by imputing quantities with a sampling distribution that is fixed under the assumed model and independent of model parameters, we dispense with any need to simulate from their posterior predictive distribution.</p>
</sec>
<sec id="sec009">
<title>Marked latent residuals for model <italic>M</italic><sub>0</sub></title>
<p>Given a realization of the epidemic process, consider a pair of pathogen sequences <italic>G</italic><sub><italic>A</italic></sub> and <italic>G</italic><sub><italic>B</italic></sub> on an infected host at <italic>consecutive ‘critical time points’</italic> <italic>t</italic><sub><italic>A</italic></sub> &lt; <italic>t</italic><sub><italic>B</italic></sub> (where a critical point is a transmission or a (sequence) sampling event). Assuming <italic>G</italic><sub><italic>A</italic></sub> evolves to <italic>G</italic><sub><italic>B</italic></sub> during the interval (<italic>t</italic><sub><italic>A</italic></sub>, <italic>t</italic><sub><italic>B</italic></sub>) according to the continuous-time Markov process specified in <bold><italic>M</italic></bold><sub>0</sub>, the number of observed mutations (i.e. change of nucleotide bases) among <italic>n</italic> nucleotides on <italic>G</italic><sub><italic>A</italic></sub> is distributed as
<disp-formula id="pcbi.1006955.e013"><alternatives><graphic id="pcbi.1006955.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e013" xlink:type="simple"/><mml:math display="block" id="M13"><mml:mrow><mml:mi>m</mml:mi> <mml:mo>∼</mml:mo> <mml:mi>B</mml:mi> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi> <mml:mo>(</mml:mo> <mml:mi>n</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>△</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives> <label>(2)</label></disp-formula>
where △<italic>t</italic> = <italic>t</italic><sub><italic>B</italic></sub> − <italic>t</italic><sub><italic>A</italic></sub> and
<disp-formula id="pcbi.1006955.e014"><alternatives><graphic id="pcbi.1006955.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e014" xlink:type="simple"/><mml:math display="block" id="M14"><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>△</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>75</mml:mn> <mml:mo>-</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>25</mml:mn> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>4</mml:mn> <mml:msub><mml:mi>μ</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mi>△</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:msup> <mml:mo>-</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>5</mml:mn> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>2</mml:mn> <mml:mo>(</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>)</mml:mo> <mml:mi>△</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:msup> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(3)</label></disp-formula>
and <italic>μ</italic><sub>1</sub> and <italic>μ</italic><sub>2</sub> are the rates of <italic>transition</italic> and <italic>transversion</italic> respectively.</p>
<p>We now design a process <inline-formula id="pcbi.1006955.e015"><alternatives><graphic id="pcbi.1006955.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e015" xlink:type="simple"/><mml:math display="inline" id="M15"><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> and a function <inline-formula id="pcbi.1006955.e016"><alternatives><graphic id="pcbi.1006955.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e016" xlink:type="simple"/><mml:math display="inline" id="M16"><mml:mrow><mml:msub><mml:mi>h</mml:mi> <mml:msub><mml:mi mathvariant="bold-italic">M</mml:mi> <mml:mn mathvariant="bold">0</mml:mn></mml:msub></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>.</mml:mo> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> in order that the statistical test on <inline-formula id="pcbi.1006955.e017"><alternatives><graphic id="pcbi.1006955.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e017" xlink:type="simple"/><mml:math display="inline" id="M17"><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> be sensitive to deviation from the s-d-s assumption that underpins molecular evolution. Specifically, we formulate a functional model for the molecular evolutionary process in which components of <inline-formula id="pcbi.1006955.e018"><alternatives><graphic id="pcbi.1006955.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e018" xlink:type="simple"/><mml:math display="inline" id="M18"><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> are independently distributed as
<disp-formula id="pcbi.1006955.e019"><alternatives><graphic id="pcbi.1006955.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e019" xlink:type="simple"/><mml:math display="block" id="M19"><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>∼</mml:mo> <mml:mi>U</mml:mi> <mml:mi>n</mml:mi> <mml:mi>i</mml:mi> <mml:mi>f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(4)</label></disp-formula>
The process described by <xref ref-type="disp-formula" rid="pcbi.1006955.e013">Eq 2</xref> may be reconstructed as
<disp-formula id="pcbi.1006955.e020"><alternatives><graphic id="pcbi.1006955.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e020" xlink:type="simple"/><mml:math display="block" id="M20"><mml:mrow><mml:mi>m</mml:mi> <mml:mo>=</mml:mo> <mml:mo form="prefix" movablelimits="true">inf</mml:mo> <mml:mo>{</mml:mo> <mml:mspace width="0.277778em"/><mml:msup><mml:mi>m</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mrow><mml:mspace width="0.277778em"/><mml:mo>|</mml:mo> <mml:mspace width="0.277778em"/></mml:mrow> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow> <mml:msup><mml:mi>m</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:munderover> <mml:msub><mml:mi>q</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msub> <mml:mo>&gt;</mml:mo> <mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>}</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(5)</label></disp-formula>
where <italic>q</italic><sub>(.)</sub> is the cumulative distribution function of the Binomial distribution in <xref ref-type="disp-formula" rid="pcbi.1006955.e013">Eq 2</xref>. Note that this formulation specifies only the numbers of mutations occurring within a time window; the specific sites at which mutations occur are not specified by <inline-formula id="pcbi.1006955.e021"><alternatives><graphic id="pcbi.1006955.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e021" xlink:type="simple"/><mml:math display="inline" id="M21"><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula>.</p>
<p>The residuals in <inline-formula id="pcbi.1006955.e022"><alternatives><graphic id="pcbi.1006955.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e022" xlink:type="simple"/><mml:math display="inline" id="M22"><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> can be further associated with specific quantities or ‘marks’ characterized by the realized epidemic process. Let <inline-formula id="pcbi.1006955.e023"><alternatives><graphic id="pcbi.1006955.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e023" xlink:type="simple"/><mml:math display="inline" id="M23"><mml:msubsup><mml:mi>t</mml:mi> <mml:mi>A</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006955.e024"><alternatives><graphic id="pcbi.1006955.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e024" xlink:type="simple"/><mml:math display="inline" id="M24"><mml:msubsup><mml:mi>t</mml:mi> <mml:mi>B</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> denote the corresponding critical time points for the <italic>k</italic><sup><italic>th</italic></sup> pair of consecutive sequences <inline-formula id="pcbi.1006955.e025"><alternatives><graphic id="pcbi.1006955.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e025" xlink:type="simple"/><mml:math display="inline" id="M25"><mml:msubsup><mml:mi>G</mml:mi> <mml:mi>A</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006955.e026"><alternatives><graphic id="pcbi.1006955.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e026" xlink:type="simple"/><mml:math display="inline" id="M26"><mml:msubsup><mml:mi>G</mml:mi> <mml:mi>B</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> sampled (or imputed) from a particular infected host. The corresponding residual <inline-formula id="pcbi.1006955.e027"><alternatives><graphic id="pcbi.1006955.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e027" xlink:type="simple"/><mml:math display="inline" id="M27"><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is then associated with the <italic>mark</italic> <disp-formula id="pcbi.1006955.e028"><alternatives><graphic id="pcbi.1006955.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e028" xlink:type="simple"/><mml:math display="block" id="M28"><mml:mrow><mml:msup><mml:mi>ζ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msubsup><mml:mi>t</mml:mi> <mml:mi>A</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>-</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:msubsup><mml:mi>t</mml:mi> <mml:mi>B</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>-</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfrac> <mml:mo>∈</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(6)</label></disp-formula>
where <italic>t</italic><sub>0</sub> is the time of infection of the host. Note that these marks are determined solely by the epidemic process and that the residual associated with a mark is therefore independent of the value of the mark in our functional-model representation. The s-d-s model <bold><italic>M</italic></bold><sub>0</sub> assumes a relationship between the expected number of mutations (effectively a ‘genetic’ time) and the time difference <italic>t</italic><sub><italic>B</italic></sub> − <italic>t</italic><sub><italic>A</italic></sub> that is approximately linear when this difference is small. The quantity <italic>ζ</italic><sup>(<italic>k</italic>)</sup> is designed to identify situations where − proportionately − the ‘effective’ genetic time between <inline-formula id="pcbi.1006955.e029"><alternatives><graphic id="pcbi.1006955.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e029" xlink:type="simple"/><mml:math display="inline" id="M29"><mml:msubsup><mml:mi>G</mml:mi> <mml:mi>A</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006955.e030"><alternatives><graphic id="pcbi.1006955.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e030" xlink:type="simple"/><mml:math display="inline" id="M30"><mml:msubsup><mml:mi>G</mml:mi> <mml:mi>B</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> might deviate from that predicted by <bold><italic>M</italic></bold><sub>0</sub>. Suppose that we fit <bold><italic>M</italic></bold><sub>0</sub> to data generated from a model with considerable within-host-diversity. One may expect that this deviation would be most prominent when <italic>ζ</italic><sup>(<italic>k</italic>)</sup> is large (i.e. when <inline-formula id="pcbi.1006955.e031"><alternatives><graphic id="pcbi.1006955.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e031" xlink:type="simple"/><mml:math display="inline" id="M31"><mml:mrow><mml:msubsup><mml:mi>t</mml:mi> <mml:mi>A</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>≈</mml:mo> <mml:msubsup><mml:mi>t</mml:mi> <mml:mi>B</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> and <italic>ζ</italic><sup>(<italic>k</italic>)</sup> ≈ 1). As <inline-formula id="pcbi.1006955.e032"><alternatives><graphic id="pcbi.1006955.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e032" xlink:type="simple"/><mml:math display="inline" id="M32"><mml:mrow><mml:msubsup><mml:mi>t</mml:mi> <mml:mi>A</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>t</mml:mi> <mml:mi>B</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>≈</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, <bold><italic>M</italic></bold><sub>0</sub> would predict very few mutations between <inline-formula id="pcbi.1006955.e033"><alternatives><graphic id="pcbi.1006955.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e033" xlink:type="simple"/><mml:math display="inline" id="M33"><mml:msubsup><mml:mi>G</mml:mi> <mml:mi>A</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006955.e034"><alternatives><graphic id="pcbi.1006955.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e034" xlink:type="simple"/><mml:math display="inline" id="M34"><mml:msubsup><mml:mi>G</mml:mi> <mml:mi>B</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>, while the within-host-diversity may lead to a substantial difference between <inline-formula id="pcbi.1006955.e035"><alternatives><graphic id="pcbi.1006955.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e035" xlink:type="simple"/><mml:math display="inline" id="M35"><mml:msubsup><mml:mi>G</mml:mi> <mml:mi>A</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006955.e036"><alternatives><graphic id="pcbi.1006955.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e036" xlink:type="simple"/><mml:math display="inline" id="M36"><mml:msubsup><mml:mi>G</mml:mi> <mml:mi>B</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>. <xref ref-type="fig" rid="pcbi.1006955.g001">Fig 1</xref> illustrates schematically the rationale behind the marked latent residuals. Therefore, the deviation from the s-d-s assumption should be <italic>systematically</italic> reflected in the distribution of the imputed residuals associated with large <italic>ζ</italic><sup>(<italic>k</italic>)</sup> (see <xref ref-type="sec" rid="sec013">Results</xref>). In particular, according to (the inversion of) <xref ref-type="disp-formula" rid="pcbi.1006955.e020">Eq 5</xref>, we expect to observe a concentration of (imputed) residuals close to 1 when attention is restricted to residuals associated with high mark <italic>ζ</italic><sup>(<italic>k</italic>)</sup> (<xref ref-type="sec" rid="sec013">Results</xref>). We therefore anticipate, for example, that a test that restricts attention to a subset of residuals with non-zero marks may be more sensitive to within-host pathogen diversity than one based on the full set of residuals (<xref ref-type="sec" rid="sec013">Results</xref>).</p>
<fig id="pcbi.1006955.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006955.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Schematic illustration of the rationale of the marked latent residuals.</title>
<p>Assume that a single pathogen strain enters a host and begins to evolve at time <italic>t</italic><sub>0</sub>. A within-host-diversity model, crudely illustrated by (a), allows for establishment of new strains (i.e. new branches) generated from mutations (occurred at internal nodes). The s-d-s model <bold><italic>M</italic></bold><sub>0</sub>, illustrated by (b), allows only mutations along the (linear) line/branch and as a result assumes only one (dominant) strain at any particular time point. Assume that two sequence samples <italic>G</italic><sub><italic>A</italic></sub> and <italic>G</italic><sub><italic>B</italic></sub> (superscripts dropped without ambiguity) are randomly sampled from the pathogen population at <italic>t</italic><sub><italic>A</italic></sub> and <italic>t</italic><sub><italic>B</italic></sub> respectively, where <italic>t</italic><sub><italic>A</italic></sub> − <italic>t</italic><sub><italic>B</italic></sub> ≈ 0 (i.e. <italic>ζ</italic><sup>(<italic>k</italic>)</sup> ≈ 1). (a) may predict distinct <italic>G</italic><sub><italic>A</italic></sub> and <italic>G</italic><sub><italic>B</italic></sub>, while (b) would predict minimal difference between them due to the implied linear relationship between mutations and time. Therefore, residuals associated with high <italic>ζ</italic><sup>(<italic>k</italic>)</sup> may be expected to be large if a model takes insufficient account of within-host-diversity.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006955.g001" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec010">
<title>Associating with superspreading events</title>
<p><italic>Superspreading</italic> is a common phenomenon in many infectious disease epidemics [<xref ref-type="bibr" rid="pcbi.1006955.ref026">26</xref>, <xref ref-type="bibr" rid="pcbi.1006955.ref037">37</xref>] in which numerous infections by a given host occur within a relatively short period of time and multiple pathogen-sequence pairs are sampled/transmitted closely in time (see <xref ref-type="fig" rid="pcbi.1006955.g001">Fig 1</xref>). Since systematic deviation from <italic>Unif</italic>(0, 1) is expected in residuals associated with high marks, and high marks may be more numerous in the event of superspreading, one may naturally conjecture that deviations from the s-d-s model, as detected using our methods, may be most apparent when superspreading occurs.</p>
<p>The general ideas underpinning the construction of latent residuals can be applied to design tests to detect other modes of mis-specification. The imputation of ‘infection-link’ residuals to detect mis-specification of spatial kernel functions has been described in [<xref ref-type="bibr" rid="pcbi.1006955.ref022">22</xref>], where residuals to detect mis-specification of sojourn time distributions are also considered. The construction of the marked genetic residuals described here could also be modified to detect alternative suspected modes of mis-specification of a genetic model. The key aim would be to identify imputable outcomes from the epidemic model (e.g. exposure times of individuals, properties of the transmission graph) that can be used to specify marks in such a way that an association between marks and residuals would be expected should the suspected mis-specification be present. For example, were it suspected that the mutation rate of the pathogen population were increasing or decreasing over time, then we might redefine the mark associated with a given residual (see <xref ref-type="disp-formula" rid="pcbi.1006955.e028">Eq (6)</xref>) to simply be <italic>t</italic><sub><italic>A</italic></sub>—the infection time of the source imputed for a particular infection event. Any increase in the true mutation rate over time should then induce some systematic dependence of imputed residuals on the corresponding mark, with small (resp. high) marks tending to be associated with small (resp. high) residuals. Were it suspected that the pathogen’s ability to reproduce itself tended to be less in the recipient than in the donor of infection, then this deviation may be detected by defining the mark associated a residual to be the depth of the corresponding donor in the imputed transmission graph, and testing for an association between residuals and the corresponding mark. Either of these tests could be implemented via comparatively minor modifications of the algorithms presented here.</p>
</sec>
</sec>
<sec id="sec011">
<title>Statistical inference</title>
<p>An overview of the Bayesian inference procedures used in the paper is given in <italic>SI: SI Text</italic>. In summary, given observations <italic>y</italic>, we use standard Bayesian data-augmentation approaches to generate samples from <italic>π</italic>(<bold><italic>θ</italic></bold>, <bold><italic>z</italic></bold> = (<bold><italic>z</italic></bold><sub><italic>e</italic></sub>, <bold><italic>z</italic></bold><sub><italic>g</italic></sub>)|<bold><italic>y</italic></bold>) where <italic>z</italic><sub><italic>e</italic></sub> comprises the times and nature of all transitions occurring during the epidemic and <italic>z</italic><sub><italic>g</italic></sub> comprises the set of observed genetic sequences augmented with the set of sequences passed during transmission events. These techniques, as applied to the model <bold><italic>M</italic></bold><sub>0</sub>, are described in detail in [<xref ref-type="bibr" rid="pcbi.1006955.ref003">3</xref>].</p>
<p>Given a draw from <italic>π</italic>(<bold><italic>θ</italic></bold>, <bold><italic>z</italic></bold> = (<bold><italic>z</italic></bold><sub><italic>e</italic></sub>, <bold><italic>z</italic></bold><sub><italic>g</italic></sub>)|<bold><italic>y</italic></bold>), it is straightforward to impute the corresponding latent residual process <inline-formula id="pcbi.1006955.e037"><alternatives><graphic id="pcbi.1006955.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e037" xlink:type="simple"/><mml:math display="inline" id="M37"><mml:mover accent="true"><mml:msup><mml:mi>r</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> by reversing the procedure described in <xref ref-type="disp-formula" rid="pcbi.1006955.e020">Eq 5</xref>, given <italic>m</italic> and the other model parameters inferred in the Bayesian framework. The imputed <inline-formula id="pcbi.1006955.e038"><alternatives><graphic id="pcbi.1006955.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e038" xlink:type="simple"/><mml:math display="inline" id="M38"><mml:mover accent="true"><mml:msup><mml:mi>r</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is then compared to its sampling distribution (i.i.d. <italic>Unif</italic>(0, 1)) to quantify the evidence against model <bold><italic>M</italic></bold><sub>0</sub> −here using the posterior distribution of the associated p-value, <inline-formula id="pcbi.1006955.e039"><alternatives><graphic id="pcbi.1006955.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e039" xlink:type="simple"/><mml:math display="inline" id="M39"><mml:mrow><mml:mi>π</mml:mi> <mml:mo>(</mml:mo> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>|</mml:mo> <mml:mi mathvariant="bold-italic">y</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. When strong evidence against the model is observed, the corresponding marked latent residuals may be inspected to elicit the nature of the poor fit (<xref ref-type="sec" rid="sec013">Results</xref>).</p>
<sec id="sec012">
<title>Model refinement: Generalizing the S-D-S model</title>
<p>While it may be straightforward to simulate data-sets using Model <bold><italic>M</italic></bold><sub>1</sub> inference with this model, using the approach applied to Model <bold><italic>M</italic></bold><sub>0</sub>, is problematic due to intractability of the genetic component of the likelihood. We therefore propose an alternative inferential framework—effectively using a surrogate model—that can represents within-host-diversity and attempt to assess its adequacy using our methods.</p>
<p>Assume that an infectious individual infects individuals at times <italic>t</italic><sub>1</sub> &lt; <italic>t</italic><sub>2</sub> &lt; … during the period [<italic>t</italic><sub>0</sub>, <italic>t</italic><sub><italic>f</italic></sub>]. The s-d-s model <bold><italic>M</italic></bold><sub>0</sub> assumes that the strain transmitted at <italic>t</italic><sub><italic>k</italic></sub> is a direct descendent of that transmitted at <italic>t</italic><sub><italic>k</italic>−1</sub> and a full likelihood function can be constructed for the genetic differences between strains assuming a comparatively simple mutation model [<xref ref-type="bibr" rid="pcbi.1006955.ref003">3</xref>]. However, while it is possible to simulate within-host evolution from a mechanistic within-host-diversity model (e.g., from model <bold><italic>M</italic></bold><sub>1</sub>, see <xref ref-type="sec" rid="sec002">Models</xref>), it may not be straightforward to perform inference with the dynamical model used. We therefore formulate a pseudo-likelihood framework <bold><italic>M</italic></bold><sub><italic>p</italic></sub> which takes into account within-host-diversity (and allows departure from the s-d-s assumption), and includes the s-d-s model <bold><italic>M</italic></bold><sub>0</sub> as a limiting case.</p>
<p>We introduce a framework which represents an ‘effective genetic time difference’ between two strains randomly chosen from the population within a host (and transmitted) at critical time points <italic>t</italic><sub><italic>A</italic></sub>, <italic>t</italic><sub><italic>B</italic></sub> ∈ [<italic>t</italic><sub>0</sub>, <italic>t</italic><sub><italic>f</italic></sub>]. The effective time difference between the two strains <italic>G</italic><sub><italic>A</italic></sub> and <italic>G</italic><sub><italic>B</italic></sub>, transmitted at times <italic>t</italic><sub><italic>A</italic></sub> &lt; <italic>t</italic><sub><italic>B</italic></sub>, is defined to be:
<disp-formula id="pcbi.1006955.e040"><alternatives><graphic id="pcbi.1006955.e040g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e040" xlink:type="simple"/><mml:math display="block" id="M40"><mml:mrow><mml:mi>T</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>G</mml:mi> <mml:mi>A</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>G</mml:mi> <mml:mi>B</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>A</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>B</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:mn>2</mml:mn> <mml:msub><mml:mi>T</mml:mi> <mml:mi>c</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>G</mml:mi> <mml:mi>A</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>G</mml:mi> <mml:mi>B</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(7)</label></disp-formula>
where <italic>t</italic><sub><italic>A</italic></sub> ≥ <italic>T</italic><sub><italic>c</italic></sub>(<italic>G</italic><sub><italic>A</italic></sub>, <italic>G</italic><sub><italic>B</italic></sub>) ≥ <italic>t</italic><sub>0</sub> is the latest time up to which ancestry of <italic>G</italic><sub><italic>A</italic></sub> and <italic>G</italic><sub><italic>B</italic></sub> is common. Now <italic>T</italic>(<italic>G</italic><sub><italic>A</italic></sub>, <italic>G</italic><sub><italic>B</italic></sub>) is unknown so we treat it as a random variable. A mutation event (i.e. a nucleotide at a same position on <italic>G</italic><sub><italic>A</italic></sub> and <italic>G</italic><sub><italic>B</italic></sub> being different) may be then described by a simple probabilistic model, i.e., probability of a mutation
<disp-formula id="pcbi.1006955.e041"><alternatives><graphic id="pcbi.1006955.e041g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e041" xlink:type="simple"/><mml:math display="block" id="M41"><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>T</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>G</mml:mi> <mml:mi>A</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>G</mml:mi> <mml:mi>B</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo><mml:mo>λ</mml:mo><mml:mi>T</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>G</mml:mi> <mml:mi>A</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>G</mml:mi> <mml:mi>B</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives> <label>(8)</label></disp-formula>where λ represents a mutation rate (note that we use single parameter λ for mutation rate as opposed to the two-parameter setting in the s-d-s model). Note that <italic>t</italic><sub><italic>B</italic></sub> − <italic>t</italic><sub><italic>A</italic></sub> &lt; <italic>T</italic>(<italic>G</italic><sub><italic>A</italic></sub>, <italic>G</italic><sub><italic>B</italic></sub>) &lt; <italic>t</italic><sub><italic>B</italic></sub> + <italic>t</italic><sub><italic>A</italic></sub> − 2<italic>t</italic><sub>0</sub>. Under our approach we assume
<disp-formula id="pcbi.1006955.e042"><alternatives><graphic id="pcbi.1006955.e042g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e042" xlink:type="simple"/><mml:math display="block" id="M42"><mml:mrow><mml:msup><mml:mi>T</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>G</mml:mi> <mml:mi>A</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>G</mml:mi> <mml:mi>B</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∼</mml:mo> <mml:mtext>Beta</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>γ</mml:mi> <mml:mo>,</mml:mo> <mml:mi>η</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(9)</label></disp-formula>
where
<disp-formula id="pcbi.1006955.e043"><alternatives><graphic id="pcbi.1006955.e043g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e043" xlink:type="simple"/><mml:math display="block" id="M43"><mml:mrow><mml:msup><mml:mi>T</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>G</mml:mi> <mml:mi>A</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>G</mml:mi> <mml:mi>B</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mi>T</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>G</mml:mi> <mml:mi>A</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>G</mml:mi> <mml:mi>B</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>B</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>A</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:mn>2</mml:mn> <mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>A</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:mo>∈</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(10)</label></disp-formula>
We then formulate a ‘pseudo-likelihood’ function for the complete genetic data by augmenting the genetic data with the unknown <italic>T</italic>(<italic>G</italic><sub><italic>A</italic></sub>, <italic>G</italic><sub><italic>B</italic></sub>) (or equivalently <italic>T</italic>*(<italic>G</italic><sub><italic>A</italic></sub>, <italic>G</italic><sub><italic>B</italic></sub>)) for each successive pair of transmitted strains, by assuming that the relationship of <italic>G</italic><sub><italic>B</italic></sub> to <italic>G</italic><sub><italic>A</italic></sub> is independent of the latter’s relationship to any previously sampled or transmitted strain strains. Details of the formulation of the likelihood function are given in <italic>SI</italic>: <xref ref-type="supplementary-material" rid="pcbi.1006955.s001">S1 Text</xref>. Note that the s-d-s model would arise as a special case of the above in the limit where <italic>γ</italic> is fixed and <italic>η</italic> → ∞. The corresponding limiting distribution for <italic>T</italic>*(<italic>G</italic><sub><italic>A</italic></sub>, <italic>G</italic><sub><italic>B</italic></sub>) places unit probability on <italic>T</italic>*(<italic>G</italic><sub><italic>A</italic></sub>, <italic>G</italic><sub><italic>B</italic></sub>) = 0, so that the effective time difference reduces to <italic>t</italic><sub><italic>B</italic></sub> − <italic>t</italic><sub><italic>A</italic></sub>. Model inference is performed by adapting the MCMC algorithm used to fit the s-d-s model in [<xref ref-type="bibr" rid="pcbi.1006955.ref003">3</xref>] by further augmenting the parameter vector with the <italic>T</italic>*(<italic>G</italic><sub><italic>A</italic></sub>, <italic>G</italic><sub><italic>B</italic></sub>) and replacing the part of the likelihood contributed by the evolutionary process with a pseudo-likelihood function (as detailed in <italic>SI</italic>: <xref ref-type="supplementary-material" rid="pcbi.1006955.s001">S1 Text</xref>).</p>
<p>Latent residuals under this pseudo-likelihood framework <bold><italic>M</italic></bold><sub><italic>p</italic></sub> may be constructed in a fashion similar to that applied to <bold><italic>M</italic></bold><sub>0</sub>, by replacing the probability of observing a mutation <italic>p</italic><sub>Δ<italic>t</italic></sub> (under the s-d-s assumption) in <xref ref-type="disp-formula" rid="pcbi.1006955.e014">Eq 3</xref> by <italic>p</italic><sub><italic>T</italic>(<italic>G</italic><sub><italic>A</italic></sub>, <italic>G</italic><sub><italic>B</italic></sub>)</sub> (which considers within-host diversity) in <xref ref-type="disp-formula" rid="pcbi.1006955.e041">Eq 8</xref>.</p>
<p>Although we have a simple Jukes-Cantor substitution model in <bold><italic>M</italic></bold><sub><italic>p</italic></sub>, in the interests of reducing complexity, we remark that the approach can be applied, with little modification, when the Kimura model is used in <bold><italic>M</italic></bold><sub><italic>p</italic></sub>, since the probability of mutation at a site in a given interval is not dependent on the base at the site in question. Hence the number of mutations in a given interval follows a binomial distribution and a residual can be imputed based on the quantile function of the binomial, as we do here. Note that we could define a second residual process related to the relative frequency of transitions and transversions by first noting that, conditional on the number of of mutations being <italic>m</italic>, the number of transitions follows a <italic>Bin</italic>(<italic>m</italic>, <italic>p</italic>) distribution for some appropriate <italic>p</italic> calculable from the generator matrix of the continuous-time Markov process defining the dynamics of mutations at a site, and the effective time <italic>T</italic>(<italic>G</italic><sub><italic>A</italic></sub>, <italic>G</italic><sub><italic>B</italic></sub>). Intuitively, we may expect evidence against the model’s assumptions on within-host diversity to be most apparent from inspection of the first set of residuals. Accordingly, we may only impute, and test against the assumption of uniformity, the first residual process relating to the number of mutations. For the Jukes-Cantor model we remark that <inline-formula id="pcbi.1006955.e044"><alternatives><graphic id="pcbi.1006955.e044g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e044" xlink:type="simple"/><mml:math display="inline" id="M44"><mml:mrow><mml:mi>p</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>3</mml:mn></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>. Hence, if we wished to test our Jukes-Kantor assumption using this framework we may consider the second residual process, imputed under the Jukes-Kantor assumption <inline-formula id="pcbi.1006955.e045"><alternatives><graphic id="pcbi.1006955.e045g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e045" xlink:type="simple"/><mml:math display="inline" id="M45"><mml:mrow><mml:mi>p</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>3</mml:mn></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula> and test for deviations from <italic>U</italic>(0, 1). Were a more complex substitution model, incorporating base-dependent transition rates, then functional-model representations—along with related residual processes—could nevertheless be constructed, by representing mutations between strains <italic>G</italic><sub><italic>A</italic></sub> and <italic>G</italic><sub><italic>B</italic></sub> in a given effective period in terms of four distinct, independent binomial distributions with parameters (<italic>n</italic><sub><italic>A</italic></sub>, <italic>p</italic><sub><italic>A</italic></sub>), (<italic>n</italic><sub><italic>T</italic></sub>, <italic>p</italic><sub><italic>T</italic></sub>), (<italic>n</italic><sub><italic>G</italic></sub>, <italic>p</italic><sub><italic>G</italic></sub>), (<italic>n</italic><sub><italic>C</italic></sub>, <italic>p</italic><sub><italic>C</italic></sub>) where the first parameters denote the numbers of sites occupied by each of the respective four bases and the second parameters denote the respective mutation probabilities. We therefore believe that our basic approach can be tailored to settings where the mutation process at sites follows a general continuous-time Markov process.</p>
</sec>
</sec>
</sec>
<sec id="sec013" sec-type="results">
<title>Results</title>
<sec id="sec014">
<title>Simulation studies</title>
<p>To test our diagnostic framework, we consider two scenarios: (I) the s-d-s (null) model <bold><italic>M</italic></bold><sub>0</sub> is fitted to data generated from <bold><italic>M</italic></bold><sub>0</sub> itself and (II) <bold><italic>M</italic></bold><sub>0</sub> is (inappropriately) fitted to data generated from a within-host-diversity model <bold><italic>M</italic></bold><sub>1</sub>. We use the same (SEIR) spatio-temporal epidemic process component in both <bold><italic>M</italic></bold><sub>0</sub> and <bold><italic>M</italic></bold><sub>1</sub>. Instead of assuming s-d-s, <bold><italic>M</italic></bold><sub>1</sub> embodies a continuous-time evolutionary process that accounts for growth, death and mutation of pathogen strains. Details of the models are given in <italic>Models</italic>.</p>
<p>We first simulate an epidemiological dataset <bold><italic>z</italic></bold><sub><italic>e</italic></sub> among a susceptible population (with size <italic>N</italic> = 150, generated as a random sample from a uniform distribution over a square region) using the common epidemic process component shared by <bold><italic>M</italic></bold><sub>0</sub> and <bold><italic>M</italic></bold><sub>1</sub>, during a period (0, <italic>T</italic><sub><italic>max</italic></sub>). Data <bold><italic>z</italic></bold><sub><italic>e</italic></sub> comprise typical epidemiological events, including infection time, transition times from compartment E to I and from I to R and transmission path. Conditioning on this <bold><italic>z</italic></bold><sub><italic>e</italic></sub>, several sets of (different) sequence data <bold><italic>z</italic></bold><sub><italic>g</italic></sub> are then simulated, using the evolutionary component (s-d-s) in <bold><italic>M</italic></bold><sub>0</sub> (Scenario I) in a single case and that in <bold><italic>M</italic></bold><sub>1</sub> (Scenario II) in 5 cases. Using the same set of <bold><italic>z</italic></bold><sub><italic>e</italic></sub> (and epidemic process component) ensures that any discrepancy in the evidence of mis-specification between the two scenarios arises from the difference of the evolutionary component.</p>
<p>In each scenario, we use Bayesian data augmentation to generate a sample from <italic>π</italic>(<bold><italic>θ</italic></bold>, <bold><italic>z</italic></bold> = (<bold><italic>z</italic></bold><sub><italic>e</italic></sub>, <bold><italic>z</italic></bold><sub><italic>g</italic></sub>)|<bold><italic>y</italic></bold>) from which we impute <inline-formula id="pcbi.1006955.e046"><alternatives><graphic id="pcbi.1006955.e046g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e046" xlink:type="simple"/><mml:math display="inline" id="M46"><mml:mover accent="true"><mml:msup><mml:mi>r</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, from the posterior distribution of the residual vector (<italic>SI</italic>: <xref ref-type="supplementary-material" rid="pcbi.1006955.s001">S1 Text</xref>.) Here the observed data <bold><italic>y</italic></bold> include: times and locations of all transitions from E to I and from I to R, and sequences sampled for each infected host at a random sampling time. Transmission path, infection times and sequences transmitted during infection events are assumed to be unknown.</p>
<p>For the assumed model <bold><italic>M</italic></bold><sub>0</sub> <italic>a priori</italic> <inline-formula id="pcbi.1006955.e047"><alternatives><graphic id="pcbi.1006955.e047g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e047" xlink:type="simple"/><mml:math display="inline" id="M47"><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is distributed as a random sample from a <italic>Unif</italic>(0, 1). Moreover, if <inline-formula id="pcbi.1006955.e048"><alternatives><graphic id="pcbi.1006955.e048g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e048" xlink:type="simple"/><mml:math display="inline" id="M48"><mml:msup><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>*</mml:mo></mml:msup></mml:math></alternatives></inline-formula> denotes the subset of <inline-formula id="pcbi.1006955.e049"><alternatives><graphic id="pcbi.1006955.e049g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e049" xlink:type="simple"/><mml:math display="inline" id="M49"><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> with non-zero associated marks, then <italic>a priori</italic> <inline-formula id="pcbi.1006955.e050"><alternatives><graphic id="pcbi.1006955.e050g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e050" xlink:type="simple"/><mml:math display="inline" id="M50"><mml:msup><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>*</mml:mo></mml:msup></mml:math></alternatives></inline-formula> is also a random sample from <italic>Unif</italic>(0, 1). Then we apply an <italic>Anderson-Darling</italic> test to <inline-formula id="pcbi.1006955.e051"><alternatives><graphic id="pcbi.1006955.e051g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e051" xlink:type="simple"/><mml:math display="inline" id="M51"><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, and to the subset <inline-formula id="pcbi.1006955.e052"><alternatives><graphic id="pcbi.1006955.e052g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e052" xlink:type="simple"/><mml:math display="inline" id="M52"><mml:msup><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>*</mml:mo></mml:msup></mml:math></alternatives></inline-formula> to test for consistency with the uniform distribution. We can summarize the evidence against model assumptions from the posterior distribution of the p-values using summary statistics such as <inline-formula id="pcbi.1006955.e053"><alternatives><graphic id="pcbi.1006955.e053g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e053" xlink:type="simple"/><mml:math display="inline" id="M53"><mml:mrow><mml:mi>π</mml:mi> <mml:mo>(</mml:mo> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>&lt;</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>05</mml:mn> <mml:mo>|</mml:mo> <mml:mi mathvariant="bold-italic">y</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> (mainly used here) as well as the empirical distribution functions of the p-values. <xref ref-type="table" rid="pcbi.1006955.t001">Table 1</xref> shows clear evidence against the null model <bold><italic>M</italic></bold><sub>0</sub> in scenario II. <xref ref-type="fig" rid="pcbi.1006955.g002">Fig 2</xref> shows that by using the subset <inline-formula id="pcbi.1006955.e054"><alternatives><graphic id="pcbi.1006955.e054g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e054" xlink:type="simple"/><mml:math display="inline" id="M54"><mml:msup><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>*</mml:mo></mml:msup></mml:math></alternatives></inline-formula> we consistently obtain more evidence against the s-d-s model, notably in the case Set 2 where the conclusion is relatively ambiguous.</p>
<fig id="pcbi.1006955.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006955.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Empirical cumulative distribution functions of p-value obtained by applying the Anderson-Darling test to the subset of residuals with non-zero marks and to the full set of residuals (for simulations set 1 to set 5 in Scenario II where s-d-s model <italic>M</italic><sub>0</sub> is (inappropriately) fitted to data generated from a within-host-diversity model <italic>M</italic><sub>1</sub>), see also <xref ref-type="table" rid="pcbi.1006955.t001">Table 1</xref>.</title>
<p>Proportions of p-value less than 0.05 (indicated by colored text) in this case are consistently higher for the subset of residuals corresponding to non-zero marks (red text).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006955.g002" xlink:type="simple"/>
</fig>
<table-wrap id="pcbi.1006955.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006955.t001</object-id>
<label>Table 1</label>
<caption>
<title>Proportions of p-value less than 0.05 that indicate overall evidence against the null model in two scenarios: (1) fitting the correct model structures and (2) fitting the s-d-s <italic>M</italic><sub>0</sub> to data generated from a within-host-diversity model <italic>M</italic><sub>1</sub>.</title>
<p>For scenario (2), five datasets are generated independently from <bold><italic>M</italic></bold><sub>1</sub> with a same set of parameter values (<italic>Models</italic>), which are used to reveal any consistent difference of the evidence of model mis-specification compared to scenario (1). Noted that in both scenarios, the (same) correct epidemic process component is fitted. <inline-formula id="pcbi.1006955.e055"><alternatives><graphic id="pcbi.1006955.e055g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e055" xlink:type="simple"/><mml:math display="inline" id="M55"><mml:msup><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:mrow> <mml:mo>*</mml:mo></mml:msup></mml:math></alternatives></inline-formula> is the subset of the full set of residuals <inline-formula id="pcbi.1006955.e056"><alternatives><graphic id="pcbi.1006955.e056g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e056" xlink:type="simple"/><mml:math display="inline" id="M56"><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, associated with non-zero marks <italic>ζ</italic><sup><italic>k</italic></sup>.</p>
</caption>
<alternatives>
<graphic id="pcbi.1006955.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006955.t001" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left">Model Fitted</th>
<th align="right">
<inline-formula id="pcbi.1006955.e057">
<alternatives>
<graphic id="pcbi.1006955.e057g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e057" xlink:type="simple"/>
<mml:math display="inline" id="M57">
<mml:mrow>
<mml:mi>π</mml:mi>
<mml:mo>(</mml:mo>
<mml:mi>P</mml:mi>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mover accent="true">
<mml:mi>r</mml:mi>
<mml:mo>˜</mml:mo>
</mml:mover>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>&lt;</mml:mo>
<mml:mn>0</mml:mn>
<mml:mo>.</mml:mo>
<mml:mn>05</mml:mn>
<mml:mo>|</mml:mo>
<mml:mi>y</mml:mi>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:math>
</alternatives>
</inline-formula>
</th>
<th align="right">
<inline-formula id="pcbi.1006955.e058">
<alternatives>
<graphic id="pcbi.1006955.e058g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e058" xlink:type="simple"/>
<mml:math display="inline" id="M58">
<mml:mrow>
<mml:mi>π</mml:mi>
<mml:mo>(</mml:mo>
<mml:mi>P</mml:mi>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mover accent="true">
<mml:mi>r</mml:mi>
<mml:mo>˜</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mo>*</mml:mo>
</mml:msup>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>&lt;</mml:mo>
<mml:mn>0</mml:mn>
<mml:mo>.</mml:mo>
<mml:mn>05</mml:mn>
<mml:mo>|</mml:mo>
<mml:mi>y</mml:mi>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:math>
</alternatives>
</inline-formula>
</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><bold><italic>M</italic></bold><sub>0</sub></td>
<td align="right">4.7%</td>
<td align="right">4.4%</td>
</tr>
<tr>
<td align="left"><bold><italic>M</italic></bold><sub>1</sub> (Set 1)</td>
<td align="right">85.7%</td>
<td align="right">95.5%</td>
</tr>
<tr>
<td align="left"><bold><italic>M</italic></bold><sub>1</sub> (Set 2)</td>
<td align="right">61.4%</td>
<td align="right">87.0%</td>
</tr>
<tr>
<td align="left"><bold><italic>M</italic></bold><sub>1</sub> (Set 3)</td>
<td align="right">99.7%</td>
<td align="right">100%</td>
</tr>
<tr>
<td align="left"><bold><italic>M</italic></bold><sub>1</sub> (Set 4)</td>
<td align="right">86.7%</td>
<td align="right">95.8%</td>
</tr>
<tr>
<td align="left"><bold><italic>M</italic></bold><sub>1</sub> (Set 5)</td>
<td align="right">100%</td>
<td align="right">100%</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>Having observed strong evidence against the null model in scenario II, we investigate the imputed residuals conditional on the p-value being less than 0.05 to detect any systematic pattern. <xref ref-type="fig" rid="pcbi.1006955.g003">Fig 3</xref> shows that, as conjectured, for <italic>ζ</italic><sup>(<italic>k</italic>)</sup> with values in the upper tercile of the set of marks, the corresponding residuals are consistently disproportionately located at the right-hand end of the interval (0, 1), suggesting that model <bold><italic>M</italic></bold><sub>0</sub> may take insufficient account of within-host-diversity leading to the poor model-fit suggested by <xref ref-type="table" rid="pcbi.1006955.t001">Table 1</xref>.</p>
<fig id="pcbi.1006955.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006955.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Systematic deviation revealed by the marked latent residuals.</title>
<p>(a)-(e) correspond to simulation set 1-5 (from Scenario II where s-d-s model <bold><italic>M</italic></bold><sub>0</sub> is (inappropriately) fitted to data generated from a within-host-diversity model <bold><italic>M</italic></bold><sub>1</sub>). The histograms depicted in the first row are formed by aggregating residuals whose associated marks <italic>ζ</italic><sup>(<italic>k</italic>)</sup> lie in the top tercile of marks for any posterior sample for which the p-value of the Anderson-Darling test is less than 0.05. The histograms of <italic>ζ</italic><sup>(<italic>k</italic>)</sup> are shown in the second row. Residuals associated with smaller <italic>ζ</italic><sup>(<italic>k</italic>)</sup> may exhibit a multiplicity of patterns (see <italic>S</italic>I: <xref ref-type="supplementary-material" rid="pcbi.1006955.s002">S1 Fig</xref>).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006955.g003" xlink:type="simple"/>
</fig>
<p>Also, <xref ref-type="supplementary-material" rid="pcbi.1006955.s003">S2 Fig</xref> in <italic>SI</italic> shows that inferred posterior distributions can accurately recover the true values of the model parameters when fitting the correct model.</p>
</sec>
<sec id="sec015">
<title>Case study: Animal foot-and-mouth disease outbreak</title>
<sec id="sec016">
<title>Model diagnosis</title>
<p>In this section we apply our diagnostic framework to a localized FMD outbreak in the UK (Darlington, Durham County) in 2001 previously analysed by several authors (e.g., [<xref ref-type="bibr" rid="pcbi.1006955.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1006955.ref005">5</xref>]). Some 15 infected premises (i.e. farms, indexed by by the letters A-P) were observed, from which one virus sequence for each premises with sequence length <italic>n</italic> = 8176 was sampled [<xref ref-type="bibr" rid="pcbi.1006955.ref005">5</xref>, <xref ref-type="bibr" rid="pcbi.1006955.ref013">13</xref>]. The geographical locations, the removal (i.e. culling) times and the genome sampling times of the infected premises were also reported. Here we fit the model <bold><italic>M</italic></bold><sub>0</sub> (also fitted in [<xref ref-type="bibr" rid="pcbi.1006955.ref003">3</xref>]) and use our diagnostic framework to elicit evidence of mis-specification.</p>
<p>Despite the relatively small size of this dataset, our residuals detect notable evidence against the model <bold><italic>M</italic></bold><sub>0</sub> both using <inline-formula id="pcbi.1006955.e059"><alternatives><graphic id="pcbi.1006955.e059g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e059" xlink:type="simple"/><mml:math display="inline" id="M59"><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006955.e060"><alternatives><graphic id="pcbi.1006955.e060g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e060" xlink:type="simple"/><mml:math display="inline" id="M60"><mml:msup><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:mrow> <mml:mo>*</mml:mo></mml:msup></mml:math></alternatives></inline-formula>. Specifically we find that <inline-formula id="pcbi.1006955.e061"><alternatives><graphic id="pcbi.1006955.e061g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e061" xlink:type="simple"/><mml:math display="inline" id="M61"><mml:mrow><mml:mi>π</mml:mi> <mml:mo>(</mml:mo> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>&lt;</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>05</mml:mn> <mml:mo>|</mml:mo> <mml:mi mathvariant="bold-italic">y</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> = 100% and <inline-formula id="pcbi.1006955.e062"><alternatives><graphic id="pcbi.1006955.e062g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e062" xlink:type="simple"/><mml:math display="inline" id="M62"><mml:mrow><mml:mi>π</mml:mi> <mml:mo>(</mml:mo> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:mrow> <mml:mo>*</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>&lt;</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>05</mml:mn> <mml:mo>|</mml:mo> <mml:mi mathvariant="bold-italic">y</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> = 80%. The corresponding proportions become respectively 100% and 61% when the significance level 0.05 is replaced by the more conservative 0.01.</p>
<p><xref ref-type="fig" rid="pcbi.1006955.g004">Fig 4</xref> further reveals that within-host-diversity has been considerably under-estimated by fitting <bold><italic>M</italic></bold><sub>0</sub>. It is observed that, in this case, the subset of residuals <inline-formula id="pcbi.1006955.e063"><alternatives><graphic id="pcbi.1006955.e063g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e063" xlink:type="simple"/><mml:math display="inline" id="M63"><mml:msup><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:mrow> <mml:mo>*</mml:mo></mml:msup></mml:math></alternatives></inline-formula> yields less evidence than <inline-formula id="pcbi.1006955.e064"><alternatives><graphic id="pcbi.1006955.e064g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e064" xlink:type="simple"/><mml:math display="inline" id="M64"><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, plausibly due to the the small outbreak size, the small sample size of <inline-formula id="pcbi.1006955.e065"><alternatives><graphic id="pcbi.1006955.e065g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e065" xlink:type="simple"/><mml:math display="inline" id="M65"><mml:msup><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:mrow> <mml:mo>*</mml:mo></mml:msup></mml:math></alternatives></inline-formula> and the reduced potential for superspreading events. We observed that few marks attain higher values close to unity (<xref ref-type="fig" rid="pcbi.1006955.g004">Fig 4</xref>) compared to the simulated scenarios (<xref ref-type="fig" rid="pcbi.1006955.g003">Fig 3</xref>) where the outbreak size (<italic>N</italic> = 150) is much larger. The results are also consistent with studies of sequence diversity of FMD virus (e.g. [<xref ref-type="bibr" rid="pcbi.1006955.ref018">18</xref>]) suggesting considerable within-host-diversity for FMD virus.</p>
<fig id="pcbi.1006955.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006955.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Residuals associated with the top tercile of marks <italic>ζ</italic><sup>(<italic>k</italic>)</sup>, in applying our diagnostic framework to a foot-and-mouth dataset.</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006955.g004" xlink:type="simple"/>
</fig>
<p>As our results (<xref ref-type="fig" rid="pcbi.1006955.g004">Fig 4</xref>) reveal considerable evidence against the s-d-s model <bold><italic>M</italic></bold><sub>0</sub>, suggesting that it may not take sufficient account of within-host diversity. it is natural to attempt to refine this ‘inadequate’ model and to fit the more general model <bold><italic>M</italic></bold><sub><italic>p</italic></sub>. There is much weaker evidence against the model when <bold><italic>M</italic></bold><sub><italic>p</italic></sub> is fitted to the FMD outbreak using the pseudo-likelihood approach and latent residuals are imputed to yield a distribution of p-values. In particular we obtain <inline-formula id="pcbi.1006955.e066"><alternatives><graphic id="pcbi.1006955.e066g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e066" xlink:type="simple"/><mml:math display="inline" id="M66"><mml:mrow><mml:mi>π</mml:mi> <mml:mo>(</mml:mo> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>&lt;</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>05</mml:mn> <mml:mo>|</mml:mo> <mml:mi mathvariant="bold-italic">y</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> = 43% and <inline-formula id="pcbi.1006955.e067"><alternatives><graphic id="pcbi.1006955.e067g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e067" xlink:type="simple"/><mml:math display="inline" id="M67"><mml:mrow><mml:mi>π</mml:mi> <mml:mo>(</mml:mo> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>&lt;</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>01</mml:mn> <mml:mo>|</mml:mo> <mml:mi mathvariant="bold-italic">y</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> = 14%, which are considerably less than the 100% obtained by applying both metrics on the full set of residuals <inline-formula id="pcbi.1006955.e068"><alternatives><graphic id="pcbi.1006955.e068g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e068" xlink:type="simple"/><mml:math display="inline" id="M68"><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> in fitting the s-d-s model <bold><italic>M</italic></bold><sub>0</sub>. This result reinforces the conclusion that the s-d-s assumption may be one root of model mis-specification (<xref ref-type="fig" rid="pcbi.1006955.g004">Fig 4(b)</xref>), and suggests that including within-host diversity may serve to increase model adequacy. <xref ref-type="fig" rid="pcbi.1006955.g005">Fig 5</xref> shows that the effective genetic time <italic>T</italic>(<italic>G</italic><sub><italic>A</italic></sub>, <italic>G</italic><sub><italic>B</italic></sub>) may be considerably larger than the ‘absolute’ genetic time <italic>t</italic><sub><italic>B</italic></sub> − <italic>t</italic><sub><italic>A</italic></sub> used in the s-d-s model, given our estimated <inline-formula id="pcbi.1006955.e069"><alternatives><graphic id="pcbi.1006955.e069g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e069" xlink:type="simple"/><mml:math display="inline" id="M69"><mml:mrow><mml:msup><mml:mi>T</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>G</mml:mi> <mml:mi>A</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>G</mml:mi> <mml:mi>B</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∼</mml:mo> <mml:mtext>Beta</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>γ</mml:mi> <mml:mo>,</mml:mo> <mml:mi>η</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> (see also <xref ref-type="disp-formula" rid="pcbi.1006955.e043">Eq 10</xref>). It is worth noting that in using the pseudo-likelihood framework to fit <bold><italic>M</italic></bold><sub><italic>p</italic></sub> we obtained a smaller mean mutation rate 4.32 × 10<sup>−5</sup>, when compared to the case of fitting the s-d-s model in which we had an overall mean mutation rate (including transition and transversion) 6.41 × 10<sup>−5</sup>. Our results suggest that observed amount of mutations in FMD may be better explained by a combination of a smaller mutation rate and a longer effective genetic time that takes into account the within-host diversity, as opposed to a larger mutation rate with a shorter absolute genetic time as implied by the s-d-s model.</p>
<fig id="pcbi.1006955.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006955.g005</object-id>
<label>Fig 5</label>
<caption><title>Logarithm of the ratio between inferred effective genetic time <italic>t</italic><sub><italic>eff</italic></sub> = <italic>T</italic>(<italic>G</italic><sub><italic>A</italic></sub>, <italic>G</italic><sub><italic>B</italic></sub>) and the ‘absolute’ genetic time <italic>t</italic><sub><italic>abs</italic></sub> = <italic>t</italic><sub><italic>B</italic></sub> − <italic>t</italic><sub><italic>A</italic></sub> used in the s-d-s model.</title> <p>Consider an individual who becomes infected at time <italic>t</italic><sub>0</sub> = 0 and causes two infections at times <italic>t</italic><sub><italic>A</italic></sub> and <italic>t</italic><sub><italic>B</italic></sub> where <italic>t</italic><sub><italic>A</italic></sub> &lt; <italic>t</italic><sub><italic>B</italic></sub> are generated as the first two event times in a Poisson process. Then we have <italic>t</italic><sub><italic>eff</italic></sub>/<italic>t</italic><sub><italic>abs</italic></sub> = 1 + 2 × <italic>T</italic>*(<italic>G</italic><sub><italic>A</italic></sub>, <italic>G</italic><sub><italic>B</italic></sub>) × <italic>Z</italic> (see also <xref ref-type="disp-formula" rid="pcbi.1006955.e043">Eq 10</xref>) where <italic>Z</italic> = <italic>u</italic>/(1 − <italic>u</italic>) with <italic>u</italic> ∼ <italic>Unif</italic>(0, 1). For each simulated <italic>Z</italic>, we draw a corresponding <italic>T</italic>*(<italic>G</italic><sub><italic>A</italic></sub>, <italic>G</italic><sub><italic>B</italic></sub>) from <inline-formula id="pcbi.1006955.e070"><alternatives><graphic id="pcbi.1006955.e070g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e070" xlink:type="simple"/><mml:math display="inline" id="M70"><mml:mrow><mml:mtext>Beta</mml:mtext> <mml:mo>(</mml:mo> <mml:mi>γ</mml:mi> <mml:mo>,</mml:mo> <mml:mi>η</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> (see <xref ref-type="disp-formula" rid="pcbi.1006955.e043">Eq 10</xref>) where <italic>γ</italic> and <italic>η</italic> are taken to be their respective posterior means.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006955.g005" xlink:type="simple"/></fig>
<p>An important question is that of whether inferred parameters of the epidemic model, or imputed events in a partially observed epidemic, are sensitive to mis-specification of the genetic model. Therefore in the SI we compare the posterior distributions of epidemic parameters and of imputed infection graphs respectively using the s-d-s assumptions and the pseudo-likelihood framework that takes into account within-host diversity. We note that while estimated values of most key epidemiological parameters appear to be very similar over the two analyses (see <italic>S</italic>I: <xref ref-type="supplementary-material" rid="pcbi.1006955.s004">S3 Fig</xref>) the posterior distribution of <italic>β</italic>, the secondary transmission rate, places considerably more weight on higher values in the case of the pseudo-likelihood analysis, pointing to the potential for the s-d-s assumptions to lead to underestimation of this parameter should they be inappropriate. Comparison of the <italic>a posteriori</italic> most probable transmission trees under the two approaches (see <italic>S</italic>I: <xref ref-type="supplementary-material" rid="pcbi.1006955.s005">S4 Fig</xref>) suggests that while the trees share many similarities, they differ in their inferences regarding the relative importance of sites A and K as infectors in the epidemic. Under s-d-s assumptions A and K are the sources 2 and 5 infections respectively in the modal infection graph. With the pseudo-likelihood framework these values become 5 and 1 respectively.</p>
</sec>
</sec>
</sec>
<sec id="sec017" sec-type="conclusions">
<title>Discussion</title>
<p>Major statistical advances for integrating epidemiological and genomic data have been stimulated and accomplished in recent years, in the midst of ever-increasingly available genomic data (e.g., [<xref ref-type="bibr" rid="pcbi.1006955.ref003">3</xref>–<xref ref-type="bibr" rid="pcbi.1006955.ref013">13</xref>]). Given the (increasing) complexity and variety of phylodynamic models, it is crucial to develop model diagnostic methods that may systematically detect specified deviations from particular model assumptions. Such tools would greatly facilitate model criticism, calibration and refinement. While conventional model testing and model selection techniques such as Bayes factors and Deviance Information Criterion (DIC) can be very useful for comparing competing models, they do not offer an interpretable framework that can be used for fine component-wise model diagnostics and refinement [<xref ref-type="bibr" rid="pcbi.1006955.ref022">22</xref>, <xref ref-type="bibr" rid="pcbi.1006955.ref024">24</xref>, <xref ref-type="bibr" rid="pcbi.1006955.ref038">38</xref>]. Moreover, in contrast to the latent-residual approach [<xref ref-type="bibr" rid="pcbi.1006955.ref022">22</xref>], they may be less sensitive in the context of spatio-temporal dynamic modelling of infectious disease [<xref ref-type="bibr" rid="pcbi.1006955.ref025">25</xref>].</p>
<p>In this paper we have proposed a novel model diagnostic framework that extends the notions of functional models and latent residuals [<xref ref-type="bibr" rid="pcbi.1006955.ref022">22</xref>, <xref ref-type="bibr" rid="pcbi.1006955.ref023">23</xref>] to phylodynamic processes. Our framework can be easily embedded within any Bayesian analysis of a spatio-temporal phylodynamic system that makes use of data-augmentation. Overall evidence against model assumptions is evaluated by assessing sets of latent residuals sampled from the posterior distribution for consistency with the assumed sampling properties of the residuals. We also particularly show that how a marked latent-residual process can be tailored to reveal the nature of mis-specification of the molecular evolution process specified in a phylodynamic model. Using simulated datasets, we exemplify our approach by showing how the marked latent residuals can be used to reveal and quantify the under-estimation of the importance of within-host-diversity in a fitted phylodynamic model. Furthermore, we show that the tailored marked latent residual testing can be particularly powerful in the event of superspreading. Our framework is then applied to a local FMD outbreak in UK, the results suggesting that the importance of within-host-diversity may be considerably under-estimated by the s-d-s models [<xref ref-type="bibr" rid="pcbi.1006955.ref018">18</xref>]. Finally, we demonstrate that our diagnostic framework could facilitate effective model calibration. Specifically, we propose a pseudo-likelihood framework which allows for a higher degree of within-host-diversity, significantly improving the model adequacy as assessed using the latent-residual approach.</p>
<p>We have considered testing schemes utilising respectively the full set of residuals <inline-formula id="pcbi.1006955.e071"><alternatives><graphic id="pcbi.1006955.e071g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e071" xlink:type="simple"/><mml:math display="inline" id="M71"><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> and those associated with non-zero marks <inline-formula id="pcbi.1006955.e072"><alternatives><graphic id="pcbi.1006955.e072g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e072" xlink:type="simple"/><mml:math display="inline" id="M72"><mml:msup><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:mrow> <mml:mo>*</mml:mo></mml:msup></mml:math></alternatives></inline-formula>. The results suggest differences in the strength of evidence against the assumed model provided by these two approaches but that one is not invariably superior to the other. The procedure presented can only be valid if the rule for selecting residuals is specified <italic>a priori</italic>; post-hoc selection of a maximally informative subset is clearly not acceptable. This points to an interesting ‘virtual’ design problem of determining the rule for selecting residuals, based on the Bayesian’s assumed model and parameter prior and a specific sampling distribution for the observations under the suspected mis-specified model, in order to maximise the expectation of some measure of evidence against <italic>M</italic><sub>0</sub>.</p>
<p>We have exemplified our diagnostic framework by using it to test the appropriateness of the s-d-s assumption. Such a framework is broadly applicable to other phylodynamic systems (e.g., influenza and Ebola [<xref ref-type="bibr" rid="pcbi.1006955.ref020">20</xref>, <xref ref-type="bibr" rid="pcbi.1006955.ref021">21</xref>]) where quantifying importance of within-host diversity in any given scenarios is crucial. In principle, the framework could be extended to test other model assumptions by, for example, formulating different (epidemiological) marks <italic>ζ</italic><sup>(<italic>k</italic>)</sup> to associate with the residuals to reflect deviations from other assumptions for the evolutionary process. We claim no optimality of the pseudo-likelihood framework proposed for the FMD which utilises several simplifying assumptions of independence in the evolutionary process. Nevertheless, since our objective is to seek further evidence that the under-estimation of the importance of within-host-diversity is the source of model mis-specification (indicated by <xref ref-type="fig" rid="pcbi.1006955.g004">Fig 4</xref>) by showing improved fit of a model that represents diversity, we believe that its use may be justified.</p>
<p>The results of this paper complement earlier results [<xref ref-type="bibr" rid="pcbi.1006955.ref003">3</xref>] where bespoke, infection-link residuals were used to detect mis-specification of the spatial kernel in model <bold><italic>M</italic></bold><sub>0</sub> in the setting where both epidemic and genetic information were available. In a simulation study, detailed in the SI of reference [<xref ref-type="bibr" rid="pcbi.1006955.ref003">3</xref>] (Table S7 therein), it is shown that the evidence against a model with mis-specified kernel provided by the infection-link residuals, appears to be enhanced when genetic information is combined with the epidemic data. Our results here demonstrate the feasibility of using alternatively formulated residuals to detect a different form of mis-specification, specifically the genetic component in model <bold><italic>M</italic></bold><sub>0</sub>, providing support for the broad applicability of the general approach. The marked latent residual approach should also be easily scaleable for larger epidemics as the number of residuals only increases linearly with of transmission and sequence sampling events.</p>
</sec>
<sec id="sec018">
<title>Supporting information</title>
<supplementary-material id="pcbi.1006955.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006955.s001" xlink:type="simple">
<label>S1 Text</label>
<caption>
<title>Supplementary information.</title>
<p>(1) Bayesian data-augmentation and model inference of S-D-S Model <bold><italic>M</italic></bold><sub>0</sub>. (2) Refining S-D-S model <bold><italic>M</italic></bold><sub>0</sub>.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006955.s002" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006955.s002" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Distributions of subsets of marked latent residuals that lead to p-value less than 0.05.</title>
<p>(a)-(e) correspond to simulation set 1-5. Each set of the imputed residuals <inline-formula id="pcbi.1006955.e073"><alternatives><graphic id="pcbi.1006955.e073g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006955.e073" xlink:type="simple"/><mml:math display="inline" id="M73"><mml:mover accent="true"><mml:msup><mml:mi>r</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> are first ordered according to the mark <italic>ζ</italic><sup>(<italic>k</italic>)</sup>. The ordered residuals are then subdivided into three equal-size samples − 1<sup><italic>st</italic></sup>, 2<sup><italic>nd</italic></sup> and 3<sup><italic>rd</italic></sup> one-third. Residuals associated with smaller <italic>ζ</italic><sup>(<italic>k</italic>)</sup> (1<sup><italic>st</italic></sup> ans 2<sup><italic>nd</italic></sup>) exhibit a multiplicity of patterns, as opposed to the 3<sup><italic>rd</italic></sup> one-third where deviation is consistently observed at the right-tail of the unit interval (0, 1) (see also main text).</p>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006955.s003" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006955.s003" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Posterior distributions of key model parameters when fitting the correct model <italic>M</italic><sub>0</sub> to the simulated dataset.</title>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006955.s004" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006955.s004" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Posterior distributions of key epidemiological model parameters when fitting respectively the s-d-s model and the pseudo-likelihood model that takes into account within-host diversity to the FMD dataset.</title>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006955.s005" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006955.s005" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>Estimated most probable transmission trees when fitting respectively the s-d-s model and the pseudo-likelihood model that takes into account within-host diversity to the FMD dataset.</title>
<p>(a) Obtained from fitting the s-d-s model; (b) Obtained from fitting the pseudo-likelihood model.</p>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006955.s006" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006955.s006" xlink:type="simple">
<label>S1 Table</label>
<caption>
<title>Prior distributions for model parameters.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="pcbi.1006955.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Grenfell</surname> <given-names>BT</given-names></name>, <name name-style="western"><surname>Pybus</surname> <given-names>OG</given-names></name>, <name name-style="western"><surname>Gog</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>Wood</surname> <given-names>JL</given-names></name>, <name name-style="western"><surname>Daly</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Mumford</surname> <given-names>JA</given-names></name>, <etal>et al</etal>. <article-title>Unifying the epidemiological and evolutionary dynamics of pathogens</article-title>. <source>Science</source>. <year>2004</year>;<volume>303</volume>(<issue>5656</issue>):<fpage>327</fpage>–<lpage>332</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.1090727" xlink:type="simple">10.1126/science.1090727</ext-link></comment> <object-id pub-id-type="pmid">14726583</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006955.ref002">
<label>2</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Pybus</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Fraser</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Rambaut</surname> <given-names>A</given-names></name>. <source>Evolutionary epidemiology: preparing for an age of genomic plenty</source>. <publisher-name>The Royal Society</publisher-name>; <year>2013</year>.</mixed-citation>
</ref>
<ref id="pcbi.1006955.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lau</surname> <given-names>MS</given-names></name>, <name name-style="western"><surname>Marion</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Streftaris</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Gibson</surname> <given-names>G</given-names></name>. <article-title>A systematic Bayesian integration of epidemiological and genetic data</article-title>. <source>PLoS computational biology</source>. <year>2015</year>;<volume>11</volume>(<issue>11</issue>):<fpage>e1004633</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1004633" xlink:type="simple">10.1371/journal.pcbi.1004633</ext-link></comment> <object-id pub-id-type="pmid">26599399</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006955.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Worby</surname> <given-names>CJ</given-names></name>, <name name-style="western"><surname>O’Neill</surname> <given-names>PD</given-names></name>, <name name-style="western"><surname>Kypraios</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Robotham</surname> <given-names>JV</given-names></name>, <name name-style="western"><surname>De Angelis</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Cartwright</surname> <given-names>EJ</given-names></name>, <etal>et al</etal>. <article-title>Reconstructing transmission trees for communicable diseases using densely sampled genetic data</article-title>. <source>The annals of applied statistics</source>. <year>2016</year>;<volume>10</volume>(<issue>1</issue>):<fpage>395</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1214/15-AOAS898" xlink:type="simple">10.1214/15-AOAS898</ext-link></comment> <object-id pub-id-type="pmid">27042253</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006955.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Morelli</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Thébaud</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Chadœuf</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>King</surname> <given-names>DP</given-names></name>, <name name-style="western"><surname>Haydon</surname> <given-names>DT</given-names></name>, <name name-style="western"><surname>Samule</surname> <given-names>S</given-names></name>. <article-title>A Bayesian inference framework to reconstruct transmission trees using epidemiological and genetic data</article-title>. <source>PLoS Computational Biology</source>. <year>2012</year>;<volume>8</volume>:<fpage>e1002768</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1002768" xlink:type="simple">10.1371/journal.pcbi.1002768</ext-link></comment> <object-id pub-id-type="pmid">23166481</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006955.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kenah</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Britton</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Halloran</surname> <given-names>ME</given-names></name>, <name name-style="western"><surname>Longini</surname> <given-names>IM</given-names> <suffix>Jr</suffix></name>. <article-title>Molecular infectious disease epidemiology: survival analysis and algorithms linking phylogenies to transmission trees</article-title>. <source>PLoS computational biology</source>. <year>2016</year>;<volume>12</volume>(<issue>4</issue>):<fpage>e1004869</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1004869" xlink:type="simple">10.1371/journal.pcbi.1004869</ext-link></comment> <object-id pub-id-type="pmid">27070316</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006955.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mollentze</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Nel</surname> <given-names>LH</given-names></name>, <name name-style="western"><surname>Townsend</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Le Roux</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Hampson</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Haydon</surname> <given-names>DT</given-names></name>, <etal>et al</etal>. <article-title>A Bayesian approach for inferring the dynamics of partially observed endemic infectious diseases from space-time-genetic data</article-title>. <source>Proceedings of the Royal Society B: Biological Sciences</source>. <year>2014</year>;<volume>281</volume>(<issue>1782</issue>):<fpage>20133251</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1098/rspb.2013.3251" xlink:type="simple">10.1098/rspb.2013.3251</ext-link></comment> <object-id pub-id-type="pmid">24619442</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006955.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ypma</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Bataille</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Stegeman</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Koch</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Wallinga</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Van Ballegooijen</surname> <given-names>W</given-names></name>. <article-title>Unravelling transmission trees of infectious diseases by combining genetic and epidemiological data</article-title>. <source>Proceedings of the Royal Society B: Biological Sciences</source>. <year>2012</year>;<volume>279</volume>(<issue>1728</issue>):<fpage>444</fpage>–<lpage>450</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1098/rspb.2011.0913" xlink:type="simple">10.1098/rspb.2011.0913</ext-link></comment> <object-id pub-id-type="pmid">21733899</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006955.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Jombart</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Didelot</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Cauchemez</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Viboud</surname> <given-names>FC</given-names></name>, <name name-style="western"><surname>Ferguson</surname> <given-names>N</given-names></name>. <article-title>Bayesian reconstruction of disease outbreaks by combining epidemiologic and genomic data</article-title>. <source>PLoS Computational Biology</source>. <year>2014</year>;<volume>10</volume>(<issue>1</issue>):<fpage>e1003457</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1003457" xlink:type="simple">10.1371/journal.pcbi.1003457</ext-link></comment> <object-id pub-id-type="pmid">24465202</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006955.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kendall</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Ayabina</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Xu</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Stimson</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Coljin</surname> <given-names>C</given-names></name>. <article-title>Estimating transmission from genetic and epidemiological data: a metric to compare transmission trees</article-title>. <source>Statistical Science</source>. <year>2017</year>;.</mixed-citation>
</ref>
<ref id="pcbi.1006955.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Didelot</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Fraser</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Gardy</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Colijn</surname> <given-names>C</given-names></name>. <article-title>Genomic infectious disease epidemiology in partially sampled and ongoing outbreaks</article-title>. <source>Molecular biology and evolution</source>. <year>2017</year>;<volume>34</volume>(<issue>4</issue>):<fpage>997</fpage>–<lpage>1007</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/molbev/msw275" xlink:type="simple">10.1093/molbev/msw275</ext-link></comment> <object-id pub-id-type="pmid">28100788</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006955.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>De Maio</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Wu</surname> <given-names>CH</given-names></name>, <name name-style="western"><surname>Wilson</surname> <given-names>DJ</given-names></name>. <article-title>SCOTTI: efficient reconstruction of transmission within outbreaks with the structured coalescent</article-title>. <source>PLoS computational biology</source>. <year>2016</year>;<volume>12</volume>(<issue>9</issue>):<fpage>e1005130</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1005130" xlink:type="simple">10.1371/journal.pcbi.1005130</ext-link></comment> <object-id pub-id-type="pmid">27681228</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006955.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cottam</surname> <given-names>EM</given-names></name>, <name name-style="western"><surname>Thébaud</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Wadsworth</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Gloster</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Mansley</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Paton</surname> <given-names>DJ</given-names></name>, <etal>et al</etal>. <article-title>Integrating genetic and epidemiological data to determine transmission pathways of foot-and-mouth disease virus</article-title>. <source>Proceedings of the Royal Society B: Biological Sciences</source>. <year>2008</year>;<volume>275</volume>(<issue>1637</issue>):<fpage>887</fpage>–<lpage>895</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1098/rspb.2007.1442" xlink:type="simple">10.1098/rspb.2007.1442</ext-link></comment> <object-id pub-id-type="pmid">18230598</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006955.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Numminen</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Chewapreecha</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Sirén</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Turner</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Turner</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Bentley</surname> <given-names>SD</given-names></name>, <etal>et al</etal>. <article-title>Two-phase importance sampling for inference about transmission trees</article-title>. <source>Proceedings of the Royal Society of London B: Biological Sciences</source>. <year>2014</year>;<volume>281</volume>(<issue>1794</issue>):<fpage>20141324</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1098/rspb.2014.1324" xlink:type="simple">10.1098/rspb.2014.1324</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006955.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Soubeyrand</surname> <given-names>S</given-names></name>. <article-title>Construction of semi-Markov genetic-space-time SEIR models and inference</article-title>. <source>Journal de la Société Française de Statistique</source>. <year>2016</year>;<volume>157</volume>(<issue>1</issue>):<fpage>129</fpage>–<lpage>152</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006955.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Stadler</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Bonhoeffer</surname> <given-names>S</given-names></name>. <article-title>Uncovering epidemiological dynamics in heterogeneous host populations using phylogenetic methods</article-title>. <source>Philosophical Transactions of the Royal Society B: Biological Sciences</source>. <year>2013</year>;<volume>368</volume>(<issue>1614</issue>):<fpage>20120198</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1098/rstb.2012.0198" xlink:type="simple">10.1098/rstb.2012.0198</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006955.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Worby</surname> <given-names>CJ</given-names></name>, <name name-style="western"><surname>Lipsitch</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Hanage</surname> <given-names>WP</given-names></name>. <article-title>Shared Genomic Variants: Identification of Transmission Routes Using Pathogen Deep-Sequence Data</article-title>. <source>American journal of epidemiology</source>. <year>2017</year>;<volume>186</volume>(<issue>10</issue>):<fpage>1209</fpage>–<lpage>1216</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/aje/kwx182" xlink:type="simple">10.1093/aje/kwx182</ext-link></comment> <object-id pub-id-type="pmid">29149252</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006955.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>King</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>Freimanis</surname> <given-names>GL</given-names></name>, <name name-style="western"><surname>Orton</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Waters</surname> <given-names>RA</given-names></name>, <name name-style="western"><surname>Haydon</surname> <given-names>DT</given-names></name>, <name name-style="western"><surname>King</surname> <given-names>DP</given-names></name>. <article-title>Investigating intra-host and intra-herd sequence diversity of foot-and-mouth disease virus</article-title>. <source>Infection, Genetics and Evolution</source>. <year>2016</year>;<volume>44</volume>:<fpage>286</fpage>–<lpage>292</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.meegid.2016.07.010" xlink:type="simple">10.1016/j.meegid.2016.07.010</ext-link></comment> <object-id pub-id-type="pmid">27421209</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006955.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Alizon</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Fraser</surname> <given-names>C</given-names></name>. <article-title>Within-host and between-host evolutionary rates across the HIV-1 genome</article-title>. <source>Retrovirology</source>. <year>2013</year>;<volume>10</volume>(<issue>1</issue>):<fpage>49</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/1742-4690-10-49" xlink:type="simple">10.1186/1742-4690-10-49</ext-link></comment> <object-id pub-id-type="pmid">23639104</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006955.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Park</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>Dudas</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Wohl</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Goba</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Whitmer</surname> <given-names>SL</given-names></name>, <name name-style="western"><surname>Andersen</surname> <given-names>KG</given-names></name>, <etal>et al</etal>. <article-title>Ebola virus epidemiology, transmission, and evolution during seven months in Sierra Leone</article-title>. <source>Cell</source>. <year>2015</year>;<volume>161</volume>(<issue>7</issue>):<fpage>1516</fpage>–<lpage>1526</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cell.2015.06.007" xlink:type="simple">10.1016/j.cell.2015.06.007</ext-link></comment> <object-id pub-id-type="pmid">26091036</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006955.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Murcia</surname> <given-names>PR</given-names></name>, <name name-style="western"><surname>Hughes</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Battista</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Lloyd</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Baillie</surname> <given-names>GJ</given-names></name>, <name name-style="western"><surname>Ramirez-Gonzalez</surname> <given-names>RH</given-names></name>, <etal>et al</etal>. <article-title>Evolution of an Eurasian avian-like influenza virus in naive and vaccinated pigs</article-title>. <source>PLoS Pathogens</source>. <year>2012</year>;<volume>8</volume>(<issue>5</issue>):<fpage>e1002730</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.ppat.1002730" xlink:type="simple">10.1371/journal.ppat.1002730</ext-link></comment> <object-id pub-id-type="pmid">22693449</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006955.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lau</surname> <given-names>MSY</given-names></name>, <name name-style="western"><surname>Marion</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Streftaris</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Gibson</surname> <given-names>GJ</given-names></name>. <article-title>New model diagnostics for spatio-temporal systems in epidemiology and ecology</article-title>. <source>J R Soc Interface</source>. <year>2014</year>;<volume>11</volume>:<fpage>20131093</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1098/rsif.2013.1093" xlink:type="simple">10.1098/rsif.2013.1093</ext-link></comment> <object-id pub-id-type="pmid">24522782</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006955.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gibson</surname> <given-names>GJ</given-names></name>, <name name-style="western"><surname>Otten</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Filipe</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Cook</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Marion</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Gilligan</surname> <given-names>CA</given-names></name>. <article-title>Bayesian estimation for percolation models of disease spread in plant populations</article-title>. <source>Statistics and Computing</source>. <year>2006</year>;<volume>16</volume>(<issue>4</issue>):<fpage>391</fpage>–<lpage>402</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s11222-006-0019-z" xlink:type="simple">10.1007/s11222-006-0019-z</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006955.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Spiegelhalter</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>Best</surname> <given-names>NG</given-names></name>, <name name-style="western"><surname>Carlin</surname> <given-names>BP</given-names></name>, <name name-style="western"><surname>Van Der Linde</surname> <given-names>A</given-names></name>. <article-title>Bayesian measures of model complexity and fit</article-title>. <source>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</source>. <year>2002</year>;<volume>64</volume>(<issue>4</issue>):<fpage>583</fpage>–<lpage>639</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/1467-9868.00353" xlink:type="simple">10.1111/1467-9868.00353</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006955.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gamado</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Marion</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Porphyre</surname> <given-names>T</given-names></name>. <article-title>Data-Driven risk assessment from small scale epidemics: estimation and Model choice for spatio-Temporal Data with application to a classical swine Fever Outbreak</article-title>. <source>Frontiers in Veterinary Science</source>. <year>2017</year>;<volume>4</volume>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3389/fvets.2017.00016" xlink:type="simple">10.3389/fvets.2017.00016</ext-link></comment> <object-id pub-id-type="pmid">28293559</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006955.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lau</surname> <given-names>MS</given-names></name>, <name name-style="western"><surname>Dalziel</surname> <given-names>BD</given-names></name>, <name name-style="western"><surname>Funk</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>McClelland</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Tiffany</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Riley</surname> <given-names>S</given-names></name>, <etal>et al</etal>. <article-title>Spatial and temporal dynamics of superspreading events in the 2014–2015 West Africa Ebola epidemic</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2017</year>;<volume>114</volume>(<issue>9</issue>):<fpage>2337</fpage>–<lpage>2342</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1614595114" xlink:type="simple">10.1073/pnas.1614595114</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006955.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Parry</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Gibson</surname> <given-names>GJ</given-names></name>, <name name-style="western"><surname>Parnell</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Gottwald</surname> <given-names>TR</given-names></name>, <name name-style="western"><surname>Irey</surname> <given-names>MS</given-names></name>, <name name-style="western"><surname>Gast</surname> <given-names>TC</given-names></name>, <etal>et al</etal>. <article-title>Bayesian inference for an emerging arboreal epidemic in the presence of control</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2014</year>;<volume>111</volume>(<issue>17</issue>):<fpage>6258</fpage>–<lpage>6262</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1310997111" xlink:type="simple">10.1073/pnas.1310997111</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006955.ref028">
<label>28</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Yang</surname> <given-names>Z</given-names></name>. <source>Computational molecular evolution</source>. <volume>vol. 284</volume>. <publisher-loc>Oxford</publisher-loc>: <publisher-name>Oxford University Press</publisher-name>; <year>2006</year>.</mixed-citation>
</ref>
<ref id="pcbi.1006955.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Worby</surname> <given-names>CJ</given-names></name>, <name name-style="western"><surname>Lipsitch</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Hanage</surname> <given-names>WP</given-names></name>. <article-title>Within-host bacterial diversity hinders accurate reconstruction of transmission networks from genomic distance data</article-title>. <source>PLoS computational biology</source>. <year>2014</year>;<volume>10</volume>(<issue>3</issue>):<fpage>e1003549</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1003549" xlink:type="simple">10.1371/journal.pcbi.1003549</ext-link></comment> <object-id pub-id-type="pmid">24675511</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006955.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Worby</surname> <given-names>CJ</given-names></name>, <name name-style="western"><surname>Chang</surname> <given-names>HH</given-names></name>, <name name-style="western"><surname>Hanage</surname> <given-names>WP</given-names></name>, <name name-style="western"><surname>Lipsitch</surname> <given-names>M</given-names></name>. <article-title>The distribution of pairwise genetic distances: a tool for investigating disease transmission</article-title>. <source>Genetics</source>. <year>2014</year>;<volume>198</volume>(<issue>4</issue>):<fpage>1395</fpage>–<lpage>1404</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1534/genetics.114.171538" xlink:type="simple">10.1534/genetics.114.171538</ext-link></comment> <object-id pub-id-type="pmid">25313129</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006955.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dawid</surname> <given-names>AP</given-names></name>, <name name-style="western"><surname>Stone</surname> <given-names>M</given-names></name>. <article-title>The functional-model basis of fiducial inference</article-title>. <source>The Annals of Statistics</source>. <year>1982</year>;p. <fpage>1054</fpage>–<lpage>1067</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1214/aos/1176345970" xlink:type="simple">10.1214/aos/1176345970</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006955.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cox</surname> <given-names>DR</given-names></name>, <name name-style="western"><surname>Snell</surname> <given-names>EJ</given-names></name>. <article-title>A general definition of residuals</article-title>. <source>Journal of the Royal Statistical Society Series B (Methodological)</source>. <year>1968</year>;p. <fpage>248</fpage>–<lpage>275</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/j.2517-6161.1968.tb00724.x" xlink:type="simple">10.1111/j.2517-6161.1968.tb00724.x</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006955.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lewis</surname> <given-names>PA</given-names></name>. <article-title>Distribution of the Anderson-Darling statistic</article-title>. <source>The Annals of Mathematical Statistics</source>. <year>1961</year>;p. <fpage>1118</fpage>–<lpage>1124</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1214/aoms/1177704850" xlink:type="simple">10.1214/aoms/1177704850</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006955.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gibson</surname> <given-names>GJ</given-names></name>, <name name-style="western"><surname>Streftaris</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Thong</surname> <given-names>D</given-names></name>, <etal>et al</etal>. <article-title>Comparison and Assessment of Epidemic Models</article-title>. <source>Statistical Science</source>. <year>2018</year>;<volume>33</volume>(<issue>1</issue>):<fpage>19</fpage>–<lpage>33</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1214/17-STS615" xlink:type="simple">10.1214/17-STS615</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006955.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Meng</surname> <given-names>X-L</given-names></name>. <article-title>Posterior predictive p-values</article-title>, <source>Ann. Stat</source>. <year>1994</year>;<volume>22</volume>: <fpage>1142</fpage>–<lpage>1160</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1214/aos/1176325622" xlink:type="simple">10.1214/aos/1176325622</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006955.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Duchene</surname> <given-names>DA</given-names></name>, <name name-style="western"><surname>Bragg</surname> <given-names>JG</given-names></name>, <name name-style="western"><surname>Duchene</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Neaves</surname> <given-names>LE</given-names></name>, <name name-style="western"><surname>Potter</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Moritz</surname> <given-names>C</given-names></name>, <etal>et al</etal>. <article-title>Analysis of Phylogenomic trees space resolves relationships among marsupial families</article-title>, <source>Syst. Biol</source>. <year>2018</year>;<volume>67</volume>: <fpage>400</fpage>–<lpage>412</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/sysbio/syx076" xlink:type="simple">10.1093/sysbio/syx076</ext-link></comment> <object-id pub-id-type="pmid">29029231</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006955.ref037">
<label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lloyd-Smith</surname> <given-names>JO</given-names></name>, <name name-style="western"><surname>Schreiber</surname> <given-names>SJ</given-names></name>, <name name-style="western"><surname>Kopp</surname> <given-names>PE</given-names></name>, <name name-style="western"><surname>Getz</surname> <given-names>W</given-names></name>. <article-title>Superspreading and the effect of individual variation on disease emergence</article-title>. <source>Nature</source>. <year>2005</year>;<volume>438</volume>(<issue>7066</issue>):<fpage>355</fpage>–<lpage>359</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature04153" xlink:type="simple">10.1038/nature04153</ext-link></comment> <object-id pub-id-type="pmid">16292310</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006955.ref038">
<label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kass</surname> <given-names>RE</given-names></name>, <name name-style="western"><surname>Raftery</surname> <given-names>AE</given-names></name>. <article-title>Bayes factors</article-title>. <source>Journal of the American Statistical Association</source>. <year>1995</year>;<volume>90</volume>(<issue>430</issue>):<fpage>773</fpage>–<lpage>795</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1080/01621459.1995.10476572" xlink:type="simple">10.1080/01621459.1995.10476572</ext-link></comment></mixed-citation>
</ref>
</ref-list>
</back>
</article>