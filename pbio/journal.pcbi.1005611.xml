<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-17-00085</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1005611</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Evolutionary biology</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Taxonomy</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Data management</subject><subj-group><subject>Taxonomy</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Evolutionary biology</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject><subj-group><subject>Phylogenetic analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Taxonomy</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject><subj-group><subject>Phylogenetic analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Data management</subject><subj-group><subject>Taxonomy</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject><subj-group><subject>Phylogenetic analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Optimization</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Evolutionary biology</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Microbiology</subject><subj-group><subject>Microbial evolution</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Evolutionary biology</subject><subj-group><subject>Organismal evolution</subject><subj-group><subject>Microbial evolution</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Evolutionary biology</subject><subj-group><subject>Evolutionary processes</subject><subj-group><subject>Horizontal gene transfer</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Gene transfer</subject><subj-group><subject>Horizontal gene transfer</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Evolutionary biology</subject><subj-group><subject>Evolutionary genetics</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Network analysis</subject></subj-group></subj-group></article-categories>
<title-group>
<article-title>Rearrangement moves on rooted phylogenetic networks</article-title>
<alt-title alt-title-type="running-head">Rearrangement moves on phylogenetic networks</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Gambette</surname> <given-names>Philippe</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>van Iersel</surname> <given-names>Leo</given-names></name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Jones</surname> <given-names>Mark</given-names></name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-5305-7372</contrib-id>
<name name-style="western">
<surname>Lafond</surname> <given-names>Manuel</given-names></name>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-8084-1464</contrib-id>
<name name-style="western">
<surname>Pardi</surname> <given-names>Fabio</given-names></name>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
<xref ref-type="aff" rid="aff005"><sup>5</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Scornavacca</surname> <given-names>Celine</given-names></name>
<xref ref-type="aff" rid="aff005"><sup>5</sup></xref>
<xref ref-type="aff" rid="aff006"><sup>6</sup></xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Laboratoire d’Informatique Gaspard-Monge (LIGM), Université Paris-Est, CNRS, ENPC, ESIEE Paris, UPEM, F-77454, Marne-la-Vallée, France</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Delft Institute of Applied Mathematics, Delft University of Technology, Postbus 5031, 2628 CD Delft, The Netherlands</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>Department of Mathematics and Statistics, University of Ottawa, K1N 6N5 Ottawa, Canada</addr-line>
</aff>
<aff id="aff004">
<label>4</label>
<addr-line>Laboratoire d’Informatique, de Robotique et de Microélectronique de Montpellier (LIRMM), Université de Montpellier, CNRS, 34095 Montpellier Cedex 5, France</addr-line>
</aff>
<aff id="aff005">
<label>5</label>
<addr-line>Institut de Biologie Computationnelle (IBC), 34095 Montpellier, France</addr-line>
</aff>
<aff id="aff006">
<label>6</label>
<addr-line>Institut des Sciences de l’Evolution (ISE-M), Université de Montpellier, CNRS, IRD, EPHE, 34095 Montpellier Cedex 5, France</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Matsen</surname> <given-names>Frederick A</given-names> <suffix>IV</suffix></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Fred Hutchinson Cancer Research Center, UNITED STATES</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con">
<p>
<list list-type="simple">
<list-item>
<p><bold>Formal analysis:</bold> PG LvI MJ ML FP CS.</p>
</list-item>
<list-item>
<p><bold>Writing – original draft:</bold> PG LvI MJ ML FP CS.</p>
</list-item>
<list-item>
<p><bold>Writing – review &amp; editing:</bold> PG LvI MJ ML FP CS.</p>
</list-item>
</list>
</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">pardi@lirmm.fr</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>8</month>
<year>2017</year>
</pub-date>
<pub-date pub-type="epub">
<day>1</day>
<month>8</month>
<year>2017</year>
</pub-date>
<volume>13</volume>
<issue>8</issue>
<elocation-id>e1005611</elocation-id>
<history>
<date date-type="received">
<day>16</day>
<month>1</month>
<year>2017</year>
</date>
<date date-type="accepted">
<day>27</day>
<month>5</month>
<year>2017</year>
</date>
</history>
<permissions>
<copyright-year>2017</copyright-year>
<copyright-holder>Gambette et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1005611"/>
<abstract>
<p>Phylogenetic tree reconstruction is usually done by local search heuristics that explore the space of the possible tree topologies via simple rearrangements of their structure. Tree rearrangement heuristics have been used in combination with practically all optimization criteria in use, from maximum likelihood and parsimony to distance-based principles, and in a Bayesian context. Their basic components are rearrangement moves that specify all possible ways of generating alternative phylogenies from a given one, and whose fundamental property is to be able to transform, by repeated application, any phylogeny into any other phylogeny. Despite their long tradition in tree-based phylogenetics, very little research has gone into studying similar rearrangement operations for phylogenetic network—that is, phylogenies explicitly representing scenarios that include reticulate events such as hybridization, horizontal gene transfer, population admixture, and recombination. To fill this gap, we propose “horizontal” moves that ensure that every network of a certain complexity can be reached from any other network of the same complexity, and “vertical” moves that ensure reachability between networks of different complexities. When applied to phylogenetic trees, our horizontal moves—named rNNI and rSPR—reduce to the best-known moves on rooted phylogenetic trees, nearest-neighbor interchange and rooted subtree pruning and regrafting. Besides a number of reachability results—separating the contributions of horizontal and vertical moves—we prove that rNNI moves are local versions of rSPR moves, and provide bounds on the sizes of the rNNI neighborhoods. The paper focuses on the most biologically meaningful versions of phylogenetic networks, where edges are oriented and reticulation events clearly identified. Moreover, our rearrangement moves are robust to the fact that networks with higher complexity usually allow a better fit with the data. Our goal is to provide a solid basis for practical phylogenetic network reconstruction.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>Phylogenetic networks are used to represent reticulate evolution, that is, cases in which the tree-of-life metaphor for evolution breaks down, because some of its branches have merged at one or several points in the past. This may occur, for example, when some organisms in the phylogeny are hybrids. In this paper, we deal with an elementary question for the reconstruction of phylogenetic networks: how to explore the space of all possible networks. The fundamental component for this is the set of operations that should be employed to generate alternative hypotheses for what happened in the past—which serve as basic blocks for optimization techniques such as hill-climbing. Although these approaches have a long tradition in classic tree-based phylogenetics, their application to networks that explicitly represent reticulate evolution is relatively unexplored. This paper provides the fundamental definitions and theoretical results for subsequent work in practical methods for phylogenetic network reconstruction: we subdivide networks into layers, according to a generally-accepted measure of their complexity, and provide operations that allow both to fully explore each layer, and to move across different layers. These operations constitute natural generalizations of well-known operations for the exploration of the space of phylogenetic trees, the lowest layer in the hierarchy described above.</p>
</abstract>
<funding-group>
<funding-statement>This work was partially funded by the CNRS "Projet international de coopération scientifique (PICS)" grant No 230310 (CoCoAlSeq). LvI was partially supported by NWO, including Vidi grant 639.072.602, and partially by the 4TU Applied Mathematics Institute. MJ was supported by Vidi grant 639.072.602 from NWO. ML was supported by Natural Sciences and Engineering Research Council (NSERC), PDF grant. FP is a member of the VIROGENESIS project, which receives funding from the European Union’s Horizon 2020 research and innovation programme under grant agreement No. 634650. CS was supported by the French Agence Nationale de la Recherche Investissements d′Avenir/Bioinformatique (ANR-10-BINF-01-02, Ancestrome). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="9"/>
<table-count count="0"/>
<page-count count="21"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2017-08-15</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant data are within the paper and its Supporting Information files.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<disp-quote>
<p>This is a <italic>PLOS Computational Biology</italic> Methods paper.</p>
</disp-quote>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>A recent trend in evolutionary biology is the growing appreciation of reticulate evolution—which occurs when the history of a set of taxa (e.g., species, populations or genes) cannot be accurately represented as a phylogenetic tree [<xref ref-type="bibr" rid="pcbi.1005611.ref001">1</xref>, <xref ref-type="bibr" rid="pcbi.1005611.ref002">2</xref>], because of events causing inheritance from more than one ancestor. There is a wide variety of reticulate events in nature, for example: hybrid speciation [<xref ref-type="bibr" rid="pcbi.1005611.ref003">3</xref>–<xref ref-type="bibr" rid="pcbi.1005611.ref005">5</xref>], population admixture [<xref ref-type="bibr" rid="pcbi.1005611.ref006">6</xref>–<xref ref-type="bibr" rid="pcbi.1005611.ref008">8</xref>] horizontal gene transfer [<xref ref-type="bibr" rid="pcbi.1005611.ref009">9</xref>–<xref ref-type="bibr" rid="pcbi.1005611.ref011">11</xref>] and genomic recombination [<xref ref-type="bibr" rid="pcbi.1005611.ref012">12</xref>–<xref ref-type="bibr" rid="pcbi.1005611.ref014">14</xref>]. These phenomena are often of interest to different communities of researchers (e.g., in plant biology, population genetics, microbiology, epidemiology), meaning that different approaches and terminologies are in use in these fields.</p>
<p>However, the different approaches to studying reticulate evolution share the same ambition: to represent evolutionary history explicitly, with <italic>phylogenetic networks</italic>. These are simple generalizations of phylogenetic trees, where some nodes—named <italic>reticulations</italic>—are allowed to have multiple direct ancestors [<xref ref-type="bibr" rid="pcbi.1005611.ref015">15</xref>, <xref ref-type="bibr" rid="pcbi.1005611.ref016">16</xref>]. See <xref ref-type="fig" rid="pcbi.1005611.g001">Fig 1</xref> for two examples of phylogenetic networks, with 3 reticulations each, showing the putative relationships among modern humans and their closest relatives. Networks such as those in <xref ref-type="fig" rid="pcbi.1005611.g001">Fig 1</xref> are sometimes referred to as “explicit” to distinguish them from other, “data-display”, networks that are not used to represent any particular scenario, but rather to graphically display conflicting phylogenetic signals in the data [<xref ref-type="bibr" rid="pcbi.1005611.ref015">15</xref>, <xref ref-type="bibr" rid="pcbi.1005611.ref016">16</xref>]. (As an example of the latter, see the networks produced by the popular program Neighbor-net [<xref ref-type="bibr" rid="pcbi.1005611.ref017">17</xref>]). In this paper, we focus on the former type of networks, like those in <xref ref-type="fig" rid="pcbi.1005611.g001">Fig 1</xref>.</p>
<fig id="pcbi.1005611.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005611.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Phylogenetic network showing hypothetical evolutionary scenarios relating modern human populations and their closest relatives.</title>
<p>On the left, a slightly simplified version of an admixture graph from a recent publication on human diversity [<xref ref-type="bibr" rid="pcbi.1005611.ref008">8</xref>]. On the right, an alternative scenario obtained by applying one of the rearrangement moves that we define here (an rNNI), which essentially swaps the order of the two events immediately ancestral to the Denisovans. S.Afr.: Sub-Saharan Africans, W.Eur.: West Eurasians, E.Asi.: Eastern Asians, Aus.: Australasians, Nea.: Neanderthals, Den.: Denisovans.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005611.g001" xlink:type="simple"/>
</fig>
<p>Although methods to infer phylogenetic networks are by necessity context-dependent—e.g., gene tree vs. species tree comparisons to study horizontal gene transfers [<xref ref-type="bibr" rid="pcbi.1005611.ref018">18</xref>], analyses of gene tree frequencies to study inter-specific hybridizations [<xref ref-type="bibr" rid="pcbi.1005611.ref019">19</xref>, <xref ref-type="bibr" rid="pcbi.1005611.ref020">20</xref>], and analyses of SNP allele frequencies to study population admixture [<xref ref-type="bibr" rid="pcbi.1005611.ref006">6</xref>, <xref ref-type="bibr" rid="pcbi.1005611.ref007">7</xref>]—in this paper we examine a component that should be central to all network inference methods: the basic moves that an algorithm should use to explore alternative reticulate scenarios. Given a network such as the one on the left in <xref ref-type="fig" rid="pcbi.1005611.g001">Fig 1</xref>, these moves allow one to generate and evaluate many alternative hypotheses, such as the one on the right in <xref ref-type="fig" rid="pcbi.1005611.g001">Fig 1</xref>. If a network improving the fit with the data is encountered, then the search continues from that network, and is carried on until no more improvements are possible—that is, until a <italic>local optimum</italic> is reached.</p>
<p>These ideas are the natural transposition to phylogenetic networks of what is routinely done for phlogenetic trees, whose reconstruction relies heavily on local search heuristics that explore the space of the possible tree topologies by means of simple rearrangements of their structure. These heuristics have an impressively long tradition (they started appearing in the 1960s [<xref ref-type="bibr" rid="pcbi.1005611.ref021">21</xref>]) and they have been used in combination with practically all optimization criteria in use, from maximum parsimony and likelihood, to distance-based principles [<xref ref-type="bibr" rid="pcbi.1005611.ref022">22</xref>, <xref ref-type="bibr" rid="pcbi.1005611.ref023">23</xref>]. The best known tree rearrangements are <italic>nearest neighbor interchange</italic> (NNI) and <italic>subtree pruning and regrafting</italic> (SPR). Despite their long history in phylogenetics, the application of topological rearrangement moves within network reconstruction software is very recent (e.g., [<xref ref-type="bibr" rid="pcbi.1005611.ref024">24</xref>]) and the first mathematically-grounded reflections on how to define these moves to ensure desirable properties are even more recent [<xref ref-type="bibr" rid="pcbi.1005611.ref025">25</xref>, <xref ref-type="bibr" rid="pcbi.1005611.ref026">26</xref>].</p>
<p>In this context, one important difference between trees and networks is that networks can have varying levels of <italic>reticulate complexity</italic>. In the next section, we will see that this term can be formally defined in several equivalent ways—for example, as the number of reticulations in the network. Intuitively, it can be seen as the equivalent of the number of parameters in a statistical model, or as a measure of the explanatory power of the set of networks of that level of complexity: higher complexity—that is, being able to hypothesize more reticulate events—generally allows a better fit with the data [<xref ref-type="bibr" rid="pcbi.1005611.ref027">27</xref>]. Although alternative measures of network complexity exist (e.g., the <italic>level</italic> of a network, see also the <xref ref-type="sec" rid="sec008">Discussion</xref> section), the approach we adopt here is consistent with most approaches to measure model complexity in networks [<xref ref-type="bibr" rid="pcbi.1005611.ref028">28</xref>, <xref ref-type="bibr" rid="pcbi.1005611.ref029">29</xref>]. Interestingly, unless a limit is imposed on reticulate complexity, there exist an infinite number of different networks describing the evolution leading to a given set of sampled taxa, unlike for phylogenetic trees.</p>
<p>Because comparing optimization scores across networks with different complexities may be problematic, in this paper we make a clear distinction between “horizontal” rearrangement moves, which enable the exploration of a “layer” of networks having a fixed reticulate complexity, and “vertical” moves, which allow a change of reticulate complexity, that is, a jump across layers. We will focus on the former, and provide natural definitions of rearrangement moves that generalize the well-known NNI and SPR moves for phylogenetic trees. As we shall show, these moves transform a network of a given reticulate complexity into another network of the same reticulate complexity, and they guarantee that every network of a given complexity is reachable from every other network of the same complexity, within a finite number of moves. Reachability between any two points of a search space is the fundamental property of any rearrangement move that can serve as basis for a search heuristic (see, e.g., the seminal paper on NNI for trees [<xref ref-type="bibr" rid="pcbi.1005611.ref030">30</xref>]).</p>
<p>The importance of distinguishing between horizontal and vertical moves lies in the fact that if moves are allowed to change the reticulate complexity of a network, then a sequence of moves transforming one network into the other may have to pass via networks of lower or higher complexity than both <italic>N</italic> and <italic>N</italic>′. This is not optimal: Lower complexity usually implies a lower fit with the data, so if every path from <italic>N</italic> to <italic>N</italic>′ has to pass via networks of lower complexity than both, then even assuming that <italic>N</italic>′ fits the data better than <italic>N</italic>, the search may get stuck before reaching <italic>N</italic>′. (<xref ref-type="fig" rid="pcbi.1005611.g002">Fig 2</xref>, discussed below, shows an example of this for a type of move recently proposed.) Similarly, if every path from <italic>N</italic> to <italic>N</italic>′ contains networks of higher complexity than both, and thus probably of higher fit with the data, it is very hard for a search starting in <italic>N</italic> to ever consider <italic>N</italic>′, as once it moves at a higher complexity, the search will likely stay there. A possible way to deal with these problems is to include in the optimization criterion a regularization term penalizing networks of higher complexity [<xref ref-type="bibr" rid="pcbi.1005611.ref028">28</xref>, <xref ref-type="bibr" rid="pcbi.1005611.ref029">29</xref>].</p>
<fig id="pcbi.1005611.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005611.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Two networks such that any sequence of rooted LST moves transforming one into the other goes through a tree.</title>
<p>LST moves are defined as in Huber et al. [<xref ref-type="bibr" rid="pcbi.1005611.ref025">25</xref>]. Note that a tree is a less complex model than either of these networks. The rearrangement moves proposed here (rNNI, see below) can transform each of these networks directly into the other (see third line in <xref ref-type="fig" rid="pcbi.1005611.g008">Fig 8</xref>, with <italic>γ</italic> = <italic>c</italic> and <italic>δ</italic> = <italic>b</italic>).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005611.g002" xlink:type="simple"/>
</fig>
<p>Two works similar in spirit to the present one have appeared recently [<xref ref-type="bibr" rid="pcbi.1005611.ref025">25</xref>, <xref ref-type="bibr" rid="pcbi.1005611.ref026">26</xref>]. The first of these [<xref ref-type="bibr" rid="pcbi.1005611.ref025">25</xref>] focuses on level-1 networks (defined in the next section), which are a relatively narrow class of networks, not including, for example, the networks in <xref ref-type="fig" rid="pcbi.1005611.g001">Fig 1</xref>. More importantly, the <italic>local subnetwork transfer</italic> (LST) moves introduced in that paper include both a horizontal and a vertical component, and the results proving the reachability between any two level-1 networks do not distinguish between these components, meaning that any sequence of LST moves transforming a network <italic>N</italic> into another network <italic>N</italic>′ with the same reticulate complexity may have to go through networks of lower (or higher) reticulate complexity. This is precisely what happens for the two networks in <xref ref-type="fig" rid="pcbi.1005611.g002">Fig 2</xref>, where to transform one into the other, the LST moves must pass via a tree. As we explained above, we believe that this is not desirable, because in many realistic scenarios, trees will have a lower fit with the data than either network.</p>
<p>The second paper [<xref ref-type="bibr" rid="pcbi.1005611.ref026">26</xref>], while it does consider horizontal and vertical moves separately, only focuses on a class of phylogenetic networks that are (<italic>a</italic>) unrooted, and (<italic>b</italic>) such that it is impossible to identify the nodes that represent reticulation events. (We note that <italic>a</italic> does not imply <italic>b</italic>: a definition of unrooted phylogenetic networks in which reticulations are well-determined is recently given by Solís-Lemus and Ané [<xref ref-type="bibr" rid="pcbi.1005611.ref020">20</xref>].) Rather than representing reticulate evolution explicitly, these networks should be seen as abstract ways to depict evolutionary relationships or, alternatively, as data-display networks. Nevertheless, that paper provides a reachability result between unrooted networks, on which we will rely in some of our proofs.</p>
<p>The rearrangement moves that we define here are named rNNI and rSPR, where the initial “r” denotes the fact that they are defined for rooted, directed phylogenetic networks such as the ones in <xref ref-type="fig" rid="pcbi.1005611.g001">Fig 1</xref>, which are the most intuitive way to represent reticulate evolutionary scenarios explicitly.</p>
<p>The paper is organized as follows: After introducing the necessary mathematical background (in <xref ref-type="sec" rid="sec002">Methods</xref>), we give our definition of rNNI moves for networks (generalizing NNI on trees), and prove that any two networks of equal reticulate complexity are mutually reachable by applying rNNI moves (in <italic>rNNI moves on rooted binary networks</italic>). Next, we define rSPR moves for networks (generalizing SPR on trees), and prove that rNNI moves can be seen as “local” rSPR moves (in <italic>rNNI moves as local rSPR moves</italic>). Because of this, reachability trivially extends to rSPR moves. Then, we study properties of the rNNI neighborhood of a network <italic>N</italic>—that is, the set of networks that can be obtained from <italic>N</italic> with just one rNNI move—giving a simple bound on its size (in <italic>Studying the size of the rNNI neighborhood</italic>). Finally, we discuss vertical moves and show that the properties they must have to ensure reachability between any pair of networks (of any complexity) are very minimal (in <italic>Changing the network complexity</italic>). We conclude with a discussion on the relevance of the results obtained to practical search heuristics for phylogenetic network inference (<xref ref-type="sec" rid="sec008">Discussion</xref>).</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Methods</title>
<p>In this section we introduce the mathematical preliminaries that are necessary for the rest of the paper.</p>
<p>A graph is <italic>directed</italic> when its edges, called <italic>arcs</italic>, are directed. An arc starting in <italic>u</italic> and ending at <italic>v</italic> is denoted by <italic>uv</italic>; <italic>u</italic> is called the <italic>tail</italic> and <italic>v</italic> the <italic>head</italic> of <italic>uv</italic>. We also call <italic>u</italic> a <italic>parent</italic> of <italic>v</italic>, and <italic>v</italic> a <italic>child</italic> of <italic>u</italic>. The <italic>degree</italic>, <italic>indegree</italic> and <italic>outdegree</italic> of a vertex <italic>v</italic> are the number of arcs incident to <italic>v</italic>, ending at <italic>v</italic> and starting at <italic>v</italic>, respectively (i.e., in a directed graph, the degree is the sum of indegree and outdegree). A directed path from <italic>s</italic> to <italic>t</italic> is called an <italic>s</italic>-<italic>t path</italic>, and is said to be <italic>nonelementary</italic> if it contains at least one vertex other than <italic>s</italic> and <italic>t</italic>. A directed graph is <italic>acyclic</italic> if it contains no directed cycle, that is, no directed path from a vertex to itself. An undirected graph is <italic>connected</italic> if there is a path between every pair of vertices.</p>
<p>Let <italic>X</italic> be a set of taxa. A <italic>rooted (phylogenetic) network</italic> on <italic>X</italic> is a directed acyclic graph with only one indegree-0 vertex, called its <italic>root</italic>, and whose set of outdegree-0 vertices, its <italic>leaves</italic>, is <italic>X</italic>. An <italic>unrooted (phylogenetic) network</italic> on <italic>X</italic> is any connected undirected graph whose set of degree-1 vertices is <italic>X</italic>. Given a rooted phylogenetic network <italic>N</italic>, the <italic>underlying unrooted network</italic> of <italic>N</italic> is the unrooted network obtained from <italic>N</italic> by replacing each arc <italic>uv</italic> in <italic>N</italic> by an undirected edge {<italic>u</italic>, <italic>v</italic>}. A phylogenetic network <italic>N</italic> is a <italic>(phylogenetic) tree</italic> if <italic>N</italic>, or the underlying unrooted network of <italic>N</italic>, does not contain any cycles. A phylogenetic network <italic>N</italic> is <italic>level-1</italic> if its simple cycles, or those of its underlying unrooted network, are pairwise disjoint.</p>
<p>A network is <italic>binary</italic> if any of its vertices has either degree 1 or 3. In the case of binary rooted networks, we also require that the root has outdegree 1. This implies that in a binary rooted network all degree-3 vertices either have indegree 1 and outdegree 2—the <italic>bifurcations</italic>—or indegree 2 and outdegree 1—the <italic>reticulations</italic>. Unless otherwise stated, the rooted networks we consider here do not have parallel arcs, that is, they are not allowed to contain more than one arc of the form <italic>uv</italic>. Note that for a <italic>binary</italic> rooted network on <italic>X</italic> with root <italic>ρ</italic>, its underlying unrooted network is on <italic>X</italic> ∪ {<italic>ρ</italic>}.</p>
<p>An <italic>arc removal</italic> in a binary rooted network <italic>N</italic> is the operation of removing from <italic>N</italic> an arc <italic>uv</italic>, where <italic>u</italic> is a bifurcation and <italic>v</italic> is a reticulation, followed by the replacement of <italic>u</italic> with a new arc connecting the parent of <italic>u</italic> with the only remaining child of <italic>u</italic>, and finally by the replacement of <italic>v</italic> with a new arc connecting the only remaining parent of <italic>v</italic> with the child of <italic>v</italic>. See <xref ref-type="fig" rid="pcbi.1005611.g003">Fig 3</xref> for an illustration of this operation.</p>
<fig id="pcbi.1005611.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005611.g003</object-id>
<label>Fig 3</label>
<caption>
<title>An arc removal.</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005611.g003" xlink:type="simple"/>
</fig>
<p>We will use repeated arc removals to measure the reticulate complexity of a network (see Proposition 1 below). Note that although this operation can produce directed acyclic graphs with parallel arcs, this is temporary: an additional arc removal applied to one of the two copies of the arc produces a binary rooted network without parallel arcs.</p>
<p>Let <italic>uv</italic> again be an arc connecting a bifurcation <italic>u</italic> to a reticulation <italic>v</italic> in a binary rooted network <italic>N</italic>. Moreover, suppose that <italic>N</italic> contains no nonelementary <italic>u</italic>-<italic>v</italic> path. An <italic>arc flip</italic> consists of replacing such an arc <italic>uv</italic> by the arc <italic>vu</italic>. Note that the conditions imposed above guarantee that an arc flip transforms a binary rooted network into another binary rooted network.</p>
<p>As discussed in the introduction, the rearrangement moves that we define in this paper allow us to explore the space of networks of a fixed reticulate complexity. The following proposition shows that there are several equivalent ways to define the same measure of reticulate complexity.</p>
<p><bold>Proposition 1.</bold> <italic>Let N</italic><sub>1</sub> <italic>and N</italic><sub>2</sub> <italic>be two binary rooted networks on X</italic>. <italic>Then the following propositions are equivalent:</italic></p>
<list list-type="order">
<list-item>
<p><italic>N</italic><sub>1</sub> <italic>and N</italic><sub>2</sub> <italic>have the same number of reticulations r</italic>.</p>
</list-item>
<list-item>
<p><italic>N</italic><sub>1</sub> <italic>and N</italic><sub>2</sub> <italic>have the same number of vertices n</italic>.</p>
</list-item>
<list-item>
<p><italic>N</italic><sub>1</sub> <italic>and N</italic><sub>2</sub> <italic>have the same number of arcs m</italic>.</p>
</list-item>
<list-item>
<p><italic>N</italic><sub>1</sub> <italic>and N</italic><sub>2</sub> <italic>require the same number of arc removals to be turned into a rooted phylogenetic tree</italic>.</p>
</list-item>
</list>
<p><italic>Proof</italic>. (1 ⇔ 2) In order to prove the equivalence between 1 and 2, we show that for any binary rooted network on <italic>X</italic> the following equation holds:
<disp-formula id="pcbi.1005611.e001"><alternatives><graphic id="pcbi.1005611.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005611.e001" xlink:type="simple"/><mml:math display="block" id="M1"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>n</mml:mi> <mml:mo>=</mml:mo> <mml:mn>2</mml:mn> <mml:mo>(</mml:mo> <mml:mi>r</mml:mi> <mml:mo>+</mml:mo> <mml:mo>|</mml:mo> <mml:mi>X</mml:mi> <mml:mo>|</mml:mo> <mml:mo>)</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
Let <italic>v</italic> be the number of bifurcations and let <italic>I</italic> (resp. <italic>O</italic>) be the sum of indegrees (resp. outdegrees) of the vertices of <italic>N</italic>. We have <italic>I</italic> = <italic>v</italic> + 2<italic>r</italic> + |<italic>X</italic>| and <italic>O</italic> = 1 + 2<italic>v</italic> + <italic>r</italic> (here 1 is for the root). Because <italic>I</italic> = <italic>O</italic>, we have <italic>v</italic> + 2<italic>r</italic> + |<italic>X</italic>| = 1 + 2<italic>v</italic> + <italic>r</italic>, which implies <italic>v</italic> = <italic>r</italic> + |<italic>X</italic>| − 1. Now substitute this in <italic>n</italic> = 1 + <italic>v</italic> + <italic>r</italic> + |<italic>X</italic>| (which expresses the total number of vertices) to obtain the equation above.</p>
<p>(1 ⇔ 3) Note that the number of arcs in a network is equal to the sum of the indegrees (or outdegrees) of its vertices, which we have already derived above. By substituting the expression above for <italic>v</italic> in that for <italic>I</italic> (or <italic>O</italic>), we obtain:
<disp-formula id="pcbi.1005611.e002"><alternatives><graphic id="pcbi.1005611.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005611.e002" xlink:type="simple"/><mml:math display="block" id="M2"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>m</mml:mi> <mml:mo>=</mml:mo> <mml:mn>3</mml:mn> <mml:mi>r</mml:mi> <mml:mo>+</mml:mo> <mml:mn>2</mml:mn> <mml:mo>|</mml:mo> <mml:mi>X</mml:mi> <mml:mo>|</mml:mo> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
which shows that two networks on <italic>X</italic> have the same number of reticulations if and only if they have the same number of arcs.</p>
<p>(1 ⇔ 4) We show that any binary rooted network <italic>N</italic> requires exactly <italic>r</italic> arc removals to be turned into a tree. If <italic>N</italic> is not a tree, then it must contain a reticulation <italic>v</italic> such that none of its parents is a reticulation. Then any arc entering <italic>v</italic> can be removed, which reduces the number of reticulations in <italic>N</italic> by one. Thus the number of arc removals that are necessary to turn <italic>N</italic> into a tree is <italic>r</italic>.</p>
<p>Note that in the statistical settings where a network is seen as a probabilistic model, the number of parameters can usually be expressed as a function of the measures above: for example if there is one parameter per arc (usually a branch length) and one parameter per reticulation (e.g., [<xref ref-type="bibr" rid="pcbi.1005611.ref028">28</xref>]), we have a total of <italic>m</italic> + <italic>r</italic> parameters. In cases such as this one, two networks on the same set of taxa require the same number of parameters if and only if they have the same reticulate complexity.</p>
<p>Our proofs will rely on previous work by Huber and collaborators [<xref ref-type="bibr" rid="pcbi.1005611.ref026">26</xref>] on NNI moves for unrooted binary networks, defined as follows: Given an unrooted binary network <italic>N</italic> and four distinct vertices (<italic>s</italic>, <italic>u</italic>, <italic>v</italic>, <italic>t</italic>) in <italic>N</italic> such that there exists a path <italic>p</italic> = (<italic>s</italic>, <italic>u</italic>, <italic>v</italic>, <italic>t</italic>) and neither {<italic>s</italic>, <italic>v</italic>} nor {<italic>u</italic>, <italic>t</italic>} are edges of <italic>N</italic>, the NNI move on (<italic>s</italic>, <italic>u</italic>, <italic>v</italic>, <italic>t</italic>) consists in replacing <italic>p</italic> with the path (<italic>s</italic>, <italic>v</italic>, <italic>u</italic>, <italic>t</italic>). In particular we will use the following result.</p>
<p><bold>Theorem 1.</bold> ([<xref ref-type="bibr" rid="pcbi.1005611.ref026">26</xref>]). <italic>If N</italic><sub>1</sub> <italic>and N</italic><sub>2</sub> <italic>are unrooted binary networks on X with the same number of vertices, then there exists a sequence of NNI moves turning N</italic><sub>1</sub> <italic>into N</italic><sub>2</sub>.</p>
</sec>
<sec id="sec003" sec-type="results">
<title>Results</title>
<sec id="sec004">
<title>rNNI moves on rooted binary networks</title>
<p>We say that a rooted phylogenetic network <italic>N</italic> has an arc <italic>on</italic> {<italic>u</italic>, <italic>v</italic>} if it has either the arc <italic>uv</italic> or <italic>vu</italic>.</p>
<p><bold>Definition 1.</bold> <italic>If a rooted binary phylogenetic network N has four distinct vertices s</italic>, <italic>u</italic>, <italic>v</italic>, <italic>t</italic> <italic>and arcs on</italic> {<italic>s</italic>, <italic>u</italic>}, {<italic>u</italic>, <italic>v</italic>} <italic>and</italic> {<italic>v</italic>, <italic>t</italic>} <italic>but not on</italic> {<italic>u</italic>, <italic>t</italic>} <italic>and</italic> {<italic>s</italic>, <italic>v</italic>}, <italic>then an</italic> rNNI <italic>move consists of replacing the arcs on</italic> {<italic>s</italic>, <italic>u</italic>}, {<italic>u</italic>, <italic>v</italic>} <italic>and</italic> {<italic>v</italic>, <italic>t</italic>} <italic>by arcs on</italic> {<italic>u</italic>, <italic>t</italic>}, {<italic>u</italic>, <italic>v</italic>} <italic>and</italic> {<italic>s</italic>, <italic>v</italic>} <italic>such that:</italic></p>
<list list-type="order">
<list-item>
<p><italic>the in</italic>- <italic>and outdegrees of s and t are not affected by the move;</italic></p>
</list-item>
<list-item>
<p><italic>the in</italic>- <italic>and outdegrees of u and v remain at most 2 and</italic></p>
</list-item>
<list-item>
<p><italic>the obtained network is acyclic</italic>.</p>
</list-item>
</list>
<p><italic>An rNNI move replacing arcs a</italic><sub>1</sub>, <italic>a</italic><sub>2</sub>, <italic>a</italic><sub>3</sub> <italic>by arcs a</italic><sub>4</sub>, <italic>a</italic><sub>5</sub>, <italic>a</italic><sub>6</sub> <italic>is denoted by</italic> (<italic>a</italic><sub>1</sub>, <italic>a</italic><sub>2</sub>, <italic>a</italic><sub>3</sub> → <italic>a</italic><sub>4</sub>, <italic>a</italic><sub>5</sub>, <italic>a</italic><sub>6</sub>). <italic>If Conditions 1 and 2 are satisfied but Condition 3 is not then the move is called a</italic> cycle-creating rNNI move.</p>
<p>Note in particular that an rNNI move may or may not change the orientation of the arc on {<italic>u</italic>, <italic>v</italic>}. Also note that an rNNI move does not change the total degree of any vertex, hence it follows from restrictions 1 and 2 that the network remains binary. Nor does it change the number of vertices of the network, and thus none of the measures of reticulate complexity (see Proposition 1), including the number of reticulations. Moreover, the newly created arcs are necessarily distinct (because all four involved vertices are distinct), and not already present in <italic>N</italic> (because no arcs on {<italic>u</italic>, <italic>t</italic>} and {<italic>s</italic>, <italic>v</italic>} are present in <italic>N</italic>), meaning that an rNNI move cannot produce parallel arcs. Finally we observe that rNNI moves are reversible: if (<italic>a</italic><sub>1</sub>, <italic>a</italic><sub>2</sub>, <italic>a</italic><sub>3</sub> → <italic>a</italic><sub>4</sub>, <italic>a</italic><sub>5</sub>, <italic>a</italic><sub>6</sub>) is an rNNI move turning <italic>N</italic> into <italic>N</italic>′, then (<italic>a</italic><sub>4</sub>, <italic>a</italic><sub>5</sub>, <italic>a</italic><sub>6</sub> → <italic>a</italic><sub>1</sub>, <italic>a</italic><sub>2</sub>, <italic>a</italic><sub>3</sub>) is an rNNI move turning <italic>N</italic>′ into <italic>N</italic>.</p>
<p><bold>Observation 1.</bold> <italic>Applying an rNNI move to a binary rooted phylogenetic network N on X results in another binary rooted phylogenetic network N</italic>′ <italic>on X with the same number of reticulations. Moreover, N can be obtained from N</italic>′ <italic>by an rNNI move</italic>.</p>
<p>The rNNI moves can be divided into seven different types, as shown by the following lemma, and illustrated in <xref ref-type="fig" rid="pcbi.1005611.g004">Fig 4</xref>.</p>
<fig id="pcbi.1005611.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005611.g004</object-id>
<label>Fig 4</label>
<caption>
<title>The seven different variants of the rNNI move.</title>
<p>Dashed edges indicate that there is no arc between those vertices. Gray arcs are those that change with the move. If vertices have additional incident arcs that are not drawn, then these may be oriented either way. These moves are only valid if the resulting network is acyclic. Note that the difference between (<italic>i</italic>) and (<italic>i</italic>*) is that (<italic>i</italic>*) reverses the direction of the <italic>uv</italic> arc.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005611.g004" xlink:type="simple"/>
</fig>
<p><bold>Lemma 1.</bold> <italic>Each rNNI move on rooted binary phylogenetic network N is of one of the following types</italic>.</p>
<list list-type="simple">
<list-item>
<p><italic>(1)</italic> (<italic>us</italic>, <italic>uv</italic>, <italic>vt</italic> → <italic>ut</italic>, <italic>uv</italic>, <italic>vs</italic>) <italic>and there is no s</italic>-<italic>v path in N</italic>;</p>
</list-item>
<list-item>
<p><italic>(1*)</italic> (<italic>us</italic>, <italic>uv</italic>, <italic>vt</italic> → <italic>ut</italic>, <italic>vu</italic>, <italic>vs</italic>), <italic>there is no s</italic>-<italic>v path and v is a reticulation in N;</italic></p>
</list-item>
<list-item>
<p><italic>(2)</italic> (<italic>su</italic>, <italic>uv</italic>, <italic>tv</italic> → <italic>sv</italic>, <italic>uv</italic>, <italic>tu</italic>) <italic>and there is no u</italic>-<italic>t path in N;</italic></p>
</list-item>
<list-item>
<p><italic>(2*)</italic> (<italic>su</italic>, <italic>uv</italic>, <italic>tv</italic> → <italic>sv</italic>, <italic>vu</italic>, <italic>tu</italic>), <italic>there is no u</italic>-<italic>t path and u is a bifurcation in N;</italic></p>
</list-item>
<list-item>
<p><italic>(3)</italic> (<italic>su</italic>, <italic>uv</italic>, <italic>vt</italic> → <italic>sv</italic>, <italic>uv</italic>, <italic>ut</italic>), <italic>u is a reticulation and v a bifurcation in N;</italic></p>
</list-item>
<list-item>
<p><italic>(3*)</italic> (<italic>su</italic>, <italic>uv</italic>, <italic>vt</italic> → <italic>sv</italic>, <italic>vu</italic>, <italic>ut</italic>) <italic>and there is no nonelementary u</italic>-<italic>v path in N;</italic></p>
</list-item>
<list-item>
<p><italic>(4)</italic> (<italic>us</italic>, <italic>uv</italic>, <italic>tv</italic> → <italic>vs</italic>, <italic>uv</italic>, <italic>tu</italic>) <italic>and there is no s</italic>-<italic>t path in N</italic>.</p>
</list-item>
</list>
<p><italic>Proof</italic>. An rNNI move assumes the existence of three arcs: one on {<italic>s</italic>, <italic>u</italic>}, one on {<italic>u</italic>, <italic>v</italic>} and one on {<italic>v</italic>, <italic>t</italic>}. We consider the four possible arc orientations for {<italic>s</italic>, <italic>u</italic>} and {<italic>v</italic>, <italic>t</italic>}, while without loss of generality the third arc is fixed as <italic>uv</italic>. For each of these combinations, we consider two possible moves: one leaving the orientation of <italic>uv</italic> unchanged, which gives cases (1)-(4), and one reversing its orientation, which gives cases (1*)-(3*). Note that a (4*) move (<italic>us</italic>, <italic>uv</italic>, <italic>tv</italic> → <italic>vs</italic>, <italic>vu</italic>, <italic>tu</italic>) is not an rNNI, as it would introduce nodes with indegree or outdegree 3. For each of the seven resulting cases, we also provide restrictions that ensure that the conditions given in Definition 1 are satisfied (e.g., <italic>u</italic> has to be a reticulation in (3)). It is tedious but relatively easy to check each of these cases and its associated restrictions.</p>
<p>Note that moves (1*), (2*), (3*) reverse the direction of arc <italic>uv</italic> while moves (1), (2), (3) and (4) do not. Also note that if <italic>N</italic> is a phylogenetic tree, then only the moves of types (1) and (3*) are allowed (as they are the only ones not assuming the presence of a reticulation) and then the rNNI moves defined above coincide with NNI moves on rooted trees.</p>
<p>Recall the definition of arc flips in the <italic>Methods</italic>, as operations that reverse the direction of an arc connecting a bifurcation to a reticulation without introducing cycles. The following three lemmas show some interesting relationships between rooted networks with the same underlying unrooted network, and between rNNI moves on a rooted network and NNI moves on the underlying unrooted network. The proofs of the first two lemmas can be found in the <xref ref-type="supplementary-material" rid="pcbi.1005611.s001">S1 Text</xref>.</p>
<p><bold>Lemma 2.</bold> <italic>Let N be a binary rooted network on X, and let N</italic>′ <italic>be a binary network obtained by applying an arc flip to N. Then, unless N and N</italic>′ <italic>are the same network (that is, they are isomorphic), N can be turned into N</italic>′ <italic>in exactly two rNNI moves</italic>.</p>
<p><bold>Lemma 3.</bold> <italic>Let N be a binary rooted phylogenetic network and let N<sub>u</sub></italic> <italic>be its underlying unrooted network. If an unrooted network</italic> <inline-formula id="pcbi.1005611.e003">
<alternatives>
<graphic id="pcbi.1005611.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005611.e003" xlink:type="simple"/>
<mml:math display="inline" id="M3">
<mml:msubsup>
<mml:mi>N</mml:mi>
<mml:mi>u</mml:mi>
<mml:mo>′</mml:mo>
</mml:msubsup>
</mml:math>
</alternatives>
</inline-formula> <italic>can be obtained by applying a single NNI move to N<sub>u</sub></italic>, <italic>then there exists a sequence of rNNI moves turning N into a network N</italic>′ <italic>that has</italic> <inline-formula id="pcbi.1005611.e004"><alternatives><graphic id="pcbi.1005611.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005611.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:msubsup><mml:mi>N</mml:mi> <mml:mi>u</mml:mi> <mml:mo>′</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> <italic>as its underlying unrooted network</italic>.</p>
<p><bold>Lemma 4.</bold> <italic>If N and N</italic>′ <italic>are binary rooted level-1 phylogenetic networks on X with the same underlying unrooted network, then there exists a sequence of arc flips turning N into N</italic>′.</p>
<p><italic>Proof</italic>. The gist of the proof is the following: because <italic>N</italic> and <italic>N</italic>′ have the same underlying unrooted network, then their cycles only differ by paths that are oriented in opposite directions in each of the networks. A flipping applied to each of the arcs in these paths transforms one of the networks into the other one. However, to be valid, these arc flips must be performed in a specific order, as we now describe.</p>
<p>For any node <italic>u</italic> in <italic>N</italic>, let <italic>d</italic><sub><italic>N</italic></sub>(<italic>u</italic>) be the length of a longest path from the root of <italic>N</italic> to <italic>u</italic>. We say that an arc <italic>xy</italic> of <italic>N</italic> is <italic>incorrectly oriented</italic> if <italic>N</italic>′ has the arc <italic>yx</italic> and <italic>correctly oriented</italic> if <italic>N</italic>′ has the arc <italic>xy</italic>. If <italic>N</italic> ≠ <italic>N</italic>′ then <italic>N</italic> has at least one incorrectly oriented arc. Let <italic>uv</italic> be an incorrectly oriented arc of <italic>N</italic> such that there is no <italic>u</italic>′<italic>v</italic>′ that is incorrectly oriented and <italic>d</italic><sub><italic>N</italic></sub>(<italic>u</italic>′) &gt; <italic>d</italic><sub><italic>N</italic></sub>(<italic>u</italic>).</p>
<p>First, <italic>v</italic> is a reticulation in <italic>N</italic> since if it were a bifurcation, for our choice of <italic>u</italic>, <italic>v</italic> would have two correctly-oriented outgoing arcs in <italic>N</italic> and hence outdegree 3 in <italic>N</italic>′, and if <italic>v</italic> were a leaf, then <italic>N</italic>′ would not be on the same set of taxa <italic>X</italic> as <italic>N</italic>. Second, <italic>u</italic> is a bifurcation in <italic>N</italic> since if it were a reticulation <italic>N</italic> would not be level-1, while if it were the root of <italic>N</italic>, then <italic>N</italic>′ would have <italic>u</italic> among its leaves, implying that <italic>N</italic> and <italic>N</italic>′ would not be on the same set <italic>X</italic>.</p>
<p>Now, we want to prove that there is no nonelementary <italic>u</italic>-<italic>v</italic> path in <italic>N</italic>. Suppose that there exists one. Then this path has at least one incorrectly oriented arc <italic>u</italic>′<italic>v</italic>′, otherwise <italic>N</italic>′ would contain a cycle. Then, because of our choice of <italic>u</italic>, we know that <italic>u</italic>′ = <italic>u</italic>. Now, notice that <italic>v</italic>′ cannot be a reticulation, since otherwise <italic>N</italic> would not be level-1. Again, for our choice of <italic>u</italic>, both outgoing arcs of <italic>v</italic>′ in <italic>N</italic> are correctly oriented. Then <italic>uv</italic>′ cannot be incorrectly oriented unless <italic>v</italic>′ has outdegree 3 in <italic>N</italic>′, which is impossible.</p>
<p>Hence, there is no nonelementary <italic>u</italic>-<italic>v</italic> path in <italic>N</italic>. Therefore, we can perform an arc flip on <italic>uv</italic> and reduce the number of incorrectly-oriented arcs by one. We repeat this until there are no incorrectly-oriented arcs left.</p>
<p>As we now show, the three lemmas above allow us to prove the restriction of our main result on rNNI moves to level-1 networks. Note that in the theorem below we do not require intermediate networks to be level-1.</p>
<p><bold>Theorem 2.</bold> <italic>If N and N</italic>′ <italic>are binary rooted level-1 phylogenetic networks on X with the same number of reticulations, then there exists a sequence of rNNI moves turning N into N</italic>′.</p>
<p><italic>Proof</italic>. By Theorem 1, there exists a sequence of unrooted NNI moves that turns the underlying unrooted network of <italic>N</italic> into the underlying unrooted network of <italic>N</italic>′ (by Proposition 1 these unrooted networks have the same number of vertices). Hence, by Lemma 3, there exists a sequence of rNNI moves that turns <italic>N</italic> into a network <italic>N</italic>′′ (on <italic>X</italic>) that has the same underlying unrooted network as <italic>N</italic>′. By Lemma 4, there exists a sequence of arc flips turning <italic>N</italic>′′ into <italic>N</italic>′, which by Lemma 2 can be reproduced by a sequence of rNNI moves. Together, this gives a sequence of rNNI moves turning <italic>N</italic> into <italic>N</italic>′.</p>
<p>Interestingly, Lemma 4 does not hold for networks that are not level-1, as shown in <xref ref-type="fig" rid="pcbi.1005611.g005">Fig 5</xref>. This means that in order to generalize Theorem 2, we need to adopt a more complex approach. These observations prompt the next definition.</p>
<fig id="pcbi.1005611.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005611.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Lemma 4 does not hold for general networks.</title>
<p>Two rooted networks with the same underlying unrooted network that are not reachable from one another by performing a sequence of arc flips. The only arc flips that can be applied are to the gray arcs, as the reversal of any other arc produces a network that either is nonbinary or contains a cycle.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005611.g005" xlink:type="simple"/>
</fig>
<p><bold>Definition 2.</bold> <italic>A binary rooted phylogenetic network N on X is called</italic> flip-friendly <italic>if it can be transformed into any other binary rooted network N</italic>′ <italic>on X with the same underlying unrooted network as N by repeatedly applying arc flips</italic>.</p>
<p>Note that if <italic>N</italic> is flip-friendly, then every network with the same underlying unrooted network as <italic>N</italic> is also flip-friendly. Although not every binary rooted network is flip-friendly (e.g., <xref ref-type="fig" rid="pcbi.1005611.g005">Fig 5</xref>), the following lemma—whose proof can be found in the <xref ref-type="supplementary-material" rid="pcbi.1005611.s001">S1 Text</xref>—shows that there are flip-friendly networks at every level of reticulate complexity.</p>
<p><bold>Lemma 5.</bold> <italic>For any nonempty X and r ≥ 1, there exists at least one flip-friendly binary rooted network on X with r reticulations</italic>.</p>
<p>This result allows us to prove that any two binary rooted networks of equal reticulate complexities are reachable from one another via rNNI moves, by using a slightly different approach than that employed to prove Theorem 2.</p>
<p><bold>Theorem 3.</bold> <italic>Let N</italic><sub>1</sub> <italic>and N</italic><sub>2</sub> <italic>be two binary rooted phylogenetic networks on X with the same number of reticulations r. Then there exists a sequence of rNNI moves turning N</italic><sub>1</sub> <italic>into N</italic><sub>2</sub>.</p>
<p><italic>Proof</italic>. Let <italic>N</italic><sub><italic>F</italic></sub> be a flip-friendly binary rooted network on <italic>X</italic> with <italic>r</italic> reticulations, which exists by Lemma 5, and let <inline-formula id="pcbi.1005611.e005"><alternatives><graphic id="pcbi.1005611.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005611.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:msubsup><mml:mi>N</mml:mi> <mml:mi>F</mml:mi> <mml:mi>u</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> be its underlying unrooted network. Also let <inline-formula id="pcbi.1005611.e006"><alternatives><graphic id="pcbi.1005611.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005611.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:msubsup><mml:mi>N</mml:mi> <mml:mn>1</mml:mn> <mml:mi>u</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> be the underlying unrooted network of <italic>N</italic><sub>1</sub>. By Theorem 1, there exists a sequence of NNI moves transforming <inline-formula id="pcbi.1005611.e007"><alternatives><graphic id="pcbi.1005611.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005611.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:msubsup><mml:mi>N</mml:mi> <mml:mn>1</mml:mn> <mml:mi>u</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> to <inline-formula id="pcbi.1005611.e008"><alternatives><graphic id="pcbi.1005611.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005611.e008" xlink:type="simple"/><mml:math display="inline" id="M8"><mml:msubsup><mml:mi>N</mml:mi> <mml:mi>F</mml:mi> <mml:mi>u</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>, and thus by Lemma 3, there is a sequence <italic>S</italic><sub>1</sub> of rNNI moves transforming <italic>N</italic><sub>1</sub> into a network <inline-formula id="pcbi.1005611.e009"><alternatives><graphic id="pcbi.1005611.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005611.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:msubsup><mml:mi>N</mml:mi> <mml:mn>1</mml:mn> <mml:mo>′</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> such that <inline-formula id="pcbi.1005611.e010"><alternatives><graphic id="pcbi.1005611.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005611.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:msubsup><mml:mi>N</mml:mi> <mml:mn>1</mml:mn> <mml:mo>′</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> has <inline-formula id="pcbi.1005611.e011"><alternatives><graphic id="pcbi.1005611.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005611.e011" xlink:type="simple"/><mml:math display="inline" id="M11"><mml:msubsup><mml:mi>N</mml:mi> <mml:mi>F</mml:mi> <mml:mi>u</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> as underlying unrooted network. By the same argument, there is a sequence <italic>S</italic><sub>2</sub> of rNNI moves transforming <italic>N</italic><sub>2</sub> into a network <inline-formula id="pcbi.1005611.e012"><alternatives><graphic id="pcbi.1005611.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005611.e012" xlink:type="simple"/><mml:math display="inline" id="M12"><mml:msubsup><mml:mi>N</mml:mi> <mml:mn>2</mml:mn> <mml:mo>′</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> also having <inline-formula id="pcbi.1005611.e013"><alternatives><graphic id="pcbi.1005611.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005611.e013" xlink:type="simple"/><mml:math display="inline" id="M13"><mml:msubsup><mml:mi>N</mml:mi> <mml:mi>F</mml:mi> <mml:mi>u</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> as underlying unrooted network. Because <italic>N</italic><sub><italic>F</italic></sub> is flip-friendly and <inline-formula id="pcbi.1005611.e014"><alternatives><graphic id="pcbi.1005611.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005611.e014" xlink:type="simple"/><mml:math display="inline" id="M14"><mml:msubsup><mml:mi>N</mml:mi> <mml:mn>1</mml:mn> <mml:mo>′</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005611.e015"><alternatives><graphic id="pcbi.1005611.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005611.e015" xlink:type="simple"/><mml:math display="inline" id="M15"><mml:msubsup><mml:mi>N</mml:mi> <mml:mn>2</mml:mn> <mml:mo>′</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> are binary rooted networks on <italic>X</italic> with the same underlying unrooted network as <italic>N</italic><sub><italic>F</italic></sub>, <italic>N</italic><sub><italic>F</italic></sub> can be turned into <inline-formula id="pcbi.1005611.e016"><alternatives><graphic id="pcbi.1005611.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005611.e016" xlink:type="simple"/><mml:math display="inline" id="M16"><mml:msubsup><mml:mi>N</mml:mi> <mml:mn>1</mml:mn> <mml:mo>′</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005611.e017"><alternatives><graphic id="pcbi.1005611.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005611.e017" xlink:type="simple"/><mml:math display="inline" id="M17"><mml:msubsup><mml:mi>N</mml:mi> <mml:mn>2</mml:mn> <mml:mo>′</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> by only using arc flips. But then, as arc flips are reversible, <inline-formula id="pcbi.1005611.e018"><alternatives><graphic id="pcbi.1005611.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005611.e018" xlink:type="simple"/><mml:math display="inline" id="M18"><mml:msubsup><mml:mi>N</mml:mi> <mml:mn>1</mml:mn> <mml:mo>′</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> can be turned into <inline-formula id="pcbi.1005611.e019"><alternatives><graphic id="pcbi.1005611.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005611.e019" xlink:type="simple"/><mml:math display="inline" id="M19"><mml:msubsup><mml:mi>N</mml:mi> <mml:mn>2</mml:mn> <mml:mo>′</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> by a sequence of arc flips, which by Lemma 2 corresponds to a sequence <italic>S</italic><sub><italic>flip</italic></sub> of rNNI moves. Then one can obtain <italic>N</italic><sub>2</sub> from <italic>N</italic><sub>1</sub> by first applying <italic>S</italic><sub>1</sub> to obtain <inline-formula id="pcbi.1005611.e020"><alternatives><graphic id="pcbi.1005611.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005611.e020" xlink:type="simple"/><mml:math display="inline" id="M20"><mml:msubsup><mml:mi>N</mml:mi> <mml:mn>1</mml:mn> <mml:mo>′</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula>, then applying <italic>S</italic><sub><italic>flip</italic></sub> to obtain <inline-formula id="pcbi.1005611.e021"><alternatives><graphic id="pcbi.1005611.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005611.e021" xlink:type="simple"/><mml:math display="inline" id="M21"><mml:msubsup><mml:mi>N</mml:mi> <mml:mn>2</mml:mn> <mml:mo>′</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula>, and finally applying <italic>S</italic><sub>2</sub> in reverse order to obtain <italic>N</italic><sub>2</sub>.</p>
<p>An interesting consequence of Theorem 3 is that our definition of rNNI moves induces natural metrics over the spaces of the rooted binary networks of fixed reticulate complexity: if we let <italic>N</italic><sub>1</sub> and <italic>N</italic><sub>2</sub> be two binary rooted phylogenetic networks on <italic>X</italic> with the same number of reticulations, their <italic>rNNI distance</italic> can be defined as the minimum number of rNNI moves required to transform <italic>N</italic><sub>1</sub> into <italic>N</italic><sub>2</sub> (or vice versa, because of the reversibility of the moves). It is easy to see that this definition satisfies the conditions for a metric.</p>
</sec>
<sec id="sec005">
<title>rNNI moves as local rSPR moves</title>
<p>In this section, we will give a natural definition of SPR moves on binary rooted networks (rSPR), and show that the rNNI moves defined above have a very simple interpretation as rSPR moves that regraft an arc “locally”.</p>
<p><bold>Definition 3.</bold> <italic>Let xz</italic>, <italic>zy</italic> <italic>and</italic> <italic>x</italic>′<italic>y</italic>′ <italic>be three arcs in a rooted binary phylogenetic network N</italic>, <italic>such that x</italic>′ ≠ <italic>z</italic> ≠ <italic>y</italic>′ <italic>and none of x</italic>′<italic>z</italic>, <italic>zy</italic>′ <italic>and</italic> <italic>xy is a arc of N</italic>. <italic>Then an</italic> rSPR <italic>move consists of replacing the arcs xz</italic>, <italic>zy</italic> <italic>and x</italic>′<italic>y</italic>′ <italic>with x</italic>′<italic>z</italic>, <italic>zy</italic>′ <italic>and</italic> <italic>xy</italic>, <italic>under the condition that the resulting network is acyclic. Such a move is denoted by</italic> [<italic>xz</italic>, <italic>zy</italic>, <italic>x</italic>′<italic>y</italic>′ → <italic>x</italic>′<italic>z</italic>, <italic>zy</italic>′, <italic>xy</italic>]. <italic>Arcs xz</italic> <italic>and</italic> <italic>zy</italic> <italic>are called the</italic> donor <italic>arcs and x</italic>′<italic>y</italic>′ <italic>is the</italic> recipient <italic>arc</italic>.</p>
<p>Note that vertex <italic>z</italic> is either the tail of an arc <italic>zw</italic> or the head of an arc <italic>wz</italic>. Informally, an rSPR move can be described as moving (or “regrafting”) the tail or the head of this arc from the donor “arc” <italic>xy</italic>, to the recipient arc <italic>x</italic>′<italic>y</italic>′ (see <xref ref-type="fig" rid="pcbi.1005611.g006">Fig 6</xref>). We call the former type of rSPR move <italic>tail-moving</italic>, and the latter <italic>head-moving</italic>. As stated, such moves are only allowed if they do not create cycles in the network. Note that when applied to a phylogenetic tree, the rSPR moves can only be tail-moving; they then coincide with the rooted SPR operations commonly defined on rooted trees [<xref ref-type="bibr" rid="pcbi.1005611.ref031">31</xref>, <xref ref-type="bibr" rid="pcbi.1005611.ref032">32</xref>]. The name rSPR is meant to stand for <italic>rooted subnetwork pruning and regrafting</italic>, where the subnetwork being affected can be identified as the one consisting of all descendants of the pruned arc in a tail-moving rSPR, or of all of its ancestors in a head-moving rSPR move.</p>
<fig id="pcbi.1005611.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005611.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Illustration of rSPR moves.</title>
<p>The donor arcs (<italic>xz</italic> and <italic>zy</italic>) and the recipient arc (<italic>x</italic>′<italic>y</italic>′) are in black, while the arc whose head or tail is moved is drawn in grey.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005611.g006" xlink:type="simple"/>
</fig>
<p>The definition above implies that the newly created arcs {<italic>x</italic>′<italic>z</italic>, <italic>zy</italic>′, <italic>xy</italic>} are necessarily distinct and not already present in <italic>N</italic>, meaning that an rSPR move cannot create parallel arcs. Moreover, an rSPR move does not change the number of vertices of the network (and thus none of the measures of reticulate complexity in Proposition 1), nor the indegree or outdegree of any vertex. Thus an rSPR move always turns a binary rooted network into another binary rooted network, and, like rNNI moves, it is easy to see that rSPR moves are reversible.</p>
<p><bold>Observation 2.</bold> <italic>Applying an rSPR move to a binary rooted phylogenetic network N on X results in another binary rooted phylogenetic network N</italic>′ <italic>on X with the same number of reticulations. Moreover, N can be obtained from N</italic>′ <italic>by an rSPR move</italic>.</p>
<p>We now provide the conditions that determine whether a candidate rSPR move creates a cycle in a network.</p>
<p><bold>Lemma 6.</bold> <italic>Similarily to Definition 3, let xz</italic>, <italic>zy</italic> <italic>and x</italic>′<italic>y</italic>′ <italic>be three arcs in a rooted binary phylogenetic network N</italic>, <italic>such that x</italic>′ ≠ <italic>z</italic> ≠ <italic>y</italic>′ <italic>and none of x</italic>′<italic>z</italic>, <italic>zy</italic>′ <italic>and xy is an arc of N</italic>. <italic>Furthermore, let w be the vertex adjacent to z in N that is neither x nor y, and let N</italic>′ <italic>be the directed graph obtained from N by replacing the arcs in</italic> {<italic>xz</italic>, <italic>zy</italic>, <italic>x</italic>′<italic>y</italic>′} <italic>with those in</italic> {<italic>x</italic>′<italic>z</italic>, <italic>zy</italic>′, <italic>xy</italic>} <italic>(see</italic> <xref ref-type="fig" rid="pcbi.1005611.g006">Fig 6</xref> <italic>for an illustration)</italic>.</p>
<list list-type="order">
<list-item>
<p><italic>If the move is tail-moving (i.e. zw is an arc of N), N</italic>′ <italic>is acyclic if and only if there is no w-x</italic>′ <italic>path in N</italic>.</p>
</list-item>
<list-item>
<p><italic>If the move is head-moving (i.e. wz is an arc of N), N</italic>′ <italic>is acyclic if and only if there is no y</italic>′ <italic>-w path in N</italic>.</p>
</list-item>
</list>
<p><italic>Proof</italic>. The <italic>only if</italic> parts are trivial, as it is easy to check that the indicated paths imply a cycle in <italic>N</italic>′. As for the <italic>if</italic> part, the fact that <italic>N</italic> is acyclic implies that there cannot be any cycles in <italic>N</italic>′ not containing <italic>zw</italic> (in the tail-moving case) or <italic>wz</italic> (in the head-moving case). But then the existence of a cycle in <italic>N</italic>′ would imply the existence of a <italic>w</italic>-<italic>x</italic>′ path, or of a <italic>y</italic>′-<italic>w</italic> path, respectively, in <italic>N</italic>′, and therefore in <italic>N</italic>.</p>
<p>NNI moves for phylogenetic trees are often viewed as SPR moves that regraft a subtree onto an edge that is incident to the edge from which the subtree was initially pruned [<xref ref-type="bibr" rid="pcbi.1005611.ref033">33</xref>]. This observation prompts the following definition.</p>
<p><bold>Definition 4.</bold> <italic>An</italic> rSPR<sub>1</sub> <italic>move is an rSPR move where the recipient arc is incident with one of the donor arcs</italic>.</p>
<p>Note that because of the requirement in Definition 3 that the recipient arc <italic>x</italic>′<italic>y</italic>′ cannot be incident to <italic>z</italic>, an rSPR<sub>1</sub> move can only regraft vertex <italic>z</italic> and its incident arc to one of four possible recipient arcs (see <xref ref-type="fig" rid="pcbi.1005611.g007">Fig 7</xref>).</p>
<fig id="pcbi.1005611.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005611.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Illustration of rSPR<sub>1</sub> moves.</title>
<p>Vertex <italic>z</italic> and its incident arc can only be regrafted onto: (a) an arc entering <italic>x</italic>, (b) an arc exiting <italic>x</italic>, (c) an arc exiting <italic>y</italic>, (d) an arc entering <italic>y</italic>. Grey arcs are the ones whose direction is undetermined.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005611.g007" xlink:type="simple"/>
</fig>
<p>We can now state the main result of this section. Its relatively tedious proof—which can be found in the <xref ref-type="supplementary-material" rid="pcbi.1005611.s001">S1 Text</xref>—consists of showing that each of the four types of rSPR<sub>1</sub> moves in <xref ref-type="fig" rid="pcbi.1005611.g007">Fig 7</xref> is in fact an rNNI move, and, conversely, each of the seven rNNI types in Lemma 1 can be reproduced with a single rSPR<sub>1</sub> move.</p>
<p><bold>Theorem 4.</bold> <italic>Let N and N</italic>′ <italic>be binary rooted networks. Then, N can be turned into N</italic>′ <italic>with one rNNI move if and only if N can be turned into N</italic>′ <italic>with one rSPR</italic><sub>1</sub> <italic>move</italic>.</p>
<p>Theorem 4 implies that every rNNI move is also an rSPR move, and every sequence of rNNI moves (e.g., that in Theorem 3) is also a sequence of rSPR moves. If we define the <italic>rSPR distance</italic> of two networks as the minimum number of rSPR moves to transform one network into the other, we then have the following result.</p>
<p><bold>Corollary 1.</bold> <italic>Let N</italic><sub>1</sub> <italic>and N</italic><sub>2</sub> <italic>be two binary rooted networks on X with the same number of reticulations. Then there exists a sequence of rSPR moves turning N</italic><sub>1</sub> <italic>into N</italic><sub>2</sub>. <italic>Moreover, the rSPR distance between N</italic><sub>1</sub> <italic>and N</italic><sub>2</sub> <italic>is at most equal to their rNNI distance</italic>.</p>
</sec>
<sec id="sec006">
<title>Studying the size of the rNNI neighborhood</title>
<p>The two previous subsections provide two alternative definitions for rNNI moves. One important aspect that they have in common is that one arc in the starting network <italic>N</italic> is “central” in both definitions: <italic>uv</italic> in the original definition (Def. 1) and the donor arc incident to the recipient arc in the definition of rSPR<sub>1</sub> moves (e.g., arc <italic>xz</italic> in <xref ref-type="fig" rid="pcbi.1005611.g007">Fig 7(a)</xref>; Def. 4). We say that the rNNI move is <italic>around</italic> this arc.</p>
<p>We can list the different networks that can be reached from a network <italic>N</italic> with one rNNI move—that is, the <italic>rNNI neighborhood</italic> of <italic>N</italic>—by considering one internal arc of <italic>N</italic> at a time, and then by enumerating the networks <italic>N</italic>′ that can be obtained with one rNNI move around that arc. This is the approach we take to prove the following bound on the size of the rNNI neighborhood.</p>
<p><bold>Proposition 2.</bold> <italic>Let N be a binary rooted network. Within N, let e<sub>BB</sub> denote the number of arcs from a bifurcation to a bifurcation, e<sub>BR</sub> the number of arcs from a bifurcation to a reticulation, e<sub>RB</sub> the number of arcs from a reticulation to a bifurcation, and e<sub>RR</sub> the number of arcs from a reticulation to a reticulation. Then, the number of different binary rooted networks that can be obtained from N by one rNNI move is at most</italic> 2(<italic>e<sub>BB</sub></italic> + <italic>e<sub>RR</sub></italic>) + 3<italic>e<sub>BR</sub></italic> + 4<italic>e<sub>RB</sub></italic>.</p>
<p>Although we refer the reader to the <xref ref-type="supplementary-material" rid="pcbi.1005611.s001">S1 Text</xref> for a detailed proof of Proposition 2, we give a brief outline here: because every rNNI move applied to <italic>N</italic> must be around some arc <italic>uv</italic> in <italic>N</italic>, where each of <italic>u</italic> and <italic>v</italic> can either be a bifurcation or a reticulation, rNNI moves can be divided into four cases: those around an arc from a bifurcation to a bifurcation (case BB), from a reticulation to a reticulation (case RR), and those around and arc connecting a bifurcation and a reticulation (in any order, cases BR and RB). By considering these four cases, it is easy to see that for cases BB and RR at most 2 other network topologies can be obtained from <italic>N</italic>, while for cases BR and RB at most 3 and 4 networks can be obtained, respectively, which gives the claimed bound. See <xref ref-type="fig" rid="pcbi.1005611.g008">Fig 8</xref> for an illustration of these four cases.</p>
<fig id="pcbi.1005611.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005611.g008</object-id>
<label>Fig 8</label>
<caption>
<title>rNNI moves around the different types of internal arcs.</title>
<p>For each type (BB, RR, BR, RB), we list the networks that can be obtained by performing an rNNI around that an arc of that type. The four types of arc are named on the basis of <italic>u</italic> and <italic>v</italic> being a bifurcation (B) or a reticulation (R). If some of the vertices in the drawing are not distinct (e.g., if <italic>α</italic> = <italic>γ</italic> in a move of type RR), or if a <italic>γ</italic>-<italic>β</italic> path exists in a move of type BR, then some of the moves above may not be applicable. See the proof of Proposition 2 (in the <xref ref-type="supplementary-material" rid="pcbi.1005611.s001">S1 Text</xref>) for details.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005611.g008" xlink:type="simple"/>
</fig>
<p>When <italic>N</italic> is a tree, only case BB is applicable and the bound above gives twice the number of internal arcs, coinciding with the classic result on the size of the NNI neighborhood for phylogenetic trees. We note that rNNI moves around different arcs may result in the same network (see, e.g., <xref ref-type="fig" rid="pcbi.1005611.g009">Fig 9(i)</xref>), which means that if we consider one arc at a time and enumerate all networks that can be obtained with one rNNI move around that arc, we may end up listing the same network twice. An extreme case of this situation is given in the <xref ref-type="supplementary-material" rid="pcbi.1005611.s001">S1 Text</xref>, where we show a family of networks whose neighborhood has logarithmic size in the number of arcs, whereas the upper bound given above is linear in the number of arcs.</p>
<fig id="pcbi.1005611.g009" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005611.g009</object-id>
<label>Fig 9</label>
<caption>
<title>Reasons why the bound of Prop. 2 is not tight.</title>
<p>(i) rNNI moves around different arcs may give the same network: the rNNI type-(1) move (<italic>u</italic><sub>1</sub><italic>u</italic><sub>2</sub>, <italic>u</italic><sub>1</sub><italic>v</italic><sub>1</sub>, <italic>v</italic><sub>1</sub><italic>v</italic><sub>2</sub> → <italic>u</italic><sub>1</sub><italic>v</italic><sub>2</sub>, <italic>u</italic><sub>1</sub><italic>v</italic><sub>1</sub>, <italic>v</italic><sub>1</sub><italic>u</italic><sub>2</sub>) and the rNNI type-(2) move (<italic>u</italic><sub>1</sub><italic>u</italic><sub>2</sub>, <italic>u</italic><sub>2</sub><italic>v</italic><sub>2</sub>, <italic>v</italic><sub>1</sub><italic>v</italic><sub>2</sub> → <italic>u</italic><sub>1</sub><italic>v</italic><sub>2</sub>, <italic>u</italic><sub>2</sub><italic>v</italic><sub>2</sub>, <italic>v</italic><sub>1</sub><italic>u</italic><sub>2</sub>) on <italic>N</italic><sub>1</sub> both give the network <inline-formula id="pcbi.1005611.e022"><alternatives><graphic id="pcbi.1005611.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005611.e022" xlink:type="simple"/><mml:math display="inline" id="M22"><mml:msubsup><mml:mi>N</mml:mi> <mml:mn>1</mml:mn> <mml:mo>′</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula>. (ii) Some of the moves drawn in <xref ref-type="fig" rid="pcbi.1005611.g008">Fig 8</xref> are not viable rNNI moves: no move of type BR around arc <italic>vv</italic><sub>4</sub> of <italic>N</italic><sub>2</sub> is allowed, because of the presence of a <italic>v</italic><sub>1</sub>-<italic>v</italic><sub>3</sub> path, which would cause the resulting network to contain a cycle. (iii) The bound of Prop. 2 is tight for some networks: the size of the rNNI neighborhood of network <italic>N</italic><sub>3</sub>, equal to 12, coincides with the bound.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005611.g009" xlink:type="simple"/>
</fig>
<p>It may be difficult to derive the exact size of the rNNI neighborhood, unless important limitations on the structure of the network are imposed. For example, in the context of unrooted networks, Huber and colleagues derived an exact formula for the size of the NNI neighborhood (see Theorem 3 of [<xref ref-type="bibr" rid="pcbi.1005611.ref025">25</xref>]), but only for the restricted subclass of unrooted level-1 networks: distinguishing distinct cases for cycles of length 3 or 4 allows them to deal with cases such as the one of <xref ref-type="fig" rid="pcbi.1005611.g009">Fig 9(i)</xref>. However, on rooted networks, acyclicity constraints also need to be taken into account, and do not permit a simple formula even for level-1 networks, like <italic>N</italic><sub>2</sub> in <xref ref-type="fig" rid="pcbi.1005611.g009">Fig 9(ii)</xref>. Note that the upper bound of Proposition 2 is tight in some cases, e.g. for <italic>N</italic><sub>3</sub> of <xref ref-type="fig" rid="pcbi.1005611.g009">Fig 9(iii)</xref>, as detailed in <xref ref-type="supplementary-material" rid="pcbi.1005611.s001">S1 Text</xref>. Interestingly, <italic>N</italic><sub>2</sub> and <italic>N</italic><sub>3</sub> in <xref ref-type="fig" rid="pcbi.1005611.g009">Fig 9</xref> have the same underlying unrooted network, and the same values for <italic>e</italic><sub><italic>BB</italic></sub>, <italic>e</italic><sub><italic>BR</italic></sub>, <italic>e</italic><sub><italic>RB</italic></sub> and <italic>e</italic><sub><italic>RR</italic></sub>, yet different sizes of rNNI neighborhoods, showing that any exact formula for the size of the rNNI neighborhood must depend on parameters of the network other than those used here or by Huber et al. [<xref ref-type="bibr" rid="pcbi.1005611.ref025">25</xref>].</p>
</sec>
<sec id="sec007">
<title>Changing the network complexity</title>
<p>Both topological rearrangements defined above only permit the exploration of the set of networks of a fixed reticulate complexity, where the complexity of a phylogenetic network can be defined in any of the ways specified by Proposition 1. In some applications this may be sufficient, for example to tackle optimization problems where network reconstruction is constrained to networks with a prespecified number of reticulations. In many cases, however, one would like to be able to move across spaces of networks of different complexities, so that <italic>any</italic> two rooted binary networks are reachable from one another.</p>
<p>In order to do this, consider a pair of rearrangement moves <inline-formula id="pcbi.1005611.e023"><alternatives><graphic id="pcbi.1005611.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005611.e023" xlink:type="simple"/><mml:math display="inline" id="M23"><mml:msup><mml:mi mathvariant="script">C</mml:mi> <mml:mo>+</mml:mo></mml:msup></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1005611.e024"><alternatives><graphic id="pcbi.1005611.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005611.e024" xlink:type="simple"/><mml:math display="inline" id="M24"><mml:msup><mml:mi mathvariant="script">C</mml:mi> <mml:mo>−</mml:mo></mml:msup></mml:math></alternatives></inline-formula> with the following properties: <inline-formula id="pcbi.1005611.e025"><alternatives><graphic id="pcbi.1005611.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005611.e025" xlink:type="simple"/><mml:math display="inline" id="M25"><mml:msup><mml:mi mathvariant="script">C</mml:mi> <mml:mo>+</mml:mo></mml:msup></mml:math></alternatives></inline-formula> can transform any rooted binary network <italic>N</italic> on <italic>X</italic> into a number of rooted binary networks on <italic>X</italic> with a level of complexity immediately higher than <italic>N</italic> (i.e., the transformed network has one more reticulation and two more vertices). Conversely, <inline-formula id="pcbi.1005611.e026"><alternatives><graphic id="pcbi.1005611.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005611.e026" xlink:type="simple"/><mml:math display="inline" id="M26"><mml:msup><mml:mi mathvariant="script">C</mml:mi> <mml:mo>-</mml:mo></mml:msup></mml:math></alternatives></inline-formula> maps any rooted binary network <italic>N</italic> that is not a phylogenetic tree to some rooted binary networks on the same set of taxa, and with a level of complexity immediately lower than <italic>N</italic>. We call such a pair of rearrangement moves a <italic>complexity-changing rearrangement pair</italic>. It is easy to see that a number of natural rearrangement pairs can be defined. For example, <inline-formula id="pcbi.1005611.e027"><alternatives><graphic id="pcbi.1005611.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005611.e027" xlink:type="simple"/><mml:math display="inline" id="M27"><mml:msup><mml:mi mathvariant="script">C</mml:mi> <mml:mo>-</mml:mo></mml:msup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005611.e028"><alternatives><graphic id="pcbi.1005611.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005611.e028" xlink:type="simple"/><mml:math display="inline" id="M28"><mml:msup><mml:mi mathvariant="script">C</mml:mi> <mml:mo>+</mml:mo></mml:msup></mml:math></alternatives></inline-formula> can be defined as arc removals (see the <xref ref-type="sec" rid="sec002">Methods</xref>) and arc insertions, respectively, or as rooted versions of the Δ<sup>−</sup> and Δ<sup>+</sup> moves by Huber et al. [<xref ref-type="bibr" rid="pcbi.1005611.ref026">26</xref>]. Precise definitions will be given below. The following proposition is a direct consequence of Theorem 3.</p>
<p><bold>Proposition 3.</bold> <italic>Let</italic> <inline-formula id="pcbi.1005611.e029"><alternatives><graphic id="pcbi.1005611.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005611.e029" xlink:type="simple"/><mml:math display="inline" id="M29"><mml:msup><mml:mi mathvariant="script">C</mml:mi><mml:mo>+</mml:mo></mml:msup></mml:math></alternatives></inline-formula> <italic>and</italic> <inline-formula id="pcbi.1005611.e030"><alternatives><graphic id="pcbi.1005611.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005611.e030" xlink:type="simple"/><mml:math display="inline" id="M30"><mml:msup><mml:mi mathvariant="script">C</mml:mi><mml:mo>-</mml:mo></mml:msup></mml:math></alternatives></inline-formula> <italic>be a complexity-changing rearrangement pair. If N</italic><sub>1</sub> <italic>and N</italic><sub>2</sub> <italic>are rooted binary networks on X, then there exist: (1) a sequence of rNNI and</italic> <inline-formula id="pcbi.1005611.e031">
<alternatives>
<graphic id="pcbi.1005611.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005611.e031" xlink:type="simple"/>
<mml:math display="inline" id="M31">
<mml:msup>
<mml:mi mathvariant="script">C</mml:mi>
<mml:mo>+</mml:mo>
</mml:msup>
</mml:math>
</alternatives>
</inline-formula> <italic>moves connecting N</italic><sub>1</sub> <italic>and</italic> <italic>N</italic><sub>2</sub> <italic>and (2) a sequence of rNNI and</italic> <inline-formula id="pcbi.1005611.e032">
<alternatives>
<graphic id="pcbi.1005611.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005611.e032" xlink:type="simple"/>
<mml:math display="inline" id="M32">
<mml:msup>
<mml:mi mathvariant="script">C</mml:mi>
<mml:mo>-</mml:mo>
</mml:msup>
</mml:math>
</alternatives>
</inline-formula> <italic>moves connecting N</italic><sub>1</sub> <italic>and N</italic><sub>2</sub>.</p>
<p><italic>Proof</italic>. Without loss of generality, let <italic>N</italic><sub>1</sub> have fewer reticulations than <italic>N</italic><sub>2</sub> (or the same number). One can transform <italic>N</italic><sub>1</sub> into <italic>N</italic><sub>2</sub> by applying <inline-formula id="pcbi.1005611.e033"><alternatives><graphic id="pcbi.1005611.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005611.e033" xlink:type="simple"/><mml:math display="inline" id="M33"><mml:msup><mml:mi mathvariant="script">C</mml:mi> <mml:mo>+</mml:mo></mml:msup></mml:math></alternatives></inline-formula> moves until obtaining a network with the same number of reticulations as <italic>N</italic><sub>2</sub>, which then, thanks to Theorem 3, can be turned into <italic>N</italic><sub>2</sub> using only rNNI moves. In the same way, <italic>N</italic><sub>2</sub> can be transformed into <italic>N</italic><sub>1</sub> by using <inline-formula id="pcbi.1005611.e034"><alternatives><graphic id="pcbi.1005611.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005611.e034" xlink:type="simple"/><mml:math display="inline" id="M34"><mml:msup><mml:mi mathvariant="script">C</mml:mi> <mml:mo>-</mml:mo></mml:msup></mml:math></alternatives></inline-formula> moves until obtaining a network with the same complexity as <italic>N</italic><sub>1</sub>, followed by rNNI moves.</p>
<p>Note that the proposition above makes very few assumptions on the chosen complexity-changing rearrangement pair. Namely, it holds even if <inline-formula id="pcbi.1005611.e035"><alternatives><graphic id="pcbi.1005611.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005611.e035" xlink:type="simple"/><mml:math display="inline" id="M35"><mml:msup><mml:mi mathvariant="script">C</mml:mi> <mml:mo>+</mml:mo></mml:msup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005611.e036"><alternatives><graphic id="pcbi.1005611.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005611.e036" xlink:type="simple"/><mml:math display="inline" id="M36"><mml:msup><mml:mi mathvariant="script">C</mml:mi> <mml:mo>-</mml:mo></mml:msup></mml:math></alternatives></inline-formula> are not the reverse of each other, which could happen for example if we define <inline-formula id="pcbi.1005611.e037"><alternatives><graphic id="pcbi.1005611.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005611.e037" xlink:type="simple"/><mml:math display="inline" id="M37"><mml:msup><mml:mi mathvariant="script">C</mml:mi> <mml:mo>+</mml:mo></mml:msup></mml:math></alternatives></inline-formula> so that it maps every network with <italic>r</italic> reticulations to the same single network with <italic>r</italic> + 1 reticulations. However these kinds of moves are unlikely to have any relevance in practice.</p>
<p>As an example of a realistic complexity-changing rearrangement pair, consider defining <inline-formula id="pcbi.1005611.e038"><alternatives><graphic id="pcbi.1005611.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005611.e038" xlink:type="simple"/><mml:math display="inline" id="M38"><mml:msup><mml:mi mathvariant="script">C</mml:mi> <mml:mo>-</mml:mo></mml:msup></mml:math></alternatives></inline-formula> as the arc removals that do not create parallel arcs, and <inline-formula id="pcbi.1005611.e039"><alternatives><graphic id="pcbi.1005611.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005611.e039" xlink:type="simple"/><mml:math display="inline" id="M39"><mml:msup><mml:mi mathvariant="script">C</mml:mi> <mml:mo>+</mml:mo></mml:msup></mml:math></alternatives></inline-formula> as their reverse operation. We refer to such <inline-formula id="pcbi.1005611.e040"><alternatives><graphic id="pcbi.1005611.e040g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005611.e040" xlink:type="simple"/><mml:math display="inline" id="M40"><mml:msup><mml:mi mathvariant="script">C</mml:mi> <mml:mo>+</mml:mo></mml:msup></mml:math></alternatives></inline-formula> moves as <italic>arc insertions</italic>. They simply consist of choosing two distinct arcs <italic>a</italic>, <italic>a</italic>′ in the network—with <italic>a</italic>′ not ancestral to <italic>a</italic>—followed by creating two new vertices <italic>u</italic>, <italic>v</italic> that subdivide <italic>a</italic> and <italic>a</italic>′, respectively, and finally by adding a new arc <italic>uv</italic>. A variation of arc insertion was first proposed by Jin et al. [<xref ref-type="bibr" rid="pcbi.1005611.ref034">34</xref>], where further constraints are imposed on the arcs <italic>a</italic>, <italic>a</italic>′ that can be connected.</p>
<p><bold>Proposition 4.</bold> <italic>Let N</italic><sup>−</sup> <italic>and N</italic><sup>+</sup> <italic>be binary rooted networks. N</italic><sup>+</sup> <italic>can be obtained by performing an arc insertion on N</italic><sup>−</sup> <italic>if and only if N</italic><sup>−</sup> <italic>can be obtained by performing an arc removal on N</italic><sup>+</sup>.</p>
<p><italic>Proof</italic>. If <italic>N</italic><sup>+</sup> is obtained from <italic>N</italic><sup>−</sup> by inserting arc <italic>uv</italic>, then clearly <italic>u</italic> is a bifurcation and <italic>v</italic> is a reticulation. We can then apply an arc removal to <italic>uv</italic> to obtain <italic>N</italic><sup>−</sup> from <italic>N</italic><sup>+</sup>. If <italic>N</italic><sup>−</sup> is obtained from <italic>N</italic><sup>+</sup> by removing arc <italic>uv</italic>, then let <italic>a</italic> and <italic>a</italic>′ be the arcs in <italic>N</italic><sup>−</sup> that replace <italic>u</italic> and <italic>v</italic>, respectively. Clearly, <italic>a</italic>′ cannot be ancestral to <italic>a</italic>, as otherwise there would be a <italic>v</italic>-<italic>u</italic> path in <italic>N</italic><sup>+</sup>, which would make it contain a cycle. Applying an arc insertion between <italic>a</italic> and <italic>a</italic>′ in <italic>N</italic><sup>−</sup>, which amounts to re-inserting <italic>uv</italic> in <italic>N</italic><sup>−</sup>, results in <italic>N</italic><sup>+</sup>.</p>
<p>Another example of complexity-changing rearrangement pair can be given by adapting to the rooted case the Δ<sup>+</sup> and Δ<sup>−</sup> moves defined by Huber et al. [<xref ref-type="bibr" rid="pcbi.1005611.ref026">26</xref>] for unrooted networks: we simply define a rooted Δ<sup>+</sup> move as an arc insertion (as defined above) between two arcs <italic>a</italic>, <italic>a</italic>′ that are incident. Its reverse, the rooted Δ<sup>−</sup> move, is any arc removal that is applied to an arc whose endpoints are separated by two incident arcs. In the same way as rNNI moves can be seen as “local” rSPR moves, the Δ<sup>+</sup> and Δ<sup>−</sup> moves are “local” arc insertions and arc removals.</p>
</sec>
</sec>
<sec id="sec008" sec-type="conclusions">
<title>Discussion</title>
<p>In this paper, we have generalized to rooted phylogenetic networks the best-known tree rearrangement moves: <italic>nearest neighbor interchange</italic> (NNI) and <italic>subtree pruning and regrafting</italic> (SPR). The new moves, which we call rNNI and rSPR, transform a network of a given reticulate complexity into another network of the same complexity, and they guarantee that every network of a given complexity is reachable from every other network of the same complexity, within a finite number of moves (Theorem 3).</p>
<p>Here, reticulate complexity is measured in terms of number of reticulations, or, equivalently, number of vertices in the network. This measure of complexity is the one that most closely models the “explanatory power” of a network, as it is often directly related to the number of free parameters in a network model (e.g., branch lengths and inheritance proportions at each reticulation [<xref ref-type="bibr" rid="pcbi.1005611.ref028">28</xref>]). We note that another measure of complexity is often adopted in the computational phylogenetics literature: the <italic>level</italic> of the network [<xref ref-type="bibr" rid="pcbi.1005611.ref035">35</xref>, <xref ref-type="bibr" rid="pcbi.1005611.ref036">36</xref>]. This measure, however, essentially has a motivation in terms of computational complexity, rather than in terms of ability to fit the data. It is related to the algorithmic efficiency of solving some fundamental problems on the network—most notably, for the purposes of this paper, that of evaluating a network under a number of optimization criteria (e.g. [<xref ref-type="bibr" rid="pcbi.1005611.ref034">34</xref>, <xref ref-type="bibr" rid="pcbi.1005611.ref037">37</xref>]).</p>
<p>Another choice we have made in this paper is to not allow multi-edges, or parallel arcs, in the networks we consider, on the assumption that they are difficult to reconstruct from real data. In a number of applications, this may not be true [<xref ref-type="bibr" rid="pcbi.1005611.ref038">38</xref>, <xref ref-type="bibr" rid="pcbi.1005611.ref039">39</xref>]. The rearrangement moves that we define here are easy to adapt so that they can deal with networks containing parallel arcs: for example, in the definition of rSPR moves, it suffices to remove the condition that “none of <italic>x</italic>′<italic>z</italic>, <italic>zy</italic>′ and <italic>xy</italic> is an arc of <italic>N</italic>” (which immediately also determines a definition of rNNI as rSPR<sub>1</sub>).</p>
<p>In addition to the “horizontal” moves above, which enable full exploration of a layer of networks of fixed complexity, this paper also provides the basic ideas on how to switch across spaces of networks of different complexities, via “complexity-changing” or “vertical” moves. Although very little assumptions on vertical moves are needed if we only wish to ensure reachability of any network from any other network (Proposition 3), it is likely that in practice the choice of adequate vertical moves will be important.</p>
<p>In practical search heuristics, it seems reasonable to only increase the complexity of a candidate network (via a vertical move) once a layer of networks of equal complexity has been sufficiently explored via horizontal moves. If we follow this guideline, then the obvious way to proceed would be to first look for the best tree with respect to the data and the chosen optimization criterion, then the best network with one reticulation, then the best network with two reticulations, and so on. This is indeed a common approach in practice [<xref ref-type="bibr" rid="pcbi.1005611.ref019">19</xref>, <xref ref-type="bibr" rid="pcbi.1005611.ref029">29</xref>, <xref ref-type="bibr" rid="pcbi.1005611.ref034">34</xref>, <xref ref-type="bibr" rid="pcbi.1005611.ref040">40</xref>], and produces a list of networks of increasing complexity and fit to the data. In order to choose between these networks, techniques for model selection are often advocated: for example the Akaike (AIC) or the Bayesian information criterion (BIC) [<xref ref-type="bibr" rid="pcbi.1005611.ref024">24</xref>, <xref ref-type="bibr" rid="pcbi.1005611.ref028">28</xref>, <xref ref-type="bibr" rid="pcbi.1005611.ref029">29</xref>], or nonparametric techniques such as cross-validation [<xref ref-type="bibr" rid="pcbi.1005611.ref024">24</xref>]. The fact that our horizontal and complexity-increasing moves <inline-formula id="pcbi.1005611.e041"><alternatives><graphic id="pcbi.1005611.e041g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005611.e041" xlink:type="simple"/><mml:math display="inline" id="M41"><mml:msup><mml:mi mathvariant="script">C</mml:mi> <mml:mo>+</mml:mo></mml:msup></mml:math></alternatives></inline-formula> are enough to go from any starting tree to any network (Proposition 3) provides a theoretical basis for this approach: no network inferred early on in the list precludes the inference of another network at a later stage.</p>
<p>Another aspect that deserves to be discussed is the locality of the proposed rearrangement moves. Clearly, rNNI and rSPR moves provide different degrees of locality for horizontal moves, and Δ<sup>+</sup>/Δ<sup>−</sup> moves and arc insertions/removals do the same for vertical moves. Recall that the neighborhood of a network <italic>N</italic> with respect to a rearrangement move is the set of networks that can be reached with one move from <italic>N</italic>. Choosing moves that are less local implies increasing the sizes of the neighborhoods, which means fewer local optima, thus potentially more accurate reconstructions. On the other hand, local moves are often considered to lead to fewer computations, as fewer neighbors need to be considered at each iteration of the search heuristic; this is counterbalanced by the fact that, typically, more iterations are needed to find an optimum (see Corollary 1). In practice adapting the degree of locality is a question of craftsmanship, and the best practices may be context-dependent. For example, the locality of the moves can change during the search, typically increasing with later iterations. Interestingly, the fact that rNNI moves can be seen as rSPR<sub>1</sub> moves immediately suggests that several intermediate degrees of locality can be achieved by defining rSPR<sub><italic>k</italic></sub> moves allowing a maximum distance <italic>k</italic> between the recipient and the donor arcs in an rSPR. Similarly, vertical moves that are intermediate between Δ<sup>+</sup>/Δ<sup>−</sup> moves and arc insertions/removals can be defined by bounding the distance between the endponts of the arc being inserted/removed.</p>
<p>Our work provides a theoretical basis to analyse the search strategy implemented in the most popular program for network reconstruction, PhyloNet [<xref ref-type="bibr" rid="pcbi.1005611.ref041">41</xref>]. In the implementation described by Yu et al. [<xref ref-type="bibr" rid="pcbi.1005611.ref024">24</xref>], the search proceeds by randomly generating networks produced by horizontal or vertical moves that are at the non-local end of the spectrum of the moves described here (they are essentially equivalent to rSPR moves and arc insertions/removals, although parallel arcs seem to be allowed there). Note that horizontal and vertical moves can occur during the search in any order. Our results imply that PhyloNet is able to reach any binary rooted network from any other binary rooted network—unsurprisingly, given the large size of the neighborhoods considered in its search. Proposition 3 shows that in fact reachability can be assured even under much more local moves. Future work on practical heuristics for network reconstruction will be likely inspired by common practices for tree reconstruction implemented by popular software such as PhyML [<xref ref-type="bibr" rid="pcbi.1005611.ref042">42</xref>] and RAxML [<xref ref-type="bibr" rid="pcbi.1005611.ref043">43</xref>]. In particular, it should be possible to speed up the evaluation (i.e. the calculation of the optimization score) of the networks in the neighborhood of a network that has already been evaluated, by identifying the parts of the computation that do not need to be repeated.</p>
<p>Another direction for future research is to constrain horizontal rearrangement moves so as to preserve not only reticulate complexity, but also the level of the network. Given that the level is often related to the computational complexity of computing the optimization score of a network (e.g., for parsimony [<xref ref-type="bibr" rid="pcbi.1005611.ref037">37</xref>], and for likelihood [<xref ref-type="bibr" rid="pcbi.1005611.ref034">34</xref>]), it would be useful to keep the level bounded during the local search. An interesting open question is to determine the maximum level reached by intermediate networks when transforming a level-<italic>k</italic> network into another level-<italic>k</italic> network with the same number of reticulations via rNNI moves or rSPR moves. An advantage of rSPR moves is that, given the larger sizes of their neighborhoods, they may be able to to avoid high-level intermediate networks.</p>
<p>Finally, in this paper we have not tackled natural questions related to the metrics induced by the moves defined here—such as the maximum distance between networks—which for trees have been studied in depth [<xref ref-type="bibr" rid="pcbi.1005611.ref030">30</xref>, <xref ref-type="bibr" rid="pcbi.1005611.ref044">44</xref>–<xref ref-type="bibr" rid="pcbi.1005611.ref046">46</xref>]. From an algorithmic standpoint, we remark that because our rNNI and rSPR distances reduce to well-known distances on phylogenetic trees, all the known hardness results on computing such distances on trees extend to our distances [<xref ref-type="bibr" rid="pcbi.1005611.ref032">32</xref>, <xref ref-type="bibr" rid="pcbi.1005611.ref047">47</xref>].</p>
</sec>
<sec id="sec009">
<title>Supporting information</title>
<supplementary-material id="pcbi.1005611.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005611.s001" xlink:type="simple">
<label>S1 Text</label>
<caption>
<title>Supporting information: Proofs omitted from the main text.</title>
<p>This document provides the proofs of Lemmas 2, 3, 5, Theorem 4, and Proposition 2. It ends with a few remarks on the size of rNNI neighborhoods.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="pcbi.1005611.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Doolittle</surname> <given-names>WF</given-names></name>. <article-title>Phylogenetic Classification and the Universal Tree</article-title>. <source>Science</source>. <year>1999</year>;<volume>284</volume>:<fpage>2124</fpage>–<lpage>2128</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.284.5423.2124" xlink:type="simple">10.1126/science.284.5423.2124</ext-link></comment> <object-id pub-id-type="pmid">10381871</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005611.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bapteste</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>van Iersel</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Janke</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Kelchner</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Kelk</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>McInerney</surname> <given-names>JO</given-names></name>, <etal>et al</etal>. <article-title>Networks: expanding evolutionary thinking</article-title>. <source>Trends in Genetics</source>. <year>2013</year>;<volume>29</volume>(<issue>8</issue>):<fpage>439</fpage>–<lpage>441</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.tig.2013.05.007" xlink:type="simple">10.1016/j.tig.2013.05.007</ext-link></comment> <object-id pub-id-type="pmid">23764187</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005611.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mallet</surname> <given-names>J</given-names></name>. <article-title>Hybrid speciation</article-title>. <source>Nature</source>. <year>2007</year>;<volume>446</volume>(<issue>7133</issue>):<fpage>279</fpage>–<lpage>283</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature05706" xlink:type="simple">10.1038/nature05706</ext-link></comment> <object-id pub-id-type="pmid">17361174</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005611.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Nolte</surname> <given-names>AW</given-names></name>, <name name-style="western"><surname>Tautz</surname> <given-names>D</given-names></name>. <article-title>Understanding the onset of hybrid speciation</article-title>. <source>Trends in Genetics</source>. <year>2010</year>;<volume>26</volume>(<issue>2</issue>):<fpage>54</fpage>–<lpage>58</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.tig.2009.12.001" xlink:type="simple">10.1016/j.tig.2009.12.001</ext-link></comment> <object-id pub-id-type="pmid">20044166</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005611.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Abbott</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Albach</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Ansell</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Arntzen</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Baird</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Bierne</surname> <given-names>N</given-names></name>, <etal>et al</etal>. <article-title>Hybridization and speciation</article-title>. <source>Journal of Evolutionary Biology</source>. <year>2013</year>;<volume>26</volume>(<issue>2</issue>):<fpage>229</fpage>–<lpage>246</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/j.1420-9101.2012.02599.x" xlink:type="simple">10.1111/j.1420-9101.2012.02599.x</ext-link></comment> <object-id pub-id-type="pmid">23323997</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005611.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Patterson</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Moorjani</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Luo</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Mallick</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Rohland</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Zhan</surname> <given-names>Y</given-names></name>, <etal>et al</etal>. <article-title>Ancient admixture in human history</article-title>. <source>Genetics</source>. <year>2012</year>;<volume>192</volume>(<issue>3</issue>):<fpage>1065</fpage>–<lpage>1093</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1534/genetics.112.145037" xlink:type="simple">10.1534/genetics.112.145037</ext-link></comment> <object-id pub-id-type="pmid">22960212</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005611.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pickrell</surname> <given-names>JK</given-names></name>, <name name-style="western"><surname>Pritchard</surname> <given-names>JK</given-names></name>. <article-title>Inference of population splits and mixtures from genome-wide allele frequency data</article-title>. <source>PLoS Genet</source>. <year>2012</year>;<volume>8</volume>(<issue>11</issue>):<fpage>e1002967</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pgen.1002967" xlink:type="simple">10.1371/journal.pgen.1002967</ext-link></comment> <object-id pub-id-type="pmid">23166502</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005611.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mallick</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Lipson</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Mathieson</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Gymrek</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Racimo</surname> <given-names>F</given-names></name>, <etal>et al</etal>. <article-title>The Simons Genome Diversity Project: 300 genomes from 142 diverse populations</article-title>. <source>Nature</source>. <year>2016</year>;<volume>538</volume>(<issue>7624</issue>):<fpage>201</fpage>–<lpage>206</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature18964" xlink:type="simple">10.1038/nature18964</ext-link></comment> <object-id pub-id-type="pmid">27654912</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005611.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Boto</surname> <given-names>L</given-names></name>. <article-title>Horizontal gene transfer in evolution: facts and challenges</article-title>. <source>Proceedings of the Royal Society B: Biological Sciences</source>. <year>2010</year>;<volume>277</volume>(<issue>1683</issue>):<fpage>819</fpage>–<lpage>827</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rspb.2009.1679" xlink:type="simple">10.1098/rspb.2009.1679</ext-link></comment> <object-id pub-id-type="pmid">19864285</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005611.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hotopp</surname> <given-names>JCD</given-names></name>. <article-title>Horizontal gene transfer between bacteria and animals</article-title>. <source>Trends in Genetics</source>. <year>2011</year>;<volume>27</volume>(<issue>4</issue>):<fpage>157</fpage>–<lpage>163</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.tig.2011.01.005" xlink:type="simple">10.1016/j.tig.2011.01.005</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005611.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zhaxybayeva</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Doolittle</surname> <given-names>WF</given-names></name>. <article-title>Lateral gene transfer</article-title>. <source>Current Biology</source>. <year>2011</year>;<volume>21</volume>(<issue>7</issue>):<fpage>R242</fpage>–<lpage>R246</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.cub.2011.01.045" xlink:type="simple">10.1016/j.cub.2011.01.045</ext-link></comment> <object-id pub-id-type="pmid">21481756</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005611.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Posada</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Crandall</surname> <given-names>KA</given-names></name>, <name name-style="western"><surname>Holmes</surname> <given-names>EC</given-names></name>. <article-title>Recombination in evolutionary genomics</article-title>. <source>Annual Review of Genetics</source>. <year>2002</year>;<volume>36</volume>(<issue>1</issue>):<fpage>75</fpage>–<lpage>97</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1146/annurev.genet.36.040202.111115" xlink:type="simple">10.1146/annurev.genet.36.040202.111115</ext-link></comment> <object-id pub-id-type="pmid">12429687</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005611.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Vuilleumier</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Bonhoeffer</surname> <given-names>S</given-names></name>. <article-title>Contribution of recombination to the evolutionary history of HIV</article-title>. <source>Current Opinion in HIV and AIDS</source>. <year>2015</year>;<volume>10</volume>(<issue>2</issue>):<fpage>84</fpage>–<lpage>89</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1097/COH.0000000000000137" xlink:type="simple">10.1097/COH.0000000000000137</ext-link></comment> <object-id pub-id-type="pmid">25565174</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005611.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rasmussen</surname> <given-names>MD</given-names></name>, <name name-style="western"><surname>Hubisz</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Gronau</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Siepel</surname> <given-names>A</given-names></name>. <article-title>Genome-wide inference of ancestral recombination graphs</article-title>. <source>PLoS Genetics</source>. <year>2014</year>;<volume>10</volume>(<issue>5</issue>):<fpage>e1004342</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pgen.1004342" xlink:type="simple">10.1371/journal.pgen.1004342</ext-link></comment> <object-id pub-id-type="pmid">24831947</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005611.ref015">
<label>15</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Huson</surname> <given-names>DH</given-names></name>, <name name-style="western"><surname>Rupp</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Scornavacca</surname> <given-names>C</given-names></name>. <source>Phylogenetic networks: concepts, algorithms and applications</source>. <publisher-name>Cambridge University Press</publisher-name>; <year>2010</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005611.ref016">
<label>16</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Morrison</surname> <given-names>DA</given-names></name>. <source>Introduction to Phylogenetic Networks</source>. <publisher-name>RJR Productions</publisher-name>; <year>2011</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005611.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bryant</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Moulton</surname> <given-names>V</given-names></name>. <article-title>Neighbor-net: an agglomerative method for the construction of phylogenetic networks</article-title>. <source>Molecular Biology and Evolution</source>. <year>2004</year>;<volume>21</volume>(<issue>2</issue>):<fpage>255</fpage>–<lpage>265</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/molbev/msh018" xlink:type="simple">10.1093/molbev/msh018</ext-link></comment> <object-id pub-id-type="pmid">14660700</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005611.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Huson</surname> <given-names>DH</given-names></name>, <name name-style="western"><surname>Scornavacca</surname> <given-names>C</given-names></name>. <article-title>A survey of combinatorial methods for phylogenetic networks</article-title>. <source>Genome Biology and Evolution</source>. <year>2011</year>;<volume>3</volume>:<fpage>23</fpage>–<lpage>35</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/gbe/evq077" xlink:type="simple">10.1093/gbe/evq077</ext-link></comment> <object-id pub-id-type="pmid">21081312</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005611.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yu</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Nakhleh</surname> <given-names>L</given-names></name>. <article-title>A maximum pseudo-likelihood approach for phylogenetic networks</article-title>. <source>BMC Genomics</source>. <year>2015</year>;<volume>16</volume>(<issue>10</issue>):<fpage>1</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005611.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Solís-Lemus</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Ané</surname> <given-names>C</given-names></name>. <article-title>Inferring phylogenetic networks with maximum pseudolikelihood under incomplete lineage sorting</article-title>. <source>PLoS Genetics</source>. <year>2016</year>;<volume>12</volume>(<issue>3</issue>):<fpage>e1005896</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pgen.1005896" xlink:type="simple">10.1371/journal.pgen.1005896</ext-link></comment> <object-id pub-id-type="pmid">26950302</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005611.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Camin</surname> <given-names>JH</given-names></name>, <name name-style="western"><surname>Sokal</surname> <given-names>RR</given-names></name>. <article-title>A method for deducing branching sequences in phylogeny</article-title>. <source>Evolution</source>. <year>1965</year>; p. <fpage>311</fpage>–<lpage>326</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.2307/2406441" xlink:type="simple">10.2307/2406441</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005611.ref022">
<label>22</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Swofford</surname> <given-names>DL</given-names></name>, <name name-style="western"><surname>Olsen</surname> <given-names>GJ</given-names></name>, <name name-style="western"><surname>Waddell</surname> <given-names>PJ</given-names></name>, <name name-style="western"><surname>Hillis</surname> <given-names>DM</given-names></name>. <chapter-title>Phylogenetic inference</chapter-title>. In: <name name-style="western"><surname>Hillis</surname> <given-names>DM</given-names></name>, <name name-style="western"><surname>Moritz</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Mable</surname> <given-names>B</given-names></name>, editors. <source>Molecular systematics</source>, <edition>2nd edn</edition>. <publisher-name>Sinauer Associates Inc.</publisher-name>; <year>1996</year>. p. <fpage>407</fpage>–<lpage>514</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005611.ref023">
<label>23</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Felsenstein</surname> <given-names>J</given-names></name>. <source>Inferring phylogenies</source>. <publisher-name>Sinauer Associates</publisher-name> <publisher-loc>Sunderland</publisher-loc>; <year>2004</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005611.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yu</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Dong</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Liu</surname> <given-names>KJ</given-names></name>, <name name-style="western"><surname>Nakhleh</surname> <given-names>L</given-names></name>. <article-title>Maximum likelihood inference of reticulate evolutionary histories</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2014</year>;<volume>111</volume>(<issue>46</issue>):<fpage>16448</fpage>–<lpage>16453</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1407950111" xlink:type="simple">10.1073/pnas.1407950111</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005611.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Huber</surname> <given-names>KT</given-names></name>, <name name-style="western"><surname>Linz</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Moulton</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Wu</surname> <given-names>T</given-names></name>. <article-title>Spaces of phylogenetic networks from generalized nearest-neighbor interchange operations</article-title>. <source>Journal of Mathematical Biology</source>. <year>2016</year>;<volume>72</volume>(<issue>3</issue>):<fpage>699</fpage>–<lpage>725</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s00285-015-0899-7" xlink:type="simple">10.1007/s00285-015-0899-7</ext-link></comment> <object-id pub-id-type="pmid">26037483</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005611.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Huber</surname> <given-names>KT</given-names></name>, <name name-style="western"><surname>Moulton</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Wu</surname> <given-names>T</given-names></name>. <article-title>Transforming phylogenetic networks: Moving beyond tree space</article-title>. <source>Journal of Theoretical Biology</source>. <year>2016</year>;<volume>404</volume>:<fpage>30</fpage>–<lpage>39</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jtbi.2016.05.030" xlink:type="simple">10.1016/j.jtbi.2016.05.030</ext-link></comment> <object-id pub-id-type="pmid">27224010</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005611.ref027">
<label>27</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Nakhleh</surname> <given-names>L</given-names></name>. <chapter-title>Evolutionary phylogenetic networks: models and issues</chapter-title>. In: <source>Problem solving handbook in computational biology and bioinformatics</source>. <publisher-name>Springer</publisher-name>; <year>2010</year>. p. <fpage>125</fpage>–<lpage>158</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005611.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kubatko</surname> <given-names>LS</given-names></name>. <article-title>Identifying hybridization events in the presence of coalescence via model selection</article-title>. <source>Systematic Biology</source>. <year>2009</year>;<volume>58</volume>(<issue>5</issue>):<fpage>478</fpage>–<lpage>488</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/sysbio/syp055" xlink:type="simple">10.1093/sysbio/syp055</ext-link></comment> <object-id pub-id-type="pmid">20525602</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005611.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Park</surname> <given-names>HJ</given-names></name>, <name name-style="western"><surname>Nakhleh</surname> <given-names>L</given-names></name>. <article-title>Inference of reticulate evolutionary histories by maximum likelihood: the performance of information criteria</article-title>. <source>BMC Bioinformatics</source>. <year>2012</year>;<volume>13</volume>(<issue>Suppl 19</issue>):<fpage>S12</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005611.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Robinson</surname> <given-names>DF</given-names></name>. <article-title>Comparison of labeled trees with valency three</article-title>. <source>Journal of Combinatorial Theory, Series B</source>. <year>1971</year>;<volume>11</volume>(<issue>2</issue>):<fpage>105</fpage>–<lpage>119</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/0095-8956(71)90020-7" xlink:type="simple">10.1016/0095-8956(71)90020-7</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005611.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Baroni</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Grünewald</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Moulton</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Semple</surname> <given-names>C</given-names></name>. <article-title>Bounding the number of hybridisation events for a consistent evolutionary history</article-title>. <source>Journal of Mathematical Biology</source>. <year>2005</year>;<volume>51</volume>(<issue>2</issue>):<fpage>171</fpage>–<lpage>182</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s00285-005-0315-9" xlink:type="simple">10.1007/s00285-005-0315-9</ext-link></comment> <object-id pub-id-type="pmid">15868201</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005611.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bordewich</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Semple</surname> <given-names>C</given-names></name>. <article-title>On the computational complexity of the rooted subtree prune and regraft distance</article-title>. <source>Annals of Combinatorics</source>. <year>2005</year>;<volume>8</volume>(<issue>4</issue>):<fpage>409</fpage>–<lpage>423</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s00026-004-0229-z" xlink:type="simple">10.1007/s00026-004-0229-z</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005611.ref033">
<label>33</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Semple</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Steel</surname> <given-names>M</given-names></name>. <source>Phylogenetics</source>. <publisher-name>Oxford University Press</publisher-name>, <publisher-loc>Oxford</publisher-loc>; <year>2003</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005611.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Jin</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Nakhleh</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Snir</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Tuller</surname> <given-names>T</given-names></name>. <article-title>Maximum likelihood of phylogenetic networks</article-title>. <source>Bioinformatics</source>. <year>2006</year>;<volume>22</volume>(<issue>21</issue>):<fpage>2604</fpage>–<lpage>2611</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btl452" xlink:type="simple">10.1093/bioinformatics/btl452</ext-link></comment> <object-id pub-id-type="pmid">16928736</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005611.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Choy</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Jansson</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Sadakane</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Sung</surname> <given-names>WK</given-names></name>. <article-title>Computing the maximum agreement of phylogenetic networks</article-title>. <source>Theoretical Computer Science</source>. <year>2005</year>;<volume>335</volume>(<issue>1</issue>):<fpage>93</fpage>–<lpage>107</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.tcs.2004.12.012" xlink:type="simple">10.1016/j.tcs.2004.12.012</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005611.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Jansson</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Sung</surname> <given-names>WK</given-names></name>. <article-title>Inferring a level-1 phylogenetic network from a dense set of rooted triplets</article-title>. <source>Theoretical Computer Science</source>. <year>2006</year>;<volume>363</volume>(<issue>1</issue>):<fpage>60</fpage>–<lpage>68</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.tcs.2006.06.022" xlink:type="simple">10.1016/j.tcs.2006.06.022</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005611.ref037">
<label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Fischer</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Van Iersel</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Kelk</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Scornavacca</surname> <given-names>C</given-names></name>. <article-title>On computing the maximum parsimony score of a phylogenetic network</article-title>. <source>SIAM Journal on Discrete Mathematics</source>. <year>2015</year>;<volume>29</volume>(<issue>1</issue>):<fpage>559</fpage>–<lpage>585</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1137/140959948" xlink:type="simple">10.1137/140959948</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005611.ref038">
<label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pardi</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Scornavacca</surname> <given-names>C</given-names></name>. <article-title>Reconstructible phylogenetic networks: Do not distinguish the indistinguishable</article-title>. <source>PLoS Computational Biology</source>. <year>2015</year>;<volume>11</volume>(<issue>4</issue>):<fpage>e1004135</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1004135" xlink:type="simple">10.1371/journal.pcbi.1004135</ext-link></comment> <object-id pub-id-type="pmid">25849429</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005611.ref039">
<label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zhu</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Degnan</surname> <given-names>JH</given-names></name>. <article-title>Displayed Trees Do Not Determine Distinguishability Under the Network Multispecies Coalescent</article-title>. <source>Systematic Biology</source>. <year>2017</year>;</mixed-citation>
</ref>
<ref id="pcbi.1005611.ref040">
<label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Jin</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Nakhleh</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Snir</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Tuller</surname> <given-names>T</given-names></name>. <article-title>Inferring phylogenetic networks by the maximum parsimony criterion: a case study</article-title>. <source>Molecular Biology and Evolution</source>. <year>2007</year>;<volume>24</volume>(<issue>1</issue>):<fpage>324</fpage>–<lpage>337</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/molbev/msl163" xlink:type="simple">10.1093/molbev/msl163</ext-link></comment> <object-id pub-id-type="pmid">17068107</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005611.ref041">
<label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Than</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Ruths</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Nakhleh</surname> <given-names>L</given-names></name>. <article-title>PhyloNet: a software package for analyzing and reconstructing reticulate evolutionary relationships</article-title>. <source>BMC bioinformatics</source>. <year>2008</year>;<volume>9</volume>(<issue>1</issue>):<fpage>322</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2105-9-322" xlink:type="simple">10.1186/1471-2105-9-322</ext-link></comment> <object-id pub-id-type="pmid">18662388</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005611.ref042">
<label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Guindon</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Dufayard</surname> <given-names>JF</given-names></name>, <name name-style="western"><surname>Lefort</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Anisimova</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Hordijk</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Gascuel</surname> <given-names>O</given-names></name>. <article-title>New algorithms and methods to estimate maximum-likelihood phylogenies: assessing the performance of PhyML 3.0</article-title>. <source>Systematic Biology</source>. <year>2010</year>;<volume>59</volume>(<issue>3</issue>):<fpage>307</fpage>–<lpage>321</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/sysbio/syq010" xlink:type="simple">10.1093/sysbio/syq010</ext-link></comment> <object-id pub-id-type="pmid">20525638</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005611.ref043">
<label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Stamatakis</surname> <given-names>A</given-names></name>. <article-title>RAxML version 8: a tool for phylogenetic analysis and post-analysis of large phylogenies</article-title>. <source>Bioinformatics</source>. <year>2014</year>;<volume>30</volume>(<issue>9</issue>):<fpage>1312</fpage>–<lpage>1313</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btu033" xlink:type="simple">10.1093/bioinformatics/btu033</ext-link></comment> <object-id pub-id-type="pmid">24451623</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005611.ref044">
<label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Culik</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Wood</surname> <given-names>D</given-names></name>. <article-title>A note on some tree similarity measures</article-title>. <source>Information Processing Letters</source>. <year>1982</year>;<volume>15</volume>(<issue>1</issue>):<fpage>39</fpage>–<lpage>42</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/0020-0190(82)90083-7" xlink:type="simple">10.1016/0020-0190(82)90083-7</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005611.ref045">
<label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Li</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Tromp</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>L</given-names></name>. <article-title>On the nearest neighbour interchange distance between evolutionary trees</article-title>. <source>Journal of Theoretical Biology</source>. <year>1996</year>;<volume>182</volume>(<issue>4</issue>):<fpage>463</fpage>–<lpage>467</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1006/jtbi.1996.0188" xlink:type="simple">10.1006/jtbi.1996.0188</ext-link></comment> <object-id pub-id-type="pmid">8944893</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005611.ref046">
<label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Allen</surname> <given-names>BL</given-names></name>, <name name-style="western"><surname>Steel</surname> <given-names>M</given-names></name>. <article-title>Subtree transfer operations and their induced metrics on evolutionary trees</article-title>. <source>Annals of Combinatorics</source>. <year>2001</year>;<volume>5</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>15</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s00026-001-8006-8" xlink:type="simple">10.1007/s00026-001-8006-8</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005611.ref047">
<label>47</label>
<mixed-citation publication-type="other" xlink:type="simple">DasGupta B, He X, Jiang T, Li M, Tromp J, Zhang L. On computing the nearest neighbor interchange distance. In: Discrete Mathematical Problems with Medical Applications: DIMACS Workshop Discrete Mathematical Problems with Medical Applications, December 8-10, 1999, DIMACS Center. vol. 55. American Mathematical Soc.; 2000. p. 125–143.</mixed-citation>
</ref>
</ref-list>
</back>
</article>