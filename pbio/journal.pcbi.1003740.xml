<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id><journal-title-group>
<journal-title>PLoS Computational Biology</journal-title></journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-14-00205</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1003740</article-id>
<article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Evolutionary modeling</subject></subj-group></subj-group><subj-group><subject>Evolutionary biology</subject><subj-group><subject>Evolutionary processes</subject></subj-group></subj-group><subj-group><subject>Genetics</subject><subj-group><subject>Cancer genetics</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Computer and information sciences</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Applied mathematics</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Algorithms to Model Single Gene, Single Chromosome, and Whole Genome Copy Number Changes Jointly in Tumor Phylogenetics</article-title>
<alt-title alt-title-type="running-head">Algorithms to Model Copy Number Changes in Tumor Phylogenetics</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Chowdhury</surname><given-names>Salim Akhter</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Shackney</surname><given-names>Stanley E.</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Heselmeyer-Haddad</surname><given-names>Kerstin</given-names></name><xref ref-type="aff" rid="aff4"><sup>4</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Ried</surname><given-names>Thomas</given-names></name><xref ref-type="aff" rid="aff4"><sup>4</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Schäffer</surname><given-names>Alejandro A.</given-names></name><xref ref-type="aff" rid="aff5"><sup>5</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Schwartz</surname><given-names>Russell</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff6"><sup>6</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
</contrib-group>
<aff id="aff1"><label>1</label><addr-line>Joint Carnegie Mellon/University of Pittsburgh Ph.D. Program in Computational Biology, Carnegie Mellon University, Pittsburgh, Pennsylvania, United States of America</addr-line></aff>
<aff id="aff2"><label>2</label><addr-line>Lane Center for Computational Biology, Carnegie Mellon University, Pittsburgh, Pennsylvania, United States of America</addr-line></aff>
<aff id="aff3"><label>3</label><addr-line>Intelligent Oncotherapeutics, Pittsburgh, Pennsylvania, United States of America</addr-line></aff>
<aff id="aff4"><label>4</label><addr-line>Genetics Branch, Center for Cancer Research, NCI, NIH, Bethesda, Maryland, United States of America</addr-line></aff>
<aff id="aff5"><label>5</label><addr-line>Computational Biology Branch, NCBI, NIH, Bethesda, Maryland, United States of America</addr-line></aff>
<aff id="aff6"><label>6</label><addr-line>Department of Biological Sciences, Carnegie Mellon University, Pittsburgh, Pennsylvania, United States of America</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Pond</surname><given-names>Sergei L. Kosakovsky.</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group>
<aff id="edit1"><addr-line>University of California San Diego, United States of America</addr-line></aff>
<author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">russells@andrew.cmu.edu</email></corresp>
<fn fn-type="conflict"><p>Dr Shackney is an employee of Intelligent Oncotherapeutics. All other authors declare that no competing interests exist.</p></fn>
<fn fn-type="con"><p>Conceived and designed the experiments: SAC SES KHH TR AAS RS. Performed the experiments: SAC AAS RS. Analyzed the data: SAC SES KHH TR AAS RS. Wrote the paper: SAC SES KHH TR AAS RS. Designed the software used in the analysis: SAC AAS RS.</p></fn>
</author-notes>
<pub-date pub-type="collection"><month>7</month><year>2014</year></pub-date>
<pub-date pub-type="epub"><day>31</day><month>7</month><year>2014</year></pub-date>
<volume>10</volume>
<issue>7</issue>
<elocation-id>e1003740</elocation-id>
<history>
<date date-type="received"><day>2</day><month>2</month><year>2014</year></date>
<date date-type="accepted"><day>4</day><month>6</month><year>2014</year></date>
</history>
<permissions>
<copyright-year>2014</copyright-year>
<license xlink:type="simple"><license-p>This is an open-access article, free of all copyright, and may be freely reproduced, distributed, transmitted, modified, built upon, or otherwise used by anyone for any lawful purpose. The work is made available under the Creative Commons CC0 public domain dedication.</license-p></license></permissions><related-article id="RA1" related-article-type="companion" ext-link-type="uri" page="e1002972" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pcbi.1002972"> <article-title>New Methods Section in PLOS Computational Biology</article-title></related-article>
<abstract>
<p>We present methods to construct phylogenetic models of tumor progression at the cellular level that include copy number changes at the scale of single genes, entire chromosomes, and the whole genome. The methods are designed for data collected by fluorescence <italic>in situ</italic> hybridization (FISH), an experimental technique especially well suited to characterizing intratumor heterogeneity using counts of probes to genetic regions frequently gained or lost in tumor development. Here, we develop new provably optimal methods for computing an edit distance between the copy number states of two cells given evolution by copy number changes of single probes, all probes on a chromosome, or all probes in the genome. We then apply this theory to develop a practical heuristic algorithm, implemented in publicly available software, for inferring tumor phylogenies on data from potentially hundreds of single cells by this evolutionary model. We demonstrate and validate the methods on simulated data and published FISH data from cervical cancers and breast cancers. Our computational experiments show that the new model and algorithm lead to more parsimonious trees than prior methods for single-tumor phylogenetics and to improved performance on various classification tasks, such as distinguishing primary tumors from metastases obtained from the same patient population.</p>
</abstract>
<abstract abstract-type="summary"><title>Author Summary</title>
<p>Cancer is an evolutionary system whose growth and development is attributed to aberrations in well-known genes and to cancer-type specific genomic imbalances. Here, we present methods for reconstructing the evolution of individual tumors based on cell-to-cell variations between copy numbers of targeted regions of the genome. The methods are designed to work with fluorescence <italic>in situ</italic> hybridization (FISH), a technique that allows one to profile copy number changes in potentially thousands of single cells per study. Our work advances the prior art by developing theory and practical algorithms for building evolutionary trees of single tumors that can model gain or loss of genetic regions at the scale of single genes, whole chromosomes, or the entire genome, all common events in tumor evolution. We apply these methods on simulated and real tumor data to demonstrate substantial improvements in tree-building accuracy and in our ability to accurately classify tumors from their inferred evolutionary models. The newly developed algorithms have been released through our publicly available software, FISHtrees.</p>
</abstract>
<funding-group><funding-statement>This research was supported in part by the Intramural Research Program of the U.S. National Institutes of Health, National Cancer Institute, and National Library of Medicine, and by U.S. National Institutes of Health grants 1R01CA140214 (RS and SAC) and 1R01AI076318 (RS). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="19"/></counts></article-meta>
</front>
<body><sec id="s1">
<title/>
<disp-quote>
<p>This is a <italic>PLOS Computational Biology</italic> Methods article.</p>
</disp-quote></sec><sec id="s2">
<title>Introduction</title>
<p>In this paper, we develop new methods to advance the theory of phylogenetic inference for reconstructing evolutionary histories of cell populations in solid tumors. The work is specifically designed for use in tracking tumor evolution by gain and loss of genomic regions as assessed by multicolor fluorescence <italic>in situ</italic> hybridization (FISH), which measures the copy numbers of targeted genes and chromosomes in potentially hundreds of individual cells of a tumor. This technology was the basis of the earliest methods for phylogenetic reconstruction of single tumors <xref ref-type="bibr" rid="pcbi.1003740-Pennington1">[1]</xref>, <xref ref-type="bibr" rid="pcbi.1003740-Pennington2">[2]</xref>. FISH remains uniquely valuable for such studies because the large number of cells that FISH can profile makes it possible to collect data on enough tumors in enough detail to build cell-by-cell phylogenies for populations of tumors and begin to study the common features of these phylogenies. In the present work, we specifically extend our previously developed inference algorithms to encompass a more complicated but realistic model of evolution of FISH probe counts, accounting for gain and loss of genetic material at the level of single gene probes, multiple probes on a single chromosome, or a probe set distributed across the whole genome. We demonstrate the value of these algorithmic improvements to more accurate phylogenetic inference and improved effectiveness of the resulting phylogenies in downstream prediction tasks.</p>
<p>The present work adds to the growing list of phylogenetic methods in cancer modeling, which were reviewed through 2008 in <xref ref-type="bibr" rid="pcbi.1003740-Attolini1">[3]</xref>. These include methods for analyzing comparative genomic hybridization (CGH) or other genetic gain/loss data in a single tumor type <xref ref-type="bibr" rid="pcbi.1003740-Desper1">[4]</xref>–<xref ref-type="bibr" rid="pcbi.1003740-Bogojeska2">[11]</xref>, for defining the cell type lineage of single tumors <xref ref-type="bibr" rid="pcbi.1003740-Pennington1">[1]</xref>, <xref ref-type="bibr" rid="pcbi.1003740-Pennington2">[2]</xref>, <xref ref-type="bibr" rid="pcbi.1003740-Frumkin1">[12]</xref>, , for organizing a taxonomy of tumor types <xref ref-type="bibr" rid="pcbi.1003740-Liu1">[14]</xref>, for reconstructing a partial order of genetic changes in multiple samples from one patient <xref ref-type="bibr" rid="pcbi.1003740-Letouz1">[15]</xref>, and for reconstructing progression from cell types inferred from bulk genomic assays <xref ref-type="bibr" rid="pcbi.1003740-Subramanian1">[16]</xref>. Recent high-throughput sequencing studies have also used ad hoc phylogenetic methods to infer putative tumor progression scenarios, e.g., <xref ref-type="bibr" rid="pcbi.1003740-Campbell1">[17]</xref>–<xref ref-type="bibr" rid="pcbi.1003740-Hou1">[20]</xref>. Like many of these methods, the present work is aimed at building tree models that provide a proposed partial order on the observed cell states, a strategy motivated originally by the work of Fearon and Vogelstein, proposing a linear order for four types of events in colorectal cancer and associating each event with a tumor stage <xref ref-type="bibr" rid="pcbi.1003740-Fearon1">[21]</xref>. Other ordering methods have been proposed, mostly for CGH or breakpoint data <xref ref-type="bibr" rid="pcbi.1003740-Letouz1">[15]</xref>, <xref ref-type="bibr" rid="pcbi.1003740-Hglund1">[22]</xref>–<xref ref-type="bibr" rid="pcbi.1003740-ShahrabiFarahani1">[28]</xref> and, more recently, sequencing data <xref ref-type="bibr" rid="pcbi.1003740-Greenman1">[29]</xref>, <xref ref-type="bibr" rid="pcbi.1003740-Purdom1">[30]</xref>.</p>
<p>The present work specifically advances the reconstruction of phylogenetic histories of single tumors from intratumor cellular heterogeneity data. The use of phylogenetic methods to reconstruct histories of single tumors was first developed in our prior work <xref ref-type="bibr" rid="pcbi.1003740-Pennington1">[1]</xref>, <xref ref-type="bibr" rid="pcbi.1003740-Pennington2">[2]</xref> by taking advantage of the ability of FISH to profile genetic changes in large numbers of single cells, allowing one to survey hundreds of cells per tumor in populations of tens of tumors <xref ref-type="bibr" rid="pcbi.1003740-Janocko1">[31]</xref>. This early work showed that even small numbers of markers could reveal numerous genetically distinct cell populations in single tumors, which could be resolved by phylogenetic inference to reveal multiple distinct pathways of progression between tumors and even within single tumors. Numerous studies since then, using multicolor FISH <xref ref-type="bibr" rid="pcbi.1003740-Pennington2">[2]</xref>, <xref ref-type="bibr" rid="pcbi.1003740-Janocko1">[31]</xref>–<xref ref-type="bibr" rid="pcbi.1003740-HeselmeyerHaddad2">[36]</xref> and, more recently, single-cell sequencing <xref ref-type="bibr" rid="pcbi.1003740-Tao1">[19]</xref>, <xref ref-type="bibr" rid="pcbi.1003740-Navin1">[37]</xref>–<xref ref-type="bibr" rid="pcbi.1003740-Xu1">[39]</xref> have greatly increased our ability to identify distinct cell populations and, in the process, revealed far more extensive intratumor heterogeneity than had been suspected prior to 2010 (reviewed in <xref ref-type="bibr" rid="pcbi.1003740-Marusyk1">[40]</xref>). The repeated observation of intratumor heterogeneity has necessitated a reconsideration of Nowell's <xref ref-type="bibr" rid="pcbi.1003740-Nowell1">[41]</xref> theory that tumors evolve clonally, showing that a tumor may contain many subpopulations relevant to the clinical prognosis of the patient <xref ref-type="bibr" rid="pcbi.1003740-Ding1">[42]</xref> and that rare subpopulations may be more relevant to prognosis than the most common ones <xref ref-type="bibr" rid="pcbi.1003740-Urbschat1">[43]</xref>. Furthermore, a simulation study has suggested that methods based on average copy number data perform poorly when there is substantial intratumor heterogeneity <xref ref-type="bibr" rid="pcbi.1003740-Sprouffske1">[44]</xref>. Such findings suggest a need for improved methods for organizing the dozens or hundreds of observed cell states in single tumors to infer the evolutionary processes that produced them.</p>
<p>Despite extensive work on tumor phylogenetics, however, the study of algorithms for reconstructing tumor evolution from large numbers of single cells has lagged far behind advances in data generation. The standard in practice for single-cell tumor phylogenetics remains the use of simple generic phylogeny algorithms (e.g., neighbor-joining <xref ref-type="bibr" rid="pcbi.1003740-Saitou1">[45]</xref>) that are not designed to model the patterns of copy number changes one would expect from evolution by chromosome abnormalities that largely drive tumor evolution. Until recently, algorithms designed specifically for inferring phylogenies of single tumors from FISH data have been limited to just a few probes per cell and lacked robust, publicly available software implementations <xref ref-type="bibr" rid="pcbi.1003740-Pennington1">[1]</xref>, <xref ref-type="bibr" rid="pcbi.1003740-Pennington2">[2]</xref>, <xref ref-type="bibr" rid="pcbi.1003740-Martins1">[34]</xref>. In prior work <xref ref-type="bibr" rid="pcbi.1003740-Chowdhury1">[46]</xref>, we developed algorithms to find copy-number phylogenies for in principle arbitrary numbers of probes and cells. That work, however, was itself limited to a simple model in which tumor cells evolve by events of gain or loss of a single copy number of a single probe at each mutation step. In real tumors, gene copy numbers can change due to a variety of mechanisms, including:</p>
<list list-type="order"><list-item>
<p>Single gene duplication/loss events (SD), in which one copy of a genetic region covered by a single probe is gained or lost.</p>
</list-item><list-item>
<p>Chromosome duplication/loss events (CD), in which entire chromosomes are unequally distributed among daughter cells during mitosis along with potentially several probes.</p>
</list-item><list-item>
<p>Whole genome duplication events (GD), in which a cell fails to divide during mitosis leading to doubling of all genetic material and all probe counts.</p>
</list-item></list>
<p>These events are illustrated schematically in <xref ref-type="fig" rid="pcbi-1003740-g001">Figure 1</xref>. While more complex probabilistic models of tumor evolution have been developed for inference of small phylogenies, with approximately ten taxa per tumor corresponding to distinct biopsies (e.g., <xref ref-type="bibr" rid="pcbi.1003740-Sottoriva1">[47]</xref>), the class of inference algorithms such models require would not be expected to scale to phylogenies of hundreds of single cells per tumor such as those examined in the present work.</p>
<fig id="pcbi-1003740-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003740.g001</object-id><label>Figure 1</label><caption>
<title>Example showing the three mechanisms of copy number changes in a hypothetical cell.</title>
<p>A copy number profile of four genes is shown as an ordered set for homologous chromosome pairs <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e001" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e002" xlink:type="simple"/></inline-formula> respectively, where the gene located on the top position in the chromosome precedes the gene located on the bottom position in the ordering. After the (A) Single gene duplication event, the copy number of a gene located on <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e003" xlink:type="simple"/></inline-formula> gets increased by 1. After the (B) Single chromosome duplication event, the chromosome <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e004" xlink:type="simple"/></inline-formula> gets duplicated and the cell has one extra copy of that chromosome as chromosome <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e005" xlink:type="simple"/></inline-formula>. After the (C) Whole genome duplication event, all the chromosomes are duplicated and the total number of chromosomes in the daughter cell is twice the number of chromosomes in the mother cell.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003740.g001" position="float" xlink:type="simple"/></fig>
<p>The work presented here seeks to fill this need for scalable phylogenetic algorithms capable of fitting more realistic models of tumor-like evolution to data sets of hundreds of single cells per tumor. We improve on our prior work for inferring tumor evolutionary models considering only SD events <xref ref-type="bibr" rid="pcbi.1003740-Chowdhury1">[46]</xref> to now include CD and GD events, which are also frequently observed in tumor progression. We specifically focus on the problem of accurately inferring evolutionary distances between distinct cells in terms of maximum parsimony combinations of SD, CD, and GD events. The major contributions of the work are:</p>
<list list-type="order"><list-item>
<p>algorithms to compute minimum evolutionary distances <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e006" xlink:type="simple"/></inline-formula> between pairs of cell states in terms of SD and CD events and in terms of SD, CD, and GD events;</p>
</list-item><list-item>
<p>a heuristic Steiner tree method based on the median-joining method <xref ref-type="bibr" rid="pcbi.1003740-Bandelt1">[48]</xref> and our prior work on SD-only inference <xref ref-type="bibr" rid="pcbi.1003740-Chowdhury1">[46]</xref>;</p>
</list-item><list-item>
<p>software implementation of the new methods to compute <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e007" xlink:type="simple"/></inline-formula> and use of those methods to construct tumor progression trees;</p>
</list-item><list-item>
<p>evaluation of the new methods on simulated data, which shows that they do better than the SD-only approach at recovering simulated tree topologies;</p>
</list-item><list-item>
<p>application of the methods to published data on cervical cancer (CC, <xref ref-type="bibr" rid="pcbi.1003740-Wangsa1">[49]</xref>) and breast cancer (BC, <xref ref-type="bibr" rid="pcbi.1003740-HeselmeyerHaddad2">[36]</xref>);</p>
</list-item><list-item>
<p>demonstration of improved ability to classify tumor types from phylogenetic features using a strategy in the spirit of the genomic progression scores (GPS) of Rahnenführer et al. <xref ref-type="bibr" rid="pcbi.1003740-Rahnenfhrer1">[50]</xref>.</p>
</list-item></list>
<p>The new methods are implemented in version 2 of our software FISHtrees (<ext-link ext-link-type="uri" xlink:href="ftp://ftp.ncbi.nlm.nih.gov/pub/FISHtrees" xlink:type="simple">ftp://ftp.ncbi.nlm.nih.gov/pub/FISHtrees</ext-link>). The work addresses a critical need in modern cancer research for algorithms capable of inferring evolutionary trajectories of hundreds of single cells per tumor under plausible models of evolution including both gene-specific and chromosome abnormalities that are central drivers of true tumor evolution.</p>
</sec><sec id="s3">
<title>Results</title>
<p>We used data collected from cervical cancer (CC) <xref ref-type="bibr" rid="pcbi.1003740-Wangsa1">[49]</xref> and breast cancer (BC) <xref ref-type="bibr" rid="pcbi.1003740-HeselmeyerHaddad2">[36]</xref> patients to evaluate our methods. <xref ref-type="fig" rid="pcbi-1003740-g002">Figure 2(A)</xref> shows a tumor progression tree inferred from one of the cervical cancer samples. For comparison, <xref ref-type="fig" rid="pcbi-1003740-g002">Figure 2(B)</xref> shows a progression tree inferred on the same sample using our prior SD model <xref ref-type="bibr" rid="pcbi.1003740-Chowdhury1">[46]</xref>. Visual inspection shows that large regions of the two trees are identical but that allowing CD and GD events leads to some rearrangement and a reduction in tree depth and overall size. Next we evaluate the changes induced by adding SD, CD and GD events, using simulated data to show effectiveness of the methods in finding more parsimonious solutions to the broader model and using the real CC and BC data to show the biological relevance of the improvements. We further show that our algorithms infer trees with higher accuracy than the prevailing alternative algorithms for single-tumor phylogenetic inference. Finally, we perform statistical experiments to evaluate the effects of tumor sample size on the performance of our tree building algorithm.</p>
<fig id="pcbi-1003740-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003740.g002</object-id><label>Figure 2</label><caption>
<title>Phylogenetic trees showing tumor progression in a cervical cancer patient.</title>
<p>Trees are built considering (A) all of SD, CD and GD and (B) only SD model of tumor evolution. Each node represents a configuration of the four gene probes <italic>LAMP3</italic>, <italic>PROX1</italic>, <italic>PRKAA1</italic> and <italic>CCND1</italic>. Nodes with solid and dotted borders represent cells present in the collected sample and inferred Steiner nodes respectively. Green and red edges model gene gain and gene loss, respectively. The weight value on each edge connecting two nodes <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e008" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e009" xlink:type="simple"/></inline-formula> is the distance between the states of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e010" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e011" xlink:type="simple"/></inline-formula>, computed using the particular model of tumor progression under consideration. The weight on each node describes the fraction of cells in the sample with the particular copy number profile modeled by that node; Steiner nodes are assigned weight 0.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003740.g002" position="float" xlink:type="simple"/></fig><sec id="s3a">
<title>Simulation experiments</title>
<p>To measure accuracy of the methods for FISH datasets with a known ground truth, we generated a dataset of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e012" xlink:type="simple"/></inline-formula> trees with six probes, two of which were treated as being on the same chromosome. Each tree was generated by starting from a diploid root node and executing a branching process in which each node was recursively assigned a number of children drawn from a geometrically distributed random variable with mean <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e013" xlink:type="simple"/></inline-formula>. Each child was distinguished from its parent by selecting an SD, CD, or GD event with probability <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e014" xlink:type="simple"/></inline-formula> for each of the six possible SD events, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e015" xlink:type="simple"/></inline-formula> of a CD event, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e016" xlink:type="simple"/></inline-formula> of a GD event. This process terminated when all leaf nodes had been assigned zero children by the sampling. We then generated simulated FISH data for each tree by uniformly sampling <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e017" xlink:type="simple"/></inline-formula> cells from the nodes in this topology. The simulated data corresponds to counts of probes for each sampled cell in the tree. We applied Algorithm 3 (see <xref ref-type="sec" rid="s5">Methods</xref>) to find a minimum-cost tree for each of four event models: (i) SD only, (ii) SD and CD, (iii) SD and GD, and (iv) SD, CD and GD.</p>
<p>We quantified the accuracy of tree inference by comparing each simulated true tree to its corresponding inferred tree derived from the sampled cells. This assessment was performed at the level of accuracy of tree edges by the following procedure:</p>
<list list-type="order"><list-item>
<p>We pruned the real tree so as to remove any subtree for which no cell in the tree was sampled. This step was intended to avoid penalizing for “impossible” inferences of subtrees unsupported by any data.</p>
</list-item><list-item>
<p>We computed a maximum matching of edges between the real subtree and the inferred tree, with each pair of edges weighted by the maximum number of nodes in agreement between the corresponding parts of the bipartitions that the two edges define <xref ref-type="bibr" rid="pcbi.1003740-Chowdhury1">[46]</xref>, <xref ref-type="bibr" rid="pcbi.1003740-Lin1">[51]</xref>. We used the Hungarian algorithm <xref ref-type="bibr" rid="pcbi.1003740-Kuhn1">[52]</xref> for computing the maximum matching (applying the function“Hungarian” by Alexander Melin from the Matlab Central File Exchange).</p>
</list-item><list-item>
<p>We calculated a reconstruction error <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e018" xlink:type="simple"/></inline-formula> of the inferred tree using the following formula:</p>
<p><disp-formula id="pcbi.1003740.e019"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003740.e019" xlink:type="simple"/></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e020" xlink:type="simple"/></inline-formula> is the weight of the maximum matching, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e021" xlink:type="simple"/></inline-formula> is set of taxa in common between the real and inferred trees, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e022" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e023" xlink:type="simple"/></inline-formula> represent the sets of nontrivial bipartitions in the real and inferred trees, respectively.</p>
</list-item></list>
<p>Intuitively, this formula measures the fractional agreement between bipartitions of the trees relative to the total number of bipartitions. We use a matching-based formula, rather than the more familiar Robinson-Foulds metric <xref ref-type="bibr" rid="pcbi.1003740-Robinson1">[53]</xref>, both because of its greater sensitivity to small changes in trees and because the Robinson-Foulds measure is not defined for trees with different node sets. We also note that we use a different normalization factor than in our prior work <xref ref-type="bibr" rid="pcbi.1003740-Chowdhury1">[46]</xref>, normalizing essentially by the total number of edges between the two trees, to control properly for the fact that different inference methods may infer different numbers of tree edges. The reconstruction error <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e024" xlink:type="simple"/></inline-formula> ranges in value from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e025" xlink:type="simple"/></inline-formula>, if the real and inferred trees are isomorphic, to an upper bound of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e026" xlink:type="simple"/></inline-formula> in the limit of complete disagreement.</p>
<p>To illustrate the meanings of the terms of the equation for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e027" xlink:type="simple"/></inline-formula>, we present a simple example using a hypothetical ground truth and an inferred tree presented in <xref ref-type="fig" rid="pcbi-1003740-g003">Figure 3(A)</xref> and <xref ref-type="fig" rid="pcbi-1003740-g003">Figure 3(B)</xref>, respectively. The set of nontrivial bipartitions in the ground truth are</p>
<fig id="pcbi-1003740-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003740.g003</object-id><label>Figure 3</label><caption>
<title>Example simulated and inferred trees illustrating key terms in the formula for calculating the reconstruction error.</title>
<p>(A) A hypothetical simulated ground truth tree on the set of taxa <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e028" xlink:type="simple"/></inline-formula>. (B) Example inferred tree built on the sampled set of taxa <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e029" xlink:type="simple"/></inline-formula> on the dataset resulting from the ground truth tree.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003740.g003" position="float" xlink:type="simple"/></fig>
<p><disp-formula id="pcbi.1003740.e030"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003740.e030" xlink:type="simple"/></disp-formula>and the nontrivial bipartitions in the inferred tree are</p>
<p><disp-formula id="pcbi.1003740.e031"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003740.e031" xlink:type="simple"/></disp-formula></p>
<p>If we apply the matching algorithm on these two sets of bipartitions, the first and second bipartitions in the ground truth tree are matched with the first and second bipartitions in the inferred tree, respectively. The weight <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e032" xlink:type="simple"/></inline-formula> of the matching is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e033" xlink:type="simple"/></inline-formula>. The number of common taxa between these two datasets is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e034" xlink:type="simple"/></inline-formula>. The total number of nontrivial bipartitions in the real and inferred trees are <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e035" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e036" xlink:type="simple"/></inline-formula>. Plugging these values into the equation for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e037" xlink:type="simple"/></inline-formula>, we calculate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e038" xlink:type="simple"/></inline-formula>.</p>
<p>A comparison of the four models is presented in <xref ref-type="fig" rid="pcbi-1003740-g004">Figure 4</xref>. The SD model showed <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e039" xlink:type="simple"/></inline-formula> reconstruction error with standard deviation (s.d.) of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e040" xlink:type="simple"/></inline-formula> across the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e041" xlink:type="simple"/></inline-formula> trees. The SD+CD model yielded <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e042" xlink:type="simple"/></inline-formula> error with s.d. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e043" xlink:type="simple"/></inline-formula>. SD+GD yielded <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e044" xlink:type="simple"/></inline-formula> error with s.d. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e045" xlink:type="simple"/></inline-formula>. The full SD+CD+GD model yielded <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e046" xlink:type="simple"/></inline-formula> error with s.d. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e047" xlink:type="simple"/></inline-formula>. Collectively, the results suggest that one can reconstruct reasonably accurate trees even from the SD-only model, despite the fact that the trees were generated from a model of all three event types, although accuracy improves with each event type added. Accounting for GD events made a larger difference in accuracy than accounting for CD events, presumably because a missed GD event might require many SD or CD events to explain it, while a missed CD event could be explained with just two SD events. The reconstruction error for the full model is reduced by more than 1.7-fold relative to the SD-only model considered in our prior work.</p>
<fig id="pcbi-1003740-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003740.g004</object-id><label>Figure 4</label><caption>
<title>Accuracy of phylogenetic inference on simulated copy number data for varying algorithms.</title>
<p>Variants of our phylogenetic algorithms and two competing methods from the literature were applied to simulated FISH datasets describing evolution by combinations of single-gene (SD), chromosome (CD), and whole-genome (GD) duplication and loss events. Results are reported for inference by our methods from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e048" xlink:type="simple"/></inline-formula> simulated trees, allowing for SD events alone, SD+CD events, SD+GD events, and SD+CD+GD events. We compared these results to inference by neighbor-joining (NJ) and pure maximum parsimony (MP) as implemented in MEGA, version 6. Accuracy is assessed by mean reconstruction error of bipartitions between true and inferred trees. Error bars show plus or minus one standard deviation across the samples for each method.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003740.g004" position="float" xlink:type="simple"/></fig>
<p>We further compared these results to those derived using generic phylogenetic methods that have been used in much of the single tumor phylogenetics work to date <xref ref-type="bibr" rid="pcbi.1003740-Subramanian1">[16]</xref>, <xref ref-type="bibr" rid="pcbi.1003740-Navin2">[54]</xref>. We tested the accuracy of reconstruction of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e049" xlink:type="simple"/></inline-formula> simulated trees described above using generic neighbor joining (NJ) with Euclidean distance and pure maximum parsimony (MP) treating copy numbers as arbitrary characters, approaches chosen because they have been the primary alternatives to our specialized algorithms in the single-tumor phylogeny literature. We omit here comparison to more complicated Bayesian phylogenetic models (e.g., <xref ref-type="bibr" rid="pcbi.1003740-Sottoriva1">[47]</xref>) because such approaches are not scalable to the numbers of cells we examine. We then used the weighted matching based similarity method, described above, to calculate the mean percentage reconstruction error <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e050" xlink:type="simple"/></inline-formula> between the inferred and the ground truth trees. The mean reconstruction errors for NJ and MP were <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e051" xlink:type="simple"/></inline-formula> (s.d. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e052" xlink:type="simple"/></inline-formula>) and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e053" xlink:type="simple"/></inline-formula> (s.d. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e054" xlink:type="simple"/></inline-formula>), respectively, in contrast to the error of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e055" xlink:type="simple"/></inline-formula> (s.d. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e056" xlink:type="simple"/></inline-formula>) for the SD+CD+GD algorithm proposed here. The test thus demonstrates that when the underlying evolutionary process includes cancer-like chromosome abnormalities, errors are substantially reduced by using an algorithm designed for that model relative to standard off-the-shelf algorithms still widely used for single-tumor phylogenetics work.</p>
<p>We performed additional experiments to evaluate the effects of different evolutionary parameters on the accuracy of inference of tumor progression trees by FISHtrees. For this experiment, we selected five different combinations of probabilities of SD, CD and GD events for generating the ground truth trees and then used SD, SD+CD, SD+GD and SD+CD+GD models to infer the tumor phylogenies. These data sets again each used six probes with two of the six on a common chromosome. The selected five combinations of (SD,CD,GD) event probabilities are: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e057" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e058" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e059" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e060" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e061" xlink:type="simple"/></inline-formula>. These combinations of event probabilities were chosen to yield trees of comparable complexity to the real data while producing test sets enriched in distinct combinations of the three event types. They thus allow us to consider how robust our algorithms are to contributions from each of the three event types, singly or in combination. We report the reconstruction error for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e062" xlink:type="simple"/></inline-formula> trees for each of these combinations of event probabilities in <xref ref-type="table" rid="pcbi-1003740-t001">Table 1</xref>. These results again show that accuracy improves with each event type added. When the probability of SD events is high (as in combination 3), the SD model results in highly accurate trees (mean reconstruction error of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e063" xlink:type="simple"/></inline-formula> with s.d. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e064" xlink:type="simple"/></inline-formula>). Accounting for GD events in combination with SD events always result in larger improvement in the reconstruction error in comparison to the SD+CD models, even when the CD events are very frequent (as in combinations 2 and 4). Finally, accounting for GD events in combination with SD and CD events results in the largest improvements when the probability ratio of GD events to SD+CD events is highest, as can be seen from comparison of parameter sets 1 and 2.</p>
<table-wrap id="pcbi-1003740-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003740.t001</object-id><label>Table 1</label><caption>
<title>Comparison of mean percentage reconstruction error (with standard deviation) of different phylogeny models on simulated data for different combinations of SD, CD and GD event probabilities.</title>
</caption><alternatives><graphic id="pcbi-1003740-t001-1" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003740.t001" xlink:type="simple"/>
<table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" rowspan="1" colspan="1">Probabilities of (SD,CD,GD) Events</td>
<td align="left" rowspan="1" colspan="1">SD</td>
<td align="left" rowspan="1" colspan="1">SD+CD</td>
<td align="left" rowspan="1" colspan="1">SD+GD</td>
<td align="left" rowspan="1" colspan="1">SD+CD+GD</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1">(0.125,0.05,0.2)</td>
<td align="left" rowspan="1" colspan="1">17.97(4.49)</td>
<td align="left" rowspan="1" colspan="1">16.89(4.32)</td>
<td align="left" rowspan="1" colspan="1">9.85(3.51)</td>
<td align="left" rowspan="1" colspan="1">9.25(4.18)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">(0.1,0.2,0.2)</td>
<td align="left" rowspan="1" colspan="1">25.58(4.50)</td>
<td align="left" rowspan="1" colspan="1">21.82(3.98)</td>
<td align="left" rowspan="1" colspan="1">13.81(3.62)</td>
<td align="left" rowspan="1" colspan="1">10.96(3.99)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">(0.15,0.07,0.03)</td>
<td align="left" rowspan="1" colspan="1">16.02(4.15)</td>
<td align="left" rowspan="1" colspan="1">14.96(4.16)</td>
<td align="left" rowspan="1" colspan="1">11.92(4.29)</td>
<td align="left" rowspan="1" colspan="1">11.71(4.77)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">(0.1,0.3,0.1)</td>
<td align="left" rowspan="1" colspan="1">23.13(4.37)</td>
<td align="left" rowspan="1" colspan="1">20.02(4.50)</td>
<td align="left" rowspan="1" colspan="1">15.43(4.60)</td>
<td align="left" rowspan="1" colspan="1">13.42(4.64)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">(0.1166,0.18,0.12)</td>
<td align="left" rowspan="1" colspan="1">17.43(5.10)</td>
<td align="left" rowspan="1" colspan="1">15.91(4.59)</td>
<td align="left" rowspan="1" colspan="1">12.01(6.40)</td>
<td align="left" rowspan="1" colspan="1">10.84(3.88)</td>
</tr>
</tbody>
</table>
</alternatives><table-wrap-foot><fn id="nt101"><label/><p>Mean percentage reconstruction error on <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e065" xlink:type="simple"/></inline-formula> simulated samples are shown for four tree-building models considering (i) SD, (ii) SD+CD, (iii) SD+GD and (iv) SD+CD+GD across five different combinations of SD, CD, and GD probabilities.</p></fn></table-wrap-foot></table-wrap>
<p>Next, we performed simulation tests to evaluate the effects of non-uniform distributions of cells across different levels of the trees on the performance of our tree inference method. In our initial simulation experiments described above, we assumed that observed cells were sampled uniformly across clones. In real tumors, the distribution of cells would not typically be uniform due to differences in age and fitness of clones. In order to test robustness of our method to non-uniformity of clone frequencies, we sampled the cells following a non-uniform model in which the sampling frequency of a clone varies geometrically with its depth in the tree with a parameter <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e066" xlink:type="simple"/></inline-formula>. We used values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e067" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e068" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e069" xlink:type="simple"/></inline-formula> in our experiments. When <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e070" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e071" xlink:type="simple"/></inline-formula> of the total cells are located in the first three levels of the trees, while for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e072" xlink:type="simple"/></inline-formula>, this fraction is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e073" xlink:type="simple"/></inline-formula>. We generated <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e074" xlink:type="simple"/></inline-formula> trees in each case with probabilities of SD, CD and GD events fixed at <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e075" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e076" xlink:type="simple"/></inline-formula>. We again used SD, SD+CD, SD+GD and SD+CD+GD models to infer the tumor progression trees. We present the results from this experiment in <xref ref-type="table" rid="pcbi-1003740-t002">Table 2</xref>, where we also show the results from the uniform sampling of the cells. Additionally, we report the results on the trees inferred using NJ and MP for these three different cell distributions. From the table, we can see that the reconstruction error increases with increasing <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e077" xlink:type="simple"/></inline-formula> for all methods. The SD+CD+GD model, however, shows the best performance among all the models for all three values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e078" xlink:type="simple"/></inline-formula> and the least loss of performance with increasing <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e079" xlink:type="simple"/></inline-formula>.</p>
<table-wrap id="pcbi-1003740-t002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003740.t002</object-id><label>Table 2</label><caption>
<title>Comparison of mean percentage reconstruction error (with standard deviation) of different phylogeny models on simulated data for different sampling distributions of the cells.</title>
</caption><alternatives><graphic id="pcbi-1003740-t002-2" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003740.t002" xlink:type="simple"/>
<table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" rowspan="1" colspan="1">Distribution</td>
<td align="left" rowspan="1" colspan="1">SD</td>
<td align="left" rowspan="1" colspan="1">SD+CD</td>
<td align="left" rowspan="1" colspan="1">SD+GD</td>
<td align="left" rowspan="1" colspan="1">SD+CD+GD</td>
<td align="left" rowspan="1" colspan="1">NJ</td>
<td align="left" rowspan="1" colspan="1">MP</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1">Uniform</td>
<td align="left" rowspan="1" colspan="1">17.43(5.10)</td>
<td align="left" rowspan="1" colspan="1">15.91(4.59)</td>
<td align="left" rowspan="1" colspan="1">12.01(6.40)</td>
<td align="left" rowspan="1" colspan="1">10.84(3.88)</td>
<td align="left" rowspan="1" colspan="1">43.23(4.24)</td>
<td align="left" rowspan="1" colspan="1">45.21(3.86)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Skewed (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e080" xlink:type="simple"/></inline-formula>)</td>
<td align="left" rowspan="1" colspan="1">22.74(4.49)</td>
<td align="left" rowspan="1" colspan="1">19.09(4.47)</td>
<td align="left" rowspan="1" colspan="1">14.75(4.64)</td>
<td align="left" rowspan="1" colspan="1">11.92(4.64)</td>
<td align="left" rowspan="1" colspan="1">47.00(3.76)</td>
<td align="left" rowspan="1" colspan="1">47.38(3.72)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Skewed (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e081" xlink:type="simple"/></inline-formula>)</td>
<td align="left" rowspan="1" colspan="1">29.93(7.37)</td>
<td align="left" rowspan="1" colspan="1">26.35(6.56)</td>
<td align="left" rowspan="1" colspan="1">18.89(7.24)</td>
<td align="left" rowspan="1" colspan="1">15.36(6.78)</td>
<td align="left" rowspan="1" colspan="1">50.63(5.89)</td>
<td align="left" rowspan="1" colspan="1">50.32(5.74)</td>
</tr>
</tbody>
</table>
</alternatives><table-wrap-foot><fn id="nt102"><label/><p>Mean percentage reconstruction error on <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e082" xlink:type="simple"/></inline-formula> simulated samples are shown for six tree-building models considering (i) SD, (ii) SD+CD, (iii) SD+GD, (iv) SD+CD+GD (v) NJ and (vi) MP when the sampling distribution of cells is varied.</p></fn></table-wrap-foot></table-wrap>
<p>Finally, we performed simulation experiments to understand the effects of varying the numbers of chromosomes with multiple probes. We created a simulated dataset of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e083" xlink:type="simple"/></inline-formula> trees with eight probes where two pairs of probes each reside on two different chromosomes and the remaining four probes reside on four separate chromosomes. The probabilities of each of the SD, CD and GD events were fixed at <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e084" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e085" xlink:type="simple"/></inline-formula>, respectively. We report the results from this experiment in <xref ref-type="table" rid="pcbi-1003740-t003">Table 3</xref>, which compares the results from this experiment with our earlier result using only a single chromosome with two probes and four other probes located on separate chromosomes. The table shows that inclusion of the extra possible CD event results in higher accuracy for all the models except for the SD only model. The performance drop in the SD model is expected, as it would require more SD events to explain a greater number of missed CD events. The highest gain in performance is observed for SD+CD+GD model. These results show that our algorithm will tend to yield comparatively more advantage over the earlier work with more complicated scenarios of sharing probes across chromosomes, suggesting its utility will increase as improvements in technology allow for larger probe sets.</p>
<table-wrap id="pcbi-1003740-t003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003740.t003</object-id><label>Table 3</label><caption>
<title>Comparison of mean percentage reconstruction error (with standard deviation) of different phylogeny models on simulated data for two different probe settings.</title>
</caption><alternatives><graphic id="pcbi-1003740-t003-3" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003740.t003" xlink:type="simple"/>
<table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" rowspan="1" colspan="1">Number of Chromosomes with 2 Genes</td>
<td align="left" rowspan="1" colspan="1">SD</td>
<td align="left" rowspan="1" colspan="1">SD+CD</td>
<td align="left" rowspan="1" colspan="1">SD+GD</td>
<td align="left" rowspan="1" colspan="1">SD+CD+GD</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1">1</td>
<td align="left" rowspan="1" colspan="1">17.43(5.10)</td>
<td align="left" rowspan="1" colspan="1">15.91(4.59)</td>
<td align="left" rowspan="1" colspan="1">12.01(6.40)</td>
<td align="left" rowspan="1" colspan="1">10.84(3.88)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">2</td>
<td align="left" rowspan="1" colspan="1">19.01(5.61)</td>
<td align="left" rowspan="1" colspan="1">15.65(5.26)</td>
<td align="left" rowspan="1" colspan="1">11.49(4.18)</td>
<td align="left" rowspan="1" colspan="1">8.94(3.46)</td>
</tr>
</tbody>
</table>
</alternatives><table-wrap-foot><fn id="nt103"><label/><p>Mean percentage reconstruction error on <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e086" xlink:type="simple"/></inline-formula> simulated samples are shown for four tree-building models considering (i) SD, (ii) SD+CD, (iii) SD+GD and (iv) SD+CD+GD for two different cases when the number of chromosomes harboring two genes is 1 or 2.</p></fn></table-wrap-foot></table-wrap></sec><sec id="s3b">
<title>Application to real cervical and breast cancer data</title>
<p>We applied the algorithm to two sets of real data:</p>
<list list-type="bullet"><list-item>
<p>A set of CC <xref ref-type="bibr" rid="pcbi.1003740-Wangsa1">[49]</xref> FISH data consisting of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e087" xlink:type="simple"/></inline-formula> samples organized into <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e088" xlink:type="simple"/></inline-formula> primary samples of metastatic patients, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e089" xlink:type="simple"/></inline-formula> paired metastasis samples from the same patients, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e090" xlink:type="simple"/></inline-formula> primary samples from patients who did not progress to metastasis. Each sample consisted of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e091" xlink:type="simple"/></inline-formula> cells profiled on four FISH probes: <italic>LAMP3</italic> (Entrez Gene Id 27074) <xref ref-type="bibr" rid="pcbi.1003740-Kanao1">[55]</xref>, <italic>PROX1</italic> (5629) <xref ref-type="bibr" rid="pcbi.1003740-Wigle1">[56]</xref>, <italic>PRKAA1</italic> (5562) <xref ref-type="bibr" rid="pcbi.1003740-Huang1">[57]</xref> and <italic>CCND1</italic> (595) <xref ref-type="bibr" rid="pcbi.1003740-Fu1">[58]</xref>. All of these four genes are oncogenes, which typically show copy number gains in tumor cells. Each of the genes belongs to a distinct chromosome.</p>
</list-item><list-item>
<p>A set of BC <xref ref-type="bibr" rid="pcbi.1003740-HeselmeyerHaddad2">[36]</xref> FISH data consisting of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e092" xlink:type="simple"/></inline-formula> paired (from the same patient) ductal carcinoma in situ (DCIS) and invasive ductal breast carcinoma (IDC) samples with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e093" xlink:type="simple"/></inline-formula> cells per sample profiled on eight FISH probes: <italic>COX-2</italic> (5743) <xref ref-type="bibr" rid="pcbi.1003740-Howe1">[59]</xref>, <italic>MYC</italic> (4609) <xref ref-type="bibr" rid="pcbi.1003740-Wolfer1">[60]</xref>, <italic>CCND1</italic> <xref ref-type="bibr" rid="pcbi.1003740-Fu1">[58]</xref>, <italic>HER-2</italic> (2064) <xref ref-type="bibr" rid="pcbi.1003740-Tan1">[61]</xref>, <italic>ZNF217</italic> (7764) <xref ref-type="bibr" rid="pcbi.1003740-Nonet1">[62]</xref>, <italic>DBC2</italic> (23221) <xref ref-type="bibr" rid="pcbi.1003740-Hamaguchi1">[63]</xref>, <italic>CDH1</italic> (999) <xref ref-type="bibr" rid="pcbi.1003740-Birchmeier1">[64]</xref> and <italic>TP53</italic> (7157) <xref ref-type="bibr" rid="pcbi.1003740-Vousden1">[65]</xref>. The first five genes in this list are oncogenes and the last three genes are tumor suppressors. In tumor cells, tumor suppressors are typically associated with loss in copy numbers.</p>
</list-item></list>
<p>Among the eight genes in the BC dataset, <italic>DBC2</italic> and <italic>MYC</italic> reside on chromosome <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e094" xlink:type="simple"/></inline-formula> and <italic>HER-2</italic> and <italic>TP53</italic> reside on chromosome <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e095" xlink:type="simple"/></inline-formula>. The other four genes belong to distinct chromosomes. The oncogene Cyclin D1 (<italic>CCND1</italic>), which plays a role in many solid tumor types, is in both the BC and CC datasets. However, in some other tumor types, such as oral cancer, <italic>CCND1</italic> is part of a larger region with recurrent copy number gains on chromosome <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e096" xlink:type="simple"/></inline-formula> and other nearby genes have also been suggested to play a role in oncogenesis <xref ref-type="bibr" rid="pcbi.1003740-Huang2">[66]</xref>.</p>
<p>We evaluated the SD+CD+GD method by its effectiveness in reducing the parsimony score (total number of mutation events) of the resulting trees relative to the prior SD-only model. With the primary CC samples, the SD+CD+GD method found a lower-cost tree in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e097" xlink:type="simple"/></inline-formula> of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e098" xlink:type="simple"/></inline-formula> cases, a tree of equal weight in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e099" xlink:type="simple"/></inline-formula> cases, and a higher-cost tree in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e100" xlink:type="simple"/></inline-formula> cases. In each case of increased weight, the increase was by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e101" xlink:type="simple"/></inline-formula> and appears to result from the subtree regrafting heuristic used in handling GD events (see <xref ref-type="sec" rid="s5">Methods</xref>). These results suggest that the heuristic tree search may more often yield a suboptimal result for the SD+CD+GD model than it does for the SD-only model. The benefit of the more realistic model, however, outweighs the cost of this suboptimality in a large majority of instances. For trees derived from metastatic samples, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e102" xlink:type="simple"/></inline-formula> of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e103" xlink:type="simple"/></inline-formula> trees had lower weight for the full SD+CD+GD model and the remainder all had equal weight for the two models. Metastatic data sets tend to have fewer distinct cell types than do primary trees and thus may represent an easier optimization challenge. For the BC samples, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e104" xlink:type="simple"/></inline-formula> of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e105" xlink:type="simple"/></inline-formula> DCIS (samples 1–13) and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e106" xlink:type="simple"/></inline-formula> of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e107" xlink:type="simple"/></inline-formula> IDC (samples 14–26) had lower weight for the full model, with the remaining one sample having equal weight. Parsimony scores by tree are provided in <xref ref-type="fig" rid="pcbi-1003740-g005">Figures 5</xref> and <xref ref-type="fig" rid="pcbi-1003740-g006">6</xref>.</p>
<fig id="pcbi-1003740-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003740.g005</object-id><label>Figure 5</label><caption>
<title>Parsimony score comparison on the CC samples.</title>
<p>Comparison of (A) Primary and (B) Metastatic CC tumor progression tree weights built considering only SD and combined SD, CD and GD models. “Total Cell Type” refers to the total number of unique probe copy number configurations in the dataset, providing a lower bound on the minimum possible parsimony score for a given data set.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003740.g005" position="float" xlink:type="simple"/></fig><fig id="pcbi-1003740-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003740.g006</object-id><label>Figure 6</label><caption>
<title>Parsimony score comparison on the BC samples.</title>
<p>Comparison of DCIS (id 1–13) and IDC (id 14–26) BC tumor progression tree weights built considering only SD and combined SD, CD and GD models. “Cell Types” refers to the total number of unique probe copy number configurations in the dataset, providing a lower bound on the minimum possible parsimony score for a given data set.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003740.g006" position="float" xlink:type="simple"/></fig>
<p>We next evaluated effects of the improved model on overall tree topology, based on results of our prior work <xref ref-type="bibr" rid="pcbi.1003740-Chowdhury1">[46]</xref> that tree topology can significantly distinguish trees drawn from distinct progression stages of a given tumor type, with possible implications for the varying balance of diversification and selection acting on different stages of tumor progression. <xref ref-type="fig" rid="pcbi-1003740-g007">Figure 7</xref> quantifies the topology for each sample set based on fractions of cells inferred at each tree depth from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e108" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e109" xlink:type="simple"/></inline-formula>. The figure shows similar qualitative trends for both SD and SD+CD+GD methods, although with small quantitative differences. For example, both SD and SD+CD+GD trees recapitulate a tendency for CC primary trees to show relatively broad topology (<xref ref-type="fig" rid="pcbi-1003740-g007">Figure 7(A)</xref>) while CC metastatic trees prune rapidly beyond the first few tree levels (<xref ref-type="fig" rid="pcbi-1003740-g007">Figure 7(B)</xref>). There is, however, an overall shift to lower depth in the SD+CD+GD trees. For CC primary trees, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e110" xlink:type="simple"/></inline-formula> of cells are located in the first <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e111" xlink:type="simple"/></inline-formula> tree levels for SD versus <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e112" xlink:type="simple"/></inline-formula> for SD+CD+GD. For CC metastatic, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e113" xlink:type="simple"/></inline-formula> of cells are located in the first <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e114" xlink:type="simple"/></inline-formula> tree levels for SD versus <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e115" xlink:type="simple"/></inline-formula> for SD+CD+GD. For BC, the comparable numbers of cells in depths <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e116" xlink:type="simple"/></inline-formula> are <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e117" xlink:type="simple"/></inline-formula> for SD versus <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e118" xlink:type="simple"/></inline-formula> for SD+CD+GD in DCIS and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e119" xlink:type="simple"/></inline-formula> for SD versus <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e120" xlink:type="simple"/></inline-formula> for SD+CD+GD. These results suggest that the overall tree topology is not greatly sensitive to the combination of event types, although there is a noticeable shift towards lower depth in the full model.</p>
<fig id="pcbi-1003740-g007" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003740.g007</object-id><label>Figure 7</label><caption>
<title>Distribution of cells across different levels of tumor phylogenies.</title>
<p>Distribution of cells across different levels are shown for (A) Primary and (B) Metastatic CC, and (C) DCIS and (D) IDC BC tumor progression trees.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003740.g007" position="float" xlink:type="simple"/></fig>
<p>An additional evaluation was possible for the BC trees, because for the BC data, a probabilistic model and expert annotation based on two additional centromere probes made it possible to estimate the cell ploidy <xref ref-type="bibr" rid="pcbi.1003740-HeselmeyerHaddad2">[36]</xref>, which we define as the mode among the number of copies of the twenty-two autosomal chromosomes in a cell. Each cell in that dataset is thus annotated with an expert-curated overall ploidy estimate. We used these ploidy estimates to validate our inference of GD events based on whether edges assigned to GD events in our trees correspond to doubling of annotated ploidy. The percentage agreement by edge between GD events and annotated doubling in ploidy is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e121" xlink:type="simple"/></inline-formula> across DCIS trees and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e122" xlink:type="simple"/></inline-formula> across IDC trees. In <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e123" xlink:type="simple"/></inline-formula> of all inferred GD events, at least one endpoint of the corresponding edge is a Steiner node, and the uncertainty among whether a GD event occurred prior to or after the emergence of the Steiner node may explain why the per-edge agreement is not higher. Nonetheless, the data support the conclusion that inferred GD events are correct in a majority of cases.</p>
<p>As a final step, we repeated an approach developed in our prior work <xref ref-type="bibr" rid="pcbi.1003740-Chowdhury1">[46]</xref> to both validate the biological relevance of the trees and develop a practical application of them by treating the trees as sources of features for classification tasks applied to the CC data. For this purpose, we developed several sets of quantitative features based on inferred trees as well as comparative features derived from raw FISH probe counts. We used the following set of tree-based features:</p>
<list list-type="order"><list-item>
<p>Edge count: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e124" xlink:type="simple"/></inline-formula> features corresponding to fraction of progression tree edges showing gains and losses of each gene.</p>
</list-item><list-item>
<p>Tree level cell percentage: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e125" xlink:type="simple"/></inline-formula> features corresponding to the fraction of cells at each of the first <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e126" xlink:type="simple"/></inline-formula> levels for the progression trees.</p>
</list-item></list>
<p>We omitted a third feature set, bin count, used in our prior work because it is not easily comparable between SD and SD+CD+GD trees. We compared these features to four features derived directly from FISH probe counts without reference to the trees:</p>
<list list-type="order"><list-item>
<p>Mean gain and loss of individual genes.</p>
</list-item><list-item>
<p>Maximum copy number of individual genes.</p>
</list-item><list-item>
<p>An information theoretic measure, Shannon index <xref ref-type="bibr" rid="pcbi.1003740-Park1">[67]</xref>. For each gene, each combination of gene copy number and cellular ploidy represents a species. If we denote the frequency of species <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e127" xlink:type="simple"/></inline-formula> among all tumors by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e128" xlink:type="simple"/></inline-formula>, then Shannon index is given by the formula <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e129" xlink:type="simple"/></inline-formula>.</p>
</list-item><list-item>
<p>Simpson's index <xref ref-type="bibr" rid="pcbi.1003740-Park1">[67]</xref>, which is defined as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e130" xlink:type="simple"/></inline-formula>.</p>
</list-item></list>
<p>We used each feature set as input to the Matlab support vector machine (SVM) classifier with a quadratic kernel using <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e131" xlink:type="simple"/></inline-formula> rounds of bootstrap replicates per test with leave-one-out cross-validation to compute mean and standard deviation of accuracy. We used Matlab functions “svmtrain” and “svmclassify” for training and testing of the SVM classifier.</p>
<p>We then applied these methods for three classification tasks: (i) distinguishing primary samples that progressed to metastasis from their paired metastatic samples, (ii) distinguishing all primary samples from all metastatic samples, and (iii) distinguishing primary samples that metastasized from primary samples that did not metastasize. The first two tasks are relevant to identifying features that help us understand the differences in evolutionary mechanisms of primary and metastatic samples. The third is intended to model an important practical problem in cancer treatment: determining whether a given primary tumor will metastasize.</p>
<p><xref ref-type="fig" rid="pcbi-1003740-g008">Figure 8</xref> shows results on each task. For task (i), allowing SD+CD+GD events increased accuracy relative to SD trees from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e132" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e133" xlink:type="simple"/></inline-formula> for edge counts and from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e134" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e135" xlink:type="simple"/></inline-formula> for tree level cell count. The SD+CD+GD tree level cell count was the most effective of all features, tree-based or not. For task (ii), we similarly saw a substantial improvement in prediction accuracy for SD+CD+GD trees relative to SD trees. Classification accuracy improved from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e136" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e137" xlink:type="simple"/></inline-formula> for edge count features and from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e138" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e139" xlink:type="simple"/></inline-formula> for tree level features. In this case, both SD+CD+GD tree feature sets outperformed all other features sets, tree-based or otherwise. These results provide an indirect validation that using a more general tree model gets closer to the biological ground truth. For task (iii), we saw no improvement, with identical results for SD and SD+CD+GD trees for either feature set. All tree-based feature sets significantly outperformed all non-tree-based feature sets for this task. We conclude that the more realistic evolutionary models appear not to reveal any more information to the classifiers for predicting which primary samples will go on to metastasize than the SD trees, which were already quite effective for that task.</p>
<fig id="pcbi-1003740-g008" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003740.g008</object-id><label>Figure 8</label><caption>
<title>Classification results on the CC dataset.</title>
<p>Prediction accuracy on three different classification tasks of CC samples of an SVM classifier using tree-based and cell-based features. Each of the two tree-based features, edge count and tree level cell percentage, is derived from phylogenetic trees built using two different models of tumor progression, namely SD and combination of SD, CD and GD. Two cell-based features, average gain/loss and maximum copy number of each gene, and two information theoretic measures of cell heterogeneity, Shannon entropy and Simpson's index, are used.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003740.g008" position="float" xlink:type="simple"/></fig></sec><sec id="s3c">
<title>Dependence on data size</title>
<p>A key advantage of FISH for profiling tumor heterogeneity is that it makes it cost-effective to profile much larger numbers of cells than alternatives such as single-cell sequencing. To assess the practical importance of this advantage, we asked two related questions: (1) how many cells do we need per tumor to accurately reconstruct single-cell phylogenies and (2) how many tumors do we need to examine to identify reproducible, statistically significant features across trees.</p>
<p>We first assessed the number of cells needed per tumor by using our first simulated dataset of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e140" xlink:type="simple"/></inline-formula> trees described above with subsamples of varying numbers of cells per tumor, measuring reconstruction error of our SD+CD+GD algorithm with the weighted matching algorithm. The mean reconstruction errors calculated across <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e141" xlink:type="simple"/></inline-formula> cases for subsamples of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e142" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e143" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e144" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e145" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e146" xlink:type="simple"/></inline-formula> cells were <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e147" xlink:type="simple"/></inline-formula> (s.d. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e148" xlink:type="simple"/></inline-formula>), <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e149" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e150" xlink:type="simple"/></inline-formula>), <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e151" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e152" xlink:type="simple"/></inline-formula>), <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e153" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e154" xlink:type="simple"/></inline-formula>), and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e155" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e156" xlink:type="simple"/></inline-formula>) respectively. We can thus conclude that accuracy improves noticeably with increasing numbers of cells to at least <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e157" xlink:type="simple"/></inline-formula> cells per tumor before plateauing at approximately <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e158" xlink:type="simple"/></inline-formula> error.</p>
<p>We next assessed numbers of tumors needed to identify meaningful statistically significant properties of tumor classes by analysis of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e159" xlink:type="simple"/></inline-formula> CC paired and primary samples. We randomly subsampled from among the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e160" xlink:type="simple"/></inline-formula> pairs and, for each subsample, calculated the following three tree statistics on progression trees inferred from our SD+CD+GD algorithm:</p>
<list list-type="order"><list-item>
<p>Shannon index based on distribution of cells across different tree levels.</p>
</list-item><list-item>
<p>Weighted mean depth of the trees.</p>
</list-item><list-item>
<p>Sum of differences of fractional gain and loss of each gene across the tree edges.</p>
</list-item></list>
<p>We then compared distributions of each statistic on primary vs. metastatic trees by a Wilcoxon signed rank test. As the samples were selected randomly, no ordering among the samples was considered. <xref ref-type="fig" rid="pcbi-1003740-g009">Figure 9</xref> shows the 1-sided p-values of the three statistical tests when the number of randomly selected samples are increased from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e161" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e162" xlink:type="simple"/></inline-formula>. The figure shows that ability to distinguish the two tumor subsets improves with increasing number of tumors. While the threshold for significance varies by statistic, each reaches weak significance (p<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e163" xlink:type="simple"/></inline-formula>0.05) between <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e164" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e165" xlink:type="simple"/></inline-formula> tumors. We can thus conclude that finding reproducible features distinguishing the tree types requires on the order of tens of tumors, at least for the candidate probe sets examined here.</p>
<fig id="pcbi-1003740-g009" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003740.g009</object-id><label>Figure 9</label><caption>
<title>Wilcoxon signed rank test results for separating primary CC samples from the metastases.</title>
<p>Wilcoxon signed rank test 1-sided p-values for separating the primary CC samples from the metastases across subsets of increasing numbers of randomly selected tumor samples. For each set of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e166" xlink:type="simple"/></inline-formula> tumors, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e167" xlink:type="simple"/></inline-formula> samples were randomly selected from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e168" xlink:type="simple"/></inline-formula> paired CC primary and metastatic tumors with atleast one of each type and then Wilcoxon signed rank test was used to calculate the p-values for separating the primary from metastases based on three different statistics: (A) Shannon index calculated using the distribution of cells across different tree levels, (B) weighted mean depth of the trees and (C) sum of differences of fractional gain and loss of each gene across the tree edges.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003740.g009" position="float" xlink:type="simple"/></fig>
<p>Taken together, these two results demonstrate that building accurate trees on a large enough scale to distinguish meaningfully primary from metastatic trees requires data sets with roughly the order of thousands of single cells (hundreds of cells per tumor for tens of tumors), a scale of data that has so far been achieved only by FISH studies of tumor heterogeneity. We note, however, that one would expect these numbers to vary depending on the degree of tumor heterogeneity, the classes of trees one wishes to distinguish, and the specific markers examined.</p>
</sec></sec><sec id="s4">
<title>Discussion</title>
<p>This paper has presented novel theory and algorithms for reconstructing evolutionary trajectories of gene copy numbers in solid tumors in terms of a model of tumor evolution incorporating changes at the scale of single gene probes, full chromosomes, or all probes in the genome. We have derived algorithms to reconstruct maximum parsimony sequences of events, and thus estimates of evolutionary distance, between pairs of cells assayed by FISH probes. We have further incorporated these inferences into a method for building phylogenies of hundreds of cells in single tumors. These methods have been added to FISHtrees <xref ref-type="bibr" rid="pcbi.1003740-Chowdhury1">[46]</xref>, our software for inferring tumor phylogenies from single-cell copy number data. Experimental results on simulated data confirm the ability of the new methods to improve phylogenetic inference accuracy relative to simpler models by adding CD and GD events that model chromosome-scale and whole-genome copy number changes that are frequently observed in tumor evolution. Application to observed human tumor data shows that these extended evolutionary models are able to yield more parsimonious tree reconstructions and that the resulting trees lead to improved accuracy in prediction tasks related to diagnosis and prognosis.</p>
<p>In future work, we hope to extend the theory developed here to handle even more realistic models and more challenging data types. One important direction will be advancing the theory developed here to improve upon the heuristic approximations used in the Steiner tree inference to better approach the goal of finding globally optimal trees for the most computationally challenging FISH data sets. The evolutionary models, likewise, might be further extended to go beyond the three mutational event types considered here to better approximate the numerous distinct mutational mechanisms by which copy number profiles of tumor cells might evolve. The data sets studied here do not include geographical information about locations of individual cells in the tumor, but other data sets for analyzing tumor heterogeneity do include such geographical information <xref ref-type="bibr" rid="pcbi.1003740-Gerlinger1">[38]</xref>, <xref ref-type="bibr" rid="pcbi.1003740-Almendro1">[68]</xref>. We expect it would be interesting to construct phylogenies with distance functions that combine spatial distance in three dimensions with combinatorial distance measures between the cell count patterns, as we have studied here. Further, while FISH for the moment retains a unique advantage in the large number of cells it can profile, one can reasonably anticipate that single-cell sequencing will eventually become practical for comparable cross-tumor studies. There would thus be value in extending the theory developed here to single-cell sequencing data, a goal that would pose substantial algorithmic challenges due to the much larger number and variety of markers it can reveal as well as the more complicated error models it would entail. Finally, we hope to make more use of these single-tumor phylogenetic models in clinically relevant prediction tasks and further explore the biological insights one can gain from more accurate tumor phylogenies.</p>
</sec><sec id="s5" sec-type="methods">
<title>Methods</title>
<p>Our main theoretical result is a method for inferring minimum distances between two states within a copy number phylogeny when duplication/loss of single genes (SD), duplication/loss of all genes on a common chromosome (CD), and duplication of all genes in the full genome (GD) events are possible. We first establish some mathematical results and then develop an algorithm for accurate distance computation. This algorithm then becomes a subroutine in a heuristic Steiner tree algorithm for inferring copy number phylogenies in the presence of SD, CD, and GD events. We introduce some notation required for specifying and proving the theoretical results:</p>
<list list-type="order"><list-item>
<p><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e169" xlink:type="simple"/></inline-formula>: A set of copy numbers of one or more genes <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e170" xlink:type="simple"/></inline-formula>, which we call a “configuration”. When <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e171" xlink:type="simple"/></inline-formula> are clear from the context, we use <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e172" xlink:type="simple"/></inline-formula> as shorthand.</p>
</list-item><list-item>
<p><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e173" xlink:type="simple"/></inline-formula>: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e174" xlink:type="simple"/></inline-formula> or rectilinear distance between two configurations <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e175" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e176" xlink:type="simple"/></inline-formula>.</p>
</list-item><list-item>
<p><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e177" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e178" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e179" xlink:type="simple"/></inline-formula>: Distance between two configurations <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e180" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e181" xlink:type="simple"/></inline-formula> when considering SD+CD (s,ch), SD+GD (s,g), or SD+CD+GD (s,ch,g) events, respectively.</p>
</list-item><list-item>
<p><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e182" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e183" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e184" xlink:type="simple"/></inline-formula>: Operations corresponding to single chromosome (CD) events corresponding to either gain (g), loss (l), or either (no subscript) of all genes belonging to the same chromosome <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e185" xlink:type="simple"/></inline-formula> from starting configuration <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e186" xlink:type="simple"/></inline-formula>, while keeping the copy numbers of genes on other chromosomes unchanged.</p>
</list-item><list-item>
<p><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e187" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e188" xlink:type="simple"/></inline-formula>: Operations corresponding to doubling (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e189" xlink:type="simple"/></inline-formula>) or halving (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e190" xlink:type="simple"/></inline-formula>) counts of all genes in configuration <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e191" xlink:type="simple"/></inline-formula>. In the case of halving, it is assumed that all genes in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e192" xlink:type="simple"/></inline-formula> have even counts.</p>
</list-item><list-item>
<p><italic>even</italic>, <italic>odd</italic> configuration: A configuration (copy number profile) <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e193" xlink:type="simple"/></inline-formula> is denoted an <italic>even</italic> configuration if <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e194" xlink:type="simple"/></inline-formula>. Otherwise, it is denoted an <italic>odd</italic> configuration.</p>
</list-item><list-item>
<p><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e195" xlink:type="simple"/></inline-formula>: The set of “nearest even” values for each <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e196" xlink:type="simple"/></inline-formula> in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e197" xlink:type="simple"/></inline-formula>, i.e., if <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e198" xlink:type="simple"/></inline-formula> then <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e199" xlink:type="simple"/></inline-formula> For example, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e200" xlink:type="simple"/></inline-formula>.</p>
</list-item><list-item>
<p>An operation <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e201" xlink:type="simple"/></inline-formula> is <italic>valid</italic> on a configuration <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e202" xlink:type="simple"/></inline-formula> if <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e203" xlink:type="simple"/></inline-formula> satisfies <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e204" xlink:type="simple"/></inline-formula> for all <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e205" xlink:type="simple"/></inline-formula> given predefined lower-bound LB and upper-bound UB. Otherwise, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e206" xlink:type="simple"/></inline-formula> is <italic>invalid</italic> on <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e207" xlink:type="simple"/></inline-formula>. LB = 0 and UB = 9 is used in the sofware, but the theory only requires that UB <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e208" xlink:type="simple"/></inline-formula> LB.</p>
</list-item><list-item>
<p>A sequence of operations <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e209" xlink:type="simple"/></inline-formula> is <italic>boundary-sensitive</italic> on configuration <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e210" xlink:type="simple"/></inline-formula> if <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e211" xlink:type="simple"/></inline-formula> satisfies <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e212" xlink:type="simple"/></inline-formula> for all <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e213" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e214" xlink:type="simple"/></inline-formula>. We use <italic>boundary-insensitive</italic> to refer to a sequence on which this condition has not been checked.</p>
</list-item></list>
<sec id="s5a">
<title>Progression model considering SD and CD events</title>
<p>We develop the theory for inference of the Steiner (unsampled or extinct cell configurations) nodes in the paths formed by the sequence of gene copy number gains and losses from an initial configuration <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e215" xlink:type="simple"/></inline-formula> to a final configuration <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e216" xlink:type="simple"/></inline-formula>. We first extend the prior theory to account for SD and CD events. Our model assumes that on division of a tumor cell, the configuration can change either by gain or loss of one copy of a single gene (SD event) or by gain or loss of one copy of each gene on a single chromosome (CD event). For example, a configuration of four genes <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e217" xlink:type="simple"/></inline-formula> with the first two genes on the same chromosome might evolve in a single mutational event to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e218" xlink:type="simple"/></inline-formula> by an SD event or to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e219" xlink:type="simple"/></inline-formula> by a CD event. We propose Algorithm 1, provided in <xref ref-type="fig" rid="pcbi-1003740-g010">Figure 10</xref>, to calculate the minimum number of steps required to transform <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e220" xlink:type="simple"/></inline-formula> into <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e221" xlink:type="simple"/></inline-formula> considering SD and CD events, where, without loss of generality, we assume that the genes on a common chromosome have consecutive indices <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e222" xlink:type="simple"/></inline-formula> in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e223" xlink:type="simple"/></inline-formula>. Algorithm 1 also identifies a minimum-length sequence of events, although this sequence is not necessarily unique. For example, if there are four genes on one chromosome and we want to get from configuration <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e224" xlink:type="simple"/></inline-formula> to configuration <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e225" xlink:type="simple"/></inline-formula>, then a shortest sequence of SD and CD events would be CD to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e226" xlink:type="simple"/></inline-formula>, SD to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e227" xlink:type="simple"/></inline-formula>, SD to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e228" xlink:type="simple"/></inline-formula>, and SD to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e229" xlink:type="simple"/></inline-formula>. Other orders of the same four events are also possible.</p>
<fig id="pcbi-1003740-g010" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003740.g010</object-id><label>Figure 10</label><caption>
<title>Algorithm 1 pseudocode.</title>
<p>Algorithm 1 converts a set of boundary-insensitive events to boundary-sensitive events; lines 3–17 are used for chromosomes on which all CD events are losses and lines 18–32 are used for chromosomes on which all CD events are gains.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003740.g010" position="float" xlink:type="simple"/></fig>
<p>The above example focuses on a single chromosome because as explained below, the problem of finding the shortest SD+CD path can be solved one chromosome at a time. We begin by establishing the following lemmas:</p>
<sec id="s5a1">
<title>Lemma 1</title>
<p><italic>A minimum-length boundary-insensitive sequence of CD and SD events cannot have both a gain of chromosome </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e230" xlink:type="simple"/></inline-formula><italic> and a loss of the same chromosome </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e231" xlink:type="simple"/></inline-formula><italic>.</italic></p>
<p><italic>Proof.</italic> By contradiction. Suppose <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e232" xlink:type="simple"/></inline-formula> is a sequence of events that has both a gain and a loss of the same chromosome. Then removing one gain and one loss produces a new sequence that is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e233" xlink:type="simple"/></inline-formula> shorter and has the same final state.</p>
</sec><sec id="s5a2">
<title>Lemma 2</title>
<p><italic>For any gene </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e234" xlink:type="simple"/></inline-formula><italic>, a minimum-length boundary-insensitive sequence of events cannot have both a gain of </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e235" xlink:type="simple"/></inline-formula><italic> and a loss of </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e236" xlink:type="simple"/></inline-formula><italic>.</italic></p>
<p><italic>Proof.</italic> By contradiction. Suppose <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e237" xlink:type="simple"/></inline-formula> is a sequence of events that has both a gain of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e238" xlink:type="simple"/></inline-formula> and a loss of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e239" xlink:type="simple"/></inline-formula>. Then removing one gain and one loss produces a new sequence that is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e240" xlink:type="simple"/></inline-formula> shorter and has the same final state.</p>
</sec><sec id="s5a3">
<title>Lemma 3</title>
<p><italic>The following sequence of events describes a minimum-length boundary-insensitive sequence of SD and CD events for transforming </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e241" xlink:type="simple"/></inline-formula><italic> into </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e242" xlink:type="simple"/></inline-formula><italic>:</italic></p>
<list list-type="order"><list-item>
<p><italic>Perform CD events in arbitrary order starting from </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e243" xlink:type="simple"/></inline-formula><italic> so that each successive event decreases the </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e244" xlink:type="simple"/></inline-formula><italic> distance between the intermediate configurations </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e245" xlink:type="simple"/></inline-formula><italic> and </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e246" xlink:type="simple"/></inline-formula><italic> until any further CD event will increase the </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e247" xlink:type="simple"/></inline-formula><italic> distance. We define the final configuration reached after this step to be </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e248" xlink:type="simple"/></inline-formula><italic>.</italic></p>
</list-item><list-item>
<p><italic>Perform SD events in abitrary order starting at </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e249" xlink:type="simple"/></inline-formula><italic> so that the </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e250" xlink:type="simple"/></inline-formula><italic> distance between </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e251" xlink:type="simple"/></inline-formula><italic> and </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e252" xlink:type="simple"/></inline-formula><italic> decreases on each step until the distance becomes zero. The total number of events required will be </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e253" xlink:type="simple"/></inline-formula><italic>.</italic></p>
</list-item></list>
<p><italic>Proof.</italic> Since the sequence of events is boundary-insensitive and addition is commutative, we can change the order of events without changing the endpoints or the cost. Therefore, we assume that all CD events precede all SD events. The construction of the above sequence of the events ensures that it uses a maximum number of possible CD events. If we denote the number of genes on the common chromosome by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e254" xlink:type="simple"/></inline-formula> and the number of CD events by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e255" xlink:type="simple"/></inline-formula>, then the total number of events required is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e256" xlink:type="simple"/></inline-formula>. If there exists a shorter sequences of events to transform <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e257" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e258" xlink:type="simple"/></inline-formula>, then that sequence must have a larger number <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e259" xlink:type="simple"/></inline-formula> of CD events, which is contradicted by the construction. Thus, the number of events is minimized.</p>
<p>The above lemmas show how to construct a minimum-length boundary-insensitive sequence of events. We now establish that this sequence can be used to derive a minimum-length boundary-sensitive sequence of events:</p>
</sec><sec id="s5a4">
<title>Lemma 4</title>
<p><italic>For any boundary-insensitive minimum-length sequence of SD and CD events </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e260" xlink:type="simple"/></inline-formula><italic> transforming </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e261" xlink:type="simple"/></inline-formula><italic> to </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e262" xlink:type="simple"/></inline-formula><italic>, there exists a boundary-sensitive sequence of SD and CD events </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e263" xlink:type="simple"/></inline-formula><italic> such that </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e264" xlink:type="simple"/></inline-formula><italic> and </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e265" xlink:type="simple"/></inline-formula><italic> have equal length.</italic></p>
<p><italic>Proof.</italic> We analyze one chromosome at a time because in this section the events on different chromosomes are independent. By Lemma 1, on any specific chromosome all the CD events are gains or all the CD events are losses. We analyze in detail the case in which all CD events are losses; the case of all gains is symmetric.</p>
<p>The proof is constructive. Specifically, we will show that the upper part of Algorithm 1 will transform a boundary-insensitive <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e266" xlink:type="simple"/></inline-formula> to a boundary-sensitive <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e267" xlink:type="simple"/></inline-formula> of equal cost solely by reordering events. Without loss of generality, suppose the only CD events in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e268" xlink:type="simple"/></inline-formula> are chromosome losses. There is a symmetric algorithm, shown as the lower part of Algorithm 1, for the case where all the chromosome events are gains. We add the following definition:</p>
<p>A gene <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e269" xlink:type="simple"/></inline-formula> is defined as unidirectional with respect to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e270" xlink:type="simple"/></inline-formula> if there are no gains of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e271" xlink:type="simple"/></inline-formula> in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e272" xlink:type="simple"/></inline-formula>. A gene <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e273" xlink:type="simple"/></inline-formula> is defined as bidirectional with respect to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e274" xlink:type="simple"/></inline-formula> if <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e275" xlink:type="simple"/></inline-formula> includes gains of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e276" xlink:type="simple"/></inline-formula>. For unidirectional genes, the order of chromosome losses and gene losses can never cause a boundary to be crossed because the copy numbers are monotonically decreasing. The situations we need to avoid are:</p>
<list list-type="order"><list-item>
<p>A bidirectional gene <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e277" xlink:type="simple"/></inline-formula> has copy number UB and the next operation affecting <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e278" xlink:type="simple"/></inline-formula> is a gain of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e279" xlink:type="simple"/></inline-formula>.</p>
</list-item><list-item>
<p>A bidirectional gene <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e280" xlink:type="simple"/></inline-formula> has copy number LB and the next operation affecting <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e281" xlink:type="simple"/></inline-formula> is a chromosome loss.</p>
</list-item></list>
<p>Chromosome gains are excluded by Lemma 1 and our assumption without loss of generality that all CD events are losses. Gene losses for bidirectional genes are exluded by Lemma 2.</p>
<p>To prove correctness of the algorithm, we note that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e282" xlink:type="simple"/></inline-formula> can never cross LB for the unidirectional genes because their net loss equals their total loss. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e283" xlink:type="simple"/></inline-formula> can never cross LB for the bidirectional genes, because when their copy number is at LB, a gene gain must still be pending and the gene gains alternate in the first while loop until no chromosome losses or gene gains are remaining. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e284" xlink:type="simple"/></inline-formula> can never cross UB for the unidirectional genes because they have only losses. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e285" xlink:type="simple"/></inline-formula> can never cross UB for the bidirectional genes because of the test <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e286" xlink:type="simple"/></inline-formula> (line 8) before any gene gain is done. Further, all the chromosome losses will be used because one chromosome loss happens on each pass through the first while loop, if any chromosome losses remain. All gene gains in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e287" xlink:type="simple"/></inline-formula> will be used in the first while loop because the net change for any gene must keep its copy number below UB. All the gene losses for the unidirectional genes are used in the second while loop. The unordered set of events and total change in each gene is thus preserved between <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e288" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e289" xlink:type="simple"/></inline-formula>, while <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e290" xlink:type="simple"/></inline-formula> guarantees that the sequence is boundary-sensitive.</p>
<p>We use the preceding result to derive the main theorem of this section, which estabishes a method to find a minimum-length sequence of SD and CD events transforming <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e291" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e292" xlink:type="simple"/></inline-formula>. As in the proof of Lemma 4, we can consider each chromosome separately since each SD and CD event affects only one chromosome.</p>
</sec><sec id="s5a5">
<title>Theorem 5</title>
<p><italic>Assume we partition the gene list by chromosomes such that each chromosome </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e293" xlink:type="simple"/></inline-formula><italic> corresponds to a consecutive subset of genes </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e294" xlink:type="simple"/></inline-formula><italic>. Further define </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e295" xlink:type="simple"/></inline-formula><italic> and </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e296" xlink:type="simple"/></inline-formula><italic>. Then we can construct a minimum-length boundary-sensitive sequence of events transforming </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e297" xlink:type="simple"/></inline-formula><italic> to </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e298" xlink:type="simple"/></inline-formula><italic> by constructing a minimum-length boundary-sensitive sequence of events </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e299" xlink:type="simple"/></inline-formula><italic> transforming </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e300" xlink:type="simple"/></inline-formula><italic> to </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e301" xlink:type="simple"/></inline-formula><italic> for each chromosome </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e302" xlink:type="simple"/></inline-formula><italic> and interleaving each </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e303" xlink:type="simple"/></inline-formula><italic> in arbitrary order.</italic></p>
<p><italic>Proof.</italic> The distance function can be decomposed into individual parts for genes belonging to distinct chromosomes as follows:<disp-formula id="pcbi.1003740.e304"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003740.e304" xlink:type="simple"/></disp-formula></p>
<p>Because the distance cost can be decomposed in this way and each CD or SD event contributes to only a single term of the outer sum, we can minimize the cost of events for each chromosome independently and combine the events from distinct chromosomes in arbitrary order without changing the value of the objective function. Likewise, since these each chromosome affects a disjoint subset of genes, boundary-sensitive sequences for each chromosome will yield a boundary-sensitive sequence across all genes.</p>
</sec></sec><sec id="s5b">
<title>Progression model combining SD, CD and GD events</title>
<p>We now extend the theory from the prior section to include SD, CD, and GD events. We assume in the proofs and discussion below that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e305" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e306" xlink:type="simple"/></inline-formula> denotes lexicographical ordering. This assumption reduces the number of cases in several proofs. If instead, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e307" xlink:type="simple"/></inline-formula>, the proofs are identical or symmetric except that GD events may be used in the wrong direction (halving instead of doubling). The use of halving events is corrected heuristically by a procedure of subtree pruning and regrafting at line 24 of the pseudocode of Algorithm 3, described below, and in FISHtrees. We will produce the complete proof by deriving a series of lemmas for three cases that together will cover all possible <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e308" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e309" xlink:type="simple"/></inline-formula>:</p>
<sec id="s5b1">
<title>Lemma 6</title>
<p><italic>For an an even configuration </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e310" xlink:type="simple"/></inline-formula><italic>, if there exists an optimal sequence of copy number change events from </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e311" xlink:type="simple"/></inline-formula><italic> to </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e312" xlink:type="simple"/></inline-formula><italic> composed of one or more SD and CD events and a single GD event, then the following sequence of events is of minimum length:</italic></p>
<list list-type="order"><list-item>
<p><italic>SD and CD events to transform </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e313" xlink:type="simple"/></inline-formula><italic> into </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e314" xlink:type="simple"/></inline-formula><italic>, constructed as described in the first named subsection of Methods</italic></p>
</list-item><list-item>
<p><italic>A single GD event to transform </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e315" xlink:type="simple"/></inline-formula><italic> into </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e316" xlink:type="simple"/></inline-formula><italic>.</italic></p>
</list-item></list>
<p><italic>Proof.</italic> We prove the statement by considering the three different ways that can be used to transform <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e317" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e318" xlink:type="simple"/></inline-formula> using single GD and multiple SD and CD events. The statement of the lemma presents one case and the remaining two possibilities are as follows:</p>
<list list-type="order"><list-item>
<p>A single GD event to transform <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e319" xlink:type="simple"/></inline-formula> into <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e320" xlink:type="simple"/></inline-formula> and then multiple SD and CD events to transform <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e321" xlink:type="simple"/></inline-formula> into <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e322" xlink:type="simple"/></inline-formula>.</p>
</list-item><list-item>
<p>Multiple SD and CD events to transform <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e323" xlink:type="simple"/></inline-formula> to an intermediate configuration <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e324" xlink:type="simple"/></inline-formula>, a single GD event to transform <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e325" xlink:type="simple"/></inline-formula> into <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e326" xlink:type="simple"/></inline-formula>, and multiple SD and CD events to transform <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e327" xlink:type="simple"/></inline-formula> into <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e328" xlink:type="simple"/></inline-formula>.</p>
</list-item></list>
<p>We show that for either of these alternative cases, we can produce a sequence satisfying the conditions of the lemma with equal or smaller length. For the first case, we have to show that<disp-formula id="pcbi.1003740.e329"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003740.e329" xlink:type="simple"/></disp-formula></p>
<p>It can be seen that <disp-formula id="pcbi.1003740.e330"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003740.e330" xlink:type="simple"/></disp-formula></p>
<p>If all genes are located on distinct chromosomes, then, <disp-formula id="pcbi.1003740.e331"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003740.e331" xlink:type="simple"/></disp-formula>and the claim follows directly.</p>
<p>Now, assume the genes are partitioned into sets of chromosomes such that each chromosome <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e332" xlink:type="simple"/></inline-formula> corresponds to a consecutive subset of genes <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e333" xlink:type="simple"/></inline-formula>. We focus on a specific chromosome <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e334" xlink:type="simple"/></inline-formula> and consider the problem of updating just genes of that chromosome from their values in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e335" xlink:type="simple"/></inline-formula> to their values in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e336" xlink:type="simple"/></inline-formula>. Either zero or a positive even number of CD events must be performed to convert these genes from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e337" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e338" xlink:type="simple"/></inline-formula> and along with zero or a positive even number of SD operations on each gene. If an odd number of CD operations are performed on <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e339" xlink:type="simple"/></inline-formula>, then we get an odd configuration and at least one or an odd number of SD operations must be performed on each gene of this odd configuration to convert it to the even configuration <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e340" xlink:type="simple"/></inline-formula>. But a combination of single SD operations acting on each of the individual genes in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e341" xlink:type="simple"/></inline-formula> has the same effect as a single CD operation on chromosome <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e342" xlink:type="simple"/></inline-formula> and this combination therefore cannot be minimal. Therefore, the number of CD operations is even. If a total of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e343" xlink:type="simple"/></inline-formula> CD operations and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e344" xlink:type="simple"/></inline-formula> SD operations are needed to convert <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e345" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e346" xlink:type="simple"/></inline-formula>, then a total of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e347" xlink:type="simple"/></inline-formula> CD operations and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e348" xlink:type="simple"/></inline-formula> SD operations are needed to convert <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e349" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e350" xlink:type="simple"/></inline-formula>. So, <disp-formula id="pcbi.1003740.e351"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003740.e351" xlink:type="simple"/></disp-formula></p>
<p>For alternative 2, we can write the distance function as: <disp-formula id="pcbi.1003740.e352"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003740.e352" xlink:type="simple"/></disp-formula></p>
<p>The distance function for our proposed optimal sequence can be written as: <disp-formula id="pcbi.1003740.e353"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003740.e353" xlink:type="simple"/></disp-formula></p>
<p>As shown for alternative 1, we can write: <disp-formula id="pcbi.1003740.e354"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003740.e354" xlink:type="simple"/></disp-formula>which implies <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e355" xlink:type="simple"/></inline-formula>.</p>
</sec><sec id="s5b2">
<title>Lemma 7</title>
<p><italic>For an odd configuration </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e356" xlink:type="simple"/></inline-formula><italic>, if the optimal sequence of copy number change events from </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e357" xlink:type="simple"/></inline-formula><italic> to </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e358" xlink:type="simple"/></inline-formula><italic> is composed of one or more SD and CD events, followed by a single GD event, followed by one or more SD and CD events, then the configuration from which the final set of SD and CD events take place is a member of </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e359" xlink:type="simple"/></inline-formula><italic>.</italic></p>
<p><italic>Proof.</italic> We denote the intermediate configuration following the GD event to be <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e360" xlink:type="simple"/></inline-formula>. We will show by contradiction that if there exists any optimal sequence of events for which <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e361" xlink:type="simple"/></inline-formula> then there must exist an alternative, shorter sequence of events. Define the full sequence of events from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e362" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e363" xlink:type="simple"/></inline-formula> to be <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e364" xlink:type="simple"/></inline-formula>, subdivided into the subsequences <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e365" xlink:type="simple"/></inline-formula>. First, we note that if there is any duplicated event in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e366" xlink:type="simple"/></inline-formula> then we can construct a more parsimonious solution by replacing the duplicate in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e367" xlink:type="simple"/></inline-formula> with a single copy of the event in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e368" xlink:type="simple"/></inline-formula>. Therefore, no event appears more than once in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e369" xlink:type="simple"/></inline-formula>. There are exactly two SD and CD events that can increase the count of any given probe (SD of that probe or CD of its chromosome) and similarly exactly two events that can decrease the count of any probe. Thus, no probe's value changes by more than <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e370" xlink:type="simple"/></inline-formula> in the transition from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e371" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e372" xlink:type="simple"/></inline-formula> in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e373" xlink:type="simple"/></inline-formula>. Finally, we note that since <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e374" xlink:type="simple"/></inline-formula> immediately follows a GD event, it must be an even configuration. Together, these assertions establish that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e375" xlink:type="simple"/></inline-formula> for any optimal path <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e376" xlink:type="simple"/></inline-formula>.</p>
</sec><sec id="s5b3">
<title>Lemma 8</title>
<p><italic>For an odd configuration </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e377" xlink:type="simple"/></inline-formula><italic>, if the optimal sequence of copy number change events from </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e378" xlink:type="simple"/></inline-formula><italic> to </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e379" xlink:type="simple"/></inline-formula><italic> is composed of one or more SD and CD events and a single GD event, then the optimum sequence of events follows the following path:</italic></p>
<list list-type="order"><list-item>
<p><italic>Generate </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e380" xlink:type="simple"/></inline-formula><italic>.</italic></p>
</list-item><list-item>
<p><italic>SD and CD events to transform </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e381" xlink:type="simple"/></inline-formula><italic> into </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e382" xlink:type="simple"/></inline-formula><italic>.</italic></p>
</list-item><list-item>
<p><italic>A single GD event to transform </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e383" xlink:type="simple"/></inline-formula><italic> into </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e384" xlink:type="simple"/></inline-formula><italic>.</italic></p>
</list-item><list-item>
<p><italic>SD and CD events to transform </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e385" xlink:type="simple"/></inline-formula><italic> into </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e386" xlink:type="simple"/></inline-formula><italic>.</italic></p>
</list-item></list>
<p><italic>The optimal sequence is an element of the set of sequences generated using this procedure.</italic></p>
<p><italic>Proof.</italic> The proof follows from application of Lemma 6 and Lemma 7. As <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e387" xlink:type="simple"/></inline-formula> is an odd configuration, the final step cannot be a GD event. So, the last steps have to be a combination of SD and/or CD events; in that case, Lemma 7 shows that the configuration reached as a result of GD must be a member of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e388" xlink:type="simple"/></inline-formula>, which we denote by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e389" xlink:type="simple"/></inline-formula>. Lemma 6 shows that to reach any member of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e390" xlink:type="simple"/></inline-formula>, which are even configurations, the optimal sequence of events is to generate SD and CD events to transform <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e391" xlink:type="simple"/></inline-formula> into <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e392" xlink:type="simple"/></inline-formula> first and then to perform a GD event to transform <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e393" xlink:type="simple"/></inline-formula> into <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e394" xlink:type="simple"/></inline-formula>. This sequence of events matches the sequence proposed in the lemma.</p>
<p>The above lemmas allow us to derive Algorithm 2 to transform <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e395" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e396" xlink:type="simple"/></inline-formula> using a minimum-length combination of SD, CD and GD events. The pseudocode of Algorithm 2 is presented in <xref ref-type="fig" rid="pcbi-1003740-g011">Figure 11</xref>. To illustrate the algorithm, suppose <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e397" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e398" xlink:type="simple"/></inline-formula>, where we will assume we have two probes on a single chromosome. Since <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e399" xlink:type="simple"/></inline-formula> is an odd configuration, we first generate its nearest even neighbors <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e400" xlink:type="simple"/></inline-formula> and calculate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e401" xlink:type="simple"/></inline-formula>. The algorithm tests for two stopping conditions by which a solution can be constructed (lines <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e402" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e403" xlink:type="simple"/></inline-formula> in Algorithm 2), neither of which applies to any of the solutions at this point. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e404" xlink:type="simple"/></inline-formula> are therefore considered for the next iteration. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e405" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e406" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e407" xlink:type="simple"/></inline-formula> are odd configurations, so we generate their neighbor sets <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e408" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e409" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e410" xlink:type="simple"/></inline-formula>. One stopping condition is satisfied for each of the elements of these neighbor sets, so <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e411" xlink:type="simple"/></inline-formula>,<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e412" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e413" xlink:type="simple"/></inline-formula> are each considered in turn as the next candidate neighbor. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e414" xlink:type="simple"/></inline-formula> is an even configuration, so we only need to consider one possible stopping condition (line 11), which it satisfies, so it is also considered as a possible next candidate neighbor. Among the four possibilities, we will conclude that using <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e415" xlink:type="simple"/></inline-formula> as the immediate neighbor will lead to the smallest possible number of steps when accumulating SD+CD events from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e416" xlink:type="simple"/></inline-formula> to the candidate, a single GD event from the candidate to its double, and SD+CD events from that double to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e417" xlink:type="simple"/></inline-formula>. Following some postprocessing updates (procedure CheckSrcNeighbor), the algorithm computes a minimum-length solution of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e418" xlink:type="simple"/></inline-formula> and returns the corresponding length <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e419" xlink:type="simple"/></inline-formula>.</p>
<fig id="pcbi-1003740-g011" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003740.g011</object-id><label>Figure 11</label><caption>
<title>Algorithm 2 pseudocode.</title>
<p>Algorithm 2 finds the shortest directed distance between two configurations using SD, CD, and GD events.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003740.g011" position="float" xlink:type="simple"/></fig>
<p>Algorithm 2 satisfies the following theorem, which constitutes the major result of this section:</p>
</sec><sec id="s5b4">
<title>Theorem 9</title>
<p><italic>Algorithm 2 returns the minimum distance between two configurations </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e420" xlink:type="simple"/></inline-formula><italic> and </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e421" xlink:type="simple"/></inline-formula><italic>, where </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e422" xlink:type="simple"/></inline-formula><italic>.</italic></p>
<p><italic>Proof.</italic> We use induction on the minimum number of steps to get from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e423" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e424" xlink:type="simple"/></inline-formula>, which we denote by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e425" xlink:type="simple"/></inline-formula>.</p>
<p><bold>Base case.</bold> For the base case, we have <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e426" xlink:type="simple"/></inline-formula>. We must consider two sub-cases: (i) <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e427" xlink:type="simple"/></inline-formula> and (ii) <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e428" xlink:type="simple"/></inline-formula>. For case (i), <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e429" xlink:type="simple"/></inline-formula> is an even configuration. The condition at line <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e430" xlink:type="simple"/></inline-formula> in Algorithm 2 fails and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e431" xlink:type="simple"/></inline-formula> is considered for the next iteration. In the next iteration, if <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e432" xlink:type="simple"/></inline-formula> is an even configuration then the condition at line <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e433" xlink:type="simple"/></inline-formula> is now satisfied and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e434" xlink:type="simple"/></inline-formula> is assigned the value <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e435" xlink:type="simple"/></inline-formula> in CheckSrcNeighbor procedure called at line <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e436" xlink:type="simple"/></inline-formula> in the main procedure. If <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e437" xlink:type="simple"/></inline-formula> is an odd configuration, then the condition at line <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e438" xlink:type="simple"/></inline-formula> is satisfied for each of the even neighbors of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e439" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e440" xlink:type="simple"/></inline-formula> is assigned the value <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e441" xlink:type="simple"/></inline-formula> in the CheckSrcNeighbor procedure called at line <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e442" xlink:type="simple"/></inline-formula>. For case (ii), one of the conditions at line <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e443" xlink:type="simple"/></inline-formula> or line <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e444" xlink:type="simple"/></inline-formula> is satisified in the first iteration of the algorithm depending on whether <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e445" xlink:type="simple"/></inline-formula> is an even or odd configuration and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e446" xlink:type="simple"/></inline-formula> is assigned the value <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e447" xlink:type="simple"/></inline-formula> at line <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e448" xlink:type="simple"/></inline-formula> or <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e449" xlink:type="simple"/></inline-formula>.</p>
<p><bold>Induction step.</bold> For the induction hypothesis, we assume that the the algorithm uses the minimum number of steps for all cases where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e450" xlink:type="simple"/></inline-formula>. Then, suppose that an adversary selects an example that has complexity <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e451" xlink:type="simple"/></inline-formula>. Let us assume that the penultimate configuration in the optimal solution is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e452" xlink:type="simple"/></inline-formula>. If <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e453" xlink:type="simple"/></inline-formula> is an even configuration, then it can be reached from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e454" xlink:type="simple"/></inline-formula> by using (i) a GD event, (ii) an SD event, or (iii) a CD event. According to the induction hypothesis, for each of these cases, Algorithm 2 uses the minimum number of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e455" xlink:type="simple"/></inline-formula> steps to generate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e456" xlink:type="simple"/></inline-formula> from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e457" xlink:type="simple"/></inline-formula>. If there is at least one GD event in the optimal solution, then Algorithm 2 first calculates <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e458" xlink:type="simple"/></inline-formula>. The induction hypothesis ensures that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e459" xlink:type="simple"/></inline-formula> and thus, Algorithm 2 returns a solution with a maximum length of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e460" xlink:type="simple"/></inline-formula>. If there is no GD event in the optimal solution from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e461" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e462" xlink:type="simple"/></inline-formula>, then Algorithm 2 uses the procedure described in the first named subsection of <xref ref-type="sec" rid="s5">Methods</xref> to calculate the optimal path from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e463" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e464" xlink:type="simple"/></inline-formula> and combining it with the optimal solution from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e465" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e466" xlink:type="simple"/></inline-formula>, it returns the optimal path between <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e467" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e468" xlink:type="simple"/></inline-formula>. Now, if <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e469" xlink:type="simple"/></inline-formula> is an odd configuration, then going from the penultimate configuration <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e470" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e471" xlink:type="simple"/></inline-formula> can only be achieved using either an SD or a CD event. For odd <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e472" xlink:type="simple"/></inline-formula>, Algorithm 2 first generates its even neighbors <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e473" xlink:type="simple"/></inline-formula> which are steps <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e474" xlink:type="simple"/></inline-formula> from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e475" xlink:type="simple"/></inline-formula>. If <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e476" xlink:type="simple"/></inline-formula>, the proof follows directly from the inductive hypothesis. If <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e477" xlink:type="simple"/></inline-formula>, then there is a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e478" xlink:type="simple"/></inline-formula> such that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e479" xlink:type="simple"/></inline-formula> is located on the optimal path between <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e480" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e481" xlink:type="simple"/></inline-formula> formed using SD and CD events only. If <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e482" xlink:type="simple"/></inline-formula> is the total number of genes with odd copy number values in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e483" xlink:type="simple"/></inline-formula>, then <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e484" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e485" xlink:type="simple"/></inline-formula>. Using the induction hypothesis, we can write,<disp-formula id="pcbi.1003740.e486"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003740.e486" xlink:type="simple"/></disp-formula></p>
<p>As Algorithm 2 uses the procedure described in the first named subsection of <xref ref-type="sec" rid="s5">Methods</xref> to construct the optimal path between <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e487" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e488" xlink:type="simple"/></inline-formula>, we can see that it returns a path with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e489" xlink:type="simple"/></inline-formula>.</p>
</sec></sec><sec id="s5c">
<title>Runtime analysis of Algorithm 2</title>
<p>We provide an upper bound on the runtime of Algorithm 2 as a function of the number of genes <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e490" xlink:type="simple"/></inline-formula> and their copy numbers. Considering all three events, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e491" xlink:type="simple"/></inline-formula>, the maximum number of doublings required is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e492" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e493" xlink:type="simple"/></inline-formula> denotes the copy number of the first gene where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e494" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e495" xlink:type="simple"/></inline-formula>. At each stage of the algorithm, the maximum number of nodes generated as a result of a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e496" xlink:type="simple"/></inline-formula> operation is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e497" xlink:type="simple"/></inline-formula>. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e498" xlink:type="simple"/></inline-formula> SD and CD events are used to create each of those <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e499" xlink:type="simple"/></inline-formula> nodes in the case of an odd configuration. So, the maximum number of required <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e500" xlink:type="simple"/></inline-formula> operations is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e501" xlink:type="simple"/></inline-formula>. Therefore, the number of operations performed during the execution of Algorithm 2 is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e502" xlink:type="simple"/></inline-formula>.</p>
</sec><sec id="s5d">
<title>Generating tumor phylogenies</title>
<p>We implemented Algorithm 2 and integrated it with our approximate median-joining-based algorithm from our prior SD-only FISHtrees <xref ref-type="bibr" rid="pcbi.1003740-Chowdhury1">[46]</xref> code. The key steps of this algorithm are summarized in Algorithm 3 (<xref ref-type="fig" rid="pcbi-1003740-g012">Figure 12</xref>), which we describe at a high level here. The phylogeny algorithm first relies on Algorithm 2 to derive a matrix of pairwise distances between observed cell configurations, which are treated as states on a truncated integer lattice of dimension <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e503" xlink:type="simple"/></inline-formula> with a maximum value (UB) set to 9 in the current code. It then repeatedly samples triplets of nodes, identifying as potential Steiner nodes those that agree in each dimension with at least one of the triplet. Those Steiner nodes that lead to reduced minimum spanning tree cost are added to the node set, with the process is repeated until there is no further improvement. Finally a series of post-processing steps are performed to prune Steiner nodes that are not needed for the final tree and to apply subtree regrafting to correct for a potential source of suboptimality arising from the fact that the core phylogeny algorithm assumes symmetric distances but GD operations are asymmetric.</p>
<fig id="pcbi-1003740-g012" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003740.g012</object-id><label>Figure 12</label><caption>
<title>Algorithm 3 pseudocode.</title>
<p>This figure provided the main steps in the algorithm to generate tumor progression trees; generate_distance_matrix uses Algorithm 2 on each distinct pair of nodes in the set of nodes it is passed. To compute Minimum Spanning Tree (function <italic>mst</italic> called at lines 4 and 16), we implemented Prim's algorithm.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003740.g012" position="float" xlink:type="simple"/></fig></sec><sec id="s5e">
<title>Inferring tumor phylogenies using Neighbor Joining (NJ) and Maximum Parsimony (MP) methods</title>
<p>Neighbor Joining (NJ) and Maximum Parsimony (MP) methods have been commonly used for building single-tumor phylogenies <xref ref-type="bibr" rid="pcbi.1003740-Subramanian1">[16]</xref>, <xref ref-type="bibr" rid="pcbi.1003740-Navin2">[54]</xref> and we therefore compared their accuracy to that of our own methods in inferring copy number phylogenies. We applied these two traditional phylogenetic tree building methods to build tumor progression trees using the individual copy number profiles as taxa and compared them with the trees built using our algorithms. We used implementations of both approaches in MEGA version 6 <xref ref-type="bibr" rid="pcbi.1003740-Tamura1">[69]</xref>. For NJ, we used Euclidean distances between cell copy number profiles to build the pairwise distance matrix. For MP, we treated copy number profiles of the genes in individual cells as sequences of arbitrary phylogenetic characters. We used the “Close-Neighbor-Interchange on Random Trees” search method. For the parameters “Number of Initial Trees” and “MP search level”, we used values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e504" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003740.e505" xlink:type="simple"/></inline-formula> respectively.</p>
</sec></sec></body>
<back>
<ack>
<p>We thank Darawalee Wangsa for collecting the CC data and we thank Lissa Berroa Garcia, Amanda Bradley, and Clarymar Ortiz-Melendez for help in collecting the BC data.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1003740-Pennington1"><label>1</label>
<mixed-citation publication-type="other" xlink:type="simple">Pennington G, Smith CA, Shackney S, Schwartz R (2006) Cancer phylogenetics from single-cell assays. Technical report, Carnegie Mellon University.</mixed-citation>
</ref>
<ref id="pcbi.1003740-Pennington2"><label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pennington</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Smith</surname><given-names>CA</given-names></name>, <name name-style="western"><surname>Shackney</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Schwartz</surname><given-names>R</given-names></name> (<year>2007</year>) <article-title>Reconstructing tumor phylogenies from heterogeneous single-cell data</article-title>. <source>J Bioinform Comput Biol</source> <volume>5</volume>: <fpage>407</fpage>–<lpage>427</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003740-Attolini1"><label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Attolini</surname><given-names>CSO</given-names></name>, <name name-style="western"><surname>Michor</surname><given-names>F</given-names></name> (<year>2009</year>) <article-title>Evolutionary theory of cancer</article-title>. <source>Ann NY Acad Sci</source> <volume>1168</volume>: <fpage>23</fpage>–<lpage>51</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003740-Desper1"><label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Desper</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Jiang</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Kallioniemi</surname><given-names>OP</given-names></name>, <name name-style="western"><surname>Moch</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Papadimitriou</surname><given-names>CH</given-names></name>, <etal>et al</etal>. (<year>1999</year>) <article-title>Inferring tree models of oncogenesis from comparative genomic hybridization data</article-title>. <source>J Comput Biol</source> <volume>6</volume>: <fpage>37</fpage>–<lpage>51</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003740-Desper2"><label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Desper</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Jiang</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Kallioniemi</surname><given-names>OP</given-names></name>, <name name-style="western"><surname>Moch</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Papadimitriou</surname><given-names>CH</given-names></name>, <etal>et al</etal>. (<year>2000</year>) <article-title>Distance-based reconstruction of tree models for oncogenesis</article-title>. <source>J Comput Biol</source> <volume>7</volume>: <fpage>789</fpage>–<lpage>803</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003740-Szabo1"><label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Szabo</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Boucher</surname><given-names>K</given-names></name> (<year>2002</year>) <article-title>Estimating an oncogenetic tree when false negatives and positives are present</article-title>. <source>Math Biosci</source> <volume>176</volume>: <fpage>219</fpage>–<lpage>236</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003740-McGlynn1"><label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>McGlynn</surname><given-names>KA</given-names></name>, <name name-style="western"><surname>Edmonson</surname><given-names>MN</given-names></name>, <name name-style="western"><surname>Michielli</surname><given-names>RA</given-names></name>, <name name-style="western"><surname>London</surname><given-names>WT</given-names></name>, <name name-style="western"><surname>Lin</surname><given-names>WY</given-names></name>, <etal>et al</etal>. (<year>2002</year>) <article-title>A phylogenetic analysis identifies heterogeneity among hepatocellular carcinomas</article-title>. <source>Hepatology</source> <volume>36</volume>: <fpage>1341</fpage>–<lpage>1348</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003740-Beerenwinkel1"><label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Beerenwinkel</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Rahnenführer</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Däumer</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Hoffmann</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Kaiser</surname><given-names>R</given-names></name>, <etal>et al</etal>. (<year>2005</year>) <article-title>Learning multiple evolutionary pathways from cross-sectional data</article-title>. <source>J Comput Biol</source> <volume>12</volume>: <fpage>584</fpage>–<lpage>598</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003740-Beerenwinkel2"><label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Beerenwinkel</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Rahnenführer</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Kaiser</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Hoffmann</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Selbig</surname><given-names>J</given-names></name>, <etal>et al</etal>. (<year>2005</year>) <article-title>Mtreemix: a software package for learning and using mixture models of mutagenetic trees</article-title>. <source>Bioinformatics</source> <volume>21</volume>: <fpage>2106</fpage>–<lpage>2107</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003740-Bogojeska1"><label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bogojeska</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Alexa</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Altmann</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Lengauer</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Rahnenführer</surname><given-names>J</given-names></name> (<year>2008</year>) <article-title>Rtreemix: an R package for estimating evolutionary pathways and genetic progression scores</article-title>. <source>Bioinformatics</source> <volume>24</volume>: <fpage>2391</fpage>–<lpage>2392</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003740-Bogojeska2"><label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bogojeska</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Lengauer</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Rahnenführer</surname><given-names>J</given-names></name> (<year>2008</year>) <article-title>Stability analysis of mixtures of mutagenetic trees</article-title>. <source>BMC Bioinformatics</source> <volume>9</volume>: <fpage>165</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003740-Frumkin1"><label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Frumkin</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Wasserstrom</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Itzkovitz</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Stern</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Harmelin</surname><given-names>A</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>Cell lineage analysis of a mouse tumor</article-title>. <source>Cancer Res</source> <volume>68</volume>: <fpage>5924</fpage>–<lpage>5931</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003740-Shlush1"><label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Shlush</surname><given-names>LI</given-names></name>, <name name-style="western"><surname>Chapal-Ilani</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Adar</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Pery</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Maruvka</surname><given-names>Y</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Cell lineage analysis of acute leukemia relapse uncovers the role of replication-rate heterogeneity and microsatellite instability</article-title>. <source>Blood</source> <volume>120</volume>: <fpage>603</fpage>–<lpage>612</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003740-Liu1"><label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Liu</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Bandyopadhyay</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Ranka</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Baudis</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Kahveci</surname><given-names>T</given-names></name> (<year>2009</year>) <article-title>Inferring progression models for CGH data</article-title>. <source>Bioinformatics</source> <volume>25</volume>: <fpage>2208</fpage>–<lpage>2215</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003740-Letouz1"><label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Letouzé</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Allory</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Bollet</surname><given-names>MA</given-names></name>, <name name-style="western"><surname>Radvanyi</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Guyon</surname><given-names>F</given-names></name> (<year>2010</year>) <article-title>Analysis of the copy number profiles of several tumor samples from the same patient reveals the successive steps in tumorigenesis</article-title>. <source>Genome Biol</source> <volume>11</volume>: <fpage>R76</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003740-Subramanian1"><label>16</label>
<mixed-citation publication-type="other" xlink:type="simple">Subramanian A, Shackney S, Schwartz R (2012) Inference of tumor phylogenies from genomic assays on heterogeneous samples. J Biomed Biotechnol: 797812.</mixed-citation>
</ref>
<ref id="pcbi.1003740-Campbell1"><label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Campbell</surname><given-names>PJ</given-names></name>, <name name-style="western"><surname>Pleasance</surname><given-names>ED</given-names></name>, <name name-style="western"><surname>Stephens</surname><given-names>PJ</given-names></name>, <name name-style="western"><surname>Dicks</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Rance</surname><given-names>R</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>Subclonal phylogenetic structures in cancer revealed by ultra-deep sequencing</article-title>. <source>Proc Natl Acad Sci USA</source> <volume>105</volume>: <fpage>13081</fpage>–<lpage>13086</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003740-Notta1"><label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Notta</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Mullighan</surname><given-names>CG</given-names></name>, <name name-style="western"><surname>Wang</surname><given-names>JC</given-names></name>, <name name-style="western"><surname>Poeppl</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Doulatov</surname><given-names>S</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Evolution of human BCR-ABL1 lymphoblastic leukaemia-initiating cells</article-title>. <source>Nature</source> <volume>469</volume>: <fpage>362</fpage>–<lpage>367</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003740-Tao1"><label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tao</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Ruan</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Yeh</surname><given-names>SH</given-names></name>, <name name-style="western"><surname>Lu</surname><given-names>X</given-names></name>, <name name-style="western"><surname>Wang</surname><given-names>Y</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Rapid growth of a hepatocellular carcinoma and the driving mutations revealed by cell-population genetic analysis of whole-genome data</article-title>. <source>Proc Natl Acad Sci USA</source> <volume>108</volume>: <fpage>12042</fpage>–<lpage>12047</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003740-Hou1"><label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hou</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Song</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Zhu</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Zhang</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Tao</surname><given-names>Y</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Single-cell exome sequencing and monoclonal evolution of a JAK2-negative myeloproliferative neoplasm</article-title>. <source>Cell</source> <volume>148</volume>: <fpage>873</fpage>–<lpage>885</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003740-Fearon1"><label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fearon</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Vogelstein</surname><given-names>B</given-names></name> (<year>1990</year>) <article-title>A genetic model for colorectal tumorigenesis</article-title>. <source>Cell</source> <volume>61</volume>: <fpage>759</fpage>–<lpage>767</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003740-Hglund1"><label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Höglund</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Gisselsson</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Mandahl</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Johansson</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Mertens</surname><given-names>F</given-names></name>, <etal>et al</etal>. (<year>2001</year>) <article-title>Multivariate analyses of genomic imbalances in solid tumors reveal distinct and converging pathways of karyotypic evolution</article-title>. <source>Genes Chromosomes Cancer</source> <volume>31</volume>: <fpage>156</fpage>–<lpage>171</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003740-Newton1"><label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Newton</surname><given-names>MA</given-names></name> (<year>2002</year>) <article-title>Discovering combinations of genomic aberrations associated with cancer</article-title>. <source>J Am Stat Assoc</source> <volume>97</volume>: <fpage>931</fpage>–<lpage>942</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003740-Bilke1"><label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bilke</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Chen</surname><given-names>QR</given-names></name>, <name name-style="western"><surname>Westerman</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Schwab</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Catchpoole</surname><given-names>D</given-names></name>, <etal>et al</etal>. (<year>2005</year>) <article-title>Inferring a tumor progression model for neuroblastoma from genomic data</article-title>. <source>J Clin Oncol</source> <volume>23</volume>: <fpage>7322</fpage>–<lpage>7331</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003740-Hjelm1"><label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hjelm</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Höglund</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Lagergren</surname><given-names>J</given-names></name> (<year>2006</year>) <article-title>New probabilistic network models and algorithms for oncogenesis</article-title>. <source>J Comput Biol</source> <volume>13</volume>: <fpage>853</fpage>–<lpage>865</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003740-Gerstung1"><label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gerstung</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Baudis</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Moch</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Beerenwinkel</surname><given-names>N</given-names></name> (<year>2009</year>) <article-title>Quantifying cancer progression with conjunctive bayesian networks</article-title>. <source>Bioinformatics</source> <volume>25</volume>: <fpage>2809</fpage>–<lpage>2815</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003740-Oesper1"><label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Oesper</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Mahmoody</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Raphael</surname><given-names>BJ</given-names></name> (<year>2013</year>) <article-title>Theta: Inferring intra-tumor heterogeneity from high-throughput DNA sequencing data</article-title>. <source>Genome Biol</source> <volume>14</volume>: <fpage>R80</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003740-ShahrabiFarahani1"><label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Shahrabi Farahani</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Lagergren</surname><given-names>J</given-names></name> (<year>2013</year>) <article-title>Learning oncogenetic networks by reducing to mixed integer linear programming</article-title>. <source>PLoS ONE</source> <volume>8</volume>: <fpage>e65773</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003740-Greenman1"><label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Greenman</surname><given-names>CD</given-names></name>, <name name-style="western"><surname>Pleasance</surname><given-names>ED</given-names></name>, <name name-style="western"><surname>Newman</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Yang</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Fu</surname><given-names>B</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Estimation of rearrangement phylogeny for cancer genomes</article-title>. <source>Genome Res</source> <volume>22</volume>: <fpage>346</fpage>–<lpage>361</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003740-Purdom1"><label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Purdom</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Ho</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Grasso</surname><given-names>CS</given-names></name>, <name name-style="western"><surname>Quist</surname><given-names>MJ</given-names></name>, <name name-style="western"><surname>Cho</surname><given-names>RJ</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>Methods and challenges in timing chromosomal abnormalities within cancer samples</article-title>. <source>Bioinformatics</source> <volume>29</volume>: <fpage>3113</fpage>–<lpage>3120</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003740-Janocko1"><label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Janocko</surname><given-names>LE</given-names></name>, <name name-style="western"><surname>Brown</surname><given-names>KA</given-names></name>, <name name-style="western"><surname>Smith</surname><given-names>CA</given-names></name>, <name name-style="western"><surname>Gu</surname><given-names>LP</given-names></name>, <name name-style="western"><surname>Pollice</surname><given-names>AA</given-names></name> (<year>2001</year>) <article-title>Distinctive patterns of Her-2/neu, c-myc, and cyclin D1 gene amplification by fluorescence in situ hybridization in primary breast cancers</article-title>. <source>Cytometry</source> <volume>46</volume>: <fpage>136</fpage>–<lpage>149</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003740-HeselmeyerHaddad1"><label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Heselmeyer-Haddad</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Chaudhri</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Stoltzfus</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Cheng</surname><given-names>JC</given-names></name>, <name name-style="western"><surname>Wilber</surname><given-names>K</given-names></name>, <etal>et al</etal>. (<year>2002</year>) <article-title>Detection of chromosomal aneuploidies and gene copy number changes in fine needle aspirates is a specific, sensitive, and objective genetic test for the diagnosis of breast cancer</article-title>. <source>Cancer Res</source> <volume>62</volume>: <fpage>2365</fpage>–<lpage>2369</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003740-Snuderl1"><label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Snuderl</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Fazlollahi</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Le</surname><given-names>LP</given-names></name>, <name name-style="western"><surname>Nitta</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Zhelyazkova</surname><given-names>BH</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Mosaic amplification of multiple receptor tyrosine kinase genes in glioblastoma</article-title>. <source>Cancer Cell</source> <volume>20</volume>: <fpage>810</fpage>–<lpage>817</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003740-Martins1"><label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Martins</surname><given-names>FC</given-names></name>, <name name-style="western"><surname>De</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Almendro</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Gönen</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Park</surname><given-names>SY</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Evolutionary pathways in BRCA1-associated breast tumors</article-title>. <source>Cancer Discov</source> <volume>2</volume>: <fpage>503</fpage>–<lpage>511</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003740-Szerlip1"><label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Szerlip</surname><given-names>NJ</given-names></name>, <name name-style="western"><surname>Pedraza</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Chakravarty</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Azim</surname><given-names>M</given-names></name>, <name name-style="western"><surname>McGuire</surname><given-names>J</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Intratumoral heterogeneity of receptor tyrosine kinases EGFR and PDGFRA amplification in glioblastoma defines subpopulations with distinct growth factor response</article-title>. <source>Proc Natl Acad Sci USA</source> <volume>109</volume>: <fpage>3041</fpage>–<lpage>3046</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003740-HeselmeyerHaddad2"><label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Heselmeyer-Haddad</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Berroa Garcia</surname><given-names>LY</given-names></name>, <name name-style="western"><surname>Bradley</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Ortiz-Melendez</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Lee</surname><given-names>WJ</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Single-cell genetic analysis of ductal carcinoma in situ and invasive breast cancer reveals enormous tumor heterogeneity, yet conserved genomic imbalances and gain of <italic>MYC</italic> during progression</article-title>. <source>Am J Pathol</source> <volume>181</volume>: <fpage>1807</fpage>–<lpage>1822</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003740-Navin1"><label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Navin</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Kendall</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Troge</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Andrews</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Rodgers</surname><given-names>L</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Tumour evolution inferred by single-cell sequencing</article-title>. <source>Nature</source> <volume>472</volume>: <fpage>90</fpage>–<lpage>94</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003740-Gerlinger1"><label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gerlinger</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Rowan</surname><given-names>AJ</given-names></name>, <name name-style="western"><surname>Horswell</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Larkin</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Endesfelder</surname><given-names>D</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Intratumor heterogeneity and branched evolution revealed by multiregion sequencing</article-title>. <source>N Engl J Med</source> <volume>366</volume>: <fpage>883</fpage>–<lpage>892</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003740-Xu1"><label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Xu</surname><given-names>X</given-names></name>, <name name-style="western"><surname>Hou</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Yin</surname><given-names>X</given-names></name>, <name name-style="western"><surname>Bao</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Tang</surname><given-names>A</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Single-cell exome sequencing reveals single-nucleotide mutation characteristics of a kidney tumor</article-title>. <source>Cell</source> <volume>148</volume>: <fpage>886</fpage>–<lpage>895</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003740-Marusyk1"><label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Marusyk</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Polyak</surname><given-names>K</given-names></name> (<year>2010</year>) <article-title>Tumor heterogeneity: causes and consequences</article-title>. <source>Biochim Biophys Acta (BBA)-Reviews on Cancer</source> <volume>1805</volume>: <fpage>105</fpage>–<lpage>117</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003740-Nowell1"><label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nowell</surname><given-names>PC</given-names></name> (<year>1976</year>) <article-title>The clonal evolution of tumor cell populations</article-title>. <source>Science</source> <volume>194</volume>: <fpage>23</fpage>–<lpage>28</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003740-Ding1"><label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ding</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Raphael</surname><given-names>BJ</given-names></name>, <name name-style="western"><surname>Chen</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Wendl</surname><given-names>MC</given-names></name> (<year>2013</year>) <article-title>Advances for studying clonal evolution in cancer</article-title>. <source>Cancer Lett</source> <volume>340</volume>: <fpage>212</fpage>–<lpage>219</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003740-Urbschat1"><label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Urbschat</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Rahnenführer</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Henn</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Feiden</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Wemmert</surname><given-names>S</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Clonal cytogenetic progression within intratumorally heterogeneous meningiomas predicts tumor recurrence</article-title>. <source>Int J Oncol</source> <volume>39</volume>: <fpage>1601</fpage>–<lpage>1608</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003740-Sprouffske1"><label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sprouffske</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Pepper</surname><given-names>JW</given-names></name>, <name name-style="western"><surname>Maley</surname><given-names>CC</given-names></name> (<year>2011</year>) <article-title>Accurate reconstruction of the temporal order of mutations in neoplastic progression</article-title>. <source>Cancer Prev Res</source> <volume>4</volume>: <fpage>1135</fpage>–<lpage>1144</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003740-Saitou1"><label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Saitou</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Nei</surname><given-names>M</given-names></name> (<year>1987</year>) <article-title>The neighbor-joining method: a new method for reconstructing phylogenetic trees</article-title>. <source>Mol Biol Evol</source> <volume>4</volume>: <fpage>406</fpage>–<lpage>425</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003740-Chowdhury1"><label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Chowdhury</surname><given-names>SA</given-names></name>, <name name-style="western"><surname>Shackney</surname><given-names>SE</given-names></name>, <name name-style="western"><surname>Heselmeyer-Haddad</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Ried</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Schäffer</surname><given-names>AA</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>Phylogenetic analysis of multiprobe fluorescence in situ hybridization data from tumor cell populations</article-title>. <source>Bioinformatics</source> <volume>29</volume>: <fpage>i189</fpage>–<lpage>i198</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003740-Sottoriva1"><label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sottoriva</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Spiteri</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Shibata</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Curtis</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Tavaré</surname><given-names>S</given-names></name> (<year>2013</year>) <article-title>Single-molecule genomic data delineate patient-specific tumor profiles and cancer stem cell organization</article-title>. <source>Cancer Res</source> <volume>73</volume>: <fpage>41</fpage>–<lpage>49</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003740-Bandelt1"><label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bandelt</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Forster</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Röhl</surname><given-names>A</given-names></name> (<year>1999</year>) <article-title>Median-joining networks for inferring intraspecific phylogenies</article-title>. <source>Mol Biol Evol</source> <volume>16</volume>: <fpage>37</fpage>–<lpage>48</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003740-Wangsa1"><label>49</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wangsa</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Heselmeyer-Haddad</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Ried</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Eriksson</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Schäffer</surname><given-names>AA</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>Fluorescence in situ hybridization markers for prediction of cervical lymph node metastases</article-title>. <source>Am J Pathol</source> <volume>175</volume>: <fpage>2637</fpage>–<lpage>2645</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003740-Rahnenfhrer1"><label>50</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rahnenführer</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Beerenwinkel</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Schulz</surname><given-names>WA</given-names></name>, <name name-style="western"><surname>Hartmann</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Deimling</surname><given-names>AV</given-names></name>, <etal>et al</etal>. (<year>2005</year>) <article-title>Estimating cancer survival and clinical outcome based on genetic tumor progression scores</article-title>. <source>Bioinformatics</source> <volume>21</volume>: <fpage>2438</fpage>–<lpage>2446</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003740-Lin1"><label>51</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lin</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Rajan</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Moret</surname><given-names>BME</given-names></name> (<year>2012</year>) <article-title>A metric for phylogenetic trees based on matching</article-title>. <source>IEEE/ACM Trans Comput Biol Bioinform</source> <volume>9</volume>: <fpage>1014</fpage>–<lpage>1022</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003740-Kuhn1"><label>52</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kuhn</surname><given-names>HW</given-names></name> (<year>1955</year>) <article-title>The Hungarian method for the assignment problem</article-title>. <source>Nav Res Logist Q</source> <volume>2</volume>: <fpage>83</fpage>–<lpage>97</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003740-Robinson1"><label>53</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Robinson</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Foulds</surname><given-names>LR</given-names></name> (<year>1981</year>) <article-title>Comparison of phylogenetic trees</article-title>. <source>Math Biosci</source> <volume>53</volume>: <fpage>131</fpage>–<lpage>147</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003740-Navin2"><label>54</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Navin</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Krasnitz</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Rodgers</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Cook</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Meth</surname><given-names>J</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Inferring tumor progression from genomic heterogeneity</article-title>. <source>Genome Res</source> <volume>20</volume>: <fpage>68</fpage>–<lpage>80</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003740-Kanao1"><label>55</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kanao</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Enomoto</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Kimura</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Fujita</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Nakashima</surname><given-names>R</given-names></name>, <etal>et al</etal>. (<year>2005</year>) <article-title>Overexpression of <italic>LAMP3/TSC403/DC-LAMP</italic> promotes metastasis in uterine cervical cancer</article-title>. <source>Cancer Res</source> <volume>65</volume>: <fpage>8640</fpage>–<lpage>8645</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003740-Wigle1"><label>56</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wigle</surname><given-names>JT</given-names></name>, <name name-style="western"><surname>Oliver</surname><given-names>G</given-names></name> (<year>1999</year>) <article-title><italic>PROX1</italic> function is required for the development of the murine lymphatic system</article-title>. <source>Cell</source> <volume>98</volume>: <fpage>769</fpage>–<lpage>778</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003740-Huang1"><label>57</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Huang</surname><given-names>FY</given-names></name>, <name name-style="western"><surname>Chiu</surname><given-names>PM</given-names></name>, <name name-style="western"><surname>Tam</surname><given-names>KF</given-names></name>, <name name-style="western"><surname>Kwok</surname><given-names>YKY</given-names></name>, <name name-style="western"><surname>Lau</surname><given-names>ET</given-names></name>, <etal>et al</etal>. (<year>2006</year>) <article-title>Semi-quantitative fluorescent PCR analysis identifies <italic>PRKAA1</italic> on chromosome 5 as a potential candidate cancer gene of cervical cancer</article-title>. <source>Gynecol Oncol</source> <volume>103</volume>: <fpage>219</fpage>–<lpage>225</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003740-Fu1"><label>58</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fu</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Wang</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Li</surname><given-names>Z</given-names></name>, <name name-style="western"><surname>Sakamaki</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Pestell</surname><given-names>R</given-names></name> (<year>2004</year>) <article-title>Minireview: Cyclin D1: normal and abnormal functions</article-title>. <source>Endocrinology</source> <volume>145</volume>: <fpage>5439</fpage>–<lpage>5447</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003740-Howe1"><label>59</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Howe</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Subbaramaiah</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Brown</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Dannenberg</surname><given-names>A</given-names></name> (<year>2001</year>) <article-title>Cyclooxygenase-2: a target for the prevention and treatment of breast cancer</article-title>. <source>Endocr Relat Cancer</source> <volume>8</volume>: <fpage>97</fpage>–<lpage>114</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003740-Wolfer1"><label>60</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wolfer</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Ramaswamy</surname><given-names>S</given-names></name> (<year>2011</year>) <article-title><italic>MYC</italic> and metastasis</article-title>. <source>Cancer Res</source> <volume>71</volume>: <fpage>2034</fpage>–<lpage>2037</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003740-Tan1"><label>61</label>
<mixed-citation publication-type="other" xlink:type="simple">Tan M, Yu D (2007) Molecular mechanisms of erbB2-mediated breast cancer chemoresistance. In: Breast Cancer Chemosensitivity, Springer. pp. 119–129.</mixed-citation>
</ref>
<ref id="pcbi.1003740-Nonet1"><label>62</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nonet</surname><given-names>GH</given-names></name>, <name name-style="western"><surname>Stampfer</surname><given-names>MR</given-names></name>, <name name-style="western"><surname>Chin</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Gray</surname><given-names>JW</given-names></name>, <name name-style="western"><surname>Collins</surname><given-names>CC</given-names></name>, <etal>et al</etal>. (<year>2001</year>) <article-title>The <italic>ZNF217</italic> gene amplified in breast cancers promotes immortalization of human mammary epithelial cells</article-title>. <source>Cancer Res</source> <volume>61</volume>: <fpage>1250</fpage>–<lpage>1254</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003740-Hamaguchi1"><label>63</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hamaguchi</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Meth</surname><given-names>JL</given-names></name>, <name name-style="western"><surname>von Klitzing</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Wei</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Esposito</surname><given-names>D</given-names></name>, <etal>et al</etal>. (<year>2002</year>) <article-title><italic>DBC2</italic>, a candidate for a tumor suppressor gene involved in breast cancer</article-title>. <source>Proc Natl Acad Sci USA</source> <volume>99</volume>: <fpage>13647</fpage>–<lpage>13652</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003740-Birchmeier1"><label>64</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Birchmeier</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Behrens</surname><given-names>J</given-names></name> (<year>1994</year>) <article-title>Cadherin expression in carcinomas: role in the formation of cell junctions and the prevention of invasiveness</article-title>. <source>Biochim Biophys Acta (BBA)-Reviews on Cancer</source> <volume>1198</volume>: <fpage>11</fpage>–<lpage>26</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003740-Vousden1"><label>65</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Vousden</surname><given-names>KH</given-names></name>, <name name-style="western"><surname>Lane</surname><given-names>DP</given-names></name> (<year>2007</year>) <article-title><italic>P53</italic> in health and disease</article-title>. <source>Nature Rev Cell Biol</source> <volume>8</volume>: <fpage>275</fpage>–<lpage>283</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003740-Huang2"><label>66</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Huang</surname><given-names>X</given-names></name>, <name name-style="western"><surname>Gollin</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Raja</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Godfrey</surname><given-names>T</given-names></name> (<year>2002</year>) <article-title>High-resolution mapping of the 11q13 amplicon and identification of a gene, <italic>TAOS1</italic>, that is amplified and overexpressed in oral cancer cells</article-title>. <source>Proc Natl Acad Sci USA</source> <volume>99</volume>: <fpage>11369</fpage>–<lpage>11374</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003740-Park1"><label>67</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Park</surname><given-names>SY</given-names></name>, <name name-style="western"><surname>Gönen</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Kim</surname><given-names>HJ</given-names></name>, <name name-style="western"><surname>Michor</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Polyak</surname><given-names>K</given-names></name> (<year>2010</year>) <article-title>Cellular and genetic diversity in the progression of in situ human breast carcinomas to an invasive phenotype</article-title>. <source>J Clin Invest</source> <volume>120</volume>: <fpage>636</fpage>–<lpage>644</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003740-Almendro1"><label>68</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Almendro</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Cheng</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Randles</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Itzkovitz</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Marusyk</surname><given-names>A</given-names></name>, <etal>et al</etal>. (<year>2014</year>) <article-title>Inference of tumor evolution during chemotherapy by computational modeling and in situ analysis of genetic and phenotypic cellular diversity</article-title>. <source>Cell Rep</source> <volume>6</volume>: <fpage>514</fpage>–<lpage>527</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003740-Tamura1"><label>69</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tamura</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Stecher</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Peterson</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Filipski</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Kumar</surname><given-names>S</given-names></name> (<year>2013</year>) <article-title>MEGA6: molecular evolutionary genetics analysis version 6.0</article-title>. <source>Molecular Biol Evol</source> <volume>30</volume>: <fpage>2725</fpage>–<lpage>2729</lpage>.</mixed-citation>
</ref>
</ref-list></back>
</article>