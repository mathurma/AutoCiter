<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1006080</article-id>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-17-01661</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Heredity</subject><subj-group><subject>Genetic mapping</subject><subj-group><subject>Haplotypes</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Database and informatics methods</subject><subj-group><subject>Bioinformatics</subject><subj-group><subject>Sequence analysis</subject><subj-group><subject>Sequence alignment</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Genome analysis</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Genomics</subject><subj-group><subject>Genome analysis</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Genetic loci</subject><subj-group><subject>Alleles</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Molecular genetics</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Molecular biology</subject><subj-group><subject>Molecular genetics</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Genome complexity</subject><subj-group><subject>Copy number variation</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Genomics</subject><subj-group><subject>Genome complexity</subject><subj-group><subject>Copy number variation</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Molecular biology</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Sequencing techniques</subject><subj-group><subject>DNA sequencing</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Sequencing techniques</subject><subj-group><subject>DNA sequencing</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Database and informatics methods</subject><subj-group><subject>Bioinformatics</subject><subj-group><subject>Sequence analysis</subject><subj-group><subject>DNA sequence analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Bamgineer: Introduction of simulated allele-specific copy number variants into exome and targeted sequence data sets</article-title>
<alt-title alt-title-type="running-head">Bamgineer</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-8718-3775</contrib-id>
<name name-style="western">
<surname>Samadian</surname>
<given-names>Soroush</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Bruce</surname>
<given-names>Jeff P.</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-8073-5888</contrib-id>
<name name-style="western">
<surname>Pugh</surname>
<given-names>Trevor J.</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001"><label>1</label> <addr-line>Princess Margaret Cancer Centre, University Health Network, Toronto, Ontario, Canada</addr-line></aff>
<aff id="aff002"><label>2</label> <addr-line>Department of Medical Biophysics, University of Toronto, Toronto, Ontario, Canada</addr-line></aff>
<aff id="aff003"><label>3</label> <addr-line>Ontario Institute for Cancer Research, Toronto, Ontario, Canada</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Karchin</surname>
<given-names>Rachel</given-names>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1"><addr-line>Johns Hopkins University, UNITED STATES</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">trevor.pugh@utoronto.ca</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<day>28</day>
<month>3</month>
<year>2018</year>
</pub-date>
<pub-date pub-type="collection">
<month>3</month>
<year>2018</year>
</pub-date>
<volume>14</volume>
<issue>3</issue>
<elocation-id>e1006080</elocation-id>
<history>
<date date-type="received">
<day>3</day>
<month>10</month>
<year>2017</year>
</date>
<date date-type="accepted">
<day>7</day>
<month>3</month>
<year>2018</year>
</date>
</history>
<permissions>
<copyright-year>2018</copyright-year>
<copyright-holder>Samadian et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1006080"/>
<abstract>
<p>Somatic copy number variations (CNVs) play a crucial role in development of many human cancers. The broad availability of next-generation sequencing data has enabled the development of algorithms to computationally infer CNV profiles from a variety of data types including exome and targeted sequence data; currently the most prevalent types of cancer genomics data. However, systemic evaluation and comparison of these tools remains challenging due to a lack of ground truth reference sets. To address this need, we have developed Bamgineer, a tool written in Python to introduce user-defined haplotype-phased allele-specific copy number events into an existing Binary Alignment Mapping (BAM) file, with a focus on targeted and exome sequencing experiments. As input, this tool requires a read alignment file (BAM format), lists of non-overlapping genome coordinates for introduction of gains and losses (bed file), and an optional file defining known haplotypes (vcf format). To improve runtime performance, Bamgineer introduces the desired CNVs in parallel using queuing and parallel processing on a local machine or on a high-performance computing cluster. As proof-of-principle, we applied Bamgineer to a single high-coverage (mean: 220X) exome sequence file from a blood sample to simulate copy number profiles of 3 exemplar tumors from each of 10 tumor types at 5 tumor cellularity levels (20–100%, 150 BAM files in total). To demonstrate feasibility beyond exome data, we introduced read alignments to a targeted 5-gene cell-free DNA sequencing library to simulate <italic>EGFR</italic> amplifications at frequencies consistent with circulating tumor DNA (10, 1, 0.1 and 0.01%) while retaining the multimodal insert size distribution of the original data. We expect Bamgineer to be of use for development and systematic benchmarking of CNV calling algorithms by users using locally-generated data for a variety of applications. The source code is freely available at <ext-link ext-link-type="uri" xlink:href="http://github.com/pughlab/bamgineer" xlink:type="simple">http://github.com/pughlab/bamgineer</ext-link>.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>We present Bamgineer, a software program to introduce user-defined, haplotype-specific copy number variants (CNVs) at any frequency into standard Binary Alignment Mapping (BAM) files. Copy number gains are simulated by introducing new DNA sequencing read pairs sampled from existing reads and modified to contain SNPs of the haplotype of interest. This approach retains biases of the original data such as local coverage, strand bias, and insert size. Deletions are simulated by removing reads corresponding to one or both haplotypes. In our proof-of-principle study, we simulated copy number profiles from 10 cancer types at varying cellularity levels typically encountered in clinical samples. We also demonstrated introduction of low frequency CNVs into cell-free DNA sequencing data that retained the bimodal fragment size distribution characteristic of these data. Bamgineer is flexible and enables users to simulate CNVs that reflect characteristics of locally-generated sequence files and can be used for many applications including development and benchmarking of CNV inference tools for a variety of data types.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution>Princess Margaret Cancer Foundation (CA)</institution>
</funding-source>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-8073-5888</contrib-id>
<name name-style="western">
<surname>Pugh</surname>
<given-names>Trevor J.</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100009326</institution-id>
<institution>Cancer Research Society</institution>
</institution-wrap>
</funding-source>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-8073-5888</contrib-id>
<name name-style="western">
<surname>Pugh</surname>
<given-names>Trevor J.</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award003">
<funding-source>
<institution>Canadian Neuroendocrine Tumour Society</institution>
</funding-source>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-8073-5888</contrib-id>
<name name-style="western">
<surname>Pugh</surname>
<given-names>Trevor J.</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award004">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100000196</institution-id>
<institution>Canada Foundation for Innovation</institution>
</institution-wrap>
</funding-source>
<award-id>32383</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-8073-5888</contrib-id>
<name name-style="western">
<surname>Pugh</surname>
<given-names>Trevor J.</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award005">
<funding-source>
<institution>Ontario Ministry of Research and Innovation</institution>
</funding-source>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-8073-5888</contrib-id>
<name name-style="western">
<surname>Pugh</surname>
<given-names>Trevor J.</given-names>
</name>
</principal-award-recipient>
</award-group>
<funding-statement>This work was supported by funding to TJP from the Princess Margaret Cancer Foundation; Canada Research Chairs Program; Cancer Research Society and Canadian Neuroendocrine Tumour Society; Canada Foundation for Innovation, Leaders Opportunity Fund, CFI #32383; and the Ontario Ministry of Research and Innovation, Ontario Research Fund Small Infrastructure Program. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="5"/>
<table-count count="1"/>
<page-count count="18"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2018-04-09</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant data are within the paper, its Supporting Information files, and an associated Github repository: <ext-link ext-link-type="uri" xlink:href="https://github.com/pughlab/bamgineer" xlink:type="simple">https://github.com/pughlab/bamgineer</ext-link>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<disp-quote>
<p>“This is a <italic>PLOS Computational Biology</italic> Methods paper.”</p>
</disp-quote>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>The emergence and maturation of next-generation sequencing technologies, including whole genome sequencing, whole exome sequencing, and targeted sequencing approaches, has enabled researchers to perform increasingly more complex analysis of copy number variants (CNVs)[<xref ref-type="bibr" rid="pcbi.1006080.ref001">1</xref>]. While genome sequencing-based methods have long been used for CNV detection, these methods can be confounded when applied to exome and targeted sequencing data due to non-contiguous and highly-variable nature of coverage and other biases introduced during enrichment of target regions[<xref ref-type="bibr" rid="pcbi.1006080.ref001">1</xref>–<xref ref-type="bibr" rid="pcbi.1006080.ref005">5</xref>]. In cancer, this analysis is further challenged by bulk tumor samples that often yield nucleic acids of variable quality and are composed of a mixture of cell-types, including normal stromal cells, infiltrating immune cells, and subclonal cancer cell populations. Circulating tumor DNA presents further challenges due to a multimodal DNA fragment size distribution and low amounts of tumor-derived DNA in blood plasma. Therefore, development of CNV calling methods on arbitrary sets of tumor-derived data from public repositories may not reflect the type of tumor specimens encountered at an individual centre, particularly formalin-fixed-paraffin embedded tissues routinely profiled for diagnostic testing.</p>
<p>Due to lack of a ground truth for validating CNV callers, many studies have used simulation to model tumor data[<xref ref-type="bibr" rid="pcbi.1006080.ref006">6</xref>]. Most often, simulation studies are used in an <italic>ad-hoc</italic> manner using customized formats to validate specific tools and settings with limited adaptability to other tools. More generalizable approaches aim at the <italic>de novo</italic> generation of sequencing reads according to a reference genome (e.g. wessim[<xref ref-type="bibr" rid="pcbi.1006080.ref003">3</xref>], Art-illumina[<xref ref-type="bibr" rid="pcbi.1006080.ref007">7</xref>], and dwgsim[<xref ref-type="bibr" rid="pcbi.1006080.ref008">8</xref>]. However, <italic>de novo</italic> simulated reads do not necessarily capture subtle features of empirical data, such as read coverage distribution, DNA fragment insert size, quality scores, error rates, strand bias and GC content[<xref ref-type="bibr" rid="pcbi.1006080.ref006">6</xref>]; factors that can be more variable for exome and targeted sequencing data particularly when derived from clinical specimens. Recently, Ewing et al. developed a tool, BAMSurgeon, to introduce synthetic mutations into existing reads in a Binary alignment Mapping (BAM) file[<xref ref-type="bibr" rid="pcbi.1006080.ref009">9</xref>]. BAMSurgeon provides support for adjusting variant allele fractions (VAF) of engineered mutations based on prior knowledge of overlapping CNVs but does not currently support direct simulation of CNVs themselves.</p>
<p>Here we introduce Bamgineer, a tool to modify existing BAM files to precisely model allele-specific and haplotype-phased CNVs (<xref ref-type="fig" rid="pcbi.1006080.g001">Fig 1</xref>). This is done by introducing new read pairs sampled from existing reads, thereby retaining biases of the original data such as local coverage, strand bias, and insert size. As input, Bamgineer requires a BAM file and a list of non-overlapping genomic coordinates to introduce allele-specific gains and losses. The user may explicitly provide known haplotypes or chose to use the BEAGLE[<xref ref-type="bibr" rid="pcbi.1006080.ref010">10</xref>] phasing module that we have incorporated within Bamgineer. We implemented parallelization of the Bamgineer algorithm for both standalone and high performance computing cluster environments, significantly improving the scalability of the algorithm. Overall, Bamgineer gives investigators complete control to introduce CNVs of arbitrary size, magnitude, and haplotype into an existing reference BAM file. We have uploaded all software code to a public repository (<ext-link ext-link-type="uri" xlink:href="http://github.com/pughlab/bamgineer" xlink:type="simple">http://github.com/pughlab/bamgineer</ext-link>)).</p>
<fig id="pcbi.1006080.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006080.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Bamgineer conceptual overview.</title>
<p>Haploype-specific CNVs simulated using re-paired reads. Red and blue colors represent read-pairs corresponding to different haplotypes. Purple color represents new reads corresponding to the red haplotype. <bold>A</bold>. Original BAM file used as the input. <bold>B</bold>. Allele-specific loss, reads matching a target haplotype are removed <bold>C</bold>. Allele-specific single copy number gain (CN = 3). <bold>D.</bold> Allele-specific 2-copy gain (CN = 4). In C and D, new read pairs are constructed from existing reads and reads are modified at SNP loci to match the desired haplotype.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006080.g001" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<sec id="sec003">
<title>Proof-of-principle experiments using whole exome sequence data</title>
<p>For all proof-of-principle experiments, we used exome sequencing data from a single normal (peripheral blood lymphocyte) DNA sample. DNA was captured using the Agilent SureSelect Exome v5+UTR kit and sequenced to 220X median coverage as part of a study of neuroendocrine tumors. Reads were aligned to the hg19 build of the human genome reference sequence and processed using the Genome Analysis Toolkit (GATK) Best Practices pipeline.</p>
<sec id="sec004">
<title>Arm-level and chromosome-level copy number alteration</title>
<p>To verify the ability of our workflow to introduce copy gains, we first generated single-copy, allele-specific copy number amplification (ASCNA) of chromosomes 21 and 22, followed by calculation of hybrid-selection metrics using the Picard suite[<xref ref-type="bibr" rid="pcbi.1006080.ref011">11</xref>]. As expected, the number of read pairs increased by 50% in the two chromosomal regions of interest with no statistically significant impact median, mean, and standard deviation of insert size for paired-reads (<xref ref-type="supplementary-material" rid="pcbi.1006080.s011">S1 Table</xref>). The distribution of paired reads distances was nearly indistinguishable before and after the addition of ASCNA (median 211.97 vs. 212.3, Two-sided KS-test p&gt;0.99, <xref ref-type="supplementary-material" rid="pcbi.1006080.s005">S5 Fig</xref>). We subsequently applied our exome analysis pipeline for detecting CNVs using Mpileup[<xref ref-type="bibr" rid="pcbi.1006080.ref012">12</xref>], Varscan2[<xref ref-type="bibr" rid="pcbi.1006080.ref013">13</xref>] and Sequenza[<xref ref-type="bibr" rid="pcbi.1006080.ref014">14</xref>] to infer allele- specific copy number profiles (<xref ref-type="supplementary-material" rid="pcbi.1006080.s006">S6 Fig</xref>). This analysis detected the desired arm- and chromosome-level gains at the expected depth ratio of 1.5 and we verified specific gain of desired haplotypes by confirming that 97–98% of the reads contained variants corresponding to the target haplotype (mean variant allele frequency of SNPs on amplified haplotypes = 0.66±<bold>0.03</bold> and 0.33 versus 0.50±<bold>0.03</bold> on non-target haplotypes; <xref ref-type="fig" rid="pcbi.1006080.g002">Fig 2A and 2B</xref>).</p>
<fig id="pcbi.1006080.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006080.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Example of allele specific CNV calls generated from modified bam files.</title>
<p>A) Genome-wide (left) and chromosome-view (right) of allele specific copy number, BAF and depth ratios for balanced gain of p-arm in chromosome 22 inferred using Sequenza. Blue and red lines show allele specific copy number profiles for each chromosome (lines are offset from discrete copy number values by ± 0.1 for visual separation of the two alleles). The small blue and red spots on the top figure (orange circle) show a balanced gain on p-arm of chromosome 22 (BAF is not affected as a result of balanced gain). Each black dot on the right figures represents a genomic locus and the red lines indicate the inferred value for consecutive segments. B) Allele-specific gain of entire chromosome 21(orange circle). As shown only one copy of the chromosome is gained and hence the allele frequency is reduced from the 0.5 to ~0.33 in the chromosome view. C) Genome-wide (left) and chromosome-view (right) for 36 events (21 gains and 25 losses) sampled from Genome Atlas for Bladder Urothelial Carcinoma (BLCA) for 100% tumor content. As expected depth ratio and BAFs are approximately 0.5 and zero respectively.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006080.g002" xlink:type="simple"/>
</fig>
<p>We next repeated this experiment to introduce a single copy loss of these two regions. Again, the number of read pairs was consistent with the desired copy state (decrease of 50% of reads in the target regions). We also verified that the single copy deletion was restricted to a single haplotype with &gt; 99% of reads containing variants corresponding to the target haplotype.</p>
</sec>
</sec>
<sec id="sec005">
<title>Synthetic tumor-normal mixtures of exemplar tumors from TCGA</title>
<p>Following the validation of our tool for readily-detected chromosome- and arm-level events, we next used Bamgineer to simulate CNV profiles mimicking 3 exemplar tumors from each of 10 different cancer types profiled by The Cancer Genome Atlas using the Affymetrix SNP6 microarray platform: lung adenocarcinoma (LUAD); lung squamous cell (LUSC); head and neck squamous cell carcinoma (HNSC); glioblastoma multiformae (GBM); kidney renal cell carcinoma (KIRC); bladder (BLCA); colorectal (CRC); uterine cervix (UCEC); ovarian (OV), and breast (BRCA) cancers (<xref ref-type="table" rid="pcbi.1006080.t001">Table 1</xref>).</p>
<table-wrap id="pcbi.1006080.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006080.t001</object-id>
<label>Table 1</label> <caption><title>Average number of copy number gains, losses and percent genome altered (PGA) across TCGA cancer types and the three exemplar tumors selected for our study.</title></caption>
<alternatives>
<graphic id="pcbi.1006080.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006080.t001" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center" colspan="3" style="background-color:#F2F2F2">TCGA</th>
<th align="center" colspan="9" style="background-color:#BFBFBF">Exemplar tumors</th>
</tr>
<tr>
<th align="center" colspan="3" style="background-color:#F2F2F2">Average of all tumors</th>
<th align="center" colspan="3" style="background-color:#BFBFBF">Tumor 1</th>
<th align="center" colspan="3" style="background-color:#BFBFBF">Tumor 2</th>
<th align="center" colspan="3" style="background-color:#BFBFBF">Tumor 3</th>
</tr>
<tr>
<th align="center" style="background-color:#F2F2F2">Cancer</th>
<th align="center" style="background-color:#F2F2F2">Gains</th>
<th align="center" style="background-color:#F2F2F2">Losses</th>
<th align="center" style="background-color:#BFBFBF">Gains</th>
<th align="center" style="background-color:#BFBFBF">Losses</th>
<th align="left" style="background-color:#BFBFBF">PGA</th>
<th align="center" style="background-color:#BFBFBF">Gains</th>
<th align="center" style="background-color:#BFBFBF">Losses</th>
<th align="center" style="background-color:#BFBFBF">PGA</th>
<th align="center" style="background-color:#BFBFBF">Gains</th>
<th align="center" style="background-color:#BFBFBF">Losses</th>
<th align="center" style="background-color:#BFBFBF">PGA</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" style="background-color:#F2F2F2">BLCA</td>
<td align="left" style="background-color:#F2F2F2">23</td>
<td align="center" style="background-color:#F2F2F2">30</td>
<td align="center" style="background-color:#BFBFBF">23</td>
<td align="center" style="background-color:#BFBFBF">30</td>
<td align="center" style="background-color:#BFBFBF">70%</td>
<td align="center" style="background-color:#BFBFBF">22</td>
<td align="center" style="background-color:#BFBFBF">25</td>
<td align="center" style="background-color:#BFBFBF">72%</td>
<td align="center" style="background-color:#BFBFBF">22</td>
<td align="center" style="background-color:#BFBFBF">25</td>
<td align="center" style="background-color:#BFBFBF">71%</td>
</tr>
<tr>
<td align="left" style="background-color:#F2F2F2">BRCA</td>
<td align="left" style="background-color:#F2F2F2">26</td>
<td align="center" style="background-color:#F2F2F2">36</td>
<td align="center" style="background-color:#BFBFBF">24</td>
<td align="center" style="background-color:#BFBFBF">34</td>
<td align="center" style="background-color:#BFBFBF">59%</td>
<td align="center" style="background-color:#BFBFBF">27</td>
<td align="center" style="background-color:#BFBFBF">33</td>
<td align="center" style="background-color:#BFBFBF">67%</td>
<td align="center" style="background-color:#BFBFBF">21</td>
<td align="center" style="background-color:#BFBFBF">30</td>
<td align="center" style="background-color:#BFBFBF">66%</td>
</tr>
<tr>
<td align="left" style="background-color:#F2F2F2">CRC</td>
<td align="left" style="background-color:#F2F2F2">24</td>
<td align="center" style="background-color:#F2F2F2">42</td>
<td align="center" style="background-color:#BFBFBF">27</td>
<td align="center" style="background-color:#BFBFBF">48</td>
<td align="center" style="background-color:#BFBFBF">27%</td>
<td align="center" style="background-color:#BFBFBF">23</td>
<td align="center" style="background-color:#BFBFBF">29</td>
<td align="center" style="background-color:#BFBFBF">70%</td>
<td align="center" style="background-color:#BFBFBF">22</td>
<td align="center" style="background-color:#BFBFBF">30</td>
<td align="center" style="background-color:#BFBFBF">69%</td>
</tr>
<tr>
<td align="left" style="background-color:#F2F2F2">GBM</td>
<td align="left" style="background-color:#F2F2F2">26</td>
<td align="center" style="background-color:#F2F2F2">36</td>
<td align="center" style="background-color:#BFBFBF">23</td>
<td align="center" style="background-color:#BFBFBF">34</td>
<td align="center" style="background-color:#BFBFBF">51%</td>
<td align="center" style="background-color:#BFBFBF">19</td>
<td align="center" style="background-color:#BFBFBF">33</td>
<td align="center" style="background-color:#BFBFBF">73%</td>
<td align="center" style="background-color:#BFBFBF">30</td>
<td align="center" style="background-color:#BFBFBF">43</td>
<td align="center" style="background-color:#BFBFBF">57%</td>
</tr>
<tr>
<td align="left" style="background-color:#F2F2F2">HNSC</td>
<td align="left" style="background-color:#F2F2F2">24</td>
<td align="center" style="background-color:#F2F2F2">40</td>
<td align="center" style="background-color:#BFBFBF">28</td>
<td align="center" style="background-color:#BFBFBF">40</td>
<td align="center" style="background-color:#BFBFBF">61%</td>
<td align="center" style="background-color:#BFBFBF">24</td>
<td align="center" style="background-color:#BFBFBF">30</td>
<td align="center" style="background-color:#BFBFBF">55%</td>
<td align="center" style="background-color:#BFBFBF">24</td>
<td align="center" style="background-color:#BFBFBF">28</td>
<td align="center" style="background-color:#BFBFBF">62%</td>
</tr>
<tr>
<td align="left" style="background-color:#F2F2F2">KIRC</td>
<td align="left" style="background-color:#F2F2F2">6</td>
<td align="center" style="background-color:#F2F2F2">16</td>
<td align="center" style="background-color:#BFBFBF">6</td>
<td align="center" style="background-color:#BFBFBF">16</td>
<td align="center" style="background-color:#BFBFBF">75%</td>
<td align="center" style="background-color:#BFBFBF">7</td>
<td align="center" style="background-color:#BFBFBF">15</td>
<td align="center" style="background-color:#BFBFBF">57%</td>
<td align="center" style="background-color:#BFBFBF">8</td>
<td align="center" style="background-color:#BFBFBF">14</td>
<td align="center" style="background-color:#BFBFBF">66%</td>
</tr>
<tr>
<td align="left" style="background-color:#F2F2F2">LUAD</td>
<td align="left" style="background-color:#F2F2F2">26</td>
<td align="center" style="background-color:#F2F2F2">34</td>
<td align="center" style="background-color:#BFBFBF">26</td>
<td align="center" style="background-color:#BFBFBF">25</td>
<td align="center" style="background-color:#BFBFBF">55%</td>
<td align="center" style="background-color:#BFBFBF">26</td>
<td align="center" style="background-color:#BFBFBF">30</td>
<td align="center" style="background-color:#BFBFBF">63%</td>
<td align="center" style="background-color:#BFBFBF">22</td>
<td align="center" style="background-color:#BFBFBF">32</td>
<td align="center" style="background-color:#BFBFBF">67%</td>
</tr>
<tr>
<td align="left" style="background-color:#F2F2F2">LUSC</td>
<td align="left" style="background-color:#F2F2F2">25</td>
<td align="center" style="background-color:#F2F2F2">43</td>
<td align="center" style="background-color:#BFBFBF">34</td>
<td align="center" style="background-color:#BFBFBF">47</td>
<td align="center" style="background-color:#BFBFBF">26%</td>
<td align="center" style="background-color:#BFBFBF">31</td>
<td align="center" style="background-color:#BFBFBF">34</td>
<td align="center" style="background-color:#BFBFBF">68%</td>
<td align="center" style="background-color:#BFBFBF">24</td>
<td align="center" style="background-color:#BFBFBF">31</td>
<td align="center" style="background-color:#BFBFBF">73%</td>
</tr>
<tr>
<td align="left" style="background-color:#F2F2F2">UCEC</td>
<td align="left" style="background-color:#F2F2F2">39</td>
<td align="center" style="background-color:#F2F2F2">47</td>
<td align="center" style="background-color:#BFBFBF">39</td>
<td align="center" style="background-color:#BFBFBF">43</td>
<td align="center" style="background-color:#BFBFBF">62%</td>
<td align="center" style="background-color:#BFBFBF">38</td>
<td align="center" style="background-color:#BFBFBF">38</td>
<td align="center" style="background-color:#BFBFBF">59%</td>
<td align="center" style="background-color:#BFBFBF">37</td>
<td align="center" style="background-color:#BFBFBF">37</td>
<td align="center" style="background-color:#BFBFBF">66%</td>
</tr>
<tr>
<td align="left" style="background-color:#F2F2F2">OV</td>
<td align="left" style="background-color:#F2F2F2">29</td>
<td align="center" style="background-color:#F2F2F2">37</td>
<td align="center" style="background-color:#BFBFBF">26</td>
<td align="center" style="background-color:#BFBFBF">35</td>
<td align="center" style="background-color:#BFBFBF">68%</td>
<td align="center" style="background-color:#BFBFBF">28</td>
<td align="center" style="background-color:#BFBFBF">34</td>
<td align="center" style="background-color:#BFBFBF">74%</td>
<td align="center" style="background-color:#BFBFBF">28</td>
<td align="center" style="background-color:#BFBFBF">31</td>
<td align="center" style="background-color:#BFBFBF">65%</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>To select 3 exemplar tumors for each cancer type, we chose profiles that best represented the copy number landscape for each cancer type. First, we addressed over-segmentation of the CNV calls from the microarray data by merging segments of &lt;500 kb in size with the closest adjacent segment and removing the smaller event from the overlapping gain and loss regions. We then assigned a score to each tumor that reflects its similarity to other tumor of the same cancer type (<xref ref-type="supplementary-material" rid="pcbi.1006080.s007">S7 Fig</xref>). This score integrates total number of CNV gain and losses (Methods, <xref ref-type="disp-formula" rid="pcbi.1006080.e010">Eq 6</xref>), median size of each gain and loss, and the overlap of CNV regions with GISTIC peaks for each cancer type as reported by The Cancer Genome Atlas (<xref ref-type="table" rid="pcbi.1006080.t001">Table 1</xref>). We selected three high ranking tumors for each cancer type such that, together, all significant GISTIC[<xref ref-type="bibr" rid="pcbi.1006080.ref015">15</xref>] peaks for that tumor type were represented. A representative profile from a single tumor is shown in <xref ref-type="fig" rid="pcbi.1006080.g002">Fig 2C</xref>.</p>
<p>Subsequently, for each of the 30 selected tumor profiles (3 for each of 10 cancer types), we introduced the corresponding CNVs at 5 levels of tumor cellularity (20, 40, 60, 80, and 100%) resulting in 150 BAM files in total. For each BAM file, we used Sequenza to generate allele-specific copy number calls as done previously. Tumor/normal log2 ratios are shown in <xref ref-type="fig" rid="pcbi.1006080.g003">Fig 3</xref> for one representative from each cancer type. From this large set of tumors, we next set out to compare Picard metrics and CNV calls as we did for the arm- and chromosome-level pilot.</p>
<fig id="pcbi.1006080.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006080.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Log2 ratios from simulated exemplar tumors at varying purity levels.</title>
<p>To assess the ability of Bamgineer to recapitulate CNV profiles of known cancers, we compared, from 10 TCGA cancer types, profiles from an exemplar tumour (top track for case) with CNV called from bam files generated by Bamgineer at five purity levels: 100%, 80%, 60%, 40% and 20% (subsequent tracks for each case). Log2 ratios of copy number segments inferred using the Sequenza algorithm, shown as a heatmap (blue: loss, red: gain; data range is -1.5 to 1.5) for different cancers and different tumor cellularities shown for one exemplar tumor for each cancer type. We generated exemplar composite seg files by combining high-ranking tumor profiles from TCGA segments for each cancer defined by similarity score; <xref ref-type="disp-formula" rid="pcbi.1006080.e010">Eq 6</xref> (top track for each cancer type). The quantized segments from each representative tumor were used as the CNV input for Bamgineer along with a single normal BAM file and sampled to artificially create tumor-normal admixture at the desired purity. The purity value for each tumor type (in gray), is the median purity value for each cancer type according to TCGA segments. As the purity decreases, we observed a corresponding decrease in log2ratios of tumor segments (reduction in color intensities). Occasional discrepancies between exemplar and simulated CNV profiles for each cancer appear to be due to variation in the segmentation of copy number calls by Sequenza as purities fall rather than inaccurate allele-specific coverage at these locations.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006080.g003" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec006">
<title>Performance evaluation</title>
<p>We evaluated Bamgineer using several metrics: tumor allelic ratio, SNP phasing consistency, and tumor to normal log2 ratios (<xref ref-type="fig" rid="pcbi.1006080.g004">Fig 4</xref>). As expected, across all regions of a single copy gain, tumor allelic ratio was at ~0.66 (interquartile range: 0.62–0.7) for the targeted haplotype and 0.33 (interquartile range: 0.3–0.36) for the other haplotype. As purity was decreased, we observed a corresponding decrease in allelic ratios, from 0.66 down to 0.54 (interquartile range: 0.5–0.57) for targeted and an increase (from 0.33) to 0.47 (interquartile range: 0.43–0.5) for the other haplotype for 20% purity (<xref ref-type="fig" rid="pcbi.1006080.g004">Fig 4A and 4B</xref>). These changes correlated directly with decreasing purity (R<sup>2</sup> &gt; 0.99) for both haplotypes. Similarly, for single copy loss regions, as purity was decreased from 100% to 20% the allelic ratio linearly decreased (R<sup>2</sup> &gt; 0.99) from ~0.99 (interquartile range: 0.98–1.0) for targeted haplotype to ~0.55 (interquartile range: 0.51–0.58) for targeted haplotype and increases from 0 to ~0.43 (interquartile range: 0.4–0.46) for the other haplotype (<xref ref-type="fig" rid="pcbi.1006080.g004">Fig 4B</xref>). The results for log2 tumor to normal depth ratios of segments normalized for average ploidy were also consistent with the expected values (Methods, <xref ref-type="disp-formula" rid="pcbi.1006080.e004">Eq 2</xref>). For CNV gain regions, log2 ratio decreased from ~0.58 (log2 of 3/2) to ~0.13 as purity was decreased from 100% to 20%. For CNV loss regions, as purity was decreased from 100% to 20%, the log2 ratio increased from -1 (log2 of 1/2) to -0.15, consistent with <xref ref-type="disp-formula" rid="pcbi.1006080.e004">Eq 2</xref> (<xref ref-type="fig" rid="pcbi.1006080.g004">Fig 4C</xref>; S1-S4 for individual cancers).</p>
<fig id="pcbi.1006080.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006080.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Exome-wide simulated copy number profiles at a range of tumor purities yield expected allelic and copy number ratios.</title>
<p>Allelic ratio for allele-specific copy number gain (A) and loss (B) events at heterozygous SNP loci for haplotypes affected (blue), haplotypes not affected (red), and SNPs not in engineered CNV regions (green) as negative controls at different tumor cellularity levels (x-axis) across all cancers. C) Tumor to normal log2 depth ratio boxplots of copy number gain (red) and loss (blue) segments from Sequenza across all cancers (<xref ref-type="table" rid="pcbi.1006080.t001">Table 1</xref>). D) Accuracy of Sequenza copy segment calling gains (red triangles) and losses (blue circles) decreases as simulated tumor content decreases.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006080.g004" xlink:type="simple"/>
</fig>
<p>Ultimately, we wanted to assess whether Bamgineer was introducing callable CNVs consistent with segments corresponding to the exemplar tumor set. To assess this, we calculated an accuracy metric (<xref ref-type="fig" rid="pcbi.1006080.g004">Fig 4D</xref>) as:
<disp-formula id="pcbi.1006080.e001">
<alternatives>
<graphic id="pcbi.1006080.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006080.e001" xlink:type="simple"/>
<mml:math display="block" id="M1">
<mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>c</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>T</mml:mi><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>T</mml:mi><mml:mi>F</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:mfrac>
</mml:math>
</alternatives>
</disp-formula>
where TP, TF, FP and FN represent number of calls from Sequenza corresponding to true positives (perfect matches to desired CNVs), true negatives (regions without CNVs introduced), false positives (CNV calls outside of target regions) and false negatives (target regions without CNVs called). TP, TF, TN, FN were calculated by comparing Sequenza absolute copy number (predicted) to the target regions for introduction of 1 Mb CNV bins across the genome. As tumor content decreased, accuracy for both gains and losses decreased as false negatives became increasingly prevalent due to small shifts in log2 ratios. We note that (as expected), decreasing cancer purity from 100% to 20% generally decreases the segmentation accuracy. Additionally, we observe that segmentation accuracy is on average, significantly higher for gain regions compared to the loss regions for tumor purity levels below 40% (<xref ref-type="fig" rid="pcbi.1006080.g004">Fig 4D</xref>). This is consistent with previous studies that show the sensitivity of CNV detection from sequencing data is slightly higher for CNV gains compared to CNV losses[<xref ref-type="bibr" rid="pcbi.1006080.ref016">16</xref>]. We also note that with decreasing cancer purity, the decline in segmentation accuracy follows a linear pattern of decline for gain regions and an abrupt stepwise decline for loss regions (<xref ref-type="fig" rid="pcbi.1006080.g004">Fig 4D</xref>; segmentation accuracies are approximately similar for 40% and 20% tumor purities).</p>
<p>Finally, we observed a degree of variation in terms of segmentation accuracy across individual cancer types (<xref ref-type="supplementary-material" rid="pcbi.1006080.s001">S1</xref>–<xref ref-type="supplementary-material" rid="pcbi.1006080.s004">S4</xref> Figs). Segmentation accuracy was lower for LUAD, OV and UCEC compared to other simulated cancer types for this study. The relative decline in performance is seen in cancer types where CNV gains and losses cover a sizeable portion of the genome; and hence, the original loss and gain events sampled from TCGA had significant overlaps. As a result, after resolving overlapping gain and loss regions (<xref ref-type="supplementary-material" rid="pcbi.1006080.s007">S7 Fig</xref>), on average, the final target regions constitute a larger number of small (&lt; 200 kb) loss regions immediately followed by gain regions and vice versa; making the accurate segmentation challenging for the CBS (circular binary segmentation) algorithm implemented by Sequenza relying on presence of heterozygous SNPs. This can cause uncertainties in assignments of segment boundaries.</p>
<p>In summary, application of an allele-specific caller to BAMs generated by Bamgineer recapitulated CNV segments consistent with &gt;95% (medians: 95.1 for losses and 97.2 for gains) of those input to the algorithm. However, we note some discrepancies between the expected and called events, primarily due to small CVNs as well as large segments of unprobed genome between exonic sequences.</p>
</sec>
<sec id="sec007">
<title>Synthetic tumor-normal mixtures using cell free DNA sequence data</title>
<p>To evaluate the use of Bamgineer for circulating tumor DNA analysis, we simulated the presence of an <italic>EGFR</italic> gene amplification in read alignments from a targeted 5-gene panel (18 kb) applied to a cell-free DNA from a healthy donor and sequenced to &gt;50,000X coverage. To mirror concentrations of tumor-derived fragments commonly encountered in cell-free DNA[<xref ref-type="bibr" rid="pcbi.1006080.ref017">17</xref>,<xref ref-type="bibr" rid="pcbi.1006080.ref018">18</xref>], we introduced gain of an <italic>EGFR</italic> haplotype at frequencies of 100, 10, 1, 0.1, and 0.01%. This haplotype included 3 SNPs covered by our panel, which were phased and subject to allele-specific gain accordingly. As with the exome data, we observed shifts in coverage of specific allelic variants, and haplotype representation consistent with the targeted allele frequencies (<xref ref-type="fig" rid="pcbi.1006080.g005">Fig 5A</xref>, Supplemental <xref ref-type="supplementary-material" rid="pcbi.1006080.s011">S1 Table</xref>). Furthermore, read pairs introduced to simulate gene amplification retain the bimodal insert size distribution characteristic of cell-free DNA fragments (<xref ref-type="fig" rid="pcbi.1006080.g005">Fig 5B and 5C</xref>).</p>
<fig id="pcbi.1006080.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006080.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Simulated low frequency CNVs in circulating tumor DNA data yield expected allelic ratios and retain underlying bimodal fragment size distribution.</title>
<p>A) Percentage increase in read count above the original input BAM file for the affected haplotype for three SNPs in EGFR region. Shifts in coverage of specific allelic variants, and haplotype representation consistent with the targeted allele frequencies. B) Comparison of DNA inserts size distribution from a targeted 5-gene cell-free DNA sequencing library subject to introduction of read pairs supporting an <italic>EGFR</italic> single-copy gain. Distribution of insert sizes using 5bp bin size. C) Experimental Cumulative Density Functions (ECDF) of all fragment lengths (blue; median 173, mean: 194.5) and newly introduced read pairs (red; median 175, mean: 197.7) allele specific gain for EGFR. Despite the multimodal nature of the cell free DNA distribution of fragment size (two major peaks at ~160 and 330bp), the fragment size distribution of the original read pairs and that of read pairs introduced to simulate EGFR gain are reasonably consistent (Two sided KS test: 0.11: p-value: 0.81; we note minor discrepancies in relative intensity of second peak at around ~330 relative to the original BAM).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006080.g005" xlink:type="simple"/>
</fig>
<p>While this experiment showcases the ability of Bamgineer to faithfully represent features of original sequencing data while controlling allelic amplification at the level of the individual reads, these subtle shifts are currently beyond the sensitivity of conventional CNV callers when applied to small, deeply covered gene panels. Therefore, it is our hope that Bamgineer may be of value to aid develop of new methods capable of detecting copy number variants supported by a small minority of DNA fragments in a specimen.</p>
</sec>
<sec id="sec008">
<title>Runtime and parallelization</title>
<p>Bamgineer is computationally intensive and the runtime of the program is dictated by the number of reads that must be processed, a function of the coverage of the genomic footprint of target regions. To ameliorate the computational intensiveness of the algorithm, we employed a parallelized computing framework to maximize use of a high-performance compute cluster environment when available. We took advantage of two features in designing the parallelization module. First, we required that added CNVs are independent for each chromosome (although nested events can likely be engineered through serial application of Bamgineer). Second, since we did not model interchromosomal CNV events, each chromosome can be processed independently. As such, CNV regions for each chromosome can be processed in parallel and aggregated as a final step. <xref ref-type="supplementary-material" rid="pcbi.1006080.s008">S8 Fig</xref> shows the runtimes for The Cancer Genome Atlas simulation experiments. Using a single node with 12 cores and 128 GB of RAM, each synthetic BAM took less than 3.5 hours to generate. We also developed a version of Bamgineer that can be launched from sun grid engine cluster environments. It uses python pipeline management package <italic>ruffus</italic> to parallelize tasks automatically and log runtime events. It is highly modular and easily updatable. If disrupted during a run, the pipeline can continue to completion without re-running previously completed intermediate steps.</p>
</sec>
</sec>
<sec id="sec009" sec-type="conclusions">
<title>Discussion</title>
<p>Here, we introduced Bamgineer, to introduce user-defined haplotype-phased allele-specific copy number events into an existing Binary Alignment Mapping (BAM) file, obtained from exome and targeted sequencing experiments. As proof of principle, we generated, from a single high coverage (mean: 220X) BAM file derived from a human blood sample, a series of 30 new BAM files containing a total of 1,693 simulated copy number variants (on average, 56 CNVs comprising 1800Mb i.e. ~55% of the genome per tumor) corresponding to profiles from exemplar tumors for each of 10 cancer types. To demonstrate quantitative introduction of CNVs, we further simulated 4 levels of tumor cellularity (20, 40, 60, 80% purity) resulting in an additional 120 new tumor BAM files. We validated our approach by comparing CNV calls and inferred purity values generated by an allele-specific CNV-caller (Sequenza[<xref ref-type="bibr" rid="pcbi.1006080.ref014">14</xref>]) as well as a focused comparison of allelic variant ratios, haplotype-phasing consistency, and tumor/normal log2 ratios for inferred CNV segments (<xref ref-type="supplementary-material" rid="pcbi.1006080.s001">S1</xref>–<xref ref-type="supplementary-material" rid="pcbi.1006080.s004">S4</xref> Figs). In every case, inferred purity values were within ±5% of the targeted purity; and majority of engineered CNV regions were correctly called by Sequenza (accuracy &gt; 94%; <xref ref-type="supplementary-material" rid="pcbi.1006080.s001">S1</xref>–<xref ref-type="supplementary-material" rid="pcbi.1006080.s004">S4</xref> Figs). Allele variant ratios were also consistent with the expected values both for targeted and the other haplotypes (Median within ±3% of expected value). Median tumor/normal log2 ratios were within ±5% of the expected values.</p>
<p>To demonstrate feasibility beyond exome data, we next evaluated these same metrics in a targeted 5-gene panel applied to a cell-free DNA sequencing library generated from a healthy blood donor and sequenced to &gt;10,000X coverage[<xref ref-type="bibr" rid="pcbi.1006080.ref017">17</xref>] To simulate concentrations of tumor-derived fragments typically encountered in cancer patients, we introduced <italic>EGFR</italic> amplifications at frequencies of 100, 10, 1, 0.1, and 0.01%. As with the exome data, we observed highly specific shifts in allele variant ratios, log2 coverage ratios, and haplotype representation consistent with the targeted allele frequencies. Our method also retained the bimodal DNA insert size distribution observed in the original read alignment. However, it is worthwhile noting that, these minute shifts are currently beyond the sensitivity of existing CNV callers when applied to small, deeply covered gene panels. Consequently, we anticipate that Bamgineer may be of value to aid develop of new methods capable of detecting copy number variants supported by a small minority of DNA fragments.</p>
<p>In the experiments conducted in this study, we limited ourselves to autosomes and to maximum total copy number to 4. Naturally, Bamgineer can readily simulate higher-level copy number states and alter sex chromosomes as well (<xref ref-type="supplementary-material" rid="pcbi.1006080.s010">S10 Fig</xref>). While chromosome X in diploid state (e.g. XX in normal female) is treated identically to autosomes, for both X and Y chromosomes beginning in haplotype state (e.g. XY in normal male), the haplotype phasing step is skipped and Bamgineer samples all reads on these chromosomes independently. For high-level amplifications, the ability of Bamgineer to faithfully retain the features of the input Bam file (e.g. DNA fragment insert size, quality scores and so on), depends on the intrinsic factors such as the length of the desired CNV, mean depth of coverage and fragment length distribution of the original input BAM file (see <xref ref-type="sec" rid="sec010">Materials and Methods</xref>).</p>
<p>The significance of this work in the context of CNV inference in cancer is twofold: 1) users can simulate CNVs using their own locally-generated alignments so as to reflect lab-, biospecimen-, or pipeline-specific features; 2) bioinformatic methods development can be better supported by ground-truth sequencing data reflecting CNVs without reliance on generated test data from suboptimal tissue or plasma specimens. Bamgineer addresses both problems by creating standardized sequencing alignment format (BAM files) harbouring user-defined CNVs that can readily be used for algorithm optimization, benchmarking and other purposes.</p>
<p>We expect our approach to be applicable to tune algorithms for detection of subtle CNV signals such as somatic mosaicism or circulating tumor DNA. As these subtle shifts are beyond the sensitivity of many CNV callers, we expect our tool to be of value for the development of new methods for detecting such events trained on conventional DNA sequencing data. By providing the ability to create customized user-generated reference data, Bamgineer will prove valuable inn development and benchmarking of CNV calling and other sequence data analysis tools and pipelines.</p>
<p>The work presented herein can be extended in several directions. First, Bamgineer is not able to reliably perform interchromosomal operations such as chromosomal translocation, as our focus has been on discrete regions probed by exome and targeted panels. Second, while Bamgineer is readily applicable to whole genome sequence data, sufficient numbers of reads are required for re-pairing when introducing high-level amplifications. As such, shallow (0.1-1X) or conventional (~30X) whole genome sequence data may only be amenable to introduction of arm-level alterations as smaller, focal targets may not contain sufficient numbers of reads to draw from to simulate high-level amplifications. Additionally, in our current implementation, we limited the simulated copy numbers to non-overlapping regions. Certainly, such overlapping CNV regions occur in cancer and iterative application of Bamgineer may enable introduction of complex, nested events. Finally, introduction of compound, serially acquired CNVs may be of interest to model subclonal phylogeny developed over time in bulk tumor tissue samples.</p>
</sec>
<sec id="sec010" sec-type="materials|methods">
<title>Materials and methods</title>
<p>Bamgineer uses several python packages for parsing input files (pyVCF[<xref ref-type="bibr" rid="pcbi.1006080.ref019">19</xref>], VCFtools[<xref ref-type="bibr" rid="pcbi.1006080.ref020">20</xref>], and pybedtools[<xref ref-type="bibr" rid="pcbi.1006080.ref021">21</xref>], manipulating BAM files (pysam[<xref ref-type="bibr" rid="pcbi.1006080.ref022">22</xref>], Samtools[<xref ref-type="bibr" rid="pcbi.1006080.ref023">23</xref>], Sambamba[<xref ref-type="bibr" rid="pcbi.1006080.ref024">24</xref>] and BamUtils[<xref ref-type="bibr" rid="pcbi.1006080.ref025">25</xref>]), phasing haplotypes (BEAGLE[<xref ref-type="bibr" rid="pcbi.1006080.ref010">10</xref>], and distributing compute jobs in cluster environments (ruffus[<xref ref-type="bibr" rid="pcbi.1006080.ref026">26</xref>]). HaplotypeCaller from the Genome Analysis Toolkit (GATK)[<xref ref-type="bibr" rid="pcbi.1006080.ref027">27</xref>] is used to call germline heterozygous SNPs (het.vcf) if known haplotype SNP data is not provided. The analysis workflow is outlined in <xref ref-type="supplementary-material" rid="pcbi.1006080.s009">S9 Fig</xref>.</p>
<sec id="sec011">
<title>Inputs</title>
<p>The user provides 2 mandatory inputs to Bamgineer as command-line arguments: 1) a BAM file containing aligned paired-end sequencing reads (“<italic>Normal</italic>.<italic>bam”</italic>), 2) a BED file containing the genome coordinates and type of CNVs (e.g. allele-specific gain) to introduce (“CNV regions.bed”). Bamgineer can be used to add four broad categories of CNVs: Balanced Copy Number Gain (BCNG), Allele-specific Copy Number Gain (ASCNG), Allele-specific Copy Number Loss (ACNL), and Homozygous Deletion (HD). For example, consider a genotype AB at a genomic locus where A represents the major and B represents the minor allele.</p>
<p>Bamgineer can be applied to convert that genomic locus to any of the following copy number states:
<disp-formula id="pcbi.1006080.e002">
<alternatives>
<graphic id="pcbi.1006080.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006080.e002" xlink:type="simple"/>
<mml:math display="block" id="M2">
<mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mi>A</mml:mi><mml:mi>B</mml:mi><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mi>A</mml:mi><mml:mi>A</mml:mi><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mi>A</mml:mi><mml:mi>B</mml:mi><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mi>A</mml:mi><mml:mi>A</mml:mi><mml:mi>B</mml:mi><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mi>A</mml:mi><mml:mi>A</mml:mi><mml:mi>A</mml:mi><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mi>A</mml:mi><mml:mi>B</mml:mi><mml:mi>B</mml:mi><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mo>…</mml:mo></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
An optional VCF file containing phased germline calls can be provided (<italic>phased_het</italic>.<italic>vcf</italic>). If this file is not provided, Bamgineer will call germline heterozygous single nucleotide polymorphisms (SNPs) using the GATK HaplotypeCaller and then categorize alleles likely to be co-located on the same haplotypes using BEAGLE and population reference data from the HapMap project.</p>
</sec>
<sec id="sec012">
<title>Isolation of source reads to construct haplotype-specific CNVs</title>
<p>To obtain paired-reads in CNV regions of interest, we first intersect <italic>Normal</italic>.<italic>bam</italic> with the targeted regions overlapping user-defined CNV regions (<italic>roi</italic>.<italic>bed</italic>). This operation generates a new BAM file (<italic>roi</italic>.<italic>bam</italic>). Subsequently, depending on whether the CNV event is a gain or loss, the algorithms performs two separate steps as follows.</p>
</sec>
<sec id="sec013">
<title>Creation of new read pairs simulating copy gains</title>
<p>To introduce copy number gains, Bamgineer creates new read-pairs constructed from existing reads within each region of interest. This approach thereby avoids introducing pairs that many tools would flag as molecular duplicates due to read 1 and read 2 having start and end positions identical to an existing pair. If desired, these read pairs can be restricted to reads meeting a specific SAM flag. For our exome experiments, we used read pairs with a SAM flag equal to 99, 147, 83, or 163, i.e. read paired, read mapped in proper pair, mate reverse (forward) strand, and first (second) in pair. To enable support for the bimodal distribution of DNA fragment sizes in ctDNA, we removed the requirement for “read mapped in proper pair” and used read pairs with a SAM flag equal to 97, 145, 81, or 161. Users considering engineering of reads supporting large inserts or intrachromosomal read pairs may also want to remove the requirement for “read mapped in proper pair”. Additionally, we required that the selection of the newly paired read is within ±50%(±20% for ctDNA) of the original read size.</p>
<p>The newly created read- pairs are provided unique read names to avoid confusion with the original input BAM file. To enable inspection of these reads, these newly created read pairs are stored in a new BAM file, <italic>gain_re_paired_renamed</italic>.<italic>bam</italic>, prior to merging into the final engineered BAM. Since we only consider high quality reads (i.e. properly paired reads, primary alignments and mapping quality &gt; 30), the newly created BAM file contains fewer reads compared to the input file (~90–95% in our proof-of-principle experiments). As such, at every transition we log the ratio between number of reads between the input and output files.</p>
<p><italic>High-level copy number amplification (ASCN &gt; = 4)</italic>. To achieve higher than 4 copy number amplifications, during the read/mate pairing step, we pair each read with more than one mate read (<xref ref-type="fig" rid="pcbi.1006080.g001">Fig 1</xref>) to generate more new reads (to accommodate the desired copy number state). Though, since as stated a small portion of newly created paired reads do not meet the inclusion criteria, we aim to create more reads than necessary in the initial phase and use the sampling to adjust them in a later phase. For instance, to simulate copy number of 6, in theory we need create two new read pairs for every input read. Hence, in the initial “re-pairing” step we aim to create four paired reads per read (instead of 3), so that the newly created Bam file includes enough number of reads (as a rule of thumb, we use read-paring window size of ~20% higher than theoretical value). It should be noted that the maximum copy number amplification that can faithfully retain the features of the input BAM file (e.g. DNA fragment insert size, quality scores and so on), depends on the intrinsic factors such as the length of the desired CNV, mean depth of coverage and fragment length distribution of the original input BAM file.</p>
<p><italic>Introduction of mutations according to haplotype state</italic>. To ensure newly constructed read-pairs match the desired haplotype, we alter the base at heterozygous SNP locations (<italic>phased_het</italic>.<italic>vcf</italic>) within each read according to haplotype provided by the user or inferred using the BEAGLE algorithm. To achieve this, we iterate through the set of re-paired reads used to increase coverage (<italic>gain_re_paired_renamed</italic>.<italic>bam</italic>) and modify bases overlapping SNPs corresponding to the target haplotype (<italic>phased_het</italic>.<italic>vcf</italic>). We then write these reads to a new BAM file (<italic>gain_re_paired_renamed_mutated</italic>.<italic>bam</italic>) prior to merging into the final engineered BAM (<xref ref-type="supplementary-material" rid="pcbi.1006080.s009">S9 Fig</xref>).</p>
<p>As an illustrative example consider two heterozygous SNPs, <italic>AB</italic> and <italic>CD</italic> both with allele frequencies of ~0.5 in the original BAM file (i.e. approximately half of the reads supporting reference bases and the other half supporting alternate bases. To introduce a 2-copy gain of a single haplotype, reads to be introduced must match the desired haplotype rather than the two haplotypes found in the original data. If heterozygous <italic>AB</italic> and <italic>CD</italic> are both located on a haplotype comprised of alternative alleles, at the end of this step, 100% of the newly re-paired reads will support alternate base-pairs (e.g. BB and DD). Based on the haplotype structure provided, other haplotype combinations are possible including AA/DD, BB/CC, etc.</p>
<p><italic>Sampling of reads to reflect desired allele fraction</italic>. Depending on the absolute copy number desired for the for CNV gain regions, we sample the BAM files according to the desired copy number state. We define conversion coefficient as the ratio of total reads in the created BAM from previous step (<italic>gain_repaired_mutated</italic>.<italic>bam</italic>) to the total reads extracted from original input file (<italic>roi</italic>.<italic>bam</italic>):
<disp-formula id="pcbi.1006080.e003">
<alternatives>
<graphic id="pcbi.1006080.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006080.e003" xlink:type="simple"/>
<mml:math display="block" id="M3">
<mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mo>.</mml:mo><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mspace width="0.25em"/><mml:mi>g</mml:mi><mml:mi>a</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mo>_</mml:mo><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mo>_</mml:mo><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mi>i</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mo>_</mml:mo><mml:mi>m</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mo>.</mml:mo><mml:mi>b</mml:mi><mml:mi>a</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mo>.</mml:mo><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mspace width="0.25em"/><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mo>.</mml:mo><mml:mi>b</mml:mi><mml:mi>a</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:mfrac>
</mml:math>
</alternatives>
<label>(1)</label>
</disp-formula>
According to the maximum number of absolute copy number (ACN) for simulated CNV gain regions (defined by the user), two scenarios are conceivable as follows.</p>
<p><italic>Copy number gain example</italic>. For instance, to achieve the single copy gain (ACN = 3, e.g. ABB copy state), the file in the previous step (<italic>gain_re_paired_renamed_mutated</italic>.<italic>bam</italic>), should be sub-sampled such that on average depth of coverage is half that of extracted reads from the target regions from the original input normal file(<italic>roi</italic>.<italic>bam</italic>). Thus, the final sampling rate is calculated by dividing ½(0.5) by <italic>ρ</italic> (subsample <italic>gain_re_paired_renamed_mutated</italic>.<italic>bam</italic> such that we have half of the <italic>roi</italic>.bam depth of coverage for the region; in practice adjusted sampling rate is in the range of 0.51–0.59 i.e. 0.85 &lt; <italic>ρ</italic> &lt; 1 for CN = 3) and the new reads are written to a new BAM file (<italic>gain_re_paired_renamed_mutated_sampled</italic>.<italic>bam</italic>) that we then merge with the original reads <italic>(roi</italic>.<italic>bam)</italic> to obtain <italic>gain_final</italic>.<italic>bam</italic>. Similarly to obtain three copy number gain (ACN = 5) and the desired genotype ABBBB, the <italic>gain_re_paired_renamed_mutated</italic>.<italic>bam</italic> is subsampled such that depth of coverage is 3/2(1.5) that of extracted reads from the target regions from the original input normal file(note that as explained during the new paired-read generation step, we have already created more reads than needed).</p>
</sec>
<sec id="sec014">
<title>Removing read-pairs to simulate CNV Loss</title>
<p>To introduce CNV losses, Bamgineer removes reads from the original BAM corresponding to a specific haplotype and does not create new read pairs from existing ones. To diminish coverage in regions of simulated copy number loss, we sub-sample the BAM files according to the desired copy number state and write these to a new file. The conversion coefficient is defined similarly as the number of reads in <italic>loss_mutated</italic>.<italic>bam</italic> divided by number of reads in <italic>roi_loss</italic>.<italic>bam</italic> (&gt; ~0.98). Similar to CNV gains, the sampling rate is adjusted such that after the sampling, the average depth of coverage is half that of extracted reads from the target regions (calculated by dividing 0.5 by conversion ratio, as the absolute copy number is 1 for loss regions). Finally, we subtract the reads in CNV loss BAMs from the <italic>input</italic>.<italic>bam</italic> (or <italic>input_sampled</italic>.<italic>bam</italic>) and merge the results with CNV gain BAM (<italic>gain_final</italic>.<italic>bam</italic>) to obtain, the final output BAM file harbouring the desired copy number events.</p>
</sec>
<sec id="sec015">
<title>Statistical benchmarking and evaluation</title>
<p>To validate that the new paired-reads generated from the original BAM files show similar probability distribution, we used two-sided Kolmogorov–Smirnov (KS) test. The critical D-values where calculated for <italic>α</italic> = 0.01 as follows:
<disp-formula id="pcbi.1006080.e004">
<alternatives>
<graphic id="pcbi.1006080.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006080.e004" xlink:type="simple"/>
<mml:math display="block" id="M4">
<mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>c</mml:mi><mml:mo>(</mml:mo><mml:mi>α</mml:mi><mml:mo>)</mml:mo><mml:msqrt><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:msqrt>
</mml:math>
</alternatives>
<label>(2)</label>
</disp-formula>
where coefficient c(α) is obtained from Table of critical values for KS test (<ext-link ext-link-type="uri" xlink:href="https://www.webdepot.umontreal.ca/Usagers/angers/MonDepotPublic/STT3500H10/Critical_KS.pdf" xlink:type="simple">https://www.webdepot.umontreal.ca/Usagers/angers/MonDepotPublic/STT3500H10/Critical_KS.pdf</ext-link>; 1.63 for α = 0.01) and n<sub>1</sub> and n<sub>2</sub> are the number of samples in each dataset. To assess tumor allelic ratio consistency, for each SNP the theoretical allele frequency parameter was used as a reference point (<xref ref-type="disp-formula" rid="pcbi.1006080.e005">Eq 3</xref>). Median, interquartile range and mean were drawn from the observed values for each haplotype-event pair for all the SNPs. The boxplot distribution of the allele frequencies were plotted and compared against the theoretical reference point. To assess the segmentation accuracy, we used log2 tumor to normal depth ratios of segments normalized for mean ploidy as the metric; where the mean ploidy is (Eqs <xref ref-type="disp-formula" rid="pcbi.1006080.e007">4</xref> and <xref ref-type="disp-formula" rid="pcbi.1006080.e008">5</xref>). To benchmark the performance of segmentation accuracy, we used accuracy as the metrics. Statistical analysis was performed with the functions in the R statistical computing package using RStudio.</p>
<p><italic>Theoretical expected values</italic>. The expected value for tumor allelic frequencies at heterozygous SNP <italic>loci</italic> for tumor purity level of <italic>p</italic> (1-<italic>p</italic>: normal contamination) is calculated as follows:
<disp-formula id="pcbi.1006080.e005">
<alternatives>
<graphic id="pcbi.1006080.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006080.e005" xlink:type="simple"/>
<mml:math display="block" id="M5">
<mml:mi>A</mml:mi><mml:mi>F</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mi>n</mml:mi><mml:mi>p</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:msub><mml:mrow><mml:mi>A</mml:mi><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mspace width="0.12em"/><mml:mi>c</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.12em"/><mml:msub><mml:mrow><mml:mi>c</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:msub><mml:mrow><mml:mi>c</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac>
</mml:math>
</alternatives>
<label>(3)</label>
</disp-formula>
where <italic>AF</italic><sub><italic>t</italic></sub> and <italic>AF</italic><sub><italic>n</italic></sub> represent the expected allele frequencies for tumor and normal and <italic>cn</italic><sub><italic>t</italic></sub> and <italic>cn</italic><sub><italic>n</italic></sub> the expected copy number for tumor and normal at specific SNP <italic>loci</italic>. For CNV events used in this experiment <italic>AF</italic><sub><italic>t</italic></sub> are (1/3 or 2/3) for gain and (1 or 0) for loss CNVs according to the haplotype information (whether or not they are located on the haplotype that is affected by each CNV). The expected value for the average ploidy (<inline-formula id="pcbi.1006080.e006"><alternatives><graphic id="pcbi.1006080.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006080.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:mover accent="true"><mml:mrow><mml:mi>∅</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>) is calculated as follows
<disp-formula id="pcbi.1006080.e007">
<alternatives>
<graphic id="pcbi.1006080.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006080.e007" xlink:type="simple"/>
<mml:math display="block" id="M7">
<mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">∅</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mfrac bevelled="true"><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>W</mml:mi></mml:mrow></mml:mfrac><mml:mo>(</mml:mo><mml:mrow><mml:mstyle displaystyle="false"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:mstyle><mml:mrow><mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mstyle displaystyle="false"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup></mml:mstyle><mml:mrow><mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mstyle displaystyle="false"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:mstyle><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>W</mml:mi><mml:mo>−</mml:mo><mml:mi>G</mml:mi><mml:mo>−</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo>
</mml:math>
</alternatives>
<label>(4)</label>
</disp-formula>
, where <italic>cn</italic><sub><italic>g</italic></sub>, <italic>cn</italic><sub><italic>l</italic></sub>, <italic>cn</italic><sub><italic>n</italic></sub>, <italic>w</italic><sub><italic>g</italic></sub> and <italic>w</italic><sub><italic>l</italic></sub> represent the expected ploidy for gain, loss and normal regions, and the length of individual gain and loss events respectively. <italic>W</italic>, <italic>G</italic>, and <italic>L</italic> represent total length (in base pairs) for gain regions, loss regions, and the entire genome (~ 3e9).</p>
<p>The expected log2ratio for each segment is calculated as follows
<disp-formula id="pcbi.1006080.e008">
<alternatives>
<graphic id="pcbi.1006080.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006080.e008" xlink:type="simple"/>
<mml:math display="block" id="M8">
<mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mn>2</mml:mn><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>g</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mn>2</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi><mml:mo>×</mml:mo><mml:mi>c</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>g</mml:mi><mml:mo>+</mml:mo><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">∅</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow>
</mml:math>
</alternatives>
<label>(5)</label>
</disp-formula>
,where <italic>cn</italic><sub><italic>seg</italic></sub> is the segment mean from Sequenza output, <italic>p</italic> tumor purity and <inline-formula id="pcbi.1006080.e009"><alternatives><graphic id="pcbi.1006080.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006080.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:mover accent="true"><mml:mrow><mml:mi>∅</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is the average ploidy calculated above. <italic>cn</italic><sub><italic>n</italic></sub> is the copy number of copy neutral region (i.e. 2)</p>
<p><italic>Similarity score to rank TCGA tumors</italic>. The similarity score for specific cancer type (c) and sampled tumor (t) is calculated as follows:
<disp-formula id="pcbi.1006080.e010">
<alternatives>
<graphic id="pcbi.1006080.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006080.e010" xlink:type="simple"/>
<mml:math display="block" id="M10">
<mml:mi>S</mml:mi><mml:mo>(</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mo>(</mml:mo><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mn>2</mml:mn><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>|</mml:mo><mml:mo>+</mml:mo><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mn>2</mml:mn><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>|</mml:mo><mml:mo>+</mml:mo><mml:mi>ϵ</mml:mi><mml:mo>)</mml:mo>
</mml:math>
</alternatives>
<label>(6)</label>
</disp-formula>
, where <italic>g</italic><sub><italic>t</italic></sub>, <italic>G</italic><sub><italic>c</italic></sub>, <italic>G</italic><sub><italic>o</italic></sub> represent the total number of gains for specific tumor sampled from Cancer Genome Atlas (after merging adjacent regions and removing overlapping regions), median number of gains for specific tumor type, and number of gain events overlapping with GISTIC peaks respectively; <italic>l</italic><sub><italic>t</italic></sub>, <italic>L</italic><sub><italic>c</italic></sub>, <italic>L</italic><sub><italic>o</italic></sub> represent the above quantities for CNV loss regions(<italic>ϵ</italic> is an arbitrary small positive value to avoid zero denominator). The higher score the closer is the sampled tumor to an exemplar tumor from specific cancer type.</p>
</sec>
</sec>
<sec id="sec016">
<title>Supporting information</title>
<supplementary-material id="pcbi.1006080.s001" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006080.s001" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Cancer-specific allelic ratio (y-axis) changes with purity (x-axis) for CNV gain regions.</title>
<p>Allelic ratio boxplots for cancer-specific copy number gain at heterozygous SNP <italic>loci</italic> for haplotypes affected (blue) and Haplotypes not affected (red) at different tumour cellularity levels.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006080.s002" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006080.s002" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Cancer-specific allelic ratio (y-axis) changes with purity (x-axis) for CNV loss regions.</title>
<p>Allelic ratio boxplots for cancer-specific copy number loss at heterozygous SNP <italic>loci</italic> for haplotypes affected (blue) and Haplotypes not affected (red) at different tumour cellularity levels.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006080.s003" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006080.s003" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Cancer-specific tumor/normal log2 ratio(y-axis) changes with purity(x-axis).</title>
<p>Tumor to normal log2 depth ratio boxplots for cancer-specific copy number gain (red) and loss (blue) at different tumour cellularity levels normalized for mean ploidy.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006080.s004" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006080.s004" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>Cancer-specific segmentation accuracy changes with purity.</title>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006080.s005" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006080.s005" xlink:type="simple">
<label>S5 Fig</label>
<caption>
<title>ECDFs of original and newly created reads.</title>
<p>Experimental Cumulative Density Functions (ECDF) of all fragment lengths (blue; median 194, mean: 212.3) and newly introduced read pairs (red; median 194, mean: 211.97) allele specific gain for chromosome 22. The distribution before and after the addition of CNV is consistent.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006080.s006" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006080.s006" xlink:type="simple">
<label>S6 Fig</label>
<caption>
<title>Whole exome sequencing pipeline for CNV inference.</title>
<p>Pipeline for detecting absolute and allele-specific CNV. Varscan2 was used for depth normalization. Varscan2 output was then used to infer allele-specific copy number profiles as well as tumour purity and ploidy using Sequenza note that in this case “tumour” file will be the synthetic file generated using Bamgineer.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006080.s007" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006080.s007" xlink:type="simple">
<label>S7 Fig</label>
<caption>
<title>Cancer-specific CNV introduction.</title>
<p>Overview of the design used to introduce cancer-specific CNV events. Parallelization module enables to simultaneously implement cancer-based, chromosome-based and event-based engineering of CNVs, significantly improving the performance (see “Runtime benchmarks and parallelization”)</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006080.s008" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006080.s008" xlink:type="simple">
<label>S8 Fig</label>
<caption>
<title>Bamgineer runtimes (hours) for different tumour types.</title>
<p>T1, T2, and T3 represent the three exemplar tumors selected from TCGA tumor profiles to best represent the copy number landscape for each cancer type for each cancer type (see <xref ref-type="table" rid="pcbi.1006080.t001">Table 1</xref>).</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006080.s009" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006080.s009" xlink:type="simple">
<label>S9 Fig</label>
<caption>
<title>Bamgineer algorithm overview.</title>
<p>A) Overall architecture of Bamgineer for editing an existing BAM file to add and delete the user defined CNV event. The input and output files are shown in dark grey. The modules are shown darker relative to the files generated at each step. B) Creating new paired-reads from existing ones. The algorithms splits the input BAM files into four separate files according to DNA strand and read information. Bamgineer then iterates through split reads (read1 and read2) from each strand separately, pairing one read from read1 splits to another read from read2 split. The insert-size (tlen) in the newly paired read is then calculated and updated.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006080.s010" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006080.s010" xlink:type="simple">
<label>S10 Fig</label>
<caption>
<title>High-level amplification of p-arm of chromosome X (CN = 7).</title>
<p>Bamgineer was used to introduce of 6 additional copies of the p-arm of chromosome X to total copy number of 7 from whole exome sequencing data from a male and accurately called using Sequenza. In the top track, blue and red lines show allele specific copy number profiles for each chromosome (lines are offset from discrete copy number values by ± 0.1 for visual separation of the two alleles). In the bottom track, the red lines depict total copy number with an overall normal diploid genome apart from the amplification of Xp introduced by Bamgineer.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006080.s011" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006080.s011" xlink:type="simple">
<label>S1 Table</label>
<caption>
<title>Allele counts at 3 SNPS in <italic>EGFR</italic>.</title>
<p>Introduction of <italic>EGFR</italic> gain to targeted 5-gene panel (18 kb) applied to a cell-free DNA at frequencies of 100, 10, 1, 0.1, and 0.01%. The Alt and Ref columns represent the count of alternative and reference base pairs at each variant position. The columns in bold represents the phased targeted haplotype. We note that Bamgineer can be used to introduce subtle shifts in coverage of specific allelic variants, and haplotype representation consistent with the targeted allele frequencies.</p>
<p>(DOCX)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We thank Rene Quevedo, Olena Kis, the staff of the Princess Margaret Genomics Centre (<ext-link ext-link-type="uri" xlink:href="http://www.pmgenomics.ca/" xlink:type="simple">www.pmgenomics.ca</ext-link>, Neil Winegarden, Julissa Tsao and Nick Khuu) and Bioinformatics Services (Carl Virtanen, Zhibin Lu and Natalie Stickle) for their expertise in generating the sequencing data used in this study.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1006080.ref001"><label>1</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sathirapongsasuti</surname> <given-names>JF</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Horst</surname> <given-names>BAJ</given-names></name>, <name name-style="western"><surname>Brunner</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Cochran</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Binder</surname> <given-names>S</given-names></name>, <etal>et al</etal>. <article-title>Exome Sequencing-Based Copy-Number Variation and Loss of Heterozygosity Detection: ExomeCNV</article-title>. <source>Bioinformatics</source>. <year>2011</year>;btr462.</mixed-citation></ref>
<ref id="pcbi.1006080.ref002"><label>2</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Chiang</surname> <given-names>DY</given-names></name>, <name name-style="western"><surname>Getz</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Jaffe</surname> <given-names>DB</given-names></name>, <name name-style="western"><surname>O’Kelly</surname> <given-names>MJT</given-names></name>, <name name-style="western"><surname>Zhao</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Carter</surname> <given-names>SL</given-names></name>, <etal>et al</etal>. <article-title>High-resolution mapping of copy-number alterations with massively parallel sequencing</article-title>. <source>Nat Methods</source>. <year>2009</year>;<volume>6</volume>:<fpage>99</fpage>–<lpage>103</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nmeth.1276" xlink:type="simple">10.1038/nmeth.1276</ext-link></comment> <object-id pub-id-type="pmid">19043412</object-id></mixed-citation></ref>
<ref id="pcbi.1006080.ref003"><label>3</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kim</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Jeong</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Bafna</surname> <given-names>V</given-names></name>. <article-title>Wessim: a whole-exome sequencing simulator based on in silico exome capture</article-title>. <source>Bioinformatics</source>. <year>2013</year>;<volume>29</volume>:<fpage>1076</fpage>–<lpage>7</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btt074" xlink:type="simple">10.1093/bioinformatics/btt074</ext-link></comment> <object-id pub-id-type="pmid">23413434</object-id></mixed-citation></ref>
<ref id="pcbi.1006080.ref004"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Stankiewicz</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Lupski</surname> <given-names>JR</given-names></name>. <article-title>Structural variation in the human genome and its role in disease</article-title>. <source>Annu Rev Med</source>. <year>2010</year>;<volume>61</volume>:<fpage>437</fpage>–<lpage>55</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1146/annurev-med-100708-204735" xlink:type="simple">10.1146/annurev-med-100708-204735</ext-link></comment> <object-id pub-id-type="pmid">20059347</object-id></mixed-citation></ref>
<ref id="pcbi.1006080.ref005"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tan</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Kleinstein</surname> <given-names>SE</given-names></name>, <name name-style="western"><surname>Liu</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Zhu</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Guo</surname> <given-names>H</given-names></name>, <etal>et al</etal>. <article-title>An evaluation of copy number variation detection tools from whole-exome sequencing data</article-title>. <source>Hum Mutat</source>. <year>2014</year>;<volume>35</volume>:<fpage>899</fpage>–<lpage>907</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/humu.22537" xlink:type="simple">10.1002/humu.22537</ext-link></comment> <object-id pub-id-type="pmid">24599517</object-id></mixed-citation></ref>
<ref id="pcbi.1006080.ref006"><label>6</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Escalona</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Rocha</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Posada</surname> <given-names>D</given-names></name>. <article-title>A comparison of tools for the simulation of genomic next-generation sequencing data</article-title>. <source>Nat Rev Genet</source> [Internet]. <year>2016</year> [cited 2016 Jul 9];advance online publication. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.nature.com/nrg/journal/vaop/ncurrent/full/nrg.2016.57.html" xlink:type="simple">http://www.nature.com/nrg/journal/vaop/ncurrent/full/nrg.2016.57.html</ext-link></mixed-citation></ref>
<ref id="pcbi.1006080.ref007"><label>7</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Huang</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Myers</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>Marth</surname> <given-names>GT</given-names></name>. <article-title>ART: a next-generation sequencing read simulator</article-title>. <source>Bioinformatics</source>. <year>2012</year>;<volume>28</volume>:<fpage>593</fpage>–<lpage>4</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btr708" xlink:type="simple">10.1093/bioinformatics/btr708</ext-link></comment> <object-id pub-id-type="pmid">22199392</object-id></mixed-citation></ref>
<ref id="pcbi.1006080.ref008"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">DWGSim [Internet]. Available from: <ext-link ext-link-type="uri" xlink:href="https://github.com/nh13/DWGSIM" xlink:type="simple">https://github.com/nh13/DWGSIM</ext-link></mixed-citation></ref>
<ref id="pcbi.1006080.ref009"><label>9</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ewing</surname> <given-names>AD</given-names></name>, <name name-style="western"><surname>Houlahan</surname> <given-names>KE</given-names></name>, <name name-style="western"><surname>Hu</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Ellrott</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Caloian</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Yamaguchi</surname> <given-names>TN</given-names></name>, <etal>et al</etal>. <article-title>Combining tumor genome simulation with crowdsourcing to benchmark somatic single-nucleotide-variant detection</article-title>. <source>Nat Meth</source>. <year>2015</year>;<volume>12</volume>:<fpage>623</fpage>–<lpage>30</lpage>.</mixed-citation></ref>
<ref id="pcbi.1006080.ref010"><label>10</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Browning</surname> <given-names>SR</given-names></name>, <name name-style="western"><surname>Browning</surname> <given-names>BL</given-names></name>. <article-title>Rapid and accurate haplotype phasing and missing-data inference for whole-genome association studies by use of localized haplotype clustering</article-title>. <source>Am J Hum Genet</source>. <year>2007</year>;<volume>81</volume>:<fpage>1084</fpage>–<lpage>97</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1086/521987" xlink:type="simple">10.1086/521987</ext-link></comment> <object-id pub-id-type="pmid">17924348</object-id></mixed-citation></ref>
<ref id="pcbi.1006080.ref011"><label>11</label><mixed-citation publication-type="other" xlink:type="simple">Picard [Internet]. Picard. Available from: <ext-link ext-link-type="uri" xlink:href="http://broadinstitute.github.io/picard" xlink:type="simple">http://broadinstitute.github.io/picard</ext-link></mixed-citation></ref>
<ref id="pcbi.1006080.ref012"><label>12</label><mixed-citation publication-type="other" xlink:type="simple">mpileup [Internet]. Available from: <ext-link ext-link-type="uri" xlink:href="http://samtools.sourceforge.net/mpileup.shtml" xlink:type="simple">http://samtools.sourceforge.net/mpileup.shtml</ext-link></mixed-citation></ref>
<ref id="pcbi.1006080.ref013"><label>13</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Koboldt</surname> <given-names>DC</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>Q</given-names></name>, <name name-style="western"><surname>Larson</surname> <given-names>DE</given-names></name>, <name name-style="western"><surname>Shen</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>McLellan</surname> <given-names>MD</given-names></name>, <name name-style="western"><surname>Lin</surname> <given-names>L</given-names></name>, <etal>et al</etal>. <article-title>VarScan 2: Somatic mutation and copy number alteration discovery in cancer by exome sequencing</article-title>. <source>Genome Res</source>. <year>2012</year>;<volume>22</volume>:<fpage>568</fpage>–<lpage>76</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1101/gr.129684.111" xlink:type="simple">10.1101/gr.129684.111</ext-link></comment> <object-id pub-id-type="pmid">22300766</object-id></mixed-citation></ref>
<ref id="pcbi.1006080.ref014"><label>14</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Favero</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Joshi</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Marquard</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Birkbak</surname> <given-names>NJ</given-names></name>, <name name-style="western"><surname>Krzystanek</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>Q</given-names></name>, <etal>et al</etal>. <article-title>Sequenza: allele-specific copy number and mutation profiles from tumor sequencing data</article-title>. <source>Ann Oncol</source>. <year>2015</year>;<volume>26</volume>:<fpage>64</fpage>–<lpage>70</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/annonc/mdu479" xlink:type="simple">10.1093/annonc/mdu479</ext-link></comment> <object-id pub-id-type="pmid">25319062</object-id></mixed-citation></ref>
<ref id="pcbi.1006080.ref015"><label>15</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mermel</surname> <given-names>CH</given-names></name>, <name name-style="western"><surname>Schumacher</surname> <given-names>SE</given-names></name>, <name name-style="western"><surname>Hill</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Meyerson</surname> <given-names>ML</given-names></name>, <name name-style="western"><surname>Beroukhim</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Getz</surname> <given-names>G</given-names></name>. <article-title>GISTIC2.0 facilitates sensitive and confident localization of the targets of focal somatic copy-number alteration in human cancers</article-title>. <source>Genome Biology</source>. <year>2011</year>;<volume>12</volume>:<fpage>R41</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/gb-2011-12-4-r41" xlink:type="simple">10.1186/gb-2011-12-4-r41</ext-link></comment> <object-id pub-id-type="pmid">21527027</object-id></mixed-citation></ref>
<ref id="pcbi.1006080.ref016"><label>16</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wang</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Nettleton</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Ying</surname> <given-names>K</given-names></name>. <article-title>Copy number variation detection using next generation sequencing read counts</article-title>. <source>BMC Bioinformatics</source>. <year>2014</year>;<volume>15</volume>:<fpage>109</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/1471-2105-15-109" xlink:type="simple">10.1186/1471-2105-15-109</ext-link></comment> <object-id pub-id-type="pmid">24731174</object-id></mixed-citation></ref>
<ref id="pcbi.1006080.ref017"><label>17</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kis</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Kaedbey</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Chow</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Danesh</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Dowar</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>T</given-names></name>, <etal>et al</etal>. <article-title>Circulating tumour DNA sequence analysis as an alternative to multiple myeloma bone marrow aspirates</article-title>. <source>Nat Commun</source>. <year>2017</year>;<volume>8</volume>:<fpage>15086</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ncomms15086" xlink:type="simple">10.1038/ncomms15086</ext-link></comment> <object-id pub-id-type="pmid">28492226</object-id></mixed-citation></ref>
<ref id="pcbi.1006080.ref018"><label>18</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wan</surname> <given-names>JCM</given-names></name>, <name name-style="western"><surname>Massie</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Garcia-Corbacho</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Mouliere</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Brenton</surname> <given-names>JD</given-names></name>, <name name-style="western"><surname>Caldas</surname> <given-names>C</given-names></name>, <etal>et al</etal>. <article-title>Liquid biopsies come of age: towards implementation of circulating tumour DNA</article-title>. <source>Nat Rev Cancer</source>. <year>2017</year>;<volume>17</volume>:<fpage>223</fpage>–<lpage>38</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nrc.2017.7" xlink:type="simple">10.1038/nrc.2017.7</ext-link></comment> <object-id pub-id-type="pmid">28233803</object-id></mixed-citation></ref>
<ref id="pcbi.1006080.ref019"><label>19</label><mixed-citation publication-type="other" xlink:type="simple">pyvcf [Internet]. PyVCF. Available from: <ext-link ext-link-type="uri" xlink:href="https://github.com/jamescasbon/PyVCF" xlink:type="simple">https://github.com/jamescasbon/PyVCF</ext-link></mixed-citation></ref>
<ref id="pcbi.1006080.ref020"><label>20</label><mixed-citation publication-type="other" xlink:type="simple">VCFtools [Internet]. Available from: <ext-link ext-link-type="uri" xlink:href="https://vcftools.github.io/index.html" xlink:type="simple">https://vcftools.github.io/index.html</ext-link></mixed-citation></ref>
<ref id="pcbi.1006080.ref021"><label>21</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dale</surname> <given-names>RK</given-names></name>, <name name-style="western"><surname>Pedersen</surname> <given-names>BS</given-names></name>, <name name-style="western"><surname>Quinlan</surname> <given-names>AR</given-names></name>. <article-title>Pybedtools: a flexible Python library for manipulating genomic datasets and annotations</article-title>. <source>Bioinformatics</source>. <year>2011</year>;<volume>27</volume>:<fpage>3423</fpage>–<lpage>4</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btr539" xlink:type="simple">10.1093/bioinformatics/btr539</ext-link></comment> <object-id pub-id-type="pmid">21949271</object-id></mixed-citation></ref>
<ref id="pcbi.1006080.ref022"><label>22</label><mixed-citation publication-type="other" xlink:type="simple">pysam [Internet]. Available from: <ext-link ext-link-type="uri" xlink:href="https://github.com/pysam-developers/pysam" xlink:type="simple">https://github.com/pysam-developers/pysam</ext-link></mixed-citation></ref>
<ref id="pcbi.1006080.ref023"><label>23</label><mixed-citation publication-type="other" xlink:type="simple">Samtools [Internet]. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.htslib.org/" xlink:type="simple">http://www.htslib.org/</ext-link></mixed-citation></ref>
<ref id="pcbi.1006080.ref024"><label>24</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tarasov</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Vilella</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Cuppen</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Nijman</surname> <given-names>IJ</given-names></name>, <name name-style="western"><surname>Prins</surname> <given-names>P</given-names></name>. <article-title>Sambamba: fast processing of NGS alignment formats</article-title>. <source>Bioinformatics</source>. <year>2015</year>;<volume>31</volume>:<fpage>2032</fpage>–<lpage>4</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btv098" xlink:type="simple">10.1093/bioinformatics/btv098</ext-link></comment> <object-id pub-id-type="pmid">25697820</object-id></mixed-citation></ref>
<ref id="pcbi.1006080.ref025"><label>25</label><mixed-citation publication-type="other" xlink:type="simple">BamUtil [Internet]. Available from: <ext-link ext-link-type="uri" xlink:href="https://github.com/statgen/bamUtil" xlink:type="simple">https://github.com/statgen/bamUtil</ext-link></mixed-citation></ref>
<ref id="pcbi.1006080.ref026"><label>26</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Goodstadt</surname> <given-names>L</given-names></name>. <article-title>Ruffus: A Lightweight Python Library for Computational Pipelines</article-title>. <source>Bioinformatics</source>. <year>2010</year>;btq524.</mixed-citation></ref>
<ref id="pcbi.1006080.ref027"><label>27</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>DePristo</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Banks</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Poplin</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Garimella</surname> <given-names>KV</given-names></name>, <name name-style="western"><surname>Maguire</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>Hartl</surname> <given-names>C</given-names></name>, <etal>et al</etal>. <article-title>A framework for variation discovery and genotyping using next-generation DNA sequencing data</article-title>. <source>Nat Genet</source>. <year>2011</year>;<volume>43</volume>:<fpage>491</fpage>–<lpage>8</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ng.806" xlink:type="simple">10.1038/ng.806</ext-link></comment> <object-id pub-id-type="pmid">21478889</object-id></mixed-citation></ref>
</ref-list>
</back>
</article>