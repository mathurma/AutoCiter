<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-16-01632</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1005509</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Evolutionary biology</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject><subj-group><subject>Phylogenetic analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Taxonomy</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject><subj-group><subject>Phylogenetic analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Data management</subject><subj-group><subject>Taxonomy</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject><subj-group><subject>Phylogenetic analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Oncology</subject><subj-group><subject>Cancers and neoplasms</subject><subj-group><subject>Lung and intrathoracic tumors</subject><subj-group><subject>Non-small cell lung cancer</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Evolutionary biology</subject><subj-group><subject>Evolutionary genetics</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Evolutionary biology</subject><subj-group><subject>Evolutionary processes</subject><subj-group><subject>Parallel evolution</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Human genetics</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Evolutionary biology</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Taxonomy</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Data management</subject><subj-group><subject>Taxonomy</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Evolutionary biology</subject><subj-group><subject>Evolutionary processes</subject></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>phyC: Clustering cancer evolutionary trees</article-title>
<alt-title alt-title-type="running-head">Clustering cancer evolutionary trees</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-3977-4313</contrib-id>
<name name-style="western">
<surname>Matsui</surname> <given-names>Yusuke</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Niida</surname> <given-names>Atsushi</given-names></name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Uchi</surname> <given-names>Ryutaro</given-names></name>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Mimori</surname> <given-names>Koshi</given-names></name>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Miyano</surname> <given-names>Satoru</given-names></name>
<xref ref-type="aff" rid="aff005"><sup>5</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Shimamura</surname> <given-names>Teppei</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Division of Systems Biology, Nagoya University Graduate School of Medicine, Nagoya, Japan</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Division of Health Medical Computational Science, Health Intelligence Center, The Institute of Medical Science, The University of Tokyo, Tokyo, Japan</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>Department of Otorhinolaryngology, Graduate School of Medical Sciences, Kyushu University, Fukuoka, Japan</addr-line>
</aff>
<aff id="aff004">
<label>4</label>
<addr-line>Department of Surgery, Kyushu University Beppu Hospital, Beppu, Japan</addr-line>
</aff>
<aff id="aff005">
<label>5</label>
<addr-line>Laboratory of DNA Information Analysis, Human Genome Center, Institute of Medical Science, The University of Tokyo, Tokyo, Japan</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Markowetz</surname> <given-names>Florian</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>University of Cambridge, UNITED KINGDOM</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con">
<p><list list-type="simple">
<list-item>
<p><bold>Conceptualization:</bold> YM TS AN RU.</p>
</list-item>
<list-item>
<p><bold>Data curation:</bold> YM RU.</p>
</list-item>
<list-item>
<p><bold>Formal analysis:</bold> YM.</p>
</list-item>
<list-item>
<p><bold>Funding acquisition:</bold> YM SM.</p>
</list-item>
<list-item>
<p><bold>Investigation:</bold> YM.</p>
</list-item>
<list-item>
<p><bold>Methodology:</bold> YM.</p>
</list-item>
<list-item>
<p><bold>Project administration:</bold> YM TS.</p>
</list-item>
<list-item>
<p><bold>Resources:</bold> AN SM.</p>
</list-item>
<list-item>
<p><bold>Software:</bold> YM.</p>
</list-item>
<list-item>
<p><bold>Supervision:</bold> TS KM SM.</p>
</list-item>
<list-item>
<p><bold>Validation:</bold> TS AN RU.</p>
</list-item>
<list-item>
<p><bold>Visualization:</bold> YM.</p>
</list-item>
<list-item>
<p><bold>Writing – original draft:</bold> YM.</p>
</list-item>
<list-item>
<p><bold>Writing – review &amp; editing:</bold> YM.</p>
</list-item>
</list>
</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">ymatsui@med.nagoya-u.ac.jp</email> (YM); <email xlink:type="simple">shimamura@med.nagoya-u.ac.jp</email> (TS)</corresp>
</author-notes>
<pub-date pub-type="collection">
<month>5</month>
<year>2017</year>
</pub-date>
<pub-date pub-type="epub">
<day>1</day>
<month>5</month>
<year>2017</year>
</pub-date>
<volume>13</volume>
<issue>5</issue>
<elocation-id>e1005509</elocation-id>
<history>
<date date-type="received">
<day>6</day>
<month>10</month>
<year>2016</year>
</date>
<date date-type="accepted">
<day>10</day>
<month>4</month>
<year>2017</year>
</date>
</history>
<permissions>
<copyright-year>2017</copyright-year>
<copyright-holder>Matsui et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1005509"/>
<abstract>
<p>Multi-regional sequencing provides new opportunities to investigate genetic heterogeneity within or between common tumors from an evolutionary perspective. Several state-of-the-art methods have been proposed for reconstructing cancer evolutionary trees based on multi-regional sequencing data to develop models of cancer evolution. However, there have been few studies on comparisons of a set of cancer evolutionary trees. We propose a clustering method (phyC) for cancer evolutionary trees, in which sub-groups of the trees are identified based on topology and edge length attributes. For interpretation, we also propose a method for evaluating the sub-clonal diversity of trees in the clusters, which provides insight into the acceleration of sub-clonal expansion. Simulation showed that the proposed method can detect true clusters with sufficient accuracy. Application of the method to actual multi-regional sequencing data of clear cell renal carcinoma and non-small cell lung cancer allowed for the detection of clusters related to cancer type or phenotype. phyC is implemented with R(≥3.2.2) and is available from <ext-link ext-link-type="uri" xlink:href="https://github.com/ymatts/phyC" xlink:type="simple">https://github.com/ymatts/phyC</ext-link>.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>Elucidating the differences between cancer evolutionary patterns among patients is valuable in personalized medicine, since therapeutic response mostly depends on cancer evolution process. Recently, computational methods have been extensively studied to reconstruct a cancer evolutionary pattern within a patient, which is visualized as a so-called “cancer evolutionary tree” constructed from multi-regional sequencing data. However, there have been few studies on comparisons of a set of cancer evolutionary trees to better understand the relationship between a set of cancer evolutionary patterns and patient phenotypes. Given a set of tree objects for multiple patients, we propose an unsupervised learning approach to identify subgroups of patients through clustering the respective cancer evolutionary trees. Using this approach, we effectively identified the patterns of different evolutionary modes in a simulation analysis, and also successfully detected the phenotype-related and cancer type-related subgroups to characterize tree structures within subgroups using actual datasets. We believe that the value and impact of our work will grow as more and more datasets for the cancer evolution of patients become available.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001691</institution-id>
<institution>Japan Society for the Promotion of Science</institution>
</institution-wrap>
</funding-source>
<award-id>16700621</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-3977-4313</contrib-id>
<name name-style="western">
<surname>Matsui</surname> <given-names>Yusuke</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001691</institution-id>
<institution>Japan Society for the Promotion of Science</institution>
</institution-wrap>
</funding-source>
<award-id>16753325</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-3977-4313</contrib-id>
<name name-style="western">
<surname>Matsui</surname> <given-names>Yusuke</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award003">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001691</institution-id>
<institution>Japan Society for the Promotion of Science</institution>
</institution-wrap>
</funding-source>
<award-id>15H05707</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Miyano</surname> <given-names>Satoru</given-names></name>
</principal-award-recipient>
</award-group>
<funding-statement>This work was supported by 16K16146, 16H01572, 15H05707 from The Japan Society for the Promotion of Science (<ext-link ext-link-type="uri" xlink:href="http://www.jsps.go.jp/english/e-grants/grants01.html" xlink:type="simple">http://www.jsps.go.jp/english/e-grants/grants01.html</ext-link>). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="4"/>
<table-count count="3"/>
<page-count count="17"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2017-05-15</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>Data are from the <ext-link ext-link-type="uri" xlink:href="https://github.com/ymatts/phyC/" xlink:type="simple">https://github.com/ymatts/phyC/</ext-link>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Cancer is a heterogeneous disease. The high genetic diversity is driven by several evolutionary processes such as somatic mutation, genetic drift, migration, and natural selection. The clonal theory of cancer [<xref ref-type="bibr" rid="pcbi.1005509.ref001">1</xref>] is based on Darwinian models of natural selection in which genetically unstable cells acquire a somatic single nucleotide variant (SSNV), and selective pressure results in tumors with a biological fitness advantage for survival.</p>
<p>The development of multi-regional sequencing techniques has provided new perspectives of genetic heterogeneity within or between common tumors [<xref ref-type="bibr" rid="pcbi.1005509.ref002">2</xref>–<xref ref-type="bibr" rid="pcbi.1005509.ref006">6</xref>]. The read counts from multi-region tumor and matched normal tissue sequences from each patient are then used to infer the tumor composition and evolutionary structure from variant allele frequencies (VAFs); <italic>i</italic>.<italic>e</italic>., the proportion of reads containing the variant allele. Using the VAF, the cancer evolutionary histories can be reconstructed as a tree, termed a cancer evolutionary tree, which reflects the accumulation patterns of the identified SSNVs for each patient.</p>
<p>A variety of cancer evolutionary trees can be considered as the consequence of the evolutionary principle for the underlying tumor, which may lead to resistance to chemotherapeutics and targeted therapies [<xref ref-type="bibr" rid="pcbi.1005509.ref019">19</xref>, <xref ref-type="bibr" rid="pcbi.1005509.ref020">20</xref>]. Therefore, characterizing inter-tumor heterogeneity according to the patterns of evolutionary trees is an important strategy for developing new targeted therapies and for preventing the emergence of drug resistance. There are currently two types of cancer evolutionary trees: sample tree and sub-clonal tree. A sample tree regards each multi-region sample as being equivalent to a species in a classical tree of taxonomic phylogenetic relationships, and infers the evolutionary trees from the binary VAF profiles using classical phylogenetic algorithms such as the maximum parsimony method. A sub-clonal tree clusters SSNVs into sets of mutations with common frequency and reconstructs the lineage based on the following two assumptions [<xref ref-type="bibr" rid="pcbi.1005509.ref007">7</xref>–<xref ref-type="bibr" rid="pcbi.1005509.ref016">16</xref>]: (i) a mutation cannot recur during the course of cancer evolution, and (ii) no mutation can be lost [<xref ref-type="bibr" rid="pcbi.1005509.ref017">17</xref>] (<xref ref-type="fig" rid="pcbi.1005509.g001">Fig 1A</xref>). In these trees, the root and its subsequent node represent a normal cell and a founder cell, respectively. Descendant sub-clones are represented as nodes below the founder cell, and edge lengths indicate the number of SSNVs that are newly accumulated in the descendant nodes (<xref ref-type="fig" rid="pcbi.1005509.g001">Fig 1B</xref>). For reviews, see [<xref ref-type="bibr" rid="pcbi.1005509.ref018">18</xref>].</p>
<fig id="pcbi.1005509.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005509.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Overview of the proposed method.</title>
<p>(A) Example of cancer evolution. A founder cell is established after a normal cell acquires several passenger mutations and driver mutations (founder SSNVs), and sub-clones evolve by acquiring progressor SSNVs. Each color (purple, orange, dark blue, light blue, and green) of circles represents different sub-clones. (B) Example of a cancer evolutionary tree in the case of (A). A root and its immediate node represent the normal cell and founder cell, respectively. Subsequent nodes indicate sub-clones and edge lengths indicate the number of SSNVs acquired in the sub-clones. (C) Example of the registration of a tree. To resolve (p1)–(p4) for comparison of the evolutionary trees, a sufficiently large bifurcated tree is constructed, which is the reference tree (note that we have omitted bifurcation from the root for clearer visualization). The tree topologies and attributes are mapped to the reference tree beginning with those with the largest depths to those with the smallest depths. In the case of a tie, the sub-trees are mapped from those with the largest edge lengths. Zero-length edges are regarded as degenerated edges (dashed lines). Edge lengths are normalized by the sum of all edge lengths within tumors. The resulting trees can be represented as edge length vectors <bold>z</bold><sub><italic>i</italic></sub>. (D) Clustering cancer evolutionary trees to summarize the evolutionary history of cancer for each patient. The trees are reconstructed based on the VAFs and then <italic>n</italic> cancer sub-clonal evolutionary trees are divided into <italic>K</italic> subgroups based on tree topologies and edge attributes. Through the registration, <italic>n</italic> evolutionary trees can be represented as <italic>m</italic>-dimensional <italic>n</italic> vectors in Euclidean space, and a standard clustering algorithm can be applied.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005509.g001" xlink:type="simple"/>
</fig>
<p>Several studies have suggested specific evolutionary patterns of tumors with various, and at times conflicting, results. For example, Gerlinger <italic>et al</italic>. [<xref ref-type="bibr" rid="pcbi.1005509.ref021">21</xref>] identified the parallel evolution of sub-clones in clear cell renal cell carcinomas (ccRCCs), whereas no such parallel evolution was evident in studies on non-small cell lung cancer (NSCLC) [<xref ref-type="bibr" rid="pcbi.1005509.ref022">22</xref>, <xref ref-type="bibr" rid="pcbi.1005509.ref023">23</xref>]. Zhang <italic>et al</italic>. [<xref ref-type="bibr" rid="pcbi.1005509.ref023">23</xref>] also showed that in a relapsed group of patients, the fraction of SSNVs in sub-clones was significantly larger than that of founder cells. These studies indicate that both the branching patterns and fraction of SSNVs in sub-clones are important factors for identifying the cancer type or phenotype of related subgroups.</p>
<p>Although the reconstruction methods developed thus far have revealed intra-tumor heterogeneity by reconstructing individual evolutionary trees, there are currently no standardized tree comparison methods for obtaining a detailed understanding of inter-tumor heterogeneity according to evolutionary patterns with a set of reconstructed trees. Comparison of phylogenetic trees has long been discussed in the context of the evolution of species, and several comparative analytical methods have been developed, including nearest-neighbor interchanging [<xref ref-type="bibr" rid="pcbi.1005509.ref025">25</xref>], subtree transfer distance [<xref ref-type="bibr" rid="pcbi.1005509.ref026">26</xref>], quartet distance [<xref ref-type="bibr" rid="pcbi.1005509.ref027">27</xref>], Robinson-Foulds distance [<xref ref-type="bibr" rid="pcbi.1005509.ref028">28</xref>], path length metrics [<xref ref-type="bibr" rid="pcbi.1005509.ref029">29</xref>], branch length scores [<xref ref-type="bibr" rid="pcbi.1005509.ref030">30</xref>], tree edit distance [<xref ref-type="bibr" rid="pcbi.1005509.ref031">31</xref>–<xref ref-type="bibr" rid="pcbi.1005509.ref033">33</xref>], and Billera-Holmes-Vogtmann (BHV) distance [<xref ref-type="bibr" rid="pcbi.1005509.ref034">34</xref>]. However, these distances are defined for phylogenetic trees with the same set of leaves, and therefore cannot accurately deal with the following problems, (p1)–(p4), that are specific to the context of cancer evolutionary trees.</p>
<list list-type="simple">
<list-item>
<p>(<bold>p1</bold>) The parental sub-clone has one child sub-clone or more than two child sub-clones.</p>
</list-item>
<list-item>
<p>(<bold>p2</bold>) The number of sub-clones varies among patients.</p>
</list-item>
<list-item>
<p>(<bold>p3</bold>) SSNV contents differ among patients.</p>
</list-item>
<list-item>
<p>(<bold>p4</bold>) The number of detected SSNVs varies among patients.</p>
</list-item>
</list>
<p>(p1) and (p2) imply that a tree structure is not always binary, and the number of sub-clones within the tree differs among patients. Various types of new sub-clones can be produced from a common ancestral sub-clone by acquiring new sets of SSNVs, which results in complex tree structures and tree sizes. (p3) and (p4) indicate that sub-clones are rarely identical among patients since the SSNVs within a patient are quite different from those of other patients, and it is thus hard to match sub-clones between patients. In addition, the total number of SSNVs can vary substantially among patients. Therefore, according to experimental conditions, it is important to adjust for these effects to effectively compare the trees. These problems motivated us to develop a method for the effective comparison among tree via transformation of the tree topologies and edge attributes, a procedure we refer to as tree registration.</p>
<p>In this paper, we propose a new clustering method for cancer evolutionary trees based on tree topologies and edge attributes that describe the relationships of sub-clones and the number of SSNVs that accumulate in the sub-clones. Our conceptual framework is based on object-oriented data analysis [<xref ref-type="bibr" rid="pcbi.1005509.ref024">24</xref>], in which the observation units are non-numeric objects such as functions and trees. The main contributions of this paper are development of (i) a tree registration method for cancer evolutionary trees, (ii) a clustering method of the registered trees, and (iii) an evaluation method of the clusters, which can be applied using our software phyC in the R environment.</p>
<p>In the registration, we resolve the issues raised in (p1)–(p4) through development of a method for transforming tree objects by mapping tree topologies and their attributes to make the trees comparable (<xref ref-type="fig" rid="pcbi.1005509.g001">Fig 1C</xref>). The registered trees are embedded in Euclidean space, which enables defining the distance between the cancer evolutionary trees. Based on this distance, we divide a set of the trees into several sub-groups with a clustering method (<xref ref-type="fig" rid="pcbi.1005509.g001">Fig 1D</xref>). We developed two tools for interpretation of the clusters: multidimensional scaling (MDS) and a sub-clonal diversity plot.</p>
<p>We evaluated the performance of phyC using simulated data that mimic the actual scenarios. We also demonstrate the applicability of phyC using two actual datasets from patients with ccRCCs [<xref ref-type="bibr" rid="pcbi.1005509.ref021">21</xref>] and NSCLC [<xref ref-type="bibr" rid="pcbi.1005509.ref023">23</xref>], respectively, to show the interpretability of the clustering results. phyC is implemented with R(≥3.2.2) and is available from <ext-link ext-link-type="uri" xlink:href="https://github.com/ymatts/phyC" xlink:type="simple">https://github.com/ymatts/phyC</ext-link>.</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Methods</title>
<p>We denote <italic>n</italic> reconstructed cancer evolutionary trees as <italic>X</italic> = {<italic>x</italic><sub><italic>i</italic></sub>; <italic>i</italic> = 1, 2, …, <italic>n</italic>}, and the edges and edge lengths are denoted as {<italic>e</italic><sub><italic>ij</italic></sub>; <italic>i</italic> = 1, 2, …, <italic>n</italic>, <italic>j</italic> = 1, 2, …, <italic>m</italic><sub><italic>i</italic></sub>} and {|<italic>e</italic><sub><italic>ij</italic></sub>|; <italic>i</italic> = 1, 2, …, <italic>n</italic> <italic>j</italic> = 1, 2, …, <italic>m</italic><sub><italic>i</italic></sub>}, respectively. Without loss of generality, {<italic>e</italic><sub><italic>i</italic>1</sub>; <italic>i</italic> = 1, 2, …, <italic>n</italic>} indicates the edge from the normal cell to the founder cell. Given the number of terminal nodes <italic>N</italic><sub><italic>i</italic></sub>; <italic>i</italic> = 1, 2, …, <italic>m</italic><sub><italic>i</italic></sub>, we set depth (<italic>i</italic>.<italic>e</italic>., the number of edges in the path from the root to the terminal node) as <italic>d</italic><sub><italic>ik</italic></sub>(<italic>i</italic> = 1, 2, …, <italic>n</italic>; <italic>k</italic> = 1, 2, …, <italic>N</italic><sub><italic>i</italic></sub>).</p>
<sec id="sec003">
<title>Registration</title>
<p>We developed a registration method for the cancer evolutionary trees. The goal of the registration is to transform the observed trees such that dissimilarities can be defined with consideration of the tree topologies and edge attributes. To solve the problems (p1)–(p4), we provide the following approaches, (q1) and (q2):</p>
<list list-type="simple">
<list-item>
<p>(<bold>q1</bold>) Reference tree encoding</p>
</list-item>
<list-item>
<p>(<bold>q2</bold>) Normalizing edge lengths</p>
</list-item>
</list>
<p>To account for different tree structures and sizes as raised in (p1), we consider a reference tree-encoding approach that is similar to [<xref ref-type="bibr" rid="pcbi.1005509.ref035">35</xref>]. In this approach, we prepare a very large bifurcated tree called a reference tree (corresponding to the maximum tree in [<xref ref-type="bibr" rid="pcbi.1005509.ref036">36</xref>] and encode the observed tree topologies and edge lengths onto the reference. Zero-length edges are regarded as degenerated edges (<xref ref-type="fig" rid="pcbi.1005509.g001">Fig 1C</xref>). The advantage of this approach is that once we encode the observed tree onto a reference tree, the comparison can be simply achieved for trees of the same structures and sizes. To account for the issue (p4), we developed a method for normalization of the edge length to remove the bias in the detected number of SSNVs.</p>
<p>Here, we describe the details of the registration method. First, we set the maximum depth in <italic>X</italic> as <italic>d</italic><sub><italic>max</italic></sub>(<italic>X</italic>) = max {<italic>d</italic><sub><italic>ik</italic></sub>; <italic>i</italic> = 1, 2, …, <italic>n</italic>, <italic>k</italic> = 1, 2, …, <italic>N</italic><sub><italic>i</italic></sub>} and define the reference tree as follows.</p>
<p><bold>Definition 1</bold> (<bold>Reference tree</bold>) <italic>The reference tree is a bifurcated tree with the minimum depth of d</italic><sub><italic>max</italic></sub>(<italic>X</italic>).</p>
<p>Thus, the reference tree has <italic>m</italic> = 2(2<sup><italic>d</italic><sub><italic>max</italic></sub>(<italic>X</italic>)</sup> − 1) edges (<xref ref-type="fig" rid="pcbi.1005509.g001">Fig 1C</xref>). We denote the reference tree as <italic>X</italic><sub><italic>ref</italic></sub> with edges and edge lengths <italic>E</italic><sub><italic>k</italic></sub>; <italic>k</italic> = 1, 2, …, <italic>m</italic> and |<italic>E</italic><sub><italic>k</italic></sub>|; <italic>k</italic> = 1, 2, …, <italic>m</italic>, respectively. The registration can then be defined with the reference tree.</p>
<p><bold>Definition 2</bold> (<bold>Registration</bold>) <italic>Registration is a mapping f</italic>: <italic>X</italic> ↦ <italic>X</italic><sub><italic>ref</italic></sub>.</p>
<p>We define the mapped trees as <italic>Y</italic> = {<italic>f</italic>(<italic>x</italic><sub><italic>i</italic></sub>); <italic>i</italic> = 1, 2, …, <italic>n</italic>}, and more specifically, the mapped edge and edge length are set to {<italic>E</italic><sub><italic>ik</italic></sub>; <italic>i</italic> = 1, 2, …, <italic>n</italic>, <italic>k</italic> = 1, 2, …, <italic>m</italic>} and {|<italic>E</italic><sub><italic>ik</italic></sub>|; <italic>i</italic> = 1, 2, …, <italic>n</italic>, <italic>k</italic> = 1, 2, …, <italic>m</italic>}, respectively. The number of edges differs between the observed tree and the reference tree, and we also need to account for any unmapped edges. Since the degenerated edges can be regarded as the zero-length edge when considering the distance of trees [<xref ref-type="bibr" rid="pcbi.1005509.ref036">36</xref>], we can define |<italic>E</italic><sub><italic>ik</italic>′</sub>| = |<italic>e</italic><sub><italic>ij</italic></sub>|; <italic>k</italic>′ ∈ <italic>A</italic> for the mapped edge index set <italic>A</italic> ⊆ {1, 2, …, <italic>m</italic>}, and define |<italic>E</italic><sub><italic>ik</italic>′</sub>| = 0; <italic>k</italic>′ ∈ <italic>B</italic> for the unmapped edge index <italic>B</italic> = {1, 2, …, <italic>m</italic>}\<italic>A</italic>.</p>
<p>To resolve (p3), we developed the mapping rule <italic>e</italic><sub><italic>ij</italic></sub> ↦ <italic>E</italic><sub><italic>ik</italic></sub> for <italic>j</italic> = 1, 2, …, <italic>m</italic><sub><italic>i</italic></sub>, <italic>k</italic> = 1, 2, …, <italic>m</italic>, such that the observed trees are mapped onto the reference tree beginning with sub-trees with the largest depths and moving on to those with the smallest depths (<xref ref-type="fig" rid="pcbi.1005509.g001">Fig 1C</xref>). When the depths are the same among the sub-trees, we use the edge length and map the sub-trees beginning with those with the largest edge lengths (Fig G in <xref ref-type="supplementary-material" rid="pcbi.1005509.s001">S1 Text</xref>).</p>
<p>In the last step of the registration, we perform normalization for the edge length. Zhang <italic>et al</italic>. [<xref ref-type="bibr" rid="pcbi.1005509.ref023">23</xref>] importantly suggested in NSCLC study that patients with relapsed disease had larger fractions in their primary tumors (average 41% in patients with relapse versus 24% in patients without relapse, p = 0.045 by t test). Therefore, we consider that the ratio of the number of accumulated SSNVs is an important factor to characterize and compare the cancer evolutionary trees, and we divided each edge length by the total number of SSNVs within patients.</p>
<disp-formula id="pcbi.1005509.e002"><alternatives><graphic id="pcbi.1005509.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005509.e002" xlink:type="simple"/><mml:math display="block" id="M2"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="4.pt"/><mml:mtext>for</mml:mtext><mml:mspace width="4.pt"/><mml:mtext>all</mml:mtext><mml:mspace width="4.pt"/><mml:mi>k</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(1)</label></disp-formula>
</sec>
<sec id="sec004">
<title>Clustering set of registered trees</title>
<p>To define the dissimilarity between the registered trees, we begin with the space of the set of the registered trees. Billera <italic>et al</italic>. [<xref ref-type="bibr" rid="pcbi.1005509.ref034">34</xref>] proposed the concept of a continuous tree space-associated geodesic distance metric as a natural way to embed and compare phylogenetic trees. This tree space consists of a set of Euclidean regions, called orthants, one for each tree topology. Orthants are joined together whenever one tree topology can be made into another by exchanging edges between the trees. Within an orthant, the coordinates of each point represent the edge lengths for a particular tree with the topology associated with that orthant. Since we only encode the observed trees onto the reference tree with the same topology, the registered trees do indeed lie in the same orthant as a special case of BHV space.</p>
<p><bold>Corollary 1</bold> (<bold>Euclidean embedding</bold>) <italic>The registered trees lie in Euclidean space</italic>.</p>
<p>We represent the registered tree as a vector, whose elements correspond to each edge length as <inline-formula id="pcbi.1005509.e003"><alternatives><graphic id="pcbi.1005509.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005509.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow> <mml:mi>i</mml:mi> <mml:mo>′</mml:mo></mml:msubsup> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mn>2</mml:mn></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mi>z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>m</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>;</mml:mo> <mml:msub><mml:mi>z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>∈</mml:mo> <mml:mtext>R</mml:mtext></mml:mrow></mml:math></alternatives></inline-formula>. Note that zero length edges are regarded as degenerated edges. Thus, <italic>n</italic> registered trees are represented as the <italic>n</italic> × <italic>m</italic> matrix <inline-formula id="pcbi.1005509.e004"><alternatives><graphic id="pcbi.1005509.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005509.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">Z</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msup> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold">z</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi mathvariant="bold">z</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo> <mml:msub><mml:mi mathvariant="bold">z</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p>We define the dissimilarity as follows:
<disp-formula id="pcbi.1005509.e005"><alternatives><graphic id="pcbi.1005509.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005509.e005" xlink:type="simple"/><mml:math display="block" id="M5"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>s</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≔</mml:mo><mml:msqrt><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold">z</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi mathvariant="bold">z</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>′</mml:mo></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold">z</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi mathvariant="bold">z</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msqrt> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2)</label></disp-formula></p>
<p>The basic statistics of the cancer evolutionary trees can also be defined. The tree average is defined as <inline-formula id="pcbi.1005509.e006"><alternatives><graphic id="pcbi.1005509.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005509.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:mrow><mml:mi>μ</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>n</mml:mi></mml:mfrac> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:msubsup> <mml:msub><mml:mi mathvariant="bold">z</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> and the tree variance is defined as <inline-formula id="pcbi.1005509.e007"><alternatives><graphic id="pcbi.1005509.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005509.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:mrow><mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>n</mml:mi></mml:mfrac> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:msubsup> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold">z</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:mi>μ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>′</mml:mo></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold">z</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:mi>μ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p>Based on the tree representation with <bold>Z</bold>, which can be regarded as <italic>n</italic> observations with an <italic>m</italic> features matrix, we can simply apply standard clustering algorithms and divide the <italic>n</italic> trees into subgroups. Hierarchical clustering was then implemented using phyC. To determine the number of clusters automatically, we applied the gap statistics criterion [<xref ref-type="bibr" rid="pcbi.1005509.ref037">37</xref>] with the NbClust R package [<xref ref-type="bibr" rid="pcbi.1005509.ref038">38</xref>].</p>
</sec>
<sec id="sec005">
<title>Graphical representation</title>
<p>Interpreting clustering results is a key issue for tree comparison, which requires understanding the features of the cancer evolutionary trees in clusters. In particular, visual representation can be a powerful tool for such interpretation. Therefore, we developed two computational tools for comparing trees and understanding the cluster features.</p>
<sec id="sec006">
<title>MDS</title>
<p>To effectively compare the trees, we approximately embedded the registered trees into lower-dimensional Euclidean space. For this purpose, we applied classical MDS (CMDS) [<xref ref-type="bibr" rid="pcbi.1005509.ref039">39</xref>], which is a dimension-reduction technique based on singular value decomposition. We will here omit the details of the CMDS algorithm and briefly describe the method below. Given the symmetric distance matrix <italic>S</italic> = {<italic>s</italic><sub><italic>ij</italic></sub>; <italic>i</italic>, <italic>j</italic> = 1, 2, …, <italic>n</italic>}, the double-centered matrix
<disp-formula id="pcbi.1005509.e009"><alternatives><graphic id="pcbi.1005509.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005509.e009" xlink:type="simple"/><mml:math display="block" id="M9"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>B</mml:mi> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:mi>H</mml:mi> <mml:msup><mml:mi>S</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mi>H</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(3)</label></disp-formula>
is positive semi-definite, where <inline-formula id="pcbi.1005509.e010"><alternatives><graphic id="pcbi.1005509.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005509.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:mrow><mml:mi>H</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>n</mml:mi></mml:mfrac> <mml:msub><mml:mn mathvariant="bold">1</mml:mn> <mml:mi mathvariant="bold">n</mml:mi></mml:msub> <mml:msup><mml:mrow><mml:msub><mml:mn mathvariant="bold">1</mml:mn> <mml:mi mathvariant="bold">n</mml:mi></mml:msub></mml:mrow> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, and can be diagonalized as
<disp-formula id="pcbi.1005509.e001"><alternatives><graphic id="pcbi.1005509.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005509.e001" xlink:type="simple"/><mml:math display="block" id="M1"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>B</mml:mi> <mml:mo>=</mml:mo> <mml:mi>U</mml:mi> <mml:mo>Λ</mml:mo> <mml:msup><mml:mi>U</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(4)</label></disp-formula></p>
<p>The constructed coordinates are obtained by <inline-formula id="pcbi.1005509.e008"><alternatives><graphic id="pcbi.1005509.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005509.e008" xlink:type="simple"/><mml:math display="inline" id="M8"><mml:mrow><mml:mi>X</mml:mi> <mml:mo>=</mml:mo> <mml:mi>U</mml:mi> <mml:msup><mml:mrow><mml:mo>Λ</mml:mo></mml:mrow> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>. For this purpose, we use the distance that is defined in <xref ref-type="disp-formula" rid="pcbi.1005509.e005">Eq (2)</xref>. CMDS requires knowing the number of dimensions, which we set to two for the purpose of convenient visualization. In phyC, we overlaid the tree shapes over the coordinates and visually compared the tree structures based on dissimilarity.</p>
</sec>
<sec id="sec007">
<title>Sub-clonal diversity plot</title>
<p>To visualize how sub-clones evolve with respect to SSNV accumulation, we apply the concept of a lineage-through-time (LTT) plot, which is commonly used for visualizing the timing of speciation events in studies of the birth-death process. The LTT plot generally describes the time vs. number of lineages; in the present case, this is expressed as the number of sub-clones (y-axis) vs. the fraction of accumulated SSNVs (x-axis) and the plot is referred to as a sub-clonal diversity plot. This plot represents the growth rate of the number of sub-clones when a certain percentage of mutations accumulate. In the plot, <italic>y</italic> = 1 means that there is no sub-clone, and thus only a normal cell exists, and <italic>y</italic> = 2 indicates that there is a founder cell. For example, (<italic>x</italic>, <italic>y</italic>) = (0.3, 2) indicates that the founder cell is established with the accumulation of 30% SSNVs. For <italic>y</italic> &gt; 1, the growth curve in the plot represents how many sub-clones emerged for a given fraction of SSNVs. If the curve is upright, the sub-clones evolve with a small fraction of SSNV accumulation, and conversely, if the curve grows with gradual steps, the sub-clones acquire a relatively large fraction of SSNVs. A gradual growth curve was observed in the case of parallel evolution shown in [<xref ref-type="bibr" rid="pcbi.1005509.ref021">21</xref>], which will be demonstrated below in the implementation of the ccRCC dataset.</p>
</sec>
</sec>
</sec>
<sec id="sec008" sec-type="results">
<title>Results</title>
<sec id="sec009">
<title>Simulation analysis</title>
<p>We evaluated the performance of the proposed method using simulation data that reflects real situations. The main purpose of simulation is to show the effectiveness of the registration process for cancer evolutionary tree classification when compared to methods without the registration. Moreover, we investigated whether the differences in tree topology or edge length are more important when comparing tree objects.</p>
<p>There are two types of tree comparison methods: one is based on only tree topologies, and the other is based on both tree topologies and edge attributes. We examined phyC from the viewpoint of classification performance for tree topologies, edge length, and both. We conducted the following three simulations:</p>
<list list-type="simple">
<list-item>
<p><bold>Simulation I</bold> Comparison of tree topologies</p>
</list-item>
<list-item>
<p><bold>Simulation II</bold> Comparison of the edge lengths of tree</p>
</list-item>
<list-item>
<p><bold>Simulation III</bold> Comparison of both tree topologies and edge lengths</p>
</list-item>
</list>
<p>Simulation I was conducted to examine whether phyC can classify tree topologies, <italic>i</italic>.<italic>e</italic>., the edge lengths are all the same. In simulation II, we examined the classification performance of phyC for edge length differences. Simulation III was designed to examine the performance of phyC for both tree topology and edge length differences between tree objects.</p>
<p>To evaluate the clustering results, we adopted three external clustering validation indices [<xref ref-type="bibr" rid="pcbi.1005509.ref040">40</xref>], which are described in <xref ref-type="supplementary-material" rid="pcbi.1005509.s001">S1 Text</xref>: purity (PR), normalized mutual information (NMI), and Rand index (RI). In the following three simulations, we created 100 replicates of each dataset and evaluated the mean and standard deviation of PR, NMI, and RI.</p>
<sec id="sec010">
<title>Simulation I</title>
<p>To simulate cancer evolutionary tree topologies, we manually created four classes of tree topologies used in Yuan <italic>et al</italic>. [<xref ref-type="bibr" rid="pcbi.1005509.ref041">41</xref>]: monoclonal (MC), polyclonal-low (PL), polyclonal-high (PH), and mutator phenotype (MT). Based on the four classes of tree topologies, we generated random topologies via tree editing with various dispersion parameters described in <xref ref-type="supplementary-material" rid="pcbi.1005509.s001">S1 Text</xref>. We obtained 10 trees for each class, and simulations were conducted for various dispersion parameters. The results were compared to those of the tree edit distance (TED) using RTED [<xref ref-type="bibr" rid="pcbi.1005509.ref033">33</xref>] and to those of the shortest path distance (SPD).</p>
</sec>
<sec id="sec011">
<title>Simulation II</title>
<p>Zhang et al. [<xref ref-type="bibr" rid="pcbi.1005509.ref023">23</xref>] showed that the ratio of the number of SSNVs in the trunk to branches was significantly different between the recurrent and non-recurrent group, suggesting that the ratio of the edge length of the trunk to that of the branches can be related to phenotype. We considered three classes of SSNVs accumulation patterns with regard to the edge length of cancer evolutionary trees: trunk-accumulation (TR), balanced-accumulation (BL), and branch accumulation (BR), as shown in <xref ref-type="fig" rid="pcbi.1005509.g002">Fig 2</xref>. In TR and BR, most of the SSNVs are accumulated in the trunk and branch, respectively. In BL, the SSNVs are equally distributed in the trunk and branch. Based on these three classes, we generated the random trees described in <xref ref-type="supplementary-material" rid="pcbi.1005509.s001">S1 Text</xref>. We obtained 10 trees for each class, and simulations were conducted for different variances. The results were compared to those of the branch length score (BScore).</p>
<fig id="pcbi.1005509.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005509.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Classes of cancer evolutionary trees in the simulations.</title>
<p><bold>Simulation I</bold>: Five classes of tree topologies were considered: monoclonal (MC), polyclonal-low (PL), polyclonal-middle (PM), polyclonal-high (PH), and mutator-phenotype (MT). <bold>Simulation II</bold>: Three classes of edge lengths of the tree are considered: trunk accumulation (TR), branched accumulation (BR), and balanced accumulation (BL). <bold>Simulation III</bold>: Nine classes of trees are considered: polyclonal-low trunk accumulation (PL-TR), polyclonal-low balanced accumulation (PL-BL), polyclonal-low branch accumulation (PL-BR), polyclonal-middle trunk-accumulation (PM-TR), polyclonal-middle balanced-accumulation (PM-BL), polyclonal-middle branch-accumulation (PM-BR), polyclonal-high trunk accumulation (PH-TR), polyclonal-high balanced accumulation (PH-BL), and polyclonal-high branch accumulation (PH-BR)</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005509.g002" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec012">
<title>Simulation III</title>
<p>We created nine classes of tree objects considering both tree topology and edge length (<xref ref-type="fig" rid="pcbi.1005509.g002">Fig 2</xref>). We used the three tree topologies from simulation I, PL, PM and PH, and adopted the three classes of SSNVs accumulation patterns from simulation II, TR, BL, and BR, to each tree topology. We obtained nine classes that represent a combination of cases in simulations I and II, named polyclonal-low trunk-accumulation (PL-TR), polyclonal-low balanced-accumulation (PL-BL), polyclonal-low branch-accumulation (PL-BR), polyclonal-middle trunk-accumulation (PM-TR), polyclonal-middle balanced-accumulation (PM-BL), polyclonal-middle branch-accumulation (PM-BR), polyclonal-high trunk-accumulation (PH-TR), polyclonal-high balanced-accumulation (PH-BL), and polyclonal-high branch-accumulation (PH-BR). Based on these nine classes, we generated the random trees described in <xref ref-type="supplementary-material" rid="pcbi.1005509.s001">S1 Text</xref>. We obtained 10 trees for each class, and simulations were conducted for different variances. The results were compared to those of the BScore.</p>
</sec>
<sec id="sec013">
<title>Simulation results</title>
<p><xref ref-type="fig" rid="pcbi.1005509.g003">Fig 3</xref> shows the results of each simulation, where the x-axis and y-axis represent the variance index and performance score, respectively. The variance index corresponds to the descending order of the variance, and the performance scores are defined by external clustering validation indices.</p>
<fig id="pcbi.1005509.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005509.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Results of the simulations.</title>
<p>Each row of panels represents the simulation type (simulation I, II, and III), and each column represents the external clustering validation indices: purity (PR), normalized mutual information (NMI), and Rand index (RI). The horizontal axis of each graph is the variance parameter defined in <xref ref-type="supplementary-material" rid="pcbi.1005509.s001">S1 Text</xref>, and the vertical axis is the external validation index. The bold lines and the bands indicate the mean and 95% confidence interval of the index for 100 replicates of each dataset.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005509.g003" xlink:type="simple"/>
</fig>
<p>In simulation I, phyC outperformed the other methods without the registration, although the performance decreased with an increase in the variance. The performance of NMI of phyC was much higher than that of the other methods, in contrast to those of PR and RI, which indicated that the clusters of TED and SPD included more objects from the other classes than that of phyC. The good performance of phyC is attributed to the mapping for tree topologies in the registration, which allows us to focus only on the tree shapes without considering node labels in contrast to the other methods. The mapping process is clearly effective when considering the differences of cancer evolutionary tree topologies.</p>
<p>In simulation II, phyC showed higher clustering performance than BScore, without the registration. When the variance was large, the performances of phyC and BScore were close; however, the performance of phyC increased with smaller variances. Similar to the results of simulation I, the performance of NMI of phyC was much higher than that of the other methods. These results are attributed to the mapping and edge length normalization in the registration, which allows us to focus on the edge length ratio with regard to SSNVs accumulation patterns.</p>
<p>In simulation III, the performance score of BScore with PR was higher than that of phyC, but the scores for NMI and RI showed the opposite results. In BScore, most of the objects are assigned to a few large clusters, and the remaining fractions of objects are distributed to several small clusters, which results in a high PR score. The good performance of phyC is attributed to the mapping and edge length normalization in the registration, as in simulations I and II. The performance of phyC tended to become saturated at around 0.75 and 0.90 in NMI and RI, respectively, compared to the performance of simulation I and II. This is because the three classes defined by PL-TR, PM-TR, and PH-TR were assigned to the same clusters, which indicates that phyC tends to emphasize the difference in edge length rather than the difference in tree topology when the differences of edge length are extremely large.</p>
<p>These results indicate that our method is effective for capturing the differences in the shapes of cancer evolutionary trees.</p>
</sec>
</sec>
<sec id="sec014">
<title>Real data</title>
<p>We here demonstrate the application of our proposed method using an actual ccRCC dataset [<xref ref-type="bibr" rid="pcbi.1005509.ref021">21</xref>] and an NSCLC dataset [<xref ref-type="bibr" rid="pcbi.1005509.ref023">23</xref>], consisting of 8 and 11 multi-regional tumor samples with VAFs collected among 587 and 7,026 SSNVs, respectively. Since both studies used the maximum parsimony method to reconstruct the cancer evolutionary trees, we also adopted this method to analyze the datasets with our approach. We binarized the VAF profiles with <italic>VAF</italic> ≥ 0.05 as one and otherwise zero. Using the binary profile, we estimated the phylogenetic trees using the function <monospace>acctran</monospace> in the R package <monospace>phangorn</monospace> [<xref ref-type="bibr" rid="pcbi.1005509.ref042">42</xref>] and we obtained 19 cancer evolutionary trees.</p>
<sec id="sec015">
<title>ccRCC dataset</title>
<p>The ccRCC dataset consists of eight evolutionary trees with clinical information related to treatments. We divided the eight evolutionary trees of the ccRCC dataset into three subgroups using hierarchical clustering with Ward’s method. <xref ref-type="table" rid="pcbi.1005509.t001">Table 1</xref> shows the clustering result, and a configuration of the eight trees with CMDS and a dendrogram are shown in <xref ref-type="fig" rid="pcbi.1005509.g004">Fig 4A-1</xref> and Fig A in <xref ref-type="supplementary-material" rid="pcbi.1005509.s001">S1 Text</xref>, respectively. We also show in Fig D of <xref ref-type="supplementary-material" rid="pcbi.1005509.s001">S1 Text</xref> the tree averages that are mean of edge length of registered trees in each cluster.</p>
<table-wrap id="pcbi.1005509.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005509.t001</object-id>
<label>Table 1</label>
<caption>
<title>Clustering result of the ccRCC dataset.</title>
</caption>
<alternatives>
<graphic id="pcbi.1005509.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005509.t001" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left">Cluster</th>
<th align="left">Sample name</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Cluster 1</td>
<td align="left">EV003, EV006</td>
</tr>
<tr>
<td align="left">Cluster 2</td>
<td align="left">EV005, EV007, RMH008, RMH004, RK26, RMH002</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<fig id="pcbi.1005509.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005509.g004</object-id>
<label>Fig 4</label>
<caption>
<title/>
<p>(A-1) Three clusters of the ccRCC dataset. The x-axis and y-axis are the lower dimensions reconstructed by CMDS. Clusters 1 (green) and 2 (orange) reflect drug-sensitive evolution and parallel evolution, respectively; we cannot provide a valid interpretation for cluster 3 (purple) at present. (B-1) Sub-clonal diversity plot of the ccRCC dataset. The x-axis and y-axis are the fraction of accumulated SSNVs and the number of sub-clones, respectively. Each color corresponds to the clusters shown in (A). Expansions in cluster 1 occurred with <italic>x</italic> = 0.6; (<italic>i</italic>.<italic>e</italic>., the proportion of SSNVs in the trunk is 60%). This result is in contrast to that obtained for cluster 2 (<italic>x</italic> = 0.2) and cluster 3 (<italic>x</italic> = 0.1). Trees in cluster 2 show gradual growth of sub-clonal diversity curves, indicating that these sub-clones acquire a relatively large fraction of SSNVs. The sub-clones independently evolve in spatially distinct regions [<xref ref-type="bibr" rid="pcbi.1005509.ref021">21</xref>]. (A-2) Two clusters in the NSCLC dataset. Clusters 1 (green) and 2 (orange) reflect the non-recurrent and recurrent group, respectively. Only case 270 and case 356 were misclassified to clusters 1 and 2, respectively. (B-2) Sub-clonal diversity plot of the NSCLC dataset. Each color corresponds to the clusters shown in (A-2). (A-3) Two clusters in the ccRCC and NSCLC datasets combined. Clusters 1 (green) and 2 (orange) represent the cancer types NSCLC and ccRCC, respectively. (B-3) Sub-clonal diversity plot of the ccRCC and NSCLC datasets.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005509.g004" xlink:type="simple"/>
</fig>
<p>The tree averages in Fig D in <xref ref-type="supplementary-material" rid="pcbi.1005509.s001">S1 Text</xref> indicate that the tree shape of cluster 1 is characterized by trunk accumulation-like shape in contrast to cluster 2 and 3 that are characterized by balanced accumulation and branched accumulation-like shapes, respectively.</p>
<p>Cases EV003 and EV006 in cluster 1 received pretreatment with everolimus [<xref ref-type="bibr" rid="pcbi.1005509.ref021">21</xref>]. The sub-clonal diversity plot shown in <xref ref-type="fig" rid="pcbi.1005509.g004">Fig 4B-1</xref> demonstrates that sub-clonal expansions in cluster 1 occurred after 60% of the SSNVs accumulated, in contrast to cluster 2 (10%), which may indicate that the drug interrupts acquisition of SSNVs in the sub-clones, leading to lower genetic diversity of these sub-clones. Cluster 1 reflects the drug-sensitive sub-clones group, and the result corresponds to the interpretation provided by Gerlinger <italic>et al</italic>. [<xref ref-type="bibr" rid="pcbi.1005509.ref021">21</xref>].</p>
<p>Cases EV005, EV007, RMH004, RMH008, RK26, and RMH002 in cluster 2 acquired a large fraction of SSNVs in the sub-clones (<xref ref-type="fig" rid="pcbi.1005509.g004">Fig 4B-1</xref>). Comparison of the original tree shape demonstrated that the long branches are followed by several private branches. The samples of EV005, EV007, RMH004, and RMH008 were reported as sub-clones of parallel evolution, <italic>i</italic>.<italic>e</italic>., each sub-clone independently evolved in spatially distinct regions [<xref ref-type="bibr" rid="pcbi.1005509.ref021">21</xref>].</p>
<p>These findings demonstrate that our method can produce interpretable clusters for the drug-sensitive group and parallel evolution group in the ccRCC dataset.</p>
</sec>
<sec id="sec016">
<title>NSCLC dataset</title>
<p>The NSCLC dataset consists of 11 evolutionary trees with the following clinical information: staging (IA, IIA, IIIA, and IB), smoking status (former, current, and never), and recurrence (yes and no). We divided the 11 trees into two subgroups using hierarchical clustering with Ward’s method. The clustering result is shown in <xref ref-type="table" rid="pcbi.1005509.t002">Table 2</xref>, and the configuration of CMDS and a dendrogram are shown in <xref ref-type="fig" rid="pcbi.1005509.g004">Fig 4A-2</xref> and Fig B in <xref ref-type="supplementary-material" rid="pcbi.1005509.s001">S1 Text</xref>, respectively. The tree averages are shown in Fig E in <xref ref-type="supplementary-material" rid="pcbi.1005509.s001">S1 Text</xref>.</p>
<table-wrap id="pcbi.1005509.t002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005509.t002</object-id>
<label>Table 2</label>
<caption>
<title>Clustering result of the NSCLC dataset.</title>
</caption>
<alternatives>
<graphic id="pcbi.1005509.t002g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005509.t002" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left">Cluster</th>
<th align="left">Sample name</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Cluster 1</td>
<td align="left">case 317, case 292, case 283, case 324, case 499<break/>case 472, case 339, case 270</td>
</tr>
<tr>
<td align="left">Cluster 2</td>
<td align="left">case 330, case 4990, case 356</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>The tree averages in Fig E in <xref ref-type="supplementary-material" rid="pcbi.1005509.s001">S1 Text</xref> indicate that the tree shape of cluster 1 and 2 are characterized by trunk accumulation and balanced accumulation-like shape.</p>
<p>Case 330 and case 4990 in cluster 2 are labeled as the recurrent group, but case 356 is not. As shown in <xref ref-type="fig" rid="pcbi.1005509.g004">Fig 4B-2</xref>, there are several long horizontal regions in the sub-clonal diversity curve, which indicates that each sub-clone acquired a large portion of SSNVs. This implies that the sub-clones contained a large fraction of the SSNVs after diverging from the founder cell, <italic>i</italic>.<italic>e</italic>., representing a genetically new generation. Zhang <italic>et al</italic>. [<xref ref-type="bibr" rid="pcbi.1005509.ref023">23</xref>] reported a similar observation, in which they found a significant difference (t-test) in the average fractions of SSNVs between the recurrent group and non-recurrent group. Case 356 is labeled as non-recurrent; however, it shows a large fraction of SSNVs in the sub-clones compared to that of the non-recurrent group, leading to a similar tree shape to that of trees of the recurrent group.</p>
<p>Cluster 1 consists of non-recurrent cases, except for case 270. <xref ref-type="fig" rid="pcbi.1005509.g004">Fig 4B-2</xref> shows small horizontal regions in the sub-clonal diversity curve, which indicates that each sub-clone acquired a smaller portion of SSNVs compared to that observed in the sub-clones of cluster 2; that is, most of the SSNV acquisition events had already occurred as founder mutations. Although case 270 is labeled as recurrent, it shows a lower fraction of SSNVs in the sub-clones compared to that of the recurrent group; as a result, its tree shape resembles that of trees of the non-recurrent group.</p>
<p>The difference between the two clusters indicates that acquisition of a large fraction of SSNVs in sub-clones may influence the survival of cancer patients, and phyC could capture this feature and correctly classify them, which is consistent with the results of Zhang et al. [<xref ref-type="bibr" rid="pcbi.1005509.ref023">23</xref>].</p>
</sec>
<sec id="sec017">
<title>Comparison of the ccRCC and NSCLC datasets</title>
<p>In addition to establishing the evolutionary pattern of a certain cancer type or sub-type, it is also interesting to compare the evolutionary patterns of different types of cancer. Therefore, we compared the evolutionary trees derived from the ccRCC and NSCLC datasets. We applied phyC to the 19 trees reconstructed as described in the previous sub-sections, which were divided into two distinct clusters (<xref ref-type="table" rid="pcbi.1005509.t003">Table 3</xref>, <xref ref-type="fig" rid="pcbi.1005509.g004">Fig 4A-3</xref> and Fig C in <xref ref-type="supplementary-material" rid="pcbi.1005509.s001">S1 Text</xref>, Fig F in <xref ref-type="supplementary-material" rid="pcbi.1005509.s001">S1 Text</xref>).</p>
<table-wrap id="pcbi.1005509.t003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005509.t003</object-id>
<label>Table 3</label>
<caption>
<title>Clustering result of the ccRCC and NSCLC datasets.</title>
</caption>
<alternatives>
<graphic id="pcbi.1005509.t003g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005509.t003" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left">Cluster</th>
<th align="left">Sample name</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Cluster 1</td>
<td align="left">case 317, case 292, case 283, case 324, case 499<break/>case 472, case 339, case 270, EV003, EV006</td>
</tr>
<tr>
<td align="left">Cluster 2</td>
<td align="left">EV005, EV007, RK26, RMH002, RMH004<break/>RMH008, case 330, case 4990, case 356</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>The tree averages in Fig F in <xref ref-type="supplementary-material" rid="pcbi.1005509.s001">S1 Text</xref> indicate that the tree shape of cluster 1 and 2 are characterized by trunk accumulation and branched accumulation-like shape.</p>
<p>The trees could be mainly classified according to cancer type. One of the main features of the ccRCC evolutionary trees in cluster 2 was the acquisition of a large fraction of SSNVs in the sub-clones, leading to the tendency of parallel evolution. In contrast to the ccRCC trees, the NSCLC evolutionary trees showed that a large fraction of SSNVs was acquired in the trunk, and not in the sub-clones, which confirmed that the important event had already occurred in the early stage of SSNVs acquisition [<xref ref-type="bibr" rid="pcbi.1005509.ref023">23</xref>].</p>
<p>Some of the trees were classified with different cancer types, including case 330, case 4990, and case 356 in cluster 2, and EV003 and EV006 in cluster 1. Case 330 and case 4990 in the NSCLC dataset are part of the recurrent group, and the tree shape of case 356 is similar to that of the recurrent group (<xref ref-type="table" rid="pcbi.1005509.t003">Table 3</xref>). A large fraction of SSNVs of case 330, case 4990, and case 356 accumulated in branches, as in the ccRCC samples. EV003 and EV006 in the ccRCC dataset are samples of drug-sensitive tumors, and their tree shapes resemble those of NSCLC trees, which further supports that the drug interrupts the accumulation of SSNVs in the sub-clones.</p>
</sec>
</sec>
</sec>
<sec id="sec018" sec-type="conclusions">
<title>Discussion</title>
<p>We developed phyC, which was designed for clustering a set of cancer evolutionary trees to characterize cancer evolutionary patterns according to tree shape, based on analysis of tree topologies and edge attributes. Using this approach, we effectively identified the evolutionary patterns with different degrees of heterogeneity in a simulation study. We also successfully detected the phenotype-related and cancer type-related subgroups when applying this method to actual ccRCC and NSCLC data.</p>
<p>Considering the generally high level of inter-tumor heterogeneity, it is important to be able to identify phenotype- or cancer type-related evolutionary patterns. Previous studies have classified and interpreted the branching patterns of such sub-clones with manual methods, and then separately analyzed the compositions of SSNVs in each sub-clone. However, development of a quantitative analysis method is required to deal with datasets containing a large number of patients with cancer evolutionary trees to characterize and interpret the evolutionary patterns.</p>
<p>Our approach relies on reconstruction methods of evolutionary trees, and we used a parsimony approach that is widely adopted in studies of multi-regional sequencing. The proposed method only requires knowledge of the edges and edge attributes of rooted trees, and is therefore widely applicable to outputs of other recently developed state-of-the-art reconstruction methods, which allowed us to consider the heterogeneous mixture of cells within a sample.</p>
<p>There are several limitations of the present method that are worth mentioning, which should be tackled in further investigations. First, we have ignored the specific content of SSNVs in the sub-clones. We believe that this is a reasonable assumption to some extent, since the variation of SSNVs is too large to yield an effective comparison. However, the effects and consequences of different types of SSNVs can also vary, such as driver mutations or passenger mutations. Thus, when comparing edges with the same lengths from different trees, the two edges may not actually be equivalent if driver genes are included in one edge but not in the other. The first cut distinction between driver and passenger mutations could also simplify the algorithm and improve its running time. Therefore, a method that can incorporate the effect of driver genes in the sub-clones should be explored in future work.</p>
<p>Second, we have here only considered the SSNVs accumulating in the evolutionary trees, ignoring potential copy number or epigenetic aberrations; however, these factors may also affect heterogeneity within a tumor. Multi-regional sequence analysis has been performed using exome sequencing as well as copy number, methylation, and mRNA expression array profiling, providing an integrated interpretation of cancer evolution [<xref ref-type="bibr" rid="pcbi.1005509.ref043">43</xref>]. To determine the evolutionary patterns from these integrated data, our method can be extended to the case of multivariate edge attributes, including copy number variations and hyper- or hypo-methylation, as well as other genetic and epigenetic aberrations.</p>
<p>Finally, we did not take into account the potential effects of regional sampling biases and individual variations among tumors or patients. Gerlinger <italic>et al</italic>. [<xref ref-type="bibr" rid="pcbi.1005509.ref021">21</xref>] pointed out that increasing the sequenced regions of samples might lead to additional detection of sub-clones, and thus the complexity of inferred evolutionary trees might be affected by the sampling strategy. Therefore, a method for sampling bias reduction is needed to improve the clustering accuracy and plausible interpretation.</p>
<p>Our proposed approach represents the first practical method to quantitatively and accurately compare a variety of evolutionary trees with different structures, sizes, and labels, and with biases of edge length, while further allowing for biological interpretation. Our results imply that this approach has potential applications for personalized medicine such as predicting the outcomes of chemotherapeutics and targeted therapies, <italic>e</italic>.<italic>g</italic>., drug-resistance, based on evolutionary trees. We believe that the value and impact of our work will grow as more and more multi-regional sequencing datasets of patients become available.</p>
</sec>
<sec id="sec019">
<title>Supporting information</title>
<supplementary-material id="pcbi.1005509.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005509.s001" xlink:type="simple">
<label>S1 Text</label>
<caption>
<title>S1 Text contains detailed procedure of generating simulation data, external evaluation criteria for clustering, sampling effects on the clustering results, supporting figures and tables (Fig A–Fig G in S1 Text and Tables A–F in S1 Text).</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005509.s002" mimetype="text/html" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005509.s002" xlink:type="simple">
<label>S1 File</label>
<caption>
<title>S1 File contains an R Markdown file for reproducing all the figures in this manuscript and the related data can be downloaded from <ext-link ext-link-type="uri" xlink:href="https://github.com/ymatts/phyC/tree/master/misc" xlink:type="simple">https://github.com/ymatts/phyC/tree/master/misc</ext-link>.</title>
<p>(HTML)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="pcbi.1005509.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Nowell</surname> <given-names>PC</given-names></name>. <article-title>The clonal evolution of tumor cell populations</article-title>. <source>Science</source>. <year>1976</year>;<volume>194</volume>: <fpage>23</fpage>–<lpage>28</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.959840" xlink:type="simple">10.1126/science.959840</ext-link></comment> <object-id pub-id-type="pmid">959840</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005509.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Campbell</surname> <given-names>PJ</given-names></name>, <name name-style="western"><surname>Pleasance</surname> <given-names>ED</given-names></name>, <name name-style="western"><surname>Stephens</surname> <given-names>PJ</given-names></name>, <name name-style="western"><surname>Dicks</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Rance</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Goodhead</surname> <given-names>I</given-names></name>, <etal>et al</etal>. <article-title>Subclonal phylogenetic structures in cancer revealed by ultra-deep sequencing</article-title>. <source>Proc Natl Acad Sci</source>. <year>2008</year>;<volume>105</volume>: <fpage>13081</fpage>–<lpage>13086</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.0801523105" xlink:type="simple">10.1073/pnas.0801523105</ext-link></comment> <object-id pub-id-type="pmid">18723673</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005509.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Carter</surname> <given-names>SL</given-names></name>, <name name-style="western"><surname>Cibulskis</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Helman</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>McKenna</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Shen</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Zack</surname> <given-names>T</given-names></name>, <etal>et al</etal>. <article-title>Absolute quantification of somatic DNA alterations in human cancer</article-title>. <source>Nat. Biotechnol</source>. <year>2012</year>;<volume>30</volume>: <fpage>413</fpage>–<lpage>421</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nbt.2203" xlink:type="simple">10.1038/nbt.2203</ext-link></comment> <object-id pub-id-type="pmid">22544022</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005509.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Newburger</surname> <given-names>DE</given-names></name>, <name name-style="western"><surname>Kashef-Haghighi</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Weng</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Salari</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Sweeney</surname> <given-names>RT</given-names></name>, <name name-style="western"><surname>Brunner</surname> <given-names>AL</given-names></name>, <etal>et al</etal>. <article-title>Genome evolution during progression to breast cancer</article-title>. <source>Genome Res</source>. <year>2013</year>;<volume>23</volume>: <fpage>1097</fpage>–<lpage>108</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/gr.151670.112" xlink:type="simple">10.1101/gr.151670.112</ext-link></comment> <object-id pub-id-type="pmid">23568837</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005509.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Schuh</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Becq</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Humphray</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Alexa</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Burns</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Clifford</surname> <given-names>R</given-names></name>, <etal>et al</etal>. <article-title>Monitoring chronic lymphocytic leukemia progression by whole genome sequencing reveals heterogeneous clonal evolution patterns</article-title>. <source>Blood</source>. <year>2012</year>;<volume>120</volume>: <fpage>4191</fpage>–<lpage>4196</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1182/blood-2012-05-433540" xlink:type="simple">10.1182/blood-2012-05-433540</ext-link></comment> <object-id pub-id-type="pmid">22915640</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005509.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yachida</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Jones</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Bozic</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Antal</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Leary</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Fu</surname> <given-names>B</given-names></name>, <etal>et al</etal>. <article-title>Distant metastasis occurs late during the genetic evolution of pancreatic cancer</article-title>. <source>Nature</source>. <year>2010</year>;<volume>467</volume>: <fpage>1114</fpage>–<lpage>1117</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature09515" xlink:type="simple">10.1038/nature09515</ext-link></comment> <object-id pub-id-type="pmid">20981102</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005509.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>El-Kebir</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Oesper</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Acheson-Field</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Raphael</surname> <given-names>BJ</given-names></name>. <article-title>Reconstruction of clonal trees and tumor composition from multi-sample sequencing data</article-title>. <source>Bioinformatics</source>. <year>2015</year>;<volume>31</volume>: <fpage>i62</fpage>–<lpage>70</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btv261" xlink:type="simple">10.1093/bioinformatics/btv261</ext-link></comment> <object-id pub-id-type="pmid">26072510</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005509.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hajirasouliha</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Mahmoody</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Raphael</surname> <given-names>BJ</given-names></name>. <article-title>A combinatorial approach for analyzing intra-tumor heterogeneity from high-throughput sequencing data</article-title>. <source>Bioinformatics</source>. <year>2014</year>;<volume>30</volume>: <fpage>i78</fpage>–<lpage>i86</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btu284" xlink:type="simple">10.1093/bioinformatics/btu284</ext-link></comment> <object-id pub-id-type="pmid">24932008</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005509.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Jiao</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Vembu</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Deshwar</surname> <given-names>AG</given-names></name>, <name name-style="western"><surname>Stein</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Morris</surname> <given-names>Q</given-names></name>. <article-title>Inferring clonal evolution of tumors from single nucleotide somatic mutations</article-title>. <source>BMC Bioinformatics</source>. <year>2013</year>;<volume>15</volume>: <fpage>35</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2105-15-35" xlink:type="simple">10.1186/1471-2105-15-35</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005509.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Miller</surname> <given-names>CA</given-names></name>, <name name-style="western"><surname>White</surname> <given-names>BS</given-names></name>, <name name-style="western"><surname>Dees</surname> <given-names>ND</given-names></name>, <name name-style="western"><surname>Griffith</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Welch</surname> <given-names>JS</given-names></name>, <name name-style="western"><surname>Griffith</surname> <given-names>OL</given-names></name>, <etal>et al</etal>. <article-title>SciClone: inferring clonal architecture and tracking the spatial and temporal patterns of tumor evolution</article-title>. <source>PLoS Comput. Biol</source>. <year>2014</year>;<volume>10</volume>: <fpage>e1003665</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1003665" xlink:type="simple">10.1371/journal.pcbi.1003665</ext-link></comment> <object-id pub-id-type="pmid">25102416</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005509.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Popic</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Salari</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Hajirasouliha</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Kashef-Haghighi</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>West</surname> <given-names>RB</given-names></name>, <name name-style="western"><surname>Batzoglou</surname> <given-names>S</given-names></name>. <article-title>Fast and scalable inference of multi-sample cancer lineages</article-title>. <source>Genome Biol</source>. <year>2015</year>;<volume>16</volume>: <fpage>91</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/s13059-015-0647-8" xlink:type="simple">10.1186/s13059-015-0647-8</ext-link></comment> <object-id pub-id-type="pmid">25944252</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005509.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Qiao</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Quinlan</surname> <given-names>AR</given-names></name>, <name name-style="western"><surname>Jazaeri</surname> <given-names>AA</given-names></name>, <name name-style="western"><surname>Verhaak</surname> <given-names>RG</given-names></name>, <name name-style="western"><surname>Wheeler</surname> <given-names>DA</given-names></name>, <name name-style="western"><surname>Marth</surname> <given-names>GT</given-names></name>. <article-title>SubcloneSeeker: a computational framework for reconstructing tumor clone structure for cancer variant interpretation and prioritization</article-title>. <source>Genome Biol</source>. <year>2014</year>;<volume>15</volume>: <fpage>443</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/s13059-014-0443-x" xlink:type="simple">10.1186/s13059-014-0443-x</ext-link></comment> <object-id pub-id-type="pmid">25160522</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005509.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Roth</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Khattra</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Yap</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Wan</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Laks</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Biele</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>PyClone: statistical inference of clonal population structure in cancer</article-title>. <source>Nat Methods</source>. <year>2014</year>;<volume>11</volume>: <fpage>396</fpage>–<lpage>398</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.2883" xlink:type="simple">10.1038/nmeth.2883</ext-link></comment> <object-id pub-id-type="pmid">24633410</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005509.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Malikic</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>McPherson</surname> <given-names>AW</given-names></name>, <name name-style="western"><surname>Donmez</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Sahinalp</surname> <given-names>CS</given-names></name>. <article-title>Clonality inference in multiple tumor samples using phylogeny</article-title>. <source>Bioinformatics</source>. <year>2015</year>;<volume>31</volume>: <fpage>1349</fpage>–<lpage>1356</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btv003" xlink:type="simple">10.1093/bioinformatics/btv003</ext-link></comment> <object-id pub-id-type="pmid">25568283</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005509.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Strino</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Parisi</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Micsinai</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Kluger</surname> <given-names>Y</given-names></name>. <article-title>TrAp: a tree approach for fingerprinting subclonal tumor composition</article-title>. <source>Nucleic Acids Res</source>. <year>2013</year>;<volume>41</volume>: <fpage>e165</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkt641" xlink:type="simple">10.1093/nar/gkt641</ext-link></comment> <object-id pub-id-type="pmid">23892400</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005509.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zare</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Hu</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Weber</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Smith</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Nickerson</surname> <given-names>D</given-names></name>, <etal>et al</etal>. <article-title>Inferring clonal composition from multiple sections of a breast cancer</article-title>. <source>PLoS Comput Biol</source>. <year>2014</year>;<volume>10</volume>: <fpage>e1003703</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1003703" xlink:type="simple">10.1371/journal.pcbi.1003703</ext-link></comment> <object-id pub-id-type="pmid">25010360</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005509.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Nik-Zainal</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Alexandrov</surname> <given-names>LB</given-names></name>, <name name-style="western"><surname>Wedge</surname> <given-names>DC</given-names></name>, <name name-style="western"><surname>Van Loo</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Greenman</surname> <given-names>CD</given-names></name>, <name name-style="western"><surname>Raine</surname> <given-names>K</given-names></name>, <etal>et al</etal>. <article-title>Mutational processes molding the genomes of 21 breast cancers</article-title>. <source>Cell</source>. <year>2012</year>;<volume>149</volume>: <fpage>979</fpage>–<lpage>993</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.cell.2012.04.024" xlink:type="simple">10.1016/j.cell.2012.04.024</ext-link></comment> <object-id pub-id-type="pmid">22608084</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005509.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Beerenwinkel</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Schwarz</surname> <given-names>RF</given-names></name>, <name name-style="western"><surname>Gerstung</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Markowetz</surname> <given-names>F</given-names></name>. <article-title>Cancer evolution: mathematical models and computational inference</article-title>. <source>Syst Biol</source>. <year>2015</year>;<volume>64</volume>: <fpage>e1</fpage>–<lpage>25</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/sysbio/syu081" xlink:type="simple">10.1093/sysbio/syu081</ext-link></comment> <object-id pub-id-type="pmid">25293804</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005509.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Swanton</surname> <given-names>C</given-names></name>. <article-title>Cancer evolution: the final frontier of precision medicine?</article-title> <source>Ann Oncol</source>. <year>2014</year>;<volume>25</volume>: <fpage>549</fpage>–<lpage>551</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/annonc/mdu005" xlink:type="simple">10.1093/annonc/mdu005</ext-link></comment> <object-id pub-id-type="pmid">24567514</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005509.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Venkatesan</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Swanton</surname> <given-names>C</given-names></name>. <article-title>Tumor evolutionary principles: how intratumor heterogeneity influences cancer treatment and outcome</article-title>. <source>Am Soc Clin Oncol Educ Book</source>. <year>2016</year>;<volume>35</volume>: <fpage>e141</fpage>–<lpage>e149</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.14694/EDBK_158930" xlink:type="simple">10.14694/EDBK_158930</ext-link></comment> <object-id pub-id-type="pmid">27249716</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005509.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gerlinger</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Horswell</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Larkin</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Rowan</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Salm</surname> <given-names>MP</given-names></name>, <name name-style="western"><surname>Varela</surname> <given-names>I</given-names></name>, <etal>et al</etal>. <article-title>Genomic architecture and evolution of clear cell renal cell carcinomas defined by multiregion sequencing</article-title>. <source>Nat Genet</source>. <year>2014</year>;<volume>46</volume>: <fpage>225</fpage>–<lpage>233</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/ng.2891" xlink:type="simple">10.1038/ng.2891</ext-link></comment> <object-id pub-id-type="pmid">24487277</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005509.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>de Bruin</surname> <given-names>EC</given-names></name>, <name name-style="western"><surname>McGranahan</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Mitter</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Salm</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Wedge</surname> <given-names>DC</given-names></name>, <name name-style="western"><surname>Yates</surname> <given-names>L</given-names></name>, <etal>et al</etal>. <article-title>Spatial and temporal diversity in genomic instability processes defines lung cancer evolution</article-title>. <source>Science</source>. <year>2014</year>;<volume>346</volume>: <fpage>251</fpage>–<lpage>256</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1253462" xlink:type="simple">10.1126/science.1253462</ext-link></comment> <object-id pub-id-type="pmid">25301630</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005509.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zhang</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Fujimoto</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Wedge</surname> <given-names>DC</given-names></name>, <name name-style="western"><surname>Song</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Intra-tumor heterogeneity in localized lung adenocarcinomas delineated by multi-region sequencing</article-title>. <source>Science</source>. <year>2014</year>;<volume>346</volume>: <fpage>256</fpage>–<lpage>259</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1256930" xlink:type="simple">10.1126/science.1256930</ext-link></comment> <object-id pub-id-type="pmid">25301631</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005509.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Marron</surname> <given-names>JS</given-names></name>, <name name-style="western"><surname>Alonso</surname> <given-names>AM</given-names></name>. <article-title>Overview of object oriented data analysis</article-title>. <source>Biom J</source>. <year>2014</year>;<volume>56</volume>: <fpage>732</fpage>–<lpage>753</lpage>. <object-id pub-id-type="pmid">24421177</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005509.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Waterman</surname> <given-names>MS</given-names></name>, <name name-style="western"><surname>Steel</surname> <given-names>M</given-names></name>. <article-title>On the similarity of dendrograms</article-title>. <source>Theor Biol</source>. <year>1978</year>;<volume>73</volume>: <fpage>789</fpage>–<lpage>800</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/0022-5193(78)90137-6" xlink:type="simple">10.1016/0022-5193(78)90137-6</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005509.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Allen</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Steel</surname> <given-names>M</given-names></name>. <article-title>Subtree transfer operations and their induced metrics on evolutionary trees</article-title>. <source>Ann. Comb</source>. <year>2001</year>;<volume>5</volume>: <fpage>1</fpage>–<lpage>15</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s00026-001-8006-8" xlink:type="simple">10.1007/s00026-001-8006-8</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005509.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Estabrook</surname> <given-names>GF</given-names></name>, <name name-style="western"><surname>McMorris FR and Meacham</surname> <given-names>CA</given-names></name>. <article-title>Comparison of undirected phylogenetic trees based on subtrees of four evolutionary units</article-title>. <source>Syst Zool</source>. <year>1985</year>;<volume>34</volume>: <fpage>193</fpage>–<lpage>200</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.2307/2413326" xlink:type="simple">10.2307/2413326</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005509.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Robinson DF and Foulds</surname> <given-names>LR</given-names></name>. <article-title>Comparison of phylogenetic trees</article-title>. <source>Math. Biosci</source>. <year>1981</year>;<volume>53</volume>: <fpage>131</fpage>–<lpage>147</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/0025-5564(81)90043-2" xlink:type="simple">10.1016/0025-5564(81)90043-2</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005509.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Steel</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Penny</surname> <given-names>D</given-names></name>. <article-title>Distribution of tree comparison metrics—some new results</article-title>. <source>Systematic Biol</source>. <year>1993</year>;<volume>42</volume>: <fpage>126</fpage>–<lpage>141</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/sysbio/42.2.126" xlink:type="simple">10.1093/sysbio/42.2.126</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005509.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kuhner</surname> <given-names>MK</given-names></name>, <name name-style="western"><surname>Felsenstein</surname> <given-names>J</given-names></name>. <article-title>A simulation comparison of phylogeny algorithms under equal and unequal evolutionary rates</article-title>. <source>Mol Biol Evol</source>. <year>1994</year>;<volume>11</volume>:<fpage>459</fpage>–<lpage>68</lpage>. <object-id pub-id-type="pmid">8015439</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005509.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zhang</surname> <given-names>K.</given-names></name> and <name name-style="western"><surname>Shasha</surname> <given-names>D.</given-names></name>. <article-title>Simple fast algorithms for the editing distance between trees and related problems</article-title>. <source>SIAM J. Comput</source>. <year>1989</year>;<volume>18</volume>:<fpage>1245</fpage>–<lpage>1262</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1137/0218082" xlink:type="simple">10.1137/0218082</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005509.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Demaine</surname> <given-names>ED</given-names></name>, <name name-style="western"><surname>Mozes</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Rossman</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Weimann</surname> <given-names>O</given-names></name>. <article-title>An optimal decomposition algorithm for tree edit distance</article-title>. <source>ACM Trans. on Alg</source>. <year>2009</year>;<volume>6</volume>.</mixed-citation>
</ref>
<ref id="pcbi.1005509.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pawlik</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Augsten</surname> <given-names>N</given-names></name>. <article-title>RTED: a robust algorithm for the tree edit distance</article-title>. <source>PVLDB</source>. <year>2011</year>;<volume>5</volume>:<fpage>334</fpage>–<lpage>345</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005509.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Billera</surname> <given-names>LJ</given-names></name>, <name name-style="western"><surname>Holmes</surname> <given-names>SP</given-names></name>, <name name-style="western"><surname>Vogtmann</surname> <given-names>K</given-names></name>. <article-title>Geometry of the space of phylogenetic trees</article-title>. <source>Adv. Appl. Math</source>. <year>2001</year>;<volume>27</volume>: <fpage>733</fpage>–<lpage>767</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1006/aama.2001.0759" xlink:type="simple">10.1006/aama.2001.0759</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005509.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>El-Kebir</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Raphael</surname> <given-names>BJ</given-names></name>, <name name-style="western"><surname>Shamir</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Sharan</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Zaccaria</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Zehavi</surname> <given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Copy-Number Evolution Problems: Complexity and Algorithms, Lecture Notes</article-title> in <source>Comput. Sci</source>. <year>2016</year>;<volume>9838</volume>:<fpage>137</fpage>–<lpage>149</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005509.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Feragen</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Lo</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>de Bruijne</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Nielsen</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Lauze</surname> <given-names>F</given-names></name>. <article-title>Toward a Theory of Statistical Tree-Shape Analysis</article-title>. <source>IEEE Trans Pattern Anal Mach Intell</source>. <year>2013</year>;<volume>35</volume>: <fpage>2008</fpage>–<lpage>2021</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/TPAMI.2012.265" xlink:type="simple">10.1109/TPAMI.2012.265</ext-link></comment> <object-id pub-id-type="pmid">23267202</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005509.ref037">
<label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tibshirani</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Walther</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Hastie</surname> <given-names>T</given-names></name>. <article-title>Estimating the Number of Clusters in a Data Set Via the Gap Statistic</article-title>. <source>J Roy Statist Soc B</source>. <year>2001</year>;<volume>63</volume>: <fpage>411</fpage>–<lpage>423</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/1467-9868.00293" xlink:type="simple">10.1111/1467-9868.00293</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005509.ref038">
<label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Charrad</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Ghazzali</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Boiteau</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Niknafs</surname> <given-names>A</given-names></name>. <article-title>Nbclust: An R Package for Determining the Relevant Number of Clusters in a Data Set</article-title>. <source>J Stat Softw</source>. <year>2014</year>;<volume>61</volume>: <fpage>1</fpage>–<lpage>36</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.18637/jss.v061.i06" xlink:type="simple">10.18637/jss.v061.i06</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005509.ref039">
<label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Torgerson</surname> <given-names>WS</given-names></name>. <article-title>Multidimensional scaling: I. theory and method</article-title>. <source>Psychometrika</source>. <year>1952</year>;<volume>17</volume>: <fpage>401</fpage>–<lpage>419</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/BF02288916" xlink:type="simple">10.1007/BF02288916</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005509.ref040">
<label>40</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Manning</surname> <given-names>CD</given-names></name>, <name name-style="western"><surname>Raghavan</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Schütze</surname> <given-names>H</given-names></name>. <source>Introduction to Information Retrieval</source>. <publisher-name>Cambridge Univ Press</publisher-name>, <year>2008</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005509.ref041">
<label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yuan</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Sakoparnig</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Markowetz</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Beerenwinkel</surname> <given-names>N</given-names></name>. <article-title>BitPhylogeny: a probabilistic framework for reconstructing intra-tumor phylogenies</article-title>. <source>Genome Biol</source>. <year>2015</year>;<volume>13</volume>:<fpage>16</fpage>–<lpage>36</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005509.ref042">
<label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Klaus</surname> <given-names>PS</given-names></name>. <article-title>phangorn: phylogenetic analysis in R</article-title>. <source>Bioinformatics</source>. <year>2011</year>;<volume>27</volume>: <fpage>592</fpage>–<lpage>593</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btq706" xlink:type="simple">10.1093/bioinformatics/btq706</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005509.ref043">
<label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Uchi</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Takahashi</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Niida</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Shimamura</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Hirata</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Sugimachi</surname> <given-names>K</given-names></name> <etal>et al</etal>. <article-title>Integrated multiregional analysis proposing a new model of colorectal cancer evolution</article-title>. <source>PLoS Genet</source>. <year>2016</year>;<volume>12</volume>: <fpage>e1005778</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pgen.1005778" xlink:type="simple">10.1371/journal.pgen.1005778</ext-link></comment> <object-id pub-id-type="pmid">26890883</object-id></mixed-citation>
</ref>
</ref-list>
</back>
</article>