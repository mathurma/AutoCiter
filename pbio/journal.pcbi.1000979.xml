<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN">
<front>
<journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher></journal-meta>
<article-meta><article-id pub-id-type="publisher-id">10-PLCB-RA-1700R3</article-id><article-id pub-id-type="doi">10.1371/journal.pcbi.1000979</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline"><subject>Biophysics/Theory and Simulation</subject><subject>Computational Biology</subject><subject>Computational Biology/Transcriptional Regulation</subject></subj-group></article-categories><title-group><article-title>Evaluating Gene Expression Dynamics Using Pairwise RNA FISH Data</article-title><alt-title alt-title-type="running-head">Evaluating Dynamics Using FISH Data</alt-title></title-group><contrib-group>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Wyart</surname><given-names>Matthieu</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Botstein</surname><given-names>David</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff3"><sup>3</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Wingreen</surname><given-names>Ned S.</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff3"><sup>3</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
</contrib-group><aff id="aff1"><label>1</label><addr-line>Lewis-Sigler Institute for Integrative Genomics, Princeton University, Princeton, New Jersey, United States of America</addr-line>       </aff><aff id="aff2"><label>2</label><addr-line>Center for Soft Matter Research, New York University, New York, New York, United States of America</addr-line>       </aff><aff id="aff3"><label>3</label><addr-line>Department of Molecular Biology, Princeton University, Princeton, New Jersey, United States of America</addr-line>       </aff><contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Ohler</surname><given-names>Uwe</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group><aff id="edit1">Duke University, United States of America</aff><author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">wingreen@Princeton.edu</email></corresp>
<fn fn-type="con"><p>Contributed reagents/materials/analysis tools: MW DB NSW. Wrote the paper: MW DB NSW.</p></fn>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn></author-notes><pub-date pub-type="collection"><month>11</month><year>2010</year></pub-date><pub-date pub-type="epub"><day>4</day><month>11</month><year>2010</year></pub-date><volume>6</volume><issue>11</issue><elocation-id>e1000979</elocation-id><history>
<date date-type="received"><day>26</day><month>1</month><year>2010</year></date>
<date date-type="accepted"><day>27</day><month>9</month><year>2010</year></date>
</history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2010</copyright-year><copyright-holder>Wyart et al</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract>
<p>Recently, a novel approach has been developed to study gene expression in single cells with high time resolution using RNA Fluorescent In Situ Hybridization (FISH). The technique allows individual mRNAs to be counted with high accuracy in wild-type cells, but requires cells to be fixed; thus, each cell provides only a “snapshot” of gene expression. Here we show how and when RNA FISH data on pairs of genes can be used to reconstruct real-time dynamics from a collection of such snapshots. Using maximum-likelihood parameter estimation on synthetically generated, noisy FISH data, we show that dynamical programs of gene expression, such as cycles (<italic>e.g.</italic>, the cell cycle) or switches between discrete states, can be accurately reconstructed. In the limit that mRNAs are produced in short-lived bursts, binary thresholding of the FISH data provides a robust way of reconstructing dynamics. In this regime, prior knowledge of the type of dynamics – cycle <italic>versus</italic> switch – is generally required and additional constraints, <italic>e.g.</italic>, from triplet FISH measurements, may also be needed to fully constrain all parameters. As a demonstration, we apply the thresholding method to RNA FISH data obtained from single, unsynchronized cells of <italic>Saccharomyces cerevisiae</italic>. Our results support the existence of metabolic cycles and provide an estimate of global gene-expression noise. The approach to FISH data presented here can be applied in general to reconstruct dynamics from snapshots of pairs of correlated quantities including, for example, protein concentrations obtained from immunofluorescence assays.</p>
</abstract><abstract abstract-type="summary"><title>Author Summary</title>
<p>Programs of gene expression lie at the heart of how cells regulate their internal processes. Some dynamical gene-expression programs, such as the cell cycle, are well known and studied, others, such as metabolic cycles, have only recently been recognized, and many other dynamical programs including switches are likely to be discovered. Traditional bulk studies typically fail to resolve such cycles or switches, because individual cells are out-of-phase with each other. On the other hand, standard techniques for studying single cells are limited in time resolution and scope. RNA Fluorescent In Situ Hybridization (FISH) is a single-cell technique that offers both high time-resolution and precise quantification of mRNA molecules, but requires fixed cells. We have explored how, when, and with what prior information FISH snapshots of pairs of genes can be used to accurately reconstruct gene-expression dynamics. The technique can be readily implemented, and is broadly applicable from bacteria to mammals. We lay out a principled and practical approach to extracting biological information from RNA FISH data to reveal new information about the dynamics of living organisms.</p>
</abstract><funding-group><funding-statement>MW, DB, and NSW were supported in part by the NIGMS Center grant GM071508; MW and NSW were supported in part by National Science Foundation grant PHY-065017, and in part by NIH grant R01 GM082938. DB was supported by NIH grant GM046406. The funders had no role in study design, data collection and analysis,decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="14"/></counts></article-meta>
</front>
<body><sec id="s1">
<title>Introduction</title>
<p>Cells are well known to respond to external conditions by altering their gene expression. In recent years, many examples of altered gene expression programs have been revealed by population level studies, including microarray studies of yeast, mammalian, and bacterial cells. But many cells are also known to alter gene expression is ways that are heterogeneous across a cell population. Examples include the acquisition of competence for DNA uptake <xref ref-type="bibr" rid="pcbi.1000979-Suel1">[1]</xref>, <xref ref-type="bibr" rid="pcbi.1000979-Maamar1">[2]</xref> and spore formation <xref ref-type="bibr" rid="pcbi.1000979-Vlamakis1">[3]</xref> in <italic>Bacillus subtilis</italic>, induction of the <italic>lac</italic> operon in <italic>Escherichia coli</italic> depending on “memory” of previous exposure to lactose and the presence of lactose permease <xref ref-type="bibr" rid="pcbi.1000979-Novick1">[4]</xref>, <xref ref-type="bibr" rid="pcbi.1000979-Ozbudak1">[5]</xref>, and the response of <italic>Saccharomyces cerevisiae</italic> (budding yeast) temperature-sensitive mutants to a shift to non-permissive temperature depending on the position of cells in their division cycle <xref ref-type="bibr" rid="pcbi.1000979-Hartwell1">[6]</xref>, <xref ref-type="bibr" rid="pcbi.1000979-Hartwell2">[7]</xref>. Heterogeneous changes in gene expression in response to homogeneous external cues may be purely stochastic as in the switch to competence in <italic>B. subtilis</italic> <xref ref-type="bibr" rid="pcbi.1000979-Suel1">[1]</xref>, <xref ref-type="bibr" rid="pcbi.1000979-Maamar1">[2]</xref>, <xref ref-type="bibr" rid="pcbi.1000979-Dubnau1">[8]</xref>, or may depend on pre-existing non-genetic differences such as the phase of the cell cycle in budding yeast <xref ref-type="bibr" rid="pcbi.1000979-Hartwell1">[6]</xref>, <xref ref-type="bibr" rid="pcbi.1000979-Hartwell2">[7]</xref>.</p>
<p>Since population level studies are not well suited to reveal heterogenous behavior, how can heterogeneous changes in gene expression be studied and quantified? Fluorescent reporter proteins have been used successfully to report on expression of a small number of genes either via FACS analysis or fluorescence microscopy. However, the use of fluorescent reporters is generally limited to highly expressed genes, with time resolution severely limited by fluorescent protein maturation and the low turnover rates of the fluorescent marker. Moreover, construction of fluorescent reporters can be laborious and impractical for studies of large-scale transcriptional responses.</p>
<p>A promising approach that has recently been used to study gene expression on a cell-by-cell basis is Fluorescence In Situ Hybridization (FISH) <xref ref-type="bibr" rid="pcbi.1000979-Femino1">[9]</xref>–<xref ref-type="bibr" rid="pcbi.1000979-Zenklusen1">[11]</xref>. In FISH, fixed cells are exposed to fluorescently labeled probes of specific mRNA transcripts, so that the number of these mRNAs can be counted in each cell by the number of bright spots. Advantages of FISH include: (1) absolute quantification since the actual number of mRNAs can be counted, (2) time resolution since there is no delay for reporter maturation, (3) ability to directly study wild-type cells, and (4) the ability to probe simultaneously for multiple mRNAs, <italic>e.g.</italic> by employing probes with different fluorescent spectra <xref ref-type="bibr" rid="pcbi.1000979-Raj1">[10]</xref>, <xref ref-type="bibr" rid="pcbi.1000979-Levsky1">[12]</xref>. A significant disadvantage of FISH is the requirement to fix cells. This disadvantage presents a particular challenge when it is the dynamics of gene expression that is of central interest. For example, each individual drawn from an asynchronous yeast population represents a particular moment in the cell division cycle. In essence, the problem we wish to address is how to reconstruct the dynamics of gene expression from what amount to “snapshots”, where each individual cell represents a different point in time.</p>
<p>Here, we present an approach to extracting information about the dynamics of gene expression from FISH data by considering correlations of expression between pairs of genes (<italic>cf.</italic> <xref ref-type="fig" rid="pcbi-1000979-g001">Fig. 1</xref>). The approach applies even if the dynamics of interest occurs heterogeneously in a population. One class of dynamics we consider are cyclic oscillations of gene expression. Common examples are the cell cycle, circadian oscillations, and metabolic oscillations <xref ref-type="bibr" rid="pcbi.1000979-Tu1">[13]</xref>. Cyclic oscillations of gene expression, such as the cell cycle, have been studied at the population level by synchronizing cells, but for many organisms synchronization is difficult without strongly perturbing the cells. A non-perturbative approach to studying oscillatory gene expression is likely to be of value in these cases. To study metabolic oscillations, cells of the yeast <italic>Saccharomyces cerevisiae</italic> have been synchronized in chemostats <xref ref-type="bibr" rid="pcbi.1000979-Tu1">[13]</xref>, but those cells demonstrably continue to influence each other via levels of dissolved oxygen and other chemical species. To ascertain if <italic>Saccharomyces</italic> undergoes metabolic oscillations outside the chemostat, Silverman <italic>et al.</italic> <xref ref-type="bibr" rid="pcbi.1000979-Silverman1">[14]</xref> recently obtained an extensive FISH data set, and argued for the existence of metabolic oscillations based on correlations in gene expression. Using the same data set, we apply our approach to reconstructing oscillatory dynamics, and confirm the existence of metabolic cycles in unsynchronized yeast populations <xref ref-type="bibr" rid="pcbi.1000979-Silverman1">[14]</xref>. Our approach can also be applied to transient oscillations in response to external stimulation, such as in the bacterial SOS response to DNA damage <xref ref-type="bibr" rid="pcbi.1000979-Friedman1">[15]</xref> or in the analogous eukaryotic p53-Mdm2 system <xref ref-type="bibr" rid="pcbi.1000979-GevaZatorsky1">[16]</xref>. Another class of dynamics we consider are stochastic switches among different states of gene expression. Examples include persister cells in <italic>Escherichia coli</italic> <xref ref-type="bibr" rid="pcbi.1000979-Balaban1">[17]</xref>, competence <xref ref-type="bibr" rid="pcbi.1000979-Suel1">[1]</xref>, <xref ref-type="bibr" rid="pcbi.1000979-Maamar1">[2]</xref>, <xref ref-type="bibr" rid="pcbi.1000979-Dubnau1">[8]</xref> and swimming/chaining in <italic>Bacillus subtilis</italic> <xref ref-type="bibr" rid="pcbi.1000979-Dubnau1">[8]</xref>, the stringent response in mycobacteria <xref ref-type="bibr" rid="pcbi.1000979-Sureka1">[18]</xref>, and galactose utilization in <italic>Saccharomyces cerevisiae</italic> <xref ref-type="bibr" rid="pcbi.1000979-Acar1">[19]</xref>.</p>
<fig id="pcbi-1000979-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000979.g001</object-id><label>Figure 1</label><caption>
<title>Illustration of periodic mRNA transcription and pairwise FISH measurements in the continuous regime (upper panel) and the bursty regime (lower panel).</title>
<p>The dashed curves indicate mean transcript numbers. The actual number of mRNA transcripts will fluctuate from cell to cell and from cycle to cycle. (A) Sketch of the number of mRNA transcripts versus time for two genes in the continuous regime, where fluctuations about the mean are small. (B) Sketch of FISH observations corresponding to (A): a large number of mRNA transcripts from both genes will typically be found in each cell. Inset: schematic of corresponding distribution of pairwise FISH data. (C) Sketch of the bursty regime where typically only the most recent transcriptional burst contributes to the total mRNA number, implying large fluctuations about the mean. (D) Sketch of FISH observations corresponding to (C): many cells display either no mRNA or bursts of a single mRNA type, and coincident bursts of both mRNA types are rare. Inset: schematic of corresponding distribution of pairwise FISH data.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000979.g001" xlink:type="simple"/></fig>
<p>Specifically, we show how Maximum Likelihood Estimation (MLE) <xref ref-type="bibr" rid="pcbi.1000979-Edwards1">[20]</xref> can be applied to FISH data obtained for multiple pairs of genes to reconstruct the underlying dynamics of gene expression. MLE consists of finding the set of parameters within a particular family of models for which the observed data is most “likely”. MLE has been applied successfully to biological data analysis in many contexts, from reconstruction of evolutionary trees <xref ref-type="bibr" rid="pcbi.1000979-Felsenstein1">[21]</xref>, <xref ref-type="bibr" rid="pcbi.1000979-Whelan1">[22]</xref> to estimation of genetic parameters <xref ref-type="bibr" rid="pcbi.1000979-Thompson1">[23]</xref> to understanding the evolution of gene structure <xref ref-type="bibr" rid="pcbi.1000979-Carmel1">[24]</xref>. We show using synthetic FISH data that MLE can accurately reconstruct dynamics, even in the presence of substantial noise, provided the number of genes and the number of FISH observations per gene pair are sufficient. Reconstructing gene-expression dynamics is most challenging in the “bursty” regime where mRNAs are often present at very low levels or not at all in the cell, except when transcriptional bursts occur. For this regime, we present a robust approach based on thresholding the FISH data into binary form, followed by MLE analysis. In this case, we show that Principal Component Analysis (PCA) of the covariance matrix performs nearly as well as MLE. We suggest that the two-step approach of thresholding followed by MLE or PCA is likely to prove the best practical approach to reconstructing gene-expression dynamics for most real FISH data sets, and we demonstrate this approach using the data set of Silverman <italic>et al.</italic> <xref ref-type="bibr" rid="pcbi.1000979-Silverman1">[14]</xref>.</p>
<p>Importantly, the method we present here for inferring intracellular dynamics from data in the form of “snapshots” is quite general, relying only on measurements of pairs of quantities in single cells, with no requirement for exact counts. The method can therefore be applied with little modification in other contexts such as quantitative immunofluorescence or single-cell sequencing studies.</p>
</sec><sec id="s2">
<title>Results</title>
<p>We presume that production of mRNA transcripts is a stochastic process. Transcription factors bind to DNA at random times, with a probability that depends on other signals, and which can therefore also vary with time. Binding of one or more transcriptional activators, or unbinding of repressors, typically leads to production of a “burst” of mRNA transcripts. One can distinguish three regimes, two of which are illustrated in <xref ref-type="fig" rid="pcbi-1000979-g001">Fig. 1</xref>. In the first regime, many bursts typically contribute to the total concentration of a particular mRNA species at any moment. The distribution of mRNA is therefore approximately Gaussian with a mean and variance that can vary with time, <italic>e.g.</italic> over the cell cycle. We refer to this case as the continuous regime. The second regime is the opposite limit where mRNA production is highly intermittent <xref ref-type="bibr" rid="pcbi.1000979-Raj1">[10]</xref> – typically there are very few mRNAs of a particular species, and when there are more than a few, they all stem from the same burst. We refer to this case as the bursty regime. The third regime is the intermediate case, where a few bursts typically contribute to the number of mRNA present at any moment. In what follows we focus on the two first regimes. Optimal treatment of the intermediate regime requires a more detailed and/or empirical noise model, but the thresholding method we develop for the bursty regime can also be usefully applied in the intermediate case, as demonstrated by our analysis of FISH data for metabolic cycles in yeast <xref ref-type="bibr" rid="pcbi.1000979-Silverman1">[14]</xref>.</p>
<p>For each regime of mRNA expression, our approach consists of defining a class of possible dynamics, and choosing the one for which the observed data is most likely. Specifically, for a given set of model parameters, we calculate the probability of the observed data, and then ask for the particular set of parameters that maximizes this probability. Since the probabilities don't sum to one over all models (<italic>i.e.</italic> sets of parameters), they are called “likelihoods” and hence this approach to parameter inference is called Maximum Likelihood Estimation (MLE). Below, we demonstrate the practicality of the MLE approach using synthetically generated FISH data in both the continuous and bursty mRNA regimes.</p>
<p>In practice the parameter optimization in MLE can be a challenge, and algorithms used to search parameter space for the maximum likelihood can get stuck in local maxima. However, the general formulation of the maximum likelihood approach is conceptually distinct from the detailed choice of algorithms used to optimize parameters, and so we have chosen to present only fully optimized results in the main text. In <xref ref-type="sec" rid="s3">Methods</xref>, we present a practical method for searching parameter space that typically quickly finds the model parameters that maximize the likelihood of the data.</p>
<p>It is important to recognize one absolute limitation of using FISH data to reconstruct the dynamics of gene expression. Because cells must be fixed before mRNAs are measured, only “snapshots” of individual dynamical trajectories are available. As a consequence, it is impossible from FISH data alone to determine the overall time scale of the dynamics of gene expression. Thus, while it is possible to infer from correlated FISH data that cells undergo cycles of gene expression, and even practical, as we will show, to accurately reconstruct such cycles, it is not possible, even in principle, to determine the period of these oscillations. Similarly, it is not possible, even in principle, to determine which direction around the cycle of gene expression corresponds to the forward arrow of time. In many cases, we anticipate that other methods, <italic>e.g.</italic> fluorescent reporters or population-level assays, can be used to provide this missing information. In some cases, the insensitivity of FISH data to cycle period may actually prove advantageous. In bulk studies of synchronized cell populations, different cycle periods of individual cells lead to loss of synchrony and therefore loss of signal. In contrast, for single-cell FISH studies, differences in cycle period among cells will not affect mRNA correlations. Hence, variations of period will not affect the ability to reconstruct cycle dynamics from mRNA snapshots. However, cell-to-cell variations of the shape of the cycle constitute noise even for FISH, which can at best allow reconstruction of the mean cycle waveform.</p>
<p>At a qualitative level, the regime of continuous mRNA production allows for relatively straightforward reconstruction of cyclic gene-expression dynamics. In the absence of noise, FISH data for even a single pair of genes is sufficient. One can simply plot the ordered pairs of FISH data as in <xref ref-type="fig" rid="pcbi-1000979-g002">Fig. 2A</xref>, and infer the dynamics from the smooth trajectory that joins the data points. (The fundamental limitations of FISH are already clear in this case – from the FISH data points alone one cannot in principle infer the period of the trajectory nor its direction.) Noise complicates the reconstruction somewhat, and requires a computational means of inferring the trajectory that best fits the data. Our solution presented below is to find the trajectory most likely to account for the data, within a family of harmonic functions, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e001" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e002" xlink:type="simple"/></inline-formula>, etc. The ability to accurately reconstruct trajectories in the presence of noise is greatly improved by FISH data for multiple pairs of cycling genes. Geometrically, the true trajectory is a path in the space of all the cycling genes. Each set of pairwise FISH data represents a projection of this trajectory onto a plane as in <xref ref-type="fig" rid="pcbi-1000979-g002">Fig. 2A</xref>. The more such projections are available, <italic>i.e.</italic> the more sets of pairwise FISH data, the more accurate the reconstruction of the true trajectory will be. This approach can be readily extended to the case of a stochastic switch between distinct gene-expression states, with the same improvements expected from multiple FISH pairs.</p>
<fig id="pcbi-1000979-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000979.g002</object-id><label>Figure 2</label><caption>
<title>Maximum likelihood estimation (MLE) applied to synthetic FISH data in the continuous regime.</title>
<p>(A) Comparison of true mRNA dynamics (red curve) with MLE reconstructions based on 4 genes (solid blue curve) and 2 genes (dashed blue curve), for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e003" xlink:type="simple"/></inline-formula> observations per gene pair. The data points are the actual synthetic data used for genes 1 and 2 in both cases. The maximum noise amplitude used to generate the data is <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e004" xlink:type="simple"/></inline-formula>. (B) The reconstruction error <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e005" xlink:type="simple"/></inline-formula>, averaged over 20 realizations of parameters with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e006" xlink:type="simple"/></inline-formula>, steadily decreases as the number of genes <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e007" xlink:type="simple"/></inline-formula> and the number of FISH observations <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e008" xlink:type="simple"/></inline-formula> per gene pair are increased.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000979.g002" xlink:type="simple"/></fig>
<p>Reconstruction of gene-expression dynamics in the regime of bursty mRNA production is more challenging. In this case, the data consists of the presence or absence of bursts of mRNAs, with rare coincidences of bursts for two genes (<italic>cf.</italic> <xref ref-type="fig" rid="pcbi-1000979-g001">Fig. 1D</xref>). All of the information in the data is therefore captured by a single number for each pair of genes, namely the covariance of their mRNA bursts. However, as we show below, the matrix of these covariances for multiple gene pairs in principle contains enough information to reconstruct the underlying parameters of cyclic trajectories or stochastic switches (albeit in some case with degeneracies that require additional constraints to resolve). Since coincident bursts of mRNAs are likely to be rare, one expects the covariance matrix derived from the data to be noisy. Nevertheless, with a sufficient number of sets of pairwise FISH data, we find that accurate reconstruction of the underlying gene-expression dynamics is feasible.</p>
<sec id="s2a">
<title>Continuous production of mRNA</title>
<p>We first consider the continuous regime where many bursts typically contribute to the instantaneous mRNA number. To demonstrate the MLE algorithm, we reconstruct the dynamics of gene expression using synthetic FISH data for which the underlying dynamics is known. We focus on analyzing cyclic dynamics, <italic>e.g.</italic> the cell cycle or a metabolic cycle; the results can be readily extended to stochastic switches, which are introduced in a later section. We denote the mean expression level of mRNA for gene <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e009" xlink:type="simple"/></inline-formula> by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e010" xlink:type="simple"/></inline-formula>, which is taken to be periodic with the same period for genes <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e011" xlink:type="simple"/></inline-formula>. For concreteness, we denote the period as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e012" xlink:type="simple"/></inline-formula>, although <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e013" xlink:type="simple"/></inline-formula> cannot be inferred from FISH data alone. FISH observations <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e014" xlink:type="simple"/></inline-formula> are generated for pairs of genes at randomly chosen times: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e015" xlink:type="simple"/></inline-formula>, where the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e016" xlink:type="simple"/></inline-formula> s reflect fluctuations in mRNA number around the mean, as well as noise in the measurement. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e017" xlink:type="simple"/></inline-formula> is assumed to be a Gaussian random variable of mean zero and standard deviation <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e018" xlink:type="simple"/></inline-formula>. We assume that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e019" xlink:type="simple"/></inline-formula> is not a function of the mean expression <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e020" xlink:type="simple"/></inline-formula>, but it is straightforward to extend the method to the more general case. (A natural extension of the model is to consider <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e021" xlink:type="simple"/></inline-formula> where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e022" xlink:type="simple"/></inline-formula> characterizes the measurement noise and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e023" xlink:type="simple"/></inline-formula> is the characteristic size of the independent events of mRNA production leading to the total mRNA number.) We aim at maximizing the likelihood of the observations within a family of harmonic functions of period <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e024" xlink:type="simple"/></inline-formula>. Bayes Theorem for the probability <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e025" xlink:type="simple"/></inline-formula> of a particular model (<italic>i.e.</italic> set of parameters) given the data states:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e026" xlink:type="simple"/><label>(1)</label></disp-formula>We neglect the term, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e027" xlink:type="simple"/></inline-formula>, corresponding to prior knowledge of the parameters, as there is no obvious choice for what such prior knowledge should be; moreover, with sufficient data, including such priors generally has little effect on the results of optimization. The probability of the data <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e028" xlink:type="simple"/></inline-formula> is a constant normalization factor, and so does not affect the relative likelihood of models. Therefore the probability of the model given the observations is proportional to the probability of the observations given the model <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e029" xlink:type="simple"/></inline-formula>.</p>
<p>For each FISH observation, one therefore has:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e030" xlink:type="simple"/><label>(2)</label></disp-formula>and for the combined likelihood <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e031" xlink:type="simple"/></inline-formula> over all observations,<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e032" xlink:type="simple"/><label>(3)</label></disp-formula>where the product runs over all <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e033" xlink:type="simple"/></inline-formula> FISH observations. In what follows we maximize <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e034" xlink:type="simple"/></inline-formula> assuming harmonic oscillations of mRNA levels,<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e035" xlink:type="simple"/><label>(4)</label></disp-formula>The method can be systematically extended to periodic trajectories that are not simple sine waves by including higher harmonics. It is also straightforward to extend the method to more detailed noise models. For example, non-Gaussian noise can be incorporated by appropriately modifying the Gaussian integrand in Eq. (2). Similarly, global transcriptional noise <xref ref-type="bibr" rid="pcbi.1000979-Raser1">[25]</xref> can be modeled in Eq. (2 via a single additional random variable multiplying both <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e036" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e037" xlink:type="simple"/></inline-formula>. Later, we consider both higher harmonics and global noise in detail for the more physiologically relevant case of bursty mRNA production.</p>
</sec><sec id="s2b">
<title>Synthetic data</title>
<p>We generate synthetic FISH data by first choosing the parameters in Eq. (4) for the oscillating mRNA levels <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e038" xlink:type="simple"/></inline-formula>, and then generating FISH observations based on these parameters. Specifically, we choose random variables <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e039" xlink:type="simple"/></inline-formula> uniformly on <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e040" xlink:type="simple"/></inline-formula>, for genes <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e041" xlink:type="simple"/></inline-formula>. We then define the model parameters in Eq. (4) as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e042" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e043" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e044" xlink:type="simple"/></inline-formula>. This construction ensures the positivity of the mRNA levels <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e045" xlink:type="simple"/></inline-formula>, and also ensures that the genes considered oscillate in time with significant amplitudes. The noise amplitudes <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e046" xlink:type="simple"/></inline-formula> are random variables, distributed continuously, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e047" xlink:type="simple"/></inline-formula>. The synthetic FISH data are generated by choosing for each gene pair <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e048" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e049" xlink:type="simple"/></inline-formula> random times <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e050" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e051" xlink:type="simple"/></inline-formula> random noise values <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e052" xlink:type="simple"/></inline-formula>, and constructing <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e053" xlink:type="simple"/></inline-formula>. In this way, the synthetic data correspond to a set of independent, pairwise FISH observations. An example is shown in <xref ref-type="fig" rid="pcbi-1000979-g002">Fig. 2</xref> for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e054" xlink:type="simple"/></inline-formula>. The red ellipse indicates the true mean-mRNA-level trajectory <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e055" xlink:type="simple"/></inline-formula>, and the crosses are the randomly generated FISH data points. The blue ellipses correspond to reconstructions of the mean trajectory via maximization of the likelihood in Eq. (3).</p>
</sec><sec id="s2c">
<title>Reconstruction of mRNA dynamics</title>
<p>To test the accuracy of reconstruction of mRNA dynamics using our MLE approach, we generated a large number of sets of parameter, and for each parameter set generated synthetic FISH data and then applied MLE to reconstruct the true dynamics. Specifically, for each parameter set defining a trajectory of mean mRNA levels <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e056" xlink:type="simple"/></inline-formula>, we maximized the likelihood <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e057" xlink:type="simple"/></inline-formula> with respect to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e058" xlink:type="simple"/></inline-formula>. To ensure that we always found the global maximum of the likelihood, the initial guess for the parameters was taken to be the true parameters describing the mean dynamics. (In <xref ref-type="sec" rid="s3">Methods</xref>, we present a simple algorithm that almost always finds the global likelihood maximum without prior knowledge of the true parameters. However, in <xref ref-type="fig" rid="pcbi-1000979-g002">Fig. 2</xref>, we chose to present the true MLE optimum as the fundamental limit of reconstruction accuracy, not limited by a particular algorithm.)</p>
<p>As shown in <xref ref-type="fig" rid="pcbi-1000979-g002">Fig. 2</xref>, with synthetic FISH data for only two genes (dashed blue ellipse) the reconstruction is rather poor, in this case mistakenly assigning too large a noise <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e059" xlink:type="simple"/></inline-formula> to each gene and missing the phase shift. However, the addition of pairwise information from two more genes to make <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e060" xlink:type="simple"/></inline-formula> (for a total of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e061" xlink:type="simple"/></inline-formula> gene pairs) is enough to correct these errors and provide a very accurate reconstruction. Since each pairwise data set is independent, the total amount of data grows as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e062" xlink:type="simple"/></inline-formula>.</p>
<p>To quantify the accuracy of the MLE algorithm, we computed the reconstruction error <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e063" xlink:type="simple"/></inline-formula>, which characterizes how much the reconstructed dynamics varies from the true mRNA dynamics,<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e064" xlink:type="simple"/><label>(5)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e065" xlink:type="simple"/></inline-formula> is the MLE reconstructed trajectory for mRNA <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e066" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e067" xlink:type="simple"/></inline-formula> is the (true) average number of mRNA <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e068" xlink:type="simple"/></inline-formula> over the period <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e069" xlink:type="simple"/></inline-formula>. Results for the reconstruction error are shown in <xref ref-type="fig" rid="pcbi-1000979-g002">Fig. 2B</xref> for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e070" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e071" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e072" xlink:type="simple"/></inline-formula>. Each point is averaged over 20 randomly generated parameter sets. As expected, the results improve with the number of genes <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e073" xlink:type="simple"/></inline-formula> and the number of FISH observations <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e074" xlink:type="simple"/></inline-formula> per gene pair, but at this noise level the results are already good <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e075" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e076" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e077" xlink:type="simple"/></inline-formula>.</p>
</sec><sec id="s2d">
<title>Bursty production of mRNA</title>
<p>We now consider the bursty regime where a cell will typically either have few (or no) mRNAs of a particular type, or the mRNAs present will come from a single recent burst of transcription. In this limit, the information provided by FISH is essentially binary - either mRNAs for a particular gene are present at significant levels, indicating a recent burst, or they are not. Formally, if a significant number of mRNAs for gene <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e078" xlink:type="simple"/></inline-formula> are present, then <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e079" xlink:type="simple"/></inline-formula>, otherwise <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e080" xlink:type="simple"/></inline-formula>. The optimal threshold <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e081" xlink:type="simple"/></inline-formula> to set for the “presence” of mRNAs <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e082" xlink:type="simple"/></inline-formula> will depend on burst size and duration, measurement noise, and the total number of FISH observations – see <xref ref-type="sec" rid="s4">Discussion</xref>. FISH data yields an estimate <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e083" xlink:type="simple"/></inline-formula> for the mean probability that mRNAs are present above the threshold value <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e084" xlink:type="simple"/></inline-formula> for each gene (in the expression for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e085" xlink:type="simple"/></inline-formula>, the variable <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e086" xlink:type="simple"/></inline-formula> reports the absence or presence of mRNA <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e087" xlink:type="simple"/></inline-formula> for observation <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e088" xlink:type="simple"/></inline-formula> of the pair <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e089" xlink:type="simple"/></inline-formula>, and the sum is made on the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e090" xlink:type="simple"/></inline-formula> observations that probe for mRNA of gene <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e091" xlink:type="simple"/></inline-formula>.) The FISH data also yields an estimate for the covariance <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e092" xlink:type="simple"/></inline-formula> for each pair of genes. We aim to accurately reconstruct the mRNA dynamics from these quantities <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e093" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e094" xlink:type="simple"/></inline-formula>, which capture all the information provided by the binarized FISH data in the bursty regime. However, even with perfect knowledge of mean expression and covariance, the reconstruction of mRNA dynamics has fundamental limitations in this regime. We illustrate by considering both cyclic dynamics and stochastic switches.</p>
</sec><sec id="s2e">
<title>Cyclic dynamics</title>
<p>We denote by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e095" xlink:type="simple"/></inline-formula> the probability that the number of mRNAs of type <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e096" xlink:type="simple"/></inline-formula> present at time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e097" xlink:type="simple"/></inline-formula> is larger than some threshold <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e098" xlink:type="simple"/></inline-formula>, and we call such an event a burst in what follows. Assuming <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e099" xlink:type="simple"/></inline-formula> is any periodic function with period <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e100" xlink:type="simple"/></inline-formula>, it can be expanded in harmonics:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e101" xlink:type="simple"/><label>(6)</label></disp-formula>with more harmonics generally required to capture more complex oscillation patterns. Note that if <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e102" xlink:type="simple"/></inline-formula> is twice the number of harmonics considered, the number of parameters is <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e103" xlink:type="simple"/></inline-formula>, the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e104" xlink:type="simple"/></inline-formula> coming from the invariance with respect to the overall phase. For the following discussion it is sufficient to keep only the first two harmonics, shown explicitly in Eq. (6). In this case, denoting by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e105" xlink:type="simple"/></inline-formula> the average over a cycle, one finds:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e106" xlink:type="simple"/><label>(7)</label></disp-formula><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e107" xlink:type="simple"/></disp-formula><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e108" xlink:type="simple"/><label>(8)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e109" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e110" xlink:type="simple"/></inline-formula> denote the true cycle-averaged mean and covariance, respectively. One immediately sees that the transformation <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e111" xlink:type="simple"/></inline-formula> for all <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e112" xlink:type="simple"/></inline-formula> leaves both <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e113" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e114" xlink:type="simple"/></inline-formula> unchanged. Thus, in this bursty regime, pairwise FISH data alone cannot disentangle different harmonics without prior knowledge. However, any additional constraint, including even a single triplet FISH data set, can readily resolve the ambiguity between harmonics. (A triplet FISH observation, <italic>i.e.</italic> simultaneous measurement of three different mRNA types, leads to terms <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e115" xlink:type="simple"/></inline-formula>, which do not have the problematic symmetry.)</p>
<p>For simplicity, let us now consider only the lowest harmonic, as in the previous section. We introduce the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e116" xlink:type="simple"/></inline-formula>-dimensional vectors <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e117" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e118" xlink:type="simple"/></inline-formula>, defined as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e119" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e120" xlink:type="simple"/></inline-formula>. Each component can vary independently of the others, as there are <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e121" xlink:type="simple"/></inline-formula> parameters, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e122" xlink:type="simple"/></inline-formula> coordinates for the two vectors. Then by inspection the covariance matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e123" xlink:type="simple"/></inline-formula> from Eq. (7) can be written:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e124" xlink:type="simple"/><label>(9)</label></disp-formula>which shows that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e125" xlink:type="simple"/></inline-formula> is in general of rank 2. If the second harmonics are included, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e126" xlink:type="simple"/></inline-formula> is of rank 4, etc. Note that all symmetric matrices of rank <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e127" xlink:type="simple"/></inline-formula> can be written in the form of Eq. (9), with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e128" xlink:type="simple"/></inline-formula> eigenvectors, implying that for a covariance matrix of even rank there is always an interpretation of the dynamics in terms of cyclic trajectories. Unfortunately, this interpretation is not unique except for the case of a single harmonic (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e129" xlink:type="simple"/></inline-formula>), which can be seen as follows. The observed mean probabilities for mRNA bursts of each type leads to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e130" xlink:type="simple"/></inline-formula> constraints. The observed covariances lead to an additional <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e131" xlink:type="simple"/></inline-formula> constraints. Being a symmetric matrix of rank <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e132" xlink:type="simple"/></inline-formula>, the covariance matrix can be defined by this many coefficients, <italic>i.e.</italic> the number necessary to describe the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e133" xlink:type="simple"/></inline-formula> eigenvectors, enforcing orthogonality among them. The expression for the number of covariance constraints is true for sufficient large <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e134" xlink:type="simple"/></inline-formula>, but in general is <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e135" xlink:type="simple"/></inline-formula>.) The total number of constraints provided by FISH is therefore <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e136" xlink:type="simple"/></inline-formula>. Thus the number of unconstrained parameters is <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e137" xlink:type="simple"/></inline-formula>, which is zero for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e138" xlink:type="simple"/></inline-formula>, but is already 5 for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e139" xlink:type="simple"/></inline-formula>. Hence, for two harmonics <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e140" xlink:type="simple"/></inline-formula> at least 5 triplet FISH data sets or other constraints are required to be able to infer all the parameters.</p>
<p>An important consideration in analyzing FISH data is that overall transcription rates may vary from cell to cell. Indeed, measurements of gene-expression noise in single yeast cells at the protein level reveal <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e141" xlink:type="simple"/></inline-formula> global fluctuations <xref ref-type="bibr" rid="pcbi.1000979-Raser1">[25]</xref>. How can the dynamics of bursty gene expression be reconstructed against the background of these global correlations? We consider the case of a simple harmonic cycle. The probability <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e142" xlink:type="simple"/></inline-formula> that the number of mRNAs of type <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e143" xlink:type="simple"/></inline-formula> present at time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e144" xlink:type="simple"/></inline-formula> is larger than some threshold <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e145" xlink:type="simple"/></inline-formula> now reads:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e146" xlink:type="simple"/><label>(10)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e147" xlink:type="simple"/></inline-formula>, representing the fluctuating global level of transcription, is a random variable of mean unity and standard deviation <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e148" xlink:type="simple"/></inline-formula>. One then obtains for the true cycle-averaged mean <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e149" xlink:type="simple"/></inline-formula> and covariance <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e150" xlink:type="simple"/></inline-formula>:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e151" xlink:type="simple"/><label>(11)</label></disp-formula><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e152" xlink:type="simple"/><label>(12)</label></disp-formula>Introducing the definitions <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e153" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e154" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e155" xlink:type="simple"/></inline-formula>, the covariance matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e156" xlink:type="simple"/></inline-formula> from Eq. (12) can now be written:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e157" xlink:type="simple"/><label>(13)</label></disp-formula>which shows that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e158" xlink:type="simple"/></inline-formula> is now of rank 3. If the second harmonics are included, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e159" xlink:type="simple"/></inline-formula> is of rank 5, etc. The maximum likelihood reconstruction for the model of Eq. (10) provides an estimate of the level of global transcriptional noise, as we show below for our reconstruction of metabolic cycles in yeast.</p>
</sec><sec id="s2f">
<title>Switching dynamics</title>
<p>We now consider a model where the expression pattern can switch stochastically among <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e160" xlink:type="simple"/></inline-formula> distinct states, as illustrated in <xref ref-type="fig" rid="pcbi-1000979-g003">Fig. 3</xref>. We assume all genes of interest switch their expression synchronously, consistent with control by a single transcription factor, and without delays, consistent with state lifetimes long compared to mRNA lifetimes. On average, each state <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e161" xlink:type="simple"/></inline-formula> occurs with probability <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e162" xlink:type="simple"/></inline-formula>. In state <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e163" xlink:type="simple"/></inline-formula>, the true probability that a burst of mRNAs of type <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e164" xlink:type="simple"/></inline-formula> is present is denoted <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e165" xlink:type="simple"/></inline-formula>. For such models, the number of parameters is therefore <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e166" xlink:type="simple"/></inline-formula>, taking into account that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e167" xlink:type="simple"/></inline-formula>. One finds, following simple arithmetic:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e168" xlink:type="simple"/><label>(14)</label></disp-formula><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e169" xlink:type="simple"/><label>(15)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e170" xlink:type="simple"/></inline-formula> is the state-averaged burst probability and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e171" xlink:type="simple"/></inline-formula> is the covariance matrix. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e172" xlink:type="simple"/></inline-formula> is a <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e173" xlink:type="simple"/></inline-formula>-dimensional vector of components <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e174" xlink:type="simple"/></inline-formula>.</p>
<fig id="pcbi-1000979-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000979.g003</object-id><label>Figure 3</label><caption>
<title>A stochastic switch in the regime of bursty mRNA production.</title>
<p>(A) Illustration of the number of mRNA transcripts versus time, in the bursty limit, for two genes subject to regulation by a stochastic 2-state switch (solid lines); dashed lines indicate true burst probabilities <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e175" xlink:type="simple"/></inline-formula> in each state. Reconstruction error <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e176" xlink:type="simple"/></inline-formula> averaged over 20 realizations of parameters as number of genes <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e177" xlink:type="simple"/></inline-formula> and number of FISH observations <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e178" xlink:type="simple"/></inline-formula> per gene pair are varied, for (B) maximum likelihood estimation, and (C) principal component analysis (PCA). The probability of the states was chosen as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e179" xlink:type="simple"/></inline-formula>, and the parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e180" xlink:type="simple"/></inline-formula> were chosen randomly on <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e181" xlink:type="simple"/></inline-formula>. To ensure that all genes considered are informative about the state of the switch, the constraint <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e182" xlink:type="simple"/></inline-formula> was enforced.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000979.g003" xlink:type="simple"/></fig>
<p>It is straightforward to see that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e183" xlink:type="simple"/></inline-formula>, which implies that the different vectors <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e184" xlink:type="simple"/></inline-formula> are not independent. Together with Eq. (15), this dependence implies that the covariance matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e185" xlink:type="simple"/></inline-formula> is in general of rank <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e186" xlink:type="simple"/></inline-formula>. Thus, pairwise FISH data alone cannot distinguish a 3-state model from simple harmonic dynamics (or a 5-state model from a cycle including second harmonics, and so on). Moreover, even if one assumes that the dynamics is a switch, the parameters cannot be resolved uniquely: the number of constraints set by the measured means and covariances is <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e187" xlink:type="simple"/></inline-formula>, so that the number of unconstrained parameters is <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e188" xlink:type="simple"/></inline-formula>, which is 1 for a 2-state switch, and 3 for a 3-state switch. The corresponding number of triplet FISH data sets or other constraints are therefore required for parameter inference; however, if this additional data is available, switching parameters can be inferred even in the presence of global noise, as discussed above for the case of a simple cycle.</p>
</sec><sec id="s2g">
<title>Maximum likelihood estimation</title>
<p>For either cyclic or switching dynamics, maximum likelihood parameter estimation in the regime of bursty mRNA production requires the following steps, (1) estimating the mean burst probability and covariance from the FISH data, (2) determining the uncertainty of these estimates, and (3) obtaining the parameters for which the observed data is most likely. Taking an average over FISH data provides an estimate <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e189" xlink:type="simple"/></inline-formula> of the cycle- or state-averaged probability for a burst of mRNAs of type <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e190" xlink:type="simple"/></inline-formula> to be present. Specifically, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e191" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e192" xlink:type="simple"/></inline-formula> reports the absence or presence of mRNA <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e193" xlink:type="simple"/></inline-formula> for observation <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e194" xlink:type="simple"/></inline-formula> of the pair <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e195" xlink:type="simple"/></inline-formula>, and where the sum is made on the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e196" xlink:type="simple"/></inline-formula> observations that probe for mRNA of gene <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e197" xlink:type="simple"/></inline-formula>. Similarly, FISH data provide an estimate of the covariance, namely <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e198" xlink:type="simple"/></inline-formula>. For a finite number of data points, these estimates will be noisy, <italic>i.e.</italic> <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e199" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e200" xlink:type="simple"/></inline-formula>, where the right hand sides are the exact values. Since coincident bursts of mRNAs of type <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e201" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e202" xlink:type="simple"/></inline-formula> will be rare, the covariance estimate <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e203" xlink:type="simple"/></inline-formula> from finite FISH data may deviate significantly from the true covariance <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e204" xlink:type="simple"/></inline-formula>, and one must allow for this uncertainty in the maximum likelihood calculation. In contrast, one may safely neglect the uncertainty in the FISH estimate of the mean burst probability, both because single mRNA bursts are much more frequent than coincident bursts, and because each mRNA type is probed <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e205" xlink:type="simple"/></inline-formula> times more frequently than each pair. In practice, we therefore demand that the MLE parameters yield <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e206" xlink:type="simple"/></inline-formula> exactly.</p>
<p>To estimate the uncertainty in the covariances, we first note that the true variance in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e207" xlink:type="simple"/></inline-formula> is<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e208" xlink:type="simple"/><label>(16)</label></disp-formula>where the overbar indicates the cycle or state average. We can then estimate the relevant quantity from the data, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e209" xlink:type="simple"/></inline-formula>, to obtain an estimate for the variance <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e210" xlink:type="simple"/></inline-formula>. Using this estimate for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e211" xlink:type="simple"/></inline-formula>, the probability of obtaining a covariance estimate <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e212" xlink:type="simple"/></inline-formula> if the true covariance is <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e213" xlink:type="simple"/></inline-formula> is given by:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e214" xlink:type="simple"/><label>(17)</label></disp-formula>Since the observations for the different mRNA pairs are independent, the likelihood of the observed covariance estimates <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e215" xlink:type="simple"/></inline-formula> for a given set of parameters is readily obtained from Eq. (17).</p>
</sec><sec id="s2h">
<title>Results for cyclic dynamics</title>
<p>As discussed above, for bursty mRNA production the means and covariances alone cannot distinguish cyclic from switching dynamics. However, if one has prior evidence that gene expression is cyclic, maximum likelihood estimation can be usefully employed to reconstruct the dynamics. If <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e216" xlink:type="simple"/></inline-formula> and for a sufficient data, the algorithm works well, as illustrated in <xref ref-type="fig" rid="pcbi-1000979-g004">Fig. 4</xref> for harmonic <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e217" xlink:type="simple"/></inline-formula> dynamics. A larger data set is needed than in the continuous mRNA regime because observations of coincident bursts are rare. Note that for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e218" xlink:type="simple"/></inline-formula>, the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e219" xlink:type="simple"/></inline-formula> constraints from the observed means and covariances are fewer than the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e220" xlink:type="simple"/></inline-formula> parameters, and reconstruction requires additional constraints, <italic>e.g.</italic> from triplet FISH data.</p>
<fig id="pcbi-1000979-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000979.g004</object-id><label>Figure 4</label><caption>
<title>Accuracy of parameter inference for harmonically oscillating gene expression.</title>
<p>Inference error <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e221" xlink:type="simple"/></inline-formula> for harmonically oscillating gene expression for (A) maximum likelihood estimation (MLE) and (B) principal component analysis (PCA), in the bursty mRNA limit for different numbers of genes and FISH observations per gene pair. MLE is systematically more accurate, but only by a few percent. Averages are shown for 20 FISH data sets, generated using parameters (as defined in Eq. (6)) <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e222" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e223" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e224" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e225" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e226" xlink:type="simple"/></inline-formula> with uniform distributions. These choices ensure that all genes considered display significant variations in burst probability along the cycle and always display a positive burst probability. (On the rare occasions that a probability estimated from Eq. (6) is larger than one at some instant of time, a burst is generated in the synthetic data with a probability of one.)</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000979.g004" xlink:type="simple"/></fig></sec><sec id="s2i">
<title>Results for switching dynamics</title>
<p>A stochastic switch between 2 states implies a covariance matrix of rank 1, and therefore can be distinguished from cyclic dynamics, which leads to a minimum rank of 2 (unless all the genes are exactly in phase). Still, one piece of additional information is required to reconstruct the dynamics. For example, it is sufficient to know the expression level of a single gene in one state. Here, we instead assume that the probability <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e227" xlink:type="simple"/></inline-formula> of being in one state is known, and given that constraint we infer all the levels of gene expression from synthetic FISH data. (Note that FISH data can only reveal the probabilities to be in each state, not the kinetics of switching, <italic>e.g.</italic> interval durations or branching ratios.) The MLE algorithm works well, as shown in <xref ref-type="fig" rid="pcbi-1000979-g003">Fig. 3A</xref>, as long as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e228" xlink:type="simple"/></inline-formula> and for sufficient data. To quantify the accuracy of the MLE parameter estimation for switching dynamics, we have plotted in <xref ref-type="fig" rid="pcbi-1000979-g003">Fig. 3B</xref> the reconstruction error <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e229" xlink:type="simple"/></inline-formula> which measures the deviation of the reconstructed rates from the true rates (normalized by the state-to-state variation and weighted by the state probabilities) and averaged over all measured genes:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e230" xlink:type="simple"/><label>(18)</label></disp-formula>where the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e231" xlink:type="simple"/></inline-formula> are the reconstructed rates.</p>
<p>In principle, with enough FISH data it should be possible to reconstruct more than just the probability of observing a burst. For example, the entire distribution of mRNAs of each type in each switching state could be obtained using MLE, <italic>e.g.</italic> via Expectation Maximization (EM) <xref ref-type="bibr" rid="pcbi.1000979-Do1">[26]</xref>, by treating the full distributions rather than just the mean burst probabilities <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e232" xlink:type="simple"/></inline-formula> as unknowns. However, the approach proposed above of thresholding and binarizing the data has the advantage of reducing noise, and thereby reducing the required number of FISH observations, while still allowing for inference of the basic gene-expression dynamics.</p>
</sec><sec id="s2j">
<title>Comparison with Principal Component Analysis</title>
<p>In the regime of bursty mRNA production, all of the information from FISH is contained in the mean burst probabilities and the covariance matrix, suggesting that Principal Component Analysis (PCA) could be usefully applied. For example, for a 2-state switch the covariance matrix has rank 1. Thus, according to Eq. (15), performing PCA by diagonalizing <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e233" xlink:type="simple"/></inline-formula> directly yields <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e234" xlink:type="simple"/></inline-formula>, the vector of differences of burst probabilities between the two states, as the only eigenvector with a non-vanishing eigenvalue. Together with the mean burst probabilities, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e235" xlink:type="simple"/></inline-formula>, this yields full information on the switching dynamics. One caveat is that all the diagonal terms are missing from the estimated covariance matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e236" xlink:type="simple"/></inline-formula>, as one cannot obtain an estimate of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e237" xlink:type="simple"/></inline-formula> directly from FISH data. To solve this problem, we initially diagonalize the matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e238" xlink:type="simple"/></inline-formula> with a zero diagonal, and obtain the principal eigenvalue and eigenvector. We then approximate the diagonal terms of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e239" xlink:type="simple"/></inline-formula> with the diagonal terms of the rank-1 matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e240" xlink:type="simple"/></inline-formula> built using this single eigenvector <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e241" xlink:type="simple"/></inline-formula>. We repeat this procedure iteratively to convergence, and take the converged principal eigenvector as an estimate of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e242" xlink:type="simple"/></inline-formula>. This PCA approach performs similarly well to MLE for the case of a 2-state switch, as shown in <xref ref-type="fig" rid="pcbi-1000979-g003">Fig. 3</xref>. The PCA approach can be easily extended to cases in which <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e243" xlink:type="simple"/></inline-formula> has a higher rank, where it also performs well, see <xref ref-type="fig" rid="pcbi-1000979-g004">Fig. 4</xref>. Of course, like MLE, PCA has the same fundamental limitations discussed above that are inherent to coincidence detection.</p>
<p>In practice, elements of the PCA and MLE approaches can be usefully combined. The main utility of PCA lies in diagonalizing <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e244" xlink:type="simple"/></inline-formula> to infer its rank. (The iterative approach to filling in the diagonals of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e245" xlink:type="simple"/></inline-formula> can help refine this procedure.) From the rank of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e246" xlink:type="simple"/></inline-formula>, one has a direct estimate of the “complexity” of the dynamics. Complexity here means the number of states in a switch model, or the number of harmonics to be considered for cyclic dynamics. This suggests the following heuristic approach to FISH data analysis: First diagonalize <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e247" xlink:type="simple"/></inline-formula>. Then isolate a group of eigenvalues that are significantly larger than the rest. Use prior information to select between the different models (cyclic or switching) leading to such a rank, and finally compute the model parameters using maximum likelihood estimation.</p>
</sec><sec id="s2k">
<title>Applying MLE to test the putative existence of a metabolic cycle in yeast</title>
<p>In recent years, McKnight and coworkers demonstrated that the yeast <italic>Saccharomyces cerevisiae</italic> grown in chemostats can undergo synchronized metabolic oscillations <xref ref-type="bibr" rid="pcbi.1000979-Tu1">[13]</xref>, <xref ref-type="bibr" rid="pcbi.1000979-Tu2">[27]</xref>. As shown in <xref ref-type="fig" rid="pcbi-1000979-g005">Fig. 5</xref>, the mRNA levels of three clusters of genes – Oxidative, Reductive Building, and Reductive Charging – were found to cycle together, with the expression of each cluster peaking at a different phase of the cycle. These population-level chemostat studies raise the question - is there an intrinsic metabolic cycle in individual cells in unsynchronized cultures? To address this question, in <xref ref-type="bibr" rid="pcbi.1000979-Silverman1">[14]</xref> FISH data were obtained from single, unsynchronized yeast cells. Specifically, correlations of mRNA levels were determined for pairs of genes, each of which cycled in the chemostat. The correlations observed in single cells closely matched those found in the chemostat studies, leading to the conclusion that metabolic oscillations do occur in individual cells in unsynchronized populations as well as in synchronized chemostats. However, in <xref ref-type="bibr" rid="pcbi.1000979-Silverman1">[14]</xref> no attempt was made to go beyond correlations to reconstruct the dynamics. Here we use MLE to infer metabolic gene dynamics in unsynchronized populations. Our results support the conclusion of <xref ref-type="bibr" rid="pcbi.1000979-Silverman1">[14]</xref> that the gene clusters observed in the chemostat persist in individual cells in unsynchronized cultures. In particular, we find that the genes of the Oxidative cluster oscillate together <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e248" xlink:type="simple"/></inline-formula> and so do the genes of the Reductive Building cluster <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e249" xlink:type="simple"/></inline-formula>. The situation is still unclear for the Reductive Charging genes, but is likely to be clarified by additional FISH data.</p>
<fig id="pcbi-1000979-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000979.g005</object-id><label>Figure 5</label><caption>
<title>Sketch of the dynamics of the three clusters of genes: Oxidative, Reductive Building, and Reductive Charging, as identified by chemostat studies of <italic>Saccharomyces cerevisiae</italic> <xref ref-type="bibr" rid="pcbi.1000979-Tu1">[13]</xref>.</title>
<p>Note that the expression levels cycle periodically and approach zero at some point along the cycle. Adapted from <xref ref-type="bibr" rid="pcbi.1000979-Tu1">[13]</xref>.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000979.g005" xlink:type="simple"/></fig>
<p>To analyze the dynamics, we first binarized the FISH data of <xref ref-type="bibr" rid="pcbi.1000979-Silverman1">[14]</xref> as appropriate for bursty gene expression. The data consists of 79 pairwise FISH experiments involving a total of 25 genes. To set an appropriate binary threshold of expression for each gene, we found the median <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e250" xlink:type="simple"/></inline-formula> of the mRNA distribution for each gene <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e251" xlink:type="simple"/></inline-formula>. Only 7 genes have a median larger than zero (and in all cases <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e252" xlink:type="simple"/></inline-formula>), indicating that most genes are indeed bursty – despite the fact that those 25 genes were selected, among other criteria, to have a high expression level <xref ref-type="bibr" rid="pcbi.1000979-Silverman1">[14]</xref>. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e253" xlink:type="simple"/></inline-formula> denotes the probability that the number of observed mRNA of gene <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e254" xlink:type="simple"/></inline-formula> is strictly larger than <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e255" xlink:type="simple"/></inline-formula> and is directly measurable from the data. We found <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e256" xlink:type="simple"/></inline-formula>, with the lower range coming from genes for which the median <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e257" xlink:type="simple"/></inline-formula>.</p>
<p>We assumed that the dynamics is cyclic and considered the expansion of Eq. 6 up to the first harmonic. Such a model has 74 independent parameters for 25 genes. Moreover, the number of data points per pair of genes varies from 175 to 16032, with only 29 pairs having more than 2000 data points. Thus some of the correlations are well-characterized, but others are not. If only the 29 gene pairs with more than 2000 data points are considered, even a single-harmonic model is under-constrained. To circumvent this problem, we are guided by the observation apparent from <xref ref-type="fig" rid="pcbi-1000979-g005">Fig. 5</xref> that the gene expression in all clusters becomes much smaller than its mean at some point in time. This suggests a simplified model where the probability <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e258" xlink:type="simple"/></inline-formula> of expressing more mRNAs than the median mRNA number for gene <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e259" xlink:type="simple"/></inline-formula> cycles as:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e260" xlink:type="simple"/><label>(19)</label></disp-formula>Therefore, once <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e261" xlink:type="simple"/></inline-formula> is extracted from the data there is a single free parameter per gene, namely its phase <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e262" xlink:type="simple"/></inline-formula>.</p>
<p>Next, the likelihood of all the observed FISH correlations was maximized with respect to the phases <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e263" xlink:type="simple"/></inline-formula>. The global maximum was found by considering various random initial phases, relaxing to a maximum, repeating, and choosing the maximum with the largest likelihood. We consistently found the same maximum after the order of 10 optimization runs. Results for the reconstructed dynamics are shown in <xref ref-type="fig" rid="pcbi-1000979-g006">Fig. 6</xref> for the 14 most tested genes (per gene number of observations<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e264" xlink:type="simple"/></inline-formula>). Genes belonging to each metabolic cluster identified by the chemostat studies are represented by distinct colors as indicated in the legend. The location of the maximum probability for each gene is indicated by an arrow. From the positions of the arrows it is apparent that genes belonging to the Oxidative cluster also cluster in an unsynchronized population, and so do the genes of the Reductive Building cluster. From the existing data we cannot yet conclude whether the Reductive Charging genes also cluster.</p>
<fig id="pcbi-1000979-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000979.g006</object-id><label>Figure 6</label><caption>
<title>Reconstruction of the metabolic cycle.</title>
<p>(A) Reconstructed dynamics of the probabilities <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e265" xlink:type="simple"/></inline-formula> of expressing more mRNAs than the median value <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e266" xlink:type="simple"/></inline-formula>. Likelihood maximization was performed on all 25 genes using all FISH data <xref ref-type="bibr" rid="pcbi.1000979-Silverman1">[14]</xref>, but only the 14 genes with the largest number of observations are shown. There are 6 Oxidative genes (CTP1, NOP1, SNU13, SUR4, UTR2, YEF3), 4 Reductive Building genes (GAS1, HXK2, POL30, SCW10), and 4 Reductive Charging genes (CTS1, OM45, PFK26, YGP1). Genes belonging to the same clusters in <xref ref-type="fig" rid="pcbi-1000979-g005">Fig. 5</xref> are represented by the same color. For each gene the position of the maximum is indicated by an arrow. (B) Average cluster activities <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e267" xlink:type="simple"/></inline-formula> as defined in the text.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000979.g006" xlink:type="simple"/></fig>
<p>To quantify our results statistically, we define for each cluster, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e268" xlink:type="simple"/></inline-formula>, the quantity <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e269" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e270" xlink:type="simple"/></inline-formula> is the number of genes in cluster <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e271" xlink:type="simple"/></inline-formula>. The <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e272" xlink:type="simple"/></inline-formula>, which characterize the average cluster activity, are plotted in <xref ref-type="fig" rid="pcbi-1000979-g006">Fig. 6</xref>. If the genes belonging to a cluster are perfectly synchronized, <italic>i.e.</italic> <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e273" xlink:type="simple"/></inline-formula> are identical for all <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e274" xlink:type="simple"/></inline-formula>, then <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e275" xlink:type="simple"/></inline-formula> will reach zero along the cycle. More generally, the lower the minimum of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e276" xlink:type="simple"/></inline-formula>, the more synchronized the cluster is for fixed <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e277" xlink:type="simple"/></inline-formula>. We find that the Oxidative and Reductive Building genes are indeed clustered: the probability of finding such low minima for the two corresponding curves would be only <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e278" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e279" xlink:type="simple"/></inline-formula> respectively (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e280" xlink:type="simple"/></inline-formula> when considered together) if the phases were random. On the other hand, the minimum of the Reductive Charging cluster is comparable to the typical value for random phases.</p>
<p>From the chemostat studies <xref ref-type="bibr" rid="pcbi.1000979-Tu1">[13]</xref>, we expect the amplitudes of oscillation of metabolically cycling genes to be large (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e281" xlink:type="simple"/></inline-formula>10 fold), and so global transcriptional noise (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e282" xlink:type="simple"/></inline-formula>2 fold <xref ref-type="bibr" rid="pcbi.1000979-Raser1">[25]</xref>) should not significantly affect our results. However, to test that our reconstruction of the metabolic cycle is robust with respect to global transcriptional noise, we reconstructed the dynamics allowing for a global correlation among mRNA levels as in Eq. (10). Specifically, we extended the model of Eq. (19) by adding the possibility of a varying global level of transcription <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e283" xlink:type="simple"/></inline-formula>:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e284" xlink:type="simple"/><label>(20)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e285" xlink:type="simple"/></inline-formula> is a random variable of mean unity and standard deviation <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e286" xlink:type="simple"/></inline-formula>. The results of the reconstruction are essentially identical to those shown in <xref ref-type="fig" rid="pcbi-1000979-g006">Fig. 6</xref>, where the global level of transcription was assumed to be fixed (for a comparison see <xref ref-type="supplementary-material" rid="pcbi.1000979.s001">Fig. S1</xref>). Moreover, from the reconstruction we infer the amplitude of the global noise of transcription to be <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e287" xlink:type="simple"/></inline-formula> (<italic>i.e.</italic> 55%), which is significant, but considerably smaller than the typical variation during a cycle <xref ref-type="bibr" rid="pcbi.1000979-Tu1">[13]</xref>.</p>
<p>In <xref ref-type="fig" rid="pcbi-1000979-g006">Fig. 6</xref>, the lack of evidence for coherent oscillations of the Reductive Charging genes may reflect a real feature of unsynchronized populations. Alternatively, it may reflect the limited data and/or the simplicity of the model of Eq. (19). To investigate the limitations of this model we considered how the pairwise gene covariances it predicts compare with the observed FISH covariances, as shown in <xref ref-type="fig" rid="pcbi-1000979-g007">Fig. 7</xref>. Even the underlying “true” model should not capture the FISH correlations perfectly, especially since some observations are very noisy due to the limited data. However, some general trends appear. In particular our model in Eq. (19) systematically underestimates the largest covariances. This may be due to the fact that the single cosine wave that we use to fit the dynamics is less peaked than the typical expression profile observed in the chemostat <xref ref-type="bibr" rid="pcbi.1000979-Tu1">[13]</xref>. Accordingly higher harmonics should be included to obtain a more accurate description of the gene-expression dynamics, an approach that will be achievable once the data set is enlarged to include additional gene pairs.</p>
<fig id="pcbi-1000979-g007" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000979.g007</object-id><label>Figure 7</label><caption>
<title>Reconstructed covariances versus observed FISH covariances for all 79 experiments in <xref ref-type="bibr" rid="pcbi.1000979-Silverman1">[14]</xref>.</title>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000979.g007" xlink:type="simple"/></fig></sec></sec><sec id="s3" sec-type="methods">
<title>Methods</title>
<sec id="s3a">
<title>Finding the global likelihood maximum</title>
<p>In general, Maximum Likelihood Estimation (MLE) requires finding the set of model parameters for which the observed data are most likely. Finding the global maximum in the space of model parameters can be a challenging task, particularly as there may be many local maxima in which a search algorithm can get stuck. For synthetic FISH data in the regime of continuous mRNA production, we found that such local maxima occurred frequently. (In contrast, for synthetic FISH data in the bursty regime a simple steepest-descent algorithm invariably found the same maximum, independent of initial conditions.) To find the global maximum in the continuous regime, we developed a heuristic algorithm that worked very well in practice to reconstruct simple cycles.</p>
<p>One approach is to consider various initial parameter values, and to use a steepest-descent algorithm to find the local maximum of the likelihood. Then the global maximum (with the highest likelihood) could be chosen among the different solutions. However, in practice this procedure can be very time-consuming if initial conditions are chosen randomly. Here we propose two approaches to first compute estimates of the parameters, and then use these estimates to initiate the optimization protocol. In these two approaches we estimated the parameters as follows: (1) For the mean expression level we took <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e288" xlink:type="simple"/></inline-formula>. (2) For both the amplitude of oscillations <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e289" xlink:type="simple"/></inline-formula> and the noise amplitude <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e290" xlink:type="simple"/></inline-formula> we took half the standard deviation of the observations of the corresponding gene <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e291" xlink:type="simple"/></inline-formula>. (3) Empirically we found that the initial choice of phase <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e292" xlink:type="simple"/></inline-formula> is critical in determining if the global or only a local maximum is found. Therefore, to accurately estimate the relative phases we introduced the Pearson correlation matrix (a normalized variant of our covariance matrix) <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e293" xlink:type="simple"/></inline-formula>. This definition implies <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e294" xlink:type="simple"/></inline-formula>. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e295" xlink:type="simple"/></inline-formula> yields a rough approximation of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e296" xlink:type="simple"/></inline-formula>, which leads to the following two approximations, the first being extremely crude:</p>
<list list-type="alpha-lower"><list-item>
<p>We assign <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e297" xlink:type="simple"/></inline-formula>. Then the vector <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e298" xlink:type="simple"/></inline-formula> is considered. The maximum value of this vector occurs for some gene <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e299" xlink:type="simple"/></inline-formula>, and we assign <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e300" xlink:type="simple"/></inline-formula>. For the second maximum, at gene <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e301" xlink:type="simple"/></inline-formula>, one fixes <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e302" xlink:type="simple"/></inline-formula>, and so on. This procedure ensures that the absolute value of the relative phases between gene 1 and all other genes is approximatively correct. The main drawback is that the procedure does not prescribe the sign of the relative phases. In practice, we used this protocol twice to get two distinct initial sets of phases. To obtain the second set, we fixed <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e303" xlink:type="simple"/></inline-formula>, and considered the vector <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e304" xlink:type="simple"/></inline-formula>.</p>
</list-item><list-item>
<p>In the second approach, we tried to approximate the relative phases rather than their absolute values. The initial parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e305" xlink:type="simple"/></inline-formula> are chosen such that the matrix made of elements <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e306" xlink:type="simple"/></inline-formula> has the largest scalar product with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e307" xlink:type="simple"/></inline-formula>, specifically, we required that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e308" xlink:type="simple"/></inline-formula> be maximized. In practice, approach (b) tended to fare better than (a).</p>
</list-item></list>
<p>Results of optimization using approaches (a) and (b) to set initial parameter values are shown in <xref ref-type="fig" rid="pcbi-1000979-g008">Fig. 8A</xref>. The results in <xref ref-type="fig" rid="pcbi-1000979-g008">Fig. 8A</xref> are nearly indistinguishable from those obtained using the true parameters as initial conditions, shown in <xref ref-type="fig" rid="pcbi-1000979-g008">Fig. 8B</xref>, demonstrating that the above protocols performs well in identifying the global maximum of the likelihood.</p>
<fig id="pcbi-1000979-g008" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000979.g008</object-id><label>Figure 8</label><caption>
<title>Quantification of the algorithm used to find the global maximum of the likelihood.</title>
<p>Mean reconstruction error <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e309" xlink:type="simple"/></inline-formula> averaged over 20 realizations as the number genes <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e310" xlink:type="simple"/></inline-formula> and the number of FISH observations per gene pair <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e311" xlink:type="simple"/></inline-formula> are varied for (A) the protocol described in the text and (B) for the global maximum, as shown in <xref ref-type="fig" rid="pcbi-1000979-g002">Fig. 2B</xref>, found by taking the parameters describing the true dynamics as initial parameters for the maximization. Results in (A) and (B) are very similar, indicating that the protocol described above generally finds the global maximum.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000979.g008" xlink:type="simple"/></fig></sec></sec><sec id="s4">
<title>Discussion</title>
<p>The ability to count mRNA molecules in single cells by Fluorescence In Situ Hybridization (FISH) <xref ref-type="bibr" rid="pcbi.1000979-Femino1">[9]</xref>–<xref ref-type="bibr" rid="pcbi.1000979-Zenklusen1">[11]</xref> allows for highly quantitative studies of cell-to-cell variation in gene expression. However, the requirement that cells be fixed before RNA FISH analysis precludes the use of RNA FISH to directly study transcriptional dynamics in single cells. Nevertheless, we have shown here how and when correlations between levels of different mRNAs can be exploited to reconstruct transcriptional dynamics, even if cells are asynchronous. All that is necessary is for FISH data to be obtained simultaneously for pairs of genes (or in some cases triplets of genes) a technique that is already well established <xref ref-type="bibr" rid="pcbi.1000979-Raj1">[10]</xref>, <xref ref-type="bibr" rid="pcbi.1000979-Levsky1">[12]</xref>. As a practical demonstration, we applied our approach to a large, pairwise FISH data set obtained from a recent study of the yeast <italic>Saccharomyces cerevisiae</italic> <xref ref-type="bibr" rid="pcbi.1000979-Silverman1">[14]</xref>. Our results help confirm the existence of cell-autonomous metabolic cycles in unsynchronized yeast populations <xref ref-type="bibr" rid="pcbi.1000979-Tu1">[13]</xref>.</p>
<p>To reconstruct the dynamics of gene expression from FISH data, our approach employs Maximum Likelihood Estimation (MLE) <xref ref-type="bibr" rid="pcbi.1000979-Edwards1">[20]</xref> to obtain the set of transcriptional parameters most likely to account for the observed data. In the regime of continuous mRNA production, apart from rescaling and inversion of time for cyclic dynamics, there is no intrinsic limit on the accuracy with which transcriptional dynamics can be reconstructed given enough data. In practice, we have shown that MLE applied to simple parameterizations for transcription (such as the leading harmonics for cyclic dynamics) allows faithful reconstruction from a moderate number of FISH observations, including noise. On the other hand, the regime where mRNA is produced in shortlived bursts <xref ref-type="bibr" rid="pcbi.1000979-Raj1">[10]</xref> presents additional challenges. In this bursty regime, FISH can at most report coincidences of bursts of different mRNAs, and there are consequently fundamental limits to reconstructing the underlying dynamics. For this bursty regime, successful reconstruction will generally rely on prior knowledge regarding the class of dynamics, <italic>e.g.</italic> cycle vs. switch, and, even so, will in some cases require additional inputs, such as triplet FISH data. (In <xref ref-type="supplementary-material" rid="pcbi.1000979.s002">Table S1</xref>, we explicitly quantify the amount of such additional information required for complete dynamical reconstruction.)</p>
<p>In applying our approach, how should one choose among models to reconstruct gene dynamics? For example, when is it better to use multiple harmonics instead of a single harmonic to model a cycle? The answer depends on the type of data. We discuss first the regime of continuous mRNA production. For this case, a standard and reliable way to choose among models when fitting data is “leave-one-out” validation, which both rewards a good fit while punishing overfitting. In the leave-one-out approach, a model is selected and its parameters are optimized on the entire data set, but with one data point left out. The resulting parameterized model is then used to fit the neglected data point. The average fitting error, taken over all possible left-out data points, is a robust measure of the quality of the model. Among competing models, the one that minimizes this error can be selected as the better choice. In the regime of continuous mRNA production, leave-one-out validation can be applied within the MLE framework by using the log(likelihood) of the left-out data point in place of the fitting error. Among competing models, the one with the largest average log(likelihood) is the best choice.</p>
<p>In contrast, finding the “best” model for data in the bursty mRNA regime is generally an under-constrained problem. We showed explicitly that for many cases it is impossible in principle to distinguish among different types of models, or even to find a unique best set of parameters for a given model. Intuitively, reduction of bursty FISH data to pairwise covariances means that even as the number of FISH data points approaches infinity, the number of model constraints stays finite. So, for bursty FISH data inference alone cannot guide one in choosing the model, and one must also use common sense. Clearly, prior knowledge of the system under study should be used in selecting a model. In addition, a simple rule is that one should use models that are sufficiently parsimonious in parameters not to have degenerate solutions. For example, in analyzing FISH data on metabolic cycles, we chose the one-harmonic model because there were not enough low-noise covariances to constrain a two-harmonic model. More generally, it is advisable to choose a model with significantly more well-constrained data than parameters. If the model is barely constrained, the peak of likelihood will generally be close to flat in some directions in parameter space and the reconstruction will be poor. <xref ref-type="fig" rid="pcbi-1000979-g004">Figure 4</xref> illustrates this point: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e312" xlink:type="simple"/></inline-formula> is the minimal number of genes to avoid degeneracy, but it requires 3 times more data per gene (or twice as many total data points) to reconstruct as well as for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e313" xlink:type="simple"/></inline-formula>. In practice, one test for the quality of the reconstruction in the bursty regime is to compare the observed covariances to the reconstructed covariances, as shown in <xref ref-type="fig" rid="pcbi-1000979-g007">Fig. 7</xref> for the case of the yeast metabolic cycle genes.</p>
<p>Reconstruction of gene-expression dynamics from FISH data presents multiple practical challenges. One important issue is noise in the measurement of mRNA levels. For the regime of continuous mRNA production, we have shown that sufficient data can compensate for both the noise inherent in gene expression and the noise arising from uncertainty in measurement. For the regime of bursty mRNA production, “binarizing” the data into the presence or absence of a significant number of mRNA molecules substantially reduces the impact of measurement noise. A practical question here is the best threshold to use for binarizing the data. In many cases, the dynamics will be best reconstructed by setting the threshold well above 1 mRNA transcript; for example, in treating the data for metabolic cycles we chose the median expression level for each gene as its threshold. A higher threshold is less sensitive to measurement noise (fewer false positives), and to occasional transcripts produced by promoter leakage (better identification of true bursts), and a higher threshold also allows finer time resolution, as a given burst will remain above threshold for a shorter time (<italic>e.g.</italic> preventing blurring of boundaries between switching states). However, a higher threshold reduces the number of coinciding bursts in the data, requiring more overall FISH observations. An important related issue is the possibility of correlated noise in the transcription of different genes. An example of such noise is the observed global correlation among transcription rates in yeast <xref ref-type="bibr" rid="pcbi.1000979-Raser1">[25]</xref>. Fortunately, global noise can be readily incorporated within the MLE framework by introducing a single additional variable in the model for gene expression, as in Eq. (10). Indeed, our treatment of global noise among genes involved in the yeast metabolic cycle yields an independent, and reasonable, estimate for this noise at 55% of mean expression. (More complex noise correlations among different genes would require case-by-case analysis.)</p>
<p>False-positive rates and false-negative rates are also both important considerations in analyzing FISH data. These are essentially technical issues beyond the scope of our study, but a few remarks are in order. In Ref. <xref ref-type="bibr" rid="pcbi.1000979-Silverman1">[14]</xref>, both false positives and false negatives were reduced by the use of multiple fluorescent probes (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000979.e314" xlink:type="simple"/></inline-formula>5) for each mRNA. Only high-contrast spots above a fluorescence threshold indicative of multiple bound probes were counted. This threshold was set empirically from the fluorescence distribution of spots outside of cell boundaries, corresponding to single probes. Nevertheless, with any such thresholding method, there will be cases where the “presence” or “absence” of an mRNA is ambiguous, and in the bursty regime such ambiguities can strongly impact the binarization of the data. Fortunately, because MLE is an intrinsically probabilistic approach, ambiguities can be dealt with by treating the two possibilities, present or absent, probabilistically. As in Ref. <xref ref-type="bibr" rid="pcbi.1000979-Silverman1">[14]</xref>, by looking at spots outside of cell boundaries, one can obtain the distribution of intensities for spots that are actually noise (typically single probes that have not been washed away), and by looking inside cell boundaries a similar distribution can be obtained for spots that correspond to real mRNAs (multiple probes). Spots inside cells that fall into the region of overlap of these two distributions can then be assigned the corresponding probabilities of being present (real) or absent (noise). MLE can then incorporate both possible interpretations of the data, with their appropriate weights, in the data set.</p>
<p>A related issue, highlighted by Zenklusen <italic>et al.</italic> <xref ref-type="bibr" rid="pcbi.1000979-Zenklusen1">[11]</xref>, is the existence of nascent mRNA transcripts at the locus of the gene. In the regime of continuous mRNA production, an estimate of nascent transcript number, possibly non-integer, could simply be added to mRNA counts. In the bursty regime, the existence of such transcripts might well be taken as <italic>prima facie</italic> evidence for active transcription, and therefore treated as equivalent to the presence of an above-threshold burst.</p>
<p>Another practical issue in reconstructing gene-expression dynamics from FISH measurements is that data may come in mixed forms, <italic>e.g.</italic> pairwise FISH data+triplet FISH data+additional constraints or prior information. Again, MLE is naturally suited to incorporating mixed data types since all sources of information can be combined to produce the overall likelihood of the data given a set of model parameters, including prior information on the model parameters themselves (<italic>cf.</italic> Eq. (2)).</p>
<p>While these and other practical issues are important to consider, our successful reconstruction of yeast metabolic cycles using the FISH data of Silverman <italic>et al.</italic> <xref ref-type="bibr" rid="pcbi.1000979-Silverman1">[14]</xref> demonstrates that our approach can provide a useful tool for analyzing gene-expression dynamics. In fact, our analysis of this data raises several new questions. First, since our reconstruction was statistically significant for the Oxidative and Reductive Building clusters but not for the Reductive Charging cluster, it is possible that cycles of the latter may be weaker in unsynchronized cultures than in synchronized chemostats. Second, our reconstruction indicates a spread among the oscillatory phases of genes within each cluster – is this spread a consequence of the limited data, or are the oscillation patterns of genes within clusters distinct? We expect that additional FISH data coupled with MLE analysis will soon provide answers to these questions.</p>
<p>The many advantages of FISH – absolute quantification, high time resolution, use of wild-type cells, ability to simultaneously measure multiple mRNA types, and broad application across species from bacteria <xref ref-type="bibr" rid="pcbi.1000979-Zwirglmaier1">[28]</xref> to yeast <xref ref-type="bibr" rid="pcbi.1000979-Zenklusen1">[11]</xref>, <xref ref-type="bibr" rid="pcbi.1000979-Silverman1">[14]</xref> to metazoans <xref ref-type="bibr" rid="pcbi.1000979-Femino1">[9]</xref>, <xref ref-type="bibr" rid="pcbi.1000979-Raj1">[10]</xref>, suggest that FISH will find many uses in future studies of gene expression, including applications beyond those currently demonstrated. For example, FISH can be applied to cells in structured environments such as tissues or biofilms, or even cells in mixed-species consortia. In all of these cases, population level studies of gene expression cannot reveal the important cell-to-cell variations. Of course, FISH is not the only technique that yields quantitative snapshots at the single-cell level. Immunofluorescence and single-cell sequencing also meet the requirements of simultaneous measurements of two or more intracellular factors. We hope that the analysis presented here can facilitate the application of FISH and other single-cell snapshot assays to cases where both cell-to-cell variation and the dynamics of gene expression are of central interest.</p>
</sec><sec id="s5">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1000979.s001" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000979.s001" xlink:type="simple"><label>Figure S1</label><caption>
<p>Average cluster activities Q<sub>j</sub>(t)as defined in the text, taking into account the presence of global transcriptional noise.</p>
<p>(0.96 MB TIF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000979.s002" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000979.s002" xlink:type="simple"><label>Table S1</label><caption>
<p>Rank of covariance matrix and required number of additional constraints (obtained from triplet-FISH measurements or other sources) necessary for complete parameter inference in the regime of bursty mRNA production, for both cyclic and stochastic switching dynamics.</p>
<p>(0.44 MB TIF)</p>
</caption></supplementary-material></sec></body>
<back>
<ack>
<p>We thank the members of the Botstein lab for very valuable discussions.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1000979-Suel1"><label>1</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Suel</surname><given-names>GM</given-names></name>
<name name-style="western"><surname>Garcia-Ojalvo</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Liberman</surname><given-names>LM</given-names></name>
<name name-style="western"><surname>Elowitz</surname><given-names>MB</given-names></name>
</person-group>             <year>2006</year>             <article-title>An excitable gene regulatory circuit induces transient cellular differentiation.</article-title>             <source>Nature</source>             <volume>440</volume>             <fpage>545</fpage>          </element-citation></ref>
<ref id="pcbi.1000979-Maamar1"><label>2</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Maamar</surname><given-names>H</given-names></name>
<name name-style="western"><surname>Raj</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Dubnau</surname><given-names>D</given-names></name>
</person-group>             <year>2007</year>             <article-title>Noise in gene expression determines cell fate in Bacillus subtilis.</article-title>             <source>Science</source>             <volume>317</volume>             <fpage>526</fpage>          </element-citation></ref>
<ref id="pcbi.1000979-Vlamakis1"><label>3</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Vlamakis</surname><given-names>H</given-names></name>
<name name-style="western"><surname>Aguilar</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Losick</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Kolter</surname><given-names>R</given-names></name>
</person-group>             <year>2008</year>             <article-title>Control of cell fate by the formation of an architecturally complex bacterial community.</article-title>             <source>Genes Dev</source>             <volume>22</volume>             <fpage>945</fpage>          </element-citation></ref>
<ref id="pcbi.1000979-Novick1"><label>4</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Novick</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Weiner</surname><given-names>M</given-names></name>
</person-group>             <year>1957</year>             <article-title>Enzyme induction as an all-or-none phenomenom.</article-title>             <source>Proc Natl Acad Sci USA</source>             <volume>43</volume>             <fpage>553</fpage>          </element-citation></ref>
<ref id="pcbi.1000979-Ozbudak1"><label>5</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Ozbudak</surname><given-names>EM</given-names></name>
<name name-style="western"><surname>Thattai</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Lim</surname><given-names>HN</given-names></name>
<name name-style="western"><surname>Shraiman</surname><given-names>BI</given-names></name>
<name name-style="western"><surname>Van Oudenaarden</surname><given-names>A</given-names></name>
</person-group>             <year>2004</year>             <article-title>Multistability in the lactose utilization network of Escherichia coli.</article-title>             <source>Nature</source>             <volume>427</volume>             <fpage>737</fpage>          </element-citation></ref>
<ref id="pcbi.1000979-Hartwell1"><label>6</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Hartwell</surname><given-names>LH</given-names></name>
<name name-style="western"><surname>Culotti</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Reid</surname><given-names>B</given-names></name>
</person-group>             <year>1970</year>             <article-title>Genetic control of the cell-division cycle in yeast. I. Detection of mutants.</article-title>             <source>Proc Natl Acad Sci USA</source>             <volume>66</volume>             <fpage>352</fpage>          </element-citation></ref>
<ref id="pcbi.1000979-Hartwell2"><label>7</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Hartwell</surname><given-names>LH</given-names></name>
<name name-style="western"><surname>Mortimer</surname><given-names>RK</given-names></name>
<name name-style="western"><surname>Culotti</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Culotti</surname><given-names>M</given-names></name>
</person-group>             <year>1973</year>             <article-title>Genetic control of the cell division cycle in yeast: V. Genetic analysis of cdc mutants.</article-title>             <source>Proc Natl Acad Sci USA</source>             <volume>74</volume>             <fpage>267</fpage>          </element-citation></ref>
<ref id="pcbi.1000979-Dubnau1"><label>8</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Dubnau</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Losick</surname><given-names>R</given-names></name>
</person-group>             <year>2006</year>             <article-title>Bistability in bacteria.</article-title>             <source>Mol Micro</source>             <volume>61</volume>             <fpage>564</fpage>          </element-citation></ref>
<ref id="pcbi.1000979-Femino1"><label>9</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Femino</surname><given-names>AM</given-names></name>
<name name-style="western"><surname>Fay</surname><given-names>FS</given-names></name>
<name name-style="western"><surname>Fogarty</surname><given-names>K</given-names></name>
<name name-style="western"><surname>Singer</surname><given-names>RH</given-names></name>
</person-group>             <year>1998</year>             <article-title>Visualization of single RNA transcripts in situ.</article-title>             <source>Science</source>             <volume>280</volume>             <fpage>585</fpage>          </element-citation></ref>
<ref id="pcbi.1000979-Raj1"><label>10</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Raj</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Peskin</surname><given-names>CS</given-names></name>
<name name-style="western"><surname>Tranchina</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Vargas</surname><given-names>DY</given-names></name>
<name name-style="western"><surname>Tyagi</surname><given-names>S</given-names></name>
</person-group>             <year>2006</year>             <article-title>Stochastic mRNA synthesis in mammalian cells.</article-title>             <source>PLoS Biol</source>             <volume>10</volume>             <fpage>309</fpage>          </element-citation></ref>
<ref id="pcbi.1000979-Zenklusen1"><label>11</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Zenklusen</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Larson</surname><given-names>DR</given-names></name>
<name name-style="western"><surname>Singer</surname><given-names>RH</given-names></name>
</person-group>             <year>2008</year>             <article-title>Single-RNA counting reveals alternative modes of gene expression in yeast.</article-title>             <source>Nat Struct Mol Biol</source>             <volume>5</volume>             <fpage>1263</fpage>          </element-citation></ref>
<ref id="pcbi.1000979-Levsky1"><label>12</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Levsky</surname><given-names>JM</given-names></name>
<name name-style="western"><surname>Shenoy</surname><given-names>SM</given-names></name>
<name name-style="western"><surname>Pezo</surname><given-names>RC</given-names></name>
<name name-style="western"><surname>Singer</surname><given-names>RH</given-names></name>
</person-group>             <year>2002</year>             <article-title>Single-cell gene expression profiling.</article-title>             <source>Science</source>             <volume>297</volume>             <fpage>836</fpage>          </element-citation></ref>
<ref id="pcbi.1000979-Tu1"><label>13</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Tu</surname><given-names>BP</given-names></name>
<name name-style="western"><surname>Kudlicki</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Rowicka</surname><given-names>M</given-names></name>
<name name-style="western"><surname>McKnight</surname><given-names>SL</given-names></name>
</person-group>             <year>2005</year>             <article-title>Logic of the yeast metabolic cycle: temporal compartmentalization of cellular processes.</article-title>             <source>Science</source>             <volume>310</volume>             <fpage>1152</fpage>          </element-citation></ref>
<ref id="pcbi.1000979-Silverman1"><label>14</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Silverman</surname><given-names>SJ</given-names></name>
<name name-style="western"><surname>Petti</surname><given-names>AA</given-names></name>
<name name-style="western"><surname>Slavov</surname><given-names>N</given-names></name>
<name name-style="western"><surname>Parsons</surname><given-names>L</given-names></name>
<name name-style="western"><surname>Briehof</surname><given-names>R</given-names></name>
<etal/></person-group>             <year>2010</year>             <article-title>Metabolic cycling in single yeast cells from unsynchronized steady-state populations limited on glucose or phosphate.</article-title>             <source>Proc Natl Acad Sci USA</source>             <volume>107</volume>             <fpage>6946</fpage>          </element-citation></ref>
<ref id="pcbi.1000979-Friedman1"><label>15</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Friedman</surname><given-names>N</given-names></name>
<name name-style="western"><surname>Vardi</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Ronen</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Alon</surname><given-names>U</given-names></name>
<name name-style="western"><surname>Stavans</surname><given-names>J</given-names></name>
</person-group>             <year>2005</year>             <article-title>Precise temporal modulation in the response of the SOS DNA repair network in individual bacteria.</article-title>             <source>PLoS Biol</source>             <volume>3</volume>             <fpage>1261</fpage>          </element-citation></ref>
<ref id="pcbi.1000979-GevaZatorsky1"><label>16</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Geva-Zatorsky</surname><given-names>N</given-names></name>
<name name-style="western"><surname>Rosenfeld</surname><given-names>N</given-names></name>
<name name-style="western"><surname>Itzkovitz</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Milo</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Sigal</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Dekel</surname><given-names>E</given-names></name>
<etal/></person-group>             <year>2006</year>             <article-title>Oscillations and variability in the p53 system.</article-title>             <source>Mol Syst Biol</source>             <volume>2</volume>             <fpage>1</fpage>          </element-citation></ref>
<ref id="pcbi.1000979-Balaban1"><label>17</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Balaban</surname><given-names>NQ</given-names></name>
<name name-style="western"><surname>Merrin</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Chait</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Kowalik</surname><given-names>L</given-names></name>
<name name-style="western"><surname>Leibler</surname><given-names>S</given-names></name>
</person-group>             <year>2004</year>             <article-title>Bacterial persistence as a phenotypic switch.</article-title>             <source>Science</source>             <volume>305</volume>             <fpage>1622</fpage>          </element-citation></ref>
<ref id="pcbi.1000979-Sureka1"><label>18</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Sureka</surname><given-names>K</given-names></name>
<name name-style="western"><surname>Ghosh</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Dasgupta</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Basu</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Kundu</surname><given-names>M</given-names></name>
<etal/></person-group>             <year>2008</year>             <article-title>Positive feedback and noise activate the stringent response regulator <italic>rel</italic> in mycobacteria.</article-title>             <source>PLoS One</source>             <volume>3</volume>             <fpage>1</fpage>          </element-citation></ref>
<ref id="pcbi.1000979-Acar1"><label>19</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Acar</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Becskei</surname><given-names>A</given-names></name>
<name name-style="western"><surname>van Oudenaarden</surname><given-names>A</given-names></name>
</person-group>             <year>2005</year>             <article-title>Enhancement of cellular memory by reducing stochastic transitions.</article-title>             <source>Nature</source>             <volume>435</volume>             <fpage>228</fpage>          </element-citation></ref>
<ref id="pcbi.1000979-Edwards1"><label>20</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Edwards</surname><given-names>AWF</given-names></name>
</person-group>             <year>1972</year>             <source>Likelihood</source>             <publisher-name>Cambridge University Press, Cambridge</publisher-name>          </element-citation></ref>
<ref id="pcbi.1000979-Felsenstein1"><label>21</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Felsenstein</surname><given-names>J</given-names></name>
</person-group>             <year>1981</year>             <article-title>Evolutionary trees from DNA sequences: a maximum likelihood approach.</article-title>             <source>J Mol Evol</source>             <volume>17</volume>             <fpage>368</fpage>          </element-citation></ref>
<ref id="pcbi.1000979-Whelan1"><label>22</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Whelan</surname><given-names>S</given-names></name>
</person-group>             <year>2008</year>             <article-title>Inferring trees.</article-title>             <source>Methods Mol Biol</source>             <volume>452</volume>             <fpage>287</fpage>          </element-citation></ref>
<ref id="pcbi.1000979-Thompson1"><label>23</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Thompson</surname><given-names>R</given-names></name>
</person-group>             <year>2008</year>             <article-title>Estimation of quantitative genetic parameters.</article-title>             <source>Proc Biol Sci</source>             <volume>275</volume>             <fpage>679</fpage>          </element-citation></ref>
<ref id="pcbi.1000979-Carmel1"><label>24</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Carmel</surname><given-names>L</given-names></name>
<name name-style="western"><surname>Rogozin</surname><given-names>IB</given-names></name>
<name name-style="western"><surname>Wolf</surname><given-names>YI</given-names></name>
<name name-style="western"><surname>Koonin</surname><given-names>EV</given-names></name>
</person-group>             <year>2009</year>             <article-title>A maximum likelihood method for reconstruction of the evolution of eukaryotic gene structure.</article-title>             <source>Methods Mol Biol</source>             <volume>541</volume>             <fpage>357</fpage>          </element-citation></ref>
<ref id="pcbi.1000979-Raser1"><label>25</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Raser</surname><given-names>JM</given-names></name>
<name name-style="western"><surname>O'Shea</surname><given-names>EK</given-names></name>
</person-group>             <year>2004</year>             <article-title>Control of stochasticity in eukaryotic gene expression.</article-title>             <source>Science</source>             <volume>304</volume>             <fpage>1811</fpage>          </element-citation></ref>
<ref id="pcbi.1000979-Do1"><label>26</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Do</surname><given-names>CB</given-names></name>
<name name-style="western"><surname>Batzoglou</surname><given-names>S</given-names></name>
</person-group>             <year>2008</year>             <article-title>What is the expectation maximization algorithm?</article-title>             <source>Nat Biotechnol</source>             <volume>26</volume>             <fpage>897</fpage>          </element-citation></ref>
<ref id="pcbi.1000979-Tu2"><label>27</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Tu</surname><given-names>BP</given-names></name>
<name name-style="western"><surname>Mohler</surname><given-names>RE</given-names></name>
<name name-style="western"><surname>Liu</surname><given-names>JC</given-names></name>
<name name-style="western"><surname>Dombek</surname><given-names>KM</given-names></name>
<name name-style="western"><surname>Young</surname><given-names>ET</given-names></name>
<etal/></person-group>             <year>2007</year>             <article-title>Cyclic changes in metabolic state during the life of a yeast cell.</article-title>             <source>Proc Natl Acad Sci USA</source>             <volume>104</volume>             <fpage>16886</fpage>          </element-citation></ref>
<ref id="pcbi.1000979-Zwirglmaier1"><label>28</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Zwirglmaier</surname><given-names>K</given-names></name>
<name name-style="western"><surname>Fichtl</surname><given-names>K</given-names></name>
<name name-style="western"><surname>Ludwig</surname><given-names>W</given-names></name>
</person-group>             <year>2005</year>             <article-title>In situ functional gene analysis: recognition of individual genes by fluorescence in situ hybridization.</article-title>             <source>Methods Enzymol</source>             <volume>397</volume>             <fpage>338</fpage>          </element-citation></ref>
</ref-list>

</back>
</article>