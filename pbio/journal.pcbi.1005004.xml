<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article article-type="research-article" dtd-version="1.1d3" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1005004</article-id>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-15-01201</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Neurons</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cellular neuroscience</subject><subj-group><subject>Neurons</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Brain</subject><subj-group><subject>Basal ganglia</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Brain</subject><subj-group><subject>Basal ganglia</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Neural networks</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neural networks</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Brain</subject><subj-group><subject>Neostriatum</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Brain</subject><subj-group><subject>Neostriatum</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Neurology</subject><subj-group><subject>Neurodegenerative diseases</subject><subj-group><subject>Movement disorders</subject><subj-group><subject>Parkinson disease</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Chemistry</subject><subj-group><subject>Chemical compounds</subject><subj-group><subject>Organic compounds</subject><subj-group><subject>Amines</subject><subj-group><subject>Catecholamines</subject><subj-group><subject>Dopamine</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Chemistry</subject><subj-group><subject>Organic chemistry</subject><subj-group><subject>Organic compounds</subject><subj-group><subject>Amines</subject><subj-group><subject>Catecholamines</subject><subj-group><subject>Dopamine</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Neurochemistry</subject><subj-group><subject>Neurotransmitters</subject><subj-group><subject>Biogenic amines</subject><subj-group><subject>Catecholamines</subject><subj-group><subject>Dopamine</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neurochemistry</subject><subj-group><subject>Neurotransmitters</subject><subj-group><subject>Biogenic amines</subject><subj-group><subject>Catecholamines</subject><subj-group><subject>Dopamine</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Hormones</subject><subj-group><subject>Catecholamines</subject><subj-group><subject>Dopamine</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cognitive science</subject><subj-group><subject>Cognition</subject><subj-group><subject>Decision making</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Mathematical and statistical techniques</subject><subj-group><subject>Mathematical functions</subject><subj-group><subject>Curve fitting</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Properties of Neurons in External Globus Pallidus Can Support Optimal Action Selection</article-title>
<alt-title alt-title-type="running-head">Pallidal Neurons Support Optimal Action Selection</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Bogacz</surname>
<given-names>Rafal</given-names>
</name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Martin Moraud</surname>
<given-names>Eduardo</given-names>
</name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Abdi</surname>
<given-names>Azzedine</given-names>
</name>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Magill</surname>
<given-names>Peter J.</given-names>
</name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Baufreton</surname>
<given-names>Jérôme</given-names>
</name>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
</contrib>
</contrib-group>
<aff id="aff001"><label>1</label> <addr-line>Medical Research Council Brain Network Dynamics Unit, Department of Pharmacology, University of Oxford, Oxford, United Kingdom</addr-line></aff>
<aff id="aff002"><label>2</label> <addr-line>Nuffield Department of Clinical Neurosciences, University of Oxford, Oxford, United Kingdom</addr-line></aff>
<aff id="aff003"><label>3</label> <addr-line>Univ. Bordeaux, Institut des Maladies Neurodégénératives, UMR 5293, Bordeaux, France</addr-line></aff>
<aff id="aff004"><label>4</label> <addr-line>CNRS, Institut des Maladies Neurodégénératives, UMR 5293, Bordeaux, France</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Blackwell</surname>
<given-names>Kim T.</given-names>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1"><addr-line>George Mason University, UNITED STATES</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con" id="contrib001">
<p>Conceived and designed the experiments: JB PJM. Performed the experiments: AA JB. Analyzed the data: RB EMM AA PJM JB. Wrote the paper: RB EMM PJM JB. Developed computational model: RB EMM.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">rafal.bogacz@ndcn.ox.ac.uk</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<day>7</day>
<month>7</month>
<year>2016</year>
</pub-date>
<pub-date pub-type="collection">
<month>7</month>
<year>2016</year>
</pub-date>
<volume>12</volume>
<issue>7</issue>
<elocation-id>e1005004</elocation-id>
<history>
<date date-type="received">
<day>17</day>
<month>7</month>
<year>2015</year>
</date>
<date date-type="accepted">
<day>2</day>
<month>6</month>
<year>2016</year>
</date>
</history>
<permissions>
<copyright-year>2016</copyright-year>
<copyright-holder>Bogacz et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1005004"/>
<abstract>
<p>The external globus pallidus (GPe) is a key nucleus within basal ganglia circuits that are thought to be involved in action selection. A class of computational models assumes that, during action selection, the basal ganglia compute for all actions available in a given context the probabilities that they should be selected. These models suggest that a network of GPe and subthalamic nucleus (STN) neurons computes the normalization term in Bayes’ equation. In order to perform such computation, the GPe needs to send feedback to the STN equal to a particular function of the activity of STN neurons. However, the complex form of this function makes it unlikely that individual GPe neurons, or even a single GPe cell type, could compute it. Here, we demonstrate how this function could be computed within a network containing two types of GABAergic GPe projection neuron, so-called ‘prototypic’ and ‘arkypallidal’ neurons, that have different response properties <italic>in vivo</italic> and distinct connections. We compare our model predictions with the experimentally-reported connectivity and input-output functions (f-I curves) of the two populations of GPe neurons. We show that, together, these dichotomous cell types fulfil the requirements necessary to compute the function needed for optimal action selection. We conclude that, by virtue of their distinct response properties and connectivities, a network of arkypallidal and prototypic GPe neurons comprises a neural substrate capable of supporting the computation of the posterior probabilities of actions.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>Choosing an appropriate action as quickly and accurately as possible in a given situation is critical for the survival of animals and humans. One of the brain regions involved in action selection is a set of subcortical nuclei known as the basal ganglia. The importance of understanding information processing in the basal ganglia is further emphasised by the fact that their disturbed interactions in Parkinson’s disease results in profound difficulties in movement. Computational models have suggested how the basal ganglia could select actions in the fastest possible way for the required accuracy level. These models further predict that a part of basal ganglia, called the external globus pallidus (GPe), needs to calculate a particular function of its inputs. This paper proposes how this function could be computed in a mathematical model of a network within GPe. Furthermore, it shows that the experimentally observed connectivity and response properties of GPe neurons fulfil the requirements necessary to support optimal action selection. This suggests the GPe neurons have properties that allow them to contribute to optimal action selection in the whole basal ganglia.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100000266</institution-id>
<institution>Engineering and Physical Sciences Research Council</institution>
</institution-wrap>
</funding-source>
<award-id>EP/I032622/1</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Bogacz</surname>
<given-names>Rafal</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100000265</institution-id>
<institution>Medical Research Council</institution>
</institution-wrap>
</funding-source>
<award-id>MC_UU_12024/5</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Bogacz</surname>
<given-names>Rafal</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award003">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100000265</institution-id>
<institution>Medical Research Council</institution>
</institution-wrap>
</funding-source>
<award-id>MC_UU_12024/2</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Magill</surname>
<given-names>Peter J.</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award004">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100004440</institution-id>
<institution>Wellcome Trust</institution>
</institution-wrap>
</funding-source>
<award-id>101821</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Magill</surname>
<given-names>Peter J.</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award005">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001665</institution-id>
<institution>Agence Nationale de la Recherche</institution>
</institution-wrap>
</funding-source>
<award-id>08-JCJC 0087</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Baufreton</surname>
<given-names>Jérôme</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award006">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100004794</institution-id>
<institution>Centre National de la Recherche Scientifique</institution>
</institution-wrap>
</funding-source>
<principal-award-recipient>
<name name-style="western">
<surname>Baufreton</surname>
<given-names>Jérôme</given-names>
</name>
</principal-award-recipient>
</award-group>
<funding-statement>This work was supported by Engineering and Physical Sciences Research Council (grant EP/I032622/1 to RB), the Medical Research Council UK (MC_UU_12024/5 to RB and MC_UU_12024/2 to PJM), the Wellcome Trust (Investigator Award 101821 to PJM), Association France Parkinson Ph.D. fellowship to AA, Fondation de France (grant 2015 0006940 to JB), Agence Nationale de la Recherche (grants 08-JCJC 0087 and ANR-15-CE37-0006 to JB), and Grant LABEX BRAIN (ANR-10-LABX-43 to JB). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="8"/>
<table-count count="0"/>
<page-count count="28"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant data are within the Supporting Information files.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>A set of subcortical brain nuclei known as the basal ganglia are thought to be involved in action selection [<xref ref-type="bibr" rid="pcbi.1005004.ref001">1</xref>]. The external globus pallidus (GPe; sometimes referred to as simply the ‘globus pallidus’ in rodents) plays an important role within the basal ganglia, in part because it is an ‘integrative hub’ that is connected to all other nuclei in these circuits [<xref ref-type="bibr" rid="pcbi.1005004.ref002">2</xref>,<xref ref-type="bibr" rid="pcbi.1005004.ref003">3</xref>]. The function of the GPe within the basal ganglia has been conceptualized in many computational models [<xref ref-type="bibr" rid="pcbi.1005004.ref004">4</xref>–<xref ref-type="bibr" rid="pcbi.1005004.ref008">8</xref>]. A class of models [<xref ref-type="bibr" rid="pcbi.1005004.ref009">9</xref>–<xref ref-type="bibr" rid="pcbi.1005004.ref012">12</xref>] suggests that, during selection of the most appropriate action, cortico-basal ganglia circuits approximate a statistical procedure known as the Multihypothesis Sequential Probability Ratio Test (MSPRT) [<xref ref-type="bibr" rid="pcbi.1005004.ref013">13</xref>]. These models assume the basal ganglia continuously update the probabilities of different actions being appropriate given sensory signals, and that an action is initiated whenever its corresponding probability exceeds a threshold of confidence. Such a procedure for making decisions has been shown analytically to yield the fastest possible choices for a given accuracy level, when the accuracy level approaches 100% [<xref ref-type="bibr" rid="pcbi.1005004.ref014">14</xref>], and in simulations with lower accuracy, the MSPRT makes faster or equally fast choices compared to other decision algorithms [<xref ref-type="bibr" rid="pcbi.1005004.ref015">15</xref>]. For brevity, we will refer to this property as the ‘optimal action selection’.</p>
<p>The optimal action selection models [<xref ref-type="bibr" rid="pcbi.1005004.ref009">9</xref>–<xref ref-type="bibr" rid="pcbi.1005004.ref012">12</xref>] assume that the GPe together with the subthalamic nucleus (STN), another basal ganglia nucleus, compute the normalization term from the equation of Bayes’ theorem. This normalization ensures that the probabilities represented in the basal ganglia add up to 1 across all actions. Hence the normalization computed by the STN-GPe network mediates the competition between actions by ensuring that an action is only selected when there is high evidence for it relative to the other options (this normalization is also critical to implement the MSPRT procedure, where the actual probabilities are compared against the threshold; thus, to perform MSPRT, it is not sufficient to just know the relative probabilities, as proposed in other Bayesian models [<xref ref-type="bibr" rid="pcbi.1005004.ref016">16</xref>]). The optimal action selection models have predicted that, in order to compute the normalization, the GPe needs to send feedback to the STN that is proportional to a particular function of STN activity (we review this function in detail below). However, because of the complex form of this function, it is not clear whether GPe neurons could compute it, and thus whether the basal ganglia could approximate the optimal action selection. The goal of this paper is to refine the mapping of the Bayes’ equation on the basal ganglia anatomy by taking into account new insights into GPe cell types, and investigate whether the GPe could compute this function.</p>
<p>In previous models of action selection in basal ganglia, it has been widely assumed that GPe neurons are homogenous in form and function [<xref ref-type="bibr" rid="pcbi.1005004.ref004">4</xref>–<xref ref-type="bibr" rid="pcbi.1005004.ref006">6</xref>,<xref ref-type="bibr" rid="pcbi.1005004.ref009">9</xref>,<xref ref-type="bibr" rid="pcbi.1005004.ref011">11</xref>,<xref ref-type="bibr" rid="pcbi.1005004.ref012">12</xref>,<xref ref-type="bibr" rid="pcbi.1005004.ref017">17</xref>]. However, recent work shows that the GABAergic projection neurons of the GPe can be divided into two main cell types, namely arkypallidal neurons and prototypic neurons. These two cell types exhibit largely distinct firing rates and patterns <italic>in vivo</italic>, including divergent encoding of spontaneous movements [<xref ref-type="bibr" rid="pcbi.1005004.ref018">18</xref>] as well as selective temporal coupling with different phases of the oscillations present in the cortex of dopamine-intact and Parkinsonian rodents [<xref ref-type="bibr" rid="pcbi.1005004.ref019">19</xref>–<xref ref-type="bibr" rid="pcbi.1005004.ref021">21</xref>]. The physiological dichotomy is mirrored by a molecular dichotomy. Thus, arkypallidal neurons express the transcription factor forkhead box protein 2 (FoxP2), whereas prototypic neurons do not [<xref ref-type="bibr" rid="pcbi.1005004.ref018">18</xref>,<xref ref-type="bibr" rid="pcbi.1005004.ref019">19</xref>]. Conversely, most prototypic neurons express the calcium-binding protein parvalbumin (PV), whereas arkypallidal neurons do not [<xref ref-type="bibr" rid="pcbi.1005004.ref018">18</xref>–<xref ref-type="bibr" rid="pcbi.1005004.ref020">20</xref>]. Equally important, arkypallidal and prototypic neurons preferentially innervate distinct sets of basal ganglia neurons [<xref ref-type="bibr" rid="pcbi.1005004.ref019">19</xref>,<xref ref-type="bibr" rid="pcbi.1005004.ref020">20</xref>], which we review in more detail below. In summary, there is now compelling support for the idea that a dichotomous functional organization, as actioned by arkypallidal and prototypic neurons with specialized physiological, molecular, and structural properties, is fundamental to the operations of the GPe. In this paper, we extend this notion by examining how a GPe network composed of these two distinct types of neuron could compute the function required for optimal action selection.</p>
<p>In the next section, we review the optimal action selection model and its predictions concerning computations in GPe. In the subsequent section, we show that the observed connectivity of arkypallidal and prototypic neurons, as well as the relationships between firing rate and injected current (f-I curves) for the two populations of the GPe neurons, fulfil the requirements necessary to approximate optimal action selection. Finally, we discuss our results and consider future directions.</p>
</sec>
<sec id="sec002">
<title>Model</title>
<p>We first review the overall computation in the model, and then its implementation in the cortico-basal-ganglia circuit.</p>
<sec id="sec003">
<title>Computations in the model</title>
<p>Let us first introduce a simple choice task, in the context of which we present the model. Consider a rat that has to press either a lever to the left or to the right on the basis of an auditory stimulus. On each trial, pressing only one of the levers will lead to the reward. The auditory stimulus consists of a sequence of short intervals during which a low- or high-pitched tone is presented, which provide probabilistic information on which lever is correct on a given trial. During trials in which pressing the left lever is rewarded, the low tone has 70% chance of occurring in each interval, while the high tone has only 30% probability of occurring. Conversely, on trials when pressing the right lever is rewarded, the low and high tones have 30% and 70% probabilities, respectively. Let us assume that the rat is well trained in this task. Please note that, in this hypothetical task, in order to maximize its reward, the rat needs to listen to the stimulus, accumulate information from successive beeps, and then only makes a choice (i.e. selects an action) once it reaches a certain level of confidence.</p>
<p>Let us denote different actions available in a given context by <italic>A</italic><sub><italic>k</italic></sub>, thus in the above example, the rat has two potentially rewarded actions, <italic>A</italic><sub>1</sub> and <italic>A</italic><sub>2</sub>, corresponding to pressing the left and the right lever, respectively. The model suggests that, during action selection, the cortico-basal-ganglia circuit is evaluating the probabilities of alternative actions being appropriate in a given context, which we denote by <italic>P</italic>(<italic>A</italic><sub><italic>k</italic></sub>). Whenever any of the probabilities exceeds a threshold of confidence during the internalized process of action selection, the corresponding action is triggered.</p>
<p>In the model, the probabilities of actions <italic>P</italic>(<italic>A</italic><sub><italic>k</italic></sub>) are updated on the basis of sensory input. For simplicity, let us assume that the time during the action selection process is divided into discrete intervals, and during each interval a sensory input <italic>S</italic> in presented. The sensory input <italic>S</italic> could be used to update the probabilities of action <italic>P</italic>(<italic>A</italic><sub><italic>k</italic></sub>), because from past experience the animal could have learned how often <italic>S</italic> appeared on trials on which action <italic>A</italic><sub><italic>k</italic></sub> was rewarded. Let us denote this rate of occurrence by <italic>P</italic>(<italic>S</italic>|<italic>A</italic><sub><italic>k</italic></sub>). Thus, for example, in the task described above, if the low tone is presented at the current time step, then <italic>P</italic>(<italic>S</italic>|<italic>A</italic><sub>1</sub>) = 0.7 and <italic>P</italic>(<italic>S</italic>|<italic>A</italic><sub>2</sub>) = 0.3. Bayes’ theorem (see <xref ref-type="disp-formula" rid="pcbi.1005004.e001">Eq 1</xref>) describes how to update the probabilities of actions according to the sensory input:
<disp-formula id="pcbi.1005004.e001">
<alternatives>
<graphic id="pcbi.1005004.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005004.e001" xlink:type="simple"/>
<mml:math display="block" id="M1">
<mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mi>S</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow>
</mml:math>
</alternatives>
<label>(1)</label>
</disp-formula></p>
<p>Bayes’ theorem says that in order to compute the updated or ‘posterior’ probability of action <italic>P</italic>(<italic>A</italic><sub><italic>k</italic></sub>|<italic>S</italic>), one needs to multiply the previous or prior probability <italic>P</italic>(<italic>A</italic><sub><italic>k</italic></sub>) by the learned probability of the sensory input <italic>S</italic> appearing on trials on which action <italic>A</italic><sub><italic>k</italic></sub> was correct, i.e. <italic>P</italic>(<italic>S|A</italic><sub><italic>k</italic></sub>). For example, when the low tone is presented, then <italic>P</italic>(<italic>A</italic><sub>1</sub>) is multiplied by 0.7 and <italic>P</italic>(<italic>A</italic><sub>2</sub>) is multiplied by 0.3. Additionally, to ensure that the posterior probabilities add up to 1, these products are divided by a normalization term <italic>P</italic>(<italic>S</italic>) equal to the sum of the products across all actions:
<disp-formula id="pcbi.1005004.e002">
<alternatives>
<graphic id="pcbi.1005004.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005004.e002" xlink:type="simple"/>
<mml:math display="block" id="M2">
<mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>S</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow>
</mml:math>
</alternatives>
<label>(2)</label>
</disp-formula></p>
<p>In <xref ref-type="disp-formula" rid="pcbi.1005004.e002">Eq 2</xref>, <italic>N</italic> denotes the number of available actions. If for any action the posterior probability computed from <xref ref-type="disp-formula" rid="pcbi.1005004.e001">Eq 1</xref> exceeds a threshold of confidence, the corresponding action is chosen. Otherwise the integration of information continues and the posterior probability <italic>P</italic>(<italic>A</italic><sub><italic>k</italic></sub>|<italic>S</italic>) from the current time interval becomes the prior <italic>P</italic>(<italic>A</italic><sub><italic>k</italic></sub>) for the next one.</p>
</sec>
<sec id="sec004">
<title>Neural implementation</title>
<p><xref ref-type="disp-formula" rid="pcbi.1005004.e001">Eq 1</xref> includes multiplication and division, which are not natural operations for neurons (as classical neural networks models rather assume that neurons add their inputs and potentially transform them through non-linear functions e.g. [<xref ref-type="bibr" rid="pcbi.1005004.ref022">22</xref>]), but this problem can be solved by taking the logarithm. Recall that the logarithm has the following properties: log <italic>a·b</italic> = log <italic>a</italic> + log <italic>b</italic>, and log <italic>a/b</italic> = log <italic>a</italic>–log <italic>b</italic>. Hence taking the logarithm of both sides of <xref ref-type="disp-formula" rid="pcbi.1005004.e001">Eq 1</xref> we get:
<disp-formula id="pcbi.1005004.e003">
<alternatives>
<graphic id="pcbi.1005004.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005004.e003" xlink:type="simple"/>
<mml:math display="block" id="M3">
<mml:mrow><mml:mi mathvariant="normal">log</mml:mi><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mi>S</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="normal">log</mml:mi><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="normal">log</mml:mi><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi mathvariant="normal">log</mml:mi><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow>
</mml:math>
</alternatives>
<label>(3)</label>
</disp-formula></p>
<p>Thus, if in the context of neurons, they have firing rates proportional to the logarithms of probabilities, the update according to Bayes’ theorem can be performed just using addition and subtraction. The computation of the logarithm of the normalization term becomes only slightly more complex, as it needs to include nonlinear transformations:
<disp-formula id="pcbi.1005004.e004">
<alternatives>
<graphic id="pcbi.1005004.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005004.e004" xlink:type="simple"/>
<mml:math display="block" id="M4">
<mml:mrow><mml:mi mathvariant="normal">log</mml:mi><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>S</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="normal">log</mml:mi><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:mi mathvariant="normal">exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">log</mml:mi><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="normal">log</mml:mi><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow>
</mml:math>
</alternatives>
<label>(4)</label>
</disp-formula></p>
<p><xref ref-type="fig" rid="pcbi.1005004.g001">Fig 1</xref> illustrates how <xref ref-type="disp-formula" rid="pcbi.1005004.e003">Eq 3</xref> could be mapped onto a subset of cortico-basal-ganglia-thalamic circuits [<xref ref-type="bibr" rid="pcbi.1005004.ref010">10</xref>]. The model assumes that within the circuit there exist populations of neurons selective for different actions (shown in different colours in <xref ref-type="fig" rid="pcbi.1005004.g001">Fig 1</xref>). The notion that different actions could be subserved by discrete neuronal populations within cortico-basal-ganglia-thalamic circuits is supported by anatomical data demonstrating that these circuits are composed of partially segregated (and topographically organized) ‘loops’ [<xref ref-type="bibr" rid="pcbi.1005004.ref023">23</xref>]. It has been demonstrated that, for certain assumptions, log <italic>P</italic>(<italic>S</italic>|<italic>A</italic><sub><italic>k</italic></sub>) is proportional to the activity of the sensory neurons selective for stimuli associated with action <italic>A</italic><sub><italic>k</italic></sub> being correct [<xref ref-type="bibr" rid="pcbi.1005004.ref009">9</xref>,<xref ref-type="bibr" rid="pcbi.1005004.ref024">24</xref>–<xref ref-type="bibr" rid="pcbi.1005004.ref026">26</xref>], so the term log <italic>P</italic>(<italic>S</italic>|<italic>A</italic><sub><italic>k</italic></sub>) could be encoded directly in the activity of cortical sensory neurons. In the model framework in <xref ref-type="fig" rid="pcbi.1005004.g001">Fig 1</xref>, the neurons in the frontal cortex add the input from sensory neurons to the logarithm of the prior probability, which is provided by a feedback from the thalamus, thus they perform the addition in <xref ref-type="disp-formula" rid="pcbi.1005004.e003">Eq 3</xref>.</p>
<fig id="pcbi.1005004.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005004.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Mapping of Bayes’ theorem onto a subset of the cortico-basal-ganglia-thalamic circuits.</title>
<p>Black and grey circles denote neural populations selective for two sample actions (<italic>A</italic><sub><italic>1</italic></sub> or <italic>A</italic><sub><italic>2</italic></sub>), and the labels next to the circles indicate their anatomical correlates. Arrows denote excitatory (glutamatergic) connections, while lines ended with circles denote inhibitory (GABAergic) connections. The following abbreviations have been used: ctx.–cortex, STN–subthalamic nucleus, GPe–external globus pallidus, Output–output nuclei of the basal ganglia, i.e. internal globus pallidus and substantia nigra pars reticulata.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005004.g001" xlink:type="simple"/>
</fig>
<p>The logarithm of the normalization term is computed in the model in a circuit of reciprocally connected STN and GPe neurons, and this computation is described in detail in the next subsection. The output nuclei of the basal ganglia receive excitation from STN (which, in the model, is proportional to log <italic>P</italic>(<italic>S</italic>)) and inhibition from the cortex via the striatum (which, in the model, is proportional to log <italic>P</italic>(<italic>A</italic><sub><italic>k</italic></sub>) + log <italic>P</italic>(<italic>S</italic>|<italic>A</italic><sub><italic>k</italic></sub>)), and subtract these two inputs; thus, according to <xref ref-type="disp-formula" rid="pcbi.1005004.e003">Eq 3</xref>, their activity is proportional to –log <italic>P</italic>(<italic>A</italic><sub><italic>k</italic></sub>|<italic>S</italic>). The output nuclei send inhibitory signals to the thalamus, so the activity in the thalamus is proportional to the logarithm of the posterior probability, i.e. log <italic>P</italic>(<italic>A</italic><sub><italic>k</italic></sub>|<italic>S</italic>). Finally, the logarithm of the posterior probability is sent back from the thalamus to the frontal cortex as it becomes the basis of the computation (or prior log <italic>P</italic>(<italic>A</italic><sub><italic>k</italic></sub>)) in the next time step.</p>
<p>The model described so far assumes that certain neural populations have activity proportional to the logarithms of probabilities, but these quantities are negative (as probabilities are smaller than one). This problem can be solved by assuming that the firing rates are proportional to the logarithms of probabilities increased by a constant <italic>c</italic> (we discuss the required value of this constant in the Results section). Eqs <xref ref-type="disp-formula" rid="pcbi.1005004.e005">5</xref>–<xref ref-type="disp-formula" rid="pcbi.1005004.e009">9</xref> below describe computations performed by each of the nuclei in the model:
<disp-formula id="pcbi.1005004.e005">
<alternatives>
<graphic id="pcbi.1005004.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005004.e005" xlink:type="simple"/>
<mml:math display="block" id="M5">
<mml:mrow><mml:mi>S</mml:mi><mml:mi>E</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="normal">log</mml:mi><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>c</mml:mi></mml:mrow>
</mml:math>
</alternatives>
<label>(5)</label>
</disp-formula>
<disp-formula id="pcbi.1005004.e006">
<alternatives>
<graphic id="pcbi.1005004.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005004.e006" xlink:type="simple"/>
<mml:math display="block" id="M6">
<mml:mrow><mml:mi>C</mml:mi><mml:mi>T</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="normal">log</mml:mi><mml:mspace width="0.25em"/><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>c</mml:mi><mml:mo>+</mml:mo><mml:mi>S</mml:mi><mml:mi>E</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mspace width="1em"/><mml:mtext>at the first interval</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>T</mml:mi><mml:msub><mml:mi>H</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>S</mml:mi><mml:mi>E</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mspace width="2em"/><mml:mtext>at subsequent intervals</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(6)</label>
</disp-formula>
<disp-formula id="pcbi.1005004.e007">
<alternatives>
<graphic id="pcbi.1005004.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005004.e007" xlink:type="simple"/>
<mml:math display="block" id="M7">
<mml:mrow><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal">log</mml:mi><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:mi mathvariant="normal">exp</mml:mi><mml:mi>C</mml:mi><mml:mi>T</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:mrow>
</mml:math>
</alternatives>
<label>(7)</label>
</disp-formula>
<disp-formula id="pcbi.1005004.e008">
<alternatives>
<graphic id="pcbi.1005004.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005004.e008" xlink:type="simple"/>
<mml:math display="block" id="M8">
<mml:mrow><mml:mi>O</mml:mi><mml:mi>U</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>–</mml:mo><mml:mi>C</mml:mi><mml:mi>T</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>N</mml:mi></mml:mrow>
</mml:math>
</alternatives>
<label>(8)</label>
</disp-formula>
<disp-formula id="pcbi.1005004.e009">
<alternatives>
<graphic id="pcbi.1005004.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005004.e009" xlink:type="simple"/>
<mml:math display="block" id="M9">
<mml:mrow><mml:mi>T</mml:mi><mml:msub><mml:mi>H</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>c</mml:mi><mml:mo>–</mml:mo><mml:mi>O</mml:mi><mml:mi>U</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow>
</mml:math>
</alternatives>
<label>(9)</label>
</disp-formula></p>
<p>In the above equations <italic>SEN</italic><sub><italic>k</italic></sub>, <italic>CTX</italic><sub><italic>k</italic></sub>, <italic>OUT</italic><sub><italic>k</italic></sub> and <italic>TH</italic><sub><italic>k</italic></sub> respectively denote the firing rates of populations of sensory cortical neurons, frontal cortical neurons, basal ganglia output nuclei neurons, and thalamic neurons, selective for alternative <italic>k</italic>. At the start of the trial, the frontal cortical neurons are initialized to the logarithms of initial prior probabilities of actions, and subsequently they receive feedback equal to thalamic activity in the previous time step i.e. <italic>TH</italic><sub><italic>k</italic></sub>(<italic>t</italic>–1). The <italic>STN</italic> term denotes the sum of activities across all STN neurons, while we denote the activity of STN the neurons selective for action <italic>A</italic><sub><italic>k</italic></sub> as <italic>STN</italic><sub><italic>k</italic></sub>, i.e.</p>
<disp-formula id="pcbi.1005004.e010">
<alternatives>
<graphic id="pcbi.1005004.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005004.e010" xlink:type="simple"/>
<mml:math display="block" id="M10">
<mml:mrow><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:mrow>
</mml:math>
</alternatives>
<label>(10)</label>
</disp-formula>
<p>Thus, according to <xref ref-type="disp-formula" rid="pcbi.1005004.e008">Eq 8</xref>, each neural population in the output nuclei in the model receives input from all populations in the STN, in agreement with experimental data suggesting that the axonal projections of STN neurons are relatively diffuse [<xref ref-type="bibr" rid="pcbi.1005004.ref027">27</xref>].</p>
<p>We will describe in the next subsection how the activity described by <xref ref-type="disp-formula" rid="pcbi.1005004.e007">Eq 7</xref> could arise in the STN, but first let us show that the model described in Eqs <xref ref-type="disp-formula" rid="pcbi.1005004.e005">5</xref>–<xref ref-type="disp-formula" rid="pcbi.1005004.e009">9</xref> correctly updates probabilities. At the first time-step, the activity of frontal cortical neurons is equal to (according to Eqs <xref ref-type="disp-formula" rid="pcbi.1005004.e005">5</xref> and <xref ref-type="disp-formula" rid="pcbi.1005004.e006">6</xref>):
<disp-formula id="pcbi.1005004.e011">
<alternatives>
<graphic id="pcbi.1005004.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005004.e011" xlink:type="simple"/>
<mml:math display="block" id="M11">
<mml:mrow><mml:mi>C</mml:mi><mml:mi>T</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="normal">log</mml:mi><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="normal">log</mml:mi><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mi mathvariant="normal">c</mml:mi></mml:mrow>
</mml:math>
</alternatives>
<label>(11)</label>
</disp-formula></p>
<p>According to Eqs <xref ref-type="disp-formula" rid="pcbi.1005004.e007">7</xref>, <xref ref-type="disp-formula" rid="pcbi.1005004.e011">11</xref> and <xref ref-type="disp-formula" rid="pcbi.1005004.e002">2</xref>, the activity in the STN is:
<disp-formula id="pcbi.1005004.e012">
<alternatives>
<graphic id="pcbi.1005004.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005004.e012" xlink:type="simple"/>
<mml:math display="block" id="M12">
<mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal">log</mml:mi><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:mi mathvariant="normal">exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">log</mml:mi><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="normal">log</mml:mi><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mi>c</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo></mml:mrow></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="2em"/><mml:mo>=</mml:mo><mml:mi mathvariant="normal">log</mml:mi><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle><mml:mi mathvariant="normal">exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mi>c</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="2em"/><mml:mo>=</mml:mo><mml:mi mathvariant="normal">log</mml:mi><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>S</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mi>c</mml:mi></mml:mtd></mml:mtr></mml:mtable>
</mml:math>
</alternatives>
<label>(12)</label>
</disp-formula></p>
<p>Constants 2<italic>c</italic> then cancel while computing the activity in the output nuclei (using Eqs <xref ref-type="disp-formula" rid="pcbi.1005004.e008">8</xref>, <xref ref-type="disp-formula" rid="pcbi.1005004.e011">11</xref>, <xref ref-type="disp-formula" rid="pcbi.1005004.e012">12</xref> and <xref ref-type="disp-formula" rid="pcbi.1005004.e003">3</xref>):
<disp-formula id="pcbi.1005004.e013">
<alternatives>
<graphic id="pcbi.1005004.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005004.e013" xlink:type="simple"/>
<mml:math display="block" id="M13">
<mml:mrow><mml:mi>O</mml:mi><mml:mi>U</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi mathvariant="normal">log</mml:mi><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi mathvariant="normal">log</mml:mi><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mi>c</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="normal">log</mml:mi><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>S</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi mathvariant="normal">log</mml:mi><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mi>S</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(13)</label>
</disp-formula></p>
<p>We have shown that at the end of the first time interval, the model computes the posterior probabilities of actions. Since the posterior probabilities are then fed back to frontal cortical neurons as a prior for the next interval, it can be shown using analogous calculations that the network correctly computes the posterior probability in every subsequent interval.</p>
</sec>
<sec id="sec005">
<title>Computation of the normalization term</title>
<p>We now describe the conditions under which the activity in STN is proportional to the logarithm of the normalization term. Bogacz and Gurney [<xref ref-type="bibr" rid="pcbi.1005004.ref009">9</xref>] have shown that the STN-GPe circuit with the architecture shown in <xref ref-type="fig" rid="pcbi.1005004.g001">Fig 1</xref> would produce activity of STN that is given in <xref ref-type="disp-formula" rid="pcbi.1005004.e007">Eq 7</xref>, if and when the neural populations in STN and GPe had the following relationships between their inputs and their firing rates:
<disp-formula id="pcbi.1005004.e014">
<alternatives>
<graphic id="pcbi.1005004.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005004.e014" xlink:type="simple"/>
<mml:math display="block" id="M14">
<mml:mrow><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="normal">exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mi>T</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>G</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(14)</label>
</disp-formula>
<disp-formula id="pcbi.1005004.e015">
<alternatives>
<graphic id="pcbi.1005004.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005004.e015" xlink:type="simple"/>
<mml:math display="block" id="M15">
<mml:mrow><mml:mi>G</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="normal">log</mml:mi><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>N</mml:mi></mml:mrow>
</mml:math>
</alternatives>
<label>(15)</label>
</disp-formula></p>
<p>In the above equations, <italic>GP</italic><sub><italic>k</italic></sub> denotes the firing rates of GPe neurons selective for action <italic>A</italic><sub><italic>k</italic></sub> (in the original model [<xref ref-type="bibr" rid="pcbi.1005004.ref009">9</xref>] the GPe neurons were assumed to belong to a single cell type). The STN neurons receive excitation from cortex and inhibition from GPe, so their total input is <italic>CTX</italic><sub><italic>k</italic></sub>−<italic>GP</italic><sub><italic>k</italic></sub>, thus <xref ref-type="disp-formula" rid="pcbi.1005004.e014">Eq 14</xref> implies that the STN neurons in the model have exponential input-output relationships (often termed ‘f-I curves’ in empirical studies). The GPe neurons receive input from STN, but this input is coming in <xref ref-type="fig" rid="pcbi.1005004.g001">Fig 1</xref> from STN neurons selective for all actions which we denote by <italic>STN</italic> without a subscript (see <xref ref-type="disp-formula" rid="pcbi.1005004.e010">Eq 10</xref>). <xref ref-type="disp-formula" rid="pcbi.1005004.e015">Eq 15</xref> implies that the GPe provides inhibition proportional to <italic>STN</italic>–log <italic>STN</italic>.</p>
<p>Before giving a mathematical proof for how the STN-GPe circuit computes <xref ref-type="disp-formula" rid="pcbi.1005004.e007">Eq 7</xref> in the model, let us first provide an intuition. Starting from the right end of <xref ref-type="disp-formula" rid="pcbi.1005004.e007">Eq 7</xref>, the frontal cortical activity <italic>CTX</italic><sub><italic>k</italic></sub> is provided to the STN in the model by the cortico-subthalamic pathway (see <xref ref-type="fig" rid="pcbi.1005004.g001">Fig 1</xref>). The exponentiation is performed by the STN neurons (cf. <xref ref-type="disp-formula" rid="pcbi.1005004.e014">Eq 14</xref>). The summation is achieved due to the diffuse projections from the STN: in the model each neural population in the output nuclei receives input from all populations in the STN, hence the neurons in the output nuclei can sum the activity of STN populations. The only non-intuitive element of the computation of <xref ref-type="disp-formula" rid="pcbi.1005004.e007">Eq 7</xref> is the logarithm–this comes from the interactions between STN and GPe, as shown below.</p>
<p>We now present a sequence of simple mathematical operations that show that Eqs <xref ref-type="disp-formula" rid="pcbi.1005004.e014">14</xref> and <xref ref-type="disp-formula" rid="pcbi.1005004.e015">15</xref> imply <xref ref-type="disp-formula" rid="pcbi.1005004.e007">Eq 7</xref>. Substituting <xref ref-type="disp-formula" rid="pcbi.1005004.e015">Eq 15</xref> into 14 gives:
<disp-formula id="pcbi.1005004.e016">
<alternatives>
<graphic id="pcbi.1005004.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005004.e016" xlink:type="simple"/>
<mml:math display="block" id="M16">
<mml:mrow><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="normal">exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mi>T</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="normal">log</mml:mi><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>N</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(16)</label>
</disp-formula></p>
<p>Using the property of exponentiation <italic>e</italic><sup><italic>a+b</italic></sup> = <italic>e</italic><sup><italic>a</italic></sup><italic>e</italic><sup><italic>b</italic></sup> we obtain:
<disp-formula id="pcbi.1005004.e017">
<alternatives>
<graphic id="pcbi.1005004.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005004.e017" xlink:type="simple"/>
<mml:math display="block" id="M17">
<mml:mrow><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="normal">exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mi>T</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi mathvariant="normal">exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>N</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>N</mml:mi></mml:mrow>
</mml:math>
</alternatives>
<label>(17)</label>
</disp-formula></p>
<p>Summing over <italic>k</italic> and using the definition of <italic>STN</italic> (given in <xref ref-type="disp-formula" rid="pcbi.1005004.e010">Eq 10</xref>) we obtain:
<disp-formula id="pcbi.1005004.e018">
<alternatives>
<graphic id="pcbi.1005004.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005004.e018" xlink:type="simple"/>
<mml:math display="block" id="M18">
<mml:mrow><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:mi mathvariant="normal">exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mi>T</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle><mml:mi mathvariant="normal">exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>N</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>N</mml:mi></mml:mrow>
</mml:math>
</alternatives>
<label>(18)</label>
</disp-formula></p>
<p>Taking the logarithm of <xref ref-type="disp-formula" rid="pcbi.1005004.e018">Eq 18</xref> we get:
<disp-formula id="pcbi.1005004.e019">
<alternatives>
<graphic id="pcbi.1005004.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005004.e019" xlink:type="simple"/>
<mml:math display="block" id="M19">
<mml:mrow><mml:mi mathvariant="normal">log</mml:mi><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal">log</mml:mi><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:mi mathvariant="normal">exp</mml:mi><mml:mi>C</mml:mi><mml:mi>T</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mstyle><mml:mo>−</mml:mo><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="normal">log</mml:mi><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>N</mml:mi></mml:mrow>
</mml:math>
</alternatives>
<label>(19)</label>
</disp-formula>
log <italic>STN</italic> cancel on both sides in <xref ref-type="disp-formula" rid="pcbi.1005004.e019">Eq 19</xref>, and moving <italic>STN</italic> to the left side we see that the sum of activities of all STN neural populations is equal to the required value of <xref ref-type="disp-formula" rid="pcbi.1005004.e007">Eq 7</xref>:
<disp-formula id="pcbi.1005004.e020">
<alternatives>
<graphic id="pcbi.1005004.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005004.e020" xlink:type="simple"/>
<mml:math display="block" id="M20">
<mml:mrow><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal">log</mml:mi><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:mi mathvariant="normal">exp</mml:mi><mml:mi>C</mml:mi><mml:mi>T</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:mrow>
</mml:math>
</alternatives>
<label>(20)</label>
</disp-formula></p>
<p>Eqs <xref ref-type="disp-formula" rid="pcbi.1005004.e014">14</xref> and <xref ref-type="disp-formula" rid="pcbi.1005004.e015">15</xref> thus describe the predictions of this model on the response properties of STN and GPe neurons, respectively. Bogacz and Gurney [<xref ref-type="bibr" rid="pcbi.1005004.ref009">9</xref>] have shown that the published f-I curves of STN neurons [<xref ref-type="bibr" rid="pcbi.1005004.ref028">28</xref>,<xref ref-type="bibr" rid="pcbi.1005004.ref029">29</xref>] indeed follow the exponential function precisely up to the firing rate of 135 spikes per second (STN neurons are unlikely to fire at higher rates <italic>in vivo</italic>). In the next Section, we investigate whether the properties of GPe neurons match those required to compute <xref ref-type="disp-formula" rid="pcbi.1005004.e015">Eq 15</xref>.</p>
</sec>
</sec>
<sec id="sec006" sec-type="results">
<title>Results</title>
<p>We start by analysing in detail the computations in GPe required by the optimal action selection model, and by giving further insight into our initial hypotheses on how this computation could be performed [<xref ref-type="bibr" rid="pcbi.1005004.ref009">9</xref>]. We then show how the key aspects of our hypothesis match experimental data. Using simulations of an optimised computer model embedding realistic f-I curves of neurons for each sub-population, we demonstrate that GPe can perform computations required for optimal action selection. We finally report the dynamical properties of such network for varying cortical inputs, and discuss how the connections between GPe and striatum can be incorporated into the model.</p>
<sec id="sec007">
<title>Computations in GPe required for optimal action selection</title>
<p>The model described in the previous section predicts that the GPe neurons send an inhibitory signal to the STN that is proportional to <italic>STN</italic>–log <italic>STN</italic>. The black curve in <xref ref-type="fig" rid="pcbi.1005004.g002">Fig 2A</xref> illustrates the shape of this function. It is worth clarifying that the axes in <xref ref-type="fig" rid="pcbi.1005004.g002">Fig 2A</xref> are expressed in the units of log of probability [<xref ref-type="bibr" rid="pcbi.1005004.ref025">25</xref>], which are related to the units of firing rate and input current through scaling factors (discussed later) because the model assumes that the firing rates are proportional to the probabilistic quantities they represent. As shown in <xref ref-type="fig" rid="pcbi.1005004.g002">Fig 2A</xref>, the function <italic>STN</italic>–log <italic>STN</italic> diverges to infinity for very low <italic>STN</italic> input. However, such very low values of <italic>STN</italic> input are not biologically relevant because STN neurons are autonomously active [<xref ref-type="bibr" rid="pcbi.1005004.ref030">30</xref>,<xref ref-type="bibr" rid="pcbi.1005004.ref031">31</xref>]; GPe will thus receive input from STN even when STN itself does not receive any organised excitatory input. The lower bound on <italic>STN</italic> is provided by <xref ref-type="disp-formula" rid="pcbi.1005004.e020">Eq 20</xref> –please note that <italic>CTX</italic><sub><italic>k</italic></sub> cannot be negative thus <italic>STN</italic> ≥ log <italic>N</italic>. The lowest possible number of choice alternatives is 2, thus <italic>STN</italic> ≥ log 2 ≈ 0.7.</p>
<fig id="pcbi.1005004.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005004.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Computation of function <italic>STN</italic>–log <italic>STN</italic> in a microcircuit containing two distinct populations of GPe neurons.</title>
<p><bold>(A)</bold> Decomposition of function <italic>STN</italic>–log <italic>STN</italic> (shown in black) into a difference between a Prototypic function (P, shown in blue) and Adjustment (A, corresponding to red striped area). <bold>(B)</bold> A hypothetical neural circuit computing <italic>STN</italic>–log <italic>STN</italic>. Rectangles denote neural populations, arrows denote excitatory connections, while lines ended with circles denote inhibitory connections. P denotes the neural population with f-I curve corresponding to function P from the left panel. Activity of neurons P is adjusted by inhibition from population denoted by A with f-I curve corresponding to the red area from the left panel. <bold>(C)</bold> Experimentally-derived connectivity between major cell types in STN-GPe circuit. PRO, prototypic GPe neurons; ARK, arkypallidal neurons.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005004.g002" xlink:type="simple"/>
</fig>
<p>The upper bound on <italic>STN</italic> is provided by <xref ref-type="disp-formula" rid="pcbi.1005004.e012">Eq 12</xref>; please note that log <italic>P</italic>(<italic>S</italic>) cannot be positive thus <italic>STN</italic> ≤ 2<italic>c</italic>. Because the upper bound depends on constant <italic>c</italic> we now consider its value. Recall that constant <italic>c</italic> was added in the model to the activity of the neurons representing logarithms of probabilities to ensure their firing rates are not negative. Nevertheless for any value of <italic>c</italic>, for sufficiently low probability <italic>p</italic>, the value of log <italic>p</italic> + <italic>c</italic> will be negative, so such low probabilities will not be represented in the model. Thus the value of constant <italic>c</italic> determines the lowest probability of action that can be represented in the model. It has been demonstrated that humans can represent prior probabilities of actions as low as 0.05 [<xref ref-type="bibr" rid="pcbi.1005004.ref032">32</xref>]. If we wish the model to represent the probability of 0.05, then <italic>c</italic> needs to be around 3, as log 0.05 + 3 ≈ 0. If we set <italic>c</italic> to 3, then the upper bound on STN considered above becomes <italic>STN</italic> ≤ 2<italic>c</italic> = 6. In summary, we will consider the relevant range of <italic>STN</italic> for which GPe needs to compute <italic>STN</italic>–log <italic>STN</italic> to be from around 0.7 to 6. The black curve in <xref ref-type="fig" rid="pcbi.1005004.g002">Fig 2A</xref> is solid in this range, while it is dashed outside it.</p>
<p>In the relevant range <italic>STN</italic> ϵ (0.7, 6), function <italic>STN</italic>–log <italic>STN</italic> is non-monotonic, i.e. it initially decreases (for <italic>STN</italic> &lt; 1) and then increases (for <italic>STN</italic> &gt; 1), so it is very unlikely that neurons with such an f-I curve would exist, and thus that this function could be computed by single neurons. Even ignoring the non-monotonicity, which occurs on only a small part of the relevant range, the function <italic>STN</italic>–log <italic>STN</italic> is convex on its whole range, i.e. the larger the input, the larger is its rate of growth. By contrast, the previously published f-I curves of GPe neurons were only convex in a very narrow range of small input currents, while on the majority of their range they were linear or concave, i.e. they were decreasing their rate of growth for larger inputs [<xref ref-type="bibr" rid="pcbi.1005004.ref033">33</xref>–<xref ref-type="bibr" rid="pcbi.1005004.ref035">35</xref>]. Hence, the published data suggest that it is unlikely that individual GPe neurons, or a single type of GPe neuron, could compute even the monotonic part of function <italic>STN</italic>–log <italic>STN</italic>. Theoretically, however, this function could be computed in a microcircuit composed of two populations of GPe neurons with distinct activities and connections. <xref ref-type="fig" rid="pcbi.1005004.g002">Fig 2A</xref> shows how the function <italic>STN</italic>–log <italic>STN</italic> could be represented by a difference of two functions: a 'Prototype' (P) function, shown by a blue line, and an 'Adjustment' (A) function, shown by a red striped area. Therefore, the function <italic>STN</italic>–log <italic>STN</italic> could be computed by two neural populations, ‘P’ and ‘A’, with the connectivity shown in <xref ref-type="fig" rid="pcbi.1005004.g002">Fig 2B</xref>, and with f-I curves corresponding, respectively, to the blue line and the height of red striped area (i.e. the difference between blue and black lines) in <xref ref-type="fig" rid="pcbi.1005004.g002">Fig 2A</xref> (such f-I curves are monotonic and non-convex). In this architecture, both populations P and A receive input from STN. Population A transforms this input via its non-linear f-I curve and sends inhibition to neurons P thus adjusting their response. In this architecture only the neurons in population P have activity proportional to <italic>STN</italic>–log <italic>STN</italic>, so <italic>only</italic> they project back to STN.</p>
</sec>
<sec id="sec008">
<title>Comparison of connectivity of GPe neurons with model predictions</title>
<p>GABAergic projection neurons in the GPe can be divided into two major cell types, termed prototypic and arkypallidal, on the basis of their distinct firing <italic>in vivo</italic>, molecular profiles and structure [<xref ref-type="bibr" rid="pcbi.1005004.ref018">18</xref>–<xref ref-type="bibr" rid="pcbi.1005004.ref020">20</xref>]. These sub-populations exhibit clearly distinct connectivity within the STN-GPe network (<xref ref-type="fig" rid="pcbi.1005004.g002">Fig 2C</xref>), as derived from empirical studies in rodents [<xref ref-type="bibr" rid="pcbi.1005004.ref019">19</xref>,<xref ref-type="bibr" rid="pcbi.1005004.ref020">20</xref>] and previous computational modelling of empirical data [<xref ref-type="bibr" rid="pcbi.1005004.ref036">36</xref>]. Interestingly, this pattern of connectivity resembles that of the model computing function <italic>STN</italic>–log <italic>STN</italic> (cf. <xref ref-type="fig" rid="pcbi.1005004.g002">Fig 2B</xref>). In particular, only one of the GPe populations, i.e. the prototypic neurons (but not arkypallidal neurons) send projections back to STN [<xref ref-type="bibr" rid="pcbi.1005004.ref019">19</xref>,<xref ref-type="bibr" rid="pcbi.1005004.ref020">20</xref>]. Additionally, recent computational modelling of effective connectivity in the STN-GPe network suggest that both prototypic and arkypallidal neurons receive input from STN [<xref ref-type="bibr" rid="pcbi.1005004.ref036">36</xref>]. Thus, in summary, the observed pattern of GPe connectivity (<xref ref-type="fig" rid="pcbi.1005004.g002">Fig 2C</xref>) includes all the connections present in the model computing function <italic>STN</italic>–log <italic>STN</italic> (<xref ref-type="fig" rid="pcbi.1005004.g002">Fig 2B</xref>), but it also includes two additional connections (i.e. that between prototypic neurons and that from prototypic to arkypallidal neurons) and we will address their roles below.</p>
</sec>
<sec id="sec009">
<title>Comparison of response properties of GPe neurons with model predictions</title>
<p>We investigated whether the f-I curves of GPe neurons have characteristics required for computation of function <italic>STN</italic>–log <italic>STN</italic>. The first characteristic we expected was that f-I curves of GPe neurons should have linear or logarithmic shape, allowing them to jointly compute the function <italic>STN</italic>—log <italic>STN</italic>. Then we sought to explore if the populations 'P' and 'A' introduced in our theoretical model could correspond to the prototypic and arkypallidal neurons reported experimentally. Such a correspondence would require further two characteristics in their f-I curves. For low levels of input from STN, the average firing rate of prototypic neurons should be higher than that of arkypallidal neurons. This requirement arises because the “adjustment” to the firing rate of the 'P' sub-population (red area in <xref ref-type="fig" rid="pcbi.1005004.g002">Fig 2A</xref>) is only necessary for high inputs, so one could expect arkypallidal neurons to have a firing rate closer to zero for low <italic>STN</italic>. Furthermore, one would expect that the responses of prototypic neurons to be more linear than those of arkypallidal neurons (as the two populations in <xref ref-type="fig" rid="pcbi.1005004.g002">Fig 2B</xref> compute the linear and logarithmic functions in <xref ref-type="fig" rid="pcbi.1005004.g002">Fig 2A</xref>).</p>
<p>The f-I curves of molecularly-identified prototypic and arkypallidal neurons have been recently measured experimentally by Abdi et al. [<xref ref-type="bibr" rid="pcbi.1005004.ref019">19</xref>] using perforated patch-clamp recordings in rat brain slices. Experimental procedures in that study were conducted either in Oxford in accordance with the Animals (Scientific Procedures) Act, 1986 (United Kingdom), or in Bordeaux according to institutional guidelines and the European Communities Council Directive 86/609/EEC and its successor 2010/63/EU. During these recordings, the slices were perfused continuously with oxygenated artificial cerebrospinal fluid at 35°C–37°C. Firing rates were recorded as a function of injected current for 18 prototypic neurons (expressed PV but not FoxP2) and 18 arkypallidal neurons (expressed FoxP2 but not PV) (<xref ref-type="fig" rid="pcbi.1005004.g003">Fig 3A</xref>). In these measurements, the depolarising current injection was gradually increased in magnitude until a point at which the neuron was unable to follow (by firing well-defined action potentials). To avoid excluding any neurons from the analysis, the average f-I curve for a given type of neuron was computed for the range in which all the studied neurons of this type were able to respond. All prototypic and arkypallidal neurons responded to currents up to 150 pA and 225 pA respectively, and hence the average f-I curves were computed up to these values. For each value of current, the firing rate was measured over 2 s interval during which the current was injected (<xref ref-type="fig" rid="pcbi.1005004.g003">Fig 3C</xref>). Additionally, the rate of autonomous firing was measured (<xref ref-type="fig" rid="pcbi.1005004.g003">Fig 3B</xref>), that is, the firing present with 0 current injection in the presence of receptor antagonists [<xref ref-type="bibr" rid="pcbi.1005004.ref019">19</xref>].</p>
<fig id="pcbi.1005004.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005004.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Autonomous firing and driven responses of molecularly-identified GPe neurons.</title>
<p><bold>(A)</bold> After recording, all neurons were labelled with biocytin, recovered and tested for expression of parvalbumin (PV) and forkhead box protein 2 (FoxP2). Prototypic GPe neurons (left) expressed PV but not FoxP2, whereas arkypallidal neurons (right) expressed FoxP2 but not PV. Scale bars = 20 μm. <bold>(B)</bold> Typical examples of the autonomous firing of a prototypic neuron (left) and an arkypallidal neuron (right). <bold>(C)</bold> Typical examples of the driven activity of a prototypic neuron (left) and arkypallidal neuron (right). Same neurons as shown in A and B. <bold>(D)</bold> Average f-I curves of prototypic and arkypallidal neurons recorded <italic>in vitro</italic>. The error bars show the standard error of the mean.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005004.g003" xlink:type="simple"/>
</fig>
<p>The average f-I curves of all prototypic and all arkypallidal neurons are shown in <xref ref-type="fig" rid="pcbi.1005004.g003">Fig 3D</xref>, and the f-I curves of individual neurons are shown in <xref ref-type="fig" rid="pcbi.1005004.g004">Fig 4B</xref> (the data is provided in <xref ref-type="supplementary-material" rid="pcbi.1005004.s001">S1 Table</xref>). One characteristic we expected was that, for low values of excitatory input (nominally from STN) the activity of prototypic neurons should be higher than that of the arkypallidal neurons. This expectation agrees with the experimental data (see <xref ref-type="fig" rid="pcbi.1005004.g003">Fig 3D</xref>), as the average rate of the autonomous firing of prototypic neurons (18.0 spikes/s) was higher than that of arkypallidal neurons (5.1 spikes/s), and this difference was highly significant (p = 0.0001, unpaired t-test).</p>
<fig id="pcbi.1005004.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005004.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Linearity and non-linearity of f-I curves of GPe neurons.</title>
<p><bold>(A)</bold> Comparison of quality of fits of f-I curves of arkypallidal or prototypic neurons to 4 different functions (linear, logarithmic, a combination of logarithmic and linear, or a power function). The fits were assessed by root mean squared error (RMSE). Note that the best fits (lowest RMSE values) arose from using the combination of logarithmic and linear as well as from the power function. Plots indicate medians plus IQRs for all neurons of each type. <bold>(B)</bold> Individual fits for all f-I curves recorded in arkypallidal (n = 18) and prototypic (n = 18) neurons. Traces are sorted from most linear (top left) to logarithmic (bottom right) for each population. Only positive responses are considered, since log <italic>x</italic> is undefined for <italic>x≤0</italic>. In the displays showing the most linear and the most logarithmic neurons, the values of coefficients in fitted function <italic>f</italic> = <italic>a</italic> + <italic>bI</italic> + <italic>c</italic>log<italic>I</italic> are printed. The logarithmic coefficient <italic>c</italic> has relatively high values even for the most linear neurons, because function log<italic>I</italic> has much smaller range for a given input than the linear function <italic>I</italic>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005004.g004" xlink:type="simple"/>
</fig>
<p>To test the linear or logarithmic behaviour of GPe neurons, we compared the fitting quality of different functions to the f-I curves of each neuron. We obtained the best fitting parameters <italic>a</italic>, <italic>b</italic> and <italic>c</italic> for different functions (linear <italic>f</italic> = <italic>a + bI</italic>, logarithmic <italic>f</italic> = <italic>a + b</italic>log<italic>I</italic>, a combination of both functions <italic>f</italic> = <italic>a</italic> + <italic>bI + c</italic>log<italic>I</italic>, or a power function <italic>f</italic> = <italic>a</italic>(<italic>I</italic> + <italic>b</italic>)<sup><italic>c</italic></sup>) by minimizing the root mean squared error (RMSE) between the actual and the predicted firing rates over the range of positive input currents for each neuron. To help visually asses the shape of f-I curves in <xref ref-type="fig" rid="pcbi.1005004.g004">Fig 4B</xref>, we ordered the neurons according to a bias for linear fit, defined as a ratio of RMSE between linear and logarithmic fits. We found that all f-I curves can be well explained by a combination of linear and logarithmic functions (shown as solid curves in <xref ref-type="fig" rid="pcbi.1005004.g004">Fig 4B</xref>; average r<sup>2</sup> for arkypallidal and prototypic neurons were 0.998 and 0.994 with standard deviations 0.0041 and 0.013). Furthermore, the f-I curves ranged from almost fully linear to clearly logarithmic (i.e. very low values of linear coefficient <italic>b</italic> in function <italic>f</italic> = <italic>a</italic> + <italic>bI + c</italic>log<italic>I</italic>). The power function could describe the f-I curves equally well (<xref ref-type="fig" rid="pcbi.1005004.g004">Fig 4A</xref>) as both a power function and a combination of linear and logarithmic functions can take a similar, concave shape. To verify whether the diversity of the shapes of f-I curves is not an artefact stemming from differences in the recording quality of individual neurons, we computed the correlation between the bias for linear fit and the series resistances during perforated-patch recordings, which was not significant.</p>
<p>Contrary to our expectations, we did not find statistically significant differences in the linearity of the f-I curves of prototypic and arkypallidal neurons (the linearity was quantified as the ratio of RMSE between linear and logarithmic fits). Indeed, both populations included neurons that lied within a continuum ranging from highly linear to highly logarithmic (<xref ref-type="fig" rid="pcbi.1005004.g004">Fig 4B</xref>). Even though this third expected characteristic was not present, it is striking that the f-I curves of the GPe neurons range from the linear to the logarithmic, which are the two components of <xref ref-type="disp-formula" rid="pcbi.1005004.e015">Eq 15</xref> that describe the predicted computation in GPe.</p>
</sec>
<sec id="sec010">
<title>Connections between prototypic GPe neurons linearize their response profile</title>
<p>Although not all prototypic neurons had linear response curves, their reciprocal connections may contribute to adjusting the shape of their response profiles (these connections have been experimentally observed, but were not initially included in our theoretical network shown in <xref ref-type="fig" rid="pcbi.1005004.g002">Fig 2B</xref>). We now show that the mutual inhibitory connections within the population of prototypic neurons linearize their response profile. The intuition for this effect is provided in <xref ref-type="fig" rid="pcbi.1005004.g005">Fig 5A</xref>, which shows a hypothetical concave (or saturating) f-I curve that qualitatively resembles the average empirical response of prototypic neurons to depolarizing current injections (<xref ref-type="fig" rid="pcbi.1005004.g003">Fig 3D</xref>). Let us consider two cases of excitatory input currents. A small input current <italic>I</italic><sub>1</sub> without the mutual inhibition would produce firing <italic>f</italic><sub>1</sub>. However, with mutual inhibition, the overall input is reduced proportionally to <italic>f</italic><sub>1</sub> to a smaller value <italic>I</italic><sub>1<italic>s</italic></sub>, which gives a lower firing <italic>f</italic><sub>1<italic>s</italic></sub>. Analogously, for a higher input current <italic>I</italic><sub>2</sub> the mutual inhibition reduces the firing from <italic>f</italic><sub>2</sub> to <italic>f</italic><sub>2<italic>s</italic></sub>. Please note that the reduction in firing due to mutual inhibition in the case of small input, i.e. <italic>f</italic><sub>1</sub> –<italic>f</italic><sub>1<italic>s</italic></sub>, is more pronounced than for the case of large input, i.e. <italic>f</italic><sub>2</sub>–<italic>f</italic><sub>2<italic>s</italic></sub>. Since the reduction is more pronounced in the less linear part of the curve than the more linear one, the mutual inhibition linearizes the response profile.</p>
<fig id="pcbi.1005004.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005004.g005</object-id>
<label>Fig 5</label>
<caption>
<title>The connections between prototypic neurons linearize their response profiles.</title>
<p><bold>(A)</bold> A schematic diagram illustrating how mutual inhibition linearizes the response profile (see main text). <bold>(B)</bold> A model of a population of prototypic neurons, PRO, receiving excitatory input (I) and mutual inhibition (average weight <italic>w</italic><sup><italic>PP</italic></sup>). <bold>(C)</bold> The resulting response profiles for different levels of inhibition within the population (when <italic>w</italic><sup><italic>PP</italic></sup> = 0, there is no mutual inhibition). Note the linearization of the population response with increasing mutual inhibition.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005004.g005" xlink:type="simple"/>
</fig>
<p>To quantify the effect of mutual inhibition on response properties of prototypic neurons, we modelled the responses of a population of prototypic neurons receiving an external excitatory input <italic>I</italic> and inhibiting the neurons within the population (<xref ref-type="fig" rid="pcbi.1005004.g005">Fig 5B</xref>). Throughout the paper, we denote the strength of connections between population <italic>X</italic> and <italic>Y</italic> by <italic>w</italic><sup><italic>XY</italic></sup>, where <italic>X</italic> and <italic>Y</italic> can be <italic>P</italic> for prototypic, <italic>A</italic> for arkypallidal or <italic>S</italic> for STN. Thus, the dynamics of this population of prototypic neurons with mutual inhibition are described by the following equation:
<disp-formula id="pcbi.1005004.e021">
<alternatives>
<graphic id="pcbi.1005004.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005004.e021" xlink:type="simple"/>
<mml:math display="block" id="M21">
<mml:mrow><mml:mi>P</mml:mi><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>O</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>I</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msup><mml:mi>P</mml:mi><mml:mi>R</mml:mi><mml:mi>O</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>P</mml:mi><mml:mi>R</mml:mi><mml:mi>O</mml:mi></mml:mrow>
</mml:math>
</alternatives>
<label>(21)</label>
</disp-formula></p>
<p>In the above equation, function <italic>f</italic><sub><italic>P</italic></sub>(<italic>x</italic>) is based on the average f-I curve of prototypic neurons (see <xref ref-type="fig" rid="pcbi.1005004.g003">Fig 3D</xref>), and was defined in the following way. If <italic>x</italic> was equal to a current used in the in vitro experiment for all prototypic neurons, <italic>f</italic><sub><italic>P</italic></sub>(<italic>x</italic>) was simply equal to the average firing rate for this current. If <italic>x</italic> was between two currents tested in experiment, <italic>f</italic><sub><italic>P</italic></sub>(<italic>x</italic>) was found using linear interpolation. If <italic>x</italic> was below the lowest current tested in experiment, <italic>f</italic><sub><italic>P</italic></sub>(<italic>x</italic>) was set to 0. Finally, if <italic>x</italic> was above the range on which the average f-I curves were computed (see above), <italic>f</italic><sub><italic>P</italic></sub>(<italic>x</italic>) was set to the firing at the maximum current used with all prototypic neurons, but in all analyses below, we ensure that we do not present results relying on this value, as in this case the f-I curve is undetermined.</p>
<p>The last term (–<italic>PRO</italic>) in <xref ref-type="disp-formula" rid="pcbi.1005004.e021">Eq 21</xref> is a decay term. The value to which the variable <italic>PRO</italic> converges can be found by setting the left hand side of <xref ref-type="disp-formula" rid="pcbi.1005004.e021">Eq 21</xref> to 0, because at convergence, the value of <italic>PRO</italic> does not change. Thus we find that at convergence <italic>PRO</italic> = <italic>f</italic><sub><italic>P</italic></sub>(<italic>I</italic> − <italic>w</italic><sup><italic>PP</italic></sup> <italic>PRO</italic>). So in this model, when <italic>w</italic><sup><italic>PP</italic></sup> = 0, the activity <italic>PRO</italic> is equal to the activity determined by the f-I curve for given input <italic>I</italic>, while when we increase <italic>w</italic><sup><italic>PP</italic></sup>, we can investigate the effect of mutual inhibition on the response profile.</p>
<p>The activity of the prototypic neurons at convergence as a function of external input is shown in <xref ref-type="fig" rid="pcbi.1005004.g005">Fig 5C</xref> for different values of mutual inhibition. As the strength of the connection between prototypic neurons (<italic>w</italic><sup><italic>PP</italic></sup>) increases, their response becomes more linear. To quantify it, we computed squared correlation (<italic>R</italic><sup>2</sup>) between <italic>I</italic> and <italic>PRO</italic> for inputs <italic>I</italic>&gt;0. The <italic>R</italic><sup>2</sup> was increasing with <italic>w</italic><sup><italic>PP</italic></sup>, namely it was equal to 0.988, 0.994, 0.996 and 0.997 for <italic>w</italic><sup><italic>PP</italic></sup> equal to 0, 1, 2 and 3 respectively.</p>
</sec>
<sec id="sec011">
<title>Computations in a network of arkypallidal and prototypic GPe neurons</title>
<p>To test our main prediction, namely that a network of GPe neurons is capable of sending inhibition to STN to instantiate the function <italic>STN</italic>–log <italic>STN</italic>, we next investigated the behaviour of a realistic, multi-dimensional network including all the different neurons recorded in the arkypallidal and prototypic populations. We built a computational network embedding the 18 arkypallidal and 18 prototypic neurons with f-I curves based on experimental data, and all corresponding connections (<xref ref-type="fig" rid="pcbi.1005004.g006">Fig 6A</xref>). This included 36 excitatory connections from STN to each neuron in these two GPe sub-populations (<italic>w</italic><sub><italic>i</italic></sub><sup><italic>SA</italic></sup> and <italic>w</italic><sub><italic>i</italic></sub><sup><italic>SP</italic></sup>), and 18 inhibitory connections from each prototypic neuron back to STN (<italic>w</italic><sub><italic>i</italic></sub><sup><italic>PS</italic></sup>; these connections influence the cost function that will be introduced later). The model also included 18<sup>2</sup> inhibitory connections from arkypallidal to prototypic neurons, 18<sup>2</sup> inhibitory connections from prototypic to arkypallidal neurons, and 18<sup>2</sup> inhibitory connections between prototypic neurons, but to reduce the high dimensionality of this system, we assumed similar levels of connectivity, and constrained the weights in each group to a single value (<italic>w</italic><sup><italic>AP</italic></sup>, <italic>w</italic><sup><italic>PA</italic></sup> and <italic>w</italic><sup><italic>PP</italic></sup>). Thus the dynamics of the simulated neurons was described by:</p>
<fig id="pcbi.1005004.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005004.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Computational model of STN-GPe network.</title>
<p><bold>(A)</bold> Architecture of the model including all 18 prototypic and arkypallidal neurons recorded experimentally, and connections within GPe and with STN. <italic>w</italic><sub><italic>i</italic></sub><sup><italic>XY</italic></sup> denotes the strength of connections between population <italic>X</italic> and <italic>Y</italic>. Sub-indices indicate the individual neuron associated with each weight. Inner GPe weights linking arkypallidal and prototypic neurons are assumed identical for all connections, hence represented by a single value. <bold>(B)</bold> Illustrative examples of inhibition sent from GPe to STN i.e. <inline-formula id="pcbi.1005004.e022"><alternatives><graphic id="pcbi.1005004.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005004.e022" xlink:type="simple"/>
<mml:math display="inline" id="M22"><mml:mrow><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>18</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mi>R</mml:mi><mml:msub><mml:mi>O</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:math>
</alternatives></inline-formula>for different optimal weights (dashed yellow and green), and comparison with the desired function <italic>STN–</italic>log <italic>STN</italic> throughout the input range considered ([0.7–6]). Middle plot shows two sets of weight parameters corresponding to the top display, and the bottom display shows the range of weight parameters found in 100 runs. Weights for each population are organised from the most linear neuron’s to the most logarithmic neuron’s (left to right), highlighting the lack of preferential connections to linear or logarithmic neurons.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005004.g006" xlink:type="simple"/>
</fig>
<disp-formula id="pcbi.1005004.e023">
<alternatives>
<graphic id="pcbi.1005004.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005004.e023" xlink:type="simple"/>
<mml:math display="block" id="M23">
<mml:mrow><mml:mi>A</mml:mi><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:msub><mml:mi>K</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>18</mml:mn><mml:mo>⋅</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mi>α</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>18</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow/><mml:mrow><mml:mi>P</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:msubsup><mml:mi>P</mml:mi><mml:mi>R</mml:mi><mml:msub><mml:mi>O</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>A</mml:mi><mml:mi>R</mml:mi><mml:msub><mml:mi>K</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow>
</mml:math>
</alternatives>
<label>(22)</label>
</disp-formula>
<disp-formula id="pcbi.1005004.e024">
<alternatives>
<graphic id="pcbi.1005004.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005004.e024" xlink:type="simple"/>
<mml:math display="block" id="M24">
<mml:mrow><mml:mi>P</mml:mi><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:msub><mml:mi>O</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>18</mml:mn><mml:mo>⋅</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mi>α</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>18</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow/><mml:mrow><mml:mi>A</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msubsup><mml:mi>A</mml:mi><mml:mi>R</mml:mi><mml:msub><mml:mi>K</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mstyle><mml:mo>−</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>18</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msup><mml:mi>P</mml:mi><mml:mi>R</mml:mi><mml:msub><mml:mi>O</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>P</mml:mi><mml:mi>R</mml:mi><mml:msub><mml:mi>O</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow>
</mml:math>
</alternatives>
<label>(23)</label>
</disp-formula>
<p>In the above equations <italic>f</italic><sub><italic>Ai</italic></sub> and <italic>f</italic><sub><italic>Pi</italic></sub> denote the f-I curves based on experimental data for individual neurons (computed analogously to <italic>f</italic><sub><italic>P</italic></sub> described above). In addition, to prevent bias during the optimisation process, the STN input sent to GPe was assumed to stem from 18 identical neurons, which ensured a homogeneous number of neurons in all three populations, and normalised the weights between them to comparable ranges. For a given value of <italic>STN</italic>, these equations were solved until convergence.</p>
<p>In Eqs <xref ref-type="disp-formula" rid="pcbi.1005004.e023">22</xref> and <xref ref-type="disp-formula" rid="pcbi.1005004.e024">23</xref> the activity of STN is scaled by a constant <italic>α</italic><sub><italic>S</italic></sub> to translate it to appropriate units. As mentioned before, the variables of the model are expressed in the units of the logarithm of probability that are proportional to firing rates, and we denote the proportionality constant for STN by <italic>α</italic><sub><italic>S</italic></sub>. Thus, the firing rate of STN neurons in [spikes/s], is <italic>α</italic><sub><italic>S</italic></sub><italic>STN</italic>. The value of <italic>α</italic><sub><italic>S</italic></sub> can be estimated on the basis of published f-I curves of STN neurons. In particular, for zero input, <italic>STN</italic> = exp(0) = 1, so <italic>α</italic><sub><italic>S</italic></sub> is equal to the autonomous firing rate of STN neurons. Hence we set <italic>α</italic><sub><italic>S</italic></sub> = 17 on the basis of average autonomous firing rate of 7 STN neurons for which the f-I curves have been published [<xref ref-type="bibr" rid="pcbi.1005004.ref028">28</xref>,<xref ref-type="bibr" rid="pcbi.1005004.ref029">29</xref>] and have been fitted with exponential functions [<xref ref-type="bibr" rid="pcbi.1005004.ref009">9</xref>].</p>
<p>We found the weights for the 57 connection parameter through constrained nonlinear optimisation, which minimised the difference between the overall inhibition sent back to STN from GPe and the desired function <italic>STN</italic>–log <italic>STN</italic> in the input range considered [0.7–6] (a.u.).</p>
<disp-formula id="pcbi.1005004.e025">
<alternatives>
<graphic id="pcbi.1005004.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005004.e025" xlink:type="simple"/>
<mml:math display="block" id="M25">
<mml:mrow><mml:mi>C</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>0.7</mml:mn></mml:mrow><mml:mn>6</mml:mn></mml:munderover><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="normal">log</mml:mi><mml:mspace width="0.25em"/><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>18</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mi>R</mml:mi><mml:msub><mml:mi>O</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mstyle></mml:mrow>
</mml:math>
</alternatives>
<label>(24)</label>
</disp-formula>
<p>Similarly as above, the feedback from prototypic neurons is divided by <italic>α</italic><sub><italic>S</italic></sub> in <xref ref-type="disp-formula" rid="pcbi.1005004.e025">Eq 24</xref> to bring it back from [spikes/s] to the units of the model. We note that the precise value of <italic>α</italic><sub><italic>S</italic></sub> does not affect the ability to find weights of connections, because it just scales other free parameters (<italic>w</italic><sub><italic>i</italic></sub><sup><italic>SA</italic></sup>, <italic>w</italic><sub><italic>i</italic></sub><sup><italic>SP</italic></sup>, <italic>w</italic><sub><italic>i</italic></sub><sup><italic>PS</italic></sup> in Eqs <xref ref-type="disp-formula" rid="pcbi.1005004.e023">22</xref>, <xref ref-type="disp-formula" rid="pcbi.1005004.e024">23</xref> and <xref ref-type="disp-formula" rid="pcbi.1005004.e025">24</xref>, respectively), so changing <italic>α</italic><sub><italic>S</italic></sub> would only result in rescaling these parameters. We only include <italic>α</italic><sub><italic>S</italic></sub> to give the weight parameters the same scale, so their values could be compared.</p>
<p>We completed 100 runs of this optimisation process for weights initialised at random values ranging between 0 and 0.3. For all runs, the optimiser converged to set of weights that exhibited a behaviour following our desired output function (average <italic>Cost</italic> was 0.0214 with standard deviation 0.017). For each run, however, the parameters found showed clear differences, indicating that distinct set of weights are capable of producing similarly optimal output functions (i.e. close approximation of <italic>STN</italic>–log <italic>STN</italic>) in such a high dimensional system. Two examples of synaptic weights and resulting outputs from the network are shown in <xref ref-type="fig" rid="pcbi.1005004.g006">Fig 6B</xref>.</p>
<p>Regardless of differences between individual runs, we sought to further characterise whether any structure underlies the weights found through global optimisation. For example, one could expect the connections from STN to arkypallidal neurons to be stronger for neurons with logarithmic f-I curves, in accordance with our initial suggestion on how the function <italic>STN</italic>–log <italic>STN</italic> is computed (<xref ref-type="fig" rid="pcbi.1005004.g002">Fig 2B</xref>). The means and standard deviations of parameters found in all 100 optimisation runs is shown in <xref ref-type="fig" rid="pcbi.1005004.g006">Fig 6B</xref> (bottom panel), where the parameters in each group are sorted by how linear the f-I curve of each neuron is. Thus the preferential STN projections to logarithmic arkypallidal neurons would manifest in the figure in higher weights on the right of the first grey area. <xref ref-type="fig" rid="pcbi.1005004.g006">Fig 6B</xref> did not highlight any specific patterns, neither for linear nor for logarithmic neurons in any of the two populations of GPe neurons. This indicates that the network considered is so flexible that it contributes to optimal action selection without requiring clear patterns in the way linear and logarithmic neurons are interconnected.</p>
<p>Among the estimated weights, the lowest value was on average assigned to a connection from prototypic to arkypallidal neurons (<xref ref-type="fig" rid="pcbi.1005004.g006">Fig 6B</xref>). The low weight value was obtained probably because this connection was not necessary to compute function <italic>STN</italic>–log <italic>STN</italic> (it was not included in the hypothetical network of <xref ref-type="fig" rid="pcbi.1005004.g002">Fig 2B</xref>).</p>
</sec>
<sec id="sec012">
<title>Dynamics of STN-GPe network</title>
<p>Finally, we sought to evaluate the dynamics of the entire STN-GPe network in response to varying cortical input. We evaluated the transient behaviour of the network (weights were set to one solution found during the optimization) when considering realistic time constants for firing rates (<italic>τ</italic>) and realistic transmission delays (Δ<italic>t</italic>), as used in a previous model of this circuit [<xref ref-type="bibr" rid="pcbi.1005004.ref036">36</xref>]. In particular, we used the following time constant <italic>τ</italic><sub><italic>S</italic></sub> = 10 ms [<xref ref-type="bibr" rid="pcbi.1005004.ref037">37</xref>,<xref ref-type="bibr" rid="pcbi.1005004.ref038">38</xref>], <italic>τ</italic><sub><italic>A</italic></sub> = <italic>τ</italic><sub><italic>P</italic></sub> = 15 ms [<xref ref-type="bibr" rid="pcbi.1005004.ref039">39</xref>] and transmission delays Δ<italic>t</italic><sub><italic>SA</italic></sub> = Δ<italic>t</italic><sub><italic>SP</italic></sub> = 2.8 ms, Δ<italic>t</italic><sub><italic>PS</italic></sub> = 1.3 ms and Δ<italic>t</italic><sub><italic>PA</italic></sub> = Δ<italic>t</italic><sub><italic>PP</italic></sub> = Δ<italic>t</italic><sub><italic>AP</italic></sub> = 1 ms [<xref ref-type="bibr" rid="pcbi.1005004.ref037">37</xref>,<xref ref-type="bibr" rid="pcbi.1005004.ref039">39</xref>]. The dynamics of the model are described by:
<disp-formula id="pcbi.1005004.e026">
<alternatives>
<graphic id="pcbi.1005004.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005004.e026" xlink:type="simple"/>
<mml:math display="block" id="M26">
<mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:mi>S</mml:mi><mml:mover accent="true"><mml:mi>T</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal">exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mi>T</mml:mi><mml:mi>X</mml:mi><mml:mo>−</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>18</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle><mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mi>R</mml:mi><mml:msub><mml:mi>O</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>N</mml:mi></mml:mrow>
</mml:math>
</alternatives>
<label>(25)</label>
</disp-formula>
<disp-formula id="pcbi.1005004.e027">
<alternatives>
<graphic id="pcbi.1005004.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005004.e027" xlink:type="simple"/>
<mml:math display="block" id="M27">
<mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mi>P</mml:mi><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:msub><mml:mi>O</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>18</mml:mn><mml:mo>⋅</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mi>α</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>18</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msup><mml:mi>A</mml:mi><mml:mi>R</mml:mi><mml:msub><mml:mi>K</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle><mml:mo>−</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>18</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msup><mml:mi>P</mml:mi><mml:mi>R</mml:mi><mml:msub><mml:mi>O</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>P</mml:mi><mml:mi>R</mml:mi><mml:msub><mml:mi>O</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow>
</mml:math>
</alternatives>
<label>(26)</label>
</disp-formula>
<disp-formula id="pcbi.1005004.e028">
<alternatives>
<graphic id="pcbi.1005004.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005004.e028" xlink:type="simple"/>
<mml:math display="block" id="M28">
<mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mi>A</mml:mi><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:msub><mml:mi>K</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>18</mml:mn><mml:mo>⋅</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mi>α</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>18</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:msup><mml:mi>P</mml:mi><mml:mi>R</mml:mi><mml:msub><mml:mi>O</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>A</mml:mi><mml:mi>R</mml:mi><mml:msub><mml:mi>K</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow>
</mml:math>
</alternatives>
<label>(27)</label>
</disp-formula></p>
<p>We run multiple simulations and studied the behaviour of the system for varying cortical input values in the range <italic>CTX</italic> ϵ [0.7–6]. Since the above network includes only a single group of STN neurons (selective for a single action), the desired value to which STN should converge according to <xref ref-type="disp-formula" rid="pcbi.1005004.e007">Eq 7</xref> for <italic>N</italic> = 1 is simply <italic>STN</italic> = <italic>CTX</italic>. We found that the network properly converged to the expected value after a transient time period (the curves in the second display from the top in <xref ref-type="fig" rid="pcbi.1005004.g007">Fig 7A</xref> converge to the values in the top display), except for a very high cortical input (<italic>CTX</italic> = 6). For such high input the network started oscillating and did not converge. Oscillations are known to emerge in networks of mutually connected excitatory and inhibitory neural populations like the STN-GPe network under certain conditions [<xref ref-type="bibr" rid="pcbi.1005004.ref040">40</xref>,<xref ref-type="bibr" rid="pcbi.1005004.ref041">41</xref>]. One of necessary conditions is a strong reaction of neurons in one population to changes in activity of the other [<xref ref-type="bibr" rid="pcbi.1005004.ref040">40</xref>,<xref ref-type="bibr" rid="pcbi.1005004.ref041">41</xref>], and the oscillations emerged in <xref ref-type="fig" rid="pcbi.1005004.g007">Fig 7A</xref> for the high cortical input, as then the STN neurons were operating in steeper range of their exponential f-I curve, and thus were more reactive to their inputs from GPe.</p>
<fig id="pcbi.1005004.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005004.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Dynamical behaviour of STN-GPe network.</title>
<p><bold>(A)</bold> Output responses of STN, Arkypallidal and Prototypic populations for a sequence of cortical (<italic>CTX</italic>) input steps ranging from 1 to 6 (a.u.). The output from arkypallidal neurons is taken as <italic>w</italic><sup><italic>AP</italic></sup>&lt;<italic>ARK</italic><sub><italic>i</italic></sub>(<italic>t</italic>)&gt;<sub><italic>i</italic></sub>, while the output from prototypic neurons was taken as <inline-formula id="pcbi.1005004.e029"><alternatives><graphic id="pcbi.1005004.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005004.e029" xlink:type="simple"/>
<mml:math display="inline" id="M29"><mml:mrow><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>18</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mi>R</mml:mi><mml:msub><mml:mi>O</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:math>
</alternatives></inline-formula>. Black and blue traces correspond to the behaviour of the system without and with delays respectively. <bold>(B)</bold> Evaluation of the effect of delays in the system in response to varying cortical input. As delays increase (and delay values approach those reported in literature), the cortical input for which the system becomes unstable decreases.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005004.g007" xlink:type="simple"/>
</fig>
<p>In contrast, the same network always converged to the appropriate values in the absence of delays, as the delays are necessary for oscillations in the model of STN-GPe network [<xref ref-type="bibr" rid="pcbi.1005004.ref040">40</xref>,<xref ref-type="bibr" rid="pcbi.1005004.ref041">41</xref>]. We further analysed the influence of delays in this behaviour (<xref ref-type="fig" rid="pcbi.1005004.g007">Fig 7B</xref>). We compared the output of the network for delays values as reported in literature, without delays, and for different values in between, when cortical input values followed a step function (steps of 2 cortical units) starting at different input values (2, 3, 4 and 5). We found that the level of cortical input for which the system became unstable progressively decreased as delays increased.</p>
</sec>
<sec id="sec013">
<title>Analytic description of the computations in GPe</title>
<p>Beyond the simulated demonstration of how a GPe network, comprised of interconnected prototypic and arkypallidal neurons with experimentally observed f-I curves, is able to compute the function required for optimal action selection, it is also useful to show it analytically, as it will allow us to see in the next subsection how the connections between GPe and striatum can be incorporated into the model.</p>
<p>In order to demonstrate the computation analytically we consider a simplified model of the GPe circuit. We assume that the arkypallidal neurons have f-I curves described by a combination of linear and logarithmic terms (as <xref ref-type="fig" rid="pcbi.1005004.g004">Fig 4B</xref> shows that this function well describes experimentally observed curves):
<disp-formula id="pcbi.1005004.e030">
<alternatives>
<graphic id="pcbi.1005004.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005004.e030" xlink:type="simple"/>
<mml:math display="block" id="M30">
<mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mi>I</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mi mathvariant="normal">log</mml:mi><mml:mi>I</mml:mi></mml:mrow>
</mml:math>
</alternatives>
<label>(28)</label>
</disp-formula></p>
<p>For simplicity, we will assume the response of prototypic neurons could be described as a linear function of their input, as we demonstrated that the mutual inhibitory connections among the prototypic neurons linearize their response profile (<xref ref-type="fig" rid="pcbi.1005004.g005">Fig 5</xref>).</p>
<disp-formula id="pcbi.1005004.e031">
<alternatives>
<graphic id="pcbi.1005004.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005004.e031" xlink:type="simple"/>
<mml:math display="block" id="M31">
<mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mi>I</mml:mi></mml:mrow>
</mml:math>
</alternatives>
<label>(29)</label>
</disp-formula>
<p>We consider a network with the simplified connectivity shown in <xref ref-type="fig" rid="pcbi.1005004.g002">Fig 2B</xref>. Thus we do not consider connections among the prototypic neurons as their role has already been incorporated in assuming linear <italic>f</italic><sub><italic>P</italic></sub>, and we do not consider connections from prototypic to arkypallidal neurons, as <xref ref-type="fig" rid="pcbi.1005004.g006">Fig 6B</xref> shows that this connection had a relatively low weight when the GPe network computed <italic>STN</italic>–log <italic>STN</italic>. The activity of prototypic neurons becomes:
<disp-formula id="pcbi.1005004.e032">
<alternatives>
<graphic id="pcbi.1005004.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005004.e032" xlink:type="simple"/>
<mml:math display="block" id="M32">
<mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>P</mml:mi><mml:mi>R</mml:mi><mml:mi>O</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msup><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msup><mml:mi>A</mml:mi><mml:mi>R</mml:mi><mml:mi>K</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="3.25em"/><mml:msub><mml:mi>a</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msup><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mi>a</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mi>b</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:msup><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mi>c</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mi mathvariant="normal">log</mml:mi><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:msup><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>N</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable>
</mml:math>
</alternatives>
<label>(30)</label>
</disp-formula></p>
<p>Rearranging the term we obtain:
<disp-formula id="pcbi.1005004.e033">
<alternatives>
<graphic id="pcbi.1005004.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005004.e033" xlink:type="simple"/>
<mml:math display="block" id="M33">
<mml:mrow><mml:mi>P</mml:mi><mml:mi>R</mml:mi><mml:mi>O</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:msub><mml:mi>b</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:msub><mml:mi>c</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msup><mml:mi mathvariant="normal">log</mml:mi><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:msup><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:msub><mml:mi>a</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msup></mml:mrow>
</mml:math>
</alternatives>
<label>(31)</label>
</disp-formula></p>
<p>It is easy to see that the output of prototypic neurons <italic>w</italic><sup><italic>PS</italic></sup><italic>PRO</italic> will become equal to <italic>STN</italic>–log <italic>STN</italic>, when the parameters satisfy the following constraints:
<disp-formula id="pcbi.1005004.e034">
<alternatives>
<graphic id="pcbi.1005004.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005004.e034" xlink:type="simple"/>
<mml:math display="block" id="M34">
<mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:msub><mml:mi>b</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:msub><mml:mi>c</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:msub><mml:mi>a</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(32)</label>
</disp-formula></p>
<p>This analysis shows that even if the f-I curves in GPe have a generalized form described by Eqs <xref ref-type="disp-formula" rid="pcbi.1005004.e030">28</xref> and <xref ref-type="disp-formula" rid="pcbi.1005004.e031">29</xref>, by setting the weights to the values satisfying the above conditions, the GPe can compute the function <italic>STN</italic>–log <italic>STN</italic>.</p>
</sec>
<sec id="sec014">
<title>Connections between GPe and striatum</title>
<p>The model presented so far describes the computations only in a subset of nuclei in the larger cortico-basal-ganglia network that, when embodied in <xref ref-type="fig" rid="pcbi.1005004.g001">Fig 1</xref>, does not include the connections between GPe and striatum. However, there are prominent projections from the striatum to the GPe [<xref ref-type="bibr" rid="pcbi.1005004.ref002">2</xref>,<xref ref-type="bibr" rid="pcbi.1005004.ref003">3</xref>], and arkypallidal neurons densely innervate the striatum [<xref ref-type="bibr" rid="pcbi.1005004.ref020">20</xref>]. We now discuss how these bidirectional connections can be included in the model.</p>
<p>The striatal projection neurons can be divided into those expressing type 1 dopamine receptors or type 2 dopamine receptors (D1 and D2), and they are thought to be involved in initiation and inhibition of actions, respectively. Let us first discuss the D2 striatal neurons for which GPe is the main target of their projections [<xref ref-type="bibr" rid="pcbi.1005004.ref003">3</xref>]. The connection from the D2 neurons to GPe is a critical part of the so-called indirect pathway (<xref ref-type="fig" rid="pcbi.1005004.g008">Fig 8A</xref>) involved in inhibiting the actions that in the past resulted in negative feedback [<xref ref-type="bibr" rid="pcbi.1005004.ref004">4</xref>]. Although there are no anatomical data that definitively describe to which GPe cell type(s) the D2 striatal neurons project, <xref ref-type="fig" rid="pcbi.1005004.g008">Fig 8A</xref> includes connections from D2 neurons to prototypic neurons, as only such connections would allow D2 striatal neurons to inhibit actions (if the D2 neurons projected to arkypallidal neurons, their activity would facilitate rather than inhibit action selection, because the pathway D2-ARK-PRO-STN-OUT-TH would include 4 inhibitory connections, so it would be effectively excitatory). The striatal D2 neurons are not included in the optimal action selection model (see <xref ref-type="fig" rid="pcbi.1005004.g001">Fig 1</xref>), because the MSPRT framework assumes that one of the actions is correct and should be taken on a given trial. By contrast, in certain situations, any action may lead to negative consequences, and the D2 striatal neurons are likely to ensure that no action is then taken. To include the D2 striatal neurons and their projections to GPe, the model has to be extended beyond the MSPRT framework, which is the subject of ongoing work.</p>
<fig id="pcbi.1005004.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005004.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Connectivity between GPe and striatum.</title>
<p>Rectangles denote neural populations: D1 and D2 label striatal neurons with D1 and D2 receptors, while PRO and ARK label prototypic and arkypallidal neurons respectively. Arrows and lines ending with circles denote excitatory and inhibitory connections respectively. Black and coloured parts of the circuit highlight the pathways illustrated in each panel. Purple pathways denote routes alternative to those shown in orange. The connections between striatum and GPe are dashed to indicate that it is not known which groups of neurons in striatum and GPe are interconnected–the figure shows only the hypothetical connections discussed in the main text. <bold>(A)</bold> Part of the indirect pathway connected with movement inhibition. <bold>(B)</bold> Routes providing evidence for actions to STN. <bold>(C)</bold> Routes providing normalization to the striatum.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005004.g008" xlink:type="simple"/>
</fig>
<p>It has been also reported that GPe receives input from most of the striatal neurons that target the output nuclei of the basal ganglia [<xref ref-type="bibr" rid="pcbi.1005004.ref042">42</xref>], i.e. the D1 striatal neurons. These striatal neurons are included in the model shown in <xref ref-type="fig" rid="pcbi.1005004.g001">Fig 1</xref>, but their projection to GPe is not. This pathway may form an alternative route by which the evidence for actions represented in cortex and striatum can be provided to STN. Please note that if the D1 striatal neurons project to prototypic neurons, the pathway CTX-D1-PRO-STN involves 2 inhibitory connections so it is effectively excitatory, similarly as the hyperdirect pathway CTX-STN (<xref ref-type="fig" rid="pcbi.1005004.g008">Fig 8B</xref>). Note that this would not be the case if striatal D1 neurons projected to arkypallidal neurons, as connection D1-ARK-PRO-STN would be effectively inhibitory, thus for simplicity we only consider the connections from striatal D1 neurons to prototypic GPe neurons.</p>
<p>We now show that adding the connection from striatal D1 neurons to prototypic GPe neurons, while also appropriately reducing the connection from cortex to STN, would not change the activity in the STN in the model, and hence the model would still implement optimal action selection.</p>
<p>Let us consider a modified version of the model in which we allow arbitrary weights of connections from cortex to STN, which we denote by <italic>w</italic><sup><italic>CS</italic></sup>, and from striatal D1 neurons to prototypic neurons, which we denote by <italic>w</italic><sup><italic>XP</italic></sup>. Since we assume that the activity of striatal D1 neurons reflects the cortical inputs, the activity of STN and GPe populations in this model becomes:
<disp-formula id="pcbi.1005004.e035">
<alternatives>
<graphic id="pcbi.1005004.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005004.e035" xlink:type="simple"/>
<mml:math display="block" id="M35">
<mml:mrow><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="normal">exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msup><mml:mi>C</mml:mi><mml:mi>T</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msup><mml:mi>P</mml:mi><mml:mi>R</mml:mi><mml:msub><mml:mi>O</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(33)</label>
</disp-formula>
<disp-formula id="pcbi.1005004.e036">
<alternatives>
<graphic id="pcbi.1005004.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005004.e036" xlink:type="simple"/>
<mml:math display="block" id="M36">
<mml:mrow><mml:mi>P</mml:mi><mml:mi>R</mml:mi><mml:msub><mml:mi>O</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msup><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msup><mml:mi>A</mml:mi><mml:mi>R</mml:mi><mml:msub><mml:mi>K</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>X</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msup><mml:mi>C</mml:mi><mml:mi>T</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(34)</label>
</disp-formula>
<disp-formula id="pcbi.1005004.e037">
<alternatives>
<graphic id="pcbi.1005004.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005004.e037" xlink:type="simple"/>
<mml:math display="block" id="M37">
<mml:mrow><mml:mi>A</mml:mi><mml:mi>R</mml:mi><mml:msub><mml:mi>K</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:msup><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>N</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(35)</label>
</disp-formula></p>
<p>The computation in this modified model and the one described in the Models Section will remain the same if the activity in STN described in <xref ref-type="disp-formula" rid="pcbi.1005004.e035">Eq 33</xref> is the same as that described by <xref ref-type="disp-formula" rid="pcbi.1005004.e016">Eq 16</xref>. Equating the arguments of exponentials in the two equations, one obtains the following condition:
<disp-formula id="pcbi.1005004.e038">
<alternatives>
<graphic id="pcbi.1005004.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005004.e038" xlink:type="simple"/>
<mml:math display="block" id="M38">
<mml:mrow><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msup><mml:mi>C</mml:mi><mml:mi>T</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msup><mml:mi>P</mml:mi><mml:mi>R</mml:mi><mml:msub><mml:mi>O</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>C</mml:mi><mml:mi>T</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="normal">log</mml:mi><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>N</mml:mi></mml:mrow>
</mml:math>
</alternatives>
<label>(36)</label>
</disp-formula></p>
<p>Substituting Eqs <xref ref-type="disp-formula" rid="pcbi.1005004.e036">34</xref> and <xref ref-type="disp-formula" rid="pcbi.1005004.e037">35</xref>, <xref ref-type="disp-formula" rid="pcbi.1005004.e030">28</xref> and <xref ref-type="disp-formula" rid="pcbi.1005004.e031">29</xref>, and the conditions of <xref ref-type="disp-formula" rid="pcbi.1005004.e034">Eq 32</xref>, we get:
<disp-formula id="pcbi.1005004.e039">
<alternatives>
<graphic id="pcbi.1005004.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005004.e039" xlink:type="simple"/>
<mml:math display="block" id="M39">
<mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>X</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mi>b</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>C</mml:mi><mml:mi>T</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="normal">log</mml:mi><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mi>C</mml:mi><mml:mi>T</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="normal">log</mml:mi><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>N</mml:mi></mml:mrow>
</mml:math>
</alternatives>
<label>(37)</label>
</disp-formula></p>
<p>It is evident that the above condition is satisfied when:
<disp-formula id="pcbi.1005004.e040">
<alternatives>
<graphic id="pcbi.1005004.e040g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005004.e040" xlink:type="simple"/>
<mml:math display="block" id="M40">
<mml:mrow><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>X</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow>
</mml:math>
</alternatives>
<label>(38)</label>
</disp-formula></p>
<p>Thus, if the GPe neurons respond to their inputs as described by Eqs <xref ref-type="disp-formula" rid="pcbi.1005004.e030">28</xref> and <xref ref-type="disp-formula" rid="pcbi.1005004.e031">29</xref>, the computations in the model do not change if a portion of cortical input is delivered to the prototypic neurons (via striatum) rather than to STN.</p>
<p>What could be the benefit of the existence of two alternative routes by which the evidence for actions can be provided to the STN? The version of the model presented in this paper describes decision making in highly practiced tasks. It assumes that the mapping between stimuli and actions is already consolidated in cortico-cortical connections, and that information from sensory cortex is integrated with prior evidence in the frontal cortex (see <xref ref-type="fig" rid="pcbi.1005004.g001">Fig 1</xref>). Thus the direct connection from frontal cortex to STN is the fastest route to provide the integrated evidence for actions to STN. However, experimental data [<xref ref-type="bibr" rid="pcbi.1005004.ref043">43</xref>] suggest that while acquiring a task the stimulus-response mapping is initially learnt in striatum, and many computational models of this learning process have been proposed [<xref ref-type="bibr" rid="pcbi.1005004.ref004">4</xref>,<xref ref-type="bibr" rid="pcbi.1005004.ref044">44</xref>]. Consequently, a version of the optimal action selection model describing newly learnt tasks [<xref ref-type="bibr" rid="pcbi.1005004.ref010">10</xref>] assumes that the information brought by stimulus is integrated with prior evidence in the striatum. Thus in this case the connection D1-PRO-STN is a fast route to provide integrated evidence to STN (otherwise it would have to go via D1-OUT-TH-CTX-STN). Thus in summary, the two alternative routes to STN could allow fast information transfer to STN in different phases of task acquisition.</p>
<p>It has been also shown that arkypallidal neurons innervate striatum to a much larger extent than prototypic neurons [<xref ref-type="bibr" rid="pcbi.1005004.ref020">20</xref>]. Moreover, arkypallidal neurons are the only type of GPe neuron that has been shown so far to innervate striatal projection neurons [<xref ref-type="bibr" rid="pcbi.1005004.ref020">20</xref>]. This connection could provide a quick route for the STN feedback to reach the striatum (<xref ref-type="fig" rid="pcbi.1005004.g008">Fig 8C</xref>) and thus normalize the probabilities of actions represented in striatum. Without this connection, the feedback from STN would need to take a long route via thalamus and cortex (<xref ref-type="fig" rid="pcbi.1005004.g008">Fig 8C</xref>). We show below that adding the connection from arkypallidal neurons to striatal D1 neurons and appropriately reducing the connections from arkypallidal neurons to STN (via prototypic neurons) would not change the activity in the output nuclei in the model, and hence the model would still implement optimal action selection (it is not known whether the arkypallidal neurons project to D1 and/or D2 striatal neurons, but we only consider here the projections to D1 neurons, as the D2 neurons are not included in the model in the MSPRT framework–see above).</p>
<p>Let us consider a modified version of the model, in which we allow arbitrary strengths of connections from arkypallidal neurons to D1 striatal neurons, which we denote by <italic>w</italic><sup><italic>AX</italic></sup> (for simplicity we no longer consider connections from striatum to GPe). The activities of neural population in STN, GPe and output nuclei in this model become:
<disp-formula id="pcbi.1005004.e041">
<alternatives>
<graphic id="pcbi.1005004.e041g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005004.e041" xlink:type="simple"/>
<mml:math display="block" id="M41">
<mml:mrow><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="normal">exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mi>T</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msup><mml:mi>P</mml:mi><mml:mi>R</mml:mi><mml:msub><mml:mi>O</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(39)</label>
</disp-formula>
<disp-formula id="pcbi.1005004.e042">
<alternatives>
<graphic id="pcbi.1005004.e042g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005004.e042" xlink:type="simple"/>
<mml:math display="block" id="M42">
<mml:mrow><mml:mi>P</mml:mi><mml:mi>R</mml:mi><mml:msub><mml:mi>O</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msup><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msup><mml:mi>A</mml:mi><mml:mi>R</mml:mi><mml:msub><mml:mi>K</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(40)</label>
</disp-formula>
<disp-formula id="pcbi.1005004.e043">
<alternatives>
<graphic id="pcbi.1005004.e043g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005004.e043" xlink:type="simple"/>
<mml:math display="block" id="M43">
<mml:mrow><mml:mi>A</mml:mi><mml:mi>R</mml:mi><mml:msub><mml:mi>K</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:msup><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>N</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(41)</label>
</disp-formula>
<disp-formula id="pcbi.1005004.e044">
<alternatives>
<graphic id="pcbi.1005004.e044g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005004.e044" xlink:type="simple"/>
<mml:math display="block" id="M44">
<mml:mrow><mml:mi>O</mml:mi><mml:mi>U</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>C</mml:mi><mml:mi>T</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>X</mml:mi></mml:mrow></mml:msup><mml:mi>A</mml:mi><mml:mi>R</mml:mi><mml:msub><mml:mi>K</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>N</mml:mi></mml:mrow>
</mml:math>
</alternatives>
<label>(42)</label>
</disp-formula></p>
<p>Let us now recall that in the original model in the Models Section, the activity in the output nuclei was the following function of cortical activity:
<disp-formula id="pcbi.1005004.e045">
<alternatives>
<graphic id="pcbi.1005004.e045g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005004.e045" xlink:type="simple"/>
<mml:math display="block" id="M45">
<mml:mrow><mml:mi>O</mml:mi><mml:mi>U</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>C</mml:mi><mml:mi>T</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi mathvariant="normal">log</mml:mi><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:mi mathvariant="normal">exp</mml:mi><mml:mi>C</mml:mi><mml:mi>T</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:mrow>
</mml:math>
</alternatives>
<label>(43)</label>
</disp-formula></p>
<p>In order for the two models to select action in the same way, they need to have the same levels of activity in the output nuclei, thus comparing Eqs <xref ref-type="disp-formula" rid="pcbi.1005004.e044">42</xref> and <xref ref-type="disp-formula" rid="pcbi.1005004.e045">43</xref> we obtain the following condition:
<disp-formula id="pcbi.1005004.e046">
<alternatives>
<graphic id="pcbi.1005004.e046g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005004.e046" xlink:type="simple"/>
<mml:math display="block" id="M46">
<mml:mrow><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>X</mml:mi></mml:mrow></mml:msup><mml:mi>A</mml:mi><mml:mi>R</mml:mi><mml:msub><mml:mi>K</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal">log</mml:mi><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:mi mathvariant="normal">exp</mml:mi><mml:mi>C</mml:mi><mml:mi>T</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:mrow>
</mml:math>
</alternatives>
<label>(44)</label>
</disp-formula></p>
<p>We will now compute how the right hand side of <xref ref-type="disp-formula" rid="pcbi.1005004.e046">Eq 44</xref> depends on parameters of GPe neurons in the modified model. Substituting Eqs <xref ref-type="disp-formula" rid="pcbi.1005004.e042">40</xref> and <xref ref-type="disp-formula" rid="pcbi.1005004.e043">41</xref> into <xref ref-type="disp-formula" rid="pcbi.1005004.e041">39</xref>, we obtain:
<disp-formula id="pcbi.1005004.e047">
<alternatives>
<graphic id="pcbi.1005004.e047g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005004.e047" xlink:type="simple"/>
<mml:math display="block" id="M47">
<mml:mrow><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="normal">exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mi>T</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mi>f</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msup><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mi>f</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:msup><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>N</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(45)</label>
</disp-formula></p>
<p>Summing over alternatives, taking logarithm and re-arranging, we obtain:
<disp-formula id="pcbi.1005004.e048">
<alternatives>
<graphic id="pcbi.1005004.e048g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005004.e048" xlink:type="simple"/>
<mml:math display="block" id="M48">
<mml:mrow><mml:mi mathvariant="normal">log</mml:mi><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:mi mathvariant="normal">exp</mml:mi><mml:mi>C</mml:mi><mml:mi>T</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mstyle><mml:mo>=</mml:mo><mml:mi mathvariant="normal">log</mml:mi><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mi>f</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msup><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mi>f</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:msup><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>N</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(46)</label>
</disp-formula></p>
<p>Substituting Eqs <xref ref-type="disp-formula" rid="pcbi.1005004.e048">46</xref> into <xref ref-type="disp-formula" rid="pcbi.1005004.e046">44</xref> and rearranging terms we obtain a general condition that needs to be satisfied for the modified model to be equivalent to that in the Model Section:
<disp-formula id="pcbi.1005004.e049">
<alternatives>
<graphic id="pcbi.1005004.e049g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005004.e049" xlink:type="simple"/>
<mml:math display="block" id="M49">
<mml:mrow><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="normal">log</mml:mi><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mi>f</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msup><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mi>f</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:msup><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>N</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>X</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mi>f</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:msup><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>N</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(47)</label>
</disp-formula></p>
<p>Substituting Eqs <xref ref-type="disp-formula" rid="pcbi.1005004.e030">28</xref> and <xref ref-type="disp-formula" rid="pcbi.1005004.e031">29</xref>, we observe that the above condition becomes satisfied when:
<disp-formula id="pcbi.1005004.e050">
<alternatives>
<graphic id="pcbi.1005004.e050g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005004.e050" xlink:type="simple"/>
<mml:math display="block" id="M50">
<mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:msub><mml:mi>b</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>X</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:msub><mml:mi>c</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>X</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:msub><mml:mi>a</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>X</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(48)</label>
</disp-formula></p>
<p>The above conditions are generalizations of those in <xref ref-type="disp-formula" rid="pcbi.1005004.e034">Eq 32</xref>. In particular, the second condition implies, that the computations in the model will not change if a proportion of output from arkypallidal neurons is sent to striatum instead of to STN via the prototypic neurons. This rebalancing of the network does not change the computation performed by the model, but could stabilize the dynamics in the striatum-GPe network (as pathway D1-PRO-STN-ARK-D1 is effectively inhibitory so forms a negative feedback loop).</p>
</sec>
</sec>
<sec id="sec015" sec-type="conclusions">
<title>Discussion</title>
<p>This paper presents a model of the microcircuits within STN-GPe elucidating how this network could compute the logarithm of the normalization term in Bayes’ theorem that underpins the procedure for optimal action selection. The model is based on recently reported connectivity of two types of GPe neurons, and the shapes of their f-I curves. Our results suggest that GPe neurons have a diversity of structural and electrophysiological properties necessary for contributing to optimal action selection in the cortico-basal-ganglia circuit.</p>
<p>In the optimal action selection model, the input from the STN to the output nuclei plays a very similar function as in other models of action selection [<xref ref-type="bibr" rid="pcbi.1005004.ref045">45</xref>,<xref ref-type="bibr" rid="pcbi.1005004.ref046">46</xref>]. In particular, the surround inhibition model [<xref ref-type="bibr" rid="pcbi.1005004.ref045">45</xref>] assumes that when one of the actions is selected, the input from the STN ensures that others are inhibited. In the optimal action selection model, the input from STN normalizes the neural representation of probabilities so that they add up to 1. Hence it ensures that if estimated probability of one action increases, the probabilities of other action decrease (as in [<xref ref-type="bibr" rid="pcbi.1005004.ref045">45</xref>]). The conflict model [<xref ref-type="bibr" rid="pcbi.1005004.ref046">46</xref>] proposes that when neural populations selective for two different actions are both active, the input from the STN postpones the action initiation. In the optimal action selection model, the input from the STN ensures that if neurons representing two actions both receive equally high inputs, the probabilities of these two actions will not exceed 0.5, thus none of the actions will be initiated until the conflict is resolved (as in [<xref ref-type="bibr" rid="pcbi.1005004.ref046">46</xref>]). Thus the input from the STN in the optimal action selection model fulfils the roles assigned to it by previous theories, but the model additionally proposes that this input is a particular function of cortical activity (<xref ref-type="disp-formula" rid="pcbi.1005004.e007">Eq 7</xref>) which allows optimal action selection. To compute this function the STN needs to interact with the neurons in the GPe.</p>
<sec id="sec016">
<title>Interpretation of the results</title>
<p>The range of values of the weights in <xref ref-type="fig" rid="pcbi.1005004.g006">Fig 6B</xref> should not be treated as a precise prediction on the connectivity of GPe neurons, mostly because other key inputs to GPe neurons (e.g. from striatum and thalamus) were not considered to avoid introducing additional free parameters in the optimization procedure. Some of the fitted weights in <xref ref-type="fig" rid="pcbi.1005004.g006">Fig 6B</xref> did not match previous estimates of the effective connectivity of the STN-GPe network in Parkinsonism [<xref ref-type="bibr" rid="pcbi.1005004.ref036">36</xref>] (the difference occurred in the connection weights between the two types of GPe neuron as well as from STN to GPe). However, please note that the two sets of weights were based on different fitting procedures applied to different data sets recorded from different animals in different labs, and most importantly, <italic>in vitro</italic> data of neurons from dopamine-intact animals were used here, while <italic>in vivo</italic> data from animal models of Parkinson’s disease were used in the previous study [<xref ref-type="bibr" rid="pcbi.1005004.ref036">36</xref>]. Dopamine depletion may change the connectivity of prototypic and arkypallidal neurons, as it changes the relationship between their <italic>in vivo</italic> firing rates, such that the prototypic neurons, which in intact animals are more active than arkypallidal [<xref ref-type="bibr" rid="pcbi.1005004.ref018">18</xref>,<xref ref-type="bibr" rid="pcbi.1005004.ref019">19</xref>], become less active [<xref ref-type="bibr" rid="pcbi.1005004.ref019">19</xref>,<xref ref-type="bibr" rid="pcbi.1005004.ref021">21</xref>]. This parallels the differences in estimated connectivity from STN to prototypic and arkypallidal neurons, as in the present study both populations were estimated to receive similar excitation from STN (<xref ref-type="fig" rid="pcbi.1005004.g006">Fig 6B</xref>) whereas, in the previous study of the Parkinsonian STN-GPe network, prototypic neurons were estimated to receive less input from STN than arkypallidal neurons [<xref ref-type="bibr" rid="pcbi.1005004.ref036">36</xref>]. The previous estimates of effective connectivity [<xref ref-type="bibr" rid="pcbi.1005004.ref036">36</xref>] are consistent with our analysis of connections from striatum to GPe as they both suggest that prototypic neurons should receive more input from striatum than arkypallidal neurons.</p>
<p>While finding the connections of GPe neurons for which they compute function <italic>STN</italic>–log <italic>STN</italic>, we accounted for differences in the shapes of f-I curves for each neuron. Such diversity contributed to making the system high dimensional, thus enabling it to find multiple solutions to the optimisation problem. Contrary to our initial expectation, the different solutions did not exhibit a specific pattern of connectivity. Indeed, one might predict that linear prototypic neurons project to STN more strongly than logarithmic prototypic neurons project to STN. This was not the case, which highlights the flexibility and robustness of the network considered to find solutions that support optimal decision making.</p>
<p>Simulations investigating the dynamics of STN-GPe circuit (<xref ref-type="fig" rid="pcbi.1005004.g007">Fig 7</xref>) revealed that a circuit with realistic time constants and synaptic transmission delays converged to a state in which the activity of STN neurons encoded log <italic>P</italic>(<italic>S</italic>), except for high cortical input when the network produced sustained oscillations. Nevertheless, it has to be noted that weight parameters were estimated using a model without delays, so it is possible that other combinations of weights can be found for which the STN-GPe circuit performs the computation required for optimal action selection, but is more stable. Furthermore, even when the oscillations are present in <xref ref-type="fig" rid="pcbi.1005004.g007">Fig 7</xref>, the firing rate averaged over time is close to that required for the optimal action selection. It is also possible that log <italic>P</italic>(<italic>S</italic>) is encoded in the power of oscillations in STN in addition to the firing rate. The frequency of oscillations observed in <xref ref-type="fig" rid="pcbi.1005004.g007">Fig 7</xref> is close to the beta range, and the beta oscillations are thought to be involved in inhibition of movement [<xref ref-type="bibr" rid="pcbi.1005004.ref047">47</xref>] and their power in STN is increased in Parkinson’s disease [<xref ref-type="bibr" rid="pcbi.1005004.ref048">48</xref>]. Given that the feedback from STN also slows down action initiation in the optimal action selection model (e.g. in the presence of conflict–see earlier <xref ref-type="sec" rid="sec015">Discussion</xref>), its representation in the power of beta oscillations would be consistent with the akinetic properties of these oscillations.</p>
</sec>
<sec id="sec017">
<title>Future directions</title>
<p>In this paper we have shown that the connections of GPe neurons required for optimal action selection can be found. However, we have not shown how these connections arise from a self-organization process employing local plasticity rules, in which the change in a synaptic weight depends on the activities of presynaptic neurons, postsynaptic neurons and levels of neuromodulators. Developing such plasticity rules would be an important direction for future work.</p>
<p>The model presented in this paper for simplicity assumed that each GPe neuron received input from all STN neurons. Although the projections from STN to GPe are widespread [<xref ref-type="bibr" rid="pcbi.1005004.ref027">27</xref>], single STN neurons do not contact all GPe neurons. It will be important to investigate in the future if a model with a more realistic pattern of connectivity between STN and GPe can also approximate optimal action selection.</p>
<p>So far the main experimental support for the optimal action selection model comes from <italic>in vitro</italic> studies of properties of isolated basal ganglia neurons: in the original paper introducing the model [<xref ref-type="bibr" rid="pcbi.1005004.ref009">9</xref>] it was already pointed out that the f-I curves of STN neurons have exponential shape for a wide range of firing rates, and here we show that the f-I curves of two types of GPe neuron can support the computation of function <italic>STN</italic>–log <italic>STN</italic>. To provide further support for the model, it is necessary to show that neurons embedded in the circuit <italic>in vivo</italic> also behave in the predicted way. For example, one could investigate how the activity of GPe neurons <italic>in vivo</italic> depends on the activity in STN (which could, for example, be parametrically manipulated using optogenetic actuators). The model predicts that the activity of prototypic GPe neurons should be a convex function of STN activity, proportional to <italic>STN</italic>–log <italic>STN</italic>, while the activity of arkypallidal neurons should be a concave function of STN activity. As far as we are aware, this prediction is specific to the model proposed in this paper, and not made by any other model of action selection in the basal ganglia.</p>
<p>A crucial test for the optimal action selection model would involve measuring whether the average activity in the STN during decision making encodes log <italic>P</italic>(<italic>S</italic>) (see <xref ref-type="fig" rid="pcbi.1005004.g001">Fig 1</xref>). For example, human participants could be asked to perform a task equivalent to that described at the start of Models section, and the STN activity after each cue could be measured either with high resolution fMRI or via deep brain stimulation electrodes, if the study were performed with Parkinson’s patients. In that case the model would predict higher amplitude of oscillations in STN after presenting stimuli with higher <italic>P</italic>(<italic>S</italic>), because the simulations in <xref ref-type="fig" rid="pcbi.1005004.g007">Fig 7</xref> suggest that more oscillatory activity is produced with higher STN activity.</p>
<p>The framework of the model we present here could be employed in the future to investigate how the computations in the STN-GPe circuit change in cases of dysfunction, such as in Parkinson’s disease where the chronic loss of dopamine grossly disturbs circuit dynamics to impede the initiation and performance of actions. Our model emphasises that the f-I curve shapes and connection strengths of STN and GPe neurons are important for action selection. It is thus noteworthy that the shapes of STN neuron f-I curves depend on postsynaptic dopamine receptors [<xref ref-type="bibr" rid="pcbi.1005004.ref049">49</xref>], that the strengths of glutamatergic and GABAergic inputs to STN and GPe neurons are tuned by presynaptic dopamine receptors [<xref ref-type="bibr" rid="pcbi.1005004.ref050">50</xref>–<xref ref-type="bibr" rid="pcbi.1005004.ref052">52</xref>], and that the impact and structure of pallidosubthalamic connections are altered after dopamine depletion [<xref ref-type="bibr" rid="pcbi.1005004.ref053">53</xref>] as a result of homeostatic plasticity [<xref ref-type="bibr" rid="pcbi.1005004.ref054">54</xref>]. Our model also predicts that the autonomous firing rates of prototypic and arkypallidal neurons are necessarily different, with the former cell type exhibiting substantially higher rates of activity. With this in mind, it is notable that the autonomous firing of GPe neurons is grossly disturbed (and lost in a subset of neurons) in experimental Parkinsonism [<xref ref-type="bibr" rid="pcbi.1005004.ref055">55</xref>,<xref ref-type="bibr" rid="pcbi.1005004.ref056">56</xref>]. In conclusion, current evidence suggests that there are multiple ways by which dopamine loss in Parkinson’s disease could affect the input-output functions and connection strengths of STN and GPe neurons, such that, ultimately, prototypic GPe neurons might not efficiently compute the function <italic>STN–</italic>log <italic>STN</italic> that supports the optimal action selection.</p>
</sec>
</sec>
<sec id="sec018">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1005004.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005004.s001" xlink:type="simple">
<label>S1 Table</label>
<caption>
<title>Firing rate of individual neurons as a function of injected current.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>The Authors thank Alex Pavlides for reading a previous version of the manuscript and useful comments. The microscopy performed to identify GPe neurons recorded in slices was done in the Bordeaux Imaging Center of <italic>the University of Bordeaux Segalen</italic>. The help of Philippe Legros, Christel Poujol, Sébastien Marais and Magali Mondin is acknowledged.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1005004.ref001"><label>1</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Redgrave</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Prescott</surname> <given-names>TJ</given-names></name>, <name name-style="western"><surname>Gurney</surname> <given-names>K</given-names></name>. <article-title>The basal ganglia: a vertebrate solution to the selection problem?</article-title> <source>Neuroscience</source> <year>1999</year>; <volume>89</volume>: <fpage>1009</fpage>–<lpage>1023</lpage>. <object-id pub-id-type="pmid">10362291</object-id></mixed-citation></ref>
<ref id="pcbi.1005004.ref002"><label>2</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kita</surname> <given-names>H</given-names></name>. <article-title>Globus pallidus external segment</article-title>. <source>Prog Brain Res</source> <year>2007</year>; <volume>160</volume>: <fpage>111</fpage>–<lpage>133</lpage>. <object-id pub-id-type="pmid">17499111</object-id></mixed-citation></ref>
<ref id="pcbi.1005004.ref003"><label>3</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Smith</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Bevan</surname> <given-names>MD</given-names></name>, <name name-style="western"><surname>Shink</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Bolam</surname> <given-names>JP</given-names></name>. <article-title>Microcircuitry of the direct and indirect pathways of the basal ganglia</article-title>. <source>Neuroscience</source> <year>1998</year>; <volume>86</volume>: <fpage>353</fpage>–<lpage>387</lpage>. <object-id pub-id-type="pmid">9881853</object-id></mixed-citation></ref>
<ref id="pcbi.1005004.ref004"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Frank</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Seeberger</surname> <given-names>LC</given-names></name>, <name name-style="western"><surname>O'Reilly R</surname> <given-names>C</given-names></name>. <article-title>By carrot or by stick: cognitive reinforcement learning in parkinsonism</article-title>. <source>Science</source> <year>2004</year>; <volume>306</volume>: <fpage>1940</fpage>–<lpage>1943</lpage>. <object-id pub-id-type="pmid">15528409</object-id></mixed-citation></ref>
<ref id="pcbi.1005004.ref005"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gurney</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Prescott</surname> <given-names>TJ</given-names></name>, <name name-style="western"><surname>Redgrave</surname> <given-names>P</given-names></name>. <article-title>A computational model of action selection in the basal ganglia. I. A new functional anatomy</article-title>. <source>Biol Cybern</source> <year>2001</year>; <volume>84</volume>: <fpage>401</fpage>–<lpage>410</lpage>. <object-id pub-id-type="pmid">11417052</object-id></mixed-citation></ref>
<ref id="pcbi.1005004.ref006"><label>6</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Humphries</surname> <given-names>MD</given-names></name>, <name name-style="western"><surname>Stewart</surname> <given-names>RD</given-names></name>, <name name-style="western"><surname>Gurney</surname> <given-names>KN</given-names></name>. <article-title>A physiologically plausible model of action selection and oscillatory activity in the basal ganglia</article-title>. <source>J Neurosci</source> <year>2006</year>; <volume>26</volume>: <fpage>12921</fpage>–<lpage>12942</lpage>. <object-id pub-id-type="pmid">17167083</object-id></mixed-citation></ref>
<ref id="pcbi.1005004.ref007"><label>7</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Berns</surname> <given-names>GS</given-names></name>, <name name-style="western"><surname>Sejnowski</surname> <given-names>TJ</given-names></name>. <chapter-title>How the basal ganglia make decisions</chapter-title>. In: <name name-style="western"><surname>Damasio</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Damasio</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Christen</surname> <given-names>Y</given-names></name>, editors. <source>Neurobiology of decision making</source>. <publisher-loc>Berlin</publisher-loc>: <publisher-name>Springer-Verlag</publisher-name>; <year>1996</year>. pp. <fpage>101</fpage>–<lpage>114</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005004.ref008"><label>8</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Berns</surname> <given-names>GS</given-names></name>, <name name-style="western"><surname>Sejnowski</surname> <given-names>TJ</given-names></name>. <article-title>A computational model of how the basal ganglia produce sequences</article-title>. <source>J Cogn Neurosci</source> <year>1998</year>; <volume>10</volume>: <fpage>108</fpage>–<lpage>121</lpage>. <object-id pub-id-type="pmid">9526086</object-id></mixed-citation></ref>
<ref id="pcbi.1005004.ref009"><label>9</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bogacz</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Gurney</surname> <given-names>K</given-names></name>. <article-title>The basal ganglia and cortex implement optimal decision making between alternative actions</article-title>. <source>Neural Computation</source> <year>2007</year>; <volume>19</volume>: <fpage>442</fpage>–<lpage>477</lpage>. <object-id pub-id-type="pmid">17206871</object-id></mixed-citation></ref>
<ref id="pcbi.1005004.ref010"><label>10</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bogacz</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Larsen</surname> <given-names>T</given-names></name>. <article-title>Integration of reinforcement learning and optimal decision-making theories of the basal ganglia</article-title>. <source>Neural Comput</source> <year>2011</year>; <volume>23</volume>: <fpage>817</fpage>–<lpage>851</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1162/NECO_a_00103" xlink:type="simple">10.1162/NECO_a_00103</ext-link></comment> <object-id pub-id-type="pmid">21222528</object-id></mixed-citation></ref>
<ref id="pcbi.1005004.ref011"><label>11</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ditterich</surname> <given-names>J</given-names></name>. <article-title>A Comparison between Mechanisms of Multi-Alternative Perceptual Decision Making: Ability to Explain Human Behavior, Predictions for Neurophysiology, and Relationship with Decision Theory</article-title>. <source>Front Neurosci</source> <year>2010</year>; <volume>4</volume>: <fpage>184</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.3389/fnins.2010.00184" xlink:type="simple">10.3389/fnins.2010.00184</ext-link></comment> <object-id pub-id-type="pmid">21152262</object-id></mixed-citation></ref>
<ref id="pcbi.1005004.ref012"><label>12</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lepora</surname> <given-names>NF</given-names></name>, <name name-style="western"><surname>Gurney</surname> <given-names>KN</given-names></name>. <article-title>The basal ganglia optimize decision making over general perceptual hypotheses</article-title>. <source>Neural Comput</source> <year>2012</year>; <volume>24</volume>: <fpage>2924</fpage>–<lpage>2945</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1162/NECO_a_00360" xlink:type="simple">10.1162/NECO_a_00360</ext-link></comment> <object-id pub-id-type="pmid">22920846</object-id></mixed-citation></ref>
<ref id="pcbi.1005004.ref013"><label>13</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Baum</surname> <given-names>CW</given-names></name>, <name name-style="western"><surname>Veeravalli</surname> <given-names>VV</given-names></name>. <article-title>A sequential procedure for multihypothesis testing</article-title>. <source>IEEE Transactions on Information Theory</source> <year>1994</year>; <volume>40</volume>: <fpage>1996</fpage>–<lpage>2007</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005004.ref014"><label>14</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dragalin</surname> <given-names>VP</given-names></name>, <name name-style="western"><surname>Tertakovsky</surname> <given-names>AG</given-names></name>, <name name-style="western"><surname>Veeravalli</surname> <given-names>VV</given-names></name>. <article-title>Multihypothesis sequential probability ratio tests–part I: asymptotic optimality</article-title>. <source>IEEE Transactions on Information Theory</source> <year>1999</year>; <volume>45</volume>: <fpage>2448</fpage>–<lpage>2461</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005004.ref015"><label>15</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>McMillen</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Holmes</surname> <given-names>P</given-names></name>. <article-title>The dynamics of choice among multiple alternatives</article-title>. <source>Journal of Mathematical Psychology</source> <year>2006</year>; <volume>50</volume>: <fpage>30</fpage>–<lpage>57</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005004.ref016"><label>16</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ma</surname> <given-names>WJ</given-names></name>, <name name-style="western"><surname>Beck</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Latham</surname> <given-names>PE</given-names></name>, <name name-style="western"><surname>Pouget</surname> <given-names>A</given-names></name>. <article-title>Bayesian inference with probabilistic population codes</article-title>. <source>Nat Neurosci</source> <year>2006</year>; <volume>9</volume>: <fpage>1432</fpage>–<lpage>1438</lpage>. <object-id pub-id-type="pmid">17057707</object-id></mixed-citation></ref>
<ref id="pcbi.1005004.ref017"><label>17</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wei</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Rubin</surname> <given-names>JE</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>XJ</given-names></name>. <article-title>Role of the indirect pathway of the basal ganglia in perceptual decision making</article-title>. <source>J Neurosci</source> <year>2015</year>; <volume>35</volume>: <fpage>4052</fpage>–<lpage>4064</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.3611-14.2015" xlink:type="simple">10.1523/JNEUROSCI.3611-14.2015</ext-link></comment> <object-id pub-id-type="pmid">25740532</object-id></mixed-citation></ref>
<ref id="pcbi.1005004.ref018"><label>18</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dodson</surname> <given-names>PD</given-names></name>, <name name-style="western"><surname>Larvin</surname> <given-names>JT</given-names></name>, <name name-style="western"><surname>Duffell</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Garas</surname> <given-names>FN</given-names></name>, <name name-style="western"><surname>Doig</surname> <given-names>NM</given-names></name>, <etal>et al</etal>. <article-title>Distinct developmental origins manifest in the specialized encoding of movement by adult neurons of the external globus pallidus</article-title>. <source>Neuron</source> <year>2015</year>; <volume>86</volume>: <fpage>501</fpage>–<lpage>513</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuron.2015.03.007" xlink:type="simple">10.1016/j.neuron.2015.03.007</ext-link></comment> <object-id pub-id-type="pmid">25843402</object-id></mixed-citation></ref>
<ref id="pcbi.1005004.ref019"><label>19</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Abdi</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Mallet</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Mohamed</surname> <given-names>FY</given-names></name>, <name name-style="western"><surname>Sharott</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Dodson</surname> <given-names>PD</given-names></name>, <etal>et al</etal>. <article-title>Prototypic and Arkypallidal Neurons in the Dopamine-Intact External Globus Pallidus</article-title>. <source>Journal of Neuroscience</source> <year>2015</year>; <volume>35</volume>: <fpage>6667</fpage>–<lpage>6688</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.4662-14.2015" xlink:type="simple">10.1523/JNEUROSCI.4662-14.2015</ext-link></comment> <object-id pub-id-type="pmid">25926446</object-id></mixed-citation></ref>
<ref id="pcbi.1005004.ref020"><label>20</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mallet</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Micklem</surname> <given-names>BR</given-names></name>, <name name-style="western"><surname>Henny</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>MT</given-names></name>, <name name-style="western"><surname>Williams</surname> <given-names>C</given-names></name>, <etal>et al</etal>. <article-title>Dichotomous organization of the external globus pallidus</article-title>. <source>Neuron</source> <year>2012</year>; <volume>74</volume>: <fpage>1075</fpage>–<lpage>1086</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuron.2012.04.027" xlink:type="simple">10.1016/j.neuron.2012.04.027</ext-link></comment> <object-id pub-id-type="pmid">22726837</object-id></mixed-citation></ref>
<ref id="pcbi.1005004.ref021"><label>21</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mallet</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Pogosyan</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Marton</surname> <given-names>LF</given-names></name>, <name name-style="western"><surname>Bolam</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>P</given-names></name>, <etal>et al</etal>. <article-title>Parkinsonian beta oscillations in the external globus pallidus and their relationship with subthalamic nucleus activity</article-title>. <source>J Neurosci</source> <year>2008</year>; <volume>28</volume>: <fpage>14245</fpage>–<lpage>14258</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.4199-08.2008" xlink:type="simple">10.1523/JNEUROSCI.4199-08.2008</ext-link></comment> <object-id pub-id-type="pmid">19109506</object-id></mixed-citation></ref>
<ref id="pcbi.1005004.ref022"><label>22</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>O'Reilly</surname> <given-names>RC</given-names></name>, <name name-style="western"><surname>Munataka</surname> <given-names>Y</given-names></name>. <chapter-title>Computational Explorations in Cognitive Neuroscience</chapter-title>. <publisher-loc>Cambridge, MA</publisher-loc>: <publisher-name>MIT Press</publisher-name>; <year>2000</year>.</mixed-citation></ref>
<ref id="pcbi.1005004.ref023"><label>23</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Alexander</surname> <given-names>GE</given-names></name>, <name name-style="western"><surname>DeLong</surname> <given-names>MR</given-names></name>, <name name-style="western"><surname>Strick</surname> <given-names>PL</given-names></name>. <article-title>Parallel organization of functionally segregated circuits linking basal ganglia and cortex</article-title>. <source>Annu Rev Neurosci</source> <year>1986</year>; <volume>9</volume>: <fpage>357</fpage>–<lpage>381</lpage>. <object-id pub-id-type="pmid">3085570</object-id></mixed-citation></ref>
<ref id="pcbi.1005004.ref024"><label>24</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gold</surname> <given-names>JI</given-names></name>, <name name-style="western"><surname>Shadlen</surname> <given-names>MN</given-names></name>. <article-title>Neural computations that underlie decisions about sensory stimuli</article-title>. <source>Trends Cogn Sci</source> <year>2001</year>; <volume>5</volume>: <fpage>10</fpage>–<lpage>16</lpage>. <object-id pub-id-type="pmid">11164731</object-id></mixed-citation></ref>
<ref id="pcbi.1005004.ref025"><label>25</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gold</surname> <given-names>JI</given-names></name>, <name name-style="western"><surname>Shadlen</surname> <given-names>MN</given-names></name>. <article-title>Banburismus and the brain: decoding the relationship between sensory stimuli, decisions, and reward</article-title>. <source>Neuron</source> <year>2002</year>; <volume>36</volume>: <fpage>299</fpage>–<lpage>308</lpage>. <object-id pub-id-type="pmid">12383783</object-id></mixed-citation></ref>
<ref id="pcbi.1005004.ref026"><label>26</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zhang</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Bogacz</surname> <given-names>R</given-names></name>. <article-title>Optimal decision making on the basis of evidence represented in spike trains</article-title>. <source>Neural Computation</source> <year>2010</year>; <volume>22</volume>: <fpage>1113</fpage>–<lpage>1148</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1162/neco.2009.05-09-1025" xlink:type="simple">10.1162/neco.2009.05-09-1025</ext-link></comment> <object-id pub-id-type="pmid">20028228</object-id></mixed-citation></ref>
<ref id="pcbi.1005004.ref027"><label>27</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Parent</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Hazrati</surname> <given-names>LN</given-names></name>. <article-title>Functional anatomy of the basal ganglia. II. The place of subthalamic nucleus and external pallidum in basal ganglia circuitry</article-title>. <source>Brain Res Brain Res Rev</source> <year>1995</year>; <volume>20</volume>: <fpage>128</fpage>–<lpage>154</lpage>. <object-id pub-id-type="pmid">7711765</object-id></mixed-citation></ref>
<ref id="pcbi.1005004.ref028"><label>28</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hallworth</surname> <given-names>NE</given-names></name>, <name name-style="western"><surname>Wilson</surname> <given-names>CJ</given-names></name>, <name name-style="western"><surname>Bevan</surname> <given-names>MD</given-names></name>. <article-title>Apamin-sensitive small conductance calcium-activated potassium channels, through their selective coupling to voltage-gated calcium channels, are critical determinants of the precision, pace, and pattern of action potential generation in rat subthalamic nucleus neurons in vitro</article-title>. <source>J Neurosci</source> <year>2003</year>; <volume>23</volume>: <fpage>7525</fpage>–<lpage>7542</lpage>. <object-id pub-id-type="pmid">12930791</object-id></mixed-citation></ref>
<ref id="pcbi.1005004.ref029"><label>29</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wilson</surname> <given-names>CJ</given-names></name>, <name name-style="western"><surname>Weyrick</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Terman</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Hallworth</surname> <given-names>NE</given-names></name>, <name name-style="western"><surname>Bevan</surname> <given-names>MD</given-names></name>. <article-title>A model of reverse spike frequency adaptation and repetitive firing of subthalamic nucleus neurons</article-title>. <source>J Neurophysiol</source> <year>2004</year>; <volume>91</volume>: <fpage>1963</fpage>–<lpage>1980</lpage>. <object-id pub-id-type="pmid">14702332</object-id></mixed-citation></ref>
<ref id="pcbi.1005004.ref030"><label>30</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bevan</surname> <given-names>MD</given-names></name>, <name name-style="western"><surname>Wilson</surname> <given-names>CJ</given-names></name>. <article-title>Mechanisms underlying spontaneous oscillation and rhythmic firing in rat subthalamic neurons</article-title>. <source>J Neurosci</source> <year>1999</year>; <volume>19</volume>: <fpage>7617</fpage>–<lpage>7628</lpage>. <object-id pub-id-type="pmid">10460267</object-id></mixed-citation></ref>
<ref id="pcbi.1005004.ref031"><label>31</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Beurrier</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Bioulac</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Hammond</surname> <given-names>C</given-names></name>. <article-title>Slowly inactivating sodium current (I(NaP)) underlies single-spike activity in rat subthalamic neurons</article-title>. <source>J Neurophysiol</source> <year>2000</year>; <volume>83</volume>: <fpage>1951</fpage>–<lpage>1957</lpage>. <object-id pub-id-type="pmid">10758106</object-id></mixed-citation></ref>
<ref id="pcbi.1005004.ref032"><label>32</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Carpenter</surname> <given-names>RH</given-names></name>, <name name-style="western"><surname>Williams</surname> <given-names>ML</given-names></name>. <article-title>Neural computation of log likelihood in control of saccadic eye movements</article-title>. <source>Nature</source> <year>1995</year>; <volume>377</volume>: <fpage>59</fpage>–<lpage>62</lpage>. <object-id pub-id-type="pmid">7659161</object-id></mixed-citation></ref>
<ref id="pcbi.1005004.ref033"><label>33</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bugaysen</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Bronfeld</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Tischler</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Bar-Gad</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Korngreen</surname> <given-names>A</given-names></name>. <article-title>Electrophysiological characteristics of globus pallidus neurons</article-title>. <source>PLoS One</source> <year>2010</year>; <volume>5</volume>: <fpage>e12001</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0012001" xlink:type="simple">10.1371/journal.pone.0012001</ext-link></comment> <object-id pub-id-type="pmid">20700458</object-id></mixed-citation></ref>
<ref id="pcbi.1005004.ref034"><label>34</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Deister</surname> <given-names>CA</given-names></name>, <name name-style="western"><surname>Chan</surname> <given-names>CS</given-names></name>, <name name-style="western"><surname>Surmeier</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>Wilson</surname> <given-names>CJ</given-names></name>. <article-title>Calcium-activated SK channels influence voltage-gated ion channels to determine the precision of firing in globus pallidus neurons</article-title>. <source>J Neurosci</source> <year>2009</year>; <volume>29</volume>: <fpage>8452</fpage>–<lpage>8461</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.0576-09.2009" xlink:type="simple">10.1523/JNEUROSCI.0576-09.2009</ext-link></comment> <object-id pub-id-type="pmid">19571136</object-id></mixed-citation></ref>
<ref id="pcbi.1005004.ref035"><label>35</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nambu</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Llinas</surname> <given-names>R</given-names></name>. <article-title>Electrophysiology of globus pallidus neurons in vitro</article-title>. <source>J Neurophysiol</source> <year>1994</year>; <volume>72</volume>: <fpage>1127</fpage>–<lpage>1139</lpage>. <object-id pub-id-type="pmid">7807199</object-id></mixed-citation></ref>
<ref id="pcbi.1005004.ref036"><label>36</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nevado-Holgado</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Mallet</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Magill</surname> <given-names>PJ</given-names></name>, <name name-style="western"><surname>Bogacz</surname> <given-names>R</given-names></name>. <article-title>Effective connectivity of the subthalamic nucleus-globus pallidus network during Parkinsonian oscillations</article-title>. <source>J Physiol</source> <year>2014</year>; <volume>592</volume>: <fpage>1429</fpage>–<lpage>1455</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1113/jphysiol.2013.259721" xlink:type="simple">10.1113/jphysiol.2013.259721</ext-link></comment> <object-id pub-id-type="pmid">24344162</object-id></mixed-citation></ref>
<ref id="pcbi.1005004.ref037"><label>37</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kita</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Chang</surname> <given-names>HT</given-names></name>, <name name-style="western"><surname>Kitai</surname> <given-names>ST</given-names></name>. <article-title>Pallidal inputs to subthalamus: intracellular analysis</article-title>. <source>Brain Res</source> <year>1983</year>; <volume>264</volume>: <fpage>255</fpage>–<lpage>265</lpage>. <object-id pub-id-type="pmid">6303502</object-id></mixed-citation></ref>
<ref id="pcbi.1005004.ref038"><label>38</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nakanishi</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Kita</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Kitai</surname> <given-names>ST</given-names></name>. <article-title>Electrical membrane properties of rat subthalamic neurons in an in vitro slice preparation</article-title>. <source>Brain Res</source> <year>1987</year>; <volume>437</volume>: <fpage>35</fpage>–<lpage>44</lpage>. <object-id pub-id-type="pmid">3427481</object-id></mixed-citation></ref>
<ref id="pcbi.1005004.ref039"><label>39</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kita</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Kitai</surname> <given-names>ST</given-names></name>. <article-title>Intracellular study of rat globus pallidus neurons: membrane properties and responses to neostriatal, subthalamic and nigral stimulation</article-title>. <source>Brain Res</source> <year>1991</year>; <volume>564</volume>: <fpage>296</fpage>–<lpage>305</lpage>. <object-id pub-id-type="pmid">1810628</object-id></mixed-citation></ref>
<ref id="pcbi.1005004.ref040"><label>40</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nevado-Holgado</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Terry</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>Bogacz</surname> <given-names>R</given-names></name>. <article-title>Conditions for the generation of beta oscillations in the subthalamic nucleus-globus pallidus network</article-title>. <source>J Neurosci</source> <year>2010</year>; <volume>30</volume>: <fpage>12340</fpage>–<lpage>12352</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.0817-10.2010" xlink:type="simple">10.1523/JNEUROSCI.0817-10.2010</ext-link></comment> <object-id pub-id-type="pmid">20844130</object-id></mixed-citation></ref>
<ref id="pcbi.1005004.ref041"><label>41</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pavlides</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Hogan</surname> <given-names>SJ</given-names></name>, <name name-style="western"><surname>Bogacz</surname> <given-names>R</given-names></name>. <article-title>Improved conditions for the generation of beta oscillations in the subthalamic nucleus—globus pallidus network</article-title>. <source>Eur J Neurosci</source> <year>2012</year>; <volume>36</volume>: <fpage>2229</fpage>–<lpage>2239</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/j.1460-9568.2012.08105.x" xlink:type="simple">10.1111/j.1460-9568.2012.08105.x</ext-link></comment> <object-id pub-id-type="pmid">22805067</object-id></mixed-citation></ref>
<ref id="pcbi.1005004.ref042"><label>42</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Levesque</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Parent</surname> <given-names>A</given-names></name>. <article-title>The striatofugal fiber system in primates: a reevaluation of its organization based on single-axon tracing studies</article-title>. <source>Proc Natl Acad Sci U S A</source> <year>2005</year>; <volume>102</volume>: <fpage>11888</fpage>–<lpage>11893</lpage>. <object-id pub-id-type="pmid">16087877</object-id></mixed-citation></ref>
<ref id="pcbi.1005004.ref043"><label>43</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pasupathy</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Miller</surname> <given-names>EK</given-names></name>. <article-title>Different time courses of learning-related activity in the prefrontal cortex and striatum</article-title>. <source>Nature</source> <year>2005</year>; <volume>433</volume>: <fpage>873</fpage>–<lpage>876</lpage>. <object-id pub-id-type="pmid">15729344</object-id></mixed-citation></ref>
<ref id="pcbi.1005004.ref044"><label>44</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Doya</surname> <given-names>K</given-names></name>. <article-title>Complementary roles of basal ganglia and cerebellum in learning and motor control</article-title>. <source>Curr Opin Neurobiol</source> <year>2000</year>; <volume>10</volume>: <fpage>732</fpage>–<lpage>739</lpage>. <object-id pub-id-type="pmid">11240282</object-id></mixed-citation></ref>
<ref id="pcbi.1005004.ref045"><label>45</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mink</surname> <given-names>JW</given-names></name>. <article-title>The basal ganglia: focused selection and inhibition of competing motor programs</article-title>. <source>Prog Neurobiol</source> <year>1996</year>; <volume>50</volume>: <fpage>381</fpage>–<lpage>425</lpage>. <object-id pub-id-type="pmid">9004351</object-id></mixed-citation></ref>
<ref id="pcbi.1005004.ref046"><label>46</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Frank</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Samanta</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Moustafa</surname> <given-names>AA</given-names></name>, <name name-style="western"><surname>Sherman</surname> <given-names>SJ</given-names></name>. <article-title>Hold your horses: impulsivity, deep brain stimulation, and medication in parkinsonism</article-title>. <source>Science</source> <year>2007</year>; <volume>318</volume>: <fpage>1309</fpage>–<lpage>1312</lpage>. <object-id pub-id-type="pmid">17962524</object-id></mixed-citation></ref>
<ref id="pcbi.1005004.ref047"><label>47</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Engel</surname> <given-names>AK</given-names></name>, <name name-style="western"><surname>Fries</surname> <given-names>P</given-names></name>. <article-title>Beta-band oscillations—signalling the status quo?</article-title> <source>Curr Opin Neurobiol</source> <year>2010</year>; <volume>20</volume>: <fpage>156</fpage>–<lpage>165</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.conb.2010.02.015" xlink:type="simple">10.1016/j.conb.2010.02.015</ext-link></comment> <object-id pub-id-type="pmid">20359884</object-id></mixed-citation></ref>
<ref id="pcbi.1005004.ref048"><label>48</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Brown</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Oliviero</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Mazzone</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Insola</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Tonali</surname> <given-names>P</given-names></name>, <etal>et al</etal>. <article-title>Dopamine dependency of oscillations between subthalamic nucleus and pallidum in Parkinson's disease</article-title>. <source>J Neurosci</source> <year>2001</year>; <volume>21</volume>: <fpage>1033</fpage>–<lpage>1038</lpage>. <object-id pub-id-type="pmid">11157088</object-id></mixed-citation></ref>
<ref id="pcbi.1005004.ref049"><label>49</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ramanathan</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Tkatch</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Atherton</surname> <given-names>JF</given-names></name>, <name name-style="western"><surname>Wilson</surname> <given-names>CJ</given-names></name>, <name name-style="western"><surname>Bevan</surname> <given-names>MD</given-names></name>. <article-title>D2-like dopamine receptors modulate SKCa channel function in subthalamic nucleus neurons through inhibition of Cav2.2 channels</article-title>. <source>J Neurophysiol</source> <year>2008</year>; <volume>99</volume>: <fpage>442</fpage>–<lpage>459</lpage>. <object-id pub-id-type="pmid">18094105</object-id></mixed-citation></ref>
<ref id="pcbi.1005004.ref050"><label>50</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cooper</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Stanford</surname> <given-names>IM</given-names></name>. <article-title>Dopamine D2 receptor mediated presynaptic inhibition of striatopallidal GABA(A) IPSCs in vitro</article-title>. <source>Neuropharmacology</source> <year>2001</year>; <volume>41</volume>: <fpage>62</fpage>–<lpage>71</lpage>. <object-id pub-id-type="pmid">11445186</object-id></mixed-citation></ref>
<ref id="pcbi.1005004.ref051"><label>51</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hernandez</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Ibanez-Sandoval</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Sierra</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Valdiosera</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Tapia</surname> <given-names>D</given-names></name>, <etal>et al</etal>. <article-title>Control of the subthalamic innervation of the rat globus pallidus by D2/3 and D4 dopamine receptors</article-title>. <source>J Neurophysiol</source> <year>2006</year>; <volume>96</volume>: <fpage>2877</fpage>–<lpage>2888</lpage>. <object-id pub-id-type="pmid">16899633</object-id></mixed-citation></ref>
<ref id="pcbi.1005004.ref052"><label>52</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Baufreton</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Bevan</surname> <given-names>MD</given-names></name>. <article-title>D2-like dopamine receptor-mediated modulation of activity-dependent plasticity at GABAergic synapses in the subthalamic nucleus</article-title>. <source>J Physiol</source> <year>2008</year>; <volume>586</volume>: <fpage>2121</fpage>–<lpage>2142</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1113/jphysiol.2008.151118" xlink:type="simple">10.1113/jphysiol.2008.151118</ext-link></comment> <object-id pub-id-type="pmid">18292127</object-id></mixed-citation></ref>
<ref id="pcbi.1005004.ref053"><label>53</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fan</surname> <given-names>KY</given-names></name>, <name name-style="western"><surname>Baufreton</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Surmeier</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>Chan</surname> <given-names>CS</given-names></name>, <name name-style="western"><surname>Bevan</surname> <given-names>MD</given-names></name>. <article-title>Proliferation of external globus pallidus-subthalamic nucleus synapses following degeneration of midbrain dopamine neurons</article-title>. <source>J Neurosci</source> <year>2012</year>; <volume>32</volume>: <fpage>13718</fpage>–<lpage>13728</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.5750-11.2012" xlink:type="simple">10.1523/JNEUROSCI.5750-11.2012</ext-link></comment> <object-id pub-id-type="pmid">23035084</object-id></mixed-citation></ref>
<ref id="pcbi.1005004.ref054"><label>54</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Chu</surname> <given-names>HY</given-names></name>, <name name-style="western"><surname>Atherton</surname> <given-names>JF</given-names></name>, <name name-style="western"><surname>Wokosin</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Surmeier</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>Bevan</surname> <given-names>MD</given-names></name>. <article-title>Heterosynaptic regulation of external globus pallidus inputs to the subthalamic nucleus by the motor cortex</article-title>. <source>Neuron</source> <year>2015</year>; <volume>85</volume>: <fpage>364</fpage>–<lpage>376</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuron.2014.12.022" xlink:type="simple">10.1016/j.neuron.2014.12.022</ext-link></comment> <object-id pub-id-type="pmid">25578364</object-id></mixed-citation></ref>
<ref id="pcbi.1005004.ref055"><label>55</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Chan</surname> <given-names>CS</given-names></name>, <name name-style="western"><surname>Glajch</surname> <given-names>KE</given-names></name>, <name name-style="western"><surname>Gertler</surname> <given-names>TS</given-names></name>, <name name-style="western"><surname>Guzman</surname> <given-names>JN</given-names></name>, <name name-style="western"><surname>Mercer</surname> <given-names>JN</given-names></name>, <etal>et al</etal>. <article-title>HCN channelopathy in external globus pallidus neurons in models of Parkinson's disease</article-title>. <source>Nat Neurosci</source> <year>2011</year>; <volume>14</volume>: <fpage>85</fpage>–<lpage>92</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn.2692" xlink:type="simple">10.1038/nn.2692</ext-link></comment> <object-id pub-id-type="pmid">21076425</object-id></mixed-citation></ref>
<ref id="pcbi.1005004.ref056"><label>56</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Miguelez</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Morin</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Martinez</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Goillandeau</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Bezard</surname> <given-names>E</given-names></name>, <etal>et al</etal>. <article-title>Altered pallido-pallidal synaptic transmission leads to aberrant firing of globus pallidus neurons in a rat model of Parkinson's disease</article-title>. <source>J Physiol</source> <year>2012</year>; <volume>590</volume>: <fpage>5861</fpage>–<lpage>5875</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1113/jphysiol.2012.241331" xlink:type="simple">10.1113/jphysiol.2012.241331</ext-link></comment> <object-id pub-id-type="pmid">22890706</object-id></mixed-citation></ref>
</ref-list>
</back>
</article>