<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-17-00169</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1005839</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Metabolism</subject><subj-group><subject>Metabolites</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Metabolism</subject><subj-group><subject>Metabolomics</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Spectrum analysis techniques</subject><subj-group><subject>NMR spectroscopy</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Body fluids</subject><subj-group><subject>Urine</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Body fluids</subject><subj-group><subject>Urine</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Body fluids</subject><subj-group><subject>Urine</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Body fluids</subject><subj-group><subject>Urine</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Spectrum analysis techniques</subject><subj-group><subject>NMR spectroscopy</subject><subj-group><subject>Proton NMR spectroscopy</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Genome analysis</subject><subj-group><subject>Genome-wide association studies</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Genomics</subject><subj-group><subject>Genome analysis</subject><subj-group><subject>Genome-wide association studies</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Human genetics</subject><subj-group><subject>Genome-wide association studies</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Molecular genetics</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Molecular biology</subject><subj-group><subject>Molecular genetics</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Physics</subject><subj-group><subject>Nuclear physics</subject><subj-group><subject>Nucleons</subject><subj-group><subject>Protons</subject></subj-group></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Metabomatching: Using genetic association to identify metabolites in proton NMR spectroscopy</article-title>
<alt-title alt-title-type="running-head">Metabomatching: Using genetic association to identify metabolites in <sup>1</sup>H NMR spectroscopy</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-6713-2214</contrib-id>
<name name-style="western">
<surname>Rueedi</surname> <given-names>Rico</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Mallol</surname> <given-names>Roger</given-names></name>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-2495-4020</contrib-id>
<name name-style="western">
<surname>Raffler</surname> <given-names>Johannes</given-names></name>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-9216-8825</contrib-id>
<name name-style="western">
<surname>Lamparter</surname> <given-names>David</given-names></name>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Friedrich</surname> <given-names>Nele</given-names></name>
<role content-type="http://credit.casrai.org/">Resources</role>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
<xref ref-type="aff" rid="aff005"><sup>5</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-0765-896X</contrib-id>
<name name-style="western">
<surname>Vollenweider</surname> <given-names>Peter</given-names></name>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<xref ref-type="aff" rid="aff006"><sup>6</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-4193-788X</contrib-id>
<name name-style="western">
<surname>Waeber</surname> <given-names>Gérard</given-names></name>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<xref ref-type="aff" rid="aff006"><sup>6</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Kastenmüller</surname> <given-names>Gabi</given-names></name>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
<xref ref-type="aff" rid="aff007"><sup>7</sup></xref>
</contrib>
<contrib contrib-type="author" equal-contrib="yes" xlink:type="simple">
<name name-style="western">
<surname>Kutalik</surname> <given-names>Zoltán</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="aff" rid="aff008"><sup>8</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" equal-contrib="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-6785-9034</contrib-id>
<name name-style="western">
<surname>Bergmann</surname> <given-names>Sven</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="aff" rid="aff009"><sup>9</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Department of Computational Biology, University of Lausanne, Lausanne, Switzerland</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Swiss Institute of Bioinformatics, Lausanne, Switzerland</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>Institute of Bioinformatics and Systems Biology, Helmholtz Zentrum München, German Research Center for Environmental Health, Neuherberg, Germany</addr-line>
</aff>
<aff id="aff004">
<label>4</label>
<addr-line>Institute of Clinical Chemistry and Laboratory Medicine, University Medicine Greifswald, Greifswald, Germany</addr-line>
</aff>
<aff id="aff005">
<label>5</label>
<addr-line>German Centre for Cardiovascular Research (DZHK), Partner site, Greifswald, Germany</addr-line>
</aff>
<aff id="aff006">
<label>6</label>
<addr-line>Department of Medicine, Internal Medicine, Lausanne University Hospital (CHUV), Lausanne, Switzerland</addr-line>
</aff>
<aff id="aff007">
<label>7</label>
<addr-line>German Center for Diabetes Research, Neuherberg, Germany</addr-line>
</aff>
<aff id="aff008">
<label>8</label>
<addr-line>Institute of Social and Preventive Medicine, Lausanne University Hospital (CHUV), Lausanne, Switzerland</addr-line>
</aff>
<aff id="aff009">
<label>9</label>
<addr-line>Department of Integrative Biomedical Sciences, University of Cape Town, Cape Town, South Africa</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Ouzounis</surname> <given-names>Christos A.</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Centre for Research and Technology-Hellas, GREECE</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">sven.bergmann@unil.ch</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>12</month>
<year>2017</year>
</pub-date>
<pub-date pub-type="epub">
<day>1</day>
<month>12</month>
<year>2017</year>
</pub-date>
<volume>13</volume>
<issue>12</issue>
<elocation-id>e1005839</elocation-id>
<history>
<date date-type="received">
<day>30</day>
<month>1</month>
<year>2017</year>
</date>
<date date-type="accepted">
<day>23</day>
<month>10</month>
<year>2017</year>
</date>
</history>
<permissions>
<copyright-year>2017</copyright-year>
<copyright-holder>Rueedi et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1005839"/>
<abstract>
<p>A metabolome-wide genome-wide association study (mGWAS) aims to discover the effects of genetic variants on metabolome phenotypes. Most mGWASes use as phenotypes concentrations of limited sets of metabolites that can be identified and quantified from spectral information. In contrast, in an <italic>untargeted</italic> mGWAS both identification and quantification are forgone and, instead, all measured metabolome features are tested for association with genetic variants. While the untargeted approach does not discard data that may have eluded identification, the interpretation of associated features remains a challenge. To address this issue, we developed <italic>metabomatching</italic> to identify the metabolites underlying significant associations observed in untargeted mGWASes on proton NMR metabolome data. Metabomatching capitalizes on <italic>genetic spiking</italic>, the concept that because metabolome features associated with a genetic variant tend to correspond to the peaks of the NMR spectrum of the underlying metabolite, genetic association can allow for identification. Applied to the untargeted mGWASes in the SHIP and CoLaus cohorts and using 180 reference NMR spectra of the urine metabolome database, metabomatching successfully identified the underlying metabolite in 14 of 19, and 8 of 9 associations, respectively. The accuracy and efficiency of our method make it a strong contender for facilitating or complementing metabolomics analyses in large cohorts, where the availability of genetic, or other data, enables our approach, but targeted quantification is limited.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>Metabolome-wide genome-wide association studies aim to discover how genetic variation affects metabolome traits. Such studies typically follow an acquire-identify-associate procedure: metabolome data are acquired experimentally, metabolites are identified in the experimental data and their concentrations quantified, and the metabolite concentrations are tested for association with genetic variants. The <italic>untargeted</italic> approach follows instead an acquire-associate-identify procedure: the experimental data are binned into <italic>metabolome features</italic>, and the features tested directly for genetic association. When the metabolome is measured by proton NMR spectroscopy, genetically associated features tend to correspond to peaks in the NMR spectrum of the underlying metabolites. This inherent property of the untargeted approach acts as a <italic>genetic spiking</italic> which informs on the identities of involved metabolites. <italic>Metabomatching</italic> is a method that uses genetic spiking information to identify the metabolite candidates, listed in a spectral database, most likely to underlie observed feature associations. Here, we present the method and its software, and evaluate its performance.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001711</institution-id>
<institution>Schweizerischer Nationalfonds zur Förderung der Wissenschaftlichen Forschung</institution>
</institution-wrap>
</funding-source>
<award-id>31003A-143914</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Kutalik</surname> <given-names>Zoltán</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution>Swiss Institute of Bioinformatics</institution>
</funding-source>
<principal-award-recipient>
<name name-style="western">
<surname>Kutalik</surname> <given-names>Zoltán</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award003">
<funding-source>
<institution>Swiss Institute of Bioinformatics</institution>
</funding-source>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-6785-9034</contrib-id>
<name name-style="western">
<surname>Bergmann</surname> <given-names>Sven</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award004">
<funding-source>
<institution>SystemsX.ch</institution>
</funding-source>
<award-id>51RTP0-151019</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Kutalik</surname> <given-names>Zoltán</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award005">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100006387</institution-id>
<institution>Fondation Leenaards</institution>
</institution-wrap>
</funding-source>
<principal-award-recipient>
<name name-style="western">
<surname>Kutalik</surname> <given-names>Zoltán</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award006">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100007601</institution-id>
<institution>Horizon 2020</institution>
</institution-wrap>
</funding-source>
<award-id>654241</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-6785-9034</contrib-id>
<name name-style="western">
<surname>Bergmann</surname> <given-names>Sven</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award007">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001711</institution-id>
<institution>Schweizerischer Nationalfonds zur Förderung der Wissenschaftlichen Forschung</institution>
</institution-wrap>
</funding-source>
<award-id>310030-152724</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-6785-9034</contrib-id>
<name name-style="western">
<surname>Bergmann</surname> <given-names>Sven</given-names></name>
</principal-award-recipient>
</award-group>
<funding-statement>This work was supported by the Leenards Foundation (to ZK), the European Comission’s Horizon 2020 program via the PhenoMeNal project (654241 to SB), the Swiss Institute of Bioinformatics (to SB, to ZK), the Swiss National Science Foundation (31003A-143914 to ZK, 310030-152724 to SB) and SystemsX.ch (51RTP0-151019 to ZK). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="3"/>
<table-count count="2"/>
<page-count count="17"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>CoLaus association summary statistics are available for download from [<ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/1039306" xlink:type="simple">https://zenodo.org/record/1039306</ext-link>]. SHIP association summary statistics are available for download from [<ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/1040795" xlink:type="simple">https://zenodo.org/record/1040795</ext-link>].</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Since the seminal metabolome-wide genome-wide association study (mGWAS) by Gieger et al. in 2008 [<xref ref-type="bibr" rid="pcbi.1005839.ref001">1</xref>], mGWASes performed on blood and urine spectral metabolome phenotypes have uncovered an increasing part of the heritable variability of the human metabolome through the discovery of hundreds of genetically influenced metabolome phenotypes [<xref ref-type="bibr" rid="pcbi.1005839.ref002">2</xref>–<xref ref-type="bibr" rid="pcbi.1005839.ref004">4</xref>].</p>
<p>Most mGWASes use estimated metabolite concentrations as phenotypes [<xref ref-type="bibr" rid="pcbi.1005839.ref001">1</xref>, <xref ref-type="bibr" rid="pcbi.1005839.ref005">5</xref>–<xref ref-type="bibr" rid="pcbi.1005839.ref010">10</xref>]. In such <italic>targeted</italic> mGWASes, metabolite concentrations are obtained by quantification [<xref ref-type="bibr" rid="pcbi.1005839.ref011">11</xref>] of spectral metabolome data produced by mass spectrometry (MS) or nuclear magnetic resonance (NMR) spectroscopy. While targeted approaches pave the way for reproducible metabolomics, only a fraction of the measured metabolome data is quantified into metabolite concentrations due to the arduous nature of metabolite identification [<xref ref-type="bibr" rid="pcbi.1005839.ref012">12</xref>–<xref ref-type="bibr" rid="pcbi.1005839.ref016">16</xref>]. In Rueedi et al. [<xref ref-type="bibr" rid="pcbi.1005839.ref017">17</xref>], we used an <italic>untargeted approach</italic> [<xref ref-type="bibr" rid="pcbi.1005839.ref018">18</xref>–<xref ref-type="bibr" rid="pcbi.1005839.ref020">20</xref>]: we binned then normalized the NMR data, and tested the resulting bin intensities, which we called <italic>metabolome features</italic>, for association with genotypes.</p>
<p>We then sought metabolite identification only for significantly associated metabolome features. To do so, we employed an inherent characteristic of the untargeted approach: <italic>genetic spiking</italic>. If the genetic component of a metabolite concentration is detected in the untargeted mGWAS, then the relevant genotype will associate with metabolome features that correspond to the peaks of the NMR spectrum of the metabolite. Much as metabolite spiking does by flooding a sample with a metabolite of interest, genetic spiking isolates, by genetic association, the spectrum of the genetically influenced metabolite. However, whereas the aim of metabolite spiking is to determine an unknown spectrum for a known metabolite, we developed <italic>metabomatching</italic> to use genetic spiking to identify an unknown metabolite from a known spectrum.</p>
<p>We previously showed that metabolite identification using the metabomatching procedure works in principle [<xref ref-type="bibr" rid="pcbi.1005839.ref017">17</xref>, <xref ref-type="bibr" rid="pcbi.1005839.ref020">20</xref>], and applied it to identify the metabolite involved in a novel SNP-feature association. Here, we further develop metabomatching, present its core concepts and data, perform numerical simulations, and evaluate its performance on two sets of mGWAS data. We also present the metabomatching software, describe its implementation and settings, and highlight the best practices and pitfalls of its application.</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Materials and methods</title>
<p>Metabolome features are obtained by reducing the experimental NMR spectra into bins along the chemical shift range. This binning can be uniform or adaptive [<xref ref-type="bibr" rid="pcbi.1005839.ref013">13</xref>, <xref ref-type="bibr" rid="pcbi.1005839.ref021">21</xref>–<xref ref-type="bibr" rid="pcbi.1005839.ref023">23</xref>], and is applied during standard processing of the NMR data, among other steps such as alignment or normalization. In an untargeted mGWAS, the quantification into metabolite concentrations is skipped, and the metabolome features are tested directly for association with genetic variants, such as single nucleotide polymorphisms (SNPs).</p>
<p>Any observed SNP-feature association, however, is but a proxy for the genetic effect of the SNP on the concentration of a certain metabolite. Metabolome features are derived from the NMR spectra of the measured samples, which in turn are combinations of the NMR spectra of the metabolites contained in the samples. Therefore, the genetic effect of a SNP on the concentration of a metabolite can be detected by the associations between the SNP and the metabolome features that match peaks in the NMR spectrum of the metabolite. This match between associated features and peaks of the spectrum allows, in principle, to identify the underlying metabolite.</p>
<p>To formalize the notion of genetic spiking, we call the collection of association <italic>p</italic>-values, effect sizes (<italic>β</italic>), and standard errors (<italic>s</italic>) resulting from the simple linear regressions between a SNP and all metabolome features the <italic>pseudospectrum</italic> of the SNP. As shown in <xref ref-type="fig" rid="pcbi.1005839.g001">Fig 1A</xref> for rs37369 in <italic>AGXT2</italic>, the pseudospectrum (−log) <italic>p</italic>-values mirror the NMR spectrum of the underlying metabolite 3-aminoisobutyrate almost exactly.</p>
<fig id="pcbi.1005839.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005839.g001</object-id>
<label>Fig 1</label>
<caption>
<title><italic>AGXT2</italic> pseudospectrum and 3-aminoisobutyrate NMR spectrum, descriptions, and metabomatching match sets.</title>
<p>(A) The upper plot shows the experimental NMR spectrum of 3-aminoisobutyrate. The lower plot shows the (-log) <italic>p</italic>-values of the pseudospectrum of rs37369 in <italic>AGXT2</italic>, when <italic>p</italic> &lt; 10<sup>−3</sup>. There is a close match between the experimental spectrum and the pseudospectrum, as the four sets of features that associate (<italic>p</italic> &lt; 5 × 10<sup>−8</sup>) with rs37369 correspond to the principal peaks of the spectrum. (B) Taking a more detailed view of the spectrum descriptions (from HMDB), we see that the peaks of 3-aminoisobutyrate group into six clusters (labeled A through F). The multiplet ranges for clusters A, C, and E enclose their corresponding peaks well, padding by an average of 0.023 ppm. The multiplet range for cluster F is significantly wider, padding by 0.062 ppm. Approximating cluster areas as the product of the width of the cluster with the average height of the peaks in the cluster, then scaling, we find area-derived proton counts of 2.8, 0.7, 1.1, 1.2 for clusters A, C, E, and F, respectively. These counts are coherent with the listed proton counts of 3, 1, 1, and 1 for the respective multiplet ranges. Applying this same approximation for clusters B and D results in area-derived proton counts of 0.0, and 0.2. Because this implies corresponding multiplet proton counts of 0, we may consider the two spectrum descriptions essentially coherent, even though no multiplet ranges are listed for clusters B and D. (C) Match sets obtained from the peak and multiplet descriptions of the 3-aminoisobutyrate spectrum, for features resulting from a uniform NMR spectrum binning in 0.01 ppm increments, and with neighborhood parameter <italic>δ</italic> = 0.03 and 0.01, respectively. While the peak and multiplet descriptions of the 3-aminoisobutyrate NMR spectrum may be essentially coherent, their resulting match sets do differ, with 22 features unique to either one of the match sets.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005839.g001" xlink:type="simple"/>
</fig>
<p>Metabomatching uses genetic spiking towards the identification of underlying metabolites: for a SNP that associates significantly with at least one metabolome feature, metabomatching compares the pseudospectrum of the SNP to the NMR spectrum of each metabolite listed in a supplied spectral database. It then scores and ranks the compared metabolites, such that high ranking metabolites are most likely to underlie the SNP-feature associations.</p>
<sec id="sec003">
<title>Spectral databases</title>
<p>The default spectral database used by metabomatching is acquired from the Human Metabolome DataBase [<xref ref-type="bibr" rid="pcbi.1005839.ref024">24</xref>] (HMDB), which lists experimental proton NMR spectra for 835 metabolites. In HMDB, the spectrum of a metabolite is described in two ways: as a list of peaks, and as a list of multiplets (see <xref ref-type="fig" rid="pcbi.1005839.g001">Fig 1B</xref>). A peak is defined by a spectral position, expressed as a chemical shift in parts per million (ppm), and a relative NMR intensity, that is the peak height expressed relative to the highest peak in the spectrum. A multiplet is defined by a chemical shift range, and a proton count. Peaks group into clusters, and for each such cluster in the peak description, there is, generally, a corresponding multiplet in the multiplet description whose range encloses the cluster. Furthermore, the area under the curve delimiting the peaks of a cluster can be related to the proton count of the corresponding multiplet [<xref ref-type="bibr" rid="pcbi.1005839.ref025">25</xref>]. The two descriptions are usually, but not always, coherent.</p>
<p>Alternatively, metabomatching can use a database acquired from the Biological Magnetic Resonance dataBank [<xref ref-type="bibr" rid="pcbi.1005839.ref026">26</xref>] (BMRB), which lists experimental proton NMR spectra for 670 metabolites. In BMRB, the spectrum of a metabolite is described only as a list of peaks. Each metabolite, however, may have several peak description spectra, obtained in different experiments.</p>
<p>Both HMDB and BMRB collect information on any metabolites found in the human body. As a result, many of the spectra contained in the full spectral databases may be irrelevant for a specific mGWAS, typically because the corresponding metabolites may not be contained in the studied biofluid. Metabomatching can therefore also use specific subsets of the full spectral databases. For urine, the spectral database is derived from the urine metabolome database (UMDB) [<xref ref-type="bibr" rid="pcbi.1005839.ref027">27</xref>] and contains proton NMR spectra for 180 metabolites, 124 if based on BMRB. For serum, the spectral database is derived from the work of Gowda et al. [<xref ref-type="bibr" rid="pcbi.1005839.ref012">12</xref>] and contains proton NMR spectra for 67 metabolites if based on HMDB, 49 if based on BMRB.</p>
</sec>
<sec id="sec004">
<title>Standard method</title>
<p>For the comparison of pseudospectra to reference spectra, we introduce a feature match set <italic>F</italic><sub><italic>δ</italic></sub>(<italic>m</italic>) for every metabolite <italic>m</italic> in the reference database. <italic>F</italic><sub><italic>δ</italic></sub>(<italic>m</italic>) is defined to contain all features <italic>f</italic> within a neighborhood of <italic>δ</italic> ppm of any spectrum peak listed in the peak description of <italic>m</italic> (see <xref ref-type="fig" rid="pcbi.1005839.g001">Fig 1C</xref>). For the pseudospectrum of a given SNP <italic>r</italic> and the spectrum of every metabolite <italic>m</italic>, we compute the match sum
<disp-formula id="pcbi.1005839.e001"><alternatives><graphic id="pcbi.1005839.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005839.e001" xlink:type="simple"/><mml:math display="block" id="M1"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>f</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi>F</mml:mi> <mml:mi>δ</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:munder> <mml:mfrac><mml:msubsup><mml:mi>β</mml:mi> <mml:mrow><mml:mi>r</mml:mi> <mml:mi>f</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:msubsup><mml:mi>s</mml:mi> <mml:mrow><mml:mi>r</mml:mi> <mml:mi>f</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula>
with <italic>β</italic><sub><italic>rf</italic></sub> the effect size and <italic>s</italic><sub><italic>rf</italic></sub> the standard error of the association between SNP <italic>r</italic> and feature <italic>f</italic>. Even though the features are usually not independent, we consider the match sum to be <italic>χ</italic><sup>2</sup>-distributed with |<italic>F</italic><sub><italic>δ</italic></sub>(<italic>m</italic>)| degrees of freedom, so as to define the score for the tested metabolite as the negative logarithm of the corresponding <italic>p</italic>-value. As a result, while we use the scores to rank metabolites for a given SNP, the scores do not inform on the statistical significance of a spectrum-pseudospectrum match, nor do we compare scores obtained for the pseudospectra of different SNPs.</p>
</sec>
<sec id="sec005">
<title>Settings</title>
<p>Because multiplet descriptions of the reference NMR spectra in HMDB can significantly differ from peak descriptions, they can be considered as composing a separate spectral database. To use this set, or its corresponding biofluid specific subsets, metabomatching can be run in <italic>multiplet mode</italic>, instead of the standard <italic>peak mode</italic> described above. The match set <italic>F</italic><sub><italic>δ</italic></sub>(<italic>m</italic>) used to compute the match sum <xref ref-type="disp-formula" rid="pcbi.1005839.e001">(1)</xref> for <italic>m</italic> is then defined to contain all features <italic>f</italic> falling in, or within <italic>δ</italic> of, any multiplet range of metabolite <italic>m</italic> (see <xref ref-type="fig" rid="pcbi.1005839.g001">Fig 1C</xref>). Because multiplet ranges tend to pad their corresponding peak cluster, the neighborhood parameter <italic>δ</italic> takes a smaller value in multiplet mode than in peak mode. The resulting match sets are then comparable to their peak mode counterparts, in general. However, differences between the two descriptions, in cluster position, size, or even presence, occur for about 10% of metabolites in HMDB. These differences can significantly affect metabomatching results.</p>
<p>Metabolome features that are common to the spectrum of a metabolite present in the study samples correlate, and metabomatching can be set to take this correlation into account. The correlation is strongest among neighboring features, which may be common to multiple metabolites of spectra containing similar peak clusters, but also appears in features corresponding to peaks in different spectrum clusters. Heuristically however, only the correlation between neighboring features is detrimental to metabomatching, and decorrelation is therefore applied only to feature neighborhoods. Given the user-provided feature-feature correlation matrix <inline-formula id="pcbi.1005839.e002"><alternatives><graphic id="pcbi.1005839.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005839.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:mover accent="true"><mml:mi>C</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, match sum <xref ref-type="disp-formula" rid="pcbi.1005839.e001">(1)</xref> is then modified to
<disp-formula id="pcbi.1005839.e003"><alternatives><graphic id="pcbi.1005839.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005839.e003" xlink:type="simple"/><mml:math display="block" id="M3"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>f</mml:mi> <mml:mo>,</mml:mo> <mml:mi>g</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi>F</mml:mi> <mml:mi>δ</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:munder> <mml:mfrac><mml:msub><mml:mi>β</mml:mi> <mml:mrow><mml:mi>r</mml:mi> <mml:mi>f</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>s</mml:mi> <mml:mrow><mml:mi>r</mml:mi> <mml:mi>f</mml:mi></mml:mrow></mml:msub></mml:mfrac> <mml:msubsup><mml:mi>C</mml:mi> <mml:mrow><mml:mi>δ</mml:mi> <mml:mo>;</mml:mo> <mml:mi>f</mml:mi> <mml:mi>g</mml:mi></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mfrac><mml:msub><mml:mi>β</mml:mi> <mml:mrow><mml:mi>r</mml:mi> <mml:mi>g</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>s</mml:mi> <mml:mrow><mml:mi>r</mml:mi> <mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2)</label></disp-formula>
where <inline-formula id="pcbi.1005839.e004"><alternatives><graphic id="pcbi.1005839.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005839.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:mrow><mml:msub><mml:mi>C</mml:mi> <mml:mrow><mml:mi>δ</mml:mi> <mml:mo>;</mml:mo> <mml:mi>f</mml:mi> <mml:mi>g</mml:mi></mml:mrow></mml:msub> <mml:mo>≐</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mo>λ</mml:mo> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mover accent="true"><mml:mi>C</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>f</mml:mi> <mml:mi>g</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>J</mml:mi> <mml:mrow><mml:mi>δ</mml:mi> <mml:mo>;</mml:mo> <mml:mi>f</mml:mi> <mml:mi>g</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:mo>λ</mml:mo> <mml:msub><mml:mi>I</mml:mi> <mml:mrow><mml:mi>f</mml:mi> <mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> provides decorrelation, with λ ∈ [0, 1] the shrinkage parameter [<xref ref-type="bibr" rid="pcbi.1005839.ref028">28</xref>], which serves to regularize. Restriction to feature neighborhoods results from the block diagonal matrix <italic>J</italic><sub><italic>δ</italic></sub>, with <italic>J</italic><sub><italic>δ</italic>;<italic>fg</italic></sub> = 1 if <italic>f</italic> and <italic>g</italic> are members of the same neighborhood, that is if they are connected by a sequence of features in <italic>F</italic><sub><italic>δ</italic></sub>(<italic>m</italic>) each at most 2<italic>δ</italic> ppm apart, and <italic>I</italic> the identity matrix.</p>
<p>Metabomatching includes two variants for cases where a SNP affects a pair of metabolites: <italic>2-compound</italic> metabomatching if the effects are of equal directions, and ±-metabomatching if the effects are of opposite directions. For 2-compound metabomatching, we compute the match sum for pairs of metabolites by running the sum over pair match sets, defined as <italic>F</italic><sub><italic>δ</italic></sub>(<italic>m</italic><sub>1</sub>, <italic>m</italic><sub>2</sub>) ≐ <italic>F</italic><sub><italic>δ</italic></sub>(<italic>m</italic><sub>1</sub>) ∪ <italic>F</italic><sub><italic>δ</italic></sub>(<italic>m</italic><sub>2</sub>). Metabolite pairs are accordingly scored and ranked. In ±-metabomatching, standard (<italic>1-compound</italic>) metabomatching is run separately for each effect direction, setting to 0 the effect size for associations in the other direction that exceed a user-provided <italic>p</italic>-value threshold. 2-compound and ±-metabomatching can be combined into <italic>±-2-compound</italic> metabomatching for SNPs affecting at most one pair of metabolites in each direction.</p>
<p>By squaring <italic>β</italic>/<italic>s</italic> in match sum <xref ref-type="disp-formula" rid="pcbi.1005839.e001">(1)</xref> or <xref ref-type="disp-formula" rid="pcbi.1005839.e003">(2)</xref>, <italic>χ</italic><sup>2</sup>-scoring increases signal to noise ratio, both by amplifying the contribution of strongly associated features to metabomatching scores, and by ignoring effect directions. This increase applies indiscriminately, however, and may actually favor competing metabolites more than the metabolite to identify. Therefore, for pseudospectra where this increase is not necessary, such as those produced in mGWASes of high statistical power, for example, stronger matches may be obtained with <italic>Z</italic>-scoring. Here, scores are computed according to the match sum
<disp-formula id="pcbi.1005839.e005"><alternatives><graphic id="pcbi.1005839.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005839.e005" xlink:type="simple"/><mml:math display="block" id="M5"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>f</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi>F</mml:mi> <mml:mi>δ</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:munder> <mml:mfrac><mml:msub><mml:mi>β</mml:mi> <mml:mrow><mml:mi>r</mml:mi> <mml:mi>f</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>s</mml:mi> <mml:mrow><mml:mi>r</mml:mi> <mml:mi>f</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(3)</label></disp-formula>
which we consider to be normally distributed, under the null hypothesis, with zero mean and variance |<italic>F</italic><sub><italic>δ</italic></sub>(<italic>m</italic>)|, even though the sampled features are not independent. To apply decorrelation in <italic>Z</italic>-scoring metabomatching, match sum <xref ref-type="disp-formula" rid="pcbi.1005839.e005">(3)</xref> is not modified, but the variance is computed as |∑<sub><italic>fg</italic></sub> <italic>C</italic><sub><italic>δ</italic>;<italic>fg</italic></sub>|, with <italic>C</italic><sub><italic>δ</italic></sub> the block diagonal matrix as previously defined. As in <italic>χ</italic><sup>2</sup>-scoring, multiplet-mode and 2-compound variants applied by using the corresponding match sets in match sum <xref ref-type="disp-formula" rid="pcbi.1005839.e005">(3)</xref>. Because <italic>Z</italic>-scoring is explicitly sensitive to effect directions, ±-metabomatching is not required for SNPs affecting two metabolites with opposite effect directions. However, the separate presentation of results of ±-metabomatching may be useful in cases where the effect sizes are such as to cause metabolites matched with one effect direction to systematically outrank metabolites matched with the other direction.</p>
</sec>
<sec id="sec006">
<title>Output</title>
<p>To summarize, metabomatching is run for a given pseudospectrum: against a set of match sets, defined by the selected spectral reference database, the mode, and neighborhood parameter <italic>δ</italic>; where appropriate, as 1-compound, 2-compound, ±-, or ±-2-compound variant; and depending on performance, with or without decorrelation, and with <italic>χ</italic><sup>2</sup>- or <italic>Z</italic>-scoring. Metabomatching outputs the score for each metabolite in the spectral database, and produces a figure showing the pseudospectrum and the spectra of the highest ranked candidate metabolites (<xref ref-type="fig" rid="pcbi.1005839.g002">Fig 2</xref>).</p>
<fig id="pcbi.1005839.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005839.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Metabomatching results figure.</title>
<p>The metabomatching results figure, shown here for the same <italic>AGXT2</italic> pseudospectrum as in <xref ref-type="fig" rid="pcbi.1005839.g001">Fig 1</xref>. The figure shows the metabomatching settings used, the pseudospectrum with features color-coded by effect size, and, for the eight highest ranked candidate metabolites, the score, name, and reference NMR spectrum with match sets color-coded according to the height of the NMR spectrum peak they derive from.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005839.g002" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec007">
<title>Simulation</title>
<p>We bin the chemical shift range [0, 10] uniformly, in 0.01 ppm increments, and round reference spectra to the binning. We express the spectrum of each metabolite as a vector <bold><italic>h</italic></bold><sup><italic>m</italic></sup>, with <inline-formula id="pcbi.1005839.e006"><alternatives><graphic id="pcbi.1005839.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005839.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:msubsup><mml:mi>h</mml:mi> <mml:mi>j</mml:mi> <mml:mi>m</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> the height of the peak in bin <italic>j</italic>, set to 0 if the spectrum does not include bin <italic>j</italic>, and define the <italic>size</italic> of the spectrum as <inline-formula id="pcbi.1005839.e007"><alternatives><graphic id="pcbi.1005839.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005839.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:mrow><mml:msup><mml:mi>s</mml:mi> <mml:mi>m</mml:mi></mml:msup> <mml:mo>≐</mml:mo> <mml:msub><mml:mo>∑</mml:mo> <mml:mi>j</mml:mi></mml:msub> <mml:msubsup><mml:mi>h</mml:mi> <mml:mi>j</mml:mi> <mml:mi>m</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>. To model the genetic association between a SNP and metabolite <italic>m</italic>, we randomly assign a genotype <italic>g</italic><sub><italic>i</italic></sub> ∈ {0, 1, 2} to each individual (<italic>i</italic> ∈ [1, 400]), according to a minor allele frequency of 0.2, and build the feature metabolome <bold><italic>M</italic></bold><sup>0</sup> of elements
<disp-formula id="pcbi.1005839.e008"><alternatives><graphic id="pcbi.1005839.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005839.e008" xlink:type="simple"/><mml:math display="block" id="M8"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>M</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mn>0</mml:mn></mml:msubsup> <mml:mo>≐</mml:mo> <mml:mi>β</mml:mi> <mml:msubsup><mml:mi>h</mml:mi> <mml:mi>j</mml:mi> <mml:mi>m</mml:mi></mml:msubsup> <mml:msub><mml:mi>g</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mi mathvariant="script">N</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(4)</label></disp-formula>
Because the number of individuals, the minor allele frequency and the amplitude of noise are fixed, the strength of the association is controlled fully by the choice of effect size <italic>β</italic>. We then associate the metabolome <bold><italic>M</italic></bold><sup>0</sup> with the genotype <bold><italic>g</italic></bold>, and apply metabomatching to the resulting pseudospectrum. For each metabolite, we repeat this procedure 1 000 times, and compute <inline-formula id="pcbi.1005839.e009"><alternatives><graphic id="pcbi.1005839.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005839.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:msubsup><mml:mi>r</mml:mi> <mml:mn>90</mml:mn> <mml:mi>m</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>, the 90th percentile over the 1 000 ranks of <italic>m</italic>. We consider metabomatching successful for <italic>m</italic> if <inline-formula id="pcbi.1005839.e010"><alternatives><graphic id="pcbi.1005839.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005839.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:mrow><mml:msubsup><mml:mi>r</mml:mi> <mml:mrow><mml:mn>90</mml:mn></mml:mrow> <mml:mi>m</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p>From the results of this simple model, shown in <xref ref-type="fig" rid="pcbi.1005839.g003">Fig 3A</xref> for UMDB, we can make two important observations. First, that if the effect size is large enough, metabomatching can identify any metabolite. Second, that the performance of metabomatching, characterized here by <inline-formula id="pcbi.1005839.e011"><alternatives><graphic id="pcbi.1005839.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005839.e011" xlink:type="simple"/><mml:math display="inline" id="M11"><mml:msubsup><mml:mi>r</mml:mi> <mml:mrow><mml:mn>90</mml:mn></mml:mrow> <mml:mi>m</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>, is strongly correlated with the spectrum size.</p>
<fig id="pcbi.1005839.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005839.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Metabomatching results on simulated metabolomes.</title>
<p><bold>A.</bold> Metabomatching performance, measured as <inline-formula id="pcbi.1005839.e012"><alternatives><graphic id="pcbi.1005839.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005839.e012" xlink:type="simple"/><mml:math display="inline" id="M12"><mml:msubsup><mml:mi>r</mml:mi> <mml:mrow><mml:mn>90</mml:mn></mml:mrow> <mml:mi>m</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>, the 90<sup>th</sup> percentile of 1 000 ranks obtained for <italic>m</italic> by metabomatching pseudospectra build from the association with <bold><italic>M</italic></bold><sup>0</sup>, for <italic>β</italic> = 0.2 (filled dots) and <italic>β</italic> = 1.6 (empty dots), as a function of the size of the metabolite spectrum.For <italic>β</italic> = 0.2, the correlation between <inline-formula id="pcbi.1005839.e013"><alternatives><graphic id="pcbi.1005839.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005839.e013" xlink:type="simple"/><mml:math display="inline" id="M13"><mml:msubsup><mml:mi>r</mml:mi> <mml:mrow><mml:mn>90</mml:mn></mml:mrow> <mml:mi>m</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> and <italic>s</italic><sup><italic>m</italic></sup> is −0.71, with <italic>p</italic> ∼ 10<sup>−26</sup>. <bold>B.</bold> As in (<bold>A</bold>), but for metabolome <bold><italic>M</italic></bold><sup><italic>α</italic></sup>, with <italic>β</italic> = 1.6, <italic>N</italic><sub><italic>a</italic></sub> = 64 and <italic>α</italic> = 0.6. <bold>C.</bold> For UMDB and <italic>δ</italic> = 0.02, number of match sets (<italic>η</italic>) that contain each feature (uniform binning in 0.01 ppm increments). <bold>D.</bold> Metabomatching performance, measured as <inline-formula id="pcbi.1005839.e014"><alternatives><graphic id="pcbi.1005839.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005839.e014" xlink:type="simple"/><mml:math display="inline" id="M14"><mml:msubsup><mml:mi>r</mml:mi> <mml:mrow><mml:mn>90</mml:mn></mml:mrow> <mml:mi>m</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>, for <bold><italic>M</italic></bold><sup><italic>α</italic></sup>, with <italic>β</italic> = 1.6, <italic>N</italic><sub><italic>a</italic></sub> = 64 and <italic>α</italic> = 0.6, as a function of <italic>η</italic> of the leading peak of the metabolite spectrum, that is the peak with <italic>h</italic><sub><italic>j</italic></sub> = 1. Metabolite sizes are rounded. For <italic>s</italic><sup><italic>m</italic></sup> = 1, 2, and 3, respectively, correlations <italic>ρ</italic> are 0.86, 0.79, and 0.76, with <italic>p</italic>-values ∼10<sup>−10</sup>, 10<sup>−4</sup>, and 10<sup>−4</sup>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005839.g003" xlink:type="simple"/>
</fig>
<p>We then add genetic noise to the model, in the form of <italic>N</italic><sub><italic>a</italic></sub> randomly drawn features that also associate, with a randomly drawn direction, with genotype <bold><italic>g</italic></bold>. We insert these genetic noise features in the model by adding the terms <italic>a</italic><sub><italic>j</italic></sub> ∈ {−1, 0, 1}, such that ∑<sub><italic>j</italic></sub> |<italic>a</italic><sub><italic>j</italic></sub>| = <italic>N</italic><sub><italic>a</italic></sub>, when building the feature metabolome <bold><italic>M</italic></bold><sup><italic>α</italic></sup> of elements
<disp-formula id="pcbi.1005839.e015"><alternatives><graphic id="pcbi.1005839.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005839.e015" xlink:type="simple"/><mml:math display="block" id="M15"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>M</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>α</mml:mi></mml:msubsup> <mml:mo>≐</mml:mo> <mml:mi>β</mml:mi> <mml:msubsup><mml:mi>h</mml:mi> <mml:mi>j</mml:mi> <mml:mi>m</mml:mi></mml:msubsup> <mml:msub><mml:mi>g</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mi>α</mml:mi> <mml:mi>β</mml:mi> <mml:msub><mml:mi>g</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:msub><mml:mi>a</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mi mathvariant="script">N</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <italic>α</italic> &lt; 1. As the amount <italic>N</italic><sub><italic>a</italic></sub>, or amplitude <italic>α</italic>, of genetic noise increases, metabolite <italic>m</italic> faces wider, respectively stronger, competition from other metabolites in the spectral database.</p>
<p>When <italic>β</italic> is small, random noise still determines metabomatching performance, and <inline-formula id="pcbi.1005839.e016"><alternatives><graphic id="pcbi.1005839.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005839.e016" xlink:type="simple"/><mml:math display="inline" id="M16"><mml:msubsup><mml:mi>r</mml:mi> <mml:mrow><mml:mn>90</mml:mn></mml:mrow> <mml:mi>m</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> is similar to that for metabolome <bold><italic>M</italic></bold><sup>0</sup> shown in <xref ref-type="fig" rid="pcbi.1005839.g003">Fig 3A</xref>. When <italic>β</italic> is large, however, genetic noise dominates. As shown in <xref ref-type="fig" rid="pcbi.1005839.g003">Fig 3B</xref> (and <xref ref-type="supplementary-material" rid="pcbi.1005839.s007">S4 Fig</xref> for other settings and for both UMDB and HMDB), metabomatching can then no longer identify all metabolites consistently, because other metabolites in the database outscore <italic>m</italic> by matching genetic noise features. Some of these other metabolites may obtain their score from genetic noise features <italic>only</italic>, but true competition for <italic>m</italic> is provided by metabolites that match both genetic noise features and features of <italic>m</italic>. Because these competing metabolites have spectra similar to the spectrum of <italic>m</italic>, they tend to be viable metabomatching candidates. For metabolites with a single peak <italic>f</italic>, we can count the number of metabolites of match set that contain <italic>f</italic> to determine the size of this competing group. In <xref ref-type="fig" rid="pcbi.1005839.g003">Fig 3C</xref>, we show this number, <italic>η</italic>(<italic>f</italic>) for UMDB, and in <xref ref-type="fig" rid="pcbi.1005839.g003">Fig 3D</xref> we see that <inline-formula id="pcbi.1005839.e017"><alternatives><graphic id="pcbi.1005839.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005839.e017" xlink:type="simple"/><mml:math display="inline" id="M17"><mml:msubsup><mml:mi>r</mml:mi> <mml:mrow><mml:mn>90</mml:mn></mml:mrow> <mml:mi>m</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> for metabolites of size 1 correlates strongly with <italic>η</italic>. For larger spectra, where we take <italic>η</italic> for the lead feature (the one of height 1), the correlation holds, but <italic>η</italic> is less representative of the size of the competing group.</p>
</sec>
</sec>
<sec id="sec008" sec-type="results">
<title>Results</title>
<p>We first tested metabomatching on pseudospectra obtained in the urine NMR mGWAS [<xref ref-type="bibr" rid="pcbi.1005839.ref017">17</xref>] in the CoLaus study [<xref ref-type="bibr" rid="pcbi.1005839.ref029">29</xref>]. NMR data were aligned, normalized, and uniformly binned in 0.005 ppm increments. The resulting untargeted metabolome contained 1,276 features for 835 individuals. As references, we used SNP-metabolite associations that were previously reported in targeted mGWASes on urine NMR [<xref ref-type="bibr" rid="pcbi.1005839.ref008">8</xref>, <xref ref-type="bibr" rid="pcbi.1005839.ref018">18</xref>, <xref ref-type="bibr" rid="pcbi.1005839.ref020">20</xref>] with a <italic>p</italic>-value below 10<sup>−5</sup> and involving a metabolite for which an NMR spectrum is listed in UMDB. If a CoLaus SNP located within 500kb of the reference SNP associated with <italic>p</italic> &lt; 10<sup>−6</sup> with at least one feature contained in the match set of the reference metabolite (with <italic>δ</italic> = 0.03 in peak mode, 0.01 in multiplet mode), we considered the CoLaus SNP pseudospectrum <italic>testable</italic>, and assumed the reference metabolite to be the metabolite underlying the SNP-feature association. This resulted in nine testable pseudospectra, each with a single reference metabolite.</p>
<p>Metabomatching with default settings (peak mode, <italic>χ</italic><sup>2</sup>-scoring, and without decorrelation), and using the urine specific UMDB reference database, was successful for eight of the nine testable pseudospectra, ranking the reference metabolite first three times and in the top ten five times (column <inline-formula id="pcbi.1005839.e018"><alternatives><graphic id="pcbi.1005839.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005839.e018" xlink:type="simple"/><mml:math display="inline" id="M18"><mml:msubsup><mml:mrow><mml:mtext>P</mml:mtext></mml:mrow> <mml:mtext>C</mml:mtext> <mml:mtext>X</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> of <xref ref-type="table" rid="pcbi.1005839.t001">Table 1</xref>, detailed results in <xref ref-type="supplementary-material" rid="pcbi.1005839.s004">S1 Fig</xref>). For the <italic>SOSTDC1</italic> SNP, the pseudospectrum (<xref ref-type="supplementary-material" rid="pcbi.1005839.s004">S1C Fig</xref>) shows strong inflation across almost the entire chemical shift range, making metabomatching fail systematically. Metabomatching in multiplet mode performed better overall (column <inline-formula id="pcbi.1005839.e019"><alternatives><graphic id="pcbi.1005839.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005839.e019" xlink:type="simple"/><mml:math display="inline" id="M19"><mml:msubsup><mml:mrow><mml:mtext>M</mml:mtext></mml:mrow> <mml:mtext>C</mml:mtext> <mml:mtext>X</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula>), ranking the reference metabolites first six times and second twice, though the performance was qualitatively different only for the <italic>HPD</italic> SNP pseudospectrum, for which the testable association involved a different reference metabolite (<xref ref-type="supplementary-material" rid="pcbi.1005839.s004">S1F and S1G Fig</xref>). Decorrelation had little effect on rankings, in either mode, provided a shrinkage parameter λ greater than 0.1 was used (results for λ = 0.5 in <xref ref-type="table" rid="pcbi.1005839.t001">Table 1</xref> columns <inline-formula id="pcbi.1005839.e020"><alternatives><graphic id="pcbi.1005839.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005839.e020" xlink:type="simple"/><mml:math display="inline" id="M20"><mml:msubsup><mml:mrow><mml:mtext>P</mml:mtext></mml:mrow> <mml:mtext>D</mml:mtext> <mml:mtext>X</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005839.e021"><alternatives><graphic id="pcbi.1005839.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005839.e021" xlink:type="simple"/><mml:math display="inline" id="M21"><mml:msubsup><mml:mrow><mml:mtext>M</mml:mtext></mml:mrow> <mml:mtext>D</mml:mtext> <mml:mtext>X</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula>, other values of λ in <xref ref-type="supplementary-material" rid="pcbi.1005839.s001">S1 Table</xref>).</p>
<table-wrap id="pcbi.1005839.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005839.t001</object-id>
<label>Table 1</label>
<caption>
<title>CoLaus metabomatching results.</title>
<p>Ranks of reference metabolites obtained for CoLaus pseudospectra, with UMDB as the spectral reference database, and with: peak- (P) or multiplet-mode (M), <italic>χ</italic><sup>2</sup>- (X) or <italic>Z</italic>-scoring (Z), and without (C) or with decorrelation (D). Neighborhood parameter is <italic>δ</italic> = 0.03 in peak-mode, 0.01 in multiplet-mode. Shrinkage parameter is λ = 0.5 for decorrelation, 1 without. Reference metabolites are obtained from testable associations collected from targeted mGWAS [<xref ref-type="bibr" rid="pcbi.1005839.ref008">8</xref>, <xref ref-type="bibr" rid="pcbi.1005839.ref018">18</xref>, <xref ref-type="bibr" rid="pcbi.1005839.ref019">19</xref>]. Squares (□) indicate ranks not in the top 10% of UMDB listed metabolites, that is ranks greater than 18. Individual metabomatching figures including the eight highest ranked metabolite candidates for each pseudospectrum can be found in <xref ref-type="supplementary-material" rid="pcbi.1005839.s004">S1 Fig</xref>. Due to the differences in the peak and multiplet descriptions, the association of the <italic>HPD</italic> SNP with <italic>α</italic>-hydroxyisobutyrate is testable only in peak mode (<xref ref-type="supplementary-material" rid="pcbi.1005839.s004">S1F Fig</xref>), the association with 3-hydroxyisovalerate only in multiplet mode (<xref ref-type="supplementary-material" rid="pcbi.1005839.s004">S1G Fig</xref>).</p>
</caption>
<alternatives>
<graphic id="pcbi.1005839.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005839.t001" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left" colspan="2">Locus</th>
<th align="left" colspan="3">Reference Association</th>
<th align="left" colspan="3">Feature Association</th>
<th align="left" colspan="8">Ranks</th>
</tr>
<tr>
<th align="left">Gene</th>
<th align="left">Chr</th>
<th align="left">SNP</th>
<th align="left">Metabolite</th>
<th align="left"><italic>p</italic></th>
<th align="left">SNP</th>
<th align="left">Feat.</th>
<th align="left"><italic>p</italic></th>
<th align="right">
<inline-formula id="pcbi.1005839.e022">
<alternatives>
<graphic id="pcbi.1005839.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005839.e022" xlink:type="simple"/>
<mml:math display="inline" id="M22">
<mml:msubsup>
<mml:mtext>P</mml:mtext>
<mml:mtext>C</mml:mtext>
<mml:mtext>X</mml:mtext>
</mml:msubsup>
</mml:math>
</alternatives>
</inline-formula>
</th>
<th align="right">
<inline-formula id="pcbi.1005839.e023">
<alternatives>
<graphic id="pcbi.1005839.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005839.e023" xlink:type="simple"/>
<mml:math display="inline" id="M23">
<mml:msubsup>
<mml:mtext>P</mml:mtext>
<mml:mtext>D</mml:mtext>
<mml:mtext>X</mml:mtext>
</mml:msubsup>
</mml:math>
</alternatives>
</inline-formula>
</th>
<th align="right">
<inline-formula id="pcbi.1005839.e024">
<alternatives>
<graphic id="pcbi.1005839.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005839.e024" xlink:type="simple"/>
<mml:math display="inline" id="M24">
<mml:msubsup>
<mml:mtext>M</mml:mtext>
<mml:mtext>C</mml:mtext>
<mml:mtext>X</mml:mtext>
</mml:msubsup>
</mml:math>
</alternatives>
</inline-formula>
</th>
<th align="right">
<inline-formula id="pcbi.1005839.e025">
<alternatives>
<graphic id="pcbi.1005839.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005839.e025" xlink:type="simple"/>
<mml:math display="inline" id="M25">
<mml:msubsup>
<mml:mtext>M</mml:mtext>
<mml:mtext>D</mml:mtext>
<mml:mtext>X</mml:mtext>
</mml:msubsup>
</mml:math>
</alternatives>
</inline-formula>
</th>
<th align="right"><inline-formula id="pcbi.1005839.e026"><alternatives><graphic id="pcbi.1005839.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005839.e026" xlink:type="simple"/><mml:math display="inline" id="M26"><mml:msubsup><mml:mtext>P</mml:mtext> <mml:mtext>C</mml:mtext> <mml:mtext>Z</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula></th>
<th align="right">
<inline-formula id="pcbi.1005839.e027">
<alternatives>
<graphic id="pcbi.1005839.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005839.e027" xlink:type="simple"/>
<mml:math display="inline" id="M27">
<mml:msubsup>
<mml:mtext>P</mml:mtext>
<mml:mtext>D</mml:mtext>
<mml:mtext>Z</mml:mtext>
</mml:msubsup>
</mml:math>
</alternatives>
</inline-formula>
</th>
<th align="right">
<inline-formula id="pcbi.1005839.e028">
<alternatives>
<graphic id="pcbi.1005839.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005839.e028" xlink:type="simple"/>
<mml:math display="inline" id="M28">
<mml:msubsup>
<mml:mtext>M</mml:mtext>
<mml:mtext>C</mml:mtext>
<mml:mtext>Z</mml:mtext>
</mml:msubsup>
</mml:math>
</alternatives>
</inline-formula>
</th>
<th align="right">
<inline-formula id="pcbi.1005839.e029">
<alternatives>
<graphic id="pcbi.1005839.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005839.e029" xlink:type="simple"/>
<mml:math display="inline" id="M29">
<mml:msubsup>
<mml:mtext>M</mml:mtext>
<mml:mtext>D</mml:mtext>
<mml:mtext>Z</mml:mtext>
</mml:msubsup>
</mml:math>
</alternatives>
</inline-formula>
</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><italic>SLC6A20</italic></td>
<td align="left">3</td>
<td align="left">rs17279437</td>
<td align="left">dimethylglycine</td>
<td align="left">1.1 × 10<sup>−46</sup></td>
<td align="left">rs4327428</td>
<td align="left">2.933</td>
<td align="right">7.3 × 10<sup>−10</sup></td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">□</td>
<td align="right">7</td>
<td align="right">12</td>
<td align="right">1</td>
</tr>
<tr>
<td align="left"><italic>AGXT2</italic></td>
<td align="left">5</td>
<td align="left">rs37369</td>
<td align="left">3-aminoisobutyrate</td>
<td align="left">2.4 × 10<sup>−252</sup></td>
<td align="left">rs37369</td>
<td align="left">1.203</td>
<td align="right">3.9 × 10<sup>−42</sup></td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr>
<td align="left"><italic>SOSTDC1</italic></td>
<td align="left">7</td>
<td align="left">rs10238442</td>
<td align="left">taurine</td>
<td align="left">4.0 × 10<sup>−6</sup></td>
<td align="left">rs17169536</td>
<td align="left">3.393</td>
<td align="right">7.6 × 10<sup>−7</sup></td>
<td align="right">□</td>
<td align="right">□</td>
<td align="right">□</td>
<td align="right">12</td>
<td align="right">□</td>
<td align="right">□</td>
<td align="right">□</td>
<td align="right">□</td>
</tr>
<tr>
<td align="left"><italic>PYROXD2</italic></td>
<td align="left">10</td>
<td align="left">rs4539242</td>
<td align="left">trimethylamine</td>
<td align="left">2.8 × 10<sup>−23</sup></td>
<td align="left">rs4488133</td>
<td align="left">2.857</td>
<td align="right">1.3 × 10<sup>−98</sup></td>
<td align="right">5</td>
<td align="right">4</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">4</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">3</td>
</tr>
<tr>
<td align="left"><italic>SLC6A13</italic></td>
<td align="left">12</td>
<td align="left">rs11613331</td>
<td align="left">3-aminoisobutyrate</td>
<td align="left">2.5 × 10<sup>−15</sup></td>
<td align="left">rs10774021</td>
<td align="left">1.193</td>
<td align="right">9.5 × 10<sup>−10</sup></td>
<td align="right">4</td>
<td align="right">4</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">14</td>
<td align="right">5</td>
<td align="right">□</td>
<td align="right">□</td>
</tr>
<tr>
<td align="left"><italic>HPD</italic></td>
<td align="left">12</td>
<td align="left">rs4760099</td>
<td align="left"><italic>α</italic>-hydroxyisobutyrate</td>
<td align="left">2.2 × 10<sup>−80</sup></td>
<td align="left">rs7314056</td>
<td align="left">1.363</td>
<td align="right">9.8 × 10<sup>−11</sup></td>
<td align="right">3</td>
<td align="right">1</td>
<td align="left"/>
<td align="left"/>
<td align="right">□</td>
<td align="right">□</td>
<td align="left"/>
<td align="left"/>
</tr>
<tr>
<td align="left"/>
<td align="left"/>
<td align="left"/>
<td align="left">3-hydroxyisovalerate</td>
<td align="left">2.4 × 10<sup>−7</sup></td>
<td align="left"/>
<td align="left"/>
<td align="left"/>
<td align="left"/>
<td align="left"/>
<td align="right">2</td>
<td align="right">5</td>
<td align="left"/>
<td align="left"/>
<td align="right">□</td>
<td align="right">□</td>
</tr>
<tr>
<td align="left"><italic>PNMT</italic></td>
<td align="left">17</td>
<td align="left">rs8069451</td>
<td align="left">tyrosine</td>
<td align="left">7.9 × 10<sup>−22</sup></td>
<td align="left">rs676882</td>
<td align="left">6.897</td>
<td align="right">1.8 × 10<sup>−8</sup></td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">□</td>
<td align="right">□</td>
<td align="right">□</td>
<td align="right">□</td>
</tr>
<tr>
<td align="left"><italic>SLC7A9</italic></td>
<td align="left">19</td>
<td align="left">rs8101881</td>
<td align="left">lysine</td>
<td align="left">3.3 × 10<sup>−25</sup></td>
<td align="left">rs6510300</td>
<td align="left">1.733</td>
<td align="right">3.9 × 10<sup>−15</sup></td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">2</td>
</tr>
<tr>
<td align="left"><italic>UPS9</italic></td>
<td align="left">19</td>
<td align="left">rs13343495</td>
<td align="left">sucrose</td>
<td align="left">3.4 × 10<sup>−6</sup></td>
<td align="left">rs17273533</td>
<td align="left">5.417</td>
<td align="right">4.0 × 10<sup>−7</sup></td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p><italic>Z</italic>-scoring metabomatching properly ranked the reference metabolites for the pseudospectra characterized by the strongest associations, that is those for SNPs in <italic>AGXT2</italic>, <italic>PYROXD2</italic>, and <italic>SLC7A9</italic>. Pseudospectra with weaker associations fared worse, with <italic>Z</italic>-scoring metabomatching ranks significantly lower than their <italic>χ</italic><sup>2</sup>-scoring counterparts, except for the <italic>UPS9</italic> pseudospectrum. For the <italic>SLC6A20</italic> and <italic>SLC6A13</italic> pseudospectra, the reference metabolite is outranked by a number of metabolites of spectra that obtain their score by matching a group of strongly correlated features. Applying decorrelation reduces this correlation-based score, thereby significantly improving the rank of the reference metabolite in both peak- and multiplet-mode (see <xref ref-type="supplementary-material" rid="pcbi.1005839.s006">S3 Fig</xref>).</p>
<p>Using the full HMDB spectral database (<xref ref-type="supplementary-material" rid="pcbi.1005839.s002">S2 Table</xref>), metabomatching ranked the reference metabolites for <italic>PYROXD2</italic>, <italic>PNMT</italic>, <italic>HPD</italic> markedly lower, due to stronger competition among the larger pool of candidate metabolites. Using the UMRB or BMRB spectral databases (<xref ref-type="supplementary-material" rid="pcbi.1005839.s002">S2 Table</xref>), metabomatching ranks the reference metabolite for <italic>PNMT</italic> lower, for <italic>PYROXD2</italic> higher, but is otherwise comparable to UMDB or HMDB, respectively.</p>
<p>We then tested metabomatching on pseudospectra obtained in the urine mGWAS [<xref ref-type="bibr" rid="pcbi.1005839.ref020">20</xref>] in the SHIP study [<xref ref-type="bibr" rid="pcbi.1005839.ref030">30</xref>]. NMR data were normalized, binned in 0.0005 ppm increments, then processed with FOCUS [<xref ref-type="bibr" rid="pcbi.1005839.ref031">31</xref>]. The resulting untargeted metabolome contained 166 features for 3,861 individuals. In addition, NMR data were manually annotated using Chenomx NMR Suite 7.0. The resulting targeted metabolome contained the concentrations of 59 metabolites for the same 3,861 individuals. Having both metabolome features and metabolite concentrations in the same sample allowed for the direct comparison of SNP-metabolite association results via metabomatching with targeted metabolite quantification followed by association. We considered the pseudospectrum of a SNP associating with <italic>p</italic> &lt; 10<sup>−6</sup> with both a metabolite and at least one feature contained in the metabolite spectrum testable. This resulted in nineteen testable SNP-metabolite associations involving fourteen SNPs.</p>
<p>Because testing is in the same samples, and because of the higher sample size of the study, metabomatching results for SHIP pseudospectra are more nuanced than they were for CoLaus pseudospectra. For the nine SNPs that associate with a single metabolite, metabomatching in default settings ranked the reference metabolite first five times, and in the top ten four times (see <xref ref-type="table" rid="pcbi.1005839.t002">Table 2</xref> column <inline-formula id="pcbi.1005839.e030"><alternatives><graphic id="pcbi.1005839.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005839.e030" xlink:type="simple"/><mml:math display="inline" id="M30"><mml:msubsup><mml:mtext>P</mml:mtext> <mml:mtext>C</mml:mtext> <mml:mtext>X</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula>, detailed results in <xref ref-type="supplementary-material" rid="pcbi.1005839.s005">S2 Fig</xref>). For the <italic>CPS1</italic> and <italic>HPD</italic> SNPs, which associate with two metabolites each, metabomatching ranked one metabolite first, the second in the top ten, and 2-compound metabomatching ranked the reference metabolite pair first. The pseudospectra for the three remaining SNPs are more complex. While the <italic>NAT2</italic> SNP only associates with formate, its pseudospectrum (<xref ref-type="supplementary-material" rid="pcbi.1005839.s005">S2N Fig</xref>) indicates the presence of additional associations, in both effect directions. We therefore applied ±-2-compound metabomatching (<xref ref-type="supplementary-material" rid="pcbi.1005839.s005">S2O Fig</xref>), which ranks a metabolite pair that includes formate first, in the <italic>β</italic> &gt; 0 direction. With associations with three reference metabolites, the <italic>PNMT</italic> SNP pseudosepctrum (<xref ref-type="supplementary-material" rid="pcbi.1005839.s005">S2U Fig</xref>) is too complex for metabomatching, or 2-compound metabomatching, to provide any of the reference metabolites as plausible candidates. The <italic>SLC6A19</italic> SNP pseudospectrum (<xref ref-type="supplementary-material" rid="pcbi.1005839.s005">S2J Fig</xref>) is similar to the <italic>PNMT</italic> SNP pseudospectrum, but with weaker associations. Because the secondary associations are closer to the noise background, metabomatching still provides top ten ranks for the two reference metabolites. 2-compound metabomatching, however, does not properly rank the reference pair.</p>
<table-wrap id="pcbi.1005839.t002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005839.t002</object-id>
<label>Table 2</label>
<caption>
<title>SHIP metabomatching results.</title>
<p>Metabomatching ranks of reference metabolites obtained for SHIP pseudospectra, with UMDB as the spectral reference database, and with: peak- (P) or multiplet-mode (M), <italic>χ</italic><sup>2</sup>- (X) or <italic>Z</italic>-scoring (Z), and without (C) or with decorrelation (D). Neighborhood parameter is <italic>δ</italic> = 0.03 in peak-mode and 0.01 in multiplet-mode. Shrinkage parameter is λ = 0.5 for decorrelation, 1 without. Ranks obtained with 2-compound metabomatching are shown in bold, those obtained with ±-2-compound metabomatching in bold and italic. Squares (□) indicate ranks not in the top 10% of UMDB listed metabolites, that is ranks greater than 18. Individual metabomatching figures including the eight highest ranked metabolite candidates for each pseudospectrum can be found in <xref ref-type="supplementary-material" rid="pcbi.1005839.s005">S2 Fig</xref>.</p>
</caption>
<alternatives>
<graphic id="pcbi.1005839.t002g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005839.t002" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left" colspan="3">Locus</th>
<th align="left" colspan="2">Reference Association</th>
<th align="left" colspan="2">Feature Association</th>
<th align="left" colspan="8">Ranks</th>
</tr>
<tr>
<th align="left">Gene</th>
<th align="left">Chr</th>
<th align="left">SNP</th>
<th align="left">Metabolite</th>
<th align="left"><italic>p</italic></th>
<th align="left">Feature</th>
<th align="left"><italic>p</italic></th>
<th align="right">
<inline-formula id="pcbi.1005839.e031">
<alternatives>
<graphic id="pcbi.1005839.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005839.e031" xlink:type="simple"/>
<mml:math display="inline" id="M31">
<mml:msubsup>
<mml:mtext>P</mml:mtext>
<mml:mtext>C</mml:mtext>
<mml:mtext>X</mml:mtext>
</mml:msubsup>
</mml:math>
</alternatives>
</inline-formula>
</th>
<th align="right">
<inline-formula id="pcbi.1005839.e032">
<alternatives>
<graphic id="pcbi.1005839.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005839.e032" xlink:type="simple"/>
<mml:math display="inline" id="M32">
<mml:msubsup>
<mml:mtext>P</mml:mtext>
<mml:mtext>D</mml:mtext>
<mml:mtext>X</mml:mtext>
</mml:msubsup>
</mml:math>
</alternatives>
</inline-formula>
</th>
<th align="right">
<inline-formula id="pcbi.1005839.e033">
<alternatives>
<graphic id="pcbi.1005839.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005839.e033" xlink:type="simple"/>
<mml:math display="inline" id="M33">
<mml:msubsup>
<mml:mtext>P</mml:mtext>
<mml:mtext>C</mml:mtext>
<mml:mtext>Z</mml:mtext>
</mml:msubsup>
</mml:math>
</alternatives>
</inline-formula>
</th>
<th align="right">
<inline-formula id="pcbi.1005839.e034">
<alternatives>
<graphic id="pcbi.1005839.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005839.e034" xlink:type="simple"/>
<mml:math display="inline" id="M34">
<mml:msubsup>
<mml:mtext>P</mml:mtext>
<mml:mtext>D</mml:mtext>
<mml:mtext>Z</mml:mtext>
</mml:msubsup>
</mml:math>
</alternatives>
</inline-formula>
</th>
<th align="right">
<inline-formula id="pcbi.1005839.e035">
<alternatives>
<graphic id="pcbi.1005839.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005839.e035" xlink:type="simple"/>
<mml:math display="inline" id="M35">
<mml:msubsup>
<mml:mtext>M</mml:mtext>
<mml:mtext>C</mml:mtext>
<mml:mtext>X</mml:mtext>
</mml:msubsup>
</mml:math>
</alternatives>
</inline-formula>
</th>
<th align="right">
<inline-formula id="pcbi.1005839.e036">
<alternatives>
<graphic id="pcbi.1005839.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005839.e036" xlink:type="simple"/>
<mml:math display="inline" id="M36">
<mml:msubsup>
<mml:mtext>M</mml:mtext>
<mml:mtext>D</mml:mtext>
<mml:mtext>X</mml:mtext>
</mml:msubsup>
</mml:math>
</alternatives>
</inline-formula>
</th>
<th align="right">
<inline-formula id="pcbi.1005839.e037">
<alternatives>
<graphic id="pcbi.1005839.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005839.e037" xlink:type="simple"/>
<mml:math display="inline" id="M37">
<mml:msubsup>
<mml:mtext>M</mml:mtext>
<mml:mtext>C</mml:mtext>
<mml:mtext>Z</mml:mtext>
</mml:msubsup>
</mml:math>
</alternatives>
</inline-formula>
</th>
<th align="right">
<inline-formula id="pcbi.1005839.e038">
<alternatives>
<graphic id="pcbi.1005839.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005839.e038" xlink:type="simple"/>
<mml:math display="inline" id="M38">
<mml:msubsup>
<mml:mtext>M</mml:mtext>
<mml:mtext>D</mml:mtext>
<mml:mtext>Z</mml:mtext>
</mml:msubsup>
</mml:math>
</alternatives>
</inline-formula>
</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><italic>DAB1</italic></td>
<td align="left">1</td>
<td align="left">rs558475</td>
<td align="left">hippurate</td>
<td align="left">3.9 × 10<sup>−7</sup></td>
<td align="left">3.949</td>
<td align="right">3.6 × 10<sup>−8</sup></td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr>
<td align="left"><italic>CPS1</italic></td>
<td align="left">2</td>
<td align="left">rs2216405</td>
<td align="left">glycine</td>
<td align="left">2.9 × 10<sup>−11</sup></td>
<td align="left">3.555</td>
<td align="right">4.9 × 10<sup>−9</sup></td>
<td align="right"><bold>1</bold></td>
<td align="right"><bold>1</bold></td>
<td align="right">□</td>
<td align="right">□</td>
<td align="right">3</td>
<td align="right">1</td>
<td align="right">□</td>
<td align="right">□</td>
</tr>
<tr>
<td align="left"/>
<td align="left"/>
<td align="left"/>
<td align="left">creatine</td>
<td align="left">7.5 × 10<sup>−11</sup></td>
<td align="left"/>
<td align="left"/>
<td align="right"><bold>1</bold></td>
<td align="right"><bold>1</bold></td>
<td align="right">□</td>
<td align="right">□</td>
<td align="right">16</td>
<td align="right">11</td>
<td align="right">□</td>
<td align="right">□</td>
</tr>
<tr>
<td align="left"><italic>XYLB</italic></td>
<td align="left">3</td>
<td align="left">rs2070486</td>
<td align="left">glycolate</td>
<td align="left">1.4 × 10<sup>−9</sup></td>
<td align="left">3.937</td>
<td align="right">2.4 × 10<sup>−9</sup></td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">2</td>
<td align="right">16</td>
<td align="right">16</td>
<td align="right">□</td>
<td align="right">□</td>
</tr>
<tr>
<td align="left"><italic>SLC6A20</italic></td>
<td align="left">3</td>
<td align="left">rs17279437</td>
<td align="left">dimethylglycine</td>
<td align="left">1.1 × 10<sup>−46</sup></td>
<td align="left">2.916</td>
<td align="right">1.1 × 10<sup>−21</sup></td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr>
<td align="left"><italic>ENTPPL</italic></td>
<td align="left">4</td>
<td align="left">rs7654111</td>
<td align="left">ethanolamine</td>
<td align="left">2.3 × 10<sup>−26</sup></td>
<td align="left">3.126</td>
<td align="right">5.0 × 10<sup>−16</sup></td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">5</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">2</td>
</tr>
<tr>
<td align="left"><italic>SLC6A19</italic></td>
<td align="left">5</td>
<td align="left">rs7719875</td>
<td align="left">histidine</td>
<td align="left">2.4 × 10<sup>−14</sup></td>
<td align="left">6.877</td>
<td align="right">6.4 × 10<sup>−12</sup></td>
<td align="right">8</td>
<td align="right">8</td>
<td align="right">10</td>
<td align="right">11</td>
<td align="right">10</td>
<td align="right">8</td>
<td align="right">8</td>
<td align="right">8</td>
</tr>
<tr>
<td align="left"/>
<td align="left"/>
<td align="left"/>
<td align="left">tyrosine</td>
<td align="left">6.5 × 10<sup>−10</sup></td>
<td align="left"/>
<td align="left"/>
<td align="right">9</td>
<td align="right">13</td>
<td align="right">12</td>
<td align="right">12</td>
<td align="right">12</td>
<td align="right">14</td>
<td align="right">□</td>
<td align="right">14</td>
</tr>
<tr>
<td align="left"><italic>AGXT2</italic></td>
<td align="left">5</td>
<td align="left">rs37369</td>
<td align="left">3-aminoisobutyrate</td>
<td align="left">2.4 × 10<sup>−252</sup></td>
<td align="left">1.171</td>
<td align="right">3.7 × 10<sup>−252</sup></td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr>
<td align="left"><italic>DMGDH</italic></td>
<td align="left">5</td>
<td align="left">rs248386</td>
<td align="left">dimethylglycine</td>
<td align="left">1.0 × 10<sup>−13</sup></td>
<td align="left">2.916</td>
<td align="right">1.8 × 10<sup>−8</sup></td>
<td align="right">5</td>
<td align="right">5</td>
<td align="right">□</td>
<td align="right">□</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">□</td>
<td align="right">□</td>
</tr>
<tr>
<td align="left"><italic>SLC36A2</italic></td>
<td align="left">5</td>
<td align="left">rs3846710</td>
<td align="left">glycine</td>
<td align="left">1.1 × 10<sup>−10</sup></td>
<td align="left">3.555</td>
<td align="right">6.3 × 10<sup>−9</sup></td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">5</td>
</tr>
<tr>
<td align="left"><italic>NAT2</italic></td>
<td align="left">8</td>
<td align="left">rs1495743</td>
<td align="left">formate</td>
<td align="left">9.5 × 10<sup>−60</sup></td>
<td align="left">3.189</td>
<td align="right">1.6 × 10<sup>−104</sup></td>
<td align="right"><bold><italic>1</italic></bold></td>
<td align="right"><bold><italic>1</italic></bold></td>
<td align="right"><bold>1</bold></td>
<td align="right"><bold>1</bold></td>
<td align="right"><bold><italic>1</italic></bold></td>
<td align="right"><bold><italic>1</italic></bold></td>
<td align="right"><bold>1</bold></td>
<td align="right"><bold>1</bold></td>
</tr>
<tr>
<td align="left"><italic>SLC6A13</italic></td>
<td align="left">12</td>
<td align="left">rs11613331</td>
<td align="left">3-aminoisobutyrate</td>
<td align="left">2.5 × 10<sup>−15</sup></td>
<td align="left">1.190</td>
<td align="right">5.0 × 10<sup>−16</sup></td>
<td align="right">5</td>
<td align="right">5</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">4</td>
<td align="right">3</td>
<td align="right">3</td>
</tr>
<tr>
<td align="left"><italic>HPD</italic></td>
<td align="left">12</td>
<td align="left">rs4760099</td>
<td align="left"><italic>α</italic>-hydroxyisobutyrate</td>
<td align="left">2.2 × 10<sup>−80</sup></td>
<td align="left">1.345</td>
<td align="right">2.2 × 10<sup>−64</sup></td>
<td align="right"><bold>1</bold></td>
<td align="right"><bold>1</bold></td>
<td align="right"><bold>1</bold></td>
<td align="right"><bold>1</bold></td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr>
<td align="left"/>
<td align="left"/>
<td align="left"/>
<td align="left">3-hydroxyisovalerate</td>
<td align="left">2.4 × 10<sup>−7</sup></td>
<td align="left"/>
<td align="left"/>
<td align="right"><bold>1</bold></td>
<td align="right"><bold>1</bold></td>
<td align="right"><bold>1</bold></td>
<td align="right"><bold>1</bold></td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">2</td>
<td align="right">5</td>
</tr>
<tr>
<td align="left"><italic>PNMT</italic></td>
<td align="left">17</td>
<td align="left">rs8069451</td>
<td align="left">tyrosine</td>
<td align="left">7.9 × 10<sup>−22</sup></td>
<td align="left">6.877</td>
<td align="right">4.4 × 10<sup>−17</sup></td>
<td align="right">□</td>
<td align="right">□</td>
<td align="right">□</td>
<td align="right">□</td>
<td align="right">□</td>
<td align="right">□</td>
<td align="right">□</td>
<td align="right">□</td>
</tr>
<tr>
<td align="left"/>
<td align="left"/>
<td align="left"/>
<td align="left">histidine</td>
<td align="left">7.3 × 10<sup>−21</sup></td>
<td align="left"/>
<td align="left"/>
<td align="right">□</td>
<td align="right">□</td>
<td align="right">□</td>
<td align="right">□</td>
<td align="right">□</td>
<td align="right">□</td>
<td align="right">□</td>
<td align="right">□</td>
</tr>
<tr>
<td align="left"/>
<td align="left"/>
<td align="left"/>
<td align="left">alanine</td>
<td align="left">2.3 × 10<sup>−11</sup></td>
<td align="left"/>
<td align="left"/>
<td align="right">18</td>
<td align="right">18</td>
<td align="right">16</td>
<td align="right">□</td>
<td align="right">17</td>
<td align="right">□</td>
<td align="right">15</td>
<td align="right">□</td>
</tr>
<tr>
<td align="left"><italic>SCL7A9</italic></td>
<td align="left">19</td>
<td align="left">rs8112297</td>
<td align="left">lysine</td>
<td align="left">5.0 × 10<sup>−16</sup></td>
<td align="left">3.003</td>
<td align="right">9.4 × 10<sup>−7</sup></td>
<td align="right">9</td>
<td align="right">9</td>
<td align="right">15</td>
<td align="right">17</td>
<td align="right">15</td>
<td align="right">11</td>
<td align="right">17</td>
<td align="right">□</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>Metabomatching in multiplet mode shows similar results for most SNPs (column <inline-formula id="pcbi.1005839.e039"><alternatives><graphic id="pcbi.1005839.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005839.e039" xlink:type="simple"/><mml:math display="inline" id="M39"><mml:msubsup><mml:mtext>M</mml:mtext> <mml:mtext>C</mml:mtext> <mml:mtext>X</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula>). However, for the <italic>CPS1</italic>, <italic>XYLB</italic>, <italic>HPD</italic> SNPs, the multiplet ranges describing the spectra of the respective reference metabolites are wide (between 0.16 and 0.28 ppm) even though each range encloses only a single peak. The resulting multiplet-mode neighborhoods have a higher number of degrees of freedom than their peak-mode counterparts, yet produce similar sum values. This lowers the scores of the reference metabolites, which are then outranked by competing metabolites, particularly in 2-compound metabomatching (<xref ref-type="supplementary-material" rid="pcbi.1005839.s005">S2D, S2E, S2G, S2S and S2T Fig</xref>).</p>
<p><italic>Z</italic>-scoring metabomatching underperforms <italic>χ</italic><sup>2</sup>-scoring overall (columns <inline-formula id="pcbi.1005839.e040"><alternatives><graphic id="pcbi.1005839.e040g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005839.e040" xlink:type="simple"/><mml:math display="inline" id="M40"><mml:msubsup><mml:mtext>P</mml:mtext> <mml:mtext>C</mml:mtext> <mml:mtext>Z</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005839.e041"><alternatives><graphic id="pcbi.1005839.e041g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005839.e041" xlink:type="simple"/><mml:math display="inline" id="M41"><mml:msubsup><mml:mtext>M</mml:mtext> <mml:mtext>C</mml:mtext> <mml:mtext>Z</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula>), yet <italic>Z</italic>-scoring ranks obtained for the reference metabolites are close to their corresponding <italic>χ</italic><sup>2</sup>-scoring ranks for all but two pseudospectra. For the <italic>CPS1</italic> and <italic>DMGDH</italic> pseudospectra, the association of the lead feature is too weak to compensate for the associations of opposite effect direction of other features captured by the match sets of the corresponding reference metabolites (see <xref ref-type="supplementary-material" rid="pcbi.1005839.s005">S2B and S2L Fig</xref>). The resulting penalties incurred under <italic>Z</italic>-scoring produce low reference metabolite ranks.</p>
<p>FOCUS combines neighboring features into a single representative feature, obtained either by peak picking or by integration of the NMR curve in the neighborhood. As a result, the effect on metabomatching ranks of correlation in feature neighborhoods is weaker because neighborhoods contain fewer features after FOCUS processing. Correspondingly, ranks with decorrelation are essentially equal to ranks without decorrelation (columns <inline-formula id="pcbi.1005839.e042"><alternatives><graphic id="pcbi.1005839.e042g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005839.e042" xlink:type="simple"/><mml:math display="inline" id="M42"><mml:msubsup><mml:mtext>P</mml:mtext> <mml:mtext>D</mml:mtext> <mml:mtext>X</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1005839.e043"><alternatives><graphic id="pcbi.1005839.e043g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005839.e043" xlink:type="simple"/><mml:math display="inline" id="M43"><mml:msubsup><mml:mtext>P</mml:mtext> <mml:mtext>D</mml:mtext> <mml:mtext>Z</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1005839.e044"><alternatives><graphic id="pcbi.1005839.e044g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005839.e044" xlink:type="simple"/><mml:math display="inline" id="M44"><mml:msubsup><mml:mtext>M</mml:mtext> <mml:mtext>D</mml:mtext> <mml:mtext>X</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula>, and <inline-formula id="pcbi.1005839.e045"><alternatives><graphic id="pcbi.1005839.e045g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005839.e045" xlink:type="simple"/><mml:math display="inline" id="M45"><mml:msubsup><mml:mtext>M</mml:mtext> <mml:mtext>D</mml:mtext> <mml:mtext>Z</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula>).</p>
<p>Using the full HMDB spectral database (<xref ref-type="supplementary-material" rid="pcbi.1005839.s003">S3 Table</xref>), metabomatching ranked the reference metabolites for <italic>SLC6A20</italic>, <italic>SLC7A9</italic> markedly lower. Using the UMRB or BMRB spectral databases (<xref ref-type="supplementary-material" rid="pcbi.1005839.s003">S3 Table</xref>), metabomatching ranks the reference metabolites for <italic>SLC6A19</italic>, <italic>SLC6A13</italic>, and <italic>PNMT</italic> higher, but is otherwise comparable to UMDB or HMDB, respectively.</p>
</sec>
<sec id="sec009" sec-type="conclusions">
<title>Discussion</title>
<p>Under the test conditions used here, metabomatching has shown to be remarkably successful in identifying the metabolites underlying the feature associations in the investigated pseudospectra, by generally highly ranking the respective reference metabolites. In normal conditions, where the underlying metabolites are not known, the performance of metabomatching depends on the characteristics of the untargeted mGWAS.</p>
<p>First and foremost, metabomatching can only identify an underlying metabolite for which a spectrum is listed in the supplied spectral database. Here, we only tested metabomatching on untargeted associations that we could link to reference metabolites with listed spectra. However, both the CoLaus [<xref ref-type="bibr" rid="pcbi.1005839.ref017">17</xref>] and SHIP [<xref ref-type="bibr" rid="pcbi.1005839.ref020">20</xref>] mGWASes discovered feature associations to which metabomatching did not assign plausible candidates, likely because the spectra of the underlying metabolites are absent from HMDB.</p>
<p>Similarly, metabomatching can only properly rank the metabolite to identify if the NMR spectrum in the provided database does not significantly deviate from the NMR spectrum as measured in the experimental conditions specific to the mGWAS. Such deviations are common, and can be significant. For example, if we compare match sets pairs for the 318 metabolites of spectra that are listed both in HMDB and BMRB, but were not necessarily acquired under identical experimental conditions, we find that the match sets of 133 metabolites differ by at least one feature and that the match sets of 29 metabolites have no common features. Increasing the neighborhood parameter <italic>δ</italic> in the match set definitions can mitigate such deviations, but in turn, larger neighborhoods make metabolites generally more difficult to distinguish.</p>
<p>If the metabolite underlying an observed metabolome feature association is listed in the database, and if the listed spectrum does not significantly deviate from the mGWAS specific spectrum, then the underlying metabolite obtains a high metabomatching score. For the metabolite to also obtain a high rank, however, it needs to outscore other listed metabolites. If the observed feature association is strong enough, the underlying metabolite outscores all those metabolites whose spectra do not include the associated feature, and whose scores therefore rely essentially on the level of noise in the pseudospectrum. The <italic>p</italic>-value threshold of 5 × 10<sup>−8</sup>, the Bonferroni threshold for significance when correcting only for the number of tested SNPs, is usually sufficient for signal-based scores to outrank almost all noise-based scores.</p>
<p>The main competition for top metabomatching rank then stems from metabolites with a listed spectrum which also matches the associated feature. Therefore, the more distinctive the underlying metabolite, that is the more dissimilar it is from the other metabolites in the spectral database, the higher it ranks. The distinctiveness of a metabolite is not an intrinsic property of the metabolite spectrum, not only because it depends on the chosen database, but because it depends on the mGWAS itself. For example, small peaks that contribute to the distinctiveness of a spectrum may be lost in a low powered mGWAS, thereby making metabolites distinct in spectra indistinguishable for metabomatching. However, the strongest matches among our test cases, that is those for loci <italic>AGXT2</italic> and <italic>SLC7A9</italic> in CoLaus (<xref ref-type="table" rid="pcbi.1005839.t001">Table 1</xref>), and <italic>DAB1</italic>, <italic>ENTTPL</italic>, and <italic>AGXT2</italic> in SHIP (<xref ref-type="table" rid="pcbi.1005839.t002">Table 2</xref>), follow a trend, similar to that suggested by our simulation results: the greater the number of clusters of peaks in the spectrum of a metabolite, the greater, and more resilient, its rank. Even though not all spectrum peaks will necessarily show strong association, metabolites with high cluster count spectra do tend to produce high cluster count pseudospectra. The corresponding matches are generally characterized in both high score and high distinctiveness.</p>
<p>The ideal settings under which to run metabomatching are specific to every mGWAS, and depend on the experimental conditions under which the feature metabolome was acquired, the data processing applied, and the statistical power of the study. Consequently, while the default settings (1-compound, HMDB, peak-mode, <italic>χ</italic><sup>2</sup>-scoring, <italic>δ</italic> = 0.03 and without decorrelation) provide a good starting point, the performance of metabomatching can be significantly improved by adapting the settings to the study.</p>
<p>The greatest impact on performance is likely achieved simply by selecting the appropriate biofluid-specific, and therefore smaller, spectral database. Then, it is advisable to run metabomatching with wide neighborhoods (<italic>δ</italic> = 0.05) first, to uncover potential issues of deviations of study spectra from reference spectra. While wide neighborhoods tend to muddle metabomatching results in general, good matches should still be obtained in specific cases where the SNP associates with multiple peaks in distinct clusters of a metabolite spectrum or with peaks of a distinctive metabolite spectrum. Guided by the performance on such cases, metabomatching should be run with progressively smaller values of <italic>δ</italic>, until the smallest <italic>δ</italic>, which still accounts for the observed deviations between study and reference spectra, is reached.</p>
<p>Pseudospectra should then be individually inspected for the need for multiple-compound metabomatching: 2-compound metabomatching if the associations are of the same effect direction, but no single metabolite matches them all; ±-metabomatching if the associations are of opposite effect directions.</p>
<p>With biofluid, <italic>δ</italic> and metabomatching variants defined, runs with decorrelation (taking λ = 0.5) or <italic>Z</italic>-scoring can be tested. Which scoring or decorrelation setting performs better is difficult to evaluate, and may be essentially subjective unless prior knowledge about the underlying metabolites is available.</p>
<p>Finally, metabomatching against other reference biofluid-specific subsets, such as those of BMRB or of multiplet description HMDB, may prove to provide stronger matches due to better conforming reference spectra, while metabomatching against full HMDB or BMRB may, for unmatched pseudospectra, identify metabolites that occur in the studied biofluid, while not being annotated as such.</p>
<p>Applying this procedure allows metabomatching to run in the settings best suited to the investigated mGWAS, and present the most likely candidate metabolites, among the provided set of reference metabolites, underlying observed SNP-feature associations. Because the spectral database never fully conforms to the set of metabolites investigated in any specific study, however, metabomatching cannot provide definitive identification. In some cases, additional evidence can strengthen metabomatching candidates, such as a direct biological connection between gene and candidate metabolite (<italic>ENTTPL</italic>, <italic>DMGDH</italic>) or coherent targeted mGWAS association results (all testable associations presented here, but <italic>CPS1</italic>, <italic>AGXT2</italic>, <italic>SLC6A13</italic>, and <italic>HPD</italic>, in particular, for which targeted association results also exist in blood and mass spectrometry mGWASes [<xref ref-type="bibr" rid="pcbi.1005839.ref007">7</xref>]). For the remaining cases, in-sample identification through manual annotation or further measurement from spiking experiments or 2-dimensional NMR spectroscopy may be required to verify the candidates provided by metabomatching.</p>
<sec id="sec010">
<title>Conclusion</title>
<p>While not yet as widespread as the targeted approach, the untargeted approach to metabolome-wide genome-wide association studies has already shown compelling results. Because it analyses all measured metabolome features, the untargeted approach more fully exploits experimental data and may discover genetically determined metabolites that were missed, because they eluded identification, by a targeted approach. By focusing the identification effort on the comparatively few metabolites found to be genetically determined, the untargeted approach also presents the pragmatic advantage of shortening the path from spectral metabolome data to mGWAS results.</p>
<p>Metabomatching further reduces this identification effort, by combining genetic spiking information with spectral reference data to assign candidate metabolites to genetically associated metabolome features. In addition, because identification through genetic spiking is not an in-sample procedure, metabomatching becomes of particular interest when applied in an mGWAS that combines untargeted and targeted approaches. In such a combined mGWAS, metabomatching can both provide an independent line of evidence for in-sample identifications of metabolites, and inform on the identity of metabolites that were missed by the targeted approach because they eluded in-sample identification.</p>
<p>Naturally, while focus was placed here, and in previous applications of metabomatching, on pseudospectra resulting from genetic association with NMR features, metabomatching is not limited to genome-wide association studies. Any trait that influences, or is influenced by, metabolome features produces an association pseudospectrum to which metabomatching can assign candidates. Notably, metabolome-wide association studies, analyzing the effects of the metabolome on organismal traits, would similarly benefit from both the untargeted approach and metabomatching.</p>
<p>The performance of metabomatching is inherently linked to the strength of genetic spiking and the quality of spectral databases. With increasing mGWAS sample sizes, and the continuing efforts to establish spectral databases that are more complete and better annotated, both conditions are expected to improve. Metabomatching is therefore not only likely to become a valuable tool for exploring the links to metabolites of listed spectrum, but may also provide impetus to complete databases of spectral information for human metabolites, reducing instances where no good match can be found.</p>
</sec>
<sec id="sec011">
<title>Software</title>
<p>Metabomatching is written for Matlab and compatible with octave. Documentation and code can be obtained from the metabomatching website <ext-link ext-link-type="uri" xlink:href="http://www.unil.ch/cbg/index.php?title=metabomatching" xlink:type="simple">http://www.unil.ch/cbg/index.php?title=metabomatching</ext-link> or GitHub. Metabomatching is also available as a docker container, and within the metabolomics e-infrastructure PhenoMeNal <ext-link ext-link-type="uri" xlink:href="http://phenomenal-h2020.eu" xlink:type="simple">http://phenomenal-h2020.eu</ext-link>.</p>
</sec>
</sec>
<sec id="sec012">
<title>Supporting information</title>
<supplementary-material id="pcbi.1005839.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005839.s001" xlink:type="simple">
<label>S1 Table</label>
<caption>
<title>CoLaus metabomatching results for different values of the shrinkage parameter λ.</title>
<p>Decorrelation has only a minor effect on metabomatching rankings. For λ ∈ [0.1, 0.9] only the <italic>HPD</italic>-<italic>α</italic>-hydroxyisobutyrate rank is significantly affected, going to 1 from 4 (at λ = 1). Without any shrinkage (λ = 0), however, several metabolites acquire artificially high scores, leading to lower ranks of the control metabolites for <italic>SLC6A20</italic> and <italic>UPS9</italic> in both peak- and multiplet-mode.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005839.s002" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005839.s002" xlink:type="simple">
<label>S2 Table</label>
<caption>
<title>CoLaus metabomatching results against HMDB, UMRB, and BMRB spectral databases.</title>
<p>Metabomatching performance using the spectral reference database UMRB, that is the urine-specific subset of BMRB, is similar to the performance using the spectral reference database UMDB. Trimethylamine ranks higher for <italic>PYROXD2</italic>, because the competing metabolites score lower in UMRB than UMDB. Tyrosine ranks lower because the BMRB listed spectrum deviates more from its pseudospectrum-implied CoLaus spectrum than the HMDB spectrum does. <italic>α</italic>-hydroxyisobutyrate and 3-hydroxyisovalerate do not have spectra listed in BMRB. Using the full HMDB or BMRB databases introduces more competing metabolites, significantly affecting the ranks of <italic>PYROXD2</italic> and <italic>PNMT</italic>.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005839.s003" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005839.s003" xlink:type="simple">
<label>S3 Table</label>
<caption>
<title>SHIP metabomatching results against HMDB, UMRB, and BMRB spectral databases.</title>
<p>We see that the spectra listed in BMRB tend to correspond better, overall, to the pseudospectrum-implied spectra of the metabolites in SHIP, resulting in better metabomatching ranks. This applies in particular to histidine, tyrosine, and 3-aminoisobutyrate, resulting in significantly better ranks for <italic>SLC6A19</italic>, <italic>SLC6A13</italic>, and <italic>PNMT</italic>. Strong matches in <italic>DAB1</italic>, <italic>SLC6A20</italic>, <italic>ENTPPL</italic>, <italic>AGXT2</italic>, <italic>SLC36A2</italic>, and <italic>NAT2</italic> maintain their high ranks when metabomatching is run against the full databases HMDB and BMRB. The ranks of weaker matches, which already suffered strong competition when using the urine-specific subsets, drop; in cases such as <italic>SLC6A20</italic> and <italic>SLC7A9</italic>, significantly so.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005839.s004" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005839.s004" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>CoLaus metabomatching figures.</title>
<p>Full results for UMDB peak-mode <italic>χ</italic><sup>2</sup>-scoring metabomatching for each of the nine testable CoLaus pseudospectra. Multiplet-mode metabomatching results are shown only for <italic>HPD</italic>, where they differ notably from peak-mode metabomatching results. The navigation table in the footer allows direct access to a specific pseudospectrum. The reference metabolite is indicated by a hash mark (#) next to its name.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005839.s005" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005839.s005" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>SHIP metabomatching figures.</title>
<p>Full results for UMDB peak-mode <italic>χ</italic><sup>2</sup>-scoring metabomatching for each of the fourteen testable SHIP pseudospectra. 2-compound metabomatching results are shown for <italic>CPS1</italic> and <italic>HPD</italic>, and ±-metabomatching results for <italic>NAT2</italic>. Multiplet-mode metabomatching results are shown only where they differ notably from peak-mode metabomatching results, that is for <italic>CPS1</italic>, <italic>XYLB</italic>, and <italic>HPD</italic>. The navigation table in the footer allows direct access to a specific pseudospectrum. The table is repeated on subsequent pages. The reference metabolites are marked with a hash mark (#) next to their name. To maintain a consistent layout where necessary, long metabolite names are replaced by the metabolite chemical abstract service registry number (CASRN), and a conversion table added to the bottom of the figure.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005839.s006" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005839.s006" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>An example of the effect of decorrelation in metabomatching.</title>
<p>The pseudospectrum of rs10774021 in <italic>SLC6A13</italic> is characterized by a single significantly associated feature: feature 1.19. (A) With <italic>χ</italic><sup>2</sup>-scoring metabomatching, the association with feature 1.19 is sufficient for metabolites of spectrum matching feature 1.19, including the reference metabolite 3-aminoisobutyrate, to obtain top ranks. (B) With <italic>Z</italic>-scoring metabomatching, metabolites of spectrum matching 1.19 are outranked by metabolites matching peaks in the region between 3.6 and 3.9 ppm, which produces, on its own, a score of 11.8. (C) The 3.6 to 3.9 ppm region is characterized by strong correlation. By applying decorrelation, with λ = 0.5, the score produced by the region, on its own, is reduced to 0.8. Correspondingly, with decorrelation, 3-aminoisobutyrate outranks most metabolites that, without decorrelation, ranked highly by matching the 3.6 to 3.9 ppm region.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005839.s007" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005839.s007" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>Simulation results for metabolome model including genetic noise.</title>
<p>Median <inline-formula id="pcbi.1005839.e046"><alternatives><graphic id="pcbi.1005839.e046g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005839.e046" xlink:type="simple"/><mml:math display="inline" id="M46"><mml:msubsup><mml:mi>r</mml:mi> <mml:mrow><mml:mn>90</mml:mn></mml:mrow> <mml:mi>m</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>, with metabolites grouped by their rounded size, and from light to dark blue, <italic>β</italic> = 0.2, 0.4, 1.6. We show results for UMDB and HMDB, neighborhood parameters <italic>δ</italic> = 0.02 and 0.05, <italic>χ</italic><sup>2</sup>- and <italic>Z</italic>-scoring, and two genetic noise levels, defined by <italic>N</italic><sub><italic>a</italic></sub> and <italic>α</italic> set to 16 and 0.4, and 64 and 0.6, respectively. From these cases, we see that the performance of metabomatching is consistently stronger in the smaller spectral database UMDB, and for smaller <italic>δ</italic>. For the weaker genetic noise, the median <inline-formula id="pcbi.1005839.e047"><alternatives><graphic id="pcbi.1005839.e047g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005839.e047" xlink:type="simple"/><mml:math display="inline" id="M47"><mml:msubsup><mml:mi>r</mml:mi> <mml:mrow><mml:mn>90</mml:mn></mml:mrow> <mml:mi>m</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> is equal to, or close to, 1, for sufficiently large <italic>β</italic>, except in the case of <italic>δ</italic> = 0.05 in HMDB for <italic>s</italic><sup><italic>m</italic></sup> = 2. For strong genetic noise, metabomatching performance is consistently poorer, with <inline-formula id="pcbi.1005839.e048"><alternatives><graphic id="pcbi.1005839.e048g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005839.e048" xlink:type="simple"/><mml:math display="inline" id="M48"><mml:msubsup><mml:mi>r</mml:mi> <mml:mrow><mml:mn>90</mml:mn></mml:mrow> <mml:mi>m</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> often far from 1. <italic>χ</italic><sup>2</sup>-scoring performs better than <italic>Z</italic>-scoring under weak genetic noise. When genetic noise is strong, however, <italic>Z</italic>-scoring performs almost invariably better: when <italic>β</italic> is large, there are sizes <italic>s</italic><sup><italic>m</italic></sup> for which <italic>Z</italic>-scoring produces <inline-formula id="pcbi.1005839.e049"><alternatives><graphic id="pcbi.1005839.e049g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005839.e049" xlink:type="simple"/><mml:math display="inline" id="M49"><mml:msubsup><mml:mi>r</mml:mi> <mml:mrow><mml:mn>90</mml:mn></mml:mrow> <mml:mi>m</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> close to 1 while <italic>χ</italic><sup>2</sup>-scoring fails to do so.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="pcbi.1005839.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gieger</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Geistlinger</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Altmaier</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Hrabé de Angelis</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Kronenberg</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Meitinger</surname> <given-names>T</given-names></name>, <etal>et al</etal>. <article-title>Genetics meets metabolomics: a genome-wide association study of metabolite profiles in human serum</article-title>. <source>PLoS Genet</source>. <year>2008</year>;<volume>4</volume>(<issue>11</issue>):<fpage>e1000282</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pgen.1000282" xlink:type="simple">10.1371/journal.pgen.1000282</ext-link></comment> <object-id pub-id-type="pmid">19043545</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005839.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Suhre</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Raffler</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Kastenmüller</surname> <given-names>G</given-names></name>. <article-title>Biochemical insights from population studies with genetics and metabolomics</article-title>. <source>Arch Biochem Biophys</source>. <year>2016</year>;<volume>589</volume>:<fpage>168</fpage>–<lpage>176</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.abb.2015.09.023" xlink:type="simple">10.1016/j.abb.2015.09.023</ext-link></comment> <object-id pub-id-type="pmid">26432701</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005839.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kastenmüller</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Raffler</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Gieger</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Suhre</surname> <given-names>K</given-names></name>. <article-title>Genetics of human metabolism: an update</article-title>. <source>Hum Mol Genet</source>. <year>2015</year>;<volume>24</volume>(<issue>R1</issue>):<fpage>R93</fpage>–<lpage>R101</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/hmg/ddv263" xlink:type="simple">10.1093/hmg/ddv263</ext-link></comment> <object-id pub-id-type="pmid">26160913</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005839.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Suhre</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Gieger</surname> <given-names>C</given-names></name>. <article-title>Genetic variation in metabolic phenotypes: study designs and applications</article-title>. <source>Nat Rev Genet</source>. <year>2012</year>;<volume>13</volume>(<issue>11</issue>):<fpage>759</fpage>–<lpage>769</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nrg3314" xlink:type="simple">10.1038/nrg3314</ext-link></comment> <object-id pub-id-type="pmid">23032255</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005839.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Illig</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Gieger</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Zhai</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Romisch-Margl</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Wang-Sattler</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Prehn</surname> <given-names>C</given-names></name>, <etal>et al</etal>. <article-title>A genome-wide perspective of genetic variation in human metabolism</article-title>. <source>Nat Genet</source>. <year>2010</year>;<volume>42</volume>(<issue>2</issue>):<fpage>137</fpage>–<lpage>141</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ng.507" xlink:type="simple">10.1038/ng.507</ext-link></comment> <object-id pub-id-type="pmid">20037589</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005839.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kettunen</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Tukiainen</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Sarin</surname> <given-names>AP</given-names></name>, <name name-style="western"><surname>Ortega-Alonso</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Tikkanen</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Lyytikäinen</surname> <given-names>LP</given-names></name>, <etal>et al</etal>. <article-title>Genome-wide association study identifies multiple loci influencing human serum metabolite levels</article-title>. <source>Nat Genet</source>. <year>2012</year>;<volume>44</volume>(<issue>3</issue>):<fpage>269</fpage>–<lpage>276</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ng.1073" xlink:type="simple">10.1038/ng.1073</ext-link></comment> <object-id pub-id-type="pmid">22286219</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005839.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Shin</surname> <given-names>SY</given-names></name>, <name name-style="western"><surname>So-Youn</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Fauman</surname> <given-names>EB</given-names></name>, <name name-style="western"><surname>Ann-Kristin</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Jan</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Rita</surname> <given-names>S</given-names></name>, <etal>et al</etal>. <article-title>An atlas of genetic influences on human blood metabolites</article-title>. <source>Nat Genet</source>. <year>2014</year>;<volume>46</volume>(<issue>6</issue>):<fpage>543</fpage>–<lpage>550</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ng.2982" xlink:type="simple">10.1038/ng.2982</ext-link></comment> <object-id pub-id-type="pmid">24816252</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005839.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Suhre</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Wallaschofski</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Raffler</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Friedrich</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Haring</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Michael</surname> <given-names>K</given-names></name>, <etal>et al</etal>. <article-title>A genome-wide association study of metabolic traits in human urine</article-title>. <source>Nat Genet</source>. <year>2011</year>;<volume>43</volume>(<issue>6</issue>):<fpage>565</fpage>–<lpage>569</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ng.837" xlink:type="simple">10.1038/ng.837</ext-link></comment> <object-id pub-id-type="pmid">21572414</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005839.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Suhre</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Shin</surname> <given-names>SY</given-names></name>, <name name-style="western"><surname>Petersen</surname> <given-names>AK</given-names></name>, <name name-style="western"><surname>Mohney</surname> <given-names>RP</given-names></name>, <name name-style="western"><surname>Meredith</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Wägele</surname> <given-names>B</given-names></name>, <etal>et al</etal>. <article-title>Human metabolic individuality in biomedical and pharmaceutical research</article-title>. <source>Nature</source>. <year>2011</year>;<volume>477</volume>(<issue>7362</issue>):<fpage>54</fpage>–<lpage>60</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature10354" xlink:type="simple">10.1038/nature10354</ext-link></comment> <object-id pub-id-type="pmid">21886157</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005839.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Demirkan</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Henneman</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Verhoeven</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Dharuri</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Amin</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>van Klinken</surname> <given-names>JB</given-names></name>, <etal>et al</etal>. <article-title>Insight in genome-wide association of metabolite quantitative traits by exome sequence analyses</article-title>. <source>PLoS Genet</source>. <year>2015</year>;<volume>11</volume>(<issue>1</issue>):<fpage>e1004835</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pgen.1004835" xlink:type="simple">10.1371/journal.pgen.1004835</ext-link></comment> <object-id pub-id-type="pmid">25569235</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005839.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Alonso</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Marsal</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Julià</surname> <given-names>A</given-names></name>. <article-title>Analytical Methods in Untargeted Metabolomics: State of the Art in 2015</article-title>. <source>Frontiers in Bioengineering and Biotechnology</source>. <year>2015</year>;<volume>3</volume>:<fpage>23</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3389/fbioe.2015.00023" xlink:type="simple">10.3389/fbioe.2015.00023</ext-link></comment> <object-id pub-id-type="pmid">25798438</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005839.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gowda</surname> <given-names>GAN</given-names></name>, <name name-style="western"><surname>Raftery</surname> <given-names>D</given-names></name>. <article-title>Quantitating Metabolites in Protein Precipitated Serum Using NMR Spectroscopy</article-title>. <source>Anal Chem</source>. <year>2014</year>;<volume>86</volume>(<issue>11</issue>):<fpage>5433</fpage>–<lpage>5440</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1021/ac5005103" xlink:type="simple">10.1021/ac5005103</ext-link></comment> <object-id pub-id-type="pmid">24796490</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005839.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hedjazi</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Gauguier</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Zalloua</surname> <given-names>PA</given-names></name>, <name name-style="western"><surname>Nicholson</surname> <given-names>JK</given-names></name>, <name name-style="western"><surname>Dumas</surname> <given-names>ME</given-names></name>, <name name-style="western"><surname>Cazier</surname> <given-names>JB</given-names></name>. <article-title>mQTL.NMR: an integrated suite for genetic mapping of quantitative variations of <sup>1</sup>H NMR-based metabolic profiles</article-title>. <source>Anal Chem</source>. <year>2015</year>;<volume>87</volume>(<issue>8</issue>):<fpage>4377</fpage>–<lpage>4384</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1021/acs.analchem.5b00145" xlink:type="simple">10.1021/acs.analchem.5b00145</ext-link></comment> <object-id pub-id-type="pmid">25803548</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005839.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Krumsiek</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Suhre</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Evans</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Mitchell</surname> <given-names>MW</given-names></name>, <name name-style="western"><surname>Mohney</surname> <given-names>RP</given-names></name>, <name name-style="western"><surname>Milburn</surname> <given-names>MV</given-names></name>, <etal>et al</etal>. <article-title>Mining the Unknown: A Systems Approach to Metabolite Identification Combining Genetic and Metabolic Information</article-title>. <source>PLoS Genet</source>. <year>2012</year>;<volume>8</volume>(<issue>10</issue>):<fpage>e1003005</fpage> <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pgen.1003005" xlink:type="simple">10.1371/journal.pgen.1003005</ext-link></comment> <object-id pub-id-type="pmid">23093944</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005839.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Everett</surname> <given-names>JR</given-names></name>. <article-title>A New Paradigm for Known Metabolite Identification in Metabonomics/Metabolomics: Metabolite Identification Efficiency</article-title>. <source>Computational and Structural Biotechnology Journal</source>. <year>2015</year>;<volume>13</volume>:<fpage>131</fpage>–<lpage>144</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.csbj.2015.01.002" xlink:type="simple">10.1016/j.csbj.2015.01.002</ext-link></comment> <object-id pub-id-type="pmid">25750701</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005839.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tulpan</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Léger</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Belliveau</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Culf</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Cuperlović-Culf</surname> <given-names>M</given-names></name>. <article-title>MetaboHunter: an automatic approach for identification of metabolites from <sup>1</sup>H-NMR spectra of complex mixtures</article-title>. <source>BMC Bioinformatics</source>. <year>2011</year>;<volume>12</volume>:<fpage>400</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/1471-2105-12-400" xlink:type="simple">10.1186/1471-2105-12-400</ext-link></comment> <object-id pub-id-type="pmid">21999117</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005839.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rueedi</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Ledda</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Nicholls</surname> <given-names>AW</given-names></name>, <name name-style="western"><surname>Salek</surname> <given-names>RM</given-names></name>, <name name-style="western"><surname>Marques-Vidal</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Morya</surname> <given-names>E</given-names></name>, <etal>et al</etal>. <article-title>Genome-wide association study of metabolic traits reveals novel gene-metabolite-disease links</article-title>. <source>PLoS Genet</source>. <year>2014</year>;<volume>10</volume>(<issue>2</issue>):<fpage>e1004132</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pgen.1004132" xlink:type="simple">10.1371/journal.pgen.1004132</ext-link></comment> <object-id pub-id-type="pmid">24586186</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005839.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Nicholson</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Rantalainen</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>JV</given-names></name>, <name name-style="western"><surname>Maher</surname> <given-names>AD</given-names></name>, <name name-style="western"><surname>Malmodin</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Ahmadi</surname> <given-names>KR</given-names></name>, <etal>et al</etal>. <article-title>A genome-wide metabolic QTL analysis in Europeans implicates two loci shaped by recent positive selection</article-title>. <source>PLoS Genet</source>. <year>2011</year>;<volume>7</volume>(<issue>9</issue>):<fpage>e1002270</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pgen.1002270" xlink:type="simple">10.1371/journal.pgen.1002270</ext-link></comment> <object-id pub-id-type="pmid">21931564</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005839.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Raffler</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Werner</surname> <given-names>RM</given-names></name>, <name name-style="western"><surname>Petersen</surname> <given-names>AK</given-names></name>, <name name-style="western"><surname>Pagel</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Blöchl</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Hengstenberg</surname> <given-names>C</given-names></name>, <etal>et al</etal>. <article-title>Identification and MS-assisted interpretation of genetically influenced NMR signals in human plasma</article-title>. <source>Genome Med</source>. <year>2013</year>;<volume>5</volume>(<issue>2</issue>):<fpage>13</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/gm417" xlink:type="simple">10.1186/gm417</ext-link></comment> <object-id pub-id-type="pmid">23414815</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005839.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Raffler</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Friedrich</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Arnold</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Kacprowski</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Rueedi</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Altmaier</surname> <given-names>E</given-names></name>, <etal>et al</etal>. <article-title>Genome-Wide Association Study with Targeted and Non-targeted NMR Metabolomics Identifies 15 Novel Loci of Urinary Human Metabolic Individuality</article-title>. <source>PLoS Genet</source>. <year>2015</year>;<volume>11</volume>(<issue>9</issue>):<fpage>e1005487</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pgen.1005487" xlink:type="simple">10.1371/journal.pgen.1005487</ext-link></comment> <object-id pub-id-type="pmid">26352407</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005839.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Anderson</surname> <given-names>PE</given-names></name>, <name name-style="western"><surname>Mahle</surname> <given-names>DA</given-names></name>, <name name-style="western"><surname>Doom</surname> <given-names>TE</given-names></name>, <name name-style="western"><surname>Reo</surname> <given-names>NV</given-names></name>, <name name-style="western"><surname>DelRaso</surname> <given-names>NJ</given-names></name>, <name name-style="western"><surname>Raymer</surname> <given-names>ML</given-names></name>. <article-title>Dynamic adaptive binning: an improved quantification technique for NMR spectroscopic data</article-title>. <source>Metabolomics</source>. <year>2010</year>;<volume>7</volume>(<issue>2</issue>):<fpage>179</fpage>–<lpage>190</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s11306-010-0242-7" xlink:type="simple">10.1007/s11306-010-0242-7</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005839.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Davis</surname> <given-names>RA</given-names></name>, <name name-style="western"><surname>Charlton</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>John</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Jones</surname> <given-names>SA</given-names></name>, <name name-style="western"><surname>Mark</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Wilson</surname> <given-names>JC</given-names></name>. <article-title>Adaptive binning: An improved binning method for metabolomics data using the undecimated wavelet transform</article-title>. <source>Chemometrics Intellig Lab Syst</source>. <year>2007</year>;<volume>85</volume>(<issue>1</issue>):<fpage>144</fpage>–<lpage>154</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.chemolab.2006.08.014" xlink:type="simple">10.1016/j.chemolab.2006.08.014</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005839.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sousa</surname> <given-names>SAA</given-names></name>, <name name-style="western"><surname>Alviclér</surname> <given-names>Ma</given-names></name>, <name name-style="western"><surname>Ferreira</surname> <given-names>MMC</given-names></name>. <article-title>Optimized bucketing for NMR spectra: Three case studies</article-title>. <source>Chemometrics Intellig Lab Syst</source>. <year>2013</year>;<volume>122</volume>:<fpage>93</fpage>–<lpage>102</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.chemolab.2013.01.006" xlink:type="simple">10.1016/j.chemolab.2013.01.006</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005839.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wishart</surname> <given-names>DS</given-names></name>, <name name-style="western"><surname>Jewison</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Guo</surname> <given-names>AC</given-names></name>, <name name-style="western"><surname>Wilson</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Knox</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Liu</surname> <given-names>Y</given-names></name>, <etal>et al</etal>. <article-title>HMDB 3.0–The Human Metabolome Database in 2013</article-title>. <source>Nucleic Acids Res</source>. <year>2013</year>;<volume>41</volume>(<issue>Database issue</issue>):<fpage>D801</fpage>–<lpage>7</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gks1065" xlink:type="simple">10.1093/nar/gks1065</ext-link></comment> <object-id pub-id-type="pmid">23161693</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005839.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bharti</surname> <given-names>SK</given-names></name>, <name name-style="western"><surname>Roy</surname> <given-names>R</given-names></name>. <article-title>Quantitative <sup>1</sup>H NMR spectroscopy</article-title>. <source>Trends Analyt Chem</source>. <year>2012</year>;<volume>35</volume>:<fpage>5</fpage>–<lpage>26</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.trac.2012.02.007" xlink:type="simple">10.1016/j.trac.2012.02.007</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005839.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ulrich</surname> <given-names>EL</given-names></name>, <name name-style="western"><surname>Akutsu</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Doreleijers</surname> <given-names>JF</given-names></name>, <name name-style="western"><surname>Harano</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Ioannidis</surname> <given-names>YE</given-names></name>, <name name-style="western"><surname>Lin</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>BioMagResBank</article-title>. <source>Nucleic Acids Res</source>. <year>2008</year>;<volume>36</volume>(<issue>Database issue</issue>):<fpage>D402</fpage>–<lpage>8</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gkm957" xlink:type="simple">10.1093/nar/gkm957</ext-link></comment> <object-id pub-id-type="pmid">17984079</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005839.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bouatra</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Aziat</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Mandal</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Guo</surname> <given-names>AC</given-names></name>, <name name-style="western"><surname>Wilson</surname> <given-names>MR</given-names></name>, <name name-style="western"><surname>Knox</surname> <given-names>C</given-names></name>, <etal>et al</etal>. <article-title>The human urine metabolome</article-title>. <source>PLoS One</source>. <year>2013</year>;<volume>8</volume>(<issue>9</issue>):<fpage>e73076</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0073076" xlink:type="simple">10.1371/journal.pone.0073076</ext-link></comment> <object-id pub-id-type="pmid">24023812</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005839.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Schäfer</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Strimmer</surname> <given-names>K</given-names></name>. <article-title>A shrinkage approach to large-scale covariance matrix estimation and implications for functional genomics</article-title>. <source>Stat Appl Genet Mol Biol</source>. <year>2005</year>;<volume>4</volume>:Article32. <object-id pub-id-type="pmid">16646851</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005839.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Firmann</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Mayor</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Vidal</surname> <given-names>PM</given-names></name>, <name name-style="western"><surname>Bochud</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Pécoud</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Hayoz</surname> <given-names>D</given-names></name>, <etal>et al</etal>. <article-title>The CoLaus study: a population-based study to investigate the epidemiology and genetic determinants of cardiovascular risk factors and metabolic syndrome</article-title>. <source>BMC Cardiovasc Disord</source>. <year>2008</year>;<volume>8</volume>:<fpage>6</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/1471-2261-8-6" xlink:type="simple">10.1186/1471-2261-8-6</ext-link></comment> <object-id pub-id-type="pmid">18366642</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005839.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Völzke</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Alte</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Schmidt</surname> <given-names>CO</given-names></name>, <name name-style="western"><surname>Radke</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Lorbeer</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Friedrich</surname> <given-names>N</given-names></name>, <etal>et al</etal>. <article-title>Cohort profile: the study of health in Pomerania</article-title>. <source>Int J Epidemiol</source>. <year>2011</year>;<volume>40</volume>(<issue>2</issue>):<fpage>294</fpage>–<lpage>307</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/ije/dyp394" xlink:type="simple">10.1093/ije/dyp394</ext-link></comment> <object-id pub-id-type="pmid">20167617</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005839.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Alonso</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Rodríguez</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Maria</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Raül</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Xavier</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Antonio</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>FOCUS: A Robust Workflow for One-Dimensional NMR Spectral Analysis</article-title>. <source>Anal Chem</source>. <year>2014</year>;<volume>86</volume>(<issue>2</issue>):<fpage>1160</fpage>–<lpage>1169</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1021/ac403110u" xlink:type="simple">10.1021/ac403110u</ext-link></comment> <object-id pub-id-type="pmid">24354303</object-id></mixed-citation>
</ref>
</ref-list>
</back>
</article>