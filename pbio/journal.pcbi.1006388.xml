<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article article-type="research-article" dtd-version="1.1d3" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-18-00284</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1006388</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Chemistry</subject><subj-group><subject>Chemical compounds</subject><subj-group><subject>Organic compounds</subject><subj-group><subject>Amino acids</subject><subj-group><subject>Amino acid substitution</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Chemistry</subject><subj-group><subject>Organic chemistry</subject><subj-group><subject>Organic compounds</subject><subj-group><subject>Amino acids</subject><subj-group><subject>Amino acid substitution</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Proteins</subject><subj-group><subject>Amino acids</subject><subj-group><subject>Amino acid substitution</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Molecular biology</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Sequencing techniques</subject><subj-group><subject>Protein sequencing</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Sequencing techniques</subject><subj-group><subject>Protein sequencing</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Immune cells</subject><subj-group><subject>Antibody-producing cells</subject><subj-group><subject>B cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Immunology</subject><subj-group><subject>Immune cells</subject><subj-group><subject>Antibody-producing cells</subject><subj-group><subject>B cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Immunology</subject><subj-group><subject>Immune cells</subject><subj-group><subject>Antibody-producing cells</subject><subj-group><subject>B cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Blood cells</subject><subj-group><subject>White blood cells</subject><subj-group><subject>B cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Immune cells</subject><subj-group><subject>White blood cells</subject><subj-group><subject>B cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Immunology</subject><subj-group><subject>Immune cells</subject><subj-group><subject>White blood cells</subject><subj-group><subject>B cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Immunology</subject><subj-group><subject>Immune cells</subject><subj-group><subject>White blood cells</subject><subj-group><subject>B cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Mutation</subject><subj-group><subject>Substitution mutation</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Mathematical and statistical techniques</subject><subj-group><subject>Statistical methods</subject><subj-group><subject>Forecasting</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Statistics</subject><subj-group><subject>Statistical methods</subject><subj-group><subject>Forecasting</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Immune physiology</subject><subj-group><subject>Antibodies</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Immune physiology</subject><subj-group><subject>Antibodies</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Immunology</subject><subj-group><subject>Immune system proteins</subject><subj-group><subject>Antibodies</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Immunology</subject><subj-group><subject>Immune system proteins</subject><subj-group><subject>Antibodies</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Proteins</subject><subj-group><subject>Immune system proteins</subject><subj-group><subject>Antibodies</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Database and informatics methods</subject><subj-group><subject>Bioinformatics</subject><subj-group><subject>Sequence analysis</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Information technology</subject><subj-group><subject>Data processing</subject></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Predicting B cell receptor substitution profiles using public repertoire data</article-title>
<alt-title alt-title-type="running-head">Predicting B cell receptor substitution profiles</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" equal-contrib="yes" xlink:type="simple">
<name name-style="western">
<surname>Dhar</surname> <given-names>Amrit</given-names></name>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" equal-contrib="yes" xlink:type="simple">
<name name-style="western">
<surname>Davidsen</surname> <given-names>Kristian</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-0607-6025</contrib-id>
<name name-style="western">
<surname>Matsen</surname> <given-names>Frederick A.</given-names> <suffix>IV</suffix></name>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-1917-9288</contrib-id>
<name name-style="western">
<surname>Minin</surname> <given-names>Vladimir N.</given-names></name>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Department of Statistics, University of Washington, Seattle, Washington, United States of America</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Computational Biology, Fred Hutchinson Cancer Research Center, Seattle, Washington, United States of America</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>Department of Statistics, University of California, Irvine, California, United States of America</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Walczak</surname> <given-names>Aleksandra M.</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>CNRS and Ecole Normale Superieure, FRANCE</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">matsen@fredhutch.org</email> (FAM); <email xlink:type="simple">vminin@uci.edu</email> (VNM)</corresp>
</author-notes>
<pub-date pub-type="collection">
<month>10</month>
<year>2018</year>
</pub-date>
<pub-date pub-type="epub">
<day>17</day>
<month>10</month>
<year>2018</year>
</pub-date>
<volume>14</volume>
<issue>10</issue>
<elocation-id>e1006388</elocation-id>
<history>
<date date-type="received">
<day>20</day>
<month>2</month>
<year>2018</year>
</date>
<date date-type="accepted">
<day>22</day>
<month>7</month>
<year>2018</year>
</date>
</history>
<permissions>
<copyright-year>2018</copyright-year>
<copyright-holder>Dhar et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1006388"/>
<abstract>
<p>B cells develop high affinity receptors during the course of affinity maturation, a cyclic process of mutation and selection. At the end of affinity maturation, a number of cells sharing the same ancestor (i.e. in the same “clonal family”) are released from the germinal center; their amino acid frequency profile reflects the allowed and disallowed substitutions at each position. These clonal-family-specific frequency profiles, called “substitution profiles”, are useful for studying the course of affinity maturation as well as for antibody engineering purposes. However, most often only a single sequence is recovered from each clonal family in a sequencing experiment, making it impossible to construct a clonal-family-specific substitution profile. Given the public release of many high-quality large B cell receptor datasets, one may ask whether it is possible to use such data in a prediction model for clonal-family-specific substitution profiles. In this paper, we present the method “Substitution Profiles Using Related Families” (SPURF), a penalized tensor regression framework that integrates information from a rich assemblage of datasets to predict the clonal-family-specific substitution profile for any single input sequence. Using this framework, we show that substitution profiles from similar clonal families can be leveraged together with simulated substitution profiles and germline gene sequence information to improve prediction. We fit this model on a large public dataset and validate the robustness of our approach on two external datasets. Furthermore, we provide a command-line tool in an open-source software package (<ext-link ext-link-type="uri" xlink:href="https://github.com/krdav/SPURF" xlink:type="simple">https://github.com/krdav/SPURF</ext-link>) implementing these ideas and providing easy prediction using our pre-fit models.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>Antibody engineering can be greatly informed by knowledge about the underlying affinity maturation process. As such this can be probed by sequencing, but unfortunately, in practice often only one member of the clonal family is sequenced, making it difficult to determine a set of possible amino acid mutations that would retain the original antibody antigen binding affinity. We overcome this data sparsity by developing a statistical learning approach that leverages vast information about amino acid preferences available in public immune system repertoire data. We use a penalized regression approach to devise a flexible statistical model that integrates multiple sources of information into a coherent prediction framework and validate our prediction algorithm using subsampling and held out data.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000002</institution-id>
<institution>National Institutes of Health</institution>
</institution-wrap>
</funding-source>
<award-id>GM113246</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-0607-6025</contrib-id>
<name name-style="western">
<surname>Matsen</surname> <given-names>Frederick A. A.</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000002</institution-id>
<institution>National Institutes of Health</institution>
</institution-wrap>
</funding-source>
<award-id>AI12096</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-0607-6025</contrib-id>
<name name-style="western">
<surname>Matsen</surname> <given-names>Frederick A. A.</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award003">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000002</institution-id>
<institution>National Institutes of Health</institution>
</institution-wrap>
</funding-source>
<award-id>AI117891</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-0607-6025</contrib-id>
<name name-style="western">
<surname>Matsen</surname> <given-names>Frederick A. A.</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award004">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000001</institution-id>
<institution>National Science Foundation</institution>
</institution-wrap>
</funding-source>
<award-id>DGE-1258485</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Dhar</surname> <given-names>Amrit</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award005">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000011</institution-id>
<institution>Howard Hughes Medical Institute</institution>
</institution-wrap>
</funding-source>
<award-id>Faculty Scholar grant</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-0607-6025</contrib-id>
<name name-style="western">
<surname>Matsen</surname> <given-names>Frederick A. A.</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award006">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000893</institution-id>
<institution>Simons Foundation</institution>
</institution-wrap>
</funding-source>
<award-id>Faculty Scholar grant</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-0607-6025</contrib-id>
<name name-style="western">
<surname>Matsen</surname> <given-names>Frederick A. A.</given-names>
</name>
</principal-award-recipient>
</award-group>
<funding-statement>FAM was supported by the National Institutes of Health (<ext-link ext-link-type="uri" xlink:href="https://www.nih.gov" xlink:type="simple">https://www.nih.gov</ext-link>) grants R01 GM113246, R01 AI12096, and U19 AI117891. FAM was supported in part by a Faculty Scholar grant from the Howard Hughes Medical Institute (<ext-link ext-link-type="uri" xlink:href="http://www.hhmi.org" xlink:type="simple">http://www.hhmi.org</ext-link>) and the Simons Foundation (<ext-link ext-link-type="uri" xlink:href="https://www.simonsfoundation.org" xlink:type="simple">https://www.simonsfoundation.org</ext-link>). AD was supported by the National Science Foundation (<ext-link ext-link-type="uri" xlink:href="https://www.nih.gov" xlink:type="simple">https://www.nih.gov</ext-link>) IGERT DGE-1258485. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="5"/>
<table-count count="4"/>
<page-count count="24"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2018-10-29</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All data available at <ext-link ext-link-type="uri" xlink:href="https://github.com/krdav/SPURF" xlink:type="simple">https://github.com/krdav/SPURF</ext-link>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>In the therapeutic antibody discovery and engineering field, researchers commonly isolate antibodies from animal or human immunizations and screen for functional properties such as binding to a target protein. Following the initial screening process, a small number of well-behaving antibodies (hits) are isolated for more rigorous examination of their biophysical properties in order to determine their potential as a therapeutic. After this stage, only a few final antibodies remain as lead candidates. However, even these carefully selected antibodies often have immunogenic peptides or other undesirable properties such as poor thermo/chemical stability and aggregation tendencies. To address these problems, the art of antibody engineering has emerged [<xref ref-type="bibr" rid="pcbi.1006388.ref001">1</xref>], with numerous rational design strategies developed to mitigate aggregation. Researchers have removed hydrophobic surface patches to avoid aggregation [<xref ref-type="bibr" rid="pcbi.1006388.ref002">2</xref>–<xref ref-type="bibr" rid="pcbi.1006388.ref005">5</xref>], “deimmunized” complementarity-determining regions by screening immunogenic peptides and mutating positions detrimental for peptide MHCII binding [<xref ref-type="bibr" rid="pcbi.1006388.ref006">6</xref>], and improved thermostability through stable framework grafting [<xref ref-type="bibr" rid="pcbi.1006388.ref007">7</xref>] and targeted mutagenesis using predictions from proprietary structure/sequence analysis software [<xref ref-type="bibr" rid="pcbi.1006388.ref008">8</xref>]. Although referred to as “rational”, the choice of which amino acid to use for a site-directed mutation is often made using 1) the germline as a reference, 2) biochemical similarity between amino acids, or 3) the highest probability amino acid from a generic substitution matrix (e.g. BLOSUM) [<xref ref-type="bibr" rid="pcbi.1006388.ref009">9</xref>]. However, neither of these three methods are explicitly designed to conserve antibody functionality (i.e. binding to the same epitope with the same kinetics), so mutations are likely to have negative side effects on affinity. These considerations motivate a prediction problem: given a B cell receptor (BCR) sequence, which positions can be modified, and to which amino acids, without drastically changing the binding properties of the resulting BCR?</p>
<p>An immunization-derived antibody has already implicitly explored the mutational space through the population of B cells sharing the same naive ancestor, referred to as its clonal family (CF). The members of a CF arise during affinity maturation in a germinal center and carry fitness information about the effect of amino acid substitutions. A profile of the observed substitutions aggregated over all the B cells in a CF reveals which sites are more conserved, which sites can be more freely edited, and which amino acids can be used for replacements. However, we generally do not sequence all the B cells that are released from a germinal center so the information to make such a substitution profile is lost. Thus, we can formulate a more specific version of our prediction problem: given bulk BCR data and a single input sequence, can we infer the most likely per-site substitutions that are allowed in its true germinal center clonal family?</p>
<p>We begin by reviewing the natural mutation and selection process of germinal center affinity maturation. The Darwinian selection undertaken inside a germinal center is driven by B cells’ ability to bind the antigen through the membrane-embedded BCR. The highly-mutated population of B cells in a germinal center is under stringent selection, driving the cell population towards higher and higher affinity until the germinal center is dissolved. Each germinal center is seeded by around one hundred naive B cells, but eventually internal competition makes one or a few of these lineages take over the whole germinal center [<xref ref-type="bibr" rid="pcbi.1006388.ref010">10</xref>]. Although B cells in the germinal center reaction experience an extraordinarily high mutation rate (10<sup>6</sup> fold higher than the regular somatic mutation rate [<xref ref-type="bibr" rid="pcbi.1006388.ref011">11</xref>]), they rarely harbor more than 15% mutations at the DNA level [<xref ref-type="bibr" rid="pcbi.1006388.ref012">12</xref>]. However, since they must maintain some degree of antigen specificity to survive during the course of the germinal center reaction, lineages evolve in small incremental steps [<xref ref-type="bibr" rid="pcbi.1006388.ref013">13</xref>, <xref ref-type="bibr" rid="pcbi.1006388.ref014">14</xref>] and therefore, even lineages that drift far away from their naive B cell ancestor most likely maintain the same epitope specificity throughout the germinal center reaction [<xref ref-type="bibr" rid="pcbi.1006388.ref015">15</xref>].</p>
<p>We can describe the combination of germinal center mutation and selection dynamics by computing per-site amino acid frequency vectors from observed BCR sequence data. We follow previous authors in calling site-specific amino acid probability vectors “substitution profiles”, where each vector in a profile stores the probabilities of observing the 20 different amino acids at a given site [<xref ref-type="bibr" rid="pcbi.1006388.ref016">16</xref>]. We use the concept of a clonal family, defined by a shared heavy chain inferred naive DNA sequence, to segment BCR sequences into evolutionarily-related groups [<xref ref-type="bibr" rid="pcbi.1006388.ref017">17</xref>]; some practitioners refer to these groups as lineages. CF inference is highly informed by nucleotide sequences and therefore performed using DNA sequences. This makes DNA-level information necessary even though germinal center selection operates at the protein level and synonymous codons do not possess any fitness advantages (modulo transcription rate differences and codon bias, which we follow many others in ignoring here). The per-site amino acid frequency vectors described above form the substitution profile estimates; the substitution profile estimates converge to the true substitution profiles as the number of sequences sampled from the same CF tends to infinity.</p>
<p>Most CFs do not contain enough sequences in order to get a detailed substitution profile estimate. Indeed, most CFs in repertoire sequencing (Rep-Seq) samples have few members and a large fraction are singletons due to the exponential nature of the CF size distribution [<xref ref-type="bibr" rid="pcbi.1006388.ref017">17</xref>]. Additionally, many antibody screening methods are not geared towards whole repertoire sequencing. One may wish, then, to enhance the substitution profile estimates for data-sparse CFs with substitution profile information from similar CFs.</p>
<p>In this paper, we present “Substitution Profiles Using Related Families” (SPURF), a penalized tensor regression framework that integrates multiple sources of information to predict the CF-specific amino acid frequency profile for a single input BCR sequence (<xref ref-type="fig" rid="pcbi.1006388.g001">Fig 1</xref>). Some of these information sources include substitution profiles for CFs in large, publicly available BCR sequence datasets and germline gene sequence information. We combine the local context-specific profile information with global profile information derived from other related germinal centers by regularizing the noisy local substitution profile estimate and pooling it closer towards more robust global profile estimates. Even though each germinal center focuses on binding to a unique epitope context, there are structural and possibly functional properties associated with BCR sequences that are common across germinal centers that we can leverage.</p>
<fig id="pcbi.1006388.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006388.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Amino acid substitution profiles viewed from three different perspectives.</title>
<p>High-throughput sequencing data (<underline>HTS data</underline>) yields large amounts of VDJ sequences, but because of uneven sampling many CFs will be sampled just once, resulting in poor representations of the amino acid substitution profiles of those true CFs. “Substitution Profiles Using Related Families” (<underline>SPURF</underline>) is a statistical framework that integrates large scale Rep-Seq data to predict amino acid substitution profiles for singleton CFs. <underline><italic>In vivo</italic></underline> affinity maturation will test many different mutations and the resulting CFs reflect the amino acid substitution profiles that we attempt to predict.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006388.g001" xlink:type="simple"/>
</fig>
<p>In addition, our inference machinery uses both standard and spatial lasso penalties as model regularizers and, as a result, furnishes sparse, interpretable parameter estimates. While our output type shares some similarities to that described by [<xref ref-type="bibr" rid="pcbi.1006388.ref016">16</xref>], the proposed objective, approach, and details differ (e.g. they predict substitution profiles for gene families, we predict substitution profiles for CFs). We enable substitution profile prediction for single input BCR sequences based on profiles derived from a high-quality repertoire dataset that contains B cell samples from many human donors. To demonstrate the usefulness of our technique, we validate SPURF on two external datasets—one containing CFs extracted from a single human donor and the other focusing on a single CF of a HIV broadly neutralizing antibody. Lastly, we implement SPURF in an open-source software package (<ext-link ext-link-type="uri" xlink:href="https://github.com/krdav/SPURF" xlink:type="simple">https://github.com/krdav/SPURF</ext-link>), which outputs a predicted CF-specific substitution profile and an associated logo plot based on a single input BCR sequence.</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Methods</title>
<sec id="sec003">
<title>Overview</title>
<p>The aim of our model is to take a single sequence and predict the site-wise amino acid frequencies as would be found in the full CF from which this single sequence derived. We will refer to this as the sequence’s CF-specific substitution profile. For this prediction problem, we have no direct information about this desired substitution profile other than the information contained in the input sequence itself, but we may use other information (e.g. from the inferred germline gene, simulated substitutions, or information derived from published BCR sequence datasets). For large CFs, a CF-specific substitution profile can be constructed simply by counting and making a per-site frequency matrix, with the rows of the matrix representing each of the 20 amino acids, and the columns being the sequence positions.</p>
<p>For training, we extract a collection of such large CFs and use them to build “ground truth” CF-specific substitution profiles as a training set for fitting the model. A randomly sampled single sequence is then taken out from each of these large CFs to predict the substitution profile, which is compared to the ground truth. We refer to these single sequences, sampled from large CFs, as subsamples.</p>
<p>To make the best possible prediction, we need a flexible model framework that can accommodate different sources of information seamlessly (<xref ref-type="fig" rid="pcbi.1006388.g002">Fig 2</xref>). For example, previous work by [<xref ref-type="bibr" rid="pcbi.1006388.ref018">18</xref>] and [<xref ref-type="bibr" rid="pcbi.1006388.ref019">19</xref>] suggests that the various V genes have different characteristic paths of diversification. We can obtain a data-driven summary of that intuition by building profiles from large Rep-Seq data sets stratified by V gene. We may also think that the neutral substitution process is an important factor in determining substitution profiles [<xref ref-type="bibr" rid="pcbi.1006388.ref018">18</xref>]. We can quantify that sort of information by repeatedly simulating the neutral substitution process using a context-sensitive model [<xref ref-type="bibr" rid="pcbi.1006388.ref020">20</xref>]. We call each external data set (e.g., V gene alignments and sequences simulated from the neutral substitution process) that can be used to predict the CF substitution profile of interest a source of profile information.</p>
<fig id="pcbi.1006388.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006388.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Model overview figure.</title>
<p>SPURF uses a per-site linear combination of substitution profiles from diverse sources to predict complete substitution profiles from a single member of a CF. At the top are the different profiles that serve as inputs to the model, some directly related to the naive sequence (<inline-formula id="pcbi.1006388.e001"><alternatives><graphic id="pcbi.1006388.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e001" xlink:type="simple"/><mml:math display="inline" id="M1"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>naiveAA</mml:mtext></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006388.e002"><alternatives><graphic id="pcbi.1006388.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>neut</mml:mtext></mml:msub></mml:math></alternatives></inline-formula>), and others partitions of the public Rep-Seq datasets (<inline-formula id="pcbi.1006388.e003"><alternatives><graphic id="pcbi.1006388.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>vgene</mml:mtext></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006388.e004"><alternatives><graphic id="pcbi.1006388.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>vsubgrp</mml:mtext></mml:msub></mml:math></alternatives></inline-formula>). To predict a substitution profile, a weighted average is taken over the input sequence <bold>X</bold> and external profiles <inline-formula id="pcbi.1006388.e005"><alternatives><graphic id="pcbi.1006388.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:mrow><mml:msup><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>=</mml:mo> <mml:mo>{</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>naiveAA</mml:mtext></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>vgene</mml:mtext></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>neut</mml:mtext></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>vsubgrp</mml:mtext></mml:msub> <mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> (see the dashed line bubble). The vertical blue arrow indicates that the weighted average (in the dashed line bubble) occurs at each of the 149 AHo positions. Once a predicted profile is generated, this is compared to ground truth using either <italic>L</italic><sub>2</sub> error or Jaccard similarity as a performance metric. The <bold><italic>α</italic></bold> vectors are estimated by optimizing the objective function, which also includes a statistical regularization term to prevent overfitting.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006388.g002" xlink:type="simple"/>
</fig>
<p>To make predictions using these types of information, we need a way of describing the various sites, and a way of integrating the information across the sites. We use the AHo numbering scheme [<xref ref-type="bibr" rid="pcbi.1006388.ref021">21</xref>] to provide a single coordinate system to all sequences via its fixed-length numbering vector going from 1 to 149. Given this coordinate system, we use a site-wise weighted average of the input predictive profiles using a <italic>α</italic> weight vector for each source of profile information.</p>
<p>To train this model, we fit the <bold><italic>α</italic></bold> vectors by minimizing some objective function that quantifies the difference between the predicted profiles (where the prediction uses the subsampled sequence and the external profile information) and the “ground truth” substitution profiles from the large CFs. Any objective function could be used, but here we provide implementations of two such functions, a “fine-grained” <italic>L</italic><sub>2</sub>-error-based objective and a “coarse-grained” Jaccard-similarity-based objective [<xref ref-type="bibr" rid="pcbi.1006388.ref022">22</xref>].</p>
<p>We use two forms of regularization to avoid overfitting the many parameters of this model. This includes a standard lasso penalty to shrink weights to zero that do not contribute significantly to prediction performance [<xref ref-type="bibr" rid="pcbi.1006388.ref023">23</xref>]. We also use a fused lasso penalty [<xref ref-type="bibr" rid="pcbi.1006388.ref024">24</xref>, <xref ref-type="bibr" rid="pcbi.1006388.ref025">25</xref>] to smooth differences between parameters at nearby sites in the sequence. These regularization terms have tuning parameters that regulate the strength of the penalties and are estimated using cross-validation.</p>
<p>Given this setup, a forward stepwise selection procedure is run with cross-validation to pick the set of external profiles to use in the final model. As a last check, this model is tested on two external datasets to give a fair estimate of the prediction performance.</p>
</sec>
<sec id="sec004">
<title>Data</title>
<p>We divide input data into two parts, with each part for a respective purpose: 1) model fitting and model testing and 2) providing “public” substitution profiles over clustered data to be used by our model. Throughout this work, we are careful to not use the same data for both purposes as this would bias our estimates; as a final validation, we test SPURF on two external datasets which are only used in this validation. Because we do not model sequence error, we only include high-quality data that we have high confidence in. We collect post-processed data files from 6 published works on Rep-Seq, which we refer to as repertoire data 1 to 6 (RD1-6):</p>
<list list-type="order">
<list-item>
<p>RD1 from [<xref ref-type="bibr" rid="pcbi.1006388.ref026">26</xref>], which is an Illumina MiSeq re-sequencing of the samples in [<xref ref-type="bibr" rid="pcbi.1006388.ref027">27</xref>], where they sequence multiple time-points before and after influenza vaccination of 3 donors using the 454 pyrosequencing platform.</p>
</list-item>
<list-item>
<p>RD2 from [<xref ref-type="bibr" rid="pcbi.1006388.ref028">28</xref>], from a study of the auto-immune disease Myasthenia Gravis (MG), in which 9 MG patients and 4 healthy donors participate.</p>
</list-item>
<list-item>
<p>RD3 from [<xref ref-type="bibr" rid="pcbi.1006388.ref029">29</xref>], containing data from different tissues in a study of B cell response in 4 multiple sclerosis patients.</p>
</list-item>
<list-item>
<p>RD4 from [<xref ref-type="bibr" rid="pcbi.1006388.ref030">30</xref>], from a study of neutralizing antibodies against the West Nile virus by sequencing naive and memory cells from 7 virus infected donors.</p>
</list-item>
<list-item>
<p>RD5 from [<xref ref-type="bibr" rid="pcbi.1006388.ref031">31</xref>], from a study of Rep-Seq error correction by sequencing naive, plasma, and memory cells from a single healthy donor.</p>
</list-item>
<list-item>
<p>RD6 from [<xref ref-type="bibr" rid="pcbi.1006388.ref032">32</xref>], from the “B cell tissue atlas” acquired from the ImmuneDB web portal.</p>
</list-item>
</list>
<p specific-use="continuation">All datasets are acquired in their post-processed form with read processing performed as described in their respective publications.</p>
<p>The first five datasets (RD1-5) are prepared from unique molecular identifier (UMI) barcoded cDNA spanning the whole VDJ region and sequenced on the Illumina MiSeq platform using overlapping paired-end reads. Using the UMI, these reads are processed to address both PCR and sequencing errors giving high confidence reads [<xref ref-type="bibr" rid="pcbi.1006388.ref033">33</xref>]. Briefly, UMIs are used for error correction in conjunction with either of the pRESTO [<xref ref-type="bibr" rid="pcbi.1006388.ref034">34</xref>] or MIGEC [<xref ref-type="bibr" rid="pcbi.1006388.ref033">33</xref>] processing pipelines and an appropriate Phred quality score cutoff. Paired-end reads are assembled using pRESTO and only the set of high confidence assembled reads constitute the final dataset used in this work. RD6 is the only dataset not prepared with UMIs; however, it is sequenced directly from genomic DNA (gDNA) instead of the more common practice of sequencing mRNA. Sequencing gDNA has the benefit of avoiding mutations introduced by the transcription machinery as well as mutations introduced in the RT-PCR step. On the other hand, DNA sequencing is not able to discriminate between expressed versus unexpressed BCRs (e.g. in the case of faulty VDJ recombination) and therefore we apply aggressive filtering of non-functional BCR sequences. We prefer quality over quantity and therefore avoid datasets from the 454 technology because of their higher indel frequencies compared to those from Illumina technologies [<xref ref-type="bibr" rid="pcbi.1006388.ref035">35</xref>].</p>
<p>Individual sequence files are merged based on donor identity so that the number of sample files matches the number of donors; this process yields 33 donor files. The donor files are then annotated and partitioned into CFs using the <monospace>partis</monospace> software [<xref ref-type="bibr" rid="pcbi.1006388.ref017">17</xref>, <xref ref-type="bibr" rid="pcbi.1006388.ref036">36</xref>]. Each donor file is run separately from the other files so CFs are defined by their unique <monospace>partis</monospace>-inferred naive sequence and donor identity. To ensure we obtain the highest quality and most biologically relevant sequences, <monospace>partis</monospace> is run in its most restrictive mode, discarding all reads with VDJ recombinations that are deemed as unproductive because of out-of-frame N/P junction nucleotides, missing invariant codons, or stop codons inside the VDJ region; furthermore, the most accurate <monospace>partis</monospace> partitioning mode (“full”) is used to get the best CF estimates. Lastly, productive VDJ-recombined sequences are removed if they contain indels to assure concordance between the length of the naive sequence and the length of the read sequences in its CF.</p>
<p>At this stage, some sequences contain ambiguous bases (e.g., because of primer masking); these are allowed to pass only if the ambiguous bases are inside the first or last 30 nucleotides of the VDJ region (equivalent to the length of the potentially masked PCR primers), otherwise they are discarded. This is a way of substituting the error-prone ends with neutral bases that minimize variance and maintain a conservative estimate of the substitutions; we also note that this has no apparent effect on the subsequently-described estimates (Figs <xref ref-type="fig" rid="pcbi.1006388.g003">3</xref> and <xref ref-type="fig" rid="pcbi.1006388.g004">4</xref>). For all sequences that pass this requirement, ambiguous bases are substituted with bases from the naive sequence in batches of 3 nucleotides (i.e. one codon) at a time until all ambiguous bases are resolved. Sequences are then translated into their respective amino acid sequences and de-duplication of repeated amino acid sequences is done within each CF. Because our statistical methodology operates on these amino acid sequences, we use the word “sequence” in subsequent sections to refer to these amino acid sequences. All CFs with fewer than 5 unique sequences are discarded. From these remaining CFs, their inferred naive sequences are used for antibody sequence numbering with the ANARCI software [<xref ref-type="bibr" rid="pcbi.1006388.ref037">37</xref>] under the AHo numbering scheme [<xref ref-type="bibr" rid="pcbi.1006388.ref021">21</xref>]. As a result of our restriction to non-indel sequences, all sequences within a given CF have equal length; thus, the AHo numbering from the naive sequence can be positionally transferred to all its CF-related read sequences. Finally, for each CF, the amino acid usage is extracted as a vector of counts at each AHo position. This overall dataset, which we call the “aggregated” dataset, contains 518,174 sequences distributed over 31,893 CFs and is built as a matrix of counts with rows denoting CFs and columns representing AHo positions and amino acid identities. All data used to build this aggregated dataset is public and freely available. We provide the data partitioned into CFs and numbered into AHo numbering for download on Zenodo (<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.1289984" xlink:type="simple">https://doi.org/10.5281/zenodo.1289984</ext-link>).</p>
<fig id="pcbi.1006388.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006388.g003</object-id>
<label>Fig 3</label>
<caption>
<title>A stacked barplot of the estimated parameter values of <italic>α</italic> from the best regularized <italic>L</italic><sub>2</sub> model.</title>
<p>For convenience, we aggregate the estimates of <italic>α</italic> associated with <inline-formula id="pcbi.1006388.e006"><alternatives><graphic id="pcbi.1006388.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>vgene</mml:mtext></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006388.e007"><alternatives><graphic id="pcbi.1006388.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>vsubgrp</mml:mtext></mml:msub></mml:math></alternatives></inline-formula> (blue) and with <inline-formula id="pcbi.1006388.e008"><alternatives><graphic id="pcbi.1006388.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e008" xlink:type="simple"/><mml:math display="inline" id="M8"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>naiveAA</mml:mtext></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006388.e009"><alternatives><graphic id="pcbi.1006388.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>neut</mml:mtext></mml:msub></mml:math></alternatives></inline-formula> (red). The black vertical lines represent the boundaries between the different CDRs and FWKs.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006388.g003" xlink:type="simple"/>
</fig>
<fig id="pcbi.1006388.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006388.g004</object-id>
<label>Fig 4</label>
<caption>
<title>The model performance results across the different antibody regions on the model fitting test dataset and the Briggs validation dataset.</title>
<p>In these plots, we compare the performances from our best models to the baseline predictive performances using only the input sequence (i.e. model predictions with all parameter values of <bold><italic>α</italic></bold> set to 0). The error bars show bootstrap standard errors.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006388.g004" xlink:type="simple"/>
</fig>
<sec id="sec005">
<title>Model fitting dataset</title>
<p>To fit our CF-specific substitution profile prediction model, it is desirable to use the CFs from the aggregated dataset with the most sequence members so we can train using the observed substitution profiles with the least amount of noise; on the other hand, it is also desirable to extract CFs from as many donors as possible to avoid overfitting towards a few similar donors. To achieve both goals, we pick 500 CFs as a “model fitting” dataset as follows. We first exclude any CFs with less than 100 sequences from being eligible to be picked. We then cycle through donors, each time picking the largest remaining eligible CF. If a donor does not have any remaining eligible CFs, it is skipped. The process ends when 500 CFs are found; all unpicked CFs are used as the “public” dataset.</p>
<p>In addition, we perform subsampling for each CF in the model fitting dataset; this is the information from which we would like to predict the full profile. First, a single sequence is randomly chosen from each CF, then <monospace>partis</monospace> is re-run using each of these subsampled sequences to re-do the VDJ annotation and naive sequence inference. For some inferred naive DNA sequences, a stop codon is incidentally present in the N/P nucleotides of the junction region; these are considered spurious and replaced by the identically positioned codon from the input sequence. We stress that the CF-specific annotation and naive sequence are inferred solely based on the subsampled sequence itself and are not determined using information from the other CF sequence members. Additionally, the parameters used within the <monospace>partis</monospace> clustering and annotation procedure are derived from an external dataset. Once we finish the <monospace>partis</monospace> inference process on the subsampled sequences, we construct the amino acid count matrix for these same sequences; we denote these substitution profiles as the “subsampled” profiles because they are subsampled from the “full” profiles in the model fitting dataset.</p>
</sec>
<sec id="sec006">
<title>Simulation of neutral substitution profiles</title>
<p>For each of the 500 subsampled substitution profiles, we also simulate a neutral substitution profile via a context-sensitive model. For each subsampled sequence, we calculate its number of somatic hypermutations (SHMs) and introduce that number of mutations sequentially into the inferred naive DNA sequence according to the BCR-specific neutral substitution model S5F [<xref ref-type="bibr" rid="pcbi.1006388.ref020">20</xref>]. Once the last mutation is introduced, the simulated DNA sequence is translated into an amino acid sequence and stored as a sample of the neutral substitution process. This procedure is repeated 10,000 times and the count profile aggregated over all the samples is referred to as the “neutral” profile.</p>
</sec>
<sec id="sec007">
<title>External validation datasets</title>
<p>For validation, two test sets are generated: the first called “Briggs”, is made from the healthy donor single cell droplet sequencing dataset described in [<xref ref-type="bibr" rid="pcbi.1006388.ref012">12</xref>]. Briefly, the data is made by passing 3 million B cells into 6 emulsion pools, each droplet with a unique barcode, and then reverse transcribing mRNA inside these droplets, attaching both a droplet and a molecular barcode. After breaking the emulsion, cDNA is sequenced and processed using UMI consensus building using pRESTO. The highest-quality UMI consensus sequence is extracted from each drop and aggregated into the final heavy chain dataset, which is then further partitioned into CFs using <monospace>partis</monospace>. Finally, this validation dataset is built up in the same manner as the model fitting dataset, where the only difference is that we allow smaller CFs to enter this dataset (minimum 28 sequences; <xref ref-type="table" rid="pcbi.1006388.t001">Table 1</xref>) in order to increase the number of extracted CFs to 100.</p>
<table-wrap id="pcbi.1006388.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006388.t001</object-id>
<label>Table 1</label>
<caption>
<title>Number of donors (<italic>N</italic><sub>donors</sub>), number of CFs (<italic>N</italic><sub>CF</sub>), number of sequences from all CFs (Total <italic>N</italic><sub>seq</sub>), smallest CF size (Min <italic>N</italic><sub>seq</sub>), median CF size (Median <italic>N</italic><sub>seq</sub>), and maximum CF size (Max <italic>N</italic><sub>seq</sub>).</title>
</caption>
<alternatives>
<graphic id="pcbi.1006388.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006388.t001" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left" rowspan="2">Dataset</th>
<th align="center" colspan="6">Dataset summary statistics</th>
</tr>
<tr>
<th align="center"><italic>N</italic><sub>donors</sub></th>
<th align="center"><italic>N</italic><sub>CF</sub></th>
<th align="center">Total <italic>N</italic><sub>seq</sub></th>
<th align="center">Min <italic>N</italic><sub>seq</sub></th>
<th align="center">Median <italic>N</italic><sub>seq</sub></th>
<th align="center">Max <italic>N</italic><sub>seq</sub></th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Aggregated</td>
<td align="center">33</td>
<td align="center">31,893</td>
<td align="center">518,174</td>
<td align="center">5</td>
<td align="center">9</td>
<td align="center">2,709</td>
</tr>
<tr>
<td align="left">Model fitting</td>
<td align="center">15</td>
<td align="center">500</td>
<td align="center">98,887</td>
<td align="center">100</td>
<td align="center">147</td>
<td align="center">2,709</td>
</tr>
<tr>
<td align="left">Public</td>
<td align="center">33</td>
<td align="center">31,393</td>
<td align="center">419,287</td>
<td align="center">5</td>
<td align="center">8</td>
<td align="center">104</td>
</tr>
<tr>
<td align="left">Briggs</td>
<td align="center">1</td>
<td align="center">100</td>
<td align="center">6,702</td>
<td align="center">28</td>
<td align="center">44</td>
<td align="center">370</td>
</tr>
<tr>
<td align="left">Liao</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">312</td>
<td align="center">312</td>
<td align="center">312</td>
<td align="center">312</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t001fn001">
<p>“Aggregated” is the base dataset aggregating RD1-6. “Model fitting” refers to the dataset with the 500 largest CFs from the “Aggregated” dataset. “Public” is the dataset left after the “Model fitting” dataset is extracted from the “Aggregated” dataset. “Briggs” and “Liao” are the external validation datasets used for testing.</p>
</fn>
</table-wrap-foot>
</table-wrap>
<p>As all the above described datasets are repertoire wide datasets with hundreds of clonal families, we sought to find a suitable dataset with focus on a single large CF. For this, we created the second test set curated from the “Liao” dataset which comes from a well studied broadly neutralizing HIV clone, CH103, described in [<xref ref-type="bibr" rid="pcbi.1006388.ref038">38</xref>]. To prepare the raw heavy chain sequences from [<xref ref-type="bibr" rid="pcbi.1006388.ref038">38</xref>], they were annotated and indel reversed by <monospace>partis</monospace>, following reconstruction of the whole VDJ region by substituting ambiguous bases with bases from the <monospace>partis</monospace>-inferred naive sequence if necessary. Finally, sequences unable to be annotated within the standard 149 position AHo numbering scheme were filtered out, leaving 312 sequences (available on the SPURF GitHub repository). For the Liao dataset, the prediction error is measured using all sequences as input samples, contrary to the repertoire datasets where only a single input sequence from each CF is used.</p>
<p>In summary, our datasets span 35 different donors, ∼32,000 clonal families and ∼500,000 sequences (<xref ref-type="table" rid="pcbi.1006388.t001">Table 1</xref>). We note that the distribution of VDJ gene usage is non-uniform but that the “Model fitting” and “Public” datasets have very similar V/J gene usage (<xref ref-type="supplementary-material" rid="pcbi.1006388.s009">S4</xref> and <xref ref-type="supplementary-material" rid="pcbi.1006388.s010">S5</xref> Figs). On the other hand, the “Briggs” dataset does have a distinctly different V/J gene usage distribution compared to the other datasets, which we attribute to the fact that it comes from a single donor.</p>
</sec>
</sec>
<sec id="sec008">
<title>Input data tensor</title>
<p>Before we present our penalized tensor regression model, we first describe how the input data for the model is constructed, building off the data descriptions in the last subsection. Throughout the rest of this section, we assume the count matrices are normalized to frequencies and reorganized into three-dimensional tensors (i.e. arrays) as follows. For any substitution profile tensor <bold>T</bold> = {<italic>T</italic><sub><italic>i</italic>,<italic>j</italic>,<italic>k</italic></sub>}, let <italic>T</italic><sub><italic>i</italic>,<italic>j</italic>,<italic>k</italic></sub> denote the frequency of the <italic>k</italic>th amino acid at the <italic>j</italic>th AHo position for the <italic>i</italic>th CF; we represent the subsampled, full, and public substitution profile tensors as <bold>X</bold>, <bold>Y</bold>, and <bold>Z</bold>, respectively. Our goal is to use the subsampled profiles <bold>X</bold> to predict the corresponding full substitution profiles <bold>Y</bold> (i.e. we want to construct a function <italic>F</italic>(<bold>X</bold>) such that <italic>F</italic>(<bold>X</bold>) ≈ <bold>Y</bold>). We incorporate information from the public dataset <bold>Z</bold> to enhance these predictions. In addition to the subsampled profiles, we use other types of substitution profiles within <italic>F</italic>(<bold>X</bold>):</p>
<list list-type="order">
<list-item>
<p>Public substitution profiles segmented by the inferred V-subgroup label (<inline-formula id="pcbi.1006388.e010"><alternatives><graphic id="pcbi.1006388.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>vsubgrp</mml:mtext></mml:msub></mml:math></alternatives></inline-formula>);</p>
</list-item>
<list-item>
<p>Public substitution profiles segmented by the inferred V-gene label (<inline-formula id="pcbi.1006388.e011"><alternatives><graphic id="pcbi.1006388.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e011" xlink:type="simple"/><mml:math display="inline" id="M11"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>vgene</mml:mtext></mml:msub></mml:math></alternatives></inline-formula>);</p>
</list-item>
<list-item>
<p>Inferred naive sequence “substitution profiles” (<inline-formula id="pcbi.1006388.e012"><alternatives><graphic id="pcbi.1006388.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e012" xlink:type="simple"/><mml:math display="inline" id="M12"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>naiveAA</mml:mtext></mml:msub></mml:math></alternatives></inline-formula>);</p>
</list-item>
<list-item>
<p>Public substitution profiles segmented by the inferred naive sequence (<inline-formula id="pcbi.1006388.e013"><alternatives><graphic id="pcbi.1006388.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e013" xlink:type="simple"/><mml:math display="inline" id="M13"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>naiveAA-clust</mml:mtext></mml:msub></mml:math></alternatives></inline-formula>);</p>
</list-item>
<list-item>
<p>Public substitution profiles segmented by the original frequency profiles (<inline-formula id="pcbi.1006388.e014"><alternatives><graphic id="pcbi.1006388.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e014" xlink:type="simple"/><mml:math display="inline" id="M14"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>clust</mml:mtext></mml:msub></mml:math></alternatives></inline-formula>);</p>
</list-item>
<list-item>
<p>Neutral substitution profiles (<inline-formula id="pcbi.1006388.e015"><alternatives><graphic id="pcbi.1006388.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e015" xlink:type="simple"/><mml:math display="inline" id="M15"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>neut</mml:mtext></mml:msub></mml:math></alternatives></inline-formula>).</p>
</list-item>
</list>
<p specific-use="continuation">To compute the external profiles in <inline-formula id="pcbi.1006388.e016"><alternatives><graphic id="pcbi.1006388.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e016" xlink:type="simple"/><mml:math display="inline" id="M16"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>vsubgrp</mml:mtext></mml:msub></mml:math></alternatives></inline-formula> (resp. <inline-formula id="pcbi.1006388.e017"><alternatives><graphic id="pcbi.1006388.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e017" xlink:type="simple"/><mml:math display="inline" id="M17"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>vgene</mml:mtext></mml:msub></mml:math></alternatives></inline-formula>), we cluster the public dataset <bold>Z</bold> by averaging its CF-specific substitution profiles according to the <monospace>partis</monospace>-inferred [<xref ref-type="bibr" rid="pcbi.1006388.ref036">36</xref>] IMGT defined [<xref ref-type="bibr" rid="pcbi.1006388.ref039">39</xref>] V-subgroup (resp. V-gene) labels and then assign each row in <bold>X</bold> to a V-subgroup (resp. V-gene) cluster profile according to its V-subgroup (resp. V-gene) identity. We obtain the second set of profiles <inline-formula id="pcbi.1006388.e018"><alternatives><graphic id="pcbi.1006388.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e018" xlink:type="simple"/><mml:math display="inline" id="M18"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>naiveAA</mml:mtext></mml:msub></mml:math></alternatives></inline-formula> by using the <monospace>partis</monospace>-inferred naive sequences as substitution profiles (these profiles contain zeros and ones because they are based on one sequence only); we re-emphasize that these naive sequences are inferred based only on the corresponding subsampled sequences in <bold>X</bold>. We cluster the public dataset <bold>Z</bold> once more by running K-means clustering based on the inferred naive sequences in <bold>Z</bold> and obtain our third set of substitution profiles <inline-formula id="pcbi.1006388.e019"><alternatives><graphic id="pcbi.1006388.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e019" xlink:type="simple"/><mml:math display="inline" id="M19"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>naiveAA-clust</mml:mtext></mml:msub></mml:math></alternatives></inline-formula> by assigning each CF in <bold>X</bold> to its closest cluster centroid. The additional cluster profiles <inline-formula id="pcbi.1006388.e020"><alternatives><graphic id="pcbi.1006388.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e020" xlink:type="simple"/><mml:math display="inline" id="M20"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>clust</mml:mtext></mml:msub></mml:math></alternatives></inline-formula> are obtained similarly as above, except in this case, we run K-means clustering based on the original frequency profiles in <bold>Z</bold>. The K-means clustering procedure is run over a grid of cluster sizes ranging from 2 to 120 using the algorithm described by [<xref ref-type="bibr" rid="pcbi.1006388.ref040">40</xref>] with the standard euclidean distance metric. Lastly, the tensor <inline-formula id="pcbi.1006388.e021"><alternatives><graphic id="pcbi.1006388.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e021" xlink:type="simple"/><mml:math display="inline" id="M21"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>neut</mml:mtext></mml:msub></mml:math></alternatives></inline-formula> contains the simulated S5F neutral substitution profiles, which are described in the previous subsection.</p>
<p>The frequency tensors <inline-formula id="pcbi.1006388.e022"><alternatives><graphic id="pcbi.1006388.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e022" xlink:type="simple"/><mml:math display="inline" id="M22"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>vsubgrp</mml:mtext></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006388.e023"><alternatives><graphic id="pcbi.1006388.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e023" xlink:type="simple"/><mml:math display="inline" id="M23"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>vgene</mml:mtext></mml:msub></mml:math></alternatives></inline-formula> are important to include in our analysis because these profiles capture substitution information at the level of the V subgroup (V1, V2, …) and V gene (V1-5, V2-2, …), respectively; this is similar to the types of profiles obtained in [<xref ref-type="bibr" rid="pcbi.1006388.ref016">16</xref>]. Even though we expect the <inline-formula id="pcbi.1006388.e024"><alternatives><graphic id="pcbi.1006388.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e024" xlink:type="simple"/><mml:math display="inline" id="M24"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>vsubgrp</mml:mtext></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006388.e025"><alternatives><graphic id="pcbi.1006388.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e025" xlink:type="simple"/><mml:math display="inline" id="M25"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>vgene</mml:mtext></mml:msub></mml:math></alternatives></inline-formula> tensors to be correlated, we are interested in seeing whether either of these profiles will dominate the other in our regression model. As described in the introduction, most germinal center lineages do not accumulate many mutations relative to the naive sequence so substitution profiles based solely on the naive sequence (like <inline-formula id="pcbi.1006388.e026"><alternatives><graphic id="pcbi.1006388.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e026" xlink:type="simple"/><mml:math display="inline" id="M26"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>naiveAA</mml:mtext></mml:msub></mml:math></alternatives></inline-formula>) may be informative for predicting the mutational patterns at conserved residue positions. In addition, we believe that the <inline-formula id="pcbi.1006388.e027"><alternatives><graphic id="pcbi.1006388.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e027" xlink:type="simple"/><mml:math display="inline" id="M27"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>naiveAA-clust</mml:mtext></mml:msub></mml:math></alternatives></inline-formula> cluster profiles are useful as the naive sequence can greatly influence the pattern of substitutions in a CF due to local sequence context. Unlike the <inline-formula id="pcbi.1006388.e028"><alternatives><graphic id="pcbi.1006388.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e028" xlink:type="simple"/><mml:math display="inline" id="M28"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>vsubgrp</mml:mtext></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006388.e029"><alternatives><graphic id="pcbi.1006388.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e029" xlink:type="simple"/><mml:math display="inline" id="M29"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>vgene</mml:mtext></mml:msub></mml:math></alternatives></inline-formula> substitution profiles, which are based on IMGT labeling schemes, the profiles in <inline-formula id="pcbi.1006388.e030"><alternatives><graphic id="pcbi.1006388.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e030" xlink:type="simple"/><mml:math display="inline" id="M30"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>naiveAA-clust</mml:mtext></mml:msub></mml:math></alternatives></inline-formula> (and <inline-formula id="pcbi.1006388.e031"><alternatives><graphic id="pcbi.1006388.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e031" xlink:type="simple"/><mml:math display="inline" id="M31"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>clust</mml:mtext></mml:msub></mml:math></alternatives></inline-formula>) are determined by a data-driven clustering procedure, which allows us to group CFs in <bold>Z</bold> in a more intricate fashion. The simulated neutral substitution profiles <inline-formula id="pcbi.1006388.e032"><alternatives><graphic id="pcbi.1006388.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e032" xlink:type="simple"/><mml:math display="inline" id="M32"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>neut</mml:mtext></mml:msub></mml:math></alternatives></inline-formula> are able to provide some insight into the CF-specific SHM processes without the corresponding clonal selection effects.</p>
<p>To condense our model presentation, we introduce a four-dimensional tensor <bold>X</bold>* that combines as many of the input profiles mentioned previously as we would like, where <italic>p</italic>, the size of the fourth tensor dimension, represents the number of external profiles used. We define <inline-formula id="pcbi.1006388.e033"><alternatives><graphic id="pcbi.1006388.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e033" xlink:type="simple"/><mml:math display="inline" id="M33"><mml:mrow><mml:msup><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>≡</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:msubsup><mml:mi>X</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi> <mml:mo>,</mml:mo> <mml:mi>l</mml:mi></mml:mrow> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> to be the input data tensor that incorporates all the external information we want to use in our substitution profile predictions; note that <italic>i</italic> ∈ {1, …, <italic>N</italic><sub><italic>CF</italic></sub>} (<italic>N</italic><sub><italic>CF</italic></sub> CFs in the tensors), <italic>j</italic> ∈ {1, …, 149} (149 AHo positions), <italic>k</italic> ∈ {1, …, 20} (20 amino acids), and <italic>l</italic> ∈ {1, …, <italic>p</italic>} (<italic>p</italic> external profiles). Each element <inline-formula id="pcbi.1006388.e034"><alternatives><graphic id="pcbi.1006388.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e034" xlink:type="simple"/><mml:math display="inline" id="M34"><mml:msubsup><mml:mi>X</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi> <mml:mo>,</mml:mo> <mml:mi>l</mml:mi></mml:mrow> <mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> represents an amino acid frequency as described above for <bold>T</bold><sub><italic>i</italic>,<italic>j</italic>,<italic>k</italic></sub>; for instance, <inline-formula id="pcbi.1006388.e035"><alternatives><graphic id="pcbi.1006388.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e035" xlink:type="simple"/><mml:math display="inline" id="M35"><mml:msubsup><mml:mi>X</mml:mi> <mml:mrow><mml:mn>5</mml:mn> <mml:mo>,</mml:mo> <mml:mn>130</mml:mn> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mn>4</mml:mn></mml:mrow> <mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> represents the amino acid frequency of the first amino acid (i.e. alanine) at the 130th AHo position for the 5th CF in the 4th profile in the tensor. In addition, we use the indexing symbol • to extract all elements of a particular array dimension of a tensor (i.e. <inline-formula id="pcbi.1006388.e036"><alternatives><graphic id="pcbi.1006388.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e036" xlink:type="simple"/><mml:math display="inline" id="M36"><mml:msubsup><mml:mi mathvariant="bold">X</mml:mi> <mml:mrow><mml:mn>10</mml:mn> <mml:mo>,</mml:mo> <mml:mn>50</mml:mn> <mml:mo>,</mml:mo> <mml:mo>•</mml:mo> <mml:mo>,</mml:mo> <mml:mn>2</mml:mn></mml:mrow> <mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> specifies the full substitution profile of the 20 amino acids at the 50th AHo position for the 10th CF in the 2nd profile in the tensor). This setup allows us to easily include as many external profiles as we would like.</p>
</sec>
<sec id="sec009">
<title>Model formulation</title>
<p>Given the subsampled profiles <bold>X</bold> and all the external profiles <bold>X</bold>*, we compute a weighted average to form an estimator of <bold>Y</bold>. Our independent-across-sites model <italic>F</italic>(<bold>X</bold>) = [<italic>f</italic>(<bold>X</bold><sub>•,1,•</sub>), …, <italic>f</italic>(<bold>X</bold><sub>•,149,•</sub>)] is specified as follows:
<disp-formula id="pcbi.1006388.e037"><alternatives><graphic id="pcbi.1006388.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e037" xlink:type="simple"/><mml:math display="block" id="M37"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold">X</mml:mi> <mml:mrow><mml:mo>•</mml:mo> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mo>•</mml:mo></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≡</mml:mo> <mml:mi>f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold">X</mml:mi> <mml:mrow><mml:mo>•</mml:mo> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mo>•</mml:mo></mml:mrow></mml:msub> <mml:mo>;</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">α</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mo>•</mml:mo></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>p</mml:mi></mml:munderover> <mml:msub><mml:mi>α</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi>l</mml:mi></mml:mrow></mml:msub> <mml:mo>·</mml:mo> <mml:msubsup><mml:mi mathvariant="bold">X</mml:mi> <mml:mrow><mml:mo>•</mml:mo> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mo>•</mml:mo> <mml:mo>,</mml:mo> <mml:mi>l</mml:mi></mml:mrow> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>+</mml:mo> <mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>p</mml:mi></mml:munderover> <mml:msub><mml:mi>α</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi>l</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo> <mml:mo>·</mml:mo> <mml:msub><mml:mi mathvariant="bold">X</mml:mi> <mml:mrow><mml:mo>•</mml:mo> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mo>•</mml:mo></mml:mrow></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula>
where <bold><italic>α</italic></bold> = {<italic>α</italic><sub><italic>j</italic>, <italic>l</italic></sub>}; 0 ≤ <italic>α</italic><sub><italic>j</italic>, <italic>l</italic></sub> ≤ 1; <inline-formula id="pcbi.1006388.e038"><alternatives><graphic id="pcbi.1006388.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e038" xlink:type="simple"/><mml:math display="inline" id="M38"><mml:mrow><mml:mn>0</mml:mn> <mml:mo>≤</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>p</mml:mi></mml:msubsup> <mml:msub><mml:mi>α</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi>l</mml:mi></mml:mrow></mml:msub> <mml:mo>≤</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> represents the site-specific weights of the different external profiles for <italic>j</italic> = 1, …, 149 and <italic>l</italic> = 1, …, <italic>p</italic>. Although we consider <italic>f</italic> to be a function of the per-site data <bold>X</bold><sub>•,<italic>j</italic>,•</sub>, the frequencies <inline-formula id="pcbi.1006388.e039"><alternatives><graphic id="pcbi.1006388.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e039" xlink:type="simple"/><mml:math display="inline" id="M39"><mml:msubsup><mml:mi mathvariant="bold">X</mml:mi> <mml:mrow><mml:mo>•</mml:mo> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mo>•</mml:mo> <mml:mo>,</mml:mo> <mml:mi>l</mml:mi></mml:mrow> <mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> are computed using sequence-level, site-dependent information. With 149 × <italic>p</italic> parameter values of <bold><italic>α</italic></bold>, this is a highly parameterized model so we include regularization terms to prevent overfitting and obtain sparse, interpretable parameter estimates. Specifically, we use standard and spatial (fused) lasso penalties to achieve these goals.</p>
<p>Standard lasso penalties shrink individual parameters to zero and are commonly used to obtain sparse solutions in regression problems [<xref ref-type="bibr" rid="pcbi.1006388.ref023">23</xref>]. It has been shown that regression models using standard lasso penalties provide more accurate predictions than models using best subset selection penalties when there is a low signal-to-noise ratio [<xref ref-type="bibr" rid="pcbi.1006388.ref041">41</xref>], which probably holds true in our problem as well. In addition, standard lasso penalties are convex functions, which is important in a regression problem as it guarantees that a local minimum is indeed a unique global solution [<xref ref-type="bibr" rid="pcbi.1006388.ref042">42</xref>].</p>
<p>On the other hand, fused lasso penalties shrink the differences between parameters to zero and are useful in regression problems with spatially-related covariates [<xref ref-type="bibr" rid="pcbi.1006388.ref024">24</xref>]. We believe that the <bold><italic>α</italic></bold> parameters have a spatial relationship (i.e. adjacent residues are under similar constraints); for instance, given that the mutations in the framework regions are largely related to antibody stability, it makes sense that we would weight external profile information similarly in those regions. The fusion penalty in this setting enforces smoothness of the <bold><italic>α</italic></bold> trend across the AHo positions. For example, if we penalize first-order differences of the <bold><italic>α</italic></bold> trend, the fitting procedure will necessarily favor trends that have no slope (i.e. that are piecewise constant). We can obtain more flexible piecewise polynomial <bold><italic>α</italic></bold> trends by penalizing higher-order successive differences of <bold><italic>α</italic></bold> [<xref ref-type="bibr" rid="pcbi.1006388.ref025">25</xref>].</p>
<p>In our modeling framework, the standard lasso penalty is represented as <inline-formula id="pcbi.1006388.e040"><alternatives><graphic id="pcbi.1006388.e040g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e040" xlink:type="simple"/><mml:math display="inline" id="M40"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mn>149</mml:mn></mml:msubsup> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>p</mml:mi></mml:msubsup> <mml:mrow><mml:mo>|</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi>l</mml:mi></mml:mrow></mml:msub> <mml:mo>|</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mrow><mml:mo>∥</mml:mo><mml:mi mathvariant="bold-italic">α</mml:mi><mml:mo>∥</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> and the fused lasso penalty is specified by <inline-formula id="pcbi.1006388.e041"><alternatives><graphic id="pcbi.1006388.e041g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e041" xlink:type="simple"/><mml:math display="inline" id="M41"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>p</mml:mi></mml:msubsup> <mml:msub><mml:mrow><mml:mo>∥</mml:mo><mml:msup><mml:mo>∇</mml:mo> <mml:mi>d</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">α</mml:mi> <mml:mrow><mml:mo>•</mml:mo> <mml:mo>,</mml:mo> <mml:mi>l</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow><mml:mo>∥</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, where ∥⋅∥<sub><italic>q</italic></sub> denotes the <italic>L</italic><sub><italic>q</italic></sub> norm and ∇<sup><italic>d</italic></sup>(⋅) represents the <italic>d</italic>th difference operator. This ∇<sup><italic>d</italic></sup>(⋅) operator accepts a vector <bold>v</bold> as input (call its length <italic>n</italic><sub><bold>v</bold></sub>) and outputs a length-(<italic>n</italic><sub><bold>v</bold></sub> − <italic>d</italic>) vector that results from successively differencing adjacent elements <italic>d</italic> times. In the special case when <italic>d</italic> = 1, the fusion penalty becomes <inline-formula id="pcbi.1006388.e042"><alternatives><graphic id="pcbi.1006388.e042g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e042" xlink:type="simple"/><mml:math display="inline" id="M42"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>p</mml:mi></mml:msubsup> <mml:msub><mml:mrow><mml:mo>∥</mml:mo><mml:msup><mml:mo>∇</mml:mo> <mml:mn>1</mml:mn></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">α</mml:mi> <mml:mrow><mml:mo>•</mml:mo> <mml:mo>,</mml:mo> <mml:mi>l</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow><mml:mo>∥</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>2</mml:mn></mml:mrow> <mml:mn>149</mml:mn></mml:msubsup> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>p</mml:mi></mml:msubsup> <mml:mrow><mml:mo>|</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi>l</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mi>l</mml:mi></mml:mrow></mml:msub> <mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>; the |<italic>α</italic><sub><italic>j</italic>, <italic>l</italic></sub> − <italic>α</italic><sub><italic>j</italic>−1,<italic>l</italic></sub>| terms can be interpreted as first-order discrete derivatives.</p>
<p>Our unpenalized objective function can be written as:
<disp-formula id="pcbi.1006388.e043"><alternatives><graphic id="pcbi.1006388.e043g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e043" xlink:type="simple"/><mml:math display="block" id="M43"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>L</mml:mi> <mml:mn>2</mml:mn> <mml:mi mathvariant="bold-italic">α</mml:mi></mml:msubsup> <mml:mo>≡</mml:mo> <mml:msubsup><mml:mi>L</mml:mi> <mml:mn>2</mml:mn> <mml:mi mathvariant="bold-italic">α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">Y</mml:mi> <mml:mo>,</mml:mo> <mml:mi>F</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">X</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mn>149</mml:mn> <mml:mo>·</mml:mo> <mml:msub><mml:mi>N</mml:mi> <mml:mrow><mml:mi>C</mml:mi> <mml:mi>F</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mn>149</mml:mn></mml:munderover> <mml:msubsup><mml:mrow><mml:mo>|</mml:mo> <mml:mo>|</mml:mo> <mml:msub><mml:mi mathvariant="bold">Y</mml:mi> <mml:mrow><mml:mo>•</mml:mo> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mo>•</mml:mo></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:mi>f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold">X</mml:mi> <mml:mrow><mml:mo>•</mml:mo> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mo>•</mml:mo></mml:mrow></mml:msub> <mml:mo>;</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">α</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mo>•</mml:mo></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>|</mml:mo> <mml:mo>|</mml:mo></mml:mrow><mml:mn>2</mml:mn> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2)</label></disp-formula>
where, as in the last subsection, <italic>N</italic><sub><italic>CF</italic></sub> denotes the number of CFs in <bold>X</bold> and <bold>Y</bold>; we refer to this objective as “<italic>L</italic><sub>2</sub> Error”. Our penalized estimation problem is defined in the following manner:
<disp-formula id="pcbi.1006388.e044"><alternatives><graphic id="pcbi.1006388.e044g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e044" xlink:type="simple"/><mml:math display="block" id="M44"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">α</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:munder><mml:mtext>argmin</mml:mtext> <mml:mi mathvariant="bold-italic">α</mml:mi></mml:munder> <mml:mspace width="4pt"/><mml:msubsup><mml:mi>L</mml:mi> <mml:mn>2</mml:mn> <mml:mi mathvariant="bold-italic">α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">Y</mml:mi> <mml:mo>,</mml:mo> <mml:mi>F</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">X</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mo>λ</mml:mo> <mml:mn>1</mml:mn></mml:msub> <mml:msub><mml:mrow><mml:mo>∥</mml:mo><mml:mi mathvariant="bold-italic">α</mml:mi><mml:mo>∥</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mo>λ</mml:mo> <mml:mn>2</mml:mn></mml:msub> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>p</mml:mi></mml:munderover> <mml:msub><mml:mrow><mml:mo>∥</mml:mo><mml:msup><mml:mo>∇</mml:mo> <mml:mi>d</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">α</mml:mi> <mml:mrow><mml:mo>•</mml:mo> <mml:mo>,</mml:mo> <mml:mi>l</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow><mml:mo>∥</mml:mo></mml:mrow> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>s</mml:mtext><mml:mo>.</mml:mo><mml:mtext>t</mml:mtext><mml:mo>.</mml:mo> <mml:mspace width="4.pt"/><mml:mn>0</mml:mn> <mml:mo>≤</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi>l</mml:mi></mml:mrow></mml:msub> <mml:mo>≤</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mspace width="4pt"/><mml:mn>0</mml:mn> <mml:mo>≤</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>p</mml:mi></mml:munderover> <mml:msub><mml:mi>α</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi>l</mml:mi></mml:mrow></mml:msub> <mml:mo>≤</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mspace width="4pt"/><mml:mo>∀</mml:mo> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi>l</mml:mi> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(3)</label></disp-formula>
where λ<sub>1</sub>, λ<sub>2</sub> ≥ 0 and <inline-formula id="pcbi.1006388.e045"><alternatives><graphic id="pcbi.1006388.e045g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e045" xlink:type="simple"/><mml:math display="inline" id="M45"><mml:mrow><mml:mi>d</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="double-struck">N</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> signify tuning parameters. The differencing order <italic>d</italic> is used to specify a given level of smoothness in the spatial <bold><italic>α</italic></bold> trend estimates because the <inline-formula id="pcbi.1006388.e046"><alternatives><graphic id="pcbi.1006388.e046g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e046" xlink:type="simple"/><mml:math display="inline" id="M46"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>p</mml:mi></mml:msubsup> <mml:msub><mml:mrow><mml:mo>∥</mml:mo><mml:msup><mml:mo>∇</mml:mo> <mml:mi>d</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">α</mml:mi> <mml:mrow><mml:mo>•</mml:mo> <mml:mo>,</mml:mo> <mml:mi>l</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow><mml:mo>∥</mml:mo></mml:mrow> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> term in the above minimization problem encourages <bold><italic>α</italic></bold> trends that have <italic>d</italic>th order discrete derivatives close to 0 (i.e. that are piecewise polynomials of order <italic>d</italic> − 1). In addition, careful selection of λ<sub>1</sub> and λ<sub>2</sub> is required to obtain an adequate model fit. Unfortunately, this is a constrained optimization problem with a multivariate output and there are not any obvious ways to minimize such an objective without resorting to general-purpose optimizers. Therefore, in all our experiments, we use the L-BFGS-B algorithm [<xref ref-type="bibr" rid="pcbi.1006388.ref043">43</xref>] to fit the above model. We note that the above penalized optimization problem is (non-strictly) convex so any local minimum is, in fact, a global solution too.</p>
</sec>
<sec id="sec010">
<title>Jaccard similarity</title>
<p>While the model described above has computational and statistical appeal, in engineering applications it is mostly interesting to know the high-frequency amino acid predictions; however, our penalized objective function focuses attention on the complete substitution profiles and not exclusively the high-frequency amino acids. To provide a metric with exclusive focus on high-frequency amino acids, we utilize the Jaccard similarity metric, which can be used to measure differences between predicted and observed sets. Sets of high-frequency amino acids are defined at each position by a minimum frequency cutoff <italic>t</italic>; Jaccard similarities are then computed between the observed and predicted sets and averaged across each CF and AHo position in the dataset.</p>
<p>The Jaccard similarity metric [<xref ref-type="bibr" rid="pcbi.1006388.ref022">22</xref>] measures the similarity between two finite sets. Specifically, for any sets <italic>A</italic> and <italic>B</italic>, the similarity metric <italic>J</italic>(<italic>A</italic>, <italic>B</italic>) is defined as the ratio of the intersection size |<italic>A</italic> ∩ <italic>B</italic>| to the union size |<italic>A</italic> ∪ <italic>B</italic>|. It has these properties: 0 ≤ <italic>J</italic>(<italic>A</italic>, <italic>B</italic>) ≤ 1; <italic>J</italic>(<italic>A</italic>, <italic>B</italic>) = 1 when <italic>A</italic> = <italic>B</italic> and <italic>J</italic>(<italic>A</italic>, <italic>B</italic>) = 0 when <italic>A</italic> ∩ <italic>B</italic> = ∅ (empty set). To formally establish our use of Jaccard similarity, we define the following notation. Let <inline-formula id="pcbi.1006388.e047"><alternatives><graphic id="pcbi.1006388.e047g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e047" xlink:type="simple"/><mml:math display="inline" id="M47"><mml:mrow><mml:msub><mml:mi mathvariant="script">Y</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:mi>y</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi mathvariant="bold">Y</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mo>•</mml:mo></mml:mrow></mml:msub> <mml:mo>∣</mml:mo> <mml:mi>y</mml:mi> <mml:mo>≥</mml:mo> <mml:mi>t</mml:mi> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> represent the set of amino acid frequencies at AHo position <italic>j</italic> for CF <italic>i</italic> that has observed frequencies greater than or equal to the cutoff <italic>t</italic> and denote <inline-formula id="pcbi.1006388.e048"><alternatives><graphic id="pcbi.1006388.e048g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e048" xlink:type="simple"/><mml:math display="inline" id="M48"><mml:mrow><mml:mi mathvariant="bold-script">Y</mml:mi> <mml:mo>≡</mml:mo> <mml:mo>{</mml:mo> <mml:msub><mml:mi mathvariant="script">Y</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> for <italic>i</italic> = 1, …, <italic>N</italic><sub><italic>CF</italic></sub> and <italic>j</italic> = 1, …, 149. We define <inline-formula id="pcbi.1006388.e049"><alternatives><graphic id="pcbi.1006388.e049g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e049" xlink:type="simple"/><mml:math display="inline" id="M49"><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="script">F</mml:mi><mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow> <mml:mi mathvariant="bold">X</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006388.e050"><alternatives><graphic id="pcbi.1006388.e050g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e050" xlink:type="simple"/><mml:math display="inline" id="M50"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold-script">F</mml:mi><mml:mo>^</mml:mo></mml:mover> <mml:mi mathvariant="bold">X</mml:mi></mml:msup> <mml:mo>≡</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="script">F</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow> <mml:mi mathvariant="bold">X</mml:mi></mml:msubsup> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> to be the analogous quantities for the predicted amino acid frequencies. If we let <inline-formula id="pcbi.1006388.e051"><alternatives><graphic id="pcbi.1006388.e051g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e051" xlink:type="simple"/><mml:math display="inline" id="M51"><mml:mrow><mml:mi mathvariant="script">A</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mi mathvariant="script">Y</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> denote a function that accepts as input an amino acid frequency set <inline-formula id="pcbi.1006388.e052"><alternatives><graphic id="pcbi.1006388.e052g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e052" xlink:type="simple"/><mml:math display="inline" id="M52"><mml:msup><mml:mi mathvariant="script">Y</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:math></alternatives></inline-formula> (i.e. <inline-formula id="pcbi.1006388.e053"><alternatives><graphic id="pcbi.1006388.e053g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e053" xlink:type="simple"/><mml:math display="inline" id="M53"><mml:msub><mml:mi mathvariant="script">Y</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> or <inline-formula id="pcbi.1006388.e054"><alternatives><graphic id="pcbi.1006388.e054g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e054" xlink:type="simple"/><mml:math display="inline" id="M54"><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="script">F</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow> <mml:mi mathvariant="bold">X</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>) and outputs the corresponding set of amino acid identities, then our Jaccard similarity objective can be written as:
<disp-formula id="pcbi.1006388.e055"><alternatives><graphic id="pcbi.1006388.e055g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e055" xlink:type="simple"/><mml:math display="block" id="M55"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>J</mml:mi> <mml:mi>t</mml:mi> <mml:mi mathvariant="bold-italic">α</mml:mi></mml:msubsup> <mml:mo>≡</mml:mo> <mml:msubsup><mml:mi>J</mml:mi> <mml:mi>t</mml:mi> <mml:mi mathvariant="bold-italic">α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">Y</mml:mi> <mml:mo>,</mml:mo> <mml:mi>F</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">X</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mn>149</mml:mn> <mml:mo>·</mml:mo> <mml:msub><mml:mi>N</mml:mi> <mml:mrow><mml:mi>C</mml:mi> <mml:mi>F</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:msub><mml:mi>N</mml:mi> <mml:mrow><mml:mi>C</mml:mi> <mml:mi>F</mml:mi></mml:mrow></mml:msub></mml:munderover> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mn>149</mml:mn></mml:munderover> <mml:mi>J</mml:mi> <mml:mo>(</mml:mo> <mml:mi mathvariant="script">A</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="script">Y</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mi mathvariant="script">A</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="script">F</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow> <mml:mi mathvariant="bold">X</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(4)</label></disp-formula>
which is referred to as the “Jaccard Similarity” objective. We can define a penalized Jaccard estimation problem by substituting <inline-formula id="pcbi.1006388.e056"><alternatives><graphic id="pcbi.1006388.e056g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e056" xlink:type="simple"/><mml:math display="inline" id="M56"><mml:mrow><mml:mo>-</mml:mo> <mml:msubsup><mml:mi>J</mml:mi> <mml:mi>t</mml:mi> <mml:mi mathvariant="bold-italic">α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">Y</mml:mi> <mml:mo>,</mml:mo> <mml:mi>F</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">X</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> for <inline-formula id="pcbi.1006388.e057"><alternatives><graphic id="pcbi.1006388.e057g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e057" xlink:type="simple"/><mml:math display="inline" id="M57"><mml:mrow><mml:msubsup><mml:mi>L</mml:mi> <mml:mn>2</mml:mn> <mml:mi mathvariant="bold-italic">α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">Y</mml:mi> <mml:mo>,</mml:mo> <mml:mi>F</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">X</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> in <xref ref-type="disp-formula" rid="pcbi.1006388.e044">Eq (3)</xref>. Jaccard similarity optimization is difficult using derivative-based optimization because of its discrete nature, so we use a smooth approximation of the aforementioned metric for model fitting in our experiments (see <xref ref-type="supplementary-material" rid="pcbi.1006388.s002">S2 Text</xref> for detailed explanation).</p>
</sec>
<sec id="sec011">
<title>Forward stepwise selection</title>
<p>We devise a forward stepwise selection procedure to help us determine the combination of external profiles that best predict the outcome of interest, which can be penalized <italic>L</italic><sub>2</sub> Error or Jaccard Similarity. In this procedure, we initially try all possible external profiles in the model separately and determine the best fit using 5-fold cross-validation. We cache the best model from the initial step and continue fitting models with two external profiles; the first external profile is fixed to be the best profile from the previous round and the second profile can be any possible remaining external profile. We continue this iterative scheme until we reach a prespecified limit on the number of external profiles allowed in <bold>X</bold>*. It is important to note that to ease computation, we perform forward selection using the unpenalized variants of our models. Even though this procedure is greedy and not as thorough as all-subsets selection, we believe this technique provides the best trade-off between accuracy and efficiency. We provide the implementation of our stepwise procedures at <ext-link ext-link-type="uri" xlink:href="https://github.com/krdav/SPURF" xlink:type="simple">https://github.com/krdav/SPURF</ext-link>.</p>
</sec>
<sec id="sec012">
<title>Inference pipeline</title>
<p>We apply a 80%/20% training/test split to the model fitting dataset described above. We first run the forward stepwise selection procedure with a maximum profile limit of five to approximately determine the best profile groupings starting with a single profile and ending with a group of five profiles. Using the profile groupings from the previous step, we fit the penalized version of the model and use 5-fold cross-validation to obtain estimates of the relevant tuning parameters, which consist of the lasso penalty weights λ<sub>1</sub>, λ<sub>2</sub> and the differencing order <italic>d</italic>; note that we report unpenalized performance estimates when we run cross-validation. After we determine the optimal tuning parameters via cross-validation, we fit the penalized model using the entire training portion of the model fitting dataset and the best tuning parameters and cache the resulting parameter estimates of <bold><italic>α</italic></bold>. Once we obtain the estimates of <bold><italic>α</italic></bold> from the penalized model, we can use them to compute the chosen performance metric on the testing portion of the model fitting dataset and any other validation dataset of interest.</p>
</sec>
</sec>
<sec id="sec013" sec-type="results">
<title>Results</title>
<p>As described in the methods (the Inference Pipeline subsection), we first need to infer the best profile groupings to use in penalized model fitting. To determine these groupings, we run the forward stepwise selection procedure for both the <italic>L</italic><sub>2</sub> error function and the smoothed Jaccard objective function with a frequency cutoff <italic>t</italic> = 0.2 (<xref ref-type="table" rid="pcbi.1006388.t002">Table 2</xref>).</p>
<table-wrap id="pcbi.1006388.t002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006388.t002</object-id>
<label>Table 2</label>
<caption>
<title>Results of forward stepwise selection on our <italic>L</italic><sub>2</sub> and smooth Jaccard objective functions.</title>
</caption>
<alternatives>
<graphic id="pcbi.1006388.t002g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006388.t002" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left">Objective Function</th>
<th align="center" colspan="6">Unregularized CV</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="2"><italic>L</italic><sub>2</sub> Error</td>
<td align="center">⌀</td>
<td align="center">
<inline-formula id="pcbi.1006388.e058">
<alternatives>
<graphic id="pcbi.1006388.e058g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e058" xlink:type="simple"/>
<mml:math display="inline" id="M58">
<mml:msub>
<mml:mover accent="true">
<mml:mi mathvariant="bold">X</mml:mi>
<mml:mo>^</mml:mo>
</mml:mover>
<mml:mtext>naiveAA</mml:mtext>
</mml:msub>
</mml:math>
</alternatives>
</inline-formula>
</td>
<td align="center">
<inline-formula id="pcbi.1006388.e059">
<alternatives>
<graphic id="pcbi.1006388.e059g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e059" xlink:type="simple"/>
<mml:math display="inline" id="M59">
<mml:msub>
<mml:mover accent="true">
<mml:mi mathvariant="bold">X</mml:mi>
<mml:mo>^</mml:mo>
</mml:mover>
<mml:mtext>vgene</mml:mtext>
</mml:msub>
</mml:math>
</alternatives>
</inline-formula>
</td>
<td align="center">
<inline-formula id="pcbi.1006388.e060">
<alternatives>
<graphic id="pcbi.1006388.e060g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e060" xlink:type="simple"/>
<mml:math display="inline" id="M60">
<mml:msub>
<mml:mover accent="true">
<mml:mi mathvariant="bold">X</mml:mi>
<mml:mo>^</mml:mo>
</mml:mover>
<mml:mtext>neut</mml:mtext>
</mml:msub>
</mml:math>
</alternatives>
</inline-formula>
</td>
<td align="center">
<inline-formula id="pcbi.1006388.e061">
<alternatives>
<graphic id="pcbi.1006388.e061g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e061" xlink:type="simple"/>
<mml:math display="inline" id="M61">
<mml:msub>
<mml:mover accent="true">
<mml:mi mathvariant="bold">X</mml:mi>
<mml:mo>^</mml:mo>
</mml:mover>
<mml:mtext>vsubgrp</mml:mtext>
</mml:msub>
</mml:math>
</alternatives>
</inline-formula>
</td>
<td align="center">
<inline-formula id="pcbi.1006388.e062">
<alternatives>
<graphic id="pcbi.1006388.e062g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e062" xlink:type="simple"/>
<mml:math display="inline" id="M62">
<mml:msub>
<mml:mover accent="true">
<mml:mi mathvariant="bold">X</mml:mi>
<mml:mo>^</mml:mo>
</mml:mover>
<mml:mrow>
<mml:mtext>naiveAA-clust</mml:mtext>
<mml:mo>-</mml:mo>
<mml:mn>5</mml:mn>
</mml:mrow>
</mml:msub>
</mml:math>
</alternatives>
</inline-formula>
</td>
</tr>
<tr>
<td align="center">0.110</td>
<td align="center">0.0542</td>
<td align="center">0.0459</td>
<td align="center">0.0456</td>
<td align="center">0.0455</td>
<td align="center">0.0456</td>
</tr>
<tr>
<td align="left" rowspan="2">Jaccard Similarity<break/>(<italic>t</italic> = 0.2)</td>
<td align="center">⌀</td>
<td align="center">
<inline-formula id="pcbi.1006388.e063">
<alternatives>
<graphic id="pcbi.1006388.e063g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e063" xlink:type="simple"/>
<mml:math display="inline" id="M63">
<mml:msub>
<mml:mover accent="true">
<mml:mi mathvariant="bold">X</mml:mi>
<mml:mo>^</mml:mo>
</mml:mover>
<mml:mtext>naiveAA</mml:mtext>
</mml:msub>
</mml:math>
</alternatives>
</inline-formula>
</td>
<td align="center">
<inline-formula id="pcbi.1006388.e064">
<alternatives>
<graphic id="pcbi.1006388.e064g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e064" xlink:type="simple"/>
<mml:math display="inline" id="M64">
<mml:msub>
<mml:mover accent="true">
<mml:mi mathvariant="bold">X</mml:mi>
<mml:mo>^</mml:mo>
</mml:mover>
<mml:mtext>vgene</mml:mtext>
</mml:msub>
</mml:math>
</alternatives>
</inline-formula>
</td>
<td align="center">
<inline-formula id="pcbi.1006388.e065">
<alternatives>
<graphic id="pcbi.1006388.e065g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e065" xlink:type="simple"/>
<mml:math display="inline" id="M65">
<mml:msub>
<mml:mover accent="true">
<mml:mi mathvariant="bold">X</mml:mi>
<mml:mo>^</mml:mo>
</mml:mover>
<mml:mtext>neut</mml:mtext>
</mml:msub>
</mml:math>
</alternatives>
</inline-formula>
</td>
<td align="center">
<inline-formula id="pcbi.1006388.e066">
<alternatives>
<graphic id="pcbi.1006388.e066g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e066" xlink:type="simple"/>
<mml:math display="inline" id="M66">
<mml:msub>
<mml:mover accent="true">
<mml:mi mathvariant="bold">X</mml:mi>
<mml:mo>^</mml:mo>
</mml:mover>
<mml:mtext>vsubgrp</mml:mtext>
</mml:msub>
</mml:math>
</alternatives>
</inline-formula>
</td>
<td align="center">
<inline-formula id="pcbi.1006388.e067">
<alternatives>
<graphic id="pcbi.1006388.e067g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e067" xlink:type="simple"/>
<mml:math display="inline" id="M67">
<mml:msub>
<mml:mover accent="true">
<mml:mi mathvariant="bold">X</mml:mi>
<mml:mo>^</mml:mo>
</mml:mover>
<mml:mrow>
<mml:mtext>naiveAA-clust</mml:mtext>
<mml:mo>-</mml:mo>
<mml:mn>85</mml:mn>
</mml:mrow>
</mml:msub>
</mml:math>
</alternatives>
</inline-formula>
</td>
</tr>
<tr>
<td align="center">0.9170</td>
<td align="center">0.9322</td>
<td align="center">0.9324</td>
<td align="center">0.9323</td>
<td align="center">0.9319</td>
<td align="center">0.9318</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t002fn001">
<p>The performance estimates shown in the table are obtained using 5-fold cross-validation. Going from left to right, each column represents the best profile addition into <bold>X</bold>* with the associated CV performance estimate. For Jaccard, we fit using the smooth Jaccard objective, but report exact Jaccard similarity estimates, both using frequency cutoff <italic>t</italic> = 0.2. Note that we fix the prespecified limit on the number of external profiles allowed in <bold>X</bold>* to be 5. ⌀ represents the model using only the input sequence.</p>
</fn>
</table-wrap-foot>
</table-wrap>
<p>For both objective functions, the forward selection path is the same until <inline-formula id="pcbi.1006388.e068"><alternatives><graphic id="pcbi.1006388.e068g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e068" xlink:type="simple"/><mml:math display="inline" id="M68"><mml:mrow><mml:msup><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>=</mml:mo> <mml:mo>{</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>naiveAA</mml:mtext></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>vgene</mml:mtext></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>neut</mml:mtext></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>vsubgrp</mml:mtext></mml:msub> <mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. For the <italic>L</italic><sub>2</sub> loss function, model performance is the best when <inline-formula id="pcbi.1006388.e069"><alternatives><graphic id="pcbi.1006388.e069g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e069" xlink:type="simple"/><mml:math display="inline" id="M69"><mml:mrow><mml:msup><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>=</mml:mo> <mml:mo>{</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>naiveAA</mml:mtext></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>vgene</mml:mtext></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>neut</mml:mtext></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>vsubgrp</mml:mtext></mml:msub> <mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> even though there are diminishing returns for using profiles beyond <inline-formula id="pcbi.1006388.e070"><alternatives><graphic id="pcbi.1006388.e070g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e070" xlink:type="simple"/><mml:math display="inline" id="M70"><mml:mrow><mml:msup><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>=</mml:mo> <mml:mo>{</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>naiveAA</mml:mtext></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>vgene</mml:mtext></mml:msub> <mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. In a similar fashion, the Jaccard similarity estimates tend to be highest when <inline-formula id="pcbi.1006388.e071"><alternatives><graphic id="pcbi.1006388.e071g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e071" xlink:type="simple"/><mml:math display="inline" id="M71"><mml:mrow><mml:msup><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>=</mml:mo> <mml:mo>{</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>naiveAA</mml:mtext></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>vgene</mml:mtext></mml:msub> <mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, despite the almost identical model performance from just using <inline-formula id="pcbi.1006388.e072"><alternatives><graphic id="pcbi.1006388.e072g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e072" xlink:type="simple"/><mml:math display="inline" id="M72"><mml:mrow><mml:msup><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>=</mml:mo> <mml:mo>{</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>naiveAA</mml:mtext></mml:msub> <mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. For the subsequent penalized model fitting step, we choose to evaluate the <inline-formula id="pcbi.1006388.e073"><alternatives><graphic id="pcbi.1006388.e073g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e073" xlink:type="simple"/><mml:math display="inline" id="M73"><mml:mo>{</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>naiveAA</mml:mtext></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>vgene</mml:mtext></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>neut</mml:mtext></mml:msub> <mml:mo>}</mml:mo></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006388.e074"><alternatives><graphic id="pcbi.1006388.e074g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e074" xlink:type="simple"/><mml:math display="inline" id="M74"><mml:mo>{</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>naiveAA</mml:mtext></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>vgene</mml:mtext></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>neut</mml:mtext></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>vsubgrp</mml:mtext></mml:msub> <mml:mo>}</mml:mo></mml:math></alternatives></inline-formula> profile groupings with the <italic>L</italic><sub>2</sub> objective and <inline-formula id="pcbi.1006388.e075"><alternatives><graphic id="pcbi.1006388.e075g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e075" xlink:type="simple"/><mml:math display="inline" id="M75"><mml:mo>{</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>naiveAA</mml:mtext></mml:msub> <mml:mo>}</mml:mo></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006388.e076"><alternatives><graphic id="pcbi.1006388.e076g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e076" xlink:type="simple"/><mml:math display="inline" id="M76"><mml:mo>{</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>naiveAA</mml:mtext></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>vgene</mml:mtext></mml:msub> <mml:mo>}</mml:mo></mml:math></alternatives></inline-formula> with the smoothed Jaccard similarity objective. The inclusion of the <inline-formula id="pcbi.1006388.e077"><alternatives><graphic id="pcbi.1006388.e077g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e077" xlink:type="simple"/><mml:math display="inline" id="M77"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>vgene</mml:mtext></mml:msub></mml:math></alternatives></inline-formula> tensor puts a notable restriction on the model; no prediction can be made for a sequence annotated to a V gene which has not been observed in our Public dataset.</p>
<p>We now use the approximate profile groupings obtained from the forward stepwise selection procedure to fit our regularized models. The penalized estimation problem has additional tuning parameters that must be determined. In our experiments, we cross-validate over penalty parameters; λ<sub>1</sub>, λ<sub>2</sub> = 10<sup>−7</sup>, 5.05 × 10<sup>−6</sup>, 10<sup>−5</sup>; the differencing order, <italic>d</italic> = 1, 2, 3; and the two profile groupings specified above for both the <italic>L</italic><sub>2</sub> error and Jaccard similarity objectives. The best regularized <italic>L</italic><sub>2</sub> model uses <inline-formula id="pcbi.1006388.e078"><alternatives><graphic id="pcbi.1006388.e078g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e078" xlink:type="simple"/><mml:math display="inline" id="M78"><mml:mrow><mml:msup><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>=</mml:mo> <mml:mo>{</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>naiveAA</mml:mtext></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>vgene</mml:mtext></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>neut</mml:mtext></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>vsubgrp</mml:mtext></mml:msub> <mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, while the best regularized Jaccard model utilizes <inline-formula id="pcbi.1006388.e079"><alternatives><graphic id="pcbi.1006388.e079g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e079" xlink:type="simple"/><mml:math display="inline" id="M79"><mml:mrow><mml:msup><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>=</mml:mo> <mml:mo>{</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>naiveAA</mml:mtext></mml:msub> <mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> (<xref ref-type="supplementary-material" rid="pcbi.1006388.s004">S1 Table</xref> and <xref ref-type="supplementary-material" rid="pcbi.1006388.s012">S7 Fig</xref>). In summary, using many external profiles is important for predicting the complete substitution profiles, while the inferred naive sequence is the only external profile deemed useful for our model to accurately predict the observed high-frequency amino acids (where high-frequency is defined by being at least 20% of the observed amino acids).</p>
<p>Our optimization times for both <italic>L</italic><sub>2</sub> loss and Jaccard Similarity on the 500 CFs ranged from 12 to 15 minutes. Our optimization is based on evaluating the objective function at different points and each objective function call has linear complexity in the number of CFs so increasing the number of CFs should result, on average, in a linear increase in time complexity. Computational time invested in pre-processing is one-time and negligible.</p>
<p>In addition to predictive performance, we are also interested in understanding how the estimated parameter weights from our best regularized <italic>L</italic><sub>2</sub> model vary across the different external profiles in <bold>X</bold>* and antibody regions. For convenience, we aggregate the estimates of <bold><italic>α</italic></bold> associated with the V gene (<inline-formula id="pcbi.1006388.e080"><alternatives><graphic id="pcbi.1006388.e080g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e080" xlink:type="simple"/><mml:math display="inline" id="M80"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>vgene</mml:mtext></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006388.e081"><alternatives><graphic id="pcbi.1006388.e081g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e081" xlink:type="simple"/><mml:math display="inline" id="M81"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>vsubgrp</mml:mtext></mml:msub></mml:math></alternatives></inline-formula>) and with the full naive sequence (<inline-formula id="pcbi.1006388.e082"><alternatives><graphic id="pcbi.1006388.e082g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e082" xlink:type="simple"/><mml:math display="inline" id="M82"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>naiveAA</mml:mtext></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006388.e083"><alternatives><graphic id="pcbi.1006388.e083g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e083" xlink:type="simple"/><mml:math display="inline" id="M83"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>neut</mml:mtext></mml:msub></mml:math></alternatives></inline-formula>) as these sets of profiles are intuitively similar (<xref ref-type="fig" rid="pcbi.1006388.g003">Fig 3</xref>); the V-gene and V-subgroup profiles are both derived by averaging over different IMGT V germline gene labeling schemes and the simulated S5F neutral substitution profiles originate from the CF-specific inferred naive sequence. Antibody heavy chain (and light chain) sequences can be partitioned into framework regions (FWKs) and complementarity-determining regions (CDRs) by the AHo definitions [<xref ref-type="bibr" rid="pcbi.1006388.ref021">21</xref>]; the BCR binding affinity is largely determined by the CDRs (especially by the heavy chain CDR3), while the FWKs encode the structural constraints of the BCR and thus can be strongly conserved [<xref ref-type="bibr" rid="pcbi.1006388.ref044">44</xref>]. The <inline-formula id="pcbi.1006388.e084"><alternatives><graphic id="pcbi.1006388.e084g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e084" xlink:type="simple"/><mml:math display="inline" id="M84"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>vgene</mml:mtext></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006388.e085"><alternatives><graphic id="pcbi.1006388.e085g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e085" xlink:type="simple"/><mml:math display="inline" id="M85"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>vsubgrp</mml:mtext></mml:msub></mml:math></alternatives></inline-formula> profiles are extremely important for prediction at FWK1-FWK3, which is not surprising as V germline genes extend from the FWK1 to the beginning of the CDR3. In contrast, the <inline-formula id="pcbi.1006388.e086"><alternatives><graphic id="pcbi.1006388.e086g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e086" xlink:type="simple"/><mml:math display="inline" id="M86"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>naiveAA</mml:mtext></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006388.e087"><alternatives><graphic id="pcbi.1006388.e087g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e087" xlink:type="simple"/><mml:math display="inline" id="M87"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>neut</mml:mtext></mml:msub></mml:math></alternatives></inline-formula> external profiles are heavily weighted in the CDR3 and FWK4; this result is also intuitive because the CDR3 is highly variable across CFs as it is a strong determinant of antigen-binding specificity, the <inline-formula id="pcbi.1006388.e088"><alternatives><graphic id="pcbi.1006388.e088g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e088" xlink:type="simple"/><mml:math display="inline" id="M88"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>naiveAA</mml:mtext></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006388.e089"><alternatives><graphic id="pcbi.1006388.e089g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e089" xlink:type="simple"/><mml:math display="inline" id="M89"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>neut</mml:mtext></mml:msub></mml:math></alternatives></inline-formula> profiles are our only CF-specific sources of external information, and the V gene specific profiles cannot provide any information beyond the end of the V gene. Furthermore, the FWKs have, on average, more support from the external profiles compared to the CDRs, which is consistent with our understanding of antibody biochemistry as the FWKs are structurally constrained and thus need to be more conserved compared to the more flexible CDRs. We note that the middle of the CDR3 has artificially low estimates of <bold><italic>α</italic></bold> because most of the AHo positions in the CDR3 have only a few or no defined sequence positions in the dataset (<xref ref-type="supplementary-material" rid="pcbi.1006388.s006">S1 Fig</xref>).</p>
<p>While our penalized modeling framework allows for easy interpretation of the parameter estimates, ultimately the quality of the <bold><italic>α</italic></bold> estimates is determined by their performance on independent test datasets. Specifically, we compute the <italic>L</italic><sub>2</sub> error (<inline-formula id="pcbi.1006388.e090"><alternatives><graphic id="pcbi.1006388.e090g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e090" xlink:type="simple"/><mml:math display="inline" id="M90"><mml:msubsup><mml:mi>L</mml:mi> <mml:mn>2</mml:mn> <mml:mi mathvariant="bold-italic">α</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>) and Jaccard similarity (<inline-formula id="pcbi.1006388.e091"><alternatives><graphic id="pcbi.1006388.e091g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e091" xlink:type="simple"/><mml:math display="inline" id="M91"><mml:msubsup><mml:mi>J</mml:mi> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>2</mml:mn></mml:mrow> <mml:mi mathvariant="bold-italic">α</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>) between the predicted and observed profiles associated with both the testing portion of the model fitting dataset and the Briggs validation dataset (<xref ref-type="table" rid="pcbi.1006388.t003">Table 3</xref>); we remind readers that these predictions are made based on the subsampled (i.e. single-sequence) profiles in the aforementioned datasets and compared to the corresponding actual amino acid frequencies through the <inline-formula id="pcbi.1006388.e092"><alternatives><graphic id="pcbi.1006388.e092g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e092" xlink:type="simple"/><mml:math display="inline" id="M92"><mml:msubsup><mml:mi>L</mml:mi> <mml:mn>2</mml:mn> <mml:mi mathvariant="bold-italic">α</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006388.e093"><alternatives><graphic id="pcbi.1006388.e093g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e093" xlink:type="simple"/><mml:math display="inline" id="M93"><mml:msubsup><mml:mi>J</mml:mi> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>2</mml:mn></mml:mrow> <mml:mi mathvariant="bold-italic">α</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> performance metrics (<xref ref-type="fig" rid="pcbi.1006388.g002">Fig 2</xref>). Additionally, we compute the <italic>L</italic><sub>2</sub> error and Jaccard similarity on all sequences in the Liao dataset, comparing the baseline and SPURF predictions to the full amino acid frequencies (<xref ref-type="table" rid="pcbi.1006388.t003">Table 3</xref>, <xref ref-type="supplementary-material" rid="pcbi.1006388.s005">S2 Table</xref>, and <xref ref-type="supplementary-material" rid="pcbi.1006388.s011">S6 Fig</xref>). Our model improves upon the “baseline” prediction performance, where “baseline” refers to predictions made using only the input sequence (i.e. model predictions with all parameter values of <bold><italic>α</italic></bold> set to 0).</p>
<table-wrap id="pcbi.1006388.t003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006388.t003</object-id>
<label>Table 3</label>
<caption>
<title>The model performance using either <italic>L</italic><sub>2</sub> error or Jaccard similarity resulting from predicting on independent datasets.</title>
</caption>
<alternatives>
<graphic id="pcbi.1006388.t003g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006388.t003" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left">Objective Function</th>
<th align="left">Model Type</th>
<th align="center" colspan="3">Objective Function Values</th>
</tr>
<tr>
<th align="left"/>
<th align="left"/>
<th align="center">Model fitting: test</th>
<th align="center">Briggs</th>
<th align="center">Liao</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="2"><italic>L</italic><sub>2</sub> Error</td>
<td align="left">Best</td>
<td align="char" char=".">0.0492</td>
<td align="char" char=".">0.0511</td>
<td align="char" char=".">0.0991</td>
</tr>
<tr>
<td align="left">Baseline</td>
<td align="char" char=".">0.114</td>
<td align="char" char=".">0.129</td>
<td align="char" char=".">0.183</td>
</tr>
<tr>
<td align="left" rowspan="2">Jaccard Similarity<break/>(<italic>t</italic> = 0.2)</td>
<td align="left">Best</td>
<td align="char" char=".">0.9289</td>
<td align="char" char=".">0.9227</td>
<td align="char" char=".">0.8516</td>
</tr>
<tr>
<td align="left">Baseline</td>
<td align="char" char=".">0.9156</td>
<td align="char" char=".">0.9053</td>
<td align="char" char=".">0.8439</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t003fn001">
<p>We provide results for the testing portion of the model fitting dataset, the Briggs validation dataset, and the Liao dataset. Note that the term “baseline” refers to predictions made using only the input sequence (i.e. model predictions with all parameter values of <bold><italic>α</italic></bold> set to 0). Lower <italic>L</italic><sub>2</sub> error and higher Jaccard Similarity mean higher accuracy.</p>
</fn>
</table-wrap-foot>
</table-wrap>
<p>In addition, we also want to know how well our model performs in the different antibody regions (i.e. FWKs/CDRs). To answer this question, we compute the same metrics as shown in <xref ref-type="table" rid="pcbi.1006388.t003">Table 3</xref> for the different FWKs and CDRs (<xref ref-type="fig" rid="pcbi.1006388.g004">Fig 4</xref>). To provide some insight into the variability of the model performance estimates in the different regions, we calculate bootstrap standard errors, which are expressed as error bars in <xref ref-type="fig" rid="pcbi.1006388.g004">Fig 4</xref>.</p>
<p>We see that our substitution profile prediction model performs well in the CDRs relative to the baseline model. This is an important finding because antigen binding is largely determined by the sequence segments in the CDRs, and especially CDR3. In fact, our models seem to provide the greatest improvement in performance in the CDR3, which is also the hardest region to predict because it has the highest amount of sequence variability. Another important takeaway is that the prediction performance is better in FWKs than CDRs, which is presumably because FWKs have lower variance and are more conserved compared to CDRs. In summary, our prediction models are able to systematically integrate different data sources to make better predictions of the per-site amino acid compositions in CFs.</p>
<p>Our model also improves the prediction of the highest-frequency amino acid at a given position, referred to here as the mode (<xref ref-type="table" rid="pcbi.1006388.t004">Table 4</xref>). Indeed, the counts in the bottom-left cells (cases where the model is correctly predicting the actual mode given an incorrect input sequence amino acid) are larger than the counts in the top-right cells (vice-versa). In addition, the input sequence amino acids that are not the true modes but correctly predicted by the model to be the actual modes are all germline reversions, which is consistent with the <inline-formula id="pcbi.1006388.e094"><alternatives><graphic id="pcbi.1006388.e094g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e094" xlink:type="simple"/><mml:math display="inline" id="M94"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>naiveAA</mml:mtext></mml:msub></mml:math></alternatives></inline-formula> profile being heavily weighted in our prediction model (<xref ref-type="fig" rid="pcbi.1006388.g003">Fig 3</xref>). In the opposite case, where the input sequence amino acid is correct but the model prediction is wrong, all the counts consist of germline predictions as well. In summary, many of the mode predictions are just germline reversions and, in fact, most of these predictions are to the true modes (i.e. the actual highest-frequency amino acids); however, most of the input sequence amino acids are the true modes already (≈ 99%).</p>
<table-wrap id="pcbi.1006388.t004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006388.t004</object-id>
<label>Table 4</label>
<caption>
<title>Mode prediction results from both the testing portion of the model fitting dataset and the Briggs dataset fitted using the <italic>L</italic><sub>2</sub> objective function.</title>
<p>For each CF and AHo position in a given dataset, we determine whether the predicted mode (i.e. highest-frequency amino acid) from our best model is the same as the actual mode. Results are aggregated based on whether or not the input sequence has the correct mode. At the left side of the vertical bar (∣) is the count for the germline predicted modes (i.e. situations when the predicted amino acid mode is the naive sequence amino acid) and at the right side is the count for the non-germline predicted modes (vice-versa).</p>
</caption>
<alternatives>
<graphic id="pcbi.1006388.t004g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006388.t004" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center" colspan="2" rowspan="2">germline ∣ non-germline</th>
<th align="center" colspan="2">Correct SPURF Mode Prediction?</th>
<th align="center" colspan="2" rowspan="2">germline ∣ non-germline</th>
<th align="center" colspan="2">Correct SPURF Mode Prediction?</th>
</tr>
<tr>
<th align="center">Yes</th>
<th align="center">No</th>
<th align="center">Yes</th>
<th align="center">No</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center" rowspan="2">Is input amino<break/>acid the mode?</td>
<td align="left">Yes</td>
<td align="center">10,473 ∣ 465</td>
<td align="left">156 ∣ 0</td>
<td align="center" rowspan="2">Is input amino<break/>acid the mode?</td>
<td align="left">Yes</td>
<td align="center">10,541 ∣ 376</td>
<td align="left">178 ∣ 1</td>
</tr>
<tr>
<td align="left">No</td>
<td align="center">349 ∣ 0</td>
<td align="left">170 ∣ 395</td>
<td align="left">No</td>
<td align="center">474 ∣ 0</td>
<td align="left">196 ∣ 393</td>
</tr>
<tr>
<td align="left" colspan="4">(<bold>a</bold>) Model fitting: test dataset</td>
<td align="left" colspan="4">(<bold>b</bold>) Briggs dataset</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>The in-sample and out-of-sample prediction performances demonstrate that our SPURF inference pipeline is able to obtain accurate and robust estimates of <bold><italic>α</italic></bold>. Specifically, prediction performance is consistently similar but slightly worse when comparing the Briggs dataset to the model fitting test set, which likely reflects two things: 1) the median number of sequences per CF in the Briggs set is lower than in the test set (Tables <xref ref-type="table" rid="pcbi.1006388.t001">1</xref> and <xref ref-type="table" rid="pcbi.1006388.t002">2</xref>) the model fitting dataset is sampled from the same donors as the dataset for cross-validation. Regardless, the differences between the test and Briggs datasets are small, which provides evidence in support of our model performance estimates. We also note that the test on the Liao data yielded results strongly favoring SPURF over baseline. Since the Liao dataset carries a high mutation frequency compared to the average CF of the other dataset it is (as expected) harder to predict the amino acid frequency, which is reflected in the magnitude of both the <italic>L</italic><sub>2</sub> error and Jaccard similarity for all predictions. Subjective assessments of the inferred substitution profiles coincide with our description of the <italic>L</italic><sub>2</sub> error metric, namely that fine-grained amino acid substitution information is captured by SPURF (<xref ref-type="supplementary-material" rid="pcbi.1006388.s007">S2 Fig</xref>).</p>
<p>The SPURF model setup produces interpretable and meaningful profile weights (<xref ref-type="fig" rid="pcbi.1006388.g005">Fig 5</xref>; per-profile decomposition in <xref ref-type="supplementary-material" rid="pcbi.1006388.s008">S3 Fig</xref>). The input sequence is strongly weighted in the CDRs, indicating that substitutions in these regions are both specific and conserved within the CF and, therefore, cannot easily utilize the information from other CFs. The weight on the V gene specific profiles spikes at CDR1 and at the end of FWK3, which is at the heavy and light chain interface. We note that, as expected, the weight on the V gene specific profiles is minimal downstream of FWK3 as this is the end of the V gene and the beginning of the V-D junction region. As such, nothing prevents the V gene profiles from having a high weight downstream of FWK3, but the model framework has chosen these meaningful weights without any manual interference. We ascribe this shrinkage feature of the weights to the standard lasso penalty built into SPURF. The profiles that are derived from the inferred naive sequence (<inline-formula id="pcbi.1006388.e095"><alternatives><graphic id="pcbi.1006388.e095g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e095" xlink:type="simple"/><mml:math display="inline" id="M95"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>naiveAA</mml:mtext></mml:msub></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1006388.e096"><alternatives><graphic id="pcbi.1006388.e096g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e096" xlink:type="simple"/><mml:math display="inline" id="M96"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>neut</mml:mtext></mml:msub></mml:math></alternatives></inline-formula>) take up the missing weight of the V gene profiles as these are highly weighted in the CDR3 and FWK4.</p>
<fig id="pcbi.1006388.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006388.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Positional profile weights <italic>α</italic> mapped to an antibody protein structure (PDB: 5X8L).</title>
<p>The antigen (PD-L1) appears as a purple surface at the top of the images, the light chain appears in white cartoon, and the heavy chain is displayed using a blue to red color gradient; the grey dashed lines mark the CDR loops. The color gradient represents the possible values of profile weights in <bold><italic>α</italic></bold> and goes from blue at a zero weight to red at the maximum weight for the profile. The display in panels <bold>B</bold> and <bold>C</bold> is rotated relative to panel <bold>A</bold> to better show results for CDR1 and CDR3; as a consequence, the CDR2 loop is hidden behind the CDR1. Panel <bold>A</bold> shows that the input sequence has high weight at the CDR1 and CDR2, panel <bold>B</bold> illustrates that the naive sequence and the neutral substitution profile have high weight at the CDR3 and FWK4, and panel <bold>C</bold> demonstrates that the V gene and V subgroup profiles are highly weighted in parts of the CDR1 but more generally in the FWKs, especially at the heavy and light chain interface.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006388.g005" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec014" sec-type="conclusions">
<title>Discussion</title>
<p>In this paper, we present SPURF, a statistical framework for predicting CF-specific amino acid frequency profiles from single input BCR sequences by leveraging multiple sources of external information. We use standard and spatial lasso penalties to prevent our model from overfitting and obtain sparse, interpretable estimates of the profile weights, expressed by an <bold><italic>α</italic></bold> matrix. The spatial lasso penalizes extreme differences between spatially-adjacent profile weights, while the standard lasso penalties promote simpler models by shrinking parameter values in <bold><italic>α</italic></bold> to 0 if the associated external profiles are not useful predictors. We show that our method not only performs well on the held-out (test) portion of our model fitting dataset but also provides accurate predictions on the Briggs and Liao external validation datasets. Indeed, we did not obtain the Briggs or Liao validation datasets until after we ran our model inference pipeline on the model fitting dataset.</p>
<p>Using two different objective functions we fitted SPURF to predict the frequencies of all amino acids (<italic>L</italic><sub>2</sub> objective) and only the &gt;20% frequency amino acids (Jaccard similarity objective). With the <italic>L</italic><sub>2</sub> objective we obtained a large difference (0.114 to 0.0492) between the baseline model and SPURF, which was confirmed using repertoire wide data from [<xref ref-type="bibr" rid="pcbi.1006388.ref012">12</xref>] and single clone data from [<xref ref-type="bibr" rid="pcbi.1006388.ref038">38</xref>] (<xref ref-type="fig" rid="pcbi.1006388.g004">Fig 4</xref> and <xref ref-type="supplementary-material" rid="pcbi.1006388.s011">S6 Fig</xref>). With the Jaccard similarity objective improvements over baseline were more modest (0.9156 to 0.9289) showing that SPURF is strongest at predicting the full spectrum of amino acid frequencies (<xref ref-type="table" rid="pcbi.1006388.t003">Table 3</xref>). Still, fitted using the <italic>L</italic><sub>2</sub> objective, SPURF can recover the highest frequency amino acid of a clonal family (mode prediction) much better than a random sequence from the corresponding clonal family (<xref ref-type="table" rid="pcbi.1006388.t004">Table 4</xref>), showing the versatility of the <italic>L</italic><sub>2</sub> objective.</p>
<p>Our work can be seen as a prediction-based extension of the work of [<xref ref-type="bibr" rid="pcbi.1006388.ref016">16</xref>] and [<xref ref-type="bibr" rid="pcbi.1006388.ref019">19</xref>]. This previous work illustrates that amino acid substitution profiles differ between germline genes, a finding supported by the context specificity of somatic hypermutation [<xref ref-type="bibr" rid="pcbi.1006388.ref020">20</xref>]. In our work, we provide a prediction algorithm that takes a single BCR sequence from a clonal family as input and outputs a CF-specific substitution profile estimate for the whole VDJ region. As SPURF relies on large CFs to establish a ground truth substitution profile it is possible that certain types of rare clones or V/J gene combinations are not included in our training/test data. For such rare events the error estimates reported cannot be reliably used, however, we note that our training/test data cover a broad set of V/J combinations (<xref ref-type="supplementary-material" rid="pcbi.1006388.s009">S4 Fig</xref>) and that the substitution profile of a rare, but expanded, broadly HIV neutralizing clone is well predicted (<xref ref-type="supplementary-material" rid="pcbi.1006388.s011">S6 Fig</xref>).</p>
<p>We believe that this work will be a useful tool for antibody engineering in situations when it is important to maintain antibody binding affinity to the same epitope. The predicted profiles from SPURF can be used to choose the sites that are most tolerable for mutagenesis and the substitutions that are most likely to maintain binding specificity; as such, this information can be used to engineer antibodies with better biophysical properties.</p>
<p>The seven datasets utilized in the present study were all derived from different laboratories employing varying strategies to obtain their processed data which served as input for SPURF. We carefully examined available resources and selected the datasets to be used in our model. However, our approach would greatly benefit from a large and uniformly accessible repository of Rep-seq datasets. For this to happen, data has to be discoverable and usable, including having all information about the study and data processing available together with the raw and processed data in publicly accessible data repositories. Recently, the Adaptive Immune Receptor Repertoire (AIRR) community [<xref ref-type="bibr" rid="pcbi.1006388.ref045">45</xref>] proposed MiAIRR [<xref ref-type="bibr" rid="pcbi.1006388.ref046">46</xref>], a set of minimal standard elements to be published alongside the raw and processed data. Future Rep-seq studies following this initiative and making their data available under the MiAIRR-standard will facilitate the development of SPURF and future approaches with similar goals.</p>
<p>To our knowledge, SPURF is the first prediction algorithm for B cell CF substitution profiles. There are many possible extensions; in our SPURF inference pipeline, we subsample single BCR sequences from CFs to use as model input; unfortunately, this means that our modeling analysis is conditional on a dataset that does not account for the variability associated with the subsampling process. One obvious means of fixing the above problem is to draw multiple subsamples from each CF and treat these multiple “observations” per CF within a dataset as a clustered data or weighted least squares problem. In addition, our model fitting dataset consists of only the largest CFs because we need accurate CF-specific substitution profile estimates to serve as the ground truth. This non-random sampling technique could potentially bias our analysis results; however, this appears unlikely given our model’s performance on the external Briggs and Liao validation datasets. Furthermore, our approach models per-site amino acid composition in a CF and accounts for interactions between sites only through the fusion lasso penalties. It is well known from other protein studies that spatially-adjacent amino acid residues evolve jointly [<xref ref-type="bibr" rid="pcbi.1006388.ref047">47</xref>, <xref ref-type="bibr" rid="pcbi.1006388.ref048">48</xref>], presumably to maintain structural stability, or in the case of antibodies to stabilize the interface between heavy and light chains [<xref ref-type="bibr" rid="pcbi.1006388.ref049">49</xref>]. In the context of antibodies, residues in the FWKs have the potential to co-evolve (e.g. FWK residues flanking the CDRs could co-evolve to stabilize the stem leading to the more flexible CDRs). Thus, figuring out how to incorporate more detailed interaction effects in our model is an important avenue for future research.</p>
</sec>
<sec id="sec015">
<title>Supporting information</title>
<supplementary-material id="pcbi.1006388.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006388.s001" xlink:type="simple">
<label>S1 Text</label>
<caption>
<title>Model interpretation.</title>
<p>Details of the penalized regression model.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006388.s002" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006388.s002" xlink:type="simple">
<label>S2 Text</label>
<caption>
<title>Smoothed Jaccard similarity.</title>
<p>Explanation of the continuous approximation of the Jaccard similarity used in the optimization.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006388.s003" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006388.s003" xlink:type="simple">
<label>S3 Text</label>
<caption>
<title>Supporting information references.</title>
<p>References used in the Supporting Information sections.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006388.s004" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006388.s004" xlink:type="simple">
<label>S1 Table</label>
<caption>
<title>The results from fitting the regularized models using 5-fold cross-validation.</title>
<p>We present the optimal tuning parameters selected from λ<sub>1</sub>, λ<sub>2</sub> = 10<sup>−7</sup>, 5.05 × 10<sup>−6</sup>, 10<sup>−5</sup> and <italic>d</italic> = 1, 2, 3 and show the associated cross-validated performance estimates. Note that the possible choices of <bold>X</bold>* for the <italic>L</italic><sub>2</sub> error metric include the <inline-formula id="pcbi.1006388.e097"><alternatives><graphic id="pcbi.1006388.e097g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e097" xlink:type="simple"/><mml:math display="inline" id="M97"><mml:mo>{</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>naiveAA</mml:mtext></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>vgene</mml:mtext></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>neut</mml:mtext></mml:msub> <mml:mo>}</mml:mo></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006388.e098"><alternatives><graphic id="pcbi.1006388.e098g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e098" xlink:type="simple"/><mml:math display="inline" id="M98"><mml:mo>{</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>naiveAA</mml:mtext></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>vgene</mml:mtext></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>neut</mml:mtext></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>vsubgrp</mml:mtext></mml:msub> <mml:mo>}</mml:mo></mml:math></alternatives></inline-formula> groupings, while the <inline-formula id="pcbi.1006388.e099"><alternatives><graphic id="pcbi.1006388.e099g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e099" xlink:type="simple"/><mml:math display="inline" id="M99"><mml:mo>{</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>naiveAA</mml:mtext></mml:msub> <mml:mo>}</mml:mo></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006388.e100"><alternatives><graphic id="pcbi.1006388.e100g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e100" xlink:type="simple"/><mml:math display="inline" id="M100"><mml:mo>{</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>naiveAA</mml:mtext></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>vgene</mml:mtext></mml:msub> <mml:mo>}</mml:mo></mml:math></alternatives></inline-formula> groupings are the possible <bold>X</bold>* choices for the smoothed Jaccard similarity objective.</p>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006388.s005" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006388.s005" xlink:type="simple">
<label>S2 Table</label>
<caption>
<title>The results from fitting the regularized models using 5-fold cross-validation.</title>
<p>The unregularized and regularized model performance using either <italic>L</italic><sub>2</sub> Error or Jaccard Similarity resulting from predicting on independent datasets. We provide results for the testing portion of the model fitting dataset, the Briggs validation dataset, and the Liao dataset. Note that the term “baseline” refers to predictions made using only the input sequence (i.e. model predictions with all parameter values of <bold><italic>α</italic></bold> set to 0) and lower <italic>L</italic><sub>2</sub> error and higher Jaccard Similarity is preferred.</p>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006388.s006" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006388.s006" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>A stacked barplot of the estimated parameter values of <italic>α</italic> from the best regularized <italic>L</italic><sub>2</sub> model.</title>
<p>The black vertical lines represent the boundaries between the different CDRs and FWKs. Due to the AHo antibody numbering used [<xref ref-type="bibr" rid="pcbi.1006388.ref021">21</xref>], some positions are assigned to a gap character (an AHo position that does not map to a sequence position). The percentage of CFs that are not assigned to gap characters is shown in the bottom plot for each AHo position. The input sequence is heavily weighted in regions with high gap percentages because of the standard lasso penalty included in our model. The conserved Tryptophan amino acid is observed as a spike in the <inline-formula id="pcbi.1006388.e101"><alternatives><graphic id="pcbi.1006388.e101g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e101" xlink:type="simple"/><mml:math display="inline" id="M101"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>vgene</mml:mtext></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006388.e102"><alternatives><graphic id="pcbi.1006388.e102g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e102" xlink:type="simple"/><mml:math display="inline" id="M102"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>naiveAA</mml:mtext></mml:msub></mml:math></alternatives></inline-formula> profile weights following the end of CDR1 (position 43 in the AHo scheme). The conserved Cysteine amino acid that defines the beginning of CDR3 is not readily observed, presumably because this is invariant in all profiles. Generally, the input sequence has less weight in CDR3 and FWK4, which indicates that there is some conservation during affinity maturation. Beyond CDR3 and FWK4, there is a general trend that the input sequence has higher weight in the CDRs than in the FWKs, which suggests that there is a higher level of conservation in the FWKs than in the CDRs during affinity maturation. A more surprising observation is the spike in the <inline-formula id="pcbi.1006388.e103"><alternatives><graphic id="pcbi.1006388.e103g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e103" xlink:type="simple"/><mml:math display="inline" id="M103"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>vgene</mml:mtext></mml:msub></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1006388.e104"><alternatives><graphic id="pcbi.1006388.e104g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e104" xlink:type="simple"/><mml:math display="inline" id="M104"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>vsubgrp</mml:mtext></mml:msub></mml:math></alternatives></inline-formula>, and <inline-formula id="pcbi.1006388.e105"><alternatives><graphic id="pcbi.1006388.e105g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e105" xlink:type="simple"/><mml:math display="inline" id="M105"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>neut</mml:mtext></mml:msub></mml:math></alternatives></inline-formula> weights at AHo position 83 near the beginning of FWK3 (the “outer” loop); this could indicate a conserved position not previously described.</p>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006388.s007" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006388.s007" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>A logo plot displaying the input sequence, predicted profile, and true profile (ordered from top to bottom) for an arbitrary CF in the Briggs dataset.</title>
<p>The logos are plotted using AHo numbers (1-149) and AHo positions undefined in the sequence are shown as empty columns. The predicted profile (middle) captures much of the amino acid composition information associated with the full profile (bottom).</p>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006388.s008" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006388.s008" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Positional profile weights <italic>α</italic> mapped to an antibody protein structure (PDB: 5X8L).</title>
<p>The antigen (PD-L1) appears as a purple surface at the top of the images, the light chain appears in yellow cartoon, and the heavy chain is displayed using a blue to red color gradient. The color gradient represents the possible values of profile weights in <bold><italic>α</italic></bold> and goes from blue at a zero weight to red at the maximum weight for the profile. The black dashed lines mark the CDR loops; note that the CDR2 loop is hidden behind the CDR1. The colored balls represent the AHo-defined FWK/CDR boundaries. The black arrows indicate regions of high profile weight. The <inline-formula id="pcbi.1006388.e106"><alternatives><graphic id="pcbi.1006388.e106g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e106" xlink:type="simple"/><mml:math display="inline" id="M106"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>naiveAA</mml:mtext></mml:msub></mml:math></alternatives></inline-formula> profile is heavily weighted in CDR3 and FWK4. The <inline-formula id="pcbi.1006388.e107"><alternatives><graphic id="pcbi.1006388.e107g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e107" xlink:type="simple"/><mml:math display="inline" id="M107"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>vgene</mml:mtext></mml:msub></mml:math></alternatives></inline-formula> profile weighting is fairly even from FWK1 through FWK3; it spikes slightly in CDR1 and completely disappears beyond FWK3, which is expected as the V-D junction region starts past the end of FWK3. The <inline-formula id="pcbi.1006388.e108"><alternatives><graphic id="pcbi.1006388.e108g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e108" xlink:type="simple"/><mml:math display="inline" id="M108"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>neut</mml:mtext></mml:msub></mml:math></alternatives></inline-formula> profile weighting is fairly even across sites but spikes near the beginning of FWK3 (the “outer” loop). The <inline-formula id="pcbi.1006388.e109"><alternatives><graphic id="pcbi.1006388.e109g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e109" xlink:type="simple"/><mml:math display="inline" id="M109"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>vsubgrp</mml:mtext></mml:msub></mml:math></alternatives></inline-formula> profile weighting is distributed similarly to that of the <inline-formula id="pcbi.1006388.e110"><alternatives><graphic id="pcbi.1006388.e110g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e110" xlink:type="simple"/><mml:math display="inline" id="M110"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>vgene</mml:mtext></mml:msub></mml:math></alternatives></inline-formula> profile with the exception of a spike at the end of FWK3 (i.e. at the heavy and light chain interface).</p>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006388.s009" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006388.s009" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>Distribution of per-clonal-family V/J gene combination usage in the different dataset partitions.</title>
<p>Minimum frequency of 1% in either partition used as a cutoff for inclusion.</p>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006388.s010" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006388.s010" xlink:type="simple">
<label>S5 Fig</label>
<caption>
<title>Distribution of per-clonal-family V/J subgroup combination usage in the different dataset partitions.</title>
<p>Minimum frequency of 1% in either partition used as a cutoff for inclusion.</p>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006388.s011" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006388.s011" xlink:type="simple">
<label>S6 Fig</label>
<caption>
<title>Two histograms showing <italic>L</italic><sub>2</sub> loss estimates based on model predictions from the baseline model and best model for the Liao dataset [<xref ref-type="bibr" rid="pcbi.1006388.ref038">38</xref>].</title>
<p>In this analysis, we made model predictions using each of the 312 sequences as the input sequence for our model.</p>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006388.s012" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006388.s012" xlink:type="simple">
<label>S7 Fig</label>
<caption>
<title>A heatmap showing 5-fold cross-validated <italic>L</italic><sub>2</sub> loss results from fitting the regularized models for the <inline-formula id="pcbi.1006388.e111"><alternatives><graphic id="pcbi.1006388.e111g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006388.e111" xlink:type="simple"/><mml:math display="inline" id="M111"><mml:mo>{</mml:mo> <mml:msub><mml:mover accent="true"><mml:mtext>X</mml:mtext> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>naiveAA</mml:mtext></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mtext>X</mml:mtext> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>vgene</mml:mtext></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mtext>X</mml:mtext> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>neut</mml:mtext></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mtext>X</mml:mtext> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>vsubgrp</mml:mtext></mml:msub> <mml:mo>}</mml:mo></mml:math></alternatives></inline-formula> profile grouping.</title>
<p>We present unregularized <italic>L</italic><sub>2</sub> loss estimates for tuning parameters λ<sub>1</sub>, λ<sub>2</sub> = 10<sup>−7</sup>, 5.05 × 10<sup>−6</sup>, 10<sup>−5</sup> and the order of differencing, <italic>d</italic> = 1, 2, 3, and mark the optimal tuning parameters found from our experiments.</p>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006388.s013" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006388.s013" xlink:type="simple">
<label>S8 Fig</label>
<caption>
<title>A plot of the function <italic>f</italic><sub><italic>ϵ</italic></sub>(<italic>a</italic><sub><italic>i</italic></sub>, 0.2) against <italic>a</italic><sub><italic>i</italic></sub> ∈ [0, 1] for various values of <italic>ϵ</italic>.</title>
<p>As <italic>ϵ</italic> gets larger, <italic>f</italic><sub><italic>ϵ</italic></sub>(<italic>a</italic><sub><italic>i</italic></sub>, 0.2) tends to the indicator function <italic>f</italic>(<italic>a</italic><sub><italic>i</italic></sub>, 0.2).</p>
<p>(TIFF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We would like to thank Jason A. Vander Heiden and Steven H. Kleinstein for sharing post-processed data (dataset 1-4), Mikhail Shugay for sharing post-processed data (dataset 5), Uri Hershberg for providing the ImmuneDB data (dataset 6). We would also like to thank Juno Therapeutics, Inc. for providing and preparing the single cell dataset used as our external validation.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1006388.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Igawa</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Tsunoda</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Kuramochi</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Sampei</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Ishii</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Hattori</surname> <given-names>K</given-names></name>. <article-title>Engineering the variable region of therapeutic IgG antibodies</article-title>. <source>mAbs</source>. <year>2011</year>;<volume>3</volume>(<issue>3</issue>):<fpage>243</fpage>–<lpage>252</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.4161/mabs.3.3.15234" xlink:type="simple">10.4161/mabs.3.3.15234</ext-link></comment> <object-id pub-id-type="pmid">21406966</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006388.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Clark</surname> <given-names>RH</given-names></name>, <name name-style="western"><surname>Latypov</surname> <given-names>RF</given-names></name>, <name name-style="western"><surname>De Imus</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Carter</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Wilson</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Manchulenko</surname> <given-names>K</given-names></name>, <etal>et al</etal>. <article-title>Remediating agitation-induced antibody aggregation by eradicating exposed hydrophobic motifs</article-title>. <source>mAbs</source>. <year>2014</year>;<volume>6</volume>(<issue>6</issue>):<fpage>1540</fpage>–<lpage>1550</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.4161/mabs.36252" xlink:type="simple">10.4161/mabs.36252</ext-link></comment> <object-id pub-id-type="pmid">25484048</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006388.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Casaz</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Boucher</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Wollacott</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Pierce</surname> <given-names>BG</given-names></name>, <name name-style="western"><surname>Rivera</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Sedic</surname> <given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Resolving self-association of a therapeutic antibody by formulation optimization and molecular approaches</article-title>. <source>mAbs</source>. <year>2014</year>;<volume>6</volume>(<issue>6</issue>):<fpage>1533</fpage>–<lpage>1539</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.4161/19420862.2014.975658" xlink:type="simple">10.4161/19420862.2014.975658</ext-link></comment> <object-id pub-id-type="pmid">25484044</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006388.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Courtois</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Agrawal</surname> <given-names>NJ</given-names></name>, <name name-style="western"><surname>Lauer</surname> <given-names>TM</given-names></name>, <name name-style="western"><surname>Trout</surname> <given-names>BL</given-names></name>. <article-title>Rational design of therapeutic mAbs against aggregation through protein engineering and incorporation of glycosylation motifs applied to bevacizumab</article-title>. <source>mAbs</source>. <year>2016</year>;<volume>8</volume>(<issue>1</issue>):<fpage>99</fpage>–<lpage>112</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1080/19420862.2015.1112477" xlink:type="simple">10.1080/19420862.2015.1112477</ext-link></comment> <object-id pub-id-type="pmid">26514585</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006388.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Geoghegan</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Fleming</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Damschroder</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Bishop</surname> <given-names>SM</given-names></name>, <name name-style="western"><surname>Sathish</surname> <given-names>HA</given-names></name>, <name name-style="western"><surname>Esfandiary</surname> <given-names>R</given-names></name>. <article-title>Mitigation of reversible self-association and viscosity in a human IgG1 monoclonal antibody by rational, structure-guided Fv engineering</article-title>. <source>mAbs</source>. <year>2016</year>;<volume>8</volume>(<issue>5</issue>):<fpage>941</fpage>–<lpage>950</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1080/19420862.2016.1171444" xlink:type="simple">10.1080/19420862.2016.1171444</ext-link></comment> <object-id pub-id-type="pmid">27050875</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006388.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Harding</surname> <given-names>FA</given-names></name>, <name name-style="western"><surname>Stickler</surname> <given-names>MM</given-names></name>, <name name-style="western"><surname>Razo</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>DuBridge</surname> <given-names>R</given-names></name>. <article-title>The immunogenicity of humanized and fully human antibodies: residual immunogenicity resides in the CDR regions</article-title>. <source>mAbs</source>. <year>2010</year>;<volume>2</volume>(<issue>3</issue>):<fpage>256</fpage>–<lpage>265</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.4161/mabs.2.3.11641" xlink:type="simple">10.4161/mabs.2.3.11641</ext-link></comment> <object-id pub-id-type="pmid">20400861</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006388.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>McConnell</surname> <given-names>AD</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Macomber</surname> <given-names>JL</given-names></name>, <name name-style="western"><surname>Chau</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Sheffer</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Rahmanian</surname> <given-names>S</given-names></name>, <etal>et al</etal>. <article-title>A general approach to antibody thermostabilization</article-title>. <source>mAbs</source>. <year>2014</year>;<volume>6</volume>(<issue>5</issue>):<fpage>1274</fpage>–<lpage>1282</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.4161/mabs.29680" xlink:type="simple">10.4161/mabs.29680</ext-link></comment> <object-id pub-id-type="pmid">25517312</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006388.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Seeliger</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Schulz</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Litzenburger</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Spitz</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Hoerer</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Blech</surname> <given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Boosting antibody developability through rational sequence optimization</article-title>. <source>mAbs</source>. <year>2015</year>;<volume>7</volume>(<issue>3</issue>):<fpage>505</fpage>–<lpage>515</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1080/19420862.2015.1017695" xlink:type="simple">10.1080/19420862.2015.1017695</ext-link></comment> <object-id pub-id-type="pmid">25759214</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006388.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Henikoff</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Henikoff</surname> <given-names>JG</given-names></name>. <article-title>Amino acid substitution matrices from protein blocks</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>1992</year>;<volume>89</volume>(<issue>22</issue>):<fpage>10915</fpage>–<lpage>10919</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.89.22.10915" xlink:type="simple">10.1073/pnas.89.22.10915</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006388.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tas</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Mesin</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Pasqual</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Targ</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Jacobsen</surname> <given-names>JT</given-names></name>, <name name-style="western"><surname>Mano</surname> <given-names>YM</given-names></name>, <etal>et al</etal>. <article-title>Visualizing antibody affinity maturation in germinal centers</article-title>. <source>Science</source>. <year>2016</year>;<volume>351</volume>(<issue>6277</issue>):<fpage>1048</fpage>–<lpage>1054</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.aad3439" xlink:type="simple">10.1126/science.aad3439</ext-link></comment> <object-id pub-id-type="pmid">26912368</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006388.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Victora</surname> <given-names>GD</given-names></name>, <name name-style="western"><surname>Nussenzweig</surname> <given-names>MC</given-names></name>. <article-title>Germinal Centers</article-title>. <source>Annual Review of Immunology</source>. <year>2012</year>;<volume>30</volume>(<issue>1</issue>):<fpage>429</fpage>–<lpage>457</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1146/annurev-immunol-020711-075032" xlink:type="simple">10.1146/annurev-immunol-020711-075032</ext-link></comment> <object-id pub-id-type="pmid">22224772</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006388.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Briggs</surname> <given-names>AW</given-names></name>, <name name-style="western"><surname>Goldfless</surname> <given-names>SJ</given-names></name>, <name name-style="western"><surname>Timberlake</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Belmont</surname> <given-names>BJ</given-names></name>, <name name-style="western"><surname>Clouser</surname> <given-names>CR</given-names></name>, <name name-style="western"><surname>Koppstein</surname> <given-names>D</given-names></name>, <etal>et al</etal>. <article-title>Tumor-infiltrating immune repertoires captured by single-cell barcoding in emulsion</article-title>. <source>bioRxiv</source>. <year>2017</year>; p. <fpage>134841</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006388.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kepler</surname> <given-names>TB</given-names></name>, <name name-style="western"><surname>Munshaw</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Wiehe</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Yu</surname> <given-names>JS</given-names></name>, <name name-style="western"><surname>Woods</surname> <given-names>CW</given-names></name>, <etal>et al</etal>. <article-title>Reconstructing a B-Cell Clonal Lineage. II. Mutation, Selection, and Affinity Maturation</article-title>. <source>Frontiers in Immunology</source>. <year>2014</year>;<volume>5</volume>:<fpage>170</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3389/fimmu.2014.00170" xlink:type="simple">10.3389/fimmu.2014.00170</ext-link></comment> <object-id pub-id-type="pmid">24795717</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006388.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kuraoka</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Schmidt</surname> <given-names>AG</given-names></name>, <name name-style="western"><surname>Nojima</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Feng</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Watanabe</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Kitamura</surname> <given-names>D</given-names></name>, <etal>et al</etal>. <article-title>Complex antigens drive permissive clonal selection in germinal centers</article-title>. <source>Immunity</source>. <year>2016</year>;<volume>44</volume>(<issue>3</issue>):<fpage>542</fpage>–<lpage>552</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.immuni.2016.02.010" xlink:type="simple">10.1016/j.immuni.2016.02.010</ext-link></comment> <object-id pub-id-type="pmid">26948373</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006388.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Schmidt</surname> <given-names>AG</given-names></name>, <name name-style="western"><surname>Xu</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Khan</surname> <given-names>AR</given-names></name>, <name name-style="western"><surname>O’Donnell</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Khurana</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>King</surname> <given-names>LR</given-names></name>, <etal>et al</etal>. <article-title>Preconfiguration of the antigen-binding site during affinity maturation of a broadly neutralizing influenza virus antibody</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2013</year>;<volume>110</volume>(<issue>1</issue>):<fpage>264</fpage>–<lpage>269</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1218256109" xlink:type="simple">10.1073/pnas.1218256109</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006388.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sheng</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Schramm</surname> <given-names>CA</given-names></name>, <name name-style="western"><surname>Kong</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Mullikin</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Mascola</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>Kwong</surname> <given-names>PD</given-names></name>, <etal>et al</etal>. <article-title>Gene-specific substitution profiles describe the types and frequencies of amino acid changes during antibody somatic hypermutation</article-title>. <source>Frontiers in Immunology</source>. <year>2017</year>;<volume>8</volume>:<fpage>537</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3389/fimmu.2017.00537" xlink:type="simple">10.3389/fimmu.2017.00537</ext-link></comment> <object-id pub-id-type="pmid">28539926</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006388.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ralph</surname> <given-names>DK</given-names></name>, <name name-style="western"><surname>Matsen</surname> <given-names>FA</given-names> <suffix>IV</suffix></name>. <article-title>Likelihood-based inference of B cell clonal families</article-title>. <source>PLoS Computational Biology</source>. <year>2016</year>;<volume>12</volume>(<issue>10</issue>):<fpage>e1005086</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1005086" xlink:type="simple">10.1371/journal.pcbi.1005086</ext-link></comment> <object-id pub-id-type="pmid">27749910</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006388.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sheng</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Schramm</surname> <given-names>CA</given-names></name>, <name name-style="western"><surname>Connors</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Morris</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Mascola</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>Kwong</surname> <given-names>PD</given-names></name>, <etal>et al</etal>. <article-title>Effects of Darwinian selection and mutability on rate of broadly neutralizing antibody evolution during HIV-1 infection</article-title>. <source>PLoS Computational Biology</source>. <year>2016</year>;<volume>12</volume>(<issue>5</issue>):<fpage>e1004940</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1004940" xlink:type="simple">10.1371/journal.pcbi.1004940</ext-link></comment> <object-id pub-id-type="pmid">27191167</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006388.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kirik</surname> <given-names>U</given-names></name>, <name name-style="western"><surname>Persson</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Levander</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Greiff</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Ohlin</surname> <given-names>M</given-names></name>. <article-title>Antibody Heavy Chain Variable Domains of Different Germline Gene Origins Diversify Through Different Paths</article-title>. <source>Frontiers in Immunology</source>. <year>2017</year>;<volume>8</volume>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3389/fimmu.2017.01433" xlink:type="simple">10.3389/fimmu.2017.01433</ext-link></comment> <object-id pub-id-type="pmid">29180996</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006388.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cui</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Di Niro</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Vander Heiden</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Briggs</surname> <given-names>AW</given-names></name>, <name name-style="western"><surname>Adams</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Gilbert</surname> <given-names>T</given-names></name>, <etal>et al</etal>. <article-title>A Model of Somatic Hypermutation Targeting in Mice Based on High-Throughput Ig Sequencing Data</article-title>. <source>The Journal of Immunology</source>. <year>2016</year>;<volume>197</volume>(<issue>9</issue>):<fpage>3566</fpage>–<lpage>3574</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.4049/jimmunol.1502263" xlink:type="simple">10.4049/jimmunol.1502263</ext-link></comment> <object-id pub-id-type="pmid">27707999</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006388.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Honegger</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Plueckthun</surname> <given-names>A</given-names></name>. <article-title>Yet another numbering scheme for immunoglobulin variable domains: an automatic modeling and analysis tool</article-title>. <source>Journal of Molecular Biology</source>. <year>2001</year>;<volume>309</volume>(<issue>3</issue>):<fpage>657</fpage>–<lpage>670</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1006/jmbi.2001.4662" xlink:type="simple">10.1006/jmbi.2001.4662</ext-link></comment> <object-id pub-id-type="pmid">11397087</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006388.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Jaccard</surname> <given-names>P</given-names></name>. <article-title>The distribution of the flora in the alpine zone</article-title>. <source>New Phytologist</source>. <year>1912</year>;<volume>11</volume>(<issue>2</issue>):<fpage>37</fpage>–<lpage>50</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/j.1469-8137.1912.tb05611.x" xlink:type="simple">10.1111/j.1469-8137.1912.tb05611.x</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006388.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tibshirani</surname> <given-names>R</given-names></name>. <article-title>Regression Shrinkage and Selection via the Lasso</article-title>. <source>Journal of the Royal Statistical Society: Series B (Methodological)</source>. <year>1996</year>;<volume>58</volume>(<issue>1</issue>):<fpage>267</fpage>–<lpage>288</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006388.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tibshirani</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Saunders</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Rosset</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Zhu</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Knight</surname> <given-names>K</given-names></name>. <article-title>Sparsity and smoothness via the fused lasso</article-title>. <source>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</source>. <year>2005</year>;<volume>67</volume>(<issue>1</issue>):<fpage>91</fpage>–<lpage>108</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/j.1467-9868.2005.00490.x" xlink:type="simple">10.1111/j.1467-9868.2005.00490.x</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006388.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tibshirani</surname> <given-names>RJ</given-names></name>. <article-title>Adaptive piecewise polynomial estimation via trend filtering</article-title>. <source>The Annals of Statistics</source>. <year>2014</year>;<volume>42</volume>(<issue>1</issue>):<fpage>285</fpage>–<lpage>323</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1214/13-AOS1189" xlink:type="simple">10.1214/13-AOS1189</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006388.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gupta</surname> <given-names>NT</given-names></name>, <name name-style="western"><surname>Adams</surname> <given-names>KD</given-names></name>, <name name-style="western"><surname>Briggs</surname> <given-names>AW</given-names></name>, <name name-style="western"><surname>Timberlake</surname> <given-names>SC</given-names></name>, <name name-style="western"><surname>Vigneault</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Kleinstein</surname> <given-names>SH</given-names></name>. <article-title>Hierarchical clustering can identify B cell clones with high confidence in Ig repertoire sequencing data</article-title>. <source>The Journal of Immunology</source>. <year>2017</year>;<volume>198</volume>(<issue>6</issue>):<fpage>2489</fpage>–<lpage>2499</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.4049/jimmunol.1601850" xlink:type="simple">10.4049/jimmunol.1601850</ext-link></comment> <object-id pub-id-type="pmid">28179494</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006388.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Laserson</surname> <given-names>U</given-names></name>, <name name-style="western"><surname>Vigneault</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Gadala-Maria</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Yaari</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Uduman</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Vander Heiden</surname> <given-names>JA</given-names></name>, <etal>et al</etal>. <article-title>High-resolution antibody dynamics of vaccine-induced immune responses</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2014</year>;<volume>111</volume>(<issue>13</issue>):<fpage>4928</fpage>–<lpage>4933</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1323862111" xlink:type="simple">10.1073/pnas.1323862111</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006388.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Vander Heiden</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Stathopoulos</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Zhou</surname> <given-names>JQ</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Gilbert</surname> <given-names>TJ</given-names></name>, <name name-style="western"><surname>Bolen</surname> <given-names>CR</given-names></name>, <etal>et al</etal>. <article-title>Dysregulation of B cell repertoire formation in myasthenia gravis patients revealed through deep sequencing</article-title>. <source>The Journal of Immunology</source>. <year>2017</year>;<volume>198</volume>(<issue>4</issue>):<fpage>1460</fpage>–<lpage>1473</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.4049/jimmunol.1601415" xlink:type="simple">10.4049/jimmunol.1601415</ext-link></comment> <object-id pub-id-type="pmid">28087666</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006388.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Stern</surname> <given-names>JN</given-names></name>, <name name-style="western"><surname>Yaari</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Vander Heiden</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Church</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Donahue</surname> <given-names>WF</given-names></name>, <name name-style="western"><surname>Hintzen</surname> <given-names>RQ</given-names></name>, <etal>et al</etal>. <article-title>B cells populating the multiple sclerosis brain mature in the draining cervical lymph nodes</article-title>. <source>Science Translational Medicine</source>. <year>2014</year>;<volume>6</volume>(<issue>248</issue>):<fpage>248ra107</fpage>–<lpage>248ra107</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/scitranslmed.3008879" xlink:type="simple">10.1126/scitranslmed.3008879</ext-link></comment> <object-id pub-id-type="pmid">25100741</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006388.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tsioris</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Gupta</surname> <given-names>NT</given-names></name>, <name name-style="western"><surname>Ogunniyi</surname> <given-names>AO</given-names></name>, <name name-style="western"><surname>Zimnisky</surname> <given-names>RM</given-names></name>, <name name-style="western"><surname>Qian</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Yao</surname> <given-names>Y</given-names></name>, <etal>et al</etal>. <article-title>Neutralizing antibodies against West Nile virus identified directly from human B cells by single-cell analysis and next generation sequencing</article-title>. <source>Integrative Biology</source>. <year>2015</year>;<volume>7</volume>(<issue>12</issue>):<fpage>1587</fpage>–<lpage>1597</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1039/c5ib00169b" xlink:type="simple">10.1039/c5ib00169b</ext-link></comment> <object-id pub-id-type="pmid">26481611</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006388.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Turchaninova</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Davydov</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Britanova</surname> <given-names>OV</given-names></name>, <name name-style="western"><surname>Shugay</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Bikos</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Egorov</surname> <given-names>ES</given-names></name>, <etal>et al</etal>. <article-title>High-quality full-length immunoglobulin profiling with unique molecular barcoding</article-title>. <source>Nat Protoc</source>. <year>2016</year>;<volume>11</volume>(<issue>9</issue>):<fpage>1599</fpage>–<lpage>1616</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nprot.2016.093" xlink:type="simple">10.1038/nprot.2016.093</ext-link></comment> <object-id pub-id-type="pmid">27490633</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006388.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Meng</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Schwartz</surname> <given-names>GW</given-names></name>, <name name-style="western"><surname>Rosenfeld</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Ren</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Thome</surname> <given-names>JJ</given-names></name>, <etal>et al</etal>. <article-title>An atlas of B-cell clonal distribution in the human body</article-title>. <source>Nature Biotechnology</source>. <year>2017</year>;<volume>35</volume>(<issue>9</issue>):<fpage>879</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nbt.3942" xlink:type="simple">10.1038/nbt.3942</ext-link></comment> <object-id pub-id-type="pmid">28829438</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006388.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Shugay</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Britanova</surname> <given-names>OV</given-names></name>, <name name-style="western"><surname>Merzlyak</surname> <given-names>EM</given-names></name>, <name name-style="western"><surname>Turchaninova</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Mamedov</surname> <given-names>IZ</given-names></name>, <name name-style="western"><surname>Tuganbaev</surname> <given-names>TR</given-names></name>, <etal>et al</etal>. <article-title>Towards error-free profiling of immune repertoires</article-title>. <source>Nature Methods</source>. <year>2014</year>;<volume>11</volume>(<issue>6</issue>):<fpage>653</fpage>–<lpage>655</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nmeth.2960" xlink:type="simple">10.1038/nmeth.2960</ext-link></comment> <object-id pub-id-type="pmid">24793455</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006388.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Vander Heiden</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Yaari</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Uduman</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Stern</surname> <given-names>JN</given-names></name>, <name name-style="western"><surname>O’Connor</surname> <given-names>KC</given-names></name>, <name name-style="western"><surname>Hafler</surname> <given-names>DA</given-names></name>, <etal>et al</etal>. <article-title>pRESTO: a toolkit for processing high-throughput sequencing raw reads of lymphocyte receptor repertoires</article-title>. <source>Bioinformatics</source>. <year>2014</year>;<volume>30</volume>(<issue>13</issue>):<fpage>1930</fpage>–<lpage>1932</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btu138" xlink:type="simple">10.1093/bioinformatics/btu138</ext-link></comment> <object-id pub-id-type="pmid">24618469</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006388.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Loman</surname> <given-names>NJ</given-names></name>, <name name-style="western"><surname>Misra</surname> <given-names>RV</given-names></name>, <name name-style="western"><surname>Dallman</surname> <given-names>TJ</given-names></name>, <name name-style="western"><surname>Constantinidou</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Gharbia</surname> <given-names>SE</given-names></name>, <name name-style="western"><surname>Wain</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Performance comparison of benchtop high-throughput sequencing platforms</article-title>. <source>Nature Biotechnology</source>. <year>2012</year>;<volume>30</volume>(<issue>5</issue>):<fpage>434</fpage>–<lpage>439</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nbt.2198" xlink:type="simple">10.1038/nbt.2198</ext-link></comment> <object-id pub-id-type="pmid">22522955</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006388.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ralph</surname> <given-names>DK</given-names></name>, <name name-style="western"><surname>Matsen</surname> <given-names>FA</given-names> <suffix>IV</suffix></name>. <article-title>Consistency of VDJ rearrangement and substitution parameters enables accurate B cell receptor sequence annotation</article-title>. <source>PLoS Computational Biology</source>. <year>2016</year>;<volume>12</volume>(<issue>1</issue>):<fpage>e1004409</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1004409" xlink:type="simple">10.1371/journal.pcbi.1004409</ext-link></comment> <object-id pub-id-type="pmid">26751373</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006388.ref037">
<label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dunbar</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Deane</surname> <given-names>CM</given-names></name>. <article-title>ANARCI: antigen receptor numbering and receptor classification</article-title>. <source>Bioinformatics</source>. <year>2015</year>;<volume>32</volume>(<issue>2</issue>):<fpage>298</fpage>–<lpage>300</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btv552" xlink:type="simple">10.1093/bioinformatics/btv552</ext-link></comment> <object-id pub-id-type="pmid">26424857</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006388.ref038">
<label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Liao</surname> <given-names>HX</given-names></name>, <name name-style="western"><surname>Lynch</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Zhou</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Gao</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Alam</surname> <given-names>SM</given-names></name>, <name name-style="western"><surname>Boyd</surname> <given-names>SD</given-names></name>, <etal>et al</etal>. <article-title>Co-evolution of a broadly neutralizing HIV-1 antibody and founder virus</article-title>. <source>Nature</source>. <year>2013</year>;<volume>496</volume>(<issue>7446</issue>):<fpage>469</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature12053" xlink:type="simple">10.1038/nature12053</ext-link></comment> <object-id pub-id-type="pmid">23552890</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006388.ref039">
<label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lefranc</surname> <given-names>MP</given-names></name>. <article-title>Nomenclature of the human immunoglobulin heavy (IGH) genes</article-title>. <source>Experimental and Clinical Immunogenetics</source>. <year>2001</year>;<volume>18</volume>(<issue>2</issue>):<fpage>100</fpage>–<lpage>116</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1159/000049189" xlink:type="simple">10.1159/000049189</ext-link></comment> <object-id pub-id-type="pmid">11340299</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006388.ref040">
<label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hartigan</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Wong</surname> <given-names>MA</given-names></name>. <article-title>Algorithm AS 136: A k-means clustering algorithm</article-title>. <source>Journal of the Royal Statistical Society Series C (Applied Statistics)</source>. <year>1979</year>;<volume>28</volume>(<issue>1</issue>):<fpage>100</fpage>–<lpage>108</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006388.ref041">
<label>41</label>
<mixed-citation publication-type="other" xlink:type="simple">Hastie T, Tibshirani R, Tibshirani RJ. Extended Comparisons of best subset selection, forward stepwise selection, and the lasso. arXiv preprint arXiv:170708692. 2017;.</mixed-citation>
</ref>
<ref id="pcbi.1006388.ref042">
<label>42</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Boyd</surname> <given-names>SP</given-names></name>, <name name-style="western"><surname>Vandenberghe</surname> <given-names>L</given-names></name>. <source>Convex Optimization</source>. <publisher-name>Cambridge University Press</publisher-name>; <year>2004</year>.</mixed-citation>
</ref>
<ref id="pcbi.1006388.ref043">
<label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Byrd</surname> <given-names>RH</given-names></name>, <name name-style="western"><surname>Lu</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Nocedal</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Zhu</surname> <given-names>C</given-names></name>. <article-title>A limited memory algorithm for bound constrained optimization</article-title>. <source>SIAM Journal on Scientific Computing</source>. <year>1995</year>;<volume>16</volume>(<issue>5</issue>):<fpage>1190</fpage>–<lpage>1208</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1137/0916069" xlink:type="simple">10.1137/0916069</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006388.ref044">
<label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tomlinson</surname> <given-names>IM</given-names></name>, <name name-style="western"><surname>Cox</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Gherardi</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Lesk</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Chothia</surname> <given-names>C</given-names></name>. <article-title>The structural repertoire of the human V kappa domain</article-title>. <source>The EMBO journal</source>. <year>1995</year>;<volume>14</volume>(<issue>18</issue>):<fpage>4628</fpage>–<lpage>4638</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/j.1460-2075.1995.tb00142.x" xlink:type="simple">10.1002/j.1460-2075.1995.tb00142.x</ext-link></comment> <object-id pub-id-type="pmid">7556106</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006388.ref045">
<label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Breden</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Luning</surname> <given-names>EP</given-names></name>, <name name-style="western"><surname>Peters</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Rubelt</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Schramm</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Busse</surname> <given-names>C</given-names></name>, <etal>et al</etal>. <article-title>Reproducibility and Reuse of Adaptive Immune Receptor Repertoire Data</article-title>. <source>Frontiers in Immunology</source>. <year>2017</year>;<volume>8</volume>:<fpage>1418</fpage>–<lpage>1418</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3389/fimmu.2017.01418" xlink:type="simple">10.3389/fimmu.2017.01418</ext-link></comment> <object-id pub-id-type="pmid">29163494</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006388.ref046">
<label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rubelt</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Busse</surname> <given-names>CE</given-names></name>, <name name-style="western"><surname>Bukhari</surname> <given-names>SAC</given-names></name>, <name name-style="western"><surname>Bürckert</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Mariotti-Ferrandiz</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Cowell</surname> <given-names>LG</given-names></name>, <etal>et al</etal>. <article-title>Adaptive Immune Receptor Repertoire Community recommendations for sharing immune-repertoire sequencing data</article-title>. <source>Nature Immunology</source>. <year>2017</year>;<volume>18</volume>(<issue>12</issue>):<fpage>1274</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ni.3873" xlink:type="simple">10.1038/ni.3873</ext-link></comment> <object-id pub-id-type="pmid">29144493</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006388.ref047">
<label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Jones</surname> <given-names>DT</given-names></name>, <name name-style="western"><surname>Buchan</surname> <given-names>DW</given-names></name>, <name name-style="western"><surname>Cozzetto</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Pontil</surname> <given-names>M</given-names></name>. <article-title>PSICOV: precise structural contact prediction using sparse inverse covariance estimation on large multiple sequence alignments</article-title>. <source>Bioinformatics</source>. <year>2011</year>;<volume>28</volume>(<issue>2</issue>):<fpage>184</fpage>–<lpage>190</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btr638" xlink:type="simple">10.1093/bioinformatics/btr638</ext-link></comment> <object-id pub-id-type="pmid">22101153</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006388.ref048">
<label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ekeberg</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Lövkvist</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Lan</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Weigt</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Aurell</surname> <given-names>E</given-names></name>. <article-title>Improved contact prediction in proteins: using pseudolikelihoods to infer Potts models</article-title>. <source>Physical Review E</source>. <year>2013</year>;<volume>87</volume>(<issue>1</issue>):<fpage>012707</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1103/PhysRevE.87.012707" xlink:type="simple">10.1103/PhysRevE.87.012707</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006388.ref049">
<label>49</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wang</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Smith</surname> <given-names>WF</given-names></name>, <name name-style="western"><surname>Miller</surname> <given-names>BR</given-names></name>, <name name-style="western"><surname>Aivazian</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Lugovskoy</surname> <given-names>AA</given-names></name>, <name name-style="western"><surname>Reff</surname> <given-names>ME</given-names></name>, <etal>et al</etal>. <article-title>Conserved amino acid networks involved in antibody variable domain interactions</article-title>. <source>Proteins: Structure, Function, and Bioinformatics</source>. <year>2009</year>;<volume>76</volume>(<issue>1</issue>):<fpage>99</fpage>–<lpage>114</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/prot.22319" xlink:type="simple">10.1002/prot.22319</ext-link></comment></mixed-citation>
</ref>
</ref-list>
</back>
</article>