<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-18-00366</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1006283</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Neurons</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cellular neuroscience</subject><subj-group><subject>Neurons</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Membrane potential</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Membrane potential</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Engineering and technology</subject><subj-group><subject>Signal processing</subject><subj-group><subject>Modulation</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Engineering and technology</subject><subj-group><subject>Signal processing</subject><subj-group><subject>Jitter</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Engineering and technology</subject><subj-group><subject>Signal processing</subject><subj-group><subject>Signal to noise ratio</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Probability theory</subject><subj-group><subject>Probability distribution</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Applied mathematics</subject><subj-group><subject>Algorithms</subject><subj-group><subject>Clustering algorithms</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject><subj-group><subject>Algorithms</subject><subj-group><subject>Clustering algorithms</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Organisms</subject><subj-group><subject>Eukaryota</subject><subj-group><subject>Animals</subject><subj-group><subject>Vertebrates</subject><subj-group><subject>Amniotes</subject><subj-group><subject>Mammals</subject><subj-group><subject>Primates</subject><subj-group><subject>Monkeys</subject><subj-group><subject>Old World monkeys</subject><subj-group><subject>Macaque</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Unsupervised clustering of temporal patterns in high-dimensional neuronal ensembles using a novel dissimilarity measure</article-title>
<alt-title alt-title-type="running-head">Unsupervised clustering of temporal spiking patterns</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Grossberger</surname> <given-names>Lukas</given-names></name>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" equal-contrib="yes" xlink:type="simple">
<name name-style="western">
<surname>Battaglia</surname> <given-names>Francesco P.</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" equal-contrib="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-4044-0970</contrib-id>
<name name-style="western">
<surname>Vinck</surname> <given-names>Martin</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Donders Institute for Brain, Cognition and Behaviour, Radboud Universiteit, Nijmegen, the Netherlands</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Ernst Strüngmann Institute for Neuroscience in cooperation with Max Planck Society, Frankfurt am Main, Germany</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Diedrichsen</surname> <given-names>Jörn</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Western University, CANADA</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">martin.vinck@esi-frankfurt.de</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>7</month>
<year>2018</year>
</pub-date>
<pub-date pub-type="epub">
<day>6</day>
<month>7</month>
<year>2018</year>
</pub-date>
<volume>14</volume>
<issue>7</issue>
<elocation-id>e1006283</elocation-id>
<history>
<date date-type="received">
<day>8</day>
<month>3</month>
<year>2018</year>
</date>
<date date-type="accepted">
<day>8</day>
<month>6</month>
<year>2018</year>
</date>
</history>
<permissions>
<copyright-year>2018</copyright-year>
<copyright-holder>Grossberger et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1006283"/>
<abstract>
<p>Temporally ordered multi-neuron patterns likely encode information in the brain. We introduce an unsupervised method, SPOTDisClust (Spike Pattern Optimal Transport Dissimilarity Clustering), for their detection from high-dimensional neural ensembles. SPOTDisClust measures similarity between two ensemble spike patterns by determining the minimum transport cost of transforming their corresponding normalized cross-correlation matrices into each other (SPOTDis). Then, it performs density-based clustering based on the resulting inter-pattern dissimilarity matrix. SPOTDisClust does not require binning and can detect complex patterns (beyond sequential activation) even when high levels of out-of-pattern “noise” spiking are present. Our method handles efficiently the additional information from increasingly large neuronal ensembles and can detect a number of patterns that far exceeds the number of recorded neurons. In an application to neural ensemble data from macaque monkey V1 cortex, SPOTDisClust can identify different moving stimulus directions on the sole basis of temporal spiking patterns.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>The brain encodes information by ensembles of neurons, and recent technological developments allow researchers to simultaneously record from over thousands of neurons. Neurons exhibit spontaneous activity patterns, which are constrained by experience and development, limiting the portion of state space that is effectively visited. Patterns of spontaneous activity may contribute to shaping the synaptic connectivity matrix and contribute to memory consolidation, and synaptic plasticity formation depends crucially on the temporal spiking order among neurons. Hence, the unsupervised detection of spike sequences is a sine qua non for understanding how spontaneous activity contributes to memory formation. Yet, sequence detection presents major methodological challenges like the sparsity and stochasticity of neuronal output, and its high dimensionality. We propose a dissimilarity measure between neuronal patterns based on optimal transport theory, determining their similarity from the pairwise cross-correlation matrix, which can be taken as a proxy of the “trace” that is left on the synaptic matrix. We then perform unsupervised clustering and visualization of patterns using density clustering on the dissimilarity matrix and low-dimensional embedding techniques. This method does not require binning of spike times, is robust to noise, jitter and rate fluctuations, and can detect more patterns than the number of neurons.</p>
</abstract>
<funding-group>
<funding-statement>Francesco Battaglia was financially supported by the European Union FP7 Project 600925 "Neuroseeker’’ (<ext-link ext-link-type="uri" xlink:href="http://www.neuroseeker.eu/" xlink:type="simple">http://www.neuroseeker.eu/</ext-link>). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="8"/>
<table-count count="0"/>
<page-count count="34"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2018-07-18</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant data are within the paper and its Supporting Information files.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<disp-quote><p>This is a <italic>PLOS Computational Biology</italic> Methods paper.</p></disp-quote>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Precisely timed spike patterns spanning multiple neurons are a ubiquitous feature of both spontaneous and stimulus-evoked brain network activity. Remarkably, not all patterns are generated with equal probability. Synaptic connectivity, shaped by development and experience, favors certain spike sequences over others, limiting the portion of the network’s “state space” that is effectively visited [<xref ref-type="bibr" rid="pcbi.1006283.ref001">1</xref>, <xref ref-type="bibr" rid="pcbi.1006283.ref002">2</xref>]. The structure of this permissible state space is of the greatest interest for our understanding of neural network function. Multi-neuron temporal sequences encode information about stimulus variables [<xref ref-type="bibr" rid="pcbi.1006283.ref003">3</xref>–<xref ref-type="bibr" rid="pcbi.1006283.ref008">8</xref>], in some cases “unrolling” non-temporally organized stimuli, such as odors, into temporal sequences [<xref ref-type="bibr" rid="pcbi.1006283.ref009">9</xref>]. Recurrent neuronal networks can generate precise temporal sequences [<xref ref-type="bibr" rid="pcbi.1006283.ref010">10</xref>–<xref ref-type="bibr" rid="pcbi.1006283.ref014">14</xref>], which are required for example for the generation of complex vocalization patterns like bird songs [<xref ref-type="bibr" rid="pcbi.1006283.ref015">15</xref>]. Temporal spiking patterns may also encode sequences of occurrences or actions, as they take place, or are planned, projected, or “replayed” for memory consolidation in the hippocampus and other structures [<xref ref-type="bibr" rid="pcbi.1006283.ref016">16</xref>–<xref ref-type="bibr" rid="pcbi.1006283.ref025">25</xref>].</p>
<p>Timing information between spikes of different neurons is critical for memory function, as it regulates spike timing dependent plasticity (STDP) of synapses, with firing of a post-synaptic neuron following the firing of a pre-synaptic neuron typically inducing synaptic potentiation, and firing in the reverse order typically inducing depotentiation [<xref ref-type="bibr" rid="pcbi.1006283.ref026">26</xref>–<xref ref-type="bibr" rid="pcbi.1006283.ref028">28</xref>]. Thus, the consolidation of memories may rely on recurring temporal patterns of neural activity, which stabilize and modify the synaptic connections among neurons [<xref ref-type="bibr" rid="pcbi.1006283.ref016">16</xref>–<xref ref-type="bibr" rid="pcbi.1006283.ref022">22</xref>, <xref ref-type="bibr" rid="pcbi.1006283.ref029">29</xref>–<xref ref-type="bibr" rid="pcbi.1006283.ref035">35</xref>]. Storing memories as sequences has the advantage that a very large number of patterns is possible, because the number of possible spike orderings grows exponentially, and different sequences can efficiently be associated to different memory items, as proposed by for instance the reservoir computing theory [<xref ref-type="bibr" rid="pcbi.1006283.ref036">36</xref>–<xref ref-type="bibr" rid="pcbi.1006283.ref040">40</xref>].</p>
<p>Detecting these temporal patterns represents a major methodological challenge. With recent advances in neuro-technology, it is now possible to record from thousands of neurons simultaneously [<xref ref-type="bibr" rid="pcbi.1006283.ref041">41</xref>], and this number is expected to show an exponential growth in the coming years [<xref ref-type="bibr" rid="pcbi.1006283.ref042">42</xref>]. The high dimensionality of population activity, combined with the sparsity and stochasticity of neuronal output, as well as the limited amount of time one can record from a given neuron, makes the detection of recurring temporal sequences an extremely difficult computational problem. Many approaches to this problem are supervised, that is, they take patterns occurring concurrently with a known event, such as the delivery of a stimulus for sensory neurons or the traversal of a running track for hippocampal place fields, as a “template” and then search for repetitions of the same template in spiking activity [<xref ref-type="bibr" rid="pcbi.1006283.ref020">20</xref>, <xref ref-type="bibr" rid="pcbi.1006283.ref043">43</xref>, <xref ref-type="bibr" rid="pcbi.1006283.ref044">44</xref>]. Other approaches construct a template by measuring latencies of each neuron’s spiking from a known event, such as the beginning of a cortical UP state [<xref ref-type="bibr" rid="pcbi.1006283.ref005">5</xref>, <xref ref-type="bibr" rid="pcbi.1006283.ref045">45</xref>]. While this enables rigorous, relatively easy statistical treatment, it risks neglecting much of the structure in the spiking data, which may contain representations of other items (e.g. remote memories, presentations of different stimuli, etc.). A more complete picture of network activity may be provided by unsupervised methods, detecting regularities, for example in the form of spiking patterns recurring more often than predicted by chance. Unsupervised methods proposed so far typically use linear approaches, such as Principal Component Analysis (PCA) [<xref ref-type="bibr" rid="pcbi.1006283.ref024">24</xref>, <xref ref-type="bibr" rid="pcbi.1006283.ref046">46</xref>, <xref ref-type="bibr" rid="pcbi.1006283.ref047">47</xref>], and cannot account for different patterns arising from permutations of spike orderings.</p>
<p>While approaches like frequent itemset mining and related methods [<xref ref-type="bibr" rid="pcbi.1006283.ref048">48</xref>–<xref ref-type="bibr" rid="pcbi.1006283.ref051">51</xref>] can find more patterns than the number of neurons and provide a rigorous statistical framework, they require that exact matches of the same pattern occur, which becomes less and less probable as the number of neurons grows or as the time bins become smaller (problem of combinatorial explosion). To address this problem, [<xref ref-type="bibr" rid="pcbi.1006283.ref052">52</xref>, <xref ref-type="bibr" rid="pcbi.1006283.ref053">53</xref>] proposed another promising unsupervised method based on spin glass Ising models that allows for approximate pattern matching while not being linearly limited in the number of patterns; this method however requires binning, and rather provides a method for classifying the binary network state vector in a small temporal neighborhood, while not dissociating rate patterns from temporal patterns.</p>
<p>In this paper we introduce a novel spike pattern detection method called SPOTDisClust (<xref ref-type="fig" rid="pcbi.1006283.g001">Fig 1</xref>). We start from the idea that the similarities of two neural patterns can be defined by the trace that they may leave on the synaptic matrix, which in turn is determined by the pairwise cross-correlations between neural activities [<xref ref-type="bibr" rid="pcbi.1006283.ref026">26</xref>, <xref ref-type="bibr" rid="pcbi.1006283.ref027">27</xref>]. The algorithm is based on constructing an epoch-to-epoch dissimilarity matrix, in which dissimilarity is defined as SPOTDis, making use of techniques from the mathematical theory of optimal transport to define, and efficiently compute, a dissimilarity between two spiking patterns [<xref ref-type="bibr" rid="pcbi.1006283.ref054">54</xref>–<xref ref-type="bibr" rid="pcbi.1006283.ref057">57</xref>]. We then perform unsupervised clustering on the pairwise SPOTDis matrix. SPOTDis measures the similarity of two spike patterns (in two different epochs) by determining the minimum transport cost of transforming their corresponding cross-correlation matrices into each other. This amounts to computing the Earth Mover’s Distance (EMD) for all pairs of neurons and all pairs of epochs (see <xref ref-type="sec" rid="sec013">Methods</xref>). Through ground-truth simulations, we show that SPOTDisClust has many desirable properties: It can detect many more patterns than the number of neurons (<xref ref-type="fig" rid="pcbi.1006283.g002">Fig 2</xref>); it can detect complex patterns that would be invisible with latency-based methods (Figs <xref ref-type="fig" rid="pcbi.1006283.g003">3</xref> and <xref ref-type="fig" rid="pcbi.1006283.g004">4</xref>); it is highly robust to noise, i.e. to the ‘insertion’ of noisy spikes, spike timing jitter, or fluctuations in the firing rate, and its performance grows with the inclusion of more neurons given a constant signal-to-noise ratio (<xref ref-type="fig" rid="pcbi.1006283.g005">Fig 5</xref>); it can detect sequences in the presence of sparse firing (<xref ref-type="fig" rid="pcbi.1006283.g006">Fig 6</xref>); and finally it is insensitive to a global or patterned scaling of the firing rates (<xref ref-type="fig" rid="pcbi.1006283.g007">Fig 7</xref>). We apply SPOTDisClust to V1 Utah array data from the awake macaque monkey, and identify different visual stimulus directions using unsupervised clustering with SPOTDisClust (<xref ref-type="fig" rid="pcbi.1006283.g008">Fig 8</xref>).</p>
<fig id="pcbi.1006283.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006283.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Simulated example illustrating the steps in SPOTDisClust.</title>
<p>A) Structure of five “ground-truth” patterns, affecting 50 neurons. λ<sub><italic>in</italic></sub> = 0.2 spks/sample, λ<sub><italic>out</italic></sub> = 0.02 spks/sample. <italic>T</italic><sub><italic>epoch</italic></sub> = 300 samples, <italic>T</italic><sub><italic>pulse</italic></sub> = 30 samples. For each pattern and each neuron, a random position was chosen for the activation pulse. B) Neuronal output is generated according to an inhomogeneous Poisson process, with rates dictated by the patterns in (A). A total of 300 epochs were simulated, out of which 150 epochs were noise patterns, and each of the 5 patterns contributed 30 epochs. C) Cross-correlation histograms, normalized to unit mass, are shown for a subset of neurons pairs, for three different epochs. Two epochs constitute realizations of the same pattern, and one epoch belongs to a different pattern. Shown is the EMD for each neuron pair, between the different epochs. These EMDs are then averaged across all neuron pairs to compute the SPOTDis. D) Illustration of the EMD for three different pairs of spike distributions. E) Left: the t-SNE projection with the ground-truth cluster labels shown. Middle: sorted dissimilarity (SPOTDis) matrix, with epochs sorted by the pattern they belong to (first 150 epochs are noise patterns). Right: reconstructed cluster average cross-correlations between neuron 1 and neurons 2-49 for pattern 2. Note the similarity between the structure of the reconstructed cross-correlation matrix and the structure of pattern 2.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006283.g001" xlink:type="simple"/>
</fig>
<fig id="pcbi.1006283.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006283.g002</object-id>
<label>Fig 2</label>
<caption>
<title>More patterns can be detected than the number of neurons with SPOTDisClust.</title>
<p>Left: Two realizations of two different patterns, for 50 neurons. Simulation parameters were λ<sub><italic>in</italic></sub> = 0.35 spks/sample, λ<sub><italic>out</italic></sub> = 0.05 spks/sample, <italic>T</italic><sub><italic>epoch</italic></sub> = 300 samples, <italic>T</italic><sub><italic>pulse</italic></sub> = 30 samples. For each pattern and each neuron, a random position was chosen for the activation pulse. Right: For 500 patterns, 30 realizations per pattern were generated, and 15000 noise epochs were added. t-SNE projection with HDBSCAN labels shows that our clustering method can retrieve all patterns from the data.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006283.g002" xlink:type="simple"/>
</fig>
<fig id="pcbi.1006283.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006283.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Bimodal activation and deactivation patterns can be detected using SPOTDisClust.</title>
<p>(A) Multiple bimodal activation patterns and examples of realizations for each pattern (<italic>N</italic> = 50 neurons). Simulation parameters were λ<sub><italic>in</italic></sub> = 0.35 spks/sample, λ<sub><italic>out</italic></sub> = 0.05 spks/sample, <italic>T</italic><sub><italic>epoch</italic></sub> = 300 and <italic>T</italic><sub><italic>pulse</italic></sub> = 20 samples. Bottom figures show sorted dissimilarity matrix and t-SNE for simulation with patterned noise (left) and homogeneous noise (right). (B) Multiple bimodal activation patterns and examples of realizations for each pattern (<italic>N</italic> = 50 neurons). Simulation parameters were λ<sub><italic>out</italic></sub> = 0.02 spks/sample (i.e. the deactivation period), λ<sub><italic>in</italic></sub> = 0.3 spks/sample, <italic>T</italic><sub><italic>epoch</italic></sub> = 300 and <italic>T</italic><sub><italic>deactivation</italic></sub> = 150 samples. Bottom figures show sorted dissimilarity matrix and t-SNE for simulation with patterned noise (left) and homogeneous noise (right).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006283.g003" xlink:type="simple"/>
</fig>
<fig id="pcbi.1006283.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006283.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Detection of other types of complex patterns using SPOTDisClust.</title>
<p>(A) Realizations of four different patterns, in which two patterns (1-2 and 3-4) have the same coarse structure, but a finer is structure embedded inside each coarse pattern. Simulation parameters were λ<sub><italic>in</italic>,<italic>coarse</italic></sub> = 0.2 spks/sample, λ<sub><italic>in</italic>,<italic>fine</italic></sub> = 0.8 spks/sample, λ<sub><italic>out</italic></sub> = 0.05 spks/sample <italic>T</italic><sub><italic>epoch</italic></sub> = 300, <italic>T</italic><sub><italic>pulse</italic>,<italic>coarse</italic></sub> = 90 samples, <italic>T</italic><sub><italic>pulse</italic>,<italic>fine</italic></sub> = 30 samples. Panels on bottom show sorted dissimilarity matrix and t-SNE for simulations with patterned noise (left) and homogeneous noise (right). (B) Realizations of multiple patterns, in which different random subsets of neurons become simultaneously active, leading to a synchronous firing without temporal order. Simulation parameters were λ<sub><italic>in</italic></sub> = 0.4 spks/sample, λ<sub><italic>out</italic></sub> = 0.05 spks/sample, <italic>T</italic><sub><italic>epoch</italic></sub> = 300, <italic>T</italic><sub><italic>pulse</italic></sub> = 50 samples.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006283.g004" xlink:type="simple"/>
</fig>
<fig id="pcbi.1006283.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006283.g005</object-id>
<label>Fig 5</label>
<caption>
<title>SPOTDisClust’s dependence on the signal to noise ratio.</title>
<p>(A) Example of 5 patterns with a low SNR with <italic>N</italic> = 100 neurons and 40 repetitions per pattern, together with 200 noise epochs (homogeneous noise). The order of the spike train realizations is Pattern 1, 2, homogeneous noise, 2, 1 and 3. Simulation parameters were λ<sub><italic>in</italic></sub> = 0.3 spks/sample, λ<sub><italic>out</italic></sub> = 0.1 spks/sample, <italic>T</italic><sub><italic>epoch</italic></sub> = 300 samples, <italic>T</italic><sub><italic>pulse</italic></sub> = 30 samples. Shown in bottom panels are sorted dissimilarity matrix (left), t-SNE embedding (ground-truth cluster labels), and t-SNE embedding with cluster labels assigned by HDBSCAN. (B) Performance of SPOTDis depends on the SNR. Left: Firing rate inside pulse period is varied, while firing rate outside pulse was varied. We simulated 5 patterns with 30 repetitions each, with λ<sub><italic>out</italic></sub> = 0.05 spks/sample, and λ<sub><italic>in</italic></sub> attaining values of 0.15, 0.2, 0.25, 0.35, 0.45 or 0.5 spks/sample, <italic>T</italic><sub><italic>pulse</italic></sub> = 30 and <italic>T</italic><sub><italic>epoch</italic></sub> = 1000 samples. The number of neurons was 25, 50 or 100. In addition 150 epochs of homogeneous noise were included. We show the mean and the standard deviation across 10 repetitions of the same simulation. Performance relative to ground truth (measured with ARI; see <xref ref-type="sec" rid="sec013">Methods</xref>) increases with SNR. Lower SNRs are needed for achieving same performance when the number of neurons is larger. Right: as left, but now varying the pulse duration. Simulation parameters were λ<sub><italic>out</italic></sub> = 0.05 spks/sample, and λ<sub><italic>in</italic></sub> = 0.5, 0.4, 0.3, 0.2, 0.1 spks/sample, and <italic>T</italic><sub><italic>pulse</italic></sub> of 100, 200, 300, 400 or 500 samples, with <italic>T</italic><sub><italic>epoch</italic></sub> = 1000 samples; note that the product of λ<sub><italic>in</italic></sub> <italic>T</italic><sub><italic>pulse</italic></sub> remained constant.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006283.g005" xlink:type="simple"/>
</fig>
<fig id="pcbi.1006283.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006283.g006</object-id>
<label>Fig 6</label>
<caption>
<title>SPOTDisClust can detect temporal patterns expressed in ensembles of sparsely firing neurons.</title>
<p>Example of 5 patterns with sparse firing. Simulation parameters were λ<sub><italic>in</italic></sub> = 0.015 spks/sample, λ<sub><italic>out</italic></sub> = 0.0001 spks/sample, <italic>T</italic><sub><italic>epoch</italic></sub> = 300 samples, <italic>T</italic><sub><italic>pulse</italic></sub> = 30 samples. For each pattern, two spike realizations are shown. Bottom panels show sorted dissimilarity matrix and t-SNE with ground-truth cluster labels (left) and HDBSCAN cluster labels (right).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006283.g006" xlink:type="simple"/>
</fig>
<fig id="pcbi.1006283.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006283.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Scaling of the rate either globally or in a subset of neurons does not interfere with the detection of temporal patterns.</title>
<p>A) Shown are two different temporal patterns. Each temporal pattern can occur in a low (λ<sub><italic>in</italic></sub> = 0.2 and λ<sub><italic>out</italic></sub> = 0.02 spks/sample), medium (λ<sub><italic>in</italic></sub> = 0.4 and λ<sub><italic>out</italic></sub> = 0.04 spks/sample) or high rate (λ<sub><italic>in</italic></sub> = 0.7 and λ<sub><italic>out</italic></sub> = 0.07 spks/sample) state, with a constant ratio of λ<sub><italic>in</italic></sub>/λ<sub><italic>out</italic></sub>. In addition, the noise pattern can also occur in one of three rate states. The pulse duration was 30 samples. Shown at the bottom the sorted dissimilarity matrix with SPOTDis values, the t-SNE embedding with the ground-truth cluster labels and the t-SNE embedding with the HDBSCAN cluster labels. B) Shown are two temporal patterns. Each temporal pattern could occur in one of two rates states: In the first rate state, the first 25 neurons are firing at low rate (λ<sub><italic>in</italic></sub> = 0.3 and λ<sub><italic>out</italic></sub> = 0.03 spks/sample), and the other 25 are firing at a high rate (λ<sub><italic>in</italic></sub> = 0.7 and λ<sub><italic>out</italic></sub> = 0.07 spks/sample). In the second rate state, the rate scaling is reversed. The pulse duration was 30 samples. Shown at the bottom the sorted dissimilarity matrix with SPOTDis values, the t-SNE embedding with the ground-truth cluster labels and the t-SNE embedding with the HDBSCAN cluster labels.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006283.g007" xlink:type="simple"/>
</fig>
<fig id="pcbi.1006283.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006283.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Application to neuronal data.</title>
<p>Top: shown are the average peri-stimulus histograms for four moving bar stimuli spanning the four cardinal directions. Middle: multi-unit spike train realizations for each of the four conditions. Bottom: sorted dissimilarity matrix, t-SNE with ground-truth labels, and t-SNE with HDBSCAN cluster labels.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006283.g008" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<sec id="sec003">
<title>Outline of the algorithm</title>
<p>Suppose we perform spiking measurements from an ensemble of <italic>N</italic> neurons, and we observe the spiking output of this ensemble in <italic>M</italic> separate epochs of length <italic>T</italic> samples (in units of the time bin length). Suppose that there are <italic>P</italic> distinct activity patterns that tend to reoccur in some of the <italic>M</italic> epochs. Each pattern generates a set of normalized (to unit mass) cross-correlation histograms among all neurons. Instantiations of the same pattern are different because of noise, but will have the same expectation for the cross-correlation histogram. The normalized cross-correlation histogram is defined as
<disp-formula id="pcbi.1006283.e001"><alternatives><graphic id="pcbi.1006283.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e001" xlink:type="simple"/><mml:math display="block" id="M1"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≡</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>s</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>τ</mml:mi> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mi>T</mml:mi></mml:mrow> <mml:mi>T</mml:mi></mml:msubsup> <mml:msub><mml:mi>s</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula>
if <inline-formula id="pcbi.1006283.e002"><alternatives><graphic id="pcbi.1006283.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>τ</mml:mi> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mi>T</mml:mi></mml:mrow> <mml:mi>T</mml:mi></mml:msubsup> <mml:msub><mml:mi>s</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>&gt;</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, and <inline-formula id="pcbi.1006283.e003"><alternatives><graphic id="pcbi.1006283.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> otherwise. Here, <italic>s</italic><sub><italic>ij</italic></sub>(<italic>τ</italic>) ≡ ∑<sub><italic>t</italic></sub> <italic>s</italic><sub><italic>i</italic></sub>(<italic>t</italic>)<italic>s</italic><sub><italic>j</italic></sub>(<italic>t</italic> + <italic>τ</italic>) is the cross-correlation function (or cross-covariance), and <italic>s</italic><sub><italic>i</italic></sub>(<italic>t</italic>) and <italic>s</italic><sub><italic>j</italic></sub>(<italic>t</italic>) are the spike trains of neurons <italic>i</italic> and <italic>j</italic>. In other words, the normalized cross-correlation histogram is simply the histogram of coincidence counts at different delays <italic>τ</italic>, normalized to unit mass. We take the <italic>N</italic> × <italic>N</italic> × (2<italic>T</italic> + 1) matrix of <inline-formula id="pcbi.1006283.e004"><alternatives><graphic id="pcbi.1006283.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> values as a full representation of a pattern, that is, we consider two patterns to have the same temporal structure when all neuron pairs have the same expected value of <inline-formula id="pcbi.1006283.e005"><alternatives><graphic id="pcbi.1006283.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> for each <italic>τ</italic>. For simplicity and clarity of presentation, we have written the cross-correlation function as a discrete (histogram) function of time. However, because the SPOTDis, which is introduced below, is a cross-bins dissimilarity measure and requires only to store the precise delays <italic>τ</italic> at which <inline-formula id="pcbi.1006283.e006"><alternatives><graphic id="pcbi.1006283.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is non-zero, the sampling rate can be made infinitely large (see <xref ref-type="sec" rid="sec013">Methods</xref>). In other words, the SPOTDis computation does not entail any loss of timing precision beyond the sampling rate at which the spikes are recorded.</p>
<p>The SPOTDisClust method contains two steps (<xref ref-type="fig" rid="pcbi.1006283.g001">Fig 1</xref>), which are illustrated for five example patterns (<xref ref-type="fig" rid="pcbi.1006283.g001">Fig 1A and 1B</xref>). The first step is to construct the SPOTDis dissimilarity measure between all pairs of epochs on the matrix of cross-correlations among all neuron pairs. The second step is to perform clustering on the SPOTDis dissimilarity measure using an unsupervised clustering algorithm that operates on a dissimilarity matrix. Many algorithms are available for unsupervised clustering on pairwise dissimilarity matrices. One family of unsupervised clustering methods comprises so called density clustering algorithms, including DBSCAN, HDBSCAN or density peak clustering. Here, we use the HDBSCAN unsupervised clustering method [<xref ref-type="bibr" rid="pcbi.1006283.ref058">58</xref>–<xref ref-type="bibr" rid="pcbi.1006283.ref061">61</xref>] (see <xref ref-type="sec" rid="sec013">Methods</xref>). To examine the separability of the clusters in a low dimensional 2-D embedding, we employ the t-SNE projection method [<xref ref-type="bibr" rid="pcbi.1006283.ref062">62</xref>, <xref ref-type="bibr" rid="pcbi.1006283.ref063">63</xref>] (see <xref ref-type="sec" rid="sec013">Methods</xref>).</p>
<p>The SPOTDis measure is constructed as follows:</p>
<list list-type="order">
<list-item>
<p>We compute, for each of the <italic>M</italic> epochs separately, the cross-correlation function for all pairs of <italic>N</italic> neurons (see <xref ref-type="sec" rid="sec013">Methods</xref>), which yields <italic>M</italic> matrices of <italic>N</italic>(<italic>N</italic> − 1)/2 cross-correlations <inline-formula id="pcbi.1006283.e007"><alternatives><graphic id="pcbi.1006283.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> (<xref ref-type="fig" rid="pcbi.1006283.g001">Fig 1C</xref> and <xref ref-type="supplementary-material" rid="pcbi.1006283.s001">S1 Fig</xref>).</p>
</list-item>
<list-item>
<p>For each pair of epochs <italic>k</italic> and <italic>m</italic> and each pair of neurons <italic>i</italic> and <italic>j</italic>, we now want to quantify how similar the temporal correlation of neuron <italic>i</italic> and <italic>j</italic> was between epochs <italic>k</italic> and <italic>m</italic>, i.e. the similarity of <inline-formula id="pcbi.1006283.e008"><alternatives><graphic id="pcbi.1006283.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e008" xlink:type="simple"/><mml:math display="inline" id="M8"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006283.e009"><alternatives><graphic id="pcbi.1006283.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi>m</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. To this end, we compute the Earth Mover’s Distance (EMD) between the normalized cross-correlations of each neuron pair, which yields <italic>M</italic>(<italic>M</italic> − 1)/2 × <italic>N</italic>(<italic>N</italic> − 1)/2 EMD values <italic>D</italic><sub><italic>ij</italic>,<italic>km</italic></sub> (see <xref ref-type="sec" rid="sec013">Methods</xref> and <xref ref-type="fig" rid="pcbi.1006283.g001">Fig 1C and 1D</xref>, <xref ref-type="supplementary-material" rid="pcbi.1006283.s001">S1</xref> and <xref ref-type="supplementary-material" rid="pcbi.1006283.s002">S2</xref> Figs). We use the L1 norm to measure dissimilarity on the time axis, and we define the cost of transporting the mass in the cross-correlation function between time <italic>τ</italic><sub>1</sub> and <italic>τ</italic><sub>2</sub> as |<italic>τ</italic><sub>1</sub> − <italic>τ</italic><sub>2</sub>|/(2<italic>T</italic> + 1), such that the minimum and maximum EMDs are 0 and 1, respectively. The EMD is a metric distance function on probability distributions that determines the minimum transport cost to transform one unit distribution of mass into another unit distribution of mass (<xref ref-type="fig" rid="pcbi.1006283.g001">Fig 1D</xref>). In this case, the mass is the normalized (to a mass of 1) cross-correlation function for a neuron pair.</p>
<p>The advantage of using the EMD is multi-fold. First, it is a symmetric and metric measure of similarity between two probability distributions (as opposed to e.g. the Kullback-Leibler divergence). Second, as it is a “cross-bins” distance, it can handle jitter in spike timing. In other words, it quantifies not only whether two distributions are overlapping, like the Kullback-Leibler divergence, but also how far they are shifted away, as minimum transport cost, from each other in a metric space (in this case: time). Third, it does not rely on the computation of a measure of central tendency like the center of mass or peak of the probability distribution, but can also compute transport cost between multimodal probability distributions (<xref ref-type="fig" rid="pcbi.1006283.g001">Fig 1D</xref>). It can therefore capture differences between complex patterns (see Figs <xref ref-type="fig" rid="pcbi.1006283.g003">3</xref> and <xref ref-type="fig" rid="pcbi.1006283.g004">4</xref>). Fourth, because our computation of the EMD uses only the exact pairwise delays among pairs of spikes as its input (the computation thus scales with the number of spikes, not bins; see <xref ref-type="sec" rid="sec013">Methods</xref>), our implementation does not require any binning or smoothing of the spike trains beyond the sampling rate at which the spikes are recorded, preventing any additional loss in timing precision; this means that the bins can be made infinitely small (see <xref ref-type="sec" rid="sec013">Methods</xref>).</p>
</list-item>
<list-item>
<p>After computing the EMDs between each pair of epochs for each neuron pair separately, we compute SPOTDis as the average EMD across neuron pairs,
<disp-formula id="pcbi.1006283.e010"><alternatives><graphic id="pcbi.1006283.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e010" xlink:type="simple"/><mml:math display="block" id="M10"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>D</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>m</mml:mi></mml:mrow></mml:msub> <mml:mo>≡</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>&gt;</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mi>N</mml:mi></mml:msubsup> <mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi> <mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>&gt;</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mi>N</mml:mi></mml:munderover> <mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi> <mml:mi>m</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>D</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi> <mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2)</label></disp-formula>
(see <xref ref-type="sec" rid="sec013">Methods</xref>) (<xref ref-type="fig" rid="pcbi.1006283.g001">Fig 1C</xref>). Here, the weights are defined as
<disp-formula id="pcbi.1006283.e011"><alternatives><graphic id="pcbi.1006283.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e011" xlink:type="simple"/><mml:math display="block" id="M11"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi> <mml:mi>m</mml:mi></mml:mrow></mml:msub> <mml:mo>≡</mml:mo> <mml:mtext>sgn</mml:mtext> <mml:mo>(</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>τ</mml:mi></mml:munder> <mml:msubsup><mml:mi>s</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo> <mml:mtext>sgn</mml:mtext> <mml:mo>(</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>τ</mml:mi></mml:munder> <mml:msubsup><mml:mi>s</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi>m</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo> <mml:mspace width="0.166667em"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(3)</label></disp-formula>
where sgn(<italic>x</italic>) is the sign function, with sgn(<italic>x</italic>) = 0 for <italic>x</italic> = 0 and sgn(<italic>x</italic>) = 1 for <italic>x</italic> &gt; 0. Thus, only for neuron pairs for which both neuron <italic>i</italic> and neuron <italic>j</italic> fired in both epochs <italic>k</italic> and <italic>m</italic> will the weight <italic>w</italic><sub><italic>ij</italic>,<italic>km</italic></sub> = 1. The rationale behind ignoring the other neuron pairs for computing the SPOTDis is that it avoids assigning an arbitrary value to the EMD in the case where we have no information about the temporal relationship between the neurons (i.e. where we do not have any spikes for one neuron in one epoch). We assume for now, that for all (<italic>k</italic>, <italic>m</italic>), <inline-formula id="pcbi.1006283.e012"><alternatives><graphic id="pcbi.1006283.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e012" xlink:type="simple"/><mml:math display="inline" id="M12"><mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>&gt;</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mi>N</mml:mi></mml:msubsup> <mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi> <mml:mi>m</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo> <mml:mo>&gt;</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, i.e. that for each pair of epochs <italic>k</italic> and <italic>m</italic>, there is at least one pair of neurons in which both neurons fired in both epochs <italic>k</italic> and <italic>m</italic>. If all the weights equal 1, then we can simplify to
<disp-formula id="pcbi.1006283.e013"><alternatives><graphic id="pcbi.1006283.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e013" xlink:type="simple"/><mml:math display="block" id="M13"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>D</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>m</mml:mi></mml:mrow></mml:msub> <mml:mo>≡</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mi>N</mml:mi> <mml:mo>(</mml:mo> <mml:mi>N</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:mfrac> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>&gt;</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mi>N</mml:mi></mml:munderover> <mml:msub><mml:mi>D</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi> <mml:mi>m</mml:mi></mml:mrow></mml:msub> <mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(4)</label></disp-formula>
From <xref ref-type="disp-formula" rid="pcbi.1006283.e010">Eq (2)</xref> we obtain <italic>M</italic>(<italic>M</italic> − 1)/2 SPOTDis values <inline-formula id="pcbi.1006283.e014"><alternatives><graphic id="pcbi.1006283.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e014" xlink:type="simple"/><mml:math display="inline" id="M14"><mml:msub><mml:mover accent="true"><mml:mi>D</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> (<xref ref-type="fig" rid="pcbi.1006283.g001">Fig 1E</xref>). These values are then the input to the HDBSCAN clustering algorithm and the t-SNE visualization (<xref ref-type="fig" rid="pcbi.1006283.g001">Fig 1E</xref>) (see <xref ref-type="sec" rid="sec013">Methods</xref>).</p>
</list-item>
</list>
</sec>
<sec id="sec004">
<title>Ground truth simulations</title>
<p>To test the SPOTDisClust method for cases in which the ground truth is known, we generated <italic>P</italic> input patterns in epochs of length <italic>T</italic> = <italic>T</italic><sub><italic>epoch</italic></sub> = 300 samples, defined by the instantaneous rate of inhomogeneous Poisson processes, and then generated spiking outputs according to these (<xref ref-type="fig" rid="pcbi.1006283.g001">Fig 1A and 1B</xref>) (see <xref ref-type="sec" rid="sec013">Methods</xref>). Because the SPOTDis is a binless measure, in the sense that it does not require any binning beyond the sampling frequency, the epochs could for example represent spike series of 3s with a sampling rate of 100Hz, or spike series of 300ms with a sampling rate of 1000Hz. Each input pattern was constructed such that it had a baseline firing rate and a pulse activation firing rate, defined as the expected number of spikes per sample. The pulse activation period (with duration <italic>T</italic><sub><italic>pulse</italic></sub> samples) is the period in the epoch in which the neuron is more active than during the baseline, and the positions of the pulses across neurons define the pattern. For each neuron and pattern, the position of the pulse activation period was randomly chosen. We generated <italic>M</italic>/(2 * <italic>P</italic>) realizations for each of the <italic>P</italic> patterns, and a matching number of <italic>M</italic>/2 noise epochs (i.e. 50 percent of epochs were noise epochs). We performed simulations for two types of noise epochs (<xref ref-type="supplementary-material" rid="pcbi.1006283.s003">S3 Fig</xref>). First, noise was generated with random firing according to a homogeneous Poisson process with a constant rate (see <xref ref-type="fig" rid="pcbi.1006283.g001">Fig 1</xref>). We refer to this noise, throughout the text, as “homogeneous noise”. For the second type of noise, each noise epoch comprised a single instantiation of a unique pattern, with randomly chosen positions of the pulse activation periods. We refer to this noise as “patterned noise”. For both types of noise patterns, the expected number of spikes in the noise epoch was the same as during an epoch in which one of the <italic>P</italic> patterns was realized. The second type of noise also had the same inter spike interval statistics for each neuron as the patterns. Importantly, because SPOTDisClust uses only the relative timing of spiking among neurons, rather than the timing of spiking relative to the epoch onset, the exact onset of the epoch does not have to be known with SPOTDis; even though the exact onset of the pattern is known in the simulations presented here, this knowledge was not used in any way for the clustering.</p>
<p>
<xref ref-type="fig" rid="pcbi.1006283.g001">Fig 1</xref> illustrates the different steps of the algorithm for an example of <italic>P</italic> = 5 patterns. For the purpose of illustration, we start with an example comprising five patterns that are relatively easy to spot by eye; later in the manuscript we show examples with a very low signal-to-noise ratio (<xref ref-type="fig" rid="pcbi.1006283.g005">Fig 5</xref>) or sparse firing (<xref ref-type="fig" rid="pcbi.1006283.g006">Fig 6</xref>). We find that in the 2-D t-SNE embedding, the <italic>P</italic> = 5 different patterns form separate clusters (<xref ref-type="fig" rid="pcbi.1006283.g001">Fig 1E</xref>), and that the HDBSCAN algorithm is able to correctly identify the separate clusters (<xref ref-type="supplementary-material" rid="pcbi.1006283.s004">S4 Fig</xref>). We also show a simulation with many more noise epochs than cluster epochs, which shows that even in such a case t-SNE embedding is able to separate the different clusters (<xref ref-type="supplementary-material" rid="pcbi.1006283.s005">S5 Fig</xref>). In <xref ref-type="supplementary-material" rid="pcbi.1006283.s003">S3 Fig</xref> we compare clustering with homogeneous and patterned noise. The homogeneous noise patterns have a consistently small SPOTDis dissimilarity to each other and are detected as a separate cluster, while the patterned noise epochs have large SPOTDis dissimilarities to each other and do not form a separate cluster, but spread out rather uniformly through the low-dimensional t-SNE embedding (<xref ref-type="supplementary-material" rid="pcbi.1006283.s003">S3 Fig</xref>).</p>
</sec>
<sec id="sec005">
<title>Detectable patterns outnumber recorded neurons</title>
<p>A key challenge for any pattern detection algorithm is to find a larger number of patterns than the number of measurement variables, assuming that each pattern is observed several times. This is impossible to achieve with traditional linear methods like PCA (Principal Component Analysis), which do not yield more components than the number of neurons (or channels), although decomposition techniques using overcomplete base sets might in principle be able to do so. Other approaches like frequent itemset mining and related methods [<xref ref-type="bibr" rid="pcbi.1006283.ref048">48</xref>–<xref ref-type="bibr" rid="pcbi.1006283.ref050">50</xref>] require that exact matches of the same pattern occur.</p>
<p>Because SPOTDisClust clusters patterns based on small SPOTDis dissimilarities, it does not require exact matches of the same pattern to occur, but only that the different instantiations of the same pattern are similar enough to one another, i.e. have SPOTDis values that are small enough, and separate them from other clusters and the noise.</p>
<p>
<xref ref-type="fig" rid="pcbi.1006283.g002">Fig 2</xref> shows an example where the number of patterns exceeds the number of neurons by a factor 10 (500 to 50). In the 2-D t-SNE embedding, the 500 patterns form separate clusters, with the emergence of a noise cluster that has higher variance. Consistent with the low dimensional t-SNE embedding, the HDBSCAN algorithm is able to correctly identify the separate clusters (<xref ref-type="supplementary-material" rid="pcbi.1006283.s004">S4 Fig</xref>).</p>
<p>When many patterns are detectable, the geometry of the low dimensional t-SNE embedding needs to be interpreted carefully: In this case, all 500 patterns are roughly equidistant to each other, however, there does not exist a 2-D projection in which all 500 clusters are equidistant to each other; this would only occur with a triangle for <italic>P</italic> = 3 patterns. Thus, although the low dimensional t-SNE embedding demonstrates that the clusters are well separated from each other, in the 2-D embedding nearby clusters do not necessarily have smaller SPOTDis dissimilarities than distant clusters when <italic>P</italic> is large.</p>
</sec>
<sec id="sec006">
<title>SPOTDisClust can detect complex patterns</title>
<p>Temporal patterns in neuronal data may consist not only of ordered sequences of activation, but can also have a more complex character. As explained above, a key advantage of the SPOTDis measure is that it computes averages over the EMD, which can distinguish complex patterns beyond patterns that differ only by a measure of central tendency. Indeed, we will demonstrate that SPOTDisClust can detect a wide variety of patterns, for which traditional methods that are based on the relative activation order (sequence) of neurons may not be well equipped.</p>
<p>We first consider a case where the patterns consist of bimodal activations within the epoch (<xref ref-type="fig" rid="pcbi.1006283.g003">Fig 3A</xref>). These types of activation patterns might for example be expected when rodents navigate through a maze, such that enthorinal grid cells or CA1 cells with multiple place fields are activated at multiple locations and time points [<xref ref-type="bibr" rid="pcbi.1006283.ref064">64</xref>–<xref ref-type="bibr" rid="pcbi.1006283.ref066">66</xref>]. A special case of a bimodal activation is one where neurons have a high baseline firing rate and are “deactivated” in a certain segment of the epoch (<xref ref-type="fig" rid="pcbi.1006283.g003">Fig 3B</xref>). These kinds of deactivations may be important, because e.g. spatial information about an animal’s position in the medial temporal lobe ([<xref ref-type="bibr" rid="pcbi.1006283.ref067">67</xref>]) or visual information in retinal ganglion cells is carried not only by neuronal activations, but also by neuronal deactivations. We find that the different patterns form well separated clusters in the low dimensional t-SNE embedding based on SPOTDis (<xref ref-type="fig" rid="pcbi.1006283.g003">Fig 3A and 3B</xref>), and that HDBSCAN correctly identifies them (<xref ref-type="supplementary-material" rid="pcbi.1006283.s004">S4 Fig</xref>).</p>
<p>Next, we consider a case where there are two coarse patterns and two fine patterns embedded within each coarse pattern, resulting in a total number of four patterns. This example might be relevant for sequences that result from cross-frequency theta-gamma coupling, or from the sequential activation of place fields that is accompanied by theta phase sequences on a faster time scale [<xref ref-type="bibr" rid="pcbi.1006283.ref068">68</xref>, <xref ref-type="bibr" rid="pcbi.1006283.ref069">69</xref>]. These kinds of patterns would be challenging for methods that rely on binning, because distinguishing the coarse and fine patterns requires coarse and fine binning, respectively. We find that the SPOTDis allows for a correct separation of the data in four clusters corresponding to the four patterns and one noise cluster (<xref ref-type="fig" rid="pcbi.1006283.g004">Fig 4A</xref>), and that HDBSCAN identifies them (<xref ref-type="supplementary-material" rid="pcbi.1006283.s004">S4 Fig</xref>). As expected, we find that the two patterns that share the same coarse structure (but contain a different fine structure) have smaller dissimilarities to each other in the t-SNE embedding as compared to the patterns that share a different coarse structure.</p>
<p>Finally, we consider a set of patterns consisting of a synchronous (i.e. without delays) firing of a subset of cells, with a cross-correlation function that is symmetric around the delay <italic>τ</italic> = 0 (i.e., correlation without delays). This type of activity may arise for example in a network in which all the coupling coefficients between neurons are symmetric.</p>
<p>Previous methods to identify the co-activation (without consideration of time delays) of different neuronal assemblies relied on PCA [<xref ref-type="bibr" rid="pcbi.1006283.ref024">24</xref>], which has the key limitation that it can identify only a small number of patterns (smaller than the number of neurons) Furthermore, while yielding orthonormal, uncorrelated components that explain the most variance in the data, PCA components do not necessarily correspond to neuronal spike patterns that form distinct and separable clusters; e.g. a multivariate Gaussian distribution can yield multiple PCA components that correspond to orthogonal axes explaining most of the data variance.</p>
<p>
<xref ref-type="fig" rid="pcbi.1006283.g004">Fig 4B</xref> shows four patterns, in which a subset of cells exhibits a correlated activation without delays. Separate clusters emerge in the t-SNE embedding based on SPOTDis (<xref ref-type="fig" rid="pcbi.1006283.g004">Fig 4B</xref>) and are identified by HDBSCAN (<xref ref-type="supplementary-material" rid="pcbi.1006283.s004">S4 Fig</xref>). This demonstrates that SPOTDisClust is not only a sequence detection method in the sense that it can detect specific temporal orderings of firing, but can also be used to identify patterns in which specific groups of cells are synchronously co-active without time delays.</p>
</sec>
<sec id="sec007">
<title>Dependence on the signal to noise ratio</title>
<p>A major challenge for the clustering of temporal spiking patterns is the stochasticity of neuronal firing. That is, in neural data, it is extremely unlikely to encounter, in a high dimensional space, a copy of the same pattern exactly twice, or even two instantiations that differ by only a few insertions or deletions of spikes. Furthermore, patterns might be distinct when they span a high-dimensional neural space, even when bivariate correlations among neurons are weak and when the firing of neurons in the activation period is only slightly higher than the baseline firing around it (see further below). The robustness of a sequence detection algorithm to noise is therefore critical.</p>
<p>We can dissociate different aspects of “noise” in temporal spiking patterns. A first source of noise is the stochastic fluctuation in the number of spikes during the pulse activation period and baseline firing period. In the ground-truth simulations presented here, this fluctuation is driven by the generation of spikes according to inhomogeneous Poisson processes. This type of noise causes differences in SPOTDis values between epochs, because of differences in the amount of mass in the pulse activation and baseline period, in combination with the normalization of the cross-correlation histogram. In the extreme case, some neurons may not fire in an given epoch, such that all information about the temporal structure of the pattern is lost. Such a neural “silence” might be prevalent when we search for spiking patterns on a short time scale. We note that fluctuations in the spike count are primarily detrimental to clustering performance because there is baseline firing around the pulse activation period, in other words because “noisy” spikes are inserted at random points in time around the pulse activations. To see this, suppose that the probability that a neuron fires at least one spike during the pulse activation period is close to one for all <italic>M</italic> epochs and all <italic>N</italic> neurons, and that the firing rate during the baseline is zero. In this case, because SPOTDis is based on computing optimal transport between normalized cross-correlation histograms (<xref ref-type="disp-formula" rid="pcbi.1006283.e016">Eq (5)</xref>), the fluctuation in the spike count due to Poisson firing would not drive differences in the SPOTDis.</p>
<p>A second source of noise is the jitter in spike timing. Jitter in spike timing also gives rise to fluctuations in the SPOTDis and in the ground-truth simulations presented here, spike timing jitter is a consequence of the generation of spikes according to Poisson processes. As explained above, because the SPOTDisClust method does not require exact matches of the observed patterns, but is a “cross-bins” dissimilarity measure, it can handle jitter in spike timing well. Again, we can distinguish jitter in spike timing during the baseline firing, and jitter in spike timing during the pulse activation period. The amount of perturbation caused by spike timing jitter during the pulse activation period is a function of the pulse period duration. We will explore the consequences of these different noise sources, namely the amount of baseline firing, the sparsity of firing, and spike timing jitter in Figs <xref ref-type="fig" rid="pcbi.1006283.g005">5</xref> and <xref ref-type="fig" rid="pcbi.1006283.g006">6</xref>.</p>
<p>We define the SNR (Signal-to-Noise-Ratio) as the ratio of the firing rate inside the activation pulse period over the firing rate outside the activation period. This measure of SNR reflects both the amount of firing in the pulse activation period as compared to the baseline period (first source of noise), and the pulse duration as compared to the epoch duration (second source of noise).</p>
<p>We first consider an example of 100 neurons that have a relatively low SNR (<xref ref-type="fig" rid="pcbi.1006283.g005">Fig 5A</xref>). It can be appreciated that different realizations from the same pattern are difficult to identify by eye, and that exact matches for the same pattern, if one would bin the spike trains, would be highly improbable, even for a single pair of two neurons (<xref ref-type="fig" rid="pcbi.1006283.g005">Fig 5A</xref>). Yet, in the 2-D t-SNE embedding based on SPOTDis, the different clusters form well separated “islands” (<xref ref-type="fig" rid="pcbi.1006283.g005">Fig 5A</xref>), and the HDBSCAN clustering algorithm captures them (<xref ref-type="supplementary-material" rid="pcbi.1006283.s004">S4 Fig</xref>).</p>
<p>To systematically analyze the dependence of clustering performance on the SNR, we varied the SNR by changing the firing rate inside the activation pulse period, while leaving the firing rate outside the activation period as well as the duration of the activation (pulse) period constant. Thus, we varied the first aspect of noise, which is driven by spike count fluctuations. A measure of performance was then constructed by comparing the unsupervised cluster labels rendered by HDBSCAN with the ground-truth cluster labels, using the Adjusted Rand Index (ARI) measure (see <xref ref-type="sec" rid="sec013">Methods</xref>). As expected, we find that clustering performance increases with the firing rate SNR (<xref ref-type="fig" rid="pcbi.1006283.g005">Fig 5B</xref>). Importantly, as the number of neurons increases, we find that the same clustering performance can be achieved with a lower SNR (<xref ref-type="fig" rid="pcbi.1006283.g005">Fig 5B</xref>). Thus, SPOTDisClust does not suffer from the problem of combinatorial explosion as the number of neurons that constitute the patterns increases, and, moreover, its performance improves when the number of recorded neurons is higher. The reason underlying this behavior is that each neuron contributes to the separability of the patterns, such that a larger sample of neurons allows each individual neuron to be noisier. This means that, in the brain, very reliable temporal patterns may span high-dimensional neural spaces, even though the bivariate correlations might appear extremely noisy; absence of evidence for temporal coding in low dimensional multi-neuron ensembles should therefore not be taken as evidence for absence of temporal coding in high dimensional multi-neuron ensembles.</p>
<p>We also varied the SNR by changing the pulse duration while leaving the ratio of expected number of spikes in the activation period relative to the baseline constant. The latter was achieved by adjusting the firing rate inside the activation period, such that the product of pulse duration with firing rate in the activation period remained constant, i.e. <italic>T</italic><sub><italic>pulse</italic></sub>λ<sub><italic>pulse</italic></sub> = <italic>c</italic>. Thus, we varied the second aspect of noise, namely the amount of spike timing jitter in the pulse activation period. We find a similar dependence of clustering performance on the firing rate SNR and the number of neurons (<xref ref-type="fig" rid="pcbi.1006283.g005">Fig 5B</xref>). Hence, patterns that comprise brief activation pulses of very high firing yield, given a constant product <italic>T</italic><sub><italic>pulse</italic></sub>λ<sub><italic>pulse</italic></sub>, clusters that are better separated than patterns comprising longer activation pulses.</p>
<p>We performed further simulations to study in a more simplified, one-dimensional setting how the SPOTDis depends quantitatively on the insertion of noise spikes outside of the activation pulse periods, which further demonstrates the robustness of the SPOTDis measure to noise (<xref ref-type="supplementary-material" rid="pcbi.1006283.s006">S6 Fig</xref>).</p>
<p>In addition, we performed simulations to determine the influence of spike sorting errors on the clustering performance. In general, spike sorting errors lead to a reduction in HDBSCAN clustering performance, the extent of which depends on the type of spike sorting error (contamination or collision) [<xref ref-type="bibr" rid="pcbi.1006283.ref070">70</xref>] and the structure of the spike pattern (<xref ref-type="supplementary-material" rid="pcbi.1006283.s007">S7</xref> and <xref ref-type="supplementary-material" rid="pcbi.1006283.s008">S8</xref> Figs). This result is consistent with the dependence of the HBDSCAN clustering performance on signal-to-noise ratio and pulse duration shown in <xref ref-type="fig" rid="pcbi.1006283.g005">Fig 5</xref>, as well with the notion that contamination mixes responses across neurons, such that the number of neurons that carries unique information decreases. We further note that in general, SPOTDisClust provides flexibility when detecting patterns using multiple tetrodes or channels of a laminar silicon probe: A common technique employed when analyzing pairwise correlations (e.g. noise correlations) is to ignore pairs of neurons that were measured from the same tetrode or from nearby channels. When the number of channels is large, this will only ignore a relatively small fraction of neuron pairs. Because the SPOTDis measure is defined over pairs of neurons, rather than the sequential ordering of firing defined over an entire neuronal ensemble, this can be easily implemented by, in <xref ref-type="disp-formula" rid="pcbi.1006283.e010">Eq 2</xref>, letting the sum run over neuron pairs from separate electrodes.</p>
</sec>
<sec id="sec008">
<title>Temporal pattern recognition in sparsely firing ensembles</title>
<p>As explained above, an extreme case of noise driven by spike count fluctuations is the absence of firing during an epoch. If many neurons remain “silent” in a given epoch, then we can only compute the EMD for a small subset of neuron pairs (<xref ref-type="disp-formula" rid="pcbi.1006283.e010">Eq (2)</xref>). Such a sparse firing scenario might be particularly challenging to latency-based methods, because the latency of cells that do not fire is not defined. We consider a case of sparse firing in <xref ref-type="fig" rid="pcbi.1006283.g006">Fig 6</xref> where the expected number of spikes per epoch is only 0.48. Despite the firing sparsity, the low-dimensional t-SNE embedding based on SPOTDis shows separable clusters, and HDBSCAN correctly identifies the different clusters (<xref ref-type="fig" rid="pcbi.1006283.g006">Fig 6</xref>). We also performed a simulation in which patterns consist of precise spike sequences, and examined the influence of temporal jitter of the precise spike sequence, as well as the amount of noise spikes surrounding these precise spike sequences. Up to some levels of temporal jitter, and signal-to-noise ratio, HDBSCAN shows a relatively good clustering performance (<xref ref-type="supplementary-material" rid="pcbi.1006283.s009">S9 Fig</xref>). In general, given sparse firing, a sufficient number of neurons is needed to correctly identify the <italic>P</italic> patterns, but, in addition, the patterns should be distinct on a sufficiently large fraction of neuron pairs. Furthermore, the lower the signal-to-noise ratio, the more neurons are needed to separate the patterns from one another.</p>
</sec>
<sec id="sec009">
<title>Insensitivity to scaling of firing rates</title>
<p>A key aim of the SPOTDisClust methodology is to identify temporal patterns that are based on consistent temporal relationships among neurons. However, in addition to temporal patterns, neuronal populations can also exhibit fluctuations in the firing rate that can be driven by e.g. external input or behavioral state and are superimposed on temporal patterns. A global scaling of the firing rate, or a scaling of the firing rate for a specific assembly, should not constitute a different temporal pattern if the temporal structure of the pattern remains unaltered, i.e. when the normalized cross-correlation function has the same expected value, and should not interfere with the clustering of temporal patterns. This is an important point for practical applications, because it might occur for instance that in specific behavioral states rates are globally scaled [<xref ref-type="bibr" rid="pcbi.1006283.ref071">71</xref>, <xref ref-type="bibr" rid="pcbi.1006283.ref072">72</xref>].</p>
<p>In <xref ref-type="fig" rid="pcbi.1006283.g007">Fig 7A</xref>, we show an example where there are three different global rate scalings, as well as two temporal patterns. The temporal patterns are, for each epoch, randomly accompanied by one of the different global rate scaling factors. The t-SNE embedding shows that the temporal patterns form separate clusters, but that the global rate scalings do not (<xref ref-type="fig" rid="pcbi.1006283.g007">Fig 7A</xref>). Furthermore, HDBSCAN correctly clusters the temporal patterns, but does not find separate clusters for the different rate scalings (<xref ref-type="fig" rid="pcbi.1006283.g007">Fig 7A</xref> and <xref ref-type="supplementary-material" rid="pcbi.1006283.s004">S4 Fig</xref>). This behavior can be understood from examination of the sorted dissimilarity matrix, in which we can see that epochs with a low rate do not only have a higher SPOTDis to epochs with a high rate, but also to other epochs with a low rate, which prevents them from agglomerating into a separate cluster (<xref ref-type="fig" rid="pcbi.1006283.g007">Fig 7A</xref>); rather the epochs with a low rate tend to cluster at the edges of the cluster, whereas the epochs with a high rate tend to form the core of the cluster (<xref ref-type="fig" rid="pcbi.1006283.g007">Fig 7A</xref>).</p>
<p>Another example of a rate scaling is one that consists of a scaling of the firing rate for one half of the neurons (<xref ref-type="fig" rid="pcbi.1006283.g007">Fig 7B</xref>). Again, the t-SNE embedding and HDBSCAN clustering show that rate scalings do not form separate clusters, and do not interfere with the clustering of the temporal patterns (<xref ref-type="fig" rid="pcbi.1006283.g007">Fig 7B</xref> and <xref ref-type="supplementary-material" rid="pcbi.1006283.s004">S4 Fig</xref>). We conclude that the unsupervised clustering of different temporal patterns with SPOTDisClust is not compromised by the inclusion of global rate scalings, or the scaling of the rate in a specific subset of neurons.</p>
</sec>
<sec id="sec010">
<title>Application to visual responses of V1 populations</title>
<p>We apply the SPOTDisClust method to data collected from monkey V1. Simultaneous recordings were performed from 64 V1 channels using a chronically implanted Utah array (Blackrock) (see <xref ref-type="sec" rid="sec013">Methods</xref>). We presented moving bar stimuli in four cardinal directions while monkeys performed a passive fixation task. Each stimulus bar was presented 20 times. We then pooled all 80 trials together, and added 80 trials containing spontaneous activity. Our aim was then to recover the separate stimulus conditions using unsupervised clustering of multi-unit data with SPOTDisClust. The low dimensional t-SNE embedding shows four dense regions that are well separated from each other and correspond to the four stimuli, and HDBSCAN identifies these four clusters (<xref ref-type="fig" rid="pcbi.1006283.g008">Fig 8</xref>). Furthermore, when we performed clustering on the firing rate vectors, and constructed a t-SNE embedding on distances between population rate vectors, we were not able to extract the different stimulus directions from the cluster labels. This shows that the temporal clustering results are not trivially explained by rate differences across stimulus directions, but also indicates that the temporal pattern of population activity might reveal important stimulus information beyond the neuronal firing rates. Thus, SPOTDisClust can be successfully used on real neuronal data to identify different temporal patterns in high-dimensional multi-neuron ensembles.</p>
</sec>
<sec id="sec011">
<title>Optimization of window length</title>
<p>For the simulations and applications above, we have assumed that the temporal window of interest for the application was known, i.e. that we had some <italic>a priori</italic> knowledge about the length of the spike patterns. For many applications in neuroscience, we want to detect sequences around specific events that are either defined by some external event (e.g. a stimulus onset) or by some “internal” event, e.g. a sharp wave ripple complex, an UP-DOWN state transition, or the cycle of some oscillation, e.g. a hippocampal theta cycle. However, in these cases the precise duration of the spike patterns is not known, and in addition there is most likely some jitter in the onset of the sequence. To handle this onset jitter, SPOTDisClust explicitly defines patterns at the level of cross-correlations rather than on univariate spike trains directly, which endows the measure with time translational invariance. To show the feasibility of determining the window length automatically from the data, we have performed simulations in which sequences occurred around some event with additional temporal jitter. These sequences were flanked by homogeneous noise (i.e. before and after the sequences). We then varied the chosen window length around the event, and measured the cluster quality using the unsupervised Silhouette score, which is based on a comparison of distances within each cluster vs. distances between the clusters (see <xref ref-type="sec" rid="sec013">Methods</xref>). As expected, the (unsupervised) Silhouette and ARI (ground-truth) cluster quality scores decreased when we used longer and shorter windows than the true sequence length (<xref ref-type="supplementary-material" rid="pcbi.1006283.s011">S11 Fig</xref>). Importantly, however, the Silhouette and ARI score showed a tight correspondence with one another, showing the feasibility of selecting the window length for spike sequence detection in an unsupervised manner. For our application to neuronal data, we optimized the window length used for the clustering using the Silhouette score and show that we can recover the window length that maximizes the cluster quality as compared to ground-truth (ARI) (<xref ref-type="supplementary-material" rid="pcbi.1006283.s012">S12 Fig</xref>).</p>
</sec>
</sec>
<sec id="sec012" sec-type="conclusions">
<title>Discussion</title>
<p>We have presented a novel dissimilarity measure for multi-neuron temporal spike patterns, SPOTDis, with unique properties that make it suitable for the unsupervised exploration of the space of admissible firing patterns. SPOTDis is rooted in optimal transport theory, a burgeoning field in mathematics that offers promising solutions for fields as diverse as economics, engineering, physics and chemistry [<xref ref-type="bibr" rid="pcbi.1006283.ref054">54</xref>–<xref ref-type="bibr" rid="pcbi.1006283.ref057">57</xref>, <xref ref-type="bibr" rid="pcbi.1006283.ref073">73</xref>]. In machine learning, optimal transportation based distances for image classification have been devised, which accommodate the fact that relevant image features may appear at slightly different positions in similar images. While pixel-wise comparisons of two images may fail to recognize similarity under those conditions, optimal transportation based distances operate in a “cross-bins” fashion, so they can treat those shifts in an appropriate way. In neural data analysis we face a similar problem, as spike patterns may present themselves repeatedly with the same overall structure, but not exactly the same timing. The traditional approach to accommodate for such “jitter” is to discretize spike times with a binning procedure, or, in a nearly equivalent way, to use a smoothed version of the spike train time series [<xref ref-type="bibr" rid="pcbi.1006283.ref074">74</xref>]. Such approaches require setting an arbitrary scale for the timing precision of neural firing. This is in general difficult, because neural patterns may occur at different temporal scales, and with different jitters. For example, hippocampal place fields fire in sequences at the “behavioral” time scale of hundreds of milliseconds, and because of the phase precession phenomena, they fire so-called “theta” sequences at a much faster (tens of milliseconds) time scales [<xref ref-type="bibr" rid="pcbi.1006283.ref025">25</xref>, <xref ref-type="bibr" rid="pcbi.1006283.ref068">68</xref>, <xref ref-type="bibr" rid="pcbi.1006283.ref069">69</xref>]. Repeated sequences at any time scale will be detected by SPOTDis, in particular in combination with a density based algorithm such as HDBSCAN, which can detect state space regions of higher density surrounded by lower density areas, regardless of the absolute density. Using ground-truth simulations, we have shown that SPOTDis can deal with cases in which both coarse and fine patterns co-exist (<xref ref-type="fig" rid="pcbi.1006283.g004">Fig 4A</xref>). Optimal transport theory provides both theoretical grounding, as well as a host of solutions for the efficient calculation of distances. Here, we propose a novel implementation, inspired to work in optimal transport, and tailored to the case of calculating the dissimilarity between point process realizations, in our case spike trains.</p>
<p>Distance measures based on “morphing” one spike train into another by moving spikes have been previously proposed. The Victor-Purpura distance, which is an adaptation of the Levenshtein distance to point processes, is a paradigmatic example [<xref ref-type="bibr" rid="pcbi.1006283.ref075">75</xref>]. Our approach differs in two fundamental ways.</p>
<p>First, the Victor-Purpura distance allows for the insertion and deletion of spikes, to enable computation of distances between spike trains with different numbers of spikes, adding in each case a penalty term (the penalty terms are arbitrary parameters to be optimized). While this may be a principled way to deal with this issue, it introduces additional complexity in the computation of the distance as many different combinations of spike shifting and insertion/deletion must be considered in order to find the optimal solution. This may render optimization difficult and the computation prohibitive as one attempts to compare a large number of multi-neuron patterns. We take the more simple-minded approach of rescaling the time series to be compared, in order to equalize mass. While this may be an oversimplification in some cases, this enables us to implement the computation in a very efficient way. Yet, we preserve many desirable features of spike train metrics such as the Victor-Purpura distance. For example, SPOTDis is not based on measures of central tendency, but can also compute dissimilarities between multimodal probability distributions (<xref ref-type="fig" rid="pcbi.1006283.g003">Fig 3A and 3B</xref>). Furthermore, SPOTDis is particularly noise robust, because it can handle jitter in spike timing, as it does not require exact overlap in discretized time bins, but is based on distance computations in a metric space.</p>
<p>A second important difference with spike train metric methods such as Victor-Purpura distance is that we calculate the pairwise epoch-to-epoch dissimilarity not directly on spike trains but on cross-correlograms between pairs of cell spike trains. This has the considerable advantage of enabling detection of similarity between spiking patterns that are misaligned, and eliminates the need for precise time reference points (e.g. the time of stimulus delivery), providing a way to freely search for repeated patterns in spontaneous or evoked activity. Comparing cross-correlation patterns between epochs has been used in seminal work on memory replay, where cross-correlation “bias” was compared across entire sleep or behavioral epochs, to assess the presence of significant replay [<xref ref-type="bibr" rid="pcbi.1006283.ref022">22</xref>, <xref ref-type="bibr" rid="pcbi.1006283.ref023">23</xref>]. Here, we provide a method for comparison at a greater granularity, enabling efficient identification of the repeated patterns within time windows of hundreds of milliseconds. A distance based on cross-correlation also has an attractive physiological interpretation: From the perspective of synaptic plasticity, it can be interpreted as the extent to which two patterns have a similar effect on the synaptic plasticity in the network through the STDP rule, which holds that changes in synaptic plasticity depend on the timing jitter between pre- and post-synaptic spikes [<xref ref-type="bibr" rid="pcbi.1006283.ref026">26</xref>, <xref ref-type="bibr" rid="pcbi.1006283.ref027">27</xref>]. Our dissimilarity measure acts on multi-neuron patterns, and can make use of any additional information available when the monitored neural population increases in size. Because SPOTDis between epoch <italic>k</italic> and epoch <italic>m</italic> ignores neuron pairs in which one neuron did not fire in both epochs, it also handles cases in which there is sparse firing and many neurons do not fire at all (<xref ref-type="fig" rid="pcbi.1006283.g006">Fig 6</xref>). Moreover, SPOTDis is based on computing a distance function on the normalized cross-correlation functions. Because of this normalization to unit mass, it copes with global fluctuations in the firing rate, and specific increases in the firing rate for subsets of neurons (<xref ref-type="fig" rid="pcbi.1006283.g005">Fig 5</xref>).</p>
<p>We combined SPOTDis with a density-based clustering algorithm, HDBSCAN, which forms a good match for several reasons: First, it can deal with non-metric dissimilarities. While SPOTDis on a single cell pair cross-correlation is metric (and the sum of metrics is a metric), absence of firing in some neurons and in some cell pairs may cause violation of metricity, which is handled gracefully by HDBSCAN. Second, it can identify clusters at different characteristic densities in different regions of the state space, adapting to patterns that may arise at different time scales and different precision due to disparate underlying mechanisms. Yet, other clustering strategies than HDBSCAN may work successfully as well. We show that in many cases, a non-linear embedding technique such as t-SNE acting on SPOTDis yields a quite intuitive representation of the underlying structure of the data.</p>
<p>It is important to emphasize that our method is an explicit clustering method, that can find unique patterns of network activity that are well separated from one another. Several methods using decomposition techniques like PCA or matrix factorization have been utilized with the goal of extracting patterns or sequences from neuronal ensemble data [<xref ref-type="bibr" rid="pcbi.1006283.ref024">24</xref>, <xref ref-type="bibr" rid="pcbi.1006283.ref046">46</xref>, <xref ref-type="bibr" rid="pcbi.1006283.ref047">47</xref>, <xref ref-type="bibr" rid="pcbi.1006283.ref076">76</xref>]. We highlight several differences between SPOTDisClust and decomposition techniques: 1) In principle, decomposition techniques like PCA achieve a different goal, namely to identify components that explain a large fraction of variance in the data. These components might in some cases correspond to separate patterns, but do not necessarily so: For instance, a multivariate Gaussian model distribution may yield few components explaining most variance, but these components do not necessarily correspond to clusters. Further, decomposition techniques like PCA decompose into an orthogonal base set, while different spike patterns may in fact be strongly correlated to one another. Thus, decomposition and clustering techniques can provide complementary information. 2) SPOTDisClust can also handle cases where there is a very large number of noise patterns and only few realizations of spike patterns yielding small clusters. These small clusters might drive only a small degree of variance, and may be invisible to decomposition techniques. 3) Many decomposition techniques are designed to find a few components corresponding to dominant axes of variance in the data, yielding fewer “spike patterns” than the number of neurons, although decomposition techniques using overcomplete base sets may in principle find more patterns than the number of neurons. SPOTDisClust on the other hand can find many more patterns than the number of clusters. 4) Finally, SPOTDisClust is in principle a “binless” method, while decomposition techniques will typically require some form of binning resulting in information loss.</p>
<p>We provide an initial application of the SPOTDis measure to real neuronal data, by analyzing multi-electrode recordings in visual cortex. In this analysis, we fed the algorithm the neural data without any knowledge of the task structure, or of the times of stimulus delivery. Strikingly, the identified clusters faithfully reflected the structure of the PSTH calculated with traditional methods, with availability of the stimulus delivery times and labels. Thus, we can recover stimulus information even after normalizing away firing rate information, which is conventionally used to decode different stimuli, demonstrating that the temporal structure of population activity encodes different moving stimulus directions. We also developed an analogous clustering method to SPOTDisClust by constructing a dissimilarity matrix based on L1 distances among population firing rate vectors. Using this clustering technique, the different stimulus directions could not be separated from one another using t-SNE embedding or HDBSCAN.</p>
<p>While we argued that our approach using bivariate cross-correlations yields many advantages, it also has a limitation in the sense that it does not capture higher-order correlations among neurons. Future extensions of this technique may explicitly construct a dissimilarity measure based on high-order correlations among neurons. Indeed, incorporating this may be an interesting avenue for future work. Nonetheless, it should be noted that higher order correlations in a population may be captured by models fitting the first and second moments alone [<xref ref-type="bibr" rid="pcbi.1006283.ref077">77</xref>, <xref ref-type="bibr" rid="pcbi.1006283.ref078">78</xref>]).</p>
<p>In the present work, we only considered spike trains as if they were recorded using electrophysiological methods. However, this method may also be applied to two-photon calcium imaging data using sensors like GCaMP6f. Analysis of this type of data always involves some additional preprocessing steps like denoising, deconvolution, region of interest identification, and normalization. An excellent strategy would be to apply the method on calcium imaging data after deconvolution and source extraction, which yields sparse time series with “spikes”, although not measured with the same temporal resolution as in case of electrophysiological recordings [<xref ref-type="bibr" rid="pcbi.1006283.ref079">79</xref>, <xref ref-type="bibr" rid="pcbi.1006283.ref080">80</xref>]. After deconvolution, the application of SPOTDisClust is straightforward. If one operates on the raw fluorescence data, using a defined set of ROIs corresponding to e.g. somata or spines, then one would have to perform some normalization to get rid of background fluorescence. One possible normalization could be Δ<italic>F</italic> = <italic>F</italic> − <italic>F</italic><sub><italic>background</italic></sub>, where <italic>F</italic><sub><italic>background</italic></sub> is the background fluorescence. After this, one would normalize Δ<italic>F</italic> to unit mass, and then directly compute the EMD on this unit mass.</p>
<p>In conclusion, we have proposed a new tool for the efficient unsupervised analysis of multi-neuron data, which opens up more flexible ways to analyze spontaneous and evoked activity than it has been so far possible.</p>
</sec>
<sec id="sec013" sec-type="materials|methods">
<title>Methods</title>
<sec id="sec014">
<title>Construction of SPOTDis</title>
<p>The SPOTDisClust method contains two steps. The first step is to construct the pairwise epoch-to-epoch SPOTDis measure on the matrix of cross-correlations among all neuron pairs.</p>
<list list-type="order">
<list-item>
<p>We compute, for each of the <italic>M</italic> epochs separately, the normalized cross-correlation function for all pairs of <italic>N</italic> neurons, which yields <italic>M</italic> matrices of <italic>N</italic>(<italic>N</italic> − 1)/2 normalized cross-correlations <inline-formula id="pcbi.1006283.e015"><alternatives><graphic id="pcbi.1006283.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e015" xlink:type="simple"/><mml:math display="inline" id="M15"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. This function is defined
<disp-formula id="pcbi.1006283.e016"><alternatives><graphic id="pcbi.1006283.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e016" xlink:type="simple"/><mml:math display="block" id="M16"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≡</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>s</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>τ</mml:mi> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mi>T</mml:mi></mml:mrow> <mml:mi>T</mml:mi></mml:msubsup> <mml:msub><mml:mi>s</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(5)</label></disp-formula>
where <inline-formula id="pcbi.1006283.e017"><alternatives><graphic id="pcbi.1006283.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e017" xlink:type="simple"/><mml:math display="inline" id="M17"><mml:mrow><mml:msub><mml:mi>s</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≡</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>τ</mml:mi> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mi>T</mml:mi></mml:mrow> <mml:mi>T</mml:mi></mml:msubsup> <mml:msub><mml:mi>s</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>s</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is the cross-correlation function (or cross-covariance), and <italic>s</italic><sub><italic>i</italic>,<italic>k</italic></sub>(<italic>t</italic>) and <italic>s</italic><sub><italic>j</italic>,<italic>k</italic></sub>(<italic>t</italic>) are the spike trains of neurons <italic>i</italic> and <italic>j</italic> in the <italic>k</italic>th trial, with <italic>k</italic> = 1, …, <italic>M</italic>, and <italic>i</italic>, <italic>j</italic> = 1, …, <italic>N</italic>. In other words, the normalized cross-correlation histogram is simply the histogram of expected coincidence counts at different delays <italic>τ</italic>, normalized to unit mass. We define <inline-formula id="pcbi.1006283.e018"><alternatives><graphic id="pcbi.1006283.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e018" xlink:type="simple"/><mml:math display="inline" id="M18"><mml:mrow><mml:mfrac><mml:mn>0</mml:mn> <mml:mn>0</mml:mn></mml:mfrac> <mml:mo>≡</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> in <xref ref-type="disp-formula" rid="pcbi.1006283.e016">Eq (5)</xref>. <xref ref-type="supplementary-material" rid="pcbi.1006283.s001">S1</xref> and <xref ref-type="supplementary-material" rid="pcbi.1006283.s002">S2</xref> Figs show an example of cross-correlations before and after normalization.</p>
</list-item>
<list-item>
<p>We then compute the Earth Mover’s Distance (EMD) between <inline-formula id="pcbi.1006283.e019"><alternatives><graphic id="pcbi.1006283.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e019" xlink:type="simple"/><mml:math display="inline" id="M19"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006283.e020"><alternatives><graphic id="pcbi.1006283.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e020" xlink:type="simple"/><mml:math display="inline" id="M20"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi>m</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> for each (<italic>k</italic>,<italic>m</italic>). While the EMD is usually defined on each entry of the histogram (i.e. for each <italic>τ</italic>), we can ignore the values of <italic>τ</italic> for which <inline-formula id="pcbi.1006283.e021"><alternatives><graphic id="pcbi.1006283.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e021" xlink:type="simple"/><mml:math display="inline" id="M21"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> here since there is no mass to move to or from. We therefore first find all the <italic>τ</italic> for which <italic>s</italic><sub><italic>ij</italic>,<italic>k</italic></sub>(<italic>τ</italic>) &gt; 0 and <italic>s</italic><sub><italic>ij</italic>,<italic>m</italic></sub>(<italic>τ</italic>) &gt; 0, defining respectively the (in ascending order) sorted vectors <inline-formula id="pcbi.1006283.e022"><alternatives><graphic id="pcbi.1006283.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e022" xlink:type="simple"/><mml:math display="inline" id="M22"><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006283.e023"><alternatives><graphic id="pcbi.1006283.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e023" xlink:type="simple"/><mml:math display="inline" id="M23"><mml:mover accent="true"><mml:mi>y</mml:mi> <mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula> (we omit <italic>i</italic> and <italic>j</italic> subscripts here). These have <italic>Q</italic> = ∑<sub><italic>τ</italic></sub> <italic>s</italic><sub><italic>ij</italic>,<italic>k</italic></sub>(<italic>τ</italic>) and <italic>R</italic> = ∑<sub><italic>τ</italic></sub> <italic>s</italic><sub><italic>ij</italic>,<italic>m</italic></sub>(<italic>τ</italic>) elements respectively, and associated mass <inline-formula id="pcbi.1006283.e024"><alternatives><graphic id="pcbi.1006283.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e024" xlink:type="simple"/><mml:math display="inline" id="M24"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>w</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mi>x</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mi>Q</mml:mi> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mi>Q</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006283.e025"><alternatives><graphic id="pcbi.1006283.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e025" xlink:type="simple"/><mml:math display="inline" id="M25"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>w</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mi>y</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mi>R</mml:mi> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mi>R</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. If there exist <italic>τ</italic> for which <italic>s</italic><sub><italic>ij</italic>,<italic>k</italic></sub>(<italic>τ</italic>) = <italic>z</italic> with <italic>z</italic> &gt; 1, <inline-formula id="pcbi.1006283.e026"><alternatives><graphic id="pcbi.1006283.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e026" xlink:type="simple"/><mml:math display="inline" id="M26"><mml:mrow><mml:mi>z</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="double-struck">N</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, then there will be <italic>z</italic> elements of <italic>τ</italic> in <inline-formula id="pcbi.1006283.e027"><alternatives><graphic id="pcbi.1006283.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e027" xlink:type="simple"/><mml:math display="inline" id="M27"><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula> and associated mass in <inline-formula id="pcbi.1006283.e028"><alternatives><graphic id="pcbi.1006283.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e028" xlink:type="simple"/><mml:math display="inline" id="M28"><mml:msub><mml:mover accent="true"><mml:mi>w</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mi>x</mml:mi></mml:msub></mml:math></alternatives></inline-formula>, the same for <italic>m</italic> and <inline-formula id="pcbi.1006283.e029"><alternatives><graphic id="pcbi.1006283.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e029" xlink:type="simple"/><mml:math display="inline" id="M29"><mml:mover accent="true"><mml:mi>y</mml:mi> <mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula>. Following these definitions, we have <italic>s</italic><sub><italic>ij</italic>,<italic>k</italic></sub>(<italic>x</italic><sub><italic>q</italic></sub>) &gt; 0 for all <italic>q</italic> and <italic>s</italic><sub><italic>ij</italic>,<italic>m</italic></sub>(<italic>y</italic><sub><italic>r</italic></sub>) &gt; 0 for all <italic>r</italic>, i.e. the vectors <inline-formula id="pcbi.1006283.e030"><alternatives><graphic id="pcbi.1006283.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e030" xlink:type="simple"/><mml:math display="inline" id="M30"><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006283.e031"><alternatives><graphic id="pcbi.1006283.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e031" xlink:type="simple"/><mml:math display="inline" id="M31"><mml:mover accent="true"><mml:mi>y</mml:mi> <mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula> contain all the pairwise delays between the spike trains of a pair of neurons in epoch <italic>k</italic> and <italic>m</italic>, respectively. Furthermore, <italic>x</italic><sub><italic>q</italic></sub> ≥ <italic>x</italic><sub><italic>p</italic></sub> for all <italic>q</italic> &gt; <italic>p</italic>, and and <italic>y</italic><sub><italic>r</italic></sub> ≥ <italic>y</italic><sub><italic>z</italic></sub> for all <italic>r</italic> &gt; <italic>z</italic>, i.e. the vectors contain pairwise delays in ascending order. As an example, if neuron <italic>i</italic> fired spikes at samples (10, 11, 20, 23) in epoch <italic>k</italic> and neuron <italic>j</italic> fired spikes at (14, 15, 20) then <inline-formula id="pcbi.1006283.e032"><alternatives><graphic id="pcbi.1006283.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e032" xlink:type="simple"/><mml:math display="inline" id="M32"><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>-</mml:mo> <mml:mn>9</mml:mn> <mml:mo>,</mml:mo> <mml:mo>-</mml:mo> <mml:mn>8</mml:mn> <mml:mo>,</mml:mo> <mml:mo>-</mml:mo> <mml:mn>6</mml:mn> <mml:mo>,</mml:mo> <mml:mo>-</mml:mo> <mml:mn>5</mml:mn> <mml:mo>,</mml:mo> <mml:mo>-</mml:mo> <mml:mn>3</mml:mn> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mn>3</mml:mn> <mml:mo>,</mml:mo> <mml:mn>4</mml:mn> <mml:mo>,</mml:mo> <mml:mn>4</mml:mn> <mml:mo>,</mml:mo> <mml:mn>5</mml:mn> <mml:mo>,</mml:mo> <mml:mn>9</mml:mn> <mml:mo>,</mml:mo> <mml:mn>10</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006283.e033"><alternatives><graphic id="pcbi.1006283.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e033" xlink:type="simple"/><mml:math display="inline" id="M33"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>w</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mi>x</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mn>12</mml:mn> <mml:mo>,</mml:mo> <mml:mo>⋯</mml:mo> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mn>12</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p>Because the EMD is computed on the precise delay times, we can let Δ<italic>t</italic> → 0 and Δ<italic>τ</italic> → 0, i.e. the sampling rate can be made infinitely large. In practice, we therefore directly find the vectors <inline-formula id="pcbi.1006283.e034"><alternatives><graphic id="pcbi.1006283.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e034" xlink:type="simple"/><mml:math display="inline" id="M34"><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006283.e035"><alternatives><graphic id="pcbi.1006283.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e035" xlink:type="simple"/><mml:math display="inline" id="M35"><mml:mover accent="true"><mml:mi>y</mml:mi> <mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula> and do not compute <inline-formula id="pcbi.1006283.e036"><alternatives><graphic id="pcbi.1006283.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e036" xlink:type="simple"/><mml:math display="inline" id="M36"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> for all <italic>τ</italic>.</p>
<p>The EMD also requires the definition of a moving cost function, which in this case is defined over time points. Let <italic>c</italic> be the moving cost function which we define as the L1 norm, <italic>c</italic>(<italic>τ</italic><sub>1</sub>, <italic>τ</italic><sub>2</sub>) ≡ |<italic>τ</italic><sub>1</sub> − <italic>τ</italic><sub>2</sub>|/(2<italic>T</italic> + 1). Note that the normalization of <inline-formula id="pcbi.1006283.e037"><alternatives><graphic id="pcbi.1006283.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e037" xlink:type="simple"/><mml:math display="inline" id="M37"><mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mn>2</mml:mn> <mml:mi>T</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula> ensures that 0 ≤ <italic>D</italic> ≤ 1 (the EMD) in <xref ref-type="disp-formula" rid="pcbi.1006283.e038">Eq (6)</xref>. Solving the optimal transport problem then amounts to finding a matrix of flows <bold>F</bold> ≡ [<italic>f</italic><sub><italic>q</italic>,<italic>r</italic></sub>], with <italic>f</italic><sub><italic>q</italic>,<italic>r</italic></sub> the flow (i.e. the amount of mass moved) from <italic>w</italic><sub><italic>q</italic>,<italic>x</italic></sub> to <italic>w</italic><sub><italic>r</italic>,<italic>y</italic></sub>, such that the overall cost is minimized, i.e.
<disp-formula id="pcbi.1006283.e038"><alternatives><graphic id="pcbi.1006283.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e038" xlink:type="simple"/><mml:math display="block" id="M38"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>D</mml:mi> <mml:mo>≡</mml:mo> <mml:munder><mml:mo form="prefix" movablelimits="true">min</mml:mo> <mml:mi mathvariant="bold">F</mml:mi></mml:munder> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>q</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>Q</mml:mi></mml:munderover> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>r</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>R</mml:mi></mml:munderover> <mml:msub><mml:mi>f</mml:mi> <mml:mrow><mml:mi>q</mml:mi> <mml:mo>,</mml:mo> <mml:mi>r</mml:mi></mml:mrow></mml:msub> <mml:mspace width="0.166667em"/><mml:mi>c</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>q</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>r</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(6)</label></disp-formula>
subject to the constraints that
<disp-formula id="pcbi.1006283.e039"><alternatives><graphic id="pcbi.1006283.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e039" xlink:type="simple"/><mml:math display="block" id="M39"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>f</mml:mi> <mml:mrow><mml:mi>q</mml:mi> <mml:mo>,</mml:mo> <mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mtd> <mml:mtd><mml:mrow><mml:mo>≥</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(7)</label></disp-formula> <disp-formula id="pcbi.1006283.e040"><alternatives><graphic id="pcbi.1006283.e040g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e040" xlink:type="simple"/><mml:math display="block" id="M40"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>r</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>R</mml:mi></mml:munderover> <mml:msub><mml:mi>f</mml:mi> <mml:mrow><mml:mi>q</mml:mi> <mml:mo>,</mml:mo> <mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mo>=</mml:mo> <mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>q</mml:mi> <mml:mo>,</mml:mo> <mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(8)</label></disp-formula> <disp-formula id="pcbi.1006283.e041"><alternatives><graphic id="pcbi.1006283.e041g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e041" xlink:type="simple"/><mml:math display="block" id="M41"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>q</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>Q</mml:mi></mml:munderover> <mml:msub><mml:mi>f</mml:mi> <mml:mrow><mml:mi>q</mml:mi> <mml:mo>,</mml:mo> <mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mo>=</mml:mo> <mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>r</mml:mi> <mml:mo>,</mml:mo> <mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(9)</label></disp-formula> <disp-formula id="pcbi.1006283.e042"><alternatives><graphic id="pcbi.1006283.e042g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e042" xlink:type="simple"/><mml:math display="block" id="M42"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>q</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>Q</mml:mi></mml:munderover> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>r</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>R</mml:mi></mml:munderover> <mml:msub><mml:mi>f</mml:mi> <mml:mrow><mml:mi>q</mml:mi> <mml:mo>,</mml:mo> <mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(10)</label></disp-formula>
The last <xref ref-type="disp-formula" rid="pcbi.1006283.e042">Eq (10)</xref> ensures that all mass needs to be moved (the total mass equals 1), Eqs <xref ref-type="disp-formula" rid="pcbi.1006283.e040">(8)</xref> and <xref ref-type="disp-formula" rid="pcbi.1006283.e041">(9)</xref> ensure that all the mass from <inline-formula id="pcbi.1006283.e043"><alternatives><graphic id="pcbi.1006283.e043g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e043" xlink:type="simple"/><mml:math display="inline" id="M43"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006283.e044"><alternatives><graphic id="pcbi.1006283.e044g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e044" xlink:type="simple"/><mml:math display="inline" id="M44"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> gets moved, and the first equation ensures that the flow is greater or equal than zero. Here, <italic>D</italic> is the EMD. This follows the standard definition of the EMD with normalized mass. Note that the EMD with the L1 norm is equivalent to the 1st order Wasserstein distance (which is a special case of the Kantorovich formulation of the optimal transport). However, for simplicity, we use the notation of the EMD here, which uses discrete variables.</p>
<p>We solve the transport problem algorithmically as follows (<xref ref-type="supplementary-material" rid="pcbi.1006283.s002">S2 Fig</xref>). The algorithm can be intuitively interpreted (as reflected in the comments in pseudo-code) as transporting mass from <inline-formula id="pcbi.1006283.e045"><alternatives><graphic id="pcbi.1006283.e045g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e045" xlink:type="simple"/><mml:math display="inline" id="M45"><mml:msub><mml:mover accent="true"><mml:mi>w</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mi>x</mml:mi></mml:msub></mml:math></alternatives></inline-formula> to <inline-formula id="pcbi.1006283.e046"><alternatives><graphic id="pcbi.1006283.e046g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e046" xlink:type="simple"/><mml:math display="inline" id="M46"><mml:msub><mml:mover accent="true"><mml:mi>w</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mi>y</mml:mi></mml:msub></mml:math></alternatives></inline-formula>, in case <italic>Q</italic> &gt; <italic>R</italic>, with cost <italic>c</italic>(<italic>x</italic><sub><italic>q</italic></sub>, <italic>y</italic><sub><italic>r</italic></sub>).</p>
<p specific-use="line">% START ALGORITHM</p>
<p specific-use="line">SET emd = 0, <italic>q</italic> = 0, <italic>r</italic> = 0</p>
<p specific-use="line">WHILE <italic>q</italic> &lt; <italic>Q</italic> DO</p>
<p specific-use="line">% Move all the remaining mass in <italic>w</italic><sub><italic>q</italic>,<italic>x</italic></sub> to <italic>w</italic><sub><italic>r</italic>,<italic>y</italic></sub>, but do not move more than <italic>w</italic><sub><italic>r</italic>,<italic>y</italic></sub>.</p>
<p specific-use="line"> SET flow = min(<italic>w</italic><sub><italic>q</italic>,<italic>x</italic></sub>, <italic>w</italic><sub><italic>r</italic>,<italic>y</italic></sub>)</p>
<p specific-use="line">% The <italic>cost</italic> equals the amount of mast moved, <italic>flow</italic>, times the cost of moving from the time point <italic>x</italic><sub><italic>q</italic></sub> to the time point <italic>y</italic><sub><italic>r</italic></sub>.</p>
<p specific-use="line"> SET cost = flow × <italic>c</italic>(<italic>x</italic><sub><italic>q</italic></sub>, <italic>y</italic><sub><italic>r</italic></sub>)</p>
<p specific-use="line">% Add this cost to the total cost.</p>
<p specific-use="line"> SET emd = emd + cost</p>
<p specific-use="line">% Compute the remaining mass in <italic>w</italic><sub><italic>q</italic>,<italic>x</italic></sub> to be moved, which equals the</p>
<p specific-use="line">previous mass <italic>w</italic><sub><italic>q</italic>,<italic>x</italic></sub> minus the mass we just moved, <italic>flow</italic>.</p>
<p specific-use="line"> SET <italic>w</italic><sub><italic>q</italic>,<italic>x</italic></sub> = <italic>w</italic><sub><italic>q</italic>,<italic>x</italic></sub> − flow</p>
<p specific-use="line">% Compute the remaining mass in <italic>w</italic><sub><italic>r</italic>,<italic>y</italic></sub>, to which we still need to transport from <inline-formula id="pcbi.1006283.e047"><alternatives><graphic id="pcbi.1006283.e047g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e047" xlink:type="simple"/><mml:math display="inline" id="M47"><mml:msub><mml:mover accent="true"><mml:mi>w</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mi>x</mml:mi></mml:msub></mml:math></alternatives></inline-formula> in the next iterations.</p>
<p specific-use="line"> SET <italic>w</italic><sub><italic>r</italic>,<italic>y</italic></sub> = <italic>w</italic><sub><italic>r</italic>,<italic>y</italic></sub> − <italic>flow</italic></p>
<p specific-use="line">% If there is no mass left then increment the index, note that the vectors <inline-formula id="pcbi.1006283.e048"><alternatives><graphic id="pcbi.1006283.e048g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e048" xlink:type="simple"/><mml:math display="inline" id="M48"><mml:msub><mml:mover accent="true"><mml:mi>w</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mi>x</mml:mi></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006283.e049"><alternatives><graphic id="pcbi.1006283.e049g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e049" xlink:type="simple"/><mml:math display="inline" id="M49"><mml:msub><mml:mover accent="true"><mml:mi>w</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mi>y</mml:mi></mml:msub></mml:math></alternatives></inline-formula> are sorted.</p>
<p specific-use="line"> IF <italic>w</italic><sub><italic>r</italic>,<italic>y</italic></sub> = 0 THEN</p>
<p specific-use="line">  SET r = r + 1</p>
<p specific-use="line"> ENDIF</p>
<p specific-use="line"> IF <italic>w</italic><sub><italic>q</italic>,<italic>x</italic></sub> = 0 THEN</p>
<p specific-use="line">  SET q = q + 1</p>
<p specific-use="line"> ENDIF</p>
<p specific-use="line">ENDWHILE</p>
<p specific-use="line">% END ALGORITHM</p>
</list-item>
<list-item>
<p>After computing the EMDs between each pair of epochs for each neuron pair separately, with computational complexity of order <inline-formula id="pcbi.1006283.e050"><alternatives><graphic id="pcbi.1006283.e050g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e050" xlink:type="simple"/><mml:math display="inline" id="M50"><mml:mi mathvariant="script">O</mml:mi></mml:math></alternatives></inline-formula>(<italic>N</italic><sup>2</sup> <italic>M</italic><sup>2</sup> <italic>n</italic><sup>2</sup>), where <italic>n</italic> is the average number of spikes, we compute SPOTDis as the average EMD, i.e.
<disp-formula id="pcbi.1006283.e051"><alternatives><graphic id="pcbi.1006283.e051g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e051" xlink:type="simple"/><mml:math display="block" id="M51"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>D</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>m</mml:mi></mml:mrow></mml:msub> <mml:mo>≡</mml:mo> <mml:mo>(</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>&gt;</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mi>N</mml:mi></mml:msubsup> <mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi> <mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac> <mml:mo>)</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>&gt;</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mi>N</mml:mi></mml:munderover> <mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi> <mml:mi>m</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>D</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi> <mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(11)</label></disp-formula>
with
<disp-formula id="pcbi.1006283.e052"><alternatives><graphic id="pcbi.1006283.e052g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e052" xlink:type="simple"/><mml:math display="block" id="M52"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi> <mml:mi>m</mml:mi></mml:mrow></mml:msub> <mml:mo>≡</mml:mo> <mml:mtext>sgn</mml:mtext> <mml:mo>(</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>τ</mml:mi></mml:munder> <mml:msubsup><mml:mi>s</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo> <mml:mtext>sgn</mml:mtext> <mml:mo>(</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>τ</mml:mi></mml:munder> <mml:msubsup><mml:mi>s</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi>m</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo> <mml:mspace width="0.166667em"/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(12)</label></disp-formula>
where sgn is the sign function.</p>
</list-item>
</list>
<p>Computing the SPOTDis with the sparse simulation (<xref ref-type="fig" rid="pcbi.1006283.g006">Fig 6</xref>) takes 60 seconds and the computation for the example case (<xref ref-type="fig" rid="pcbi.1006283.g001">Fig 1</xref>) takes approximately 5 minutes, utilizing an Intel Xenon E5-2650 v2 2.60GHz system with 16 cores.</p>
</sec>
<sec id="sec015">
<title>HDBSCAN</title>
<p>HDBSCAN is an automated density clustering algorithm that clusters on the basis of pairwise dissimilarity matrices. An extensive overview of HDBSCAN can be found in [<xref ref-type="bibr" rid="pcbi.1006283.ref060">60</xref>, <xref ref-type="bibr" rid="pcbi.1006283.ref061">61</xref>] and we provide only a brief overview of HDBSCAN here. HDBSCAN comprises the following steps:</p>
<list list-type="order">
<list-item>
<p>After pairwise distances have been computed between all data points, HDBSCAN defines a “mutual reachability distance” between each pair of data points (in our case epochs). The mutual reachability distance is an adjustment of the distance measure that effectively acts as a smoother. For each epoch <italic>k</italic>, the core distance <inline-formula id="pcbi.1006283.e053"><alternatives><graphic id="pcbi.1006283.e053g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e053" xlink:type="simple"/><mml:math display="inline" id="M53"><mml:msubsup><mml:mi>d</mml:mi> <mml:mi>k</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>o</mml:mi> <mml:mi>r</mml:mi> <mml:mi>e</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> is defined as the SPOTDis dissimilarity, <inline-formula id="pcbi.1006283.e054"><alternatives><graphic id="pcbi.1006283.e054g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e054" xlink:type="simple"/><mml:math display="inline" id="M54"><mml:msub><mml:mover accent="true"><mml:mi>D</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> (<xref ref-type="disp-formula" rid="pcbi.1006283.e010">Eq (2)</xref>), to its <italic>n</italic><sub><italic>pts</italic></sub>th nearest neighbour <italic>m</italic>. The mutual reachability distance is then defined as <inline-formula id="pcbi.1006283.e055"><alternatives><graphic id="pcbi.1006283.e055g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e055" xlink:type="simple"/><mml:math display="inline" id="M55"><mml:mrow><mml:msubsup><mml:mi>d</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>,</mml:mo> <mml:mi>m</mml:mi></mml:mrow> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>r</mml:mi> <mml:mi>e</mml:mi> <mml:mi>a</mml:mi> <mml:mi>c</mml:mi> <mml:mi>h</mml:mi></mml:mrow></mml:msubsup> <mml:mo>≡</mml:mo> <mml:mo form="prefix" movablelimits="true">max</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:msubsup><mml:mi>d</mml:mi> <mml:mi>k</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>o</mml:mi> <mml:mi>r</mml:mi> <mml:mi>e</mml:mi></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>d</mml:mi> <mml:mi>m</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>o</mml:mi> <mml:mi>r</mml:mi> <mml:mi>e</mml:mi></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>D</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>m</mml:mi></mml:mrow></mml:msub> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. The mutual reachability distance does not alter the distance between two points that are in dense regions, but it changes the distance for points that are in low-density regions and have a relatively large <inline-formula id="pcbi.1006283.e056"><alternatives><graphic id="pcbi.1006283.e056g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e056" xlink:type="simple"/><mml:math display="inline" id="M56"><mml:msubsup><mml:mi>d</mml:mi> <mml:mi>k</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>o</mml:mi> <mml:mi>r</mml:mi> <mml:mi>e</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> distance. The purpose of transforming the distance matrix in this way is to make the clustering algorithm more robust to noise.</p>
</list-item>
<list-item>
<p>HDBSCAN then defines a minimum spanning tree, in which there is a path between all points (vertices), without any loops (i.e. an acyclic graph), such that the total weight of the edge connections is minimized. Here the edges are the mutual reachability distances.</p>
</list-item>
<list-item>
<p>HDBSCAN then constructs an hierarchical cluster dendrogram from the minimum spanning tree as follows: Initially all points are assigned to the “root”, a single cluster containing all points. HDBSCAN then sets a threshold <italic>ϵ</italic> and cuts edges from the minimum spanning tree whose weight is higher than <italic>ϵ</italic>. HDBSCAN keeps decreasing the value of <italic>ϵ</italic> such that more connections are removed and new clusters can appear, forming a cluster dendrogram. Sets of points that have fewer than <italic>n</italic><sub><italic>clSize</italic></sub> members, the minimum cluster size, at a value of <italic>ϵ</italic> are deemed noise points at that value of <italic>ϵ</italic>. Here we take the simplification <italic>n</italic><sub><italic>pts</italic></sub> = <italic>n</italic><sub><italic>clSize</italic></sub> [<xref ref-type="bibr" rid="pcbi.1006283.ref060">60</xref>], such that <italic>n</italic><sub><italic>pts</italic></sub> is the only hyperparameter, which we set to 10 here, unless specified otherwise. We use the implementation of HDBSCAN developed by [<xref ref-type="bibr" rid="pcbi.1006283.ref061">61</xref>], and all analyses and simulations were performed in Python. HDBSCAN uses either the “leaf selection” method for selecting clusters, or the “excess of mass” method. In the leaf selection method, the end branches of the hierarchical cluster dendrogram are taken as the selected clusters. In the “excess of mass” algorithm, HDBSCAN chooses the set of clusters that is most stable under a change of <italic>ϵ</italic>. This is done as follows: at some value of <italic>ϵ</italic> a cluster is born, <italic>ϵ</italic><sub><italic>max</italic></sub>, and at some point, the cluster dies, <italic>ϵ</italic><sub><italic>min</italic></sub>. For each member of the cluster we can define the value of <italic>ϵ</italic><sub><italic>k</italic></sub> where each <italic>k</italic>th member fell out, and take the stability as the sum ∑<sub><italic>k</italic></sub>1/<italic>ϵ</italic><sub><italic>k</italic></sub> − 1/<italic>ϵ</italic><sub><italic>max</italic></sub> over all members. HDBSCAN then selects in the dendrogram the optimal levels at which to cut the tree in order to maximize the stability of the selected clusters, forming a set of clusters. An advantage of this selection procedure is that it allows for clusters of varying density.</p>
</list-item>
</list>
</sec>
<sec id="sec016">
<title>t-SNE</title>
<p>T-SNE (t-distributed stochastic neighbor embedding) is a dimensionality reduction technique for high-dimensional datasets [<xref ref-type="bibr" rid="pcbi.1006283.ref062">62</xref>]. While it typically is computed starting from a high-dimensional dataset that is then converted into a matrix of pairwise Euclidean distances, here we compute it directly on the pairwise dissimilarity matrix. We first outline the algorithm of SNE [<xref ref-type="bibr" rid="pcbi.1006283.ref063">63</xref>], and after that the adjustments made in t-SNE.</p>
<list list-type="order">
<list-item>
<p>For each two data points (<italic>k</italic> and <italic>m</italic>), which represent epochs in our case, a measure of similarity is computed. This measure of similarity is taken as the conditional probability of observing <italic>m</italic> given a Gaussian distribution centered on <italic>k</italic>,
<disp-formula id="pcbi.1006283.e057"><alternatives><graphic id="pcbi.1006283.e057g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e057" xlink:type="simple"/><mml:math display="block" id="M57"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>|</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>≡</mml:mo> <mml:mfrac><mml:mrow><mml:mtext>exp</mml:mtext> <mml:mo>(</mml:mo> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>d</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>m</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn> <mml:msubsup><mml:mi>σ</mml:mi> <mml:mi>k</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>≠</mml:mo> <mml:mi>k</mml:mi></mml:mrow> <mml:mi>M</mml:mi></mml:msubsup> <mml:mtext>exp</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>d</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>l</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn> <mml:msubsup><mml:mi>σ</mml:mi> <mml:mi>k</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(13)</label></disp-formula>
Here, the standard choice for <italic>d</italic><sub><italic>km</italic></sub> is the L1 norm for a high dimensional dataset <italic>x</italic><sub>1</sub>, …, <italic>x</italic><sub><italic>M</italic></sub>, defined as <italic>d</italic><sub><italic>km</italic></sub> = ||<italic>x</italic><sub><italic>k</italic></sub> − <italic>x</italic><sub><italic>m</italic></sub>||, but we take it here as the SPOTDis, <inline-formula id="pcbi.1006283.e058"><alternatives><graphic id="pcbi.1006283.e058g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e058" xlink:type="simple"/><mml:math display="inline" id="M58"><mml:mrow><mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>m</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>D</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>. The normalization in <xref ref-type="disp-formula" rid="pcbi.1006283.e057">Eq (13)</xref> simply assures that the probabilities ∑<sub><italic>m</italic></sub> <italic>p</italic><sub><italic>m</italic>|<italic>k</italic></sub> sum to one. The variance of the Gaussian, <inline-formula id="pcbi.1006283.e059"><alternatives><graphic id="pcbi.1006283.e059g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e059" xlink:type="simple"/><mml:math display="inline" id="M59"><mml:msubsup><mml:mi>σ</mml:mi> <mml:mi>k</mml:mi> <mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula>, is determined for each data point individually, by finding <italic>σ</italic><sub><italic>k</italic></sub> to satisfy the equation
<disp-formula id="pcbi.1006283.e060"><alternatives><graphic id="pcbi.1006283.e060g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e060" xlink:type="simple"/><mml:math display="block" id="M60"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>ψ</mml:mi> <mml:mo>=</mml:mo> <mml:msup><mml:mn>2</mml:mn> <mml:mrow><mml:mi>H</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>P</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(14)</label></disp-formula>
Here, <italic>H</italic> is the entropy function using logarithm base 2, <italic>P</italic><sub><italic>k</italic></sub> is the probability distribution of all the data points given <italic>k</italic>, <italic>P</italic><sub><italic>k</italic></sub> = (<italic>p</italic><sub>1|<italic>k</italic></sub>, …, <italic>p</italic><sub><italic>M</italic>|<italic>k</italic></sub>), and <italic>ψ</italic> is the perplexity which is set by the user, which can be interpreted as a smooth measure of the effective number of neighbors each datapoint has. We set the perplexity <italic>ψ</italic> to 30, which is in the typical range used in the literature. T-SNE is generally quite insensitive to choices of the perplexity, which is usually taken in the range 5-50.</p>
</list-item>
<list-item>
<p>SNE then attempts to find a low dimensional set of data points, {<bold>y</bold><sub>1</sub>, …, <bold>y</bold><sub><italic>M</italic></sub>}, that have a similar distribution of conditional probabilities (similarities) as the distances derived from the high-dimensional counterparts. In this case the variance of the Gaussian is constant for all data points, and
<disp-formula id="pcbi.1006283.e061"><alternatives><graphic id="pcbi.1006283.e061g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e061" xlink:type="simple"/><mml:math display="block" id="M61"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>q</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>|</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>≡</mml:mo> <mml:mfrac><mml:mrow><mml:mtext>exp</mml:mtext> <mml:mo>(</mml:mo> <mml:mo>-</mml:mo> <mml:mo>|</mml:mo> <mml:mo>|</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msup><mml:mo>|</mml:mo> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>≠</mml:mo> <mml:mi>k</mml:mi></mml:mrow> <mml:mi>M</mml:mi></mml:msubsup> <mml:mrow><mml:mtext>exp</mml:mtext> <mml:mo>(</mml:mo> <mml:mo>-</mml:mo> <mml:mo>|</mml:mo> <mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi>y</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:msup><mml:mrow><mml:mo>|</mml:mo> <mml:mo>|</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(15)</label></disp-formula></p>
</list-item>
<list-item>
<p>SNE then minimizes a cost function, which in this case is the Kullback-Leibler divergence between <italic>p</italic><sub><italic>m</italic>|<italic>k</italic></sub> and <italic>q</italic><sub><italic>m</italic>|<italic>k</italic></sub> over all data points. To do that, it starts from a random sample of points (Gaussian distributed) and then performs a gradient descent, in which each point <italic>y</italic><sub><italic>k</italic></sub> is moved around depending on the attraction or repulsion from other data points (see [<xref ref-type="bibr" rid="pcbi.1006283.ref062">62</xref>]).</p>
</list-item>
</list>
<p>T-SNE makes two main adjustments relative to SNE (the rationale behind these two adjustments is extensively discussed in [<xref ref-type="bibr" rid="pcbi.1006283.ref062">62</xref>]). First, it uses a symmetric measure of similarity between two data points, as the joint probability
<disp-formula id="pcbi.1006283.e062"><alternatives><graphic id="pcbi.1006283.e062g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e062" xlink:type="simple"/><mml:math display="block" id="M62"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>|</mml:mo> <mml:mi>m</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>|</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:mn>2</mml:mn> <mml:mi>n</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(16)</label></disp-formula>
Second, it uses a Student’s t-distribution with one degree of freedom instead of a Gaussian for the low dimensional counterparts.</p>
</sec>
<sec id="sec017">
<title>Measures for cluster evaluation</title>
<sec id="sec018">
<title>ARI</title>
<p>The ARI (Adjusted Rand Index, [<xref ref-type="bibr" rid="pcbi.1006283.ref081">81</xref>]) is a measure of similarity between two data clusterings <italic>X</italic> (here the ground-truth clusters) and <italic>Y</italic> (here the empirical cluster definitions). We note that the points that are labeled as noise by HDBSCAN are, for the purpose of computing the ARI, assigned to a separate cluster. The computation of the Rand Index considers each pair of observations and determines for each pair of observations (in our case epochs) whether they agree between the two data clusterings. Agreement is defined as either: a) falling in the same cluster in <italic>X</italic> and in the same cluster in <italic>Y</italic>, or b) falling in different clusters in <italic>X</italic> and in different subsets in <italic>Y</italic>. The reason why agreement must be defined over pairs of observations is that the subset partitions do not have to be matched between <italic>X</italic> and <italic>Y</italic>, and that both can contain a different number of clusters. Disagreement is defined as falling in the same subset in <italic>X</italic> but a different subset in <italic>Y</italic>, or falling in different subsets in <italic>X</italic> but the same subset in <italic>Y</italic>. The Rand Index is then defined as the ratio of the number of agreements between the data clusterings (i.e. one epoch being assigned to the same data clusterings) over the total number of agreements and disagreements. The Adjusted Rand Index corrects for a bias in the Rand Index, by subtracting the ratio of number of agreements over disagreements that is expected by chance.</p>
</sec>
<sec id="sec019">
<title>Silhouette</title>
<p>The Silhouette score [<xref ref-type="bibr" rid="pcbi.1006283.ref082">82</xref>] is one example measure of cluster quality that does not rely on a ground truth cluster assignment, and is therefore applicable in unsupervised settings. The Silhouette score is computed as follows. For each epoch, we compute the average dissimilarity to all the epoch in the nearest cluster (which could be also the noise cluster), <italic>d</italic><sub><italic>k</italic>,<italic>nearest</italic></sub>. We then also compute the average dissimilarity to all the epochs in the same cluster as the epoch, <italic>d</italic><sub><italic>k</italic>,<italic>same</italic></sub>. We then compute the Silhouette as
<disp-formula id="pcbi.1006283.e063"><alternatives><graphic id="pcbi.1006283.e063g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e063" xlink:type="simple"/><mml:math display="block" id="M63"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>S</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>M</mml:mi></mml:mfrac> <mml:munderover><mml:mo>∑</mml:mo> <mml:mi>k</mml:mi> <mml:mi>M</mml:mi></mml:munderover> <mml:mfrac><mml:mrow><mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mi>e</mml:mi> <mml:mi>a</mml:mi> <mml:mi>r</mml:mi> <mml:mi>e</mml:mi> <mml:mi>s</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>,</mml:mo> <mml:mi>s</mml:mi> <mml:mi>a</mml:mi> <mml:mi>m</mml:mi> <mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:mo form="prefix" movablelimits="true">max</mml:mo> <mml:mo>{</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mi>e</mml:mi> <mml:mi>a</mml:mi> <mml:mi>r</mml:mi> <mml:mi>e</mml:mi> <mml:mi>s</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>,</mml:mo> <mml:mi>s</mml:mi> <mml:mi>a</mml:mi> <mml:mi>m</mml:mi> <mml:mi>e</mml:mi></mml:mrow></mml:msub> <mml:mo>}</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(17)</label></disp-formula></p>
</sec>
</sec>
<sec id="sec020">
<title>Application to neuronal data</title>
<p>One male macaque monkey performed a passive fixation task while moving bar stimuli (white bars on gray background, 0.25 degrees in visual angle width) were presented. All procedures complied with the German law for the protection of animals and were approved by the regional authority (Regierungspräsidium Darmstadt). Recordings were performed from 64 V1 channels simultaneously, obtained from a chronic Utah array implant (Blackrock). Receptive fields had eccentricities around 3-5 degrees visual angle. We performed band-pass filtering of each channel in the frequency range of action potentials (300-6000Hz) and then thresholded the band-pass filtered signal <italic>x</italic>(<italic>t</italic>) according to [<xref ref-type="bibr" rid="pcbi.1006283.ref083">83</xref>], using the threshold <inline-formula id="pcbi.1006283.e064"><alternatives><graphic id="pcbi.1006283.e064g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e064" xlink:type="simple"/><mml:math display="inline" id="M64"><mml:mrow><mml:mn>3</mml:mn> <mml:mfrac><mml:mrow><mml:mi>m</mml:mi> <mml:mi>e</mml:mi> <mml:mi>d</mml:mi> <mml:mo>{</mml:mo> <mml:mi>x</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo> <mml:mo>}</mml:mo></mml:mrow> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>6745</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>, where <italic>med</italic> is the median (i.e. effectively three standard deviations). When the signal <italic>x</italic>(<italic>t</italic>) crossed this threshold, we denoted a spike. After the detection of a threshold crossing, further threshold crossings were suppressed for 0.75ms. Moving bar stimuli were presented in four cardinal directions. Each stimulus bar was presented 20 times. We then pooled all 80 trials together, and added 80 trials containing spontaneous activity. Our aim was then to recover the separate stimulus conditions using unsupervised clustering with SPOTDisClust. We use <italic>n</italic><sub><italic>pts</italic></sub> = 3 with leaf selection for the HDBSCAN parameters.</p>
</sec>
</sec>
<sec id="sec021">
<title>Supporting information</title>
<supplementary-material id="pcbi.1006283.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006283.s001" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Illustration of the SPOTDis computation.</title>
<p>For each epoch (1), the cross-correlation is computed for each pair of neurons (2). These cross-correlations are then normalized to unit mass (3). For each pair of epochs and pair of neurons (4) we then compute the EMD. The EMDs are then averaged over all eligible neuron pairs (i.e. pairs of neurons active in both epoch <italic>k</italic> and <italic>m</italic>) to compute the SPOTDis between epochs <italic>k</italic> and <italic>m</italic>.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006283.s002" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006283.s002" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Illustration of the EMD computation.</title>
<p>Showing the first 5 iterations of the EMD algorithm on simple example cross correlation histograms. Each normalized cross-correlation (top and bottom) belongs to one epoch. In each step the mass is transported from the top epoch to the highlighted parts of the histogram and the histogram entries between which mass is transported are connected.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006283.s003" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006283.s003" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Example figure to illustrate the difference between homogeneous noise and patterned noise.</title>
<p>Simulation parameters were λ<sub><italic>in</italic></sub> = 0.35 spks/sample, λ<sub><italic>out</italic></sub> = 0.05 spks/sample, <italic>T</italic><sub><italic>epoch</italic></sub> = 300 samples, <italic>T</italic><sub><italic>pulse</italic></sub> = 30 samples. Homogeneous noise was generated according to a homogeneous Poisson process, while each patterned noise epoch was an instantiation of a unique pattern, that was randomly generated with the same statistics as the four recurring patterns (i.e. for each neuron it had the same values of the pulse duration, λ<sub><italic>in</italic></sub> and λ<sub><italic>out</italic></sub>). The t-SNE embedding shows that homogeneous noise forms a separate cluster, while patterned noise does not.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006283.s004" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006283.s004" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>HDBSCAN labels for each of the seven main figures.</title>
<p>Shown are the excess of mass (EOM) and the leaf cluster selection methods of the HDBSCAN algorithm (see <xref ref-type="sec" rid="sec013">Methods</xref>). Grey points are identified as noise points by HDBSCAN, other colors correspond to clusters.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006283.s005" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006283.s005" xlink:type="simple">
<label>S5 Fig</label>
<caption>
<title>SPOTDisClust performance for cases where there are many noise epochs and few cluster epochs.</title>
<p>Same settings as in <xref ref-type="fig" rid="pcbi.1006283.g001">Fig 1</xref>, but now using 750 noise epochs and only 30 epochs per cluster. Even though there is a very large number of noise epochs, t-SNE embedding is still able to reveal the separate clusters.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006283.s006" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006283.s006" xlink:type="simple">
<label>S6 Fig</label>
<caption>
<title>Illustration of how the EMD is a noise-robust measure of distance for spikes.</title>
<p>We consider four rate modulations (top left) each consisting of a single activation pulse and a baseline. We then generated spikes from the four rate modulations according to an inhomogeneous Poisson process (top right). The rate modulations may represent cross-correlations for neuron pairs or activation patterns for single neurons. We then varied the spike rate inside the activation period and outside the activation period, thereby changing the ratio of spikes inside the pulse period to the amount of spikes outside the pulse period (changing the SNR). We then computed the EMD between the normalized mass of rate modulation <italic>k</italic> and the spike realization of rate modulation 1, for all <italic>k</italic> = 1, …, 4, defined as Δ<sub><italic>k</italic></sub>. Here the pattern mass can be interpreted as an average of many spike train realizations of that rate modulation. The figure on the bottom left shows, across many spike train realizations of rate modulation 1, ΔEMD(<italic>k</italic>) = Δ<sub><italic>k</italic></sub> − Δ<sub>1</sub>. The dashed lines indicate the EMD between the different patterns. Thus, a value of ΔEMD(<italic>k</italic>) &gt; 0 indicates that the spike train has a lower EMD to its own corresponding rate modulation than to another rate modulation, i.e. it indicates that the assignment of spike train to rate modulation based on the EMD would be correct. We find that as long as the spike count SNR—which we define as the ratio of spikes inside the pulse period to the amount of spikes outside the pulse period—exceeds 1, the minimum value of Δ<sub><italic>k</italic></sub> occurs when <italic>k</italic> = 1, that is when the EMD is computed between the realization and its corresponding rate modulation (<xref ref-type="supplementary-material" rid="pcbi.1006283.s006">S6 Fig</xref>). Even when the SNR drops significantly below 1, this holds true. Thus, the proximity of a rate modulation to its realization, in terms of EMD, is highly robust to the insertion of noise spikes around the activation pulse period. We find that the same principle holds approximately true when comparing the EMD between two spike train realizations from the same rate modulation vs. spike train realizations from other rate modulation (bottom right). The robustness to insertion of spikes around the activation period can be intuitively understood from the behavior of the EMD transport distance: When comparing e.g. a realization of rate modulation 1 with the mass of pattern 2, we need to move points out of the pulse period of rate modulation 1, move points into the activation period of rate modulation 2, as well as spreading out spike energy to minimize the distance to the baseline. In contrast, when comparing spikes to the same rate modulation, the transport cost only consists of moving a few points in or out of the pulse period, and spreading the points around to minimize the distance to the baseline.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006283.s007" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006283.s007" xlink:type="simple">
<label>S7 Fig</label>
<caption>
<title>Dependence of clustering performance on spike sorting contamination.</title>
<p>(A) Five patterns were generated for a total of 330 neurons, with λ<sub><italic>in</italic></sub> = 0.15 spks/sample, λ<sub><italic>out</italic></sub> = 0.01 spks/sample. Each group of 11 subsequent neurons was assigned to one “virtual electrode”. From this virtual electrode, we then only “recorded” one neuron. The activity of each recorded neuron was then contaminated by randomly inserting spikes from the other “hidden’ neurons. Both the number of contaminating “hidden’ neurons and the fraction of contaminating spikes, as compared to the total number of spikes of each “hidden” neuron, was varied. For example, a value of 5 contaminating neurons and 50% contaminating spikes indicated that 50% of spikes from each of the 5 contaminating “hidden” neurons was added to the recorded neuron. On the left and middle, an original realization of a spike pattern and the observed spike trains after contamination (10 contaminating neurons and each “hidden” neuron contaminating with 100% of its spikes). The table on the right shows the clustering performance compared with the ground-truth (ARI) as a function of spike contamination parameters. B) Patterns were defined using the same firing statistics as in <xref ref-type="fig" rid="pcbi.1006283.g001">Fig 1</xref>. Each group of 5 subsequent neurons was assigned to a “virtual electrode”. The output of all neurons was observed in this case. For each epoch, we then randomly exchanged spikes among the 5 neurons. A contamination probability of 0.25 meant that each spike had a probability of 0.25 to be transferred to another randomly chosen neuron, i.e. inserted into the spike train of that other neuron. On the left and middle are respectively shown the original spike train output, and the resulting spike train pattern after contamination. On the right is shown the HDBSCAN clustering performance compared to ground-truth (ARI) with standard deviations (across 5 repetitions of the simulation).</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006283.s008" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006283.s008" xlink:type="simple">
<label>S8 Fig</label>
<caption>
<title>Dependence of clustering performance on spike sorting errors resulting from collisions.</title>
<p>The simulations are based on the same firing statistics reported for <xref ref-type="fig" rid="pcbi.1006283.g001">Fig 1</xref>. Neurons were divided into 10 groups of subsequent 5 neurons, each constituting a “virtual electrode”. Whenever two neurons fired simultaneously (i.e. at the same sample) within the group of 5, we removed the two spikes with a certain collision probability. The spike rasters on the left and middle panel show, respectively, an original spike train realization from a pattern and the spike train realization after removing the colliding spikes with 100% collision probability. The panel on the right shows HDBSCAN clustering performance compared to ground-truth (ARI) as a function of collision probability, with standard deviations. Same as (A), but now all neurons within a group of 5 fire according to identical patterns, which strongly increases the amount of collisions, and deteriorates clustering performance as collision probability increases.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006283.s009" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006283.s009" xlink:type="simple">
<label>S9 Fig</label>
<caption>
<title>Clustering performance for a case with precise spike sequences.</title>
<p>Five patterns were defined by selecting for each pattern a random time point at which the neuron would fire a spike. In addition, we inserted a varying number of noise spikes per neuron according to a homogeneous Poisson process, and also varied the amount of temporal jitter in the pattern spikes. The left panel shows an example for one such pattern, where the pattern spikes are displayed in black and the noise spikes are colored gray. The right panel shows the HDBSCAN cluster quality as compared to ground truth (ARI) with a varying number of noise spikes along with applying an increasing amount of temporal jitter to the pattern spikes. The maximum jitter denoted on the x-axis is defined as a percentage of the total interval length, from which a perturbation value is chosen with uniform probability, for each pattern spike individually. This means that a maximum jitter of 100% corresponds to a jitter chosen uniformly from [−<italic>T</italic>, <italic>T</italic>], and 20% corresponds to a jitter uniformly chosen from [−0.2<italic>T</italic>, 0.2<italic>T</italic>]. Spikes that are perturbed such that they fall outside of the epoch’s time interval are still considered to be part of the epoch.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006283.s010" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006283.s010" xlink:type="simple">
<label>S10 Fig</label>
<caption>
<title>Application to neuronal data, matching <xref ref-type="fig" rid="pcbi.1006283.g008">Fig 8</xref>.</title>
<p>For each multi-unit, we computed the spike count in the same temporal window as used for the SPOTDisClust clustering, denoted <italic>r</italic><sub><italic>ik</italic></sub> (epoch <italic>k</italic>, unit <italic>i</italic>). In (A), we then constructed a normalized population vector as <inline-formula id="pcbi.1006283.e065"><alternatives><graphic id="pcbi.1006283.e065g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e065" xlink:type="simple"/><mml:math display="inline" id="M65"><mml:mrow><mml:msubsup><mml:mi>r</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup> <mml:mo>=</mml:mo> <mml:msub><mml:mi>r</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>/</mml:mo> <mml:msub><mml:mo>∑</mml:mo> <mml:mi>i</mml:mi></mml:msub> <mml:msub><mml:mi>r</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> for each multi-unit <italic>i</italic>. We then constructed all pairwise distances between epochs <italic>k</italic> and <italic>m</italic> as the L1-norm among these normalized population vectors, <inline-formula id="pcbi.1006283.e066"><alternatives><graphic id="pcbi.1006283.e066g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e066" xlink:type="simple"/><mml:math display="inline" id="M66"><mml:mrow><mml:msubsup><mml:mi>D</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>m</mml:mi></mml:mrow> <mml:mrow><mml:mi>r</mml:mi> <mml:mi>a</mml:mi> <mml:mi>t</mml:mi> <mml:mi>e</mml:mi></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>N</mml:mi></mml:mfrac> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:msubsup> <mml:mrow><mml:mo>|</mml:mo> <mml:msubsup><mml:mi>r</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>r</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>m</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup> <mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Based on these pairwise distances, we then performed low dimensional t-SNE embedding and HDBSCAN clustering. Shown are the distance matrix, as well as the t-SNE with true labels and cluster labels. The clustering and low-dimensional embedding is unable to separate out all four stimulus directions. In (B), we defined the pairwise distances as the L1-norm on the absolute spike counts, i.e. <inline-formula id="pcbi.1006283.e067"><alternatives><graphic id="pcbi.1006283.e067g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006283.e067" xlink:type="simple"/><mml:math display="inline" id="M67"><mml:mrow><mml:msubsup><mml:mi>D</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>m</mml:mi></mml:mrow> <mml:mrow><mml:mi>r</mml:mi> <mml:mi>a</mml:mi> <mml:mi>t</mml:mi> <mml:mi>e</mml:mi></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>N</mml:mi></mml:mfrac> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:msubsup> <mml:mrow><mml:mo>|</mml:mo> <mml:msub><mml:mi>r</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>r</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>m</mml:mi></mml:mrow></mml:msub> <mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, and then performed t-SNE and HDBSCAN clustering. Like in (A), this clustering procedure fails to separate all four stimulus directions.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006283.s011" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006283.s011" xlink:type="simple">
<label>S11 Fig</label>
<caption>
<title>Dependence of clustering performance on chosen window length and temporal jitter of spike pattern onset.</title>
<p>The parameter settings for the patterns underlying this figure are equivalent to <xref ref-type="fig" rid="pcbi.1006283.g001">Fig 1</xref>. Each pattern has a length of 300 samples, and is embedded in a larger window starting from -300 samples to +300 samples, with homogeneous noise surrounding the pattern on the left and right. The onset of the pattern is -150 samples plus some random offset Δ<italic>t</italic><sub><italic>w</italic></sub>. For each epoch realization, the value of Δ<italic>t</italic><sub><italic>w</italic></sub> was randomly chosen with uniform probability from an interval determined by the maximum window offset (max offset of 100 meant that Δ<italic>t</italic><sub><italic>w</italic></sub> ∈ [−100, 100]). A value of Δ<italic>t</italic><sub><italic>w</italic></sub> = −50 then meant that the sequence started at -200 samples and ended at 100 samples. For the clustering, we then assume that the sequence duration is unknown. We select a window ranging from −<italic>T</italic><sub><italic>w</italic></sub>/2 to +<italic>T</italic><sub><italic>w</italic></sub>/2 samples of length <italic>T</italic><sub><italic>w</italic></sub>. In case of <italic>T</italic><sub><italic>w</italic></sub> = 300 and no offset (Δ<italic>t</italic><sub><italic>w</italic></sub> = 0), the generated data matches the simulation of 1. Clustering performance was measured relative to ground-truth (ARI) and with an unsupervised performance measure, Silhouette (see <xref ref-type="sec" rid="sec013">Methods</xref>). Clustering performance decreased as the maximum window offset increased, due to the inclusion of noise spikes around the spike pattern. Clustering performance peaked around <italic>T</italic><sub><italic>w</italic></sub> = 300 samples for both ARI and Silhouette as <italic>T</italic><sub><italic>w</italic></sub>. indicating that we can determine the “optimal” window length in an unsupervised manner when the sequence duration is unknown.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006283.s012" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006283.s012" xlink:type="simple">
<label>S12 Fig</label>
<caption>
<title>Application to neuronal data of window length selection, matching <xref ref-type="fig" rid="pcbi.1006283.g008">Fig 8</xref>.</title>
<p>We repeated the clustering with different window length selections. Windows were centered on 180 ms, the center of the 360 ms stimulation period. Clustering performance, measured both with a ground-truth performance measure (ARI) and an unsupervised cluster quality score (Silhouette), peaked at the window length of 360 ms. Large window lengths lead to an inclusion of baseline firing, decreasing clustering performance, whereas smaller window lengths also deteriorated performance. ARI and Silhouette scores showed a tight correspondence, showing the feasibility of using Silhouette score to “optimize” the window length for sequence detection.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006283.s013" mimetype="text/csv" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006283.s013" xlink:type="simple">
<label>S1 Data</label>
<caption>
<title>Data item for <xref ref-type="fig" rid="pcbi.1006283.g008">Fig 8</xref>.</title>
<p>The four columns correspond to spike times (column 1), for different MU channels (column 2), in different epochs (column 3) belonging to different conditions (either one of four stimulus conditions, or noise epochs).</p>
<p>(CSV)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>Dr. Michael Schmid, Dr. Katharine Shapcott, Dr. Joscha Schmiedt, Dr. Richard Saunders, Dr. Pascal Fries, Cem Uran and Alina Peters were responsible for the collection and preprocessing of the experimental monkey V1 data, with financial support from DFG Emmy Nother grant 2806 (Dr. Michael Schmid). We thank Dr. Felix Effenberger for inspiring discussions on this topic and helpful comments.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1006283.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Luczak</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>McNaughton</surname> <given-names>BL</given-names></name>, <name name-style="western"><surname>Harris</surname> <given-names>KD</given-names></name>. <article-title>Packet-based communication in the cortex</article-title>. <source>Nat Rev Neurosci</source>. <year>2015</year>;<volume>16</volume>(<issue>12</issue>):<fpage>745</fpage>–<lpage>55</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nrn4026" xlink:type="simple">10.1038/nrn4026</ext-link></comment> <object-id pub-id-type="pmid">26507295</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ikegaya</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Aaron</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Cossart</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Aronov</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Lampl</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Ferster</surname> <given-names>D</given-names></name>, <etal>et al</etal>. <article-title>Synfire chains and cortical songs: temporal modules of cortical activity</article-title>. <source>Science</source>. <year>2004</year>;<volume>304</volume>(<issue>5670</issue>):<fpage>559</fpage>–<lpage>64</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.1093173" xlink:type="simple">10.1126/science.1093173</ext-link></comment> <object-id pub-id-type="pmid">15105494</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Vinck</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Lima</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Womelsdorf</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Oostenveld</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Singer</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Neuenschwander</surname> <given-names>S</given-names></name>, <etal>et al</etal>. <article-title>Gamma-phase shifting in awake monkey visual cortex</article-title>. <source>J Neurosci</source>. <year>2010</year>;<volume>30</volume>(<issue>4</issue>):<fpage>1250</fpage>–<lpage>7</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1523/JNEUROSCI.1623-09.2010" xlink:type="simple">10.1523/JNEUROSCI.1623-09.2010</ext-link></comment> <object-id pub-id-type="pmid">20107053</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Siegel</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Warden</surname> <given-names>MR</given-names></name>, <name name-style="western"><surname>Miller</surname> <given-names>EK</given-names></name>. <article-title>Phase-dependent neuronal coding of objects in short-term memory</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2009</year>;<volume>106</volume>(<issue>50</issue>):<fpage>21341</fpage>–<lpage>6</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.0908193106" xlink:type="simple">10.1073/pnas.0908193106</ext-link></comment> <object-id pub-id-type="pmid">19926847</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Havenith</surname> <given-names>MN</given-names></name>, <name name-style="western"><surname>Yu</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Biederlack</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>NH</given-names></name>, <name name-style="western"><surname>Singer</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Nikolic</surname> <given-names>D</given-names></name>. <article-title>Synchrony makes neurons fire in sequence, and stimulus properties determine who is ahead</article-title>. <source>J Neurosci</source>. <year>2011</year>;<volume>31</volume>(<issue>23</issue>):<fpage>8570</fpage>–<lpage>84</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1523/JNEUROSCI.2817-10.2011" xlink:type="simple">10.1523/JNEUROSCI.2817-10.2011</ext-link></comment> <object-id pub-id-type="pmid">21653861</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Konig</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Engel</surname> <given-names>AK</given-names></name>, <name name-style="western"><surname>Roelfsema</surname> <given-names>PR</given-names></name>, <name name-style="western"><surname>Singer</surname> <given-names>W</given-names></name>. <article-title>How precise is neuronal synchronization?</article-title> <source>Neural Comput</source>. <year>1995</year>;<volume>7</volume>(<issue>3</issue>):<fpage>469</fpage>–<lpage>85</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1162/neco.1995.7.3.469" xlink:type="simple">10.1162/neco.1995.7.3.469</ext-link></comment> <object-id pub-id-type="pmid">8935960</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lu</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Liang</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>X</given-names></name>. <article-title>Temporal and rate representations of time-varying signals in the auditory cortex of awake primates</article-title>. <source>Nat Neurosci</source>. <year>2001</year>;<volume>4</volume>(<issue>11</issue>):<fpage>1131</fpage>–<lpage>8</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn737" xlink:type="simple">10.1038/nn737</ext-link></comment> <object-id pub-id-type="pmid">11593234</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gerstner</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Kempter</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>van Hemmen</surname> <given-names>JL</given-names></name>, <name name-style="western"><surname>Wagner</surname> <given-names>H</given-names></name>. <article-title>A neuronal learning rule for sub-millisecond temporal coding</article-title>. <source>Nature</source>. <year>1996</year>;<volume>383</volume>(<issue>6595</issue>):<fpage>76</fpage>–<lpage>81</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/383076a0" xlink:type="simple">10.1038/383076a0</ext-link></comment> <object-id pub-id-type="pmid">8779718</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wehr</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Laurent</surname> <given-names>G</given-names></name>. <article-title>Odour encoding by temporal sequences of firing in oscillating neural assemblies</article-title>. <source>Nature</source>. <year>1996</year>;<volume>384</volume>(<issue>6605</issue>):<fpage>162</fpage>–<lpage>6</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/384162a0" xlink:type="simple">10.1038/384162a0</ext-link></comment> <object-id pub-id-type="pmid">8906790</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Memmesheimer</surname> <given-names>RM</given-names></name>, <name name-style="western"><surname>Rubin</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Olveczky</surname> <given-names>BP</given-names></name>, <name name-style="western"><surname>Sompolinsky</surname> <given-names>H</given-names></name>. <article-title>Learning precisely timed spikes</article-title>. <source>Neuron</source>. <year>2014</year>;<volume>82</volume>(<issue>4</issue>):<fpage>925</fpage>–<lpage>38</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2014.03.026" xlink:type="simple">10.1016/j.neuron.2014.03.026</ext-link></comment> <object-id pub-id-type="pmid">24768299</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Abbott</surname> <given-names>LF</given-names></name>, <name name-style="western"><surname>Blum</surname> <given-names>KI</given-names></name>. <article-title>Functional significance of long-term potentiation for sequence learning and prediction</article-title>. <source>Cereb Cortex</source>. <year>1996</year>;<volume>6</volume>(<issue>3</issue>):<fpage>406</fpage>–<lpage>16</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/cercor/6.3.406" xlink:type="simple">10.1093/cercor/6.3.406</ext-link></comment> <object-id pub-id-type="pmid">8670667</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref012">
<label>12</label>
<mixed-citation publication-type="other" xlink:type="simple">Huh D, Sejnowski TJ. Gradient Descent for Spiking Neural Networks. arXiv preprint arXiv:170604698. 2017;.</mixed-citation>
</ref>
<ref id="pcbi.1006283.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Fiete</surname> <given-names>IR</given-names></name>, <name name-style="western"><surname>Senn</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>CZ</given-names></name>, <name name-style="western"><surname>Hahnloser</surname> <given-names>RH</given-names></name>. <article-title>Spike-time-dependent plasticity and heterosynaptic competition organize networks to produce long scale-free sequences of neural activity</article-title>. <source>Neuron</source>. <year>2010</year>;<volume>65</volume>(<issue>4</issue>):<fpage>563</fpage>–<lpage>76</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2010.02.003" xlink:type="simple">10.1016/j.neuron.2010.02.003</ext-link></comment> <object-id pub-id-type="pmid">20188660</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Laje</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Buonomano</surname> <given-names>DV</given-names></name>. <article-title>Robust timing and motor patterns by taming chaos in recurrent neural networks</article-title>. <source>Nat Neurosci</source>. <year>2013</year>;<volume>16</volume>(<issue>7</issue>):<fpage>925</fpage>–<lpage>33</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn.3405" xlink:type="simple">10.1038/nn.3405</ext-link></comment> <object-id pub-id-type="pmid">23708144</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hahnloser</surname> <given-names>RH</given-names></name>, <name name-style="western"><surname>Kozhevnikov</surname> <given-names>AA</given-names></name>, <name name-style="western"><surname>Fee</surname> <given-names>MS</given-names></name>. <article-title>An ultra-sparse code underlies the generation of neural sequences in a songbird</article-title>. <source>Nature</source>. <year>2002</year>;<volume>419</volume>(<issue>6902</issue>):<fpage>65</fpage>–<lpage>70</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature00974" xlink:type="simple">10.1038/nature00974</ext-link></comment> <object-id pub-id-type="pmid">12214232</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Carr</surname> <given-names>MF</given-names></name>, <name name-style="western"><surname>Jadhav</surname> <given-names>SP</given-names></name>, <name name-style="western"><surname>Frank</surname> <given-names>LM</given-names></name>. <article-title>Hippocampal replay in the awake state: a potential substrate for memory consolidation and retrieval</article-title>. <source>Nat Neurosci</source>. <year>2011</year>;<volume>14</volume>(<issue>2</issue>):<fpage>147</fpage>–<lpage>53</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn.2732" xlink:type="simple">10.1038/nn.2732</ext-link></comment> <object-id pub-id-type="pmid">21270783</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Foster</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>Wilson</surname> <given-names>MA</given-names></name>. <article-title>Reverse replay of behavioural sequences in hippocampal place cells during the awake state</article-title>. <source>Nature</source>. <year>2006</year>;<volume>440</volume>(<issue>7084</issue>):<fpage>680</fpage>–<lpage>3</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature04587" xlink:type="simple">10.1038/nature04587</ext-link></comment> <object-id pub-id-type="pmid">16474382</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dragoi</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Tonegawa</surname> <given-names>S</given-names></name>. <article-title>Preplay of future place cell sequences by hippocampal cellular assemblies</article-title>. <source>Nature</source>. <year>2011</year>;<volume>469</volume>(<issue>7330</issue>):<fpage>397</fpage>–<lpage>401</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature09633" xlink:type="simple">10.1038/nature09633</ext-link></comment> <object-id pub-id-type="pmid">21179088</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Johnson</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Redish</surname> <given-names>AD</given-names></name>. <article-title>Neural ensembles in CA3 transiently encode paths forward of the animal at a decision point</article-title>. <source>J Neurosci</source>. <year>2007</year>;<volume>27</volume>(<issue>45</issue>):<fpage>12176</fpage>–<lpage>89</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1523/JNEUROSCI.3761-07.2007" xlink:type="simple">10.1523/JNEUROSCI.3761-07.2007</ext-link></comment> <object-id pub-id-type="pmid">17989284</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Nadasdy</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Hirase</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Czurko</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Csicsvari</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Buzsaki</surname> <given-names>G</given-names></name>. <article-title>Replay and time compression of recurring spike sequences in the hippocampus</article-title>. <source>J Neurosci</source>. <year>1999</year>;<volume>19</volume>(<issue>21</issue>):<fpage>9497</fpage>–<lpage>507</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1523/JNEUROSCI.19-21-09497.1999" xlink:type="simple">10.1523/JNEUROSCI.19-21-09497.1999</ext-link></comment> <object-id pub-id-type="pmid">10531452</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pfeiffer</surname> <given-names>BE</given-names></name>, <name name-style="western"><surname>Foster</surname> <given-names>DJ</given-names></name>. <article-title>Hippocampal place-cell sequences depict future paths to remembered goals</article-title>. <source>Nature</source>. <year>2013</year>;<volume>497</volume>(<issue>7447</issue>):<fpage>74</fpage>–<lpage>9</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature12112" xlink:type="simple">10.1038/nature12112</ext-link></comment> <object-id pub-id-type="pmid">23594744</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Skaggs</surname> <given-names>WE</given-names></name>, <name name-style="western"><surname>McNaughton</surname> <given-names>BL</given-names></name>. <article-title>Replay of neuronal firing sequences in rat hippocampus during sleep following spatial experience</article-title>. <source>Science</source>. <year>1996</year>;<volume>271</volume>(<issue>5257</issue>):<fpage>1870</fpage>–<lpage>3</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.271.5257.1870" xlink:type="simple">10.1126/science.271.5257.1870</ext-link></comment> <object-id pub-id-type="pmid">8596957</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Euston</surname> <given-names>DR</given-names></name>, <name name-style="western"><surname>Tatsuno</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>McNaughton</surname> <given-names>BL</given-names></name>. <article-title>Fast-forward playback of recent memory sequences in prefrontal cortex during sleep</article-title>. <source>Science</source>. <year>2007</year>;<volume>318</volume>(<issue>5853</issue>):<fpage>1147</fpage>–<lpage>50</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.1148979" xlink:type="simple">10.1126/science.1148979</ext-link></comment> <object-id pub-id-type="pmid">18006749</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Peyrache</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Khamassi</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Benchenane</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Wiener</surname> <given-names>SI</given-names></name>, <name name-style="western"><surname>Battaglia</surname> <given-names>FP</given-names></name>. <article-title>Replay of rule-learning related neural patterns in the prefrontal cortex during sleep</article-title>. <source>Nat Neurosci</source>. <year>2009</year>;<volume>12</volume>(<issue>7</issue>):<fpage>919</fpage>–<lpage>26</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn.2337" xlink:type="simple">10.1038/nn.2337</ext-link></comment> <object-id pub-id-type="pmid">19483687</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pastalkova</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Itskov</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Amarasingham</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Buzsaki</surname> <given-names>G</given-names></name>. <article-title>Internally generated cell assembly sequences in the rat hippocampus</article-title>. <source>Science</source>. <year>2008</year>;<volume>321</volume>(<issue>5894</issue>):<fpage>1322</fpage>–<lpage>7</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.1159775" xlink:type="simple">10.1126/science.1159775</ext-link></comment> <object-id pub-id-type="pmid">18772431</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dan</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Poo</surname> <given-names>MM</given-names></name>. <article-title>Spike timing-dependent plasticity of neural circuits</article-title>. <source>Neuron</source>. <year>2004</year>;<volume>44</volume>(<issue>1</issue>):<fpage>23</fpage>–<lpage>30</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2004.09.007" xlink:type="simple">10.1016/j.neuron.2004.09.007</ext-link></comment> <object-id pub-id-type="pmid">15450157</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Markram</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Lubke</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Frotscher</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Sakmann</surname> <given-names>B</given-names></name>. <article-title>Regulation of synaptic efficacy by coincidence of postsynaptic APs and EPSPs</article-title>. <source>Science</source>. <year>1997</year>;<volume>275</volume>(<issue>5297</issue>):<fpage>213</fpage>–<lpage>5</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.275.5297.213" xlink:type="simple">10.1126/science.275.5297.213</ext-link></comment> <object-id pub-id-type="pmid">8985014</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Abbott</surname> <given-names>LF</given-names></name>, <name name-style="western"><surname>Nelson</surname> <given-names>SB</given-names></name>. <article-title>Synaptic plasticity: taming the beast</article-title>. <source>Nat Neurosci</source>. <year>2000</year>;<volume>3</volume> <issue>Suppl</issue>:<fpage>1178</fpage>–<lpage>83</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/81453" xlink:type="simple">10.1038/81453</ext-link></comment> <object-id pub-id-type="pmid">11127835</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Buzsaki</surname> <given-names>G</given-names></name>. <article-title>Two-stage model of memory trace formation: a role for “noisy” brain states</article-title>. <source>Neuroscience</source>. <year>1989</year>;<volume>31</volume>(<issue>3</issue>):<fpage>551</fpage>–<lpage>70</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/0306-4522(89)90423-5" xlink:type="simple">10.1016/0306-4522(89)90423-5</ext-link></comment> <object-id pub-id-type="pmid">2687720</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Benchenane</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Peyrache</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Khamassi</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Tierney</surname> <given-names>PL</given-names></name>, <name name-style="western"><surname>Gioanni</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Battaglia</surname> <given-names>FP</given-names></name>, <etal>et al</etal>. <article-title>Coherent theta oscillations and reorganization of spike timing in the hippocampal- prefrontal network upon learning</article-title>. <source>Neuron</source>. <year>2010</year>;<volume>66</volume>(<issue>6</issue>):<fpage>921</fpage>–<lpage>36</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2010.05.013" xlink:type="simple">10.1016/j.neuron.2010.05.013</ext-link></comment> <object-id pub-id-type="pmid">20620877</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sejnowski</surname> <given-names>TJ</given-names></name>, <name name-style="western"><surname>Paulsen</surname> <given-names>O</given-names></name>. <article-title>Network oscillations: emerging computational principles</article-title>. <source>J Neurosci</source>. <year>2006</year>;<volume>26</volume>(<issue>6</issue>):<fpage>1673</fpage>–<lpage>6</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1523/JNEUROSCI.3737-05d.2006" xlink:type="simple">10.1523/JNEUROSCI.3737-05d.2006</ext-link></comment> <object-id pub-id-type="pmid">16467514</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Suri</surname> <given-names>RE</given-names></name>, <name name-style="western"><surname>Sejnowski</surname> <given-names>TJ</given-names></name>. <article-title>Spike propagation synchronized by temporally asymmetric Hebbian learning</article-title>. <source>Biol Cybern</source>. <year>2002</year>;<volume>87</volume>(<issue>5-6</issue>):<fpage>440</fpage>–<lpage>5</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s00422-002-0355-9" xlink:type="simple">10.1007/s00422-002-0355-9</ext-link></comment> <object-id pub-id-type="pmid">12461633</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lee</surname> <given-names>AK</given-names></name>, <name name-style="western"><surname>Wilson</surname> <given-names>MA</given-names></name>. <article-title>Memory of sequential experience in the hippocampus during slow wave sleep</article-title>. <source>Neuron</source>. <year>2002</year>;<volume>36</volume>(<issue>6</issue>):<fpage>1183</fpage>–<lpage>94</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/S0896-6273(02)01096-6" xlink:type="simple">10.1016/S0896-6273(02)01096-6</ext-link></comment> <object-id pub-id-type="pmid">12495631</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Drew</surname> <given-names>PJ</given-names></name>, <name name-style="western"><surname>Abbott</surname> <given-names>LF</given-names></name>. <article-title>Extending the effects of spike-timing-dependent plasticity to behavioral timescales</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2006</year>;<volume>103</volume>(<issue>23</issue>):<fpage>8876</fpage>–<lpage>81</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.0600676103" xlink:type="simple">10.1073/pnas.0600676103</ext-link></comment> <object-id pub-id-type="pmid">16731625</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>van Rossum</surname> <given-names>MC</given-names></name>, <name name-style="western"><surname>Bi</surname> <given-names>GQ</given-names></name>, <name name-style="western"><surname>Turrigiano</surname> <given-names>GG</given-names></name>. <article-title>Stable Hebbian learning from spike timing-dependent plasticity</article-title>. <source>J Neurosci</source>. <year>2000</year>;<volume>20</volume>(<issue>23</issue>):<fpage>8812</fpage>–<lpage>21</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1523/JNEUROSCI.20-23-08812.2000" xlink:type="simple">10.1523/JNEUROSCI.20-23-08812.2000</ext-link></comment> <object-id pub-id-type="pmid">11102489</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Maass</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Natschlager</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Markram</surname> <given-names>H</given-names></name>. <article-title>Real-time computing without stable states: a new framework for neural computation based on perturbations</article-title>. <source>Neural Comput</source>. <year>2002</year>;<volume>14</volume>(<issue>11</issue>):<fpage>2531</fpage>–<lpage>60</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1162/089976602760407955" xlink:type="simple">10.1162/089976602760407955</ext-link></comment> <object-id pub-id-type="pmid">12433288</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref037">
<label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lazar</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Pipa</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Triesch</surname> <given-names>J</given-names></name>. <article-title>SORN: a self-organizing recurrent neural network</article-title>. <source>Front Comput Neurosci</source>. <year>2009</year>;<volume>3</volume>:<fpage>23</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3389/neuro.10.023.2009" xlink:type="simple">10.3389/neuro.10.023.2009</ext-link></comment> <object-id pub-id-type="pmid">19893759</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref038">
<label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Singer</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Lazar</surname> <given-names>A</given-names></name>. <article-title>Does the Cerebral Cortex Exploit High-Dimensional, Non-linear Dynamics for Information Processing?</article-title> <source>Front Comput Neurosci</source>. <year>2016</year>;<volume>10</volume>:<fpage>99</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3389/fncom.2016.00099" xlink:type="simple">10.3389/fncom.2016.00099</ext-link></comment> <object-id pub-id-type="pmid">27713697</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref039">
<label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Buonomano</surname> <given-names>DV</given-names></name>, <name name-style="western"><surname>Maass</surname> <given-names>W</given-names></name>. <article-title>State-dependent computations: spatiotemporal processing in cortical networks</article-title>. <source>Nat Rev Neurosci</source>. <year>2009</year>;<volume>10</volume>(<issue>2</issue>):<fpage>113</fpage>–<lpage>25</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nrn2558" xlink:type="simple">10.1038/nrn2558</ext-link></comment> <object-id pub-id-type="pmid">19145235</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref040">
<label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lukoševičius</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Jaeger</surname> <given-names>H</given-names></name>. <article-title>Reservoir computing approaches to recurrent neural network training</article-title>. <source>Computer Science Review</source>. <year>2009</year>;<volume>3</volume>(<issue>3</issue>):<fpage>127</fpage>–<lpage>149</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cosrev.2009.03.005" xlink:type="simple">10.1016/j.cosrev.2009.03.005</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref041">
<label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Jun</surname> <given-names>JJ</given-names></name>, <name name-style="western"><surname>Steinmetz</surname> <given-names>NA</given-names></name>, <name name-style="western"><surname>Siegle</surname> <given-names>JH</given-names></name>, <name name-style="western"><surname>Denman</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>Bauza</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Barbarits</surname> <given-names>B</given-names></name>, <etal>et al</etal>. <article-title>Fully integrated silicon probes for high-density recording of neural activity</article-title>. <source>Nature</source>. <year>2017</year>;<volume>551</volume>(<issue>7679</issue>):<fpage>232</fpage>–<lpage>236</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature24636" xlink:type="simple">10.1038/nature24636</ext-link></comment> <object-id pub-id-type="pmid">29120427</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref042">
<label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Stevenson</surname> <given-names>IH</given-names></name>, <name name-style="western"><surname>Kording</surname> <given-names>KP</given-names></name>. <article-title>How advances in neural recording affect data analysis</article-title>. <source>Nat Neurosci</source>. <year>2011</year>;<volume>14</volume>(<issue>2</issue>):<fpage>139</fpage>–<lpage>42</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn.2731" xlink:type="simple">10.1038/nn.2731</ext-link></comment> <object-id pub-id-type="pmid">21270781</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref043">
<label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lee</surname> <given-names>AK</given-names></name>, <name name-style="western"><surname>Wilson</surname> <given-names>MA</given-names></name>. <article-title>A combinatorial method for analyzing sequential firing patterns involving an arbitrary number of neurons based on relative time order</article-title>. <source>J Neurophysiol</source>. <year>2004</year>;<volume>92</volume>(<issue>4</issue>):<fpage>2555</fpage>–<lpage>73</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1152/jn.01030.2003" xlink:type="simple">10.1152/jn.01030.2003</ext-link></comment> <object-id pub-id-type="pmid">15212425</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref044">
<label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Davidson</surname> <given-names>TJ</given-names></name>, <name name-style="western"><surname>Kloosterman</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Wilson</surname> <given-names>MA</given-names></name>. <article-title>Hippocampal replay of extended experience</article-title>. <source>Neuron</source>. <year>2009</year>;<volume>63</volume>(<issue>4</issue>):<fpage>497</fpage>–<lpage>507</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2009.07.027" xlink:type="simple">10.1016/j.neuron.2009.07.027</ext-link></comment> <object-id pub-id-type="pmid">19709631</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref045">
<label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Luczak</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Bartho</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Harris</surname> <given-names>KD</given-names></name>. <article-title>Spontaneous events outline the realm of possible sensory responses in neocortical populations</article-title>. <source>Neuron</source>. <year>2009</year>;<volume>62</volume>(<issue>3</issue>):<fpage>413</fpage>–<lpage>25</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2009.03.014" xlink:type="simple">10.1016/j.neuron.2009.03.014</ext-link></comment> <object-id pub-id-type="pmid">19447096</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref046">
<label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lopes-dos-Santos</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Ribeiro</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Tort</surname> <given-names>AB</given-names></name>. <article-title>Detecting cell assemblies in large neuronal populations</article-title>. <source>J Neurosci Methods</source>. <year>2013</year>;<volume>220</volume>(<issue>2</issue>):<fpage>149</fpage>–<lpage>66</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.jneumeth.2013.04.010" xlink:type="simple">10.1016/j.jneumeth.2013.04.010</ext-link></comment> <object-id pub-id-type="pmid">23639919</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref047">
<label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Stopfer</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Jayaraman</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Laurent</surname> <given-names>G</given-names></name>. <article-title>Intensity versus identity coding in an olfactory system</article-title>. <source>Neuron</source>. <year>2003</year>;<volume>39</volume>(<issue>6</issue>):<fpage>991</fpage>–<lpage>1004</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2003.08.011" xlink:type="simple">10.1016/j.neuron.2003.08.011</ext-link></comment> <object-id pub-id-type="pmid">12971898</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref048">
<label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Grun</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Diesmann</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Aertsen</surname> <given-names>A</given-names></name>. <article-title>Unitary events in multiple single-neuron spiking activity: I. Detection and significance</article-title>. <source>Neural Comput</source>. <year>2002</year>;<volume>14</volume>(<issue>1</issue>):<fpage>43</fpage>–<lpage>80</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1162/089976602753284455" xlink:type="simple">10.1162/089976602753284455</ext-link></comment> <object-id pub-id-type="pmid">11747534</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref049">
<label>49</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Picado-Muino</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Borgelt</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Berger</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Gerstein</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Grun</surname> <given-names>S</given-names></name>. <article-title>Finding neural assemblies with frequent item set mining</article-title>. <source>Front Neuroinform</source>. <year>2013</year>;<volume>7</volume>:<fpage>9</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3389/fninf.2013.00009" xlink:type="simple">10.3389/fninf.2013.00009</ext-link></comment> <object-id pub-id-type="pmid">23755010</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref050">
<label>50</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pipa</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Wheeler</surname> <given-names>DW</given-names></name>, <name name-style="western"><surname>Singer</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Nikolic</surname> <given-names>D</given-names></name>. <article-title>NeuroXidence: reliable and efficient analysis of an excess or deficiency of joint-spike events</article-title>. <source>J Comput Neurosci</source>. <year>2008</year>;<volume>25</volume>(<issue>1</issue>):<fpage>64</fpage>–<lpage>88</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s10827-007-0065-3" xlink:type="simple">10.1007/s10827-007-0065-3</ext-link></comment> <object-id pub-id-type="pmid">18219568</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref051">
<label>51</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Torre</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Picado-Muiño</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Denker</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Borgelt</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Grün</surname> <given-names>S</given-names></name>. <article-title>Statistical evaluation of synchronous spike patterns extracted by frequent item set mining</article-title>. <source>Frontiers in computational neuroscience</source>. <year>2013</year>;<volume>7</volume>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3389/fncom.2013.00132" xlink:type="simple">10.3389/fncom.2013.00132</ext-link></comment> <object-id pub-id-type="pmid">24167487</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref052">
<label>52</label>
<mixed-citation publication-type="other" xlink:type="simple">Effenberger F, Hillar C. Discovery of salient low-dimensional dynamical structure in neuronal population activity using hopfield networks. In: International Workshop on Similarity-Based Pattern Recognition. Springer; 2015. p. 199–208.</mixed-citation>
</ref>
<ref id="pcbi.1006283.ref053">
<label>53</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hillar</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Effenberger</surname> <given-names>F</given-names></name>. <article-title>Robust discovery of temporal structure in multi-neuron recordings using Hopfield networks</article-title>. <source>Procedia Computer Science</source>. <year>2015</year>;<volume>53</volume>:<fpage>365</fpage>–<lpage>374</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.procs.2015.07.313" xlink:type="simple">10.1016/j.procs.2015.07.313</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref054">
<label>54</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Monge</surname> <given-names>G</given-names></name>. <chapter-title>Mémoire sur la théorie des déblais et des remblais</chapter-title>. <source>Histoire de l’Académie Royale des Sciences de Paris</source>. <year>1781</year>;.</mixed-citation>
</ref>
<ref id="pcbi.1006283.ref055">
<label>55</label>
<mixed-citation publication-type="other" xlink:type="simple">Kantorovich LV. On the translocation of masses. In: Dokl. Akad. Nauk SSSR. vol. 37; 1942. p. 199–201.</mixed-citation>
</ref>
<ref id="pcbi.1006283.ref056">
<label>56</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hitchcock</surname> <given-names>FL</given-names></name>. <article-title>The distribution of a product from several sources to numerous localities</article-title>. <source>Studies in Applied Mathematics</source>. <year>1941</year>;<volume>20</volume>(<issue>1-4</issue>):<fpage>224</fpage>–<lpage>230</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006283.ref057">
<label>57</label>
<mixed-citation publication-type="other" xlink:type="simple">Rubner Y, Tomasi C, Guibas LJ. A metric for distributions with applications to image databases. In: Computer Vision, 1998. Sixth International Conference on. IEEE; 1998. p. 59–66.</mixed-citation>
</ref>
<ref id="pcbi.1006283.ref058">
<label>58</label>
<mixed-citation publication-type="other" xlink:type="simple">Ester M, Kriegel HP, Sander J, Xu X, et al. A density-based algorithm for discovering clusters in large spatial databases with noise. In: Kdd. vol. 96; 1996. p. 226–231.</mixed-citation>
</ref>
<ref id="pcbi.1006283.ref059">
<label>59</label>
<mixed-citation publication-type="other" xlink:type="simple">
<name name-style="western"><surname>Campello</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Moulavi</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Sander</surname> <given-names>J</given-names></name>. Density-based clustering based on hierarchical density estimates. In: Pacific-Asia Conference on Knowledge Discovery and Data Mining. Springer; 2013. p. 160–172.</mixed-citation>
</ref>
<ref id="pcbi.1006283.ref060">
<label>60</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Campello</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Moulavi</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Zimek</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Sander</surname> <given-names>J</given-names></name>. <article-title>Hierarchical density estimates for data clustering, visualization, and outlier detection</article-title>. <source>ACM Transactions on Knowledge Discovery from Data (TKDD)</source>. <year>2015</year>;<volume>10</volume>(<issue>1</issue>):<fpage>5</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1145/2733381" xlink:type="simple">10.1145/2733381</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref061">
<label>61</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>McInnes</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Healy</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Astels</surname> <given-names>S</given-names></name>. <article-title>hdbscan: Hierarchical density based clustering</article-title>. <source>The Journal of Open Source Software</source>. <year>2017</year>;<volume>2</volume>(<issue>11</issue>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.21105/joss.00205" xlink:type="simple">10.21105/joss.00205</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref062">
<label>62</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Maaten</surname> <given-names>Lvd</given-names></name>, <name name-style="western"><surname>Hinton</surname> <given-names>G</given-names></name>. <article-title>Visualizing data using t-SNE</article-title>. <source>Journal of Machine Learning Research</source>. <year>2008</year>;<volume>9</volume>(<month>Nov</month>):<fpage>2579</fpage>–<lpage>2605</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006283.ref063">
<label>63</label>
<mixed-citation publication-type="other" xlink:type="simple">Hinton GE, Roweis ST. Stochastic neighbor embedding. In: Advances in neural information processing systems; 2003. p. 857–864.</mixed-citation>
</ref>
<ref id="pcbi.1006283.ref064">
<label>64</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>O’Keefe</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Burgess</surname> <given-names>N</given-names></name>. <article-title>Geometric determinants of the place fields of hippocampal neurons</article-title>. <source>Nature</source>. <year>1996</year>;<volume>381</volume>(<issue>6581</issue>):<fpage>425</fpage>–<lpage>8</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/381425a0" xlink:type="simple">10.1038/381425a0</ext-link></comment> <object-id pub-id-type="pmid">8632799</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref065">
<label>65</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Maurer</surname> <given-names>AP</given-names></name>, <name name-style="western"><surname>Cowen</surname> <given-names>SL</given-names></name>, <name name-style="western"><surname>Burke</surname> <given-names>SN</given-names></name>, <name name-style="western"><surname>Barnes</surname> <given-names>CA</given-names></name>, <name name-style="western"><surname>McNaughton</surname> <given-names>BL</given-names></name>. <article-title>Organization of hippocampal cell assemblies based on theta phase precession</article-title>. <source>Hippocampus</source>. <year>2006</year>;<volume>16</volume>(<issue>9</issue>):<fpage>785</fpage>–<lpage>94</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/hipo.20202" xlink:type="simple">10.1002/hipo.20202</ext-link></comment> <object-id pub-id-type="pmid">16921501</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref066">
<label>66</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hafting</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Fyhn</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Molden</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Moser</surname> <given-names>MB</given-names></name>, <name name-style="western"><surname>Moser</surname> <given-names>EI</given-names></name>. <article-title>Microstructure of a spatial map in the entorhinal cortex</article-title>. <source>Nature</source>. <year>2005</year>;<volume>436</volume>(<issue>7052</issue>):<fpage>801</fpage>–<lpage>6</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature03721" xlink:type="simple">10.1038/nature03721</ext-link></comment> <object-id pub-id-type="pmid">15965463</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref067">
<label>67</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bos</surname> <given-names>JJ</given-names></name>, <name name-style="western"><surname>Vinck</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>van Mourik-Donga</surname> <given-names>LA</given-names></name>, <name name-style="western"><surname>Jackson</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Witter</surname> <given-names>MP</given-names></name>, <name name-style="western"><surname>Pennartz</surname> <given-names>CMA</given-names></name>. <article-title>Perirhinal firing patterns are sustained across large spatial segments of the task environment</article-title>. <source>Nat Commun</source>. <year>2017</year>;<volume>8</volume>:<fpage>15602</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ncomms15602" xlink:type="simple">10.1038/ncomms15602</ext-link></comment> <object-id pub-id-type="pmid">28548084</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref068">
<label>68</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>O’Keefe</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Recce</surname> <given-names>ML</given-names></name>. <article-title>Phase relationship between hippocampal place units and the EEG theta rhythm</article-title>. <source>Hippocampus</source>. <year>1993</year>;<volume>3</volume>(<issue>3</issue>):<fpage>317</fpage>–<lpage>30</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/hipo.450030307" xlink:type="simple">10.1002/hipo.450030307</ext-link></comment> <object-id pub-id-type="pmid">8353611</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref069">
<label>69</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dragoi</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Buzsaki</surname> <given-names>G</given-names></name>. <article-title>Temporal encoding of place sequences by hippocampal cell assemblies</article-title>. <source>Neuron</source>. <year>2006</year>;<volume>50</volume>(<issue>1</issue>):<fpage>145</fpage>–<lpage>57</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2006.02.023" xlink:type="simple">10.1016/j.neuron.2006.02.023</ext-link></comment> <object-id pub-id-type="pmid">16600862</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref070">
<label>70</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pillow</surname> <given-names>JW</given-names></name>, <name name-style="western"><surname>Shlens</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Chichilnisky</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Simoncelli</surname> <given-names>EP</given-names></name>. <article-title>A model-based spike sorting algorithm for removing correlation artifacts in multi-neuron recordings</article-title>. <source>PloS one</source>. <year>2013</year>;<volume>8</volume>(<issue>5</issue>):<fpage>e62123</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0062123" xlink:type="simple">10.1371/journal.pone.0062123</ext-link></comment> <object-id pub-id-type="pmid">23671583</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref071">
<label>71</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>McGinley</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Vinck</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Reimer</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Batista-Brito</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Zagha</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Cadwell</surname> <given-names>CR</given-names></name>, <etal>et al</etal>. <article-title>Waking State: Rapid Variations Modulate Neural and Behavioral Responses</article-title>. <source>Neuron</source>. <year>2015</year>;<volume>87</volume>(<issue>6</issue>):<fpage>1143</fpage>–<lpage>61</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2015.09.012" xlink:type="simple">10.1016/j.neuron.2015.09.012</ext-link></comment> <object-id pub-id-type="pmid">26402600</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref072">
<label>72</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Steriade</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Timofeev</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Grenier</surname> <given-names>F</given-names></name>. <article-title>Natural waking and sleep states: a view from inside neocortical neurons</article-title>. <source>J Neurophysiol</source>. <year>2001</year>;<volume>85</volume>(<issue>5</issue>):<fpage>1969</fpage>–<lpage>85</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1152/jn.2001.85.5.1969" xlink:type="simple">10.1152/jn.2001.85.5.1969</ext-link></comment> <object-id pub-id-type="pmid">11353014</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref073">
<label>73</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Villani</surname> <given-names>C</given-names></name>. <source>Optimal transport: old and new</source>. <volume>vol. 338</volume>. <publisher-name>Springer Science &amp; Business Media</publisher-name>; <year>2008</year>.</mixed-citation>
</ref>
<ref id="pcbi.1006283.ref074">
<label>74</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>van Rossum</surname> <given-names>MC</given-names></name>. <article-title>A novel spike distance</article-title>. <source>Neural Comput</source>. <year>2001</year>;<volume>13</volume>(<issue>4</issue>):<fpage>751</fpage>–<lpage>63</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1162/089976601300014321" xlink:type="simple">10.1162/089976601300014321</ext-link></comment> <object-id pub-id-type="pmid">11255567</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref075">
<label>75</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Victor</surname> <given-names>JD</given-names></name>, <name name-style="western"><surname>Purpura</surname> <given-names>KP</given-names></name>. <article-title>Nature and precision of temporal coding in visual cortex: a metric-space analysis</article-title>. <source>J Neurophysiol</source>. <year>1996</year>;<volume>76</volume>(<issue>2</issue>):<fpage>1310</fpage>–<lpage>26</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1152/jn.1996.76.2.1310" xlink:type="simple">10.1152/jn.1996.76.2.1310</ext-link></comment> <object-id pub-id-type="pmid">8871238</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref076">
<label>76</label>
<mixed-citation publication-type="other" xlink:type="simple">Mackevicius EL, Bahle AH, Williams AH, Gu S, Denissenko NI, Goldman MS, et al. Unsupervised discovery of temporal sequences in high-dimensional datasets, with applications to neuroscience. bioRxiv. 2018; p. 273128.</mixed-citation>
</ref>
<ref id="pcbi.1006283.ref077">
<label>77</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tavoni</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Ferrari</surname> <given-names>U</given-names></name>, <name name-style="western"><surname>Battaglia</surname> <given-names>FP</given-names></name>, <name name-style="western"><surname>Cocco</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Monasson</surname> <given-names>R</given-names></name>. <article-title>Functional coupling networks inferred from prefrontal cortex activity show experience-related effective plasticity</article-title>. <source>Network Neuroscience</source>. <year>2017</year>;<volume>1</volume>(<issue>3</issue>):<fpage>275</fpage>–<lpage>301</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1162/NETN_a_00014" xlink:type="simple">10.1162/NETN_a_00014</ext-link></comment> <object-id pub-id-type="pmid">29855621</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref078">
<label>78</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Meshulam</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Gauthier</surname> <given-names>JL</given-names></name>, <name name-style="western"><surname>Brody</surname> <given-names>CD</given-names></name>, <name name-style="western"><surname>Tank</surname> <given-names>DW</given-names></name>, <name name-style="western"><surname>Bialek</surname> <given-names>W</given-names></name>. <article-title>Collective behavior of place and non-place neurons in the hippocampal network</article-title>. <source>Neuron</source>. <year>2017</year>;<volume>96</volume>(<issue>5</issue>):<fpage>1178</fpage>–<lpage>1191</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2017.10.027" xlink:type="simple">10.1016/j.neuron.2017.10.027</ext-link></comment> <object-id pub-id-type="pmid">29154129</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref079">
<label>79</label>
<mixed-citation publication-type="other" xlink:type="simple">Pachitariu M, Stringer C, Schröder S, Dipoppa M, Rossi LF, Carandini M, et al. Suite2p: beyond 10,000 neurons with standard two-photon microscopy. Biorxiv. 2016; p. 061507.</mixed-citation>
</ref>
<ref id="pcbi.1006283.ref080">
<label>80</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pnevmatikakis</surname> <given-names>EA</given-names></name>, <name name-style="western"><surname>Soudry</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Gao</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Machado</surname> <given-names>TA</given-names></name>, <name name-style="western"><surname>Merel</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Pfau</surname> <given-names>D</given-names></name>, <etal>et al</etal>. <article-title>Simultaneous denoising, deconvolution, and demixing of calcium imaging data</article-title>. <source>Neuron</source>. <year>2016</year>;<volume>89</volume>(<issue>2</issue>):<fpage>285</fpage>–<lpage>299</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2015.11.037" xlink:type="simple">10.1016/j.neuron.2015.11.037</ext-link></comment> <object-id pub-id-type="pmid">26774160</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref081">
<label>81</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hubert</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Arabie</surname> <given-names>P</given-names></name>. <article-title>Comparing partitions</article-title>. <source>Journal of classification</source>. <year>1985</year>;<volume>2</volume>(<issue>1</issue>):<fpage>193</fpage>–<lpage>218</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/BF01908075" xlink:type="simple">10.1007/BF01908075</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref082">
<label>82</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rousseeuw</surname> <given-names>PJ</given-names></name>. <article-title>Silhouettes: a graphical aid to the interpretation and validation of cluster analysis</article-title>. <source>Journal of computational and applied mathematics</source>. <year>1987</year>;<volume>20</volume>:<fpage>53</fpage>–<lpage>65</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/0377-0427(87)90125-7" xlink:type="simple">10.1016/0377-0427(87)90125-7</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006283.ref083">
<label>83</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Quiroga</surname> <given-names>RQ</given-names></name>, <name name-style="western"><surname>Nadasdy</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Ben-Shaul</surname> <given-names>Y</given-names></name>. <article-title>Unsupervised spike detection and sorting with wavelets and superparamagnetic clustering</article-title>. <source>Neural computation</source>. <year>2004</year>;<volume>16</volume>(<issue>8</issue>):<fpage>1661</fpage>–<lpage>1687</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1162/089976604774201631" xlink:type="simple">10.1162/089976604774201631</ext-link></comment> <object-id pub-id-type="pmid">15228749</object-id></mixed-citation>
</ref>
</ref-list>
</back>
</article>