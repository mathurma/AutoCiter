<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research-article">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-14-01867</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1004344</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Inferring the Clonal Structure of Viral Populations from Time Series Sequencing</article-title>
<alt-title alt-title-type="running-head">Clonal Structure of Viral Populations</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Chedom</surname> <given-names>Donatien F.</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref rid="currentaff001" ref-type="fn"><sup>¤a</sup></xref>
<xref rid="currentaff002" ref-type="fn"><sup>¤b</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Murcia</surname> <given-names>Pablo R.</given-names></name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Greenman</surname> <given-names>Chris D.</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>The Genome Analysis Centre, Norwich Research Park, Norwich, United Kingdom</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>MRC-University of Glasgow Centre for Virus Research, United Kingdom</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>School of Computing Sciences, University of East Anglia, Norwich, United Kingdom</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Kosakovsky Pond</surname> <given-names>Sergei L.</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>University of California San Diego, UNITED STATES</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con" id="contrib001">
<p>Conceived and designed the experiments: CDG PRM DFC. Performed the experiments: CDG PRM DFC. Analyzed the data: CDG PRM DFC. Contributed reagents/materials/analysis tools: CDG PRM DFC. Wrote the paper: CDG PRM DFC.</p>
</fn>
<fn fn-type="current-aff" id="currentaff001">
<label>¤a</label><p>Current address: The Wellcome Trust centre for Human Genetics, University of Oxford, Oxford, United Kingdom</p>
</fn>
<fn fn-type="current-aff" id="currentaff002">
<label>¤b</label><p>Current address: Ovarian Cancer Cell Laboratory,  Weatherall Institute of Molecular Medicine, Oxford, United Kingdom</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">C.Greenman@uea.ac.uk</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>11</month>
<year>2015</year>
</pub-date>
<pub-date pub-type="epub">
<day>16</day>
<month>11</month>
<year>2015</year>
</pub-date>
<volume>11</volume>
<issue>11</issue>
<elocation-id>e1004344</elocation-id>
<history>
<date date-type="received">
<day>13</day>
<month>10</month>
<year>2014</year>
</date>
<date date-type="accepted">
<day>17</day>
<month>5</month>
<year>2015</year>
</date>
</history>
<permissions>
<copyright-year>2015</copyright-year>
<copyright-holder>Chedom et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1004344" xlink:type="simple"/>
<abstract>
<p>RNA virus populations will undergo processes of mutation and selection resulting in a mixed population of viral particles. High throughput sequencing of a viral population subsequently contains a mixed signal of the underlying clones. We would like to identify the underlying evolutionary structures. We utilize two sources of information to attempt this; within segment linkage information, and mutation prevalence. We demonstrate that clone haplotypes, their prevalence, and maximum parsimony reticulate evolutionary structures can be identified, although the solutions may not be unique, even for complete sets of information. This is applied to a chain of influenza infection, where we infer evolutionary structures, including reassortment, and demonstrate some of the difficulties of interpretation that arise from deep sequencing due to artifacts such as template switching during PCR amplification.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>Any functional influenza virus particle is made up of eight distinct RNA segments. There can be in the order of 10<sup>6</sup> such particles per mL of infected tissue. Furthermore, on average, each new virus particle has a single mutation distinguishing the virus from its parent particle. The population of viruses thus contains a diverse mix of mutations. Modern sequencing experiments produce a signal that represents this mixed population. Untangling this signal to describe the evolutionary processes at work is an important part of virus biology. Furthermore, if an individual is infected with two different strains that both infect a single cell, new particles can form that contain a mixture of the two parents segments. This is known as reassortment and can result in the emergence of new virus strains. These events are hard to identify from sequencing experiments. Here we introduce a statistical method that can infer the evolutionary structure from a time series of sequencing experiments, which can also detect reassortment events, thus providing a method to help improve the understanding of within host evolution of viruses.</p>
</abstract>
<funding-group>
<funding-statement>The authors received no specific funding for this work.</funding-statement>
</funding-group>
<counts>
<fig-count count="10"/>
<table-count count="0"/>
<page-count count="26"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability" xlink:type="simple">
<meta-name>Data Availability</meta-name>
<meta-value>The raw data is available from the NCBI (project accession number SRP044631).</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<disp-quote>
<p>This is a <italic>PLOS Computational Biology</italic> Methods paper</p>
</disp-quote>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>RNA viruses have evolutionary dynamics characterized by high turnover rates, large population sizes and very high mutation rates [<xref ref-type="bibr" rid="pcbi.1004344.ref001">1</xref>, <xref ref-type="bibr" rid="pcbi.1004344.ref002">2</xref>], resulting in a genetically diverse mixed viral population [<xref ref-type="bibr" rid="pcbi.1004344.ref001">1</xref>, <xref ref-type="bibr" rid="pcbi.1004344.ref003">3</xref>–<xref ref-type="bibr" rid="pcbi.1004344.ref005">5</xref>]. Subpopulations in these mixtures containing specific sets of mutations are referred to as clones and their corresponding mutation sets as haplotypes. Unveiling the diversity, evolution and clonal composition of a viral population will be key to understanding factors such as infectiousness, virulence and drug resistance [<xref ref-type="bibr" rid="pcbi.1004344.ref006">6</xref>].</p>
<p>High throughput sequencing technologies have resulted in the generation of rapid, cost-effective, large sequencing datasets [<xref ref-type="bibr" rid="pcbi.1004344.ref007">7</xref>]. When applied to viruses, the set of reads obtained from a deep sequencing experiment represents a sample of the viral population which can be used to infer the underlying structure of that population at an unprecedented level of detail [<xref ref-type="bibr" rid="pcbi.1004344.ref001">1</xref>].</p>
<p>In this study, we aim to identify the haplotypes of clones and quantify their prevalence within a viral population. The method also constructs evolutionary histories of the process consistent with the data. Reconstructing the structure of a mixed viral population from sequencing data is a challenging problem [<xref ref-type="bibr" rid="pcbi.1004344.ref008">8</xref>]. Only a few works address the issue of viral mixed population haplotype reconstruction which infer both the genomes of sub-populations and their prevalence. Reviews of the methods and approaches dealing with these issues can be found in [<xref ref-type="bibr" rid="pcbi.1004344.ref001">1</xref>, <xref ref-type="bibr" rid="pcbi.1004344.ref009">9</xref>–<xref ref-type="bibr" rid="pcbi.1004344.ref011">11</xref>] and [<xref ref-type="bibr" rid="pcbi.1004344.ref012">12</xref>].</p>
<p>These works frequently make use of read graphs, which consist of a graph representation of pairs of mutations linked into haplotypes [<xref ref-type="bibr" rid="pcbi.1004344.ref013">13</xref>]. Haplotypes then correspond to paths through these graphs, although not every path will necessarily be realized as a genuine haplotype, which can lead to over-calling haplotypes. Different formalizations of this problem has led to different optimization problems in the literature [<xref ref-type="bibr" rid="pcbi.1004344.ref011">11</xref>], including minimum-cost flows [<xref ref-type="bibr" rid="pcbi.1004344.ref014">14</xref>], minimum sets of paths [<xref ref-type="bibr" rid="pcbi.1004344.ref013">13</xref>, <xref ref-type="bibr" rid="pcbi.1004344.ref015">15</xref>], probabilistic and statistical methods [<xref ref-type="bibr" rid="pcbi.1004344.ref008">8</xref>], network flow problems [<xref ref-type="bibr" rid="pcbi.1004344.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1004344.ref016">16</xref>], minimum path cover problems [<xref ref-type="bibr" rid="pcbi.1004344.ref017">17</xref>], maximizing bandwidth [<xref ref-type="bibr" rid="pcbi.1004344.ref018">18</xref>], graph coloring problems [<xref ref-type="bibr" rid="pcbi.1004344.ref019">19</xref>] or K-mean clustering approaches [<xref ref-type="bibr" rid="pcbi.1004344.ref013">13</xref>]. After the haplotypes are constructed, in many cases an expectation-maximisation (EM) algorithm is used to estimate their prevalence in the sampled population. Some other works [<xref ref-type="bibr" rid="pcbi.1004344.ref006">6</xref>, <xref ref-type="bibr" rid="pcbi.1004344.ref020">20</xref>] use a probabilistic approach instead of a graph-based method.</p>
<p>In this work we take an integrative approach to address both the genetic diversity and the evolutionary trajectory of the viral population. The method presented is not read graph based and constructs evolutionary trees and recombination networks weighted by clone prevalences. This reduces the size of the solution set of haplotypes. The method does not rely exclusively on reads physically linking mutations so is applicable to longer segments. The method will also be shown to have particular utility with time series data and is highlighted on a chain of infections by influenza (H3N8).</p>
<p>The question of the influenza genome diversity has been addressed in the literature largely between strains or samples from different hosts, considering one single dominant genome for each host [<xref ref-type="bibr" rid="pcbi.1004344.ref021">21</xref>]. Within-host evolution is a source of genetic diversity the understanding of which may lead to the development of models that link different evolutionary scales [<xref ref-type="bibr" rid="pcbi.1004344.ref010">10</xref>]. Kuroda et al. [<xref ref-type="bibr" rid="pcbi.1004344.ref022">22</xref>] addressed the question of evolution within a single host of influenza extracted on a patient who died of an A/H1N1/2009 infection, but with a focus on HA segment using a de-novo approach. Our approach provides a method to further understand within host evolution of such viruses.</p>
<p>The next section highlights the approach with an overview of the methods used, examples of the tree and network construction methods with simulated data, followed by an application of the method to a daily sequence of real influenza data. The Methods section describes the construction of the trees and networks in more detail.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<sec id="sec003">
<title>Overview</title>
<p>Here we provide a brief outline of our general approach, which is explained in more detail in subsequent sections. The aim of our approach was twofold. Firstly, identify mutations arising in an infection chain of viral hosts. Secondly, provide a phylogenetic tree or recombination network that best explains the evolution structure of the most prevalent mutations. A flow chart of the process is provided in <xref ref-type="fig" rid="pcbi.1004344.g001">Fig 1</xref>.</p>
<fig id="pcbi.1004344.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004344.g001</object-id>
<label>Fig 1</label>
<caption>
<title>A flow chart describing the tree and network construction process.</title>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004344.g001"/>
</fig>
<p>The first step was to sequence a time series of virus samples. Next, we took the initial sample in the time series (such as an inoculum, for example) and obtained the nucleotide with highest prevalence at each position. This defined a reference (concensus) sequence, which was then compared to the remaining samples enabling the identification of de novo mutations. The proportion of reads containing each mutation then represented its prevalence in the viral population (paired reads with identical start positions, end positions and sequences were counted once in this process, being assumed to derive from a single PCR product). Mutations with a prevalence above a (user defined) threshold (10%) on at least one sample were included for further analysis. Next we attempted to construct an evolutionary tree consistent with the prevalence information and paired end linkage information across all samples. If no consistent tree could be identified, we attempted to construct a recombination network with one reticulation event. If this failed we iteratively increase the number of reticulation events permissable to find a recombination network consistent with the data. Any solutions obtained were outputted in either the Newick format (for trees) or the extended Newick format (for networks).</p>
<p>Our method used two main sources of information. Firstly, a pigeon hole principle was utilized, restricting how different sub-populations of viruses, each containing a certain combination of mutations, can fit within a tree or network structure. Secondly, linkage information was harnessed, describing how pairs of mutations co-exist in sub-populations. This information is obtained from single paired-end reads (likely to derive from a single viral particle) that contained two (or more) mutations.</p>
<p>The pigeon hole principle worked best with a set of mutation prevalences that vary significantly across the samples collected. More specifically, a subset of mutations undergoing either rapid selection or drift were found to provide the most informative datasets (RNA viruses undergoing drug treatments, or the bottleneck arising when a small number of viral particles infects an animal are examples of where this might happen). Mutations that have consistently low or high prevalence contain information that is harder to leverage, and the underlying evolutionary structures are harder to infer. Such mutations were not included in the analysis. Slowly mutating viruses (DNA viruses for example) are also less likely to be sufficient mutagenic for our approach.</p>
<p>The linkage information worked best when recombination events were relatively rare. Viruses with high rates of recombination (such as HIV) will rapidly lose linkage information making the evolutionary structure harder to identify.</p>
<p>We next outline the tree and network construction methods in more detail.</p>
</sec>
<sec id="sec004">
<title>An Evolutionary Tree</title>
<p>Consider the pedagogic simulation in <xref ref-type="fig" rid="pcbi.1004344.g002">Fig 2</xref>, where we have a region of interest (such as an influenza segment, for example) that has undergone mutational and selective processes encapsulated by the evolution tree in <xref ref-type="fig" rid="pcbi.1004344.g002">Fig 2A</xref>. This tree contains five mutations <italic>M</italic><sub>1</sub>, <italic>M</italic><sub>2</sub>, <italic>M</italic><sub>3</sub>, <italic>M</italic><sub>4</sub>, <italic>M</italic><sub>5</sub> that lie on various branches of the tree. These combine into the six clones that are the leaves of the tree. For example, the second leaf is labeled <italic>C</italic><sub>11000</sub>, indicating a clone with haplotype consisting of mutations <italic>M</italic><sub>1</sub>, <italic>M</italic><sub>2</sub> but not <italic>M</italic><sub>3</sub>, <italic>M</italic><sub>4</sub>, <italic>M</italic><sub>5</sub>. Note that the path from the root of the tree to this leaf crosses the two branches corresponding to mutations <italic>M</italic><sub>1</sub> and <italic>M</italic><sub>2</sub>. The number 20 at the leaf indicates that this clone makes up 20% of the viral population, and is termed the <italic>prevalence</italic>.</p>
<fig id="pcbi.1004344.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004344.g002</object-id>
<label>Fig 2</label>
<caption>
<title>A super-tree sample.</title>
<p>(A) A contrived evolution of a mixed viral population involving five mutations and six clones. Dotted lines indicate internal nodes extended to a leaf. (B) A notional representation of sequencing across the region of interest, and the resulting Depth-Position graph. Paired reads bridge two clusters of mutations. (C) Read count data obtained for the two clusters, with total depth x1000, along with artifacts †. (D) Evolutionary trees corresponding to (Ci,ii). (E) Ordered list of mutations and population prevalences (%). (F) Reconstruction of original tree in (A).</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004344.g002"/>
</fig>
<p>Note that these prevalences form a <italic>conserved flow network</italic> through the tree [<xref ref-type="bibr" rid="pcbi.1004344.ref023">23</xref>]. For example, the prevalence of mutation <italic>M</italic><sub>1</sub> is 55%, which accounts for the two haplotypes <italic>C</italic><sub>11001</sub> and <italic>C</italic><sub>11000</sub>, with prevalences 35% and 20%, respectively. In general, we find that the prevalence flowing into a node of the tree must equal the sum of the exiting prevalences. This represents conservation of the viral sub-populations. The total prevalence across all the leaves is therefore 100%.</p>
<p>In reality we are not privy to this information and perform a sequencing experiment to investigate the structure. This takes the form of molecular sequencing, where we detect the five mutations, which each have a different <italic>depth</italic> of sequencing, as portrayed in <xref ref-type="fig" rid="pcbi.1004344.g002">Fig 2B</xref>. We will later see with real influenza data that percentage depth can be reasonably interpreted as prevalence. Furthermore, we can group mutations arising on individual sequencing reads into clusters. For our example, mutations <italic>M</italic><sub>1</sub>, <italic>M</italic><sub>2</sub> and <italic>M</italic><sub>3</sub> are positioned such that there are paired end reads (exemplified in <xref ref-type="fig" rid="pcbi.1004344.g002">Fig 2Bi</xref>) where <italic>M</italic><sub>1</sub> and <italic>M</italic><sub>2</sub> will lie on the sequence at one end, and <italic>M</italic><sub>3</sub> in the sequence at the other end of the read. Mutations <italic>M</italic><sub>1</sub>, <italic>M</italic><sub>2</sub> and <italic>M</italic><sub>3</sub> thus form one cluster. Similarly, mutations <italic>M</italic><sub>4</sub> and <italic>M</italic><sub>5</sub> can be found at the two ends of paired reads and form a distinct cluster. We then find the mutations are grouped into two clusters, giving the two corresponding haplotype tables in <xref ref-type="fig" rid="pcbi.1004344.g002">Fig 2C</xref>.</p>
<p>We first construct an evolution tree for each of these tables. Our approach is based upon two sources of information; one utilizes mutation sequencing depth with a pigeon hole principle, the other utilizes linkage information from haplotype tables.</p>
<p>Now we have mutation <italic>M</italic><sub>2</sub> present in 80% of viruses and mutation <italic>M</italic><sub>1</sub> present in 55% of viruses. If these mutations are not both simultaneously present in a sub population of viruses, then the mutations are exclusive. This implies the two populations of size 80% and 55% do not overlap. However, the total population of viruses containing either of these viruses would then be greater than 100% &lt; 80% + 55%. This is not possible, and the only explanation is that a subpopulation of viruses contain both mutations; the pigeon hole principle. The only tree-like evolutionary structure possible is that <italic>M</italic><sub>1</sub> is a descendant of <italic>M</italic><sub>2</sub>, as indicated by the rooted, directed tree in <xref ref-type="fig" rid="pcbi.1004344.g002">Fig 2Di</xref>. Note that we have not utilized any haplotype information to infer this, just the mutation prevalence of the two mutations and a pigeon hole principle.</p>
<p>Mutation <italic>M</italic><sub>3</sub> has a prevalence that is too low to repeat a prevalence based argument. However, we have a second source of information; the paired read data that can link together mutations into the haplotypes in <xref ref-type="fig" rid="pcbi.1004344.g002">Fig 2Ci</xref>. This table is based on three mutations, which group into 2<sup>3</sup> = 8 possible haplotypes. However, a tree structure with three mutations will only contain four leaves [<xref ref-type="bibr" rid="pcbi.1004344.ref024">24</xref>] and we see that four of the halpotypes (emboldened) have notably larger counts of reads and are likely to be genuine. The four haplotypes with a notably lower read counts are likely to be the result of sequencing error at the mutant base positions, or template switching from a cycle of rtPCR, and are ignored. The presence of genuine haplotypes <italic>C</italic><sub>011</sub> and <italic>C</italic><sub>010</sub>, lead us to conclude that <italic>M</italic><sub>3</sub> is descendant from <italic>M</italic><sub>2</sub> but not <italic>M</italic><sub>1</sub>, resulting in the tree of <xref ref-type="fig" rid="pcbi.1004344.g002">Fig 2Di</xref>.</p>
<p>From the mutation prevalences 55%, 80% and 15% of <italic>M</italic><sub>1</sub>, <italic>M</italic><sub>2</sub> and <italic>M</italic><sub>3</sub>, we can also use the conserved network flow to measure the haplotypes prevalence. For example, the leaf descending from <italic>M</italic><sub>2</sub>(80%), but not <italic>M</italic><sub>1</sub>(55%) or <italic>M</italic><sub>3</sub>(15%) (clone <italic>C</italic><sub>010</sub> of <xref ref-type="fig" rid="pcbi.1004344.g002">Fig 2Di</xref>) must represent the remaining 10% = 80% − 55% − 15% of the population.</p>
<p>This provides us with two sources of information (sequencing depth and linkage information) we can utilize to reconstruct the clone haplotypes, prevalence, and evolution. However, not all mutations can be connected by sequencing reads. They may be either separated by a distance beyond the library insert size, or may lie on distinct (unlinked) segments. Our approach is then as follows. We first construct a tree for each cluster of linked mutations. This will be a subtree of the full evolutionary structure. We then construct a supertree from this set of subtrees.</p>
<p>Now both of the trees in <xref ref-type="fig" rid="pcbi.1004344.g002">Fig 2D</xref> must be subtrees of a full evolutionary tree for the collective mutation set so we need to construct a supertree of these two trees. We can do this recursively as follows. We take the mutations and place them in decreasing order according to their prevalence, as given in <xref ref-type="fig" rid="pcbi.1004344.g002">Fig 2E</xref>. We then attach branches corresponding to these mutations to the supertree in turn, checking firstly network flow conservation, and secondly that the haplotype information in the subtrees is preserved. The steps for this example can be seen in <xref ref-type="fig" rid="pcbi.1004344.g002">Fig 2F</xref>. We start with a single incoming edge with prevalence 100%; the entire viral population. We next place an edge corresponding to <italic>M</italic><sub>2</sub>, the mutation with maximum prevalence of 80%. The next mutation in the tree either descends from the root or this new node. Any descendants of <italic>M</italic><sub>2</sub> must have a prevalence less than this 80%. Any other branches must descend from the top node but can only account for up to 20% of the remaining population. These two values are the <italic>capacities</italic> indicated in square brackets. The next value we place is <italic>M</italic><sub>1</sub> with prevalence 55%. This is beyond the capacity 20% of the top node, so <italic>M</italic><sub>1</sub> is descendant to <italic>M</italic><sub>2</sub>, accounting for 55% of the 80%, leaving 25%. We thus have a three node tree with capacities 20%, 25% and 55%. The third ordered mutation <italic>M</italic><sub>5</sub> has prevalence 35%, which can only be placed at the bottom node with maximum capacity. Our next mutation <italic>M</italic><sub>3</sub> has a prevalence 15% that is less than any of the four capacities available, and no useful information on the supertree structure is obtained. This branch is the first to use haplotype information. We know from the first subtree that the corresponding branch is a descendant of <italic>M</italic><sub>2</sub> and not <italic>M</italic><sub>1</sub>. The only node we can use (in red) has capacity 25% and we place the branch. For the final branch corresponding to mutation <italic>M</italic><sub>4</sub>, the prevalence 15% is less than four available capacities. The second subtree tells us that <italic>M</italic><sub>4</sub> is not a descendant of <italic>M</italic><sub>5</sub>. This only rules out one of the four choices, and any of the three (red) nodes will result in a tree consistent with the data. The top node selected results in a tree equivalent to that in <xref ref-type="fig" rid="pcbi.1004344.g002">Fig 2A</xref>. To see this tree equivalence, the internal nodes in the last tree of <xref ref-type="fig" rid="pcbi.1004344.g002">Fig 2F</xref> have additional leaves attached (dotted lines) to obtain <xref ref-type="fig" rid="pcbi.1004344.g002">Fig 2A</xref>.</p>
<p>We thus find that a single dataset can result in several trees that are consistent with the data. However, having a time series of samples means a tree consistent with all days of data is required, which will substantially reduces the solution space. Note that the prevalences of the clones at the leaves of the tree results from this recursive process. We thus find that supertree construction is relatively straightforward with the aid of prevalence.</p>
<p>However, trees do not always fit the data. This can be due to recombination occurring within segments, or re-assortment occurring between segments. In the next section we construct recombination networks to cater for this, although we will see that they cannot be constructed as efficiently as trees.</p>
</sec>
<sec id="sec005">
<title>A Recombination Network</title>
<p>In <xref ref-type="fig" rid="pcbi.1004344.g003">Fig 3A</xref> we see another simulated evolution based upon the two segments in <xref ref-type="fig" rid="pcbi.1004344.g003">Fig 3Ci</xref> that accumulate four mutations, <italic>M</italic>1, <italic>M</italic>2, <italic>M</italic>3 and <italic>M</italic>4. First we have mutations <italic>M</italic>1 and <italic>M</italic>3. Then we have the first of two recombination events, <italic>r</italic>1, where we have recombination within the first segment as described in <xref ref-type="fig" rid="pcbi.1004344.g003">Fig 3Cii</xref>. We then have mutations <italic>M</italic>2 and <italic>M</italic>4, followed by the second recombination event <italic>r</italic>2 in <xref ref-type="fig" rid="pcbi.1004344.g003">Fig 3Ciii</xref>, a re-assortment between the two segments. This results in the seven clones given at the leaves of <xref ref-type="fig" rid="pcbi.1004344.g003">Fig 3A</xref>. The prevalences of the four mutations across five time points are given in <xref ref-type="fig" rid="pcbi.1004344.g003">Fig 3E</xref>. Note that we no longer have the conservation of prevalence observed in trees. For example, mutations <italic>M</italic>1 and <italic>M</italic>3 are on distinct branches extending from the root, yet their total prevalence is in excess of 100% (on Day 5 for example). This is due to recombination <italic>r</italic>1 resulting in the presence of a clone containing both mutations. The use of the prevalence to reconstruct this structure from observable data thus requires more care.</p>
<fig id="pcbi.1004344.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004344.g003</object-id>
<label>Fig 3</label>
<caption>
<title>A super-network sample.</title>
<p>(A) A pedagogic evolution recombination network with four mutations and two recombination events across two segments. (B) Typical haplotype tables arising from (A). (Ci) Two clusters of mutations grouped by paired reads on two segments. (Cii) Clones <italic>C</italic><sub>1000</sub> and <italic>C</italic><sub>0010</sub> undergo within segment recombination into <italic>C</italic><sub>1010</sub>, with a crossover site between <italic>M</italic><sub>1</sub> and <italic>M</italic><sub>3</sub>. (Ciii) Clones <italic>C</italic><sub>1001</sub> and <italic>C</italic><sub>1110</sub> undergo between segment recombination (reassortment) into <italic>C</italic><sub>1111</sub>. (D) Recombination networks arising from the haplotype tables in (B). (E) The prevalence of the four mutations across five days. (F) Phylogenetic network associated with (A). (G) Point and range prevalence estimates. (Hi) A network consistent with the two networks of (D). (Hii) Incompatible prevalence conditions associated with (Hi).</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004344.g003"/>
</fig>
<p>Now we see in <xref ref-type="fig" rid="pcbi.1004344.g003">Fig 3Ci</xref> that the four mutations cluster into two groups of mutations each bridged by a set of paired reads, resulting in two tables of read counts in <xref ref-type="fig" rid="pcbi.1004344.g003">Fig 3Bi and 3Bii</xref>. We would like to reconstruct the evolution in <xref ref-type="fig" rid="pcbi.1004344.g003">Fig 3A</xref> from these data.</p>
<p>Firstly, we need to decide which of the haplotypes in <xref ref-type="fig" rid="pcbi.1004344.g003">Fig 3B</xref> are real. The haplotypes with consistently low entries are classified as artifact (in opaque). We next use a standard approach (such as a canonical splits network [<xref ref-type="bibr" rid="pcbi.1004344.ref025">25</xref>]) to construct sub-networks from the real haplotypes in each of these tables, such as those given in <xref ref-type="fig" rid="pcbi.1004344.g003">Fig 3Dii</xref>. We then build super-networks ensuring that all sub-networks are contained as a sub-graph. There does not appear to be an efficient way of doing this (such as ordering by prevalence which works so well with trees) so a brute force approach is taken, where we construct all possible networks that contain four mutations and the haplotypes observed in <xref ref-type="fig" rid="pcbi.1004344.g003">Fig 3Bi and 3Bii</xref>.</p>
<p>This results in many candidate super-networks. We now find that the prevalence information can be used to reject many cases. For example, the super-network in <xref ref-type="fig" rid="pcbi.1004344.g003">Fig 3Hi</xref> contains both sub-networks of <xref ref-type="fig" rid="pcbi.1004344.g003">Fig 3Di and 3Dii</xref> as subgraphs. Note that the root node, representing the entire 100% of the population, has daughter branches containing mutations <italic>M</italic>4, <italic>M</italic>1 and <italic>M</italic>3. However, from the prevalences on Day 5 we see that <italic>M</italic>4 has prevalence 66% and <italic>M</italic>1 and <italic>M</italic>3 (which recombine) have a collective prevalence (from clones <italic>C</italic><sub>001</sub>, <italic>C</italic><sub>100</sub>, <italic>C</italic><sub>101</sub>, and <italic>C</italic><sub>111</sub> in <xref ref-type="fig" rid="pcbi.1004344.g003">Fig 3Bi</xref>) of 93%. This is in excess of the possible 100% available and the network is rejected.</p>
<p>Application of filtering by prevalence (see <xref ref-type="sec" rid="sec010">Methods</xref> section for full details) rejects all networks with one recombination event, so we try all networks with two recombination events, resulting in just seven possible recombination networks. These all contain the same set of clones, all of which correspond to the single phylogenetic network in <xref ref-type="fig" rid="pcbi.1004344.g003">Fig 3F</xref>. Although only one recombination event is present across the subnetworks, all super-networks with one recombination event were filtered out and two recombination events were required.</p>
<p>Lastly we require estimates of the prevalences of each of the seven clones. We would like to match these to the prevalences in the tables of <xref ref-type="fig" rid="pcbi.1004344.g003">Fig 3B</xref>. This is a linear programming problem, the full details of which are given in the Methods section. The resulting estimates are given in <xref ref-type="fig" rid="pcbi.1004344.g003">Fig 3G</xref> where we see that some clones have point estimates, whereas others have ranges. For example, we see that clone <italic>C</italic><sub>0010</sub> has a point estimate for each day. This is because it is the only clone of the super-network that corresponds to clone <italic>C</italic><sub>001</sub> of <xref ref-type="fig" rid="pcbi.1004344.g003">Fig 3Bi</xref> and their prevalences can be matched. Conversely, we see ranges for the prevalences of clones <italic>C</italic><sub>1110</sub> and <italic>C</italic><sub>1111</sub>. This is because both clones correspond to clone <italic>C</italic><sub>111</sub> of <xref ref-type="fig" rid="pcbi.1004344.g003">Fig 3Bi</xref> and prevalence estimates for each clone cannot be uniquely specified.</p>
<p>Full details of this approach can be found in the Methods section. In the next section we describe the results obtained when applying these methods to a time series of influenza samples.</p>
</sec>
<sec id="sec006">
<title>Application to Influenza</title>
<p>The data used in this study were generated from a chain of horse infections with influenza A H3N8 virus (sample processing details can be found in the methods section). An inoculum was used to infect two horses labeled 2761 and 6652. These two animals then infected horses labeled 6292 and 9476. This latter pair then infected 1420 and 6273. The chain continued and daily samples were collected from the horses resulting in 50 samples in total. For the present study we used 16 samples; the inoculum and hosts 2761 (days 2 to 6), 6652 (days 2, 3 and 5), 6292 (days 3 to 6) and 1420 (days 3, 5 and 6).</p>
<p>Influenza A virus is a member of the family Orthomyxoviridae which contains eight segmented, negative-stranded genomic RNAs commonly referred to as segments and numbered by their lengths from the longest 2341 to the shortest 890 bps [<xref ref-type="bibr" rid="pcbi.1004344.ref021">21</xref>], as summarized in <xref ref-type="fig" rid="pcbi.1004344.g004">Fig 4A</xref>.</p>
<fig id="pcbi.1004344.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004344.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Flu segments.</title>
<p>(A) Size and function of the eight flu segments. (B,C) Depth of mutations from segment 4 from host 2761 Day 4 and host 6292 Day 3, respectively. (i,ii) Results from Hi-Seq and Mi-Seq experiments on separate libraries from the same samples.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004344.g004"/>
</fig>
<p>Daily samples were collected from each host and paired end sequenced was performed with Hi-seq and Mi-seq machines. The samples sequences were aligned with Bowtie2 [<xref ref-type="bibr" rid="pcbi.1004344.ref026">26</xref>] with default parameters. We obtain for each sample a SAM file containing mapping information of all the different reads in the sample. Any mapped read whose average Phred-quality per base was less than 30 were discarded.</p>
<p>In order to identify mutations from real data we need a reference sequence to compare the read sequences to. Consistent differences between the two can then be classified as a mutation. We constructed a majority consensus sequence from the inoculum sample. This consensus sequence was then used as a starting reference for the chain of infected animals.</p>
<p>To produce DNA for sequencing, viral RNA was reverse-transcribed and amplified (RT-PCR). The reverse transcription step can result in the introduction of artefact mutations that in turn would be further amplified in the PCR step, resulting in different levels of amplification and mutation. This in turn is likely to introduce significant differences between the sequencing depth and prevalence. To combat this, all identical paired end reads (with equal beginning and endpoints, and identical sequences) were grouped, classified as a single PCR product, deriving from a single molecule and only counted once.</p>
<p>We tested this assumption by using the observed insert size distribution to randomly simulate reads with a number equal to the observed depth (∼ 1.8<italic>e</italic>6 reads), assuming a single mutation with prevalence of 50% exists, to determine how often two distinct events would produce identical reads. This produced a surprisingly high figure of 7% which will get worse as the depth of sequencing increases and some care is needed (see [<xref ref-type="bibr" rid="pcbi.1004344.ref027">27</xref>] for further discussion on these kind of ‘birthday paradoxes’). However, many reads contain more than one mutation making identical sequences less likely and the real figure will be somewhat lower. The depth of sequencing with these adjusted counts should then provide an improved measurement of the prevalence of viral subpopulations. We compared an identical sample that was sequenced separately (following the RT-PCR step), the results of which can be seen across two samples in <xref ref-type="fig" rid="pcbi.1004344.g004">Fig 4Bi, 4Bii, 4Ci and 4Cii</xref>. Both the position and prevalence of mutations were reproducible to good accuracy suggesting proportional sequencing depth is a good surrogate for prevalence. We note that although there was variation in the depth of sequencing across the genome, the expected proportion of reads containing any given mutation will not change, and the depth of sequencing will not be a large source of bias on the estimated prevalence. However, we cannot rule out the possibility that some mutations are preferentially amplified, which would cause some systematic bias. We thus make the cautionary observation that some biases may exist in the prevalence, and that spike-in experiments to systematically examine the strength of correlation between sequence depth and viral prevalence are needed. Such experiments are beyond the scope of the present study and proportional sequence depth was taken as a suitable proxy for proportional viral prevalence.</p>
<p>We then applied the methods to sets of high prevalence mutations in each of the eight segments individually, and also to a set of three mutations from distinct segments. The main observations are below.</p>
</sec>
<sec id="sec007">
<title>Within Segment Evolution</title>
<p>For segments 1, 3, 5, 6, 7 and 8 we obtained tree like evolutions for the segments. In all cases the mutations involved lay on distinct branches and were indicative of mutations arising in independent clones. Segment 6 can be seen in <xref ref-type="fig" rid="pcbi.1004344.g005">Fig 5A</xref>, where we see five mutations on six branches. We also see from the stacked bar chart in <xref ref-type="fig" rid="pcbi.1004344.g005">Fig 5B</xref> that many of the mutations arose during different periods in the infection chain.</p>
<fig id="pcbi.1004344.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004344.g005</object-id>
<label>Fig 5</label>
<caption>
<p>(A) Evolution tree arising from five mutations on segment 6. (B) Prevalences of the clones across the times series.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004344.g005"/>
</fig>
<p>However, the evolution structure of mutations within segments did not always appear to be tree like, with segment 2 containing one putative recombination event and seven mutations, and segment 4 containing three putative recombination events and six mutations. This latter case arose because we found three pairs of mutations in putative recombination. Using nucleotide positions as labels, these were (431, 674), (431, 709) and (709, 1401). That is, we found significant counts of all four combinations of mutations, labeled <italic>C</italic><sub>00</sub>, <italic>C</italic><sub>01</sub>, <italic>C</italic><sub>10</sub> and <italic>C</italic><sub>11</sub>, lying on paired reads. Examples of typical counts for three (out of sixteen) samples are given in the top table in <xref ref-type="fig" rid="pcbi.1004344.g006">Fig 6B</xref> (see Supplementary Information for full details). If the evolution is tree-like, reads from one of the types <italic>C</italic><sub>01</sub>, <italic>C</italic><sub>10</sub> or <italic>C</italic><sub>11</sub> should only arise as an artifact. Note that we have high read counts of all four categories, which is indicative of recombination.</p>
<fig id="pcbi.1004344.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004344.g006</object-id>
<label>Fig 6</label>
<caption>
<p>(A) Three template switching models. (B) Fitted models for three pairs of linked mutations on segment 4.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004344.g006"/>
</fig>
<p>However, various studies have shown that there is very little evidence of genuine recombination that occurs within segments of influenza [<xref ref-type="bibr" rid="pcbi.1004344.ref028">28</xref>–<xref ref-type="bibr" rid="pcbi.1004344.ref030">30</xref>], and these kind of observations can arise from template switching across different copies of segments during the rtPCR sequencing cycle [<xref ref-type="bibr" rid="pcbi.1004344.ref031">31</xref>]. We developed an analytic approach to consider this possibility in more detail.</p>
<p>Now if the true underlying structure is tree-like, it suggests that one of <italic>C</italic><sub>11</sub>, <italic>C</italic><sub>01</sub> or <italic>C</italic><sub>10</sub> arises purely from template switching (the wild type <italic>C</italic><sub>00</sub> is assumed to always occur). This gives us the three models (labeled i-iii in <xref ref-type="fig" rid="pcbi.1004344.g006">Fig 6A and 6B</xref>) to consider (see also Template Switching subsection in Methods section). We let <italic>a</italic>, <italic>b</italic> and <italic>c</italic> be the population proportions of the three real genotypes. We let <italic>n</italic> be the probability that a cycle of rtPCR causes template switching. We then treat template switching as a continuous time three state random process. This allows us to derive probabilities that genotypes <italic>C</italic><sub>00</sub>, <italic>C</italic><sub>01</sub>, <italic>C</italic><sub>10</sub> and <italic>C</italic><sub>11</sub> arise on paired end reads, as given in <xref ref-type="fig" rid="pcbi.1004344.g006">Fig 6A</xref> (see <xref ref-type="sec" rid="sec010">Methods</xref> for derivations). The counts of the four classes of read then follow a corresponding multinomial distribution. Maximum likelihood was used to estimate parameters, obtain log-likelihood scores, and a chi-squared measure of fit was obtained for each of the three models.</p>
<p>For the pair (431, 674) we found that the best log-likelihood, on all sixteen sampled days, was Model 1 (<xref ref-type="fig" rid="pcbi.1004344.g006">Fig 6i</xref>), where reads of type <italic>C</italic><sub>11</sub> are artifacts arising from template switching alone. The parameters obtained provided an almost perfect fit; the expected counts were almost equal to the observed counts and the goodness of fit significance values were close to 1. Models 2 and 3 (<xref ref-type="fig" rid="pcbi.1004344.g006">Fig 6ii and 6iii</xref>) had substantially lower likelihoods and significantly bad fits. This tells us that if the underlying structure is a tree, it involves the three genotypes <italic>C</italic><sub>00</sub>, <italic>C</italic><sub>01</sub> and <italic>C</italic><sub>10</sub> and mutations 431 and 674 lie on distinct branches.</p>
<p>For the pair (431, 709) we found that the best log-likelihood, over the sixteen sampled days, was Model 3 (<xref ref-type="fig" rid="pcbi.1004344.g006">Fig 6iii</xref>), where reads of type <italic>C</italic><sub>10</sub> are artifacts. The parameters obtained provided an almost perfect fit on most days with goodness of fit significance values close to 1. A couple of days had relatively poor fits, but were not significant when multiple testing across all sixteen days was considered. Model 1 (with <italic>C</italic><sub>11</sub> as an artifact, <xref ref-type="fig" rid="pcbi.1004344.g006">Fig 6i</xref>) had very similar likelihoods, but the data exhibited significantly poor fits on multiple days. Model 2 (with <italic>C</italic><sub>01</sub> as an artifact, <xref ref-type="fig" rid="pcbi.1004344.g006">Fig 6ii</xref>) performed very badly. This tells us that if the underlying structure is a tree, it involves the three genotypes <italic>C</italic><sub>00</sub>, <italic>C</italic><sub>01</sub> and <italic>C</italic><sub>11</sub> and mutation 431 is a descendant of 709.</p>
<p>For the pair (709, 1401) we found that the best log-likelihood, on all sixteen sampled days, was Model 2 (<xref ref-type="fig" rid="pcbi.1004344.g006">Fig 6ii</xref>), where reads of type <italic>C</italic><sub>01</sub> are artifacts. The parameters obtained provided an almost perfect fit on all days with goodness of fit significance values close to 1. Models 1 and 3 (<xref ref-type="fig" rid="pcbi.1004344.g006">Fig 6i and 6iii</xref>) performed very badly. This tells us that if the underlying structure is a tree, it involves the three genotypes <italic>C</italic><sub>00</sub>, <italic>C</italic><sub>10</sub> and <italic>C</italic><sub>11</sub> and mutation 1401 is a descendant of 709.</p>
<p>Thus the three cases where data are indicative of recombination can be explained purely by template switching during rtPCR. This is reinforced somewhat by the fact that the same model emerged across all sampled days for each mutation pair. However, this does not definitively rule out recombination, which could also exhibit these consistent patterns across sampled days, and so care is needed when interpreting data. Furthermore, the rates of template switching required to explain the data without recombination were not always consistent. For example, in the sample from host 2761 Day 4, the estimated template switching between mutations (431,674) was 43.6% (95% c.i 38.2%—49.2%). Between mutations (431,709) it was 48.8% (95% c.i 46.3%—51.4%), giving reasonable agreement. Between mutations (709, 1401) it was somewhat higher, at 58.6% (95% c.i 68.3%—78.7%), although this may be expected due to the greater distance between the mutations. However, in sample 1420 Day 3, the template switching rate for the pair (431,674), at 99.6% (95% c.i 76.6%—99.3%), was notably higher than both the mutation pair (431,709), at 43.2% (95% c.i 39.5%—47.1%), and mutation pair (709,1401), at 49.3% (95% c.i 36.9%—64.1%). Although differences between samples (and so library preparations) may be expected, differences such as this in the same library are harder to explain without implicating genuine recombination.</p>
<p>We thus have two explanations of the data; genuine recombination or template switching artifacts. We consider both cases and then draw comparisons.</p>
<p>Firstly we consider segment 4 assuming recombination has taken place. The results can be seen in <xref ref-type="fig" rid="pcbi.1004344.g007">Fig 7</xref>. The prevalences of six mutations of interest are given in <xref ref-type="fig" rid="pcbi.1004344.g007">Fig 7A</xref>. Reasonable linkage information was available across the segment, including the two haplotype tables in <xref ref-type="fig" rid="pcbi.1004344.g007">Fig 7C</xref>. The first is linkage information between mutations 709 and 1401, where all four combinations of mutation occur to reasonable depth, implying recombination between the mutations. The second is between mutations 1387 and 1401, where we see only three haplotypes occur to significant depth, suggesting a tree like evolutionary structure between the two mutations. The full set of tables is in Supplementary Information. Although the sequencing depth in the first table is lower, due to the rarer occurrence of sufficiently large insert sizes, the information gleaned is just as crucial. The most parsimonious evolution found involved three recombination events, resulting in the single cloneset contained in the phylogenetic network given in <xref ref-type="fig" rid="pcbi.1004344.g007">Fig 7D</xref>. There were 22 possible recombination networks that fit this phylogenetic network, one example of which is given in <xref ref-type="fig" rid="pcbi.1004344.g007">Fig 7E</xref>. The relatively complete linkage information resulted in point estimates for the clone prevalences (rather than ranges), as given in <xref ref-type="fig" rid="pcbi.1004344.g007">Fig 7B</xref>.</p>
<fig id="pcbi.1004344.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004344.g007</object-id>
<label>Fig 7</label>
<caption>
<p>(A) Mutation prevalences of six mutations in segment 4. (B) Prevalences of the ten associated clones. (C) Two tables of linked mutations exhibiting network like relationship of mutations 709 and 1401, and tree like relationship of 1387 and 1401. (D) The phylogenetic network of the single fitted cloneset. (E) One of 22 possible recombination networks that arise from (D). (F) Probable tree structure from (E) after template switching is considered.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004344.g007"/>
</fig>
<p>If we now assume that the recombination like events are template switching during rtPCR, then from above, we observed that mutations 431 and 674 are on distinct branches, mutation 431 is a descendant of 709, and 1401 is also a descendant of 709. This resolves all three reticulation events in the network of <xref ref-type="fig" rid="pcbi.1004344.g007">Fig 7E</xref> and we end up with the tree given in <xref ref-type="fig" rid="pcbi.1004344.g007">Fig 7F</xref>. However, this structure still has two minor conflicts. Firstly, the tree like structure suggests that mutation 431 should have a lower prevalence than 1401, and on most days it does. However, the sample from host 2761 Day 4 has prevalences 54.3% and 51.2% for mutations 431 and 1401, respectively. Similarly, the samples from host 1420 Day 3 are 66.1% and 70.3%, respectively. Secondly, the four mutations 674, 709, 1013 and 1401 all descend from the root on separate branches and should have a total prevalence that is less than 100% and on fifteen of sixteen samples this is true. However, on sample 6292 Day 3 the prevalences are 9.9%, 52.8%, 18.0% and 26.0%, which combine to 106.7%. Although the conflicts are relatively small, these differences are larger than would be expected from Poisson sampling of such deep data. However, this is the most plausible tree structure we found.</p>
</sec>
<sec id="sec008">
<title>Detecting Reassortment</title>
<p>Re-assortments occur when progeny segments from distinct viral parents are partnered into the same viral particle, resulting in a recombinant evolutionary network.</p>
<p>Now re-assortment is a form of recombination. This is usually possible to detect in diploid species such as human because linkage information is available across a region of interest, such as a chromosome, and recombination can be inferred. Furthermore human samples have distinct sequencing samples for each member of the species. Inferring re-assortment across distinct viral samples is more difficult because firstly we do not have linkage information across distinct segments, and secondly, we have mixed populations within each sample.</p>
<p>However, we show that re-assortment can still be detected within mixed population viral samples with the aid of information provided by prevalence. Consider <xref ref-type="fig" rid="pcbi.1004344.g008">Fig 8</xref>. We have three mutations in segments 2, 3 and 4, along with their mutation nucleotide positions 2037, 201 and 709, respectively. We refer to the mutations as <italic>S</italic> 2_2037, <italic>S</italic> 3_201 and <italic>S</italic> 4_709 accordingly. We see in <xref ref-type="fig" rid="pcbi.1004344.g008">Fig 8A</xref> that <italic>S</italic> 2_2037 and <italic>S</italic> 3_201 have prevalences that alternate in magnitude across the 16 days sampled. If we assume a tree like structure, these two mutations cannot lie on a single branch, because one prevalence would have to be consistently lower than the other; they must therefore lie on distinct branches. Now mutation <italic>S</italic> 4_709 can; i) be on a distinct third branch, ii) be a descendant of <italic>S</italic> 2_2037, iii) be a descendant of <italic>S</italic> 3_201, iv) be an ancestor of <italic>S</italic> 2_2037, v) be an ancestor of <italic>S</italic> 3_201, or vi) be an ancestor of both. We can rule out all of these choices as follows.</p>
<fig id="pcbi.1004344.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004344.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Three mutations between three segments that indicate two re-assortment events.</title>
<p>(A) Mutation prevalences across time series. (B) One of 51 recombination networks that fit the data. (C) Two phylogenetic networks that fit the data ((i) and (ii)-(iv)), corresponding to four clonesets. (D) Prevalence ranges for the four clonesets.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004344.g008"/>
</fig>
<p>Firstly we note that <italic>S</italic> 4_709 has a prevalence that is consistently larger than that of <italic>S</italic> 2_2037 or <italic>S</italic> 3_201, so cannot be a descendant of either mutation, ruling out ii) and iii). We see from sample 6292 Day 3 that <italic>S</italic> 2_2037 and <italic>S</italic> 3_201 have a total prevalence greater than <italic>S</italic> 4_709, meaning <italic>S</italic> 4_709 cannot be an ancestor of both mutations, ruling out vi). In this sample, the total prevalence of all three mutations is in excess of 100%, ruling out i). Now if <italic>S</italic> 4_709 and <italic>S</italic> 2_2037 lie on distinct branches, we see from 2761 Day 4 that their combined prevalence is in excess of 100%, ruling out v). Finally, if <italic>S</italic> 4_709 and <italic>S</italic> 3_201 lie on distinct branches, we see from 6292 Day 4 that their combined prevalence is in excess of 100%, ruling out iv). No tree structure is possible and we conclude the presence of re-assortment as the most likely explanation.</p>
<p>In fact, application of the full method reveals that two re-assortment events are required to explain the data. This results in 51 possible recombination networks, one such example is given in <xref ref-type="fig" rid="pcbi.1004344.g008">Fig 8B</xref>. These correspond to the four clonesets given in <xref ref-type="fig" rid="pcbi.1004344.g008">Fig 8C</xref>, arising from two possible phylogentic networks. The four clonesets have prevalences that could not be uniquely resolved; their possible ranges are shown in <xref ref-type="fig" rid="pcbi.1004344.g008">Fig 8D</xref>. Although we cannot uniquely identify the network or the prevalences, all solutions involved two re-assortments, one involving mutations <italic>S</italic> 4_709 and <italic>S</italic> 2_2037, the other involving <italic>S</italic> 4_709 and <italic>S</italic> 3_201. This observation was only possible because of inferences made with the prevalence.</p>
</sec>
</sec>
<sec id="sec009" sec-type="conclusions">
<title>Discussion</title>
<p>We have introduced a methodology to analyze time series viral sequencing data. This has three aims; to identify the presence of clones in mixed viral populations, to quantify the relative population sizes of the clones, and to describe underlying evolutionary structures, including reticulated evolution.</p>
<p>We have demonstrated the applicability of these methods with paired end sequencing from a chain of infections of the H3N8 influenza virus. Although we could identify underlying evolutionary structures, some properties of the viruses and the resulting data make interpretation difficult. In particular, template switching during the rtPCR cycle of sequencing an RNA virus is known to occur, and can result in paired reads that imply the presence of recombination. Although any underlying tree like evolutions can still be detected, these artifacts confound the signal of any genuine recombination that may be taking place, making it harder to identify. The prevalence of mutations, measured as sequencing depth proportion, offers an alternative source of information that can help resolve these conflicts in theory, although more work is needed to evaluate how robust this metric is in practice.</p>
<p>For example, although tree like evolutions were identified in six of the segments, in the two remaining segments the approach found reticulated networks, with three distinct reticulated nodes in the hemagglutinin segments network. Although each of these nodes were consistent with template switching artifacts, the resultant tree structure could not quite be fitted to the mutation prevalences. Although this conflict implies the original network is correct and recombination has taken place, within segment recombination in influenza is rare [<xref ref-type="bibr" rid="pcbi.1004344.ref028">28</xref>–<xref ref-type="bibr" rid="pcbi.1004344.ref030">30</xref>] and other explanations may be required. In particular, we note in <xref ref-type="fig" rid="pcbi.1004344.g004">Fig 4B</xref> that there are slight differences between the prevalences obtained from independent Mi-seq and Hi-seq runs. Although some of this will be due to Poisson variation of depth, there could be some biases in PCR over certain mutations, for example. The application of prevalence thus needs to be used with caution, and further studies are needed to fine tune this type of approach.</p>
<p>When the approach was applied to mutations in distinct segments, two re-assortment events were inferred. The differences in mutation prevalences were more marked in this case suggesting the inference is more robust and re-assortment more likely to have taken place. This is also biologically more plausible, with events such as this accounting for the emergence of new strains. We note that although re-assortment may have genuinely taken place, only one of the original clones (containing just mutation 709 on segment 4) survived the infection chain and a longitudinal study would not have picked up such transient clonal activity.</p>
<p>These methods utilized paired end sequencing data and showed that even when paired reads do not extend the full length of segments, or bridge distinct segments, we can still make useful inferences on the underlying evolutionary structures. The two main sources of information are the linkage offered by two or more mutations lying on the same paired reads, and the prevalence information. We note, firstly, that utilising the full range of insert sizes produced in the sequencing library provides linkage information that covered most distances across segments. Filtering paired reads to remove inserts with larger insert sizes can lose useful linkage information. Indeed, it is likely to be profitable to produce libraries with different insert sizes. Secondly, we note that it is by utilizing the variability of the prevalence in a time series dataset that we can narrow down the predictions to a useful degree; application of this method to individuals days will likely result in too many predictions to be useful. Furthermore, this has greatest application to mutations of higher prevalence; this places more restrictions on possible evolutions consistent with the data. Subsequently, this kind of variability is most likely to manifest itself under conditions of differing selectional forces. A stable population is less likely to contain mutations moving to fixation under selective forces. Lower prevalence mutations will result, meaning less predictive power. Simulations also suggest that although clone-sets may be uniquely identified, prediction of the underlying reticulation network is difficult, with many networks explaining the same dataset.</p>
<p>As we lower the minimum prevalence of analyzed mutations, their number will increase. The number of networks will likely explode and raise significant challenges. Furthermore, single strand RNA viruses such as influenza mutate quickly, suggesting a preponderance of low prevalence mutations likely exist. This is further exacerbated by the fact that sequencing uses rt-PCR, introducing point mutations and template switching artifacts that create noise in the data. These processes are likely responsible for the grass-like distribution of low prevalence mutations visible in <xref ref-type="fig" rid="pcbi.1004344.g004">Fig 4B and 4C</xref>. Thus as we consider lower prevalence mutations we are likely to get a rapidly growing evolution structure of increasingly complex topology. The methods we have introduced, however, can provide useful information at the upper-portions of these structures.</p>
<p>The software ViralNet is available at <ext-link ext-link-type="uri" xlink:href="http://www.uea.ac.uk/computing/software" xlink:type="simple">www.uea.ac.uk/computing/software</ext-link>. The raw data is available from the NCBI (project accession number SRP044631). More detailed outputs from the algorithm are available in Supplementary Information.</p>
</sec>
<sec id="sec010" sec-type="materials|methods">
<title>Methods</title>
<p>We now outline details of sample preparation, tree and network construction methods, a template switching model, and method validation.</p>
<sec id="sec011">
<title>Sample Preparation</title>
<p>Viral RNA was isolated from 280 μl-aliquots of nasal swabs using the QIAamp viral RNA mini kit (Qiagen) following the manufacturer’s instructions. To quantify virus shedding, a real-time RT-PCR as described in [<xref ref-type="bibr" rid="pcbi.1004344.ref005">5</xref>] and [<xref ref-type="bibr" rid="pcbi.1004344.ref032">32</xref>] was performed. Virus copy numbers are available in supplementary information. Full genome amplification was performed as described in [<xref ref-type="bibr" rid="pcbi.1004344.ref033">33</xref>]. Each DNA sample was then processed for paired end sequencing on both a Hi-Seq and Mi-Seq machine, producing ends with 101 bases.</p>
<p>The reads from the innoculum sample were then used to construct a majority reference sequence. Reads from samples further down the infection chain were compared against this reference for variant calling. Paired reads with identical start and end reference points, and identical sequences, were deemed to arise from a single PCR product. Duplicates were thus removed and only one paired read is selected for the final dataset.</p>
</sec>
<sec id="sec012">
<title>Tree Construction</title>
<p>The construction of phylogenetic trees is a well established area [<xref ref-type="bibr" rid="pcbi.1004344.ref024">24</xref>]. Trees are frequently constructed from tables of haplotypes of different species. However, we have two properties that change the situation. Firstly, if we have a set of <italic>n</italic> mutations linked by reads, we can have up to 2<sup><italic>n</italic></sup> distinct haplotypes. However, a consistent set of splits from such a table should only have up to <italic>n</italic> + 1 distinct haplotypes, in a split-compatible configuration [<xref ref-type="bibr" rid="pcbi.1004344.ref024">24</xref>]. To construct a phylogenetic tree we thus need to classify the genotypes as real or artifact. Secondly, we have prevalence information, in the form of a conserved network flow through the tree. This can help us to both decide which haplotypes to believe and to construct a corresponding tree.</p>
<p>To describe the algorithm we first introduce some notation. Now, the evolutionary structure is represented by two types of rooted directed tree; one where each edge represents a mutation, such as in <xref ref-type="fig" rid="pcbi.1004344.g002">Fig 2F</xref>, and one where all leaves represent clones in the population, such as in <xref ref-type="fig" rid="pcbi.1004344.g002">Fig 2A and 2D</xref>. The first is a subtree of the latter. The latter has a conserved flow network. These will be termed the <italic>Compact Prevalence Tree</italic> and <italic>Complete Prevalence Tree</italic> respectively.</p>
<p>Now to each edge <italic>e</italic> in the compact prevalence tree, we assign <italic>prevalence</italic> <italic>ρ</italic>(<italic>e</italic>). This represents the proportion of population containing the mutation represented by the edge <italic>e</italic>. The single directed edge <italic>e</italic><sub><italic>in</italic></sub>(<italic>v</italic>) pointing toward a vertex <italic>v</italic> (away from the root) represents a viral population of prevalence <italic>ρ</italic>(<italic>e</italic><sub><italic>in</italic></sub>(<italic>v</italic>)), all containing the mutation corresponding to edge <italic>e</italic><sub><italic>in</italic></sub>(<italic>v</italic>), along with its predecessor mutations. The set of daughter edges <italic>E</italic><sub><italic>out</italic></sub>(<italic>v</italic>) leading away from node <italic>v</italic> represent populations containing subsequent mutations, each with prevalence <italic>ρ</italic>(<italic>e</italic>), <italic>e</italic> ∈ <italic>E</italic><sub><italic>out</italic></sub>(<italic>v</italic>). The remaining population from <italic>ρ</italic>(<italic>e</italic><sub><italic>in</italic></sub>(<italic>v</italic>)) contains just the original mutation set, having a prevalence described by the <italic>capacity</italic> <italic>ζ</italic>(<italic>v</italic>). The conservation of prevalence satisfied by each vertex <italic>v</italic> ∈ <italic>T</italic> is then represented by the condition:
<disp-formula id="pcbi.1004344.e001"><alternatives><graphic id="pcbi.1004344.e001g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004344.e001"/><mml:math id="M1" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>ρ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>v</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>ζ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>v</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>e</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi>E</mml:mi> <mml:mrow><mml:mi>o</mml:mi> <mml:mi>u</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>v</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:munder> <mml:mi>ρ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>e</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>v</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula></p>
<p>The root node has total prevalence of 1, representing the entire population of interest.</p>
<p>This describes the mutation based trees such as that in <xref ref-type="fig" rid="pcbi.1004344.g002">Fig 2F</xref>. To obtain a complete tree containing all the clones, we need to extend an edge from each internal node to represent the associated clone (these are the dashed lines in <xref ref-type="fig" rid="pcbi.1004344.g002">Fig 2A</xref>). The prevalence of the additional edges are equal to the capacities of the parental nodes.</p>
<p>We saw in <xref ref-type="fig" rid="pcbi.1004344.g002">Fig 2B</xref> that mutations can be clustered together, and evolution trees constructed for each cluster. We define a <italic>cluster</italic> to be any subset of mutations with reference positions all lying within the two sequences of individual paired end reads. We restricted clusters to cases where the total number of paired end reads containing the mutation sites numbered at least 200 and greater reliability in the linkage information exists. The evolutionary tree corresponding to each mutation cluster is referred to as a <italic>Subtree</italic>. We then look for a tree that contains all such subtrees as a subset of edges. We refer to these as <italic>Supertrees</italic>.</p>
<p>The algorithm is broken into two steps. The first calculates subtrees. The second calculates supertrees.</p>
<sec id="sec013">
<title>Step 1 Subtree construction</title>
<p>Now, for <italic>n</italic> mutations we have 2<sup><italic>n</italic></sup> possible haplotypes, with corresponding counts <italic>n</italic><sub><italic>i</italic></sub>, <italic>i</italic> = 1, 2, …, 2<sup><italic>n</italic></sup>, and a tree with <italic>n</italic> + 1 haplotypes to fit. This implies that 2<sup><italic>n</italic></sup> − <italic>n</italic> − 1 of those counts are artifacts. For example, in <xref ref-type="fig" rid="pcbi.1004344.g009">Fig 9D</xref> we see the simulated counts for 2<sup>3</sup> haplotypes on 3 mutations. Now Cayley’s formula states that there are <italic>n</italic><sup><italic>n</italic> − 2</sup> different labeled trees that can be constructed on n vertices [<xref ref-type="bibr" rid="pcbi.1004344.ref034">34</xref>]. These are easily constructed with the aid of Prüfer sequences [<xref ref-type="bibr" rid="pcbi.1004344.ref035">35</xref>], which are any integer sequence [<italic>p</italic><sub>1</sub>, …, <italic>p</italic><sub><italic>n</italic> − 2</sub>] such that <italic>p</italic><sub><italic>i</italic></sub> ∈ {1, 2, …, <italic>n</italic>}. The first few examples are given in <xref ref-type="fig" rid="pcbi.1004344.g009">Fig 9A</xref>.</p>
<fig id="pcbi.1004344.g009" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004344.g009</object-id>
<label>Fig 9</label>
<caption>
<p>(A) Cayley trees for 2, 3 and 4 vertices. (Bi) Vertex list <bold>v</bold> for example (*). (Bii) Prüfer sequence <bold>p</bold>. (Biii) Tree construction. (Ci) The graph directed away from the root. (ii) The equivalent compact clonal tree. (iii) The corresponding complete clonal tree. (D) Alignment of trees * and † to haplotype tables.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004344.g009"/>
</fig>
<p>To construct a tree we start with <bold>p</bold> = [<italic>p</italic><sub>1</sub>, …, <italic>p</italic><sub><italic>n</italic> − 2</sub>] and the vector <bold>v</bold> = [1, 2, …, <italic>n</italic>]. At each step we take the lowest entry of <bold>v</bold> not in <bold>p</bold>, and the lowest entry of <bold>p</bold>, and join the two corresponding nodes together with an edge. For example in <xref ref-type="fig" rid="pcbi.1004344.g009">Fig 9B</xref> we start with <bold>v</bold> = [<italic>R</italic>, 1, 2, 3], where the root node <italic>R</italic> is treated as the minimum value, along with Prüfer sequence <bold>p</bold> = [<italic>R</italic>, 3]. The smallest element of <bold>v</bold> not in <bold>p</bold> is 1. The corresponding node is then joined to the node for the smallest element <italic>R</italic> of <bold>p</bold>, such as exemplified in <xref ref-type="fig" rid="pcbi.1004344.g009">Fig 9Biii</xref>. These two elements are removed from <bold>p</bold> and <bold>v</bold> and the process repeated until we are left with two elements in <bold>v</bold>. Our example leaves us with the two elements 2 and 3, the corresponding nodes of which are then joined by an edge. The edges are then directed away from the root, resulting in the prevalence clonal tree in <xref ref-type="fig" rid="pcbi.1004344.g009">Fig 9Cii</xref>. The corresponding complete prevalence tree is in <xref ref-type="fig" rid="pcbi.1004344.g009">Fig 9Ciii</xref>.</p>
<p>Once we have all the possible subtrees constructed, we use maximum likelihood to select the most plausible tree. Consider, for example, the penultimate column of <xref ref-type="fig" rid="pcbi.1004344.g009">Fig 9D</xref>, which correspond to the four haplotypes for the tree (*) in <xref ref-type="fig" rid="pcbi.1004344.g009">Fig 9A–9C</xref>. Note that the haplotype <italic>C</italic><sub>110</sub> with a count 550 is an artifact for this tree. If each mutation artifact arises with probability <italic>ϵ</italic>, then an artifact read of type <italic>C</italic><sub>110</sub> contains two mutant bases and occurs with probability <italic>ϵ</italic><sup>2</sup>. We can then construct log-likelihoods (summed across time points) for the artifact counts arising from clones that do not belong to the putative tree being tested. We then assume Poisson distributed counts and construct the following likelihood function for a given putative clonal tree <inline-formula id="pcbi.1004344.e002"><alternatives><graphic id="pcbi.1004344.e002g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004344.e002"/><mml:math id="M2" display="inline" overflow="scroll"><mml:mstyle mathvariant="script"><mml:mi>T</mml:mi></mml:mstyle></mml:math></alternatives></inline-formula>:
<disp-formula id="pcbi.1004344.e003"><alternatives><graphic id="pcbi.1004344.e003g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004344.e003"/><mml:math id="M3" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="script">L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="script">T</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>t</mml:mi></mml:munder> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>h</mml:mi> <mml:mo>∉</mml:mo> <mml:mi mathvariant="script">T</mml:mi></mml:mrow></mml:munder> <mml:mi>l</mml:mi> <mml:mi>o</mml:mi> <mml:mi>g</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>P</mml:mi> <mml:mi>o</mml:mi> <mml:mi>i</mml:mi> <mml:mi>s</mml:mi> <mml:msub><mml:mi>s</mml:mi> <mml:msubsup><mml:mi>n</mml:mi> <mml:mi>j</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>n</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:msup><mml:mi>ϵ</mml:mi> <mml:mrow><mml:mi>x</mml:mi> <mml:mo>(</mml:mo> <mml:mi>h</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2)</label></disp-formula></p>
<p>Here <italic>t</italic> indexes the time point, <italic>n</italic><sup>(<italic>t</italic>)</sup> and <italic>ϵ</italic> = 0.003 are the total depth and the error rate, respectively. The values <italic>x</italic>(<italic>h</italic>) represents the number of mutants in haplotype <italic>h</italic>. The tree with maximum likelihood is selected. Although the use of a Poisson distribution may be approximate, this technique is a pragmatic way to identify plausible haplotypes/trees.</p>
</sec>
<sec id="sec014">
<title>Step 2 Supertree construction</title>
<p>We next build supertrees of the evolution from the subtrees. As we saw in the example in <xref ref-type="fig" rid="pcbi.1004344.g002">Fig 2F</xref>, this involves ranking the subtree branches by prevalence, and adding mutations sequentially as in the example in <xref ref-type="fig" rid="pcbi.1004344.g002">Fig 2F</xref>, checking pairwise ancestry relationships between mutations (from the subtrees), along with the capacity of prevalence available at each node (by checking <xref ref-type="disp-formula" rid="pcbi.1004344.e001">Eq (1)</xref> for every time point).</p>
<p>Note that this algorithm may produce no trees. This implies there are no supertrees consistent with the data, and recombination networks may be more suitable.</p>
</sec>
</sec>
<sec id="sec015">
<title>The Recombination Algorithm</title>
<p>We would like to use data such as <xref ref-type="fig" rid="pcbi.1004344.g003">Fig 3B</xref> to reconstruct the evolutionary structure. The splits method [<xref ref-type="bibr" rid="pcbi.1004344.ref025">25</xref>] is used to construct phylogenetic networks such as <xref ref-type="fig" rid="pcbi.1004344.g003">Fig 3G</xref>. There are many recombination networks that correspond to any given phylogenetic network. A standard method to identify recombination networks is to look for an optimal path of trees across the recombination sites [<xref ref-type="bibr" rid="pcbi.1004344.ref036">36</xref>]. These methods generally have the full mutation profile of a set of species of interest to compare. Our problem is exacerbated by missing data and the full haplotypes of distinct species (clones in our case) are not available. However, we have prevalence information which can help identify structures consistent with the data.</p>
<p>We construct recombination networks in five steps; haplotype classification, super-network construction, super-network filtering, prevalence maximum likelihood estimation, and prevalence range estimation. We describe these steps in detail.</p>
<sec id="sec016">
<title>Step 1 Haplotype classification</title>
<p>In order to distinguish the real and artifact haplotypes in any table such as <xref ref-type="fig" rid="pcbi.1004344.g007">Fig 7C</xref> we do the following. For any count <inline-formula id="pcbi.1004344.e004"><alternatives><graphic id="pcbi.1004344.e004g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004344.e004"/><mml:math id="M4" display="inline" overflow="scroll"><mml:msubsup><mml:mi>n</mml:mi> <mml:mi>h</mml:mi> <mml:mrow><mml:mo stretchy="false" form="prefix">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false" form="postfix">)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> associated with haplotype <italic>h</italic> and time point <italic>t</italic>, we calculate the probability it arises as an error using the Poisson distribution. This gives a term of the form <inline-formula id="pcbi.1004344.e005"><alternatives><graphic id="pcbi.1004344.e005g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004344.e005"/><mml:math id="M5" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi> <mml:mi>o</mml:mi> <mml:mi>i</mml:mi> <mml:mi>s</mml:mi> <mml:msub><mml:mi>s</mml:mi> <mml:msubsup><mml:mi>n</mml:mi> <mml:mi>h</mml:mi> <mml:mrow><mml:mo stretchy="false" form="prefix">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false" form="postfix">)</mml:mo></mml:mrow></mml:msubsup></mml:msub> <mml:mo stretchy="false" form="prefix">(</mml:mo> <mml:msup><mml:mi>n</mml:mi> <mml:mrow><mml:mo stretchy="false" form="prefix">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false" form="postfix">)</mml:mo></mml:mrow></mml:msup> <mml:msup><mml:mi>ϵ</mml:mi> <mml:mrow><mml:mi>x</mml:mi> <mml:mo stretchy="false" form="prefix">(</mml:mo> <mml:mi>h</mml:mi> <mml:mo stretchy="false" form="postfix">)</mml:mo></mml:mrow></mml:msup> <mml:mo stretchy="false" form="postfix">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, where <italic>n</italic><sup>(<italic>t</italic>)</sup> is the total read depth from that time point, <italic>x</italic>(<italic>h</italic>) is the number of mutations distinct from the wild type, and <italic>ϵ</italic> is a user selected error rate per base per read. We then take the combined log-likelihood <inline-formula id="pcbi.1004344.e006"><alternatives><graphic id="pcbi.1004344.e006g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004344.e006"/><mml:math id="M6" display="inline" overflow="scroll"><mml:mstyle mathvariant="script"><mml:mi>ℒ</mml:mi></mml:mstyle></mml:math></alternatives></inline-formula> across all time points. All log-likelihoods below a threshold <inline-formula id="pcbi.1004344.e007"><alternatives><graphic id="pcbi.1004344.e007g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004344.e007"/><mml:math id="M7" display="inline" overflow="scroll"><mml:msub><mml:mstyle mathvariant="script"><mml:mi>ℒ</mml:mi></mml:mstyle> <mml:mn>0</mml:mn></mml:msub></mml:math></alternatives></inline-formula> are classified as real. The values <italic>ϵ</italic> = 0.003 and <inline-formula id="pcbi.1004344.e008"><alternatives><graphic id="pcbi.1004344.e008g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004344.e008"/><mml:math id="M8" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mstyle mathvariant="script"><mml:mi>ℒ</mml:mi></mml:mstyle> <mml:mn>0</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mo>−</mml:mo> <mml:mn>350</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> were used in implementation. An error rate of <italic>ϵ</italic> = 0.003 is a conservative overestimate of the true error rate [<xref ref-type="bibr" rid="pcbi.1004344.ref037">37</xref>]. The likelihood threshold was the value that misclassified the least number (4%) of haplotypes (where ‘real’ haplotypes were defined to be those containing at least one prevalence above 10%). This threshold can be lowered if the inclusion of lower prevalence haplotypes is desirable, although more false positive haplotypes will subsequently be included.</p>
</sec>
<sec id="sec017">
<title>Step 2 Super-network construction</title>
<p>This is a brute force approach where we construct all possible recombination networks using <italic>r</italic> = 0, 1, 2, … reticulated nodes in turn. Any networks that do not contain the real haplotypes of the individual haplotype tables of Step 1 are rejected. The value of <italic>r</italic> selected is the smallest value with any valid networks after Steps 3 and 4 are implemented.</p>
</sec>
<sec id="sec018">
<title>Step 3 Filtering</title>
<p>We need to utilize the prevalence to identify and remove invalid networks. Each leaf <italic>c</italic> of the recombination graph represents a single clone of the mixed population. We let <italic>ρ</italic><sub><italic>c</italic></sub> denote the prevalences of that clone. We then have the conditions:
<disp-formula id="pcbi.1004344.e009"><alternatives><graphic id="pcbi.1004344.e009g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004344.e009"/><mml:math id="M9" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:munder><mml:mo>∑</mml:mo> <mml:mi>c</mml:mi></mml:munder> <mml:msub><mml:mi>ρ</mml:mi> <mml:mi>c</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:msub><mml:mi>ρ</mml:mi> <mml:mi>c</mml:mi></mml:msub> <mml:mo>≥</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(3)</label></disp-formula></p>
<p>Now we have the estimated prevalence <italic>λ</italic><sub><italic>m</italic></sub> of each mutation <italic>m</italic> = 1, 2, …, <italic>M</italic> from the proportional sequencing depth at the mutations position. If we let <inline-formula id="pcbi.1004344.e010"><alternatives><graphic id="pcbi.1004344.e010g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004344.e010"/><mml:math id="M10" display="inline" overflow="scroll"><mml:msub><mml:mstyle mathvariant="script"><mml:mi>C</mml:mi></mml:mstyle> <mml:mi>m</mml:mi></mml:msub></mml:math></alternatives></inline-formula> denote the set of clones from the super-network that contain mutation <italic>m</italic>, we have conditions of the form:
<disp-formula id="pcbi.1004344.e011"><alternatives><graphic id="pcbi.1004344.e011g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004344.e011"/><mml:math id="M11" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:mi>c</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi mathvariant="script">C</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>}</mml:mo></mml:mrow></mml:munder> <mml:msub><mml:mi>ρ</mml:mi> <mml:mi>c</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>λ</mml:mi> <mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(4)</label></disp-formula></p>
<p>We solve the linear programming problem defined by Eqs <xref ref-type="disp-formula" rid="pcbi.1004344.e009">3</xref> and <xref ref-type="disp-formula" rid="pcbi.1004344.e011">4</xref> with the simplex method. If no solution exists on any day <italic>t</italic> the network is rejected. If a solution is found, it is the input to the (more precise) calculation in Step 4. This step generally reduces the number of networks to manageable levels.</p>
</sec>
<sec id="sec019">
<title>Step 4 Prevalence point estimation</title>
<p>In reality <italic>λ</italic><sub><italic>m</italic></sub> is an estimate and we have more information than just the depth of mutations. For each cluster of mutations we have the count <inline-formula id="pcbi.1004344.e012"><alternatives><graphic id="pcbi.1004344.e012g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004344.e012"/><mml:math id="M12" display="inline" overflow="scroll"><mml:msubsup><mml:mi>n</mml:mi> <mml:mi>h</mml:mi> <mml:mrow><mml:mo stretchy="false" form="prefix">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false" form="postfix">)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> for each real genotype <italic>h</italic> (artifacts are ignored) and time points <italic>t</italic> in the corresponding table. Conditioning on the total count <italic>n</italic><sup>(<italic>t</italic>)</sup> of real genotypes results in a binomial log-likelihood of the following form:
<disp-formula id="pcbi.1004344.e013"><alternatives><graphic id="pcbi.1004344.e013g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004344.e013"/><mml:math id="M13" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="script">L</mml:mi> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>h</mml:mi></mml:munder> <mml:msubsup><mml:mi>n</mml:mi> <mml:mi>h</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mi>l</mml:mi> <mml:mi>o</mml:mi> <mml:mi>g</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>n</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>c</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi>C</mml:mi> <mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mspace width="1pt"/><mml:msubsup><mml:mi>ρ</mml:mi> <mml:mi>c</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
<p>Here the sum is over the set <italic>C</italic><sub><italic>h</italic></sub> of clones that contain haplotype <italic>h</italic>. We then sum this over all tables and time points and maximize for estimates of the clone prevalences <inline-formula id="pcbi.1004344.e014"><alternatives><graphic id="pcbi.1004344.e014g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004344.e014"/><mml:math id="M14" display="inline" overflow="scroll"><mml:msubsup><mml:mi>ρ</mml:mi> <mml:mi>c</mml:mi> <mml:mrow><mml:mo stretchy="false" form="prefix">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false" form="postfix">)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>. We use gradient descent to maximize, projecting each step onto the simplex in <xref ref-type="disp-formula" rid="pcbi.1004344.e009">Eq 3</xref>. Projecting onto the simplex is relatively straightforward, the updated prevalence vector <italic>ρ</italic> just becomes <inline-formula id="pcbi.1004344.e015"><alternatives><graphic id="pcbi.1004344.e015g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004344.e015"/><mml:math id="M15" display="inline" overflow="scroll"><mml:mfrac><mml:mstyle mathvariant="bold"><mml:mi>ρ</mml:mi></mml:mstyle> <mml:mrow><mml:mo stretchy="false" form="prefix">|</mml:mo> <mml:mo stretchy="false" form="prefix">|</mml:mo> <mml:mstyle mathvariant="bold"><mml:mi>ρ</mml:mi></mml:mstyle> <mml:mo stretchy="false" form="prefix">|</mml:mo> <mml:msub><mml:mo stretchy="false" form="prefix">|</mml:mo> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula>, where negative components are set to zero.</p>
</sec>
<sec id="sec020">
<title>Step 5 Range estimation</title>
<p>Step 4 does not always result in a unique estimate, because there may be ranges of values <inline-formula id="pcbi.1004344.e016"><alternatives><graphic id="pcbi.1004344.e016g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004344.e016"/><mml:math id="M16" display="inline" overflow="scroll"><mml:msubsup><mml:mi>ρ</mml:mi> <mml:mi>c</mml:mi> <mml:mrow><mml:mo stretchy="false" form="prefix">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false" form="postfix">)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> on the simplex of <xref ref-type="disp-formula" rid="pcbi.1004344.e009">Eq 3</xref> that yield identical terms <inline-formula id="pcbi.1004344.e017"><alternatives><graphic id="pcbi.1004344.e017g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004344.e017"/><mml:math id="M17" display="inline" overflow="scroll"><mml:mrow><mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>c</mml:mi> <mml:mo>∈</mml:mo> <mml:mi>s</mml:mi></mml:mrow></mml:munder> <mml:msubsup><mml:mi>ρ</mml:mi> <mml:mi>c</mml:mi> <mml:mrow><mml:mo stretchy="false" form="prefix">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false" form="postfix">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>. Then if <inline-formula id="pcbi.1004344.e018"><alternatives><graphic id="pcbi.1004344.e018g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004344.e018"/><mml:math id="M18" display="inline" overflow="scroll"><mml:msubsup><mml:mover><mml:mi>ρ</mml:mi> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mi>c</mml:mi> <mml:mrow><mml:mo stretchy="false" form="prefix">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false" form="postfix">)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> are the estimates from the gradient descent, we use the simplex method to maximize <inline-formula id="pcbi.1004344.e019"><alternatives><graphic id="pcbi.1004344.e019g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004344.e019"/><mml:math id="M19" display="inline" overflow="scroll"><mml:mrow><mml:mo>±</mml:mo> <mml:msubsup><mml:mi>ρ</mml:mi> <mml:mi>c</mml:mi> <mml:mrow><mml:mo stretchy="false" form="prefix">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false" form="postfix">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> subject to <xref ref-type="disp-formula" rid="pcbi.1004344.e009">Eq 3</xref> and conditions of the form:
<disp-formula id="pcbi.1004344.e020"><alternatives><graphic id="pcbi.1004344.e020g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004344.e020"/><mml:math id="M20" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>c</mml:mi> <mml:mo>∈</mml:mo> <mml:mi>s</mml:mi></mml:mrow></mml:munder> <mml:msubsup><mml:mi>ρ</mml:mi> <mml:mi>c</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>c</mml:mi> <mml:mo>∈</mml:mo> <mml:mi>s</mml:mi></mml:mrow></mml:munder> <mml:msubsup><mml:mover accent="true"><mml:mi>ρ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>c</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
<p>Valid clonesets with the maximum likelihood are then selected. This can be applied to any putative network to either conclude that the network is not feasible, or produce a range of possible prevalences associated with the network.</p>
</sec>
</sec>
<sec id="sec021">
<title>Template Switching</title>
<p>We model template switching during rtPCR as follows. Suppose we have two mutations of interest and four possible genotypes, labeled <italic>C</italic><sub>00</sub>, <italic>C</italic><sub>01</sub>, <italic>C</italic><sub>10</sub> and <italic>C</italic><sub>11</sub>. We have corresponding read depth counts <italic>n</italic><sub>00</sub>, <italic>n</italic><sub>01</sub>, <italic>n</italic><sub>10</sub> and <italic>n</italic><sub>11</sub>. Now, if tree like evolution exists, one of <italic>C</italic><sub>01</sub>, <italic>C</italic><sub>10</sub> or <italic>C</italic><sub>11</sub> is an artifact arising from template switching during rtPCR (the wild type C00 is assumed to always occur). We demonstrate the case where <italic>C</italic><sub>01</sub> is an artifact (model 2 in <xref ref-type="fig" rid="pcbi.1004344.g006">Fig 6Aii</xref>). The derivation for the other two models is similar. Then we assume that the real clones <italic>C</italic><sub>00</sub>, <italic>C</italic><sub>10</sub> and <italic>C</italic><sub>11</sub> have prevalences of <italic>a</italic>, <italic>b</italic> and <italic>c</italic>, respectively, so that <italic>a</italic> + <italic>b</italic> + <italic>c</italic> = 1.</p>
<p>We model rtPCR as a time continuous three state process, where template switching occurs at a rate <italic>λ</italic>, jumping to any of the three templates <italic>C</italic><sub>00</sub>, <italic>C</italic><sub>10</sub> or <italic>C</italic><sub>11</sub> with probabilities <italic>a</italic>, <italic>b</italic> and <italic>c</italic>, respectively. We also refer to the states as <italic>a</italic>, <italic>b</italic> and <italic>c</italic>. The template switching rate <italic>λ</italic> is taken to be a constant, which is equivalent to assuming template switching occurs with uniform probability along the segments. Any sequence context effects along segments are ignored. We let <italic>p</italic><sub><italic>a</italic></sub>(<italic>t</italic>), <italic>p</italic><sub><italic>b</italic></sub>(<italic>t</italic>) and <italic>p</italic><sub><italic>c</italic></sub>(<italic>t</italic>) be the probabilities of occupying a copy of the corresponding templates at position <italic>t</italic>. Then conditioning <italic>p</italic><sub><italic>a</italic></sub>(<italic>t</italic>) over a time interval (<italic>t</italic>, <italic>t</italic> + <italic>dt</italic>) results in the following expression (see [<xref ref-type="bibr" rid="pcbi.1004344.ref038">38</xref>] for typical derivations):
<disp-formula id="pcbi.1004344.e021"><alternatives><graphic id="pcbi.1004344.e021g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004344.e021"/><mml:math id="M21" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mi>d</mml:mi> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mi>λ</mml:mi> <mml:mi>d</mml:mi> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>a</mml:mi> <mml:mi>λ</mml:mi> <mml:mi>d</mml:mi> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>a</mml:mi> <mml:mi>λ</mml:mi> <mml:mi>d</mml:mi> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:mi>c</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>a</mml:mi> <mml:mi>λ</mml:mi> <mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
<p>This gives us the following differential equation and solution:
<disp-formula id="pcbi.1004344.e022"><alternatives><graphic id="pcbi.1004344.e022g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004344.e022"/><mml:math id="M22" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>p</mml:mi> <mml:mi>a</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo> <mml:mi>λ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>a</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>⇔</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>a</mml:mi> <mml:mo>+</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mi>a</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>λ</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
<p>We rescale time so that <italic>t</italic> = 1 represents one rtPCR cycle. We then have the following transition matrix between states:
<disp-formula id="pcbi.1004344.e023"><alternatives><graphic id="pcbi.1004344.e023g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004344.e023"/><mml:math id="M23" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>T</mml:mtext> <mml:mo>=</mml:mo> <mml:mfenced separators="" open="(" close=")"><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>a</mml:mi> <mml:mo>+</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mi>a</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>λ</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mi>b</mml:mi> <mml:mo>-</mml:mo> <mml:mi>b</mml:mi> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>λ</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mi>c</mml:mi> <mml:mo>-</mml:mo> <mml:mi>c</mml:mi> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>λ</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:mi>a</mml:mi> <mml:mo>-</mml:mo> <mml:mi>a</mml:mi> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>λ</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mi>b</mml:mi> <mml:mo>+</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mi>b</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>λ</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mi>c</mml:mi> <mml:mo>-</mml:mo> <mml:mi>c</mml:mi> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>λ</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:mi>a</mml:mi> <mml:mo>-</mml:mo> <mml:mi>a</mml:mi> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>λ</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mi>b</mml:mi> <mml:mo>-</mml:mo> <mml:mi>b</mml:mi> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>λ</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mi>c</mml:mi> <mml:mo>+</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mi>c</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>λ</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
<p>Probabilities for all types <italic>C</italic><sub>00</sub>, <italic>C</italic><sub>01</sub>, <italic>C</italic><sub>10</sub> and <italic>C</italic><sub>11</sub> can now be defined, which we demonstrate for <italic>C</italic><sub>10</sub>. Derivations for the other terms can be obtained in a similar manner. From <xref ref-type="fig" rid="pcbi.1004344.g006">Fig 6Aii</xref> we see that to obtain a read of the form <italic>C</italic><sub>10</sub>, we can start in either state <italic>b</italic> or <italic>c</italic> and end in either state <italic>a</italic> or <italic>b</italic>. This gives us four terms to add:
<disp-formula id="pcbi.1004344.e024"><alternatives><graphic id="pcbi.1004344.e024g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004344.e024"/><mml:math id="M24" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>C</mml:mi> <mml:mn>10</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>b</mml:mi> <mml:msub><mml:mi>T</mml:mi> <mml:mrow><mml:mi>b</mml:mi> <mml:mi>a</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:mi>b</mml:mi> <mml:msub><mml:mi>T</mml:mi> <mml:mrow><mml:mi>b</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:mi>c</mml:mi> <mml:msub><mml:mi>T</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>a</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:mi>c</mml:mi> <mml:msub><mml:mi>T</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mi>b</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>a</mml:mi> <mml:mo>-</mml:mo> <mml:mi>a</mml:mi> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>λ</mml:mi></mml:mrow></mml:msup> <mml:mo>+</mml:mo> <mml:mi>b</mml:mi> <mml:mo>+</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mi>b</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>λ</mml:mi></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>c</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>a</mml:mi> <mml:mo>-</mml:mo> <mml:mi>a</mml:mi> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>λ</mml:mi></mml:mrow></mml:msup> <mml:mo>+</mml:mo> <mml:mi>b</mml:mi> <mml:mo>-</mml:mo> <mml:mi>b</mml:mi> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>λ</mml:mi></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>b</mml:mi> <mml:mo>+</mml:mo> <mml:mi>a</mml:mi> <mml:mi>c</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
<p>Here <italic>n</italic> = 1 − <italic>e</italic><sup>−<italic>λ</italic></sup> is the probability a template switch occurs. The formulas in <xref ref-type="fig" rid="pcbi.1004344.g006">Fig 6A</xref> are obtained similarly.</p>
<p>The counts <italic>n</italic><sub>00</sub>, <italic>n</italic><sub>01</sub>, <italic>n</italic><sub>10</sub> and <italic>n</italic><sub>11</sub> then follow a multinomial distribution, from which log-likelihoods can be derived. A chi-squared goodness of fit can then be obtained. We note that in many cases, solutions for the four terms <italic>Pr</italic>(<italic>C</italic><sub>00</sub>), <italic>Pr</italic>(<italic>C</italic><sub>01</sub>), <italic>Pr</italic>(<italic>C</italic><sub>10</sub>) and <italic>Pr</italic>(<italic>C</italic><sub>11</sub>) in terms of <italic>a</italic>, <italic>b</italic>, <italic>c</italic> and <italic>n</italic> can be obtained, resulting in a perfect fit. When this is not possible, one or more of the three models can be rejected if the fit is sufficiently bad.</p>
<p>Note that none of these three models necessarily explain the data. In the last column of <xref ref-type="fig" rid="pcbi.1004344.g006">Fig 6D</xref>, for example, we have four artificial counts 50, 1000, 1000 and 1000 corresponding to genotypes <italic>C</italic><sub>00</sub>, <italic>C</italic><sub>01</sub>, <italic>C</italic><sub>10</sub> and <italic>C</italic><sub>11</sub>. All three models are a bad fit suggesting recombination is present. However, this relies on small counts for <italic>C</italic><sub>00</sub>, which were not observed in the real data that was examined.</p>
<p>Note that template switching has no effect on the prevalence of individual mutations. For example, considering <xref ref-type="fig" rid="pcbi.1004344.g005">Fig 5Ciii</xref>, if we add <italic>Pr</italic>(<italic>C</italic><sub>01</sub>) and <italic>Pr</italic>(<italic>C</italic><sub>11</sub>), we get <italic>b</italic> + <italic>c</italic>, which is precisely the prevalence of mutation <italic>M</italic>2.</p>
</sec>
<sec id="sec022">
<title>Validation and Simulation</title>
<p>The validation of the method is based upon simulated data. This will give some idea of the reconstruction capabilities of the methods and allow benchmarking with other existing approaches. In particular, we compared our tree construction algorithm to the benchmark software Shorah using the same simulation approaches as Zagordi et al [<xref ref-type="bibr" rid="pcbi.1004344.ref012">12</xref>, <xref ref-type="bibr" rid="pcbi.1004344.ref015">15</xref>] and Astrovskaya et al. [<xref ref-type="bibr" rid="pcbi.1004344.ref016">16</xref>].</p>
<p>To measure the performance of the mixed population estimation, we computed the <italic>Precision</italic>, the <italic>Recall</italic>, and the <italic>Accuracy</italic> of prevalence estimation for the methods of interest. The recall (or sensitivity) gives the ratio <inline-formula id="pcbi.1004344.e025"><alternatives><graphic id="pcbi.1004344.e025g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004344.e025"/><mml:math id="M25" display="inline" overflow="scroll"><mml:mfrac><mml:mrow><mml:mi>T</mml:mi> <mml:mi>P</mml:mi></mml:mrow> <mml:mrow><mml:mi>T</mml:mi> <mml:mi>P</mml:mi> <mml:mo>+</mml:mo> <mml:mi>F</mml:mi> <mml:mi>N</mml:mi></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula> of correctly reconstructed haplotypes to the total number of true haplotypes, where we have true positives (<italic>TP</italic>), false negatives (<italic>FN</italic>) and false positives (<italic>FP</italic>). The precision gives their ratio to the total number of generated haplotypes, <inline-formula id="pcbi.1004344.e026"><alternatives><graphic id="pcbi.1004344.e026g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004344.e026"/><mml:math id="M26" display="inline" overflow="scroll"><mml:mfrac><mml:mrow><mml:mi>T</mml:mi> <mml:mi>P</mml:mi></mml:mrow> <mml:mrow><mml:mi>T</mml:mi> <mml:mi>P</mml:mi> <mml:mo>+</mml:mo> <mml:mi>F</mml:mi> <mml:mi>P</mml:mi></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula>.</p>
<p>The accuracy measures the ability of the method to recover the true mixture of haplotypes, and was defined as measuring the mean absolute error of the prevalence estimate. Where a range estimate is obtained for the prevalence, we calculate the shortest distance from the true value to the range.</p>
<p>Comparison with Shorah was done on simulated deep sequencing data from a 1.5 kb-long region of HIV-1. Simulated reads have been generated by MetaSim [<xref ref-type="bibr" rid="pcbi.1004344.ref039">39</xref>], a meta-genomic simulator which generates collections of reads reproducing the error model of some given technologies such as Sanger and 454 Roche. It takes as input a set of genome sequences and an abundancy profile and generates a collection of reads sampling the inputted genomic population.</p>
<p>For up to 12 haplotypes and 3 reticulations we performed 100 runs as follows. We randomly constructed a network by attaching each new branch to a random selected node. Reticulations were also randomized. The prevalences of the resulting clones (at the leaves) were randomly selected from a Dirichlet distribution. This is repeated for 10 time points of data. We used MetaSim to generate a collection of 5,000 reads having an average length of 500bp and replicating the error process of Roche 454 sequencing. The methods were then applied to the resulting data.</p>
<p>Shorah output can display mismatches or gaps in the outputted genomes, with increasing frequency at the segment edges. We applied a modification on Shorah output by trimming the edge and we then corrected one or two mismatches or gaps on all the genomes before addressing the comparison. <xref ref-type="fig" rid="pcbi.1004344.g010">Fig 10A–10C</xref> provide the comparison for recall, precision and error indicators. We found slight improvements for recall, especially for tree like evolution. The precision and error also had improved results. We acknowledge that the simulations were based upon evolutionary structures that the models are designed to fit so such improvement might be expected. Furthermore, Shorah likely have better performance on low prevalence clones. However, these simulations demonstrate that reasonable results can be obtained from the techniques we have introduced.</p>
<fig id="pcbi.1004344.g010" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004344.g010</object-id>
<label>Fig 10</label>
<caption>
<title>Validation profiles for a range of haplotype counts, including; (A) Recall, (B) Precision, and (C) Error.</title>
<p>In all cases the solid line denotes the algorithm preformance, the dashed line indicates Shorah performance.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004344.g010"/>
</fig>
</sec>
</sec>
<sec id="sec023">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1004344.s001" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004344.s001" mimetype="text/csv" xlink:type="simple">
<label>S1 Data</label>
<caption>
<title>Haplotype Tables.</title>
<p>(CSV)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004344.s002" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004344.s002" mimetype="text/csv" xlink:type="simple">
<label>S2 Data</label>
<caption>
<title>Hi-seq Coverage.</title>
<p>(CSV)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004344.s003" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004344.s003" mimetype="text/csv" xlink:type="simple">
<label>S3 Data</label>
<caption>
<title>Mi-seq Coverage.</title>
<p>(CSV)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004344.s004" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004344.s004" mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" xlink:type="simple">
<label>S4 Data</label>
<caption>
<title>Output Information.</title>
<p>(XLSX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004344.s005" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004344.s005" mimetype="application/pdf" xlink:type="simple">
<label>S5 Data</label>
<caption>
<title>Viral Copy Numbers.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004344.s006" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004344.s006" mimetype="text/plain" xlink:type="simple">
<label>S1 File</label>
<caption>
<title>Segment 1 Networks for visualisation in Dendroscope.</title>
<p>(TXT)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004344.s007" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004344.s007" mimetype="text/plain" xlink:type="simple">
<label>S2 File</label>
<caption>
<title>Segment 2 Networks for visualisation in Dendroscope.</title>
<p>(TXT)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004344.s008" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004344.s008" mimetype="text/plain" xlink:type="simple">
<label>S3 File</label>
<caption>
<title>Segment 3 Networks for visualisation in Dendroscope.</title>
<p>(TXT)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004344.s009" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004344.s009" mimetype="text/plain" xlink:type="simple">
<label>S4 File</label>
<caption>
<title>Segment 4 Networks for visualisation in Dendroscope.</title>
<p>(TXT)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004344.s010" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004344.s010" mimetype="text/plain" xlink:type="simple">
<label>S5 File</label>
<caption>
<title>Segment 5 Networks for visualisation in Dendroscope.</title>
<p>(TXT)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004344.s011" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004344.s011" mimetype="text/plain" xlink:type="simple">
<label>S6 File</label>
<caption>
<title>Segment 6 Networks for visualisation in Dendroscope.</title>
<p>(TXT)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004344.s012" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004344.s012" mimetype="text/plain" xlink:type="simple">
<label>S7 File</label>
<caption>
<title>Segment 7 Networks for visualisation in Dendroscope.</title>
<p>(TXT)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004344.s013" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004344.s013" mimetype="text/plain" xlink:type="simple">
<label>S8 File</label>
<caption>
<title>Segment 8 Networks for visualisation in Dendroscope.</title>
<p>(TXT)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004344.s014" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004344.s014" mimetype="text/plain" xlink:type="simple">
<label>S9 File</label>
<caption>
<title>Cross Segment Networks for visualisation in Dendroscope.</title>
<p>(TXT)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="pcbi.1004344.ref001">
<label>1</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Beerenwinkel</surname> <given-names>N</given-names></name> and <name name-style="western"><surname>Zagordi</surname> <given-names>O</given-names></name>, <year>2011</year>, <article-title>Ultra-deep sequencing for the analysis of viral populations</article-title>, <source><italic>Curr. Opin. Virol</italic></source>, <volume>1</volume>(<issue>5</issue>), <fpage>413</fpage>–<lpage>418</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.coviro.2011.07.008" xlink:type="simple">10.1016/j.coviro.2011.07.008</ext-link></comment> <object-id pub-id-type="pmid">22440844</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004344.ref002">
<label>2</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Siobain</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Shackelton</surname> <given-names>LA</given-names></name> and <name name-style="western"><surname>Holmes</surname> <given-names>EC</given-names></name>, <year>2008</year>, <article-title>Rates of evolutionary change in viruses: patterns and determinants</article-title>, <source><italic>Nature Reviews Genetics</italic></source>, <volume>9</volume>(<issue>4</issue>), <fpage>267</fpage>–<lpage>276</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nrg2323" xlink:type="simple">10.1038/nrg2323</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004344.ref003">
<label>3</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Skums</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Mancuso</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Artyomenko</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Tork</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Mandoiu</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Khudyakov</surname> <given-names>Y</given-names></name> and <name name-style="western"><surname>Zelikovsky</surname> <given-names>A</given-names></name>, <year>2013</year>, <article-title>Reconstruction of Viral Population Structure from Next-Generation Sequencing Data Using Multicommodity Flows</article-title>, <source><italic>BMC Bioinformatics</italic></source>, <volume>14</volume>(<issue>9</issue>), <fpage>S2</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2105-14-S9-S2" xlink:type="simple">10.1186/1471-2105-14-S9-S2</ext-link></comment> <object-id pub-id-type="pmid">23902469</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004344.ref004">
<label>4</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Murcia</surname> <given-names>PR</given-names></name>, <name name-style="western"><surname>Hughes</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Battista</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Lloyd</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Baillie</surname> <given-names>GJ</given-names></name>, <name name-style="western"><surname>Ramirez-Gonzalez</surname> <given-names>RH</given-names></name>, <name name-style="western"><surname>Ormond</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Oliver</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Elton</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Mumford</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Caccamo</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Kellam</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Grenfell</surname> <given-names>BT</given-names></name>, <name name-style="western"><surname>Holmes</surname> <given-names>EC</given-names></name> and <name name-style="western"><surname>Wood</surname> <given-names>JLN</given-names></name>, <year>2012</year>, <article-title>Evolution of an Eurasian Avian-like Influenza Virus in Naive and Vaccinated Pigs</article-title>, <volume>8</volume>(<issue>5</issue>), <fpage>e1002730</fpage>, <source><italic>PLOS Pathogens</italic></source>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.ppat.1002730" xlink:type="simple">10.1371/journal.ppat.1002730</ext-link></comment> <object-id pub-id-type="pmid">22693449</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004344.ref005">
<label>5</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Murcia</surname> <given-names>PR</given-names> <suffix>1</suffix></name>, <name name-style="western"><surname>Baillie</surname> <given-names>GJ</given-names></name>, <name name-style="western"><surname>Daly</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Elton</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Jervis</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Mumford</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Newton</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Parrish</surname> <given-names>CR</given-names></name>, <name name-style="western"><surname>Hoelzer</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Dougan</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Parkhill</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Lennard</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Ormond</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Moule</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Whitwham</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>McCauley</surname> <given-names>JW</given-names></name>, <name name-style="western"><surname>McKinley</surname> <given-names>TJ</given-names></name>, <name name-style="western"><surname>Holmes</surname> <given-names>EC</given-names></name>, <name name-style="western"><surname>Grenfell</surname> <given-names>BT</given-names></name>, <name name-style="western"><surname>Wood</surname> <given-names>JL</given-names></name>, <year>2010</year>, <article-title>Intra- and interhost evolutionary dynamics of equine influenza virus</article-title>, <source><italic>J Virol</italic></source>., <volume>84</volume>(<issue>14</issue>), <fpage>6943</fpage>–<lpage>54</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1128/JVI.00112-10" xlink:type="simple">10.1128/JVI.00112-10</ext-link></comment> <object-id pub-id-type="pmid">20444896</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004344.ref006">
<label>6</label>
<mixed-citation xlink:type="simple" publication-type="book">
<name name-style="western"><surname>Zagordi</surname> <given-names>O</given-names></name> and <name name-style="western"><surname>Töpfer</surname> <given-names>A</given-names></name> and <name name-style="western"><surname>Prabhakaran</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Roth</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Halperin</surname> <given-names>E</given-names></name> and <name name-style="western"><surname>Beerenwinkel</surname> <given-names>N</given-names></name>, <year>2012</year>, <chapter-title><italic>Probabilistic inference of viral quasispecies subject to recombination</italic></chapter-title>, <source>Research in Computational Molecular Biology</source>, <publisher-name>Springer</publisher-name>, <fpage>342</fpage>–<lpage>354</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004344.ref007">
<label>7</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Luciani</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Bull</surname> <given-names>RA</given-names></name> and <name name-style="western"><surname>Lloyd</surname> <given-names>AR</given-names></name>, <year>2012</year>, <article-title>Next generation deep sequencing and vaccine design: today and tomorrow</article-title>, <source><italic>Trends in biotechnology</italic></source>, <volume>30</volume>(<issue>9</issue>), <fpage>443</fpage>–<lpage>452</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.tibtech.2012.05.005" xlink:type="simple">10.1016/j.tibtech.2012.05.005</ext-link></comment> <object-id pub-id-type="pmid">22721705</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004344.ref008">
<label>8</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Prosperi</surname> <given-names>MCF</given-names></name>, <name name-style="western"><surname>Prosperi</surname> <given-names>Luciano</given-names></name> and <name name-style="western"><surname>Bruselles</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Abbate</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Rozera</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Vincenti</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Solmone</surname> <given-names>MC</given-names></name>, <name name-style="western"><surname>Capobianchi</surname> <given-names>MR</given-names></name> and <name name-style="western"><surname>Ulivi</surname> <given-names>G</given-names></name>, <year>2011</year>, <article-title>Combinatorial analysis and algorithms for quasispecies reconstruction using next-generation sequencing</article-title>, <source><italic>BMC bioinformatics</italic></source>, <volume>12</volume>(<issue>1</issue>), <fpage>5</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2105-12-5" xlink:type="simple">10.1186/1471-2105-12-5</ext-link></comment> <object-id pub-id-type="pmid">21208435</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004344.ref009">
<label>9</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Barzon</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Lavezzo</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Militello</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Toppo</surname> <given-names>S</given-names></name> and <name name-style="western"><surname>Palù</surname> <given-names>G</given-names></name>, <year>2011</year>, <article-title>Applications of next-generation sequencing technologies to diagnostic virology</article-title>, <source><italic>International journal of molecular sciences</italic></source>, <volume>12</volume>(<issue>11</issue>), <fpage>7861</fpage>–<lpage>7884</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.3390/ijms12117861" xlink:type="simple">10.3390/ijms12117861</ext-link></comment> <object-id pub-id-type="pmid">22174638</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004344.ref010">
<label>10</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Pybus</surname> <given-names>OG</given-names></name> and <name name-style="western"><surname>Rambaut</surname> <given-names>A</given-names></name>, <year>2009</year>, <article-title>Evolutionary analysis of the dynamics of viral infectious disease</article-title>, <source><italic>Nature Reviews Genetics</italic></source>, <volume>10</volume>(<issue>8</issue>), <fpage>540</fpage>–<lpage>550</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nrg2583" xlink:type="simple">10.1038/nrg2583</ext-link></comment> <object-id pub-id-type="pmid">19564871</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004344.ref011">
<label>11</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Beerenwinkel</surname> <given-names>N</given-names></name> and <name name-style="western"><surname>Günthard</surname> <given-names>HF</given-names></name>, <name name-style="western"><surname>Roth</surname> <given-names>V</given-names></name> and <name name-style="western"><surname>Metzner</surname> <given-names>KJ</given-names></name>, <year>2012</year>, <article-title>Challenges and opportunities in estimating viral genetic diversity from next-generation sequencing data</article-title>, <source><italic>Frontiers in Microbiology</italic></source>, <volume>3</volume>, <fpage>329</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.3389/fmicb.2012.00329" xlink:type="simple">10.3389/fmicb.2012.00329</ext-link></comment> <object-id pub-id-type="pmid">22973268</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004344.ref012">
<label>12</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Zagordi</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Geyrhofer</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Roth</surname> <given-names>V</given-names></name> and <name name-style="western"><surname>Beerenwinkel</surname> <given-names>N</given-names></name>, <year>2010</year>, <article-title>Deep sequencing of a genetically heterogeneous sample: local haplotype reconstruction and read error correction</article-title>, <source><italic>Journal of computational biology</italic></source>, <volume>17</volume>(<issue>3</issue>), <fpage>417</fpage>–<lpage>428</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1089/cmb.2009.0164" xlink:type="simple">10.1089/cmb.2009.0164</ext-link></comment> <object-id pub-id-type="pmid">20377454</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004344.ref013">
<label>13</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Eriksson</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Pachter</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Mitsuya</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Rhee</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Gharizadeh</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Ronaghi</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Shafer</surname> <given-names>RW</given-names></name> and <name name-style="western"><surname>Beerenwinkel</surname> <given-names>N</given-names></name>, <year>2008</year>, <article-title>Viral population estimation using pyrosequencing</article-title>, <source><italic>PLoS Computational Biology</italic></source>, <volume>4</volume>(<issue>5</issue>), <fpage>e1000074</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1000074" xlink:type="simple">10.1371/journal.pcbi.1000074</ext-link></comment> <object-id pub-id-type="pmid">18437230</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004344.ref014">
<label>14</label>
<mixed-citation xlink:type="simple" publication-type="book">
<name name-style="western"><surname>Westbrooks</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Astrovskaya</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Campo</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Khudyakov</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Berman</surname> <given-names>Piotr</given-names></name> and <name name-style="western"><surname>Zelikovsky</surname> <given-names>A</given-names></name>, <year>2008</year>, <chapter-title>HCV quasispecies assembly using network flows</chapter-title>, <source><italic>Bioinformatics Research and Applications</italic></source>, <fpage>159</fpage>–<lpage>170</lpage>, <publisher-name>Springer</publisher-name>.</mixed-citation>
</ref>
<ref id="pcbi.1004344.ref015">
<label>15</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<year>2011</year>, <name name-style="western"><surname>Zagordi</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Bhattacharya</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Eriksson</surname> <given-names>N</given-names></name> and <name name-style="western"><surname>Beerenwinkel</surname> <given-names>N</given-names></name>, <article-title>ShoRAH: estimating the genetic diversity of a mixed sample from next-generation sequencing data</article-title>, <source><italic>BMC bioinformatics</italic></source>, <volume>12</volume>(<issue>1</issue>), <fpage>119</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2105-12-119" xlink:type="simple">10.1186/1471-2105-12-119</ext-link></comment> <object-id pub-id-type="pmid">21521499</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004344.ref016">
<label>16</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Astrovskaya</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Tork</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Mangul</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Westbrooks</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Măndoiu</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Balfe</surname> <given-names>P</given-names></name> and <name name-style="western"><surname>Zelikovsky</surname> <given-names>A</given-names></name>, <year>2011</year>, <article-title>Inferring viral quasispecies spectra from 454 pyrosequencing reads</article-title>, <source><italic>BMC bioinformatics</italic></source>, <volume>12</volume>(<issue>6</issue>), <fpage>S1</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2105-12-S6-S1" xlink:type="simple">10.1186/1471-2105-12-S6-S1</ext-link></comment> <object-id pub-id-type="pmid">21989211</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004344.ref017">
<label>17</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>O’Neil</surname> <given-names>ST</given-names></name> and <name name-style="western"><surname>Emrich</surname> <given-names>SJ</given-names></name>, <year>2012</year>, <article-title>Haplotype and minimum-chimerism consensus determination using short sequence data</article-title>, <source><italic>BMC genomics</italic></source>, <volume>13</volume>(<issue>2</issue>), <fpage>S4</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2164-13-S2-S4" xlink:type="simple">10.1186/1471-2164-13-S2-S4</ext-link></comment> <object-id pub-id-type="pmid">22537299</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004344.ref018">
<label>18</label>
<mixed-citation xlink:type="simple" publication-type="other">
Mancuso N, Tork B, Skums P Mandoiu I and Zelikovsky A, 2011, Viral quasispecies reconstruction from amplicon 454 pyrosequencing reads, <italic>Bioinformatics and Biomedicine Workshops (BIBMW), 2011 IEEE International Conference</italic>, 94–101.</mixed-citation>
</ref>
<ref id="pcbi.1004344.ref019">
<label>19</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Huang</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Kantor</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>DeLong</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Schreier</surname> <given-names>L</given-names></name> and <name name-style="western"><surname>Istrail</surname> <given-names>S</given-names></name>, <year>2011</year>, <article-title>QColors: An algorithm for conservative viral quasispecies reconstruction from short and non-contiguous next generation sequencing reads</article-title>, <source><italic>In silico biology</italic></source>, <volume>11</volume>(<issue>5</issue>), <fpage>193</fpage>–<lpage>201</lpage>. <object-id pub-id-type="pmid">23202421</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004344.ref020">
<label>20</label>
<mixed-citation xlink:type="simple" publication-type="other">
Prabhakaran S, Rey M, Zagordi O, Beerenwinkel N and Roth V, 2010, HIV-haplotype inference using a constraint-based dirichlet process mixture model, <italic>Machine Learning in Computational Biology (MLCB) NIPS Workshop</italic>, 1–4.</mixed-citation>
</ref>
<ref id="pcbi.1004344.ref021">
<label>21</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Tsaic</surname> <given-names>K</given-names></name> and <name name-style="western"><surname>Chen</surname> <given-names>G</given-names></name>, <year>2011</year>, <article-title>Influenza genome diversity and evolution</article-title>, <source><italic>Microbes and Infection</italic></source>, <volume>13</volume>(<issue>5</issue>), <fpage>479</fpage>–<lpage>488</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.micinf.2011.01.013" xlink:type="simple">10.1016/j.micinf.2011.01.013</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004344.ref022">
<label>22</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Kuroda</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Katano</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Nakajima</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Tobiume</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Ainai</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Sekizuka</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Hasegawa</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Tashiro</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Sasaki</surname> <given-names>Y</given-names></name> and <name name-style="western"><surname>Arakawa</surname> <given-names>Y</given-names></name> <etal>et al</etal>., <year>2010</year>, <article-title>Characterization of quasispecies of pandemic 2009 influenza A virus (A/H1N1/2009) by de novo sequencing using a next-generation DNA sequencer</article-title>, <source><italic>PLoS One</italic></source>, <volume>5</volume>(<issue>4</issue>), <fpage>e10256</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0010256" xlink:type="simple">10.1371/journal.pone.0010256</ext-link></comment> <object-id pub-id-type="pmid">20428231</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004344.ref023">
<label>23</label>
<mixed-citation xlink:type="simple" publication-type="book">
<name name-style="western"><surname>Papadimitriou</surname> <given-names>PH</given-names></name>, <year>1982</year>, <source><italic>Combinatorial Optimization</italic></source>, <publisher-name>Dover</publisher-name>.</mixed-citation>
</ref>
<ref id="pcbi.1004344.ref024">
<label>24</label>
<mixed-citation xlink:type="simple" publication-type="book">
<name name-style="western"><surname>Semple</surname> <given-names>C</given-names></name> and <name name-style="western"><surname>Steel</surname> <given-names>M</given-names></name>, <year>2003</year>, <source>Phylogenetics</source>, <publisher-name>OUP</publisher-name>.</mixed-citation>
</ref>
<ref id="pcbi.1004344.ref025">
<label>25</label>
<mixed-citation xlink:type="simple" publication-type="book">
<name name-style="western"><surname>Huson</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Rupp</surname> <given-names>R</given-names></name> and <name name-style="western"><surname>Scornavacca</surname> <given-names>C</given-names></name>, <year>2010</year>, <source><italic>Phylogenetic Networks, Concepts, Algorithms and Applications</italic></source>, <publisher-name>CUP</publisher-name>.</mixed-citation>
</ref>
<ref id="pcbi.1004344.ref026">
<label>26</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Langmead</surname> <given-names>B</given-names></name> and <name name-style="western"><surname>Salzberg</surname> <given-names>SL</given-names></name>, <year>2012</year>, <article-title>Fast gapped-read alignment with Bowtie 2</article-title>, <source><italic>Nature Methods</italic></source>, <volume>9</volume>(<issue>4</issue>), <fpage>357</fpage>–<lpage>359</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.1923" xlink:type="simple">10.1038/nmeth.1923</ext-link></comment> <object-id pub-id-type="pmid">22388286</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004344.ref027">
<label>27</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Sheward</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>Murrell</surname> <given-names>B</given-names></name> and <name name-style="western"><surname>Williamson</surname> <given-names>C</given-names></name>, <year>2012</year>, <article-title>Degenerate Primer IDs and the birthday problem</article-title>, <source><italic>Proc Natl Acad Sci U S A</italic></source>, <volume>109</volume>(<issue>21</issue>), <fpage>E1330</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1203613109" xlink:type="simple">10.1073/pnas.1203613109</ext-link></comment> <object-id pub-id-type="pmid">22517746</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004344.ref028">
<label>28</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Boni</surname> <given-names>MF</given-names></name>, <name name-style="western"><surname>Smith</surname> <given-names>GJ</given-names></name>, <name name-style="western"><surname>Holmes</surname> <given-names>EC</given-names></name>, <name name-style="western"><surname>Vijaykrishna</surname> <given-names>D</given-names></name>, <year>2012</year>, <article-title>No evidence for intra-segment recombination of 2009 H1N1 influenza virus in swine</article-title>, <source><italic>Gene</italic></source>, <volume>494</volume>(<issue>2</issue>), <fpage>242</fpage>–<lpage>5</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.gene.2011.10.041" xlink:type="simple">10.1016/j.gene.2011.10.041</ext-link></comment> <object-id pub-id-type="pmid">22226809</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004344.ref029">
<label>29</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Boni</surname> <given-names>MF</given-names></name>, <name name-style="western"><surname>Zhou</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Taubenberger</surname> <given-names>JK</given-names></name>, <name name-style="western"><surname>Holmes</surname> <given-names>EC</given-names></name>, <year>2008</year>, <article-title>Homologous recombination is very rare or absent in human influenza A virus</article-title>, <source><italic>J Virol</italic></source>., <volume>82</volume>(<issue>10</issue>), <fpage>4807</fpage>–<lpage>11</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1128/JVI.02683-07" xlink:type="simple">10.1128/JVI.02683-07</ext-link></comment> <object-id pub-id-type="pmid">18353939</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004344.ref030">
<label>30</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Boni</surname> <given-names>MF</given-names></name>, <name name-style="western"><surname>de Jong</surname> <given-names>MD</given-names></name>, <name name-style="western"><surname>van Doorn</surname> <given-names>HR</given-names></name>, <name name-style="western"><surname>Holmes</surname> <given-names>EC</given-names></name>, <year>2010</year>, <source><italic>PLoS One</italic></source>, <volume>5</volume>(<issue>5</issue>), <fpage>e10434</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0010434" xlink:type="simple">10.1371/journal.pone.0010434</ext-link></comment> <object-id pub-id-type="pmid">20454662</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004344.ref031">
<label>31</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Simon-Loriere</surname> <given-names>E</given-names></name> and <name name-style="western"><surname>Holmes</surname> <given-names>EC</given-names></name>, <year>2011</year>, <article-title>Why do RNA viruses recombine?</article-title>, <source><italic>Nature Reviews Microbiology</italic></source>, <volume>9</volume>, <fpage>617</fpage>–<lpage>626</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nrmicro2614" xlink:type="simple">10.1038/nrmicro2614</ext-link></comment> <object-id pub-id-type="pmid">21725337</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004344.ref032">
<label>32</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Murcia</surname> <given-names>PR</given-names></name>, <name name-style="western"><surname>Baillie</surname> <given-names>GJ</given-names></name>, <name name-style="western"><surname>Stack</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Jervis</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Elton</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Mumford</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Daly</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Kellam</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Grenfell</surname> <given-names>BT</given-names></name>, <name name-style="western"><surname>Holmes EC and Wood</surname> <given-names>JLN</given-names></name>, <year>2013</year>, <article-title>Evolution of Equine Influenza Virus in Vaccinated Horses</article-title>, <source><italic>J. Virol</italic></source>., <volume>87</volume>(<issue>8</issue>), <fpage>4768</fpage>–<lpage>4771</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1128/JVI.03379-12" xlink:type="simple">10.1128/JVI.03379-12</ext-link></comment> <object-id pub-id-type="pmid">23388708</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004344.ref033">
<label>33</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Zhou</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Donnelly</surname> <given-names>ME</given-names></name>, <name name-style="western"><surname>Scholes</surname> <given-names>DT</given-names></name>, <name name-style="western"><surname>George</surname> <given-names>K</given-names> <prefix>St.</prefix></name>, <name name-style="western"><surname>Hatta</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Kawaoka</surname> <given-names>Y</given-names></name>, and <name name-style="western"><surname>Wentworth</surname> <given-names>DE</given-names></name>, <article-title>Single-Reaction Genomic Amplification Accelerates Sequencing and Vaccine Production for Classical and Swine Origin Human Influenza A Viruses</article-title>, <year>2009</year>, <source><italic>J. Virol</italic></source>., <volume>83</volume>(<issue>19</issue>), <fpage>10309</fpage>–<lpage>10313</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1128/JVI.01109-09" xlink:type="simple">10.1128/JVI.01109-09</ext-link></comment> <object-id pub-id-type="pmid">19605485</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004344.ref034">
<label>34</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Cayley</surname> <given-names>A</given-names></name>, <year>1889</year>, <article-title>A theorem on trees</article-title>, <source><italic>Quart. J. Math</italic></source>, <volume>23</volume>, <fpage>376</fpage>–<lpage>378</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004344.ref035">
<label>35</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Prüfer</surname> <given-names>H</given-names></name>, <year>1918</year>, <article-title>Neuer Beweis eines Satzes über Permutationen</article-title>, <source><italic>Arch. Math. Phys</italic></source>., <volume>27</volume>, <fpage>742</fpage>–<lpage>744</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004344.ref036">
<label>36</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Song YS and Hein</surname> <given-names>J</given-names></name>, <article-title>Constructing Minimal Ancestral Recombination Graphs</article-title>, <year>2005</year>, <source><italic>J. Comp Bio</italic></source>., bf <volume>12</volume>(<issue>2</issue>), <fpage>147</fpage>–<lpage>169</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1089/cmb.2005.12.147" xlink:type="simple">10.1089/cmb.2005.12.147</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004344.ref037">
<label>37</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Sanjuán</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Nebot</surname> <given-names>MR</given-names></name>, <name name-style="western"><surname>Chirico</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Mansky LM and Belshaw</surname> <given-names>R</given-names></name>, <year>2010</year>, <article-title>Viral mutation rates</article-title>, <source><italic>J. Virol</italic></source>., <volume>84</volume>, <fpage>9733</fpage>–<lpage>9748</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1128/JVI.00694-10" xlink:type="simple">10.1128/JVI.00694-10</ext-link></comment> <object-id pub-id-type="pmid">20660197</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004344.ref038">
<label>38</label>
<mixed-citation xlink:type="simple" publication-type="book">
<name name-style="western"><surname>Bunday</surname> <given-names>BD</given-names></name>, <year>1996</year>, <source><italic>An Introduction to Queueing Theory</italic></source>, <publisher-name>Arnold</publisher-name>.</mixed-citation>
</ref>
<ref id="pcbi.1004344.ref039">
<label>39</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Richter</surname> <given-names>DC</given-names></name>, <name name-style="western"><surname>Ott</surname> <given-names>Felix</given-names></name>, <name name-style="western"><surname>Auch</surname> <given-names>AF</given-names></name>, <name name-style="western"><surname>Schmid</surname> <given-names>R</given-names></name> and <name name-style="western"><surname>Huson</surname> <given-names>DH</given-names></name>, <year>2011</year>, <article-title>MetaSim: A Sequencing Simulator for Genomics and Metagenomics</article-title>, <source><italic>Handbook of Molecular Microbial Ecology I: Metagenomics and Complementary Approaches</italic></source>, <volume>1</volume>(<issue>417</issue>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/9781118010518.ch48" xlink:type="simple">10.1002/9781118010518.ch48</ext-link></comment></mixed-citation>
</ref>
</ref-list>
</back>
</article>