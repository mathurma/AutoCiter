<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id><journal-title-group>
<journal-title>PLoS Computational Biology</journal-title></journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-13-01432</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1003456</article-id>
<article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Biology</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Biophysic al simulations</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Computer science</subject><subj-group><subject>Computing methods</subject><subj-group><subject>Computer animation</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Physics</subject><subj-group><subject>Biophysics</subject><subj-group><subject>Biophysics simulations</subject></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title><italic>In Silico</italic> Single-Molecule Manipulation of DNA with Rigid Body Dynamics</article-title>
<alt-title alt-title-type="running-head">Simulating DNA with Physics Engines</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Carrivain</surname><given-names>Pascal</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Barbi</surname><given-names>Maria</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Victor</surname><given-names>Jean-Marc</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
</contrib-group>
<aff id="aff1"><label>1</label><addr-line>Laboratoire de Physique Théorique de la Matière Condensée, CNRS UMR 7600, Université Pierre et Marie Curie, Paris, France</addr-line></aff>
<aff id="aff2"><label>2</label><addr-line>Institut de Génétique Humaine (IGH), CNRS UPR 1142, Montpellier, France</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Chen</surname><given-names>Shi-Jie</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group>
<aff id="edit1"><addr-line>University of Missouri, United States of America</addr-line></aff>
<author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">victor@lptmc.jussieu.fr</email></corresp>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn>
<fn fn-type="con"><p>Analyzed the data: PC MB JMV. Wrote the paper: PC MB JMV.</p></fn>
</author-notes>
<pub-date pub-type="collection"><month>2</month><year>2014</year></pub-date>
<pub-date pub-type="epub"><day>20</day><month>2</month><year>2014</year></pub-date>
<volume>10</volume>
<issue>2</issue>
<elocation-id>e1003456</elocation-id>
<history>
<date date-type="received"><day>13</day><month>8</month><year>2013</year></date>
<date date-type="accepted"><day>11</day><month>12</month><year>2013</year></date>
</history>
<permissions>
<copyright-year>2014</copyright-year>
<copyright-holder>Carrivain et al</copyright-holder><license xlink:type="simple"><license-p>This is an open-access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions>
<abstract>
<p>We develop a new powerful method to reproduce <italic>in silico</italic> single-molecule manipulation experiments. We demonstrate that flexible polymers such as DNA can be simulated using rigid body dynamics thanks to an original implementation of Langevin dynamics in an open source library called Open Dynamics Engine. We moreover implement a global thermostat which accelerates the simulation sampling by two orders of magnitude. We reproduce force-extension as well as rotation-extension curves of reference experimental studies. Finally, we extend the model to simulations where the control parameter is no longer the torsional strain but instead the torque, and predict the expected behavior for this case which is particularly challenging theoretically and experimentally.</p>
</abstract>
<abstract abstract-type="summary"><title>Author Summary</title>
<p>Video game techniques are designed to simulate rigid body dynamics of macroscopic bodies, e.g. characters or vehicles, in a realistic manner. However they are not able to deal with temperature effects, hence they are not able to deal with molecules. In order to extend these powerful techniques to molecular modeling, we implement here Langevin Dynamics in an open source library called Open Dynamics Engine. Moreover we add a “global thermostat” to this Langevin Dynamics, which accelerates the simulation sampling by two orders of magnitude. With these radically new simulation techniques, we prove that we can accurately reproduce single-molecule manipulation experiments in silico, in particular force-extension as well as rotation-extension curves of reference experimental studies. The method developed here represents an unparalleled tool for the study of more complex single molecule manipulation experiments, notably when DNA interacts with proteins. Furthermore the simulation technique that we propose here has all the functionalities required to tackle the nuclear organization of chromosomes at every length scale, from DNA to whole nuclei.</p>
</abstract>
<funding-group><funding-statement>This work was funded by the Institut National du Cancer, PLBIO program, grant INCa_5960 and the Institut National de la Sante et de la Recherche Medicale, grant MICROMEGAS PC201104. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="13"/></counts></article-meta>
</front>
<body><sec id="s1">
<title/>
<disp-quote>
<p>This is a <italic>PLOS Computational Biology</italic> Methods article.</p>
</disp-quote></sec><sec id="s2">
<title>Introduction</title>
<p>The mechanical and topological properties of DNA and protein-DNA assemblies are of primary importance in many biological processes, including transcription, replication, chromatin organization and remodeling. Since techniques have become available enabling the manipulation of single-molecules <xref ref-type="bibr" rid="pcbi.1003456-Smith1">[1]</xref>, <xref ref-type="bibr" rid="pcbi.1003456-Strick1">[2]</xref>, a large amount of experimental data have been accumulated on the mechanical response of DNA and protein-DNA assemblies under stretching forces and twisting torsions, in particular from optical and magnetic tweezers experiments <xref ref-type="bibr" rid="pcbi.1003456-Strick1">[2]</xref>–<xref ref-type="bibr" rid="pcbi.1003456-Koster1">[5]</xref>. In magnetic tweezers experiments, a DNA molecule is grafted at one end to a coverslip and at the other end to a magnetic bead. The bead is trapped in the magnetic field of a pair of magnets that may be translated, thus exerting a varying force on the bead. Moreover the pair of magnets may be rotated at a certain number of turns, thus constraining the linking number of the DNA molecule. After the stretching force and the number of turns are applied to the bead, the only physical variable that can be directly measured is the DNA extension, <italic>i.e.</italic> the distance between its two ends. Therefore the interpretation of the experimental results requires an important modeling effort, particularly in the more complex cases where DNA is associated with proteins, as for instance in chromatin assemblies <xref ref-type="bibr" rid="pcbi.1003456-Bancaud1">[6]</xref>, <xref ref-type="bibr" rid="pcbi.1003456-Bancaud2">[7]</xref>. Although theoretical approaches may be successful in some cases <xref ref-type="bibr" rid="pcbi.1003456-Moroz1">[8]</xref>–<xref ref-type="bibr" rid="pcbi.1003456-Marko1">[10]</xref>, simulations are often crucial tests of the proposed model validity, when they are not the unique possible way of dealing with the system complexity.</p>
<p>In this spirit, we aim to develop an efficient tool to manipulate single-molecules <italic>in silico</italic> reproducing optical and magnetic tweezers experiments. This task is challenging since the DNA model should have precise specifications to reproduce the behavior of DNA accurately. We need to: <italic>(i)</italic> model a polymer, i.e. an articulated chain; <italic>(ii)</italic> reproduce the effective diameter of DNA (depending on electrostatic conditions) and, when proteins are present, have the possibility to model their shape and steric hindrance; <italic>(iii)</italic> deal with collisions, especially in order to reproduce DNA supercoiled structures (plectonemes) and steric effects in DNA-protein assemblies; <italic>(iv)</italic> reproduce DNA twisting and bending elasticities; <italic>(v)</italic> include statistical mechanics features to account for temperature and thermal motion. Beside these essential points, we also wish to simulate the system <italic>dynamics</italic>, which may be important in some cases, e.g. when hysteresis is observed under magnetic tweezers <xref ref-type="bibr" rid="pcbi.1003456-Bancaud2">[7]</xref> or for <italic>in vivo</italic> chromosome dynamics experiments in the cell nucleus <xref ref-type="bibr" rid="pcbi.1003456-Heun1">[11]</xref>, <xref ref-type="bibr" rid="pcbi.1003456-Albert1">[12]</xref>.</p>
<p>This ambitious list of specifications is beyond the reach of traditional simulation approaches where particles interact through 2-body potentials (as in Molecular Dynamics or Monte Carlo simulations <xref ref-type="bibr" rid="pcbi.1003456-Vologodskii1">[13]</xref>, <xref ref-type="bibr" rid="pcbi.1003456-Vologodskii2">[14]</xref> with a given force field). The need to deal with frozen degrees of freedom in coarse grained modeling may be addressed through holonomic constraints, as in the SHAKE algorithm <xref ref-type="bibr" rid="pcbi.1003456-Ryckaert1">[15]</xref>, <xref ref-type="bibr" rid="pcbi.1003456-vanGunsteren1">[16]</xref>, where an iterative approach is adopted. However, collision detection and steric hindrance may only be accounted for in this scheme by introducing additional steps. More recently, non iterative algorithms have been developed <xref ref-type="bibr" rid="pcbi.1003456-Erleben1">[17]</xref>, that subsequently led to the development of new powerful tools, called “physics engines”. These have been designed by the engineering and robotics communities to reproduce the dynamic behaviour of articulated systems of rigid bodies. Physics engines are acquiring an increasing importance, notably in the fields of computer graphics and video games, where they are now widely used to simulate rigid body motion under realistic conditions and in real-time. Open Dynamics Engine (ODE) is one of the most popular rigid-body dynamics open source library for robotics simulation applications <xref ref-type="bibr" rid="pcbi.1003456-Smith2">[18]</xref>. As other physics engines, ODE simulates the kinematics of articulated systems by using permanent joints that impose holonomic constraints, instead of bond potentials. The same method is used to manage collisions: when overlapping between bodies is detected, a temporary joint is locally created that reproduces the action of the contact forces, without the need for explicit permanent 2-body interaction potentials (see section “<xref ref-type="sec" rid="s3">Materials and Methods</xref>” for details on how ODE manages joints and collisions).</p>
<p>These extremely efficient simulators haven't, up to now, been used in statistical mechanics. Although well adapted to mechanical simulations, physics engines lack coupling to a thermal bath. The main novelty of our approach is the implementation of Langevin-Euler equation in the ODE software. Moreover we improve the simulation efficiency of this Langevin dynamics by extending the “global thermostat” algorithm designed by Bussi and Parinello in 2008 <xref ref-type="bibr" rid="pcbi.1003456-Bussi1">[19]</xref> to physics engines. This algorithm allows much faster yet unbiased sampling of the phase-space. As a first step toward simulating DNA-protein assemblies, we focus here on bare DNA and show how to perform <italic>in silico</italic> single molecule manipulation of DNA.</p>
</sec><sec id="s3" sec-type="materials|methods">
<title>Materials and Methods</title>
<sec id="s3a">
<title>Introduction to physics engines</title>
<p>In rigid body dynamics simulations run with ODE, the state of a system consisting of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e001" xlink:type="simple"/></inline-formula> rigid bodies is described by the positions <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e002" xlink:type="simple"/></inline-formula> of their centres of mass, a quaternion representation of their orientations <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e003" xlink:type="simple"/></inline-formula>, and their linear and angular velocities <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e004" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e005" xlink:type="simple"/></inline-formula> respectively. These velocities are collected in the column vector <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e006" xlink:type="simple"/></inline-formula>. We use the superscript T to denote the transpose of a vector or a matrix everywhere in this article. The vector <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e007" xlink:type="simple"/></inline-formula> then collects all linear and angular momenta, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e008" xlink:type="simple"/></inline-formula> is a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e009" xlink:type="simple"/></inline-formula> block diagonal matrix whose elements are the mass matrices <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e010" xlink:type="simple"/></inline-formula> and inertia matrices <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e011" xlink:type="simple"/></inline-formula> of the N bodies (with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e012" xlink:type="simple"/></inline-formula> the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e013" xlink:type="simple"/></inline-formula> identity matrix). The Newtonian dynamics equation then reads <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e014" xlink:type="simple"/></inline-formula> where the generalized force <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e015" xlink:type="simple"/></inline-formula> is a vector collecting forces and torques applied to the system. These forces and torques may be external, due for example to gravity or magnetic fields, or internal, as a consequence of the mechanical constraints between the rigid bodies that make up the system.</p>
<p>Most notably, in articulated systems, as is the case of polymers, rigid bodies are connected by mechanical joints. A joint is a relationship that is enforced between two bodies so that they can have only certain positions and orientations relative to each other, and ODE provides different types of joints according to the kind of articulation that has to be implemented, e.g. ball-and-socket, hinge, slider or universal.</p>
<p>Mathematically a joint imposes some holonomic constraint between both connected bodies. Such a constraint is an equation that reads <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e016" xlink:type="simple"/></inline-formula> where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e017" xlink:type="simple"/></inline-formula> is the distance between both joint bearings, e.g. the center of the ball of one body and the the center of the socket of the other one. The constrained distance <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e018" xlink:type="simple"/></inline-formula> is purely geometrical, depending only on the relative position and orientation of both jointed bodies. The position and orientation of each of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e019" xlink:type="simple"/></inline-formula> bodies the articulated system is composed of depend on time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e020" xlink:type="simple"/></inline-formula>. Therefore the constraints <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e021" xlink:type="simple"/></inline-formula> of the articulated system can be derived with respect to time to get the kinematic constraints in the form <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e022" xlink:type="simple"/></inline-formula> where we introduce the jacobian matrix of constraints <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e023" xlink:type="simple"/></inline-formula> (see subsection “Exact solution for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e024" xlink:type="simple"/></inline-formula> when there are no collisions” for a detailed example). This velocity-based description is used in ODE as in most game/physics engines.</p>
<p>So, mechanical joints exert reaction forces and torques on the joint bearings. These internal mechanical constraints can be collected into a generalized constraint force <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e025" xlink:type="simple"/></inline-formula> which, by virtue of the principle of virtual work <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e026" xlink:type="simple"/></inline-formula>, reads <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e027" xlink:type="simple"/></inline-formula> where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e028" xlink:type="simple"/></inline-formula> is a vector of Lagrange multipliers that precisely accounts for the reaction forces and torques coming from the joint bearings <xref ref-type="bibr" rid="pcbi.1003456-vanGunsteren1">[16]</xref>. The Newtonian dynamics equation therefore reads <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e029" xlink:type="simple"/></inline-formula> where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e030" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e031" xlink:type="simple"/></inline-formula> stand for the external and internal contributions to the generalized force respectively. As the constraint force reads <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e032" xlink:type="simple"/></inline-formula>, the Newtonian dynamics equation becomes an equation for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e033" xlink:type="simple"/></inline-formula> in the form: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e034" xlink:type="simple"/></inline-formula>.</p>
<p>Solving this equation for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e035" xlink:type="simple"/></inline-formula> should moreover satisfy the holonomic constraints <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e036" xlink:type="simple"/></inline-formula> at every timestep <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e037" xlink:type="simple"/></inline-formula>. However the discretization used in the numerical calculation results in errors on <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e038" xlink:type="simple"/></inline-formula> so that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e039" xlink:type="simple"/></inline-formula> is generally not equal to 0. Then, in order to have <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e040" xlink:type="simple"/></inline-formula> at the next timestep, the kinematic constraint <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e041" xlink:type="simple"/></inline-formula> should be adapted accordingly. Indeed <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e042" xlink:type="simple"/></inline-formula> according to the Euler semi-implicit integration scheme which is used in velocity-based algorithms. Hence <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e043" xlink:type="simple"/></inline-formula>. But then this implies that the kinematic constraint is not equal to zero at time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e044" xlink:type="simple"/></inline-formula>, i.e. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e045" xlink:type="simple"/></inline-formula>, so that the joint bearings will continue to move apart afterwards. In order to keep both <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e046" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e047" xlink:type="simple"/></inline-formula> close to zero at every timestep, ODE introduces an error reduction parameter <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e048" xlink:type="simple"/></inline-formula> in the kinematic equation <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e049" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pcbi.1003456-Smith2">[18]</xref>. This parameter has to be adjusted to some optimal value between 0 (no correction at all) and 1 (complete correction of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e050" xlink:type="simple"/></inline-formula> in one timestep). However setting <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e051" xlink:type="simple"/></inline-formula> is not recommended since, as said above, this would imply that the joint bearings will continue to move apart afterwards with maximal velocities. ODE recommends values between <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e052" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e053" xlink:type="simple"/></inline-formula>.</p>
<p>In addition to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e054" xlink:type="simple"/></inline-formula>, ODE introduces a second ingredient to soften the rigid constraints by allowing the violation of the constraint equation by an amount proportional to the restoring force <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e055" xlink:type="simple"/></inline-formula>. More explicitly, a “constraint force mixing” diagonal matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e056" xlink:type="simple"/></inline-formula> is defined, such that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e057" xlink:type="simple"/></inline-formula> (implicit integration) <xref ref-type="bibr" rid="pcbi.1003456-Smith2">[18]</xref>. This is equivalent to introducing a spring-damper system (spring constant of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e058" xlink:type="simple"/></inline-formula> and damping constant of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e059" xlink:type="simple"/></inline-formula>) with implicit integrator between the joint bearings; this can be understood as analogous to a bead-spring model. Nevertheless there is a major difference between this effective spring and a regular spring: the term <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e060" xlink:type="simple"/></inline-formula> constrains the velocity whereas a regular spring constrains the acceleration. As a result, no energy is stored in this effective spring, at odds with a regular spring which stores an averaged energy <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e061" xlink:type="simple"/></inline-formula> (see below subsection “Preliminary tests of validity and performance of the global thermostat” along with the histograms of energy in <xref ref-type="fig" rid="pcbi-1003456-g001">Figure 1</xref>).</p>
<fig id="pcbi-1003456-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003456.g001</object-id><label>Figure 1</label><caption>
<title>Boltzmann statistics test.</title>
<p>The distribution of kinetic energy <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e062" xlink:type="simple"/></inline-formula> of a DNA molecule of length <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e063" xlink:type="simple"/></inline-formula> µm at thermal equilibrium is plotted as a function of the dimensionless kinetic energy <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e064" xlink:type="simple"/></inline-formula> for both global (left panel) and local (right panel) thermostats. The DNA molecule is composed of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e065" xlink:type="simple"/></inline-formula> rigid cylinders of radius <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e066" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e067" xlink:type="simple"/></inline-formula>. The other parameters of the simulation are given in <xref ref-type="table" rid="pcbi-1003456-t001">Table 1</xref>. According to <xref ref-type="disp-formula" rid="pcbi.1003456.e305">Eq. (33)</xref> the number of degrees of freedom is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e068" xlink:type="simple"/></inline-formula> with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e069" xlink:type="simple"/></inline-formula> the number of non-redundant holonomic constraints (3 per ball-and socket joint, hence <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e070" xlink:type="simple"/></inline-formula>). The factor <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e071" xlink:type="simple"/></inline-formula> ensures the normalization of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e072" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e073" xlink:type="simple"/></inline-formula> is the Euler Gamma function).</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003456.g001" position="float" xlink:type="simple"/></fig>
<p>In particular, ODE uses a powerful software called <italic>libccd</italic> <xref ref-type="bibr" rid="pcbi.1003456-Fiser1">[20]</xref> to detect collisions between two convex shapes. Whenever overlapping is detected between two rigid bodies, ODE attaches a temporary joint between them called a “contact joint”. Defining vector <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e074" xlink:type="simple"/></inline-formula> (resp. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e075" xlink:type="simple"/></inline-formula>) that connects the center of mass of body 1 (resp. 2) to the contact point and denoting <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e076" xlink:type="simple"/></inline-formula> the common normal to both bodies at the contact point (directed from 2 to 1), the kinematic constraint imposed by the contact joint would read <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e077" xlink:type="simple"/></inline-formula> in the perfect case when the holonomic constraint imposed by the contact joint reads exactly <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e078" xlink:type="simple"/></inline-formula>. However, in practice <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e079" xlink:type="simple"/></inline-formula> is not equal to 0 because of discretization errors, hence the kinematic constraint imposed by the contact joint actually reads:<disp-formula id="pcbi.1003456.e080"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003456.e080" xlink:type="simple"/><label>(1)</label></disp-formula>with<disp-formula id="pcbi.1003456.e081"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003456.e081" xlink:type="simple"/><label>(2)</label></disp-formula><disp-formula id="pcbi.1003456.e082"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003456.e082" xlink:type="simple"/><label>(3)</label></disp-formula></p>
<p>The right hand side of <xref ref-type="disp-formula" rid="pcbi.1003456.e080">Eq.(1)</xref> deals with the already existing overlapping of the two bodies in contact at time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e083" xlink:type="simple"/></inline-formula> when collision is first detected, or with their residual overlapping while the contact joint exists.</p>
<p>By inserting the constraint force <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e084" xlink:type="simple"/></inline-formula> into the equation of motion <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e085" xlink:type="simple"/></inline-formula> and taking the first-order discretisation of this equation, one can easily get the following expression to be solved for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e086" xlink:type="simple"/></inline-formula>:<disp-formula id="pcbi.1003456.e087"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003456.e087" xlink:type="simple"/><label>(4)</label></disp-formula></p>
<p>This equation is of the form <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e088" xlink:type="simple"/></inline-formula>. Importantly, the addition of the term <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e089" xlink:type="simple"/></inline-formula> to each diagonal term <bold>o</bold>f the matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e090" xlink:type="simple"/></inline-formula> provides a symmetric positive definite matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e091" xlink:type="simple"/></inline-formula>, thus greatly increasing the solution accuracy of <xref ref-type="disp-formula" rid="pcbi.1003456.e087">Eq.(4)</xref>. From this equation, the vector <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e092" xlink:type="simple"/></inline-formula> of Lagrange multipliers, hence the constraint force <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e093" xlink:type="simple"/></inline-formula>, can be determined. Then the motion solver (semi-implicit Euler integrator) gives the new positions and orientations of the articulated bodies at time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e094" xlink:type="simple"/></inline-formula>. It is advantageous to choose the Exponential Map parametrization <xref ref-type="bibr" rid="pcbi.1003456-Grassia1">[21]</xref> for the quaternion integration.</p>
</sec><sec id="s3b">
<title>Solving constraints</title>
<p>In general <xref ref-type="disp-formula" rid="pcbi.1003456.e087">Eq.(4)</xref> has to be solved numerically and ODE has two algorithms to do so, one based on the Successive-Over-Relaxation (SOR) method <xref ref-type="bibr" rid="pcbi.1003456-Young1">[22]</xref> and the other based on the Linear Complementary Problem (LCP) <xref ref-type="bibr" rid="pcbi.1003456-Cottle1">[23]</xref>. LCP time complexity is of order <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e095" xlink:type="simple"/></inline-formula> and space complexity (memory) of order <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e096" xlink:type="simple"/></inline-formula> where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e097" xlink:type="simple"/></inline-formula> is the number of constraint rows <xref ref-type="bibr" rid="pcbi.1003456-Smith2">[18]</xref>; whereas SOR time complexity is of order <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e098" xlink:type="simple"/></inline-formula> where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e099" xlink:type="simple"/></inline-formula> is the number of successive-over-relaxation and space complexity of order <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e100" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pcbi.1003456-Smith2">[18]</xref>. Both algorithms have equivalent performances when <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e101" xlink:type="simple"/></inline-formula>. But in general LCP is more accurate, although much more time consuming, than SOR. We compared these two algorithms for a chain of length <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e102" xlink:type="simple"/></inline-formula> without noticing significant differences in the errors on <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e103" xlink:type="simple"/></inline-formula> (error on the colocalization of joint bearings). In order to save computational time, we preferentially run the SOR method with a value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e104" xlink:type="simple"/></inline-formula> for the relaxation factor and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e105" xlink:type="simple"/></inline-formula>. These values are different from the default values in ODE and work well for a linear chain of rigid bodies connected with ball-and-socket joints. But in some cases, the SOR method does not converge and we then switch to the LCP method, which always converges. However in the case when there are no collisions between the rigid bodies the articulated system is composed of, we were able to derive an exact solution for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e106" xlink:type="simple"/></inline-formula> (see next subsection). Therefore we solve <xref ref-type="disp-formula" rid="pcbi.1003456.e087">Eq.(4)</xref> according to the following scheme:</p>
<list list-type="order"><list-item>
<p>if there are no collisions at time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e107" xlink:type="simple"/></inline-formula>, we use the exact solution for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e108" xlink:type="simple"/></inline-formula>,</p>
</list-item><list-item>
<p>if some collisions are detected, then we run the SOR method and check for the accuracy of the solution. More specifically the solution is accepted if <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e109" xlink:type="simple"/></inline-formula>,</p>
</list-item><list-item>
<p>if <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e110" xlink:type="simple"/></inline-formula> then the simulation step is restarted with the LCP method.</p>
</list-item></list>
</sec><sec id="s3c">
<title>Exact solution for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e111" xlink:type="simple"/></inline-formula> when there are no collisions</title>
<p>For the sake of clarity, let us first consider the example of four rigid cylinders of length <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e112" xlink:type="simple"/></inline-formula> each connected with ball-and-socket joints at the extremities <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e113" xlink:type="simple"/></inline-formula> with the first one anchored to some fixed point, taken as the origin of the coordinates. The vector <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e114" xlink:type="simple"/></inline-formula> is the tangent to the cylinder <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e115" xlink:type="simple"/></inline-formula>. The jacobian matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e116" xlink:type="simple"/></inline-formula> associated with this system is tridiagonal when there are no collisions, in which case it reads:<disp-formula id="pcbi.1003456.e117"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003456.e117" xlink:type="simple"/><label>(5)</label></disp-formula></p>
<p>For each cylinder, the antisymmetric matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e118" xlink:type="simple"/></inline-formula> is associated with the cross product <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e119" xlink:type="simple"/></inline-formula> and has the property <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e120" xlink:type="simple"/></inline-formula>:<disp-formula id="pcbi.1003456.e121"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003456.e121" xlink:type="simple"/><label>(6)</label></disp-formula></p>
<p>The transpose Jacobian matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e122" xlink:type="simple"/></inline-formula> and mass matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e123" xlink:type="simple"/></inline-formula> are given by:<disp-formula id="pcbi.1003456.e124"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003456.e124" xlink:type="simple"/><label>(7)</label></disp-formula></p>
<p>Then we get:<disp-formula id="pcbi.1003456.e125"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003456.e125" xlink:type="simple"/><label>(8)</label></disp-formula>and we deduce the final result for the symmetric matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e126" xlink:type="simple"/></inline-formula>:<disp-formula id="pcbi.1003456.e127"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003456.e127" xlink:type="simple"/><label>(9)</label></disp-formula>where we define the matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e128" xlink:type="simple"/></inline-formula>. We then write <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e129" xlink:type="simple"/></inline-formula> in the associated principal axis body frame as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e130" xlink:type="simple"/></inline-formula>:<disp-formula id="pcbi.1003456.e131"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003456.e131" xlink:type="simple"/><label>(10)</label></disp-formula></p>
<p>The vector <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e132" xlink:type="simple"/></inline-formula> collects the Lagrange multipliers associated to each joint respectively <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e133" xlink:type="simple"/></inline-formula>. The equation <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e134" xlink:type="simple"/></inline-formula> gives us a system of coupled equations on <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e135" xlink:type="simple"/></inline-formula>. Note that ODE solves in one time all the constraints of this articulated system. This is not the case with the SHAKE algorithm where an unconstrained step is first performed, before correcting the positions and orientations iteratively to get the constraints satisfied eventually. The term <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e136" xlink:type="simple"/></inline-formula> from <xref ref-type="disp-formula" rid="pcbi.1003456.e087">Eq.(4)</xref> is given by:<disp-formula id="pcbi.1003456.e137"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003456.e137" xlink:type="simple"/><label>(11)</label></disp-formula>where we write <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e138" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e139" xlink:type="simple"/></inline-formula>. We can then write the constraint forces and torques <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e140" xlink:type="simple"/></inline-formula><disp-formula id="pcbi.1003456.e141"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003456.e141" xlink:type="simple"/><label>(12)</label></disp-formula></p>
<p>We can now generalise the previous example to the case of a linear chain of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e142" xlink:type="simple"/></inline-formula> rigid cylinders connected with ball-and-socket joints with the first one anchored to the ground. We denote <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e143" xlink:type="simple"/></inline-formula> the matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e144" xlink:type="simple"/></inline-formula> with the following properties:<disp-formula id="pcbi.1003456.e145"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003456.e145" xlink:type="simple"/><label>(13)</label></disp-formula><disp-formula id="pcbi.1003456.e146"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003456.e146" xlink:type="simple"/><label>(14)</label></disp-formula><disp-formula id="pcbi.1003456.e147"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003456.e147" xlink:type="simple"/><label>(15)</label></disp-formula><disp-formula id="pcbi.1003456.e148"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003456.e148" xlink:type="simple"/><label>(16)</label></disp-formula></p>
<p>Using the following decomposition <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e149" xlink:type="simple"/></inline-formula> for the matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e150" xlink:type="simple"/></inline-formula> where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e151" xlink:type="simple"/></inline-formula> is a block lower matrix with block identity matrix on the diagonal and where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e152" xlink:type="simple"/></inline-formula> is the block diagonal matrix it is easy to show that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e153" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e154" xlink:type="simple"/></inline-formula>. From these we get the following equations:<disp-formula id="pcbi.1003456.e155"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003456.e155" xlink:type="simple"/><label>(17)</label></disp-formula><disp-formula id="pcbi.1003456.e156"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003456.e156" xlink:type="simple"/><label>(18)</label></disp-formula><disp-formula id="pcbi.1003456.e157"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003456.e157" xlink:type="simple"/><label>(19)</label></disp-formula></p>
<p>In order to solve the linear system of equations <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e158" xlink:type="simple"/></inline-formula> we define <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e159" xlink:type="simple"/></inline-formula> and solve the problem <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e160" xlink:type="simple"/></inline-formula> in an iterative way:<disp-formula id="pcbi.1003456.e161"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003456.e161" xlink:type="simple"/><label>(20)</label></disp-formula><disp-formula id="pcbi.1003456.e162"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003456.e162" xlink:type="simple"/><label>(21)</label></disp-formula>and we get the final solution for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e163" xlink:type="simple"/></inline-formula> by solving the problem <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e164" xlink:type="simple"/></inline-formula>:<disp-formula id="pcbi.1003456.e165"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003456.e165" xlink:type="simple"/><label>(22)</label></disp-formula><disp-formula id="pcbi.1003456.e166"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003456.e166" xlink:type="simple"/><label>(23)</label></disp-formula></p>
<p>The method explained here is the exact solution of the problem <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e167" xlink:type="simple"/></inline-formula> where no collisions are present in the system. With this exact resolution the simulation is faster than the SOR algorithm (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e168" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e169" xlink:type="simple"/></inline-formula>) with a gain of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e170" xlink:type="simple"/></inline-formula>.</p>
</sec><sec id="s3d">
<title>Simulating DNA molecules under magnetic tweezers</title>
<p>To model a DNA molecule, we build a linear chain of rigid cylinders of length <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e171" xlink:type="simple"/></inline-formula> each, corresponding to 10 base pairs (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e172" xlink:type="simple"/></inline-formula>), which amounts to the double helix pitch. We connect the cylinders to each other by ball-and-socket joints. The radius of the cylinders is set according to the salt buffer concentration of the experimental data we compare with. Indeed, since the DNA molecule is highly negatively charged, DNA-DNA electrostatic repulsion affects the double helix response in single molecule experiments <xref ref-type="bibr" rid="pcbi.1003456-Neukirch1">[9]</xref>, <xref ref-type="bibr" rid="pcbi.1003456-Clauvelin1">[24]</xref>–<xref ref-type="bibr" rid="pcbi.1003456-Argudo1">[27]</xref>. This effect can be easily and implicitly included in simulations and theoretical models by introducing an effective DNA radius <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e173" xlink:type="simple"/></inline-formula> where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e174" xlink:type="simple"/></inline-formula> is the crystallographic radius of the DNA double helix and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e175" xlink:type="simple"/></inline-formula> accounts for the DNA-DNA electrostatic repulsion <xref ref-type="bibr" rid="pcbi.1003456-Stigter1">[28]</xref>–<xref ref-type="bibr" rid="pcbi.1003456-Rybenkov2">[31]</xref>. It turns out that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e176" xlink:type="simple"/></inline-formula> may be set equal to the Debye length <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e177" xlink:type="simple"/></inline-formula> of the salt buffer solution. As <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e178" xlink:type="simple"/></inline-formula> with c the salt concentration given in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e179" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e180" xlink:type="simple"/></inline-formula> in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e181" xlink:type="simple"/></inline-formula>, we set the effective radius to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e182" xlink:type="simple"/></inline-formula> in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e183" xlink:type="simple"/></inline-formula>mmol monovalent salt buffer for comparison with the reference experimental data of Mosconi et al <xref ref-type="bibr" rid="pcbi.1003456-Mosconi1">[32]</xref>. Alternatively we use an effective radius <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e184" xlink:type="simple"/></inline-formula> to fit the experimental data obtained in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e185" xlink:type="simple"/></inline-formula>mmol monovalent salt buffer by Smith et al <xref ref-type="bibr" rid="pcbi.1003456-Smith1">[1]</xref>.</p>
<p>We performed all our <italic>in silico</italic> single molecule experiments with a DNA molecule of contour length <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e186" xlink:type="simple"/></inline-formula>. The corresponding number of DNA cylinders in the chain is therefore <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e187" xlink:type="simple"/></inline-formula>. The DNA molecule is anchored, at one end, to a planar surface (mimicking the microscope coverslip), and at the other end, to a rotatable bead (mimicking the magnetic bead). We set the bead radius to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e188" xlink:type="simple"/></inline-formula> in order to prevent the DNA from looping around it. At both ends of the DNA chain, the rigid cylinders are tangent to their attachment surface.</p>
<p>The final problem that remains to be addressed is how to obtain a correct definition of the bending and twisting behavior of DNA. We have solved this problem by a special choice of the connecting joints and by introducing appropriate restoring torques reacting to the bending and twisting deformations. This has been done based on the bending and twisting energies that are defined according to the usual expressions <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e189" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e190" xlink:type="simple"/></inline-formula> respectively. The rigidity constants <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e191" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e192" xlink:type="simple"/></inline-formula> are related to the bending and twisting persistence lengths <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e193" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e194" xlink:type="simple"/></inline-formula> respectively, through the following equations:<disp-formula id="pcbi.1003456.e195"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003456.e195" xlink:type="simple"/><label>(24)</label></disp-formula><disp-formula id="pcbi.1003456.e196"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003456.e196" xlink:type="simple"/><label>(25)</label></disp-formula><disp-formula id="pcbi.1003456.e197"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003456.e197" xlink:type="simple"/><label>(26)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e198" xlink:type="simple"/></inline-formula> is the Langevin function (see supplementary <xref ref-type="supplementary-material" rid="pcbi.1003456.s006">Text S1</xref>). The bending angle <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e199" xlink:type="simple"/></inline-formula> and twisting angle <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e200" xlink:type="simple"/></inline-formula> are related to the standard Euler transformation ZXZ and are given by<disp-formula id="pcbi.1003456.e201"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003456.e201" xlink:type="simple"/><label>(27)</label></disp-formula><disp-formula id="pcbi.1003456.e202"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003456.e202" xlink:type="simple"/><label>(28)</label></disp-formula><disp-formula id="pcbi.1003456.e203"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003456.e203" xlink:type="simple"/><label>(29)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e204" xlink:type="simple"/></inline-formula> is the tangent vector of cylinder i, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e205" xlink:type="simple"/></inline-formula> a vector normal to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e206" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e207" xlink:type="simple"/></inline-formula>. These three vectors are the principal axis of cylinder i.</p>
<p>We finally get the following expression for the global restoring torque between two connected DNA segments (see supplementary <xref ref-type="supplementary-material" rid="pcbi.1003456.s006">Text S1</xref> for the complete derivation of this equation):<disp-formula id="pcbi.1003456.e208"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003456.e208" xlink:type="simple"/><label>(30)</label></disp-formula></p>
<p>We recall that, for DNA, estimates of the bending persistence length give <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e209" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e210" xlink:type="simple"/></inline-formula> salt buffer (see Refs. <xref ref-type="bibr" rid="pcbi.1003456-Smith1">[1]</xref>, <xref ref-type="bibr" rid="pcbi.1003456-Hagerman1">[33]</xref>–<xref ref-type="bibr" rid="pcbi.1003456-Bouchiat1">[35]</xref>); whereas estimates of the twisting persistence length give <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e211" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e212" xlink:type="simple"/></inline-formula> salt buffer <xref ref-type="bibr" rid="pcbi.1003456-Neukirch1">[9]</xref>, <xref ref-type="bibr" rid="pcbi.1003456-Mosconi1">[32]</xref>. According to the size <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e213" xlink:type="simple"/></inline-formula> of the unit cylinder we find <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e214" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e215" xlink:type="simple"/></inline-formula>.</p>
</sec><sec id="s3e">
<title>Langevin dynamics and global thermostat implementation</title>
<p>Although well adapted to mechanical simulations, ODE lacks coupling to a thermal bath. As physics engines impose to deal with dynamics equations including inertial terms, in particular for computing constraint forces (collected in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e216" xlink:type="simple"/></inline-formula>), we need to turn to some implementation of stochastic isothermal molecular dynamics in order to thermalize the system: <italic>isothermal</italic> to simulate the system at constant temperature, <italic>stochastic</italic> to ensure ergodicity. The corresponding algorithms are all related to Langevin dynamics and can be cast into local and global thermostats. In local thermostats, such as standard Langevin dynamics, a correction force including both a frictional term and a stochastic term is exerted on each particle to drive the system to the canonical distribution at a prescribed temperature. Global schemes of Langevin dynamics are designed to minimize the perturbation introduced by the thermostat on the Hamiltonian trajectory (so called “disturbance” as defined originally in <xref ref-type="bibr" rid="pcbi.1003456-Berendsen1">[36]</xref>), hence on the dynamical properties, such as autocorrelation functions, and related quantities, such as diffusion coefficients. In these globally applied thermostats the stochastic term of the correction force acting on each particle is proportional to the momentum of that particle. Two main global algorithms have been designed so far: (a) Stochastic Velocity Rescaling methods, most notably the “global thermostat” introduced by Bussi and Parrinello <xref ref-type="bibr" rid="pcbi.1003456-Bussi1">[19]</xref>, (b) the Nosé-Hoover Langevin thermostat <xref ref-type="bibr" rid="pcbi.1003456-Samoletov1">[37]</xref>. Here we first show how to implement Langevin-Euler equation in the ODE software. Moreover we show that the global thermostat introduced by Bussi and Parrinello is so remarkably adapted to this implementation that it improves quite significantly the sampling efficiency with respect to local Langevin dynamics (by two orders of magnitude in typical situations), while preserving the time-dependent properties such as autocorrelation functions. The sampling efficiency is defined as usual as the number of independent configurations generated during the time necessary to reach thermal equilibrium.</p>
<p>To begin with, we add to the “mechanical” forces <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e217" xlink:type="simple"/></inline-formula> an additional, thermal contribution <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e218" xlink:type="simple"/></inline-formula> containing a frictional term <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e219" xlink:type="simple"/></inline-formula> and a random force vector <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e220" xlink:type="simple"/></inline-formula>. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e221" xlink:type="simple"/></inline-formula> is the matrix of the coupling frequencies to the thermostat, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e222" xlink:type="simple"/></inline-formula> the matrix of white noise amplitudes and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e223" xlink:type="simple"/></inline-formula> a generalized vector of normalized and independent Wiener processes. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e224" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e225" xlink:type="simple"/></inline-formula> are related through the fluctuation-dissipation theorem, which reads here<disp-formula id="pcbi.1003456.e226"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003456.e226" xlink:type="simple"/><label>(31)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e227" xlink:type="simple"/></inline-formula> with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e228" xlink:type="simple"/></inline-formula> the temperature of the thermal bath and where the superscript <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e229" xlink:type="simple"/></inline-formula> denotes that the matrices <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e230" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e231" xlink:type="simple"/></inline-formula> are chosen to be diagonal in the principal axis body frame (where the matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e232" xlink:type="simple"/></inline-formula> is diagonal by definition). For simplicity, we choose to fix all the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e233" xlink:type="simple"/></inline-formula> to a common frequency <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e234" xlink:type="simple"/></inline-formula>. Note that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e235" xlink:type="simple"/></inline-formula> is the relaxation time of the thermostat, i.e. the autocorrelation time of the kinetic energy (see supplementary <xref ref-type="supplementary-material" rid="pcbi.1003456.s001">Figure S1</xref>).</p>
<p>We then improve the sampling efficiency of this Langevin dynamics by extending the “global thermostat” algorithm designed by Bussi and Parinello in 2008 <xref ref-type="bibr" rid="pcbi.1003456-Marko1">[10]</xref> to physics engines. This algorithm allows faster yet correct sampling of the phase space in the canonical ensemble. However, it is designed for the translational degrees of freedom only. In order to apply it to an articulated rigid body system, we therefore have to extend it to the rotational degrees of freedom and adapt it to the ODE software. To this aim, we replace the traditional Langevin-Euler correction force (local thermostat) <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e236" xlink:type="simple"/></inline-formula> by a corresponding global version <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e237" xlink:type="simple"/></inline-formula>, which reads<disp-formula id="pcbi.1003456.e238"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003456.e238" xlink:type="simple"/><label>(32)</label></disp-formula><xref ref-type="disp-formula" rid="pcbi.1003456.e238">Eq.(32)</xref> shows that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e239" xlink:type="simple"/></inline-formula> is proportional to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e240" xlink:type="simple"/></inline-formula>, so that the stochastic force and torque globally associated with the thermostat is in the same direction as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e241" xlink:type="simple"/></inline-formula>. Hence, a free particle, i.e. a particle not connected to any other particle, will move on a straight line between two collisions. Note that, nevertheless, the particle will undergo Brownian motion along this straight trajectory. The global version of the Langevin dynamics minimizes the disturbance induced by the thermostat on the Hamiltonian trajectory (equal to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e242" xlink:type="simple"/></inline-formula> according to its definition in Ref. <xref ref-type="bibr" rid="pcbi.1003456-Bussi1">[19]</xref>, but extended here to the rotational degrees of freedom), nevertheless retaining the same thermalization speed as usual Langevin dynamics (see supplementary <xref ref-type="supplementary-material" rid="pcbi.1003456.s001">Figure S1</xref>).</p>
<p>When used in the framework of a velocity-based algorithm such as ODE, the global thermostat presents a remarkable advantage. This is because, in this case the global Langevin contribution <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e243" xlink:type="simple"/></inline-formula> is decoupled from the constraint forces, in the sense that it cancels out in the equations for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e244" xlink:type="simple"/></inline-formula>. More precisely, with our definition of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e245" xlink:type="simple"/></inline-formula> (see <xref ref-type="disp-formula" rid="pcbi.1003456.e238">Eq.(32)</xref>), the contribution <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e246" xlink:type="simple"/></inline-formula> to the term <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e247" xlink:type="simple"/></inline-formula> in <xref ref-type="disp-formula" rid="pcbi.1003456.e087">Eq.(4)</xref> is always zero. In other words, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e248" xlink:type="simple"/></inline-formula> not only minimizes the disturbance of the Hamiltonian trajectory <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e249" xlink:type="simple"/></inline-formula>, but also does not disturb the generalized constraint force <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e250" xlink:type="simple"/></inline-formula>. Both effects cooperate to achieve a dramatic acceleration of the simulation sampling, that is, in the case of our model, approximately <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e251" xlink:type="simple"/></inline-formula> times faster than with the local thermostat (see below “Preliminary tests of validity and performance of the global thermostat” and <xref ref-type="fig" rid="pcbi-1003456-g002">Figure 2</xref>). Importantly this acceleration is compatible with the correct computation of dynamical properties, such as autocorrelation functions.</p>
<fig id="pcbi-1003456-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003456.g002</object-id><label>Figure 2</label><caption>
<title>Global thermostat efficiency test.</title>
<p>Complementary autocorrelation function <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e252" xlink:type="simple"/></inline-formula> of the end-to-end distance of a DNA molecule simulated with the global Langevin thermostat (black) compared with the same function simulated with the local Langevin thermostat (red). <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e253" xlink:type="simple"/></inline-formula> is the dimensionless lag-time with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e254" xlink:type="simple"/></inline-formula> the thermostat coupling frequency. The DNA molecule is composed of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e255" xlink:type="simple"/></inline-formula> rigid cylinders of radius <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e256" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e257" xlink:type="simple"/></inline-formula>. The other parameters of the simulation are given in <xref ref-type="table" rid="pcbi-1003456-t001">Table 1</xref>. Cylinders are connected by ball-and-socket joints. The chain ends are free to diffuse here.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003456.g002" position="float" xlink:type="simple"/></fig></sec><sec id="s3f">
<title>Parameter settings of our implementation of ODE</title>
<p>In all DNA simulations presented in this article, we choose the length of the cylinders as the unit length <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e258" xlink:type="simple"/></inline-formula>, the mass of the cylinders as the unit mass <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e259" xlink:type="simple"/></inline-formula> and the unit of thermal agitation <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e260" xlink:type="simple"/></inline-formula> as the unit of energy <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e261" xlink:type="simple"/></inline-formula>, from which we deduce the unit of time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e262" xlink:type="simple"/></inline-formula>. The complete set of parameters of our simulations is given in <xref ref-type="table" rid="pcbi-1003456-t001">Table 1</xref>. We also choose to deal collisions with a restitution coefficient equal to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e263" xlink:type="simple"/></inline-formula> without surface friction. Hence, when two rigid bodies collide, the constraint force <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e264" xlink:type="simple"/></inline-formula> imposed by the contact joint that temporarily connects them is directed along their common normal <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e265" xlink:type="simple"/></inline-formula> at the contact point. We finally choose an error reduction parameter <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e266" xlink:type="simple"/></inline-formula> and a constraint force mixing parameter <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e267" xlink:type="simple"/></inline-formula>.</p>
<table-wrap id="pcbi-1003456-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003456.t001</object-id><label>Table 1</label><caption>
<title>Main set of parameters used for the DNA model and for the numerical simulations.</title>
</caption><alternatives><graphic id="pcbi-1003456-t001-1" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003456.t001" xlink:type="simple"/>
<table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" rowspan="1" colspan="1">Entity</td>
<td align="left" rowspan="1" colspan="1">Parameter</td>
<td align="left" rowspan="1" colspan="1">Typical value</td>
<td align="left" rowspan="1" colspan="1">Definition</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1">DNA parameters</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e268" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e269" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">DNA cylinder effective radius in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e270" xlink:type="simple"/></inline-formula>mmol salt</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e271" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">DNA cylinder effective radius in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e272" xlink:type="simple"/></inline-formula>mmol salt</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e273" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e274" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">DNA cylinders length (10 basepairs)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e275" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e276" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">number of DNA cylinders</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">(corresp. to a contour length <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e277" xlink:type="simple"/></inline-formula> µm)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e278" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e279" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">bending persistence length in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e280" xlink:type="simple"/></inline-formula>mmol salt</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e281" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e282" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">twisting persistence length in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e283" xlink:type="simple"/></inline-formula>mmol salt</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e284" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e285" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">bending rigidity constant</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">(corresp. to bending persistence length : <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e286" xlink:type="simple"/></inline-formula>)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e287" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">28.4</td>
<td align="left" rowspan="1" colspan="1">twisting rigidity constant</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">(corresp. to twisting persistence length : <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e288" xlink:type="simple"/></inline-formula>)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e289" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">1.162 <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e290" xlink:type="simple"/></inline-formula>kg</td>
<td align="left" rowspan="1" colspan="1">mass of each DNA cylinder (10 basepairs)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Time units</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e291" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">1.7660 <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e292" xlink:type="simple"/></inline-formula>s</td>
<td align="left" rowspan="1" colspan="1">natural system time unit <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e293" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Simulation parameters</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e294" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">0.000592 <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e295" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">simulation time step</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e296" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">10 <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e297" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">thermostat coupling frequency</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e298" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">0.8</td>
<td align="left" rowspan="1" colspan="1">ODE error reduction parameter</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e299" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e300" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">ODE constraint force mixing parameter (hard)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e301" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e302" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">SOR relaxation factor</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e303" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e304" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">number of successive-over-relaxations</td>
</tr>
</tbody>
</table>
</alternatives></table-wrap></sec></sec><sec id="s4">
<title>Results/Discussion</title>
<sec id="s4a">
<title>Preliminary tests of validity and performance of the global thermostat</title>
<p>We start to validate our methodology by simulating a DNA molecule without any constraint applied on the bead (neither stretching nor twisting). To this aim, we first check the equipartition theorem. When the system is at thermal equilibrium, its temperature is related to the kinetic energy through the equation<disp-formula id="pcbi.1003456.e305"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003456.e305" xlink:type="simple"/><label>(33)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e306" xlink:type="simple"/></inline-formula> is the number of non-redundant holonomic constraints. This relation is standard since <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e307" xlink:type="simple"/></inline-formula> is just the number of degrees of freedom (dof) of the system. Moreover the distribution of the kinetic energy of the system at thermal equilibrium follows a Boltzmann law and therefore reads:<disp-formula id="pcbi.1003456.e308"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003456.e308" xlink:type="simple"/><label>(34)</label></disp-formula>with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e309" xlink:type="simple"/></inline-formula>. We checked this relation for a DNA molecule of length <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e310" xlink:type="simple"/></inline-formula> µm coupled to the two different Langevin thermostats, local and global respectively. The resulting histograms are shown in <xref ref-type="fig" rid="pcbi-1003456-g001">Figure 1</xref>, confirming that: (i) the kinetic energy is correctly sampled at thermal equilibrium with both thermostats, (ii) there is indeed no energy stored in the joints, although these have been softened by effective springs (see above the error reduction parameter <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e311" xlink:type="simple"/></inline-formula> in subsection “<xref ref-type="sec" rid="s2">Introduction</xref> to physics engines”).</p>
<p>We then quantified the simulation sampling efficiency by means of the autocorrelation function <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e312" xlink:type="simple"/></inline-formula> of the end-to-end distance <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e313" xlink:type="simple"/></inline-formula> of a DNA molecule of length <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e314" xlink:type="simple"/></inline-formula>µm coupled to the two different Langevin thermostats, local and global respectively. Here the average is performed over the time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e315" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e316" xlink:type="simple"/></inline-formula> denotes the lag-time of the autocorrelation function. A demonstration of the performance of the global thermostat in terms of relaxation rapidity is given in <xref ref-type="fig" rid="pcbi-1003456-g002">Figure 2</xref>. Fitting the exponential decrease of both relaxation curves shows that with use of the global thermostat we reach the saturation value at <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e317" xlink:type="simple"/></inline-formula> whereas this value is reached at <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e318" xlink:type="simple"/></inline-formula> in the case of the local thermostat, thus resulting in an acceleration factor of about <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e319" xlink:type="simple"/></inline-formula> for this system composed of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e320" xlink:type="simple"/></inline-formula> articulated rigid bodies. Note that the dimensionless lag-time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e321" xlink:type="simple"/></inline-formula> is equal to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e322" xlink:type="simple"/></inline-formula> (see <xref ref-type="table" rid="pcbi-1003456-t001">Table 1</xref>), with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e323" xlink:type="simple"/></inline-formula> the corresponding number of time steps. Then a typical run using the global thermostat is of the order of tens of millions of time steps, whereas it is of the order of billions of time steps with usual Langevin dynamics. A striking illustration of the sampling acceleration provided by the global thermostat is also given in supplementary <xref ref-type="supplementary-material" rid="pcbi.1003456.s007">Video S1</xref>.</p>
<p>We also compute the tangent-tangent correlation function <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e324" xlink:type="simple"/></inline-formula> along the polymer with both local and global thermostats. No significant deviations were found between both thermostats. Results obtained with the global thermostat are plotted in supplementary <xref ref-type="supplementary-material" rid="pcbi.1003456.s002">Figure S2</xref> along with the corresponding theoretical curves.</p>
<p>A simple calculation shows that the tangent-tangent correlation function decreases as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e325" xlink:type="simple"/></inline-formula>, from which one can calculate the average bending <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e326" xlink:type="simple"/></inline-formula>. With the DNA persistence length <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e327" xlink:type="simple"/></inline-formula>, this quantity amounts to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e328" xlink:type="simple"/></inline-formula>, to be compared to the result from a fit of the simulation curves, giving <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e329" xlink:type="simple"/></inline-formula>. The same comparison can be done for the twist angle (with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e330" xlink:type="simple"/></inline-formula>), for which the simulation average <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e331" xlink:type="simple"/></inline-formula> matches the theoretical value <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e332" xlink:type="simple"/></inline-formula>. These comparisons show that our simulation results are in very good agreement with the analytical formulae, thus validating (i) our implementation of the bending and twisting rigidities and (ii) the correct sampling of the DNA conformation space by means of the global Langevin thermostat.</p>
</sec><sec id="s4b">
<title>Comparison with the experimental DNA stretching response</title>
<p>We then simulate reference force-extension curves, both theoretical and experimental. We thus perform simulations at given stretching force <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e333" xlink:type="simple"/></inline-formula> along the z-axis (normal to the DNA anchor surface), and without torsional constraints on the magnetic bead. In order to fit the experimental data obtained by Smith et al <xref ref-type="bibr" rid="pcbi.1003456-Smith1">[1]</xref> in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e334" xlink:type="simple"/></inline-formula> monovalent salt buffer, we set here the DNA radius (i.e. the radius of the unit cylinders) to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e335" xlink:type="simple"/></inline-formula>. The resulting force-extension curve is given in <xref ref-type="fig" rid="pcbi-1003456-g003">Figure 3</xref> where we plot (red circles) the dimensionless stretching force <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e336" xlink:type="simple"/></inline-formula> as a function of the dimensionless mean relative extension <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e337" xlink:type="simple"/></inline-formula>. Here <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e338" xlink:type="simple"/></inline-formula> denotes the mean DNA extension, i.e. the mean distance between the bead and the anchor surface, at zero torsional constraint. For comparison, we also plot (black solid line) the analytical Worm-Like-Chain (WLC) interpolation fitting curve proposed by Bouchiat et al <xref ref-type="bibr" rid="pcbi.1003456-Bouchiat1">[35]</xref> as well as the numerical solution of the WLC model (black triangles) obtained by Marko and Siggia with the same persistence length <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e339" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pcbi.1003456-Marko2">[34]</xref>. The simulation reproduces pretty well the WLC behavior, thus validating our implementation of the DNA bending rigidity. Note that, at low forces, the extension saturates at a value greater than zero because of the impenetrable ground and magnetic bead that both confine the DNA molecule. This effect is more pronounced than in the experimental curve <xref ref-type="bibr" rid="pcbi.1003456-Smith1">[1]</xref> because the ratio of the bead radius to the DNA length is higher in our simulations.</p>
<fig id="pcbi-1003456-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003456.g003</object-id><label>Figure 3</label><caption>
<title>Comparison to force-extension curves.</title>
<p>Red circles: dimensionless stretching force <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e340" xlink:type="simple"/></inline-formula> as a function of the mean relative extension <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e341" xlink:type="simple"/></inline-formula>. Here the radius of the cylinders is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e342" xlink:type="simple"/></inline-formula> corresponding to the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e343" xlink:type="simple"/></inline-formula>mmol monovalent salt buffer used in <xref ref-type="bibr" rid="pcbi.1003456-Smith1">[1]</xref>. The other parameters of the simulation are given in <xref ref-type="table" rid="pcbi-1003456-t001">Table 1</xref>. For comparison, the black solid line reproduces the analytical Worm-Like-Chain force-extension approximation formula <xref ref-type="bibr" rid="pcbi.1003456-Bouchiat1">[35]</xref>. Black triangles correspond to a numerical fit of the exact Worm-Like-Chain model <xref ref-type="bibr" rid="pcbi.1003456-Marko2">[34]</xref> with the same persistence length <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e344" xlink:type="simple"/></inline-formula>. Blue crosses: we also show simulations in the limit case <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e345" xlink:type="simple"/></inline-formula>, with no torsional rigidity (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e346" xlink:type="simple"/></inline-formula>) and no collisions, and compare it to the theoretical force-extension curve of a Freely-Jointed-Chain (FJC, blue solid line). The statistical error bars on the simulation points are all smaller than the symbol size.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003456.g003" position="float" xlink:type="simple"/></fig>
<p>In <xref ref-type="fig" rid="pcbi-1003456-g003">Figure 3</xref>, we also show the results obtained in the limit case <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e347" xlink:type="simple"/></inline-formula>, for which <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e348" xlink:type="simple"/></inline-formula> (see <xref ref-type="disp-formula" rid="pcbi.1003456.e195">Eqs.(24</xref>–<xref ref-type="disp-formula" rid="pcbi.1003456.e196">25)</xref>), and when there are no collisions. In this case we expect to observe a Freely-Jointed-Chain response (with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e349" xlink:type="simple"/></inline-formula> segments of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e350" xlink:type="simple"/></inline-formula> each). The analytical force-extension relation for FJC is given by the well-known expression as a Langevin function <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e351" xlink:type="simple"/></inline-formula> and it is also reproduced in <xref ref-type="fig" rid="pcbi-1003456-g003">Figure 3</xref>. Again, the simulation results are in very good agreement with the theoretical formula.</p>
</sec><sec id="s4c">
<title>Comparison with the experimental DNA torsional response</title>
<p>More interestingly, magnetic tweezers also allow the application of a torsional strain on a single DNA molecule at constant stretching force. This torsional strain is equal to the number of turns of the magnetic bead around the z-axis due to the rotation of the magnets. The number of turns of the bead is also equal to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e352" xlink:type="simple"/></inline-formula>, the variation of the linking number of the DNA double helix with respect to the intrinsic twist of the DNA double helix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e353" xlink:type="simple"/></inline-formula> with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e354" xlink:type="simple"/></inline-formula> the pitch of the DNA. And we define as usual the DNA relative overtwist as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e355" xlink:type="simple"/></inline-formula>.</p>
<sec id="s4c1">
<title>Simulations at constant strain (fixed overtwist)</title>
<p>We simulate the rotation-extension behaviour of our DNA model by imposing the bead rotation and compare to experimental data from <xref ref-type="bibr" rid="pcbi.1003456-Mosconi1">[32]</xref>, where the mean relative extension <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e356" xlink:type="simple"/></inline-formula> is given for different stretching forces as a function of the fixed relative overtwist <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e357" xlink:type="simple"/></inline-formula> (<xref ref-type="fig" rid="pcbi-1003456-g004">Figure 4</xref>). An example of the simulated dynamics at a stretching force <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e358" xlink:type="simple"/></inline-formula>pN and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e359" xlink:type="simple"/></inline-formula> is shown in supplementary <xref ref-type="supplementary-material" rid="pcbi.1003456.s008">Video S2</xref>. Again excellent agreement is observed between the experimental bell-shape curves (also called “hat curves”) and the simulated curves. We went further to check the validity of the DNA radius which is set here to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e360" xlink:type="simple"/></inline-formula> according to the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e361" xlink:type="simple"/></inline-formula> monovalent salt buffer used in these experiments. To this aim we refer to a series of papers by Neukirch and co–workers <xref ref-type="bibr" rid="pcbi.1003456-Neukirch1">[9]</xref>, <xref ref-type="bibr" rid="pcbi.1003456-Clauvelin1">[24]</xref>, <xref ref-type="bibr" rid="pcbi.1003456-Clauvelin2">[25]</xref> where they showed that the linear part of the “hat curves” can be expressed as a function of the supercoiling radius <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e362" xlink:type="simple"/></inline-formula>, the superhelical angle <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e363" xlink:type="simple"/></inline-formula> and the ratio <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e364" xlink:type="simple"/></inline-formula> of the twisting and bending persistence lengths, as<disp-formula id="pcbi.1003456.e365"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003456.e365" xlink:type="simple"/><label>(35)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e366" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e367" xlink:type="simple"/></inline-formula> depend on the force applied on the bead.</p>
<fig id="pcbi-1003456-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003456.g004</object-id><label>Figure 4</label><caption>
<title>Comparison to experimental extension-rotation curves.</title>
<p>Mean relative extension <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e368" xlink:type="simple"/></inline-formula> as a function of the imposed overtwist <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e369" xlink:type="simple"/></inline-formula> for different stretching forces <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e370" xlink:type="simple"/></inline-formula> in the range of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e371" xlink:type="simple"/></inline-formula> pN. We superimpose on to the simulation results (symbols) the experimental results from <xref ref-type="bibr" rid="pcbi.1003456-Mosconi1">[32]</xref> (lines). The statistical error bars on the simulation points are smaller than the symbol size.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003456.g004" position="float" xlink:type="simple"/></fig>
<p>The comparison between the experimental estimations of the three parameters <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e372" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e373" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e374" xlink:type="simple"/></inline-formula> deduced from <xref ref-type="bibr" rid="pcbi.1003456-Mosconi1">[32]</xref> and the corresponding results from our simulations are given as functions of the applied force in the three supplementary <xref ref-type="supplementary-material" rid="pcbi.1003456.s003">Figures S3</xref>, <xref ref-type="supplementary-material" rid="pcbi.1003456.s004">S4</xref>, <xref ref-type="supplementary-material" rid="pcbi.1003456.s005">S5</xref>. The good agreement observed validates the value applied to the effective DNA radius <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e375" xlink:type="simple"/></inline-formula> in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e376" xlink:type="simple"/></inline-formula>mmol monovalent salt buffer.</p>
</sec><sec id="s4c2">
<title>Simulations at constant stress (fixed torque)</title>
<p>In the characteristic rotation-extension “hat curves” the DNA extension decreases linearly as a function of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e377" xlink:type="simple"/></inline-formula> once it reaches a critical point where the resulting applied torque crosses a critical buckling value <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e378" xlink:type="simple"/></inline-formula>. This linear decrease corresponds to the formation of plectonemes: any additional turn beyond the buckling transition is absorbed into the growing plectoneme without changes in the torque <xref ref-type="bibr" rid="pcbi.1003456-Marko1">[10]</xref>. As standard magnetic tweezers cannot measure torques, the buckling torque can be only indirectly deduced by integrating the change of the molecule extension with respect to the applied force <xref ref-type="bibr" rid="pcbi.1003456-Mosconi1">[32]</xref>, <xref ref-type="bibr" rid="pcbi.1003456-Zhang1">[38]</xref>. However, new set ups have recently been proposed that enforce a torque and allow its measurement: one of them uses an angular optical trap <xref ref-type="bibr" rid="pcbi.1003456-Forth1">[39]</xref>–<xref ref-type="bibr" rid="pcbi.1003456-Wang1">[41]</xref>, another one a magnetic nanorod coupled to a magnetic bead <xref ref-type="bibr" rid="pcbi.1003456-Celedon1">[42]</xref> and a third one a soft magnetic tweezer <xref ref-type="bibr" rid="pcbi.1003456-Mosconi2">[43]</xref>. These innovative experiments confirm that the torque stays constant during the plectoneme formation, and allow the investigation of the dependence of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e379" xlink:type="simple"/></inline-formula> on the applied stretching force.</p>
<p>Our technique also allows us to simulate the DNA response when both the stretching force <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e380" xlink:type="simple"/></inline-formula> and the twisting torque <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e381" xlink:type="simple"/></inline-formula> are imposed, while the number of turns of the magnetic bead <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e382" xlink:type="simple"/></inline-formula> is free to evolve. In this case we compute the average overtwist <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e383" xlink:type="simple"/></inline-formula> for fixed values of the twisting torque <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e384" xlink:type="simple"/></inline-formula>. <xref ref-type="fig" rid="pcbi-1003456-g005">Figure 5</xref> shows <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e385" xlink:type="simple"/></inline-formula> for three different values of the external force. A clear transition from “pure extended” DNA (left part of the curves) to “pure plectonemic” DNA (right part) is observed at (almost) constant critical torque <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e386" xlink:type="simple"/></inline-formula>. In the pure extended state, simulations and experimental results <xref ref-type="bibr" rid="pcbi.1003456-Mosconi1">[32]</xref> are in very good agreement. In this regime <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e387" xlink:type="simple"/></inline-formula> is linear and the corresponding slope agrees with theoretical predictions <xref ref-type="bibr" rid="pcbi.1003456-Marko1">[10]</xref>. The estimations of the critical torque obtained in <xref ref-type="bibr" rid="pcbi.1003456-Mosconi1">[32]</xref> by integrating the change in the molecule extension are reported as horizontal lines in <xref ref-type="fig" rid="pcbi-1003456-g005">Figure 5</xref>. Our simulation correctly reproduces these values, including the dependence of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e388" xlink:type="simple"/></inline-formula> on the stretching force <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e389" xlink:type="simple"/></inline-formula> throughout the whole range of salt concentrations explored (data not shown).</p>
<fig id="pcbi-1003456-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003456.g005</object-id><label>Figure 5</label><caption>
<title>Torque computation.</title>
<p>Twisting torque <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e390" xlink:type="simple"/></inline-formula> as a function of the average overtwist <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e391" xlink:type="simple"/></inline-formula> for stretching forces <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e392" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e393" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e394" xlink:type="simple"/></inline-formula> pN. Symbols are the simulation results. Horizontal lines show the values of the critical torques estimated from the experimental results at the corresponding stretching forces <xref ref-type="bibr" rid="pcbi.1003456-Mosconi1">[32]</xref>. Oblique black dotted line: experimental results in the pure extended state (low <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e395" xlink:type="simple"/></inline-formula>). Oblique blue dotted line: asymptotic behavior of the twisting torque as a function of the simulated average overtwist in the pure plectonemic state (high <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e396" xlink:type="simple"/></inline-formula>): <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e397" xlink:type="simple"/></inline-formula> with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e398" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e399" xlink:type="simple"/></inline-formula>; <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e400" xlink:type="simple"/></inline-formula> is the pitch of the DNA double helix.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003456.g005" position="float" xlink:type="simple"/></fig>
<p>Note that we sporadically obtained two plectonemes in the same DNA molecule during some simulation runs. Moreover we also observed that plectonemes diffuse along the DNA molecule when the global thermostat is started up (see supplementary <xref ref-type="supplementary-material" rid="pcbi.1003456.s007">Video S1</xref>). Interestingly, both features - multiplectonemes and plectoneme diffusion - have been recently observed experimentally <xref ref-type="bibr" rid="pcbi.1003456-vanLoenhout1">[44]</xref> and theoretically explained <xref ref-type="bibr" rid="pcbi.1003456-Emanuel1">[45]</xref>. Note that nevertheless these observations have been obtained with a 21-kb DNA molecule, hence with a much longer molecule than in our simulations (3-kb). This may explain why we did not observe the “multiplectoneme phase” described in (<xref ref-type="bibr" rid="pcbi.1003456-Emanuel1">[45]</xref>).</p>
<p>The increase of the average overtwist <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e401" xlink:type="simple"/></inline-formula> observed <italic>at</italic> the critical torque in <xref ref-type="fig" rid="pcbi-1003456-g005">Figure 5</xref> corresponds to the formation of plectonemes, until the entire DNA molecule is supercoiled. We explored this critical regime by recording, at given <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e402" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e403" xlink:type="simple"/></inline-formula>, the time evolution of both the molecule length and overtwist. When the critical torque is approached, a clear buckling instability appears, with DNA fluctuating between the pure extended state, characterized by a small supercoiling and a large extension, and a pure plectonemic state, with opposite characteristics <xref ref-type="bibr" rid="pcbi.1003456-Marko1">[10]</xref> (<xref ref-type="fig" rid="pcbi-1003456-g006">Figure 6</xref>). Note the anticorrelation between supercoiling and extension.</p>
<fig id="pcbi-1003456-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003456.g006</object-id><label>Figure 6</label><caption>
<title>Buckling behavior.</title>
<p>Buckling instability with stretching force of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e404" xlink:type="simple"/></inline-formula> pN and six different torques <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e405" xlink:type="simple"/></inline-formula>. (Blue) DNA relative extension. (Red) DNA overtwist. DNA relative extension and overtwist are monitored as a function of the number of simulation steps. All these recordings have been obtained after thermal equilibrium has been reached.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003456.g006" position="float" xlink:type="simple"/></fig>
<p>Beyond the buckling torque, DNA is in the pure plectonemic state, and an increasing torque will tighten the molecule supercoiling. Interestingly, while experimental results <xref ref-type="bibr" rid="pcbi.1003456-Mosconi1">[32]</xref> do not provide measurements of the average overtwist <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e406" xlink:type="simple"/></inline-formula> in this pure plectonemic state, our simulations allow to explore this regime. An example of the simulated dynamics at a stretching force <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e407" xlink:type="simple"/></inline-formula>pN and twisting torque <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e408" xlink:type="simple"/></inline-formula> is shown in supplementary <xref ref-type="supplementary-material" rid="pcbi.1003456.s009">Video S3</xref>. We observe that our simulation results deviate from Marko's theoretical prediction according to which <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e409" xlink:type="simple"/></inline-formula>, with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e410" xlink:type="simple"/></inline-formula> the twist persistence length of the plectoneme and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e411" xlink:type="simple"/></inline-formula> the pitch of the DNA double helix <xref ref-type="bibr" rid="pcbi.1003456-Marko1">[10]</xref>. Instead we get an affine law which may be cast in a similar form: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e412" xlink:type="simple"/></inline-formula> with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e413" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e414" xlink:type="simple"/></inline-formula>. The presence of the reference value <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e415" xlink:type="simple"/></inline-formula> seems rather natural since this is the overtwist above which the system enters the pure plectonemic state. The meaning of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e416" xlink:type="simple"/></inline-formula> length is an open question, but we notice that its value is close to the DNA bending persistence length <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e417" xlink:type="simple"/></inline-formula>.</p>
</sec></sec><sec id="s4d">
<title>Concluding remarks</title>
<p>The method developed here can conveniently describe all physiological situations involving DNA positive supercoiling, which are of main importance for DNA transcription or replication. One limitation of the modeling developed so far is that extensive modifications of the double helix structure are not accounted for, e.g. base pair opening that occurs when negative supercoiling is applied (DNA denaturation), or the S-DNA transition observed at extremely high force, or the P-DNA transition under very positive torque. Nevertheless this methodology gives an unparalleled opportunity to study more complex biological systems, such as protein-DNA complexes: in particular, we are currently addressing the modeling of magnetic tweezers response of chromatin fibres <xref ref-type="bibr" rid="pcbi.1003456-Bancaud2">[7]</xref>, by associating our <italic>in silico</italic> DNA model with a rigid body representation of the histone octamer. More recently, <italic>in vivo</italic> experiments also enable the measurement of the dynamics of chromosome <italic>loci</italic> in the cell nucleus <xref ref-type="bibr" rid="pcbi.1003456-Heun1">[11]</xref>, <xref ref-type="bibr" rid="pcbi.1003456-Albert1">[12]</xref>, <xref ref-type="bibr" rid="pcbi.1003456-Hajjoul1">[46]</xref>.</p>
</sec></sec><sec id="s5">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1003456.s001" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003456.s001" position="float" xlink:type="simple"><label>Figure S1</label><caption>
<p>Autocorrelation function of the kinetic energy <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e418" xlink:type="simple"/></inline-formula> (symbols) of a polymer of size <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e419" xlink:type="simple"/></inline-formula> µm and persistence length <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e420" xlink:type="simple"/></inline-formula> and for three different cylinder lengths: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e421" xlink:type="simple"/></inline-formula> (circles), <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e422" xlink:type="simple"/></inline-formula> (triangles) and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e423" xlink:type="simple"/></inline-formula> (crosses). We compare the theoretical exponential model <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e424" xlink:type="simple"/></inline-formula> for the tangent-tangent correlation to our simulation results (blue lines).</p>
<p>(TIF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003456.s002" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003456.s002" position="float" xlink:type="simple"><label>Figure S2</label><caption>
<p>Average tangent-tangent correlation <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e425" xlink:type="simple"/></inline-formula> (symbols) for a polymer of size <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e426" xlink:type="simple"/></inline-formula> µm and persistence length <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e427" xlink:type="simple"/></inline-formula> and for three different cylinder lengths: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e428" xlink:type="simple"/></inline-formula> (circles), <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e429" xlink:type="simple"/></inline-formula> (triangles) and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e430" xlink:type="simple"/></inline-formula> (crosses). We compare the theoretical exponential model <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e431" xlink:type="simple"/></inline-formula> for the tangent-tangent correlation to our simulation results (blue lines).</p>
<p>(TIFF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003456.s003" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003456.s003" position="float" xlink:type="simple"><label>Figure S3</label><caption>
<p>Supercoiling radius <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e432" xlink:type="simple"/></inline-formula> estimation from simulation results (black circles) and from experimental results <xref ref-type="bibr" rid="pcbi.1003456-Mosconi1">[32]</xref> (red triangles).</p>
<p>(TIFF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003456.s004" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003456.s004" position="float" xlink:type="simple"><label>Figure S4</label><caption>
<p>Helical angle estimation <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e433" xlink:type="simple"/></inline-formula> from simulation results (black circles) and from experimental results <xref ref-type="bibr" rid="pcbi.1003456-Mosconi1">[32]</xref> (red triangles).</p>
<p>(TIFF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003456.s005" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003456.s005" position="float" xlink:type="simple"><label>Figure S5</label><caption>
<p>Slope estimation <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e434" xlink:type="simple"/></inline-formula> from simulation results (black circles) and from experimental results <xref ref-type="bibr" rid="pcbi.1003456-Mosconi1">[32]</xref> (red triangles).</p>
<p>(TIFF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003456.s006" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003456.s006" position="float" xlink:type="simple"><label>Text S1</label><caption>
<p>In this appendix we address the problem of how to obtain a correct and computationally efficient definition of the bending and twisting rigidities for a polymer in general and a DNA molecule in particular.</p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003456.s007" mimetype="video/x-msvideo" xlink:href="info:doi/10.1371/journal.pcbi.1003456.s007" position="float" xlink:type="simple"><label>Video S1</label><caption>
<p>Illustration of the sampling efficiency of global versus local thermostat. This <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e435" xlink:type="simple"/></inline-formula> video records the simulated dynamics of a DNA molecule manipulated by magnetic tweezers after thermal equilibrium has been reached. The stretching force is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e436" xlink:type="simple"/></inline-formula>pN and the number of turns of the bead is fixed to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e437" xlink:type="simple"/></inline-formula>. From <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e438" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e439" xlink:type="simple"/></inline-formula>s the simulation is run with Langevin local thermostat. Then the global thermostat is started up at <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e440" xlink:type="simple"/></inline-formula>s and run until <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e441" xlink:type="simple"/></inline-formula>s, strikingly accelerating the dynamics of the DNA molecule. Moreover the plectoneme starts to diffuse along the DNA molecule. Then the local thermostat is run again from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e442" xlink:type="simple"/></inline-formula>s to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e443" xlink:type="simple"/></inline-formula>, resulting in a dramatic slowing down of the dynamics. And finally the global thermostat is started up again at <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e444" xlink:type="simple"/></inline-formula> and run until the end of the video at <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e445" xlink:type="simple"/></inline-formula>. The DNA molecule is composed of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e446" xlink:type="simple"/></inline-formula> rigid cylinders of radius <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e447" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e448" xlink:type="simple"/></inline-formula>. The other parameters of the simulation are given in <xref ref-type="table" rid="pcbi-1003456-t001">Table 1</xref>. This video is also available at <ext-link ext-link-type="uri" xlink:href="http://vimeo.com/51918121" xlink:type="simple">http://vimeo.com/51918121</ext-link>.</p>
<p>(AVI)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003456.s008" mimetype="video/x-msvideo" xlink:href="info:doi/10.1371/journal.pcbi.1003456.s008" position="float" xlink:type="simple"><label>Video S2</label><caption>
<p>Simulated dynamics of a DNA molecule manipulated by magnetic tweezers with a stretching force <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e449" xlink:type="simple"/></inline-formula>pN and fixed number of turns of the bead <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e450" xlink:type="simple"/></inline-formula>. This dynamics is performed with the global thermostat after thermal equilibrium has been reached. Note the diffusion of the plectoneme all along the DNA molecule. The DNA molecule is composed of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e451" xlink:type="simple"/></inline-formula> rigid cylinders of radius <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e452" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e453" xlink:type="simple"/></inline-formula>. The other parameters of the simulation are given in <xref ref-type="table" rid="pcbi-1003456-t001">Table 1</xref>. This video is also available at <ext-link ext-link-type="uri" xlink:href="http://vimeo.com/51918378" xlink:type="simple">http://vimeo.com/51918378</ext-link>.</p>
<p>(AVI)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003456.s009" mimetype="video/x-msvideo" xlink:href="info:doi/10.1371/journal.pcbi.1003456.s009" position="float" xlink:type="simple"><label>Video S3</label><caption>
<p>Simulated dynamics of a DNA molecule manipulated by magnetic tweezers with a stretching force <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e454" xlink:type="simple"/></inline-formula>pN and fixed twisting torque <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e455" xlink:type="simple"/></inline-formula>. Global thermostat is used all over the simulation. At initial time the number of turns of the bead is zero and the torque starts to be applied to the bead (the rotation of the bead can be followed thanks to the small orange tag on the sphere). Because the applied torque (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e456" xlink:type="simple"/></inline-formula>) is well above the buckling torque (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e457" xlink:type="simple"/></inline-formula>), the DNA molecule is in the pure plectonemic state at the end of the simulation. The DNA molecule is composed of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e458" xlink:type="simple"/></inline-formula> rigid cylinders of radius <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e459" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003456.e460" xlink:type="simple"/></inline-formula>. The other parameters of the simulation are given in <xref ref-type="table" rid="pcbi-1003456-t001">Table 1</xref>. This video is also available at <ext-link ext-link-type="uri" xlink:href="http://vimeo.com/51918151" xlink:type="simple">http://vimeo.com/51918151</ext-link>.</p>
<p>(AVI)</p>
</caption></supplementary-material></sec></body>
<back>
<ack>
<p>We acknowledge Julien Mozziconacci and Hua Wong for having introduced us to physics engines in general and ODE in particular, and Fabien Paillusson for fruitful discussions about the statistical mechanics foundations of the global thermostat. We are grateful to Rhoda Hawkins for careful reading of the manuscript.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1003456-Smith1"><label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Smith</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Finzi</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Bustamante</surname><given-names>C</given-names></name> (<year>1992</year>) <article-title>Direct mechanical measurements of the elasticity of single dna molecules by using magnetic beads</article-title>. <source>Science</source> <volume>258</volume>: <fpage>1122</fpage>–<lpage>1126</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003456-Strick1"><label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Strick</surname><given-names>TR</given-names></name>, <name name-style="western"><surname>Allemand</surname><given-names>JF</given-names></name>, <name name-style="western"><surname>Bensimon</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Bensimon</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Croquette</surname><given-names>V</given-names></name> (<year>1996</year>) <article-title>The elasticity of a single supercoiled dna molecule</article-title>. <source>Science</source> <volume>271</volume>: <fpage>1835</fpage>–<lpage>1837</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003456-Bryant1"><label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bryant</surname><given-names>Z</given-names></name>, <name name-style="western"><surname>Stone</surname><given-names>MD</given-names></name>, <name name-style="western"><surname>Gore</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Smith</surname><given-names>SB</given-names></name>, <name name-style="western"><surname>Cozzarelli</surname><given-names>NR</given-names></name>, <etal>et al</etal>. (<year>2003</year>) <article-title>Structural transitions and elasticity from torque measurements on dna</article-title>. <source>Nature</source> <volume>424</volume>: <fpage>338</fpage>–<lpage>341</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003456-Strick2"><label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Strick</surname><given-names>TR</given-names></name>, <name name-style="western"><surname>Croquette</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Bensimon</surname><given-names>D</given-names></name> (<year>2000</year>) <article-title>Single-molecule analysis of DNA uncoiling by a type II topoisomerase</article-title>. <source>Nature</source> <volume>404</volume>: <fpage>901</fpage>–<lpage>904</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003456-Koster1"><label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Koster</surname><given-names>DA</given-names></name>, <name name-style="western"><surname>Croquette</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Dekker</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Shuman</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Dekker</surname><given-names>NH</given-names></name> (<year>2005</year>) <article-title>Friction and torque govern the relaxation of DNA supercoils by eukaryotic topoisomerase IB</article-title>. <source>Nature</source> <volume>434</volume>: <fpage>671</fpage>–<lpage>674</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003456-Bancaud1"><label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bancaud</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Conde e Silva</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Barbi</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Wagner</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Allemand</surname><given-names>JF</given-names></name>, <etal>et al</etal>. (<year>2006/05//print</year>) <article-title>Structural plasticity of single chromatin fibers revealed by torsional manipulation</article-title>. <source>Nat Struct Mol Biol</source> <volume>13</volume>: <fpage>444</fpage>–<lpage>450</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003456-Bancaud2"><label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bancaud</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Wagner</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Conde e Silva</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Lavelle</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Wong</surname><given-names>H</given-names></name>, <etal>et al</etal>. (<year>2007/07/06</year>) <article-title>Nucleosome chiral transition under positive torsional stress in single chromatin fibers</article-title>. <source>Molecular cell</source> <volume>27</volume>: <fpage>135</fpage>–<lpage>147</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003456-Moroz1"><label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Moroz</surname><given-names>JD</given-names></name>, <name name-style="western"><surname>Nelson</surname><given-names>P</given-names></name> (<year>1997</year>) <article-title>Torsional directed walks, entropic elasticity, and dna twist stiffness</article-title>. <source>Proc Natl Acad Sci USA</source> <volume>94</volume>: <fpage>14418</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003456-Neukirch1"><label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Neukirch</surname><given-names>S</given-names></name> (<year>2004</year>) <article-title>Extracting dna twist rigidity from experimental supercoiling data</article-title>. <source>Phys Rev Lett</source> <volume>93</volume>: <fpage>198107</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003456-Marko1"><label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Marko</surname><given-names>JF</given-names></name> (<year>2007</year>) <article-title>Torque and dynamics of linking number relaxation in stretched supercoiled dna</article-title>. <source>Phys Rev E</source> <volume>76</volume>: <fpage>021926</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003456-Heun1"><label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Heun</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Laroche</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Shimada</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Furrer</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Gasser</surname><given-names>SM</given-names></name> (<year>2001</year>) <article-title>Chromosome dynamics in the yeast interphase nucleus</article-title>. <source>Science</source> <fpage>2181</fpage>–<lpage>2186</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003456-Albert1"><label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Albert</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Mathon</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Shukla</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Saad</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Normand</surname><given-names>C</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>Systematic characterization of the conformation and dynamics of budding yeast chromosome XII</article-title>. <source>J Cell Biol</source> <volume>202</volume>: <fpage>201</fpage>–<lpage>210</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003456-Vologodskii1"><label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Vologodskii</surname><given-names>AV</given-names></name>, <name name-style="western"><surname>Levene</surname><given-names>SD</given-names></name>, <name name-style="western"><surname>Klenin</surname><given-names>KV</given-names></name>, <name name-style="western"><surname>Frank-Kamenetskii</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Cozzarelli</surname><given-names>NR</given-names></name> (<year>1992</year>) <article-title>Conformational and thermodynamic properties of supercoiled dna</article-title>. <source>Journal of Molecular Biology</source> <volume>227</volume>: <fpage>1224</fpage>–<lpage>1243</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003456-Vologodskii2"><label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Vologodskii</surname><given-names>A</given-names></name> (<year>1994</year>) <article-title>Dna extension under the action of an external force</article-title>. <source>Macromolecules</source> <volume>27</volume>: <fpage>5623</fpage>–<lpage>5625</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003456-Ryckaert1"><label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ryckaert</surname><given-names>JP</given-names></name>, <name name-style="western"><surname>Ciccotti</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Berendsen</surname><given-names>HJ</given-names></name> (<year>1977</year>) <article-title>Numerical integration of the cartesian equations of motion of a system with constraints: molecular dynamics of n-alkanes</article-title>. <source>Journal of Computational Physics</source> <volume>23</volume>: <fpage>327</fpage>–<lpage>341</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003456-vanGunsteren1"><label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>van Gunsteren</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Berendsen</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Rullmann</surname><given-names>J</given-names></name> (<year>1981</year>) <article-title>Stochastic dynamics for molecules with constraints</article-title>. <source>Molecular Physics</source> <volume>44</volume>: <fpage>69</fpage>–<lpage>95</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003456-Erleben1"><label>17</label>
<mixed-citation publication-type="other" xlink:type="simple">Erleben K (2005) Stable, Robust, and Versatile Multibody Dynamics Animation. Ph.D. thesis, The Department of Computer Science, University of Copenhagen, Denmark.</mixed-citation>
</ref>
<ref id="pcbi.1003456-Smith2"><label>18</label>
<mixed-citation publication-type="other" xlink:type="simple">Smith R (2008). Open dynamic engine. <ext-link ext-link-type="uri" xlink:href="http://www.ode.org" xlink:type="simple">http://www.ode.org</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1003456-Bussi1"><label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bussi</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Parrinello</surname><given-names>M</given-names></name> (<year>2008</year>) <article-title>Stochastic thermostats: comparison of local and global schemes</article-title>. <source>Computer Physics Communications</source> <volume>179</volume>: <fpage>26</fpage>–<lpage>29</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003456-Fiser1"><label>20</label>
<mixed-citation publication-type="other" xlink:type="simple">Fiser D. Library for collision detection between complex shapes. <ext-link ext-link-type="uri" xlink:href="http://libccd.danfis.cz" xlink:type="simple">http://libccd.danfis.cz</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1003456-Grassia1"><label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Grassia</surname><given-names>FS</given-names></name> (<year>1998</year>) <article-title>Practical parameterization of rotations using the exponential map</article-title>. <source>J Graph Tools</source> <volume>3</volume>: <fpage>29</fpage>–<lpage>48</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003456-Young1"><label>22</label>
<mixed-citation publication-type="other" xlink:type="simple">Young DM (1950) Iterative methods for solving partial difference equations of elliptical type. Ph.D. thesis, Havard University.</mixed-citation>
</ref>
<ref id="pcbi.1003456-Cottle1"><label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cottle</surname><given-names>RW</given-names></name>, <name name-style="western"><surname>Dantzig</surname><given-names>GB</given-names></name> (<year>1968</year>) <article-title>Complementary pivot theory of mathematical programming</article-title>. <source>Linear Algebra and its Applications</source> <volume>1</volume>: <fpage>103</fpage>–<lpage>125</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003456-Clauvelin1"><label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Clauvelin</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Audoly</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Neukirch</surname><given-names>S</given-names></name> (<year>2008</year>) <article-title>Mechanical response of plectonemic dna: An analytical solution</article-title>. <source>Macromolecules</source> <volume>41</volume>: <fpage>4479</fpage>–<lpage>4483</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003456-Clauvelin2"><label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Clauvelin</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Audoly</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Neukirch</surname><given-names>S</given-names></name> (<year>2009</year>) <article-title>Elasticity and electrostatics of plectonemic dna</article-title>. <source>Biophysical Journal</source> <volume>96</volume>: <fpage>3716</fpage>–<lpage>3723</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003456-Brutzer1"><label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Brutzer</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Luzzietti</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Klaue</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Seidel</surname><given-names>R</given-names></name> (<year>2010</year>) <article-title>Energetics at the dna supercoiling transition</article-title>. <source>Biophysical Journal</source> <volume>98</volume>: <fpage>1267</fpage>–<lpage>1276</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003456-Argudo1"><label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Argudo</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Purohit</surname><given-names>PK</given-names></name> (<year>2012</year>) <article-title>The dependence of dna supercoiling on solution electrostatics</article-title>. <source>Acta Biomaterialia</source> <volume>8</volume>: <fpage>2133</fpage>–<lpage>2143</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003456-Stigter1"><label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Stigter</surname><given-names>D</given-names></name> (<year>1977</year>) <article-title>Interactions of highly charged colloidal cylinders with applications to doublestranded dna</article-title>. <source>Biopolymers</source> <volume>16</volume>: <fpage>1435</fpage>–<lpage>1448</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003456-Brian1"><label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Brian</surname><given-names>AA</given-names></name>, <name name-style="western"><surname>Frisch</surname><given-names>HL</given-names></name>, <name name-style="western"><surname>Lerman</surname><given-names>LS</given-names></name> (<year>1981</year>) <article-title>Thermodynamics and equilibrium sedimentation analysis of the close approach of dna molecules and a molecular ordering transition</article-title>. <source>Biopolymers</source> <volume>20</volume>: <fpage>1305</fpage>–<lpage>1328</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003456-Rybenkov1"><label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rybenkov</surname><given-names>VV</given-names></name>, <name name-style="western"><surname>Cozzarelli</surname><given-names>NR</given-names></name>, <name name-style="western"><surname>Vologodskii</surname><given-names>AV</given-names></name> (<year>1993</year>) <article-title>Probability of dna knotting and the effective diameter of the dna double helix</article-title>. <source>Proc Natl Acad Sci USA</source> <volume>90</volume>: <fpage>5307</fpage>–<lpage>5311</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003456-Rybenkov2"><label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rybenkov</surname><given-names>VV</given-names></name>, <name name-style="western"><surname>Vologodskii</surname><given-names>AV</given-names></name>, <name name-style="western"><surname>Cozzarelli</surname><given-names>NR</given-names></name> (<year>1997</year>) <article-title>The effect of ionic conditions on dna helical repeat, effective diameter and free energy of supercoiling</article-title>. <source>Nucleic Acids Research</source> <volume>25</volume>: <fpage>1412</fpage>–<lpage>1418</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003456-Mosconi1"><label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mosconi</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Allemand</surname><given-names>JF</given-names></name>, <name name-style="western"><surname>Bensimon</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Croquette</surname><given-names>V</given-names></name> (<year>2009</year>) <article-title>Measurement of the torque on a single stretched and twisted dna using magnetic tweezers</article-title>. <source>Phys Rev Lett</source> <volume>102</volume>: <fpage>078301</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003456-Hagerman1"><label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hagerman</surname><given-names>PJ</given-names></name> (<year>1988</year>) <article-title>Flexibility of dna</article-title>. <source>Annual Review of Biophysics and Biophysical Chemistry</source> <volume>17</volume>: <fpage>265</fpage>–<lpage>286</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003456-Marko2"><label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Marko</surname><given-names>JF</given-names></name>, <name name-style="western"><surname>Siggia</surname><given-names>E</given-names></name> (<year>1995</year>) <article-title>Stretching dna</article-title>. <source>Macromolecules</source> <volume>28</volume>: <fpage>8759</fpage>–<lpage>8770</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003456-Bouchiat1"><label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bouchiat</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Wang</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Allemand</surname><given-names>JF</given-names></name>, <name name-style="western"><surname>Strick</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Block</surname><given-names>S</given-names></name>, <etal>et al</etal>. (<year>1999</year>) <article-title>Estimating the persistence length of a worm-like chain molecule from force-extension measurements</article-title>. <source>Biophysical Journal</source> <volume>76</volume>: <fpage>409</fpage>–<lpage>413</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003456-Berendsen1"><label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Berendsen</surname><given-names>HJC</given-names></name>, <name name-style="western"><surname>Postma</surname><given-names>JPM</given-names></name>, <name name-style="western"><surname>van Gunsteren</surname><given-names>WF</given-names></name>, <name name-style="western"><surname>DiNola</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Haak</surname><given-names>JR</given-names></name> (<year>1984</year>) <article-title>Molecular dynamics with coupling to an external bath</article-title>. <source>The Journal of Chemical Physics</source> <volume>81</volume>: <fpage>3684</fpage>–<lpage>3690</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003456-Samoletov1"><label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Samoletov</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Chaplain</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Dettmann</surname><given-names>C</given-names></name> (<year>2007</year>) <article-title>Thermostats for slow configurational modes</article-title>. <source>Journal of Statistical Physics</source> <volume>128</volume>: <fpage>1321</fpage>–<lpage>1336</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003456-Zhang1"><label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zhang</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Marko</surname><given-names>JF</given-names></name> (<year>2008</year>) <article-title>Maxwell relations for single-dna experiments: Monitoring protein binding and double-helix torque with force-extension measurements</article-title>. <source>Phys Rev E</source> <volume>77</volume>: <fpage>031916</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003456-Forth1"><label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Forth</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Deufel</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Sheinin</surname><given-names>MY</given-names></name>, <name name-style="western"><surname>Daniels</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Sethna</surname><given-names>JP</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>Abrupt buckling transition observed during the plectoneme formation of individual dna molecules</article-title>. <source>Phys Rev Lett</source> <volume>100</volume>: <fpage>148301</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003456-Christopher1"><label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Christopher</surname><given-names>Deufel</given-names></name>, <name name-style="western"><surname>Scott</surname><given-names>Forth</given-names></name>, <name name-style="western"><surname>Simmons Chad</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Siavash</surname><given-names>Dejgosha</given-names></name>, <name name-style="western"><surname>Wang Michelle</surname><given-names>D</given-names></name> (<year>2007</year>) <article-title>Nanofabricated quartz cylinders for angular trapping: DNA supercoiling torque detection</article-title>. <source>Nat Meth</source> <volume>4</volume>: <fpage>223</fpage>–<lpage>225</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003456-Wang1"><label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wang</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Yin</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Landick</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Gelles</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Block</surname><given-names>S</given-names></name> (<year>1997</year>) <article-title>Stretching dna with optical tweezers</article-title>. <source>Biophysical Journal</source> <volume>72</volume>: <fpage>1335</fpage>–<lpage>1346</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003456-Celedon1"><label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Celedon</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Nodelman</surname><given-names>IM</given-names></name>, <name name-style="western"><surname>Wildt</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Dewan</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Searson</surname><given-names>P</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>Magnetic tweezers measurement of single molecule torque</article-title>. <source>Nano Letters</source> <volume>9</volume>: <fpage>1720</fpage>–<lpage>1725</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003456-Mosconi2"><label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mosconi</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Allemand</surname><given-names>JF</given-names></name>, <name name-style="western"><surname>Croquette</surname><given-names>V</given-names></name> (<year>2011</year>) <article-title>Soft magnetic tweezers: A proof of principle</article-title>. <source>Rev Sci Instrum</source> <volume>82</volume>: <fpage>034302</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003456-vanLoenhout1"><label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>van Loenhout</surname><given-names>MTJ</given-names></name>, <name name-style="western"><surname>de Grunt</surname><given-names>MV</given-names></name>, <name name-style="western"><surname>Dekker</surname><given-names>C</given-names></name> (<year>2012</year>) <article-title>Dynamics of dna supercoils</article-title>. <source>Science</source> <volume>338</volume>: <fpage>94</fpage>–<lpage>97</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003456-Emanuel1"><label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Emanuel</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Lanzani</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Schiessel</surname><given-names>H</given-names></name> (<year>2013</year>) <article-title>Multiplectoneme phase of double-stranded dna under tension</article-title>. <source>Phys Rev E</source> <volume>88</volume>: <fpage>022706</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003456-Hajjoul1"><label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hajjoul</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Mathon</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Ranchon</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Goiffon</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Mozziconacci</surname><given-names>J</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>High throughput chromatin motion tracking in living yeast reveals the exibility of the fiber throughout the genome</article-title>. <source>Genome Research</source> <volume>23</volume>: <fpage>1829</fpage>–<lpage>1838</lpage>.</mixed-citation>
</ref>
</ref-list></back>
</article>