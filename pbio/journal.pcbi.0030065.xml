<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN"><front><journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="publisher">pcbi</journal-id><journal-id journal-id-type="allenpress-id">plcb</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher><publisher-name>Public Library of Science</publisher-name><publisher-loc>San Francisco, USA</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.1371/journal.pcbi.0030065</article-id><article-id pub-id-type="publisher-id">06-PLCB-RA-0288R3</article-id><article-id pub-id-type="sici">plcb-03-04-05</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline"><subject>Computational Biology</subject><subject>Molecular Biology</subject></subj-group><subj-group subj-group-type="System Taxonomy"><subject>Ascidians (sea squirts)</subject><subject>Animals</subject><subject>Eukaryotes</subject></subj-group></article-categories><title-group><article-title>Inferring Noncoding RNA Families and Classes by Means of Genome-Scale Structure-Based Clustering</article-title><alt-title alt-title-type="running-head">Structure-Based Clustering of RNAs</alt-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Will</surname><given-names>Sebastian</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Reiche</surname><given-names>Kristin</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Hofacker</surname><given-names>Ivo L</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Stadler</surname><given-names>Peter F</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Backofen</surname><given-names>Rolf</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib></contrib-group><aff id="aff1">
				<label>1</label><addr-line> Bioinformatics Group, Institute of Computer Science, University of Freiburg, Freiburg, Germany
			</addr-line></aff><aff id="aff2">
				<label>2</label><addr-line> Bioinformatics Group, Department of Computer Science, University of Leipzig, Leipzig, Germany
			</addr-line></aff><aff id="aff3">
				<label>3</label><addr-line> Department of Theoretical Chemistry, University of Vienna, Vienna, Austria
			</addr-line></aff><contrib-group><contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Bourne</surname><given-names>Philip E</given-names></name><role>Editor</role><xref ref-type="aff" rid="edit1"/></contrib></contrib-group><aff id="edit1">University of California San Diego, United States of America</aff><author-notes><fn fn-type="con" id="ack1"><p>All authors conceived and designed the experiments and contributed to writing the paper. SW developed and implemented the algorithm and performed the experiments. KR analyzed the data and contributed analysis tools.</p></fn><corresp id="cor1">* To whom correspondence should be addressed. E-mail: <email xlink:type="simple">backofen@informatik.uni-freiburg.de</email></corresp><fn fn-type="conflict" id="ack3"><p> The authors have declared that no competing interests exist.</p></fn></author-notes><pub-date pub-type="ppub"><month>4</month><year>2007</year></pub-date><pub-date pub-type="epub"><day>13</day><month>4</month><year>2007</year></pub-date><pub-date pub-type="epreprint"><day>22</day><month>2</month><year>2007</year></pub-date><volume>3</volume><issue>4</issue><elocation-id>e65</elocation-id><history><date date-type="received"><day>18</day><month>7</month><year>2006</year></date><date date-type="accepted"><day>22</day><month>2</month><year>2007</year></date></history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2007</copyright-year><copyright-holder>Will et al</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract><p>The RFAM database defines families of ncRNAs by means of sequence similarities that are sufficient to establish homology. In some cases, such as microRNAs and box H/ACA snoRNAs, functional commonalities define classes of RNAs that are characterized by structural similarities, and typically consist of multiple RNA families. Recent advances in high-throughput transcriptomics and comparative genomics have produced very large sets of putative noncoding RNAs and regulatory RNA signals. For many of them, evidence for stabilizing selection acting on their secondary structures has been derived, and at least approximate models of their structures have been computed. The overwhelming majority of these hypothetical RNAs cannot be assigned to established families or classes. We present here a structure-based clustering approach that is capable of extracting putative RNA classes from genome-wide surveys for structured RNAs. The LocARNA (local alignment of RNA) tool implements a novel variant of the Sankoff algorithm that is sufficiently fast to deal with several thousand candidate sequences. The method is also robust against false positive predictions, i.e., a contamination of the input data with unstructured or nonconserved sequences. We have successfully tested the LocARNA-based clustering approach on the sequences of the RFAM-seed alignments. Furthermore, we have applied it to a previously published set of 3,332 predicted structured elements in the <named-content content-type="genus-species" xlink:type="simple">Ciona intestinalis</named-content> genome (Missal K, Rose D, Stadler PF (2005) Noncoding RNAs in <italic>Ciona intestinalis.</italic> Bioinformatics 21 (Supplement 2): i77–i78). In addition to recovering, e.g., tRNAs as a structure-based class, the method identifies several RNA families, including microRNA and snoRNA candidates, and suggests several novel classes of ncRNAs for which to date no representative has been experimentally characterized.</p></abstract><abstract abstract-type="summary"><title>Author Summary</title><sec id="st1"><title/><p>For a long time, it was believed that the control of processes in living organisms is almost only performed by proteins. Only recently, scientists learned that a further class of molecules, namely special RNAs, plays an important role in cell control. In consequence, research on such RNAs enjoys increasing attention over the last few years. These RNAs were called noncoding RNAs (ncRNA), because, unlike most other RNAs, these molecules do not code for proteins. Due to recent research successes, one can predict a lot of potential new ncRNAs by comparing the genomes of related organisms. Technically, comparing such RNAs is challenging and computationally expensive, since related ncRNAs often show only weak similarity on the sequence level, but share similar structures. In the paper, we present the new method LocARNA for fast and accurate comparison of RNAs with respect to their sequence and structure. Using this method, we define a distance measure between pairs of ncRNAs based on sequence and structure. This is then used for combining RNAs into a cluster for identifying groups of similar RNAs in large unorganized sets of RNA. The final aim of such a comparison is to identify new classes of ncRNAs. We applied our clustering procedure to a previously published set of 3,332 predicted ncRNAs in the <named-content content-type="genus-species" xlink:type="simple">C. intestinalis</named-content> genomes. In addition to rediscovering known classes of RNAs, e.g., tRNAs, the method predicts microRNA candidates, and suggests several novel, experimentally uncharacterized classes of ncRNAs. For verification, we clustered about 4,000 RNAs of RFAM, which is a large database that contains RNAs with an already known classification into families. Our results show good performance of the presented structure-based clustering approach.</p></sec></abstract><funding-group><funding-statement>This work has been funded, in part, by the Federal Ministry of Education and Research in the context of the Jena Center for Bioinformatics, the Austrian GEN-AU projects Bioinformatics Integration Network II and Noncoding RNA, and the SPP 1174 “Deep Metazoan Phylogeny”' and Bioinformatics Initiative BIZ-6/1–2 of the DFG (German Research Foundation).</funding-statement></funding-group><counts><page-count count="12"/></counts><!--===== Restructure custom-meta-wrap to custom-meta-group =====--><custom-meta-group><custom-meta><meta-name>citation</meta-name><meta-value>Will S, Reiche K, Hofacker IL, Stadler PF, Backofen R (2007) Inferring noncoding RNA families and classes by means of genome-scale structure-based clustering. PLoS Comput Biol 3(4): e65. doi:<ext-link ext-link-type="doi" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.0030065" xlink:type="simple">10.1371/journal.pcbi.0030065</ext-link></meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1"><title>Introduction</title><p>Starting with the discovery of microRNAs [<xref ref-type="bibr" rid="pcbi-0030065-b001">1</xref>–<xref ref-type="bibr" rid="pcbi-0030065-b003">3</xref>] and the advent of genome-wide transcriptomics [<xref ref-type="bibr" rid="pcbi-0030065-b004">4</xref>–<xref ref-type="bibr" rid="pcbi-0030065-b006">6</xref>], it has become obvious that RNA plays a large variety of important, often regulatory, roles in living organisms that extend far beyond being a mere intermediate one in protein biosynthesis. The elucidation of the functional roles of the plethora of newly discovered ncRNAs has thus become a central research interest in molecular biology.</p><p>Recent advances in computational RNomics have resulted in numerous software packages that can be employed to detect ncRNAs with evolutionarily conserved secondary structures [<xref ref-type="bibr" rid="pcbi-0030065-b007">7</xref>–<xref ref-type="bibr" rid="pcbi-0030065-b012">12</xref>]. Two of these, EvoFold [<xref ref-type="bibr" rid="pcbi-0030065-b010">10</xref>] and RNAz [<xref ref-type="bibr" rid="pcbi-0030065-b009">9</xref>,<xref ref-type="bibr" rid="pcbi-0030065-b013">13</xref>], are efficient enough to be applied to genome-wide surveys in mammals [<xref ref-type="bibr" rid="pcbi-0030065-b010">10</xref>,<xref ref-type="bibr" rid="pcbi-0030065-b013">13</xref>] and other metazoan clades [<xref ref-type="bibr" rid="pcbi-0030065-b014">14</xref>,<xref ref-type="bibr" rid="pcbi-0030065-b015">15</xref>]. Both approaches start from multiple sequence alignments. While EvoFold uses the SCFG approach pioneered by qrna [<xref ref-type="bibr" rid="pcbi-0030065-b007">7</xref>], RNAz is based on evaluating the folding thermodynamics. Both approaches classify input alignments either as unstructured or as possessing a common RNA secondary structure; in the latter case they provide a prediction for the consensus structure of the aligned sequences.</p><p>Just as in the case of proteins, ncRNA sequences can be grouped into families that are characterized by clear homologies. Usually the members in a family share functional characteristics as well as conserved sequence and structure motifs. Indeed, the RFAM database [<xref ref-type="bibr" rid="pcbi-0030065-b016">16</xref>] compiles several hundred families of ncRNAs based on this observation. Examples include the individual snRNAs U1, U2, U4, U5, and U6, 5S rRNA, RNAse P RNA, the RNA component of telomerase, more than a hundred families of snoRNAs, and several hundred microRNA families collected in mirbase [<xref ref-type="bibr" rid="pcbi-0030065-b017">17</xref>]. In many cases, RNA families can be grouped together, forming a ncRNA class whose members have no discernible homology at sequence level, but still share common structural and functional properties. The best-known classes are tRNAs (although it is well-established that all tRNAs derive from a common ancestor [<xref ref-type="bibr" rid="pcbi-0030065-b018">18</xref>]), the two distinct classes of snoRNAs (box H/ACA and box C/D), RNAse P and MRP RNAs, and microRNAs. It is thus natural to ask whether the many ncRNA candidates that have been predicted computationally can be grouped into families or even classes, and in particular, whether there is evidence for novel families and classes for which we have not yet seen experimentally verified representatives.</p><p>As sequence similarity is often remote even within well-established RNA families, we cannot rely on pure sequence alignment techniques for this task. Indeed, it has been shown that sequence alignments of structured RNAs fail at pairwise sequence identities below about 60% [<xref ref-type="bibr" rid="pcbi-0030065-b019">19</xref>]. Several different algorithmic approaches have been introduced in the past to determine structural similarities and to derive consensus structure patterns for RNAs that are too diverse to be alignable at sequence level. The corresponding software tools, such as MARNA [<xref ref-type="bibr" rid="pcbi-0030065-b020">20</xref>], PMmulti [<xref ref-type="bibr" rid="pcbi-0030065-b021">21</xref>], and RNAforrester [<xref ref-type="bibr" rid="pcbi-0030065-b022">22</xref>] cannot be applied without modifications to the problem of clustering predicted structures from RNAz or EvoFold surveys, however. The main reason is that these ncRNA detectors are not guaranteed to find the complete ncRNA genes; rather they usually detect particularly conserved substructures and sometimes the predictions are contaminated with spurious predictions in the flanking sequences. Thus, a local structure-based alignment algorithm is necessary. This is already implemented in RNAforrester [<xref ref-type="bibr" rid="pcbi-0030065-b022">22</xref>], which is based on tree-alignment, and in the local sequence–structure alignment approach described [<xref ref-type="bibr" rid="pcbi-0030065-b023">23</xref>], which in addition can also detect structurally local motifs. A related approach detects exact local sequence structure patterns in <bold>O</bold>(<italic>n</italic><sup>2</sup>) [<xref ref-type="bibr" rid="pcbi-0030065-b024">24</xref>]. However, all these approaches require a single known or predicted input structure. Tree-alignment and tree-editing in addition have only limited capabilities to repair incorrect base pairs. Tree-alignment is particularly restrictive in this respect since even broken arcs must be nested. As a consequence, RNAforrester tends to produce many alignment columns that contain mostly gap characters in the multiple alignment mode.</p><p>In contrast, derivates of the Sankoff algorithm [<xref ref-type="bibr" rid="pcbi-0030065-b025">25</xref>] solve the problem of simultaneous folding and alignment, which turned out to be more appropriate. However, the large number of predicted ncRNAs, several thousands in the case of nematode and urochordate genomes and close to 100,000 in the case of mammals, calls for more efficient variants of these algorithms.</p><p>In this contribution we introduce LocARNA (local alignment of RNA), a local pairwise structural alignment algorithm for pseudoknot-free RNA secondary structures, and its multiple version mLocARNA. (m)LocARNA is a Sankoff-style algorithm, similar to PMmulti, that is efficient enough to be used for large clustering of predicted ncRNAs. We have successfully tested the LocARNA-based clustering approach on the sequences of the RFAM-seed alignments to demonstrate the feasibility of the approach, and to evaluate the results. Furthermore, we use the data from a survey of the ascidians <named-content content-type="genus-species" xlink:type="simple">C. intestinalis</named-content> and <named-content content-type="genus-species" xlink:type="simple">C. savignyi</named-content> [<xref ref-type="bibr" rid="pcbi-0030065-b014">14</xref>] to achieve the following goals. (1) We search for novel, clade-specific RNA families in <italic>Ciona,</italic> which is of interest in itself. (2) In doing so, we can increase the credibility of some of the predicted ncRNAs, since being part of larger family of related RNAs with similar structure reduces the likelihood of being a false positive prediction. (3) We improve the genome annotation by assigning additional ncRNAs to known families. (4) The inferred consensus structures of novel families form a starting point for subsequent searches in related organisms.</p></sec><sec id="s2"><title>Methods</title><sec id="s2a"><title>Structure-Based Clustering</title><p>In this work, we set up a pipeline for automated clustering of ncRNAs (or ncRNA candidates) and semi-automated selection of novel, complex clusters of RNAs. The input is a set of RNAs <italic>R</italic><sub>1</sub>,…,<italic>R</italic><sub>N</sub>, which are given by their sequences, and the output is a hierarchical clustering of these RNAs. In addition, we will generate a fast, presorted, and annotated overview of the clusters for further inspection by an expert. Our pipeline is built from the following steps:</p><p>1. For each of the RNAs, we compute structural information using McCaskill's algorithm, implemented in RNAfold. This algorithm computes a matrix of pair probabilities based on a complete energy model of RNAs.</p><p>2. The next step is to compute all pairwise alignments of the structurally annotated sequences using LocARNA. Note that this requires computation of <bold>O</bold>(<italic>N</italic><sup>2</sup>) pairwise sequence–structure alignments for determining the distance matrix. Note further that performing all pairwise comparisons cannot be reasonably circumvented or replaced in a full-featured clustering procedure. For genomic-scale datasets, <bold>O</bold>(<italic>N</italic><sup>2</sup>) comparisons are way too costly for most existing sequence–structure approaches. The computational efficiency remains crucial, even if this computationally most intensive procedure is distributed for parallel computation, which we do in a straightforward manner. As a result, we assign a LocARNA-alignment score (<italic>i</italic>,<italic>j</italic>) to each pair of RNAs (<italic>R<sub>i</sub></italic>,<italic>R<sub>j</sub></italic>).</p><p>3. A cluster-tree is generated by applying the weighted pair group method algorithm (WPGMA), which is also known as average-linkage clustering, to a matrix of pairwise distances of the RNAs. There, the distances <italic>d</italic>(<italic>i</italic>,<italic>j</italic>) correspond directly to our LocARNA-scores. Instead of computing distances as <italic>max<sub>ij</sub>-score</italic>(<italic>i,j</italic>)<italic>,</italic> we define distances by
					<disp-formula id="pcbi-0030065-eq001"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030065.eq001" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mi>d</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&equals;</mml:mo><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>q</mml:mi><mml:mo>&minus;</mml:mo><mml:mi>s</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math> --></disp-formula>where <italic>q</italic> is the <italic>x</italic>-quantile (e.g., <italic>x</italic> = 99%) of all pairwise scores. This decision avoids the fact that exceptionally large scores influence the distance-transformation. In the resulting tree, internal nodes correspond to clusters of RNAs. Their heights correspond to the mean pairwise LocARNA-scores of their constituents and thus give a single-value measure of cluster quality.
				</p><p>4. A good overview and a true quality assessment of the clusters can be best provided through multiple alignments of each cluster. We simultaneously construct all multiple sequence–structure alignments, i.e., one for each cluster, by only <bold>O</bold>(<italic>N</italic>) runs of the pairwise alignment algorithm. This can be done by constructing the multiple alignments progressively, using the already constructed cluster-tree as guide tree.</p><p>From each of the multiple alignments, we collect information that can guide a quality assessment of the cluster. We compute the mean pairwise sequence identity (MPI) and, using RNAalifold, the structure conservation index (SCI), the consensus minimum free energy (MFE), the consensus MFE structure, and the consensus base pair probabilities. Sorting the list of generated clusters by the quantities size of cluster, SCI, MPI, and MFE provide the expert with an automatically proposed order for his manual inspection of the clusters. The multiple alignment itself and the consensus structure information facilitate the selection of “interesting” clusters.</p><p>This pipeline crucially depends on pairwise sequence–structure alignments. Therefore, we require the following algorithmic components which we describe in some detail in the next two sections, (1) LocARNA: Efficient Pairwise Local Sequence–Structure Alignment and (2) Local Multiple Sequence Structure Alignments. In (1), we develop an efficient algorithm for high-quality pairwise alignments of RNAs that considers both sequence and structure information. For this purpose, the best results are achieved with Sankoff-style algorithms. We provide the new method called LocARNA, which is much more efficient than current approaches and uses base pair probabilities as structural input. Regarding (2), for the selection of clusters, one important subproblem is to extract consensus structure information from the clustered RNAs, which is done by using RNAalifold. For producing the input for RNAalifold, we introduce the <italic>local</italic> multiple alignment method mLocARNA.</p></sec><sec id="s2b"><title>LocARNA: Efficient Pairwise Local Sequence–Structure Alignment</title><p>For the pairwise alignments of RNA, we use our novel tool LocARNA, which computes local alignments of RNA. It is a Sankoff-style algorithm in the spirit of PMcomp, but goes beyond its ancestor by introducing local alignment and significantly improving the efficiency.</p><p>The Sankoff algorithm [<xref ref-type="bibr" rid="pcbi-0030065-b025">25</xref>] provides a general solution to the problem of simultaneously computing an alignment and the common secondary structure of the two aligned sequences. In its full form, the problem requires <bold>O</bold>(<italic>n</italic><sup>6</sup>) CPU time and <bold>O</bold>(<italic>n</italic><sup>4</sup>) memory, where <italic>n</italic> is the length of the RNA sequences to be aligned. In general, one can distinguish two variants of the Sankoff algorithms: programs such as foldalign [<xref ref-type="bibr" rid="pcbi-0030065-b026">26</xref>,<xref ref-type="bibr" rid="pcbi-0030065-b027">27</xref>] and dynalign [<xref ref-type="bibr" rid="pcbi-0030065-b028">28</xref>] implement a more or less complete energy model for the RNA folding part. In contrast, PMcomp [<xref ref-type="bibr" rid="pcbi-0030065-b021">21</xref>] assumes that a structure model for the two input sequences is already known and given in the form of weights for the individual base pairs. However, note that such a structure model is reasonably obtained using McCaskill's algorithm [<xref ref-type="bibr" rid="pcbi-0030065-b029">29</xref>], again on the basis of a full-featured energy model.</p><p>Consider two sequences <italic>A</italic> and <italic>B</italic> with associated base pair probability matrices <italic>P<sup>A</sup></italic> and <italic>P<sup>B</sup></italic>, respectively. The goal is to compute a sequence alignment <bold>A</bold> of <italic>A</italic> and <italic>B</italic> together with secondary structure <bold>S</bold> on <bold>A</bold>. <bold>A</bold> consists of a set of (mis)matches written as pairs (<italic>i</italic>,<italic>k</italic>), where <italic>i</italic> is a position in <italic>A,</italic> and <italic>k</italic> a position in <italic>B</italic>. The consensus secondary structure <bold>S</bold> for an alignment <bold>A</bold> consists of a set of quadruples (<italic>ij</italic>;<italic>kl</italic>), where (<italic>i</italic>,<italic>k</italic>)∈<bold>A</bold> and (<italic>j</italic>,<italic>l</italic>)∈<bold>A</bold> are two matches in <bold>A</bold>, (<italic>i</italic>,<italic>j</italic>) is a base pair on sequence <italic>A,</italic> and (<italic>k</italic>,<italic>l</italic>) is a base pair on sequence <italic>B</italic>. Furthermore, denote by <bold>A</bold><italic><sub>s</sub></italic> the single-stranded part of the alignment; i.e., if (<italic>i</italic>,<italic>k</italic>)∈<bold>A</bold><italic><sub>s</sub></italic> then there is no pair (<italic>j</italic>,<italic>l</italic>) such that (<italic>ij</italic>;<italic>kl</italic>)∈<bold>S</bold> or (<italic>ji</italic>;<italic>kl</italic>)∈<bold>S</bold>. The goal is to determine the pair (<bold>A</bold>,<bold>S</bold>) that maximized the score function
					<disp-formula id="pcbi-0030065-e001"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030065.e001" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mstyle displaystyle='true'><mml:munder><mml:mo>&sum;</mml:mo><mml:mrow><mml:mo stretchy='false'>(</mml:mo><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo>;</mml:mo><mml:mi>k</mml:mi><mml:mi>l</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>&isin;</mml:mo><mml:mstyle mathvariant='bold' mathsize='normal'><mml:mtext>S</mml:mtext></mml:mstyle></mml:mrow></mml:munder></mml:mstyle><mml:mtext>&thinsp;</mml:mtext><mml:mo stretchy='false'>(</mml:mo><mml:msubsup><mml:mi>&Psi;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>A</mml:mi></mml:msubsup><mml:mo>&plus;</mml:mo><mml:msubsup><mml:mi>&Psi;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mi>B</mml:mi></mml:msubsup><mml:mo stretchy='false'>)</mml:mo><mml:mo>&plus;</mml:mo><mml:mstyle displaystyle='true'><mml:munder><mml:mo>&sum;</mml:mo><mml:mrow><mml:mo stretchy='false'>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>&isin;</mml:mo><mml:msub><mml:mtext mathvariant='bold'>A</mml:mtext><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:munder></mml:mstyle><mml:mtext>&thinsp;</mml:mtext><mml:mi>&sigma;</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy='false'>)</mml:mo><mml:mo>&minus;</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mtext>gap</mml:mtext></mml:mrow></mml:msub><mml:mi>&gamma;</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math> --></disp-formula>where <inline-formula id="pcbi-0030065-ex001"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0030065.ex001" xlink:type="simple"/></inline-formula>
					 and <inline-formula id="pcbi-0030065-ex002"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0030065.ex002" xlink:type="simple"/></inline-formula>
					 are base pair scores (see below), σ:{<italic>A</italic>,<italic>C</italic>,<italic>G</italic>,<italic>U</italic>}<sup>2</sup> → <bold>R</bold> is the similarity score for (mis)matches, γ is the gap score parameter, and <italic>N</italic><sub>gap</sub> is the number of insertions and deletions in the alignment <bold>A</bold>.
				</p><p>Both PMcomp and our novel tool, LocARNA, use base pair scores that are derived from the base pairing probability matrices of the two individual sequences. More precisely, we use here
					<disp-formula id="pcbi-0030065-e002"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030065.e002" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:msub><mml:mi>&Psi;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>&equals;</mml:mo><mml:mrow><mml:mo stretchy="true">&lcub;</mml:mo><mml:mrow><mml:mtable columnalign='left'><mml:mtr columnalign='left'><mml:mtd columnalign='left'><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mstyle scriptlevel='+1'><mml:mfrac><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>/</mml:mo><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mstyle scriptlevel='+1'><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:mtd><mml:mtd columnalign='left'><mml:mrow><mml:mtext>if</mml:mtext><mml:mtext>&thinsp;</mml:mtext><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>&ge;</mml:mo><mml:msup><mml:mi>p</mml:mi><mml:mo>&lowast;</mml:mo></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign='left'><mml:mtd columnalign='left'><mml:mrow><mml:mo>&minus;</mml:mo><mml:mi>&infin;</mml:mi><mml:malignmark/></mml:mrow></mml:mtd><mml:mtd columnalign='left'><mml:mrow><mml:mtext>otherwise</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:malignmark/></mml:mrow></mml:mrow></mml:mrow></mml:math> --></disp-formula>where <italic>P<sub>ij</sub></italic> is the equilibrium pairing probability as computed by McCaskill's algorithm [<xref ref-type="bibr" rid="pcbi-0030065-b029">29</xref>], <italic>p</italic><sub>0</sub> is the expected probability for a pairing to occur at random, and <italic>p</italic><sup>*</sup> is the cutoff probability, below which the arcs are ignored. Formally, this is expressed by assigning −∞ as the weight in this case. The term <inline-formula id="pcbi-0030065-ex003"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0030065.ex003" xlink:type="simple"/></inline-formula>
					 is the log-odds score for having a specific base pairing against the null model of a random pairing, and <inline-formula id="pcbi-0030065-ex004"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0030065.ex004" xlink:type="simple"/></inline-formula>
					 is a normalization factor that transforms the weights to a maximum of 1. The reason for this normalization is just that it is easier to balance the sequence score against the structure score.
				</p><p>LocARNA improves the PMcomp approach in several ways. First of all, it uses a modified dynamic programming approach that allows us to utilize the fact that typically the number of significant base pairs does not grow with <bold>O</bold>(<italic>n</italic><sup>2</sup>), i.e., that the base pair probability matrices <italic>P<sup>A</sup></italic> and <italic>P<sup>B</sup></italic> are usually sparse. In particular, if <italic>p</italic> is constant for different <italic>n</italic>, then each base can take part in at most 1/<italic>p</italic><sup>*</sup>, and thus <bold>O</bold>(1) base pairs. Hence, there are only <italic>m</italic> = <bold>O</bold>(<italic>n</italic>) significant entries in <italic>P</italic>.</p><p>We define <italic>D<sub>ij</sub></italic><sub>;<italic>kl</italic></sub> as the maximal similarity score of an alignment for the subsequences <italic>A</italic>[<italic>i</italic>..<italic>j</italic>] and <italic>B</italic>[<italic>k</italic>..<italic>l</italic>] with the additional condition that (<italic>i j</italic>;<italic>k l</italic>) is part of consensus secondary structure. To profit from the reduced number of significant base pairs in time and space complexity, we calculate and store only <italic>D<sub>ij</sub></italic><sub>;<italic>kl</italic></sub> that correspond to significant base pairs. Due to this modification, we need to take special care to avoid redundant computation. Therefore, we compute the entries <italic>D<sub>ij</sub></italic><sub>;<italic>kl</italic></sub> by fixing <italic>i</italic> and <italic>k</italic> and varying only <italic>j</italic> and <italic>l</italic>. We introduce the notation <italic>D<sub>i•</sub></italic><sub>;<italic>k•</italic></sub> to denote the matrix slice where <italic>i</italic> and <italic>k</italic> are fixed. The efficient calculation of <italic>D<sub>i•</sub></italic><sub>;<italic>k•</italic></sub> in <bold>O</bold>(<italic>n</italic><sup>2</sup>) time requires an auxiliary matrix <italic>M</italic>, where the entries <italic>M<sub>ij</sub></italic><sub>;<italic>kl</italic></sub> are the optimal similarity score of subsequences <italic>A</italic>[<italic>i</italic> + 1…<italic>j</italic>] and <italic>B</italic>[<italic>k</italic> + 1…<italic>l</italic>], and leads to a computation order that differs from PMcomp. Finally, the dynamic programming recursion for <italic>M</italic> and <italic>D</italic> takes the usual form of a Sankoff-style algorithm:
					<disp-formula id="pcbi-0030065-e003"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030065.e003" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mtext>&thinsp;</mml:mtext><mml:mi>j</mml:mi><mml:mo>;</mml:mo><mml:mi>k</mml:mi><mml:mtext>&thinsp;</mml:mtext><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:malignmark/><mml:mo>&equals;</mml:mo><mml:malignmark/><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="true">&lcub;</mml:mo><mml:mrow><mml:mtable columnalign='left'><mml:mtr columnalign='left'><mml:mtd columnalign='left'><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mtext>&thinsp;</mml:mtext><mml:mi>j</mml:mi><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn><mml:mo>;</mml:mo><mml:mi>k</mml:mi><mml:mtext>&thinsp;</mml:mtext><mml:mi>l</mml:mi><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&plus;</mml:mo><mml:mi>&sigma;</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo stretchy='false'>)</mml:mo><mml:malignmark/></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign='left'><mml:mtd columnalign='left'><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mtext>&thinsp;</mml:mtext><mml:mi>j</mml:mi><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn><mml:mo>;</mml:mo><mml:mi>k</mml:mi><mml:mtext>&thinsp;</mml:mtext><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>&plus;</mml:mo><mml:mi>&gamma;</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign='left'><mml:mtd columnalign='left'><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mtext>&thinsp;</mml:mtext><mml:mi>j</mml:mi><mml:mo>;</mml:mo><mml:mi>k</mml:mi><mml:mtext>&thinsp;</mml:mtext><mml:mi>l</mml:mi><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&plus;</mml:mo><mml:mi>&gamma;</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign='left'><mml:mtd columnalign='left'><mml:mrow><mml:malignmark/><mml:munder><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:mo>&prime;</mml:mo></mml:msup><mml:msup><mml:mi>l</mml:mi><mml:mo>&prime;</mml:mo></mml:msup></mml:mrow></mml:munder><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mtext>&thinsp;</mml:mtext><mml:msup><mml:mi>j</mml:mi><mml:mo>&prime;</mml:mo></mml:msup><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn><mml:mo>;</mml:mo><mml:mi>k</mml:mi><mml:mtext>&thinsp;</mml:mtext><mml:msup><mml:mi>l</mml:mi><mml:mo>&prime;</mml:mo></mml:msup><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&plus;</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:mo>&prime;</mml:mo></mml:msup><mml:mtext>&thinsp;</mml:mtext><mml:mi>j</mml:mi><mml:mo>;</mml:mo><mml:msup><mml:mi>l</mml:mi><mml:mo>&prime;</mml:mo></mml:msup><mml:mtext>&thinsp;</mml:mtext><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:malignmark/></mml:mrow></mml:mrow></mml:mrow></mml:math> --><!-- <mml:math display='block'><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mtext>&thinsp;</mml:mtext><mml:mi>j</mml:mi><mml:mo>;</mml:mo><mml:mi>k</mml:mi><mml:mtext>&thinsp;</mml:mtext><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:malignmark/><mml:mo>&equals;</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mtext>&thinsp;</mml:mtext><mml:mi>j</mml:mi><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn><mml:mo>;</mml:mo><mml:mi>k</mml:mi><mml:mtext>&thinsp;</mml:mtext><mml:mi>l</mml:mi><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&plus;</mml:mo><mml:msubsup><mml:mi>&Psi;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>A</mml:mi></mml:msubsup><mml:mo>&plus;</mml:mo><mml:msubsup><mml:mi>&Psi;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mi>B</mml:mi></mml:msubsup></mml:mrow></mml:math> --></disp-formula>
				</p><p>The important observation is that the last, computationally most expensive, alternative in the <italic>M</italic> recursion needs to be evaluated only for <italic>P<sup>A</sup><sub>j</sub></italic><sub>′<italic>j</italic></sub> ≥ <italic>p</italic><sup>*</sup> and <italic>P<sup>B</sup><sub>l′l</sub></italic> ≥ <italic>p</italic><sup>*</sup>, and, analogously, <italic>D</italic> needs to be stored only for matching base pairs. We observe that <italic>D</italic><sub><italic>i</italic>•</sub><sub>;<italic>k</italic>•</sub> depends only on <italic>M<sub>i•</sub></italic><sub>;<italic>k•</italic></sub>, which in turn can be computed from other <italic>M<sub>i•</sub></italic><sub>;<italic>k•</italic></sub> entries. Thus, we only need to store the entries of <italic>M</italic> for the current values of <italic>i</italic> and <italic>k</italic>, i.e., <bold>O</bold>(<italic>n</italic><sup>2</sup>) entries. The recursion can therefore be evaluated in <bold>O</bold>(<italic>m</italic><sup>2</sup> + <italic>n</italic><sup>2</sup>) memory and <bold>O</bold>(<italic>n</italic><sup>2</sup>(<italic>n</italic><sup>2</sup> + <italic>m</italic><sup>2</sup>)) time.</p><p>From the matrices <italic>M</italic> and <italic>D,</italic> we can now compute the score of the best global alignment as well as the score of the best local alignment. In our study, we are only interested in the latter. Global alignment is only explained for better understanding and for comparison to the global alignment algorithm PMcomp. The score of the global alignment can be computed by evaluating the recursion for <italic>M</italic><sub>0<italic>j</italic>;0<italic>l</italic></sub>, i.e., the optimal global alignment score is <italic>M</italic><sub>0|<italic>A</italic>|;0|<italic>B</italic>|</sub>.</p><p>Recall that our main goal is to apply the procedure to the prediction of ncRNA detectors (e.g., such as RNAz) as generated by genome-wide screens. These detectors are not guaranteed to find the complete ncRNA genes and usually detect conserved substructures. Moreover, the predictions can be contaminated with spurious predictions in the flanking sequences. Hence, we need local sequence–structure alignment.</p><p>Concerning local alignment, in a Sankoff-style approach usually we compute a four-dimensional matrix of alignment scores for <italic>each</italic> pair of subsequences <italic>A</italic>[<italic>i…j</italic>] and <italic>B</italic>[<italic>k…l</italic>]. In this case, we could trivially obtain the best local alignment score by searching for the maximal score.</p><p>In our case, however, we cannot apply this simple method, since we do not compute entries for all possible pairs of subsequences. Rather, we compute only scores for subsequences that are closed by (significant) base pairs or prefixes of them. Those scores are either stored in <italic>D<sub>ij</sub></italic><sub>;<italic>kl</italic></sub> (in the case of closing a base pair match) or in <italic>M<sub>ij</sub></italic><sub>;<italic>kl</italic></sub>.</p><p>Instead, we will borrow, slightly tailored for our purpose, the trick of standard sequence alignment, which is to add an additional zero entry in the recursion for cutting off dissimilar prefix-alignments. Note that this assumes that the score parameters yield a score greater than zero only for similar subsequences. The best local alignment is then obtained as the maximal entry of the matrix.</p><p>However, note that we must not change the recursion equations for all <italic>M<sub>ij</sub></italic><sub>;<italic>kl</italic></sub>, which serve for computing some entry of <italic>D</italic>. Only for alignments of subsequences <italic>A</italic>[<italic>i…j</italic>] and <italic>B</italic>[<italic>k…l</italic>], where at least one of the subsequences is not enclosed by a (significant) base pair, is it correct to cut off dissimilar prefix-alignments. All these cases are accounted for when considering the alignments of all pairs of prefixes of <italic>A</italic> and <italic>B</italic>, which are stored in the <italic>M</italic><sub>0•;0•</sub> slice.</p><p>Therefore, we use for local alignment the following variant of <xref ref-type="disp-formula" rid="pcbi-0030065-e003">Equation 3</xref> that extends <xref ref-type="disp-formula" rid="pcbi-0030065-e003">Equation 3</xref> only for the slice <italic>M</italic><sub>0•;0•</sub>.
					<disp-formula id="pcbi-0030065-e004"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030065.e004" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo>;</mml:mo><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>&equals;</mml:mo><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="true">&lcub;</mml:mo><mml:mrow><mml:mtable columnalign='left'><mml:mtr columnalign='left'><mml:mtd columnalign='left'><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn><mml:mo>;</mml:mo><mml:mi>k</mml:mi><mml:mi>l</mml:mi><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&plus;</mml:mo><mml:mi>&sigma;</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo stretchy='false'>)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign='left'><mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign='left'><mml:mtd columnalign='left'><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn><mml:mo>;</mml:mo><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>&plus;</mml:mo><mml:mi>&gamma;</mml:mi></mml:mrow></mml:mtd><mml:mtd columnalign='left'><mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign='left'><mml:mtd columnalign='left'><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo>;</mml:mo><mml:mi>k</mml:mi><mml:mi>l</mml:mi><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&plus;</mml:mo><mml:mi>&gamma;</mml:mi></mml:mrow></mml:mtd><mml:mtd columnalign='left'><mml:mrow><mml:mtext>for</mml:mtext><mml:mspace width="3pt"/><mml:mi>i</mml:mi><mml:mspace width="3pt"/><mml:mo>&gt;</mml:mo><mml:mspace width="3pt"/><mml:mn>0</mml:mn><mml:mspace width="3pt"/><mml:mtext>or</mml:mtext><mml:mspace width="3pt"/><mml:mi>j</mml:mi><mml:mspace width="3pt"/><mml:mo>&gt;</mml:mo><mml:mspace width="3pt"/><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign='left'><mml:mtd columnalign='left'><mml:mrow><mml:munder><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:mo>&prime;</mml:mo></mml:msup><mml:msup><mml:mi>l</mml:mi><mml:mo>&prime;</mml:mo></mml:msup></mml:mrow></mml:munder><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:msup><mml:mi>j</mml:mi><mml:mo>&prime;</mml:mo></mml:msup><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn><mml:mo>;</mml:mo><mml:mi>k</mml:mi><mml:msup><mml:mi>l</mml:mi><mml:mo>&prime;</mml:mo></mml:msup><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&plus;</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:mo>&prime;</mml:mo></mml:msup><mml:mi>j</mml:mi><mml:mo>;</mml:mo><mml:msup><mml:mi>l</mml:mi><mml:mo>&prime;</mml:mo></mml:msup><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign='left'><mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:math> --><!-- <mml:math display='block'><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>j</mml:mi><mml:mo>;</mml:mo><mml:mn>0</mml:mn><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>&equals;</mml:mo><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="true">&lcub;</mml:mo><mml:mrow><mml:mtable columnalign='left'><mml:mtr columnalign='left'><mml:mtd columnalign='left'><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr columnalign='left'><mml:mtd columnalign='left'><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>j</mml:mi><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn><mml:mo>;</mml:mo><mml:mn>0</mml:mn><mml:mi>l</mml:mi><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&plus;</mml:mo><mml:mi>&sigma;</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo stretchy='false'>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign='left'><mml:mtd columnalign='left'><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>j</mml:mi><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn><mml:mo>;</mml:mo><mml:mn>0</mml:mn><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>&plus;</mml:mo><mml:mi>&gamma;</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign='left'><mml:mtd columnalign='left'><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>j</mml:mi><mml:mo>;</mml:mo><mml:mn>0</mml:mn><mml:mi>l</mml:mi><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&plus;</mml:mo><mml:mi>&gamma;</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign='left'><mml:mtd columnalign='left'><mml:mrow><mml:munder><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:mo>&prime;</mml:mo></mml:msup><mml:msup><mml:mi>l</mml:mi><mml:mo>&prime;</mml:mo></mml:msup></mml:mrow></mml:munder><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:msup><mml:mi>j</mml:mi><mml:mo>&prime;</mml:mo></mml:msup><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn><mml:mo>;</mml:mo><mml:mn>0</mml:mn><mml:msup><mml:mi>l</mml:mi><mml:mo>&prime;</mml:mo></mml:msup><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&plus;</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:mo>&prime;</mml:mo></mml:msup><mml:mi>j</mml:mi><mml:mo>;</mml:mo><mml:msup><mml:mi>l</mml:mi><mml:mo>&prime;</mml:mo></mml:msup><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:math> --><!-- <mml:math display='block'><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo>;</mml:mo><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>&equals;</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn><mml:mo>;</mml:mo><mml:mi>k</mml:mi><mml:mi>l</mml:mi><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&plus;</mml:mo><mml:msubsup><mml:mi>&Psi;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>A</mml:mi></mml:msubsup><mml:mo>&plus;</mml:mo><mml:msubsup><mml:mi>&Psi;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mi>B</mml:mi></mml:msubsup></mml:mrow></mml:math> --></disp-formula>
				</p><p>Note that the entries <italic>M</italic><sub>0<italic>j</italic>;0<italic>l</italic></sub> will not be needed to compute any entry <italic>D<sub>i</sub></italic><sub>′<italic>j</italic>′;<italic>k</italic>′<italic>l</italic>′</sub>. By adding a 0-entry in the calculation of <italic>M</italic><sub>0<italic>j</italic>;0<italic>l</italic></sub>, we ensure that entries in <italic>M</italic><sub>0•;0•</sub> are nonnegative. Since negative scores are considered dissimilar, we thereby remove prefix-alignments that do not belong to the local alignment. The optimal local alignment score is then max<italic><sub>jl</sub></italic>(<italic>M</italic><sub>0<italic>j</italic>;0<italic>l</italic></sub>).</p><p>The corresponding optimal alignment and consensus secondary structure can now be obtained by backtracing, i.e., for local alignment we start from the maximal entry in <italic>M</italic><sub>0<italic>j</italic>;0<italic>l</italic></sub> and stop when similarity drops to its minimal value of zero. In addition, for every pair (<italic>i j</italic>;<italic>k l</italic>) in the consensus structure we have to recompute the <italic>M<sub>i</sub></italic><sub>•;<italic>k</italic>•</sub> at a cost of <bold>O</bold>(<italic>n</italic><sup>2</sup>+<italic>m</italic><sup>2</sup>). Since there are at most <bold>O</bold>(<italic>n</italic>) pairs in the consensus structure, the cost of backtracing stays negligible.</p><p>LocARNA is implemented in C++, which results in a further performance gain relative to the Perl implementation of PMcomp. While it fully exploits speed and memory reductions that can be obtained by limiting possible consensus structures, additional performance gains are possible by restricting the possible sequence alignments. This is done, e.g., in stemloc [<xref ref-type="bibr" rid="pcbi-0030065-b030">30</xref>] by using “alignment envelops”. A similar but more easily implemented technique is used by CONSAN [<xref ref-type="bibr" rid="pcbi-0030065-b031">31</xref>], where high confidence matches (“pins”) are derived from local sequence alignments. The algorithm then considers only alignments that contain all pins.</p></sec><sec id="s2b1"><title>Local Multiple Sequence–Structure Alignments</title><p>Based on the pairwise LocARNA algorithm, we construct a progressive multiple alignment method, mLocARNA, which is similar in spirit to PMmulti, the PMcomp-derived multiple alignment tool [<xref ref-type="bibr" rid="pcbi-0030065-b021">21</xref>]. mLocARNA differs from PMmulti in the algorithm for computing the consensus base pairing probability matrix <italic>P<sup>A∘B</sup></italic> for the combined alignment of <italic>A</italic> and <italic>B</italic> from the base pairing probability matrices of the subalignments (or sequences) <italic>A</italic> and <italic>B</italic>. For a pair of columns <italic>p, q</italic> in the alignment of <italic>A</italic> and <italic>B</italic>, PMcomp defines the combined base pair weight by
					<disp-formula id="pcbi-0030065-e005"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030065.e005" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>&compfn;</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msubsup><mml:mo>&equals;</mml:mo><mml:mrow><mml:mo stretchy="true">&lcub;</mml:mo><mml:mrow><mml:mtable columnalign='left'><mml:mtr columnalign='left'><mml:mtd columnalign='left'><mml:mrow><mml:msqrt><mml:mrow><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:msub><mml:mi>i</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:mrow><mml:mi>A</mml:mi></mml:msubsup><mml:mo>&times;</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:msub><mml:mi>k</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:mrow><mml:mi>B</mml:mi></mml:msubsup></mml:mrow></mml:msqrt></mml:mrow></mml:mtd><mml:mtd columnalign='left'><mml:mrow><mml:malignmark/><mml:mtext>for a match</mml:mtext><mml:mtext>&thinsp;</mml:mtext><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mtext>&thinsp;</mml:mtext><mml:mi>q</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign='left'><mml:mtd columnalign='left'><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign='left'><mml:mrow><mml:mtext>otherwise</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:malignmark/></mml:mrow></mml:mrow></mml:mrow></mml:math> --></disp-formula>where <italic>i<sub>p</sub></italic> and <italic>i<sub>q</sub></italic> are the positions corresponding to <italic>p</italic> and <italic>q</italic> in the subalignment <italic>A,</italic> respectively. <italic>k<sub>p</sub></italic> and <italic>k<sub>q</sub></italic> are defined analogously for subalignment <italic>B</italic>. This has the effect that whenever one subalignment contains a gap at <italic>p</italic> or <italic>q</italic> or has a very low base pair probability, then the structural information between <italic>p</italic> and <italic>q</italic> from the other subalignment is effectively lost. In consequence, PMmulti tends to remove most base pairs when aligning many sequences.
				</p><p>To avoid this undesired effect, we introduce the new definition
					<disp-formula id="pcbi-0030065-e006"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030065.e006" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>&compfn;</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msubsup><mml:mo>&equals;</mml:mo><mml:msqrt><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent='true'><mml:mi>P</mml:mi><mml:mo stretchy='true'>&macr;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>q</mml:mi></mml:mrow><mml:mi>A</mml:mi></mml:msubsup><mml:mo>&times;</mml:mo><mml:msubsup><mml:mrow><mml:mover accent='true'><mml:mi>P</mml:mi><mml:mo stretchy='true'>&macr;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>q</mml:mi></mml:mrow><mml:mi>B</mml:mi></mml:msubsup></mml:mrow></mml:msqrt><mml:mo>,</mml:mo></mml:mrow></mml:math> --></disp-formula>where
					<disp-formula id="pcbi-0030065-eq002"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030065.eq002" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent='true'><mml:mi>P</mml:mi><mml:mo stretchy='true'>&macr;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>q</mml:mi></mml:mrow><mml:mi>A</mml:mi></mml:msubsup><mml:mo>&equals;</mml:mo><mml:mrow><mml:mo stretchy="true">&lcub;</mml:mo><mml:mrow><mml:mtable columnalign='left'><mml:mtr columnalign='left'><mml:mtd columnalign='left'><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:msub><mml:mi>i</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:mrow><mml:mi>A</mml:mi></mml:msubsup><mml:mo stretchy='false'>)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign='left'><mml:mrow><mml:mtext>for a match</mml:mtext><mml:mspace width="3pt"/><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign='left'><mml:mtd columnalign='left'><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign='left'><mml:mrow><mml:mtext>otherwise</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:malignmark/><mml:malignmark/></mml:mrow></mml:mrow></mml:mrow></mml:math> --></disp-formula>and <inline-formula id="pcbi-0030065-ex005"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0030065.ex005" xlink:type="simple"/></inline-formula>
					 is defined analogously.
				</p><p>As usual, the order of pairwise alignments is directed by a guide tree. We use for that purpose the sub-trees produced by the hierarchical clustering.</p></sec></sec><sec id="s3"><title>Results</title><sec id="s3a"><title>Evaluation of the Clustering Procedure</title><p>To evaluate the quality of our clustering approach, we have applied our procedure to the sequences in the RFAM seed alignments. Our test set consists of all seed sequences that have no more than 80% sequence identity and do not exceed 400 nt in length, resulting in 3,901 sequences from 503 families. Normally, quality measures such as sensitivity and specificity are defined for binary classification problems, while here we face the problem of comparing our hierarchical clustering with the family assignment in RFAM. In principle, there are two ways of looking at the problem, namely globally (considering the complete set of clusters), and locally (considering the quality for each family separately).</p><p>Concerning the global view, the complete RFAM defines a partition of the set of all sequences into families (or clusters), and we can compare the degree of agreement between the partition defined by our clustering with the partition defined by RFAM. Since we have a hierarchical clustering, different sets of clusters can be defined by cutting the tree at different thresholds ϑ, and we have to compare all these thresholds to find the set of clusters with the best agreement. The problem of comparing the partition defined by a given set of clusters (generated by cutting the tree at some specific level) with the partition defined by RFAM is now transformed into a classification problem as follows. We consider all possible pairs of sequences, and define the number of true positives (ss) as the number of sequence pairs from the same family that lie in the same cluster. Analogously, the number of false positives, false negatives, and true negatives are given by the number of pairs from different families but same cluster (ds), same family but different clusters (sd), and different families and different clusters (dd), respectively. Sensitivity and specificity are then defined as usual, namely <italic>spec</italic> = <italic>dd</italic>/(<italic>dd</italic> + <italic>ds</italic>) and <italic>sens</italic> = <italic>ss</italic>/(<italic>ss</italic> + <italic>sd</italic>). The receiver operating characteristic (ROC), obtained by plotting the sensitivity against the false positive rate (1-specificity) for different values of the cutoff ϑ, is shown in <xref ref-type="fig" rid="pcbi-0030065-g001">Figure 1</xref>.</p><fig id="pcbi-0030065-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030065.g001</object-id><label>Figure 1</label><caption><title>ROC Curve of the Global Comparison of Clustering and RFAM Families</title><p>At a false positive rate of 12%, we achieve a sensitivity of 52% (correctly grouping together sequences of the same family), which is more than sufficient to detect families.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030065.g001" xlink:type="simple"/></fig><p>A problem in the comparison with RFAM families is that different families exhibit very different diversity: some families consist only of closely related sequences while others accommodate significant variation in sequence and structure. Therefore, one should not expect that the RFAM family division can be modeled by using one fixed threshold ϑ for all families. We therefore consider a local, family-wise, criterion for the clustering quality. For a given RFAM family <italic>R</italic> and a cluster <italic>C,</italic> we define the recall <italic>r</italic>(<italic>R</italic>,<italic>C</italic>) as the fraction of members from <italic>R</italic> contained in <italic>C</italic>, i.e., <italic>r</italic>(<italic>R</italic>,<italic>C</italic>) = |<italic>R</italic>∩<italic>C</italic>|/|<italic>R</italic>|. For each family and a given minimum recall 0.5 &lt; <italic>r</italic> ≤ 1, we can always determine the minimal threshold ϑ such that there is a unique cluster <italic>C</italic> with <italic>r</italic>(<italic>R</italic>,<italic>C</italic>) ≥ <italic>r</italic>. A measure of how well the clustering reconstructs the family <italic>R</italic> is then the associated precision <italic>p</italic>(<italic>R</italic>,<italic>C</italic>) = |<italic>R</italic>∩<italic>C</italic>|/|<italic>C</italic>|. An equal assessment of precision and recall is given with the F-measure:
					<disp-formula id="pcbi-0030065-eq003"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030065.eq003" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mn>0.5</mml:mn></mml:mrow></mml:msub><mml:mo stretchy='false'>(</mml:mo><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>&equals;</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>r</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy='false'>)</mml:mo></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>&plus;</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy='false'>)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math> --></disp-formula>
				</p><p>Averages are weighted by family size. Families that are only represented by one sequence do not contribute to the average as their precision is always 1.</p><p><xref ref-type="table" rid="pcbi-0030065-t001">Table 1</xref> shows the average precision and F-measure weighted by family size for different minimum recall levels between 0.5 and 0.95. If we require that least 70% of a family (= minimal recall level) are grouped within the same cluster level, we get in fact on average a recall of 80%. In this case, we observe on average 32% false positive sequences within this cluster. Of course, we have much better values for some families such as 5S rRNA, where we have a precision of 100% at a recall level of 95%. The results also show that we are able to correctly cluster larger RNAs as well. For the members of the SSU_rRNA_5 family (accession code RF00177) included in our test set (recall that we have restricted the length to at most 400), 72.46% of them were clustered together in one single, pure cluster containing no other sequences. The sequences in this cluster have an average identity of 56.31%, and an average sequence length of 257. The complete RFAM tree constructed with our method is given in <xref ref-type="supplementary-material" rid="pcbi-0030065-sd001">File Collection S1</xref>.</p><table-wrap content-type="1col" id="pcbi-0030065-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030065.t001</object-id><label>Table 1</label><caption><p>Average Precision and F-Measure for Different Minimum Recall Levels</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030065.t001" xlink:type="simple"/><!-- <table frame="hsides" rules="none"><colgroup><col id="tb1col1" align="left" charoff="0" char=""/><col id="tb1col2" align="left" charoff="0" char=""/><col id="tb1col3" align="left" charoff="0" char=""/><col id="tb1col4" align="left" charoff="0" char=""/></colgroup><thead><tr><td align="left"><hr/>Minimum Recall Level</td><td><hr/>Average Recall</td><td><hr/>Average Precision</td><td><hr/>Average F-Measure</td></tr></thead><tbody><tr><td>0.50</td><td>0.5818</td><td>0.8280</td><td>0.6079</td></tr><tr><td>0.55</td><td>0.6996</td><td>0.7819</td><td>0.6475</td></tr><tr><td>0.60</td><td>0.7277</td><td>0.7530</td><td>0.6391</td></tr><tr><td>0.65</td><td>0.7596</td><td>0.7117</td><td>0.6191</td></tr><tr><td>0.70</td><td>0.8092</td><td>0.6831</td><td>0.6158</td></tr><tr><td>0.75</td><td>0.8519</td><td>0.5949</td><td>0.5650</td></tr><tr><td>0.80</td><td>0.8763</td><td>0.5701</td><td>0.5526</td></tr><tr><td>0.85</td><td>0.9381</td><td>0.4794</td><td>0.4964</td></tr><tr><td>0.90</td><td>0.9599</td><td>0.4419</td><td>0.4647</td></tr><tr><td>0.95</td><td>0.9766</td><td>0.3907</td><td>0.4173</td></tr></tbody></table> --><!-- --></table-wrap><p>Concerning the formation of classes comprising several families, this mainly makes sense for classes such as tRNAs and miRNAs which have a similar structure, but, for example, not for ribosomal RNAs where there are four structurally different families. The best classification is observed for the class of all tRNAs. They still have a precision of 96% at a recall level of 95%. Concerning the class of all miRNAs, they are (not surprisingly) grouped in several separate clusters. However, we have a large cluster comprising 85% of all 213 miRNAs and only 18% false positive sequences.</p></sec><sec id="s3b"><title>Clustering of ncRNA Candidates in Gammaproteobacteria</title><p>An RNAz screen of six related gammaproteobacteria resulted in an ncRNA candidate set of 123 unique loci of the reference organism <named-content content-type="genus-species" xlink:type="simple">Escherichia coli</named-content>. The screen follows the same pipeline as in [<xref ref-type="bibr" rid="pcbi-0030065-b014">14</xref>,<xref ref-type="bibr" rid="pcbi-0030065-b015">15</xref>] but includes a new approach to build multiple alignments. Only alignments with homolog sequences of at least three genomes, with maximal pairwise blast e-values of 1e-10 and a minimal length of 40 nt were retained for input to the RNAz pipeline.</p><p>That the majority of ncRNA candidates could be annotated with known <named-content content-type="genus-species" xlink:type="simple">E. coli</named-content> ncRNAs (labeled with <italic>EC</italic>[...] in <xref ref-type="fig" rid="pcbi-0030065-g002">Figure 2</xref>) is not surprising, as the screen was set up with a restrictive e-value for the initial blast search. Further, only candidates with homologs in at least three gammaproteobacteria genomes are reported. This provides us with a second ncRNA candidate set to validate the clustering approach, which in contrast to the RFAM seed sequences in the earlier section, Evaluation of the Clustering Procedure, was detected by RNAz. A candidate was annotated to be a known <named-content content-type="genus-species" xlink:type="simple">E. coli</named-content> ncRNA if their genomic regions overlap to at least 70%. If such an annotation was not available, a blast search against the RFAM database (<italic>E</italic> &lt; 1e-6) identified further homolog ncRNAs.</p><fig id="pcbi-0030065-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030065.g002</object-id><label>Figure 2</label><caption><title>Complete WPGMA Clustering Tree for ncRNA Candidates in Gammaproteobacteria <named-content content-type="genus-species" xlink:type="simple">E. coli</named-content></title><p>Candidates are annotated with known <named-content content-type="genus-species" xlink:type="simple">E. coli</named-content> ncRNAs (<italic>EC</italic>[...]), or if such do not exist, then with ncRNAs from the RFAM database (<italic>RF</italic>[...]). The colored boxes correspond to different substructures of 16S as found by the RNAz screen. See <xref ref-type="fig" rid="pcbi-0030065-g003">Figure 3</xref> for the location of these substructures. The situation is the same for 23S (see <xref ref-type="supplementary-material" rid="pcbi-0030065-sd001">File Collection S1</xref>).</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030065.g002" xlink:type="simple"/></fig><fig id="pcbi-0030065-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030065.g003</object-id><label>Figure 3</label><caption><title>Locations of RNAz Predictions for 16S rRNA</title><p>The dark blue box is the annotated 16S rRNA. The other boxes denote the RNAz predictions. Boxes with the same color are clustered together by our clustering procedure (see <xref ref-type="fig" rid="pcbi-0030065-g002">Figure 2</xref>). This shows that we correctly cluster the corresponding substructures.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030065.g003" xlink:type="simple"/></fig><p>In <xref ref-type="fig" rid="pcbi-0030065-g002">Figure 2</xref>, the complete WPGMA tree is depicted. It is nicely seen that again tRNAs get grouped in one separate cluster. Even tRNAs coding for the same amino acid are mostly found within the same subclusters.</p><p>At first glance, the distribution of rRNAs in <xref ref-type="fig" rid="pcbi-0030065-g002">Figure 2</xref> is disappointing. Different families of rRNAs appear in several separate clusters; however, RNAz predictions for 16S and 23S do not fall into a single cluster. This distribution results from a shortcoming of the RNAz input screen rather than from a weakness of the clustering method. Since RNAz scores alignments in relatively short slices, large structured RNAs are in general not detected as a single contiguous locus. Rather, several substructures are recognized for both 16S and 23S RNAs, which to a certain extent depend on the exact location of sequence windows that are used for the RNAz scoring. As demonstrated in <xref ref-type="fig" rid="pcbi-0030065-g003">Figure 3</xref> and in detail in <xref ref-type="supplementary-material" rid="pcbi-0030065-sd001">File Collection S1</xref>, corresponding substructures (including features up to 800 nt in length) from the different rRNA loci in the <named-content content-type="genus-species" xlink:type="simple">E. coli</named-content> genome are correctly clustered together.</p></sec><sec id="s3c"><title>Clustering of ncRNA Candidates in <named-content content-type="genus-species" xlink:type="simple">C. intestinalis</named-content></title><p>The dataset resulting from the RNAz-based survey for conserved ncRNAs in the genomes of the ascidians <named-content content-type="genus-species" xlink:type="simple">C. intestinalis</named-content> and <named-content content-type="genus-species" xlink:type="simple">C. savignyi</named-content> [<xref ref-type="bibr" rid="pcbi-0030065-b014">14</xref>] consists of 3,332 predicted structured RNAs, of which only about 500 could be annotated as members of well-known RNA families. The overwhelming majority of the known RNAs are the 301 tRNAs recognized by RNAz. <xref ref-type="fig" rid="pcbi-0030065-g004">Figure 4</xref> summarizes the results of the clustering procedure.</p><fig id="pcbi-0030065-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030065.g004</object-id><label>Figure 4</label><caption><title>Summary of the Clustering Procedure</title><p>The WPGMA tree contains 3,332 putative ncRNAs. A few large, prominent clusters are indicated. Among them are tRNAs and U3 snRNA, and an miRNA cluster, <xref ref-type="fig" rid="pcbi-0030065-g005">Figure 5</xref>, which contains the known miRNAs <italic>mir-124-a/b</italic> and <italic>let-7</italic> as well as candidates for <italic>mir-126</italic> and <italic>mir-7</italic>. Clusters 1384 in <xref ref-type="fig" rid="pcbi-0030065-g006">Figure 6</xref> and 249 in <xref ref-type="fig" rid="pcbi-0030065-g007">Figure 7</xref> are good candidates for novel ncRNA classes. sc01 and sc03 are both example clusters based on high sequence similarity.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030065.g004" xlink:type="simple"/></fig><fig id="pcbi-0030065-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030065.g005</object-id><label>Figure 5</label><caption><title>Cluster Containing Known and Predicted <named-content content-type="genus-species" xlink:type="simple">C. intestinalis</named-content> microRNAs</title><p>The two known <italic>mir-124</italic> paralogs are members of subcluster 127, whereas the known <italic>let-7</italic> is found in subcluster 139. Sequence ci_555813 in subcluster 152 contains a <italic>mir-126</italic> candidate (UCGUACCGUGAGUAAUAAAGC) and ci_555312 in subcluster 127 a <italic>mir-7</italic> candidate (UGGAAGACUAGUGAUUUUGUUGU). Forty of the 58 cluster members (marked with ***) are classified as putative microRNAs by RNAmicro [<xref ref-type="bibr" rid="pcbi-0030065-b037">37</xref>]. The fourth known microRNA in urochordates, <italic>mir-92,</italic> does not fall into this structural cluster. Members of the cluster are not sequence related (NeighborNet in the bottom right corner). N, number of sequences in cluster.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030065.g005" xlink:type="simple"/></fig><fig id="pcbi-0030065-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030065.g006</object-id><label>Figure 6</label><caption><title>Cluster 1384 Groups Sequences with a Well-Conserved Secondary Structure Consisting of Three Stem Loops</title><p>Whereas the sequence identity is low, we observe a high structural conservation. N, number of sequences in cluster.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030065.g006" xlink:type="simple"/></fig><fig id="pcbi-0030065-g007" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030065.g007</object-id><label>Figure 7</label><caption><title>Example of Structure-Based Clustering of Very Diverse Sequences Which Might Form a Novel ncRNA Class</title><p>The consensus structure models thus show a large number of compensatory mutations. N, number of sequences in cluster.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030065.g007" xlink:type="simple"/></fig><p>At first glance, the result might look disappointing as we find a large number of predictions that do not belong to any tight cluster. This is not surprising, however, given that we expect a very high noise level in this dataset. (1) The RNAz screen has an estimated false discovery rate of about 18%. (2) No attempts have been made to correct the fairly unreliable strand prediction of RNAz, which has an error rate up to 30% [<xref ref-type="bibr" rid="pcbi-0030065-b032">32</xref>]. (3) We can expect that a significant fraction of structured elements have been predicted only partially. (4) Thermodynamic consensus structure predictions based on only pairwise alignments are far from perfect [<xref ref-type="bibr" rid="pcbi-0030065-b019">19</xref>,<xref ref-type="bibr" rid="pcbi-0030065-b033">33</xref>]. It is thus not surprising that only a fraction of the input data can be assigned to meaningful clusters.</p><p>As expected, the largest and most prominent cluster comprises tRNAs. As discussed in some detail in [<xref ref-type="bibr" rid="pcbi-0030065-b034">34</xref>], this tRNA cluster is composed of subclusters corresponding to homologous tRNAs with common anticodons. Several other well-known multigene families are easily identifiable as structural clusters, including the U5 snRNAs, U3 snRNAs, and 5S rRNAs. Several families of multicopy genes with common secondary structure are present in the <italic>Ciona</italic> genomes [<xref ref-type="bibr" rid="pcbi-0030065-b034">34</xref>]. Most of them are also readily identifiable in the structural cluster tree. Since these subclusters are already easily detectable on the sequence level, they are of little interest for the structured-based approach pursued here.</p><p>A more interesting example is a cluster, <xref ref-type="fig" rid="pcbi-0030065-g005">Figure 5</xref>, that contains two paralogs of <italic>mir-124</italic> and one copy of <italic>let-7</italic> microRNAs that were previously described in computational screens of <named-content content-type="genus-species" xlink:type="simple">C. intestinalis</named-content> [<xref ref-type="bibr" rid="pcbi-0030065-b035">35</xref>,<xref ref-type="bibr" rid="pcbi-0030065-b036">36</xref>], as well as good candidates for <italic>mir-126</italic> and <italic>mir-7</italic>. The other members of the cluster have no sequence similarity with known microRNA families compiled in miRBase release 9.0 (blast <italic>E</italic> ≤ 0.001). Both <italic>mir-124</italic> candidates occur within introns of known mRNAs of <named-content content-type="genus-species" xlink:type="simple">C. intestinalis</named-content> (JGI2.0), while <italic>mir-126</italic> and <italic>mir-7</italic> do not seem to be located in an intron. That a large cluster of known and putative miRNAs was detected demonstrates that annotation of ncRNA candidates is highly improved by structure-based clustering. The majority of cluster members could not be identified as miRNA candidates by sequence comparison alone [<xref ref-type="bibr" rid="pcbi-0030065-b014">14</xref>]. Further, a comprehensive comparative screen for miRNAs across the metazoan species identified only a few homologs with high sequence similarity within the urochordates [<xref ref-type="bibr" rid="pcbi-0030065-b036">36</xref>], raising the question if there may exist a group of yet unknown miRNA families within the urochordates.</p><p><xref ref-type="fig" rid="pcbi-0030065-g006">Figures 6</xref> and <xref ref-type="fig" rid="pcbi-0030065-g007">7</xref> highlight two novel clusters of structurally similar predictions for which no functional or class assignment is available. The neighbor-net graphs in the insets show the sequence distance within the example cluster. Since the sequence distance is on average larger than 0.5, this confirms that the clusters are defined essentially based on structural similarities. While our examples usually contain some subsets of related sequences, overall there is little or no detectable sequence conservation so that the clusters could not have been detected by sequence similarity alone. Since many ncRNAs, in particular snRNAs, tend to form multigene families (often evolving under some form of concerted evolution that keeps the family members nearly identical), a moderate copy number in the genome can be interpreted as supporting the hypothesis that the candidate is indeed a true ncRNA.</p><p>In cluster 1384, <xref ref-type="fig" rid="pcbi-0030065-g006">Figure 6</xref>, for example, sequences with a well-conserved secondary structure but low sequence similarity are grouped. Nine of 11 sequences of cluster 1384 could be exactly mapped to the new <named-content content-type="genus-species" xlink:type="simple">C. intestinalis</named-content> assembly JGI2.0. The structural cluster contains three subclusters, 1378, 1381, and 1383, that have overall structural features in common. All subclusters have three stem loops originating from one single multiloop as consensus structure. But their length and number of internal loops differ. Their grouping into the superclusters 1382 and 1384 are justified by compensatory mutations. Two sequences of subcluster 1378 and one of subcluster 1381 appear within an intron of <italic>Ciona</italic>-mRNA AK113484. Whereas the two sequences of subcluster 1378 appear within the same copy of mRNA AK113484 on chr01p, the sequence in subcluster 1381 occurs in a copy on chr04q. Six different genomic copies of AK113484 exist in JGI2.0, but none of the intronic regions where the ncRNA candidates are found are associated with repeats. This allows the conclusion that those ncRNA candidates are indeed functional ncRNAs as their sequences are highly diverged, whereas they share common structural features and appear within the same <italic>Ciona</italic>-mRNA. One sequence of subcluster 1383 occurs in an exon of the known protein coding <italic>Ciona</italic>-mRNA AK114007. All other elements are intergenic or at least the corresponding mRNAs are not yet known.</p><p>Cluster 1249 is also composed of highly divergent sequences but similar secondary structures. Two sequences of subcluster 1247 appear within an intron of the <italic>Ciona</italic>-mRNA AK174830. Subclusters 1238 and 1245 contain one sequence occurring in an intron of <italic>Ciona</italic>-mRNA AK222260 and AK116291, respectively.</p><p>Clusters 1384 and 1249 are good candidates for novel classes of urochordate-specific ncRNAs, since none of the sequences has detectable ncRNA homologs in vertebrates.</p></sec></sec><sec id="s4"><title>Discussion</title><p>Genome-wide studies, both experimental and computational, have uncovered tens of thousands of transcripts in higher Eukaryotes that have little or no protein-coding capacity. For a large subset of these, there is evidence for selection acting to preserve secondary-structure motifs. Many classes of functional RNAs, on the other hand, can be recognized based on structural similarities. It is thus natural to ask if the available data contain evidence for novel families and classes of structured RNAs, for which so far no representative has been well-characterized experimentally. To answer this question, it is necessary to cluster the candidate RNAs based on their structural features, a task that is computationally much harder than clustering based on sequence similarity.</p><p>We present here a new tool, LocARNA, which implements a novel, more efficient variant of the Sankoff algorithm. We have demonstrated that LocARNA is fast enough to make structure-based clustering of thousands of putative structured RNAs feasible. The main reason for its superior efficiency is due to the prefiltering of the base pairs by their probability, and an efficient computation scheme that is able to profit from the reduced number of base pairs considered. The method is also robust enough to find significant clusters in fairly noisy, realistic data that contain a substantial fraction of false positive predictions. We have successfully tested the tool on the sequences of the RFAM seed alignments.</p><p>The LocARNA implements a local sequence structure alignment method, which is required when applied to candidate ncRNA sequences where the exact region of interest is not exactly known (of course, the tool can also be applied to global alignment problems). Clearly, there is a length dependency in the scores, which has several sources, one being the calculation of pair probabilities. This influences both pairwise alignment and the clustering, which implies that the ncRNAs to be clustered should not diverge too much in length. This is the case in many applications like the clustering of predicted ncRNAs. A more precise treatment of the different kinds of dependencies (such as GC content) is planned for a future version.</p><p>Since perfect predictions and experimentally determined structures are not available, it is imperative to have a method that can identify clusters on <italic>imperfect</italic> structure prediction, although this also implies that we cannot hope for perfect pure clusters—some “contamination” and some sequences that fall elsewhere in the clustering are thus unavoidable. The ROC curve in <xref ref-type="fig" rid="pcbi-0030065-g001">Figure 1</xref> shows that LocARNA indeed achieves this goal.</p><p>The application of the tool to a dataset of more than 3,000 predicted structured RNAs in urochordates showed that the clustering approach not only recovers known RNA families and classes such as tRNAs, but also predicts several candidates for novel ncRNA classes. In some cases we find that additional sequences are identified as structural relatives of known RNA families. In this way we have identified, for example, a <italic>mir-126</italic> and a <italic>mir-7</italic> homolog that were not detected in previous computational studies. More importantly, however, we also find structure-based clusters that are candidates for novel, presumably urochordate-specific, RNA classes. We find that these clusters often contain subclusters consisting of multicopy sequences. Comparing this with the characteristics of several well-studied ncRNA families, in particular tRNAs, the snRNAs associated with the major spliceosome, and SL RNAs, lends further credibility to the hypothesis that these sequences indeed form a bona fide RNA class.</p></sec><sec id="s5"><title>Supporting Information</title><supplementary-material id="pcbi-0030065-sd001" mimetype="application/zip" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030065.sd001" xlink:type="simple"><label>File Collection S1</label><caption><title>Supplemental Material, Zip File of html Directory</title><p><ext-link ext-link-type="uri" xlink:href="http://www.bioinf.uni-freiburg.de/Supplements/locarna-06-12" xlink:type="simple">http://www.bioinf.uni-freiburg.de/Supplements/locarna-06-12</ext-link></p><p>(643 KB ZIP)</p></caption></supplementary-material><sec id="s5a"><title>Accession Numbers</title><p>Accession numbers starting with RF (e.g., RF00177) are taken from the RNA families database RFAM (<ext-link ext-link-type="uri" xlink:href="http://www.sanger.ac.uk/Software/Rfam/" xlink:type="simple">http://www.sanger.ac.uk/Software/Rfam/</ext-link>) and denote different RNA families. Accession numbers starting with AK (e.g., AK113484) describe <named-content content-type="genus-species" xlink:type="simple">Ciona intestinalis</named-content> mRNAs in the GenBank database (<ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?db=Nucleotide" xlink:type="simple">http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?db=Nucleotide</ext-link>).</p></sec></sec></body><back><ack><p>We thank Dominic Rose and Jana Hertel for the data of the RNAz screen of gammaproteobacteria. We also would like to thank the anonymous referees for many helpful comments.</p></ack><glossary><title>Abbreviations</title><def-list><def-item><term>LocARNA;</term><def><p>local alignment of RNA</p></def></def-item><def-item><term>MFE</term><def><p>minimum free energy</p></def></def-item><def-item><term>MPI</term><def><p>mean pairwise sequence identity</p></def></def-item><def-item><term>ncRNA</term><def><p>noncoding RNA</p></def></def-item><def-item><term>ROC</term><def><p>receiver operating characteristic</p></def></def-item><def-item><term>SCI</term><def><p>structure conservation index</p></def></def-item><def-item><term>WPGMA</term><def><p>weighted pair group method algorithm</p></def></def-item></def-list></glossary><ref-list><title>References</title><ref id="pcbi-0030065-b001"><label>1</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Lagos-Quintana</surname><given-names>M</given-names></name><name name-style="western"><surname>Rauhut</surname><given-names>R</given-names></name><name name-style="western"><surname>Lendeckel</surname><given-names>W</given-names></name><name name-style="western"><surname>Tuschl</surname><given-names>T</given-names></name></person-group>
					<year>2001</year>
					<article-title>Identification of novel genes coding for small expressed RNAs.</article-title>
					<source>Science</source>
					<volume>294</volume>
					<fpage>853</fpage>
					<lpage>857</lpage>
				</element-citation></ref><ref id="pcbi-0030065-b002"><label>2</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Lau</surname><given-names>NC</given-names></name><name name-style="western"><surname>Lim</surname><given-names>LP</given-names></name><name name-style="western"><surname>Weinstein</surname><given-names>EG</given-names></name><name name-style="western"><surname>Bartel</surname><given-names>DP</given-names></name></person-group>
					<year>2001</year>
					<article-title>An abundant class of tiny RNAs with probable regulatory roles in <named-content content-type="genus-species" xlink:type="simple">Caenorhabditis elegans</named-content>.</article-title>
					<source>Science</source>
					<volume>294</volume>
					<fpage>858</fpage>
					<lpage>862</lpage>
				</element-citation></ref><ref id="pcbi-0030065-b003"><label>3</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Lee</surname><given-names>R</given-names></name><name name-style="western"><surname>Ambros</surname><given-names>V</given-names></name></person-group>
					<year>2001</year>
					<article-title>An extensive class of small RNAs in <named-content content-type="genus-species" xlink:type="simple">Caenorhabditis elegans</named-content>.</article-title>
					<source>Science</source>
					<volume>294</volume>
					<fpage>862</fpage>
					<lpage>864</lpage>
				</element-citation></ref><ref id="pcbi-0030065-b004"><label>4</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Carninci</surname><given-names>P</given-names></name><name name-style="western"><surname>Kasukawa</surname><given-names>T</given-names></name><name name-style="western"><surname>Katayama</surname><given-names>S</given-names></name><name name-style="western"><surname>Gough</surname><given-names>J</given-names></name><name name-style="western"><surname>Frith</surname><given-names>M</given-names></name><etal/></person-group>
					<year>2005</year>
					<article-title>The transcriptional landscape of the mammalian genome.</article-title>
					<source>Science</source>
					<volume>309</volume>
					<fpage>1559</fpage>
					<lpage>1563</lpage>
				</element-citation></ref><ref id="pcbi-0030065-b005"><label>5</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Cheng</surname><given-names>J</given-names></name><name name-style="western"><surname>Kapranov</surname><given-names>P</given-names></name><name name-style="western"><surname>Drenkow</surname><given-names>J</given-names></name><name name-style="western"><surname>Dike</surname><given-names>S</given-names></name><name name-style="western"><surname>Brubaker</surname><given-names>S</given-names></name><etal/></person-group>
					<year>2005</year>
					<article-title>Transcriptional maps of 10 human chromosomes at 5-nucleotide resolution.</article-title>
					<source>Science</source>
					<volume>308</volume>
					<fpage>1149</fpage>
					<lpage>1154</lpage>
				</element-citation></ref><ref id="pcbi-0030065-b006"><label>6</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Bertone</surname><given-names>P</given-names></name><name name-style="western"><surname>Stoc</surname><given-names>V</given-names></name><name name-style="western"><surname>Royce</surname><given-names>TE</given-names></name><name name-style="western"><surname>Rozowsky</surname><given-names>JS</given-names></name><name name-style="western"><surname>Urban</surname><given-names>AE</given-names></name><etal/></person-group>
					<year>2004</year>
					<article-title>Global identification of human transcribed sequences with genome tiling arrays.</article-title>
					<source>Science</source>
					<volume>306</volume>
					<fpage>2242</fpage>
					<lpage>2246</lpage>
				</element-citation></ref><ref id="pcbi-0030065-b007"><label>7</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Rivas</surname><given-names>E</given-names></name><name name-style="western"><surname>Eddy</surname><given-names>SR</given-names></name></person-group>
					<year>2001</year>
					<article-title>Noncoding RNA gene detection using comparative sequence analysis.</article-title>
					<source>BMC Bioinformatics</source>
					<volume>2</volume>
					<fpage>8</fpage>
					<comment>epub.</comment>
				</element-citation></ref><ref id="pcbi-0030065-b008"><label>8</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Washietl</surname><given-names>S</given-names></name><name name-style="western"><surname>Hofacker</surname><given-names>IL</given-names></name></person-group>
					<year>2004</year>
					<article-title>Consensus folding of aligned sequences as a new measure for the detection of functional RNAs by comparative genomics.</article-title>
					<source>J Mol Biol</source>
					<volume>342</volume>
					<fpage>19</fpage>
					<lpage>39</lpage>
				</element-citation></ref><ref id="pcbi-0030065-b009"><label>9</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Washietl</surname><given-names>S</given-names></name><name name-style="western"><surname>Hofacker</surname><given-names>IL</given-names></name><name name-style="western"><surname>Stadler</surname><given-names>PF</given-names></name></person-group>
					<year>2005</year>
					<article-title>Fast and reliable prediction of noncoding RNAs.</article-title>
					<source>Proc Natl Acad Sci U S A</source>
					<volume>102</volume>
					<fpage>2454</fpage>
					<lpage>2459</lpage>
				</element-citation></ref><ref id="pcbi-0030065-b010"><label>10</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Pedersen</surname><given-names>JS</given-names></name><name name-style="western"><surname>Bejerano</surname><given-names>G</given-names></name><name name-style="western"><surname>Siepel</surname><given-names>A</given-names></name><name name-style="western"><surname>Rosenbloom</surname><given-names>K</given-names></name><name name-style="western"><surname>Lindblad-Toh</surname><given-names>K</given-names></name><etal/></person-group>
					<year>2006</year>
					<article-title>Classification of conserved RNA secondary structures in the human genome.</article-title>
					<source>PLoS Comput Biol</source>
					<volume>2</volume>
					<fpage>e33</fpage>
				</element-citation></ref><ref id="pcbi-0030065-b011"><label>11</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Torarinsson</surname><given-names>E</given-names></name><name name-style="western"><surname>Sawera</surname><given-names>M</given-names></name><name name-style="western"><surname>Havgaard</surname><given-names>JH</given-names></name><name name-style="western"><surname>Fredholm</surname><given-names>M</given-names></name><name name-style="western"><surname>Gorodkin</surname><given-names>J</given-names></name></person-group>
					<year>2006</year>
					<article-title>Thousands of corresponding human and mouse genomic regions unalignable in primary sequence contain common RNA structure.</article-title>
					<source>Genome Res</source>
					<volume>16</volume>
					<fpage>885</fpage>
					<lpage>889</lpage>
				</element-citation></ref><ref id="pcbi-0030065-b012"><label>12</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Uzilov</surname><given-names>AV</given-names></name><name name-style="western"><surname>Keegan</surname><given-names>JM</given-names></name><name name-style="western"><surname>Mathews</surname><given-names>DH</given-names></name></person-group>
					<year>2006</year>
					<article-title>Detection of non-coding RNAs on the basis of predicted secondary structure formation free energy change.</article-title>
					<source>BMC Bioinformatics</source>
					<volume>7</volume>
					<fpage>173</fpage>
					<comment>epub.</comment>
				</element-citation></ref><ref id="pcbi-0030065-b013"><label>13</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Washietl</surname><given-names>S</given-names></name><name name-style="western"><surname>Hofacker</surname><given-names>IL</given-names></name><name name-style="western"><surname>Lukasser</surname><given-names>M</given-names></name><name name-style="western"><surname>Hüttenhofer</surname><given-names>A</given-names></name><name name-style="western"><surname>Stadler</surname><given-names>PF</given-names></name></person-group>
					<year>2005</year>
					<article-title>Mapping of conserved RNA secondary structures predicts thousands of functional non-coding RNAs in the human genome.</article-title>
					<source>Nature Biotech</source>
					<volume>23</volume>
					<fpage>1383</fpage>
					<lpage>1390</lpage>
				</element-citation></ref><ref id="pcbi-0030065-b014"><label>14</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Missal</surname><given-names>K</given-names></name><name name-style="western"><surname>Rose</surname><given-names>D</given-names></name><name name-style="western"><surname>Stadler</surname><given-names>PF</given-names></name></person-group>
					<year>2005</year>
					<article-title>Non-coding RNAs in <named-content content-type="genus-species" xlink:type="simple">Ciona intestinalis</named-content>. Proceedings of the Fourth European Conference on Computational Biology/Jornadas de BioInformática; 28 September–1 October, 2005; Madrid, Spain.</article-title>
					<source>Bioinformatics</source>
					<volume>21</volume>
					<issue>Supplement 2</issue>
					<fpage>i77</fpage>
					<lpage>78</lpage>
				</element-citation></ref><ref id="pcbi-0030065-b015"><label>15</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Missal</surname><given-names>K</given-names></name><name name-style="western"><surname>Zhu</surname><given-names>X</given-names></name><name name-style="western"><surname>Rose</surname><given-names>D</given-names></name><name name-style="western"><surname>Deng</surname><given-names>W</given-names></name><name name-style="western"><surname>Skogerbø</surname><given-names>G</given-names></name><etal/></person-group>
					<year>2006</year>
					<article-title>Prediction of structured non-coding RNAs in the genome of the nematode <named-content content-type="genus-species" xlink:type="simple">Caenorhabitis elegans</named-content>.</article-title>
					<source>J Exp Zool B: Mol Dev Evol</source>
					<volume>306</volume>
					<fpage>379</fpage>
					<lpage>392</lpage>
				</element-citation></ref><ref id="pcbi-0030065-b016"><label>16</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Griffiths-Jones</surname><given-names>S</given-names></name><name name-style="western"><surname>Moxon</surname><given-names>S</given-names></name><name name-style="western"><surname>Marshall</surname><given-names>M</given-names></name><name name-style="western"><surname>Khanna</surname><given-names>A</given-names></name><name name-style="western"><surname>Eddy</surname><given-names>SR</given-names></name><etal/></person-group>
					<year>2005</year>
					<article-title>Rfam: Annotating non-coding RNAs in complete genomes.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>33</volume>
					<fpage>D121</fpage>
					<lpage>D124</lpage>
				</element-citation></ref><ref id="pcbi-0030065-b017"><label>17</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Griffiths-Jones</surname><given-names>S</given-names></name></person-group>
					<year>2004</year>
					<article-title>The microRNA Registry.</article-title>
					<source>Nucleics Acid Res</source>
					<volume>32</volume>
					<fpage>D109</fpage>
					<lpage>D111</lpage>
				</element-citation></ref><ref id="pcbi-0030065-b018"><label>18</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Eigen</surname><given-names>M</given-names></name><name name-style="western"><surname>Lindemann</surname><given-names>BF</given-names></name><name name-style="western"><surname>Tietze</surname><given-names>M</given-names></name><name name-style="western"><surname>Winkler-Oswatitsch</surname><given-names>R</given-names></name><name name-style="western"><surname>Dress</surname><given-names>AWM</given-names></name><etal/></person-group>
					<year>1989</year>
					<article-title>How old is the genetic code? Statistical geometry of tRNA provides an answer.</article-title>
					<source>Science</source>
					<volume>244</volume>
					<fpage>673</fpage>
					<lpage>679</lpage>
				</element-citation></ref><ref id="pcbi-0030065-b019"><label>19</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Gardner</surname><given-names>PP</given-names></name><name name-style="western"><surname>Wilm</surname><given-names>A</given-names></name><name name-style="western"><surname>Washietl</surname><given-names>S</given-names></name></person-group>
					<year>2005</year>
					<article-title>A benchmark of multiple sequence alignment programs upon structural RNAs.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>33</volume>
					<fpage>2433</fpage>
					<lpage>2439</lpage>
				</element-citation></ref><ref id="pcbi-0030065-b020"><label>20</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Siebert</surname><given-names>S</given-names></name><name name-style="western"><surname>Backofen</surname><given-names>R</given-names></name></person-group>
					<year>2005</year>
					<article-title>MARNA: Multiple alignment and consensus structure prediction of RNAs based on sequence structure comparisons.</article-title>
					<source>Bioinformatics</source>
					<volume>21</volume>
					<fpage>3352</fpage>
					<lpage>3359</lpage>
				</element-citation></ref><ref id="pcbi-0030065-b021"><label>21</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Hofacker</surname><given-names>IL</given-names></name><name name-style="western"><surname>Bernhart</surname><given-names>SHF</given-names></name><name name-style="western"><surname>Stadler</surname><given-names>PF</given-names></name></person-group>
					<year>2004</year>
					<article-title>Alignment of RNA base pairing probability matrices.</article-title>
					<source>Bioinformatics</source>
					<volume>20</volume>
					<fpage>2222</fpage>
					<lpage>2227</lpage>
				</element-citation></ref><ref id="pcbi-0030065-b022"><label>22</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Höchsmann</surname><given-names>M</given-names></name><name name-style="western"><surname>Voss</surname><given-names>B</given-names></name><name name-style="western"><surname>Giegerich</surname><given-names>R</given-names></name></person-group>
					<year>2004</year>
					<article-title>Pure multiple RNA secondary structure alignments: A progressive profile approach.</article-title>
					<source>IEEE/ACM Trans Comput Biol Bioinform</source>
					<volume>1</volume>
					<fpage>53</fpage>
					<lpage>62</lpage>
				</element-citation></ref><ref id="pcbi-0030065-b023"><label>23</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Backofen</surname><given-names>R</given-names></name><name name-style="western"><surname>Will</surname><given-names>S</given-names></name></person-group>
					<year>2004</year>
					<article-title>Local sequence–structure motifs in RNA.</article-title>
					<source>J Bioinformatics Comput Biol</source>
					<volume>2</volume>
					<fpage>681</fpage>
					<lpage>698</lpage>
				</element-citation></ref><ref id="pcbi-0030065-b024"><label>24</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Backofen</surname><given-names>R</given-names></name><name name-style="western"><surname>Siebert</surname><given-names>S</given-names></name></person-group>
					<year>2005</year>
					<article-title>Fast detection of common sequence structure patterns in RNAs.</article-title>
					<source>Lec Notes Comp Sci</source>
					<volume>3246</volume>
					<fpage>79</fpage>
					<lpage>92</lpage>
				</element-citation></ref><ref id="pcbi-0030065-b025"><label>25</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Sankoff</surname><given-names>D</given-names></name></person-group>
					<year>1985</year>
					<article-title>Simultaneous solution of the RNA folding, alignment, and proto-sequence problems.</article-title>
					<source>SIAM J Appl Math</source>
					<volume>45</volume>
					<fpage>810</fpage>
					<lpage>825</lpage>
				</element-citation></ref><ref id="pcbi-0030065-b026"><label>26</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Gorodkin</surname><given-names>J</given-names></name><name name-style="western"><surname>Heyer</surname><given-names>L</given-names></name><name name-style="western"><surname>Stormo</surname><given-names>G</given-names></name></person-group>
					<year>1997</year>
					<article-title>Finding common sequences and structure motifs in a set of RNA molecules.</article-title>
					<comment>In:</comment>
					<person-group person-group-type="editor"><name name-style="western"><surname>Gaasterland</surname><given-names>T</given-names></name><name name-style="western"><surname>Karp</surname><given-names>P</given-names></name><name name-style="western"><surname>Karplus</surname><given-names>K</given-names></name><name name-style="western"><surname>Ouzounis</surname><given-names>C</given-names></name><name name-style="western"><surname>Sander</surname><given-names>C</given-names></name><etal/></person-group>
					<source>Proceedings of the Sixth International Conference on Intelligent Systems for Molecular Biology</source>
					<conf-date>21–25 June, 1997;</conf-date>
					<conf-loc>Halkidiki, Greece.</conf-loc>
					<publisher-loc>Menlo Park (California)</publisher-loc>
					<publisher-name>AAAI Press</publisher-name>
					<fpage>120</fpage>
					<lpage>123</lpage>
				</element-citation></ref><ref id="pcbi-0030065-b027"><label>27</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Hull Havgaard</surname><given-names>JH</given-names></name><name name-style="western"><surname>Lyngsø</surname><given-names>R</given-names></name><name name-style="western"><surname>Stormo</surname><given-names>GD</given-names></name><name name-style="western"><surname>Gorodkin</surname><given-names>J</given-names></name></person-group>
					<year>2005</year>
					<article-title>Pairwise local structural alignment of RNA sequences with sequence similarity less than 40%.</article-title>
					<source>Bioinformatics</source>
					<volume>21</volume>
					<fpage>1815</fpage>
					<lpage>1824</lpage>
				</element-citation></ref><ref id="pcbi-0030065-b028"><label>28</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Mathews</surname><given-names>D</given-names></name><name name-style="western"><surname>Turner</surname><given-names>D</given-names></name></person-group>
					<year>2002</year>
					<article-title>Dynalign: An algorithm for finding the secondary structure common to two RNA sequences.</article-title>
					<source>J Mol Biol</source>
					<volume>317</volume>
					<fpage>191</fpage>
					<lpage>203</lpage>
				</element-citation></ref><ref id="pcbi-0030065-b029"><label>29</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>McCaskill</surname><given-names>JS</given-names></name></person-group>
					<year>1990</year>
					<article-title>The equilibrium partition function and base pair binding probabilities for RNA secondary structure.</article-title>
					<source>Biopolymers</source>
					<volume>29</volume>
					<fpage>1105</fpage>
					<lpage>1119</lpage>
				</element-citation></ref><ref id="pcbi-0030065-b030"><label>30</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Holmes</surname><given-names>I</given-names></name></person-group>
					<year>2005</year>
					<article-title>Accelerated probabilistic inference of RNA structure evolution.</article-title>
					<source>BMC Bioinformatics</source>
					<volume>6</volume>
					<fpage>73</fpage>
					<comment>epub.</comment>
				</element-citation></ref><ref id="pcbi-0030065-b031"><label>31</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Dowell</surname><given-names>R</given-names></name><name name-style="western"><surname>Eddy</surname><given-names>SR</given-names></name></person-group>
					<year>2006</year>
					<article-title>Efficient pairwise RNA structure prediction and alignment using sequence alignment constraints.</article-title>
					<source>BMC Bioinformatics</source>
					<volume>7</volume>
					<fpage>400</fpage>
					<comment>Available: <ext-link ext-link-type="uri" xlink:href="http://selab.janelia.org/" xlink:type="simple">http://selab.janelia.org/</ext-link>. Accessed 9 March 2007.</comment>
				</element-citation></ref><ref id="pcbi-0030065-b032"><label>32</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Missal</surname><given-names>K</given-names></name><name name-style="western"><surname>Stadler</surname><given-names>PF</given-names></name></person-group>
					<year>2007</year>
					<source>RNAstrand: Reading direction of structured RNAs in multiple sequence alignments</source>
					<comment>Available: <ext-link ext-link-type="uri" xlink:href="http://www.bioinf.uni-leipzig.de/Publications/PREPRINTS/06-006.pdf" xlink:type="simple">http://www.bioinf.uni-leipzig.de/Publications/PREPRINTS/06–006.pdf</ext-link>. Accessed 9 March 2007.</comment>
				</element-citation></ref><ref id="pcbi-0030065-b033"><label>33</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Hofacker</surname><given-names>IL</given-names></name><name name-style="western"><surname>Fekete</surname><given-names>M</given-names></name><name name-style="western"><surname>Stadler</surname><given-names>PF</given-names></name></person-group>
					<year>2002</year>
					<article-title>Secondary structure prediction for aligned RNA sequences.</article-title>
					<source>J Mol Biol</source>
					<volume>319</volume>
					<fpage>1059</fpage>
					<lpage>1066</lpage>
				</element-citation></ref><ref id="pcbi-0030065-b034"><label>34</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Athanasius</surname><given-names>F</given-names></name><collab xlink:type="simple">Bompfunewerer Consortium;</collab><name name-style="western"><surname>Backofen</surname><given-names>R</given-names></name><name name-style="western"><surname>Bernhart</surname><given-names>SH</given-names></name><name name-style="western"><surname>Flamm</surname><given-names>C</given-names></name><name name-style="western"><surname>Fried</surname><given-names>C</given-names></name><etal/></person-group>
					<year>2007</year>
					<article-title>RNAs everywhere: Genome-wide annotation of structured RNAs.</article-title>
					<source>J Exp Zool B: Mol Dev Evol</source>
					<volume>308</volume>
					<fpage>1</fpage>
					<lpage>25</lpage>
				</element-citation></ref><ref id="pcbi-0030065-b035"><label>35</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Legendre</surname><given-names>M</given-names></name><name name-style="western"><surname>Lambert</surname><given-names>A</given-names></name><name name-style="western"><surname>Gautheret</surname><given-names>D</given-names></name></person-group>
					<year>2005</year>
					<article-title>Profile-based detection of microRNA precursors in animal genomes.</article-title>
					<source>Bioinformatics</source>
					<volume>21</volume>
					<fpage>841</fpage>
					<lpage>845</lpage>
				</element-citation></ref><ref id="pcbi-0030065-b036"><label>36</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Hertel</surname><given-names>J</given-names></name><name name-style="western"><surname>Lindemeyer</surname><given-names>M</given-names></name><name name-style="western"><surname>Missal</surname><given-names>K</given-names></name><name name-style="western"><surname>Fried</surname><given-names>C</given-names></name><name name-style="western"><surname>Tanzer</surname><given-names>A</given-names></name><etal/></person-group>
					<year>2006</year>
					<article-title>The expansion of the metazoan microRNA repertoire.</article-title>
					<source>BMC Genomics</source>
					<volume>7</volume>
					<fpage>15</fpage>
					<comment>epub.</comment>
				</element-citation></ref><ref id="pcbi-0030065-b037"><label>37</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Hertel</surname><given-names>J</given-names></name><name name-style="western"><surname>Stadler</surname><given-names>PF</given-names></name></person-group>
					<year>2006</year>
					<article-title>Hairpins in a haystack: Recognizing microRNA precursors in comparative genomics data. In: Proceedings of the Fifteenth Conference on Intelligent Systems in Molecular Biology; 6–10 August, 2006; Fortaleza, Brazil.</article-title>
					<source>Bioinformatics</source>
					<volume>22</volume>
					<fpage>e197</fpage>
					<lpage>e202</lpage>
				</element-citation></ref></ref-list></back></article>