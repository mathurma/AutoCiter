<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-19-00273</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1006883</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Physics</subject><subj-group><subject>Classical mechanics</subject><subj-group><subject>Motion</subject><subj-group><subject>Torque</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Biological tissue</subject><subj-group><subject>Connective tissue</subject><subj-group><subject>Tendons</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Biological tissue</subject><subj-group><subject>Connective tissue</subject><subj-group><subject>Tendons</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Organisms</subject><subj-group><subject>Eukaryota</subject><subj-group><subject>Animals</subject><subj-group><subject>Vertebrates</subject><subj-group><subject>Fish</subject><subj-group><subject>Osteichthyes</subject><subj-group><subject>Eels</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Organisms</subject><subj-group><subject>Eukaryota</subject><subj-group><subject>Animals</subject><subj-group><subject>Vertebrates</subject><subj-group><subject>Fish</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Biological locomotion</subject><subj-group><subject>Swimming</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Biological locomotion</subject><subj-group><subject>Swimming</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Bioassays and physiological analysis</subject><subj-group><subject>Electrophysiological techniques</subject><subj-group><subject>Muscle electrophysiology</subject><subj-group><subject>Electromyography</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Physics</subject><subj-group><subject>Classical mechanics</subject><subj-group><subject>Kinematics</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Physics</subject><subj-group><subject>Classical mechanics</subject><subj-group><subject>Continuum mechanics</subject><subj-group><subject>Fluid mechanics</subject><subj-group><subject>Fluid dynamics</subject><subj-group><subject>Hydrodynamics</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>3D computational models explain muscle activation patterns and energetic functions of internal structures in fish swimming</article-title>
<alt-title alt-title-type="running-head">3D computational models explain muscle activation patterns</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" equal-contrib="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-7975-5008</contrib-id>
<name name-style="western">
<surname>Ming</surname> <given-names>Tingyu</given-names></name>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" equal-contrib="yes" xlink:type="simple">
<name name-style="western">
<surname>Jin</surname> <given-names>Bowen</given-names></name>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Song</surname> <given-names>Jialei</given-names></name>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Luo</surname> <given-names>Haoxiang</given-names></name>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Du</surname> <given-names>Ruxu</given-names></name>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-8252-2421</contrib-id>
<name name-style="western">
<surname>Ding</surname> <given-names>Yang</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Beijing Computational Science Research Center, Haidian District, Beijing, China</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Department of Mechanical and Automation Engineering, Chinese University of Hong Kong, Hong Kong SAR, China</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>Department of Mechanical Engineering, Vanderbilt University, Nashville, Tennessee, United States of America</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Lauga</surname> <given-names>Eric</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>University of Cambridge, UNITED KINGDOM</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">dingyang@csrc.ac.cn</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>9</month>
<year>2019</year>
</pub-date>
<pub-date pub-type="epub">
<day>5</day>
<month>9</month>
<year>2019</year>
</pub-date>
<volume>15</volume>
<issue>9</issue>
<elocation-id>e1006883</elocation-id>
<history>
<date date-type="received">
<day>18</day>
<month>2</month>
<year>2019</year>
</date>
<date date-type="accepted">
<day>22</day>
<month>7</month>
<year>2019</year>
</date>
</history>
<permissions>
<copyright-year>2019</copyright-year>
<copyright-holder>Ming et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1006883"/>
<abstract>
<p>How muscles are used is a key to understanding the internal driving of fish swimming. However, the underlying mechanisms of some features of the muscle activation patterns and their differential appearance in different species are still obscure. In this study, we explain the muscle activation patterns by using 3D computational fluid dynamics models coupled to the motion of fish with prescribed deformation and examining the torque and power required along the fish body with two primary swimming modes. We find that the torque required by the hydrodynamic forces and body inertia exhibits a wave pattern that travels faster than the curvature wave in both anguilliform and carangiform swimmers, which can explain the traveling wave speeds of the muscle activations. Notably, intermittent negative power (i.e., power delivered by the fluid to the body) on the posterior part, along with a timely transfer of torque and energy by tendons, explains the decrease in the duration of muscle activation towards the tail. The torque contribution from the body elasticity further clarifies the wave speed increase or the reverse of the wave direction of the muscle activation on the posterior part of a carangiform swimmer. For anguilliform swimmers, the absence of the aforementioned changes in the muscle activation on the posterior part is consistent with our torque prediction and the absence of long tendons from experimental observations. These results provide novel insights into the functions of muscles and tendons as an integral part of the internal driving system, especially from an energy perspective, and they highlight the differences in the internal driving systems between the two primary swimming modes.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>For undulatory swimming, fish form posteriorly traveling waves of body bending by activating their muscles sequentially along the body. However, experimental observations have shown that the muscle activation wave does not simply match the bending wave. Researchers have previously computed the torque required for muscles along the body based on classic hydrodynamic theories and explained the higher wave speed of the muscle activation compared to the curvature wave. However, the origins of other features of the muscle activation pattern and their variation among different species are still obscure after decades of research. In this study, we use 3D computational fluid dynamics models to compute the spatiotemporal distributions of both the torque and power required for eel-like and mackerel-like swimming. By examining both the torque and power patterns and considering the energy transfer, storage, and release by tendons and body viscoelasticity, we can explain not only the features and variations in the muscle activation patterns as observed from fish experiments but also how tendons and body elasticity save energy. We provide a mechanical picture in which the body shape, body movement, muscles, tendons, and body elasticity of a mackerel (or similar) orchestrate to make swimming efficient.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100010906</institution-id>
<institution>NSAF Joint Fund</institution>
</institution-wrap>
</funding-source>
<award-id>U1530401</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-8252-2421</contrib-id>
<name name-style="western">
<surname>Ding</surname> <given-names>Yang</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001809</institution-id>
<institution>National Natural Science Foundation of China</institution>
</institution-wrap>
</funding-source>
<award-id>11672029</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-8252-2421</contrib-id>
<name name-style="western">
<surname>Ding</surname> <given-names>Yang</given-names></name>
</principal-award-recipient>
</award-group>
<funding-statement>This work was supported by the National Science Foundation of China (NSFC), <ext-link ext-link-type="uri" xlink:href="https://www.nsfc.gov.cn" xlink:type="simple">www.nsfc.gov.cn</ext-link>, (grant No. 11672029 and NSFC-NSAF grant No. U1930402) to T.M., B.J., J.S. and Y.D. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="9"/>
<table-count count="0"/>
<page-count count="18"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2019-09-17</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All code and data files are available from the GitHub database: github.com/jbw15/fish_total_code_data.git.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>During the undulatory swimming of fish, a backward-traveling wave of body bending is formed to push against the water and generate propulsion. Muscle is the executor of the neural control and the source of mechanical power in fish swimming. Therefore, how muscles are used is a key question in understanding the control and mechanics of fish swimming and has been a focus multidisciplinary research over the past decades.</p>
<p>Experimentally, muscle activation during swimming is measured using electromyography (EMG) for various fish species ([<xref ref-type="bibr" rid="pcbi.1006883.ref001">1</xref>–<xref ref-type="bibr" rid="pcbi.1006883.ref005">5</xref>], for a review see [<xref ref-type="bibr" rid="pcbi.1006883.ref006">6</xref>]). During steady swimming, a common pattern emerges: the muscle elements are activated as a wave traveling posteriorly, but this EMG wave travels faster than the curvature wave. Consequently, the phase difference between the curvature and EMG waves varies along the body, which is known as “neuromechanical phase lags”. Nonetheless, the details of the muscle activation pattern vary among species. For anguilliform swimmers such as eels, the speed difference is not large, and the duration of the muscle activation on one side of the body is approximately half of the undulation period [<xref ref-type="bibr" rid="pcbi.1006883.ref003">3</xref>]. For carangiform swimmers such as carp, the propagation speed of the EMG onset is much higher than that of the curvature wave, whereas that of EMG termination is even higher, resulting in a decrease in duration towards the tail [<xref ref-type="bibr" rid="pcbi.1006883.ref004">4</xref>]. The EMG activity, along with the muscle contraction kinetics, the strain and the volume of the active muscle, can determine the absolute muscle power output along the body. With this approach, Rome <italic>et al</italic>. [<xref ref-type="bibr" rid="pcbi.1006883.ref005">5</xref>] showed that for scup, the power is generated mostly by the posterior part of the body.</p>
<p>To understand the muscle activation patterns and underlying mechanical principles of internal driving, researchers previously studied the internal torque and the corresponding power required. The sign of the torque has been used to predict which side of the muscle should be activated. Using theoretical models, namely resistive force theory [<xref ref-type="bibr" rid="pcbi.1006883.ref007">7</xref>], elongated body theory [<xref ref-type="bibr" rid="pcbi.1006883.ref008">8</xref>], and 3D waving plate theory [<xref ref-type="bibr" rid="pcbi.1006883.ref009">9</xref>, <xref ref-type="bibr" rid="pcbi.1006883.ref010">10</xref>], previous studies obtained torque waves that travel faster than the curvature waves and qualitatively explained the neuromechanical phase lag. However, since positive and negative torques both occupy half of the period throughout the body, the decrease in the EMG duration in carangiform swimmers remains an obscure phenomenon.</p>
<p>Another approach used to understand the internal driving in the coupled system is to use neural control signals as an input and observe the kinematics emerging from the coupling of internal driving, the body, and the external fluid. Using resistive force theory and 2D computational fluid dynamics (CFD) with a prescribed uniform muscle activation, McMillen <italic>et al</italic>. [<xref ref-type="bibr" rid="pcbi.1006883.ref011">11</xref>] and Tytell <italic>et al</italic>. [<xref ref-type="bibr" rid="pcbi.1006883.ref012">12</xref>] studied lamprey-like swimmers and showed that the same muscle forces can generate body bending with different wavelengths, corresponding to varying magnitudes of the neuromechanical phase lags, depending on passive body properties such as stiffness. However, since the kinematics emerge from the coupling of many components, this type of approach may generate kinematics that do not match the experimental observations; therefore, the approach may cause difficulties for systematically studying the features of muscle activation and for explaining the differences in the muscle activation between species.</p>
<p>These previous modeling studies were all based on either theoretical models with strong assumptions or 2D CFD models, which cannot capture 3D flow around the top and bottom of the fish body and the jet left behind and 3D shapes for carangiform swimmers [<xref ref-type="bibr" rid="pcbi.1006883.ref013">13</xref>]. Therefore, while the qualitative explanations from the models are reasonable, the errors in these predictions are difficult to estimate.</p>
<p>To study the features of muscle activations among different species and elucidate the underlying mechanical principles, we use 3D CFD simulations to investigate the torque patterns and power output patterns for a typical anguilliform swimmer and a typical carangiform swimmer. By combining the simulation results with experimental observations, we aim to explain the features and their variations in the EMG patterns among fish with different swimming modes.</p>
</sec>
<sec id="sec002">
<title>Model and numerical methods</title>
<p>Treating water as an incompressible viscous fluid and the fish as moving bodies with prescribed deformations, we developed two-way coupled 3D models for the swimming of an eel and a mackerel (see <xref ref-type="fig" rid="pcbi.1006883.g001">Fig 1</xref>).</p>
<fig id="pcbi.1006883.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006883.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Numerical models.</title>
<p>(A) and (B) are the meshes without body deformation for the eel and mackerel, respectively. Flow fields in the middle coronal planes (<italic>z</italic> = 0) of the eel (C) and mackerel (D) models in the laboratory frame. The arrows indicate the velocity direction and the colors represent the magnitude of the velocity. Only flow speeds greater than 0.02 in nondimensionalized units are shown in color.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006883.g001" xlink:type="simple"/>
</fig>
<sec id="sec003">
<title>Body shape and kinematics</title>
<p>The carangiform body is modeled based on the actual anatomy of a mackerel, whereas the anguilliform body is created from a lamprey computed tomography (CT) scan (see [<xref ref-type="bibr" rid="pcbi.1006883.ref014">14</xref>] for details). Except for the caudal fin, the fins are neglected for the swimmers. The lengths of the fish bodies (<italic>L</italic>) are used as the unit length in the simulations. The bodies are meshed with triangular elements, and some sharp and small structures from the scan are removed to avoid instability in the CFD computation. After obtaining the surface data of the two fish, we reshaped the fish and remeshed the surface grid such that our code could accommodate the boundary between the fish and the fluid. The sharp and thin tail of the mackerel was modeled as a zero-thickness membranous structure. The number of surface mesh points was 3962 for the eel and 2127 for the mackerel (including 1962 for the mackerel’s body and 165 for the tail). The body mass (<italic>M</italic>) was computed by assuming a uniform distribution of density equal to the fluid density and was 1 in nondimensional units. <italic>M</italic> = 0.0019 for the eel and <italic>M</italic> = 0.0101 for the mackerel.</p>
<p>The kinematics for undulatory locomotion are generally in the form of a posteriorly traveling wave with the largest wave amplitude at the tail. To describe the deformation of the fish bodies, centerline curvatures <italic>κ</italic> are prescribed in the form of <italic>κ</italic>(<italic>s</italic>, <italic>t</italic>) = <italic>A</italic>(<italic>s</italic>) sin(<italic>ks</italic> − <italic>ω</italic><sub><italic>u</italic></sub><italic>t</italic>), where <italic>s</italic> is the arc length measured along the fish axis from the tip of the fish head, <italic>A</italic>(<italic>s</italic>) is the amplitude envelope of curvature as a function of <italic>s</italic>, <italic>k</italic> is the wavenumber of the body undulations that corresponds to wavelength λ, and <italic>ω</italic><sub><italic>u</italic></sub> is angular frequency. We use the undulation period as the unit of time; thus, <italic>ω</italic><sub><italic>u</italic></sub> = 2<italic>π</italic>. The amplitude envelope <italic>A</italic>(<italic>s</italic>) for the anguilliform kinematics has the form <italic>A</italic>(<italic>s</italic>) = <italic>a</italic><sub>max</sub><italic>e</italic><sup><italic>s</italic>−1</sup>, where <italic>a</italic><sub>max</sub> is the tail-beat amplitude. For carangiform kinematics, the amplitude envelope has the form <italic>A</italic>(<italic>s</italic>) = <italic>a</italic><sub>0</sub> + <italic>a</italic><sub>1</sub><italic>s</italic> + <italic>a</italic><sub>2</sub><italic>s</italic><sup>2</sup>. The parameters for <italic>A</italic>(<italic>s</italic>) were adjusted to fit the envelope of the movement of real fish observed in experiments [<xref ref-type="bibr" rid="pcbi.1006883.ref008">8</xref>, <xref ref-type="bibr" rid="pcbi.1006883.ref015">15</xref>]. The parameters used were <italic>a</italic><sub>max</sub> = 11.41, and <italic>k</italic> = 2<italic>π</italic>/0.59 for the anguilliform swimmer and <italic>a</italic><sub>0</sub> = 1, <italic>a</italic><sub>1</sub> = −3.2, <italic>a</italic><sub>2</sub> = 5.6, and <italic>k</italic> = 2<italic>π</italic>/1.0 for the carangiform swimmer. To avoid generating spurious forces and torques in the interaction between the fish bodies and fluid, we added rotation and translation in the body frame of the swimmers to ensure that the movement of the bodies without external forces satisfied two conservation laws: linear momentum conservation and angular momentum conservation (see <xref ref-type="supplementary-material" rid="pcbi.1006883.s001">S1 Appendix</xref> for details). The resulting kinematics are shown in <xref ref-type="supplementary-material" rid="pcbi.1006883.s004">S1 Fig</xref>.</p>
</sec>
<sec id="sec004">
<title>CFD and the fluid-structure interaction</title>
<p>The in-house immersed boundary method code that is used is capable of simulating 3D incompressible, unsteady, and viscous flows in a domain with complex embedded objects including zero-thickness membranes and general 3D bodies [<xref ref-type="bibr" rid="pcbi.1006883.ref016">16</xref>, <xref ref-type="bibr" rid="pcbi.1006883.ref017">17</xref>]. The flow is computed on a nonuniform Cartesian grid in <italic>x</italic>′<italic>y</italic>′<italic>z</italic>′ coordinates. The fluid domain has a size of 8.5 × 5 × 5, and a total of 620 × 400 × 400 ≈ 99 million points are used. The grid is locally refined near the body, with the finest spacing being 0.005 × 0.005 × 0.005. The fish models are placed in the center of the computational domain, and the body centerlines are in the <italic>z</italic>′ = 0 plane. A homogeneous Neumann boundary condition is used for the pressure at all boundaries. The flow speeds of the inlet flow at the front boundary is set as the swimming speed in the trial runs such that the model swimmers move only minimally in the computational domain. A zero-gradient boundary condition is used at all other boundaries. At the surface of the swimmers, nonslip boundary conditions are enforced. The time interval for the integration is 5 × 10<sup>−4</sup>.</p>
<p>Because the deformations of the bodies are prescribed, there are 6 degrees of freedom for the overall movement of the swimmers, the same as that of a rigid body. We computed the 3 degrees of freedom in the 2D plane of undulation from the fluid-structure interaction, namely, forward translation, lateral translation, and yaw motion. The velocity components of the swimmers are numerically integrated at the same time interval as the CFD based on Newton-Euler equations with forces and torques from the CFD. Those 3 degrees of freedoms related to the vertical direction are neglected but the force magnitude in the direction perpendicular to the plane of motion is on average less than 1/10 of the force magnitude in the plane of motion. Because the bodies of the swimmers are deforming, the governing equation for the angular degree of freedom is d(<italic>Iω</italic>)/d<italic>t</italic> = <italic>T</italic><sub>tot</sub>, where <italic>I</italic> is the moment of inertia, <italic>ω</italic> is the angular speed of the body, and <italic>T</italic><sub>tot</sub> is the total torque computed by integrating the contributions from the hydrodynamic forces on the surface of the swimmer. Since the deformation is prescribed, <italic>I</italic> and <inline-formula id="pcbi.1006883.e001"><alternatives><graphic id="pcbi.1006883.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006883.e001" xlink:type="simple"/><mml:math display="inline" id="M1"><mml:mover accent="true"><mml:mi>I</mml:mi> <mml:mo>˙</mml:mo></mml:mover></mml:math></alternatives></inline-formula> are known. Therefore, <italic>ω</italic> can be obtained by numerically integrating <inline-formula id="pcbi.1006883.e002"><alternatives><graphic id="pcbi.1006883.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006883.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:mrow><mml:mover accent="true"><mml:mi>ω</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mtext>tot</mml:mtext></mml:msub> <mml:mo>-</mml:mo> <mml:mover accent="true"><mml:mi>I</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mi>ω</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:mi>I</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> while integrating other equations for the translational movement of the body and the flow of the fluid.</p>
<p>We set an initial swimming speed of 0.3 at the beginning of the simulation and waited at least two full cycles for the swimmer to reach steady swimming. All the data presented are collected from two periods. Because the swimming direction is not perfectly aligned with the -<italic>x</italic>′-axis of the computation grid, a new coordinate system is used such that the swimming direction is aligned with -<italic>x</italic>, <italic>y</italic> is the lateral direction, and the <italic>z</italic>-axis is the vertical direction. The Reynolds number is defined as <italic>Re</italic> = <italic>UL</italic>/<italic>ν</italic><sub><italic>k</italic></sub>, where <italic>U</italic> is the swimming speed, and <italic>ν</italic><sub><italic>k</italic></sub> = 1/15000 is the kinematic viscosity.</p>
</sec>
<sec id="sec005">
<title>Force, torque, and power in the simulation</title>
<p>The force, internal torque, and power distributions along the fish body as a function of time are computed from the simulation. The force per unit length on the fish body, <bold>F</bold>, is calculated as follows: take an arc length Δ<italic>s</italic> along the body centerline, and integrate all forces from every mesh point in Δ<italic>s</italic>; then, divide the total force by the arc length Δ<italic>s</italic>.</p>
<p>Considering the hydrodynamic forces, we compute the internal torque required to overcome the hydrodynamic forces and body inertia. The body elasticity and the other internal resistive forces are initially ignored and will be discussed later. The torque can be found by analyzing the force balance on either side of the body from the point of interest [<xref ref-type="bibr" rid="pcbi.1006883.ref018">18</xref>] and using the concept of inertial force. When the effect of acceleration on the torque of a segment is considered as inertial force (−<italic>m</italic><sub><italic>b</italic></sub><bold>a</bold>), the effective external force can be considered <bold>F</bold> − <italic>m</italic><sub><italic>b</italic></sub><bold>a</bold>, where <italic>m</italic><sub><italic>b</italic></sub> is the body mass per unit length, <inline-formula id="pcbi.1006883.e003"><alternatives><graphic id="pcbi.1006883.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006883.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:mrow><mml:mi mathvariant="bold">a</mml:mi> <mml:mo>=</mml:mo> <mml:mover accent="true"><mml:mi mathvariant="bold">v</mml:mi> <mml:mo>˙</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula> is the acceleration of the body segment, and the body is in static equilibrium. Then from the torque balance equation on either side of the body from the point of interest, we obtain the torque at the point of interest: <inline-formula id="pcbi.1006883.e004"><alternatives><graphic id="pcbi.1006883.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006883.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:mrow><mml:msub><mml:mi>T</mml:mi> <mml:mtext>posterior</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:msub><mml:mi mathvariant="bold">e</mml:mi> <mml:mi>z</mml:mi></mml:msub> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mi>s</mml:mi> <mml:mn>1</mml:mn></mml:msubsup> <mml:mi mathvariant="bold">r</mml:mi> <mml:mo>×</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">F</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>m</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mi mathvariant="bold">a</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mtext>d</mml:mtext> <mml:mi>l</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> or <inline-formula id="pcbi.1006883.e005"><alternatives><graphic id="pcbi.1006883.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006883.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:mrow><mml:msub><mml:mi>T</mml:mi> <mml:mtext>anterior</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi mathvariant="bold">e</mml:mi> <mml:mi>z</mml:mi></mml:msub> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mn>0</mml:mn> <mml:mi>s</mml:mi></mml:msubsup> <mml:mi mathvariant="bold">r</mml:mi> <mml:mo>×</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">F</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>m</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mi mathvariant="bold">a</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mtext>d</mml:mtext> <mml:mi>l</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, which is consistent with [<xref ref-type="bibr" rid="pcbi.1006883.ref009">9</xref>]. Although <italic>T</italic> = <italic>T</italic><sub>posterior</sub> = <italic>T</italic><sub>anterior</sub> theoretically, the relative error becomes significant at the ends where torques are small. To minimize the numerical error, we use a weighted average of the torques computed from both sides, namely, <italic>T</italic> = <italic>sT</italic><sub>posterior</sub> + (1 − <italic>s</italic>)<italic>T</italic><sub>anterior</sub>.</p>
<p>The internal power by the torque and the power transferred to the fluid per unit length are computed as <inline-formula id="pcbi.1006883.e006"><alternatives><graphic id="pcbi.1006883.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006883.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:mrow><mml:msub><mml:mi>P</mml:mi> <mml:mi>T</mml:mi></mml:msub> <mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo> <mml:mo>=</mml:mo> <mml:mi>T</mml:mi> <mml:mover accent="true"><mml:mi>κ</mml:mi> <mml:mo>˙</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula> [<xref ref-type="bibr" rid="pcbi.1006883.ref008">8</xref>] and <italic>P</italic><sub><italic>F</italic></sub> (<italic>s</italic>, <italic>t</italic>) = −<bold>F</bold> ⋅ <bold>v</bold>, respectively, where <inline-formula id="pcbi.1006883.e007"><alternatives><graphic id="pcbi.1006883.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006883.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:mover accent="true"><mml:mi>κ</mml:mi> <mml:mo>˙</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is the time derivative of curvature, and <bold>v</bold> is the velocity of the body segment. The difference between the total power computed by integrating the internal power and the external power along the body is within the numerical error (&lt; 3%).</p>
<p>We varied the kinematics (amplitude and wavelength) and the body shape (height and width) by 10% to examine the sensitivity of the results. We found that the force and torque patterns are qualitatively the same in these tests. Simulations with a smaller mesh size result in forces and torques within the numerical error. The detailed of the test parameters and the results are provided in <xref ref-type="supplementary-material" rid="pcbi.1006883.s002">S2 Appendix</xref>.</p>
</sec>
</sec>
<sec id="sec006" sec-type="conclusions">
<title>Results and discussion</title>
<sec id="sec007">
<title>Body movement and fluid flow</title>
<p>The free swimming speeds (<italic>U</italic>) are 0.285±0.004 and 0.245±0.005 in nondimensionalized units for the eel and the mackerel, respectively. The corresponding Strouhal numbers are 0.63 and 0.65. These values are consistent with previous numerical studies at similar Reynolds numbers (<italic>Re</italic> ≈4000) (e.g., [<xref ref-type="bibr" rid="pcbi.1006883.ref014">14</xref>]). For both fish, double row vortices are shed behind the tail, similar to previous numerical results (see <xref ref-type="fig" rid="pcbi.1006883.g001">Fig 1</xref>). The velocity field behind the mackerel clearly shows a backward flow, while a mean flow behind the eel in the fore-aft direction is not easily detected.</p>
</sec>
<sec id="sec008">
<title>Force</title>
<p>As expected from the input kinematics and body shapes, the forces are relatively uniformly distributed on the eel but concentrated on the tail of the mackerel (Figs <xref ref-type="fig" rid="pcbi.1006883.g002">2</xref> and <xref ref-type="fig" rid="pcbi.1006883.g003">3A &amp; 3C</xref>, <xref ref-type="supplementary-material" rid="pcbi.1006883.s005">S1</xref> and <xref ref-type="supplementary-material" rid="pcbi.1006883.s006">S2</xref> Videos). The fore-aft and lateral forces both show posteriorly traveling wave patterns similar to those of body bending, except at the head where the surface orientation rapidly changes. For the eel, the peaks in the force components near 0.7 body length correspond to an increase in the body height (in <italic>z</italic> direction) at that position. For the mackerel, the separation of the thrust and drag is clear: the tail generates most of the thrust, and the anterior part of the body generates drag at all times.</p>
<fig id="pcbi.1006883.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006883.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Spatiotemporal distribution of the fore-aft force (<italic>F</italic><sub><italic>x</italic></sub>) on the eel (A) and the mackerel (B) for two periods.</title>
<p>Negative values indicate thrust, because the swimming direction is in the -<italic>x</italic> direction.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006883.g002" xlink:type="simple"/>
</fig>
<fig id="pcbi.1006883.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006883.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Lateral force (<italic>F</italic><sub><italic>y</italic></sub>).</title>
<p>(A &amp; C,) Spatiotemporal distribution of the lateral force on the body for two periods from the simulation. The dashed black line indicates a zero-crossing (phase) of the force. (B &amp; D) Comparison of the phase of the lateral force along the body from CFD (solid black line, the same as the dashed lines in A and C) with the phase of the negation of the velocity and the phase of the negation of the acceleration. A 2<italic>π</italic> term is added or subtracted to ensure continuity.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006883.g003" xlink:type="simple"/>
</fig>
<p>Because the phase of the force, especially the lateral force, is essential in determining the phase of the torque [<xref ref-type="bibr" rid="pcbi.1006883.ref018">18</xref>], we compare the phases of the lateral forces from the simulation with those of the velocity and the acceleration of the segments. In general, if the lateral force from the fluid on a segment is in phase with the negation of the segment velocity, it is a resistive-like force, and if the lateral force is in phase with the negation of the acceleration of the segment, it is a reactive-like force. We find that the phase of the observed lateral force on the body is closer to the phase of the negation of the acceleration except near the snout tips and the tail for the mackerel. In these regions, the phase of the lateral force is close to the negation of the velocity. In general, the forces on the fish are close to the predicted forces from elongated body theory, but discrepancies exist when the shape changes are rapid. Detailed discussions of the hydrodynamics underlying the force pattern are beyond the scope of this paper.</p>
</sec>
<sec id="sec009">
<title>Torque</title>
<p>The torque required to overcome the hydrodynamic forces and body inertia in both species exhibits a traveling wave pattern moving posteriorly with a higher speed than the curvature wave (<xref ref-type="fig" rid="pcbi.1006883.g004">Fig 4</xref>). For the eel, the average speed of the torque wave (<italic>v</italic><sub><italic>T</italic></sub>) is 1.41 in the nondimensionalized unit (body length/period). The traveling wave speed of the torque is even higher in the mackerel (<italic>v</italic><sub><italic>T</italic></sub> = 2.11), exhibiting a nearly standing wave pattern. The torque wave speeds qualitatively match the observation that the EMG speed is much higher in carangiform swimmers [<xref ref-type="bibr" rid="pcbi.1006883.ref006">6</xref>]. The maximal value of the torque appears at approximately the middle of the body of the eel and slightly posterior to the middle point for the mackerel.</p>
<fig id="pcbi.1006883.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006883.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Spatiotemporal distribution of the torque on the body in two periods for the eel (A) and the mackerel (B).</title>
<p>The solid and dashed lines indicate the maximum and minimum curvatures, respectively. The same information is illustrated in <xref ref-type="supplementary-material" rid="pcbi.1006883.s007">S3</xref> and <xref ref-type="supplementary-material" rid="pcbi.1006883.s008">S4</xref> Videos.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006883.g004" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec010">
<title>Power</title>
<p>As shown in <xref ref-type="fig" rid="pcbi.1006883.g005">Fig 5</xref>, the power from the torque is mostly positive, indicating the energy output from the muscle, but negative values are observed on the posterior parts of both fish. For the eel, the power is nearly all negative for <italic>s</italic> &gt; 0.7, similar to the case with a floppy body in a previous 2D study [<xref ref-type="bibr" rid="pcbi.1006883.ref012">12</xref>], whereas for the mackerel, the negative power is intermittent on the posterior part. The work over a cycle calculated by simply integrating the power is the minimal work needed, because the dissipation due to the internal resistance is not included; this method implies that the negative power transferred to the body is fully stored and recovered. The peak of this work per cycle is at the anterior part (≈0.4) for the eel and at a more posterior position for the mackerel (≈0.58), slightly posterior to the peak magnitude of the torque. We find that the work over a cycle is significantly negative on the posterior half of the eel body and slightly negative near the tail of the mackerel. If we assume that no energy-storing and energy-transmitting elements exist, then the work done by the muscles is the integration of only the positive power. We denote this quantity by <italic>W</italic><sup>+</sup>. The differences between the two types of work per cycle are the greatest for the posterior part of the eel, indicating that power is lost if no spatial energy transfer is performed inside the body of the eel. The distribution of power transferred to the fluid from the body is relatively uniform on the eel but concentrated on the tail of the mackerel (cyan dashed lines in <xref ref-type="fig" rid="pcbi.1006883.g005">Fig 5B &amp; 5D</xref>).</p>
<fig id="pcbi.1006883.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006883.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Internal power (<italic>P</italic><sub><italic>T</italic></sub>(<italic>s</italic>, <italic>t</italic>)) distribution for the eel (A) and the mackerel (C) and the work done over a cycle by muscles along the bodies of the eel (B) and the mackerel (D).</title>
<p>The dashed line in (C) indicates the zero-crossing of the torque in the mackerel (<xref ref-type="fig" rid="pcbi.1006883.g004">Fig 4B</xref>). The two black dots in (C) indicate an example time instant when two points on the body have the opposite sign of power but the same sign of torque. The solid blue lines in (B &amp; D) represent the work by integrating only the positive values in (A &amp; C), and the dashed-dotted red lines represent the work (<italic>W</italic>) by integrating both positive and negative values. The dotted green lines represent the positive work <italic>W</italic><sup>+</sup> when body elasticity is considered (<xref ref-type="fig" rid="pcbi.1006883.g007">Fig 7B &amp; 7D</xref>). The cyan dashed lines represent the work done to the fluid by the integration of <italic>P</italic><sub><italic>F</italic></sub>(<italic>s</italic>, <italic>t</italic>).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006883.g005" xlink:type="simple"/>
</fig>
<p>The mean total power <italic>P</italic><sub>tot</sub> averaged over a cycle is 2.2 × 10<sup>−4</sup> (in nondimensionalized units) for the eel and 2.6 × 10<sup>−4</sup> for the mackerel. If only the positive power is used, the power becomes <inline-formula id="pcbi.1006883.e008"><alternatives><graphic id="pcbi.1006883.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006883.e008" xlink:type="simple"/><mml:math display="inline" id="M8"><mml:mrow><mml:msubsup><mml:mi>P</mml:mi> <mml:mtext>tot</mml:mtext> <mml:mo>+</mml:mo></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>8</mml:mn> <mml:mo>.</mml:mo> <mml:mn>6</mml:mn> <mml:mo>×</mml:mo> <mml:msup><mml:mn>10</mml:mn> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006883.e009"><alternatives><graphic id="pcbi.1006883.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006883.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:mrow><mml:msubsup><mml:mi>P</mml:mi> <mml:mtext>tot</mml:mtext> <mml:mo>+</mml:mo></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>3</mml:mn> <mml:mo>.</mml:mo> <mml:mn>4</mml:mn> <mml:mo>×</mml:mo> <mml:msup><mml:mn>10</mml:mn> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, for the eel and the mackerel, respectively. The significant differences between <italic>P</italic><sub>tot</sub> and <inline-formula id="pcbi.1006883.e010"><alternatives><graphic id="pcbi.1006883.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006883.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:msubsup><mml:mi>P</mml:mi> <mml:mtext>tot</mml:mtext> <mml:mo>+</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> indicate a great potential to improve energetic efficiency through the spatiotemporal transfer of energy.</p>
</sec>
<sec id="sec011">
<title>Understanding the torque and power patterns</title>
<p>The torque pattern can be understood by applying the results obtained in a previous study [<xref ref-type="bibr" rid="pcbi.1006883.ref018">18</xref>]: the torque pattern in undulatory locomotion is determined mainly by the wavelength and phase of the lateral force relative to the lateral movement. The torque wave of the eel has a relatively low wave speed compared to that of the mackerel due to the short wavelength of the undulation. Because the phase of the force for the eel is overall close to the phase of the reactive force, the internal torque and power patterns are also similar to the patterns associated with pure reactive forces (<xref ref-type="fig" rid="pcbi.1006883.g006">Fig 6</xref>, left column). For the mackerel, the long wavelength of the curvature wave and the concentrated force on the tail result in nearly synchronized torques on the body. Because the force from the tail to the fluid is nearly in phase with the velocity, the rate of change of the curvature (<inline-formula id="pcbi.1006883.e011"><alternatives><graphic id="pcbi.1006883.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006883.e011" xlink:type="simple"/><mml:math display="inline" id="M11"><mml:mover accent="true"><mml:mi>κ</mml:mi> <mml:mo>˙</mml:mo></mml:mover></mml:math></alternatives></inline-formula>) and the torque are also nearly in phase. Consequently, the torque and power patterns are similar to the patterns associated with pure resistive forces (<xref ref-type="fig" rid="pcbi.1006883.g006">Fig 6</xref>, right column), and the internal power is nearly all positive.</p>
<fig id="pcbi.1006883.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006883.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Spatiotemporal distributions of the torque (<italic>T</italic>) and power (<italic>P</italic>) along the body when pure resistive forces (A for <italic>T</italic> and B for <italic>P</italic>) or pure reactive forces (C for <italic>T</italic> and D for <italic>P</italic>) are considered.</title>
<p>All values are normalized to the respective maximum values in each subfigure. The solid and dashed lines indicate the maximum and minimum curvatures, respectively. The insets are the distribution of the work (<inline-formula id="pcbi.1006883.e012"><alternatives><graphic id="pcbi.1006883.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006883.e012" xlink:type="simple"/><mml:math display="inline" id="M12"><mml:mrow><mml:mi>W</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mn>0</mml:mn> <mml:mn>1</mml:mn></mml:msubsup> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mtext>d</mml:mtext> <mml:mi>t</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>) done by the internal torque. The gray lines in the insets indicate 0 to guide the eye. In the calculation, the body is uniform, the undulation amplitude is uniform and infinitesimal, and the wavelength is the same as the body length. See <xref ref-type="supplementary-material" rid="pcbi.1006883.s003">S3 Appendix</xref> for details of the derivation.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006883.g006" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec012">
<title>Body viscoelasticity explains the wave speed variation of EMG</title>
<p>Previous bending tests and experiences in the handling of fish indicate that the torque from the viscoelasticity of an eel body is significant but smaller than the torque generated by muscles [<xref ref-type="bibr" rid="pcbi.1006883.ref019">19</xref>]. For carangiform swimmers, since no muscles exist behind the peduncle region and the curvature is comparable (albeit greater) to the rest of the body, the torque from elasticity must be significant at least in the tail region. However, an accurate <italic>in vivo</italic> measurement of the body viscoelasticity distribution is not available. Therefore, we discuss the trend of the influences of the viscosity and elasticity individually when the elasticity or viscosity is small relative to the torque from hydrodynamics and the body inertia (<xref ref-type="fig" rid="pcbi.1006883.g007">Fig 7</xref>).</p>
<fig id="pcbi.1006883.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006883.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Torque (A) and power (B) distributions when the elasticity of the body is considered for the eel and torque (C) and power (D) distributions for the mackerel.</title>
<p>The dashed lines indicate zero-crossings of the torque.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006883.g007" xlink:type="simple"/>
</fig>
<p>We assume that the magnitude of the torque from the body elasticity or viscosity is 40% of the torque at individual positions along the body, namely <italic>T</italic><sub><italic>e</italic></sub> = 0.4〈<italic>T</italic>〉<italic>κ</italic>(<italic>s</italic>, <italic>t</italic>)/〈<italic>κ</italic>〉 or <inline-formula id="pcbi.1006883.e013"><alternatives><graphic id="pcbi.1006883.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006883.e013" xlink:type="simple"/><mml:math display="inline" id="M13"><mml:mrow><mml:msub><mml:mi>T</mml:mi> <mml:mi>v</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>4</mml:mn> <mml:mrow><mml:mo>〈</mml:mo> <mml:mi>T</mml:mi> <mml:mo>〉</mml:mo></mml:mrow> <mml:mover accent="true"><mml:mi>κ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:mrow><mml:mo>〈</mml:mo> <mml:mover accent="true"><mml:mi>κ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mo>〉</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, where “〈〉” means standard deviation over time. Then, the total torque that needs to be generated becomes <italic>T</italic> + <italic>T</italic><sub><italic>e</italic></sub> or <italic>T</italic> + <italic>T</italic><sub><italic>v</italic></sub>. As shown in <xref ref-type="fig" rid="pcbi.1006883.g007">Fig 7</xref>, we find that the effect of elasticity on the torque is different along the body, separated by a position (<italic>s</italic> ≈ 0.5 for the mackerel and <italic>s</italic> ≈ 0.3 for the eel) where <italic>T</italic> and <inline-formula id="pcbi.1006883.e014"><alternatives><graphic id="pcbi.1006883.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006883.e014" xlink:type="simple"/><mml:math display="inline" id="M14"><mml:mover accent="true"><mml:mi>κ</mml:mi> <mml:mo>˙</mml:mo></mml:mover></mml:math></alternatives></inline-formula> are in phase and the power is all positive. Anterior to that point, the torque magnitudes increase, and the torque wave speeds decrease; posterior to that point, the torque magnitude decreases, and the speed of the torque wave increases. For the mackerel, the torque wave can even reverse when the phase shift effect of the elasticity is strong. The reversal of the wave resembles the reversal of the wave of the offset of the EMG observed for carangiform swimmers [<xref ref-type="bibr" rid="pcbi.1006883.ref006">6</xref>]. As a result of the changes in the torque, the area of the negative power region in the posterior part of the body decreases, and <italic>W</italic><sup>+</sup> decreases (<xref ref-type="fig" rid="pcbi.1006883.g005">Fig 5D</xref>). This observation is consistent with the findings of previous studies that suitable elasticity can save and restore energy to improve efficiency (e.g., [<xref ref-type="bibr" rid="pcbi.1006883.ref020">20</xref>]). For the eel, the effect of the speed increase ends near <italic>s</italic> = 0.7 when the maximal curvature coincides with the minimal torque without elasticity. Therefore, the energy storage and release for the eel is in the middle part of the body (<xref ref-type="fig" rid="pcbi.1006883.g005">Fig 5B</xref>). Since the body viscoelasticity of the eel is weak and this effect is subtle, changes in the wave speed of the middle part of the torque wave or EMG are not obvious.</p>
<p>Since the body viscosity requires a torque that is in phase with the time derivative of the curvature, for both the eel and the mackerel, the resulting torques become more aligned with the time derivative of the curvature and hence have wave speeds closer to the speed of the curvature (<xref ref-type="fig" rid="pcbi.1006883.g008">Fig 8</xref>). Consequently, the negative power regions are reduced because the viscosity of the body always dissipates energy. The effects of the viscosity and elasticity are qualitatively the same as greater contributions, at least to a prefactor of 0.8 for <italic>T</italic><sub><italic>e</italic></sub> and <italic>T</italic><sub><italic>v</italic></sub> (see <xref ref-type="supplementary-material" rid="pcbi.1006883.s001">S1 Appendix</xref> for details).</p>
<fig id="pcbi.1006883.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006883.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Torque (A) and power (B) distributions when the viscosity of the body is considered for the eel and torque (C) and power (D) distributions for the mackerel.</title>
<p>The solid and dashed lines indicate the maximum and minimum curvatures, respectively.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006883.g008" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec013">
<title>Tendon connection explains the duration decrease of EMG</title>
<p>Although local elasticity can temporally transfer the energy flow into this region due to the fluid-structure interactions, the spatial transmission of such energy can only be achieved by other structures. In animals, coupled joint articulation by tendons over two or more joints is common and is an effective structure to save and transfer energy by connecting a joint with positive power and another joint with negative power [<xref ref-type="bibr" rid="pcbi.1006883.ref021">21</xref>, <xref ref-type="bibr" rid="pcbi.1006883.ref022">22</xref>]. For carangiform swimmers, long tendons exist that span many vertebra [<xref ref-type="bibr" rid="pcbi.1006883.ref023">23</xref>]. Although the force transfer function of these tendons towards the tail has been experimentally confirmed, to our best knowledge, their function in saving energy has not been considered. We hypothesize that these long tendons are used to transfer energy from the posterior part to the middle part of the body when the negative power appears on the posterior part (<xref ref-type="fig" rid="pcbi.1006883.g005">Fig 5</xref>). This hypothesis can explain the observed decrease in the muscle activation duration among the carangiform swimmers, including some detailed features: the increase in the duration of the negative power from the middle of the body towards the tail matches the decrease in the EMG duration. The start of the positive power is aligned with the sign change of <inline-formula id="pcbi.1006883.e015"><alternatives><graphic id="pcbi.1006883.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006883.e015" xlink:type="simple"/><mml:math display="inline" id="M15"><mml:mover accent="true"><mml:mi>κ</mml:mi> <mml:mo>˙</mml:mo></mml:mover></mml:math></alternatives></inline-formula> (the lines in <xref ref-type="fig" rid="pcbi.1006883.g004">Fig 4B</xref>), resulting in a low speed that is the same as that of the curvature wave. The end of the positive power is aligned with the sign change in the torque (the dashed lines in <xref ref-type="fig" rid="pcbi.1006883.g005">Fig 5B</xref>), resulting in a high speed that is the same as that of the torque wave. Such differences in wave speed qualitatively match the speed differences of the onset and offset of the EMG. Note that this hypothesis does not contradict the common view that force and energy are transmitted to the tail to interact with the fluid. Torque is still required when the power is negative on the posterior region and can be provided by the muscle in a more anterior position connected by the tendon. This hypothesis is also consistent with the observation that the EMG duration is nearly half of the undulation period on the whole body of anguilliform swimmers, which do not possess long tendons [<xref ref-type="bibr" rid="pcbi.1006883.ref023">23</xref>].</p>
<p>The energy transfer and savings by a tendon and the shortening of muscle activation can be further elucidated by a simplistic rope model (<xref ref-type="fig" rid="pcbi.1006883.g009">Fig 9</xref>). We take the positions <italic>s</italic><sub>1</sub> = 0.47 and <italic>s</italic><sub>2</sub> = 0.71 on the mackerel as an example. We assume that the designated muscles (muscle 1 and muscle 2 in <xref ref-type="fig" rid="pcbi.1006883.g009">Fig 9A</xref>) are attached to virtual struts with a height <italic>H</italic><sub><italic>s</italic></sub>. Based on experimental observations on the arrangement of muscles, tendons and vertebral segments in the posterior part of carangiform swimmers [<xref ref-type="bibr" rid="pcbi.1006883.ref024">24</xref>, <xref ref-type="bibr" rid="pcbi.1006883.ref025">25</xref>], a pair of muscles on anterior position are connected to the posterior point by tendons (hereafter referred to as ‘tendon muscles’). A simple relationship between the muscle force <italic>F</italic><sub><italic>m</italic></sub> and the torque about the points on the centerline from a muscle <italic>T</italic><sub><italic>m</italic></sub> can be derived: <italic>T</italic><sub><italic>m</italic></sub> = <italic>H</italic><sub><italic>s</italic></sub><italic>F</italic><sub><italic>m</italic></sub>. Correspondingly, the change in the muscle length and the curvature has the following relation: Δ<italic>L</italic><sub><italic>m</italic></sub> = <italic>L</italic><sub><italic>m</italic></sub> − <italic>L</italic><sub><italic>m</italic>0</sub> = <italic>H</italic><sub><italic>s</italic></sub><italic>κ</italic>Δ<italic>s</italic>, where <italic>L</italic><sub><italic>m</italic>0</sub> is the muscle length at rest, and Δ<italic>s</italic> is the arc length between the struts without bending. The power per unit length can be computed as <inline-formula id="pcbi.1006883.e016"><alternatives><graphic id="pcbi.1006883.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006883.e016" xlink:type="simple"/><mml:math display="inline" id="M16"><mml:mrow><mml:mi>P</mml:mi> <mml:mo>=</mml:mo> <mml:msub><mml:mi>F</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:msub><mml:mover accent="true"><mml:mi>L</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mi>m</mml:mi></mml:msub> <mml:mo>/</mml:mo> <mml:mo>Δ</mml:mo> <mml:mi>s</mml:mi> <mml:mo>=</mml:mo> <mml:mi>T</mml:mi> <mml:mover accent="true"><mml:mi>κ</mml:mi> <mml:mo>˙</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula>. This relationship also holds for the tendon muscles. Because the height of the struts, the arc distance between the struts, and the resting length of the muscle do not affect the power, the exact values of these quantities are not important in this analysis.</p>
<fig id="pcbi.1006883.g009" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006883.g009</object-id>
<label>Fig 9</label>
<caption>
<title>The energy transfer by tendons.</title>
<p>(A) Diagram of the tendon model. The muscles and tendon on the left side are drawn as semitransparent for clarity. (B) The torques and time derivative of curvatures as a function of time at the two joints and the torque generated by the tendon muscle. The vertical lengths of the shaded regions indicate the magnitudes of the respective torques. The bars at the bottom indicate the predicted muscle activation periods when the tendons are used. The blue and black bars combined predict the muscle activation at joint 1, and the red bar predicts the muscle activation at joint 2. (C) The total power generated by the muscles with and without the tendons and the power from the tendon muscle. The gray lines indicate the negative power on the tendon muscle but is counted as 0 in computing <italic>P</italic><sub>total</sub>. The stage indices are labeled at the tops of (B) and (C).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006883.g009" xlink:type="simple"/>
</fig>
<p>We consider the case where the phases of <italic>T</italic><sub>1</sub> = <italic>T</italic>(<italic>s</italic><sub>1</sub>), <italic>T</italic><sub>2</sub> = <italic>T</italic>(<italic>s</italic><sub>2</sub>), <inline-formula id="pcbi.1006883.e017"><alternatives><graphic id="pcbi.1006883.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006883.e017" xlink:type="simple"/><mml:math display="inline" id="M17"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>κ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mover accent="true"><mml:mi>κ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, and <inline-formula id="pcbi.1006883.e018"><alternatives><graphic id="pcbi.1006883.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006883.e018" xlink:type="simple"/><mml:math display="inline" id="M18"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>κ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mover accent="true"><mml:mi>κ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> have the relation <inline-formula id="pcbi.1006883.e019"><alternatives><graphic id="pcbi.1006883.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006883.e019" xlink:type="simple"/><mml:math display="inline" id="M19"><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mover accent="true"><mml:mi>κ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>≈</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mi>T</mml:mi> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>&gt;</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mi>T</mml:mi> <mml:mn>2</mml:mn></mml:mrow></mml:msub> <mml:mo>&gt;</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mover accent="true"><mml:mi>κ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> (<xref ref-type="fig" rid="pcbi.1006883.g009">Fig 9B</xref>). We assume a strategy in which the tendon muscles are only active when the torque required at these two points have the same sign and one of the tendon muscles generates a torque <italic>T</italic><sub><italic>d</italic></sub> that is needed by both joints, namely, <italic>T</italic><sub><italic>d</italic></sub> = sgn(<italic>T</italic><sub>1</sub>) min(|<italic>T</italic><sub>1</sub>|, |<italic>T</italic><sub>2</sub>|). We first assume that any negative power of the muscles is wasted. Then, there are four stages (see <xref ref-type="fig" rid="pcbi.1006883.g009">Fig 9B &amp; 9C</xref>):</p>
<list list-type="simple">
<list-item>
<label>I</label>
<p><italic>T</italic><sub>1</sub> and <italic>T</italic><sub>2</sub> have different signs, the tendon muscle is not activated, and the total muscle power is unchanged.</p>
</list-item>
<list-item>
<label>II</label>
<p><italic>T</italic><sub>1</sub>, <italic>T</italic><sub>2</sub>, and <inline-formula id="pcbi.1006883.e020"><alternatives><graphic id="pcbi.1006883.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006883.e020" xlink:type="simple"/><mml:math display="inline" id="M20"><mml:msub><mml:mover accent="true"><mml:mi>κ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula> have the same sign but opposite to <inline-formula id="pcbi.1006883.e021"><alternatives><graphic id="pcbi.1006883.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006883.e021" xlink:type="simple"/><mml:math display="inline" id="M21"><mml:msub><mml:mover accent="true"><mml:mi>κ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msub></mml:math></alternatives></inline-formula>. The power from muscle 1 is <inline-formula id="pcbi.1006883.e022"><alternatives><graphic id="pcbi.1006883.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006883.e022" xlink:type="simple"/><mml:math display="inline" id="M22"><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mi>d</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mover accent="true"><mml:mi>κ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, that from muscle 2 is <inline-formula id="pcbi.1006883.e023"><alternatives><graphic id="pcbi.1006883.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006883.e023" xlink:type="simple"/><mml:math display="inline" id="M23"><mml:mrow><mml:mo form="prefix" movablelimits="true">max</mml:mo> <mml:mo>(</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mi>d</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mover accent="true"><mml:mi>κ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, and that from the tendon muscle on both joints is <inline-formula id="pcbi.1006883.e024"><alternatives><graphic id="pcbi.1006883.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006883.e024" xlink:type="simple"/><mml:math display="inline" id="M24"><mml:mrow><mml:msub><mml:mi>P</mml:mi> <mml:mi>d</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mo form="prefix" movablelimits="true">max</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mi>d</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>κ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>κ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mi>d</mml:mi></mml:msub> <mml:msub><mml:mover accent="true"><mml:mi>κ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:mo>-</mml:mo> <mml:mrow><mml:mo form="prefix" movablelimits="true">min</mml:mo> <mml:mo>(</mml:mo> <mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi>T</mml:mi> <mml:mi>d</mml:mi></mml:msub> <mml:msub><mml:mover accent="true"><mml:mi>κ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>|</mml:mo> <mml:mo>,</mml:mo> <mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi>T</mml:mi> <mml:mi>d</mml:mi></mml:msub> <mml:msub><mml:mover accent="true"><mml:mi>κ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msub> <mml:mrow><mml:mo>|</mml:mo> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. The total power is <inline-formula id="pcbi.1006883.e025"><alternatives><graphic id="pcbi.1006883.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006883.e025" xlink:type="simple"/><mml:math display="inline" id="M25"><mml:mrow><mml:msub><mml:mi>T</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:msub><mml:mover accent="true"><mml:mi>κ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> without the tendon and <inline-formula id="pcbi.1006883.e026"><alternatives><graphic id="pcbi.1006883.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006883.e026" xlink:type="simple"/><mml:math display="inline" id="M26"><mml:mrow><mml:msub><mml:mi>T</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:msub><mml:mover accent="true"><mml:mi>κ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:mo>-</mml:mo> <mml:mrow><mml:mo form="prefix" movablelimits="true">min</mml:mo> <mml:mo>(</mml:mo> <mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi>T</mml:mi> <mml:mi>d</mml:mi></mml:msub> <mml:msub><mml:mover accent="true"><mml:mi>κ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>|</mml:mo> <mml:mo>,</mml:mo> <mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi>T</mml:mi> <mml:mi>d</mml:mi></mml:msub> <mml:msub><mml:mover accent="true"><mml:mi>κ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msub> <mml:mrow><mml:mo>|</mml:mo> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> with the tendon. The energy saved is <inline-formula id="pcbi.1006883.e027"><alternatives><graphic id="pcbi.1006883.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006883.e027" xlink:type="simple"/><mml:math display="inline" id="M27"><mml:mrow><mml:mo form="prefix" movablelimits="true">min</mml:mo> <mml:mo>(</mml:mo> <mml:mo>|</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mi>d</mml:mi></mml:msub> <mml:msub><mml:mover accent="true"><mml:mi>κ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:mo>|</mml:mo> <mml:mo>,</mml:mo> <mml:mo>|</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mi>d</mml:mi></mml:msub> <mml:msub><mml:mover accent="true"><mml:mi>κ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msub> <mml:mo>|</mml:mo> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>.</p>
</list-item>
<list-item>
<label>III</label>
<p><italic>T</italic><sub>1</sub>, <italic>T</italic><sub>2</sub>, <inline-formula id="pcbi.1006883.e028"><alternatives><graphic id="pcbi.1006883.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006883.e028" xlink:type="simple"/><mml:math display="inline" id="M28"><mml:msub><mml:mover accent="true"><mml:mi>κ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula>, and <inline-formula id="pcbi.1006883.e029"><alternatives><graphic id="pcbi.1006883.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006883.e029" xlink:type="simple"/><mml:math display="inline" id="M29"><mml:msub><mml:mover accent="true"><mml:mi>κ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msub></mml:math></alternatives></inline-formula> all have the same sign. The power from muscle 1 is <inline-formula id="pcbi.1006883.e030"><alternatives><graphic id="pcbi.1006883.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006883.e030" xlink:type="simple"/><mml:math display="inline" id="M30"><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mi>d</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mover accent="true"><mml:mi>κ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, that from muscle 2 is <inline-formula id="pcbi.1006883.e031"><alternatives><graphic id="pcbi.1006883.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006883.e031" xlink:type="simple"/><mml:math display="inline" id="M31"><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mi>d</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mover accent="true"><mml:mi>κ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, and that from the tendon muscle is <inline-formula id="pcbi.1006883.e032"><alternatives><graphic id="pcbi.1006883.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006883.e032" xlink:type="simple"/><mml:math display="inline" id="M32"><mml:mrow><mml:msub><mml:mi>P</mml:mi> <mml:mi>d</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mi>d</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>κ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>κ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. The tendon has no effect on the total power.</p>
</list-item>
<list-item>
<label>IV</label>
<p><italic>T</italic><sub>1</sub>, <italic>T</italic><sub>2</sub> and <inline-formula id="pcbi.1006883.e033"><alternatives><graphic id="pcbi.1006883.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006883.e033" xlink:type="simple"/><mml:math display="inline" id="M33"><mml:msub><mml:mover accent="true"><mml:mi>κ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msub></mml:math></alternatives></inline-formula> have the same sign but opposite to <inline-formula id="pcbi.1006883.e034"><alternatives><graphic id="pcbi.1006883.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006883.e034" xlink:type="simple"/><mml:math display="inline" id="M34"><mml:msub><mml:mover accent="true"><mml:mi>κ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula>. Similar to case 2, the power from muscle 1 is <inline-formula id="pcbi.1006883.e035"><alternatives><graphic id="pcbi.1006883.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006883.e035" xlink:type="simple"/><mml:math display="inline" id="M35"><mml:mrow><mml:mo form="prefix" movablelimits="true">max</mml:mo> <mml:mo>(</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mi>d</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mover accent="true"><mml:mi>κ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, that from muscle 2 is <inline-formula id="pcbi.1006883.e036"><alternatives><graphic id="pcbi.1006883.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006883.e036" xlink:type="simple"/><mml:math display="inline" id="M36"><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mi>d</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mover accent="true"><mml:mi>κ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, and that from the tendon muscle is <inline-formula id="pcbi.1006883.e037"><alternatives><graphic id="pcbi.1006883.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006883.e037" xlink:type="simple"/><mml:math display="inline" id="M37"><mml:mrow><mml:msub><mml:mi>P</mml:mi> <mml:mi>d</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mo form="prefix" movablelimits="true">max</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mi>d</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>κ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>κ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mi>d</mml:mi></mml:msub> <mml:msub><mml:mover accent="true"><mml:mi>κ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msub> <mml:mo>-</mml:mo> <mml:mrow><mml:mo form="prefix" movablelimits="true">min</mml:mo> <mml:mo>(</mml:mo> <mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi>T</mml:mi> <mml:mi>d</mml:mi></mml:msub> <mml:msub><mml:mover accent="true"><mml:mi>κ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>|</mml:mo> <mml:mo>,</mml:mo> <mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi>T</mml:mi> <mml:mi>d</mml:mi></mml:msub> <mml:msub><mml:mover accent="true"><mml:mi>κ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msub> <mml:mrow><mml:mo>|</mml:mo> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. The power saved is <inline-formula id="pcbi.1006883.e038"><alternatives><graphic id="pcbi.1006883.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006883.e038" xlink:type="simple"/><mml:math display="inline" id="M38"><mml:mrow><mml:mo form="prefix" movablelimits="true">min</mml:mo> <mml:mo>(</mml:mo> <mml:mo>|</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mi>d</mml:mi></mml:msub> <mml:msub><mml:mover accent="true"><mml:mi>κ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:mo>|</mml:mo> <mml:mo>,</mml:mo> <mml:mo>|</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mi>d</mml:mi></mml:msub> <mml:msub><mml:mover accent="true"><mml:mi>κ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msub> <mml:mo>|</mml:mo> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>.</p>
</list-item>
</list>
<p>In the example, because <inline-formula id="pcbi.1006883.e039"><alternatives><graphic id="pcbi.1006883.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006883.e039" xlink:type="simple"/><mml:math display="inline" id="M39"><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mover accent="true"><mml:mi>κ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>&lt;</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mi>T</mml:mi> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, only stages I–III are present. The energy saved is 20% of the energy output from muscle 2 without the tendon and accounts for 60% of the total negative power that can potentially be saved. The remaining 40% of the energy is wasted in the tendon muscle due to the lengthening of the tendon-muscle system at the beginning of stage II (gray curves in <xref ref-type="fig" rid="pcbi.1006883.g009">Fig 9C</xref>). If the tendon is elastic, then the energy could be saved during the lengthening and be released during the shortening in the later stage II to further improve efficiency. The muscle activation at point 1 comes from the combination of muscle 1 and tendon muscle, which take a half period on one side of the body, and the muscle activation at point 2 only comes from muscle 2, which takes less than a half period (see the bars at the bottom of <xref ref-type="fig" rid="pcbi.1006883.g009">Fig 9B</xref>).</p>
</sec>
<sec id="sec014">
<title>Error associated with <italic>Re</italic></title>
<p>The low swimming speeds that we observed (compared with those of real animals) are likely due to the low <italic>Re</italic> used in our simulations. However, we argue that the results are qualitatively representative of real adult fish. First, a meta-analysis of previously reported fish swimming data indicates that the transition from the viscous regime to the turbulent regime occurs at a <italic>Re</italic> of several thousand [<xref ref-type="bibr" rid="pcbi.1006883.ref026">26</xref>]. Second, even the eel model in our study shows an inertia-dominated mode of swimming. Because the drag coefficient decreases with increasing <italic>Re</italic> in general, the speed of the simulated swimmer is expected to increase with increasing <italic>Re</italic>, and the contribution of the resistive force is expected to decrease for a real adult eel.</p>
</sec>
<sec id="sec015">
<title>Conclusion</title>
<p>Using 3D numerical models, we provide the most accurate prediction of the torque and power required for hydrodynamic forces during the undulatory swimming of fish. By considering the torque and power transfer by tendons and the body viscoelasticity, we for the first time provide explanations for some long-standing questions in muscle activation patterns: the shortening of muscle activations in carangiform swimmers and reversal of the wave of the offset of EMG. Our study offers an integrative view of the function of the muscles as part of the mechanical system, highlights the differences in the internal driving of two primary swimming modes, and provides insights into the energy transfer and energy saving mechanisms by body elasticity and tendons in undulatory swimming. The numerical models developed and the mechanisms revealed in this study may guide the design of efficient bioinspired robots, especially soft robots with distributed driving systems and elastic bodies [<xref ref-type="bibr" rid="pcbi.1006883.ref027">27</xref>, <xref ref-type="bibr" rid="pcbi.1006883.ref028">28</xref>].</p>
</sec>
</sec>
<sec id="sec016">
<title>Supporting information</title>
<supplementary-material id="pcbi.1006883.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006883.s001" xlink:type="simple">
<label>S1 Appendix</label>
<caption>
<title>Description of the method to satisfy momentum conservation and obtain kinematics in the body frames.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006883.s002" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006883.s002" xlink:type="simple">
<label>S2 Appendix</label>
<caption>
<title>Sensitivity and convergence tests.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006883.s003" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006883.s003" xlink:type="simple">
<label>S3 Appendix</label>
<caption>
<title>Derivation of the torque and power from pure resistive forces and reactive forces.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006883.s004" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006883.s004" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>The kinematics of the swimmers in their own body frames (free movement in vacuum).</title>
<p>(A) Eel. (B) Mackerel.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006883.s005" mimetype="video/x-msvideo" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006883.s005" xlink:type="simple">
<label>S1 Video</label>
<caption>
<title>The force distribution along the body of the eel.</title>
<p>The black line represents the midline of the fish and the red arrows represent the hydrodynamic forces. The head is on the left and the tail is on the right.</p>
<p>(AVI)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006883.s006" mimetype="video/x-msvideo" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006883.s006" xlink:type="simple">
<label>S2 Video</label>
<caption>
<title>The force distribution along the body of the mackerel.</title>
<p>The black line represents the midline of the fish and the red arrows represent the hydrodynamic forces. The head is on the left and the tail is on the right.</p>
<p>(AVI)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006883.s007" mimetype="video/x-msvideo" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006883.s007" xlink:type="simple">
<label>S3 Video</label>
<caption>
<title>The torque distribution along the body of the eel.</title>
<p>The magnitude of the torque in the <italic>z</italic> direction is represented by the color.</p>
<p>(AVI)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006883.s008" mimetype="video/x-msvideo" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006883.s008" xlink:type="simple">
<label>S4 Video</label>
<caption>
<title>The torque distribution along the body of the mackerel.</title>
<p>The magnitude of the torque in the <italic>z</italic> direction is represented by the color.</p>
<p>(AVI)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006883.s009" mimetype="video/x-msvideo" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006883.s009" xlink:type="simple">
<label>S5 Video</label>
<caption>
<title>The torques from simulations with different mesh sizes for the eel.</title>
<p>(AVI)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We thank Prof. Fotis Sotiropoulos and Prof. Iman Borazjani for sharing the shape data of the fish.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1006883.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Williams</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Grillner</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Smoljaninov</surname> <given-names>VV</given-names></name>, <name name-style="western"><surname>Allen</surname> <given-names>PW</given-names></name>, <name name-style="western"><surname>Kashin</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Rossignol</surname> <given-names>S</given-names></name>. <article-title>Locomotion in lamprey and trout: the relative timing of activationand movement</article-title>. <source>Journal of Experimental Biology</source>. <year>1989</year>;<volume>143</volume>:<fpage>559</fpage>–<lpage>566</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006883.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wardle</surname> <given-names>CS</given-names></name>, <name name-style="western"><surname>Videler</surname> <given-names>JJ</given-names></name>. <article-title>The timing of the electromyogram in the lateral myotomes of mackereland saithe at different swimming speeds</article-title>. <source>Journal of Fish Biology</source>. <year>1993</year>;<volume>42</volume>(<issue>3</issue>):<fpage>347</fpage>–<lpage>359</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/j.1095-8649.1993.tb00338.x" xlink:type="simple">10.1111/j.1095-8649.1993.tb00338.x</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006883.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gillis</surname> <given-names>GB</given-names></name>. <article-title>Neuromuscular control of anguilliform locomotion: patterns of red andwhite muscle activity during swimming in the American eel Anguilla rostrata</article-title>. <source>Journal of Experimental Biology</source>. <year>1998</year>;<volume>201</volume>:<fpage>3245</fpage>–<lpage>3256</lpage>. <object-id pub-id-type="pmid">9808837</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006883.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Leeuwen</surname> <given-names>Jv</given-names></name>, <name name-style="western"><surname>Lankheet</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Akster</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Osse</surname> <given-names>J</given-names></name>. <article-title>Function of red axial muscles of carp (Cyprinus carpio): recruitmentand normalized power output during swimming in different modes</article-title>. <source>Journal of Zoology</source>. <year>1990</year>;<volume>220</volume>(<issue>1</issue>):<fpage>123</fpage>–<lpage>145</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/j.1469-7998.1990.tb04298.x" xlink:type="simple">10.1111/j.1469-7998.1990.tb04298.x</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006883.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rome</surname> <given-names>LC</given-names></name>, <name name-style="western"><surname>Swank</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Corda</surname> <given-names>D</given-names></name>. <article-title>How fish power swimming</article-title>. <source>Science</source>. <year>1993</year>;<volume>261</volume>(<issue>5119</issue>):<fpage>340</fpage>–<lpage>343</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006883.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wardle</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Videler</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Altringham</surname> <given-names>J</given-names></name>. <article-title>Tuning in to fish swimming waves: body form, swimming mode and musclefunction</article-title>. <source>Journal of Experimental Biology</source>. <year>1995</year>;<volume>198</volume>(<issue>8</issue>):<fpage>1629</fpage>–<lpage>1636</lpage>. <object-id pub-id-type="pmid">9319534</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006883.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Chen</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Friesen</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Iwasaki</surname> <given-names>T</given-names></name>. <article-title>Mechanisms underlying rhythmic locomotion: body–fluid interaction inundulatory swimming</article-title>. <source>Journal of Experimental Biology</source>. <year>2011</year>;<volume>214</volume>(<issue>4</issue>):<fpage>561</fpage>–<lpage>574</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1242/jeb.048751" xlink:type="simple">10.1242/jeb.048751</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006883.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hess</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Videler</surname> <given-names>JJ</given-names></name>. <article-title>Fast continuous swimming of saithe (<italic>Pollachius virens</italic>): a dynamicanalysis of bending moments and muscle power</article-title>. <source>Journal of Experimental Biology</source>. <year>1984</year>;<volume>109</volume>(<issue>1</issue>):<fpage>229</fpage>–<lpage>251</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006883.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cheng</surname> <given-names>JY</given-names></name>, <name name-style="western"><surname>Blickhan</surname> <given-names>R</given-names></name>. <article-title>Bending moment distribution along swimming fish</article-title>. <source>Journal of Theoretical Biology</source>. <year>1994</year>;<volume>168</volume>(<issue>3</issue>):<fpage>337</fpage>–<lpage>348</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1006/jtbi.1994.1114" xlink:type="simple">10.1006/jtbi.1994.1114</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006883.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cheng</surname> <given-names>JY</given-names></name>, <name name-style="western"><surname>Pedley</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Altringham</surname> <given-names>J</given-names></name>. <article-title>A continuous dynamic beam model for swimming fish</article-title>. <source>Philosophical Transactions of the Royal Society of London Series B:Biological Sciences</source>. <year>1998</year>;<volume>353</volume>(<issue>1371</issue>):<fpage>981</fpage>–<lpage>997</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1098/rstb.1998.0262" xlink:type="simple">10.1098/rstb.1998.0262</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006883.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>McMillen</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Williams</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Holmes</surname> <given-names>P</given-names></name>. <article-title>Nonlinear muscles, passive viscoelasticity and body taper conspire tocreate neuromechanical phase lags in anguilliform swimmers</article-title>. <source>PLoS Computational Biology</source>. <year>2008</year>;<volume>4</volume>(<issue>8</issue>):<fpage>e1000157</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1000157" xlink:type="simple">10.1371/journal.pcbi.1000157</ext-link></comment> <object-id pub-id-type="pmid">18769734</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006883.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tytell</surname> <given-names>ED</given-names></name>, <name name-style="western"><surname>Hsu</surname> <given-names>CY</given-names></name>, <name name-style="western"><surname>Williams</surname> <given-names>TL</given-names></name>, <name name-style="western"><surname>Cohen</surname> <given-names>AH</given-names></name>, <name name-style="western"><surname>Fauci</surname> <given-names>LJ</given-names></name>. <article-title>Interactions between internal forces, body stiffness, and fluidenvironment in a neuromechanical model of lamprey swimming</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2010</year>;<volume>107</volume>(<issue>46</issue>):<fpage>19832</fpage>–<lpage>19837</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1011564107" xlink:type="simple">10.1073/pnas.1011564107</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006883.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wolfgang</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Anderson</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Grosenbaugh</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Yue</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Triantafyllou</surname> <given-names>M</given-names></name>. <article-title>Near-body flow dynamics in swimming fish</article-title>. <source>Journal of Experimental Biology</source>. <year>1999</year>;<volume>202</volume>(<issue>17</issue>):<fpage>2303</fpage>. <object-id pub-id-type="pmid">10441083</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006883.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Borazjani</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Sotiropoulos</surname> <given-names>F</given-names></name>. <article-title>On the role of form and kinematics on the hydrodynamics ofself-propelled body/caudal fin swimming</article-title>. <source>Journal of Experimental Biology</source>. <year>2010</year>;<volume>213</volume>(<issue>1</issue>):<fpage>89</fpage>–<lpage>107</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1242/jeb.030932" xlink:type="simple">10.1242/jeb.030932</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006883.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tytell</surname> <given-names>ED</given-names></name>, <name name-style="western"><surname>Lauder</surname> <given-names>GV</given-names></name>. <article-title>The hydrodynamics of eel swimming. I. Wake structure</article-title>. <source>Journal of Experimental Biology</source>. <year>2004</year>;<volume>207</volume>(<issue>11</issue>):<fpage>1825</fpage>–<lpage>1841</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1242/jeb.00968" xlink:type="simple">10.1242/jeb.00968</ext-link></comment> <object-id pub-id-type="pmid">15107438</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006883.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Song</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Luo</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Hedrick</surname> <given-names>TL</given-names></name>. <article-title>Three-dimensional flow and lift characteristics of a hoveringruby-throated hummingbird</article-title>. <source>Journal of The Royal Society Interface</source>. <year>2014</year>;<volume>11</volume>(<issue>98</issue>):<fpage>20140541</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1098/rsif.2014.0541" xlink:type="simple">10.1098/rsif.2014.0541</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006883.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Luo</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Dai</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>de Sousa</surname> <given-names>PJF</given-names></name>, <name name-style="western"><surname>Yin</surname> <given-names>B</given-names></name>. <article-title>On the numerical oscillation of the direct-forcing immersed-boundarymethod for moving boundaries</article-title>. <source>Computers &amp; Fluids</source>. <year>2012</year>;<volume>56</volume>:<fpage>61</fpage>–<lpage>76</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.compfluid.2011.11.015" xlink:type="simple">10.1016/j.compfluid.2011.11.015</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006883.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ming</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Ding</surname> <given-names>Y</given-names></name>. <article-title>Transition and formation of the torque pattern of undulatorylocomotion in resistive force dominated media</article-title>. <source>Bioinspiration &amp; biomimetics</source>. <year>2018</year>;<volume>13</volume>(<issue>4</issue>):<fpage>046001</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1088/1748-3190/aab805" xlink:type="simple">10.1088/1748-3190/aab805</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006883.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Long</surname> <given-names>JH</given-names> <suffix>Jr</suffix></name>. <article-title>Muscles, elastic energy, and the dynamics of body stiffness inswimming eels</article-title>. <source>American zoologist</source>. <year>1998</year>;<volume>38</volume>(<issue>4</issue>):<fpage>771</fpage>–<lpage>792</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/icb/38.4.771" xlink:type="simple">10.1093/icb/38.4.771</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006883.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Alben</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Witt</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Baker</surname> <given-names>TV</given-names></name>, <name name-style="western"><surname>Anderson</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Lauder</surname> <given-names>GV</given-names></name>. <article-title>Dynamics of freely swimming flexible foils</article-title>. <source>Physics of Fluids</source>. <year>2012</year>;<volume>24</volume>(<issue>5</issue>):<fpage>051901</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1063/1.4709477" xlink:type="simple">10.1063/1.4709477</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006883.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Elftman</surname> <given-names>H</given-names></name>. <article-title>The work done by muscles in running</article-title>. <source>American Journal of Physiology</source>. <year>1940</year>;<volume>129</volume>(<issue>3</issue>):<fpage>672</fpage>–<lpage>684</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1152/ajplegacy.1940.129.3.672" xlink:type="simple">10.1152/ajplegacy.1940.129.3.672</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006883.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Junius</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Moltedo</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Cherelle</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Rodriguez-Guerrero</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Vanderborght</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Lefeber</surname> <given-names>D</given-names></name>. <article-title>Biarticular elements as a contributor to energy efficiency:biomechanical review and application in bio-inspired robotics</article-title>. <source>Bioinspiration &amp; biomimetics</source>. <year>2017</year>;<volume>12</volume>(<issue>6</issue>):<fpage>061001</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1088/1748-3190/aa806e" xlink:type="simple">10.1088/1748-3190/aa806e</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006883.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Shadwick</surname> <given-names>RE</given-names></name>, <name name-style="western"><surname>Gemballa</surname> <given-names>S</given-names></name>. <article-title>Structure, kinematics, and muscle dynamics in undulatory swimming</article-title>. <source>Fish physiology</source>. <year>2005</year>;<volume>23</volume>:<fpage>241</fpage>–<lpage>280</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/S1546-5098(05)23007-8" xlink:type="simple">10.1016/S1546-5098(05)23007-8</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006883.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gemballa</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Treiber</surname> <given-names>K</given-names></name>. <article-title>Cruising specialists and accelerators–Are different types of fishlocomotion driven by differently structured myosepta?</article-title> <source>Zoology</source>. <year>2003</year>;<volume>106</volume>(<issue>3</issue>):<fpage>203</fpage>–<lpage>222</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1078/0944-2006-00116" xlink:type="simple">10.1078/0944-2006-00116</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006883.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Liron</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Shahar</surname> <given-names>R</given-names></name>. <article-title>Stokes flow due to a Stokeslet in a pipe</article-title>. <source>Journal of Fluid Mechanics</source>. <year>1978</year>;<volume>86</volume>(<issue>4</issue>):<fpage>727</fpage>–<lpage>744</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1017/S0022112078001366" xlink:type="simple">10.1017/S0022112078001366</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006883.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Weerden</surname> <given-names>JF</given-names></name>, <name name-style="western"><surname>Reid</surname> <given-names>DA</given-names></name>, <name name-style="western"><surname>Hemelrijk</surname> <given-names>CK</given-names></name>. <article-title>A meta-analysis of steady undulatory swimming</article-title>. <source>Fish and Fisheries</source>. <year>2014</year>;<volume>15</volume>(<issue>3</issue>):<fpage>397</fpage>–<lpage>409</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/faf.12022" xlink:type="simple">10.1111/faf.12022</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006883.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zhu</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Cao</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Liu</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Yang</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>X</given-names></name>. <article-title>Architectures of soft robotic locomotion enabled by simple mechanicalprinciples</article-title>. <source>Soft matter</source>. <year>2017</year>;<volume>13</volume>(<issue>25</issue>):<fpage>4441</fpage>–<lpage>4456</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1039/c7sm00636e" xlink:type="simple">10.1039/c7sm00636e</ext-link></comment> <object-id pub-id-type="pmid">28632275</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006883.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Shintake</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Cacucciolo</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Shea</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Floreano</surname> <given-names>D</given-names></name>. <article-title>Soft biomimetic fish robot made of dielectric elastomer actuators</article-title>. <source>Soft robotics</source>. <year>2018</year>;<volume>5</volume>(<issue>4</issue>):<fpage>466</fpage>–<lpage>474</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1089/soro.2017.0062" xlink:type="simple">10.1089/soro.2017.0062</ext-link></comment> <object-id pub-id-type="pmid">29957131</object-id></mixed-citation>
</ref>
</ref-list>
</back>
</article>