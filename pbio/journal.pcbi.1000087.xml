<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN"><front><journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher><publisher-name>Public Library of Science</publisher-name><publisher-loc>San Francisco, USA</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">07-PLCB-RA-0768R2</article-id><article-id pub-id-type="doi">10.1371/journal.pcbi.1000087</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline"><subject>Computational Biology/Computational Neuroscience</subject><subject>Computational Biology/Genomics</subject><subject>Computational Biology/Signaling Networks</subject><subject>Computational Biology/Systems Biology</subject><subject>Computer Science/Systems and Control Theory</subject><subject>Mathematics/Statistics</subject><subject>Physiology/Cognitive Neuroscience</subject><subject>Physiology/Integrative Physiology</subject></subj-group></article-categories><title-group><article-title>Uncovering Interactions in the Frequency Domain</article-title><alt-title alt-title-type="running-head">Uncovering Interactions in Frequency Domain</alt-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Guo</surname><given-names>Shuixia</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Wu</surname><given-names>Jianhua</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Ding</surname><given-names>Mingzhou</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Feng</surname><given-names>Jianfeng</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff4"><sup>4</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib></contrib-group><aff id="aff1"><label>1</label><addr-line>Department of Mathematics, Hunan Normal University, Changsha, China</addr-line>       </aff><aff id="aff2"><label>2</label><addr-line>Department of Computer Science and Mathematics, Warwick University, Coventry, United Kingdom</addr-line>       </aff><aff id="aff3"><label>3</label><addr-line>Crayton Pruitt Family Department of Biomedical Engineering, University of Florida Gainesville, Gainesville, Florida, United States of America</addr-line>       </aff><aff id="aff4"><label>4</label><addr-line>Centre for Computational System Biology, Fudan University, Shanghai, China</addr-line>       </aff><contrib-group><contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Friston</surname><given-names>Karl J.</given-names></name><role>Editor</role><xref ref-type="aff" rid="edit1"/></contrib></contrib-group><aff id="edit1">University College London, United Kingdom</aff><author-notes><corresp id="cor1">* E-mail: <email xlink:type="simple">Jianfeng.feng@warwick.ac.uk</email></corresp><fn fn-type="con"><p>Conceived and designed the experiments: SG JF. Performed the experiments: JF. Analyzed the data: SG JF. Contributed reagents/materials/analysis tools: SG JF. Wrote the paper: SG JF. Analyzed the gene data: JW. Analyzed the monkey data: MD.</p></fn><fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn></author-notes><pub-date pub-type="collection"><month>5</month><year>2008</year></pub-date><pub-date pub-type="epub"><day>30</day><month>5</month><year>2008</year></pub-date><volume>4</volume><issue>5</issue><elocation-id>e1000087</elocation-id><history><date date-type="received"><day>14</day><month>12</month><year>2007</year></date><date date-type="accepted"><day>17</day><month>4</month><year>2008</year></date></history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2008</copyright-year><copyright-holder>Guo et al</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract><p>Oscillatory activity plays a critical role in regulating biological processes at levels ranging from subcellular, cellular, and network to the whole organism, and often involves a large number of interacting elements. We shed light on this issue by introducing a novel approach called partial Granger causality to reliably reveal interaction patterns in multivariate data with exogenous inputs and latent variables in the frequency domain. The method is extensively tested with toy models, and successfully applied to experimental datasets, including (1) gene microarray data of HeLa cell cycle; (2) in vivo multi-electrode array (MEA) local field potentials (LFPs) recorded from the inferotemporal cortex of a sheep; and (3) in vivo LFPs recorded from distributed sites in the right hemisphere of a macaque monkey.</p></abstract><abstract abstract-type="summary"><title>Author Summary</title><p>When predicting the structure of a network (a gene network, a protein network, a metabolic network or a neuronal network) based upon simultaneously recorded multi-variable temporal data, a major tool is either the Bayesian network or the Granger causality. We focused on the Granger causality, and it has become increasingly important in recent years because of the huge body of temporal data available in, for example, molecular biology (microarray gene data) and physiology (multi-electrode array recordings of multi-neurons). However, all methods of estimating the Granger causality tend to ignore latent variables, which are ubiquitous in experimental data. Here, we have developed a method that can eliminate the influence of latent variables in predicting the network structure. The method is then extended to the frequency domain. The ability of the method to eliminate the influence of latent variables is extensively verified in toy models and then applied to a gene circuit, a neuronal network, and a network of brain areas. Both in the time and frequency domains, our approach can be used to detect a network structure when multi-dimensional temporal data are available.</p></abstract><funding-group><funding-statement>This work was supported by BBSRC, EPSRC, and EU grants.</funding-statement></funding-group><counts><page-count count="10"/></counts></article-meta></front><body><sec id="s1"><title>Introduction</title><p>Recently, as reviewed in <xref ref-type="bibr" rid="pcbi.1000087-Longo1">[1]</xref>, many novel approaches in molecular biology have been invented to improve the bulk-scale methods that measure average values for a population of genes or proteins and mask their dynamical activities which are critical for the function of cells <xref ref-type="bibr" rid="pcbi.1000087-Hoffmann1">[2]</xref>–<xref ref-type="bibr" rid="pcbi.1000087-Nelson1">[4]</xref>. In neurophysiology, there is a long history of analyzing neural dynamics by recording at the single neuron, neuronal network and brain area levels. Based upon such experimental data, how to explore the network structure of genes, proteins, neurons, etc, is one of the most important issues in Systems Biology. In the literature, there exist two closely related approaches (see for example <xref ref-type="bibr" rid="pcbi.1000087-Ghahramani1">[5]</xref>–<xref ref-type="bibr" rid="pcbi.1000087-Pearl1">[8]</xref>): Bayesian modeling and Granger causality analysis. The appealing properties of the Granger causality approach are: (1) the flow of time is explicitly used to define causal relationships; (2) there is a frequency decomposition that reveals the frequency at which two units or variables interact with each other.</p><p>In the current paper we concentrate on the Granger causality approach. The concept of Granger causality, originally introduced by Wiener <xref ref-type="bibr" rid="pcbi.1000087-Wiener1">[9]</xref> and later formalized by Granger <xref ref-type="bibr" rid="pcbi.1000087-Granger1">[10]</xref>, has played an important role in investigating the relationship among stationary time series. Specifically, given two time series, if the variance of the prediction error for the second time series at the present time is reduced by including past measurements from the first time series in the (non)linear regression model, then the first time series can be said to cause the second time series. Geweke's decomposition of a vector autoregressive process <xref ref-type="bibr" rid="pcbi.1000087-Geweke1">[11]</xref> led to a set of causality measures which have a spectral representation and make the interpretation more informative and useful <xref ref-type="bibr" rid="pcbi.1000087-Hosoya1">[12]</xref>.</p><p>We first develop a novel approach to calculate Granger causality: partial Granger causality, both in the time and the frequency domain, aiming to deal with the case that the data recorded has latent variables. Employing toy models we compare our approach with partial directed coherence (PDC), which is used to detect direct influences in multivariate time series <xref ref-type="bibr" rid="pcbi.1000087-Gourevitch1">[13]</xref>. It is shown that partial Granger causality is able to reveal the right causal relationship whereas PDC fails (see <xref ref-type="fig" rid="pcbi-1000087-g001">Figure 1</xref>). The simple reason is that our decomposition relies on the Kolmogrov equation, but PDC type of approach lacks this property. As a consequence, the results in the frequency domain decomposition could be in conflict with the results in the time domain.</p><fig id="pcbi-1000087-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000087.g001</object-id><label>Figure 1</label><caption><title>Frequency decomposition.</title><p>Comparison of the frequency decomposition of all 20 kinds of relationships between the partial Granger causality (PGC) and PDC for data in Example 1 with <italic>a<sub>i</sub></italic>∼<italic>U</italic>[0,1], <italic>b<sub>i</sub></italic> = 2, <italic>c<sub>i</sub></italic> = 5, <italic>i</italic> = 1,…5. Upper panels are the results of PGC, and bottom panels are the results of PDC.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000087.g001" xlink:type="simple"/></fig><p>After validating the approach we then apply it to three sets of experimental data. The first data set is microarray data from the IκB-NF-κB circuit in HeLa cell <xref ref-type="bibr" rid="pcbi.1000087-Whitfield1">[14]</xref>. Although the data has been widely analyzed in the literature, no results in the frequency domain have been reported. Our approach reveals three basic frequencies in the circuit. The first one with a period of 16 hours is the HeLa cycle time. The second one with a period of 4 hours has been reported in the past by other analysis methods <xref ref-type="bibr" rid="pcbi.1000087-Hoffmann1">[2]</xref>–<xref ref-type="bibr" rid="pcbi.1000087-Krishna1">[3]</xref>. Finally, the third frequency feature has a period of around 10 hours and has been observed in other gene networks, such as the P53 network <xref ref-type="bibr" rid="pcbi.1000087-Longo1">[1]</xref>. Our causality analysis further reveals how these genes interact with each other at the three identified frequencies in the IκB-NF-κB circuit. The second data set consists of multi-electrode array recordings from the inferotemporal cortex (IT) of a sheep performing a stimulus discrimination task. Five channels are used in our analysis to illustrate the application of our approach. The third set of data is recorded with transcortical bipolar electrodes from 15 distributed sites in the right hemisphere of a monkey trained to perform a visuomotor task. In comparison with the results obtained from the conditional Granger causality analysis, an additional interaction between two areas is found.</p></sec><sec id="s2"><title>Results</title><sec id="s2a"><title>Toy Model</title><p>To illustrate the frequency decomposition of the partial Granger causality introduced here, we first consider a toy model with exogenous inputs and latent variables (see <xref ref-type="sec" rid="s3">Methods</xref> section). In this model 5 simultaneously generated time series are defined by the equations<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000087.e001" xlink:type="simple"/></disp-formula>where ε<italic><sub>i</sub></italic>(<italic>t</italic>),<italic>i</italic> = 1,2,…7 are zero-mean uncorrelated processes with identical variances, <italic>a<sub>i</sub></italic>ε<sub>6</sub>is the exogenous input, and the term <italic>b<sub>i</sub></italic>ε<sub>7</sub>(<italic>t</italic>−1)+<italic>c<sub>i</sub></italic>ε<sub>7</sub>(<italic>t</italic>−2) represents the influence of latent variables.</p><p>From the model, one can see that <italic>x</italic><sub>1</sub>(<italic>t</italic>) is a direct source to <italic>x</italic><sub>2</sub>(<italic>t</italic>), <italic>x</italic><sub>3</sub>(<italic>t</italic>), and <italic>x</italic><sub>4</sub>(<italic>t</italic>), <italic>x</italic><sub>4</sub>(<italic>t</italic>) and <italic>x</italic><sub>5</sub>(<italic>t</italic>) share a feedback loop, and there is no direct connection between <italic>x</italic><sub>1</sub>(<italic>t</italic>) and <italic>x</italic><sub>5</sub>(<italic>t</italic>). We perform a simulation of this system with <italic>a<sub>i</sub></italic>∼<italic>U</italic>[0,1], <italic>b<sub>i</sub></italic> = 2, <italic>c<sub>i</sub></italic> = 5, <italic>i</italic> = 1,…5 (we extensively tested our approach in other more general cases of <italic>a<sub>i</sub></italic>, <italic>b<sub>i</sub></italic>, <italic>c<sub>i</sub></italic>, see <xref ref-type="bibr" rid="pcbi.1000087-Gourevitch1">[13]</xref>) to generate a data set of 2000 data points with a sample rate of 200 Hz. <xref ref-type="fig" rid="pcbi-1000087-g002">Figure 2A</xref> illustrates the traces of 5 time series. It is obvious that the system is stationary. The network structure is depicted in <xref ref-type="fig" rid="pcbi-1000087-g002">Figure 2B</xref>. <xref ref-type="fig" rid="pcbi-1000087-g002">Figure 2C</xref> is the comparison between our partial Granger causality <italic>F</italic><sup>(1)</sup> and the conditional Granger causality <italic>F</italic><sup>(2)</sup> <xref ref-type="bibr" rid="pcbi.1000087-Ding1">[15]</xref>. It is clearly shown that our partial Granger causality outperforms the conditional Granger causality. The values of the conditional Granger causality are all very small due to the latent variables and common inputs, while the correct structure is revealed via the partial Granger causality. In particular, the interaction 4→5 is not identified by the conditional causality, but it is correctly revealed in our partial Granger causality approach.</p><fig id="pcbi-1000087-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000087.g002</object-id><label>Figure 2</label><caption><title>Simulation results.</title><p>(A) Traces of the time series we considered in Example 1 when <italic>a<sub>i</sub></italic>∼<italic>U</italic>[0,1], <italic>b<sub>i</sub></italic> = 2, <italic>c<sub>i</sub></italic> = 5, <italic>i</italic> = 1,…5. <italic>x</italic><sub>2</sub>,<italic>x</italic><sub>3</sub>,<italic>x</italic><sub>4</sub> and <italic>x</italic><sub>5</sub> are shifted upward for visualization purpose. (B) The causality structure is plotted. (C) Comparison of the partial Granger causality <italic>F</italic><sup>(1)</sup> and the conditional Granger causality <italic>F</italic><sup>(2)</sup> when <italic>a<sub>i</sub></italic>∼<italic>U</italic>[0,1]. It is obvious that <italic>F</italic><sup>(2)</sup> fails to pick up the correct relationship while the inferred relationship from <italic>F</italic><sup>(1)</sup> is consistent with the true structure (B). (D) Comparison of the partial Granger causality in the time domain and frequency domain when <italic>a<sub>i</sub></italic>∼<italic>U</italic>[0,1], <italic>i</italic> = 1,…5 in Example 1. The blue line represents the case of time domain, and the red line is the integral of the frequency domain in the interval [−π, π].</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000087.g002" xlink:type="simple"/></fig><p><xref ref-type="fig" rid="pcbi-1000087-g002">Figure 2D</xref> presents a comparison between the time domain partial Granger causality and the frequency domain partial Granger causality. Blue line is the value of the partial Granger causality for all 20 kinds of relationship calculated in the time domain. Red line is the summation (integration) of the partial Granger causality for frequencies in the range of [−π,π]. As expected, <xref ref-type="fig" rid="pcbi-1000087-g002">Figure 2D</xref> demonstrates that the decomposition in the frequency domain fits very well with the partial Granger causality in the time domain.</p><p>As mentioned before, PDC has been used in the literature to reveal the causal relationship in the frequency domain <xref ref-type="bibr" rid="pcbi.1000087-Gourevitch1">[13]</xref>. However, it lacks a theoretical foundation. <xref ref-type="fig" rid="pcbi-1000087-g001">Figure 1</xref> is the detailed comparison of the causality in the frequency domain of all 20 kinds of relationship between the partial Granger causality (PGC) and PDC. The upper panels are the results obtained from the PGC in the frequency domain. It is easy to see that there are direct causal drives from 1 to 2, 3 and 4, and a feedback between 5 and 4. Most importantly it is consistent with the results in the time domain. The bottom panels are the results obtained from PDC. It is evident that the causality for almost all relationship is significant, in contradiction with the results in the time domain. In addition to the exampled considered here, more extensive testing of the PGC has been carried out and comparison made with existing approaches (see <xref ref-type="supplementary-material" rid="pcbi.1000087.s001">Text S1</xref>). Next we apply PGC to the experimental data.</p></sec><sec id="s2b"><title>NF-κB: A Tri-Frequency Circuit</title><p>We applied partial causality analysis to HeLa cell cycle gene expression data collected by Whitfield et al. (2002) <xref ref-type="bibr" rid="pcbi.1000087-Whitfield1">[14]</xref>. These data contain three complete cell cycles, i.e., 48 time points distributed at intervals of 1 h, where the HeLa cell cycle is 16 h. This data can be downloaded at <ext-link ext-link-type="uri" xlink:href="http://genome-www.stanford.edu/Human-CellCycle/Hela/" xlink:type="simple">http://genome-www.stanford.edu/Human-CellCycle/Hela/</ext-link>. At each time point, there are three or four replicates for each gene selected.</p><p>The NF-κB, a stress-regulated transcription factor belonging to the Rel family, plays a pivotal role in the control of inflammatory and innate responses. NF-κB activation has been related to multiple aspects of tumorigenesis, including the control of cell proliferation and migration, cell cycle progression and apoptosis. Whereas only limited information is available regarding the direct involvement of NF-κB in cell-cycle regulation, it was also found that the levels of NF-κB activation are linked to signaling that controls cell-cycle progression in HeLa cells.</p><p>Here we applied pairwise Granger causality method and partial Granger causality (PGC) methods based on a sliding-window VAR model. We only applied both methods to one typical gene modules, which is regulated by 2 transcription factors, namely: nuclear factor-κB (NF-κB) in the context of cell cycle progression of transformed HeLa cells. In <xref ref-type="fig" rid="pcbi-1000087-g003">Figure 3A</xref>, we plotted the original data and fitted VAR model (dotted lines). The obtained results of Granger causality in the time domain are depicted in <xref ref-type="fig" rid="pcbi-1000087-g003">Figure 3B</xref> (pairwise Granger causality) and in <xref ref-type="fig" rid="pcbi-1000087-g003">Figure 3C</xref> (PGC).</p><fig id="pcbi-1000087-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000087.g003</object-id><label>Figure 3</label><caption><title>Results for microarray data.</title><p>(A) Gene expression profile plot of actual data and fitted data by AR model to the NF-κB, NEMO, IKKα, Iand κB genes. A network is composed based on calculated time domain causality for gene module NF-κB, which contains NF-κB, NEMO, IKKα, and IκB genes. (B) is constructed based on pairwise Granger causality method, and (C) is constructed based on PGC method. According to the confidence interval, two connections become insignificant after partial influence is taken into account. (D) Power spectrum density (PSD) for IKKα, NEMO, IκB, and NF-κB genes. There is only one frequency at 16 hours in IKKα, but there are two prominent frequencies for NEMO, IκB, and NF-κB at 16 hours and 4 hours. (E) Frequency domain causality for IKKα, NEMO, IκB, and NF-κB genes.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000087.g003" xlink:type="simple"/></fig><p>Our gene expression analysis (<xref ref-type="fig" rid="pcbi-1000087-g003">Figure 3</xref>) indicates that the activation of NF-κB correlates with increased activity of IKKα, a natural repressor of IκB -dependent inhibition of NF-κB. As presented in <xref ref-type="fig" rid="pcbi-1000087-g003">Figure 3B</xref>, for the causal network of NF-κB module based on pairwise Granger causality analysis, there are directional connections between IKKα, NEMO and IκB, and also bidirectional connections between IKKα, IκB and NF-κB. Here only the causality that is significant is shown, and the magnitude of the causality and the confidence interval are presented along the arrows. <xref ref-type="fig" rid="pcbi-1000087-g003">Figure 3C</xref> shows the causal network of NF-κB module based on partial Granger causality analysis presented in this paper. Four directional causality connections are preserved and two are eliminated after partial causality analysis is applied. As reported by experimental data, the activity of NF-κB is tightly regulated by its interaction with inhibitory IκB proteins. Activation of NF-κB is achieved through the action of a family of serine/threonine k (IKK). The IKK contains two catalytic subunits (IKKα and IKKβ) and a regulatory/adapter protein NEMO (also known as IKKγ). The causality analysis of NF-κB moduai le presents the activation progression of NF-κB, and it also depicts the causal effect of each gene during the transcription progression. The results indicate that NF-κB transcription factor participates (directly or indirectly) in the control of a complex pattern of HeLa cell cycle regulators in a bidirectional fashion.</p><p>As discussed in the <xref ref-type="sec" rid="s3">Methods</xref> section, the Granger causality is consistent in both time and frequency domains. However, it may be more convenient to decompose the time domain causality into its frequency content, such that the profile connections can be examined under a specific frequency. <xref ref-type="fig" rid="pcbi-1000087-g003">Figure 3D</xref> presents the power spectrum plot for four genes. The power of the four genes concentrates on three specific frequencies <italic>f</italic><sub>1</sub> = 0.061, <italic>f</italic><sub>2</sub> = 0.011, and <italic>f</italic><sub>3</sub> = 0.22 h<sup>−1</sup>. Then partial frequency causality in the frequency domain is calculated.</p><p>It is interesting to see that the peak of IKKα→NEMO is around 16 hours, which implies that the HeLa cell cycle is originated from the driving of IKKα. The peak causality of NEMO→IκB is at 10 hours. Although the power at 10-hour frequency is less that the other two, it is consistently presented in all genes. To the best of our knowledge, it seems there are no direct reports on the 10-hour frequency of the NF-κB circuit. However, it is reported in, for example, the p53 circuit (see Figure 1A in <xref ref-type="bibr" rid="pcbi.1000087-Longo1">[1]</xref>). The important role played by NF-κB to regulate the p53 circuit has been reported in <xref ref-type="bibr" rid="pcbi.1000087-Jeong1">[16]</xref>. The second peak of NEMO→IκB locates at around 4-hour frequency and PSD is very significant in both NEMO and IκB. This frequency is reported in, for example, Figure 2 in <xref ref-type="bibr" rid="pcbi.1000087-Krishna1">[3]</xref>. From our analysis, we conclude that the 4-hour frequency is generated from NEMO, but it is absent in IKKα. It would be interesting to test this experimentally and single out its functional meaning. Furthermore, the driving from IκB to NF-κB is mainly at 16-hour frequency and its harmonic (8-hour) frequency. Finally the feedback from NF-κB to IκB is less frequency specific.</p></sec><sec id="s2c"><title>Intra-Network Data: Theta-Frequency Circuit</title><p>The experimental data set is the local field potential (LFP) data that was collected from the inferotemporal cortex in left and right hemisphere of the sheep. Multi-electrode array recordings consisted of 64 channels in each hemisphere and individual electrodes were fabricated from tungsten wires (125µ diam.) sharpened to a tip smaller than 1 µ and insulated with epoxylite. The sampling frequency for the LFPs was 2000 Hz. The sheep were trained to perform an operant discrimination task in which different pairs of sheep faces were presented and a correct panel-press response elicited a food reward <xref ref-type="bibr" rid="pcbi.1000087-Horton1">[17]</xref>–<xref ref-type="bibr" rid="pcbi.1000087-Wu3">[21]</xref>.</p><p>Inferior temporal (IT) cortex is considered to be the highest processing stage along the ventral pathway in the visual system. It is implicated in such higher cognitive functions as categorization and memory formation. fMRI study has reported that ventral temporal regions of primates can be differently activated by different visual stimuli, such as faces, houses and other objects <xref ref-type="bibr" rid="pcbi.1000087-Ishai1">[22]</xref>. Recently both spikes and local field potentials have been found to be selective to a variety of stimuli and they are tolerant to retinal position and size <xref ref-type="bibr" rid="pcbi.1000087-Kreiman1">[23]</xref>.</p><p>Much of current studies are based on either neuroimaging or single unit recording techniques. fMRI can accurately locate the brain regions that are active during a visual task but its temporal resolution is poor. Single unit recordings provide direct detailed neuronal information but it is unable to investigate large neuronal ensembles. We use multi-electrode array that consists of up to 128 electrodes and make recordings in sheep IT cortex in both brain hemispheres while animals performed discrimination tasks between pairs of faces and objects (see <xref ref-type="fig" rid="pcbi-1000087-g004">Figure 4A</xref>).</p><fig id="pcbi-1000087-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000087.g004</object-id><label>Figure 4</label><caption><title>Results for sheep data.</title><p>(A) Local field potential recorded from 64 channels. Time 0 is the starting point of stimuli. (B) Spatial-temporal pattern of theta power distribution (−500 to 500 ms) across the recording array for one experimental session in response to face presentation. Electrodes are arranged by the latency of the normalized theta power. The electrodes with increased power are marked by the filled colour on the electrode grid in different time slots of 50 ms in the duration 100–400 ms. (C) Partial Granger causality of all possible relationships in time domain. (D) The inferred structure from experimental data in the time domain. (E) The frequency decomposition of all possible relationship is consistent with the structure inferred from time domain.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000087.g004" xlink:type="simple"/></fig><p>To see the spatial power distribution on the recording array, the electrodes with increased theta power were arranged by the latency of each channel. <xref ref-type="fig" rid="pcbi-1000087-g004">Figure 4B</xref> shows the theta (3–10 Hz) power distribution on the electrode array. The activation of theta power for face stimuli is concentrated within the latency of 300–350 ms. The activated regions include part of the left hemisphere and nearly the whole area of the right hemisphere. The activation region for object presentation is similar in terms of its topographical positions on the array but the stimulus elicited a major activation starting at 200 ms in the left hemisphere which is followed by right hemisphere activation at 250 ms. The sequential activation is also observed for face stimuli in other recording sessions. Assuming that LFP carries input signals from lower brain areas, synchronized theta wave may represent a parallel input into IT while the sequence of theta waves with different latencies may reflect a traveling wave within the recorded region.</p><p>It is preferable that all links between distinct pairs of channels (64 channels) be found. However, even with the data size we have at the moment (10 seconds recordings with a sample rate of 2 K Hz), fitting a 64 dimensional model is somewhat problematic. Hence, here we only select five channels to demonstrate the application of our approach and will publish the biological results elsewhere. The links revealed in our approach could be thought of as ‘functional’ interactions between five channels, as defined in the fMRI literature <xref ref-type="bibr" rid="pcbi.1000087-Kim1">[24]</xref>. In fact, the limited data analyzed aligns well with the setup of the current paper: it contains the exogenous input (see below) and latent variables (due to unrecorded inputs and the fact that we only choose five channels).</p><p>The partial Granger causality in the time domain is shown in <xref ref-type="fig" rid="pcbi-1000087-g004">Figure 4C</xref>. The complete causal relationship is presented in <xref ref-type="fig" rid="pcbi-1000087-g004">Figure 4D</xref>. In <xref ref-type="fig" rid="pcbi-1000087-g004">Figure 4E</xref>, the partial Granger causality in the frequency domain is depicted. We conclude that the interaction between these channels is in the theta band. For example, the frequency decomposition corresponding to the peak (1→4) in <xref ref-type="fig" rid="pcbi-1000087-g004">Figure 4C</xref> in the time domain has a peak around 10 Hz. Although there are activities in the power spectral density in the gamma band for the five channels (not shown), we have not observed any interactions between these five channels.</p></sec><sec id="s2d"><title>Inter-Network Data: Beta- and Gamma-Frequency Circuit</title><p>We refer the reader to <xref ref-type="bibr" rid="pcbi.1000087-Ding1">[15]</xref> for details of the experiment. Briefly, the LFP data were collected when the monkey performed a GO/NO-GO visual pattern discrimination task. The presence of oscillatory field potential activity in the beta (14–30 Hz) frequency range was reported in the sensorimotor cortex during the prestimulus period.</p><p>It is pointed out in <xref ref-type="bibr" rid="pcbi.1000087-Ding1">[15]</xref> that if only pairwise Granger causality is applied, the connectivity structure is as depicted in <xref ref-type="fig" rid="pcbi-1000087-g005">Figure 5A</xref>. Using the conditional Granger causality, the causal relationship between the primary somatosensory (S1) and one of the inferior posterior parietal sites (in area 7a) is eliminated, a result predicted from anatomical considerations. Applying the partial Granger causality in the time domain, we obtain the results as shown in <xref ref-type="fig" rid="pcbi-1000087-g005">Figure 5B</xref>, where the actual values and the confidence intervals are depicted. 7b is another inferior posterior parietal site and M1 is the primary motor site. It is clearly seen that there are six causal relationships, i.e., S1→M1, 7b→M1, 7b→S1, 7b→7a, S1→7b, and finally 7a→7b. <xref ref-type="fig" rid="pcbi-1000087-g005">Figure 5C</xref> is the Granger causality in the frequency domain. According to <xref ref-type="fig" rid="pcbi-1000087-g005">Figure 5B</xref>, we see that there are six pairs which have significant Granger causality. The first five have been reported in the literature and are in the Beta band (10–30) Hz. The final one, 7a→7b, has a peak at a high frequency (the super Gamma band). It has been reported in the literature that the nervous systems use different frequency bands to communicate with each other <xref ref-type="bibr" rid="pcbi.1000087-Canolty1">[25]</xref>.</p><fig id="pcbi-1000087-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000087.g005</object-id><label>Figure 5</label><caption><title>Results for monkey data.</title><p>(A) Pairwise Granger causality of all possible relationships. (B) The partial Granger causality in the time domain. (C) Frequency decomposition of all possible relationships. (D) The inferred structure from experimental data. The four areas in the brain are marked in the upper trace and the detailed interactions are shown in the bottom trace. The dashed line indicates the additional interaction found using partial Granger causality.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000087.g005" xlink:type="simple"/></fig></sec></sec><sec id="s3"><title>Methods</title><sec id="s3a"><title>Partial Granger Causality: Time Domain</title><p>Consider a multiple stationary time series of dimension <italic>n</italic>, {<italic>W<sub>t</sub></italic>}. The series has the following vector autoregressive representation with the use of the lag operator <italic>L</italic>:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000087.e002" xlink:type="simple"/><label>(1)</label></disp-formula>where <italic>E</italic>(ξ<italic><sub>t</sub></italic>) = 0, var(ξ<italic><sub>t</sub></italic>) = Σ, an <italic>n</italic>×<italic>n</italic> matrix, and <italic>B</italic> is a polynomial matrix of <italic>L</italic>. <italic>B</italic>(0) = <italic>I<sub>n</sub></italic>, <italic>I<sub>n</sub></italic> is an <italic>n</italic>×<italic>n</italic> identity matrix. Now suppose that <italic>W<sub>t</sub></italic> has been decomposed into three vectors (measured variables) <italic>X<sub>t</sub></italic>, <italic>Y<sub>t</sub></italic>, and <italic>Z<sub>t</sub></italic> with <italic>k</italic>, <italic>l</italic>, and <italic>m</italic> dimensions, respectively, i.e., <italic>W<sub>t</sub></italic> = (<italic>X<sub>t</sub><sup>T</sup></italic>,<italic>Y<sub>t</sub><sup>T</sup></italic>,<italic>Z<sub>t</sub><sup>T</sup></italic>)<italic><sup>T</sup></italic>, where (.)<italic><sup>T</sup></italic> denotes matrix transposition.</p><p>Generally, the perturbation ξ<italic><sub>t</sub></italic> in Equation 1 can be represented as a noise term ε<italic><sub>t</sub></italic> together with an exogenous term <italic>E<sub>t</sub><sup>x</sup></italic> and a latent variable term <italic>L<sub>t</sub><sup>a</sup></italic><sup>1</sup>. Equation 1 can be rewritten as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000087.e003" xlink:type="simple"/><label>(2)</label></disp-formula>where the random vectors (<italic>E<sub>t</sub><sup>x</sup></italic>,<italic>L<sub>t</sub><sup>a</sup></italic>) and ε<italic><sub>t</sub></italic> are independent. The exogenous variable <italic>E<sub>t</sub><sup>x</sup></italic> represents the environmental drive and is typically present in any experimental setup. For example, all neurons in the inferior temporal cortex receive inputs from lower visual areas such as V1 and V2 and the incoming signal could be represented as exogenous variables. The latent variable <italic>L<sub>t</sub><sup>a</sup></italic> is a variable that cannot be measured in the experiment.</p><p>The vector autoregressive representation for <italic>W</italic> involving three time series <italic>X<sub>t</sub></italic> (<italic>k</italic> dimensional vector), <italic>Y<sub>t</sub></italic> (<italic>l</italic> dimensional vector) and <italic>Z<sub>t</sub></italic> (<italic>m</italic> dimensional vector) can be written in the following way:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000087.e004" xlink:type="simple"/><label>(3)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000087.e005" xlink:type="simple"/></inline-formula>,<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000087.e006" xlink:type="simple"/></inline-formula>,<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000087.e007" xlink:type="simple"/></inline-formula> are normally distributed random vectors and <italic>B<sub>i</sub></italic>(<italic>L</italic>) is a polynomial matrix of <italic>L</italic> of appropriate size.</p><p>For simplicity of notation, let us define<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000087.e008" xlink:type="simple"/></disp-formula><italic>i</italic> = 1,2,3. The noise covariance matrix for Equation 3 can be represented as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000087.e009" xlink:type="simple"/></disp-formula>Following the idea of Granger causality, let us further consider two time series <italic>X<sub>t</sub></italic> and <italic>Z<sub>t</sub></italic> (to fit <italic>X<sub>t</sub></italic> and <italic>Z<sub>t</sub></italic> in <italic>W</italic> exclusively using <italic>X</italic> and <italic>Z</italic>) (due to Wald representation, latent variables can be represented as the summation of normally distributed random inputs, depending on history), the joint autoregressive representation for <italic>X<sub>t</sub></italic> and <italic>Z<sub>t</sub></italic> can be written as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000087.e010" xlink:type="simple"/><label>(4)</label></disp-formula>The noise covariance matrix for Equation 4 can be represented as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000087.e011" xlink:type="simple"/></disp-formula>We have defined partial Granger causality in the time domain (see <xref ref-type="supplementary-material" rid="pcbi.1000087.s001">Text S1</xref>), which reflects the causal influence from <italic>Y</italic> to <italic>X</italic> conditioned on <italic>Z</italic> by eliminating the influence of common exogenous inputs and latent variables. It has the following expression:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000087.e012" xlink:type="simple"/><label>(5)</label></disp-formula>It is interesting to compare <italic>F</italic><sup>(1)</sup> with the definition of the conditional Granger causality <italic>F</italic><sup>(2)</sup> defined by<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000087.e013" xlink:type="simple"/><label>(6)</label></disp-formula>Note that the main difference between the conditional and the partial Granger causality is that in the definition of the conditional Granger causality, the effect of latent and exogenous variables is not eliminated both in the denominator term |Σ<italic><sub>xx</sub></italic>| and in the numerator |<italic>S</italic><sub>44</sub>|. In our definition of the partial Granger causality, we use the conditional variance in both the denominator |Σ<italic><sub>xx</sub></italic>−Σ<italic><sub>xz</sub></italic>Σ<italic><sub>zz</sub></italic><sup>−1</sup>Σ<italic><sub>zx</sub></italic>| and the numerator |<italic>S</italic><sub>44</sub>−<italic>S</italic><sub>45</sub><italic>S</italic><sub>55</sub><sup>−1</sup><italic>S</italic><sub>54</sub>|. As a result, the effect of the latent and exogenous variables could be eliminated. This was proven to be important as demonstrated extensively in the Results section and in <xref ref-type="supplementary-material" rid="pcbi.1000087.s001">Text S1</xref>. Of particular interest is that the definition of the partial Granger causality has a transparent statistical meaning since it depends on a well-understood notation: the conditional variance.</p><p>To deal with exogenous inputs and latent variables is one of the central topics in statistics and, as one could expect, there is an extensive literature on the topic. On page 353 in <xref ref-type="bibr" rid="pcbi.1000087-Eichler2">[26]</xref>, for example, the author has raised the issue and gone further on page 355 to define the partial directed correlation. However, our approach is completely different. First of all, the partial Granger causality is based upon the definition of the conditional Granger causality, which is proved to be one of the most widely used Granger causality definition <xref ref-type="bibr" rid="pcbi.1000087-Chen1">[27]</xref> in the literature. The statistical meaning is transparent, as discussed in the paragraph above. Secondly, as also mentioned above, we extend the time domain partial Granger causality to the frequency domain in the next subsection, which is one of the most appealing properties of the Granger causality.</p></sec><sec id="s3b"><title>Partial Granger Causality: Frequency Domain</title><p>To drive the spectral decomposition of the time domain partial Granger causality, we first multiply the matrix<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000087.e014" xlink:type="simple"/><label>(7)</label></disp-formula>to both sides of Equation 4. The normalized equations are represented as:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000087.e015" xlink:type="simple"/><label>(8)</label></disp-formula>with <italic>D</italic><sub>11</sub>(0) = <italic>I<sub>k</sub></italic>, <italic>D</italic><sub>22</sub>(0) = <italic>I<sub>m</sub></italic>, <italic>D</italic><sub>21</sub>(0) = 0, cov(<italic>X<sub>t</sub></italic><sup>*</sup>,<italic>Z<sub>t</sub></italic><sup>*</sup>) = 0. We note that var(<italic>X<sub>t</sub></italic><sup>*</sup>) = <italic>S</italic><sub>44</sub>−<italic>S</italic><sub>45</sub><italic>S</italic><sub>55</sub><sup>−1</sup><italic>S</italic><sub>54</sub>, var(<italic>Z<sub>t</sub></italic><sup>*</sup>) = <italic>S</italic><sub>55</sub>. For Equation 3, we also multiply<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000087.e016" xlink:type="simple"/><label>(9)</label></disp-formula>where<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000087.e017" xlink:type="simple"/><label>(10)</label></disp-formula>and<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000087.e018" xlink:type="simple"/><label>(11)</label></disp-formula>to both sides of Equation 3. The normalized equation of Equation 3 becomes<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000087.e019" xlink:type="simple"/><label>(12)</label></disp-formula>where ε<italic><sub>xt</sub></italic>, ε<italic><sub>yt</sub></italic>, ε<italic><sub>zt</sub></italic> are independent, and their variances being Σˆ<italic><sub>xx</sub></italic>, Σˆ<italic><sub>yy</sub></italic>, Σˆ<italic><sub>zz</sub></italic> with<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000087.e020" xlink:type="simple"/></disp-formula>After Fourier transforming Equation 8 and Equation 12, we can rewrite these two equations in the following expression:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000087.e021" xlink:type="simple"/><label>(13)</label></disp-formula>and<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000087.e022" xlink:type="simple"/><label>(14)</label></disp-formula>Noting that <italic>X</italic>(λ) and <italic>Z</italic>(λ) from Equation 13 are identical with that from Equation 14, we thus have<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000087.e023" xlink:type="simple"/><label>(15)</label></disp-formula>where <italic>Q</italic>(<italic>λ</italic>) = <italic>G</italic><sup>−1</sup>(<italic>λ</italic>)<italic>H</italic>(<italic>λ</italic>). Now the power spectrum of <italic>X</italic><sup>*</sup> is<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000087.e024" xlink:type="simple"/><label>(16)</label></disp-formula>where (.)′ denotes the complex transformation and conjunction. In light of the fact that Σˆ<italic><sub>xx</sub></italic> = Σ<italic><sub>xx</sub></italic>−Σ<italic><sub>xz</sub></italic>Σ<italic><sub>zz</sub></italic><sup>−1</sup>Σ<italic><sub>zx</sub></italic>, the first term in Equation 16 can be thought of as the intrinsic power after eliminating exogenous inputs and latent variables and the remaining two terms as the combined causal influence from <italic>Y</italic> mediated by <italic>Z</italic>. This interpretation leads immediately to the definition<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000087.e025" xlink:type="simple"/><label>(17)</label></disp-formula>Note that according to Equation 8, the variance of <italic>X</italic><sup>*</sup> equals <italic>S</italic><sub>44</sub>−<italic>S</italic><sub>45</sub><italic>S</italic><sub>55</sub><sup>−1</sup><italic>S</italic><sub>54</sub>. By the Kolmogrov formula <xref ref-type="bibr" rid="pcbi.1000087-Geweke2">[28]</xref> for spectral decompositions and under some mild conditions, the Granger causality in the frequency domain and in the time domain measures satisfies<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000087.e026" xlink:type="simple"/><label>(18)</label></disp-formula>The dependence of partial Granger causality on the coefficient of VAR model is quite complex. Further discussion is presented in <xref ref-type="supplementary-material" rid="pcbi.1000087.s002">Text S2</xref>.</p></sec></sec><sec id="s4"><title>Discussion</title><p>We have presented a study on the frequency decomposition for the partial Granger causality. The time domain partial Granger causality and its frequency domain decomposition are successfully applied to toy models and experimental data.</p><sec id="s4a"><title>Partial Granger Causality and Its Frequency Domain Decomposition</title><p>In the literature various definitions of the Granger causality in the frequency domain have been introduced. For more than three time series, Kalminski and Blilowska <xref ref-type="bibr" rid="pcbi.1000087-Kaminski1">[29]</xref> proposed a full multi-variate spectral measure, called directed transfer function (DTF), which is used to determine the directional influences between any given pair of variables in a multivariate data set. Sameshima and Baccala <xref ref-type="bibr" rid="pcbi.1000087-Baccala1">[30]</xref> introduced PDC to detect direct influence in multivariate time series. Earlier, Geweke <xref ref-type="bibr" rid="pcbi.1000087-Geweke1">[11]</xref> has introduced the conditional Granger causality to infer the original direct relationship between multi-variable time series, as recently reviewed in <xref ref-type="bibr" rid="pcbi.1000087-Ding1">[15]</xref>, <xref ref-type="bibr" rid="pcbi.1000087-Chen1">[27]</xref>–<xref ref-type="bibr" rid="pcbi.1000087-Geweke2">[28]</xref>. In <xref ref-type="bibr" rid="pcbi.1000087-Geweke1">[11]</xref> both a time domain measure, consistent with that of Granger, and its frequency decomposition were given. However, when the exogenous inputs or latent variables are present, the conditional Granger causality fails to identify the correct causal relationship while the partial Granger causality we defined this paper remains robust against the exogenous input and latent variables (see <xref ref-type="fig" rid="pcbi-1000087-g002">Figure 2</xref>), as pointed out in <xref ref-type="supplementary-material" rid="pcbi.1000087.s001">Text S1</xref>. One of the key properties of the conditional Granger causality of Geweke's formulation is that the summation of the Granger causality in the frequency domain equals the Granger causality in the time domain. This is due to the Kolmogrov equation for frequency decompositions. Both PDC and DTF lack this property and the inferred structures could simply be misleading. Here we follow the idea of Geweke's formulation and the partial Granger causality in the frequency domain is given.</p><p>One of our aims of the current paper is to present a method to correctly calculate the Granger causality when there are latent variables and exogenous inputs. Our results on toy models have demonstrated that the Granger causality defined here is robust against latent variables and exogenous inputs, in comparison with the quantities such as the conditional Granger causality etc. The other aim is to demonstrate that an <italic>ad hoc</italic> definition of the causality such as PDC in the frequency domain could be misleading. It usually yields contradicting results between the time domain Granger causality and the frequency domain Granger causality.</p></sec><sec id="s4b"><title>HeLa Gene Network</title><p>Due to the limitation of HeLa microarray data (sampling rate is one hour), we are not able to assess the fast dynamical activity which occurs at a minute scale. It is pointed out in <xref ref-type="bibr" rid="pcbi.1000087-Hoffmann2">[31]</xref> that there are two pathways in NF-κB circuit: one is canonical (fast time scale, minutes) and the other is non-canonical (slow time scale, hours or days). The canonical pathway involves NEMO and is faster than the non-canonical pathway which does not involve NEMO. Our results contradict the above conclusion. The non-canonical pathway does involve NEMO, although it exhibits a slow dynamics. Of course, we do not exclude the possibility that the causality between IKKα and NEMO is due to the crosstalk between canonical and non-canonical pathways. However, one thing is certain. The claim that ‘It is important to note that non-canonical activation of NF-κB appears to lack highly dynamic control’ <xref ref-type="bibr" rid="pcbi.1000087-Hoffmann2">[31]</xref> seems untrue. The NF-κB circuit clearly shows a tri-frequency activity and the causality between each gene is strong or significant.</p></sec><sec id="s4c"><title>Gamma, Beta, and Theta Rhythms</title><p>Gamma rhythms occur during persistent, self-sustained activity and are a hallmark of cortical activity during sensory processing and cognition. Beta oscillatory activity is often observed to be synchronized between various parts of sensorimotor cortex. Theta-frequency activity is observed during some short term memory tasks and reflects the on-line state of the hippocampus; one of readiness to process incoming signals <xref ref-type="bibr" rid="pcbi.1000087-Buzsaki1">[32]</xref>. In our data, although theta wave is observable for most channels (see <xref ref-type="fig" rid="pcbi-1000087-g004">Figure 4B</xref>), they are synchronous at around 300 ms, which is more or less the time of the evolved field potential. In conclusion, there are different frequencies in the recorded brain activity and their interactions give rise to different cognitive functions.</p></sec></sec><sec id="s5"><title>Supporting Information</title><supplementary-material id="pcbi.1000087.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000087.s001" xlink:type="simple"><label>Text S1</label><caption><p>Partial Granger causality: eliminating exogenous inputs and latent variables.</p><p>(0.50 MB PDF)</p></caption></supplementary-material><supplementary-material id="pcbi.1000087.s002" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000087.s002" xlink:type="simple"><label>Text S2</label><caption><p>A simple example in the frequency domain: dependence of the Granger causality on model parameters.</p><p>(0.04 MB PDF)</p></caption></supplementary-material></sec></body><back><ack><p>We are grateful to the referees for their useful comments and bring our attention to references <xref ref-type="bibr" rid="pcbi.1000087-Ghahramani1">[5]</xref>–<xref ref-type="bibr" rid="pcbi.1000087-Eichler1">[7]</xref>,<xref ref-type="bibr" rid="pcbi.1000087-Eichler2">[26]</xref>.</p></ack><ref-list><title>References</title><ref id="pcbi.1000087-Longo1"><label>1</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Longo</surname><given-names>D</given-names></name><name name-style="western"><surname>Hasty</surname><given-names>J</given-names></name></person-group>             <year>2006</year>             <article-title>Dynamics of single-cell gene expression.</article-title>             <source>Molecular Systems Biology</source>             <volume>2</volume>             <fpage>64</fpage>             <lpage>75</lpage>          </element-citation></ref><ref id="pcbi.1000087-Hoffmann1"><label>2</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Hoffmann</surname><given-names>A</given-names></name><name name-style="western"><surname>Levchenko</surname><given-names>A</given-names></name><name name-style="western"><surname>Scott</surname><given-names>ML</given-names></name><name name-style="western"><surname>Baltimore</surname><given-names>D</given-names></name></person-group>             <year>2002</year>             <article-title>The IκB-NF-κB signaling module: temporal control and selective gene activation.</article-title>             <source>Science</source>             <volume>298</volume>             <fpage>1241</fpage>             <lpage>1245</lpage>          </element-citation></ref><ref id="pcbi.1000087-Krishna1"><label>3</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Krishna</surname><given-names>S</given-names></name><name name-style="western"><surname>Jensen</surname><given-names>MH</given-names></name><name name-style="western"><surname>Sneppen</surname><given-names>K</given-names></name></person-group>             <year>2006</year>             <article-title>Minimal model of spiky oscillations in NF-κB signaling.</article-title>             <source>PNAS</source>             <volume>103</volume>             <fpage>10840</fpage>             <lpage>10845</lpage>          </element-citation></ref><ref id="pcbi.1000087-Nelson1"><label>4</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Nelson</surname><given-names>DE</given-names></name><name name-style="western"><surname>Sée</surname><given-names>V</given-names></name><name name-style="western"><surname>Nelson</surname><given-names>G</given-names></name><name name-style="western"><surname>White</surname><given-names>MRH</given-names></name></person-group>             <year>2004</year>             <article-title>Oscillations in NF-κB signaling control the dynamics of gene expression.</article-title>             <source>Science</source>             <volume>306</volume>             <fpage>704</fpage>             <lpage>708</lpage>          </element-citation></ref><ref id="pcbi.1000087-Ghahramani1"><label>5</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Ghahramani</surname><given-names>Z</given-names></name></person-group>             <year>1998</year>             <article-title>Learning dynamic Bayesian networks,</article-title>             <person-group person-group-type="editor"><name name-style="western"><surname>Giles</surname><given-names>CL</given-names></name><name name-style="western"><surname>Gori</surname><given-names>M</given-names></name></person-group>             <source>Adaptive Processing of Sequences and Data Structures. Lecture Notes in Artificial Intelligence</source>             <publisher-loc>Berlin</publisher-loc>             <publisher-name>Springer-Verlag</publisher-name>             <fpage>168</fpage>             <lpage>197</lpage>          </element-citation></ref><ref id="pcbi.1000087-ValdesSosa1"><label>6</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Valdes-Sosa</surname><given-names>PA</given-names></name><name name-style="western"><surname>Sanchez-Bornot</surname><given-names>JM</given-names></name><name name-style="western"><surname>Lage-Castellanos</surname><given-names>A</given-names></name><name name-style="western"><surname>Vega-Hernandez</surname><given-names>M</given-names></name><name name-style="western"><surname>Bosch-Bayard</surname><given-names>J</given-names></name><name name-style="western"><surname>Melie-Garcia</surname><given-names>L</given-names></name><name name-style="western"><surname>Canales-Rodriguez</surname><given-names>E</given-names></name></person-group>             <year>2005</year>             <article-title>Estimating brain functional connectivity with sparse multivariate autoregression.</article-title>             <source>Phil Trans Royal Soc B</source>             <volume>360</volume>             <fpage>969</fpage>             <lpage>981</lpage>          </element-citation></ref><ref id="pcbi.1000087-Eichler1"><label>7</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Eichler</surname><given-names>M</given-names></name></person-group>             <year>2005</year>             <article-title>A graphical approach for evaluating effective connectivity in neural systems.</article-title>             <source>Phil Trans Royal Soc B</source>             <volume>360</volume>             <fpage>953</fpage>             <lpage>967</lpage>          </element-citation></ref><ref id="pcbi.1000087-Pearl1"><label>8</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Pearl</surname><given-names>J</given-names></name></person-group>             <year>1998</year>             <source>Causality: Models, Reasoning, and Inference</source>             <publisher-loc>Cambridge (United Kingdom)</publisher-loc>             <publisher-name>Cambridge University Press</publisher-name>          </element-citation></ref><ref id="pcbi.1000087-Wiener1"><label>9</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Wiener</surname><given-names>N</given-names></name></person-group>             <year>1956</year>             <article-title>The theory of prediction.</article-title>             <person-group person-group-type="editor"><name name-style="western"><surname>Beckenbach</surname><given-names>EF</given-names></name></person-group>             <source>Modern mathematics for engineers, chap 8</source>             <publisher-loc>New York</publisher-loc>             <publisher-name>McGraw-Hill</publisher-name>          </element-citation></ref><ref id="pcbi.1000087-Granger1"><label>10</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Granger</surname><given-names>C</given-names></name></person-group>             <year>1969</year>             <article-title>Investigating Causal Relations by Econometric Models and Cross- spectral Methods.</article-title>             <source>Econometrica</source>             <volume>37</volume>             <fpage>424</fpage>             <lpage>438</lpage>          </element-citation></ref><ref id="pcbi.1000087-Geweke1"><label>11</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Geweke</surname><given-names>J</given-names></name></person-group>             <year>1982</year>             <article-title>Measurement of Linear Dependence and Feedback Between Multiple Time Series.</article-title>             <source>J of the American Statistical Association</source>             <volume>77</volume>             <fpage>304</fpage>             <lpage>313</lpage>          </element-citation></ref><ref id="pcbi.1000087-Hosoya1"><label>12</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Hosoya</surname><given-names>Y</given-names></name></person-group>             <year>1991</year>             <article-title>The decomposition and measurement of the interdependency between second-order stationary process.</article-title>             <source>Probability Theory and Related Fields</source>             <volume>88</volume>             <fpage>429</fpage>             <lpage>444</lpage>          </element-citation></ref><ref id="pcbi.1000087-Gourevitch1"><label>13</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Gourevitch</surname><given-names>B</given-names></name><name name-style="western"><surname>Bouquin-Jeannes</surname><given-names>Le</given-names></name><name name-style="western"><surname>Gaucon</surname><given-names>G</given-names></name></person-group>             <year>2006</year>             <article-title>Linear and nonlinear causality between signals: methods, examples, and neurophysiological applications.</article-title>             <source>Biol Cybern</source>             <volume>95</volume>             <fpage>349</fpage>             <lpage>369</lpage>          </element-citation></ref><ref id="pcbi.1000087-Whitfield1"><label>14</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Whitfield</surname><given-names>ML</given-names></name><name name-style="western"><surname>Sherlock</surname><given-names>G</given-names></name><name name-style="western"><surname>Saldanha</surname><given-names>AJ</given-names></name><name name-style="western"><surname>Murray</surname><given-names>JI</given-names></name><name name-style="western"><surname>Ball</surname><given-names>CA</given-names></name><name name-style="western"><surname>Alexander</surname><given-names>KE</given-names></name><name name-style="western"><surname>Matese</surname><given-names>JC</given-names></name><name name-style="western"><surname>Pero</surname><given-names>CM</given-names></name><name name-style="western"><surname>Hurt</surname><given-names>MM</given-names></name><name name-style="western"><surname>Brown</surname><given-names>PO</given-names></name><name name-style="western"><surname>Botstein</surname><given-names>D</given-names></name></person-group>             <year>2002</year>             <article-title>Identification of genes periodically expressed in the human cell cycle and their expression in tumors.</article-title>             <source>Mol Biol Cell</source>             <volume>13</volume>             <fpage>1977</fpage>             <lpage>2000</lpage>          </element-citation></ref><ref id="pcbi.1000087-Ding1"><label>15</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Ding</surname><given-names>MZ</given-names></name><name name-style="western"><surname>Chen</surname><given-names>YH</given-names></name><name name-style="western"><surname>Bressler</surname><given-names>SL</given-names></name></person-group>             <year>2006</year>             <article-title>Granger Causality: Basic Theory and Application to Neuroscience. Handbook of Time Series Analysis.</article-title>             <person-group person-group-type="editor"><name name-style="western"><surname>Schelter</surname><given-names>B</given-names></name><name name-style="western"><surname>Winterhalder</surname><given-names>M</given-names></name><name name-style="western"><surname>Timmer</surname><given-names>J</given-names></name></person-group>             <publisher-name>Wiley-VCH Verlag</publisher-name>             <fpage>451</fpage>             <lpage>474</lpage>          </element-citation></ref><ref id="pcbi.1000087-Jeong1"><label>16</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Jeong</surname><given-names>SJ</given-names></name><name name-style="western"><surname>Radonovich</surname><given-names>M</given-names></name><name name-style="western"><surname>Brady</surname><given-names>JN</given-names></name><name name-style="western"><surname>Pise-Masison</surname><given-names>CA</given-names></name></person-group>             <year>2004</year>             <article-title>HTLV-I Tax induces a novel interaction between p65/RelA and p53 which results in inhibition of p53 transcriptional activity.</article-title>             <source>Blood</source>             <comment>doi:10/1182/blood-2003-12-4174.</comment>          </element-citation></ref><ref id="pcbi.1000087-Horton1"><label>17</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Horton</surname><given-names>PM</given-names></name><name name-style="western"><surname>Bonny</surname><given-names>L</given-names></name><name name-style="western"><surname>Nicol</surname><given-names>AL</given-names></name><name name-style="western"><surname>Kendrick</surname><given-names>KM</given-names></name><name name-style="western"><surname>Feng</surname><given-names>JF</given-names></name></person-group>             <year>2005</year>             <article-title>Applications of multi-variate analysis of variances (MANOVA) to multi-electrode array data.</article-title>             <source>J Neurosci Methods</source>             <volume>146</volume>             <fpage>22</fpage>             <lpage>41</lpage>          </element-citation></ref><ref id="pcbi.1000087-Horton2"><label>18</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Horton</surname><given-names>PM</given-names></name><name name-style="western"><surname>Nicol</surname><given-names>AU</given-names></name><name name-style="western"><surname>Kendrick</surname><given-names>KM</given-names></name><name name-style="western"><surname>Feng</surname><given-names>JF</given-names></name></person-group>             <year>2007</year>             <article-title>Spike sorting based upon machine learning algorithms (SOMA).</article-title>             <source>J Neurosci Methods</source>             <volume>160</volume>             <fpage>52</fpage>             <lpage>68</lpage>          </element-citation></ref><ref id="pcbi.1000087-Wu1"><label>19</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Wu</surname><given-names>JH</given-names></name><name name-style="western"><surname>Kendrick</surname><given-names>KM</given-names></name><name name-style="western"><surname>Feng</surname><given-names>JF</given-names></name></person-group>             <year>2007</year>             <article-title>Detecting Correlation Changes in Electrophysiological Data.</article-title>             <source>J Neurosci Methods</source>             <volume>161</volume>             <fpage>155</fpage>             <lpage>165</lpage>          </element-citation></ref><ref id="pcbi.1000087-Wu2"><label>20</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Wu</surname><given-names>JH</given-names></name><name name-style="western"><surname>Kendrick</surname><given-names>KM</given-names></name><name name-style="western"><surname>Feng</surname><given-names>JF</given-names></name></person-group>             <year>2007</year>             <article-title>Detecting Hot-Spots in Multivariates Biological Data.</article-title>             <source>BMC Bioinformatics</source>             <volume>8</volume>             <fpage>331</fpage>          </element-citation></ref><ref id="pcbi.1000087-Wu3"><label>21</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Wu</surname><given-names>JH</given-names></name><name name-style="western"><surname>Liu</surname><given-names>XG</given-names></name><name name-style="western"><surname>Feng</surname><given-names>JF</given-names></name></person-group>             <year>2008</year>             <article-title>Detecting causality between different frequencies.</article-title>             <source>J Neurosci Methods</source>             <volume>167</volume>             <fpage>367</fpage>             <lpage>375</lpage>          </element-citation></ref><ref id="pcbi.1000087-Ishai1"><label>22</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Ishai</surname><given-names>A</given-names></name><name name-style="western"><surname>Ungerleider</surname><given-names>LG</given-names></name><name name-style="western"><surname>Martin</surname><given-names>A</given-names></name><name name-style="western"><surname>Schouten</surname><given-names>JL</given-names></name><name name-style="western"><surname>Haxby</surname><given-names>JV</given-names></name></person-group>             <year>1999</year>             <article-title>Distributed representation of objects in the human ventral visual pathway.</article-title>             <source>PNAS</source>             <volume>96</volume>             <fpage>9379</fpage>             <lpage>84</lpage>          </element-citation></ref><ref id="pcbi.1000087-Kreiman1"><label>23</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Kreiman</surname><given-names>G</given-names></name><name name-style="western"><surname>Hung</surname><given-names>CP</given-names></name><name name-style="western"><surname>Kraskov</surname><given-names>A</given-names></name><name name-style="western"><surname>Quiroga</surname><given-names>RQ</given-names></name><name name-style="western"><surname>Poggio</surname><given-names>T</given-names></name><name name-style="western"><surname>DiCarlo</surname><given-names>JJ</given-names></name></person-group>             <year>2006</year>             <article-title>Object selectivity of local field potentials and spikes in the macaque inferior temporal cortex.</article-title>             <source>Neuron</source>             <volume>49</volume>             <fpage>433</fpage>             <lpage>45</lpage>          </element-citation></ref><ref id="pcbi.1000087-Kim1"><label>24</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Kim</surname><given-names>J</given-names></name><name name-style="western"><surname>Zhu</surname><given-names>W</given-names></name><name name-style="western"><surname>Chang</surname><given-names>L</given-names></name></person-group>             <year>2007</year>             <article-title>Unified Structural Equation Modeling Approach for the Analysis of Multisubject, Multivariate Functional MRI Data.</article-title>             <source>Human Brain Mapping</source>             <volume>28</volume>             <fpage>85</fpage>             <lpage>93</lpage>          </element-citation></ref><ref id="pcbi.1000087-Canolty1"><label>25</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Canolty</surname><given-names>RT</given-names></name><name name-style="western"><surname>Edwards</surname><given-names>E</given-names></name><name name-style="western"><surname>Dalal</surname><given-names>SS</given-names></name><name name-style="western"><surname>Soltani</surname><given-names>M</given-names></name><name name-style="western"><surname>Nagarajan</surname><given-names>SS</given-names></name><name name-style="western"><surname>Kirsch</surname><given-names>HE</given-names></name><name name-style="western"><surname>Berger</surname><given-names>MS</given-names></name><name name-style="western"><surname>Barbaro</surname><given-names>NM</given-names></name><name name-style="western"><surname>Knight</surname><given-names>RT</given-names></name></person-group>             <year>2006</year>             <article-title>High gamma power is phase locked to theta oscillations in human neocortex.</article-title>             <source>Science</source>             <volume>313</volume>             <fpage>1626</fpage>             <lpage>1628</lpage>          </element-citation></ref><ref id="pcbi.1000087-Eichler2"><label>26</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Eichler</surname><given-names>M</given-names></name></person-group>             <year>2006</year>             <article-title>Graphical modelling of dynamic relationships in multivariate time series. Handbook of Time Series Analysis.</article-title>             <person-group person-group-type="editor"><name name-style="western"><surname>Schelter</surname><given-names>B</given-names></name><name name-style="western"><surname>Winterhalder</surname><given-names>M</given-names></name><name name-style="western"><surname>Timmer</surname><given-names>J</given-names></name></person-group>             <publisher-name>Wiley-VCH Verlag</publisher-name>             <fpage>335</fpage>             <lpage>372</lpage>          </element-citation></ref><ref id="pcbi.1000087-Chen1"><label>27</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Chen</surname><given-names>YH</given-names></name><name name-style="western"><surname>Bressler</surname><given-names>SL</given-names></name><name name-style="western"><surname>Ding</surname><given-names>MZ</given-names></name></person-group>             <year>2006</year>             <article-title>Frequency Decomposition of Conditional Granger Causality and Application to Multivariate Neural Field Potential Data.</article-title>             <source>J Neurosci Methods</source>             <volume>150</volume>             <fpage>228</fpage>             <lpage>237</lpage>          </element-citation></ref><ref id="pcbi.1000087-Geweke2"><label>28</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Geweke</surname><given-names>J</given-names></name></person-group>             <year>1984</year>             <article-title>Measures of Conditional Linear Dependence and Feedback Between Time Series.</article-title>             <source>J of the American Statistical Association</source>             <volume>79</volume>             <fpage>907</fpage>             <lpage>915</lpage>          </element-citation></ref><ref id="pcbi.1000087-Kaminski1"><label>29</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Kaminski</surname><given-names>M</given-names></name><name name-style="western"><surname>Ding</surname><given-names>MZ</given-names></name><name name-style="western"><surname>Tryccolo</surname><given-names>WA</given-names></name><name name-style="western"><surname>Bressler</surname><given-names>SL</given-names></name></person-group>             <year>2001</year>             <article-title>Evaluating causal relations in neural system: Granger causality, directed transfer function and statistical assessment of significance.</article-title>             <source>Biol Cybern</source>             <volume>85</volume>             <fpage>145</fpage>             <lpage>157</lpage>          </element-citation></ref><ref id="pcbi.1000087-Baccala1"><label>30</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Baccala</surname><given-names>L</given-names></name><name name-style="western"><surname>Sameshima</surname><given-names>K</given-names></name></person-group>             <year>2001</year>             <article-title>Partial Directed Coherence: a New Concept in Neural Structure Determination.</article-title>             <source>Biol Cybern</source>             <volume>84</volume>             <fpage>463</fpage>             <lpage>474</lpage>          </element-citation></ref><ref id="pcbi.1000087-Hoffmann2"><label>31</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Hoffmann</surname><given-names>A</given-names></name><name name-style="western"><surname>Baltimore</surname><given-names>D</given-names></name></person-group>             <year>2006</year>             <article-title>Circuitry of nuclear factor κB signalling.</article-title>             <source>Immunological Reviews</source>             <volume>210</volume>             <fpage>171</fpage>             <lpage>186</lpage>          </element-citation></ref><ref id="pcbi.1000087-Buzsaki1"><label>32</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Buzsaki</surname><given-names>G</given-names></name></person-group>             <year>2002</year>             <article-title>Theta oscillations in the hippocampus.</article-title>             <source>Neuron</source>             <volume>33</volume>             <fpage>325</fpage>             <lpage>40</lpage>          </element-citation></ref></ref-list></back></article>