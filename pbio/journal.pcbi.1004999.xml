<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-15-02066</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1004999</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Network analysis</subject><subj-group><subject>Metabolic networks</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Metabolism</subject><subj-group><subject>Metabolites</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Applied mathematics</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Chemistry</subject><subj-group><subject>Chemical elements</subject><subj-group><subject>Carbon</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Graph theory</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Graph theory</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Algebra</subject><subj-group><subject>Linear algebra</subject><subj-group><subject>Vector spaces</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Molecular biology</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Cell labeling</subject><subj-group><subject>Metabolic labeling</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Cell labeling</subject><subj-group><subject>Metabolic labeling</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Chemistry</subject><subj-group><subject>Chemical elements</subject><subj-group><subject>Oxygen</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Identification of Conserved Moieties in Metabolic Networks by Graph Theoretical Analysis of Atom Transition Networks</article-title>
<alt-title alt-title-type="running-head">Conserved Metabolic Moieties in Atom Transition Networks</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Haraldsdóttir</surname> <given-names>Hulda S.</given-names></name>
<xref ref-type="aff" rid="aff001"/>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Fleming</surname> <given-names>Ronan M. T.</given-names></name>
<xref ref-type="corresp" rid="cor001">*</xref>
<xref ref-type="aff" rid="aff001"/>
</contrib>
</contrib-group>
<aff id="aff001">
<addr-line>Luxembourg Centre for Systems Biomedicine, University of Luxembourg, Esch-sur-Alzette, Luxembourg</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Maranas</surname> <given-names>Costas D.</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>The Pennsylvania State University, UNITED STATES</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con">
<p><list list-type="simple"><list-item><p><bold>Conceived and designed the experiments:</bold> HSH RMTF.</p></list-item> <list-item><p><bold>Performed the experiments:</bold> HSH.</p></list-item> <list-item><p><bold>Analyzed the data:</bold> HSH RMTF.</p></list-item> <list-item><p><bold>Contributed reagents/materials/analysis tools:</bold> HSH RMTF.</p></list-item> <list-item><p><bold>Wrote the paper:</bold> HSH RMTF.</p></list-item></list></p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">ronan.mt.fleming@gmail.com</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>11</month>
<year>2016</year>
</pub-date>
<pub-date pub-type="epub">
<day>21</day>
<month>11</month>
<year>2016</year>
</pub-date>
<volume>12</volume>
<issue>11</issue>
<elocation-id>e1004999</elocation-id>
<history>
<date date-type="received">
<day>9</day>
<month>12</month>
<year>2015</year>
</date>
<date date-type="accepted">
<day>25</day>
<month>5</month>
<year>2016</year>
</date>
</history>
<permissions>
<copyright-year>2016</copyright-year>
<copyright-holder>Haraldsdóttir, Fleming</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1004999"/>
<abstract>
<p>Conserved moieties are groups of atoms that remain intact in all reactions of a metabolic network. Identification of conserved moieties gives insight into the structure and function of metabolic networks and facilitates metabolic modelling. All moiety conservation relations can be represented as nonnegative integer vectors in the left null space of the stoichiometric matrix corresponding to a biochemical network. Algorithms exist to compute such vectors based only on reaction stoichiometry but their computational complexity has limited their application to relatively small metabolic networks. Moreover, the vectors returned by existing algorithms do not, in general, represent conservation of a specific moiety with a defined atomic structure. Here, we show that identification of conserved moieties requires data on reaction atom mappings in addition to stoichiometry. We present a novel method to identify conserved moieties in metabolic networks by graph theoretical analysis of their underlying atom transition networks. Our method returns the exact group of atoms belonging to each conserved moiety as well as the corresponding vector in the left null space of the stoichiometric matrix. It can be implemented as a pipeline of polynomial time algorithms. Our implementation completes in under five minutes on a metabolic network with more than 4,000 mass balanced reactions. The scalability of the method enables extension of existing applications for moiety conservation relations to genome-scale metabolic networks. We also give examples of new applications made possible by elucidating the atomic structure of conserved moieties.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>Conserved moieties are transferred between metabolites in internal reactions of a metabolic network but are not synthesised, degraded or exchanged with the environment. The total amount of a conserved moiety in the metabolic network is therefore constant over time. Metabolites that share a conserved moiety have interdependent concentrations because their total amount is constant. Identification of conserved moieties results in a concise description of all concentration dependencies in a metabolic network. The problem of identifying conserved moieties has previously been formulated in terms of the stoichiometry of metabolic reactions. Methods based on this formulation are computationally intractable for large networks. We show that reaction stoichiometry alone gives insufficient information to identify conserved moieties. By first incorporating additional data on the fate of atoms in metabolic reactions, we developed and implemented a computationally tractable algorithm to identify conserved moieties and their atomic structure.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001866</institution-id>
<institution>Fonds National de la Recherche Luxembourg</institution>
</institution-wrap>
</funding-source>
<award-id>NCER-PD</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Haraldsdóttir</surname> <given-names>Hulda S.</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000015</institution-id>
<institution>U.S. Department of Energy</institution>
</institution-wrap>
</funding-source>
<award-id>DE-SC0010429</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Fleming</surname> <given-names>Ronan M. T.</given-names></name>
</principal-award-recipient>
</award-group>
<funding-statement>HSH and RMTF were supported by the U.S. Department of Energy (<ext-link ext-link-type="uri" xlink:href="http://www.energy.gov/" xlink:type="simple">http://www.energy.gov/</ext-link>), Offices of Advanced Scientific Computing Research and the Biological and Environmental Research as part of the Scientific Discovery Through Advanced Computing program, grant #DE-SC0010429. HSH was supported by the Luxembourg National Research Fund (FNR, <ext-link ext-link-type="uri" xlink:href="http://www.fnr.lu/" xlink:type="simple">http://www.fnr.lu/</ext-link>) through the National Centre of Excellence in Research (NCER) on Parkinson’s Disease (<ext-link ext-link-type="uri" xlink:href="http://ncer-pd.lu/" xlink:type="simple">http://ncer-pd.lu/</ext-link>). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="11"/>
<table-count count="6"/>
<page-count count="30"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>A MATLAB (MathWorks, Natick, MA) implementation of the method is freely available as part of the COBRA toolbox at <ext-link ext-link-type="uri" xlink:href="https://github.com/opencobra/cobratoolbox/tree/master/topology/conservedMoieties" xlink:type="simple">https://github.com/opencobra/cobratoolbox/tree/master/topology/conservedMoieties</ext-link>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<disp-quote><p>This is a <italic>PLOS Computational Biology</italic> Methods paper.</p></disp-quote>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Conserved moieties give rise to pools of metabolites with constant total concentration and dependent individual concentrations. These constant metabolite pools often consist of highly connected cofactors that are distributed throughout a metabolic network. Representative examples from energy metabolism include the AMP and NAD moieties [<xref ref-type="bibr" rid="pcbi.1004999.ref001">1</xref>, <xref ref-type="bibr" rid="pcbi.1004999.ref002">2</xref>]. Changes in concentration ratios within these cofactor pools affect thermodynamic and mass action kinetic driving forces for all reactions they participate in. Moiety conservation therefore imposes a purely physicochemical form of regulation on metabolism that is mediated through changes in concentration ratios within constant metabolite pools. Reich and Sel’kov likened conserved moieties to turning wheels that are “geared into a clockwork” [<xref ref-type="bibr" rid="pcbi.1004999.ref002">2</xref>]. They described the thermodynamic state of energy metabolism as “open flow through a system closed by moiety conservation”. Identification of conserved moieties in metabolic networks has helped elucidate complex metabolic phenomena including synchronisation of glycolytic oscillations in yeast cell populations [<xref ref-type="bibr" rid="pcbi.1004999.ref003">3</xref>] and the function of glycosomes in the African sleeping sickness parasite <italic>Trypanosoma brucei</italic> [<xref ref-type="bibr" rid="pcbi.1004999.ref004">4</xref>]. It has also been shown to be relevant for drug development [<xref ref-type="bibr" rid="pcbi.1004999.ref004">4</xref>, <xref ref-type="bibr" rid="pcbi.1004999.ref005">5</xref>].</p>
<p>Identification of conserved moieties has been of interest to the metabolic modelling community for several decades [<xref ref-type="bibr" rid="pcbi.1004999.ref006">6</xref>, <xref ref-type="bibr" rid="pcbi.1004999.ref007">7</xref>]. It is particularly important for dynamic modelling [<xref ref-type="bibr" rid="pcbi.1004999.ref008">8</xref>] and metabolic control analysis [<xref ref-type="bibr" rid="pcbi.1004999.ref009">9</xref>] where metabolite concentrations are explicitly modelled. Moiety conservation relations provide a sparse, physically meaningful description of concentration dependencies in a metabolic network. They can be used to eliminate redundant metabolite concentrations as the latter can be derived from the set of independently varying metabolite concentrations. Doing so facilitates simulation of metabolic networks and is in fact required for many computational modelling methods [<xref ref-type="bibr" rid="pcbi.1004999.ref006">6</xref>, <xref ref-type="bibr" rid="pcbi.1004999.ref007">7</xref>].</p>
<p>Mathematically, moiety conservation gives rise to a stoichiometric matrix with linearly dependent rows. The left null space of the stoichiometric matrix therefore has nonzero dimension (see <xref ref-type="sec" rid="sec002">Theoretical Framework</xref>, Section Moiety vectors). Vectors in the left null space, hereafter referred to as conservation vectors, can be divided into several interrelated sets based on their numerical properties and biochemical meaning (<xref ref-type="fig" rid="pcbi.1004999.g001">Fig 1</xref>). <italic>Moiety vectors</italic> constitute a subset of conservation vectors with a distinct biochemical interpretation. Each moiety vector represents conservation of a particular metabolic moiety. Elements of a moiety vector correspond to the number of instances of a conserved moiety in metabolites of a metabolic network. As moieties are discrete quantities, moiety vectors are necessarily nonnegative integer vectors.</p>
<fig id="pcbi.1004999.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004999.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Sets of conservation vectors for metabolic networks.</title>
<p>The set of real-valued conservation vectors consists of all vectors in the left null space of a stoichiometric matrix. Real-valued basis vectors can be computed using efficient linear algebra algorithms but are difficult to interpret as they generally contain negative and noninteger elements. Nonnegative integer vectors are easier to interpret but more difficult to compute. Existing algorithms have exponential worst case time complexity. Algorithms exist to compute extreme rays, the set of all nondecomposable nonnegative integer vectors, and a maximal set of linearly independent nonnegative integer vectors. These vector sets intersect with the set of moiety vectors but are not equivalent to it. Moiety vectors represent conservation of an identifiable group of atoms in network metabolites. They are a property of the specific set of metabolites and reactions that constitute a metabolic network whereas other conservation vectors are a property of the network’s stoichiometric matrix. The method presented here computes moiety vectors in polynomial time.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004999.g001" xlink:type="simple"/>
</fig>
<p>Methods exist to compute conservation vectors based only on the stoichiometric matrix of a metabolic network. These methods compute different types of bases for the left null space of the stoichiometric matrix (see <xref ref-type="supplementary-material" rid="pcbi.1004999.s001">S1 Appendix</xref> for mathematical definitions). Each method draws basis vectors from a particular set of conservation vectors (<xref ref-type="fig" rid="pcbi.1004999.g001">Fig 1</xref>). There is a tradeoff between the computational complexity of these methods and the biochemical interpretability of the basis vectors they return. At the low end of the computational complexity spectrum are linear algebraic methods such as singular value decomposition. Other methods, such as Householder QR factorisation [<xref ref-type="bibr" rid="pcbi.1004999.ref007">7</xref>] or sparse LU factorisation [<xref ref-type="bibr" rid="pcbi.1004999.ref010">10</xref>] are more efficient for large stoichiometric matrices. These methods construct a linear basis for the left null space from real-valued conservation vectors. Though readily computed, these vectors are also the most difficult to interpret as they generally contain negative and noninteger elements.</p>
<p>Schuster and Höfer [<xref ref-type="bibr" rid="pcbi.1004999.ref011">11</xref>] introduced the use of vertex enumeration algorithms to compute the <italic>extreme rays</italic> of the positive orthant of the left null space. They referred to these extreme rays as “extreme semipositive conservation relations”. Famili and Palsson [<xref ref-type="bibr" rid="pcbi.1004999.ref012">12</xref>] later referred to them as “metabolic pools” and the set of all extreme rays as “a <italic>convex basis</italic> for the left null space”. Like moiety vectors, extreme rays are nonnegative integer vectors. They are therefore readily interpreted in terms of constant metabolite pools. However, extreme rays can currently only be computed for relatively small metabolic networks due to the computational complexity of vertex enumeration algorithms [<xref ref-type="bibr" rid="pcbi.1004999.ref013">13</xref>]. Moreover, the set of extreme rays is not identical to the set of moiety vectors (<xref ref-type="fig" rid="pcbi.1004999.g001">Fig 1</xref>). Schuster and Hilgetag [<xref ref-type="bibr" rid="pcbi.1004999.ref014">14</xref>] presented examples of extreme rays that did not represent moiety conservation relations, as well as moiety vectors that were not extreme rays.</p>
<p>Moiety vectors are a property of a metabolic network while extreme rays are a property of its stoichiometric matrix. Multiple metabolic networks could in theory have the same stoichiometric matrix, despite consisting of different sets of metabolites and reactions. These networks would all have the same set of extreme rays, but could have different sets of moiety vectors. Schuster and Hilgetag [<xref ref-type="bibr" rid="pcbi.1004999.ref014">14</xref>] published an extension to the vertex enumeration algorithm in [<xref ref-type="bibr" rid="pcbi.1004999.ref011">11</xref>] to compute the set of all <italic>nondecomposable nonnegative integer vectors</italic> in the left null space of a stoichiometric matrix. This set is guaranteed to contain all nondecomposable moiety vectors for a particular metabolic network as subset (<xref ref-type="fig" rid="pcbi.1004999.g001">Fig 1</xref>). However, it is impossible to identify the subset of moiety vectors without information about the atomic structure of metabolites.</p>
<p>Alternatives to vertex enumeration have been proposed to speed up computation of biochemically meaningful conservation vectors, e.g., [<xref ref-type="bibr" rid="pcbi.1004999.ref015">15</xref>–<xref ref-type="bibr" rid="pcbi.1004999.ref017">17</xref>]. Most recently, De Martino et al. [<xref ref-type="bibr" rid="pcbi.1004999.ref017">17</xref>] published a novel method to compute a <italic>nonnegative integer basis</italic> for the left null space of a stoichiometric matrix. This method [<xref ref-type="bibr" rid="pcbi.1004999.ref017">17</xref>] relies on stochastic algorithms, without guaranteed convergence, but that were empirically shown to perform well even on large networks. Like extreme rays, the nonnegative integer vectors computed with this method are not necessarily moiety vectors (<xref ref-type="fig" rid="pcbi.1004999.g001">Fig 1</xref>). In general, methods to analyse stoichiometric matrices are not suited to specifically compute moiety vectors. Computation of moiety vectors requires information about the atomic composition of metabolites. To our knowledge, only one method has previously been published to specifically compute moiety vectors for metabolic networks [<xref ref-type="bibr" rid="pcbi.1004999.ref018">18</xref>]. This method was based on nonnegative integer factorisation of the elemental matrix; a numerical representation of metabolite formulas. Nonnegative integer factorisation of a matrix is at least NP-hard [<xref ref-type="bibr" rid="pcbi.1004999.ref019">19</xref>] and no polynomial time algorithm is known to exist for this problem. Moreover, only the chemical formula but not the atomic identities of the conserved moieties can be derived from this approach. Identifying the atoms that belong to each moiety requires additional information about the fate of atoms in metabolic reactions. This information is not contained in a stoichiometric matrix.</p>
<p>Here, we propose a novel method to identify conserved moieties in metabolic networks. Our method is based on the premise that atoms within the same conserved moiety follow identical paths through a metabolic network. Given data on which substrate atoms map to which product atoms in each metabolic reaction, the paths of individual atoms through a metabolic network can be encoded in an <italic>atom transition network</italic>. Until recently, the necessary data were difficult to obtain but relatively efficient algorithms have now become available to predict atom mappings in metabolic reactions [<xref ref-type="bibr" rid="pcbi.1004999.ref020">20</xref>–<xref ref-type="bibr" rid="pcbi.1004999.ref022">22</xref>]. These algorithms have made it possible to construct atom transition networks for large metabolic networks. Unlike metabolic networks, atom transition networks are amenable to analysis with efficient graph theory algorithms. Here, we take advantage of this fact to identify conserved moieties in metabolic networks in polynomial time. Furthermore, starting from atom transition networks allows us to associate each conserved moiety with a specific group of atoms in a subset of metabolites in a metabolic network.</p>
<p>This work combines elements of biochemistry, linear algebra and graph theory. We have made an effort to accommodate readers from all fields. The main text consists of informal descriptions of our methods and results, accompanied by illustrative examples and a limited number of mathematical equations. Formal definitions of italicised terms are given in supporting file <xref ref-type="supplementary-material" rid="pcbi.1004999.s001">S1 Appendix</xref>. We precede our results with a section on the theoretical framework for this work, where we introduce key concepts and notation used in the remainder of the text.</p>
</sec>
<sec id="sec002">
<title>Theoretical Framework</title>
<sec id="sec003">
<title>Metabolic networks</title>
<p>A metabolic network consists of a set of metabolites that interconvert via a set of metabolic reactions. Metabolic networks in living beings are open systems that exchange mass and energy with their environment. For modelling purposes, the boundary between system and environment can be defined by introducing a set of metabolite sources and sinks collectively known as exchange reactions. Unlike internal reactions, exchange reactions are artificial constructs that do not conserve mass or charge. The topology of a metabolic network can be represented in several ways. Here, we use metabolic maps and stoichiometric matrices. A metabolic map for a small example metabolic network is shown in <xref ref-type="fig" rid="pcbi.1004999.g002">Fig 2</xref>. This example will be used throughout this section to demonstrate key concepts relevant to this work.</p>
<fig id="pcbi.1004999.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004999.g002</object-id>
<label>Fig 2</label>
<caption>
<title>A metabolic map for an example metabolic network.</title>
<p>The network consists of one internal reaction and four exchange reactions. The internal reaction is the DOPA decarboxylase reaction (VMH [<xref ref-type="bibr" rid="pcbi.1004999.ref023">23</xref>] ID: 3HLYTCL) that produces dopamine (DA, VMH ID: dopa) and CO<sub>2</sub> (VMH ID: co2) from levodopa (L-DOPA, VMH ID: 34dhphe) and H<sup>+</sup> (VMH ID: h). The open network includes source reactions for the two substrates and sink reactions for the two products. Arrowheads indicate reaction directionality. Metabolite structures were rendered from molfiles (Accelrys, San Diego, CA) with MarvinView (ChemAxon, Budapest, Hungary). Atoms are numbered according to their order in each metabolite’s molfile. Atoms of different elements are numbered separately, in colours matching their elemental symbol. The internal reaction conserves three metabolic moieties. Atoms belonging to the same moiety have identically coloured backgrounds. Levodopa and dopamine each contain one instance of a dopamine moiety (blue background). Implicit hydrogen atoms on both metabolites are also part of this moiety. Levodopa and CO<sub>2</sub> each contain one instance of a CO<sub>2</sub> moiety (red background). Finally, the hydrogen ion and dopamine each contain one instance of a hydrogen moiety (orange background).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004999.g002" xlink:type="simple"/>
</fig>
<p>A stoichiometric matrix for an open metabolic network with <italic>m</italic> metabolites and <italic>n</italic> reactions is denoted by <inline-formula id="pcbi.1004999.e001"><alternatives><graphic id="pcbi.1004999.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004999.e001" xlink:type="simple"/><mml:math display="inline" id="M1"><mml:mrow><mml:mi>S</mml:mi> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="double-struck">R</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>×</mml:mo> <mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>. Each row of <italic>S</italic> represents a metabolite and each column a reaction such that element <italic>S</italic><sub><italic>ij</italic></sub> is the stoichiometric coefficient of metabolite <italic>i</italic> in reaction <italic>j</italic>. Coefficients are negative for substrates and positive for products. Substrates and products in reversible reactions are defined by designating one direction as forward. The stoichiometric matrix can be written as
<disp-formula id="pcbi.1004999.e002"><alternatives><graphic id="pcbi.1004999.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004999.e002" xlink:type="simple"/><mml:math display="block" id="M2"><mml:mrow><mml:mi>S</mml:mi> <mml:mo>=</mml:mo> <mml:mfenced close="]" open="[" separators=""><mml:mi>N</mml:mi> <mml:mo>,</mml:mo> <mml:mi>B</mml:mi></mml:mfenced> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(1)</label></disp-formula>
where <inline-formula id="pcbi.1004999.e003"><alternatives><graphic id="pcbi.1004999.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004999.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:mrow><mml:mi>N</mml:mi> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="double-struck">Z</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>×</mml:mo> <mml:mi>u</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> consists of columns representing internal (mass balanced) reactions and <inline-formula id="pcbi.1004999.e004"><alternatives><graphic id="pcbi.1004999.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004999.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:mrow><mml:mi>B</mml:mi> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="double-struck">R</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>×</mml:mo> <mml:mo>(</mml:mo> <mml:mi>n</mml:mi> <mml:mo>-</mml:mo> <mml:mi>u</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> consists of columns representing exchange reactions (mass imbalanced). Note that <italic>N</italic> represents a metabolic network that is closed to the environment. In what follows we will refer to <italic>N</italic> as the internal stoichiometric matrix, <italic>B</italic> as the exchange stoichiometric matrix, and <italic>S</italic> as the total stoichiometric matrix. The total stoichiometric matrix for the example metabolic network in <xref ref-type="fig" rid="pcbi.1004999.g002">Fig 2</xref> is given in <xref ref-type="table" rid="pcbi.1004999.t001">Table 1</xref>.</p>
<table-wrap id="pcbi.1004999.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004999.t001</object-id>
<label>Table 1</label>
<caption>
<title>The total stoichiometric matrix <italic>S</italic> = [<italic>N</italic>, <italic>B</italic>] for the example metabolic network.</title>
</caption>
<alternatives>
<graphic id="pcbi.1004999.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004999.t001" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left"/>
<th align="center"><italic>N</italic></th>
<th align="center" colspan="4"><italic>B</italic></th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">L-DOPA</td>
<td align="center">-1</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr>
<td align="left">H<sup>+</sup></td>
<td align="center">-1</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr>
<td align="left">DA</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">-1</td>
<td align="center">0</td>
</tr>
<tr>
<td align="left">CO<sub>2</sub></td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">-1</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t001fn001">
<p>Rows are labelled with the corresponding metabolite identifier from <xref ref-type="fig" rid="pcbi.1004999.g002">Fig 2</xref>. The internal stoichiometric matrix <inline-formula id="pcbi.1004999.e005"><alternatives><graphic id="pcbi.1004999.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004999.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:mrow><mml:mi>N</mml:mi> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="double-struck">Z</mml:mi> <mml:mrow><mml:mn>4</mml:mn> <mml:mo>×</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> is row rank deficient, with rank (<italic>N</italic>) = 1. The dimension of its left null space is therefore <inline-formula id="pcbi.1004999.e006"><alternatives><graphic id="pcbi.1004999.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004999.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:mrow><mml:mtext>dim </mml:mtext> <mml:mo>(</mml:mo> <mml:mi mathvariant="script">N</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mi>N</mml:mi> <mml:mi>T</mml:mi></mml:msup> <mml:mo>)</mml:mo> <mml:mo>)</mml:mo> <mml:mo>=</mml:mo> <mml:mn>4</mml:mn> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>=</mml:mo> <mml:mn>3</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>. The total stoichiometric matrix <inline-formula id="pcbi.1004999.e007"><alternatives><graphic id="pcbi.1004999.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004999.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:mrow><mml:mi>S</mml:mi> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="double-struck">Z</mml:mi> <mml:mrow><mml:mn>4</mml:mn> <mml:mo>×</mml:mo> <mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> is full row rank. Its left null space is therefore zero dimensional.</p>
</fn>
</table-wrap-foot>
</table-wrap>
<p>Stoichiometric matrices are <italic>incidence matrices</italic> for generalised <italic>graphs</italic> known as <italic>hypergraphs</italic> [<xref ref-type="bibr" rid="pcbi.1004999.ref024">24</xref>]. Hypergraphs contain hyperedges that can connect more than two nodes. The metabolic map in <xref ref-type="fig" rid="pcbi.1004999.g002">Fig 2</xref> is a planar visualisation of a hypergraph with one hyperedge, connecting four metabolites. A graph edge that only connects two nodes is a special instance of a hyperedge. Apart from the occasional isomerisation reaction, metabolic reactions involve more than two metabolites. As a result, they cannot be represented as graph edges without loss of information. Metabolic networks are therefore represented as hypergraphs where nodes represent metabolites and hyperedges represent reactions. Since reactions have a designated forward direction, they are <italic>directed hypergraphs</italic>. Representing metabolic networks as hypergraphs has the advantage of conserving basic structure and functional relationships. The disadvantage is that many graph theoretical algorithms are not applicable to hypergraphs [<xref ref-type="bibr" rid="pcbi.1004999.ref024">24</xref>].</p>
</sec>
<sec id="sec004">
<title>Moiety vectors</title>
<p>An internal stoichiometric matrix <inline-formula id="pcbi.1004999.e008"><alternatives><graphic id="pcbi.1004999.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004999.e008" xlink:type="simple"/><mml:math display="inline" id="M8"><mml:mrow><mml:mi>N</mml:mi> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="double-struck">Z</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>×</mml:mo> <mml:mi>u</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> for a closed metabolic network is always row-rank deficient, i.e., rank(<italic>N</italic>) &lt; <italic>m</italic> [<xref ref-type="bibr" rid="pcbi.1004999.ref011">11</xref>]. The left null space of <italic>N</italic>, denoted by <inline-formula id="pcbi.1004999.e009"><alternatives><graphic id="pcbi.1004999.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004999.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:mrow><mml:mi mathvariant="script">N</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mi>N</mml:mi> <mml:mi>T</mml:mi></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, therefore has finite dimension given by <inline-formula id="pcbi.1004999.e010"><alternatives><graphic id="pcbi.1004999.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004999.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:mrow><mml:mtext>dim</mml:mtext> <mml:mo>(</mml:mo> <mml:mi mathvariant="script">N</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mi>N</mml:mi> <mml:mi>T</mml:mi></mml:msup> <mml:mo>)</mml:mo> <mml:mo>)</mml:mo> <mml:mo>=</mml:mo> <mml:mi>m</mml:mi> <mml:mo>-</mml:mo> <mml:mtext>rank</mml:mtext> <mml:mo>(</mml:mo> <mml:mi>N</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. The left null space holds all conservation vectors for a stoichiometric matrix [<xref ref-type="bibr" rid="pcbi.1004999.ref008">8</xref>]. The number of linearly independent conservation vectors for a closed metabolic network is <inline-formula id="pcbi.1004999.e011"><alternatives><graphic id="pcbi.1004999.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004999.e011" xlink:type="simple"/><mml:math display="inline" id="M11"><mml:mrow><mml:mtext>dim</mml:mtext> <mml:mo>(</mml:mo> <mml:mi mathvariant="script">N</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mi>N</mml:mi> <mml:mi>T</mml:mi></mml:msup> <mml:mo>)</mml:mo> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. The total stoichiometric matrix <italic>S</italic> for an open metabolic network has a greater rank than the internal stoichiometric matrix <italic>N</italic> for the corresponding closed metabolic network (e.g., <xref ref-type="table" rid="pcbi.1004999.t001">Table 1</xref>), i.e., rank(<italic>N</italic>) &lt; rank(<italic>S</italic>). Consequently, <inline-formula id="pcbi.1004999.e012"><alternatives><graphic id="pcbi.1004999.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004999.e012" xlink:type="simple"/><mml:math display="inline" id="M12"><mml:mrow><mml:mtext>dim</mml:mtext> <mml:mo>(</mml:mo> <mml:mi mathvariant="script">N</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mi>S</mml:mi> <mml:mi>T</mml:mi></mml:msup> <mml:mo>)</mml:mo> <mml:mo>)</mml:mo> <mml:mo>&lt;</mml:mo> <mml:mtext>dim</mml:mtext> <mml:mo>(</mml:mo> <mml:mi mathvariant="script">N</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mi>N</mml:mi> <mml:mi>T</mml:mi></mml:msup> <mml:mo>)</mml:mo> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, meaning that there are fewer linearly independent conservation vectors for an open metabolic network than the corresponding closed network. This is consistent with physical reality, since mass can flow into and out of open networks but is conserved within closed networks. All quantities that are conserved in an open metabolic network are also conserved in the corresponding closed network. That is, if <italic>z</italic> is a conservation vector for an open metabolic network <italic>S</italic>, such that <italic>S</italic><sup><italic>T</italic></sup> <italic>z</italic> = 0, then <italic>z</italic> is also a conservation vector for the corresponding closed network <italic>N</italic>, and <italic>N</italic><sup><italic>T</italic></sup> <italic>z</italic> = 0, since <italic>S</italic> = [<italic>N</italic>, <italic>B</italic>]. The set of conservation relations for an open network is therefore a subset of all conservation relations for the corresponding closed network, i.e., <inline-formula id="pcbi.1004999.e013"><alternatives><graphic id="pcbi.1004999.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004999.e013" xlink:type="simple"/><mml:math display="inline" id="M13"><mml:mrow><mml:mi mathvariant="script">N</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mi>S</mml:mi> <mml:mi>T</mml:mi></mml:msup> <mml:mo>)</mml:mo> <mml:mo>⊆</mml:mo> <mml:mi mathvariant="script">N</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mi>N</mml:mi> <mml:mi>T</mml:mi></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. In what follows we will mainly be concerned with the larger set of conservation relations for a closed metabolic network.</p>
<p>Schuster and Hilgetag [<xref ref-type="bibr" rid="pcbi.1004999.ref014">14</xref>] defined a moiety vector <italic>l</italic><sub>1</sub> as a nonnegative integer vector in the left null space of a stoichiometric matrix, i.e.,
<disp-formula id="pcbi.1004999.e014"><alternatives><graphic id="pcbi.1004999.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004999.e014" xlink:type="simple"/><mml:math display="block" id="M14"><mml:mrow><mml:msup><mml:mi>N</mml:mi> <mml:mi>T</mml:mi></mml:msup> <mml:msub><mml:mi>l</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(2)</label></disp-formula> <disp-formula id="pcbi.1004999.e015"><alternatives><graphic id="pcbi.1004999.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004999.e015" xlink:type="simple"/><mml:math display="block" id="M15"><mml:mrow><mml:msub><mml:mi>l</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>∈</mml:mo> <mml:msubsup><mml:mi mathvariant="double-struck">N</mml:mi> <mml:mrow><mml:mn>0</mml:mn></mml:mrow> <mml:mi>m</mml:mi></mml:msubsup> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(3)</label></disp-formula>
In addition, they defined <italic>l</italic><sub>1</sub> to be a maximal moiety vector if it cannot be decomposed into two other vectors <italic>l</italic><sub>2</sub> and <italic>l</italic><sub>3</sub> that satisfy Eqs <xref ref-type="disp-formula" rid="pcbi.1004999.e014">2</xref> and <xref ref-type="disp-formula" rid="pcbi.1004999.e015">3</xref>, i.e., if
<disp-formula id="pcbi.1004999.e016"><alternatives><graphic id="pcbi.1004999.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004999.e016" xlink:type="simple"/><mml:math display="block" id="M16"><mml:mrow><mml:msub><mml:mi>l</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>≠</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:msub><mml:mi>l</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mn>3</mml:mn></mml:msub> <mml:msub><mml:mi>l</mml:mi> <mml:mn>3</mml:mn></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(4)</label></disp-formula>
where <inline-formula id="pcbi.1004999.e017"><alternatives><graphic id="pcbi.1004999.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004999.e017" xlink:type="simple"/><mml:math display="inline" id="M17"><mml:mrow><mml:msub><mml:mi>α</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mn>3</mml:mn></mml:msub> <mml:mo>∈</mml:mo> <mml:msub><mml:mi mathvariant="double-struck">N</mml:mi> <mml:mo>+</mml:mo></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>. We propose a more specific definition. The properties above define increasingly small sets of conservation vectors (<xref ref-type="fig" rid="pcbi.1004999.g001">Fig 1</xref>). <xref ref-type="disp-formula" rid="pcbi.1004999.e014">Eq 2</xref> defines the set of all conservation vectors. Addition of <xref ref-type="disp-formula" rid="pcbi.1004999.e015">Eq 3</xref> defines the set of nonnegative integer conservation vectors and addition of <xref ref-type="disp-formula" rid="pcbi.1004999.e016">Eq 4</xref> defines the set of nonnegative integer conservation vectors that are nondecomposable. Although this set includes all nondecomposable moiety vectors as subset it is not equivalent (<xref ref-type="fig" rid="pcbi.1004999.g001">Fig 1</xref>). To define the set of moiety vectors we require a fourth property. We define <italic>l</italic><sub>1</sub> to be a moiety vector if it satisfies Eqs <xref ref-type="disp-formula" rid="pcbi.1004999.e014">2</xref> and <xref ref-type="disp-formula" rid="pcbi.1004999.e015">3</xref> and represents conservation of a specific metabolic moiety, i.e., an identifiable group of atoms in network metabolites. Element <italic>l</italic><sub>1,<italic>i</italic></sub> should correspond to the number of instances of the conserved moiety in metabolite <italic>i</italic>. We define <italic>l</italic><sub>1</sub> to be a <italic>nondecomposable moiety vector</italic> if it satisfies condition 4 and a <italic>composite moiety vector</italic> if it does not. Nondecomposable moiety vectors for the DOPA decarboxylase reaction from the example metabolic network in <xref ref-type="fig" rid="pcbi.1004999.g002">Fig 2</xref> are given in <xref ref-type="table" rid="pcbi.1004999.t002">Table 2a</xref>. For comparison, conservation vectors computed with existing methods for conservation analysis of metabolic networks are given in <xref ref-type="table" rid="pcbi.1004999.t002">Table 2b–2d</xref>. In general, these vectors do not represent moiety conservation.</p>
<table-wrap id="pcbi.1004999.t002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004999.t002</object-id>
<label>Table 2</label>
<caption>
<title>Different types of conservation vectors for the DOPA decarboxylase reaction.</title>
</caption>
<alternatives>
<graphic id="pcbi.1004999.t002g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004999.t002" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left"/>
<th align="center" colspan="3">(a)</th>
<th align="center" colspan="4">(b)</th>
<th align="center" colspan="3">(c)</th>
<th align="center" colspan="4">(d)</th>
</tr>
<tr>
<th align="left"/>
<th align="left"><italic>l</italic><sub>1</sub></th>
<th align="left"><italic>l</italic><sub>2</sub></th>
<th align="left"><italic>l</italic><sub>3</sub></th>
<th align="center">C</th>
<th align="left">H</th>
<th align="left">O</th>
<th align="left">N</th>
<th align="center"><italic>z</italic><sub>1</sub></th>
<th align="left"><italic>z</italic><sub>2</sub></th>
<th align="left"><italic>z</italic><sub>3</sub></th>
<th align="center"><italic>l</italic><sub>1</sub></th>
<th align="left"><italic>l</italic><sub>2</sub></th>
<th align="left"><italic>l</italic><sub>3</sub></th>
<th align="left"><italic>z</italic><sub>4</sub></th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">L-DOPA</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">0</td>
<td align="center">9</td>
<td align="left">11</td>
<td align="left">4</td>
<td align="left">1</td>
<td align="center">-1/2</td>
<td align="left">1/2</td>
<td align="left">1/2</td>
<td align="center">1</td>
<td align="left">1</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr>
<td align="left">H<sup>+</sup></td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">1</td>
<td align="center">0</td>
<td align="left">1</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="center">5/6</td>
<td align="left">1/6</td>
<td align="left">1/6</td>
<td align="center">0</td>
<td align="left">0</td>
<td align="left">1</td>
<td align="left">1</td>
</tr>
<tr>
<td align="left">DA</td>
<td align="left">1</td>
<td align="left">0</td>
<td align="left">1</td>
<td align="center">8</td>
<td align="left">12</td>
<td align="left">2</td>
<td align="left">1</td>
<td align="center">1/6</td>
<td align="left">5/6</td>
<td align="left">-1/6</td>
<td align="center">1</td>
<td align="left">0</td>
<td align="left">1</td>
<td align="left">0</td>
</tr>
<tr>
<td align="left">CO<sub>2</sub></td>
<td align="left">0</td>
<td align="left">1</td>
<td align="left">0</td>
<td align="center">1</td>
<td align="left">0</td>
<td align="left">2</td>
<td align="left">0</td>
<td align="center">1/6</td>
<td align="left">-1/6</td>
<td align="left">5/6</td>
<td align="center">0</td>
<td align="left">1</td>
<td align="left">0</td>
<td align="left">1</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t002fn001">
<p>Moiety vectors are denoted <italic>l</italic><sub><italic>k</italic></sub>. (a) Moiety vectors computed with the method presented here. Each column represents the conservation of a particular metabolic moiety. <italic>l</italic><sub>1</sub> represents conservation of the dopamine moiety (blue background in <xref ref-type="fig" rid="pcbi.1004999.g002">Fig 2</xref>), <italic>l</italic><sub>2</sub> the CO<sub>2</sub> moiety (red background), and <italic>l</italic><sub>3</sub> the hydrogen moiety (orange background). (b) The elemental matrix. Each column represents conservation of a particular element. Elemental conservation vectors generally do not span the left null space of a stoichiometric matrix. (c) Real-valued conservation vectors computed with singular value decomposition of the internal stoichiometric matrix <italic>N</italic> in <xref ref-type="table" rid="pcbi.1004999.t001">Table 1</xref>. Real-valued conservation vectors cannot generally be interpreted in terms of conserved moieties as they contain negative and noninteger values. (d) Extreme rays of the left null space <inline-formula id="pcbi.1004999.e018"><alternatives><graphic id="pcbi.1004999.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004999.e018" xlink:type="simple"/><mml:math display="inline" id="M18"><mml:mrow><mml:mi mathvariant="script">N</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mi>N</mml:mi> <mml:mi>T</mml:mi></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. The first three belong to the intersection between the sets of extreme rays and moiety vectors in <xref ref-type="fig" rid="pcbi.1004999.g001">Fig 1</xref>. The fourth belongs to the set difference. It cannot represent moiety conservation as no atoms are exchanged between H<sup>+</sup> and CO<sub>2</sub>. Without information about atom mappings between metabolites it would be impossible to determine which extreme rays correspond to conserved moieties. The full set of all nondecomposable nonnegative integer vectors includes 13 additional vectors (not shown), none of which represent moiety conservation.</p>
</fn>
</table-wrap-foot>
</table-wrap>
</sec>
<sec id="sec005">
<title>Atom transition networks</title>
<p>Metabolic reactions conserve mass and chemical elements. Therefore, there must exist a mapping from each atom in a reactant metabolite to a single atom of the same element in a product metabolite. An atom transition is a single mapping from a substrate to a product atom. An <italic>atom transition network</italic> contains information about all atom transitions in a metabolic network. It is a mathematical structure that enables one to trace the paths of each individual atom through a metabolic network. An atom transition network can be generated automatically from a stoichiometric matrix for a metabolic network and atom mappings for internal reactions. The atom transition network for the DOPA decarboxylase reaction from the example metabolic network in <xref ref-type="fig" rid="pcbi.1004999.g002">Fig 2</xref> is shown in <xref ref-type="fig" rid="pcbi.1004999.g003">Fig 3</xref>. Unlike metabolic networks, atom transition networks are graphs since every atom transition (edge) connects exactly two atoms (nodes). They are <italic>directed graphs</italic> since every atom transition has a designated direction that is determined by the directionality of the parent metabolic reaction, i.e., the designation of substrates and products. Because atom transition networks are graphs, they are amenable to analysis with efficient graph algorithms that are not generally applicable to metabolic networks due to the presence of hyperedges [<xref ref-type="bibr" rid="pcbi.1004999.ref024">24</xref>].</p>
<fig id="pcbi.1004999.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004999.g003</object-id>
<label>Fig 3</label>
<caption>
<title>A graphical representation of an atom transition network for the DOPA decarboxylase reaction.</title>
<p>Nodes (open circles) represent atoms. Atoms can be matched to metabolite structures in <xref ref-type="fig" rid="pcbi.1004999.g002">Fig 2</xref> on their metabolite identifiers, colours and numbers. Directed edges (arrows) represent atom transitions. All except one hydrogen atom are omitted to simplify the figure.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004999.g003" xlink:type="simple"/>
</fig>
</sec>
</sec>
<sec id="sec006" sec-type="results">
<title>Results</title>
<sec id="sec007">
<title>Identification of conserved moieties in the dopamine synthesis pathway</title>
<p>We will demonstrate our method by identifying conserved moieties in the simple dopamine synthesis network DAS in <xref ref-type="fig" rid="pcbi.1004999.g004">Fig 4</xref>. This network consists of 11 metabolites, four internal reactions and seven exchange reactions. The total stoichiometric matrix <italic>S</italic> = [<italic>N</italic>, <italic>B</italic>] is given in <xref ref-type="table" rid="pcbi.1004999.t003">Table 3</xref>. The internal stoichiometric matrix <italic>N</italic> is row rank deficient with rank (<italic>N</italic>) = 4. The dimension of the left null space is therefore <inline-formula id="pcbi.1004999.e019"><alternatives><graphic id="pcbi.1004999.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004999.e019" xlink:type="simple"/><mml:math display="inline" id="M19"><mml:mrow><mml:mtext>dim</mml:mtext> <mml:mo>(</mml:mo> <mml:mi mathvariant="script">N</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mi>N</mml:mi> <mml:mi>T</mml:mi></mml:msup> <mml:mo>)</mml:mo> <mml:mo>)</mml:mo> <mml:mo>=</mml:mo> <mml:mn>7</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, meaning that there are seven linearly independent conservation vectors for the closed metabolic network. Our analysis of an atom transition network for DAS will conclude with the computation of seven linearly independent moiety vectors that span <inline-formula id="pcbi.1004999.e020"><alternatives><graphic id="pcbi.1004999.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004999.e020" xlink:type="simple"/><mml:math display="inline" id="M20"><mml:mrow><mml:mi mathvariant="script">N</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mi>N</mml:mi> <mml:mi>T</mml:mi></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. To compute these vectors we require the internal stoichiometric matrix in <xref ref-type="table" rid="pcbi.1004999.t003">Table 3</xref> and atom mappings for the four internal reactions. Here, we used algorithmically predicted atom mappings [<xref ref-type="bibr" rid="pcbi.1004999.ref020">20</xref>]. These data are required to generate an atom transition network for DAS (see <xref ref-type="sec" rid="sec016">Methods</xref>, Section Generation of atom transition networks). By graph theoretical analysis of this atom transition network we derive the first of two alternative representations of moiety conservation relations which we term <italic>moiety graphs</italic>. Nodes in a moiety graph represent separate instances of a conserved moiety. Each node is associated with a specific set of atoms in a particular metabolite. The second representation of moiety conservation relations are the moiety vectors which can be derived from moiety graphs in a straightforward manner. Moiety vectors computed with our method are therefore associated with specific atoms via moiety graphs.</p>
<fig id="pcbi.1004999.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004999.g004</object-id>
<label>Fig 4</label>
<caption>
<title>DAS: a small metabolic network consisting of reactions in the human dopamine synthesis pathway.</title>
<p>Metabolite abbreviations are, Phe: L-phenylalanine (VMH [<xref ref-type="bibr" rid="pcbi.1004999.ref023">23</xref>] ID: phe_L), Tyr: L-tyrosine (VMH ID: tyr_L), L-DOPA: levodopa (VMH ID: 34dhphe), DA: dopamine (VMH ID: dopa), BH<sub>4</sub>: tetrahydrobiopterin (VMH ID: thbpt), BH<sub>2</sub>: dihydrobiopterin (VMH ID: dhbpt). Internal reactions are labelled R1–R4. R1 (dashed lines) is the phenylalanine hydroxylase reaction (VMH ID: r0399). R2 (dotted lines) is the tyrosine hydroxylase reaction (VMH ID: TYR3MO2 and THBPT4ACAMDASE). R3 (dash-dotted lines) is the DOPA decarboxylase reaction (VMH ID: 3HLYTCL). R4 (solid line) is a composite of the formate dehydrogenase reaction (VMH ID: FDH) and the dihydropteridine reductase reaction (VMH ID: DHPR). Exchange reactions are labelled E1–E6. The hydrogen ion (H<sup>+</sup>) exchange reaction E7 was omitted to simplify the figure. Atoms are numbered according to their order in each metabolite’s molfile. Atoms of different elements are numbered separately, in colours matching their elemental symbol. Atoms belonging to the same conserved moiety have identically coloured backgrounds.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004999.g004" xlink:type="simple"/>
</fig>
<table-wrap id="pcbi.1004999.t003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004999.t003</object-id>
<label>Table 3</label>
<caption>
<title>The total stoichiometric matrix <italic>S</italic> = [<italic>N</italic>, <italic>B</italic>] for DAS.</title>
</caption>
<alternatives>
<graphic id="pcbi.1004999.t003g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004999.t003" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left"/>
<th align="center">R1</th>
<th align="center">R2</th>
<th align="center">R3</th>
<th align="center">R4</th>
<th align="center">E1</th>
<th align="center">E2</th>
<th align="center">E3</th>
<th align="center">E4</th>
<th align="center">E5</th>
<th align="center">E6</th>
<th align="center">E7</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Phe</td>
<td align="center">-1</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr>
<td align="left">Tyr</td>
<td align="center">1</td>
<td align="center">-1</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr>
<td align="left">L-DOPA</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">-1</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr>
<td align="left">DA</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">-1</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr>
<td align="left">CO<sub>2</sub></td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">-1</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr>
<td align="left">Formate</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">-1</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">0</td>
</tr>
<tr>
<td align="left">BH<sub>4</sub></td>
<td align="center">-1</td>
<td align="center">-1</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr>
<td align="left">BH<sub>2</sub></td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">-1</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr>
<td align="left">O<sub>2</sub></td>
<td align="center">-1</td>
<td align="center">-1</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr>
<td align="left">H<sub>2</sub>O</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">-1</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr>
<td align="left">H<sup>+</sup></td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">-1</td>
<td align="center">-1</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">1</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t003fn001">
<p>Rows and columns are labelled, respectively, with the corresponding metabolite and reaction identifiers from <xref ref-type="fig" rid="pcbi.1004999.g004">Fig 4</xref>. The hydrogen ion (H<sup>+</sup>) exchange reaction E7 was omitted from <xref ref-type="fig" rid="pcbi.1004999.g004">Fig 4</xref> for simplification. The first four columns of <italic>S</italic> correspond to the internal stoichiometric matrix <italic>N</italic> and the last seven columns correspond to the exchange stoichiometric matrix <italic>B</italic>.</p>
</fn>
</table-wrap-foot>
</table-wrap>
<p>To identify all conserved moieties in DAS we require an atom transition network for all atoms regardless of element but for demonstration purposes we will initially focus only on carbon atoms. A carbon atom transition network for DAS is shown in <xref ref-type="fig" rid="pcbi.1004999.g005">Fig 5a</xref>. Our working definition of a conserved moiety is a group of atoms that follow identical paths through a metabolic network. To identify conserved moieties, we therefore need to trace the paths of individual atoms and determine which paths are identical. The paths of individual atoms through the carbon atom transition network for DAS can be traced by visual inspection of <xref ref-type="fig" rid="pcbi.1004999.g005">Fig 5a</xref>. For example, we can trace a path from C1 in L-phenylalanine to C7 in dopamine via C3 in L-tyrosine and C8 in levodopa. This path is made up of atom transitions in reactions R1, R2, and R3 from <xref ref-type="fig" rid="pcbi.1004999.g004">Fig 4</xref>. In graph theory terms, these four carbon atoms and the atom transitions that connect them constitute a <italic>connected component</italic> [<xref ref-type="bibr" rid="pcbi.1004999.ref025">25</xref>] or, simply, a <italic>component</italic> of the directed graph representing the carbon atom transition network for DAS. A directed graph is said to be <italic>connected</italic> if a path exists between any pair of nodes when edge directions are ignored. A component of a directed graph is a maximal connected subgraph. In total, the carbon atom transition network for DAS in <xref ref-type="fig" rid="pcbi.1004999.g005">Fig 5a</xref> consists of 18 components.</p>
<fig id="pcbi.1004999.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004999.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Identification of conserved carbon moieties in DAS.</title>
<p>(a) The carbon atom transition network. Numbering of atoms and line styles of atom transitions refer to metabolite structures and reactions, respectively, in <xref ref-type="fig" rid="pcbi.1004999.g004">Fig 4</xref>. The directed graph consists of 18 components, one for each of the nine carbon atoms in L-phenylalanine, and one for each of the nine carbon atoms in tetrahydrobiopterin. The single carbon atom (C1) in formate is in the same component as C9 in L-phenylalanine, since a path can be traced between the two atoms when directionalities of atom transitions are ignored. Isomorphic components have matching colours. A single instance of a conserved moiety consists of all equivalent atoms in a set of isomorphic components. (b) Moiety graphs for the three carbon moieties in DAS. Each graph was obtained by merging a set of isomorphic components in (a) into a single directed graph. Each node represents an instance of a conserved moiety. Each edge represents conservation of a moiety between two metabolites in a particular reaction in <xref ref-type="fig" rid="pcbi.1004999.g004">Fig 4</xref> with matching line style. Colours match the background colours of the corresponding moieties in <xref ref-type="fig" rid="pcbi.1004999.g004">Fig 4</xref>. Analysis of the full atom transition network for DAS yielded four additional conserved moieties (<xref ref-type="fig" rid="pcbi.1004999.g006">Fig 6</xref>).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004999.g005" xlink:type="simple"/>
</fig>
<p>The paths of the first eight carbon atoms (C1–C8) in L-phenylalanine are identical in the sense that they include the same number of atoms in each metabolite and the same number of atom transitions in each reaction. In graph theory terms, the components containing C1–C8 in L-phenylalanine are <italic>isomorphic</italic>. An isomorphism between two graphs is a <italic>structure preserving</italic> vertex bijection [<xref ref-type="bibr" rid="pcbi.1004999.ref025">25</xref>]. The definition of isomorphism varies for different types of graphs as they have different structural elements that need to be preserved. An isomorphism between two simple graphs is a vertex bijection that preserves the adjacency and nonadjacency of every node, i.e., its connectivity. An isomorphism between two simple directed graphs must also preserve edge directions. We define an isomorphism between two components of an atom transition network as a vertex bijection that preserves the metabolic identity of every node. The nature of chemical reactions ensures that all other structural elements are preserved along with metabolic identities, including the connectivity of atoms and the number, directions and reaction identities of atom transitions. The 18 components of the carbon atom transition network for DAS in <xref ref-type="fig" rid="pcbi.1004999.g005">Fig 5a</xref> can be divided into three sets, where every pair of components within each set is isomorphic.</p>
<p>An isomorphism between two components of an atom transition network is a one-to-one mapping between atoms in the two components. For example, the isomorphism between the two left-most components in <xref ref-type="fig" rid="pcbi.1004999.g005">Fig 5a</xref> maps between C1 and C2 in L-phenylalanine, C3 and C2 in L-tyrosine, C8 and C7 in L-DOPA, and C7 and C8 in dopamine. We say that two atoms are <italic>equivalent</italic> if an isomorphism maps between them. We note that our definition of isomorphism only allows mappings between atoms with the same metabolic identity. Two atoms can therefore only be equivalent if they are in the same metabolite. Equivalent atoms follow identical paths through a metabolic network and therefore belong to the same conserved moiety. In general, <italic>we define a conserved moiety to be a maximal set of equivalent atoms in an atom transition network</italic>. To identify conserved moieties, we must therefore determine isomorphisms between components of an atom transition network to identify maximal sets of equivalent atoms.</p>
<p>The first eight carbon atoms (C1–C8) in L-phenylalanine are equivalent. They are therefore part of the same conserved moiety, which we denote <italic>λ</italic><sub>1</sub>. The last eight carbon atoms (C2–C9) in L-tyrosine are likewise part of the same conserved moiety. They make up another instance of the <italic>λ</italic><sub>1</sub> moiety. The <italic>λ</italic><sub>1</sub> moiety is conserved between L-phenylalanine and L-tyrosine in reaction R1, between L-tyrosine and levodopa in reaction R2, and between levodopa and dopamine in reaction R3. Each of the four metabolites contains one instance of the <italic>λ</italic><sub>1</sub> moiety. The path of this moiety through DAS defines its conservation relation. This brings us to our first representation of moiety conservation relations, which we term moiety graphs. Moiety graphs are obtained from atom transition networks by merging a set of isomorphic components into a single graph. Moiety graphs for the three carbon atom moieties in DAS are shown in <xref ref-type="fig" rid="pcbi.1004999.g005">Fig 5b</xref>. Four additional moieties were identified by analysis of an atom transition network for DAS that included all atoms regardless of element. All seven moiety graphs are shown in <xref ref-type="fig" rid="pcbi.1004999.g006">Fig 6</xref>. Atoms belonging to each node in the moiety graphs are highlighted in <xref ref-type="fig" rid="pcbi.1004999.g004">Fig 4</xref>.</p>
<fig id="pcbi.1004999.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004999.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Moiety graphs for all seven conserved moieties in DAS.</title>
<p>The seven moieties were identified by analysis of the full atom transition network for DAS in <xref ref-type="fig" rid="pcbi.1004999.g004">Fig 4</xref>. Colours match the background colours of the corresponding moieties in <xref ref-type="fig" rid="pcbi.1004999.g004">Fig 4</xref>. Linestyles of edges match the linestyles of the corresponding reactions in <xref ref-type="fig" rid="pcbi.1004999.g004">Fig 4</xref>. The chemical composition of each moiety is given below its graph.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004999.g006" xlink:type="simple"/>
</fig>
<p>The second way to represent moiety conservation relations is as moiety vectors. Above we defined a moiety vector as a conservation vector <italic>l</italic><sub><italic>k</italic></sub> where element <italic>l</italic><sub><italic>k</italic>,<italic>i</italic></sub> corresponds to the number of instances of moiety <italic>k</italic> in metabolite <italic>i</italic> of a metabolic network (see Section Moiety vectors in <xref ref-type="sec" rid="sec002">Theoretical Framework</xref>). We can now make this definition exact by relating moiety vectors to moiety graphs. Each instance of a conserved moiety is represented as a node in its moiety graph. Element <italic>l</italic><sub><italic>k</italic>,<italic>i</italic></sub> of a moiety vector therefore corresponds to the number of nodes in moiety graph λ<sub><italic>k</italic></sub> that represent moieties in metabolite <italic>i</italic>. Moiety vectors are readily derived from moiety graphs by counting the number of nodes in each metabolite. Moiety vectors for DAS were derived from the moiety graphs in <xref ref-type="fig" rid="pcbi.1004999.g006">Fig 6</xref>. The seven moiety vectors are given as columns of the moiety matrix <inline-formula id="pcbi.1004999.e021"><alternatives><graphic id="pcbi.1004999.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004999.e021" xlink:type="simple"/><mml:math display="inline" id="M21"><mml:mrow><mml:mi>L</mml:mi> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="double-struck">Z</mml:mi> <mml:mrow><mml:mn>11</mml:mn> <mml:mo>×</mml:mo> <mml:mn>7</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> in <xref ref-type="table" rid="pcbi.1004999.t004">Table 4</xref>. These seven vectors are linearly independent and therefore span all seven dimensions of <inline-formula id="pcbi.1004999.e022"><alternatives><graphic id="pcbi.1004999.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004999.e022" xlink:type="simple"/><mml:math display="inline" id="M22"><mml:mrow><mml:mi mathvariant="script">N</mml:mi><mml:mtext> </mml:mtext><mml:mo>(</mml:mo> <mml:msup><mml:mi>N</mml:mi> <mml:mi>T</mml:mi></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. The moiety matrix <italic>L</italic> is therefore a <italic>moiety basis</italic> for the left null space.</p>
<table-wrap id="pcbi.1004999.t004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004999.t004</object-id>
<label>Table 4</label>
<caption>
<title>Moiety vectors for DAS.</title>
</caption>
<alternatives>
<graphic id="pcbi.1004999.t004g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004999.t004" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left"/>
<th align="center"><italic>l</italic><sub>1</sub></th>
<th align="center"><italic>l</italic><sub>2</sub></th>
<th align="center"><italic>l</italic><sub>3</sub></th>
<th align="center"><italic>l</italic><sub>4</sub></th>
<th align="center"><italic>l</italic><sub>5</sub></th>
<th align="center"><italic>l</italic><sub>6</sub></th>
<th align="center"><italic>l</italic><sub>7</sub></th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Phe</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr>
<td align="left">Tyr</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">0</td>
</tr>
<tr>
<td align="left">L-DOPA</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">2</td>
<td align="center">0</td>
</tr>
<tr>
<td align="left">DA</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">2</td>
<td align="center">0</td>
</tr>
<tr>
<td align="left">CO<sub>2</sub></td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr>
<td align="left">Formate</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr>
<td align="left">BH<sub>4</sub></td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr>
<td align="left">BH<sub>2</sub></td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr>
<td align="left">O<sub>2</sub></td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">1</td>
</tr>
<tr>
<td align="left">H<sub>2</sub>O</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">1</td>
</tr>
<tr>
<td align="left">H<sup>+</sup></td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t004fn001">
<p>The seven moiety vectors, denoted <italic>l</italic><sub>1</sub>–<italic>l</italic><sub>7</sub> are written as columns of the moiety matrix <italic>L</italic>. Note that <italic>L</italic><sub>3,6</sub> = <italic>L</italic><sub>4,6</sub> = 2 because levodopa (<italic>i</italic> = 3) and dopamine (<italic>i</italic> = 4) each contain two instances of the <italic>l</italic><sub>6</sub> moiety (see moiety graph <italic>λ</italic><sub>6</sub> in <xref ref-type="fig" rid="pcbi.1004999.g006">Fig 6</xref>).</p>
</fn>
</table-wrap-foot>
</table-wrap>
</sec>
<sec id="sec008">
<title>Effects of variable atom mappings between recurring metabolite pairs</title>
<p>Atom transition networks are generated from atom mappings for internal reactions of metabolic networks. However, atom mappings for metabolic reactions are not necessarily unique. Computationally predicted atom mappings, as used here, are always associated with some uncertainty. In addition, there can be biochemical variability in atom mappings, in particular for metabolites containing symmetric atoms. All reactions of the O<sub>2</sub> molecule, for example, have at least two biochemically equivalent atom mappings since the two symmetric oxygen atoms map with equal probability to connected atoms. Different atom mappings give rise to different atom transition networks that may contain different moiety conservation relations. For the most part, we found that varying the set of input atom mappings did not affect the number of computed moiety conservation relations, only their atomic structure. An important exception was when atom mappings between the same pair of metabolites varied between reactions in the same metabolic network.</p>
<p>The same pair of metabolites often exchange atoms in multiple reactions throughout the same metabolic network. Common cofactors such as ATP and ADP, for example, exchange atoms in hundreds of reactions in large metabolic networks [<xref ref-type="bibr" rid="pcbi.1004999.ref026">26</xref>]. In the dopamine synthesis network, DAS in <xref ref-type="fig" rid="pcbi.1004999.g004">Fig 4</xref>, O<sub>2</sub> and H<sub>2</sub>O exchange an oxygen atom in two reactions, R1 and R2. Since the two oxygen atoms of O<sub>2</sub> are symmetric, there are four possible combinations of oxygen atom mappings for these two reactions. Each combination gives rise to a different oxygen transition network as shown in <xref ref-type="fig" rid="pcbi.1004999.g007">Fig 7</xref>. Two of these oxygen transition networks, shown in <xref ref-type="fig" rid="pcbi.1004999.g007">Fig 7a and 7b</xref>, contain two moiety conservation relations each, <italic>λ</italic><sub>6</sub> and <italic>λ</italic><sub>7</sub>, which are shown in <xref ref-type="fig" rid="pcbi.1004999.g007">Fig 7c</xref>. The other two oxygen transition networks, shown in <xref ref-type="fig" rid="pcbi.1004999.g007">Fig 7d and 7e</xref>, contain only one moiety conservation relation each, <italic>λ</italic><sub>8</sub>, which is shown in <xref ref-type="fig" rid="pcbi.1004999.g007">Fig 7f</xref>.</p>
<fig id="pcbi.1004999.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004999.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Effects of variable atom mappings between O<sub>2</sub> and H<sub>2</sub>O in DAS.</title>
<p>The recurring metabolite pair exchanges an oxygen atom in two reactions, R1 and R2 in <xref ref-type="fig" rid="pcbi.1004999.g004">Fig 4</xref>. Since the two oxygen atoms of O<sub>2</sub> are symmetric, there are four possible combinations of oxygen atom mappings for these two reactions. Each combination gives rise to a different oxygen transition network. (a) The first oxygen atom (O1) in O<sub>2</sub> maps to the single oxygen atom (O1) in H<sub>2</sub>O in both R1 and R2. (b) O2 in O<sub>2</sub> maps to O1 in H<sub>2</sub>O in both R1 and R2. (c) Moiety graphs obtained from the oxygen atom transition networks in (a) and (b). Two nondecomposable moiety conservation relations were identified in each atom transition network where the same atom mapped from O<sub>2</sub> to H<sub>2</sub>O in both R1 and R2. (d) O1 in O<sub>2</sub> maps to O1 in H<sub>2</sub>O in R1 while O2 in O<sub>2</sub> maps to O1 in H<sub>2</sub>O in R2. (e) O2 in O<sub>2</sub> maps to O1 in H<sub>2</sub>O in R1 while O1 in O<sub>2</sub> maps to O1 in H<sub>2</sub>O in R2. (f) The single moiety graph obtained from the oxygen atom transition networks in (d) and (e). Only one composite moiety conservation relation was identified in each atom transition network where a different atom mapped from O<sub>2</sub> to H<sub>2</sub>O in R1 than R2.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004999.g007" xlink:type="simple"/>
</fig>
<p>The DAS atom transition network considered in the previous section was generated with the oxygen atom mappings in <xref ref-type="fig" rid="pcbi.1004999.g007">Fig 7a</xref> and thus contained the two moiety conservation relations <italic>λ</italic><sub>6</sub> and <italic>λ</italic><sub>7</sub> (see <xref ref-type="fig" rid="pcbi.1004999.g006">Fig 6</xref>). An atom transition network generated with the atom mappings in <xref ref-type="fig" rid="pcbi.1004999.g007">Fig 7d or 7e</xref> would contain the single moiety conservation relation <italic>λ</italic><sub>8</sub> instead of these two. What distinguishes the oxygen transition networks in <xref ref-type="fig" rid="pcbi.1004999.g007">Fig 7d and 7e</xref> is that the oxygen atom in O<sub>2</sub> that maps to H<sub>2</sub>O varies between the two reactions R1 and R2. The atom transition network for DAS therefore contains one less moiety conservation relation if the atom mapping between this recurring metabolite pair varies between reactions. The moiety matrix for these alternative atom transition networks,
<disp-formula id="pcbi.1004999.e023"><alternatives><graphic id="pcbi.1004999.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004999.e023" xlink:type="simple"/><mml:math display="block" id="M23"><mml:mrow><mml:mi>L</mml:mi> <mml:mo>=</mml:mo> <mml:mfenced close="]" open="[" separators=""><mml:msub><mml:mi>l</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>l</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>l</mml:mi> <mml:mn>3</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>l</mml:mi> <mml:mn>4</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>l</mml:mi> <mml:mn>5</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>l</mml:mi> <mml:mn>8</mml:mn></mml:msub></mml:mfenced> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(5)</label></disp-formula>
only contains six linearly independent columns and is therefore not a basis for the seven dimensional left null space of <italic>N</italic>.</p>
<p>The vector representation of moiety graph <italic>λ</italic><sub>8</sub> is
<disp-formula id="pcbi.1004999.e024"><alternatives><graphic id="pcbi.1004999.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004999.e024" xlink:type="simple"/><mml:math display="block" id="M24"><mml:mrow><mml:msubsup><mml:mi>l</mml:mi> <mml:mrow><mml:mn>8</mml:mn></mml:mrow> <mml:mi>T</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:mfenced close="]" open="["><mml:mtable><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>1</mml:mn></mml:mtd> <mml:mtd><mml:mn>2</mml:mn></mml:mtd> <mml:mtd><mml:mn>2</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>2</mml:mn></mml:mtd> <mml:mtd><mml:mn>1</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mfenced> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(6)</label></disp-formula>
We note that <italic>l</italic><sub>8</sub> = <italic>l</italic><sub>6</sub> + <italic>l</italic><sub>7</sub> where
<disp-formula id="pcbi.1004999.e025"><alternatives><graphic id="pcbi.1004999.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004999.e025" xlink:type="simple"/><mml:math display="block" id="M25"><mml:mrow><mml:msubsup><mml:mi>l</mml:mi> <mml:mrow><mml:mn>6</mml:mn></mml:mrow> <mml:mi>T</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:mfenced close="]" open="["><mml:mtable><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>1</mml:mn></mml:mtd> <mml:mtd><mml:mn>2</mml:mn></mml:mtd> <mml:mtd><mml:mn>2</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>1</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mfenced> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(7)</label></disp-formula> <disp-formula id="pcbi.1004999.e026"><alternatives><graphic id="pcbi.1004999.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004999.e026" xlink:type="simple"/><mml:math display="block" id="M26"><mml:mrow><mml:msubsup><mml:mi>l</mml:mi> <mml:mrow><mml:mn>7</mml:mn></mml:mrow> <mml:mi>T</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:mfenced close="]" open="["><mml:mtable><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>1</mml:mn></mml:mtd> <mml:mtd><mml:mn>1</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mfenced> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(8)</label></disp-formula>
from <xref ref-type="table" rid="pcbi.1004999.t004">Table 4</xref>. The moiety vector <italic>l</italic><sub>8</sub> therefore represents a composite moiety. It does not meet the definition of a nondecomposable moiety vector in <xref ref-type="disp-formula" rid="pcbi.1004999.e016">Eq 4</xref>. This example shows that variable atom mappings between recurring metabolite pairs may cause multiple nondecomposable moiety conservation relations to be joined together into a single composite moiety conservation relation. We formulated an optimisation problem, described in Methods, Section Decomposition of moiety vectors, to decompose composite moiety vectors. Solving this problem for the composite moiety vector <italic>l</italic><sub>8</sub> yields the two nondecomposable components <italic>l</italic><sub>6</sub> and <italic>l</italic><sub>7</sub>.</p>
</sec>
<sec id="sec009">
<title>General properties of identified moieties</title>
<p>We applied our method to identify conserved moieties in three metabolic networks of increasing size. The networks, listed from smallest to largest, were the dopamine synthesis network, DAS in <xref ref-type="fig" rid="pcbi.1004999.g004">Fig 4</xref>, the <italic>E. coli</italic> core metabolic network, iCore [<xref ref-type="bibr" rid="pcbi.1004999.ref027">27</xref>], and an atom mapped subset of the generic human metabolic reconstruction, Recon 2 [<xref ref-type="bibr" rid="pcbi.1004999.ref026">26</xref>] which we refer to here as subRecon. The dimensions of the three networks are given in <xref ref-type="table" rid="pcbi.1004999.t005">Table 5a</xref>. Further descriptions are provided in Methods, Section Metabolic networks. There are seven linearly independent conservation relations for the closed DAS network, 11 for iCore, and 351 for subRecon.</p>
<table-wrap id="pcbi.1004999.t005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004999.t005</object-id>
<label>Table 5</label>
<caption>
<title>Results for the three metabolic networks treated here.</title>
</caption>
<alternatives>
<graphic id="pcbi.1004999.t005g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004999.t005" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<tbody>
<tr>
<td align="left" colspan="4">(a)</td>
</tr>
<tr>
<td align="left">Network</td>
<td align="center">DAS</td>
<td align="center">iCore</td>
<td align="center">subRecon</td>
</tr>
<tr>
<td align="left">Metabolites (<italic>m</italic>)</td>
<td align="center">11</td>
<td align="center">72</td>
<td align="center">2,970</td>
</tr>
<tr>
<td align="left">Internal reactions (<italic>u</italic>)</td>
<td align="center">4</td>
<td align="center">74</td>
<td align="center">4,261</td>
</tr>
<tr>
<td align="left">rank(<italic>N</italic>)</td>
<td align="center">4</td>
<td align="center">61</td>
<td align="center">2,619</td>
</tr>
<tr>
<td align="left">dim(null(<italic>N</italic><sup><italic>T</italic></sup>))</td>
<td align="center">7</td>
<td align="center">11</td>
<td align="center">351</td>
</tr>
<tr>
<td align="left" colspan="4">(b)</td>
</tr>
<tr>
<td align="left">Initial moieties (<italic>r</italic>)</td>
<td align="center">7</td>
<td align="center">10</td>
<td align="center">345</td>
</tr>
<tr>
<td align="left">rank(<italic>L</italic>)</td>
<td align="center">7</td>
<td align="center">10</td>
<td align="center">340</td>
</tr>
<tr>
<td align="left">Decomposed moieties (<italic>t</italic>)</td>
<td align="center">7</td>
<td align="center">11</td>
<td align="center">353</td>
</tr>
<tr>
<td align="left">rank(<italic>D</italic>)</td>
<td align="center">7</td>
<td align="center">11</td>
<td align="center">347</td>
</tr>
<tr>
<td align="left" colspan="4">(c)</td>
</tr>
<tr>
<td align="left">Carbon atom isotopomers</td>
<td align="center">2.8×10<sup>3</sup></td>
<td align="center">1.1×10<sup>15</sup></td>
<td align="center">6.2×10<sup>23</sup></td>
</tr>
<tr>
<td align="left">Carbon moiety isotopomers</td>
<td align="center">2.2×10<sup>1</sup></td>
<td align="center">1.4×10<sup>3</sup></td>
<td align="center">4.9×10<sup>18</sup></td>
</tr>
<tr>
<td align="left" colspan="4">(d)</td>
</tr>
<tr>
<td align="left">Atoms (<italic>p</italic>)</td>
<td align="center">170</td>
<td align="center">1,697</td>
<td align="center">153,298</td>
</tr>
<tr>
<td align="left">Atom transitions (<italic>q</italic>)</td>
<td align="center">176</td>
<td align="center">6,019</td>
<td align="center">446,900</td>
</tr>
<tr>
<td align="left">Graph-based method (this work)</td>
<td align="center">1.8×10<sup>-1</sup></td>
<td align="center">5.6×10<sup>-1</sup></td>
<td align="center">2.8×10<sup>2</sup></td>
</tr>
<tr>
<td align="left">Vertex enumeration algorithm [<xref ref-type="bibr" rid="pcbi.1004999.ref013">13</xref>]</td>
<td align="center">6.1×10<sup>-2</sup></td>
<td align="center">9.1×10<sup>-1</sup></td>
<td align="center">&gt;6.0×10<sup>5</sup></td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t005fn001">
<p>(a) Dimensions of stoichiometric matrices. The number of linearly independent conservation relations is <inline-formula id="pcbi.1004999.e027"><alternatives><graphic id="pcbi.1004999.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004999.e027" xlink:type="simple"/><mml:math display="inline" id="M27"><mml:mrow><mml:mtext>dim</mml:mtext> <mml:mo>(</mml:mo> <mml:mi mathvariant="script">N</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mi>N</mml:mi> <mml:mi>T</mml:mi></mml:msup> <mml:mo>)</mml:mo> <mml:mo>)</mml:mo> <mml:mo>=</mml:mo> <mml:mi>m</mml:mi> <mml:mo>-</mml:mo> <mml:mtext>rank</mml:mtext> <mml:mo>(</mml:mo> <mml:mi>N</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> in a closed network with stoichiometric matrix <inline-formula id="pcbi.1004999.e028"><alternatives><graphic id="pcbi.1004999.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004999.e028" xlink:type="simple"/><mml:math display="inline" id="M28"><mml:mrow><mml:mi>N</mml:mi> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="double-struck">Z</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>×</mml:mo> <mml:mi>u</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>. (b) Dimensions of moiety matrices. Initial moiety matrices <inline-formula id="pcbi.1004999.e029"><alternatives><graphic id="pcbi.1004999.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004999.e029" xlink:type="simple"/><mml:math display="inline" id="M29"><mml:mrow><mml:mi>L</mml:mi> <mml:mo>∈</mml:mo> <mml:msubsup><mml:mi mathvariant="double-struck">N</mml:mi> <mml:mrow><mml:mn>0</mml:mn></mml:mrow> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>×</mml:mo> <mml:mi>r</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> were computed directly from predicted atom transition networks. Decomposed moiety matrices <inline-formula id="pcbi.1004999.e030"><alternatives><graphic id="pcbi.1004999.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004999.e030" xlink:type="simple"/><mml:math display="inline" id="M30"><mml:mrow><mml:mi>D</mml:mi> <mml:mo>∈</mml:mo> <mml:msubsup><mml:mi mathvariant="double-struck">N</mml:mi> <mml:mrow><mml:mn>0</mml:mn></mml:mrow> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>×</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> were derived by decomposing the columns of <italic>L</italic> as described in Methods, Section Decomposition of moiety vectors. (c) Carbon isotopomers (see Section Application of moiety graphs to stable isotope assisted metabolic flux analysis). Comparison between the number of carbon atom and carbon moiety isotopomers. (d) Computation times (in seconds) for the graph-based method presented here, in comparison to the vertex enumeration algorithm described in [<xref ref-type="bibr" rid="pcbi.1004999.ref013">13</xref>] (see Section Computational complexity).</p>
</fn>
</table-wrap-foot>
</table-wrap>
<p>Atom transition networks were generated using algorithmically predicted atom mappings [<xref ref-type="bibr" rid="pcbi.1004999.ref020">20</xref>] as described in Methods, Section Generation of atom transition networks. Seven, ten and 345 moiety conservation relations were identified in the predicted atom transition network for DAS, iCore and subRecon, respectively (<xref ref-type="table" rid="pcbi.1004999.t005">Table 5b</xref>). Characterisation of identified moieties revealed some trends (<xref ref-type="fig" rid="pcbi.1004999.g008">Fig 8</xref>). We found a roughly inverse relationship between the frequency of a moiety, defined as the number of instances, and the size of that moiety, defined as the number of atoms per instance. We also found a relationship between moiety size, frequency and classification. Internal moieties tended to be large and infrequent, occurring in a small number of closely related secondary metabolites, e.g., the 35 atom AMP moiety found in the three iCore metabolites AMP, ADP and ATP. Integrative moieties were usually small and frequent while transitive moieties were intermediate in both size and frequency. The smallest moieties consisted of single atoms. These were often highly frequent, occurring in up to 62/72 iCore metabolites and 2,472/2,970 subRecon metabolites. These results indicate a remarkable interconnectivity between metabolites at the atomic level. Due to their frequency, single atom moieties accounted for a large portion of atoms in each metabolic network. Single atom moieties accounted for nearly half (791/1,697) of all atoms in iCore, and approximately two thirds (104,268/153,298) of all atoms in subRecon.</p>
<fig id="pcbi.1004999.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004999.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Characteristics of conserved moieties identified in the three metabolic networks treated here.</title>
<p>The total number of instances of a moiety is plotted against the number of atoms per instance. Classification of moieties as transitive, internal, or integrative is described in, Methods, Section Classification of moieties.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004999.g008" xlink:type="simple"/>
</fig>
<p>Moiety matrices derived from the predicted atom transition networks for iCore and subRecon did not span the left null spaces of their respective stoichiometric matrices, indicating that they might contain composite moiety vectors. Using the method described in Methods, Section Decomposition of moiety vectors, we found two composite moiety vectors in the moiety matrix for iCore, and 10 in the one for subRecon. Decomposition of these vectors yielded three new nondecomposable moiety vectors for iCore and 18 for subRecon (<xref ref-type="table" rid="pcbi.1004999.t005">Table 5b</xref>). The 11 nondecomposable moiety vectors for iCore were linearly independent. They therefore comprised a basis for the 11 dimensional left null space of <italic>N</italic> for iCore. The 353 nondecomposable moiety vectors for subRecon, on the other hand, were not linearly independent and only spanned 347 out of 351 dimensions in the left null space of <italic>S</italic> for subRecon. This indicated that there existed conservation relations for subRecon that were independent of atom conservation.</p>
<p>Schuster and Höfer, citing earlier work by Aris [<xref ref-type="bibr" rid="pcbi.1004999.ref028">28</xref>] and Corio [<xref ref-type="bibr" rid="pcbi.1004999.ref029">29</xref>], noted the importance of considering electron conservation in addition to atom conservation [<xref ref-type="bibr" rid="pcbi.1004999.ref011">11</xref>]. Unfortunately, it is not as straightforward to map electrons as atoms and no formalism currently exists for electron mappings. As a result, electron conservation relations cannot be computed with the current version of our algorithm. We therefore computed electron conservation relations for subRecon by decomposing the electron vector with the method described in Methods, Section Decomposition of moiety vectors. An electron vector for a metabolic network with m metabolites is a vector <inline-formula id="pcbi.1004999.e031"><alternatives><graphic id="pcbi.1004999.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004999.e031" xlink:type="simple"/><mml:math display="inline" id="M31"><mml:mrow><mml:mi>e</mml:mi> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="double-struck">N</mml:mi> <mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> where <italic>e</italic><sub><italic>i</italic></sub> is the total number of electrons in metabolite <italic>i</italic>. Decomposition of <italic>e</italic> for subRecon yielded 11 new conservation vectors. When combined, the 11 electron vectors and the 353 fully decomposed moiety vectors for subRecon (<xref ref-type="table" rid="pcbi.1004999.t005">Table 5b</xref>) spanned the left null space of the subRecon stoichiometric matrix.</p>
</sec>
<sec id="sec010">
<title>The gearwheels of metabolism</title>
<p>Internal moieties define pools of metabolites with constant total concentration and dependent individual concentrations. In the small dopamine synthesis network DAS in <xref ref-type="fig" rid="pcbi.1004999.g004">Fig 4</xref>, the biopterin moiety (<italic>l</italic><sub>3</sub>) is classified as internal. This moiety is conserved between the metabolites BH<sub>2</sub> and BH<sub>4</sub>. The total concentration of BH<sub>2</sub> and BH<sub>4</sub> is therefore fixed at a constant value in DAS. If the concentration of BH<sub>2</sub> increases, the concentration of BH<sub>4</sub> must decrease by the same amount and vice versa.</p>
<p>The concentration dependency between BH<sub>2</sub> and BH<sub>4</sub> couples all reactions that interconvert the two metabolites. Assume that DAS is initially at a steady state when there is a sudden increase in flux through reactions R1, R2, R3 and associated exchanges such that the concentrations of all primary metabolites remain constant. This would lead to net consumption of BH<sub>4</sub> accompanied by net production of BH<sub>2</sub>. The increased BH<sub>2</sub>/BH<sub>4</sub> concentration ratio would increase thermodynamic and mass action kinetic driving forces through R4, while simultaneously decreasing driving forces through R1 and R2. The system would eventually settle back to the initial steady state or a new one depending on reaction kinetic parameters and substrate availability. Conservation of the biopterin moiety therefore imposes a purely physicochemical form of regulation on dopamine synthesis that is mediated through mass action kinetics and thermodynamics. This statement can be generalised to all internal moieties, as Reich and Sel’kov did in their 1981 monograph on energy metabolism [<xref ref-type="bibr" rid="pcbi.1004999.ref002">2</xref>].</p>
<p>Reich and Sel‘kov’s gearwheel analogy [<xref ref-type="bibr" rid="pcbi.1004999.ref002">2</xref>] is appropriate for the five internal moieties we identified in iCore. These five moieties define five well known cofactor pools (<xref ref-type="table" rid="pcbi.1004999.t006">Table 6</xref>). Each pool is coupled to a set of reactions that interconvert metabolites within that pool. The five pools are also coupled to each other through shared reactions, forming a gearwheel-like mechanism (<xref ref-type="fig" rid="pcbi.1004999.g009">Fig 9</xref>). A change in concentration ratios within any pool will affect the driving forces that turn the wheels. The central wheel in iCore is the NAD moiety (<italic>l</italic><sub>6</sub>). A change in concentration ratios within one pool will therefore be propagated to other pools via the NAD/NADH concentration ratio (<xref ref-type="fig" rid="pcbi.1004999.g009">Fig 9</xref>). This example shows how local changes in the state of a metabolic network can be propagated throughout the network via coupled cofactor pools defined by internal moieties.</p>
<table-wrap id="pcbi.1004999.t006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004999.t006</object-id>
<label>Table 6</label>
<caption>
<title>Internal moieties in iCore.</title>
</caption>
<alternatives>
<graphic id="pcbi.1004999.t006g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004999.t006" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center">Moiety</th>
<th align="left">Chemical composition</th>
<th align="left">Metabolites</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><italic>l</italic><sub>1</sub></td>
<td align="left">C<sub>49</sub>H<sub>74</sub>O<sub>4</sub></td>
<td align="left">Q8, Q8H2</td>
</tr>
<tr>
<td align="center"><italic>l</italic><sub>2</sub></td>
<td align="left">C<sub>21</sub>H<sub>25</sub>N<sub>7</sub>O<sub>17</sub>P<sub>3</sub></td>
<td align="left">NADP, NADPH</td>
</tr>
<tr>
<td align="center"><italic>l</italic><sub>4</sub></td>
<td align="left">C<sub>10</sub>H<sub>12</sub>N<sub>5</sub>O<sub>7</sub>P</td>
<td align="left">AMP, ADP, ATP</td>
</tr>
<tr>
<td align="center"><italic>l</italic><sub>6</sub></td>
<td align="left">C<sub>21</sub>H<sub>26</sub>N<sub>7</sub>O<sub>14</sub>P<sub>2</sub></td>
<td align="left">NAD, NADH</td>
</tr>
<tr>
<td align="center"><italic>l</italic><sub>7</sub></td>
<td align="left">C<sub>21</sub>H<sub>31</sub>N<sub>7</sub>O<sub>16</sub>P<sub>3</sub>S</td>
<td align="left">CoA, Acetyl-CoA, Succinyl-CoA</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<fig id="pcbi.1004999.g009" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004999.g009</object-id>
<label>Fig 9</label>
<caption>
<title>Coupling between internal moiety pools in iCore.</title>
<p>The five pools from <xref ref-type="table" rid="pcbi.1004999.t006">Table 6</xref> are coupled into a gearwheel-like mechanism. An increase in the NAD/NADH concentration ratio would affect driving forces in the direction shown. (a) Any reactions that interconvert NAD and NADH would be driven in the direction of increased NAD consumption. These include reactions of glycolysis and the TCA cycle, reactions converting malate and lactate to pyruvate, and reactions converting pyruvate, ethanol, and acetaldehyde to acetyl CoA. In short, NAD/NADH coupled reactions would be driven in the direction of increased acetyl CoA production from available carbon sources. (b) The increased NAD/NADH concentration ratio would also affect driving forces through reactions that couple the NAD pool to other cofactor pools. Altered flux through these reactions would in turn affect concentration ratios within those pools which are coupled to their own sets of reactions. (c) An increased NADP/NADPH ratio would drive flux through the pentose phosphate pathway and conversion of glutamate to alpha-ketoglutarate. An increased Q8/Q8H2 ratio would inhibit flux through the electron transport chain. Increased acetyl-CoA/CoA and succinyl-CoA/CoA ratios would drive acetate production and TCA cycle reactions, respectively, which are coupled to ATP production from ADP. (d) An increase in the ATP/ADP ratio resulting from increased flux through these reactions would drive ATP consuming reactions. In iCore, ATP consuming reactions are mainly found in gluconeogenesis so the increased ATP/ADP ratio would counteract the effects of an increased NAD/NADH ratio to some extent.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004999.g009" xlink:type="simple"/>
</fig>
<p>The majority of moieties identified in subRecon were classified as internal (237/345). Most of these internal moieties were artefacts of the way the subset of reactions from Recon 2 were selected, i.e., based on the availability of atom mapping data (see <xref ref-type="sec" rid="sec016">Methods</xref>, Section Metabolic networks). Many reactions in subRecon were disconnected from the rest of the network and therefore could not carry any flux. To identify reactions capable of carrying flux, we computed the flux consistent part of subRecon [<xref ref-type="bibr" rid="pcbi.1004999.ref030">30</xref>], which consisted of 3,225 reactions and 1,746 metabolites. We identified 118 moiety conservation relations for this part of subRecon, 33 of which were classified as internal. The metabolite pools defined by these moieties consisted of between 2 and 9 metabolites and were distributed across five cell compartments; the cytosol, mitochondria, nucleus, endoplasmic reticulum, and peroxisomes. Some moieties were compartment specific while others were distributed amongst metabolites in two different compartments. As in iCore, the internal moiety pools were not independent of each other but were coupled by shared reactions.</p>
</sec>
<sec id="sec011">
<title>Application of moiety graphs to stable isotope assisted metabolic flux analysis</title>
<p>Atoms in the same instance of a conserved moiety all follow the same path through a metabolic network. In an atom transition network these atoms are represented as separate nodes and their atom transitions as separate edges. A moiety graph encodes the paths of all atoms in an atom transition network in a reduced number of nodes and edges. In effect, they are reduced representations of atom transition networks that can be used in many of the same applications. Atom transition networks arise most frequently in the context of stable isotope assisted metabolic flux analysis where they underpin the ability to model the flow of isotopically labelled atoms through metabolic networks [<xref ref-type="bibr" rid="pcbi.1004999.ref031">31</xref>]. Stable isotope assisted metabolic flux analysis (MFA) deals with estimation of internal reaction fluxes in a metabolic network based on data from isotope labelling experiments [<xref ref-type="bibr" rid="pcbi.1004999.ref031">31</xref>]. Internal fluxes are estimated by fitting a mathematical model to measured exchange fluxes and isotopomer distributions.</p>
<p>A basic MFA model consists of nonlinear flux balance equations formulated around isotopomers of metabolites in the metabolic network of interest [<xref ref-type="bibr" rid="pcbi.1004999.ref032">32</xref>]. A metabolite with <italic>n</italic> carbon atoms has 2<sup><italic>n</italic></sup> carbon atom isotopomers. Therefore, the number of isotopomer balance equations grows exponentially with the number of metabolites in the metabolic network. More sophisticated MFA modelling frameworks have been developed to reduce the complexity of the problem, notably the cumomer [<xref ref-type="bibr" rid="pcbi.1004999.ref033">33</xref>] and elementary metabolite unit (EMU) [<xref ref-type="bibr" rid="pcbi.1004999.ref034">34</xref>] frameworks. Cumomer models consist of flux balance equations formulated around transformed variables called cumomers. They are the same size as isotopomer models but have a simpler structure that makes them easier to solve. EMU models have a similar structure as cumomer models but are significantly smaller. They consist of flux balance equations formulated around transformed variables known as EMU species. The number of EMU species for a given metabolic network is much smaller than the number of isotopomers and cumomers.</p>
<p>MFA models can be derived from moiety graphs instead of atom transition networks without loss of predictive capacity. We say that a moiety is labelled if any of its atoms are labelled and define moiety isotopomers as different labelling states of a metabolite’s moieties. The eight carbon containing metabolites in DAS (<xref ref-type="fig" rid="pcbi.1004999.g004">Fig 4</xref>) have 2,820 possible carbon atom isotopomers. Their 55 carbon atoms can be grouped into 11 carbon moieties (<xref ref-type="fig" rid="pcbi.1004999.g005">Fig 5b</xref>) with only 22 possible carbon moiety isotopomers. The reduction in number of isotopomers is even more pronounced for the two larger metabolic networks (<xref ref-type="table" rid="pcbi.1004999.t005">Table 5c</xref>), reaching 12 orders of magnitude for iCore. It was less for subRecon where a greater proportion of moieties consist of a single atom (<xref ref-type="fig" rid="pcbi.1004999.g008">Fig 8</xref>). However, it was still substantial. Deriving MFA models from moiety graphs can therefore reduce the number of model equations by several orders of magnitude. Isotopomer and cumomer models, in particular, can be simplified with this approach. The algorithm to generate EMU species from atom transition networks ensures that atoms in the same instance of a conserved moiety are always part of the same EMU species. EMU models derived from moiety graphs will therefore be identical to those derived from atom transition networks (see supporting file <xref ref-type="supplementary-material" rid="pcbi.1004999.s002">S1 Fig</xref>). Regardless of the MFA modelling framework, moiety graphs can be used to simplify design of isotope labelling experiments, by reducing the number of options for labelled substrates.</p>
</sec>
<sec id="sec012">
<title>Application of moiety vectors to decomposition of metabolic networks</title>
<p>Moiety vectors can be used to decompose a metabolic network into simpler moiety subnetworks [<xref ref-type="bibr" rid="pcbi.1004999.ref035">35</xref>]. An open metabolic network with total stoichiometric matrix <italic>S</italic> can be decomposed into <italic>t</italic> moiety subnetworks where <italic>t</italic> is the number of moiety conservation relations for the corresponding closed network <italic>N</italic>. Each moiety vector <inline-formula id="pcbi.1004999.e032"><alternatives><graphic id="pcbi.1004999.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004999.e032" xlink:type="simple"/><mml:math display="inline" id="M32"><mml:mrow><mml:msub><mml:mi>l</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>∈</mml:mo> <mml:mi mathvariant="script">N</mml:mi><mml:mtext> </mml:mtext><mml:mo>(</mml:mo> <mml:mi>N</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> defines a stoichiometric matrix for one moiety subnetwork as
<disp-formula id="pcbi.1004999.e033"><alternatives><graphic id="pcbi.1004999.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004999.e033" xlink:type="simple"/><mml:math display="block" id="M33"><mml:mrow><mml:msup><mml:mi>S</mml:mi> <mml:mfenced close=")" open="("><mml:mi>k</mml:mi></mml:mfenced></mml:msup> <mml:mo>=</mml:mo> <mml:mi>d</mml:mi> <mml:mi>i</mml:mi> <mml:mi>a</mml:mi> <mml:mi>g</mml:mi> <mml:mfenced close=")" open="(" separators=""><mml:msub><mml:mi>l</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mfenced> <mml:mi>S</mml:mi> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(9)</label></disp-formula>
Stoichiometric matrices for moiety subnetworks (<italic>S</italic><sup>(<italic>k</italic>)</sup>) are generally more sparse than the stoichiometric matrix for the full metabolic network (<italic>S</italic>). Each moiety subnetwork only includes the subparts of metabolites and reactions that involve a particular moiety. Moiety subnetworks of DAS are shown in <xref ref-type="fig" rid="pcbi.1004999.g010">Fig 10a</xref>. In addition to being more sparse than the full metabolic network (<xref ref-type="fig" rid="pcbi.1004999.g004">Fig 4</xref>), these subnetworks have simpler topologies. Of the seven moiety subnetworks of DAS only one (<italic>S</italic><sup>(6)</sup>) was a hypergraph. All other DAS subnetworks were graphs. Four of 11 iCore subnetworks and 342 of 365 subRecon subnetworks were also graphs. We note that, although metabolic networks could in theory be decomposed with other types of conservation vectors, only moiety vectors are guaranteed to result in mass balanced subnetworks (see <xref ref-type="fig" rid="pcbi.1004999.g010">Fig 10b</xref>).</p>
<fig id="pcbi.1004999.g010" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004999.g010</object-id>
<label>Fig 10</label>
<caption>
<title>Moiety subnetworks of DAS.</title>
<p>(a) Moiety vectors <italic>l</italic><sub>1</sub>, <italic>l</italic><sub>2</sub>, <italic>l</italic><sub>3</sub>, <italic>l</italic><sub>6</sub>, and <italic>l</italic><sub>7</sub> (<xref ref-type="table" rid="pcbi.1004999.t004">Table 4</xref>) were used to decompose the stoichiometric matrix for DAS (<xref ref-type="table" rid="pcbi.1004999.t003">Table 3</xref>) into five subnetworks. Colours match the corresponding moieties in <xref ref-type="fig" rid="pcbi.1004999.g004">Fig 4</xref>. Linestyles match the corresponding reactions in <xref ref-type="fig" rid="pcbi.1004999.g004">Fig 4</xref>. The two hydrogen atom moiety subnetworks (<italic>l</italic><sub>4</sub> and <italic>l</italic><sub>5</sub>) were omitted to simplify the figure. (b) A subnetwork derived from an extreme ray that did not represent moiety conservation. This subnetwork is not mass balanced as there is no mass transfer between Phe and BH<sub>2</sub>, Tyr and BH<sub>2</sub>, or BH<sub>2</sub> and CO<sub>2</sub> in the full metabolic network (<xref ref-type="fig" rid="pcbi.1004999.g004">Fig 4</xref>).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004999.g010" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec013">
<title>Instantaneous moieties</title>
<p>The results above were for moieties identified for metabolic network reconstructions where we assume each reaction is active. These moieties will only be relevant if all reactions in those reconstructions are actually active in practice, i.e., carrying nonzero flux. In general, not all reactions in a metabolic network are active simultaneously, e.g., oxidative phosphorylation reactions in iCore are only active in the presence of oxygen. The set of instantaneous conserved moieties, their conservation relations, and their classification depend on which reactions are active at any point in time. All steady state flux distributions <inline-formula id="pcbi.1004999.e034"><alternatives><graphic id="pcbi.1004999.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004999.e034" xlink:type="simple"/><mml:math display="inline" id="M34"><mml:mrow><mml:mi>v</mml:mi> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="double-struck">R</mml:mi> <mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> are in the right null space <inline-formula id="pcbi.1004999.e035"><alternatives><graphic id="pcbi.1004999.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004999.e035" xlink:type="simple"/><mml:math display="inline" id="M35"><mml:mrow><mml:mi mathvariant="script">N</mml:mi> <mml:mo>(</mml:mo> <mml:mi>S</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> of the total stoichiometric matrix <italic>S</italic> for a metabolic network [<xref ref-type="bibr" rid="pcbi.1004999.ref036">36</xref>]. A convex basis for <inline-formula id="pcbi.1004999.e036"><alternatives><graphic id="pcbi.1004999.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004999.e036" xlink:type="simple"/><mml:math display="inline" id="M36"><mml:mrow><mml:mi mathvariant="script">N</mml:mi> <mml:mo>(</mml:mo> <mml:mi>S</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> gives all extreme pathways of a metabolic network [<xref ref-type="bibr" rid="pcbi.1004999.ref037">37</xref>]. Extreme pathways are analogous to extreme semipositive conservation relations in the left null space <inline-formula id="pcbi.1004999.e037"><alternatives><graphic id="pcbi.1004999.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004999.e037" xlink:type="simple"/><mml:math display="inline" id="M37"><mml:mrow><mml:mi mathvariant="script">N</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mi>S</mml:mi> <mml:mi>T</mml:mi></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> (see Section <xref ref-type="sec" rid="sec001">Introduction</xref>). They are a maximal set of conically independent steady state flux distributions. Any steady state flux distribution can be written as a conical combination of extreme pathways.</p>
<p>To see how instantaneous conserved moieties vary depending on what reactions are active we computed the extreme pathways of iCore with the vertex enumeration algorithm from [<xref ref-type="bibr" rid="pcbi.1004999.ref013">13</xref>]. Computation of the extreme pathways of subRecon with the same algorithm was not tractable. The algorithm returned 1,421 extreme pathways for iCore. The number of instantaneous moiety conservation relations for these pathways ranged from 4 to 11 and the total number of moieties (i.e., instances) ranged from 18 to 520. <xref ref-type="fig" rid="pcbi.1004999.g011">Fig 11</xref> shows an example of instantaneous moieties in an extreme pathway that corresponds to glycolysis. We found that moieties classified as transitive or integrative in the entire iCore network, were often classified as internal in individual extreme pathways. In particular, the inorganic phosphate moiety (P<sub><italic>i</italic></sub>) was classified as internal in all except one extreme pathway. The constant metabolite pool defined by the P<sub><italic>i</italic></sub> moiety varied between pathways, consisting of P<sub><italic>i</italic></sub>, ATP, AMP and 9 to 17 phosphorylated intermediates of glycolysis and the pentose phosphate pathway. The ammonia moiety (NH<sub>4</sub><sup>+</sup>) was also classified as internal in many extreme pathways (266/1,421) where it defined a constant metabolite pool consisting of NH<sub>4</sub><sup>+</sup>, glutamine and glutamate.</p>
<fig id="pcbi.1004999.g011" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004999.g011</object-id>
<label>Fig 11</label>
<caption>
<title>Instantaneous iCore moieties.</title>
<p>Carbon and phosphate containing moieties in an extreme pathway of the <italic>E. coli</italic> core network that corresponds to glycolysis. Four conserved moieties are distinguished by shape in the figure. The pathway also conserves one oxygen atom moiety and two hydrogen atom moieties that were omitted to simplify the figure. Metabolite abbreviations are, Glc: D-glucose (VMH [<xref ref-type="bibr" rid="pcbi.1004999.ref023">23</xref>] ID: glc_D), PEP: phosphoenolpyruvate (VMH ID: pep), Pyr: pyruvate (VMH ID: pyr), F6P: D-fructose 6-phosphate (VMH ID: f6p), ATP: adenosine triphosphate (VMH ID: atp), ADP: adenosine diphosphate (VMH ID: adp), FDP: D-fructose 1,6-bisphosphate (VMH ID: fdp), DHAP: dihydroxyacetone phosphate (VMH ID: dhap), G3P: glyceraldehyde 3-phosphate (VHM ID: g3p), NAD: nicotinamide adenine dinucleotide (VMH ID: nad), P<sub><italic>bluei</italic></sub>: orthophosphate (VMH ID: pi), NADH: reduced nicotinamide adenine dinucleotide (VMH ID: nadh), DPG: 1,3-bisphospho-D-glycerate (VMH ID: 13dpg), Lac: D-lactate (VMH ID: lac_D). The glucose moiety (circles) is transitive whereas the other three moieties are internal, including the phosphate moiety (squares) which was classified as integrative in the full iCore network.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004999.g011" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec014">
<title>Computational complexity</title>
<p>The computational complexity of the method presented here is largely determined by the following two steps: 1) finding connected components of an atom transition network, and 2) determining isomorphisms between components. We used an implementation of Tarjan’s Algorithm [<xref ref-type="bibr" rid="pcbi.1004999.ref038">38</xref>] to find connected components of atom transition networks (see <xref ref-type="sec" rid="sec016">Methods</xref>, Section Identification of conserved moieties). The worst case time complexity of this algorithm is <italic>O</italic> (<italic>p</italic> + <italic>q</italic>) where <italic>p</italic> is the number of atoms (nodes) and <italic>q</italic> is the number of atom transitions (edges) in the input atom transition network. We apply Tarjan’s algorithm to the simple graph underlying the input atom transition network, which generally contains significantly fewer edges.</p>
<p>Algorithms to determine isomorphisms between two general graphs are an active research area. Atom transition networks are specialised graphs where every node is associated with a metabolite and every edge is associated with a reaction in the parent metabolic network. These additional structural elements of atom transition networks make it possible to determine isomorphisms between their components by pairwise comparisons (see Section Identification of conserved moieties in <xref ref-type="sec" rid="sec016">Methods</xref>). Since every atom must be connected to at least one other atom, the number of components is bounded from above by <italic>p</italic>/2. The number of components in the atom transition networks treated here was much lower. There were 57 components in the atom transition for DAS, 391 in the one for iCore, and 16,348 in the one for subRecon. If no component is isomorphic to any other component, we need to compare the first component to all other components, the second component to all others except the first, etc. The maximum number of comparisons is therefore
<disp-formula id="pcbi.1004999.e038"><alternatives><graphic id="pcbi.1004999.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004999.e038" xlink:type="simple"/><mml:math display="block" id="M38"><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mfrac><mml:mi>p</mml:mi> <mml:mn>2</mml:mn></mml:mfrac> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mfrac><mml:mi>p</mml:mi> <mml:mn>2</mml:mn></mml:mfrac> <mml:mo>−</mml:mo> <mml:mn>2</mml:mn></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mo>⋯</mml:mo> <mml:mo>+</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mfrac><mml:mi>p</mml:mi> <mml:mn>2</mml:mn></mml:mfrac> <mml:mo>−</mml:mo> <mml:mfrac><mml:mi>p</mml:mi> <mml:mn>2</mml:mn></mml:mfrac></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msup><mml:mi>p</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow> <mml:mn>4</mml:mn></mml:mfrac> <mml:mo>−</mml:mo> <mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>g</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mi>p</mml:mi> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:munderover> <mml:mi>g</mml:mi></mml:mstyle> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msup><mml:mi>p</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow> <mml:mn>4</mml:mn></mml:mfrac> <mml:mo>−</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mi>p</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow> <mml:mn>4</mml:mn></mml:mfrac> <mml:mo>+</mml:mo> <mml:mfrac><mml:mi>p</mml:mi> <mml:mn>2</mml:mn></mml:mfrac></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>4</mml:mn></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mi>p</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow> <mml:mn>2</mml:mn></mml:mfrac> <mml:mo>−</mml:mo> <mml:mi>p</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(10)</label></disp-formula>
The overall worst case time complexity of our method is therefore <inline-formula id="pcbi.1004999.e039"><alternatives><graphic id="pcbi.1004999.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004999.e039" xlink:type="simple"/><mml:math display="inline" id="M39"><mml:mrow><mml:mi mathvariant="script">O</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mi>p</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>+</mml:mo> <mml:mi>q</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. In practice, however, computation time scales much better (<xref ref-type="table" rid="pcbi.1004999.t005">Table 5d</xref>). Identification of conserved moieties in subRecon took under five minutes with our method. We compared this performance with an implementation of a vertex enumeration algorithm [<xref ref-type="bibr" rid="pcbi.1004999.ref013">13</xref>] to compute the extreme rays of the left null space of a stoichiometric matrix (<xref ref-type="table" rid="pcbi.1004999.t005">Table 5d</xref>). The two algorithms performed similarly on the two smaller networks but computation of extreme rays proved intractable for subRecon. The vertex enumeration algorithm did not complete after running for a week, at which point we terminated the process.</p>
<p>It may be of interest to know how our method scales with the size of metabolic networks, instead of the size of atom transition networks. The number of atoms per metabolite varies greatly but is bounded from above. So is the number of atom transitions per reaction. The largest metabolite in the three metabolic networks treated here was the subRecon metabolite neurotensin (Recon 2 ID C01836), with 241 atoms. The largest reaction was the subRecon reaction peroxisomal thiolase 2 (Recon 2 ID SCP2x), with 1,791 atom transitions. This is a composite reaction with large stoichiometric coefficients. Such large reactions are anomalous. The average number of atom transitions per metabolic reaction was much lower. The average (±standard deviation) was 44 (±16) for DAS, 81 (±72) for iCore, and 105 (±90) for subRecon. The number of atoms and atom transitions scales approximately linearly with the number of metabolites and internal reactions, respectively (<xref ref-type="table" rid="pcbi.1004999.t005">Table 5d</xref>). We can therefore approximate the worst case time complexity of our method as <inline-formula id="pcbi.1004999.e040"><alternatives><graphic id="pcbi.1004999.e040g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004999.e040" xlink:type="simple"/><mml:math display="inline" id="M40"><mml:mrow><mml:mi mathvariant="script">O</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mi>m</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>+</mml:mo> <mml:mi>u</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>.</p>
</sec>
</sec>
<sec id="sec015" sec-type="conclusions">
<title>Discussion</title>
<p>Moiety conservation relations are a subset of nonnegative integer conservation relations for a metabolic network. In principle, the latter can be computed using only a stoichiometric matrix, but the computational complexity of existing algorithms [<xref ref-type="bibr" rid="pcbi.1004999.ref011">11</xref>, <xref ref-type="bibr" rid="pcbi.1004999.ref012">12</xref>, <xref ref-type="bibr" rid="pcbi.1004999.ref014">14</xref>, <xref ref-type="bibr" rid="pcbi.1004999.ref015">15</xref>, <xref ref-type="bibr" rid="pcbi.1004999.ref017">17</xref>] has prohibited their application to large networks. Computation of moiety conservation relations requires information about the paths of atoms through metabolic networks in addition to reaction stoichiometry (see, Section <xref ref-type="sec" rid="sec002">Theoretical Framework</xref>, Section Moiety vectors). Here, we incorporated this information in the form of atom transition networks. Doing so allowed us to formulate the problem of computing moiety conservation relations as a graph theory problem that is solvable in polynomial time. We related atom paths to connected components of atom transition networks and conserved moieties to equivalent nodes of isomorphic components. We provided a novel definition of isomorphism that is specific to the structure of atom transition networks. This definition enabled us to determine isomorphisms and identify conserved moieties in a fast and reliable way. The relationship between conservation relations and metabolite substructures has long been known [<xref ref-type="bibr" rid="pcbi.1004999.ref001">1</xref>, <xref ref-type="bibr" rid="pcbi.1004999.ref002">2</xref>, <xref ref-type="bibr" rid="pcbi.1004999.ref018">18</xref>]. A relationship between conservation relations and graph theoretical properties of atom transition networks has not, to our knowledge, been demonstrated prior to this work. This is also, to our knowledge, the first polynomial time method to compute nonnegative integer conservation relations for metabolic networks.</p>
<p>Our method requires data on reaction stoichiometry and atom mappings for internal reactions of a metabolic network. Reliable data on reaction stoichiometry are readily available from high quality, manually curated metabolic network reconstructions that have been published for hundreds of organisms over the past couple of decades or so. These reconstructions are accessible in a standardised format [<xref ref-type="bibr" rid="pcbi.1004999.ref039">39</xref>], e.g., through the BioModels database [<xref ref-type="bibr" rid="pcbi.1004999.ref040">40</xref>]. Atom mapping data are increasingly becoming accessible through biochemical databases but are still largely algorithmically generated [<xref ref-type="bibr" rid="pcbi.1004999.ref021">21</xref>, <xref ref-type="bibr" rid="pcbi.1004999.ref022">22</xref>]. KEGG [<xref ref-type="bibr" rid="pcbi.1004999.ref041">41</xref>, <xref ref-type="bibr" rid="pcbi.1004999.ref042">42</xref>] and BioPath (Molecular Networks GmbH, Erlangen, Germany) provide manually curated atom mappings but the data are not freely accessible. No database currently provides mappings for hydrogen atoms or electrons which are required to compute all conserved moieties in a metabolic network. Data formats vary between databases as there is currently no agreed standard. However, the availability and quality of atom mapping data are rapidly increasing and we expect these issues will be remedied in the near future.</p>
<p>We chose to use the DREAM algorithm [<xref ref-type="bibr" rid="pcbi.1004999.ref020">20</xref>] to predict atom mappings for this work. Advantages of DREAM include ease of use, the ability to map hydrogen atoms, and use of the information-rich rxnfile format. A disadvantage of DREAM is that it uses mixed integer linear programming (MILP) which has exponential worst case time complexity. Kumar and Maranas recently published the first polynomial time atom mapping algorithm, called canonical labelling for clique approximation (CLCA) [<xref ref-type="bibr" rid="pcbi.1004999.ref022">22</xref>]. An implementation of this algorithm has not yet been released but should further speed up the process of obtaining atom mapping predictions. CLCA predictions for 27,000 reactions are already accessible through the MetRxn database [<xref ref-type="bibr" rid="pcbi.1004999.ref022">22</xref>]. These predictions were not yet suitable for this work, however, as they do not include hydrogen atoms.</p>
<p>Conserved moieties identified with our method depend on input atom mappings (see <xref ref-type="sec" rid="sec006">Results</xref>, Section Effects of variable atom mappings between recurring metabolite pairs). We showed how variable atom mappings between recurring metabolite pairs could give rise to a non-maximal set of composite moiety vectors. Note that composite moieties are a biochemical reality, not just an artefact of the atom mapping algorithm used. Many metabolite pairs do have multiple biochemically equivalent atom mappings, each of which is realised in a living organism. For modelling purposes, however, it is desirable to identify a maximal number of linearly independent moiety conservation relations. We therefore formulated an MILP algorithm for decomposition of composite moiety vectors (<xref ref-type="sec" rid="sec016">Methods</xref>, Section Decomposition of moiety vectors). It would be preferable to construct the atom transition network with minimal variability in atom mappings between recurring metabolite pairs to avoid composite moieties altogether. Doing so would be relatively straightforward if input data included all alternative atom mappings for reactions. Prediction of alternative atom mappings with the DREAM algorithm is possible but time consuming, both due to the longer running times required, and because DREAM outputs each alternative atom mapping in a separate rxnfile. Some effort is therefore required to integrate alternative predictions. The CLCA algorithm outputs alternative atom mapping predictions in a single file by default and should therefore facilitate identification of nondecomposable moiety conservation relations. Ultimately, however, predicted atom mappings need to be manually curated for alternatives.</p>
<p>To span the left null space of Recon 2 we needed to decompose the electron vector <inline-formula id="pcbi.1004999.e041"><alternatives><graphic id="pcbi.1004999.e041g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004999.e041" xlink:type="simple"/><mml:math display="inline" id="M41"><mml:mrow><mml:mi>e</mml:mi> <mml:mo>∈</mml:mo> <mml:msubsup><mml:mi mathvariant="double-struck">N</mml:mi> <mml:mrow><mml:mn>0</mml:mn></mml:mrow> <mml:mi>m</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> (<xref ref-type="sec" rid="sec006">Results</xref>, Section General properties of identified moieties) with the MILP algorithm described in Methods, Section Decomposition of moiety vectors. We note that this MILP algorithm can also be used to decompose the elemental matrix for a metabolic network. This is in fact a method for nonnegative integer factorisation of the elemental matrix, similar to the algorithm presented in [<xref ref-type="bibr" rid="pcbi.1004999.ref018">18</xref>]. However, this method has exponential worst case time complexity. Also, while MILP decomposition of the elemental matrix returns the chemical composition of moieties it cannot be used to pinpoint the exact group of atoms in a metabolite that belong to each moiety. Empirically, we found that MILP decomposition of the elemental matrices for the three metabolic networks treated here completed in a reasonable amount of time although it scaled much worse than analysis of atom transition networks (3.4 × 10<sup>−1</sup> s for DAS, 1.8 × 10<sup>0</sup> s for iCore, 4.7 × 10<sup>3</sup> s for subRecon, compare to <xref ref-type="table" rid="pcbi.1004999.t005">Table 5d</xref>). In the absence of atom mapping data, MILP decomposition of the elemental matrix provides an alternative way to compute moiety conservation relations for metabolic networks. For the most part, decomposition of elemental matrices gave the same set of vectors as analysis of atom transition networks. The only exception was that decomposition of the elemental matrix for DAS returned the vector
<disp-formula id="pcbi.1004999.e042"><alternatives><graphic id="pcbi.1004999.e042g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004999.e042" xlink:type="simple"/><mml:math display="block" id="M42"><mml:mrow><mml:msubsup><mml:mi>l</mml:mi> <mml:mn>9</mml:mn> <mml:mi>T</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>1</mml:mn></mml:mtd> <mml:mtd><mml:mn>2</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>2</mml:mn></mml:mtd> <mml:mtd><mml:mn>2</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>1</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(11)</label></disp-formula>
in place of the oxygen moiety vector <italic>l</italic><sub>6</sub> in <xref ref-type="table" rid="pcbi.1004999.t004">Table 4</xref>. We note that <italic>l</italic><sub>9</sub> = <italic>l</italic><sub>6</sub> + 2 (<italic>l</italic><sub>2</sub> − <italic>l</italic><sub>1</sub>) does not correspond to a conserved moiety in DAS.</p>
<p>Here, we highlighted three potential applications of our method; to identify constant metabolite pools (<xref ref-type="sec" rid="sec006">Results</xref> Section The gearwheels of metabolism), to model isotope labelling experiments for metabolic flux analysis (<xref ref-type="sec" rid="sec006">Results</xref> Section Application of moiety graphs to stable isotope assisted metabolic flux analysis), and to decompose metabolic networks (<xref ref-type="sec" rid="sec006">Results</xref> Section Application of moiety vectors to decomposition of metabolic networks). These applications take advantage of our method’s unique ability to identify the exact group of atoms that correspond to each conserved moiety. As we alluded to in the introduction, another clear application area is metabolic modelling. A nonnegative integer basis for the left null space can be used to simplify metabolic models and to compute a full rank Jacobian which is required for many computational modelling methods [<xref ref-type="bibr" rid="pcbi.1004999.ref006">6</xref>, <xref ref-type="bibr" rid="pcbi.1004999.ref007">7</xref>]. Other applications would include minimisation of intermediate metabolite concentrations [<xref ref-type="bibr" rid="pcbi.1004999.ref043">43</xref>], and computation of minimal cut sets [<xref ref-type="bibr" rid="pcbi.1004999.ref044">44</xref>]. We also believe our method may be of value to theoretical biologists. For example, the ability to decompose metabolic networks into simpler subnetworks may facilitate research on physical and mathematical properties that are otherwise obscured by topological complexity.</p>
</sec>
<sec id="sec016" sec-type="materials|methods">
<title>Methods</title>
<sec id="sec017">
<title>Metabolic networks</title>
<p>We tested our method on three metabolic networks of increasing sizes (see <xref ref-type="table" rid="pcbi.1004999.t005">Table 5a</xref>), two human and one <italic>E. coli</italic> network. The <italic>E. coli</italic> network consisted of core metabolic pathways including glycolysis, the pentose phosphate shunt, the TCA cycle, oxidative phosphorylation and fermentation [<xref ref-type="bibr" rid="pcbi.1004999.ref027">27</xref>]. We refer to this network as iCore for abbreviation.</p>
<p>The two human networks were derived from the generic human metabolic reconstruction Recon 2 [<xref ref-type="bibr" rid="pcbi.1004999.ref026">26</xref>]. The smaller of the two consisted of four internal reactions from the dopamine synthesis pathway and seven metabolite exchange reactions. We refer to this network as DAS, and its four internal reactions as R1, R2, R3, and R4. R1 corresponds to Recon 2 reaction r0399, R2 is a composite of reactions TYR3MO2 and THBPT4ACAMDASE, R3 corresponds to reaction 3HLYTCL, and R4 is a composite of reactions DHPR and FDH.</p>
<p>The larger human network, which we refer to as subRecon, included approximately two thirds (4,261/6,691) of internal reactions in Recon 2. This was the largest subset of Recon 2 reactions for which atom mappings could be predicted at the time of our analysis. For most of the remaining reactions (2,380/2,430), we were unable to generate rxnfiles for input to the DREAM server [<xref ref-type="bibr" rid="pcbi.1004999.ref020">20</xref>]. For other reactions (50/2,430), the DREAM algorithm timed out or failed to parse input rxnfiles. Rxnfiles could not be generated for 1,871/2,380 due to lack of information about metabolite structures, and for 509/2,380 reactions because they were not mass or charge balanced.</p>
</sec>
<sec id="sec018">
<title>Generation of atom transition networks</title>
<p>Atom transition networks were generated based on atom mappings for metabolic reactions. Atom mapping predictions were obtained through the web interface to the mixed integer linear programming method DREAM [<xref ref-type="bibr" rid="pcbi.1004999.ref020">20</xref>]. The objective was set to minimise the number of bonds broken and formed in each reaction. Reactions were input to DREAM in rxnfile format (Accelrys, San Diego, CA). Rxnfiles were written from data on reaction stoichiometry and metabolite structures in molfile format (Accelrys, San Diego, CA). All hydrogen atoms were explicitly represented to obtain mappings for hydrogen atoms in addition to other elements. Care was taken to ensure that hydrogen and charge balancing of reactions was the same in rxnfiles as in the parent stoichiometric matrix. This was essential to ensure that computed moiety vectors were in the left null space of the stoichiometric matrix.</p>
</sec>
<sec id="sec019">
<title>Identification of conserved moieties</title>
<p>We denote the internal stoichiometric matrix of a metabolic network by <inline-formula id="pcbi.1004999.e043"><alternatives><graphic id="pcbi.1004999.e043g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004999.e043" xlink:type="simple"/><mml:math display="inline" id="M43"><mml:mrow><mml:mi>N</mml:mi> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="double-struck">Z</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>×</mml:mo> <mml:mi>u</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>. Conserved moieties in the metabolic network were identified by analysis of an atom transition network that was generated as described in Generation of atom transition networks. We denote the incidence matrix of the input atom transition network by <italic>A</italic> ∈ {−1, 0, 1}<sup><italic>p</italic>×<italic>q</italic></sup> where <italic>p</italic> is the number of atoms and <italic>q</italic> the number of atom transitions. The first step in our analysis is to find connected components of <italic>A</italic>. To this end, we used an implementation of Tarjan’s algorithm [<xref ref-type="bibr" rid="pcbi.1004999.ref038">38</xref>] (see Section Implementation). We denote the incidence matrix of component <italic>h</italic> of <italic>A</italic> by <italic>C</italic><sup>(<italic>h</italic>)</sup> ∈ {−1, 0, 1}<sup><italic>x</italic>×<italic>y</italic></sup>.</p>
<p>Each atom in a component belongs to a particular metabolite in the metabolic network. We define a mapping matrix <italic>M</italic><sup>(<italic>h</italic>)</sup> ∈ {0, 1}<sup><italic>m</italic>×<italic>x</italic></sup> that maps atoms to metabolites. It is defined such that <inline-formula id="pcbi.1004999.e044"><alternatives><graphic id="pcbi.1004999.e044g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004999.e044" xlink:type="simple"/><mml:math display="inline" id="M44"><mml:mrow><mml:msubsup><mml:mi>M</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>g</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>h</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> if the atom represented by row <italic>g</italic> in <italic>C</italic><sup>(<italic>h</italic>)</sup> belongs to the metabolite represented by row <italic>i</italic> in <italic>N</italic>. Otherwise, <inline-formula id="pcbi.1004999.e045"><alternatives><graphic id="pcbi.1004999.e045g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004999.e045" xlink:type="simple"/><mml:math display="inline" id="M45"><mml:mrow><mml:msubsup><mml:mi>M</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>g</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>h</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>. The component <italic>C</italic><sup>(<italic>h</italic>)</sup> represents conservation of a single atom throughout the metabolic network. We define its atom conservation vector as
<disp-formula id="pcbi.1004999.e046"><alternatives><graphic id="pcbi.1004999.e046g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004999.e046" xlink:type="simple"/><mml:math display="block" id="M46"><mml:mrow><mml:msub><mml:mi>a</mml:mi> <mml:mi>h</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msup><mml:mi>M</mml:mi> <mml:mfenced close=")" open="("><mml:mi>h</mml:mi></mml:mfenced></mml:msup> <mml:mn mathvariant="bold">1</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(12)</label></disp-formula>
i.e., it is the column sum of <italic>M</italic><sup>(<italic>h</italic>)</sup>. Element <italic>a</italic><sub><italic>h</italic>,<italic>i</italic></sub> is therefore the number of atoms in metabolite <italic>i</italic> that are in component <italic>C</italic><sup>(<italic>h</italic>)</sup>. We define two components <italic>C</italic><sup>(<italic>h</italic>)</sup> and <italic>C</italic><sup>(<italic>d</italic>)</sup> to be isomorphic if they include the same number of atoms from each metabolite. It follows that the two components are isomorphic, with <italic>C</italic><sup>(<italic>h</italic>)</sup> = <italic>C</italic><sup>(<italic>d</italic>)</sup>, if <italic>a</italic><sub><italic>h</italic></sub> = <italic>a</italic><sub><italic>d</italic></sub>. A set of isomorphic components is denoted by <italic>K</italic> = {<italic>h</italic>, <italic>d</italic> ∣ <italic>a</italic><sub><italic>d</italic></sub> = <italic>a</italic><sub><italic>h</italic></sub>}.</p>
<p>A moiety graph <italic>λ</italic><sub><italic>k</italic></sub> is obtained by merging a set <italic>K</italic> of isomorphic components into a single graph. The incidence matrix of <italic>λ</italic><sub><italic>k</italic></sub> is given by
<disp-formula id="pcbi.1004999.e047"><alternatives><graphic id="pcbi.1004999.e047g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004999.e047" xlink:type="simple"/><mml:math display="block" id="M47"><mml:mrow><mml:msup><mml:mi>G</mml:mi> <mml:mfenced close=")" open="("><mml:mi>k</mml:mi></mml:mfenced></mml:msup> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mfenced close="|" open="|"><mml:mi>K</mml:mi></mml:mfenced></mml:mfrac> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>h</mml:mi> <mml:mo>∈</mml:mo> <mml:mi>K</mml:mi></mml:mrow></mml:munder> <mml:msup><mml:mi>C</mml:mi> <mml:mfenced close=")" open="("><mml:mi>h</mml:mi></mml:mfenced></mml:msup> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(13)</label></disp-formula>
We note that <italic>G</italic><sup>(<italic>k</italic>)</sup> = <italic>C</italic><sup>(<italic>h</italic>)</sup>∀<italic>h</italic> ∈ <italic>K</italic> except that the rows of <italic>G</italic><sup>(<italic>k</italic>)</sup> represent separate instances of a conserved moiety instead of atoms. A moiety vector <italic>l</italic><sub><italic>k</italic></sub> is derived from the incidence matrix <italic>G</italic><sup>(<italic>k</italic>)</sup> of a moiety graph in the same way that the atom conservation vector <italic>a</italic><sub><italic>h</italic></sub> was derived from the incidence matrix <italic>C</italic><sup>(<italic>h</italic>)</sup> of a component in <xref ref-type="disp-formula" rid="pcbi.1004999.e046">Eq 12</xref>. This is equivalent to setting <italic>l</italic><sub><italic>k</italic></sub> = <italic>a</italic><sub><italic>h</italic></sub>∀<italic>h</italic> ∈ <italic>K</italic>.</p>
</sec>
<sec id="sec020">
<title>Classification of moieties</title>
<p>We classified moieties according to the schema presented in [<xref ref-type="bibr" rid="pcbi.1004999.ref012">12</xref>]. Briefly, moieties were grouped into three categories termed transitive, integrative and internal. These categories were referred to as Type A, Type B, and Type C, respectively, in [<xref ref-type="bibr" rid="pcbi.1004999.ref012">12</xref>]. A moiety with conservation vector <italic>l</italic><sub><italic>k</italic></sub> was classified as internal if it was conserved in the open metabolic network represented by the total stoichiometric matrix <italic>S</italic>, i.e., if <italic>S</italic><sup><italic>T</italic></sup> <italic>l</italic><sub><italic>k</italic></sub> = 0. Metabolites containing internal moieties were defined as secondary metabolites, while all other metabolites were defined as primary metabolites. Moieties that were only found in primary metabolites were classified as transitive moieties, while those that were found in both primary and secondary metabolites were classified as integrative moieties.</p>
</sec>
<sec id="sec021">
<title>Decomposition of moiety vectors</title>
<p>Our method for analysing atom transition networks returns <italic>r</italic> moiety vectors <inline-formula id="pcbi.1004999.e048"><alternatives><graphic id="pcbi.1004999.e048g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004999.e048" xlink:type="simple"/><mml:math display="inline" id="M48"><mml:mo>{</mml:mo> <mml:msub><mml:mi>l</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>∈</mml:mo> <mml:msubsup><mml:mi mathvariant="double-struck">N</mml:mi> <mml:mrow><mml:mn>0</mml:mn></mml:mrow> <mml:mi>m</mml:mi></mml:msubsup> <mml:mo>∣</mml:mo> <mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mo>[</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mi>r</mml:mi> <mml:mo>]</mml:mo> <mml:mo>}</mml:mo></mml:math></alternatives></inline-formula> as the columns of the moiety matrix <inline-formula id="pcbi.1004999.e049"><alternatives><graphic id="pcbi.1004999.e049g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004999.e049" xlink:type="simple"/><mml:math display="inline" id="M49"><mml:mrow><mml:mi>L</mml:mi> <mml:mo>∈</mml:mo> <mml:msubsup><mml:mi mathvariant="double-struck">N</mml:mi> <mml:mrow><mml:mn>0</mml:mn></mml:mrow> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>×</mml:mo> <mml:mi>r</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>. As described in Results, Section Effects of variable atom mappings between recurring metabolite pairs, our method may return composite moiety vectors if the input atom transition network was generated from variable atom mappings between recurring metabolite pairs. Any composite moiety vector can be written as <italic>l<sub>k</sub></italic> = <italic>x<sub>k</sub></italic> + <italic>y<sub>k</sub></italic>, where <italic>x<sub>k</sub></italic> and <italic>y<sub>k</sub></italic> are nonzero moiety vectors. To decompose a composite moiety vector <italic>l<sub>k</sub></italic>, we solved the mixed integer linear programming (MILP) problem
<disp-formula id="pcbi.1004999.e050"><alternatives><graphic id="pcbi.1004999.e050g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004999.e050" xlink:type="simple"/><mml:math display="block" id="M50"><mml:mrow><mml:mi>m</mml:mi> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi> <mml:mtext> </mml:mtext> <mml:msup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mn>1</mml:mn></mml:mstyle> <mml:mi>T</mml:mi></mml:msup> <mml:msub><mml:mi>x</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(14)</label></disp-formula> <disp-formula id="pcbi.1004999.e051"><alternatives><graphic id="pcbi.1004999.e051g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004999.e051" xlink:type="simple"/><mml:math display="block" id="M51"><mml:mrow><mml:mi>s</mml:mi> <mml:mo>.</mml:mo> <mml:mi>t</mml:mi> <mml:mo>.</mml:mo> <mml:mtext> </mml:mtext> <mml:msub><mml:mi>l</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(15)</label></disp-formula> <disp-formula id="pcbi.1004999.e052"><alternatives><graphic id="pcbi.1004999.e052g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004999.e052" xlink:type="simple"/><mml:math display="block" id="M52"><mml:mrow><mml:msup><mml:mi>N</mml:mi> <mml:mi>T</mml:mi></mml:msup> <mml:msub><mml:mi>x</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(16)</label></disp-formula> <disp-formula id="pcbi.1004999.e053"><alternatives><graphic id="pcbi.1004999.e053g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004999.e053" xlink:type="simple"/><mml:math display="block" id="M53"><mml:mrow><mml:msub><mml:mi>x</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>∈</mml:mo> <mml:msubsup><mml:mi>ℕ</mml:mi> <mml:mn>0</mml:mn> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>×</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(17)</label></disp-formula> <disp-formula id="pcbi.1004999.e054"><alternatives><graphic id="pcbi.1004999.e054g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004999.e054" xlink:type="simple"/><mml:math display="block" id="M54"><mml:mrow><mml:mn>0</mml:mn> <mml:mo>&lt;</mml:mo> <mml:msup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mn>1</mml:mn></mml:mstyle> <mml:mi>T</mml:mi></mml:msup> <mml:msub><mml:mi>x</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>&lt;</mml:mo> <mml:msup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mn>1</mml:mn></mml:mstyle> <mml:mi>T</mml:mi></mml:msup> <mml:msub><mml:mi>l</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(18)</label></disp-formula>
We denote this problem by <italic>P</italic><sub><italic>k</italic></sub>. The constraint in <xref ref-type="disp-formula" rid="pcbi.1004999.e051">Eq 15</xref> defines the solution vectors <italic>x</italic><sub><italic>k</italic></sub> and <italic>y</italic><sub><italic>k</italic></sub> as components of <italic>l</italic><sub><italic>k</italic></sub>. The constraints in Eqs <xref ref-type="disp-formula" rid="pcbi.1004999.e052">16</xref> and <xref ref-type="disp-formula" rid="pcbi.1004999.e053">17</xref> correspond to Eqs <xref ref-type="disp-formula" rid="pcbi.1004999.e014">2</xref> and <xref ref-type="disp-formula" rid="pcbi.1004999.e015">3</xref> defining nonnegative integer conservation vectors (see <xref ref-type="sec" rid="sec002">Theoretical Framework</xref>, Section Moiety vectors). These constraints are implicit for <italic>y</italic><sub><italic>k</italic></sub> due to <xref ref-type="disp-formula" rid="pcbi.1004999.e051">Eq 15</xref>. The constraint in <xref ref-type="disp-formula" rid="pcbi.1004999.e054">Eq 18</xref>, when combined with <xref ref-type="disp-formula" rid="pcbi.1004999.e051">Eq 15</xref>, ensures that <italic>x</italic><sub><italic>k</italic></sub> and <italic>y</italic><sub><italic>k</italic></sub> are both greater than zero. We chose to minimise the sum of elements in <italic>x</italic><sub><italic>k</italic></sub> but other objectives would also work. Problem <italic>P</italic><sub><italic>k</italic></sub> is infeasible for nondecomposable <italic>l</italic><sub><italic>k</italic></sub>. We note that the solution vectors <italic>x</italic><sub><italic>k</italic></sub> and <italic>y</italic><sub><italic>k</italic></sub> might themselves be composite moiety vectors. To fully decompose the moiety matrix <italic>L</italic> we must therefore solve <italic>P</italic><sub><italic>k</italic></sub> iteratively until it is infeasible for all input moiety vectors. This process can be described with the algorithm,</p>
<p specific-use="line">1. Input <inline-formula id="pcbi.1004999.e055"><alternatives><graphic id="pcbi.1004999.e055g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004999.e055" xlink:type="simple"/><mml:math display="inline" id="M55"><mml:mi>L</mml:mi> <mml:mo>∈</mml:mo> <mml:msubsup><mml:mi>ℕ</mml:mi> <mml:mn>0</mml:mn> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>×</mml:mo> <mml:mi>r</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>. Initialise <italic>L</italic>′ = <italic>L</italic> and <italic>D</italic> = [ ], where [ ] denotes an empty matrix.</p>
<p specific-use="line">2. Set <inline-formula id="pcbi.1004999.e056"><alternatives><graphic id="pcbi.1004999.e056g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004999.e056" xlink:type="simple"/><mml:math display="inline" id="M56"><mml:msup><mml:mi>r</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>=</mml:mo> <mml:mtext>dim</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msubsup><mml:mi>L</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mo>:</mml:mo></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and L′′ = [ ], where <inline-formula id="pcbi.1004999.e057"><alternatives><graphic id="pcbi.1004999.e057g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004999.e057" xlink:type="simple"/><mml:math display="inline" id="M57"><mml:mrow><mml:msubsup><mml:mi>L</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mo>:</mml:mo></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> denotes the first row of <italic>L</italic>′.</p>
<p specific-use="line">   If r′ ≥ 1, then go to Step 3,</p>
<p specific-use="line">   else, go to Step 5.</p>
<p specific-use="line">3. For <italic>k</italic> = 1: <italic>r</italic>′,</p>
<p specific-use="line">   denote <italic>l</italic><sub><italic>k</italic></sub> = <italic>L</italic><sub>:,<italic>k</italic></sub>,</p>
<p specific-use="line">   solve <italic>P</italic><sub><italic>k</italic></sub>.</p>
<p specific-use="line">   If <italic>P</italic><sub><italic>k</italic></sub> is infeasible, set <italic>D</italic> = [<italic>D</italic>, <italic>l</italic><sub><italic>k</italic></sub>],</p>
<p specific-use="line">   else, denote the solution of <italic>P</italic><sub><italic>k</italic></sub> by <italic>x</italic><sub><italic>k</italic></sub> and <italic>y</italic><sub><italic>k</italic></sub> and set <italic>L</italic>′′ = [<italic>L</italic>′′, <italic>x</italic><sub><italic>k</italic></sub>, <italic>y</italic><sub><italic>k</italic></sub>].</p>
<p specific-use="line">   Go to Step 4.</p>
<p specific-use="line">4. Set <italic>L</italic>′ = <italic>L</italic>′′ and go back to Step 2.</p>
<p specific-use="line">5. Output the fully decomposed moiety matrix <inline-formula id="pcbi.1004999.e058"><alternatives><graphic id="pcbi.1004999.e058g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004999.e058" xlink:type="simple"/><mml:math display="inline" id="M58"><mml:mi>D</mml:mi> <mml:mo>∈</mml:mo> <mml:msubsup><mml:mi>ℕ</mml:mi> <mml:mn>0</mml:mn> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>×</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>.</p>
<p>The same algorithm can be used for nonnegative integer matrix factorisation of an elemental matrix and electron vector for a metabolic network.</p>
</sec>
<sec id="sec022">
<title>Implementation</title>
<p>We implemented the method presented here as an algorithmic pipeline in MATLAB (MathWorks, Natick, MA). This implementation is freely available as part of the COBRA toolbox [<xref ref-type="bibr" rid="pcbi.1004999.ref045">45</xref>] at <ext-link ext-link-type="uri" xlink:href="https://github.com/opencobra/cobratoolbox" xlink:type="simple">https://github.com/opencobra/cobratoolbox</ext-link> (directory topology/conservedMoieties). Required inputs are an atom transition network and a stoichiometric matrix for a metabolic network. The method outputs moiety conservation relations both as moiety graphs and moiety vectors. All graphs are represented as incidence matrices. Support functions to generate atom transition networks (Section Generation of atom transition networks), classify moieties (Section Classification of moieties) and decompose moiety vectors (Section Decomposition of moiety vectors) are included with the core code. A tutorial on identification of conserved moieties in the dopamine synthesis network DAS is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/opencobra/cobratoolbox" xlink:type="simple">https://github.com/opencobra/cobratoolbox</ext-link> (directory topology/conservedMoieties/example), along with necessary data and MATLAB scripts that run through the example.</p>
<p>To compute the connected components of atom transition networks we used and implementation of Tarjan’s algorithm available as part of the Bioinformatics Toolbox for MATLAB (MathWorks, Natick, MA). This toolbox is not included with a standard installation of MATLAB. Users who do not have the Bioinformatics Toolbox can still run the pipeline with a free alternative to Tarjan’s algorithm to compute components of atom transition networks. If the Bioinformatics Toolbox is not installed in the MATLAB path, the pipeline calls a k-Nearest Neighbour algorithm in the MATLAB Network Routines toolbox by Bounova and Weck [<xref ref-type="bibr" rid="pcbi.1004999.ref046">46</xref>]. This toolbox is freely available with the COBRA toolbox. The k-Nearest Neighbour algorithm is considerably slower than Tarjan’s algorithm.</p>
<p>All code in the COBRA toolbox is distributed under a GNU General Public Licence and we encourage implementations of our method for other platforms than MATLAB. We have taken care to document and comment our code to facilitate such efforts.</p>
</sec>
</sec>
<sec id="sec023">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1004999.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004999.s001" xlink:type="simple">
<label>S1 Appendix</label>
<caption>
<title>Mathematical definitions.</title>
<p>Formal definitions of linear algebra and graph theory terms used or introduced in this work.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004999.s002" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004999.s002" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Conserved moieties and elementary metabolite units.</title>
<p>Application of the algorithm presented in [<xref ref-type="bibr" rid="pcbi.1004999.ref034">34</xref>] to generate an elementary metabolite unit (EMU) reaction network from a moiety graph. (a) A toy metabolic network first presented in black [<xref ref-type="bibr" rid="pcbi.1004999.ref034">34</xref>] black. (b) An atom transition network for the toy metabolic network. (c) The moiety graph derived from the atom transition network. (d)-(f) Elementary metabolite unit reaction networks generated from the moiety graph. (d) Size 1 EMU species. (e) Size 2 EMU species. (f) Size 3 EMU species.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We thank Vuong Phan, Hoai Minh Le, Matthew DeJongh, Averina Nicolae, Diana El Assal and Fatima Liliana Monteiro for their helpful comments on the manuscript.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1004999.ref001">
<label>1</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Atkinson</surname> <given-names>DE</given-names></name>. <source>Cellular Energy Metabolism and its Regulation</source>. <publisher-loc>Waltham</publisher-loc>: <publisher-name>Academic Press</publisher-name>; <year>1977</year>.</mixed-citation>
</ref>
<ref id="pcbi.1004999.ref002">
<label>2</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Reich</surname> <given-names>JG</given-names></name>, <name name-style="western"><surname>Sel’kov</surname> <given-names>EE</given-names></name>. <chapter-title>Energy Metabolism of the Cell</chapter-title>. <source>A Theoretical Treatise</source>. <publisher-loc>London</publisher-loc>: <publisher-name>Academic Press</publisher-name>; <year>1981</year>.</mixed-citation>
</ref>
<ref id="pcbi.1004999.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bier</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Bakker</surname> <given-names>BM</given-names></name>, <name name-style="western"><surname>Westerhoff</surname> <given-names>HV</given-names></name>. <article-title>How yeast cells synchronize their glycolytic oscillations: A perturbation analytic treatment</article-title>. <source>Biophys J</source>. <year>2000</year>; <volume>78</volume>: <fpage>1087</fpage>–<lpage>1093</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0006-3495(00)76667-7" xlink:type="simple">10.1016/S0006-3495(00)76667-7</ext-link></comment> <object-id pub-id-type="pmid">10692299</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004999.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bakker</surname> <given-names>BM</given-names></name>, <name name-style="western"><surname>Mensonides</surname> <given-names>FIC</given-names></name>, <name name-style="western"><surname>Teusink</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>van Hoek</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Michels</surname> <given-names>PAM</given-names></name>, <name name-style="western"><surname>Westerhoff</surname> <given-names>HV</given-names></name>. <article-title>Compartmentation protects trypanosomes from the dangerous design of glycolysis</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2000</year>; <volume>97</volume>: <fpage>2087</fpage>–<lpage>2092</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.030539197" xlink:type="simple">10.1073/pnas.030539197</ext-link></comment> <object-id pub-id-type="pmid">10681445</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004999.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cornish-Bowden</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Hofmeyr</surname> <given-names>JHS</given-names></name>. <article-title>The role of stoichiometric analysis in studies of metabolism: An example</article-title>. <source>J Theor Biol</source>. <year>2002</year>; <volume>216</volume>: <fpage>179</fpage>–<lpage>191</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1006/jtbi.2002.2547" xlink:type="simple">10.1006/jtbi.2002.2547</ext-link></comment> <object-id pub-id-type="pmid">12079370</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004999.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sauro</surname> <given-names>HM</given-names></name>, <name name-style="western"><surname>Ingalls</surname> <given-names>B</given-names></name>. <article-title>Conservation analysis in biochemical networks: computational issues for software writers</article-title>. <source>Biophys Chem</source>. <year>2004</year>; <volume>109</volume>: <fpage>1</fpage>–<lpage>15</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.bpc.2003.08.009" xlink:type="simple">10.1016/j.bpc.2003.08.009</ext-link></comment> <object-id pub-id-type="pmid">15059656</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004999.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Vallabhajosyula</surname> <given-names>RR</given-names></name>, <name name-style="western"><surname>Chickarmane</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Sauro</surname> <given-names>HM</given-names></name>. <article-title>Conservation analysis of large biochemical networks</article-title>. <source>Bioinformatics</source>. <year>2006</year>; <volume>22</volume>: <fpage>346</fpage>–<lpage>53</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/bti800" xlink:type="simple">10.1093/bioinformatics/bti800</ext-link></comment> <object-id pub-id-type="pmid">16317075</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004999.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Horn</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Jackson</surname> <given-names>R</given-names></name>. <article-title>General mass action kinetics</article-title>. <source>Arch Ration Mech Anal</source>. <year>1972</year>; <volume>47</volume>: <fpage>81</fpage>–<lpage>116</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/BF00251225" xlink:type="simple">10.1007/BF00251225</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004999.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hofmeyr</surname> <given-names>JHS</given-names></name>, <name name-style="western"><surname>Kacser</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>van der Merwe</surname> <given-names>KJ</given-names></name>. <article-title>Metabolic control analysis of moiety-conserved cycles</article-title>. <source>FEBS J</source>. <year>1986</year>; <volume>155</volume>: <fpage>631</fpage>–<lpage>640</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/j.1432-1033.1986.tb09534.x" xlink:type="simple">10.1111/j.1432-1033.1986.tb09534.x</ext-link></comment> <object-id pub-id-type="pmid">3956502</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004999.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gill</surname> <given-names>PE</given-names></name>, <name name-style="western"><surname>Murray</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Saunders</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Wright</surname> <given-names>MH</given-names></name>. <article-title>Maintaining LU factors of a general sparse matrix</article-title>. <source>Linear Algebra Appl</source>. <year>1987</year>; <volume>88–89</volume>:<fpage>239</fpage>–<lpage>270</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/0024-3795(87)90112-1" xlink:type="simple">10.1016/0024-3795(87)90112-1</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004999.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Schuster</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Höfer</surname> <given-names>T</given-names></name>. <article-title>Determining all extreme semi-positive conservation relations in chemical reaction systems: a test criterion for conservativity</article-title>. <source>J Chem Soc Faraday Trans</source>. <year>1991</year>; <volume>87</volume>: <fpage>2561</fpage>–<lpage>2566</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1039/FT9918702561" xlink:type="simple">10.1039/FT9918702561</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004999.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Famili</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Palsson</surname> <given-names>BØ</given-names></name>. <article-title>The convex basis of the left null space of the stoichiometric matrix leads to the definition of metabolically meaningful pools</article-title>. <source>Biophys J</source>. <year>2003</year>; <volume>85</volume>: <fpage>16</fpage>–<lpage>26</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0006-3495(03)74450-6" xlink:type="simple">10.1016/S0006-3495(03)74450-6</ext-link></comment> <object-id pub-id-type="pmid">12829460</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004999.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Avis</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Fukuda</surname> <given-names>K</given-names></name>. <article-title>A pivoting algorithm for convex hulls and vertex enumeration of arrangements and polyhedra</article-title>. <source>Discrete Comput Geom</source>. <year>1992</year>; <volume>8</volume>: <fpage>295</fpage>–<lpage>313</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/BF02293050" xlink:type="simple">10.1007/BF02293050</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004999.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Schuster</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Hilgetag</surname> <given-names>C</given-names></name>. <article-title>What information about the conserved-moiety structure of chemical reaction systems can be derived from their stoichiometry?</article-title> <source>J Phys Chem</source>. <year>1995</year>; <volume>99</volume>: <fpage>8017</fpage>–<lpage>8023</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1021/j100020a026" xlink:type="simple">10.1021/j100020a026</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004999.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Nikolaev</surname> <given-names>EV</given-names></name>, <name name-style="western"><surname>Burgard</surname> <given-names>AP</given-names></name>, <name name-style="western"><surname>Maranas</surname> <given-names>CD</given-names></name>. <article-title>Elucidation and structural analysis of conserved pools for genome-scale metabolic reconstructions</article-title>. <source>Biophys J</source>. <year>2005</year>; <volume>88</volume>: <fpage>37</fpage>–<lpage>49</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1529/biophysj.104.043489" xlink:type="simple">10.1529/biophysj.104.043489</ext-link></comment> <object-id pub-id-type="pmid">15489308</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004999.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Soliman</surname> <given-names>S</given-names></name>. <article-title>Invariants and other structural properties of biochemical models as a constraint satisfaction problem</article-title>. <source>Algorithms Mol Biol</source>. <year>2012</year>; <volume>7</volume>: <fpage>15</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1748-7188-7-15" xlink:type="simple">10.1186/1748-7188-7-15</ext-link></comment> <object-id pub-id-type="pmid">22642806</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004999.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>De Martino</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>De Martino</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Mulet</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Pagnani</surname> <given-names>A</given-names></name>. <article-title>Identifying all moiety conservation laws in genome-scale metabolic networks</article-title>. <source>PLoS One</source>. <year>2014</year>; <volume>9</volume>: <fpage>e100750</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0100750" xlink:type="simple">10.1371/journal.pone.0100750</ext-link></comment> <object-id pub-id-type="pmid">24988199</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004999.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Park</surname> <given-names>DJM</given-names> <suffix>Jr</suffix></name>. <article-title>The complete stoichiometer</article-title>. <source>Comput Methods Programs Biomed</source>. <year>1986</year>; <volume>22</volume>: <fpage>293</fpage>–<lpage>301</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/0169-2607(86)90006-4" xlink:type="simple">10.1016/0169-2607(86)90006-4</ext-link></comment> <object-id pub-id-type="pmid">3637126</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004999.ref019">
<label>19</label>
<mixed-citation publication-type="other" xlink:type="simple">Vavasis SA. On the complexity of nonnegative matrix factorization; 2007. Preprint. Available: arXiv:0708.4149v2 [cs.NA]. Accessed 18 October 2015.</mixed-citation>
</ref>
<ref id="pcbi.1004999.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>First</surname> <given-names>EL</given-names></name>, <name name-style="western"><surname>Gounaris</surname> <given-names>CE</given-names></name>, <name name-style="western"><surname>Floudas</surname> <given-names>CA</given-names></name>. <article-title>Stereochemically consistent reaction mapping and identification of multiple reaction mechanisms through integer linear optimization</article-title>. <source>J Chem Inf Model</source>. <year>2012</year>; <volume>52</volume>:<fpage>84</fpage>–<lpage>92</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1021/ci200351b" xlink:type="simple">10.1021/ci200351b</ext-link></comment> <object-id pub-id-type="pmid">22098204</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004999.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Latendresse</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Malerich</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Travers</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Karp</surname> <given-names>PD</given-names></name>. <article-title>Accurate atom-mapping computation for biochemical reactions</article-title>. <source>J Chem Inf Model</source>. <year>2012</year>; <volume>52</volume>(<issue>11</issue>): <fpage>2970</fpage>–<lpage>2982</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1021/ci3002217" xlink:type="simple">10.1021/ci3002217</ext-link></comment> <object-id pub-id-type="pmid">22963657</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004999.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kumar</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Maranas</surname> <given-names>CD</given-names></name>. <article-title>CLCA: Maximum common molecular substructure queries within the MetRxn database</article-title>. <source>J Chem Inf Model</source>. <year>2014</year>; <volume>54</volume>: <fpage>3417</fpage>–<lpage>3438</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1021/ci5003922" xlink:type="simple">10.1021/ci5003922</ext-link></comment> <object-id pub-id-type="pmid">25412255</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004999.ref023">
<label>23</label>
<mixed-citation publication-type="other" xlink:type="simple">Database: The Virtual Metabolic Human database [Internet]. Accessed: <ext-link ext-link-type="uri" xlink:href="https://vmh.uni.lu/" xlink:type="simple">https://vmh.uni.lu/</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1004999.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Klamt</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Haus</surname> <given-names>UU</given-names></name>, <name name-style="western"><surname>Theis</surname> <given-names>F</given-names></name>. <article-title>Hypergraphs and cellular networks</article-title>. <source>PLoS Computational Biology</source>. <year>2009</year>; <volume>5</volume>: <fpage>e1000385</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1000385" xlink:type="simple">10.1371/journal.pcbi.1000385</ext-link></comment> <object-id pub-id-type="pmid">19478865</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004999.ref025">
<label>25</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Gross</surname> <given-names>JL</given-names></name>, <name name-style="western"><surname>Yellen</surname> <given-names>J</given-names></name>. <source>Graph Theory and Its Applications</source>. <edition>2nd ed</edition>. <publisher-loc>Boca Raton</publisher-loc>: <publisher-name>Chapman and Hall/CRC</publisher-name>; <year>2005</year>.</mixed-citation>
</ref>
<ref id="pcbi.1004999.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Thiele</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Swainston</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Fleming</surname> <given-names>RMT</given-names></name>, <name name-style="western"><surname>Hoppe</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Sahoo</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Aurich</surname> <given-names>MK</given-names></name>, <etal>et al</etal>. <article-title>A community-driven global reconstruction of human metabolism</article-title>. <source>Nat Biotechnol</source>. <year>2013</year>; <volume>31</volume>: <fpage>419</fpage>–<lpage>425</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nbt.2488" xlink:type="simple">10.1038/nbt.2488</ext-link></comment> <object-id pub-id-type="pmid">23455439</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004999.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Orth</surname> <given-names>JD</given-names></name>, <name name-style="western"><surname>Palsson</surname> <given-names>BØ</given-names></name>, <name name-style="western"><surname>Fleming</surname> <given-names>RMT</given-names></name>. <article-title>Reconstruction and use of microbial metabolic networks: the core <italic>Escherichia coli</italic> metabolic model as an educational guide</article-title>. <source>EcoSal Plus</source>. <year>2010</year>; <volume>1</volume>: <fpage>10</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1128/ecosalplus.10.2.1" xlink:type="simple">10.1128/ecosalplus.10.2.1</ext-link></comment> <object-id pub-id-type="pmid">26443778</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004999.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Aris</surname> <given-names>R</given-names></name>. <article-title>Chemical kinetics and the ecology of mathematics</article-title>. <source>Am Sci</source>. <year>1970</year>; <volume>58</volume>: <fpage>419</fpage>–<lpage>428</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004999.ref029">
<label>29</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Corio</surname> <given-names>PL</given-names></name>. <chapter-title>Theory of reaction mechanisms</chapter-title>. In: <source>Relationships and Mechanisms in the Periodic Table, number 150 in Topics in Current Chemistry</source>. <publisher-loc>Heidelberg</publisher-loc>: <publisher-name>Springer Berlin</publisher-name>; <year>1989</year>. pp. <fpage>249</fpage>–<lpage>283</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/BFb0111262" xlink:type="simple">10.1007/BFb0111262</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004999.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Vlassis</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Pacheco</surname> <given-names>MP</given-names></name>, <name name-style="western"><surname>Sauter</surname> <given-names>T</given-names></name>. <article-title>Fast reconstruction of compact context-specific metabolic network models</article-title>. <source>PLoS Comput Biol</source>. <year>2014</year>; <volume>10</volume>: <fpage>e1003424</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1003424" xlink:type="simple">10.1371/journal.pcbi.1003424</ext-link></comment> <object-id pub-id-type="pmid">24453953</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004999.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wiechert</surname> <given-names>W</given-names></name>. <article-title>13C metabolic flux analysis</article-title>. <source>Metab Eng</source>. <year>2001</year>; <volume>3</volume>: <fpage>195</fpage>–<lpage>206</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1006/mben.2001.0187" xlink:type="simple">10.1006/mben.2001.0187</ext-link></comment> <object-id pub-id-type="pmid">11461141</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004999.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wiechert</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>de Graaf</surname> <given-names>AA</given-names></name>. <article-title>Bidirectional reaction steps in metabolic networks: I. modeling and simulation of carbon isotope labeling experiments</article-title>. <source>Biotechnol Bioeng</source>. <year>1997</year>; <volume>55</volume>: <fpage>101</fpage>–<lpage>17</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/(SICI)1097-0290(19970705)55:1&lt;101::AID-BIT12&gt;3.0.CO;2-P" xlink:type="simple">10.1002/(SICI)1097-0290(19970705)55:1&lt;101::AID-BIT12&gt;3.0.CO;2-P</ext-link></comment> <object-id pub-id-type="pmid">18636449</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004999.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wiechert</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Möllney</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Isermann</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Wurzel</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>de Graaf</surname> <given-names>AA</given-names></name>. <article-title>Bidirectional reaction steps in metabolic networks: III. explicit solution and analysis of isotopomer labeling systems</article-title>. <source>Biotechnol Bioeng</source>. <year>1999</year>; <volume>66</volume>: <fpage>69</fpage>–<lpage>85</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/(SICI)1097-0290(1999)66:2%3C69::AID-BIT1%3E3.3.CO;2-Y" xlink:type="simple">10.1002/(SICI)1097-0290(1999)66:2%3C69::AID-BIT1%3E3.3.CO;2-Y</ext-link></comment> <object-id pub-id-type="pmid">10567066</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004999.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Antoniewicz</surname> <given-names>MR</given-names></name>, <name name-style="western"><surname>Kelleher</surname> <given-names>JK</given-names></name>, <name name-style="western"><surname>Stephanopoulos</surname> <given-names>G</given-names></name>. <article-title>Elementary metabolite units (EMU): a novel framework for modeling isotopic distributions</article-title>. <source>Metab Eng</source>. <year>2007</year>; <volume>9</volume>: <fpage>68</fpage>–<lpage>86</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.ymben.2006.09.001" xlink:type="simple">10.1016/j.ymben.2006.09.001</ext-link></comment> <object-id pub-id-type="pmid">17088092</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004999.ref035">
<label>35</label>
<mixed-citation publication-type="other" xlink:type="simple">Plasson R, Bersini H, Brandenburg A. Decomposition of complex reaction networks into reactons; 2008. Preprint. Available: arXiv:0803.1385v1 [q-bio.MN]. Accessed 18 October 2015.</mixed-citation>
</ref>
<ref id="pcbi.1004999.ref036">
<label>36</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Palsson</surname> <given-names>BØ</given-names></name>. <source>Systems Biology: Constraint-based Reconstruction and Analysis</source>. <edition>1st ed</edition>. <publisher-loc>Cambridge</publisher-loc>: <publisher-name>Cambridge University Press</publisher-name>; <year>2015</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1017/CBO9780511790515" xlink:type="simple">10.1017/CBO9780511790515</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004999.ref037">
<label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Schilling</surname> <given-names>CH</given-names></name>, <name name-style="western"><surname>Letscher</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Palsson</surname> <given-names>BØ</given-names></name>. <article-title>Theory for the systemic definition of metabolic pathways and their use in interpreting metabolic function from a pathway-oriented perspective</article-title>. <source>J Theor Biol</source>. <year>2000</year>; <volume>203</volume>: <fpage>229</fpage>–<lpage>48</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1006/jtbi.2000.1073" xlink:type="simple">10.1006/jtbi.2000.1073</ext-link></comment> <object-id pub-id-type="pmid">10716907</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004999.ref038">
<label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tarjan</surname> <given-names>RE</given-names></name>. <article-title>Depth first search and linear graph algorithms</article-title>. <source>SIAM J Comput</source>. <year>1972</year>; <volume>1</volume>: <fpage>146</fpage>–<lpage>160</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004999.ref039">
<label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hucka</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Finney</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Sauro</surname> <given-names>HM</given-names></name>, <name name-style="western"><surname>Bolouri</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Doyle</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Kitano</surname> <given-names>H</given-names></name>, <etal>et al</etal>. <article-title>The systems biology markup language (SBML): a medium for representation and exchange of biochemical network models</article-title>. <source>Bioinformatics</source>. <year>2003</year>; <volume>19</volume>: <fpage>524</fpage>–<lpage>531</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btg015" xlink:type="simple">10.1093/bioinformatics/btg015</ext-link></comment> <object-id pub-id-type="pmid">12611808</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004999.ref040">
<label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Li</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Donizelli</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Rodriguez</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Dharuri</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Endler</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Chelliah</surname> <given-names>V</given-names></name>, <etal>et al</etal>. <article-title>BioModels database: An enhanced, curated and annotated resource for published quantitative kinetic models</article-title>. <source>BMC Syst Biol</source>. <year>2010</year>; <volume>4</volume>: <fpage>92</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1752-0509-4-92" xlink:type="simple">10.1186/1752-0509-4-92</ext-link></comment> <object-id pub-id-type="pmid">20587024</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004999.ref041">
<label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hattori</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Okuno</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Goto</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Kanehisa</surname> <given-names>M</given-names></name>. <article-title>Development of a chemical structure comparison method for integrated analysis of chemical and genomic information in the metabolic pathways</article-title>. <source>J Am Chem Soc</source>. <year>2003</year>; <volume>125</volume>:<fpage>11853</fpage>–<lpage>11865</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1021/ja036030u" xlink:type="simple">10.1021/ja036030u</ext-link></comment> <object-id pub-id-type="pmid">14505407</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004999.ref042">
<label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kotera</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Okuno</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Hattori</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Goto</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Kanehisa</surname> <given-names>M</given-names></name>. <article-title>Computational assignment of the EC numbers for genomic-scale analysis of enzymatic reactions</article-title>. <source>J Am Chem Soc</source>. <year>2004</year>; <volume>126</volume>: <fpage>16487</fpage>–<lpage>16498</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1021/ja0466457" xlink:type="simple">10.1021/ja0466457</ext-link></comment> <object-id pub-id-type="pmid">15600352</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004999.ref043">
<label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Schuster</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Schuster</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Heinrich</surname> <given-names>R</given-names></name>. <article-title>Minimization of intermediate concentrations as a suggested optimality principle for biochemical networks</article-title>. <source>J Math Biol</source>. <year>1991</year>; <volume>29</volume>: <fpage>425</fpage>–<lpage>455</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/BF00160470" xlink:type="simple">10.1007/BF00160470</ext-link></comment> <object-id pub-id-type="pmid">1875162</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004999.ref044">
<label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Klamt</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Gilles</surname> <given-names>ED</given-names></name>. <article-title>Minimal cut sets in biochemical reaction networks</article-title>. <source>Bioinformatics</source>. <year>2004</year>; <volume>20</volume>: <fpage>226</fpage>–<lpage>234</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btg395" xlink:type="simple">10.1093/bioinformatics/btg395</ext-link></comment> <object-id pub-id-type="pmid">14734314</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004999.ref045">
<label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Schellenberger</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Que</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Fleming</surname> <given-names>RMT</given-names></name>, <name name-style="western"><surname>Thiele</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Orth</surname> <given-names>JD</given-names></name>, <name name-style="western"><surname>Feist</surname> <given-names>AM</given-names></name>, <etal>et al</etal>. <article-title>Quantitative prediction of cellular metabolism with constraint-based models: the COBRA toolbox v2.0</article-title>. <source>Nat Protoc</source>. <year>2011</year>; <volume>6</volume>: <fpage>1290</fpage>–<lpage>1307</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nprot.2011.308" xlink:type="simple">10.1038/nprot.2011.308</ext-link></comment> <object-id pub-id-type="pmid">21886097</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004999.ref046">
<label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bounova</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>de Weck</surname> <given-names>O</given-names></name>. <article-title>Overview of metrics and their correlation patterns for multiple-metric topology analysis on heterogeneous graph ensembles</article-title>. <source>Phys Rev E</source>. <year>2012</year>; <volume>85</volume>: <fpage>016117</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevE.85.016117" xlink:type="simple">10.1103/PhysRevE.85.016117</ext-link></comment> <object-id pub-id-type="pmid">22400635</object-id></mixed-citation>
</ref>
</ref-list>
</back>
</article>