<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-16-01591</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1005540</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Probability theory</subject><subj-group><subject>Random variables</subject><subj-group><subject>Covariance</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Brain mapping</subject><subj-group><subject>Magnetoencephalography</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Imaging techniques</subject><subj-group><subject>Neuroimaging</subject><subj-group><subject>Magnetoencephalography</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neuroimaging</subject><subj-group><subject>Magnetoencephalography</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Engineering and technology</subject><subj-group><subject>Signal processing</subject><subj-group><subject>White noise</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Mathematical and statistical techniques</subject><subj-group><subject>Fourier analysis</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Differential equations</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Brain</subject><subj-group><subject>Cerebral cortex</subject><subj-group><subject>Parietal lobe</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Brain</subject><subj-group><subject>Cerebral cortex</subject><subj-group><subject>Parietal lobe</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Engineering and technology</subject><subj-group><subject>Signal processing</subject><subj-group><subject>Statistical signal processing</subject></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Dynamic decomposition of spatiotemporal neural signals</article-title>
<alt-title alt-title-type="running-head">Dynamic decomposition of spatiotemporal neural signals</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-3673-0825</contrib-id>
<name name-style="western">
<surname>Ambrogioni</surname> <given-names>Luca</given-names></name>
<xref ref-type="aff" rid="aff001"/>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-2206-9098</contrib-id>
<name name-style="western">
<surname>van Gerven</surname> <given-names>Marcel A. J.</given-names></name>
<xref ref-type="aff" rid="aff001"/>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-5166-1800</contrib-id>
<name name-style="western">
<surname>Maris</surname> <given-names>Eric</given-names></name>
<xref ref-type="aff" rid="aff001"/>
</contrib>
</contrib-group>
<aff id="aff001">
<addr-line>Radboud University, Donders Institute for Brain, Cognition and Behaviour, Nijmegen, The Netherlands</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Beck</surname> <given-names>Jeff</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Duke University, UNITED STATES</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con">
<p>
<list list-type="simple">
<list-item>
<p><bold>Conceptualization:</bold> LA EM.</p>
</list-item>
<list-item>
<p><bold>Formal analysis:</bold> LA.</p>
</list-item>
<list-item>
<p><bold>Funding acquisition:</bold> EM.</p>
</list-item>
<list-item>
<p><bold>Investigation:</bold> LA.</p>
</list-item>
<list-item>
<p><bold>Methodology:</bold> LA EM.</p>
</list-item>
<list-item>
<p><bold>Project administration:</bold> EM.</p>
</list-item>
<list-item>
<p><bold>Software:</bold> LA.</p>
</list-item>
<list-item>
<p><bold>Supervision:</bold> EM.</p>
</list-item>
<list-item>
<p><bold>Validation:</bold> EM.</p>
</list-item>
<list-item>
<p><bold>Visualization:</bold> LA.</p>
</list-item>
<list-item>
<p><bold>Writing – original draft:</bold> LA.</p>
</list-item>
<list-item>
<p><bold>Writing – review &amp; editing:</bold> LA EM MAJvG.</p>
</list-item>
</list>
</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">l.ambrogioni@donders.ru.nl</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>5</month>
<year>2017</year>
</pub-date>
<pub-date pub-type="epub">
<day>30</day>
<month>5</month>
<year>2017</year>
</pub-date>
<volume>13</volume>
<issue>5</issue>
<elocation-id>e1005540</elocation-id>
<history>
<date date-type="received">
<day>29</day>
<month>9</month>
<year>2016</year>
</date>
<date date-type="accepted">
<day>1</day>
<month>5</month>
<year>2017</year>
</date>
</history>
<permissions>
<copyright-year>2017</copyright-year>
<copyright-holder>Ambrogioni et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1005540"/>
<abstract>
<p>Neural signals are characterized by rich temporal and spatiotemporal dynamics that reflect the organization of cortical networks. Theoretical research has shown how neural networks can operate at different dynamic ranges that correspond to specific types of information processing. Here we present a data analysis framework that uses a linearized model of these dynamic states in order to decompose the measured neural signal into a series of components that capture both rhythmic and non-rhythmic neural activity. The method is based on stochastic differential equations and Gaussian process regression. Through computer simulations and analysis of magnetoencephalographic data, we demonstrate the efficacy of the method in identifying meaningful modulations of oscillatory signals corrupted by structured temporal and spatiotemporal noise. These results suggest that the method is particularly suitable for the analysis and interpretation of complex temporal and spatiotemporal neural signals.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>In neuroscience, researchers are often interested in the modulations of specific signal components (e.g., oscillations in a particular frequency band), that have to be extracted from a background of both rhythmic and non-rhythmic activity. As the interfering background signals often have higher amplitude than the component of interest, it is crucial to develop methods that are able to perform some sort of signal decomposition. In this paper, we introduce a Bayesian decomposition method that exploits a prior dynamical model of the neural temporal dynamics in order to extract signal components with well-defined dynamic features. The method is based on Gaussian process regression with prior distributions determined by the covariance functions of linear stochastic differential equations. Using simulations and analysis of real MEG data, we show that these informed prior distributions allow for the extraction of interpretable dynamic components and the estimation of relevant signal modulations. We generalize the method to the analysis of spatiotemporal cortical activity and show that the framework is intimately related to well-established source-reconstruction techniques.</p>
</abstract>
<funding-group>
<funding-statement>This work was funded by a internal grant of the Donders Center for Cognition to EM. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="9"/>
<table-count count="1"/>
<page-count count="37"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2017-06-13</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>The MEG data are available from the Research Data Management (RDM) Repository of the Donders Institute for Brain, Cognition and Behaviour, and can be accessed via this persistent identifier: <ext-link ext-link-type="uri" xlink:href="http://hdl.handle.net/11633/di.dcc.DSC_DCC.2016.00249_262" xlink:type="simple">http://hdl.handle.net/11633/di.dcc.DSC_DCC.2016.00249_262</ext-link>. The MATLAB scripts are stored in the following public BitBuckut repository: <ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/lucaphd/sgpd" xlink:type="simple">https://bitbucket.org/lucaphd/sgpd</ext-link>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<disp-quote>
<p>This is a <italic>PLOS Computational Biology</italic> methods paper.</p>
</disp-quote>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Human neocortex has an impressively complex organization. Cortical electrical activity is determined by dynamic properties of neurons that are wired together in large cortical networks. These neuronal networks generate measurable time series with characteristic spatial and temporal structure. In spite of the staggering complexity of cortical networks, electrophysiological measurements can often be properly described in terms of a few relatively simple dynamic components. By dynamic components we mean signals that exhibit characteristic properties such as rhythmicity, time scale and peak frequency. For example, neural oscillations at different frequencies are extremely prominent in electroencephalographic (EEG) and magnetoencephalographic (MEG) measurements and have been related to a wide range of cognitive and behavioral states [<xref ref-type="bibr" rid="pcbi.1005540.ref001">1</xref>–<xref ref-type="bibr" rid="pcbi.1005540.ref003">3</xref>]. Neural oscillations have been the subject of theoretical and experimental research as they are seen as a way to connect the dynamic properties of the cortex to human cognition [<xref ref-type="bibr" rid="pcbi.1005540.ref004">4</xref>–<xref ref-type="bibr" rid="pcbi.1005540.ref008">8</xref>]. Importantly, an oscillatory process can be described using simple mathematical models in the form of linearized differential equations [<xref ref-type="bibr" rid="pcbi.1005540.ref009">9</xref>].</p>
<p>In this paper, we introduce a framework to integrate prior knowledge of neural signals (both rhythmic and broadband) into an analysis framework based on Gaussian process (GP) regression [<xref ref-type="bibr" rid="pcbi.1005540.ref010">10</xref>]. The aim is to decompose the measured time series into a set of dynamic components, each defined by a linear stochastic differential equation (SDE). These SDEs determine a prior probability distribution through their associated GP covariance functions. The covariance function specifies the prior correlation structure of the dynamic components, i.e. the correlations between the components’ activity at different time points. Using this prior, a mathematical model of the signal dynamics is incorporated into a Bayesian data analysis procedure. The resulting decomposition method is able to separate linearly mixed dynamic components from a noise-corrupted measured time series. This is conceptually different from blind decomposition methods such as independent component analysis (ICA) and principal component analysis (PCA) [<xref ref-type="bibr" rid="pcbi.1005540.ref011">11</xref>, <xref ref-type="bibr" rid="pcbi.1005540.ref012">12</xref>] that necessarily rely on the statistical relations between sensors and are not informed by a prior model of the underlying signals. In particular, since each component extracted using the GP-based decomposition is obtained from an explicit model of the underlying process, these components are easily interpretable and can be naturally compared across different participants and experimental conditions.</p>
<p>The GP-based decomposition can be applied to spatiotemporal brain data by imposing a spatial smoothness constraint at the level of the cortical surface. We will show that the resulting spatiotemporal decomposition is related to well-known source reconstruction methods [<xref ref-type="bibr" rid="pcbi.1005540.ref013">13</xref>–<xref ref-type="bibr" rid="pcbi.1005540.ref016">16</xref>] and allows to localize the dynamic components across the cortex. The connections between EEG/MEG source reconstruction and GP regression have recently been shown by Solin et al. [<xref ref-type="bibr" rid="pcbi.1005540.ref017">17</xref>]. Our approach complements and extends their work by introducing an explicit additive model of the underlying neural dynamics.</p>
<p>Through computer simulations and analysis of empirical data, we show that the GP-based decomposition allows to quantify subtle modulations of the dynamic components, such as oscillatory amplitude modulations, and does so more reliably than conventional methods. We also demonstrate that the output of the method is highly interpretable and can be effectively used for uncovering reliable spatiotemporal phenomena in the neural data. Therefore, when applied to the data of a cognitive experiment, this approach may give rise to new insights into how cognitive states arise from neural dynamics.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<p>In the following, we will show how to construct a probabilistic model of the neural dynamics that captures the main dynamical features of the electrophysiological signals. The temporal dynamics of the neural sources are modeled using linear SDEs, and these in turn determine a series of GP prior distributions. These priors will be used to decompose the signal into several dynamic components with a characteristic temporal correlation structure. Building from the temporal model, we introduce a spatiotemporal decomposition method that can localize the dynamic components on the cortical surface.</p>
<sec id="sec003">
<title>Decomposing a signal using temporal covariance functions</title>
<sec id="sec004">
<title>Modeling neural activity with stochastic differential equations</title>
<p>We consider a single sensor that measures the signal produced by the synchronized subthreshold dynamics of some homogeneous neuronal population. Neural activity is defined for all possible time points but is only observed through discretely-sampled and noise-corrupted measurements <italic>y</italic><sub><italic>t</italic></sub>. We assume the observation noise <italic>ξ</italic>(<italic>t</italic>) to be Gaussian but not necessarily white. In <xref ref-type="fig" rid="pcbi.1005540.g001">Fig 1A</xref>, an example is given of a continuous-time process corrupted by white noise and sampled at regular intervals. Modeling the neural signal as a continuous (rather than a discrete) time series has the advantage of being invariant under changes of sampling frequency and can also accommodate non-equidistant samples.</p>
<fig id="pcbi.1005540.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005540.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Stochastic processes and covariance functions.</title>
<p>A) Example of a continuous-time oscillatory process (blue line) sampled at discrete equally-spaced time points though noise corrupted measurements (red dots). B–E) Samples (colored) and expected values (black) of the stochastic processes. The processes are a damped harmonic oscillator, second order integrator, first order integrator and residuals respectively. The samples start from an excited state and decay back to their respective stationary distribution. F) Illustration of the decomposition of a complex signal’s covariance function into simpler additive components. This corresponds to an additive decomposition of the measured time series. The second order integrator process has been excluded from this panel for visualization purposes.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005540.g001" xlink:type="simple"/>
</fig>
<p>The prior distribution of the temporal dynamics of the neural activity is specified using linear SDEs. For example, we model the neural oscillatory process <italic>φ</italic>(<italic>t</italic>) using the following equation:
<disp-formula id="pcbi.1005540.e001"><alternatives><graphic id="pcbi.1005540.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e001" xlink:type="simple"/><mml:math display="block" id="M1"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:msup><mml:mi>d</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mrow><mml:mi>d</mml:mi> <mml:msup><mml:mi>t</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac> <mml:mi>φ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>b</mml:mi> <mml:mfrac><mml:mi>d</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mi>φ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>ω</mml:mi> <mml:mrow><mml:mn>0</mml:mn></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mi>φ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>w</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula>
This differential equation describes a damped harmonic oscillator, which responds to input by increasing its oscillatory amplitude. The parameter <italic>b</italic> regulates the exponential decay of these input-driven excitations. The frequency w of these excitations is equal to <inline-formula id="pcbi.1005540.e002"><alternatives><graphic id="pcbi.1005540.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:msqrt><mml:mrow><mml:msubsup><mml:mi>ω</mml:mi> <mml:mrow><mml:mn>0</mml:mn></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>-</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:msup><mml:mi>b</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:math></alternatives></inline-formula>. Clearly, this frequency is only defined for <inline-formula id="pcbi.1005540.e003"><alternatives><graphic id="pcbi.1005540.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:mrow><mml:msubsup><mml:mi>ω</mml:mi> <mml:mrow><mml:mn>0</mml:mn></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>&gt;</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:msup><mml:mi>b</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>. For larger values of <italic>b</italic>, the system ceases to exhibit oscillatory responses and is said to be overdamped. These dynamical states are referred to as an oscillator in case <inline-formula id="pcbi.1005540.e004"><alternatives><graphic id="pcbi.1005540.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:mrow><mml:msubsup><mml:mi>ω</mml:mi> <mml:mrow><mml:mn>0</mml:mn></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>&gt;</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:msup><mml:mi>b</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> and an integrator in case <inline-formula id="pcbi.1005540.e005"><alternatives><graphic id="pcbi.1005540.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:mrow><mml:msubsup><mml:mi>ω</mml:mi> <mml:mrow><mml:mn>0</mml:mn></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>&lt;</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:msup><mml:mi>b</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> [<xref ref-type="bibr" rid="pcbi.1005540.ref018">18</xref>].</p>
<p>We assume the process to be driven by a random input <italic>w</italic>(<italic>t</italic>) (also denoted as <italic>perturbation</italic>). This random function models the combined effect of the synaptic inputs to the neuronal population that generates the signal. <xref ref-type="fig" rid="pcbi.1005540.g001">Fig 1B</xref> shows the expected value (black) and a series of samples (coloured) of the process, starting from an excited state (<italic>φ</italic>(0) = 0.4) and decaying back to its stationary dynamics. Note that the expected value converges to zero whereas the individual samples do not; this is due to the continued effect of the random input. Also, note that the samples gradually become phase inconsistent, with the decay of phase consistency being determined by the damping parameter <italic>b</italic>. Thus, the damping parameter also determines the decay of the temporal correlations.</p>
<p>In general, we model the measured time series as a mixture of four processes, which we will now describe. Of these four, one reflects rhythmic brain activity (i.e., an oscillation), two reflect non-rhythmic brain activity, and one accounts for the residuals:</p>
<list list-type="bullet">
<list-item>
<p><italic>Damped harmonic oscillator.</italic> Oscillations are a feature of many electrophysiological recordings [<xref ref-type="bibr" rid="pcbi.1005540.ref019">19</xref>, <xref ref-type="bibr" rid="pcbi.1005540.ref020">20</xref>], and they are thought to be generated by synchronized oscillatory dynamics of the membrane potentials of large populations of pyramidal neurons [<xref ref-type="bibr" rid="pcbi.1005540.ref021">21</xref>]. We model the neural oscillatory process as a stochastic damped harmonic oscillator as defined in <xref ref-type="disp-formula" rid="pcbi.1005540.e001">Eq (1)</xref> with damping coefficient <inline-formula id="pcbi.1005540.e006"><alternatives><graphic id="pcbi.1005540.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:mrow><mml:mi>b</mml:mi> <mml:mo>&lt;</mml:mo> <mml:msqrt><mml:mrow><mml:mn>2</mml:mn> <mml:msubsup><mml:mi>ω</mml:mi> <mml:mrow><mml:mn>0</mml:mn></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:msqrt></mml:mrow></mml:math></alternatives></inline-formula>. This linear differential equation can be obtained by linearizing a model of the neuronal membrane potential that is characterized by sub-threshold oscillations [<xref ref-type="bibr" rid="pcbi.1005540.ref018">18</xref>].</p>
</list-item>
<list-item>
<p><italic>Second order integrator.</italic> We model the smooth non-oscillatory component of the measured time series using an equation of the same form as <xref ref-type="disp-formula" rid="pcbi.1005540.e001">Eq (1)</xref> but in the overdamped state. We will denote this dynamic component as <italic>χ</italic>(<italic>t</italic>). In the overdamped regime, the equation has smooth, non-rhythmic solutions (see <xref ref-type="fig" rid="pcbi.1005540.g001">Fig 1C</xref>). Equations like these emerge by linearizing neuronal models around a non-oscillatory fixed point [<xref ref-type="bibr" rid="pcbi.1005540.ref018">18</xref>].</p>
</list-item>
<list-item>
<p><italic>First order integrator.</italic> Most neurophysiological signals have a significant amount of energy in very low frequencies. We model this part of the signal with a simple first order SDE of which the covariance function decays exponentially. This process captures some of the qualitative features of the measured time series, such as roughness and non-rhythmicity. The model is determined by the following first order SDE:
<disp-formula id="pcbi.1005540.e007"><alternatives><graphic id="pcbi.1005540.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e007" xlink:type="simple"/><mml:math display="block" id="M7"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mi>d</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mi>ψ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mi>c</mml:mi> <mml:mi>ψ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>w</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2)</label></disp-formula>
The positive number <italic>c</italic> determines the exponential relaxation of the process, i.e. how fast its mean decays to zero after a perturbation. The resulting stochastic process is known as Ornstein-Uhlenbeck process. For a compact neuron this is a good model of the sub-threshold membrane potential under random synaptic inputs [<xref ref-type="bibr" rid="pcbi.1005540.ref022">22</xref>]. See <xref ref-type="fig" rid="pcbi.1005540.g001">Fig 1D</xref> for some samples of this process.</p>
</list-item>
<list-item>
<p><italic>Residuals.</italic> Finally, we account for the residuals <italic>ξ</italic>(<italic>t</italic>) of our model using a process with temporal covariance that decays as <inline-formula id="pcbi.1005540.e008"><alternatives><graphic id="pcbi.1005540.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e008" xlink:type="simple"/><mml:math display="inline" id="M8"><mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mfrac><mml:msup><mml:mi>t</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mrow><mml:mn>2</mml:mn> <mml:msup><mml:mi>δ</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>, where <italic>δ</italic> is a small time constant. This noise is characterized by short-lived temporal autocorrelations (see <xref ref-type="fig" rid="pcbi.1005540.g001">Fig 1E</xref>). As <italic>δ</italic> tends to zero, the process tends to Gaussian white noise. The temporal covariance of this component was not derived from a stochastic differential equation.</p>
</list-item>
</list>
</sec>
<sec id="sec005">
<title>From stochastic differential equations to Gaussian processes regression</title>
<p>In our dynamical model, the random input is Gaussian and the dynamics are linear. The linearity implies that the value of the process at any time point is a linear combination of the random input at the past time points. As a consequence, because every linear combination of a set of Gaussian random variables is still Gaussian, the solutions of the SDEs are Gaussian. The Gaussian Process (GP) distribution is the generalization of a multivariate Gaussian for infinitely many degrees of freedom, where the covariance function of the former is analogous to the covariance matrix of the latter. As a zero-mean multivariate Gaussian distribution is fully specified by a covariance matrix, a zero-mean GP <italic>α</italic>(<italic>t</italic>) can be completely determined by its covariance function:
<disp-formula id="pcbi.1005540.e009"><alternatives><graphic id="pcbi.1005540.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e009" xlink:type="simple"/><mml:math display="block" id="M9"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>k</mml:mi> <mml:mi>α</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mtext>cov</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>α</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mi>α</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(3)</label></disp-formula>
which captures the temporal correlation structure of the stochastic process <italic>α</italic>(<italic>t</italic>). In our case, the covariance function of the dynamical component <italic>φ</italic>(<italic>t</italic>), <italic>χ</italic>(<italic>t</italic>) and <italic>ψ</italic>(<italic>t</italic>) can be obtained analytically from Eqs <xref ref-type="disp-formula" rid="pcbi.1005540.e001">(1)</xref> and <xref ref-type="disp-formula" rid="pcbi.1005540.e007">(2)</xref>. This allows to derive a GP distribution for each linear SDE. Moreover, a sum of independent GPs is again a GP, but now with a covariance function that is the sum of the covariance functions of each of its components. This decomposition of the covariance function is exemplified in <xref ref-type="fig" rid="pcbi.1005540.g001">Fig 1F</xref>, which shows the decomposition of the covariance function of a complex signal into several component-specific covariance functions, together with examples of the corresponding dynamic component time series. For visual clarity, the second order integrator component has been omitted from this figure.</p>
<p>With these GPs as prior distributions, we can use Bayes’ theorem for estimating the time course of the dynamic components from the measured time series <italic>y</italic>. In particular, we assume that <italic>y</italic> is generated by the sum of all dynamic components and corrupted by Gaussian noise <italic>ξ</italic>(<italic>t</italic>). The aim is to individually estimate the posterior marginal expectations of <italic>φ</italic>(<italic>t</italic>), <italic>χ</italic>(<italic>t</italic>) and <italic>ψ</italic>(<italic>t</italic>). These marginal expectations are estimates of a dynamic component time course obtained by filtering out from <italic>y</italic> all the contributions of the other components plus the noise.</p>
<p>Since both the prior distributions and the observation model are Gaussian, the posterior distribution is itself Gaussian and its marginal expectations can be computed exactly (see <xref ref-type="disp-formula" rid="pcbi.1005540.e037">Eq (20)</xref> in <xref ref-type="sec" rid="sec025">Materials and methods</xref>).</p>
</sec>
</sec>
<sec id="sec006">
<title>Spatiotemporal GP-based decomposition</title>
<p>So far, we have shown how SDE modeling of dynamic components can be used for analyzing a neural time series through GP regression. Here, we complement this temporal model by introducing a spatial correlation structure. In this way, we define a full spatiotemporal model. We define the total additive spatiotemporal neural signal as follows:
<disp-formula id="pcbi.1005540.e010"><alternatives><graphic id="pcbi.1005540.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e010" xlink:type="simple"/><mml:math display="block" id="M10"><mml:mrow><mml:mi>ρ</mml:mi> <mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo> <mml:mo>=</mml:mo> <mml:mi>φ</mml:mi> <mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo> <mml:mo>+</mml:mo> <mml:mi>χ</mml:mi> <mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo> <mml:mo>+</mml:mo> <mml:mi>ψ</mml:mi> <mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo> <mml:mspace width="0.166667em"/><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
where <bold><italic>x</italic></bold> denotes a cortical location. Strictly speaking, <italic>ρ</italic>(<bold><italic>x</italic></bold>, <italic>t</italic>) should be a vector field because the neural electrical activity at each cortical point is modeled as an equivalent current dipole. However, for simplicity, we present the methods for the case in which the dipole orientation is fixed and <italic>ρ</italic>(<bold><italic>x</italic></bold>, <italic>t</italic>) can be considered as a scalar field. All formulas for the vector-valued case are given in the supporting information.</p>
<sec id="sec007">
<title>Modeling spatial correlations</title>
<p>Correlations between different cortical locations can be modeled using a spatial covariance function <italic>s</italic>(<bold><italic>x</italic></bold>, <bold><italic>x</italic></bold>′). Since the localization of an electric or magnetic source from a sensor array is in general an ill-posed problem, the specification of a prior covariance function is required in order to obtain a unique solution [<xref ref-type="bibr" rid="pcbi.1005540.ref015">15</xref>]. We do not model the spatial correlation structure directly using spatial SDEs. Instead, we impose a certain degree of spatial smoothness, and this is motivated by the fact that fine details of the neural activity cannot be reliably estimated from the MEG or EEG measurements. This procedure has been shown to reduce the localization error and attenuate some of the typical artifacts of source reconstruction [<xref ref-type="bibr" rid="pcbi.1005540.ref014">14</xref>, <xref ref-type="bibr" rid="pcbi.1005540.ref016">16</xref>].</p>
<p>Modeling the spatial correlations between measurements of neural activity requires a proper definition of distance between cortical locations. The conventional Euclidean distance is likely to be inappropriate because cortical gyri can be nearby according to the Euclidean distance in three-dimensional space, but far apart in terms of the intrinsic cortical geometry that is determined by the synaptic connectivity between grey matter areas. Surface reconstruction algorithms such as Freesurfer [<xref ref-type="bibr" rid="pcbi.1005540.ref023">23</xref>] allow to map each of the cortical hemispheres onto a sphere in a way that preserves this intrinsic cortical geometry. Building this spherical representation, we can make use of the so-called spherical harmonics. These are basis functions that generalize sines and cosines on the surface of a sphere and are naturally ordered according to their spatial frequency. Using the spherical harmonics we define a spatial covariance function <italic>s</italic>(<bold><italic>x</italic></bold>, <bold><italic>x</italic></bold>′) between cortical locations, and choose a particular covariance function by discounting high spatial-frequency harmonics. This operation smooths out the fast-varying neural activity and thereby induces spatial correlations. This can be interpreted as a low-pass spatial filter on the cortical surface. The amount of spatial smoothing is regulated by a smoothing parameter <italic>υ</italic> and a regularization parameter λ, where the former controls the prior spatial correlations and the latter the relative contribution of the prior and the observed spatial correlation (see Eqs <xref ref-type="disp-formula" rid="pcbi.1005540.e056">(23)</xref> and <xref ref-type="disp-formula" rid="pcbi.1005540.e083">(36)</xref> in the <xref ref-type="sec" rid="sec025">Materials and methods</xref>).</p>
</sec>
<sec id="sec008">
<title>Decomposing spatiotemporal signals using separable covariance functions</title>
<p>We combine the spatial and temporal model by making a separability assumption, namely we assume that the covariance between <italic>ρ</italic>(<bold><italic>x</italic></bold>, <italic>t</italic>) and <italic>ρ</italic>(<bold><italic>x</italic></bold>′, <italic>t</italic>′) is given by the product <italic>k</italic><sub><italic>ρ</italic></sub>(<italic>t</italic>, <italic>t</italic>′)<italic>s</italic>(<bold><italic>x</italic></bold>, <bold><italic>x</italic></bold>′). Using this spatiotemporal GP prior we compute the marginal expectations of the spatiotemporal dynamic components (see <xref ref-type="disp-formula" rid="pcbi.1005540.e083">Eq (36)</xref> in <xref ref-type="sec" rid="sec025">Materials and methods</xref>). We refer to this approach as spatiotemporal GP-based decomposition (SGPD).</p>
</sec>
</sec>
<sec id="sec009">
<title>Estimating the model parameters</title>
<p>The covariance functions of the dynamic components have parameters that can be directly estimated from the data. Instead of using a full hierarchical model, we estimate the parameters by fitting the total additive covariance function of the model to the empirical auto-covariance matrix of the measured time series using a least-squares approach. This procedure allows to infer the parameters of the prior directly from the data, thereby tuning the dynamical model on the specific features of each participant/experimental condition. Specifically, the parameters of the prior are estimated from the data of all trials, and these parameters in turn determine the GP prior distribution that is used for the analysis of the trial-specific data.</p>
<p>The details of the cost function are described in the Materials and Methods section. Because this optimization problem is not convex, it can have several local minima. For that reason, we used a gradient-free simulated annealing procedure [<xref ref-type="bibr" rid="pcbi.1005540.ref024">24</xref>] to find a good approximate solution to the global optimization problem.</p>
</sec>
<sec id="sec010">
<title>Analyzing oscillatory signals using GP-based decomposition: Simulation studies</title>
<p>We conducted three simulation studies to compare the performance of GP-based decomposition with the performance of existing methods. In the first study, we evaluate the ability of the method to recover components from complex spatiotemporal signals. In the second simulation, we evaluate its performance in estimating modulations of oscillatory amplitude. And in the third simulation, we evaluate its performance in localizing the source of an oscillatory amplitude modulation.</p>
<sec id="sec011">
<title>Recovering components from complex neural signals</title>
<p>Using simulated signals, we evaluated the performance of SGPD in recovering components from mixed oscillatory signals corrupted by temporally and spatially structured noise. We first established the robustness of the GP decomposition method with respect to over-estimation of the number of dynamic components. We did this in a simplified situation where only the temporal dimension is relevant. Next, using spatiotemporal signals, we compared the performance of SGPD with several commonly used decomposition methods. We simulated signals both using a one- and a two-dimensional cortical sheet, with the latter involing non-contiguous spatial profiles. For simplicity, in all these simulations, we assume that the neural activity can be measured directly, thereby obviating the need for a forward model. We will validate GP-based source reconstruction, in which the forward model is an inherent component, in a later paragraph.</p>
<p>In the study evaluating robustness to over-estimation, we simulated signals in the following conditions: (1) two oscillatory processes (5 Hz and 10 Hz) plus an OU process, (2) one oscillatory process (10 Hz) plus an OU process, and (3) a single oscillatory process (10 Hz). In all three conditions, the signals also contained white noise and the total SNR was set equal to 1. In all conditions, we used the temporal GP decomposition with four dynamic components (two damped oscillators, a first order integrator and a residual) to recover the 10 Hz oscillatory process. The performance of the decomposition is extremely similar for all conditions: the median correlations with the ground truth signals were, respectively, 0.947, 0.947 and 0.940 for condition 1,2 and 3. This shows that the method can be very robust to overestimation of the number of dynamic components.</p>
<p>In the second simulation, we compared the performance of SGPD with some of the most commonly used signal decomposition techniques: ICA, PCA, empirical mode decomposition (EMD) and singular spectrum analysis (SSA) [<xref ref-type="bibr" rid="pcbi.1005540.ref011">11</xref>, <xref ref-type="bibr" rid="pcbi.1005540.ref025">25</xref>, <xref ref-type="bibr" rid="pcbi.1005540.ref026">26</xref>]. All methods were used to extract the time series of a high frequency oscillatory component (10Hz) with a contiguous spatial profile from a mixed spatiotemporal signal. The SGPD was adapted to the one-dimensional case by working with one-dimensional Fourier basis functions (sines and cosines) instead of the two-dimensional spherical harmonics. The oscillatory dynamic component was estimated for all source points, then a single time series was obtained by selecting the source point with the highest variance. EMD and SSA components were extracted separately for each spatial source point and the performance was solely evaluated for the component with highest temporal correlations with the ground truth signal. Performance was quantified as the temporal correlation between the recovered time series and the simulated oscillatory signal (the ground truth). We simulated two oscillatory sources with Gaussian spatial profiles whose centers have coordinates -0.5 mm and 0.5 mm. We manipulated both the spectral and the spatial overlap of the two oscillatory sources. Specifically, the standard deviation of their spatial profiles was either 1 mm (low spatial overlap) or 2 mm (high spatial overlap) and the difference between their peak frequency was either 5 Hz (low spectral overlap) or 2 Hz (high spectral overlap). One of the two oscillatory sources had a peak frequency of 10 Hz, the other source had a lower peak frequency. In all these conditions, the oscillatory sources were surrounded by two noise sources with dynamics governed by an OU process. These noise sources had Gaussian spatial profiles centered at -1.5 mm and 1.5 mm and standard deviation of 1 mm. In total, we generated 600 trials, each with a length of 0.8 s. More details are given in the Methods. <xref ref-type="fig" rid="pcbi.1005540.g002">Fig 2</xref> shows the correlations between the ground truth signals and the recovered oscillatory components for all listed methods. SGPD performs better than the other methods in all four conditions: high and low spectral overlap combined with high and low spatial overlap. SSA is a good second best, followed by EMD. The performance of ICA depends on the degree of spatial overlap: when the spatial overlap is low, its performance is slightly better than the performance of EMD, but when the spatial overlap is high, its performance is inferior. Finally, in all four conditions, PCA showed the worst performance in recovering the ground truth component.</p>
<fig id="pcbi.1005540.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005540.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Simulation results on the decomposition of spatiotemporally mixed signals.</title>
<p>Performance of SGPD, SSA, EMD, ICA and PCA in recovering an oscillatory signal that was mixed with complex spatiotemporal noise. The performance is quantified as correlation with the ground truth. The red line is the median correlation across trials, the boxes contain correlations between the first and the third quartile. There are four conditions: A) low spectral and low spatial overlap; B) high spectral and low spatial overlap; C) low spectral and high spatial overlap; D) high spectral and high spatial overlap.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005540.g002" xlink:type="simple"/>
</fig>
<p>Our third simulation, is motivated by the fact that cortical spatiotemporal components can have a non-contiguous spatial profile. One of the best known examples is the default mode network, a cortical network that spans several brain areas [<xref ref-type="bibr" rid="pcbi.1005540.ref027">27</xref>]. In our simulation, we investigate the capacity of SGPD to recover the spatial profile of a simulated non-contiguous dynamic component. Since component analysis methods such as ICA and PCA are by far the most widely used for recovering the spatial profile of functional networks, we limited our comparison to those two methods. The source model is a two-dimensional flat cortical sheet. For each simulated trial, we generated an oscillatory source (peak frequency: 10 Hz) with a spatial profile that was the sum of two bivariate isotropic Gaussian functions with centers at coordinate pairs (1, 1) mm and (−1, −1) mm and with standard deviation equal to 0.2 mm. This spatial profile is shown in <xref ref-type="fig" rid="pcbi.1005540.g003">Fig 3A</xref>. These two peaks of activity are practically non-contiguous, being separated by five standard deviations. The oscillatory signal was contaminated by an OU process with a spatial profile that is also the sum of two bivariate isotropic Gaussian functions with centers at coordinate paris (1, −1) mm and (−1, 1) and with standard deviation equal to 0.8 mm. Finally, the data was corrupted with spatiotemporal white noise. Except for the presence of a single oscillatory source, the details of all the signals are identical to the previous simulation. We evaluated the performance of SGPD in recovering the spatial pattern of the oscillatory source. As a comparison, the figure also reports the spatial correlations of the estimates obtained using PCA and temporal ICA. In this latter case, we applied the ICA algorithm on the temporally-concatenated data matrix. From every resulting decomposition, we selected the component with the highest temporal correlation with the ground truth oscillation. Next, for both ICA and PCA, we obtained trial-by-trial estimates of the spatial maps by least squares fitting of the selected component’s time course on the trial specific data. The SGPD had a median correlation of 0.9 while PCA and ICA had a lower median correlation of 0.77 and 0.78 respectively. <xref ref-type="fig" rid="pcbi.1005540.g003">Fig 3B</xref> shows the spatial correlations between the ground truth spatial profile and the estimate obtained using SGPD, PCA and ICA.</p>
<fig id="pcbi.1005540.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005540.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Simulation results on recovery of spatial profiles of non-contiguous dynamic components.</title>
<p>Performance of SGPD, ICA and PCA in recovering an oscillatory signal with a non-contiguous spatial profile. A) Ground truth spatial profile of the dynamic component. B) Performance of SGPD, PCA and PCA in recovering the spatial profile of a dynamic component with bi-modal spatial profile on a two-dimensional cortical sheet. The performance is quantified as spatial correlation with the ground truth.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005540.g003" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec012">
<title>Estimating modulations in oscillatory amplitude</title>
<p>Modulations in oscillatory amplitude have been related to many cognitive processes. For example, in tasks that require attentional orienting to some part of the visual field, alpha oscillations are suppressed over the corresponding brain regions [<xref ref-type="bibr" rid="pcbi.1005540.ref028">28</xref>, <xref ref-type="bibr" rid="pcbi.1005540.ref029">29</xref>]. Because the spectral content of electrophysiological measurements is almost always broadband, when there is an interest in oscillations, it makes sense to isolate these oscillations from the other components of the measured time series. The resulting procedure involves a separation of the oscillatory components of interest from the interfering non-rhythmic components. In the GP-based decomposition framework, this separation can be achieved by modeling both the oscillatory component <italic>φ</italic>(<italic>t</italic>) and the interfering processes. We use the symbol <bold><italic>m</italic></bold><sub><italic>φ</italic>|<italic>y</italic></sub> for the marginal expectation of the process <italic>φ</italic>(<italic>t</italic>) at the sample points. The average amplitude can be obtained from <bold><italic>m</italic></bold><sub><italic>φ</italic>|<italic>y</italic></sub> by calculating its root mean square deviation:
<disp-formula id="pcbi.1005540.e011"><alternatives><graphic id="pcbi.1005540.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e011" xlink:type="simple"/><mml:math display="block" id="M11"><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfrac><mml:mstyle displaystyle="true"><mml:msub><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>φ</mml:mi><mml:mo>|</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mi>m</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mstyle></mml:mrow></mml:msqrt></mml:math>
</alternatives> <label>(4)</label></disp-formula>
with <inline-formula id="pcbi.1005540.e012"><alternatives><graphic id="pcbi.1005540.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e012" xlink:type="simple"/><mml:math display="inline" id="M12"><mml:mrow><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>N</mml:mi></mml:mfrac> <mml:msub><mml:mo>Σ</mml:mo> <mml:mi>i</mml:mi></mml:msub> <mml:msub><mml:mrow><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">m</mml:mi> <mml:mrow><mml:mi>φ</mml:mi> <mml:mo>|</mml:mo> <mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow> <mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p>Here, we compared the sensitivity of the GP method with DPSS multitaper spectral estimation [<xref ref-type="bibr" rid="pcbi.1005540.ref030">30</xref>], a widely used non-parametric technique. In the simulation study, the methods had to estimate a simulated experimental modulation of the amplitude of a 10 Hz oscillatory process. For each of two conditions, we generated oscillatory time series from a non-Gaussian oscillatory process. The oscillatory time series was then corrupted by Ornstein–Uhlenbeck (OU) noise and white noise. The simulation design involved 16 levels that covered an amplitude modulation range from 15% to 60% in equidistant steps. For each level, per experimental condition, we generated 150,000 trials of 2 s. The effect size was defined as follows:
<disp-formula id="pcbi.1005540.e013"><alternatives><graphic id="pcbi.1005540.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e013" xlink:type="simple"/><mml:math display="block" id="M13"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>f</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mrow><mml:mo>⟨</mml:mo> <mml:msub><mml:mi>A</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>⟩</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mrow><mml:mo>⟨</mml:mo> <mml:msub><mml:mi>A</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>⟩</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mtext>var</mml:mtext> <mml:mo>(</mml:mo> <mml:mi>A</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:mspace width="0.166667em"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(5)</label></disp-formula>
where 〈<italic>A</italic><sub><italic>j</italic></sub>〉 is the mean oscillatory amplitude in the j-th experimental condition and var (<italic>A</italic>) is its variance. Mean and variance were calculated over the trials.</p>
<p>The GP method does not have free parameters, since the parameters of the covariance functions are estimated from the data. In contrast, the spectral smoothing of a multitaper analysis is determined by the number of tapers, which is a parameter that can be chosen freely. We selected the number of tapers that maximizes the effect size in order not to bias the evaluation in favor of the GP method. In addition, we reported the effect sizes for the multitaper analysis with a fixed smoothing of 0.6 Hz. <xref ref-type="fig" rid="pcbi.1005540.g004">Fig 4A</xref> shows the effect sizes for the GP and the multitaper method as a function of the true between-condition amplitude difference. The Gaussian process consistently outperforms the non-parametric method. <xref ref-type="fig" rid="pcbi.1005540.g004">Fig 4B</xref> shows the ratio between the GP and the optimal multitaper effect size as a function of the true amplitude difference. Here, we can see that the superior performance is more pronounced when the amplitude difference is smaller, corresponding to a situation with a lower signal-to-noise ratio.</p>
<fig id="pcbi.1005540.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005540.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Simulation results on the estimation of modulations in oscillatory amplitude.</title>
<p>A) Effect size of temporal GP and DPSS multitaper spectral analysis as function of mean percentage amplitude difference between simulated conditions. The parameters of the temporal GP-based decomposition (blue line) were estimated from the raw simulated time series. The spectral smoothing of the multitaper method (green line) was chosen for each to maximize the effect size. The red line is the effect size for a multitaper method with constant spectral smoothing of 0.6 Hz. B) Effect size ratio between temporal GP and (optimized) multitaper method as function of the mean amplitude difference between conditions.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005540.g004" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec013">
<title>Localizing the source of an oscillatory amplitude modulation</title>
<p>We now investigate how SGPD compares to a state-of-the-art existing methods with respect to the spatial localization of an oscillatory amplitude modulation in the presence of noise sources with both spatial and temporal structure. We compare our method to the Harmony source reconstruction technique [<xref ref-type="bibr" rid="pcbi.1005540.ref016">16</xref>], which has been shown to outperform several commonly used linear source reconstruction methods. For this, we set up a simulation study in which the performance was evaluated by the extent to which a spatially focal amplitude modulation could be detected.</p>
<p>We modeled the brain activity as generated by three cortical patches, each with a constant spatial profile and a time course generated in the same way as in the single sensor simulation. The patches had a radius of approximately one centimeter and were localized in the right temporal, right occipital, and left parietal cortex (<xref ref-type="fig" rid="pcbi.1005540.g005">Fig 5A</xref>). All three patches exhibited oscillatory activity, but the one in the right temporal lobe had an amplitude that was modulated by the simulated conditions. The source activity was projected to the sensors by a forward model that was obtained using a realistic head model [<xref ref-type="bibr" rid="pcbi.1005540.ref031">31</xref>]. The sensor level activity for the first trial is shown in <xref ref-type="fig" rid="pcbi.1005540.g005">Fig 5B</xref>. The regularization parameter l of both Harmony and SGPD were identified using leave-one-out cross validation [<xref ref-type="bibr" rid="pcbi.1005540.ref032">32</xref>], while the smoothing parameter <italic>υ</italic> was set by hand and had the same value of 3 in both models. The spectral smoothing of the DPSS multitaper spectral estimation was set to 0.6 Hz. The value was chosen because, on average, this gave the highest effect size of the amplitude modulation.</p>
<fig id="pcbi.1005540.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005540.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Simulation results on localizing the source of an oscillatory amplitude modulation.</title>
<p>A) Spatial maps of the simulated brain sources. The left map shows the spatial extent of the amplitude-modulated source while the two right maps show the interfering sources. The dipole orientation was set to be orthogonal to the mesh surface. B) Visualization of sensor activity as a mixing of the three sources. The dots represent MEG sensors. The color of the dots show the sign (red for positive and blue for negative) together with the magnitudes. The time series was taken from an occipital sensor. C) Scatter plot of the accuracy of SGPD and Harmony. The index was computed by dividing the total reconstructed effect within the amplitude-modulated cortical patch by the sum of total effects in the non-modulated patches. D) Scatter plot of the sharpness of SGPD and Harmony. The sharpness index was obtained by dividing the total reconstructed effect within the amplitude-modulated cortical patch by the total effect elsewhere. For the purpose of visualization, in both scatterplots, we excluded some outliers (&gt; 5 × median). These outliers arise when the denominator of one of the indices becomes too small. The outliers have been removed from the figure but they were involved in the calculation of the medians for the two methods.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005540.g005" xlink:type="simple"/>
</fig>
<p>We assessed the quality of the reconstructed effects using two indices, one for accuracy and one for sharpness. The accuracy index is obtained by dividing the estimated effect in the center of the amplitude-modulated patch (more specifically, the sum over the points in a sphere with 1 cm radius) by the maximum of the estimated effects in the centers of the other two patches (again, by summing over the points in a sphere). The accuracy index will be high if it localizes the effect in the right patch but not in the interfering ones. The sharpness index evaluates how much the effect maps are focused around the center of the effect. It is computed by dividing the summed estimated effect in the center of the amplitude-modulated patch by the summed estimated effect outside that region. <xref ref-type="fig" rid="pcbi.1005540.g005">Fig 5C &amp; 5D</xref> show the results of the simulation. Each disc in the scatter plot represents the outcome of SGPD and Harmony for a single simulation. The median accuracy and sharpness were respectively 33% and 28% higher for SGPD as compared to the Harmony approach.</p>
</sec>
</sec>
<sec id="sec014">
<title>Gaussian process analysis of example MEG data</title>
<p>We tested the temporal GP-based decomposition on an example MEG dataset that was collected from 14 participants that performed a somatosensory attention experiment [<xref ref-type="bibr" rid="pcbi.1005540.ref033">33</xref>]. We will use this dataset for different purposes, and start by using it for evaluating the performance of our parameter estimation algorithm. <xref ref-type="fig" rid="pcbi.1005540.g006">Fig 6</xref> shows the empirical auto-covariance functions and the least squares fit for two participants. To make them comparable, we normalized these auto-covariance functions by dividing them by their variance. The fitted auto-covariance functions capture most features of the observed auto-covariance functions. The comparison shows some individual differences: First, Participant 1 has a higher amplitude alpha signal relative to the other dynamic components, but the correlation peaks are separated only by about three cycles. Second, the auto-covariance of Participant 2 is dominated more by a signal component with a high temporal correlation for nearby points, and the rhythmic alpha component decays much more slowly. The latter is a signature of a longer phase preservation.</p>
<fig id="pcbi.1005540.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005540.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Estimation of the model covariance functions.</title>
<p>Parametric fit of the MEG auto-covariance functions of Participant 1 and Participant 2. The red lines refer to the estimated parametric model and the blue lines reflect the empirical auto-covariance of the measured time series. A single auto-covariance was obtained from the multi-sensor data by performing a principal component analysis and averaging the empirical auto-covariance of the first 50 components, weighted by their variance. The parameters of the model were estimated using a least-squares simulated annealing optimization method. The graphs have been scaled between 0 and 1 by dividing them by the maximum of the individual empirical auto-covariance.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005540.g006" xlink:type="simple"/>
</fig>
<p>We quantified the goodness-of-fit as the normalized total absolute deviation from the model:
<disp-formula id="pcbi.1005540.e014"><alternatives><graphic id="pcbi.1005540.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e014" xlink:type="simple"/><mml:math display="block" id="M14"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>g</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>|</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:mi>k</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>|</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msub><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>|</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:mspace width="0.166667em"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(6)</label></disp-formula>
where <italic>c</italic><sub><italic>ij</italic></sub> is the empirical auto-covariance between <inline-formula id="pcbi.1005540.e015"><alternatives><graphic id="pcbi.1005540.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e015" xlink:type="simple"/><mml:math display="inline" id="M15"><mml:mrow><mml:msub><mml:mi>y</mml:mi> <mml:mrow> <mml:msub><mml:mi>t</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow>
</mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005540.e016"><alternatives><graphic id="pcbi.1005540.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e016" xlink:type="simple"/><mml:math display="inline" id="M16"><mml:mrow><mml:msub><mml:mi>y</mml:mi> <mml:mrow> <mml:msub><mml:mi>t</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow>
</mml:math></alternatives></inline-formula>, and <italic>k</italic>(<italic>t</italic><sub><italic>i</italic></sub>, <italic>t</italic><sub><italic>j</italic></sub>) is the auto-covariance predicted by our dynamical model. We evaluated the goodness-of-fit by computing this deviation measure for each participant. The median goodness-of-fit was 0.06, meaning that the median deviation from the empirical auto-covariance was only 6% of the sum of its absolute values. The goodness-of-fit for the two example participants one and two in <xref ref-type="fig" rid="pcbi.1005540.g006">Fig 6</xref> are 0.04 and 0.02, respectively.</p>
<p>Next, we inspect the reconstructed spatiotemporal dynamic components obtained from the resting state MEG signal of Participant 1 (with auto-covariance as shown in <xref ref-type="fig" rid="pcbi.1005540.g006">Fig 6A</xref>), as obtained by SGPD. <xref ref-type="fig" rid="pcbi.1005540.g007">Fig 7A</xref> shows an example of time courses of the dynamic components for an arbitrarily chosen cortical vertex situated in the right parietal cortex. The first order integrator time series (upper-left panel) tends to be slow-varying but also exhibits some fast transitions. The second order integrator (lower-left panel) is equally slow but smoother. In this participant, the alpha oscillations, as captured by the damped harmonic oscillator, are quite irregular (upper-right panel), and this is in agreement with its covariance function (see <xref ref-type="fig" rid="pcbi.1005540.g006">Fig 6A</xref>). Finally, the residuals (lower-right panel) are very irregular, as is expected from the signal’s short-lived temporal correlations. <xref ref-type="fig" rid="pcbi.1005540.g007">Fig 7B</xref> shows an example of the spatiotemporal evolution of alpha oscillations for a period of 32 milliseconds in a resting-state MEG signal. For the purpose of visualization, we only show the value of the dipole along an arbitrary axis. The pattern in the left hemisphere has a wavefront that propagates through the parietal cortex. Conversely, the alpha signal in the right hemisphere is more stationary.</p>
<fig id="pcbi.1005540.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005540.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Estimated dynamic components.</title>
<p>Reconstructed source-level neural activity of Participant 1. A) Reconstructed time series of the four dynamic processes localized in a right parietal cortical vertex. B) Reconstructed spatiotemporal dynamics of alpha oscillations along the <italic>x</italic> axis. This choice of axis is arbitrary and has been chosen solely for visualization purposes. The source-reconstructed activity has been normalized by dividing it by the maximum of the absolute of the spatiotemporal signal.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005540.g007" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec015">
<title>Attention-induced spatiotemporal dynamics of oscillatory amplitude</title>
<p>Next, we applied the SGPD source reconstruction method to the example MEG data that were collected in a cued tactile detection experiment. Identifying the neurophysiological mechanisms underlying attentional orienting is an active area of investigation in cognitive neuroscience [<xref ref-type="bibr" rid="pcbi.1005540.ref008">8</xref>, <xref ref-type="bibr" rid="pcbi.1005540.ref028">28</xref>, <xref ref-type="bibr" rid="pcbi.1005540.ref033">33</xref>, <xref ref-type="bibr" rid="pcbi.1005540.ref034">34</xref>]. Such mechanisms could involve neural activity of which the spatial distribution varies over time (i.e., neural activity with dynamic spatial patterns), and GP source reconstruction turns out to be highly suited for identifying such activity, as we will demonstrate now.</p>
<p>In the cued tactile detection experiment an auditory stimulus (high or low pitch pure tone) cued the location (left or right hand) of a near-threshold tactile stimulus in one-third of the trials. This cue was presented 1.5 s before the target. The remaining two-thirds of the trials were uncued. In the following, we compare the pre-target interval between the cued and the uncued conditions in terms of how the alpha amplitude modulation develops over time. In the analysis, we made use of the fact that the experiment involved two recording sessions, separated by a break. We explored the data of the first session in search for some pattern, and then used the data of the second session to statistically test for the presence of this pattern. Thus, the spatiotemporal details of the null hypothesis of this statistical test were determined by the data of the first session, and we used the data of the second session to test it.</p>
<p>
<xref ref-type="fig" rid="pcbi.1005540.g008">Fig 8A</xref> shows the group-averaged alpha amplitude modulation as a function of time. An amplitude suppression for the cued relative to the uncued condition originates bilaterally in the parietal cortex and gradually progresses caudal to rostral until it reaches the sensorimotor cortices. The time axes are expressed in terms of the distance to the target. Similar patterns can be seen in individual participants (see <xref ref-type="fig" rid="pcbi.1005540.g008">Fig 8B &amp; 8C</xref> for representative participants 1 and 2). Participant 1 has a suppressive profile that is almost indistinguishable from the group average. On the other hand, participant 2 shows an early enhancement of sensorimotor alpha power accompanied by a parietal suppression, and the latter then propagates forward until it reaches the sensorimotor areas. Thus, in the grand average and in most of the participants, there is a clear caudal-to-rostral progression in the attention-induced alpha amplitude suppression. We characterized this progression by constructing cortical maps of the linear dependence (slope) between latency and amplitude modulation. The group average of the slope maps for the first session is shown in <xref ref-type="fig" rid="pcbi.1005540.g008">Fig 8D</xref>. This figure shows that the posterior part of the brain has positive slopes, reflecting the fact that the effect tended to become less negative over time. Conversely, the sensorimotor regions have positive slopes, reflecting the fact that the effect tended to become more negative over time.</p>
<fig id="pcbi.1005540.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005540.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Caudal-to-rostral progression of alpha amplitude attentional modulation.</title>
<p>A) Group average of alpha amplitude attentional modulation as function of time. B,C) Alpha amplitude attentional modulation for participants 1 and 2, respectively. D) Spatial map obtained by computing the slope of the average alpha difference between cued and non-cued conditions as a function of time for each cortical vertex.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005540.g008" xlink:type="simple"/>
</fig>
<p>To evaluate the reliability of this pattern, we build on the reasoning that, if this pattern in the slope map is due to chance, then it must be uncorrelated with the slope map for the second session. To evaluate this, for every participant, we calculated the dot product between the normalized slope maps for the two sessions and tested whether the average dot product was different from zero.</p>
<p>The one-sample t-test showed that the effect was significantly different from zero (<italic>p</italic> &lt; 0.05), supporting the claim that the caudal-to-rostral progression in the attention-induced alpha amplitude suppression is genuine. Thus, we have shown that, during the attentional preparation following the cue, the alpha modulation progresses from the parietal to the sensorimotor cortex.</p>
</sec>
</sec>
<sec id="sec016" sec-type="conclusions">
<title>Discussion</title>
<p>In this paper, we introduced a new signal decomposition technique that incorporates explicit dynamical models of neural activity. We showed how dynamical models can be constructed and integrated into a Bayesian statistical analysis framework based on GP regression. The resulting statistical model can be used for decomposing the measured time series into a set of temporal or spatiotemporal dynamic components that reflect different aspects of the neural signal. A spatiotemporal version of the decomposition method was obtained by decomposing the spatial configuration of cortical neural signals in spherical harmonics.</p>
<p>We validated our method using simulations and real MEG data. We performed three simulation studies in which we demonstrated the superior performance of our method for three different applications: the recovery of a component from a complex neural signal, the estimation of a modulation in oscillatory amplitude, and the localization of the source of an oscillatory amplitude modulation. For the first application, we showed that, under a broad range of conditions, our method provided a more accurate recovery than four popular signal decomposition methods: ICA, PCA, EMD and SSA. For the second application, we demonstrated that our method can be used for quantifying changes in oscillatory amplitude between experimental conditions. We showed that, when the oscillatory signal is corrupted by temporally structured noise, our method improves on multitaper non-parametric spectral estimation. Finally, for the third application, we demonstrated that SGPD leads to sharp and precise localization of dynamic components on the cortical surface. In particular, we showed that, in the presence of spatially and temporally structured noise, SGDP localizes amplitude modulations more accurately than Harmony, a related method that does not make use of the temporal decomposition of the signal of interest [<xref ref-type="bibr" rid="pcbi.1005540.ref016">16</xref>]. Lastly, using the spatiotemporal decomposition on real MEG data from a somatosensory detection task, we demonstrated its usefulness by identifying an intriguing anterior-to-posterior propagation in the attention-induced suppression of oscillatory alpha power.</p>
<sec id="sec017">
<title>Generality, limitations, and robustness</title>
<p>Although we used a specific set of SDEs, the method is fully general in that it can be applied to any linearized model of neuronal activity. Therefore, it establishes a valuable connection between data analysis and theoretical modeling of neural phenomena. For example, neural masses models and neural field equations (see, e.g. [<xref ref-type="bibr" rid="pcbi.1005540.ref035">35</xref>]) can be linearized around their fixed points and the resulting SDEs form the basis for a GP analysis that extracts the theoretically defined components. Furthermore, the GP-based decomposition could be used as an analytically solvable starting point for the statistical analysis of non-linear and non-Gaussian phenomena through methods such as perturbative expansion, where the initial linear Gaussian model is corrected by non-linear terms that come from the Taylor expansion of the non-linear couplings between the neural activity at different spatiotemporal points [<xref ref-type="bibr" rid="pcbi.1005540.ref036">36</xref>].</p>
<p>The method’s limitations pertain to the model’s prior assumptions. Our prior model is based on linear stochastic differential equations that cannot account for the complex non-linear effects that are found in both experimental [<xref ref-type="bibr" rid="pcbi.1005540.ref037">37</xref>, <xref ref-type="bibr" rid="pcbi.1005540.ref038">38</xref>] and modeling work [<xref ref-type="bibr" rid="pcbi.1005540.ref039">39</xref>–<xref ref-type="bibr" rid="pcbi.1005540.ref041">41</xref>]. In addition, our prior model assumes a homegeneous spatial correlation structure that solely depends on the distance between cortical locations. Clearly, this correlation struction does not account for the rich connectivity structure of the brain [<xref ref-type="bibr" rid="pcbi.1005540.ref042">42</xref>–<xref ref-type="bibr" rid="pcbi.1005540.ref045">45</xref>]. Nevertheless, the method has some robustness against the violations of the underlying assumptions. This robustness follows from the fact that the model specifies the prior distribution but does not constrain the marginal expectations to have a specific parametric form. The temporal prior affects the estimation of a dynamic component to a degree that depends on the ratio between its variance and the cumulative variance of all other components. Specifically, the smaller the prior variance of a component relative to the combined variance of all the others, the more the pattern in the prior covariance matrix will affect the posterior. Since we estimate all these prior variances directly from the measured time series, our method is able to reconstruct complex non-linear effects in components that have a relatively high SNR while it tends to “linearize” components with low SNR. As a consequence, the more pronounced the non-linear effects in the observed signal, the more these will be reflected in the posterior, gradually dominating the linear structure imposed by the prior. Importantly, because our temporal prior is based on a larger data set, it will be adequate, on average, over all epochs while still allowing strong components in individual epochs to dominate the results.</p>
<p>The situation is similar but not identical for our spatial prior. Contrary to our temporal prior, this spatial prior is not derived from an empirically fitted dynamical model but on the basis of our prior belief that source configurations with high spatial frequencies are unlikely to be reliably estimated from MEG measurements. Since the problem of reconstructing source activity from MEG measurements is generally ill-posed, the choice of the spatial prior will bias the inference even for very high SNR. Nevertheless, it has been shown that the discounting of high spatial frequencies leads to reduced localization error and more interpretable results [<xref ref-type="bibr" rid="pcbi.1005540.ref016">16</xref>].</p>
</sec>
<sec id="sec018">
<title>Connections with other methods</title>
<p>The ideas behind the GP-based decomposition derive from a series of recent developments in machine learning, connecting GP regression to stochastic dynamics [<xref ref-type="bibr" rid="pcbi.1005540.ref046">46</xref>, <xref ref-type="bibr" rid="pcbi.1005540.ref047">47</xref>]. The approach is closely connected with many methods in several areas of statistical data-analysis such as signal decomposition, blind source separation, spectral analysis and source reconstruction. We will now review some of these links, focusing on methods that are commonly used in neuroscience.</p>
<sec id="sec019">
<title>Signal decomposition</title>
<p>In the neuroscience literature, the most widely used signal decomposition techniques are a class of methods known as <italic>blind source separation</italic>. The two best known members of this class are PCA and ICA, which have been extended in several different ways [<xref ref-type="bibr" rid="pcbi.1005540.ref011">11</xref>, <xref ref-type="bibr" rid="pcbi.1005540.ref012">12</xref>, <xref ref-type="bibr" rid="pcbi.1005540.ref048">48</xref>–<xref ref-type="bibr" rid="pcbi.1005540.ref052">52</xref>]. ICA and PCA rely on the statistical properties of multi-sensor data (maximum variance for PCA and statistical independence for ICA) and produce components whose associated signals are linear combinations of the sensor-level signals. The main difference between PCA and ICA is that the former only relies on second order statistics (correlations between sensors) while the latter exploits higher order statistics such as skewness and kurtosis.</p>
<p>Whereas GP-based decomposition depends on a specific model of the neural signal, neither PCA nor ICA makes use of prior knowledge of the component-level signals. Furthermore, both PCA and ICA require matrix-valued time series data, whereas GP-based decomposition can be applied to a single univariate time series. It is important to note that GP-based decomposition is not a tool for separating statistically independent or uncorrelated components. Instead, its goal is to decompose the measured signal into several processes characterized by different autocorrelation structures. Hence, the method does not discriminate between two independent processes generated by two sources with the same dynamics, such as a frontal and an occipital alpha oscillation. Therefore, the GP-based decomposition is complementary to blind source separation. In fact, the latter can be used to extract interesting temporal and spatiotemporal patterns from the dynamic components obtained from GP-based decomposition.</p>
<p>There also exists a class of signal separation methods that <italic>can</italic> be applied to a single univariate time series. Two members of this class are EMD [<xref ref-type="bibr" rid="pcbi.1005540.ref025">25</xref>] and SSA [<xref ref-type="bibr" rid="pcbi.1005540.ref026">26</xref>]. The aim of EMD is to identify meaningful components from a mixed signal without resorting to formal assumptions about these components or an explicit set of basis functions [<xref ref-type="bibr" rid="pcbi.1005540.ref025">25</xref>]. The components extracted using EMD are referred to as <italic>intrinsic mode functions</italic> (IMF). The absence of formal assumptions does not imply that the method is not biased towards a particular type of component. In fact, by identifying local peaks and troughs, the EMD algorithm effectively searches for oscillatory components. SSA is based on the singular value decomposition (SVD) of the so called trajectory matrix, whose columns are time-lagged copies of the original time-series [<xref ref-type="bibr" rid="pcbi.1005540.ref026">26</xref>]. The singular vectors of the trajectory matrix are often denoted as <italic>empirical orthogonal functions</italic> and can be seen as a set of temporal signal components. The components extracted using SSA solely depend on the temporal autocorrelation of the time series. Therefore, SSA only uses second order statistics. The main difference between GP-based decomposition and the blind decomposition methods SSA and EMD is that the former makes explicit formal assumptions about the temporal structure in the components in its prior distribution. Specifically, the GP-based decomposition assumes a prior model that is linear and stationary while both EMD and SSA do not assume neither the stationary nor the linearity of the process that generated the components. Although GP-decomposition requires an initial modeling effort, which is not required by SSA and EMD, this effort pays off in the simpler interpretation and comparability of the resulting dynamic components. In fact, the components obtained through SSA and EMD are not labeled and their number is not constant. Consequently, components obtained from different trials/participants are not directly comparable.</p>
<p>So far, we have only discussed alternative decomposition methods that exploit either the temporal or the spatial features of the data. Truly spatiotemporal signal components can be obtained with a straightforward multivariate generalization of SSA, often denoted as multivariate SSA (M-SSA) [<xref ref-type="bibr" rid="pcbi.1005540.ref053">53</xref>]. M-SSA components can be obtained as eigenvectors of the lagged cross-covariance matrix. Since this eigendecomposition scales quadratically with the product between maximal time lag and number of spatial points, it is difficult to apply this method to large spatiotemporal arrays. Another widely used and intrinsically spatiotemporal decomposition approach is dynamic mode decomposition (DMD) [<xref ref-type="bibr" rid="pcbi.1005540.ref054">54</xref>]. This method assumes that the spatial pattern at each time point is a linear combination of the spatial pattern at the previous time point. The method involves a state transition matrix, which is usually assumed to be constant during the analyzed epoch. Signal components, also called <italic>dynamical modes</italic>, are obtained by eigendecomposition of the state transition matrix. Similar to EMD and (M-)SSA, DMD does not uses a separate dynamical model of each component and, consequently, the resulting dynamical modes do not have natural labels.</p>
<p>The characteristics of the different signal decomposition methods are summarized in <xref ref-type="table" rid="pcbi.1005540.t001">Table 1</xref>.</p>
<table-wrap id="pcbi.1005540.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005540.t001</object-id>
<label>Table 1</label>
<caption>
<title>Comparison of signal decomposition methods.</title>
</caption>
<alternatives>
<graphic id="pcbi.1005540.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005540.t001" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left"/>
<th align="left">GP</th>
<th align="left">PCA</th>
<th align="left">ICA</th>
<th align="left">EMD</th>
<th align="left">(M-)SSA</th>
<th align="left">DMD</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Produces labeled components</td>
<td align="left">yes</td>
<td align="left">no</td>
<td align="left">no</td>
<td align="left">no</td>
<td align="left">no</td>
<td align="left">no</td>
</tr>
<tr>
<td align="left">Can work on single sensor data</td>
<td align="left">yes</td>
<td align="left">no</td>
<td align="left">no</td>
<td align="left">yes</td>
<td align="left">yes</td>
<td align="left">yes</td>
</tr>
<tr>
<td align="left">Combines multiple sensors</td>
<td align="left">yes</td>
<td align="left">yes</td>
<td align="left">yes</td>
<td align="left">no</td>
<td align="left">yes</td>
<td align="left">yes</td>
</tr>
<tr>
<td align="left">Combines multiple time points</td>
<td align="left">yes</td>
<td align="left">no</td>
<td align="left">no</td>
<td align="left">yes</td>
<td align="left">yes</td>
<td align="left">yes</td>
</tr>
<tr>
<td align="left">Assumes stationarity and linearity of the time series</td>
<td align="left">yes</td>
<td align="left">no</td>
<td align="left">no</td>
<td align="left">no</td>
<td align="left">no</td>
<td align="left">yes</td>
</tr>
<tr>
<td align="left">Only uses second order statistics</td>
<td align="left">yes</td>
<td align="left">yes</td>
<td align="left">no</td>
<td align="left">no</td>
<td align="left">yes</td>
<td align="left">yes</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>From an applications point of view, the most relevant aspect of a signal decomposition method is its recovery of a signal component that is mixed with other components in the observed signal. In simulations that involved signal components with different temporal autocorrelation structures, we showed that that the goodness-of-recovery of our GP-based decomposition was superior to PCA, ICA, EMD and SSA. Importantly, this superiority was maintained across different levels of spatial and spectral overlap between signal and noise.</p>
</sec>
<sec id="sec020">
<title>Spectral analysis</title>
<p>In the Results, we have demonstrated that the GP-based decomposition can be profitably used to estimate amplitude modulations in an oscillatory signal, which is an important application of spectral analysis. There are two classes of spectral analysis methods: parametric and non-parametric [<xref ref-type="bibr" rid="pcbi.1005540.ref030">30</xref>]. Non-parametric methods mostly rely on the discrete Fourier transform applied to a tapered signal, as for example in DPSS multitaper spectral estimation [<xref ref-type="bibr" rid="pcbi.1005540.ref030">30</xref>, <xref ref-type="bibr" rid="pcbi.1005540.ref055">55</xref>]. These methods are non-parametric because they do not explicitly model the process that generates the signal.</p>
<p>Parametric methods <italic>do</italic> depend on an explicit model, and typically this is an autoregressive (AR) model [<xref ref-type="bibr" rid="pcbi.1005540.ref056">56</xref>, <xref ref-type="bibr" rid="pcbi.1005540.ref057">57</xref>]. AR models are closely related to GPs as they are typically formulated as discrete-time Gaussian processes driven by stochastic <italic>difference</italic> equations. In this sense, the GP prior distributions are continuous-time versions of an AR process. However, the usual AR approach to spectral estimation differs from our approach. AR models are usually parametrized in terms of a series of model coefficients that determine the statistical dependencies between the present value of a signal and its past values. These model coefficients are related to the inverse of the impulse response function in our approach (see <xref ref-type="sec" rid="sec025">Materials and methods</xref> for a description of the impulse response function). Spectral analysis based on AR models has the disadvantage that one has to estimate a very large number of parameters. This flexibility in the analytic form of the AR model is required as the spectrum is obtained from the model coefficients. Compared to AR modeling, the GP-based decomposition model is much more constrained by the underlying theory, having an explicit additive structure with few parameters for each dynamic component. Specifically, the additive structure allows to isolate the spectrum of a component of the signal from other nuisance components (e.g. the spectrum of an oscillation from the background pink noise). The rigidity of the model is compensated by the fact that the oscillatory amplitude is not obtained from the fitted model covariance function. Instead, it is computed from the marginal expectation of the oscillatory component, which is obtained by applying Bayes’ rule.</p>
<p>In our simulation study, we compared the temporal GP-based decomposition to DPSS multitaper spectral estimation. We showed that, when the oscillatory signal of interest is corrupted by temporally structured noise, our method gives better quantification of changes in oscillatory amplitude. The superiority of our method is probably explained by its ability to learn the features of the signal and the noise from the data.</p>
</sec>
<sec id="sec021">
<title>Source reconstruction</title>
<p>A general framework for GP source analysis has recently been introduced [<xref ref-type="bibr" rid="pcbi.1005540.ref017">17</xref>]. In this work, the authors show that several well-known source reconstruction methods are special cases of GP regression with appropriate covariance functions. In particular, the spatial filter of techniques such as minimum norm estimation [<xref ref-type="bibr" rid="pcbi.1005540.ref013">13</xref>] and exact Loreta [<xref ref-type="bibr" rid="pcbi.1005540.ref014">14</xref>] are obtained as a discretization of a spatial GP analysis with an appropriate spatial covariance function. The authors also introduced a general framework for GP spatiotemporal analysis using separable covariance functions designed to localize averaged neural activity (e.g. evoked fields). This GP spatiotemporal source reconstruction is formally similar to several other spatiotemporal source reconstruction methods [<xref ref-type="bibr" rid="pcbi.1005540.ref058">58</xref>–<xref ref-type="bibr" rid="pcbi.1005540.ref061">61</xref>].</p>
<p>Our approach improves on this work by introducing informed temporal covariance functions that explicitly model the temporal dynamics of the ongoing neural signal. The additive structure of the temporal covariance function allows to individually source localize signal components with different dynamic properties. The spatial configuration of these components are analyzed in the spherical harmonics domain, as this greatly reduces the dimensionality of the source space. As shown in the Materials and Methods section, the resulting spatial filter is closely related to the Harmony source reconstruction method [<xref ref-type="bibr" rid="pcbi.1005540.ref016">16</xref>]. However, despite this similarity in spatial filters, our simulation study shows that SGPD leads to more accurate source reconstructions than spatial localization alone.</p>
</sec>
</sec>
<sec id="sec022">
<title>Benefits of GP-based decomposition for cognitive neuroscience</title>
<p>In our simulation studies, we demonstrated the superior performance of GP-based decomposition for three different applications: the recovery of a component from a complex neural signal, the estimation of a modulation in oscillatory amplitude, and the localization of the source of an oscillatory amplitude modulation. In addition, this method is also particularly suited for data-driven exploration of complex spatiotemporal data as it decomposes the signal into a series of more interpretable dynamic components. As a demostration of this, we used the SGPD to investigate the modulation of alpha oscillations associated with attentional preparation to a tactile stimulus. Several previous works demonstrated that alpha amplitude is reduced prior to a predicted stimulus [<xref ref-type="bibr" rid="pcbi.1005540.ref028">28</xref>, <xref ref-type="bibr" rid="pcbi.1005540.ref033">33</xref>, <xref ref-type="bibr" rid="pcbi.1005540.ref034">34</xref>]. These amplitude modulations have been associated to modality specific preparatory regulations of the sensory cortices [<xref ref-type="bibr" rid="pcbi.1005540.ref007">7</xref>, <xref ref-type="bibr" rid="pcbi.1005540.ref034">34</xref>, <xref ref-type="bibr" rid="pcbi.1005540.ref062">62</xref>–<xref ref-type="bibr" rid="pcbi.1005540.ref064">64</xref>]. While the attentional role of alpha oscillations in the primary sensory cortices is well established, it is still unclear how this generalizes to supramodal areas. Although the parietal cortex is known to play a role in the top-down control of attention [<xref ref-type="bibr" rid="pcbi.1005540.ref065">65</xref>, <xref ref-type="bibr" rid="pcbi.1005540.ref066">66</xref>], parietal alpha oscillations have typically been considered as closely related to the visual system [<xref ref-type="bibr" rid="pcbi.1005540.ref028">28</xref>].</p>
<p>The involvement of the parietal cortex in the somatosensory detection task went unnoticed in the first analysis of the data that have been reanalyzed in the present paper [<xref ref-type="bibr" rid="pcbi.1005540.ref033">33</xref>]. In our new analysis, we used the SGPD to more effectively explore the data, looking for interesting spatiotemporal effects. This led to the identification of a suppression of alpha amplitude that originates from the parietal cortex and then propagates to the somatosensory regions. This effect turned out to be statistically robust when tested in a second independent dataset that was collected in the same experiment. The results suggest a hierarchical organization of the reconfiguration of alpha amplitude following an attentional cue. In particular, the initial reduction of parietal alpha amplitude could reflect the activation of a supramodal attentional network that paves the way for later sensorimotor-specific cortical reconfiguration.</p>
<p>While we mainly restricted our attention to the analysis of alpha oscillations, we believe that the GP-based decomposition can be useful for the study of other neural oscillations as well as non-rhythmic components. Several experimental tasks are related to effects in multiple dynamic components. For example, perception of naturalistic videos induces modulations in several frequency bands [<xref ref-type="bibr" rid="pcbi.1005540.ref067">67</xref>]. Studying the interplay between these differential modulations requires an appropriate decomposition of the measured signals that can be effectively performed using GP-based decomposition.</p>
</sec>
<sec id="sec023">
<title>Computational efficiency</title>
<p>The time complexity of SGPD is separately cubic in the number of time points <italic>M</italic> and and in the number of sensors <italic>N</italic>. In fact, the method involves the inversion of both the spatial covariance matrix (<italic>N</italic> × <italic>N</italic>) and the temporal covariance matrix (<italic>M</italic> × <italic>M</italic>) (see Eqs <xref ref-type="disp-formula" rid="pcbi.1005540.e084">37</xref> and <xref ref-type="disp-formula" rid="pcbi.1005540.e085">38</xref> in the <xref ref-type="sec" rid="sec025">Methods</xref>). For MEG or EEG applications, the inversion of the spatial covariance matrix is not problematic as the number of sensors is rarely much larger than 300. In several neuroscience applications, the data are analyzed in short trials and the cubic complexity in the number of time points (tipically ranging from 300 to 1000) is not particularly problematic either. However, this complexity could be prohibitive when analyzing long continuous signals. Fortunately, several approximate and exact methods have been introduced for reducing the complexity of GP regression to quadratic or even linear in the number of time points (see for example [<xref ref-type="bibr" rid="pcbi.1005540.ref046">46</xref>, <xref ref-type="bibr" rid="pcbi.1005540.ref068">68</xref>, <xref ref-type="bibr" rid="pcbi.1005540.ref069">69</xref>]). For example, the GP regression can be transformed into an infinite-dimensional version of the Kalman smoother that has linear complexity in the number of time points [<xref ref-type="bibr" rid="pcbi.1005540.ref046">46</xref>]. Finally, in terms of memory requirements, working in the spherical harmonic domain is convenient as the number of required harmonics is often an order of magnitude smaller than the number of source points in the cortical mesh.</p>
</sec>
<sec id="sec024">
<title>Conclusions</title>
<p>Our dynamic decomposition method starts from a precise mathematical model of the dynamics of the neural fields. The formalism of GP regression allows translation of linear stochastic dynamics into a well-defined Bayesian prior distribution. In this way, the method establishes a connection between mathematical modeling and data analysis of neural phenomena. On the one hand, the experimentalist and the data-analyst can benefit from the method as it allows to isolate the dynamic components of interest from the interfering noise. These components are interpretable and visualizable, and their study can lead to the identification of new temporal and spatiotemporal neural phenomena that are relevant for human cognition. On the other hand, the theorist can use this formalism for obtaining a probabilistic formulation of dynamical models, thereby relating them to the experimental data.</p>
</sec>
</sec>
<sec id="sec025" sec-type="materials|methods">
<title>Materials and methods</title>
<p>In this section we will explain the mathematical underpinnings of the GP-based decomposition. Following the lines of the Results section, the exposition begins from the connection between SDEs and Gaussian processes and continues with the exposition of the temporal and spatiotemporal GP-based decomposition. In order to improve the readability and to not overshadow the main ideas, we left some technical derivations to the appendices.</p>
<sec id="sec026">
<title>From SDEs to GPs</title>
<p>At the core of our method is the connection between Gaussian processes and SDEs. This connection leads to the definition of the covariance functions of the dynamic components that will be used for determining the prior of the GP regression. In the Results section, we introduced the SDE (<xref ref-type="disp-formula" rid="pcbi.1005540.e001">Eq (1)</xref>)
<disp-formula id="pcbi.1005540.e017"><alternatives><graphic id="pcbi.1005540.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e017" xlink:type="simple"/><mml:math display="block" id="M17"><mml:mrow><mml:mfrac><mml:msup><mml:mi>d</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mrow><mml:mi>d</mml:mi> <mml:msup><mml:mi>t</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac> <mml:mi>φ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>b</mml:mi> <mml:mfrac><mml:mi>d</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mi>φ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>ω</mml:mi> <mml:mrow><mml:mn>0</mml:mn></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mi>φ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>w</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula>
to model an oscillatory signal. In fact, this SDE can be interpreted as a damped harmonic oscillator when <inline-formula id="pcbi.1005540.e018"><alternatives><graphic id="pcbi.1005540.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e018" xlink:type="simple"/><mml:math display="inline" id="M18"><mml:mrow><mml:mi>b</mml:mi> <mml:mo>&lt;</mml:mo> <mml:msqrt><mml:mrow><mml:mn>2</mml:mn> <mml:msubsup><mml:mi>ω</mml:mi> <mml:mn>0</mml:mn> <mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:msqrt></mml:mrow></mml:math></alternatives></inline-formula>. As initial conditions, we set <inline-formula id="pcbi.1005540.e019"><alternatives><graphic id="pcbi.1005540.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e019" xlink:type="simple"/><mml:math display="inline" id="M19"><mml:mrow><mml:mi>φ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>-</mml:mo> <mml:mi>∞</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:mi>φ</mml:mi></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>-</mml:mo> <mml:mi>∞</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>. This choice implies that the (deterministic) effects of the initial conditions are negligible. Given these initial conditions, the solution of <xref ref-type="disp-formula" rid="pcbi.1005540.e001">Eq (1)</xref> is fully specified by the random input <italic>w</italic>(<italic>t</italic>) that follows a temporally uncorrelated normal distribution. Since the equation is linear, the solution, given a particular instantiation of <italic>w</italic>(<italic>t</italic>), can be obtained by convolving <italic>w</italic>(<italic>t</italic>) with the impulse response function of the SDE (see the supporting information for more details):
<disp-formula id="pcbi.1005540.e020"><alternatives><graphic id="pcbi.1005540.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e020" xlink:type="simple"/><mml:math display="block" id="M20"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>φ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mi>∞</mml:mi></mml:msubsup> <mml:msub><mml:mi>G</mml:mi> <mml:mi>φ</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>w</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>d</mml:mi> <mml:mi>s</mml:mi> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(7)</label></disp-formula></p>
<p>Intuitively, the impulse response function <italic>G</italic><sub><italic>φ</italic></sub>(<italic>t</italic>) determines the response of the system to a localized unit-amplitude input. Consequently, <xref ref-type="disp-formula" rid="pcbi.1005540.e020">Eq (7)</xref> states that the process <italic>φ</italic>(<italic>t</italic>) is generated by the infinite superposition of responses to <italic>w</italic>(<italic>t</italic>) at every time point. This proves that the resulting stochastic process <italic>φ</italic>(<italic>t</italic>) is Gaussian, since it is a linear mixture of Gaussian random variables.</p>
<p>The impulse response function of <xref ref-type="disp-formula" rid="pcbi.1005540.e001">Eq (1)</xref> is
<disp-formula id="pcbi.1005540.e021"><alternatives><graphic id="pcbi.1005540.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e021" xlink:type="simple"/><mml:math display="block" id="M21"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>G</mml:mi> <mml:mi>φ</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>ϑ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>b</mml:mi> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn> <mml:mi>t</mml:mi></mml:mrow></mml:msup> <mml:mo form="prefix">sin</mml:mo> <mml:mi>ω</mml:mi> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(8)</label></disp-formula>
where <italic>ϑ</italic>(<italic>t</italic>) is a function equal to zero for <italic>t</italic> &lt; 0 and 1 otherwise. This function assures that the response cannot precede the input impulse. From this formula, we see that the system responds to an impulse by oscillating at frequency <inline-formula id="pcbi.1005540.e022"><alternatives><graphic id="pcbi.1005540.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e022" xlink:type="simple"/><mml:math display="inline" id="M22"><mml:mrow><mml:mi>ω</mml:mi> <mml:mo>=</mml:mo> <mml:msqrt><mml:mrow><mml:msubsup><mml:mi>ω</mml:mi> <mml:mn>0</mml:mn> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mn>4</mml:mn> <mml:msup><mml:mi>b</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mrow></mml:math></alternatives></inline-formula> and with an amplitude that decays exponentially with time scale <italic>b</italic>/2. The covariance function of the process <italic>φ</italic>(<italic>t</italic>) can be determined from its impulse response function and is given by
<disp-formula id="pcbi.1005540.e023"><alternatives><graphic id="pcbi.1005540.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e023" xlink:type="simple"/><mml:math display="block" id="M23"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>k</mml:mi> <mml:mi>φ</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mi>φ</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:msubsup><mml:mi>σ</mml:mi> <mml:mi>φ</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mrow><mml:mn>2</mml:mn> <mml:mi>b</mml:mi></mml:mrow></mml:mfrac> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>b</mml:mi> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn> <mml:mo>|</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>|</mml:mo></mml:mrow></mml:msup> <mml:mfenced close=")" open="(" separators=""><mml:mo form="prefix">cos</mml:mo> <mml:mi>ω</mml:mi> <mml:mi>τ</mml:mi> <mml:mo>+</mml:mo> <mml:mfrac><mml:mi>b</mml:mi> <mml:mi>ω</mml:mi></mml:mfrac> <mml:mo form="prefix">sin</mml:mo> <mml:mi>ω</mml:mi> <mml:mrow><mml:mo>|</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>|</mml:mo></mml:mrow></mml:mfenced> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(9)</label></disp-formula>
where <italic>τ</italic> denotes the time difference <italic>t</italic><sub><italic>i</italic></sub> − <italic>t</italic><sub><italic>j</italic></sub>. In the case of the second order integrator, the parameter <italic>ω</italic><sub>0</sub> is smaller than <italic>b</italic>/2 and the system is overdamped. In this case, the response to an impulse is not oscillatory, the response initially rises and then decays to zero with time scale <italic>b</italic>/2. This behavior is determined by the impulse response function
<disp-formula id="pcbi.1005540.e024"><alternatives><graphic id="pcbi.1005540.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e024" xlink:type="simple"/><mml:math display="block" id="M24"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>G</mml:mi> <mml:mi>χ</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>ϑ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>b</mml:mi> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn> <mml:mi>t</mml:mi></mml:mrow></mml:msup> <mml:mo form="prefix">sinh</mml:mo> <mml:mi>z</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(10)</label></disp-formula>
in which <italic>z</italic> is equal to <inline-formula id="pcbi.1005540.e025"><alternatives><graphic id="pcbi.1005540.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e025" xlink:type="simple"/><mml:math display="inline" id="M25"><mml:msqrt><mml:mrow><mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mn>4</mml:mn> <mml:msup><mml:mi>b</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>ω</mml:mi> <mml:mn>0</mml:mn> <mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:msqrt></mml:math></alternatives></inline-formula>. The covariance function is given by
<disp-formula id="pcbi.1005540.e026"><alternatives><graphic id="pcbi.1005540.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e026" xlink:type="simple"/><mml:math display="block" id="M26"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>k</mml:mi> <mml:mi>χ</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:msubsup><mml:mi>σ</mml:mi> <mml:mi>χ</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mrow><mml:mn>2</mml:mn> <mml:mi>b</mml:mi></mml:mrow></mml:mfrac> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>b</mml:mi> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn> <mml:mo>|</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>|</mml:mo></mml:mrow></mml:msup> <mml:mfenced close=")" open="(" separators=""><mml:mo form="prefix">cosh</mml:mo> <mml:mi>z</mml:mi> <mml:mi>τ</mml:mi> <mml:mo>+</mml:mo> <mml:mfrac><mml:mi>b</mml:mi> <mml:mi>z</mml:mi></mml:mfrac> <mml:mo form="prefix">sinh</mml:mo> <mml:mi>z</mml:mi> <mml:mrow><mml:mo>|</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>|</mml:mo></mml:mrow></mml:mfenced> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(11)</label></disp-formula></p>
<p>Finally, the first order integrator (<xref ref-type="disp-formula" rid="pcbi.1005540.e007">Eq (2)</xref>)
<disp-formula id="pcbi.1005540.e027"><alternatives><graphic id="pcbi.1005540.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e027" xlink:type="simple"/><mml:math display="block" id="M27"><mml:mrow><mml:mspace width="4pt"/><mml:mfrac><mml:mi>d</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mi>ψ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mi>c</mml:mi> <mml:mi>ψ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>w</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula>
has a discontinuous impulse response function that decays exponentially:
<disp-formula id="pcbi.1005540.e028"><alternatives><graphic id="pcbi.1005540.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e028" xlink:type="simple"/><mml:math display="block" id="M28"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>G</mml:mi> <mml:mi>ψ</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>ϑ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>c</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:msup> <mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(12)</label></disp-formula></p>
<p>The discontinuity of the impulse response at <italic>t</italic> = 0 implies that the process is not differentiable as it reacts very abruptly to the external input. The covariance function of this process is given by:
<disp-formula id="pcbi.1005540.e029"><alternatives><graphic id="pcbi.1005540.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e029" xlink:type="simple"/><mml:math display="block" id="M29"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>k</mml:mi> <mml:mi>ψ</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>ψ</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mrow><mml:mn>2</mml:mn> <mml:mi>c</mml:mi></mml:mrow></mml:mfrac> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>c</mml:mi> <mml:mo>|</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>|</mml:mo></mml:mrow></mml:msup> <mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(13)</label></disp-formula></p>
<sec id="sec027">
<title>Covariance function for the residuals</title>
<p>The stochastic differential equations are meant to capture the most important (linear) qualitative features of the neural signal. Nevertheless, the real underlying neural dynamics are much more complex than can be captured by any simple model. Empirically, we found that the residuals of our model have short-lived temporal correlations. We decided to account for these correlations by introducing a residuals process <italic>ξ</italic>(<italic>t</italic>) with covariance function
<disp-formula id="pcbi.1005540.e030"><alternatives><graphic id="pcbi.1005540.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e030" xlink:type="simple"/><mml:math display="block" id="M30"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>k</mml:mi> <mml:mi>ξ</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>ξ</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mfrac><mml:msup><mml:mi>τ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mrow><mml:mn>2</mml:mn> <mml:msup><mml:mi>δ</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(14)</label></disp-formula>
in which the small time constant <italic>δ</italic> is the signal’s characteristic time scale and <italic>σ</italic><sub><italic>ξ</italic></sub> is its standard deviation. This covariance function is commonly called the squared exponential and is one of the most used in the machine learning literature [<xref ref-type="bibr" rid="pcbi.1005540.ref010">10</xref>]. As <italic>k</italic><sub><italic>ξ</italic></sub>(<italic>τ</italic>) decays to zero much faster than our SDE-derived covariance functions for <italic>τ</italic> tending to ∞, this covariance function is appropriate for modeling short-lived temporal correlations.</p>
</sec>
</sec>
<sec id="sec028">
<title>Analysing neural signals using Gaussian process regression</title>
<p>In this section, we show how to estimate the value of a dynamic component such as <italic>φ</italic>(<italic>t</italic>) in the set of sample points <inline-formula id="pcbi.1005540.e031"><alternatives><graphic id="pcbi.1005540.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e031" xlink:type="simple"/><mml:math display="inline" id="M31"><mml:mrow><mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mn>…</mml:mn> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>N</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> using GP regression. To this end, it is convenient to collect all the components other than <italic>φ</italic>(<italic>t</italic>) in a total residuals process <italic>ζ</italic>(<italic>t</italic>) = <italic>χ</italic>(<italic>t</italic>) + <italic>ψ</italic>(<italic>t</italic>) + <italic>ξ</italic>(<italic>t</italic>). In fact, in this context, they jointly have the role of interfering noise. The vector of data points <bold><italic>y</italic></bold> is assumed to be a sum of the signal of interest and the noise:
<disp-formula id="pcbi.1005540.e032"><alternatives><graphic id="pcbi.1005540.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e032" xlink:type="simple"/><mml:math display="block" id="M32"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>y</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi>φ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>ζ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(15)</label></disp-formula></p>
<p>In order to estimate the values of <italic>φ</italic>(<italic>t</italic>) using Bayes’ theorem we need to specify a prior distribution over the space of continuous-time signals. In the previous sections, we saw how to construct such probability distributions from linear SDEs. In particular, we found that those distributions were GPs with covariance functions that can be analytically obtained from the impulse response function of the SDEs. These prior distributions can be summarized in the following way:
<disp-formula id="pcbi.1005540.e033"><alternatives><graphic id="pcbi.1005540.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e033" xlink:type="simple"/><mml:math display="block" id="M33"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>φ</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mo>∼</mml:mo> <mml:mi>G</mml:mi> <mml:mi>P</mml:mi> <mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mi>φ</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>ζ</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mo>∼</mml:mo> <mml:mi>G</mml:mi> <mml:mi>P</mml:mi> <mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mi>ζ</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(16)</label></disp-formula>
where the symbol ∼ indicates that the random variable on the left-hand side follows the distribution on the right-hand side and <italic>GP</italic>(<italic>μ</italic>(<italic>t</italic>), <italic>k</italic>(<italic>t</italic><sub>1</sub>, <italic>t</italic><sub>2</sub>)) denotes a GP with mean function <italic>μ</italic>(<italic>t</italic>) and covariance function <italic>k</italic>(<italic>t</italic><sub>1</sub>, <italic>t</italic><sub>2</sub>). Note that, in this functional notation, expressions such as <italic>μ</italic>(<italic>t</italic>) and <italic>k</italic>(<italic>t</italic><sub>1</sub>, <italic>t</italic><sub>2</sub>) denote whole functions rather than just the values of these functions at specific time points.</p>
<p>We will now derive the marginal expectation of <italic>φ</italic>(<italic>t</italic>) under the posterior distribution. Since we are interested in the values of <italic>φ</italic>(<italic>t</italic>) at sample points <italic>t</italic><sub>1</sub>,…, <italic>t</italic><sub><italic>N</italic></sub>, it is convenient to introduce the vector <bold><italic>φ</italic></bold> defined by the entries <italic>φ</italic><sub><italic>j</italic></sub> = <italic>φ</italic>(<italic>t</italic><sub><italic>j</italic></sub>). Any marginal distribution of a GP for a finite set of sample points is a multivariate Gaussian whose covariance matrix is obtained by evaluating the covariance function at every pair of time points:
<disp-formula id="pcbi.1005540.e034"><alternatives><graphic id="pcbi.1005540.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e034" xlink:type="simple"/><mml:math display="block" id="M34"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mrow><mml:mo>[</mml:mo> <mml:msub><mml:mi>K</mml:mi> <mml:mi>φ</mml:mi></mml:msub> <mml:mo>]</mml:mo></mml:mrow> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mi>φ</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(17)</label></disp-formula>
Using Bayes’ theorem and integrating out the total residual <italic>ζ</italic>(<italic>t</italic>), we can now write the marginal posterior of <bold><italic>φ</italic></bold> as
<disp-formula id="pcbi.1005540.e035"><alternatives><graphic id="pcbi.1005540.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e035" xlink:type="simple"/><mml:math display="block" id="M35"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">φ</mml:mi> <mml:mo>∣</mml:mo> <mml:mi mathvariant="bold-italic">y</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∝</mml:mo> <mml:mo>∫</mml:mo> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">y</mml:mi> <mml:mo>∣</mml:mo> <mml:mi mathvariant="bold-italic">φ</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">ζ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">ζ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>d</mml:mi> <mml:mi mathvariant="bold-italic">ζ</mml:mi> <mml:mspace width="4pt"/><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">φ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>N</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">y</mml:mi> <mml:mo>∣</mml:mo> <mml:mi mathvariant="bold-italic">φ</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>K</mml:mi> <mml:mi mathvariant="bold-italic">ζ</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>N</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">φ</mml:mi> <mml:mo>∣</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:msub><mml:mi>K</mml:mi> <mml:mi mathvariant="bold-italic">φ</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(18)</label></disp-formula>
in which <italic>K</italic><sub><italic>ζ</italic></sub> is the temporal covariance matrix of <italic>ζ</italic>(<italic>t</italic>). As a product of two Gaussian densities, the posterior density is a Gaussian distribution itself. The parameters of the posterior can be found by writing the prior and the likelihood in canonical form. From this form, it is easy to show that the posterior marginal expectation is given by the vector <bold><italic>m</italic></bold><sub><italic>φ</italic>|<italic>y</italic></sub> (see [<xref ref-type="bibr" rid="pcbi.1005540.ref010">10</xref>] for more details about this derivation):
<disp-formula id="pcbi.1005540.e036"><alternatives><graphic id="pcbi.1005540.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e036" xlink:type="simple"/><mml:math display="block" id="M36"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">m</mml:mi> <mml:mrow><mml:mi>φ</mml:mi> <mml:mo>|</mml:mo> <mml:mi>y</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>K</mml:mi> <mml:mi>φ</mml:mi></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>K</mml:mi> <mml:mi>φ</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>K</mml:mi> <mml:mi>ζ</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mi mathvariant="bold-italic">y</mml:mi> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(19)</label></disp-formula></p>
<p>Furthermore, if we assume that <italic>χ</italic>(<italic>t</italic>), <italic>ψ</italic>(<italic>t</italic>) and <italic>ξ</italic>(<italic>t</italic>) are independent, the noise covariance matrix reduces to
<disp-formula id="pcbi.1005540.e037"><alternatives><graphic id="pcbi.1005540.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e037" xlink:type="simple"/><mml:math display="block" id="M37"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>K</mml:mi> <mml:mi>ζ</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>K</mml:mi> <mml:mi>χ</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>K</mml:mi> <mml:mi>ψ</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>K</mml:mi> <mml:mi>ξ</mml:mi></mml:msub> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(20)</label></disp-formula></p>
</sec>
<sec id="sec029">
<title>GP analysis of spatiotemporal signals</title>
<p>In the following, we show how to generalize GP-based decomposition to the spatiotemporal setting. This requires the construction of a source model and the definition of an appropriate prior covariance between cortical locations. In fact, the problem of localizing brain activity from MEG or EEG sensors becomes solvable once we introduce prior spatial correlations by defining a spatial covariance <italic>s</italic>(<bold><italic>x</italic></bold><sub><italic>i</italic></sub>, <bold><italic>x</italic></bold><sub><italic>j</italic></sub>) between every pair of cortical locations <bold><italic>x</italic></bold><sub><italic>i</italic></sub> and <bold><italic>x</italic></bold><sub><italic>j</italic></sub>. In this paper, we construct <italic>s</italic>(<bold><italic>x</italic></bold><sub><italic>i</italic></sub>, <bold><italic>x</italic></bold><sub><italic>j</italic></sub>) by discounting high spatial frequencies in the spherical harmonics domain, thereby limiting our reconstruction to spatial scales that can be reliably estimated from the sensor measurements. However, prior to the definition of the covariance function, we need to specify a model of the geometry of the head and the brain cortex.</p>
<sec id="sec030">
<title>The source model</title>
<p>In order to define a source model, we construct a triangular mesh of the cortex from a structural MRI scan using Freesurfer [<xref ref-type="bibr" rid="pcbi.1005540.ref023">23</xref>]. The cortical boundary is morphed into a spherical hull in a way that maximally preserves the intrinsic geometry of the cortex. This allows to parameterize the surface <italic>C</italic> using the spherical coordinates <italic>α</italic> and <italic>θ</italic>, respectively azimuth and elevation. For notational simplicity, we collect the spherical coordinates into the coordinate pair <bold><italic>x</italic></bold> = (<italic>α</italic>, <italic>θ</italic>) that refers to a spatial location in the cortex. Furthermore, we denote the finite set of <italic>M</italic> points in the mesh as <inline-formula id="pcbi.1005540.e038"><alternatives><graphic id="pcbi.1005540.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e038" xlink:type="simple"/><mml:math display="inline" id="M38"><mml:mrow><mml:mi mathvariant="script">X</mml:mi> <mml:mo>=</mml:mo> <mml:mo>{</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi> <mml:mi>M</mml:mi></mml:msub> <mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p>We define our source model as a vector field of current dipoles on the cortical surface. We first consider GP source reconstruction of the total neural activity <inline-formula id="pcbi.1005540.e039"><alternatives><graphic id="pcbi.1005540.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e039" xlink:type="simple"/><mml:math display="inline" id="M39"><mml:mrow><mml:mover accent="true"><mml:mi>ρ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, without differentiating between spatiotemporal dynamic components such as <inline-formula id="pcbi.1005540.e040"><alternatives><graphic id="pcbi.1005540.e040g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e040" xlink:type="simple"/><mml:math display="inline" id="M40"><mml:mrow><mml:mover accent="true"><mml:mi>φ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1005540.e041"><alternatives><graphic id="pcbi.1005540.e041g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e041" xlink:type="simple"/><mml:math display="inline" id="M41"><mml:mrow><mml:mover accent="true"><mml:mi>χ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005540.e042"><alternatives><graphic id="pcbi.1005540.e042g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e042" xlink:type="simple"/><mml:math display="inline" id="M42"><mml:mrow><mml:mover accent="true"><mml:mi>ψ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. The vector field <inline-formula id="pcbi.1005540.e043"><alternatives><graphic id="pcbi.1005540.e043g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e043" xlink:type="simple"/><mml:math display="inline" id="M43"><mml:mrow><mml:mover accent="true"><mml:mi>ρ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is characterized by the three Cartesian coordinates <italic>ρ</italic><sub>1</sub>(<italic>x</italic>, <italic>t</italic>), <italic>ρ</italic><sub>2</sub>(<italic>x</italic>, <italic>t</italic>), and <italic>ρ</italic><sub>3</sub>(<italic>x</italic>, <italic>t</italic>). In all the analyses contained in this paper, we estimate the full vector field. However, since we do not assume any prior correlations between the dipole coordinates, in the following we will simplify the notation by describing the source decomposition method for a dipole field <inline-formula id="pcbi.1005540.e044"><alternatives><graphic id="pcbi.1005540.e044g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e044" xlink:type="simple"/><mml:math display="inline" id="M44"><mml:mrow><mml:mi>ρ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mover accent="true"><mml:mi>v</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">x</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, where the unit-length vector field <inline-formula id="pcbi.1005540.e045"><alternatives><graphic id="pcbi.1005540.e045g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e045" xlink:type="simple"/><mml:math display="inline" id="M45"><mml:mrow><mml:mover accent="true"><mml:mi>v</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">x</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> of dipole orientations is assumed to be known. The supporting information contains an explanation of how to adapt all the formulas to the vector-valued case using matrices with a block diagonal form.</p>
</sec>
<sec id="sec031">
<title>Spatial Gaussian processes source reconstruction in the spherical harmonics domain</title>
<p>The linearity of the electromagnetic field allows to model the spatiotemporal data matrix <italic>Y</italic> as the result of a linear operator acting on the neural activity <italic>ρ</italic>(<italic>x</italic>, <italic>t</italic>) [<xref ref-type="bibr" rid="pcbi.1005540.ref031">31</xref>]:
<disp-formula id="pcbi.1005540.e046"><alternatives><graphic id="pcbi.1005540.e046g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e046" xlink:type="simple"/><mml:math display="block" id="M46"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>Y</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mo>∫</mml:mo> <mml:mi>C</mml:mi></mml:msub> <mml:msub><mml:mi mathvariant="script">L</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>ρ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">x</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>d</mml:mi> <mml:mi mathvariant="bold-italic">x</mml:mi> <mml:mspace width="3.33333pt"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(21)</label></disp-formula>
in which the component <inline-formula id="pcbi.1005540.e047"><alternatives><graphic id="pcbi.1005540.e047g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e047" xlink:type="simple"/><mml:math display="inline" id="M47"><mml:mrow><mml:msub><mml:mi mathvariant="script">L</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">x</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> describes the effect of a source located at <bold><italic>x</italic></bold> on the <italic>i</italic>-th sensor. Note that <inline-formula id="pcbi.1005540.e048"><alternatives><graphic id="pcbi.1005540.e048g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e048" xlink:type="simple"/><mml:math display="inline" id="M48"><mml:mrow><mml:msub><mml:mi mathvariant="script">L</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">x</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> implicitly depends on the orientation <inline-formula id="pcbi.1005540.e049"><alternatives><graphic id="pcbi.1005540.e049g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e049" xlink:type="simple"/><mml:math display="inline" id="M49"><mml:mrow><mml:mover accent="true"><mml:mi>v</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">x</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> since different dipole orientations generate different sensor measurements. We refer to <inline-formula id="pcbi.1005540.e050"><alternatives><graphic id="pcbi.1005540.e050g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e050" xlink:type="simple"/><mml:math display="inline" id="M50"><mml:mrow><mml:msub><mml:mi mathvariant="script">L</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">x</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> as the forward model relative to the <italic>i</italic>-th sensor, note that this is a function of the spatial location on the cortical surface.</p>
<p>In this section, we ignore the prior temporal correlations induced by the temporal covariance functions, i.e. we implicitly assume a prior for <italic>ρ</italic>(<bold><italic>x</italic></bold>, <italic>t</italic>) that is temporally white. In a GP regression setting, the spatial smoothing can be implemented by using a spatially homogeneous covariance function, i.e. a covariance function that only depends on the cortical distance between the sources. To define this covariance function, we make use of the so-called spherical Fourier transform. Whereas the ordinary Fourier transform decomposes signals into sinusoidal waves, the spherical Fourier transform decomposes spatial configurations defined over a sphere into the spherical harmonics <inline-formula id="pcbi.1005540.e051"><alternatives><graphic id="pcbi.1005540.e051g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e051" xlink:type="simple"/><mml:math display="inline" id="M51"><mml:mrow><mml:msubsup><mml:mi mathvariant="script">H</mml:mi> <mml:mi>l</mml:mi> <mml:mi>m</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">x</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. These basis functions are characterized by a spatial frequency number <italic>l</italic> and a “spatial phase” number <italic>m</italic>. <xref ref-type="fig" rid="pcbi.1005540.g009">Fig 9A</xref> shows the spherical harmonics corresponding to the first three spatial frequencies morphed on the cortical surface. For notational convenience, we assign an arbitrary linear indexing to each (<italic>l</italic>, <italic>m</italic>) couple that henceforth will be denoted as (<italic>l</italic><sub><italic>k</italic></sub>, <italic>m</italic><sub><italic>k</italic></sub>). It is convenient to represent the neural activity <italic>ρ</italic>(<bold><italic>x</italic></bold>, <italic>t</italic>) in the spherical harmonics domain. Specifically, we will use the symbol <inline-formula id="pcbi.1005540.e052"><alternatives><graphic id="pcbi.1005540.e052g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e052" xlink:type="simple"/><mml:math display="inline" id="M52"><mml:mrow><mml:mover accent="true"><mml:mi>ρ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>l</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>m</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>;</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> to denote the Fourier coefficient of the spherical harmonic indexed by (<italic>l</italic><sub><italic>k</italic></sub>, <italic>m</italic><sub><italic>k</italic></sub>) (see the supporting information).</p>
<fig id="pcbi.1005540.g009" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005540.g009</object-id>
<label>Fig 9</label>
<caption>
<title>Spherical harmonics and covariance functions.</title>
<p>Visualization of the spherical harmonics morphed onto the cortex and the resulting spatial correlation structure. A) Example of spherical harmonics on the brain cortex for frequency numbers from 0 to 2. For each frequency number <italic>l</italic> there are 2<italic>l</italic>+1 harmonics with “phase” number <italic>m</italic> ranging from −<italic>l</italic> to <italic>l</italic>. As clear from the picture, the spatial frequency increases as a function of the frequency number. In all our analyses we truncated the harmonic expansion after the 11th frequency number. B,C) Prior correlation structure induced by <xref ref-type="disp-formula" rid="pcbi.1005540.e057">Eq (24)</xref>. Panel B shows the prior correlations on the cortical surface from a cortical point identified by a red dot. Panel C shows the same function on the spherical hull. The spatial correlations are determined by the frequency discount function <italic>f</italic>(<italic>l</italic>); here we used the same smoothing parameters as all analyses in the paper: <italic>k</italic> = 2 and <italic>υ</italic> = 3.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005540.g009" xlink:type="simple"/>
</fig>
<p>We assume that the spherical Fourier coefficients <inline-formula id="pcbi.1005540.e053"><alternatives><graphic id="pcbi.1005540.e053g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e053" xlink:type="simple"/><mml:math display="inline" id="M53"><mml:mrow><mml:mover accent="true"><mml:mi>ρ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>l</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>m</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>;</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> are independent Gaussian random variables. Under this assumption, we just need to define the prior variance of the coefficients <inline-formula id="pcbi.1005540.e054"><alternatives><graphic id="pcbi.1005540.e054g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e054" xlink:type="simple"/><mml:math display="inline" id="M54"><mml:mrow><mml:mover accent="true"><mml:mi>ρ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>l</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>m</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>;</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Since we aim to reduce the effect of noise with high spatial frequencies, we define these prior variances using a frequency damping function <italic>f</italic>(<italic>l</italic><sub><italic>k</italic></sub>) that monotonically decreases as a function of the spatial frequency number <italic>l</italic><sub><italic>k</italic></sub>. This effectively discounts high spatial frequencies and therefore can be seen as a spherical low-pass filter. The variance of the spherical Fourier coefficients is given by the following variance function
<disp-formula id="pcbi.1005540.e055"><alternatives><graphic id="pcbi.1005540.e055g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e055" xlink:type="simple"/><mml:math display="block" id="M55"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>s</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>l</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>m</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>;</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>l</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(22)</label></disp-formula>
where, as damping function, we use a spherical version of the truncated Butterworth low-pass filter:
<disp-formula id="pcbi.1005540.e056"><alternatives><graphic id="pcbi.1005540.e056g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e056" xlink:type="simple"/><mml:math display="block" id="M56"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>l</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfenced close="" open="{" separators=""><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mfrac><mml:msub><mml:mi>l</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mi>υ</mml:mi></mml:mfrac> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mn>2</mml:mn> <mml:mi>k</mml:mi></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mtext>for</mml:mtext> <mml:mspace width="4pt"/><mml:msub><mml:mi>l</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>≤</mml:mo> <mml:mi>L</mml:mi></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mtext>for</mml:mtext> <mml:mspace width="4pt"/><mml:msub><mml:mi>l</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>&gt;</mml:mo> <mml:mi>L</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(23)</label></disp-formula>
with smoothing parameter <italic>υ</italic>, order <italic>k</italic>, and cut-off frequency <italic>L</italic>. This filter has been shown to have good properties in the spatial domain [<xref ref-type="bibr" rid="pcbi.1005540.ref070">70</xref>]. Note that, under the covariance function defined by Eqs <xref ref-type="disp-formula" rid="pcbi.1005540.e055">(22)</xref> and <xref ref-type="disp-formula" rid="pcbi.1005540.e056">(23)</xref>, the spherical Fourier coefficients with frequency number larger than <italic>L</italic> have zero variance and are therefore irrelevant. Although the analysis is carried out in the spherical harmonics domain, it is informative to be able to visualize the covariance function in the spatial domain. By applying the inverse spherical Fourier transform, the function <italic>s</italic>(<bold><italic>x</italic></bold><sub><italic>i</italic></sub>, <bold><italic>x</italic></bold><sub><italic>j</italic></sub>) can be explicitly obtained as follows:
<disp-formula id="pcbi.1005540.e057"><alternatives><graphic id="pcbi.1005540.e057g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e057" xlink:type="simple"/><mml:math display="block" id="M57"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>s</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>,</mml:mo> <mml:mi>m</mml:mi></mml:mrow></mml:munder> <mml:msubsup><mml:mi mathvariant="script">H</mml:mi> <mml:mi>l</mml:mi> <mml:mi>m</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msubsup><mml:mi mathvariant="script">H</mml:mi> <mml:mi>l</mml:mi> <mml:mi>m</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>l</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(24)</label></disp-formula> <xref ref-type="fig" rid="pcbi.1005540.g009">Fig 9B and 9C</xref> show the correlations induced by our spatial covariance function.</p>
<p>In order to formulate the spatial GP regression in the spherical harmonics domain, we rewrite the integral in <xref ref-type="disp-formula" rid="pcbi.1005540.e046">Eq (21)</xref> using the inverse spherical Fourier transform (see the supporting information) and interchanging the order of summation and integration:
<disp-formula id="pcbi.1005540.e058"><alternatives><graphic id="pcbi.1005540.e058g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e058" xlink:type="simple"/><mml:math display="block" id="M58"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>Y</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mo>∫</mml:mo> <mml:mi>C</mml:mi></mml:msub> <mml:msub><mml:mi mathvariant="script">L</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mfenced close=")" open="("><mml:mrow><mml:munder><mml:mo>∑</mml:mo> <mml:mi>k</mml:mi></mml:munder> <mml:mover accent="true"><mml:mi>ρ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>l</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>m</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>;</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msubsup><mml:mi mathvariant="script">H</mml:mi> <mml:mrow><mml:msub><mml:mi>l</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow> <mml:msub><mml:mi>m</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">x</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfenced> <mml:mi>d</mml:mi> <mml:mi mathvariant="bold-italic">x</mml:mi> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>k</mml:mi></mml:munder> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="script">L</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>l</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>m</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mover accent="true"><mml:mi>ρ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>l</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>m</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>;</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(25)</label></disp-formula>
where
<disp-formula id="pcbi.1005540.e059"><alternatives><graphic id="pcbi.1005540.e059g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e059" xlink:type="simple"/><mml:math display="block" id="M59"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="script">L</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>l</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>m</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mo>∫</mml:mo> <mml:mi>C</mml:mi></mml:msub> <mml:msub><mml:mi mathvariant="script">L</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msubsup><mml:mi mathvariant="script">H</mml:mi> <mml:mrow><mml:msub><mml:mi>l</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow> <mml:msub><mml:mi>m</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>d</mml:mi> <mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(26)</label></disp-formula>
is the spherical Fourier transform of <inline-formula id="pcbi.1005540.e060"><alternatives><graphic id="pcbi.1005540.e060g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e060" xlink:type="simple"/><mml:math display="inline" id="M60"><mml:mrow><mml:msub><mml:mi mathvariant="script">L</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">x</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Therefore, the spherical Fourier transform converts the forward model (which is a function of the cortical location) from the spatial to the spherical harmonics domain. We can simplify <xref ref-type="disp-formula" rid="pcbi.1005540.e058">Eq (25)</xref> by organizing the spherical Fourier coefficients <inline-formula id="pcbi.1005540.e061"><alternatives><graphic id="pcbi.1005540.e061g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e061" xlink:type="simple"/><mml:math display="inline" id="M61"><mml:mrow><mml:mover accent="true"><mml:mi>ρ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>l</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>m</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>;</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> in the matrix <inline-formula id="pcbi.1005540.e062"><alternatives><graphic id="pcbi.1005540.e062g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e062" xlink:type="simple"/><mml:math display="inline" id="M62"><mml:mover accent="true"><mml:mi>R</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, whose element <inline-formula id="pcbi.1005540.e063"><alternatives><graphic id="pcbi.1005540.e063g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e063" xlink:type="simple"/><mml:math display="inline" id="M63"><mml:msub><mml:mover accent="true"><mml:mi>R</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> is <inline-formula id="pcbi.1005540.e064"><alternatives><graphic id="pcbi.1005540.e064g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e064" xlink:type="simple"/><mml:math display="inline" id="M64"><mml:mrow><mml:mover accent="true"><mml:mi>ρ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>l</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>m</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>;</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Analogously, the spherical Fourier transform of the forward model can be arranged in a matrix Λ with elements <inline-formula id="pcbi.1005540.e065"><alternatives><graphic id="pcbi.1005540.e065g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e065" xlink:type="simple"/><mml:math display="inline" id="M65"><mml:mrow><mml:msub><mml:mo>Λ</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="script">L</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>l</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>m</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Using this notation, we can write the observation model for the spatiotemporal data matrix <italic>Y</italic> in a compact way:
<disp-formula id="pcbi.1005540.e066"><alternatives><graphic id="pcbi.1005540.e066g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e066" xlink:type="simple"/><mml:math display="block" id="M66"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>Y</mml:mi> <mml:mo>=</mml:mo> <mml:mo>Λ</mml:mo> <mml:mover accent="true"><mml:mi>R</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>+</mml:mo> <mml:mi mathvariant="bold-italic">ξ</mml:mi> <mml:mspace width="3.33333pt"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(27)</label></disp-formula>
where <bold><italic>ξ</italic></bold> are Gaussian residuals with spatial covariance matrix Σ.</p>
<p>We can now combine this observation model with the spherical harmonics domain spatial GP prior, as determined by the variance function given by <xref ref-type="disp-formula" rid="pcbi.1005540.e055">Eq (22)</xref>, and from this we obtain the posterior of the neural activity <inline-formula id="pcbi.1005540.e067"><alternatives><graphic id="pcbi.1005540.e067g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e067" xlink:type="simple"/><mml:math display="inline" id="M67"><mml:mover accent="true"><mml:mi>R</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> given the measured signal <italic>Y</italic>. Because the spatial process is Gaussian, the prior distribution of the spherical Fourier coefficients is normal and, because we assumed that the spherical Fourier coefficients are independent, their covariance matrix <italic>D</italic> is diagonal with entries specified by the variance function <italic>D</italic><sub><italic>kk</italic></sub> = <italic>f</italic>(<italic>l</italic><sub><italic>k</italic></sub>) (see <xref ref-type="disp-formula" rid="pcbi.1005540.e055">Eq (22)</xref>). Alltogether, the prior and the observation model specify a Gaussian linear regression. The posterior expectation of the regression coeffcients <inline-formula id="pcbi.1005540.e068"><alternatives><graphic id="pcbi.1005540.e068g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e068" xlink:type="simple"/><mml:math display="inline" id="M68"><mml:mover accent="true"><mml:mi>R</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> can be shown to be [<xref ref-type="bibr" rid="pcbi.1005540.ref015">15</xref>]:
<disp-formula id="pcbi.1005540.e069"><alternatives><graphic id="pcbi.1005540.e069g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e069" xlink:type="simple"/><mml:math display="block" id="M69"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>M</mml:mi> <mml:mrow><mml:mover accent="true"><mml:mi>R</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>|</mml:mo> <mml:mi>Y</mml:mi></mml:mrow></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msup><mml:mrow><mml:mi>D</mml:mi> <mml:mo>Λ</mml:mo></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:msup><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mo>Λ</mml:mo> <mml:mi>D</mml:mi> <mml:mo>Λ</mml:mo></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:mrow><mml:mo>+</mml:mo> <mml:mo>Σ</mml:mo> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mi>Y</mml:mi> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(28)</label></disp-formula>
In this formula, Λ<italic>D</italic>Λ<sup><italic>T</italic></sup> is the sensor level covariance matrix induced by the spatially smooth brain activity and Σ is the residual covariance matrix of the sensors. This expression can be recast in terms of the original cortical locations <inline-formula id="pcbi.1005540.e070"><alternatives><graphic id="pcbi.1005540.e070g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e070" xlink:type="simple"/><mml:math display="inline" id="M70"><mml:mi mathvariant="script">X</mml:mi></mml:math></alternatives></inline-formula> using the inverse spherical Fourier transform. In matrix form, this can be written as
<disp-formula id="pcbi.1005540.e071"><alternatives><graphic id="pcbi.1005540.e071g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e071" xlink:type="simple"/><mml:math display="block" id="M71"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>M</mml:mi> <mml:mrow><mml:mi>R</mml:mi> <mml:mo>|</mml:mo> <mml:mi>Y</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mi>H</mml:mi> <mml:msub><mml:mi>M</mml:mi> <mml:mrow><mml:mover accent="true"><mml:mi>ρ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>|</mml:mo> <mml:mi>Y</mml:mi></mml:mrow></mml:mrow></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(29)</label></disp-formula>
where the matrix <italic>H</italic> is obtained by evaluating the spherical harmonics at the discrete spatial grid-points <inline-formula id="pcbi.1005540.e072"><alternatives><graphic id="pcbi.1005540.e072g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e072" xlink:type="simple"/><mml:math display="inline" id="M72"><mml:mi mathvariant="script">X</mml:mi></mml:math></alternatives></inline-formula>:
<disp-formula id="pcbi.1005540.e073"><alternatives><graphic id="pcbi.1005540.e073g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e073" xlink:type="simple"/><mml:math display="block" id="M73"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>H</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi mathvariant="script">H</mml:mi> <mml:mrow><mml:msub><mml:mi>l</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow> <mml:msub><mml:mi>m</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(30)</label></disp-formula>
This formula gives the Harmony source reconstruction solution as presented in [<xref ref-type="bibr" rid="pcbi.1005540.ref016">16</xref>]. We can reformulate this expression by introducing the Harmony spatial filter
<disp-formula id="pcbi.1005540.e074"><alternatives><graphic id="pcbi.1005540.e074g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e074" xlink:type="simple"/><mml:math display="block" id="M74"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:mo>=</mml:mo> <mml:msup><mml:mrow><mml:mi>H</mml:mi> <mml:mi>D</mml:mi> <mml:mo>Λ</mml:mo></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:msup><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mo>Λ</mml:mo> <mml:mi>D</mml:mi> <mml:mo>Λ</mml:mo></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:mrow><mml:mo>+</mml:mo> <mml:mo>Σ</mml:mo> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(31)</label></disp-formula>
Using this matrix, the posterior expectation of the neural activity at the cortical locations <inline-formula id="pcbi.1005540.e075"><alternatives><graphic id="pcbi.1005540.e075g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e075" xlink:type="simple"/><mml:math display="inline" id="M75"><mml:mi mathvariant="script">X</mml:mi></mml:math></alternatives></inline-formula> can be written as follows:
<disp-formula id="pcbi.1005540.e076"><alternatives><graphic id="pcbi.1005540.e076g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e076" xlink:type="simple"/><mml:math display="block" id="M76"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>M</mml:mi> <mml:mrow><mml:mi>R</mml:mi> <mml:mo>|</mml:mo> <mml:mi>Y</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mi>P</mml:mi> <mml:mi>Y</mml:mi> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(32)</label></disp-formula></p>
</sec>
<sec id="sec032">
<title>Spatiotemporal GP-based decomposition</title>
<p>The temporal and spatial GP regression can be combined by assigning a temporal covariance function to each spherical Fourier coefficient. In other words, we model the time series of each coefficient as an independent temporal Gaussian process. These processes have the same prior temporal correlation structure as specified in our additive temporal model. However, as in the spatial model, their prior variance is discounted as a function of the spatial frequency <italic>l</italic><sub><italic>k</italic></sub>. Using functional notation, this can be written as follows:
<disp-formula id="pcbi.1005540.e077"><alternatives><graphic id="pcbi.1005540.e077g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e077" xlink:type="simple"/><mml:math display="block" id="M77"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>ρ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>l</mml:mi> <mml:mo>,</mml:mo> <mml:mi>m</mml:mi> <mml:mo>;</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∼</mml:mo> <mml:mi>G</mml:mi> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mi>f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>l</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>k</mml:mi> <mml:mi>ρ</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(33)</label></disp-formula>
Considering the prior distributions of the processes <inline-formula id="pcbi.1005540.e078"><alternatives><graphic id="pcbi.1005540.e078g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e078" xlink:type="simple"/><mml:math display="inline" id="M78"><mml:mrow><mml:mover accent="true"><mml:mi>ρ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>l</mml:mi> <mml:mo>,</mml:mo> <mml:mi>m</mml:mi> <mml:mo>;</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> at the sample points, the matrix-valued random variable <inline-formula id="pcbi.1005540.e079"><alternatives><graphic id="pcbi.1005540.e079g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e079" xlink:type="simple"/><mml:math display="inline" id="M79"><mml:mover accent="true"><mml:mi>R</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, when vectorized, follows a multivariate Gaussian distribution with covariance matrix <italic>K</italic><sub><italic>ρ</italic></sub> ⊗ <italic>D</italic>, where ⊗ denotes the Kronecker product (see the supporting information). This Kronecker product form follows from the fact that the covariance function of <inline-formula id="pcbi.1005540.e080"><alternatives><graphic id="pcbi.1005540.e080g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e080" xlink:type="simple"/><mml:math display="inline" id="M80"><mml:mrow><mml:mover accent="true"><mml:mi>ρ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>l</mml:mi> <mml:mo>,</mml:mo> <mml:mi>m</mml:mi> <mml:mo>;</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is the product of a spatial and a temporal part. Multivariate Gaussian distributions with this Kronecker structure can be more compactly reformulated as a matrix normal distribution (see [<xref ref-type="bibr" rid="pcbi.1005540.ref071">71</xref>]):
<disp-formula id="pcbi.1005540.e081"><alternatives><graphic id="pcbi.1005540.e081g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e081" xlink:type="simple"/><mml:math display="block" id="M81"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>R</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>∼</mml:mo> <mml:mi>M</mml:mi> <mml:mi>N</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mi>D</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>K</mml:mi> <mml:mi>ρ</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(34)</label></disp-formula>
where the matrix parameters <italic>D</italic> and <italic>K</italic><sub><italic>ρ</italic></sub> determine the covariance structure across, respectively, the spherical harmonics and time.</p>
<p>We define a spatiotemporal observation model in which the residuals have a spatiotemporal covariance structure of the form <italic>K</italic><sub><italic>ξ</italic></sub> ⊗ (Λ<italic>D</italic>Λ<sup><italic>T</italic></sup>). This implies that the spatial covariance matrix of the residuals (previously denoted as Σ) has the form Λ<italic>D</italic>Λ<sup><italic>T</italic></sup>. Thus, it is assumed that the residuals have the same spatial covariance as the brain activity of interest (see <xref ref-type="disp-formula" rid="pcbi.1005540.e069">Eq (28)</xref> but a different temporal covariance. Hence, <italic>ξ</italic>(<bold><italic>x</italic></bold>, <italic>t</italic>) should be interpreted as brain noise [<xref ref-type="bibr" rid="pcbi.1005540.ref072">72</xref>]. This assumption greatly simplifies the derivation of the posterior distribution. Under this observation model, the probability distribution of the spatiotemporal data matrix can be written as follows:
<disp-formula id="pcbi.1005540.e082"><alternatives><graphic id="pcbi.1005540.e082g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e082" xlink:type="simple"/><mml:math display="block" id="M82"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>Y</mml:mi> <mml:mo>∼</mml:mo> <mml:mi>M</mml:mi> <mml:mi>N</mml:mi> <mml:mo>(</mml:mo> <mml:mo>Λ</mml:mo> <mml:mover accent="true"><mml:mi>R</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>,</mml:mo> <mml:mo>Λ</mml:mo> <mml:mi>D</mml:mi> <mml:msup><mml:mo>Λ</mml:mo> <mml:mi>T</mml:mi></mml:msup> <mml:mo>,</mml:mo> <mml:msub><mml:mi>K</mml:mi> <mml:mi>ξ</mml:mi></mml:msub> <mml:mo>)</mml:mo> <mml:mspace width="3.33333pt"/><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(35)</label></disp-formula></p>
<p>The posterior expectation for this model can be obtained using the properties of Kronecker product matrices. This derivation is slightly technical and is reported in the supporting information. In this derivation, to enhance numerical stability, we introduce a Tikhonov regularization parameter <italic>λ</italic>. This allows us to deal with the fact that the matrix Λ<italic>D</italic>Λ<sup><italic>T</italic></sup> (which must be inverted), is usually close to singular for an MEG or EEG forward model. The resulting posterior expectation is the following:
<disp-formula id="pcbi.1005540.e083"><alternatives><graphic id="pcbi.1005540.e083g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e083" xlink:type="simple"/><mml:math display="block" id="M83"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>M</mml:mi> <mml:mrow><mml:mover accent="true"><mml:mi>R</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>|</mml:mo> <mml:mi>Y</mml:mi></mml:mrow></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msup><mml:mrow><mml:mi>D</mml:mi> <mml:mo>Λ</mml:mo></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:msup><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mo>Λ</mml:mo> <mml:mi>D</mml:mi> <mml:mo>Λ</mml:mo></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:mrow><mml:mo>+</mml:mo> <mml:mi>λ</mml:mi> <mml:mi>I</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mi>Y</mml:mi> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>K</mml:mi> <mml:mi>ρ</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>K</mml:mi> <mml:mi>ξ</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:msub><mml:mi>K</mml:mi> <mml:mi>ρ</mml:mi></mml:msub> <mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(36)</label></disp-formula>
Besides regularizing the matrix inversion, the <italic>λI</italic> term contributes to filtering out the spatially non-structured observation noise. This is consistent with the fact that the regularization matrix replaces the noise spatial covariance matrix in <xref ref-type="disp-formula" rid="pcbi.1005540.e069">Eq (28)</xref> and, being diagonal, corresponds to spatially white noise. In the spatial domain, <xref ref-type="disp-formula" rid="pcbi.1005540.e083">Eq (36)</xref> becomes:
<disp-formula id="pcbi.1005540.e084"><alternatives><graphic id="pcbi.1005540.e084g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e084" xlink:type="simple"/><mml:math display="block" id="M84"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>M</mml:mi> <mml:mrow><mml:mi>R</mml:mi> <mml:mo>|</mml:mo> <mml:mi>Y</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mi>P</mml:mi> <mml:mi>Y</mml:mi> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>K</mml:mi> <mml:mi>ρ</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>K</mml:mi> <mml:mi>ξ</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:msub><mml:mi>K</mml:mi> <mml:mi>ρ</mml:mi></mml:msub> <mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(37)</label></disp-formula>
Therefore, the spatiotemporal expectation is obtained by applying the Harmony spatial filter (with Σ = <italic>λI</italic>) to the expectation of the temporal model given by <xref ref-type="disp-formula" rid="pcbi.1005540.e036">Eq (19)</xref>. We can now apply this to the situation in which we want to estimate some component of interest, such as <italic>φ</italic>(<bold><italic>x</italic></bold>, <italic>t</italic>), in the presence of other components <italic>ζ</italic>(<bold><italic>x</italic></bold>, <italic>t</italic>) = <italic>χ</italic>(<bold><italic>x</italic></bold>, <italic>t</italic>) + <italic>ψ</italic>(<bold><italic>x</italic></bold>, <italic>t</italic>) + <italic>ξ</italic>(<bold><italic>x</italic></bold>, <italic>t</italic>). In analogy with <xref ref-type="disp-formula" rid="pcbi.1005540.e036">Eq (19)</xref>, the marginal expectation of the spatiotemporal component <italic>φ</italic>(<bold><italic>x</italic></bold>, <italic>t</italic>) is given by
<disp-formula id="pcbi.1005540.e085"><alternatives><graphic id="pcbi.1005540.e085g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e085" xlink:type="simple"/><mml:math display="block" id="M85"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>M</mml:mi> <mml:mrow><mml:mo>Φ</mml:mo> <mml:mo>|</mml:mo> <mml:mi>Y</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mi>P</mml:mi> <mml:mi>Y</mml:mi> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>K</mml:mi> <mml:mi>φ</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>K</mml:mi> <mml:mi>ζ</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:msub><mml:mi>K</mml:mi> <mml:mi>φ</mml:mi></mml:msub> <mml:mspace width="0.166667em"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(38)</label></disp-formula>
where <italic>K</italic><sub><italic>ζ</italic></sub> is the temporal covariance matrix of <italic>ζ</italic>(<bold><italic>x</italic></bold>, <italic>t</italic>) = <italic>χ</italic>(<bold><italic>x</italic></bold>, <italic>t</italic>) + <italic>ψ</italic>(<bold><italic>x</italic></bold>, <italic>t</italic>) + <italic>ξ</italic>(<bold><italic>x</italic></bold>, <italic>t</italic>). This formula allows to individually reconstruct the dynamic components.</p>
</sec>
</sec>
<sec id="sec033">
<title>Estimating the model parameters</title>
<p>We estimate the parameters of the covariance functions from all the data of each participant using an empirical Bayes method. This produces a prior distribution that is both informed by the participant-specific signal dynamics and flexible enough to account for the variability across different epochs. Specifically, given <italic>K</italic> trials, the parameters are estimated from the empirical autocovariance matrix <italic>S</italic> of the total measured time series:
<disp-formula id="pcbi.1005540.e086"><alternatives><graphic id="pcbi.1005540.e086g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e086" xlink:type="simple"/><mml:math display="block" id="M86"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>S</mml:mi> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>K</mml:mi></mml:munderover> <mml:msub><mml:mi>Y</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:msubsup><mml:mi>Y</mml:mi> <mml:mrow><mml:mi>k</mml:mi></mml:mrow> <mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(39)</label></disp-formula>
where <italic>Y</italic><sub><italic>k</italic></sub> denotes the demeaned (mean-subtracted) spatiotemporal data matrix of an experimental trial <italic>k</italic>. For notational convenience, we organize all the parameters of the model covariance function in the vector <italic>ϑ</italic>. Furthermore, we make the dependence on the parameters explicit by denoting the total covariance function of the total additive model as
<disp-formula id="pcbi.1005540.e087"><alternatives><graphic id="pcbi.1005540.e087g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e087" xlink:type="simple"/><mml:math display="block" id="M87"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>k</mml:mi> <mml:mi>ρ</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>;</mml:mo> <mml:mi mathvariant="bold-italic">ϑ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mi>φ</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>;</mml:mo> <mml:mi mathvariant="bold-italic">ϑ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mi>χ</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>;</mml:mo> <mml:mi mathvariant="bold-italic">ϑ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mi>ψ</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>;</mml:mo> <mml:mi mathvariant="bold-italic">ϑ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mi>ξ</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>;</mml:mo> <mml:mi mathvariant="bold-italic">ϑ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(40)</label></disp-formula></p>
<p>As the objective function to be minimized, we use the sum of the squared deviations of the measured time series’ auto-covariance from the covariance function of our model:
<disp-formula id="pcbi.1005540.e088"><alternatives><graphic id="pcbi.1005540.e088g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e088" xlink:type="simple"/><mml:math display="block" id="M88"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>C</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">ϑ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:munder> <mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mi>ρ</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>;</mml:mo> <mml:mi mathvariant="bold-italic">ϑ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfenced></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(41)</label></disp-formula>
This objective function is, in general, multimodal and requires the use of a robust optimization technique. Gradient-based methods can be unstable since they can easily lead to sub-optimal local-minima. For that reason we used a gradient-free simulated annealing strategy. The details of the simulated annealing algorithm are described in [<xref ref-type="bibr" rid="pcbi.1005540.ref024">24</xref>]. As proposal distribution we used
<disp-formula id="pcbi.1005540.e089"><alternatives><graphic id="pcbi.1005540.e089g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e089" xlink:type="simple"/><mml:math display="block" id="M89"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>ϑ</mml:mi> <mml:mi>j</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>k</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>t</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>ϑ</mml:mi> <mml:mi>j</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>k</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>|</mml:mo> <mml:msubsup><mml:mi>ϑ</mml:mi> <mml:mi>j</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:msub><mml:mi>γ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(42)</label></disp-formula>
where <italic>t</italic>(<italic>x</italic>|<italic>a</italic>, <italic>b</italic>, <italic>c</italic>) denotes a univariate Student’s t-distribution over <italic>x</italic> with mean <italic>a</italic>, scale <italic>b</italic> and <italic>c</italic> degrees of freedom. We chose this distribution because the samples can span several order of magnitudes, thereby allowing both a quick convergence to the low cost region and an effective fine tuning at the final stages. We used the following annealing schedule:
<disp-formula id="pcbi.1005540.e090"><alternatives><graphic id="pcbi.1005540.e090g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e090" xlink:type="simple"/><mml:math display="block" id="M90"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>T</mml:mi> <mml:mo>(</mml:mo> <mml:mi>n</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>8</mml:mn> <mml:mo>·</mml:mo> <mml:mi>T</mml:mi> <mml:mo>(</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo> <mml:mspace width="0.166667em"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(43)</label></disp-formula>
where <italic>T</italic>(0) was initialized at 10 and the algorithm stopped when the temperature was smaller than 10<sup>−8</sup>.</p>
<p>We estimated all the temporal parameters of the model. Specifically, the estimated parameters were the following: (a) the alpha frequency <inline-formula id="pcbi.1005540.e091"><alternatives><graphic id="pcbi.1005540.e091g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e091" xlink:type="simple"/><mml:math display="inline" id="M91"><mml:mrow><mml:mi>ω</mml:mi> <mml:mo>=</mml:mo> <mml:msqrt><mml:mrow><mml:msubsup><mml:mi>ω</mml:mi> <mml:mn>0</mml:mn> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mn>4</mml:mn> <mml:msup><mml:mi>b</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mrow></mml:math></alternatives></inline-formula>, phase decay <italic>β</italic><sub><italic>φ</italic></sub> = 1/2<italic>b</italic><sub><italic>φ</italic></sub>, and amplitude <inline-formula id="pcbi.1005540.e092"><alternatives><graphic id="pcbi.1005540.e092g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e092" xlink:type="simple"/><mml:math display="inline" id="M92"><mml:mrow><mml:msub><mml:mi mathvariant="script">A</mml:mi> <mml:mi>φ</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>φ</mml:mi></mml:msub> <mml:mo>/</mml:mo> <mml:msqrt><mml:mrow><mml:mn>2</mml:mn> <mml:msub><mml:mi>b</mml:mi> <mml:mi>φ</mml:mi></mml:msub></mml:mrow></mml:msqrt></mml:mrow></mml:math></alternatives></inline-formula>, (b) the second order integrator parameters <italic>z</italic>, <italic>β</italic><sub><italic>χ</italic></sub> = 1/2<italic>b</italic><sub><italic>χ</italic></sub>, and its amplitude <inline-formula id="pcbi.1005540.e093"><alternatives><graphic id="pcbi.1005540.e093g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e093" xlink:type="simple"/><mml:math display="inline" id="M93"><mml:mrow><mml:msub><mml:mi mathvariant="script">A</mml:mi> <mml:mi>χ</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>χ</mml:mi></mml:msub> <mml:mo>/</mml:mo> <mml:msqrt><mml:mrow><mml:mn>2</mml:mn> <mml:msub><mml:mi>b</mml:mi> <mml:mi>χ</mml:mi></mml:msub></mml:mrow></mml:msqrt></mml:mrow></mml:math></alternatives></inline-formula>, (c) the first order integrator decay constant <italic>c</italic> and its amplitude <inline-formula id="pcbi.1005540.e094"><alternatives><graphic id="pcbi.1005540.e094g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e094" xlink:type="simple"/><mml:math display="inline" id="M94"><mml:mrow><mml:msub><mml:mi mathvariant="script">A</mml:mi> <mml:mi>ψ</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>ψ</mml:mi></mml:msub> <mml:mo>/</mml:mo> <mml:msqrt><mml:mrow><mml:mn>2</mml:mn> <mml:msub><mml:mi>b</mml:mi> <mml:mi>ψ</mml:mi></mml:msub></mml:mrow></mml:msqrt></mml:mrow></mml:math></alternatives></inline-formula>, and (d) the residual’s time scale <italic>δ</italic>, and standard deviation <italic>σ</italic><sub><italic>ξ</italic></sub>. The parameters were initialized at plausible values (e.g. 10 Hz for the oscillator frequency) and were constrained to stay within realistic intervals (6–15 Hz for alpha frequency, positive for <italic>β</italic><sub><italic>φ</italic></sub>, <italic>β</italic><sub><italic>χ</italic></sub>, <italic>c</italic>, <italic>δ</italic> and all the amplitudes).</p>
</sec>
<sec id="sec034">
<title>Details of the simulation studies</title>
<p>In this subsection we describe our three simulation studies in detail.</p>
<sec id="sec035">
<title>Simulation study I: Recovering components from complex spatiotemporal neural signals</title>
<p>The oscillatory time series were generated as a non-Gaussian random process according to the following formula:
<disp-formula id="pcbi.1005540.e095"><alternatives><graphic id="pcbi.1005540.e095g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005540.e095" xlink:type="simple"/><mml:math display="block" id="M95"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>y</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msqrt><mml:mrow><mml:msup><mml:mi>a</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msqrt> <mml:mo form="prefix">cos</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ω</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mi>γ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>ξ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>ψ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(44)</label></disp-formula>
The random initial phase <italic>γ</italic> in this formula was drawn from a uniform distribution and the functions <italic>a</italic>(<italic>t</italic>) and <italic>ω</italic>(<italic>t</italic>) are Gaussian processes with a squared exponential covariance function (see <xref ref-type="disp-formula" rid="pcbi.1005540.e030">Eq (14)</xref>). The noise processes <italic>ξ</italic>(<italic>t</italic>) and <italic>ψ</italic>(<italic>t</italic>) were respectively an OU process (with relaxation coefficient equal to 10) and white noise. The source model was one-dimensional, composed of 9 different spatial locations from -2 mm to 2 mm in steps of 0.5 mm. The oscillatory processes had a Gaussian spatial profile with the center located at -0.5 mm for the low frequency oscillation and 0.5 mm for the high frequency oscillation. There were two independent sources of OU noise (with standard deviation equal to 0.6 each) with Gaussian spatial profiles with centers located at -1.5 mm and 1.5 mm and width equal to 1 mm. Finally, the data was corrupted by spatiotemporal white noise (with standard deviation equal to 0.1). We had four conditions: a) low spatial and low spectral overlap, b) low spatial and high spectral overlap, c) high spatial and low spectral overlap and d) high spatial and high spectral overlap. The peak frequency of the slow oscillation was 5 Hz for low spectral overlap conditions and 8 Hz for high spectral overlap conditions while the peak frequency of the fast oscillation was always 10 Hz. In the low and in the high spatial overlap conditions the widths of the spatial profiles of both oscillations were respectively 1 mm and 2 mm. For each condition, we generated 600 trials. The fast oscillation was reconstructed using SGPD, SSA, EMD, ICA and PCA. The spatial covariance matrix for the SGPD was obtained by discounting the spatial frequencies using the discount function in <xref ref-type="disp-formula" rid="pcbi.1005540.e056">Eq 23</xref>. The parameters were <italic>l</italic> = 0.2 and <italic>k</italic> = 5. The additive temporal covariance function of the SGPD had two oscillatory components, a first order integrator component and a squared exponential residual component. All the parameters of the temporal covariance function were inferred from the data using the least squares fit. Performance of each method was evaluated by computing the correlation between the true oscillatory signal (ground truth) and the recovered fast oscillatory component. Since the components obtained from SSA, EMD, ICA and PCA are unlabeled, for these methods we selected the component that maximized the correlation.</p>
</sec>
<sec id="sec036">
<title>Simulation study II: Estimating modulations in oscillatory amplitude</title>
<p>The study consisted of two simulated experimental conditions that differed only with respect to their mean oscillatory amplitude. In this simulation the signals were purely temporal, as we did not model the spatial extent of the sources. In each trial a single oscillatory time series was generated using <xref ref-type="disp-formula" rid="pcbi.1005540.e095">Eq 44</xref>. The mean of its angular frequency <italic>ω</italic>(<italic>t</italic>) was equal to 2<italic>π</italic> ⋅ 10 (the typical frequency of alpha oscillations) for both experimental conditions. In the low-amplitude condition the mean oscillatory amplitude was equal to 1. This oscillatory time series was corrupted by an OU process (amplitude equal to 0.55; relaxation coefficient equal to 10) and white noise (amplitude equal to 0.55). The simulation design involved 16 levels characterized by amplitude differences ranging from 15% to 60%. For each level, we generated 150,000 trials per experimental condition, giving us very reliable estimates of the effect size. The trials were 2 s long. We used the temporal GP-based decomposition to extract the oscillatory component from the simulated time series. The effect sizes were quantified as the between-condition differences between the trial-averaged amplitudes divided by the across-trials standard deviation of the amplitudes. We compared the sensitivity of the GP-based decomposition with non-parametric spectral estimation using DPSS multitaper spectral analysis as described in [<xref ref-type="bibr" rid="pcbi.1005540.ref030">30</xref>]. For every trial, the mean oscillatory amplitude was obtained by averaging over the amplitude estimates for the orthogonal tapers. In this method, the number of tapers is a free parameter that determines the degree of spectral smoothing. For each cell of the simulation design we chose the number of tapers that maximized the effect size. This selection procedure is biased in favor of the multitaper method since it tends to overfit the data and therefore produces larger effect sizes.</p>
</sec>
<sec id="sec037">
<title>Simulation study III: Localizing the source of an oscillatory amplitude modulation</title>
<p>A template cortical surface mesh was created using Freesurfer [<xref ref-type="bibr" rid="pcbi.1005540.ref023">23</xref>], down-sampled using the MNE toolbox [<xref ref-type="bibr" rid="pcbi.1005540.ref073">73</xref>], and aligned to a template MEG sensor configuration. We ran 500 trials, each involving two conditions that differed only with respect to the oscillatory amplitude of one cortical location. Sources were generated at three locations in the brain: one in the right parieto-temporal, one in the right occipital and one in the left parietal cortex. For each trial and condition, we generated three time series with the same temporal structure as those generated in the previous simulation study. The three time series were localized in cortical mesh with a spatial profile that is proportional to a Fisher-von Mises distribution. These spatial profiles can model a localized patch of activity. The dipole orientation was set to be orthogonal to the mesh surface. While all patches of activity contained the oscillatory component, only one patch involved an amplitude modulation between the two experimental conditions, and this was set at 20%. The activity was projected to the MEG sensors using a forward model obtained from a realistic head model [<xref ref-type="bibr" rid="pcbi.1005540.ref031">31</xref>]. The effect was computed for each cortical vertex as the difference in average oscillatory amplitude between the two conditions.</p>
<p>The oscillatory signal was first reconstructed at each cortical vertex using the spatiotemporal GP-based decomposition. Next, as in the simulation study for the single sensor, the GP estimate of average oscillatory amplitude was obtained as the standard deviation of the estimate of the oscillatory component. We compared the spatiotemporal GP-based decomposition with the Harmony source reconstruction of the estimated cross-spectral density matrix. Using the DPSS multitaper spectral analysis, we first estimated the sensor-level cross-spectral density matrix <italic>F</italic>. Next, we projected this matrix to the source level by sandwiching it between the Harmony spatial filters (see <xref ref-type="disp-formula" rid="pcbi.1005540.e071">Eq (29)</xref>): <italic>F</italic><sub><italic>H</italic></sub> = <italic>PFP</italic><sup><italic>T</italic></sup>. The source level amplitude is obtained by taking the square root of the diagonal elements of <italic>F</italic><sub><italic>H</italic></sub>. The spectral smoothing was kept fixed at 0.6 Hz since we found this value to be optimal given the simulation parameters.</p>
</sec>
</sec>
<sec id="sec038">
<title>Details of the application to an MEG study on anticipatory spatial attention</title>
<sec id="sec039">
<title>Participants and data collection</title>
<p>We tested the spatiotemporal GP source reconstruction method on a cued tactile detection experiment in which the magneto-encephalogram (MEG) was recorded [<xref ref-type="bibr" rid="pcbi.1005540.ref026">26</xref>]. The study was conducted in accordance with the Declaration of Helsinki and approved by the local ethics committee (CMO Regio Arnhem-Nijmegen). Informed written consent was obtained from all participants. Fourteen healthy participants (5 male; 22–49 yr) participated in the study. The MEG system (CTF MEG; MISL, Coquitlam, British Columbia, Canada) had 273 axial gradiometers and was located in a magnetically shielded room. The head position was determined by localization coils fixed to anatomic landmarks (nasion and ears). The data were low-pass filtered (300-Hz cutoff), digitized at 1,200 Hz and stored for offline analysis.</p>
</sec>
<sec id="sec040">
<title>Experimental design</title>
<p>The experiment was a tactile detection task in which the location and timing of the targets were either cued or not. A short auditory stimulus (50 ms, white noise) was presented together with an electrotactile stimulus (0.5-ms electric pulse close to threshold intensity) in half of the trials. In the other half the auditory stimulus was presented alone. Participants were asked to indicate if a tactile stimulus was presented. In one-third of the trials, an auditory cue (150 ms, pure tone) informed the participants about the timing and the location at which the tactile stimulus might occur. In particular, the target auditory signal was always presented 1.5 s after the cue. Two independent sessions were collected for each participant. More details can be found in [<xref ref-type="bibr" rid="pcbi.1005540.ref033">33</xref>].</p>
</sec>
<sec id="sec041">
<title>MEG preprocessing</title>
<p>Third-order synthetic gradients were used to attenuate the environmental noise [<xref ref-type="bibr" rid="pcbi.1005540.ref074">74</xref>]. In addition, extra-cerebral physiological sources such as heartbeat and eye movements were detected using independent component analysis [<xref ref-type="bibr" rid="pcbi.1005540.ref011">11</xref>] and regressed out from the signal prior to the spatiotemporal GP-based decomposition.</p>
</sec>
<sec id="sec042">
<title>Details of the GP spatiotemporal data analysis</title>
<p>We started the GP analysis by learning the parameters of the additive dynamical model for each individual participant using the simulated annealing method. To reduce the contribution of low-amplitude noise, we estimated this matrix from the first 50 principal components of the total empirical temporal cross-covariance matrix averaged over all sensors. A template cortical surface mesh was created using Freesurfer [<xref ref-type="bibr" rid="pcbi.1005540.ref023">23</xref>], downsampled using the MNE toolbox [<xref ref-type="bibr" rid="pcbi.1005540.ref073">73</xref>], and aligned to the MEG sensors using the measured head position. The Tikhonov regularization parameter <italic>λ</italic> was identified for each participant using leave-one-out cross-validation [<xref ref-type="bibr" rid="pcbi.1005540.ref032">32</xref>]. The spatial smoothing parameters <italic>k</italic> and <italic>υ</italic> were set to, respectively, 2 and 3. The spatiotemporal GP-based decomposition was applied to 1.8 s long segments, starting ten milliseconds before the presentation of the cue and ending ten milliseconds after the target stimulus. The alpha amplitude envelope <italic>A</italic>(<italic>t</italic>, <italic>x</italic>) was obtained for all cortical vertices and dipole directions by performing a Hilbert transform on the estimated alpha signal and taking the absolute value of the resulting analytic signal [<xref ref-type="bibr" rid="pcbi.1005540.ref061">61</xref>]. For each cortical location, the total amplitude was obtained by summing the amplitude envelopes for the three independent dipole directions <italic>φ</italic><sub>1</sub>(<bold><italic>x</italic></bold>, <italic>t</italic>), <italic>φ</italic><sub>2</sub>(<bold><italic>x</italic></bold>, <italic>t</italic>), and <italic>φ</italic><sub>3</sub>(<bold><italic>x</italic></bold>, <italic>t</italic>). The individual topographic maps of the attention-induced alpha amplitude suppression were obtained by computing the mean amplitude difference between cued and non-cued trials, separately for each vertex and time point. These individual maps were then averaged across participants, again for each vertex and time point.</p>
</sec>
<sec id="sec043">
<title>Statistical analysis</title>
<p>For each cortical vertex, the dynamic effect was quantified as the rate of change of the attention-induced alpha amplitude suppression as a function of elapsed time from cue onset. Specifically, we used linear regression to estimate the slope of the relation between attention-induced alpha amplitude suppression and time. We did this separately for every vertex. The cortical maps of regression coefficients were constructed from the first experimental session of every participant and then averaged across participants. This map was subsequently used as data-driven hypothesis which was tested using the data from the second session. As a test statistic, we used the dot product between the individual regression coefficients maps, computed from the second sessions, and the group-level map. Under the null hypothesis that the group-level map is not systematic (i.e., is driven by noise only), the expected value of this test statistic is zero. Therefore we tested this null hypothesis using a one-sample t-test.</p>
</sec>
</sec>
</sec>
<sec id="sec044">
<title>Supporting information</title>
<supplementary-material id="pcbi.1005540.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005540.s001" xlink:type="simple">
<label>S1 Supporting Information</label>
<caption>
<title/>
<p>S1 Appendix: Covariance functions defined by linear SDEs. Brief review of the technique used for obtaining the covariance function from the SDE. S2 Appendix: Spherical harmonics and spherical Fourier transform. Brief review of the spherical Fourier transform. S3 Appendix: Properties of the Kronecker product and GP regression with separable covariance matrices. Derivation of the spatiotemporal posterior expectation using Kronecker product matrices. S4 Appendix: Modeling vector-valued sources using block matrices. Generalization of the method to vector valued dipolar sources.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="pcbi.1005540.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cheyne</surname> <given-names>DO</given-names></name>. <article-title>MEG studies of sensorimotor rhythms: A review</article-title>. <source>Exp Neurol</source>. <year>2013</year>;<volume>245</volume>:<fpage>27</fpage>–<lpage>39</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.expneurol.2012.08.030" xlink:type="simple">10.1016/j.expneurol.2012.08.030</ext-link></comment> <object-id pub-id-type="pmid">22981841</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005540.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Roux</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Uhlhaas</surname> <given-names>PJ</given-names></name>. <article-title>Working memory and neural oscillations: Alpha–gamma versus theta–gamma codes for distinct WM information?</article-title> <source>Trends Cogn Sci</source>. <year>2014</year>;<volume>18</volume>(<issue>1</issue>):<fpage>16</fpage>–<lpage>25</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.tics.2013.10.010" xlink:type="simple">10.1016/j.tics.2013.10.010</ext-link></comment> <object-id pub-id-type="pmid">24268290</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005540.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Basar</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Guntekin</surname> <given-names>B</given-names></name>. <article-title>Review of delta, theta, alpha, beta, and gamma response oscillations in neuropsychiatric disorders</article-title>. <source>Suppl Clin Neurophysiol</source>. <year>2013</year>;<volume>62</volume>:<fpage>303</fpage>–<lpage>341</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/B978-0-7020-5307-8.00019-3" xlink:type="simple">10.1016/B978-0-7020-5307-8.00019-3</ext-link></comment> <object-id pub-id-type="pmid">24053047</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005540.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tallon-Baudry</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Bertrand</surname> <given-names>O</given-names></name>. <article-title>Oscillatory gamma activity in humans and its role in object representation</article-title>. <source>Trends Cogn Sci</source>. <year>1999</year>;<volume>3</volume>(<issue>4</issue>):<fpage>151</fpage>–<lpage>162</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S1364-6613(99)01299-1" xlink:type="simple">10.1016/S1364-6613(99)01299-1</ext-link></comment> <object-id pub-id-type="pmid">10322469</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005540.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Engel</surname> <given-names>AK</given-names></name>, <name name-style="western"><surname>Fries</surname> <given-names>P</given-names></name>. <article-title>Beta–band oscillations: Signalling the status quo?</article-title> <source>Curr Opin Neurobiol</source>. <year>2010</year>;<volume>20</volume>(<issue>2</issue>):<fpage>156</fpage>–<lpage>165</lpage>. <object-id pub-id-type="pmid">20359884</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005540.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kirschfeld</surname> <given-names>K</given-names></name>. <article-title>Alpha waves: A new tool to investigate visual attention with high temporal resolution</article-title>. <source>Invest Ophthalmol Vis Sci</source>. <year>2005</year>;<volume>46</volume>(<issue>13</issue>):<fpage>5654</fpage>–<lpage>5654</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005540.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Klimesch</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Sauseng</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Hanslmayr</surname> <given-names>S</given-names></name>. <article-title>EEG alpha oscillations: The inhibition–timing hypothesis</article-title>. <source>Brain Res Rev</source>. <year>2007</year>;<volume>53</volume>(<issue>1</issue>):<fpage>63</fpage>–<lpage>88</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.brainresrev.2006.06.003" xlink:type="simple">10.1016/j.brainresrev.2006.06.003</ext-link></comment> <object-id pub-id-type="pmid">16887192</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005540.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Jensen</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Mazaheri</surname> <given-names>A</given-names></name>. <article-title>Shaping functional architecture by oscillatory alpha activity: gating by inhibition</article-title>. <source>Front Hum Neurosci</source>. <year>2010</year>;<volume>4</volume>:<fpage>186</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.3389/fnhum.2010.00186" xlink:type="simple">10.3389/fnhum.2010.00186</ext-link></comment> <object-id pub-id-type="pmid">21119777</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005540.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bressloff</surname> <given-names>PC</given-names></name>. <article-title>Spatiotemporal dynamics of continuum neural fields</article-title>. <source>J Phys A Math Theor</source>. <year>2011</year>;<volume>45</volume> 033001(<issue>3</issue>):<fpage>1</fpage>–<lpage>109</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005540.ref010">
<label>10</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Rasmussen</surname> <given-names>CE</given-names></name>. <source>Gaussian Processes for Machine Learning</source>. <publisher-name>MIT Press</publisher-name>; <year>2006</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005540.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Comon</surname> <given-names>P</given-names></name>. <article-title>Independent component analysis, a new concept?</article-title> <source>Signal Process</source>. <year>1994</year>;<volume>36</volume>(<issue>3</issue>):<fpage>287</fpage>–<lpage>314</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/0165-1684(94)90029-9" xlink:type="simple">10.1016/0165-1684(94)90029-9</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005540.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tipping</surname> <given-names>ME</given-names></name>, <name name-style="western"><surname>Bishop</surname> <given-names>CM</given-names></name>. <article-title>Probabilistic principal component analysis</article-title>. <source>J R Stat Soc Series B</source>. <year>1999</year>;<volume>61</volume>(<issue>3</issue>):<fpage>611</fpage>–<lpage>622</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/1467-9868.00196" xlink:type="simple">10.1111/1467-9868.00196</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005540.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hämäläinen</surname> <given-names>MS</given-names></name>, <name name-style="western"><surname>Ilmoniemi</surname> <given-names>RJ</given-names></name>. <article-title>Interpreting magnetic fields of the brain: minimum norm estimates</article-title>. <source>Med Biol Eng Comput</source>. <year>1994</year>;<volume>32</volume>(<issue>1</issue>):<fpage>35</fpage>–<lpage>42</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/BF02512476" xlink:type="simple">10.1007/BF02512476</ext-link></comment> <object-id pub-id-type="pmid">8182960</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005540.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pascual-Marqui</surname> <given-names>RD</given-names></name>, <name name-style="western"><surname>Esslen</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Kochi</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Lehmann</surname> <given-names>D</given-names></name>. <article-title>Functional imaging with low-resolution brain electromagnetic tomography (LORETA): A review</article-title>. <source>Methods Find Exp Clin Pharmacol</source>. <year>2002</year>;<volume>24</volume>(<issue>Suppl C</issue>):<fpage>91</fpage>–<lpage>95</lpage>. <object-id pub-id-type="pmid">12575492</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005540.ref015">
<label>15</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Tarantola</surname> <given-names>A</given-names></name>. <source>Inverse problem theory and methods for model parameter estimation</source>. <publisher-name>SIAM</publisher-name>; <year>2005</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005540.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Petrov</surname> <given-names>Y</given-names></name>. <article-title>Harmony: EEG/MEG linear inverse source reconstruction in the anatomical basis of spherical harmonics</article-title>. <source>PLoS one</source>. <year>2012</year>;<volume>7</volume>(<issue>10</issue>):<fpage>e44439</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0044439" xlink:type="simple">10.1371/journal.pone.0044439</ext-link></comment> <object-id pub-id-type="pmid">23071497</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005540.ref017">
<label>17</label>
<mixed-citation publication-type="other" xlink:type="simple">Solin A, Jylänki P, Kauramäki J, Heskes T, van Gerven MAJ, Särkkä S. Regularizing solutions to the MEG inverse problem using space–time separable covariance functions. arXiv preprint. 2016; p. 1604.04931.</mixed-citation>
</ref>
<ref id="pcbi.1005540.ref018">
<label>18</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Izhikevich</surname> <given-names>EM</given-names></name>. <source>Dynamical systems in neuroscience</source>. <publisher-name>MIT Press</publisher-name>; <year>2007</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005540.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gray</surname> <given-names>CM</given-names></name>, <name name-style="western"><surname>Singer</surname> <given-names>W</given-names></name>. <article-title>Stimulus-specific neuronal oscillations in orientation columns of cat visual cortex</article-title>. <source>Proc Natl Acad Sci USA</source>. <year>1989</year>;<volume>86</volume>(<issue>5</issue>):<fpage>1698</fpage>–<lpage>1702</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.86.5.1698" xlink:type="simple">10.1073/pnas.86.5.1698</ext-link></comment> <object-id pub-id-type="pmid">2922407</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005540.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lubenov</surname> <given-names>EV</given-names></name>, <name name-style="western"><surname>Siapas</surname> <given-names>AG</given-names></name>. <article-title>Hippocampal theta oscillations are travelling waves</article-title>. <source>Nature</source>. <year>2009</year>;<volume>459</volume>(<issue>7246</issue>):<fpage>534</fpage>–<lpage>539</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature08010" xlink:type="simple">10.1038/nature08010</ext-link></comment> <object-id pub-id-type="pmid">19489117</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005540.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Silva</surname> <given-names>LR</given-names></name>, <name name-style="western"><surname>Amitai</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Connors</surname> <given-names>BW</given-names></name>. <article-title>Intrinsic oscillations of neocortex generated by layer 5 pyramidal neurons</article-title>. <source>Science</source>. <year>1991</year>;<volume>251</volume>(<issue>4992</issue>):<fpage>432</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1824881" xlink:type="simple">10.1126/science.1824881</ext-link></comment> <object-id pub-id-type="pmid">1824881</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005540.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ricciardi</surname> <given-names>LM</given-names></name>, <name name-style="western"><surname>Luigi</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Sacerdote</surname> <given-names>L</given-names></name>. <article-title>The Ornstein-Uhlenbeck process as a model for neuronal activity</article-title>. <source>Biol Cybern</source>. <year>1979</year>;<volume>35</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>9</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/BF01845839" xlink:type="simple">10.1007/BF01845839</ext-link></comment> <object-id pub-id-type="pmid">508846</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005540.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Fischl</surname> <given-names>B</given-names></name>. <article-title>FreeSurfer</article-title>. <source>Neuroimage</source>. <year>2012</year>;<volume>62</volume>(<issue>2</issue>):<fpage>774</fpage>–<lpage>781</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuroimage.2012.01.021" xlink:type="simple">10.1016/j.neuroimage.2012.01.021</ext-link></comment> <object-id pub-id-type="pmid">22248573</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005540.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kirkpatrick</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Gelatt</surname> <given-names>CD</given-names></name>, and <name name-style="western"><surname>Vecchi</surname> <given-names>Mario P</given-names></name>, <etal>et al</etal>. <article-title>Optimization by simulated annealing</article-title>. <source>Science</source>. <year>1983</year>;<volume>4598</volume>(<issue>220</issue>):<fpage>671</fpage>–<lpage>680</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.220.4598.671" xlink:type="simple">10.1126/science.220.4598.671</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005540.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Huang</surname> <given-names>NE</given-names></name>, <name name-style="western"><surname>Shen</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Long</surname> <given-names>SR</given-names></name>, <name name-style="western"><surname>Wu</surname> <given-names>MC</given-names></name>, <name name-style="western"><surname>Shih</surname> <given-names>HH</given-names></name>, <name name-style="western"><surname>Zheng</surname> <given-names>Q</given-names></name>, <etal>et al</etal>. <article-title>The empirical mode decomposition and the Hilbert spectrum for nonlinear and non-stationary time series analysis</article-title>. <source>Proc R Soc Lond A</source>. <year>1998</year>;<volume>454</volume>(<issue>1971</issue>):<fpage>903</fpage>–<lpage>995</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rspa.1998.0193" xlink:type="simple">10.1098/rspa.1998.0193</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005540.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Vautard</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Yiou</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Ghil</surname> <given-names>M</given-names></name>. <article-title>Singular-spectrum analysis: A toolkit for short, noisy chaotic signals</article-title>. <source>Physica D</source>. <year>1992</year>;<volume>58</volume>(<issue>1</issue>):<fpage>95</fpage>–<lpage>126</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/0167-2789(92)90103-T" xlink:type="simple">10.1016/0167-2789(92)90103-T</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005540.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Buckner</surname> <given-names>RL</given-names></name> and <name name-style="western"><surname>Vincent</surname> <given-names>JL</given-names></name>. <article-title>Singular-spectrum analysis: A toolkit for short, noisy chaotic signals</article-title>. <source>Neuroimage</source>. <year>2007</year>;<volume>37</volume>(<issue>4</issue>):<fpage>1091</fpage>–<lpage>1096</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005540.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Foxe</surname> <given-names>JJ</given-names></name>, <name name-style="western"><surname>Snyder</surname> <given-names>AC</given-names></name>. <article-title>The role of alpha–band brain oscillations as a sensory suppression mechanism during selective attention</article-title>. <source>Front Psychol</source>. <year>2011</year>;<volume>2</volume>:<fpage>154</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.3389/fpsyg.2011.00154" xlink:type="simple">10.3389/fpsyg.2011.00154</ext-link></comment> <object-id pub-id-type="pmid">21779269</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005540.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kelly</surname> <given-names>SP</given-names></name>, <name name-style="western"><surname>Lalor</surname> <given-names>EC</given-names></name>, <name name-style="western"><surname>Reilly</surname> <given-names>RB</given-names></name>, <name name-style="western"><surname>Foxe</surname> <given-names>JJ</given-names></name>. <article-title>Increases in alpha oscillatory power reflect an active retinotopic mechanism for distracter suppression during sustained visuospatial attention</article-title>. <source>J Neurophisyol</source>. <year>2006</year>;<volume>95</volume>(<issue>6</issue>):<fpage>3844</fpage>–<lpage>3851</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1152/jn.01234.2005" xlink:type="simple">10.1152/jn.01234.2005</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005540.ref030">
<label>30</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Percival</surname> <given-names>DB</given-names></name>, <name name-style="western"><surname>Walden</surname> <given-names>AT</given-names></name>. <source>Spectral analysis for physical applications</source>. <publisher-name>Cambridge University Press</publisher-name>; <year>1993</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005540.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Nolte</surname> <given-names>G</given-names></name>. <article-title>The magnetic lead field theorem in the quasi-static approximation and its use for magnetoencephalography forward calculation in realistic volume conductors</article-title>. <source>Phys Med Biol</source>. <year>2003</year>;<volume>48</volume>(<issue>22</issue>):<fpage>3637</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1088/0031-9155/48/22/002" xlink:type="simple">10.1088/0031-9155/48/22/002</ext-link></comment> <object-id pub-id-type="pmid">14680264</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005540.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Stone</surname> <given-names>M</given-names></name>. <article-title>Cross–validatory choice and assessment of statistical predictions</article-title>. <source>J R Stat Soc Series B</source>. <year>1974</year>;<volume>36</volume>:<fpage>111</fpage>–<lpage>147</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005540.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>van Ede</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Köster</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Maris</surname> <given-names>E</given-names></name>. <article-title>Beyond establishing involvement: Quantifying the contribution of anticipatory alpha–and beta-band suppression to perceptual improvement with attention</article-title>. <source>J Neurophisyol</source>. <year>2012</year>;<volume>108</volume>(<issue>9</issue>):<fpage>2352</fpage>–<lpage>2362</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1152/jn.00347.2012" xlink:type="simple">10.1152/jn.00347.2012</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005540.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>van Ede</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>de Lange</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Jensen</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Maris</surname> <given-names>E</given-names></name>. <article-title>Orienting attention to an upcoming tactile event involves a spatially and temporally specific modulation of sensorimotor alpha–and beta–band oscillations</article-title>. <source>J Neurosci</source>. <year>2011</year>;<volume>31</volume>(<issue>6</issue>):<fpage>2016</fpage>–<lpage>2024</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.5630-10.2011" xlink:type="simple">10.1523/JNEUROSCI.5630-10.2011</ext-link></comment> <object-id pub-id-type="pmid">21307240</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005540.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Deco</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Jirsa</surname> <given-names>VK</given-names></name>, <name name-style="western"><surname>Robinson</surname> <given-names>PA</given-names></name>, <name name-style="western"><surname>Breakspear</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Friston</surname> <given-names>K</given-names></name>. <article-title>The dynamic brain: From spiking neurons to neural masses and cortical fields</article-title>. <source>PLoS Comput Biol</source>. <year>2008</year>;<volume>4</volume>(<issue>8</issue>):<fpage>e1000092</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1000092" xlink:type="simple">10.1371/journal.pcbi.1000092</ext-link></comment> <object-id pub-id-type="pmid">18769680</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005540.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dickman</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Vidigal</surname> <given-names>R</given-names></name>. <article-title>Path integrals and perturbation theory for stochastic processes</article-title>. <source>Braz J Phys</source>. <year>2003</year>;<volume>33</volume>(<issue>1</issue>):<fpage>73</fpage>–<lpage>93</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1590/S0103-97332003000100005" xlink:type="simple">10.1590/S0103-97332003000100005</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005540.ref037">
<label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Freyer</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Aquino</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Robinson</surname> <given-names>PA</given-names></name>, <name name-style="western"><surname>Ritter</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Breakspear</surname> <given-names>M</given-names></name>. <article-title>Bistability and non-Gaussian fluctuations in spontaneous cortical activity</article-title>. <source>J Neurosci</source>. <year>2009</year>;<volume>29</volume>(<issue>26</issue>):<fpage>8512</fpage>–<lpage>8524</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.0754-09.2009" xlink:type="simple">10.1523/JNEUROSCI.0754-09.2009</ext-link></comment> <object-id pub-id-type="pmid">19571142</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005540.ref038">
<label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Osorio</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Frei</surname> <given-names>MG</given-names></name>, <name name-style="western"><surname>Sornette</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Milton</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Lai</surname> <given-names>YC</given-names></name>. <article-title>Epileptic seizures: Quakes of the brain?</article-title> <source>Phys Rev E Stat Nonlin Soft</source>. <year>2010</year>;<volume>82</volume>(<issue>2</issue>):<fpage>021919</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevE.82.021919" xlink:type="simple">10.1103/PhysRevE.82.021919</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005540.ref039">
<label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Golos</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Jirsa</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Daucé</surname> <given-names>E</given-names></name>. <article-title>Multistability in large scale models of brain activity</article-title>. <source>PLoS Comput Biol</source>. <year>2015</year>;<volume>11</volume>(<issue>12</issue>):<fpage>e1004644</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1004644" xlink:type="simple">10.1371/journal.pcbi.1004644</ext-link></comment> <object-id pub-id-type="pmid">26709852</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005540.ref040">
<label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ghosh</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Rho</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>McIntosh</surname> <given-names>AR</given-names></name>, <name name-style="western"><surname>Kötter</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Jirsa</surname> <given-names>VK</given-names></name>. <article-title>Noise during rest enables the exploration of the brain’s dynamic repertoire</article-title>. <source>PLoS Comput Biol</source>. <year>2008</year>;<volume>4</volume>(<issue>10</issue>):<fpage>e1000196</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1000196" xlink:type="simple">10.1371/journal.pcbi.1000196</ext-link></comment> <object-id pub-id-type="pmid">18846206</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005540.ref041">
<label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Breakspear</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Roberts</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Terry</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>Rodrigues</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Mahant</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Robinson</surname> <given-names>PA</given-names></name>. <article-title>A unifying explanation of primary generalized seizures through nonlinear brain modeling and bifurcation analysis</article-title>. <source>Cereb Cortex</source>. <year>2006</year>;<volume>16</volume>(<issue>9</issue>):<fpage>1296</fpage>–<lpage>1313</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/cercor/bhj072" xlink:type="simple">10.1093/cercor/bhj072</ext-link></comment> <object-id pub-id-type="pmid">16280462</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005540.ref042">
<label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Greicius</surname> <given-names>MD</given-names></name>, <name name-style="western"><surname>Supekar</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Menon</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Dougherty</surname> <given-names>RF</given-names></name>. <article-title>Resting–state functional connectivity reflects structural connectivity in the default mode network</article-title>. <source>Cereb Cortex</source>. <year>2009</year>;<volume>19</volume>(<issue>1</issue>):<fpage>72</fpage>–<lpage>78</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/cercor/bhn059" xlink:type="simple">10.1093/cercor/bhn059</ext-link></comment> <object-id pub-id-type="pmid">18403396</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005540.ref043">
<label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Stam</surname> <given-names>CJ</given-names></name>. <article-title>Functional connectivity patterns of human magnetoencephalographic recordings: A ‘small-world’ network?</article-title> <source>Neurosci Lett</source>. <year>2004</year>;<volume>355</volume>(<issue>1</issue>):<fpage>25</fpage>–<lpage>28</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005540.ref044">
<label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sporns</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Tononi</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Kötter</surname> <given-names>R</given-names></name>. <article-title>The human connectome: A structural description of the human brain</article-title>. <source>PLoS Comput Biol</source>. <year>2005</year>;<volume>1</volume>(<issue>4</issue>):<fpage>e42</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.0010042" xlink:type="simple">10.1371/journal.pcbi.0010042</ext-link></comment> <object-id pub-id-type="pmid">16201007</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005540.ref045">
<label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>van den Heuvel</surname> <given-names>MP</given-names></name>, <name name-style="western"><surname>Sporns</surname> <given-names>O</given-names></name>. <article-title>Rich–club organization of the human connectome</article-title>. <source>J Neurosci</source>. <year>2011</year>;<volume>31</volume>(<issue>44</issue>):<fpage>15775</fpage>–<lpage>15786</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.3539-11.2011" xlink:type="simple">10.1523/JNEUROSCI.3539-11.2011</ext-link></comment> <object-id pub-id-type="pmid">22049421</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005540.ref046">
<label>46</label>
<mixed-citation publication-type="other" xlink:type="simple">Särkkä S, Hartikainen J. Infinite–dimensional Kalman filtering approach to spatio–temporal Gaussian process regression. International Conference on Artificial Intelligence and Statistics. 2012; p. 993–1001.</mixed-citation>
</ref>
<ref id="pcbi.1005540.ref047">
<label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Solin</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Särkkä</surname> <given-names>S</given-names></name>. <article-title>Infinite–dimensional Bayesian filtering for detection of quasiperiodic phenomena in spatiotemporal data</article-title>. <source>Phys Rev E Stat Nonlin Soft</source>. <year>2013</year>;<volume>88</volume>(<issue>5</issue>):<fpage>052909</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevE.88.052909" xlink:type="simple">10.1103/PhysRevE.88.052909</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005540.ref048">
<label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zou</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Hastie</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Tibshirani</surname> <given-names>R</given-names></name>. <article-title>Sparse principal component analysis</article-title>. <source>J Comput Graph Stat</source>. <year>2006</year>;<volume>15</volume>(<issue>2</issue>):<fpage>265</fpage>–<lpage>286</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1198/106186006X113430" xlink:type="simple">10.1198/106186006X113430</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005540.ref049">
<label>49</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Schölkopf</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Smola</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Müller</surname> <given-names>KR</given-names></name>. <article-title>Nonlinear component analysis as a kernel eigenvalue problem</article-title>. <source>Neural Comput</source>. <year>1998</year>;<volume>10</volume>(<issue>5</issue>):<fpage>1299</fpage>–<lpage>1319</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1162/089976698300017467" xlink:type="simple">10.1162/089976698300017467</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005540.ref050">
<label>50</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kolda</surname> <given-names>TG</given-names></name>, <name name-style="western"><surname>Bader</surname> <given-names>BW</given-names></name>. <article-title>Tensor decompositions and applications</article-title>. <source>SIAM rev</source>. <year>2009</year>;<volume>51</volume>(<issue>3</issue>):<fpage>455</fpage>–<lpage>500</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1137/07070111X" xlink:type="simple">10.1137/07070111X</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005540.ref051">
<label>51</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>van der Meij</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Kahana</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Maris</surname> <given-names>E</given-names></name>. <article-title>Phase–amplitude coupling in human electrocorticography is spatially distributed and phase diverse</article-title>. <source>J Neurosci</source>. <year>2012</year>;<volume>32</volume>(<issue>1</issue>):<fpage>111</fpage>–<lpage>123</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.4816-11.2012" xlink:type="simple">10.1523/JNEUROSCI.4816-11.2012</ext-link></comment> <object-id pub-id-type="pmid">22219274</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005540.ref052">
<label>52</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>van der Meij</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Jacobs</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Maris</surname> <given-names>E</given-names></name>. <article-title>Uncovering phase–coupled oscillatory networks in electrophysiological data</article-title>. <source>Hum Brain Mapp</source>. <year>2015</year>;<volume>36</volume>(<issue>7</issue>):<fpage>2655</fpage>–<lpage>2680</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/hbm.22798" xlink:type="simple">10.1002/hbm.22798</ext-link></comment> <object-id pub-id-type="pmid">25864927</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005540.ref053">
<label>53</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ghil</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Allen</surname> <given-names>MR</given-names></name>, <name name-style="western"><surname>Dettinger</surname> <given-names>MD</given-names></name>, <name name-style="western"><surname>Ide</surname> <given-names>K</given-names></name> and others. <article-title>Advanced spectral methods for climatic time series</article-title> <source>Rev Geophys</source>. <year>2002</year>;<volume>40</volume>(<issue>1</issue>):<fpage>41</fpage>–<lpage>58</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005540.ref054">
<label>54</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Schmid</surname> <given-names>PJ</given-names></name>. <article-title>Dynamic mode decomposition of numerical and experimental data</article-title>. <source>J Fluid Mech</source>. <year>2010</year>;<volume>656</volume>:<fpage>5</fpage>–<lpage>28</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1017/S0022112010001217" xlink:type="simple">10.1017/S0022112010001217</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005540.ref055">
<label>55</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bronez</surname> <given-names>TP</given-names></name>. <article-title>On the performance advantage of multitaper spectral analysis</article-title>. <source>IEEE Trans Sig Process</source>. <year>1992</year>;<volume>40</volume>(<issue>12</issue>):<fpage>2941</fpage>–<lpage>2946</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/78.175738" xlink:type="simple">10.1109/78.175738</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005540.ref056">
<label>56</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Muthuswamy</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Thakor</surname> <given-names>N</given-names></name>. <article-title>Spectral analysis methods for neurological signals</article-title>. <source>J Neurosci Methods</source>. <year>1998</year>;<volume>83</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>14</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0165-0270(98)00065-X" xlink:type="simple">10.1016/S0165-0270(98)00065-X</ext-link></comment> <object-id pub-id-type="pmid">9765047</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005540.ref057">
<label>57</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pace</surname> <given-names>RK</given-names></name>, <name name-style="western"><surname>Barry</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Clapp</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Rodriquez</surname> <given-names>M</given-names></name>. <article-title>Spatiotemporal autoregressive models of neighborhood effects</article-title>. <source>J Real Eestate Financ Econ</source>. <year>1998</year>;<volume>17</volume>(<issue>1</issue>):<fpage>15</fpage>–<lpage>33</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1023/A:1007799028599" xlink:type="simple">10.1023/A:1007799028599</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005540.ref058">
<label>58</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Darvas</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Schmitt</surname> <given-names>U</given-names></name>, <name name-style="western"><surname>Louis</surname> <given-names>AK</given-names></name>, <name name-style="western"><surname>Fuchs</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Knoll</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Buchner</surname> <given-names>H</given-names></name>. <article-title>Spatio-temporal current density reconstruction (stCDR) from EEG/MEG-data</article-title>. <source>Brain Topogr</source>. <year>2001</year>;<volume>13</volume>(<issue>3</issue>):<fpage>195</fpage>–<lpage>207</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1023/A:1007855119092" xlink:type="simple">10.1023/A:1007855119092</ext-link></comment> <object-id pub-id-type="pmid">11302398</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005540.ref059">
<label>59</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Friston</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Harrison</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Daunizeau</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Kiebel</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Phillips</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Trujillo-Barreto</surname> <given-names>N</given-names></name>, <etal>et al</etal>. <article-title>Multiple sparse priors for the M/EEG inverse problem</article-title>. <source>Neuroimage</source>. <year>2008</year>;<volume>39</volume>(<issue>3</issue>):<fpage>1104</fpage>–<lpage>1120</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuroimage.2007.09.048" xlink:type="simple">10.1016/j.neuroimage.2007.09.048</ext-link></comment> <object-id pub-id-type="pmid">17997111</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005540.ref060">
<label>60</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Trujillo-Barreto</surname> <given-names>NJ</given-names></name>, <name name-style="western"><surname>Aubert-Vázquez</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Penny</surname> <given-names>WD</given-names></name>. <article-title>Bayesian M/EEG source reconstruction with spatio–temporal priors</article-title>. <source>Neuroimage</source>. <year>2008</year>;<volume>39</volume>(<issue>1</issue>):<fpage>318</fpage>–<lpage>335</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuroimage.2007.07.062" xlink:type="simple">10.1016/j.neuroimage.2007.07.062</ext-link></comment> <object-id pub-id-type="pmid">17904869</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005540.ref061">
<label>61</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dannhauer</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Lammel</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Wolters</surname> <given-names>CH</given-names></name>, <name name-style="western"><surname>Knosche</surname> <given-names>TR</given-names></name>. <article-title>Spatio-temporal regularization in linear distributed source reconstruction from EEG/MEG: a critical evaluation</article-title>. <source>Brain Topogr</source>. <year>2013</year>;<volume>26</volume>(<issue>2</issue>):<fpage>229</fpage>–<lpage>246</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s10548-012-0263-9" xlink:type="simple">10.1007/s10548-012-0263-9</ext-link></comment> <object-id pub-id-type="pmid">23112100</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005540.ref062">
<label>62</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>van Dijk</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Schoffelen</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Oostenveld</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Jensen</surname> <given-names>O</given-names></name>. <article-title>Prestimulus oscillatory activity in the alpha band predicts visual discrimination ability</article-title>. <source>J Neurosci</source>. <year>2008</year>;<volume>28</volume>(<issue>8</issue>):<fpage>1816</fpage>–<lpage>1823</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.1853-07.2008" xlink:type="simple">10.1523/JNEUROSCI.1853-07.2008</ext-link></comment> <object-id pub-id-type="pmid">18287498</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005540.ref063">
<label>63</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Volberg</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Kliegl</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Hanslmayr</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Greenlee</surname> <given-names>MW</given-names></name>. <article-title>EEG alpha oscillations in the preparation for global and local processing predict behavioral performance</article-title>. <source>Hum Brain Mapp</source>. <year>2009</year>;<volume>30</volume>(<issue>7</issue>):<fpage>2173</fpage>–<lpage>2183</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/hbm.20659" xlink:type="simple">10.1002/hbm.20659</ext-link></comment> <object-id pub-id-type="pmid">18830957</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005540.ref064">
<label>64</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rohenkohl</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Nobre</surname> <given-names>AC</given-names></name>. <article-title>Alpha oscillations related to anticipatory attention follow temporal expectations</article-title>. <source>J Neurosci</source>. <year>2011</year>;<volume>31</volume>(<issue>40</issue>):<fpage>14076</fpage>–<lpage>14084</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.3387-11.2011" xlink:type="simple">10.1523/JNEUROSCI.3387-11.2011</ext-link></comment> <object-id pub-id-type="pmid">21976492</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005540.ref065">
<label>65</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Culham</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Kanwisher</surname> <given-names>NG</given-names></name>. <article-title>Neuroimaging of cognitive functions in human parietal cortex</article-title>. <source>Curr Opin Neurobiol</source>. <year>2001</year>;<volume>11</volume>(<issue>2</issue>):<fpage>157</fpage>–<lpage>163</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0959-4388(00)00191-4" xlink:type="simple">10.1016/S0959-4388(00)00191-4</ext-link></comment> <object-id pub-id-type="pmid">11301234</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005540.ref066">
<label>66</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Corbetta</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Shulman</surname> <given-names>GL</given-names></name>. <article-title>Control of goal–directed and stimulus–driven attention in the brain</article-title>. <source>Nat Rev Neurosci</source>. <year>2002</year>;<volume>3</volume>(<issue>3</issue>):<fpage>201</fpage>–<lpage>215</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nrn755" xlink:type="simple">10.1038/nrn755</ext-link></comment> <object-id pub-id-type="pmid">11994752</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005540.ref067">
<label>67</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Betti</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Della Penna</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>de Pasquale</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Mantini</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Marzetti</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Romani</surname> <given-names>G</given-names></name>, <etal>et al</etal>. <article-title>Natural scenes viewing alters the dynamics of functional connectivity in the human brain</article-title>. <source>Neuron</source>. <year>2013</year>;<volume>79</volume>(<issue>4</issue>):<fpage>782</fpage>–<lpage>797</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuron.2013.06.022" xlink:type="simple">10.1016/j.neuron.2013.06.022</ext-link></comment> <object-id pub-id-type="pmid">23891400</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005540.ref068">
<label>68</label>
<mixed-citation publication-type="other" xlink:type="simple">Hensman, J and Fusi, N and Lawrence, ND. Gaussian processes for big data arXiv:1309.6835.</mixed-citation>
</ref>
<ref id="pcbi.1005540.ref069">
<label>69</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Betti</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Della Penna</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>de Pasquale</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Mantini</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Marzetti</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Romani</surname> <given-names>G</given-names></name>, <etal>et al</etal>. <article-title>Bayesian smoothing with Gaussian processes using Fourier basis functions in the spectralGP package</article-title>. <source>Journal of Statistical Software</source>. <year>2007</year>;<volume>19</volume>(<issue>2</issue>):<fpage>22751</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005540.ref070">
<label>70</label>
<mixed-citation publication-type="other" xlink:type="simple">Devaraju B, Sneeuw N. Performance analysis of isotropic spherical harmonic spectral windows. VII Hotine-Marussi Symposium on Mathematical Geodesy. 2012; p. 105–110.</mixed-citation>
</ref>
<ref id="pcbi.1005540.ref071">
<label>71</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dawid</surname> <given-names>AP</given-names></name>. <article-title>Some matrix–variate distribution theory: Notational considerations and a Bayesian application</article-title>. <source>Biometrika</source>. <year>1981</year>;<volume>68</volume>(<issue>1</issue>):<fpage>265</fpage>–<lpage>274</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/biomet/68.1.265" xlink:type="simple">10.1093/biomet/68.1.265</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005540.ref072">
<label>72</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mišić</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Mills</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Taylor</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>McIntosh</surname> <given-names>AR</given-names></name>. <article-title>Brain noise is task dependent and region specific</article-title>. <source>J Neurophysiol</source>. <year>2010</year>;<volume>104</volume>(<issue>5</issue>):<fpage>2667</fpage>–<lpage>2676</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1152/jn.00648.2010" xlink:type="simple">10.1152/jn.00648.2010</ext-link></comment> <object-id pub-id-type="pmid">20844116</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005540.ref073">
<label>73</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gramfort</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Luessi</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Larson</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Engemann</surname> <given-names>DA</given-names></name>, <name name-style="western"><surname>Strohmeier</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Brodbeck</surname> <given-names>C</given-names></name>, <etal>et al</etal>. <article-title>MNE software for processing MEG and EEG data</article-title>. <source>Neuroimage</source>. <year>2014</year>;<volume>86</volume>:<fpage>446</fpage>–<lpage>460</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuroimage.2013.10.027" xlink:type="simple">10.1016/j.neuroimage.2013.10.027</ext-link></comment> <object-id pub-id-type="pmid">24161808</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005540.ref074">
<label>74</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Vrba</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Robinson</surname> <given-names>SE</given-names></name>. <article-title>Signal processing in magnetoencephalography</article-title>. <source>Methods</source>. <year>2001</year>;<volume>25</volume>(<issue>2</issue>):<fpage>249</fpage>–<lpage>271</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1006/meth.2001.1238" xlink:type="simple">10.1006/meth.2001.1238</ext-link></comment> <object-id pub-id-type="pmid">11812209</object-id></mixed-citation>
</ref>
</ref-list>
</back>
</article>