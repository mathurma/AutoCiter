<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article article-type="research-article" dtd-version="1.1d3" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1004985</article-id>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-15-01800</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Genetic elements</subject><subj-group><subject>Mobile genetic elements</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Genomics</subject><subj-group><subject>Mobile genetic elements</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Microbiology</subject><subj-group><subject>Archaean biology</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Molecular biology</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Molecular biology assays and analysis techniques</subject><subj-group><subject>Phylogenetic analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Molecular biology assays and analysis techniques</subject><subj-group><subject>Phylogenetic analysis</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Proteins</subject><subj-group><subject>Proteomes</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Evolutionary biology</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Taxonomy</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Data management</subject><subj-group><subject>Taxonomy</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Computational techniques</subject><subj-group><subject>Split-decomposition method</subject><subj-group><subject>Multiple alignment calculation</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Evolutionary biology</subject><subj-group><subject>Evolutionary processes</subject><subj-group><subject>Horizontal gene transfer</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Gene transfer</subject><subj-group><subject>Horizontal gene transfer</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Molecular biology</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Sequencing techniques</subject><subj-group><subject>Sequence analysis</subject><subj-group><subject>Sequence alignment</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Sequencing techniques</subject><subj-group><subject>Sequence analysis</subject><subj-group><subject>Sequence alignment</subject></subj-group></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Phylogeny Reconstruction with Alignment-Free Method That Corrects for Horizontal Gene Transfer</article-title>
<alt-title alt-title-type="running-head">Alignment-Free Phylogeny Reconstruction</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-3526-6362</contrib-id>
<name name-style="western">
<surname>Bromberg</surname>
<given-names>Raquel</given-names>
</name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Grishin</surname>
<given-names>Nick V.</given-names>
</name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Otwinowski</surname>
<given-names>Zbyszek</given-names>
</name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001"><label>1</label> <addr-line>Department of Biophysics and Department of Biochemistry, University of Texas Southwestern Medical Center at Dallas, Dallas, Texas, United States of America</addr-line></aff>
<aff id="aff002"><label>2</label> <addr-line>Howard Hughes Medical Institute, University of Texas Southwestern Medical Center at Dallas, Dallas, Texas, United States of America</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Morgenstern</surname>
<given-names>Burkhard</given-names>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1"><addr-line>Gotingen University, UNITED STATES</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con" id="contrib001">
<p>Conceived and designed the experiments: ZO NVG RB. Performed the experiments: RB. Analyzed the data: ZO NVG RB. Wrote the paper: ZO NVG RB.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">Zbyszek.Otwinowski@utsouthwestern.edu</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<day>23</day>
<month>6</month>
<year>2016</year>
</pub-date>
<pub-date pub-type="collection">
<month>6</month>
<year>2016</year>
</pub-date>
<volume>12</volume>
<issue>6</issue>
<elocation-id>e1004985</elocation-id>
<history>
<date date-type="received">
<day>22</day>
<month>10</month>
<year>2015</year>
</date>
<date date-type="accepted">
<day>10</day>
<month>5</month>
<year>2016</year>
</date>
</history>
<permissions>
<copyright-year>2016</copyright-year>
<copyright-holder>Bromberg et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1004985"/>
<abstract>
<p>Advances in sequencing have generated a large number of complete genomes. Traditionally, phylogenetic analysis relies on alignments of orthologs, but defining orthologs and separating them from paralogs is a complex task that may not always be suited to the large datasets of the future. An alternative to traditional, alignment-based approaches are whole-genome, alignment-free methods. These methods are scalable and require minimal manual intervention. We developed SlopeTree, a new alignment-free method that estimates evolutionary distances by measuring the decay of exact substring matches as a function of match length. SlopeTree corrects for horizontal gene transfer, for composition variation and low complexity sequences, and for branch-length nonlinearity caused by multiple mutations at the same site. We tested SlopeTree on 495 bacteria, 73 archaea, and 72 strains of <italic>Escherichia coli</italic> and <italic>Shigella</italic>. We compared our trees to the NCBI taxonomy, to trees based on concatenated alignments, and to trees produced by other alignment-free methods. The results were consistent with current knowledge about prokaryotic evolution. We assessed differences in tree topology over different methods and settings and found that the majority of bacteria and archaea have a core set of proteins that evolves by descent. In trees built from complete genomes rather than sets of core genes, we observed some grouping by phenotype rather than phylogeny, for instance with a cluster of sulfur-reducing thermophilic bacteria coming together irrespective of their phyla. The source-code for SlopeTree is available at: <ext-link ext-link-type="uri" xlink:href="http://prodata.swmed.edu/download/pub/slopetree_v1/slopetree.tar.gz" xlink:type="simple">http://prodata.swmed.edu/download/pub/slopetree_v1/slopetree.tar.gz</ext-link>.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>Due to their lack of distinct morphological features, bacteria and archaea were extremely difficult to classify until technology was developed to obtain their DNA sequences; these sequences could then be compared to estimate evolutionary relationships. Now, due to technological advances, there is a flood of available sequences from a wide variety of organisms. These advances have spurred the development of algorithms which can estimate evolutionary relationships using whole genomes, in contrast to the more traditional methods which used single genes earlier and now typically use groups of conserved genes. However, there are many challenges when attempting to infer evolutionary relationships, in particular horizontal gene transfer, where DNA is transferred from one organism to another, resulting in an organism’s genome containing DNA that does not reflect its evolution by descent. We developed a new whole-genome method for estimating evolutionary distances which identifies and corrects for horizontal transfer. We found that for SlopeTree and all other whole-genome methods we applied, horizontal transfer causes some evolutionary distances to be grossly underestimated, and that our correction corrects for this.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000002</institution-id>
<institution>National Institutes of Health</institution>
</institution-wrap>
</funding-source>
<award-id>GM094575</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Grishin</surname>
<given-names>Nick V.</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000928</institution-id>
<institution>Welch Foundation</institution>
</institution-wrap>
</funding-source>
<award-id>I-1505</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Grishin</surname>
<given-names>Nick V.</given-names>
</name>
</principal-award-recipient>
</award-group>
<funding-statement>This work was supported by National Institutes of Health (GM094575 to NVG), and the Welch Foundation (I-1505 to NVG). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="6"/>
<table-count count="1"/>
<page-count count="39"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant data are within the paper and its Supporting Information files. The software we developed is available at <ext-link ext-link-type="uri" xlink:href="http://prodata.swmed.edu/download/pub/slopetree_v1/slopetree.tar.gz" xlink:type="simple">http://prodata.swmed.edu/download/pub/slopetree_v1/slopetree.tar.gz</ext-link></meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Learning how to obtain complete genomes was a critical step to understanding biology and was achieved as early as 1977 for the genome of bacteriophage <italic>ɸ</italic>X174 [<xref ref-type="bibr" rid="pcbi.1004985.ref001">1</xref>]. Since then, methods for obtaining full genome sequences have advanced tremendously [<xref ref-type="bibr" rid="pcbi.1004985.ref002">2</xref>–<xref ref-type="bibr" rid="pcbi.1004985.ref004">4</xref>], leading to a second critical transition, when the number of genome sequences became too large for traditional, alignment-based, phylogenetics [<xref ref-type="bibr" rid="pcbi.1004985.ref005">5</xref>–<xref ref-type="bibr" rid="pcbi.1004985.ref008">8</xref>]. Even during the time of Sanger sequencing, the number of bacterial genomes began to cross this threshold [<xref ref-type="bibr" rid="pcbi.1004985.ref009">9</xref>]. With the development of next generation sequencing technology, we are experiencing a flood of complete genomes and metagenomes [<xref ref-type="bibr" rid="pcbi.1004985.ref010">10</xref>].</p>
<p>Molecular phylogenetics enabled the classification of prokaryotic organisms. In 1977, a multiple sequence alignment (MSA) of the small subunit (SSU) 16S rRNA gene revealed the existence of the three domains of life [<xref ref-type="bibr" rid="pcbi.1004985.ref011">11</xref>], making the SSU rRNA the gold standard for phylogenetics [<xref ref-type="bibr" rid="pcbi.1004985.ref012">12</xref>–<xref ref-type="bibr" rid="pcbi.1004985.ref014">14</xref>]. As more sequences became available, additional genes were used as phylogenetic markers, including protein elongation factors EF-α/Tu and EF-2 [<xref ref-type="bibr" rid="pcbi.1004985.ref015">15</xref>–<xref ref-type="bibr" rid="pcbi.1004985.ref017">17</xref>], chaperones Hsp60 and Hsp70 [<xref ref-type="bibr" rid="pcbi.1004985.ref018">18</xref>, <xref ref-type="bibr" rid="pcbi.1004985.ref019">19</xref>], the largest subunits of the RNA polymerase [<xref ref-type="bibr" rid="pcbi.1004985.ref020">20</xref>, <xref ref-type="bibr" rid="pcbi.1004985.ref021">21</xref>], RecA [<xref ref-type="bibr" rid="pcbi.1004985.ref022">22</xref>], a variety of aminoacyl-tRNA synthetases [<xref ref-type="bibr" rid="pcbi.1004985.ref023">23</xref>] and others. Approaches using single genes originally generated a wealth of phylogenetic insight, but these trees were frequently incongruent with one another [<xref ref-type="bibr" rid="pcbi.1004985.ref024">24</xref>, <xref ref-type="bibr" rid="pcbi.1004985.ref025">25</xref>]. To improve the accuracy of phylogenetic methods, phylogeneticists began to concatenate multiple conserved genes to produce larger MSAs and therefore better resolved trees [<xref ref-type="bibr" rid="pcbi.1004985.ref025">25</xref>–<xref ref-type="bibr" rid="pcbi.1004985.ref028">28</xref>]. The size and functional diversity of these gene groups is largely dependent on the number and diversity of taxa [<xref ref-type="bibr" rid="pcbi.1004985.ref029">29</xref>]. For instance, in the recent work of Lang and Eisen [<xref ref-type="bibr" rid="pcbi.1004985.ref025">25</xref>], an analysis of ~900 diverse prokaryotes from both bacteria and archaea identified only 24 suitable (i.e. paralog-free) genes. These consisted of a subset of ribosomal proteins, two translation factors that both interact with the ribosome, and the alpha subunit of a phenylalanyl-tRNA synthetase which was the only protein in the set not interacting with the ribosome and which contributed only ~5% of the overall alignment used to generate phylogeny. A similar situation was seen by Ciccarelli et al., in which for a group of 191 organisms, the set of 31 genes used in the final alignment consisted of 23 ribosomal proteins [<xref ref-type="bibr" rid="pcbi.1004985.ref030">30</xref>]. Widespread horizontal gene transfer (HGT) also interferes with a straightforward definition of evolution by descent [<xref ref-type="bibr" rid="pcbi.1004985.ref031">31</xref>–<xref ref-type="bibr" rid="pcbi.1004985.ref034">34</xref>]. Therefore, we are still making our way to a consensus to a definition of prokaryotic evolution by descent.</p>
<p>In contrast to the majority of traditional MSA-approaches, which often require extensive curation to produce high quality alignments of orthologs, alignment-free methods are scalable and require minimum manual intervention [<xref ref-type="bibr" rid="pcbi.1004985.ref035">35</xref>–<xref ref-type="bibr" rid="pcbi.1004985.ref038">38</xref>]. The idea of using complete genomes to perform phylogeny has a long history [<xref ref-type="bibr" rid="pcbi.1004985.ref039">39</xref>], but lay dormant until enough complete genomes became available. The rate at which these methods are now appearing reflects the pressing need for unsupervised, scalable methods. An additional advantage is that because they use complete genomes, they may provide a more sound approximation for organismal phylogeny [<xref ref-type="bibr" rid="pcbi.1004985.ref040">40</xref>]. Alignment-free methods compute similarity or distance metrics using a variety of statistical properties belonging to k-mers (fixed-length substrings, also called n-grams, n-mers, k-tuples, and k-words) in genomes. These methods are often divided into two main classes: methods using fixed-length word counts and methods using match lengths.</p>
<p>Word count methods relying on exact word matches include Composition Vector Trees (CVTrees) [<xref ref-type="bibr" rid="pcbi.1004985.ref041">41</xref>, <xref ref-type="bibr" rid="pcbi.1004985.ref042">42</xref>], Feature Frequency Profiles (FFP) [<xref ref-type="bibr" rid="pcbi.1004985.ref043">43</xref>], and D2 statistics [<xref ref-type="bibr" rid="pcbi.1004985.ref044">44</xref>–<xref ref-type="bibr" rid="pcbi.1004985.ref046">46</xref>]. Each of these methods relies on different properties of counting exact matches fixed-length k-mers. CVTree calculates the frequency of all length-<italic>k</italic> k-mers in all proteomes; these frequency or composition vectors, after a background subtraction correcting for random neutral mutations, are then compared to one another and a correlation is calculated by means of the cosine of the angle between them, which is normalized to produce the final value. FFP tabulates the counts for all possible features in the genome of fixed length <italic>k</italic>, which as in CVTree also are passed through a normalization procedure to form a probability distribution vector (i.e. an FFP); distances are then calculated using Jensen-Shannon Divergence [<xref ref-type="bibr" rid="pcbi.1004985.ref047">47</xref>]. D2 measures sequence dissimilarity by the logarithm of the ratio between conserved and non-conserved k-mers. Word count methods employing inexact matches include Co-phylog [<xref ref-type="bibr" rid="pcbi.1004985.ref048">48</xref>] and Spaced Word Frequencies (SWF) [<xref ref-type="bibr" rid="pcbi.1004985.ref049">49</xref>, <xref ref-type="bibr" rid="pcbi.1004985.ref050">50</xref>]. Co-phylog identifies seed alignments (exact or approximate matches) between the query and subject sequences and then extends them into longer alignments (i.e. ‘micro-alignments’); this method has an additional advantage in that it runs on raw next-generation sequencing data. SWF is similar to Co-phylog, using a mask consisting of positions that are either <italic>match</italic> or <italic>don’t care</italic>, and using the frequencies of these spaced words, with the <italic>don’t care</italic> positions ignored according to the specified pattern.</p>
<p>Match length methods can also be divided into those allowing zero mismatches or those allowing some number of mismatches. Exact match length methods include Average Common Substring (ACS) [<xref ref-type="bibr" rid="pcbi.1004985.ref051">51</xref>], Kr [<xref ref-type="bibr" rid="pcbi.1004985.ref052">52</xref>], and Underlying Approach (UA) [<xref ref-type="bibr" rid="pcbi.1004985.ref053">53</xref>]. Conceptually, the ACS method is the most similar to the method we present, and calculates its distance metric by means of variable length, exact matches between genomes or proteomes. For every position in one genome or proteome, ACS finds the longest length match in the other. This list of matches is then averaged, normalized, and a correction applied that transforms it from a similarity measure to a distance. The Kr method is closely related to the ACS method; taking two unaligned DNA sequences, Kr estimates the number of substitutions per site by determining for every suffix present in the one sequence the shortest prefix that is absent from the other (called shustrings). UA uses a scoring function on matching statistics between unique, independent subwords. k-Mismatch ACS (kmacs) [<xref ref-type="bibr" rid="pcbi.1004985.ref049">49</xref>] is an extension of the ACS approach which approximates the number of substring matches with up to <italic>k</italic> mismatches. Another, more recent extension of the ACS approach is ALFRED-G, also capable of computing lengths of shared sequences with mismatches allowed [<xref ref-type="bibr" rid="pcbi.1004985.ref054">54</xref>]. ACS-like methods which allow for <italic>k</italic>&gt;1 mismatches can be highly costly in computational terms, but there has recently been some headway in improving their efficiency [<xref ref-type="bibr" rid="pcbi.1004985.ref055">55</xref>].</p>
<p>We present SlopeTree, a new alignment-free method which measures evolutionary distance by quantifying how quickly the number of matching sequences between two proteomes decays as a function of sequence length. The sequences that we employ to this end are k-mers, i.e. substrings of length <italic>k</italic>. The method considers uneven composition of amino acids, the possibility of backwards mutations, a background of coincidental matches over short k-mer lengths, and the issue of HGT. HGT is highly relevant for alignment-free methods because it adds a spurious contribution of similarity between genomes [<xref ref-type="bibr" rid="pcbi.1004985.ref056">56</xref>, <xref ref-type="bibr" rid="pcbi.1004985.ref057">57</xref>]. There are multiple possible signatures of horizontally transferred proteins, for instance unusual codon usage [<xref ref-type="bibr" rid="pcbi.1004985.ref058">58</xref>–<xref ref-type="bibr" rid="pcbi.1004985.ref060">60</xref>]. We identified a novel signature based on analysis of multiple copies of almost identical protein sequences in a genome, and those multiple copies almost invariably belonged to one of two categories: one category was of EF-Tu translation factor, which is frequently present in multiple copies; and the second was of mobile elements, as inferred from a very narrow or scattered phylogenetic footprint, even within a single species. When annotated, these mobile elements consisted primarily of parasitic proteins resulting from phage infections. Another level of filtering is done by means of a dual evolutionary stability index indicating conservation and lack of stability, i.e. a <italic>paralogy score</italic>, with a large instability value representing very likely cases of HGT. A mobile element (ME) filter and a separate, conservation filter were built into SlopeTree using the earlier mentioned novel signature and the paralogy score. To measure the similarity between two proteomes, SlopeTree yields a <italic>slope</italic> (explained in the Algorithms section); a third HGT correction is based on the curvature of this slope. Therefore, SlopeTree is unique in that it is not only robust to HGT, but it explicitly identifies and corrects for HGT at multiple stages of the analysis. By subtracting the background of short length, coincidental matches and restricting itself to a range of longer lengths (~7 or more amino acids), SlopeTree is able to follow the evolution of the highly conserved segments of proteins, using approximately 10,000 to 40,000 amino acids per genome pair. The highly conserved regions that SlopeTree targets correspond to the alignable regions in an MSA.</p>
<p>For 72 strains of <italic>Escherichia coli</italic> and <italic>Shigella</italic>, 73 archaea, and 495 bacteria, we built trees using different degrees of HGT-correction. We compared these trees to trees based on phylogenetically broad concatenated alignments from the literature [<xref ref-type="bibr" rid="pcbi.1004985.ref025">25</xref>], in which supermatrices were constructed from 24 single-copy, ubiquitous genes and then passed to a Maximum Likelihood (ML) routine for tree-building. These comparisons were performed to assess the accuracy of our method and to identify potential biological sources for differences. The SlopeTree strain-level trees were remarkably stable for different inputs. Even when only mobile elements together with proteins that are not part of the core were considered, the tree topology was highly similar. The archaeal trees were more fluid upon restricting the method to the most conserved proteins, but the majority of clades and relationships between deep branches remained the same. The deep, short branches in the bacterial trees were the most unstable, which is related to a generic problem of defining phylogenetic relationships in evolutionary radiation. For archaea and bacteria, we calculated the symmetric difference distance [<xref ref-type="bibr" rid="pcbi.1004985.ref061">61</xref>] to the trees built from supermatrices for trees built by SlopeTree, ACS, CVTree, D2, kmacs, Spaced Words and ALFRED-G. By applying our ME filter and conservation filter to the data prior to running the main SlopeTree routines, we were able to significantly reduce the distances to the trees built from supermatrices not only for SlopeTree but for all other alignment-free methods. We observed approximately 20 bacteria whose placement on the phylogenetic trees frequently disagreed between alignment-free methods and the current NCBI classification. The consistency of these alternative placements for these bacteria when applying alignment-free methods suggests that their classification may require revision, or at the very least have complex histories. This is further supported by the fact that several of these bacteria had similar disagreements between the trees built from supermatrices and the NCBI classification.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<sec id="sec003">
<title>Algorithms</title>
<p>Our method is based on k-mers that are substrings of length <italic>k</italic>. The SlopeTree package includes both the main SlopeTree algorithm, which estimates evolutionary distance by quantifying how quickly the number of matching sequences between two proteomes decays as a function of sequence length, and several independent modules for filtering mobile elements and less-conserved proteins out of the data and recalculating distances for pairs still exhibiting significant HGT even after the earlier filtering steps. Altogether, the method consists of the following four modules: (1) a Mobile Element Filter, (2) a Conservation and Stability Filter, (3) the SlopeTree Main Algorithm and (4) a Pair-Wise Horizontal Gene Transfer (HGT) Correction. A flowchart is provided in <xref ref-type="supplementary-material" rid="pcbi.1004985.s001">S1 Fig</xref>.</p>
<p>The Mobile Element Filter exploits a novel signature which is based on analysis of multiple copies of almost identical protein sequences in a genome. These highly repetitive proteins proved almost always to be mobile elements. The Conservation and Stability Filter calculates for each protein a value, which we call a <italic>paralogy</italic> score, from the ratio of the sum of how many genes each of the protein’s k-mers has a match with in other genomes to the sum of the total number of genomes the protein’s k-mers have matches with. This ratio effectively separated orthologous proteins evolving by descent, which typically have a gene to genome ratio of one and therefore had paralogy scores of approximately one. Mobile elements on the other hand, have paralogy scores frequently much greater than one because their presence, absence, and copy number are much more unstable, while unconserved proteins which simply have no k-mer matches with any other proteins in the input have scores of 0.</p>
<p>The SlopeTree Main Algorithm estimates a distance for every pair of organisms from the decay in the number of exact sequence matches as a function of match length.</p>
<p>The Pair-Wise HGT Correction assesses the slopes produced by the SlopeTree Main Algorithm and identifies pairs of organisms that appear to have shared significant horizontal transfers; it runs the SlopeTree Main Algorithm on these pairs combined with a reference set to identify proteins that the pair shares but that are absent from the reference, and then it re-runs the SlopeTree Main Algorithm on just the pair, with the flagged proteins removed.</p>
<p>The four modules are not necessarily run together; for instance, the SlopeTree Main Algorithm can be run on unfiltered data or data passed through only one of the filters.</p>
</sec>
<sec id="sec004">
<title>Algorithm 1: Mobile Element Filter</title>
<p><bold>Input</bold>. A set S of <italic>n</italic> proteomes 〈<italic>S</italic><sub>1</sub>, <italic>S</italic><sub>2</sub>, …, <italic>S</italic><sub><italic>n</italic></sub>〉 and a set T = 〈<italic>T</italic><sub>1</sub>, <italic>T</italic><sub>2</sub>, …, <italic>T</italic><sub><italic>l</italic></sub>〉, with T taken from <italic>l</italic> taxonomically diverse organisms where <italic>T</italic><sub><italic>i</italic></sub> consists solely of the highly conserved proteins of the organism <italic>i</italic>. In practice, <italic>l</italic> is generally much smaller than <italic>n</italic>, but this is not required.</p>
<p specific-use="continuation"><bold>Output</bold>. A set V = 〈<italic>V</italic><sub>1</sub>, <italic>V</italic><sub>2</sub>, …, <italic>V</italic><sub><italic>n</italic></sub>〉 where each <italic>V</italic><sub><italic>i</italic></sub> consists of all proteins in <italic>S</italic><sub><italic>i</italic></sub>, minus the mobile elements.</p>
<p specific-use="continuation"><bold>Algorithm</bold>. Let <italic>p</italic><sub><italic>ij</italic></sub> be the <italic>j</italic><sup><italic>th</italic></sup> protein in <italic>S</italic><sub><italic>i</italic></sub>, and let <inline-formula id="pcbi.1004985.e001"><alternatives><graphic id="pcbi.1004985.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004985.e001" xlink:type="simple"/><mml:math display="inline" id="M1"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>[</mml:mo><mml:mi>h</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> be a k-mer from <italic>p</italic><sub><italic>ij</italic></sub> of length <italic>k</italic>, starting at index <italic>h</italic>, where <italic>0</italic>≤<italic>h</italic>&lt;<italic>f</italic> given that <italic>p</italic><sub><italic>ij</italic></sub> has length <italic>f</italic>. For those k-mers at the end of each protein where <italic>h</italic>+<italic>k</italic>&gt;<italic>f</italic>, the suffix is expanded by the necessary number of empty characters to fill the remainder of the k-mer. Each k-mer is stored as a 2-tuple consisting of the k-mer and the gene ID (<italic>j</italic>). Let <italic>A</italic><sub><italic>i</italic></sub> be the alphabetically sorted list of all 2-tuples from <italic>S</italic><sub><italic>i</italic></sub>. For every protein <italic>p</italic><sub><italic>ij</italic></sub>, there is a pair of integers, <italic>r</italic><sub><italic>ij</italic></sub> and <italic>c</italic><sub><italic>ij</italic></sub>, both initialized to 0. Starting from the first k-mer in <italic>A</italic><sub><italic>i</italic></sub>, we pass down the list until a k-mer with more than <italic>u</italic> mismatches with this first k-mer is found. For all proteins with k-mers in this block, <italic>r</italic><sub><italic>ij</italic></sub> is incremented. This process is repeated until the end of <italic>A</italic><sub><italic>i</italic></sub> is reached, always starting from the first k-mer to not be a member of the current block of matches.</p>
<p>Separately, we repeat the k-mer compilation process described above on T to generate a single, alphabetically sorted list of 2-tuples across all proteomes in T. Duplicates are removed from this list to make a new list B consisting of each k-mer and the number of times it appears in T. Those k-mers appearing only once are given a count of 1. Then for every k-mer in <italic>A</italic><sub><italic>j</italic></sub>, we query B; the value of <italic>c</italic><sub><italic>ij</italic></sub> is increased by the count stored in B for every exact match between B and any k-mer in any protein <italic>p</italic><sub><italic>ij</italic></sub>.</p>
<p>Having set all <italic>r</italic><sub><italic>ij</italic></sub> and <italic>c</italic><sub><italic>ij</italic></sub> for all <italic>p</italic><sub><italic>ij</italic></sub> in <italic>S</italic><sub><italic>i</italic></sub>, we define a linear function such that all <italic>p</italic><sub><italic>ij</italic></sub> with <italic>r</italic><sub><italic>ij</italic></sub>≥<italic>ac</italic><sub><italic>ij</italic></sub><italic>+b</italic> are removed from proteome <italic>P</italic><sub><italic>i</italic></sub> and the reduced proteome we call <italic>V</italic><sub><italic>i</italic></sub>.</p>
<p specific-use="continuation"><bold>Computational complexity</bold>. For <italic>n</italic> organisms and <italic>m</italic> amino acids in S, let m = m<sub>1</sub>+m<sub>2</sub>+…+m<sub>n</sub>. For <italic>l</italic> organisms and <italic>k</italic> amino acids in T, let k = k<sub>1</sub>+k<sub>2</sub>+…+k<sub>l</sub>. The compilation of <italic>A</italic><sub><italic>i</italic></sub> is done in <italic>O</italic>(<italic>m</italic>) time, and the time required for sorting each <italic>A</italic><sub><italic>i</italic></sub> is <italic>O</italic>(<italic>m</italic><sub><italic>i</italic></sub> log <italic>m</italic><sub><italic>i</italic></sub>), which summed over all <italic>n</italic> organisms is <italic>O</italic>(<italic>m</italic> log <italic>m</italic>). Similarly, the time to compile all k-mers in T is <italic>O</italic>(<italic>k</italic>) and to sort them requires <italic>O</italic>(<italic>k</italic> log <italic>k</italic>) time. The order of the algorithm is dominated by the sorting, and therefore the computational complexity of the filter is <italic>O</italic>(<italic>m</italic> log <italic>m + k</italic> log <italic>k</italic>).</p>
</sec>
<sec id="sec005">
<title>Algorithm 2: Conservation and Stability Filter</title>
<p><bold>Input</bold>.A set W of <italic>n</italic>+<italic>k</italic> proteomes consisting of two sets of proteomes: a set V of <italic>n</italic> proteomes 〈<italic>V</italic><sub>1</sub>, <italic>V</italic><sub>2</sub>, …, <italic>V</italic><sub><italic>n</italic></sub>〉 and a set U of <italic>z</italic> proteomes 〈<italic>U</italic><sub>1</sub>, <italic>U</italic><sub>2</sub>, …, <italic>U</italic><sub><italic>z</italic></sub>〉, with U taken from taxonomically diverse organisms.</p>
<p specific-use="continuation"><bold>Output</bold>. A set H = 〈<italic>H</italic><sub>1</sub>, <italic>H</italic><sub>2</sub>, …, <italic>H</italic><sub><italic>n</italic>+<italic>k</italic></sub>〉 where <italic>H</italic><sub><italic>i</italic></sub> is the subset of <italic>W</italic><sub><italic>i</italic></sub> containing conserved proteins with stable copy number.</p>
<p specific-use="continuation"><bold>Algorithm</bold>. Let <italic>p</italic><sub><italic>ij</italic></sub> be the <italic>j</italic><sup><italic>th</italic></sup> protein in <italic>W</italic><sub><italic>i</italic></sub>, and let <inline-formula id="pcbi.1004985.e002"><alternatives><graphic id="pcbi.1004985.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004985.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>[</mml:mo><mml:mi>h</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> be a k-mer from <italic>p</italic><sub><italic>ij</italic></sub> of length <italic>k</italic>, starting at index <italic>h</italic>, where <italic>0</italic>≤<italic>h</italic>&lt;<italic>f</italic> given that <italic>p</italic><sub><italic>ij</italic></sub> has length <italic>f</italic>. For those k-mers at the end of each protein where <italic>h</italic>+<italic>k</italic>&gt;<italic>f</italic>, the suffix is expanded by the necessary number of empty characters to fill the remainder of the k-mer. Each k-mer is stored as a 3-tuple consisting of the k-mer, the proteome ID (<italic>i</italic>), and the gene ID (<italic>j</italic>). Let D be the alphabetically sorted list of all 3-tuples from both V and U.</p>
<p>We define a k-mer cluster to be a block of adjacent k-mers in D in which no k-mer has more than <italic>u</italic> mismatches with the previous k-mer. Starting from the first k-mer in D, we compare adjacent k-mers to identify all clusters in D. At the end of this process, the k-mers in adjacent clusters are checked against one another and merged by the same rule of no more than <italic>u</italic> mismatches, a step which circumvents the frequent problem of stray k-mers interrupting what would otherwise be a single block of matches. We call this final set of clusters C.</p>
<p>Every protein in <italic>p</italic><sub><italic>ij</italic></sub> from W is assigned a pair of integer arrays, <italic>G</italic><sub><italic>ij</italic></sub> and <italic>F</italic><sub><italic>ij</italic></sub> each initialized at every index to 0 (default size = 10). For each cluster in <italic>C</italic>, let <italic>g</italic> be the number of organisms from U with <italic>at least</italic> one k-mer in the cluster, and let <italic>f</italic> be the number of total 3-tuples in the cluster with k-mers from U, including repeats. We use <italic>G</italic><sub><italic>ij</italic></sub> and <italic>F</italic><sub><italic>ij</italic></sub> to accumulate the sums of <italic>f</italic> and <italic>g</italic>, respectively, for each cluster; the index of the array for a given cluster is selected by a function of the fraction of the total proteomes in U with hits in the cluster. If <italic>y</italic> is the number of proteomes in U with hits in the cluster, <italic>o</italic> = ⌊10<italic>y</italic>/<italic>z</italic>⌋. For every protein <italic>p</italic><sub><italic>ij</italic></sub> with a k-mer in a given cluster from C, let <italic>g</italic> and <italic>f</italic> be added to the values of <italic>G</italic><sub><italic>ij</italic></sub> and <italic>F</italic><sub><italic>ij</italic></sub> at index <italic>o</italic>, respectively.</p>
<p>After passing through all clusters in C, we assign a paralogy score for every protein <italic>p</italic><sub><italic>ij</italic></sub>, for each possible value of <italic>o</italic>, where we define a paralogy score <inline-formula id="pcbi.1004985.e003"><alternatives><graphic id="pcbi.1004985.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004985.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>o</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> for each value of <italic>o</italic> as <inline-formula id="pcbi.1004985.e004"><alternatives><graphic id="pcbi.1004985.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004985.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>o</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>o</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo> <mml:mi>o</mml:mi> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle><mml:mo>/</mml:mo><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>o</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mstyle></mml:math></alternatives></inline-formula>. <italic>H</italic> consists of all proteomes in <italic>V</italic> and <italic>U</italic>, where only proteins that have <inline-formula id="pcbi.1004985.e005"><alternatives><graphic id="pcbi.1004985.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004985.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:mrow><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>o</mml:mi></mml:msubsup><mml:mo>≤</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> orthology cutoff (default = 1.3) retained. How conserved the final set H is depends on the user’s selection of <italic>o</italic>.</p>
<p>The reference set U is not mandatory. When a reference set is absent, the whole set V is treated as the reference by the algorithm.</p>
<p specific-use="continuation"><bold>Computational complexity</bold>. As in Algorithm 1, the time to compile the sorted list of k-mers is <italic>O</italic>(<italic>m</italic> log <italic>m</italic>), where <italic>m</italic> is the total number of amino acids in W. The clustering is performed in <italic>O</italic>(<italic>m</italic>) time, and the calculation of final scores is performed in <italic>O</italic>(<italic>n</italic>+<italic>k</italic>) time. Therefore, the computational complexity of the filter is <italic>O</italic>(<italic>m</italic> log <italic>m)</italic>.</p>
</sec>
<sec id="sec006">
<title>Algorithm 3: Main SlopeTree Algorithm</title>
<p><bold>Input</bold>. A set H of <italic>n</italic> proteomes 〈<italic>H</italic><sub>1</sub>, <italic>H</italic><sub>2</sub>, …, <italic>H</italic><sub><italic>n</italic></sub>〉.</p>
<p specific-use="continuation"><bold>Output</bold>. A distance matrix D of SlopeTree evolutionary distances between all pairs in H, such that <italic>D</italic><sub><italic>ij</italic></sub> is the SlopeTree distance between proteomes <italic>H</italic><sub><italic>i</italic></sub> and <italic>H</italic><sub><italic>j</italic></sub>.</p>
<p specific-use="continuation"><bold>Algorithm</bold>. Let <italic>p</italic><sub><italic>ij</italic></sub> be the <italic>j</italic><sup><italic>th</italic></sup> protein in <italic>H</italic><sub><italic>i</italic></sub>, and let <inline-formula id="pcbi.1004985.e006"><alternatives><graphic id="pcbi.1004985.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004985.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>[</mml:mo><mml:mi>h</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> be a k-mer from <italic>p</italic><sub><italic>ij</italic></sub> of length <italic>k</italic>, starting at index <italic>h</italic>, where <italic>0</italic>≤<italic>h</italic>&lt;<italic>f</italic> given that <italic>p</italic><sub><italic>ij</italic></sub> has length <italic>f</italic>. For those k-mers at the end of each protein where <italic>h</italic>+<italic>k</italic>&gt;<italic>f</italic>, the suffix is expanded by the necessary number of empty characters to fill the remainder of the k-mer. Each k-mer is stored as a 3-tuple consisting of the k-mer, the proteome ID (<italic>i</italic>), and the gene ID (<italic>j</italic>). Let L be the alphabetically sorted list of all 3-tuples.</p>
<p>Let <inline-formula id="pcbi.1004985.e007"><alternatives><graphic id="pcbi.1004985.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004985.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:mrow><mml:msubsup><mml:mi>m</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> be an exact sequence match of length <italic>r</italic>, where <italic>1≤r≤k</italic> for proteomes <italic>P</italic><sub><italic>x</italic></sub> and <italic>P</italic><sub><italic>y</italic></sub>, where each match is counted exactly once. Let <inline-formula id="pcbi.1004985.e008"><alternatives><graphic id="pcbi.1004985.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004985.e008" xlink:type="simple"/><mml:math display="inline" id="M8"><mml:mrow><mml:msubsup><mml:mi>M</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> be count of all <inline-formula id="pcbi.1004985.e009"><alternatives><graphic id="pcbi.1004985.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004985.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:mrow><mml:msubsup><mml:mi>m</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, where the same sequence is only counted once. For all <italic>r</italic> in the evolutionarily relevant range, ~<italic>r</italic>&gt;8 amino acids, we define <italic>D</italic><sub><italic>xy</italic></sub> as an estimate of the evolutionary distance between proteomes <italic>P</italic><sub><italic>x</italic></sub> and <italic>P</italic><sub><italic>y</italic></sub>, where <italic>D</italic><sub><italic>xy</italic></sub> is the decay in the histogram of <inline-formula id="pcbi.1004985.e010"><alternatives><graphic id="pcbi.1004985.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004985.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:mrow><mml:mtext>ln</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>M</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> as a function of <italic>r</italic>.</p>
<p specific-use="continuation"><bold>Computational complexity</bold>. For <italic>n</italic> organisms and <italic>m</italic> amino acids, let m = m<sub>1</sub>+m<sub>2</sub>+…+m<sub>n</sub>. The compilation of L is done in <italic>O</italic>(<italic>m</italic>), and the sort within all organisms is equal to Σ<italic>O</italic>(<italic>m</italic><sub><italic>i</italic></sub> log <italic>m</italic><sub><italic>i</italic></sub>) which is equal to <italic>O</italic>(<italic>m</italic> log <italic>m</italic>). The match-counting algorithm then requires <italic>O</italic>(<italic>m</italic> log <italic>m</italic> + <italic>n</italic><sup><italic>2</italic></sup>) time. Thus, the time complexity is <italic>O</italic>(<italic>m</italic> log <italic>m + n</italic><sup><italic>2</italic></sup>), with <italic>m</italic>&gt;&gt;<italic>n</italic>. We treat the alphabet size as a constant here.</p>
</sec>
<sec id="sec007">
<title>Algorithm 4: Pair-Wise Horizontal Gene Transfer (HGT) Correction</title>
<p><bold>Input</bold>. A previously calculated SlopeTree distance matrix D (defined in Algorithm 3), a list Q of proteome pairs flagged as requiring additional correction, and a set R of proteomes, with R taken from taxonomically diverse organisms.</p>
<p specific-use="continuation"><bold>Output</bold>. A new distance matrix D`identical to D except for the distances between all pairs in Q, which have been recalculated.</p>
<p specific-use="continuation"><bold>Algorithm</bold>. Let <italic>p</italic><sub><italic>ij</italic></sub> be the <italic>j</italic><sup><italic>th</italic></sup> protein in <italic>R</italic><sub><italic>i</italic></sub>, and let <inline-formula id="pcbi.1004985.e011"><alternatives><graphic id="pcbi.1004985.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004985.e011" xlink:type="simple"/><mml:math display="inline" id="M11"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>[</mml:mo><mml:mi>h</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> be a k-mer from <italic>p</italic><sub><italic>ij</italic></sub> of length <italic>k</italic>, starting at index <italic>h</italic>, where <italic>0</italic>≤<italic>h</italic>&lt;<italic>f</italic> given that <italic>p</italic><sub><italic>ij</italic></sub> has length <italic>f</italic>. For those k-mers at the end of each protein where <italic>h</italic>+<italic>k</italic>&gt;<italic>f</italic>, the suffix is expanded by the necessary number of empty characters to fill the remainder of the k-mer. Each k-mer is stored as a 3-tuple consisting of the k-mer, the proteome ID, and the gene ID. Let <italic>S</italic> be the alphabetically sorted list of all 3-tuples from <italic>R</italic>.</p>
<p>Let <italic>v</italic> and <italic>w</italic> be a pair in Q. Then for this pair, we compile an alphabetically sorted list of 3-tuples and call this list P. Let S and P be merged and this list passed to Algorithm 3, i.e. the SlopeTree Main Algorithm for counting matches. During the match-counting, let any protein <italic>p</italic><sub><italic>ij</italic></sub> contributing a match between <italic>v</italic> and <italic>w</italic> with a nit-score (proportional to the length of the match, described in Implementation) higher than some cutoff <italic>x</italic>, and with fewer than <italic>y</italic> hits among the reference set, be marked. Having reached the end of the merged list of S and P, and having marked all proteins from <italic>v</italic> and <italic>w</italic>, we rerun Algorithm 3 on P, but ignoring matches from the marked proteins, to produce a new distance, <italic>D`</italic><sub><italic>vw</italic></sub>.</p>
<p>Let the original distance <italic>D</italic><sub><italic>vw</italic></sub> be replaced by the new distance <italic>D`</italic><sub><italic>vw</italic></sub>, and the matrix <italic>D`</italic>be the matrix in which every element has been updated in this way for all pairs in <italic>Q</italic>.</p>
<p specific-use="continuation"><bold>Computational complexity</bold>. Compiling the alphabetically sorted list <italic>S</italic> takes <italic>O</italic>(<italic>r</italic> log <italic>r</italic>) time, where <italic>r</italic> is the total number of amino acids in R. Similarly, compiling <italic>P</italic> takes <italic>O(p</italic> log <italic>p)</italic> time, where <italic>p</italic> is the total number of amino acids in <italic>v</italic> and <italic>w</italic>. Each first iteration of the SlopeTree main algorithm then requires <italic>O</italic>(<italic>r</italic> log <italic>r + p</italic> log <italic>p</italic>) time, and running the pair requires <italic>O</italic>(<italic>p</italic> log <italic>p</italic>) time. This must be repeated for every pair in Q. For a total of <italic>n</italic> organisms, i.e. a distance matrix to recalculate that is <italic>n</italic> by <italic>n</italic>, the worst case scenario is that every pair has been flagged, requiring that n<sup>2</sup>/2 distances be recalculated, but in practice, and especially after having applied the filters described in Algorithms 1 and 2, the number of pairs in Q is much smaller.</p>
</sec>
<sec id="sec008">
<title>Implementation</title>
<p>The algorithms behind the four main modules of the SlopeTree package (<xref ref-type="supplementary-material" rid="pcbi.1004985.s001">S1 Fig</xref>) were described in the Algorithms section. Here we present some important details regarding their implementation, including how the methods address uneven composition of amino acids, the possibility of backwards mutations, and the background of coincidental matches over short k-mer lengths. The source-code for SlopeTree is available at <ext-link ext-link-type="uri" xlink:href="http://prodata.swmed.edu/download/pub/slopetree_v1/slopetree.tar.gz" xlink:type="simple">http://prodata.swmed.edu/download/pub/slopetree_v1/slopetree.tar.gz</ext-link>.</p>
<sec id="sec009">
<title>Assigning unique ordinals to proteomes and proteins</title>
<p>The first operation of SlopeTree is to detect all organisms in the input (a source directory containing FASTA files is provided by the user), alphabetically sort them by name, and assign them a unique integer, which we refer to as a genome ID, starting from 0.</p>
</sec>
<sec id="sec010">
<title>Assembling the k-mer lists</title>
<p>SlopeTree generates a list of all k-mers (default = 20-mers) from all proteomes in the input set by means of a sliding window. Those k-mers shorter than 20 (i.e. k-mers from the end of each protein) are buffered a ‘^’, signifying ‘no character’, and k-mers containing non-standard amino acids (e.g. U) are ignored. In the same way that each proteome is given an ID (described above), each protein is given an integer ID which is unique within (but not between) proteomes. Each k-mer then is associated with a proteome ID and a protein ID as a 3-tuple, and these 3-tuples are sorted alphabetically into a final list. To facilitate various operations embedded in the SlopeTree code, and to facilitate development, SlopeTree uses its own procedures for k-mer counting and sorting.</p>
<p>At the k-mer generation stage, SlopeTree also compares k-mers to a small set of conserved, hardcoded sequences from EF-Tu. Proteins with k-mers that overlap with these sequences by 60% or more are considered matches and are marked so that the filters, if applied subsequently, do remove them. This is to prevent EF-Tu, which is a highly conserved protein, from being eliminate due to its unusual copy number.</p>
</sec>
<sec id="sec011">
<title>Removing low complexity sequences</title>
<p>Those k-mers with significantly reduced amino acid alphabets (i.e. low complexity sequences) are not included in the sorted list. For each k-mer, SlopeTree counts the total number of times each amino acid is present (<italic>c</italic><sub><italic>n</italic></sub>). The low-complexity score (S) of the k-mer is calculated as the sum of the squares for these counts.
<disp-formula id="pcbi.1004985.e012">
<alternatives>
<graphic id="pcbi.1004985.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004985.e012" xlink:type="simple"/>
<mml:math display="block" id="M12">
<mml:mrow><mml:mtext>S</mml:mtext><mml:mrow><mml:mtext> </mml:mtext></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>20</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:msubsup><mml:mi>c</mml:mi><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mstyle></mml:mrow>
</mml:math>
</alternatives>
<label>(1)</label>
</disp-formula>
The k-mers with scores above a given cutoff (<italic>C</italic>) are discarded. Originally, this cutoff was manually set to 130 for 20-mers after manual inspection of k-mers, but to allow for different values of <italic>k</italic>, <italic>C</italic> is calculated by SlopeTree as 6.5<italic>k</italic>.</p>
</sec>
<sec id="sec012">
<title>Match-counting</title>
<p>The list of k-mers merged across all proteomes is passed to the main SlopeTree algorithm, a match-counting routine that recursively partitions the sorted list of 3-tuples into blocks having the same leading amino acid, with three base cases for the recursion: the end of the k-mers has been reached, with the match reaching the last character in the block; the current block consists of only one k-mer, meaning that the current k-mer has no matches; and the end of the k-mer list has been reached. At the beginning of the match-counting process, a 3-dimensional integer array <italic>A</italic> with dimensions (number of organisms) by (number of organisms) by (maximum possible match score value) is initialized to 0. Then, for each unique k-mer match of score <italic>s</italic> between any pair of organisms <italic>p</italic> and <italic>q</italic>, array <italic>A</italic> has the entry at <italic>A</italic>[<italic>p</italic>][<italic>q</italic>][<italic>s</italic>] incremented.</p>
</sec>
<sec id="sec013">
<title>Scoring matches</title>
<p>The simplest scoring scheme for a match would be to score by the match length. We extended this to nit-scores. Prior to counting matches, for each proteome, the number of instances of each amino acid (<italic>c</italic><sub><italic>a</italic></sub>) and the total number of amino acids (<italic>T</italic>) are counted, and amino acid frequencies (<italic>f</italic><sub><italic>a</italic></sub>) of each proteome are then calculated:
<disp-formula id="pcbi.1004985.e013">
<alternatives>
<graphic id="pcbi.1004985.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004985.e013" xlink:type="simple"/>
<mml:math display="block" id="M13">
<mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow><mml:mi>T</mml:mi></mml:mfrac></mml:mrow>
</mml:math>
</alternatives>
<label>(2)</label>
</disp-formula>
For each proteome, for each amino acid, a nit-score (<italic>s</italic><sub><italic>a</italic></sub>) is then calculated:
<disp-formula id="pcbi.1004985.e014">
<alternatives>
<graphic id="pcbi.1004985.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004985.e014" xlink:type="simple"/>
<mml:math display="block" id="M14">
<mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:mo>−</mml:mo><mml:mtext>ln</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(3)</label>
</disp-formula>
To take into account that each proteome has its own set of nit-scores, this can be rewritten for a specific proteome <italic>p</italic> as:
<disp-formula id="pcbi.1004985.e015">
<alternatives>
<graphic id="pcbi.1004985.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004985.e015" xlink:type="simple"/>
<mml:math display="block" id="M15">
<mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:mo>−</mml:mo><mml:mtext>ln</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(4)</label>
</disp-formula>
For a match <italic>m</italic> of length <italic>l</italic> between two organisms, <italic>p</italic> and <italic>q</italic>, where <italic>m</italic>[<italic>i</italic>] is the amino acid at match position <italic>i</italic>, the score <italic>m</italic><sub><italic>pq</italic></sub> for the match, <italic>m</italic>, would be:
<disp-formula id="pcbi.1004985.e016">
<alternatives>
<graphic id="pcbi.1004985.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004985.e016" xlink:type="simple"/>
<mml:math display="block" id="M16">
<mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>l</mml:mi></mml:msubsup><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>q</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow>
</mml:math>
</alternatives>
<label>(5)</label>
</disp-formula>
There were two motivations for using nit-scores. One was to improve the rejection of coincidental matches. Coincidences of more frequent amino acids were more likely, so relying on a nit-score provided better rejection, with stretches of frequent amino acids having to be longer to contribute to the evolutionarily relevant range of the data. The second consideration was to obtain a more fine-grained sampling than number of amino acids, which for 20-mers would have defined just 20 bins. However, the slope expressed in nits also had a composition-dependent relationship to the slope expressed in mutations. Because our target was a slope expressed in units of mutation, there was a need for a correction factor that was composition dependent.</p>
</sec>
<sec id="sec014">
<title>Background subtraction</title>
<p>The match-counting produces a histogram of the number of unique k-mer matches shared by every pair, for a range of nit-scores (rounded to integers) from 0 to the maximum possible nit-score for the chosen k-mer length (<italic>t</italic><sub><italic>i</italic></sub>). Because at the lower nit-score range, these histograms can also contain coincidental matches, SlopeTree subtracts a background from these histograms. During the initial k-mer compilation, a separate set of k-mers is generated in which the original proteins have had their amino acid order scrambled prior to applying the sliding window. This scrambling is performed on amino acid fragments of length 1 to 4. The sorted, merged k-mer list derived from the scrambled proteins is also passed through the SlopeTree match-counting algorithm (Algorithm 3), generating its own set of histograms in which the evolutionarily conserved sequences have been completely erased. SlopeTree’s background correction consists of subtracting the counts from the histograms obtained from randomized sequences from the histograms obtained from real data (<xref ref-type="fig" rid="pcbi.1004985.g001">Fig 1A and 1B</xref>).</p>
<fig id="pcbi.1004985.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004985.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Main SlopeTree plots.</title>
<p>(A) Number of matches between <italic>Escherichia coli K-12</italic> and <italic>Lactobacillus sakei 23K</italic> for range of nit-scores available to 20-mers (black), and same plot from randomized data (blue). (B) Natural log of number of matches between same bacteria as in (A) (black), and corresponding plot in natural log from randomized data (blue). (C) Natural log of number of matches between 2 bacteria of the same species, using 20-mers (black) and 40-mers (orange). (D) “Evolutionary signal” extracted from (B). (E) <italic>E</italic>.<italic>coli 042</italic> compared to 3 bacteria: <italic>E</italic>.<italic>coli 536</italic> (black); <italic>Petrotoga mobilis S85</italic> (blue); and <italic>Pyrolobus fumarii 1A</italic> (orange). (F) Natural log of number of matches between <italic>Syntrophobacter fumaroxidans MPOB</italic> and <italic>Dehalogenimonas lykanthroporepellens</italic>, a pair exhibiting HGT.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004985.g001" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec015">
<title>Binning correction</title>
<p>SlopeTree also corrects for binning artifacts caused by amino acid frequencies and unusual patterns in amino acid composition. For every pair of organisms, an additional histogram is produced consisting of the nit-scores from every single sequence in either proteome, from length 1 to the k-mer length. Sequences are counted regardless of whether or not they have matches (<xref ref-type="fig" rid="pcbi.1004985.g002">Fig 2A</xref>). These sequences are scored using the nit-scores derived for the particular pair, just as in the main match-counting code (<italic>b</italic><sub><italic>i</italic></sub>). To produce a histogram corrected for binning artifacts (<italic>y</italic><sub><italic>i</italic></sub>), where <italic>i</italic> corresponds to rounded nit-scores, for each score in the natural log of the real data (<italic>t</italic><sub><italic>i</italic></sub>), the natural log of these bin-correction counts (<italic>b</italic><sub><italic>i</italic></sub>) is subtracted, and the average of the bin-correction (〈<italic>B</italic>〉) added back:
<disp-formula id="pcbi.1004985.e017">
<alternatives>
<graphic id="pcbi.1004985.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004985.e017" xlink:type="simple"/>
<mml:math display="block" id="M17">
<mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:mtext>ln</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mtext>ln</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mo> </mml:mo><mml:mo>〈</mml:mo><mml:mi>B</mml:mi><mml:mo>〉</mml:mo><mml:mo>,</mml:mo></mml:mrow>
</mml:math>
</alternatives>
<label>(6)</label>
</disp-formula>
This correction was particularly important for improving the accuracy of the slope measurement because it mostly applied to the data in the lower nit-scores to which SlopeTree gives the highest weights (described below) (<xref ref-type="fig" rid="pcbi.1004985.g002">Fig 2B</xref>).</p>
<fig id="pcbi.1004985.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004985.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Refining SlopeTree evolutionary distances.</title>
<p>A) Plot for binning correction. B) Corrected (blue) and uncorrected (red) data. C) Tikhonov positive restraint. D) Calculating an effective number of states to correct for nonlinearity in the SlopeTree distances.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004985.g002" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec016">
<title>Bounds selection</title>
<p>SlopeTree uses the area of the histogram corresponding to the decay of evolutionarily conserved sequences. This requires that for each plot, the lower and upper bounds of this area be selected. For the nit-scores in which the counts for the scrambled data (see Background subtraction) are more than 25% the counts for the real data, the real data values are set to 0, and the left bound set to the nit-score with the maximum count. To select the right bound, the binning correction described above is used. This correction provides an estimate of the nit-score at which the cap on matching sequences, imposed by the maximum k-mer length, would cause the match counts to begin to decline (for nit-scores greater than ~55 in <xref ref-type="fig" rid="pcbi.1004985.g002">Fig 2A</xref>). For each binning correction plot, a rolling average 〈<italic>R</italic>〉 across the counts is calculated; starting at nit-score 0, ln(〈<italic>R</italic>〉) for each index is stored in a vector. This vector is then scanned for the largest nit-score at which the value of the natural log of the bin correction counts is within 0.1 of the natural log for the rolling average at that same index (<italic>i</italic>). The right bound is set to <italic>i</italic>-1, <italic>assuming</italic> the match counts are greater than 0 at this value. Otherwise, it is set to the lowest nit-score for which the pair had no matches.</p>
</sec>
<sec id="sec017">
<title>Estimating evolutionary distances by measuring SlopeTree slopes</title>
<p>The histograms SlopeTree produces (Algorithm 3) consist of the number of unique k-mer matches between a pair of proteomes over the range of all possible nit-scores. These histograms, when plotted in natural log, exhibit a linear dependence at the higher nit-scores which corresponds to the decay of evolutionarily conserved sequences (<xref ref-type="fig" rid="pcbi.1004985.g001">Fig 1A and 1B</xref>). As the matches become sparser for higher nit-scores, the data becomes increasingly noisy. Therefore, the slope is measured using a weighted fit, where the scores with higher counts are given more weight (<italic>w</italic>(<italic>i</italic>)) than those with lower counts:
<disp-formula id="pcbi.1004985.e018">
<alternatives>
<graphic id="pcbi.1004985.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004985.e018" xlink:type="simple"/>
<mml:math display="block" id="M18">
<mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>W</mml:mi></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow>
</mml:math>
</alternatives>
<label>(7)</label>
</disp-formula>
<italic>w</italic> is a constant set to 100 by default. Three fits are then calculated for the data: a linear fit, a quadratic fit, and a fit for the sum of two exponentials.</p>
<p>Linear fit:</p>
<disp-formula id="pcbi.1004985.e019">
<alternatives>
<graphic id="pcbi.1004985.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004985.e019" xlink:type="simple"/>
<mml:math display="block" id="M19">
<mml:mrow><mml:mi>y</mml:mi><mml:mo> </mml:mo><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mi>b</mml:mi></mml:mrow>
</mml:math>
</alternatives>
<label>(8)</label>
</disp-formula>
<disp-formula id="pcbi.1004985.e020">
<alternatives>
<graphic id="pcbi.1004985.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004985.e020" xlink:type="simple"/>
<mml:math display="block" id="M20">
<mml:mrow><mml:mi>d</mml:mi><mml:mo> </mml:mo><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:mo>−</mml:mo><mml:mi>a</mml:mi></mml:mrow>
</mml:math>
</alternatives>
<label>(9)</label>
</disp-formula>
<p>Quadratic fit:</p>
<disp-formula id="pcbi.1004985.e021">
<alternatives>
<graphic id="pcbi.1004985.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004985.e021" xlink:type="simple"/>
<mml:math display="block" id="M21">
<mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mo> </mml:mo><mml:mi>b</mml:mi><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mi>c</mml:mi></mml:mrow>
</mml:math>
</alternatives>
<label>(10)</label>
</disp-formula>
<disp-formula id="pcbi.1004985.e022">
<alternatives>
<graphic id="pcbi.1004985.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004985.e022" xlink:type="simple"/>
<mml:math display="block" id="M22">
<mml:mrow><mml:mi>d</mml:mi><mml:mo> </mml:mo><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:mo>−</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(11)</label>
</disp-formula>
<p>Double exponential fit:</p>
<disp-formula id="pcbi.1004985.e023">
<alternatives>
<graphic id="pcbi.1004985.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004985.e023" xlink:type="simple"/>
<mml:math display="block" id="M23">
<mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mi>F</mml:mi><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>l</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi>G</mml:mi><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>m</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msup></mml:mrow>
</mml:math>
</alternatives>
<label>(12)</label>
</disp-formula>
<disp-formula id="pcbi.1004985.e024">
<alternatives>
<graphic id="pcbi.1004985.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004985.e024" xlink:type="simple"/>
<mml:math display="block" id="M24">
<mml:mrow><mml:mi>d</mml:mi><mml:mo> </mml:mo><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(13)</label>
</disp-formula>
<p specific-use="continuation">The slope (<italic>d</italic>) is invariant in the linear equation. In the quadratic equation, the slope varies as a function of <italic>x</italic>, with the choice of <italic>x</italic> having an effect on the final trees. By default, <italic>x</italic> is set to 15.</p>
</sec>
<sec id="sec018">
<title>Tikhonov positive restraint</title>
<p>SlopeTree applies a Tikhonov positive restraint to the <italic>a</italic>-coefficients. This requires two passes through the data: in the first pass, the average slope (〈<italic>A</italic>〉) over all plots, the root mean square deviation for the fit (<italic>RMSD</italic>), and the uncertainty of the slope (<italic>σ</italic>) are calculated. These values are then included in the summation terms used to calculate the restrained version of the fit. When calculating the fit for the quadratic equation, we first multiplied out the square of the quadratic equation, which we divided into sums, where <inline-formula id="pcbi.1004985.e025"><alternatives><graphic id="pcbi.1004985.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004985.e025" xlink:type="simple"/><mml:math display="inline" id="M25"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mn>40</mml:mn></mml:mrow></mml:msub><mml:mo> </mml:mo><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:mo>∑</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mi>i</mml:mi><mml:mn>4</mml:mn></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1004985.e026"><alternatives><graphic id="pcbi.1004985.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004985.e026" xlink:type="simple"/><mml:math display="inline" id="M26"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mn>21</mml:mn></mml:mrow></mml:msub><mml:mo> </mml:mo><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:mo>∑</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>. These two terms were then modified by the Tikhonov restraint for the new fit (<xref ref-type="fig" rid="pcbi.1004985.g002">Fig 2C</xref>), such that U<sub>40</sub> and U<sub>21</sub> were used in the subsequent fit calculations:
<disp-formula id="pcbi.1004985.e027">
<alternatives>
<graphic id="pcbi.1004985.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004985.e027" xlink:type="simple"/>
<mml:math display="block" id="M27">
<mml:mrow><mml:mo>′</mml:mo><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mn>40</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mn>40</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>R</mml:mi><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:mi>D</mml:mi></mml:mrow><mml:mi>σ</mml:mi></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow>
</mml:math>
</alternatives>
<label>(14)</label>
</disp-formula>
<disp-formula id="pcbi.1004985.e028">
<alternatives>
<graphic id="pcbi.1004985.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004985.e028" xlink:type="simple"/>
<mml:math display="block" id="M28">
<mml:mrow><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mn>21</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mn>21</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo> </mml:mo><mml:mo>〈</mml:mo><mml:mi>A</mml:mi><mml:mo>〉</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>R</mml:mi><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:mi>D</mml:mi></mml:mrow><mml:mi>σ</mml:mi></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow>
</mml:math>
</alternatives>
<label>(15)</label>
</disp-formula>
Slopes were always either negative or in the case of extremely similar organisms, approximately 0. We reversed the sign for all slopes, making distances positive with larger values corresponding to larger distances. SlopeTree uses all three fits at different stages of calculation, but the evolutionary distances used for the trees are derived from the quadratic fit, because the linear fit was too sensitive to HGT and the double exponential proved unstable.</p>
</sec>
<sec id="sec019">
<title>Converting slopes to evolutionary distances</title>
<p>We performed two operations to convert our slopes into evolutionary distances. During the initial compilation of the sorted k-mer list, the entropy for each pair of organisms was calculated. For organisms <italic>p</italic> and <italic>q</italic>, this entropy (<italic>H</italic><sub><italic>pq</italic></sub>) is calculated as:
<disp-formula id="pcbi.1004985.e029">
<alternatives>
<graphic id="pcbi.1004985.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004985.e029" xlink:type="simple"/>
<mml:math display="block" id="M29">
<mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msubsup><mml:mo>Σ</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>20</mml:mn></mml:mrow></mml:msubsup><mml:mfrac><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mtext>ln</mml:mtext><mml:mfrac><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mrow>
</mml:math>
</alternatives>
<label>(16)</label>
</disp-formula>
The final slopes are the slopes derived from the quadratic fit multiplied by their respective entropy.</p>
<p>The other operation was necessary due to backwards mutations (i.e. revertants). Alignment-based methods have very complex mathematics for the accumulation of multiple mutations. However, alignment-free methods only have to consider multiple mutations when they revert to their original position. In the absence of backwards mutations, the slope would be the evolutionary distance for the highly conserved subset of a proteome. This simplified the evolutionary model, which essentially became a two-state model for each amino acid in the starting k-mer (either preserved or not). It was necessary to know, at least roughly, what number of amino acids a starting position could mutate to. In principle, this number would be 19, but in highly conserved positions that were still variable, selection restricted the effective number of possible states. If the total number of possible states was <italic>n</italic>, and <italic>D</italic> was the evolutionary distance, <italic>d</italic> the slope, and <italic>x</italic> the point at which the slope was taken for the quadratic, then our model was that:
<disp-formula id="pcbi.1004985.e030">
<alternatives>
<graphic id="pcbi.1004985.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004985.e030" xlink:type="simple"/>
<mml:math display="block" id="M30">
<mml:mrow><mml:mi>D</mml:mi><mml:mo> </mml:mo><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:mo>−</mml:mo><mml:mi>w</mml:mi><mml:mtext>ln</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>w</mml:mi><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:mi>H</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mi>w</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(17)</label>
</disp-formula>
<disp-formula id="pcbi.1004985.e031">
<alternatives>
<graphic id="pcbi.1004985.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004985.e031" xlink:type="simple"/>
<mml:math display="block" id="M31">
<mml:mrow><mml:mi>w</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>n</mml:mi></mml:mrow>
</mml:math>
</alternatives>
<label>(18)</label>
</disp-formula>
<disp-formula id="pcbi.1004985.e032">
<alternatives>
<graphic id="pcbi.1004985.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004985.e032" xlink:type="simple"/>
<mml:math display="block" id="M32">
<mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(19)</label>
</disp-formula>
This formula was easy to invert to pass from slope to evolutionary distance, but there remained the problem of how to estimate the factor of <italic>n</italic>. We performed a somewhat simplified calculation in order to estimate this value by observing the number of alternative amino acids in k-mers longer than <italic>n</italic>. We found the possible range of <italic>n</italic> to be somewhere between 2.8 and 20 (<xref ref-type="fig" rid="pcbi.1004985.g002">Fig 2D</xref>). Our estimate was likely a lower bound for the actual number. Because of the finite length of the evolutionary distances, we did not observe all possible alternative states, so this presumably caused the estimate to be an underestimation of the actual <italic>n</italic>. This restrained the range of the nonlinearity correction in our model. We expect that the true number would be much closer to the bottom of the range than 20, and <italic>n</italic> = 2.8 is the default setting. But even taking the smallest value corresponding to the largest correction for nonlinearity, within the groups of free-living bacteria or free-living archaea, this nonlinearity correction is not large. As <italic>n</italic> becomes larger, the formula becomes more linear; a nonlinearity correction using <italic>n</italic> = 20 would be minimal.</p>
<p>This is an incomplete description, because the number of alternative amino acids will be different at every position, and this will make the nonlinearity correction somewhat different from simply averaging the number of possible states. However, seeing as how there is already some uncertainty in our nonlinearity correction, this is a secondary consideration. Furthermore, distance-based methods are robust in terms of the nonlinearity of their measure with respect to evolutionary distance. This robustness depends on the type of the phylogenetic inference from the distance method. CVTree is the best example of limited sensitivity to nonlinearity correction; it has a highly nonlinear distance measure, but nevertheless produces meaningful trees. Considering that we faced a minimal range of nonlinearity uncertainty, in terms of tree construction, this could not have been a major factor.</p>
</sec>
<sec id="sec020">
<title>Mobile element (ME) filtering (Algorithm 1)</title>
<p>Alphabetically sorted k-mer lists for each proteome are generated at the very beginning of a SlopeTree run. For each organism separately, these k-mers are clustered by comparing immediately neighboring sequences in the list. By default, k-mers that are identical in 19 out of 20 amino acids are put into the same cluster. The values for <italic>a</italic> and <italic>b</italic>, mentioned in Algorithm 1, are by default 1.0 and 3.0, respectively. This filter makes it possible to identify the elements that are highly repetitive within a single genome, which are almost always parasitic elements such as phage proteins. These are removed from the analysis. EF-Tu is the one consistent exception to this. EF-Tu is frequently present in multiple copies in a single genome.</p>
</sec>
<sec id="sec021">
<title>Conservation filtering (Algorithm 2)</title>
<p>The k-mers in the final alphabetically sorted list across all organisms are compared to their immediate neighbors and grouped together if <italic>x</italic> amino acids (default = 13 out of 20) are identical (i.e. same amino acid in the same position). The default value of 13 matches (for 20-mers) for clustering is adjustable, with a higher cutoff (e.g. 19 or 20) being suitable for strain-level phylogeny. At the end of the clustering and counting process, paralogy scores are calculated by dividing the protein count field by the genome count field. Orthologs generally have a value of 1 for this ratio, whereas paralogs and mobile elements have ratios that are often much higher. These values are summed for each protein across all clusters. A final value of 0 causes the protein to be marked for elimination. Proteins with a paralogy score greater than an orthology cutoff (default = 1.3) are also eliminated. The default value of 1.3 was chosen in consideration for EF-Tu.</p>
<p>Paralogy scores can be calculated for a range of conservation levels. A parameter, which we refer to as <italic>o</italic> in the text, refers to the level of filtering that was applied. The two variables mentioned above, genome count and protein count, are both arrays (default size = 10) in the implementation (arrays <italic>G</italic><sub><italic>ij</italic></sub> and <italic>F</italic><sub><italic>ij</italic></sub> in Algorithm 2). Genome count and protein count for index 0 (i.e. <italic>o</italic> = 0) of this table would be updated for every cluster regardless of cluster size. For index 2 (<italic>o</italic> = 2) of the table, on the other hand, the value would only be updated only for clusters in which 20% or more of the reference set was represented. Paralogy scores calculated from higher indices of the table therefore produced smaller proteomes consisting of more conserved proteins.</p>
</sec>
<sec id="sec022">
<title>Pair-wise HGT correction (Algorithm 4)</title>
<p>First the pair-wise HGT correction identifies pairs with signs of HGT. Pairs in which the double exponential weighted RMSD (<italic>x)</italic> produces a better fit than the quadratic fit weighted RMSD (<italic>y)</italic> are flagged for the correction (default cutoff: <italic>x/y</italic> &lt; 0.9). A shallow slope (i.e. indicating evolutionary closeness) but a high RMSD for the linear fit (default: RMSD&gt;0.12; slope&lt;0.06) also cause a pair to be flagged, because the RMSD is typically very low for slopes from truly close organisms.</p>
<p>For each flagged pair, two iterations through the SlopeTree match-counting code are performed. First, k-mers from a flagged pair are passed through the match-counting code alongside a diverse, pre-selected reference set. Two tables of integers are updated during this match-counting, where each element corresponds to a protein from either of the flagged organisms; one table logs all matches between a protein and the reference set, while the other logs all matches between the flagged pair. Only matches of a given length or longer (default = 12 or more amino acids) are counted for these two tables. At the end of the match-counting, these tables are compared; proteins shared by the pair that are not present in a certain number (default = 3) of reference set organisms are flagged. The pair, without the reference set, is then passed through the match-counting code once more, with all flagged proteins excluded.</p>
</sec>
<sec id="sec023">
<title>Flagging potentially problematic inputs</title>
<p>SlopeTree identifies potential problems in the input such as: reduced genomes (&lt;140,000 amino acids), under-representation of conserved genes, over-representation of conserved genes, and candidate status. Reduced genomes are detected at the early k-mer-counting step. Candidate division organisms are identified simply by scanning the name of the organism for ‘Candidatus.’ SlopeTree identifies proteomes with an under- or over- representation of conserved genes by means of calculations performed during the k-mer clustering described in Algorithm 2. To identify an over-representation of conserved genes, SlopeTree calculates the average number of hits for a cluster per reference proteome, for every cluster containing a large fraction (default = 0.9) of the reference set. Generally, such clusters come from conserved proteins, and this average number of hits is close to 1. For every cluster, for every organism represented in the cluster, the difference between the number of hits that the organism has in the cluster and the average number of hits per reference organism is stored as a running sum. Some organisms are left with much higher values for these sums than others; the IDs of these organisms are written to file. SlopeTree identifies proteomes with an under-representation of conserved genes in a similar manner, using the same set of clusters discussed above (i.e. 90% or more of the reference set present in the cluster). For every organism, SlopeTree counts the number of times the organism has a hit in one of these cluster. At the end of the process, some organisms which were frequently absent from these conserved clusters had significantly lower values for this count, and were also written to file.</p>
<p>These tests identified that genomic sequences based on WGS assembly of environmental reads can have particular characteristics, such as paralogy, rather different from complete genome assemblies. This is very likely due to the intrinsic difficulties in performing assembly based on a non-homogeneous source.</p>
<p>Series of SlopeTree (ST) trees were generated for 72 <italic>Escherichia coli</italic> and <italic>Shigella</italic>, 73 archaea, and 495 bacteria. SlopeTree provides two filters that remove proteins from the input prior to the distance calculations. The Mobile Element (ME) Filter (Algorithm 1) removes mobile elements by taking advantage of their unique copy number patterns within individual proteomes. The Conservation and Stability Filter (Algorithm 2) removes proteins exhibiting an unstable pattern of presence and absence in a taxonomically diverse reference set, with a parameter (<italic>o</italic>) corresponding to the fraction of reference organisms that have to have k-mer matches with a given protein the protein to be retained. SlopeTree also provides additional, separate correction for horizontal gene transfer (HGT) (Algorithm 4) which identifies specific pairs of organisms that appear to have transferred genes and re-calculates the distance using the main SlopeTree routine, with the suspicious proteins removed from the data. This correction is not expected to be effective for extremely ancient transfers, but is adequate for recent transfers such as those involving phage proteins.</p>
<p>We built ST-trees on “raw” (i.e. no filtering) proteomes, proteomes filtered of mobile elements, proteomes filtered of mobile elements and also non-conserved, unstable proteins, and finally filtered proteomes passed through the additional HGT-correction. Most of these trees were pruned of organisms flagged by SlopeTree as problematic, e.g. reduced organisms. For comparison purposes, we calculated symmetric difference (SD) [<xref ref-type="bibr" rid="pcbi.1004985.ref061">61</xref>] distances between all ST-trees and the supermatrix trees [<xref ref-type="bibr" rid="pcbi.1004985.ref025">25</xref>], which we call Eisen-495 (bacteria) and Eisen-73 (archaea), and Eisen-445 and Eisen-71 for their pruned counterparts (<xref ref-type="supplementary-material" rid="pcbi.1004985.s002">S2 Fig</xref>). We also calculated the distances to the Eisen-trees for trees built using other alignment-free methods, namely Average Common Substring (ACS), CVTree, D2, kmacs, and Spaced Words and ALFRED-G. These alternative methods were given both raw data and also a variety of filtered inputs.</p>
<p>SlopeTree proved to be an effective tool for strain-level phylogeny, despite the number of matches between strains of the same species being enormous and most distances being very close to zero (<xref ref-type="fig" rid="pcbi.1004985.g001">Fig 1C and 1E</xref>). SlopeTree was applied to archaea and bacteria separately because matches for organisms belonging to different domains can be very sparse, branch-length nonlinearity is magnified at very large genetic distances (e.g. between the domains of life), and there are cases of occasional but extensive HGT between domains [<xref ref-type="bibr" rid="pcbi.1004985.ref062">62</xref>–<xref ref-type="bibr" rid="pcbi.1004985.ref064">64</xref>].</p>
</sec>
</sec>
<sec id="sec024">
<title>Filtering for Mobile Elements and by Stability and Conservation</title>
<p>We observed occasional curvature in the SlopeTree histograms (<xref ref-type="fig" rid="pcbi.1004985.g001">Fig 1F</xref>). The linear fit was inadequate for plots exhibiting this curvature. Manual inspection of the proteins associated with long length matches between organisms with unexpectedly close distances identified several cases of horizontal gene transfer (HGT). We implemented a quadratic fit to address this, which produced better slopes for a number of cases. However, the quadratic fit also performed poorly when it came to large-scale HGT, e.g. cases involving single copy phages. For this reason, we developed the two filters and the final HGT correction (Algorithms 1–2, 3).</p>
<p>Mobile elements are often present in multiple copies in a single genome, with their k-mers therefore also being present in multiple copies; we used this feature of mobile element k-mer copy number to identify and remove these proteins. This criteria removed an average of 118 proteins from each archaea (stdev = 116) and 162 proteins from each bacteria (stdev = 246). The archaea with the most mobile elements removed was <italic>Methanosarcina acetivorans C2A</italic>, which had 744 proteins removed out of a total 4540. The bacteria with the most mobile elements removed, and which did not show issues with data quality, was <italic>Arthrospira platensis NIES-39</italic>, which had 2143 proteins removed out of a total 6630. The effect this filtering had on the distance to the Eisen-trees was variable; SlopeTree and CVTree show negligible difference before and after the application of the filter; ACS and kmacs showed a small reduction in distance to the Eisen-trees; and D2 and Spaced Words showed a significant reduction in distance to the Eisen-trees.</p>
<p>The conservation filter used a taxonomically diverse reference set of organisms to identify proteins with k-mers that had hits for a minimum fraction (~<italic>o</italic>) of the reference set, and calculated paralogy scores that provided an estimate of a protein’s copy number profile across the entire reference set. This filter was applied to the majority of the ST-trees, in conjunction with the ME-filter. The purpose was to observe how the phylogenetic trees might change as the input was reduced to an increasingly conserved core, and to assess whether these automatic filters could help produce higher quality trees while keeping the methods completely unsupervised. As a validation, we generated histograms from the paralogy scores for proteins with specific keywords in their annotations, with for example ‘ribosomal’ as an instance of a core protein and ‘chemotaxis’ as an instance of an unstable, often horizontally transferred protein (<xref ref-type="supplementary-material" rid="pcbi.1004985.s003">S3 Fig</xref>). The former has a sharp peak at the paralogy score of 1 which decreased but does not disappear for increasing <italic>o</italic>. The latter has two peaks at 0 and 5, with all paralogy scores of 1 disappearing by <italic>o = 2</italic>, indicating that chemotaxis proteins are frequently absent or present in multiple copies. Proteins with paralogy scores less than 1 and greater than 1.3 are filtered out; therefore, as <italic>o</italic> is raised, chemotaxis and other similar proteins are gradually eliminated while the majority of ribosomal proteins and other stable, conserved proteins are retained. For every method, this filtering steadily reduced the distance to the Eisen-trees (<xref ref-type="table" rid="pcbi.1004985.t001">Table 1</xref>) and organisms that were misplaced (according to the NCBI taxonomy) in the unfiltered trees were frequently placed correctly in the more filtered trees.</p>
<table-wrap id="pcbi.1004985.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004985.t001</object-id>
<label>Table 1</label> <caption><title>Distance to Eisen trees for SlopeTree and for five other whole-genome methods, over different levels of mobile-element and conservation filtering.</title></caption>
<alternatives>
<graphic id="pcbi.1004985.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004985.t001" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left">Distance to Eisen-495 tree and Eisen-445 tree</th>
<th align="left">Symmetric difference</th>
<th align="left">Distance to Eisen-73 tree and Eisen-71 tree</th>
<th align="left">Symmetric difference</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><bold>ST—raw</bold></td>
<td align="right"><bold>506</bold></td>
<td align="left"><bold>ST—raw</bold></td>
<td align="right"><bold>56</bold></td>
</tr>
<tr>
<td align="left"><bold>ST—pruned</bold></td>
<td align="right"><bold>426</bold></td>
<td align="left"><bold>ST—pruned</bold></td>
<td align="right"><bold>52</bold></td>
</tr>
<tr>
<td align="left"><bold>ST—pruned, ME</bold></td>
<td align="right"><bold>432</bold></td>
<td align="left"><bold>ST—pruned, ME</bold></td>
<td align="right"><bold>54</bold></td>
</tr>
<tr>
<td align="left"><bold>ST—pruned, ME, o = 3</bold></td>
<td align="right"><bold>388</bold></td>
<td align="left"><bold>ST—pruned, ME, o = 3</bold></td>
<td align="right"><bold>42</bold></td>
</tr>
<tr>
<td align="left"><bold>ST—pruned, ME, o = 3, HGT</bold></td>
<td align="right"><bold>384</bold></td>
<td align="left"><bold>ST—o = 3, HGT</bold></td>
<td align="right"><bold>50</bold></td>
</tr>
<tr>
<td align="left"><bold>ST—pruned, ME, o = 5</bold></td>
<td align="right"><bold>388</bold></td>
<td align="left"><bold>ST—ME, o = 5</bold></td>
<td align="right"><bold>38</bold></td>
</tr>
<tr>
<td align="left"><bold>ST—pruned, ME, o = 5, HGT</bold></td>
<td align="right"><bold>390</bold></td>
<td align="left"><bold>ST—ME, o = 5, HGT</bold></td>
<td align="right"><bold>38</bold></td>
</tr>
<tr>
<td align="left"><bold>ST—pruned, ME, o = 7</bold></td>
<td align="right"><bold>404</bold></td>
<td align="left"><bold>ST—ME, o = 7</bold></td>
<td align="right"><bold>42</bold></td>
</tr>
<tr>
<td align="left"><bold>ST—pruned, ME, o = 7, HGT</bold></td>
<td align="right"><bold>404</bold></td>
<td align="left"><bold>ST—ME, o = 7, HGT</bold></td>
<td align="right"><bold>42</bold></td>
</tr>
<tr>
<td align="left"><bold>ACS—raw</bold></td>
<td align="right"><bold>554</bold></td>
<td align="left"><bold>ACS—raw</bold></td>
<td align="right"><bold>58</bold></td>
</tr>
<tr>
<td align="left"><bold>ACS—pruned</bold></td>
<td align="right"><bold>480</bold></td>
<td align="left"><bold>ACS—pruned</bold></td>
<td align="right"><bold>56</bold></td>
</tr>
<tr>
<td align="left"><bold>ACS—pruned, ME</bold></td>
<td align="right"><bold>474</bold></td>
<td align="left"><bold>ACS—pruned, ME</bold></td>
<td align="right"><bold>50</bold></td>
</tr>
<tr>
<td align="left"><bold>ACS—pruned, ME, o = 3</bold></td>
<td align="right"><bold>412</bold></td>
<td align="left"><bold>ACS—pruned, ME, o = 3</bold></td>
<td align="right"><bold>36</bold></td>
</tr>
<tr>
<td align="left"><bold>ACS—pruned, ME, o = 5</bold></td>
<td align="right"><bold>420</bold></td>
<td align="left"><bold>ACS—pruned, ME, o = 5</bold></td>
<td align="right"><bold>34</bold></td>
</tr>
<tr>
<td align="left"><bold>ACS—pruned, ME, o = 7</bold></td>
<td align="right"><bold>410</bold></td>
<td align="left"><bold>ACS—pruned, ME, o = 7</bold></td>
<td align="right"><bold>34</bold></td>
</tr>
<tr>
<td align="left"><bold>CVTree—raw</bold></td>
<td align="right"><bold>676</bold></td>
<td align="left"><bold>CVTree—raw</bold></td>
<td align="right"><bold>64</bold></td>
</tr>
<tr>
<td align="left"><bold>CVTree—pruned</bold></td>
<td align="right"><bold>868</bold></td>
<td align="left"><bold>CVTree—pruned</bold></td>
<td align="right"><bold>60</bold></td>
</tr>
<tr>
<td align="left"><bold>CVTree—pruned, ME</bold></td>
<td align="right"><bold>868</bold></td>
<td align="left"><bold>CVTree—pruned, ME</bold></td>
<td align="right"><bold>62</bold></td>
</tr>
<tr>
<td align="left"><bold>CVTree—pruned, ME, o = 3</bold></td>
<td align="right"><bold>838</bold></td>
<td align="left"><bold>CVTree—pruned, ME, o = 3</bold></td>
<td align="right"><bold>34</bold></td>
</tr>
<tr>
<td align="left"><bold>CVTree—pruned, ME, o = 5</bold></td>
<td align="right"><bold>832</bold></td>
<td align="left"><bold>CVTree—pruned, ME, o = 5</bold></td>
<td align="right"><bold>34</bold></td>
</tr>
<tr>
<td align="left"><bold>CVTree—pruned, ME, o = 7</bold></td>
<td align="right"><bold>830</bold></td>
<td align="left"><bold>CVTree—pruned, ME, o = 7</bold></td>
<td align="right"><bold>34</bold></td>
</tr>
<tr>
<td align="left"><bold>D2—raw</bold></td>
<td align="right"><bold>528</bold></td>
<td align="left"><bold>D2—raw</bold></td>
<td align="right"><bold>50</bold></td>
</tr>
<tr>
<td align="left"><bold>D2—pruned</bold></td>
<td align="right"><bold>458</bold></td>
<td align="left"><bold>D2—pruned</bold></td>
<td align="right"><bold>44</bold></td>
</tr>
<tr>
<td align="left"><bold>D2—pruned, ME</bold></td>
<td align="right"><bold>416</bold></td>
<td align="left"><bold>D2—pruned, ME</bold></td>
<td align="right"><bold>36</bold></td>
</tr>
<tr>
<td align="left"><bold>D2—pruned, ME, o = 3</bold></td>
<td align="right"><bold>386</bold></td>
<td align="left"><bold>D2—pruned, ME, o = 3</bold></td>
<td align="right"><bold>32</bold></td>
</tr>
<tr>
<td align="left"><bold>D2—pruned, ME, o = 5</bold></td>
<td align="right"><bold>366</bold></td>
<td align="left"><bold>D2—pruned, ME, o = 5</bold></td>
<td align="right"><bold>34</bold></td>
</tr>
<tr>
<td align="left"><bold>D2—pruned, ME, o = 7</bold></td>
<td align="right"><bold>366</bold></td>
<td align="left"><bold>D2—pruned, ME, o = 7</bold></td>
<td align="right"><bold>32</bold></td>
</tr>
<tr>
<td align="left"><bold>kmacs—raw</bold></td>
<td align="right"><bold>524</bold></td>
<td align="left"><bold>kmacs—raw</bold></td>
<td align="right"><bold>50</bold></td>
</tr>
<tr>
<td align="left"><bold>kmacs—pruned</bold></td>
<td align="right"><bold>448</bold></td>
<td align="left"><bold>kmacs—pruned</bold></td>
<td align="right"><bold>48</bold></td>
</tr>
<tr>
<td align="left"><bold>kmacs—pruned, ME</bold></td>
<td align="right"><bold>440</bold></td>
<td align="left"><bold>kmacs—pruned, ME</bold></td>
<td align="right"><bold>48</bold></td>
</tr>
<tr>
<td align="left"><bold>kmacs—pruned, ME, o = 3</bold></td>
<td align="right"><bold>390</bold></td>
<td align="left"><bold>kmacs—pruned, ME, o = 3</bold></td>
<td align="right"><bold>36</bold></td>
</tr>
<tr>
<td align="left"><bold>kmacs—pruned, ME, o = 5</bold></td>
<td align="right"><bold>372</bold></td>
<td align="left"><bold>kmacs—pruned, ME, o = 5</bold></td>
<td align="right"><bold>34</bold></td>
</tr>
<tr>
<td align="left"><bold>kmacs—pruned, ME, o = 7</bold></td>
<td align="right"><bold>350</bold></td>
<td align="left"><bold>kmacs—pruned, ME, o = 7</bold></td>
<td align="right"><bold>32</bold></td>
</tr>
<tr>
<td align="left"><bold>spaced—raw</bold></td>
<td align="right"><bold>810</bold></td>
<td align="left"><bold>spaced—raw</bold></td>
<td align="right"><bold>88</bold></td>
</tr>
<tr>
<td align="left"><bold>spaced—pruned</bold></td>
<td align="right"><bold>720</bold></td>
<td align="left"><bold>spaced—pruned</bold></td>
<td align="right"><bold>80</bold></td>
</tr>
<tr>
<td align="left"><bold>spaced—pruned, ME</bold></td>
<td align="right"><bold>684</bold></td>
<td align="left"><bold>spaced—pruned, ME</bold></td>
<td align="right"><bold>76</bold></td>
</tr>
<tr>
<td align="left"><bold>spaced—pruned, ME, o = 3</bold></td>
<td align="right"><bold>478</bold></td>
<td align="left"><bold>spaced—pruned, ME, o = 3</bold></td>
<td align="right"><bold>64</bold></td>
</tr>
<tr>
<td align="left"><bold>spaced—pruned, ME, o = 5</bold></td>
<td align="right"><bold>452</bold></td>
<td align="left"><bold>spaced—pruned, ME, o = 5</bold></td>
<td align="right"><bold>56</bold></td>
</tr>
<tr>
<td align="left"><bold>spaced—pruned, ME, o = 7</bold></td>
<td align="right"><bold>430</bold></td>
<td align="left"><bold>spaced—pruned, ME, o = 7</bold></td>
<td align="right"><bold>46</bold></td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>To be valid inputs to SlopeTree, proteomes cannot be filtered beyond a certain level. This is because SlopeTree distances are derived from the decay of k-mers as a function of match length, and when the average proteome size drops below ~100–200 proteins, the algorithm begins to encounter pairs that no longer have measurable or informative slopes. This defines a filtering limit for SlopeTree in the vicinity of <italic>o</italic> = 8 or <italic>o</italic> = 9, but not all alignment-free methods have this constraint.</p>
<p>The pair-wise HGT correction was designed to correct very occasional but serious error when a single copy phage was transferred between distal organisms. The mobile element filter is not designed to identify single copy phages, which represent a rare category of phages. The ME filter, conservation filter, and pair-wise HGT correction are separate modules in SlopeTree that are applied at different times and address slightly different issues in the data. However, they overlap in many of the proteins they remove; for instance, the mobile element filter and conservation filter both remove many proteins that the HGT filter would remove, were the conservation filter not applied. In general, we found that by <italic>o = 3</italic> or <italic>o</italic> = 5, most problematic proteins were already removed and the HGT filter had little impact on the final trees.</p>
</sec>
<sec id="sec025">
<title>SlopeTree Applied to Strains: 72 <italic>Escherichia coli</italic> and <italic>Shigella</italic></title>
<p>A series of ST-trees was built for 62 <italic>E</italic>.<italic>coli</italic> and 10 <italic>Shigella</italic> (<xref ref-type="fig" rid="pcbi.1004985.g003">Fig 3</xref> and <xref ref-type="supplementary-material" rid="pcbi.1004985.s004">S4 Fig</xref>), which were all the complete proteomes available for these species at the time of this writing. This was to test the range at which SlopeTree could still resolve sensible evolutionary distances. <italic>Escherichia fergusonii</italic> and <italic>Escherichia blattae</italic> were included in the run as outgroups to root the trees, but were removed from the final distance matrices prior to tree-building because their presence excessively compressed the other distances. To assess whether longer k-mers might produce more accurate distances at the strain-level, we built a tree using 20-mers (<xref ref-type="fig" rid="pcbi.1004985.g003">Fig 3</xref>) and another using 40-mers. We did not observe an improvement; the 20-mer and 40-mer trees were in very close agreement, with topological differences arising from short branches mainly in the B2 phylogroup. We built additional trees using proteomes filtered for mobile elements, and also proteomes filtered for stability and conservation, in which the reference set for the conservation filter was simply the entire input. The average number of proteins per proteome for the 72 <italic>E</italic>.<italic>coli</italic> and <italic>Shigella</italic>, prior to filtering, was 4730 (stdev = 485). When the set was filtered just for mobile elements, the average size was reduced to an average of 4282 proteins (stdev = 402). This set, with mobile elements removed, was filtered against itself for the smallest possible filtering parameter (<italic>o</italic> = 0), reduced the average proteome size to 4071 (stdev = 362); for self-filtering on <italic>o</italic> = 5, the average size was then 3465 (stdev = 209); and for <italic>o</italic> = 10, the average size was 1290 (stdev = 9). For all trees, the trees were highly similar to the unfiltered trees. We performed more aggressive conservation filtering against a reference set of 30 diverse bacteria (<italic>o</italic> = 3), leaving an average of 343 (stdev = 41) proteins per proteome. This was done to investigate whether the trees built from the most conserved genes across the entire domain of bacteria matched those built without filtering and those built with loose filtering. Again, we observed only minor changes in topology, mostly involving short branches. As an additional validation, we reduced the unfiltered 20-mer tree to the set considered in Touchon et al. [<xref ref-type="bibr" rid="pcbi.1004985.ref065">65</xref>] which was used as a reference for another alignment-free method in Sims et al. [<xref ref-type="bibr" rid="pcbi.1004985.ref066">66</xref>]; these two topologies were also found to be in agreement.</p>
<fig id="pcbi.1004985.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004985.g003</object-id>
<label>Fig 3</label>
<caption>
<title>ST-tree from 72 <italic>E</italic>. <italic>coli</italic> and <italic>Shigella</italic> using 20-mers and unfiltered data.</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004985.g003" xlink:type="simple"/>
</fig>
<p>The ST strain-level topology also agreed with current phylogroups of <italic>E</italic>.<italic>coli</italic> and <italic>Shigella</italic>. There are different means for determining phylogroups, with some assignments varying between approaches [<xref ref-type="bibr" rid="pcbi.1004985.ref067">67</xref>, <xref ref-type="bibr" rid="pcbi.1004985.ref068">68</xref>]; SlopeTree supports the grouping of <italic>E</italic>. <italic>coli IAI39 uid59381</italic>with phylogroup D and <italic>E</italic>. <italic>coli APEC O78 uid187277</italic> with phylogroup C. Pathotypes do not follow phylogeny [<xref ref-type="bibr" rid="pcbi.1004985.ref069">69</xref>] and when they were mapped the trees, their placement was scattered. The genes responsible for pathogenicity are frequently mobile elements [<xref ref-type="bibr" rid="pcbi.1004985.ref056">56</xref>, <xref ref-type="bibr" rid="pcbi.1004985.ref070">70</xref>, <xref ref-type="bibr" rid="pcbi.1004985.ref071">71</xref>], so we constructed an ST-tree from mobile elements and less conserved proteins removed during filtering on <italic>o</italic> = 0, to investigate whether strains of the same pathotype would cluster. We did not see this effect; not surprisingly, this tree differed from the other trees in several placements, but nevertheless held many groupings in common, particularly between the more closely related strains (<xref ref-type="supplementary-material" rid="pcbi.1004985.s004">S4 Fig</xref>).</p>
<p>When strains differ by very few mutations in DNA, most of these will not cause changes in coding sequence. For such cases, performing phylogenetic analyses by following the easily identifiable mutations at the DNA level is the more accurate and practical approach.</p>
</sec>
<sec id="sec026">
<title>SlopeTree Applied to 73 Archaea</title>
<p>A series of ST-trees was constructed for 73 archaea (<xref ref-type="fig" rid="pcbi.1004985.g004">Fig 4</xref> and <xref ref-type="supplementary-material" rid="pcbi.1004985.s005">S5 Fig</xref>). These 73 were all the archaea in Lang et al. [<xref ref-type="bibr" rid="pcbi.1004985.ref025">25</xref>] that had available proteomes in NCBI. Two archaea were pruned from the distance matrix prior to building the trees: <italic>Candidatus Korarchaeum cryptofilum OPF8 uid58601</italic>, and <italic>Nanoarchaeum equitans Kin4 M uid58009</italic>. Both were automatically flagged by SlopeTree for having an unusually low number of conserved genes compared to the rest of the set. As with the strain-level analysis, we generated both unfiltered ST-trees and also filtered ST-trees, and also applied our pair-wise HGT correction. These trees were compared to the Eisen-73 and Eisen-71 trees. Differences in filtering parameters produced some changes in topology, with distances to the Eisen-73 tree generally decreasing as filtering increased. For instance, without filtering (but with pruning), the symmetric difference distance was 52, compared to 38 for filtering on <italic>o</italic> = 5. For the purpose of comparison, we also built trees on unfiltered and filtered data using five other alignment-free methods: ACS (<xref ref-type="supplementary-material" rid="pcbi.1004985.s006">S6 Fig</xref>), CVTree (<xref ref-type="supplementary-material" rid="pcbi.1004985.s007">S7 Fig</xref>), D2 (<xref ref-type="supplementary-material" rid="pcbi.1004985.s008">S8 Fig</xref>), kmacs (<xref ref-type="supplementary-material" rid="pcbi.1004985.s009">S9 Fig</xref>), and Spaced Words (<xref ref-type="supplementary-material" rid="pcbi.1004985.s010">S10 Fig</xref>). A smaller set of trees, due to the long run-time of the program, was calculated for ALFRED-G (<xref ref-type="supplementary-material" rid="pcbi.1004985.s011">S11 Fig</xref>). The symmetric difference distances to the Eisen-73 and Eisen-71 trees are shown in <xref ref-type="table" rid="pcbi.1004985.t001">Table 1</xref>, with more distances available in <xref ref-type="supplementary-material" rid="pcbi.1004985.s020">S1 Table</xref>.</p>
<fig id="pcbi.1004985.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004985.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Phylogenetic trees for 73 Archaea.</title>
<p>A) ST-tree, raw and pruned. B) ST-tree, pruned, with mobile element filtering and conservation filtering (<italic>o</italic> = 5). C) Eisen-71 tree.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004985.g004" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec027">
<title>SlopeTree Applied to 495 Bacteria</title>
<p>We built a series of ST-trees for 495 bacteria on unfiltered data, filtered data (varying the value of <italic>o</italic>), and with and without the final pair-wise HGT correction (<xref ref-type="fig" rid="pcbi.1004985.g005">Fig 5</xref> and <xref ref-type="supplementary-material" rid="pcbi.1004985.s012">S12 Fig</xref>). As the root, we chose the division between the gram-negative and gram-positive bacteria. Organisms identified by SlopeTree as problematic (e.g. unusual number of conserved genes, reduced genomes, significantly fragmented assemblies, candidate division, etc.) were retained throughout the entire SlopeTree run, but pruned from the majority of the final trees (<xref ref-type="supplementary-material" rid="pcbi.1004985.s021">S1 Text</xref>). Mobile element and conservation filtering reduced the distance to the Eisen-495 tree for all methods, fixing several misplacements of individual organisms as well as shifting whole branches to locations more in keeping with the current NCBI classifications. By ‘misplacement’ we mean a disagreement with the current NCBI classification. For the purpose of comparison, we built trees on full and filtered data using ACS (<xref ref-type="supplementary-material" rid="pcbi.1004985.s013">S13 Fig</xref>), CVTree (<xref ref-type="supplementary-material" rid="pcbi.1004985.s014">S14 Fig</xref>), D2 (<xref ref-type="supplementary-material" rid="pcbi.1004985.s015">S15 Fig</xref>), kmacs (<xref ref-type="supplementary-material" rid="pcbi.1004985.s016">S16 Fig</xref>), and Spaced Words (<xref ref-type="supplementary-material" rid="pcbi.1004985.s017">S17 Fig</xref>). We also built trees using ALFRED-G, but could only test the <italic>o</italic> = 5 and <italic>o</italic> = 7 inputs due to the long run-time of the program (<xref ref-type="supplementary-material" rid="pcbi.1004985.s018">S18 Fig</xref>). The ALFRED-G distances are included in <xref ref-type="supplementary-material" rid="pcbi.1004985.s020">S1 Table</xref>.</p>
<fig id="pcbi.1004985.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004985.g005</object-id>
<label>Fig 5</label>
<caption>
<title>ST-tree of 495 bacteria.</title>
<p>Tree was pruned to 445, with mobile element filtering and conservation filtering (<italic>o</italic> = 3). Pair-wise HGT correction was performed.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004985.g005" xlink:type="simple"/>
</fig>
<p>There is no consensus regarding the positions of the deep branches of phylogenetic trees. Even the attempt to root the tree on the division between gram-positive and gram-negative bacteria could not be done cleanly, with the Chlamydiae, Cyanobacteria and Spirochaetes moving between these two groups for different levels of filtering. Not just SlopeTree, but all alignment-free methods have changes in their tree topologies as the inputs are filtered more aggressively. Nevertheless, we observed some stable features in the ST-trees that are stable for the other methods as well. These include a clade consisting of the Gammaproteobacteria, Betaproteobacteria, and Alphapoteobacteria. The Bacteroidetes, Chlorobi, and Gemmatimonadetes form another stable clade, typically neighboring a group consisting of the Spirochaetes and some subset of the Planctomycetes-Verrucomicrobia-Chlamydia (PVC) superphylum [<xref ref-type="bibr" rid="pcbi.1004985.ref072">72</xref>, <xref ref-type="bibr" rid="pcbi.1004985.ref073">73</xref>]. These features are consistent with the Eisen-495 tree. The Deltaproteobacteria however are almost always polyphyletic or paraphyletic. The position of the Acidobacteria is also variable, grouping with the Proteobacteria (mainly the Deltaproteobacteria) or the PVC group. The Epsilonproteobacteria are consistently monophyletic, but they group with the Proteobacteria for raw and less-filtered trees (up to <italic>o</italic> = 3) and the Aquificae or PVC group for more filtered trees (<italic>o</italic> = 5 or more).</p>
<p>SlopeTree usually places the Aquificae and a diverse, sulfur-reducing thermophilic group with the gram-negative bacteria, close to a group of Deltaproteobacteria. Filtering and the pair-wise HGT correction move this clade to an area that is separate from the majority of the gram-negative bacteria (Proteobacteria, Bacteroidetes, Chlorobi, Verrucomicrobia, Planctomycetes, etc.) and the gram-positive bacteria (Actinobacteria, Firmicutes) alike. The Cyanobacteria are also often found in this area; they are typically on a short, deep branch and in the filtered trees, they neighbor the Deinococcus-Thermus. In the unfiltered ST-tree in which the pair-wise HGT correction was not performed, the Cyanobacteria are grouped with the Proteobacteria, which agrees with the Eisen-495 tree. However, a cursory investigation of the prospective HGT pairs for the members of Cyanobacteria present in the analysis revealed numerous possible transfers with the Proteobacteria, and the pair-wise HGT correction alone, even with no filtering, moved the Cyanobacteria away from the gram-negative bacteria and into the neutral area. This area also often includes a clade consisting of the Thermotogae and Synergistetes, another stable group whose placement in the trees varies between this area and a placement deep within the gram-positive bacteria.</p>
<p>The remainder of the tree consists predominantly of gram-positive bacteria. The Firmicutes and Actinobacteria typically share a common root, in agreement with the Eisen-495 tree. The Firmicutes are polyphyletic in all ST-trees, with the Tenericutes branching from within them. Whether the Tenericutes are their own phylum or belong within the Firmicutes is debated [<xref ref-type="bibr" rid="pcbi.1004985.ref074">74</xref>]; SlopeTree consistently groups them within the Firmicutes, matching the Eisen-495 tree. The occasional presence of the Thermotogae within the Firmicutes is at least in part due to a clear instance of HGT discussed later, but it has been observed that the Thermotogae and Firmicutes, in particular Clostridia, show similarity at the whole-genome level [<xref ref-type="bibr" rid="pcbi.1004985.ref075">75</xref>, <xref ref-type="bibr" rid="pcbi.1004985.ref076">76</xref>]. The Fusobacteria are also in this clade, first nested within the Firmicutes but then more and more basal as filtering increases. The placement of the Fusobacteria with the gram-positive bacteria, despite their being gram negative, has support [<xref ref-type="bibr" rid="pcbi.1004985.ref076">76</xref>, <xref ref-type="bibr" rid="pcbi.1004985.ref077">77</xref>]. This generally gram-positive clade also often included the Chloroflexi. Like the Thermotogae, the Chloroflexi mostly stain Gram negative, but are monoderms [<xref ref-type="bibr" rid="pcbi.1004985.ref078">78</xref>]. This placement is seen in the majority of trees produced by the other alignment-free methods and is also seen in the Eisen-495 tree.</p>
</sec>
<sec id="sec028">
<title>Bacteria That Diverge from the Eisen-495 Tree or the NCBI Classification</title>
<p>It is to be expected that different phylogenetic methods will produce different phylogenetic trees. However, the set of organisms that is misplaced in the trees according to the current NCBI taxonomy is remarkably consistent between all alignment-free methods and many of these misplacements were present in the supermatrix tree and specifically discussed in Lang et al. [<xref ref-type="bibr" rid="pcbi.1004985.ref025">25</xref>]. We discuss some of them below.</p>
<sec id="sec029">
<title><italic>Coprothermobacter proteolyticus</italic>, Dictyoglomi, Thermotogae and Synergistetes</title>
<p><italic>C</italic>. <italic>proteolyticus</italic>, currently classified as a member of Clostridia, is a thermophilic, gram-negative bacterium which was classified first as <italic>Thermobacteroides proteolyticus</italic> before being reclassified as a Firmicute, order Thermoanaerobacterales [<xref ref-type="bibr" rid="pcbi.1004985.ref079">79</xref>]. Through the entire range of ST-trees without exception, it maintains a stable position alongside <italic>Dictyoglomus turgidum DSM 6724</italic>, a member of the Dictyoglomi. Together, <italic>C</italic>. <italic>proteolyticus</italic> and <italic>D</italic>. <italic>turgidum</italic> neighbor the Thermotogae, and this group in turn neighbors the Synergistetes. This placement is supported by the Eisen-495 tree and by other, independent observations from the literature [<xref ref-type="bibr" rid="pcbi.1004985.ref080">80</xref>, <xref ref-type="bibr" rid="pcbi.1004985.ref081">81</xref>]. Trees built by CVTree, D2, ACS, kmacs, Spaced Words, and ALFRED-G also support this classification.</p>
</sec>
<sec id="sec030">
<title>A sulfur-reducing thermophilic cluster</title>
<p>There was tendency for sulfur-reducing thermophiles to cluster together in the tree, irrespective of their phylum. This cluster generally consisted of the Aquificae, a group of Deltaproteobacteria, and four additional bacteria: <italic>Thermodesulfobium narugense</italic> (Clostridia), <italic>Thermodesulfatator indicus DSM 15286</italic> (Thermodesulfobacteria), <italic>Thermodesulfovibrio yellowstonii DSM 11347</italic> (Nitrospira), and <italic>Hippea maritima</italic> (Deltaproteobacteria). All four were specifically described in Lang et al. [<xref ref-type="bibr" rid="pcbi.1004985.ref025">25</xref>] for their unusual phylogeny. <italic>H</italic>. <italic>maritima</italic> was placed in the Desulfurellaceae family of the Deltaproteobacteria by means of 16S rRNA [<xref ref-type="bibr" rid="pcbi.1004985.ref082">82</xref>]; Lang et al. propose [<xref ref-type="bibr" rid="pcbi.1004985.ref025">25</xref>] to move it to the Epsilonproteobacteria. In the ST-phylogeny, <italic>H</italic>. <italic>maritima</italic> consistently appears closest to the Aquificae, forming a clade with this phylum in every ST-tree except for the most stringently filtered (o = 7) ST-tree, in which it finally joins a clade consisting of Nitrospirae, Fibrobacteres, Verrucomicrobia, Planctomycetes, and the Epsilonproteobacteria. For <italic>T</italic>. <italic>yellowstonii</italic>, until filtering at <italic>o</italic> = 5, it groups with the Aquificae, but then moves to the Epsilonproteobacteria. On the other hand, <italic>T</italic>. <italic>narugense</italic>, for <italic>o</italic> = 3 groups with <italic>C</italic>. <italic>proteolyticus</italic>, <italic>D</italic>. <italic>turgidum</italic>, the Thermotogae and the Synergistetes. This is the placement supported in the Eisen-495 tree. However, for <italic>o = 5</italic> and <italic>o</italic> = 7, it groups with the Deinoccocus-Thermus. <italic>T</italic>. <italic>desulfatator</italic>, for the totally raw tree, the pruned tree, and filtered for <italic>o</italic> = 0, o = 1, and o = 5, it is found among the sulfur-reducing group; for <italic>o</italic> = 3 and <italic>o</italic> = 7, and also in the tree where no conservation filtering (only mobile element filtering) has been performed, it groups with the Deltaproteobacteria.</p>
<p>These four, together with the Aquificae, indicate that the less filtered trees, which provide a phylogenetic perspective that is inaccessible to alignment-based approaches, sometimes reflect phenetics over phylogeny. This grouping was present in all alignment-free methods, persisting to different extents as the data were filtered.</p>
</sec>
<sec id="sec031">
<title><italic>Acidithiobacillus ferrooxidans ATCC 23270</italic> and <italic>Acidithiobacillus caldus</italic></title>
<p>NCBI currently classifies these two acidophiles as Gammaproteobacteria. In the unfiltered ST-tree, they form a basal group within the Gammaproteobacteria as well. However, their placement is unstable, and filtering can move them to within the Betaproteobacteria or make them a basal group for the two phyla. Compounding this ambiguity is the fact that under the heaviest conservation, they return to the Gammaproteobacteria. This ill-defined behavior was apparent in the other alignment-free phylogenies as well. It has been noted before that the <italic>Acidithiobacillales</italic> behave ambivalently [<xref ref-type="bibr" rid="pcbi.1004985.ref083">83</xref>, <xref ref-type="bibr" rid="pcbi.1004985.ref084">84</xref>]. Lang et al. [<xref ref-type="bibr" rid="pcbi.1004985.ref025">25</xref>] propose the creation of an “eta-proteobacteria” lineage for them. The alignment-free trees do not contradict this proposal.</p>
</sec>
<sec id="sec032">
<title><italic>Dehalogenimonas lykanthroporepellens</italic> and <italic>Dehalococcoides mccartyi 195</italic></title>
<p><italic>D</italic>. <italic>lykanthroporepellens</italic> and <italic>D</italic>. <italic>mccartyi</italic> are members of the Chloroflexi. Both stain Gram negative, with the former being a mesophile—a somewhat unusual feature for a Chloroflexi. Both were classified by means of the 16S rRNA gene [<xref ref-type="bibr" rid="pcbi.1004985.ref085">85</xref>, <xref ref-type="bibr" rid="pcbi.1004985.ref086">86</xref>]. When no filtering was performed, SlopeTree misclassified this pair, grouping <italic>D</italic>. <italic>lykanthroporepellens</italic> with the Gammaproteobacteria and <italic>D</italic>. <italic>mccartyi</italic> with the Firmicutes. This pair was also misclassified by all other alternative methods (ACS, CVTree, D2 and Spaced Words) up to some level of filtering, although D2 showed the most robustness to this misplacement. The misplacement of <italic>D</italic>. <italic>lykanthroporepellens</italic> is due to a phage transfer shared with <italic>Syntrophobacter fumaroxidans</italic>, and <italic>Desulfarculus baarsi</italic> (Gammaproteobacteria). The pair-wise HGT correction also flagged the Firmicute <italic>Natranaerobius thermophilus JW/NM-WN-LF</italic> as being a possible partner of <italic>D</italic>. <italic>mccartyi</italic>, and removed several transporters prior to recalculating the evolutionary distance. The lightest level of conservation filtering (<italic>o</italic> = 0) was sufficient to fix the misplacement of these two Chloroflexi. We also found that the pair-wise HGT correction, even without filtering, also corrected their placement.</p>
</sec>
<sec id="sec033">
<title><italic>Rhodothermus marinus</italic> and <italic>Salinibacter ruber</italic></title>
<p>Every ST-tree contains the Bacteroidetes and Chlorobi clade. However, the family Rhodothermaceae, which consists of <italic>R</italic>. <italic>marinus</italic> and <italic>S</italic>. <italic>ruber</italic> and is classified as belonging to the Bacteroidetes, is frequently either grouped with the Chlorobi or placed on a branch basal to both phyla. The Eisen-495 tree places this pair of bacteria with the Bacteroidetes, but all alignment-free methods frequently set this pair apart from the Bacteroidetes. When no ME filtering or conservation filtering were performed, or for very low levels of conservation filtering, ACS, CVTree and kmacs can completely misplace these two bacteria. For instance when no mobile element and conservation filtering are performed, kmacs groups the pair with the three Actinobacteria discussed above, the Myxococcales, and Deinococcus-Thermus.</p>
</sec>
</sec>
<sec id="sec034">
<title>Pair-Wise HGT Correction and Examples of HGT</title>
<p>We observed two main classes of HGT for the pair-wise HGT correction. The first was associated with single copy phages. <italic>D</italic>. <italic>lykanthroporepellens</italic> and both <italic>Syntrophobacter fumaroxidans</italic> and <italic>Desulfarculus baarsi</italic> serve as an example of this. The second was related to adaptation-associated proteins. <italic>Petrotoga mobilis</italic> and <italic>Mahella australiensis</italic>, which shared a transfer of proteins associated with resistance to a toxic environment, are an example. Both were addressed by means of a combination of mobile element filtering and a sufficiently high value for <italic>o</italic>, and in general this was our preferred approach because it is significantly more efficient than running the HGT filter on a large number of pairs. However, we did observe that for a very low <italic>o</italic>, or when filtering was not applied, the pair-wise HGT correction was able to correct the placement of <italic>D</italic>. <italic>lykothroporepellens</italic>, <italic>D</italic>. <italic>mccartyi</italic>, and <italic>P</italic>. <italic>mobilis</italic> (<xref ref-type="supplementary-material" rid="pcbi.1004985.s019">S19 Fig</xref>). In addition, it amended the placement of <italic>Leptospira biflexa serovar Patoc</italic> and <italic>Leptospira interrogans serovar Lai</italic>, two Spirochaetes which every alignment-free method misplaced unless using a very high level of conservation filtering. <italic>Rhodothermus marinus</italic> and <italic>Salinibacter ruber M8</italic>, classified as Bacteroidetes, were also moved from the Chlorobi back to the Bacteroidetes. The correction also caused some substantial reordering of the deeper branches. The Gammaproteobacteria, which are completely monophyletic in the uncorrected tree, are split into two groups in the HGT-corrected tree, in both cases forming a monophyletic clade with the Betaproteobacteria; this split is often seen in the other alignment-free methods and may be an indication of a missing “eta” class for the Proteobacteria [<xref ref-type="bibr" rid="pcbi.1004985.ref025">25</xref>, <xref ref-type="bibr" rid="pcbi.1004985.ref084">84</xref>]. The pair-wise HGT correction also removed the Cyanobacteria from the Proteobacteria, placing them close to the root alongside the Deinococcus-Thermus which were also shifted out of the Firmicutes. The Spirochaetes and Chlamydiae were also moved from the gram-positive bacteria to the gram-negative bacteria.</p>
</sec>
<sec id="sec035">
<title>Distances to Eisen-trees and Other Whole-Proteome or Alignment-Free Methods</title>
<p>The symmetric difference distance [<xref ref-type="bibr" rid="pcbi.1004985.ref061">61</xref>] was calculated between all alignment-free trees and the Eisen-trees, using the treedist program in PHYLIP [<xref ref-type="bibr" rid="pcbi.1004985.ref087">87</xref>]. However, we note that the Eisen-trees are only approximations of the real evolutionary history, and that the methods should not be judged as “better” or “worse” purely according to their distances to these approximations. The kmacs method, with mobile element filtering and conservation filtering on <italic>o = 7</italic>, achieved the closest tree to the Eisen-tree for both bacteria and archaea, with a symmetric difference distance of 350 and 32. D2 also achieved a distance of 32 to the Eisen-71 tree. For bacteria and archaea, SlopeTree achieved 384 and 38, both at <italic>o</italic> = 5.</p>
<p>Filtering lessened the distance to the Eisen-trees for all methods (<xref ref-type="fig" rid="pcbi.1004985.g006">Fig 6B</xref> and <xref ref-type="table" rid="pcbi.1004985.t001">Table 1</xref>). We observed a distinct difference in the nature of the branch lengths between different methods; D2, SlopeTree and Spaced Words fall into one group, having a wider range of branch lengths, while ACS, CVTree, kmacs, and ALFRED-G have branch lengths that are restricted to a more narrow range (<xref ref-type="fig" rid="pcbi.1004985.g006">Fig 6A, 6C and 6D</xref>). ACS appears to be the most restricted in this regard, and we found that by applying the conservation filter, the range for a given method’s distances was somewhat widened.</p>
<fig id="pcbi.1004985.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004985.g006</object-id>
<label>Fig 6</label>
<caption>
<title>SlopeTree and other alignment-free methods.</title>
<p>A) Histogram of scaled distances produced by each method. B) Decrease in symmetric difference distance to the Eisen-495 tree for Spaced Words method. C) SlopeTree distances to D2 distances for a matching set of randomly selected organism pairs. D) SlopeTree distances to ACS distances for a matching set of randomly selected organism pairs.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004985.g006" xlink:type="simple"/>
</fig>
</sec>
</sec>
<sec id="sec036" sec-type="conclusions">
<title>Discussion</title>
<p>We tested SlopeTree, a new, alignment-free method for phylogenetic reconstruction, on a set of strains and also on two domains of life. The method implements three types of gene-filtering: filtering for parasitic elements using copy number within a genome; filtering of genes by their overall conservation; and filtering of gene pairs indicating HGT. The method also includes a bulk correction for genome-specific HGT, it corrects for nonlinearity of the distance measure, and it corrects for compositional bias affecting the background. Some of these corrections work cleanly, for example the mobile element (ME) filter which removes parasitic elements. Others represent only minor corrections to the distance estimate. The biggest influence came from the filtering of gene pairs and filtering for overall conservation, which corrected for various artifacts and helped in the analysis of the global patterns of co-evolution. For sets of core genes and also for complete genomes, SlopeTree produced trees that were close but not identical to those produced by traditional MSA approaches [<xref ref-type="bibr" rid="pcbi.1004985.ref025">25</xref>]. Our results point to the general validity of species evolution by descent, but with various types of exceptions.</p>
<p>Non-sexual, clonal evolution with horizontal transfer creates a problem for defining the rules of species evolution. These rules would inform us on how to interpret genomic data, given the assumption of evolution by descent. The traditional approach to this problem is to define the genes that always evolve together [<xref ref-type="bibr" rid="pcbi.1004985.ref025">25</xref>, <xref ref-type="bibr" rid="pcbi.1004985.ref088">88</xref>, <xref ref-type="bibr" rid="pcbi.1004985.ref089">89</xref>]. Such analyses are generally limited to the number of genes that are trustworthy, and these sets of genes in practice frequently correspond to ribosomal genes and proteins that interact with the ribosome [<xref ref-type="bibr" rid="pcbi.1004985.ref025">25</xref>, <xref ref-type="bibr" rid="pcbi.1004985.ref030">30</xref>]. However, if possible, we would like to have a concept of species evolution in prokaryotes that is not dominated by the evolution of the ribosome.</p>
<p>Alignment-free approaches using complete genomes are an alternative to MSA approaches. We expect alignment-free methods, which look for consensus phylogenetic signals at the level of individual k-mers rather than gene-long alignments, to provide alternative insights into evolutionary history. For instance, alignment-free methods identified a cluster of sulfur-reducing thermophiles which was absent from the traditional MSA tree. To assess alignment-free methods, their trees can be compared to the ribosomal evolution tree, which is what we did here, but it may not always be clear to what extent disagreements are due to the method or to the lack of co-evolution.</p>
<sec id="sec037">
<title>SlopeTree Distance Measure Is Closely Related to Accumulation of Mutations</title>
<p>Different measures of evolution, for instance different alignment-free methods, will produce different trees. Generally, these measures are correlated, generating highly concordant trees. Each alignment-free method defines similarity between organisms in its own units, but it still needs to be established how each of these measures can be transformed into units of accumulation-of-mutations and with what level of accuracy. SlopeTree was designed to provide a measure with a close relationship to the accumulation of mutations. In the absence of selection, this relationship would be given by a simple formula, but at larger evolutionary distances, the slope is defined by slowly evolving protein segments subject to strong negative selection. At the domain level, the relationship becomes nonlinear and requires calibration between the slope and the number of accumulated mutations. At very large distances, such as those between domains, the slope loses its relationship to evolutionary distance entirely. However, this is only significant for rooting archaeal and bacterial phylogenies.</p>
<p>The uniformity of the branch lengths from the “root” to the tips in the SlopeTree trees is not an artifact of the distance measure being nonlinear or saturating at some value. It may be a consequence of looking at a large number of conserved sites and if a particular locus evolved faster for a particular genome pair, its contribution becomes much smaller. Heterotachy, which is variable between positions in an alignment, has very different consequences in terms of branch length estimation for alignment-based methods and current alignment-free methods. Considering that there is much larger variability in branch lengths by alignment-based methods, it appears that more uniform branch lengths are a consequence of two factors: averaging between more proteins and potentially smaller sensitivity to heterotachy which is variable between positions in an alignment.</p>
</sec>
<sec id="sec038">
<title>SlopeTree Filtering Benefits Other Methods</title>
<p>SlopeTree includes a filter for mobile elements and a conservation filter which is applied to all proteomes prior to the main run. A conservation filter follows, which is adjustable. As the level of filtering increased, the distances between the ST-trees and the Eisen-73 or the Eisen-495 trees decreased. All other alignment-free methods that we tested also benefited from filtering the data prior to running, at least in terms of their distances becoming closer to the Eisen trees. An additional benefit to this is that filtering the data beforehand decreases the run-times.</p>
<p>The number of matches contributing to the assessment of evolutionary distances can be limited for longer distances or small genomes. Including mismatches adds a substantial number of informative, i.e. non-random, matches to the analysis. As can be seen with kmacs, the inclusion of mismatches can greatly improve phylogenetic distances. SlopeTree is essentially a type of survival analysis; therefore, it can apply to partial matches just as well as to those that are exact, and it is our expectation that such extension will produce even better results.</p>
</sec>
</sec>
<sec id="sec039" sec-type="materials|methods">
<title>Materials and Methods</title>
<sec id="sec040">
<title>Downloading Proteomes, Selecting Input Sets, and Building Eisen-Trees</title>
<p>The archive all.faa.tar.gz was downloaded from the NCBI ftp website (<ext-link ext-link-type="uri" xlink:href="ftp://ftp.ncbi.nih.gov/genomes/Bacteria/" xlink:type="simple">ftp://ftp.ncbi.nih.gov/genomes/Bacteria/</ext-link>) in May 2015. The archive taxdump.tar.gz was downloaded from the NCBI taxonomy website (<ext-link ext-link-type="uri" xlink:href="ftp://ftp.ncbi.nlm.nih.gov/pub/taxonomy/" xlink:type="simple">ftp://ftp.ncbi.nlm.nih.gov/pub/taxonomy/</ext-link>) also in May 2015. In the NCBI taxonomy, the root nodes for bacteria and archaea are 2 and 2157, respectively, and out of the 2774 organisms in the FASTA archive, 165 were identified as archaea and 2607 as bacteria. The Maximum Likelihood trees, S1 and S4 files from Lang et al. [<xref ref-type="bibr" rid="pcbi.1004985.ref025">25</xref>], built from the concatenations of 24 conserved proteins, were downloaded and organisms compared to those present in the FASTA archive. Allowing for some imperfect matches (e.g. <italic>Haliangium ochraceum SMP 2 DSM 14365</italic> in the ML tree, opposed to <italic>Haliangium ochraceum DSM 14365</italic> in the archive) and some differences in strains (e.g. <italic>Eubacterium siraeum DSM 15702 uid54603</italic> in the ML tree, opposed to <italic>Eubacterium siraeum uid197160</italic> in the archive), 73 archaea and 495 bacteria were found in common between the ML trees and the archive. Two lists were compiled of organisms to remove from the ML trees and these lists and trees were given as input to the program nw_prune, from the package newick-utils (version 1.6) [<xref ref-type="bibr" rid="pcbi.1004985.ref090">90</xref>]:</p>
<p><monospace>./nw_prune Eisen_newick_ML_journal.pone.0062510.s008.txt $(cat pruning_bacteria.txt) &gt; eisen_495_tree_bacteria_newick.txt</monospace></p>
<p><monospace>./nw_prune Eisen_ML_841_journal.pone.0062510.s011.txt $(cat pruning_archaea.txt) &gt; eisen_73__tree_archaea_newick.txt</monospace></p>
<p>These two supermatrix-derived trees are referred to as the Eisen-73 tree and the Eisen-495 tree and were produced for comparison purposes (<xref ref-type="supplementary-material" rid="pcbi.1004985.s002">S2 Fig</xref>).</p>
</sec>
<sec id="sec041">
<title>Neighbor Joining</title>
<p>For all distance matrices produced by SlopeTree and the other methods discussed here, we used rapidNJ version 2.0.1 [<xref ref-type="bibr" rid="pcbi.1004985.ref091">91</xref>] to construct the trees.</p>
<p><monospace>./rapidnj distance_matrix.txt &gt; distance_matrix_tree.txt</monospace></p>
</sec>
<sec id="sec042">
<title>Pruning Trees</title>
<p>A raw tree consisting of the full sets bacteria and archaea is available for each method (SlopeTree and alternative alignment-free methods). The remaining trees were pruned of the organisms that SlopeTree automatically flagged as problematic, 2 for archaea and 50 for bacteria (<xref ref-type="supplementary-material" rid="pcbi.1004985.s021">S1 Text</xref>). The distance matrices were pruned of the flagged organisms before being passed to rapidNJ. Pruned versions of the Eisen-trees were also created (<xref ref-type="supplementary-material" rid="pcbi.1004985.s002">S2 Fig</xref>), using nw_prune as described above with the organisms flagged by SlopeTree added to the file of organisms to prune. This was necessary for the pruned trees to be comparable to the Eisen-trees.</p>
</sec>
<sec id="sec043">
<title>Building SlopeTree Trees</title>
<p>The scripts we refer to in this section are included in the SlopeTree package (<ext-link ext-link-type="uri" xlink:href="http://prodata.swmed.edu/download/pub/slopetree_v1/slopetree.tar.gz" xlink:type="simple">http://prodata.swmed.edu/download/pub/slopetree_v1/slopetree.tar.gz</ext-link>).</p>
<p>The figures for all of the trees in this manuscript were generated using the ITOL web-server [<xref ref-type="bibr" rid="pcbi.1004985.ref092">92</xref>, <xref ref-type="bibr" rid="pcbi.1004985.ref093">93</xref>].</p>
</sec>
<sec id="sec044">
<title>Commands for Constructing the Raw SlopeTree Trees for the Sets of Bacteria, Archaea and <italic>E</italic>.<italic>coli</italic></title>
<p>All bacterial proteomes were moved to the directory FAA within the directory Bacteria. All archaeal proteomes were moved to the directory FAA within the directory Archaea. All proteomes for the strain-level analysis were moved to the directory FAA within the directory Ecoli. The distance matrices for these two sets were then generated with the following two scripts:</p>
<p><monospace>bash dSTm.sh Bacteria/ 20 B../Taxonomy/</monospace></p>
<p><monospace>bash dSTm.sh Archaea/ 20 A../Taxonomy/</monospace></p>
<p><monospace>bash dSTm.sh Ecoli/ 20 B../Taxonomy/</monospace></p>
<p>The distance matrices were then passed to rapidNJ. We refer to these trees as the “raw” trees.</p>
</sec>
<sec id="sec045">
<title>Selecting the Reference Sets for Bacteria and Archaea</title>
<p>We manually selected thirty diverse bacteria from the raw ST-tree as our reference set for the bacterial runs. Similarly, we manually selected ten diverse archaea for the archaeal runs. The specific organisms selected are listed in <xref ref-type="supplementary-material" rid="pcbi.1004985.s022">S2 Text</xref>.</p>
</sec>
<sec id="sec046">
<title>Building ST-Trees with Mobile Elements Removed</title>
<p>The reference sets for bacteria and archaea were moved to Bacteria_ref/FAA and Archaea_ref/FAA, respectively. We then filtered them for conservation, using our conservation filter, for the parameter of <italic>o</italic> = 7:</p>
<p>For bacteria:</p>
<p><monospace>bash pFilt.sh Bacteria_ref/ 20</monospace></p>
<p><monospace>./fpwrite Bacteria_ref/–f 10 –o 7</monospace></p>
<p>For archaea:</p>
<p><monospace>bash pFilt.sh Archaea_ref/ 20</monospace></p>
<p><monospace>./fpwrite Archaea_ref/–f 10 –o 7</monospace></p>
<p specific-use="continuation">These commands generated proteomes that had been reduced to their core proteins. These reduced proteomes were moved to new directories Bacteria_ref_10_7/FAA and Archaea_ref_10_7/FAA and the list of merged and sorted 20-mers generated for each of them:</p>
<p><monospace>bash dMT.sh Bacteria_ref_10_7/ 20 B</monospace></p>
<p><monospace>bash dMT.sh Archaea_ref_10_7/ 20 A</monospace></p>
<p specific-use="continuation">This created a set of sorted 20-mers from conserved proteins from a diverse reference set for bacteria and for archaea. These sets were used as the reference for the mobile element filtering:</p>
<p><monospace>./mef Bacteria/ Bacteria_ref_10_7/MERGED_TAGS/</monospace></p>
<p><monospace>./mef Archaea/ Archaea_ref_10_7/MERGED_TAGS/</monospace></p>
<p><monospace>./mef Ecoli/ Bacteria_ref_10_7/MERGED_TAGS/</monospace></p>
<p specific-use="continuation">This produced, for bacteria, archaea and our set of <italic>E</italic>.<italic>coli</italic>, a set of proteomes in which the mobile elements were eliminated. These reduced proteomes were automatically written out to Bacteria/FAA_mobelim, Archaea/FAA_mobelim and Ecoli/FAA_mobelim. We moved these reduced proteomes to Bacteria_MEF/FAA, Archaea_MEF/FAA and Ecoli_MEF/FAA and moved the organisms that had been chosen for the reference sets to FAA_ref directories within each main directory. We then ran the main SlopeTree script to produce the final distance matrices:</p>
<p><monospace>bash dSTm.sh Bacteria_MEF/ 20 B../Taxonomy/</monospace></p>
<p><monospace>bash dSTm.sh Archaea_MEF/ 20 A../Taxonomy/</monospace></p>
<p><monospace>bash dSTm.sh Ecoli_MEF/ 20 B../Taxonomy/</monospace></p>
<p>Trees were then built using rapidnj.</p>
</sec>
<sec id="sec047">
<title>Building Trees Filtered by Conservation</title>
<p>The FAA and FAA_ref directories from Bacteria_MEF/ and Archaea_MEF/, and the FAA directory for Ecoli_MEF, were copied to Bacteria_MEF_CF, Archaea_MEF_CF, and ECOLI_MEF_CF, respectively. We then ran the filtering code:</p>
<p><monospace>bash pFilt.sh Bacteria_MEF_CF/ 20 B</monospace></p>
<p><monospace>bash pFilt.sh Archaea_MEF_CF/ 20 A</monospace></p>
<p><monospace>bash pFilt.sh Ecoli_MEF_CF/ 20 B</monospace></p>
<p specific-use="continuation">For bacteria and archaea separately, we generated five sets of proteomes filtered on <italic>o</italic> = 0, <italic>o</italic> = 1, <italic>o</italic> = 3, <italic>o</italic> = 5 and <italic>o</italic> = 7. The following two commands use o = 3 as an example:</p>
<p><monospace>./fpwrite Bacteria_MEF_CF/–f 10 –o 3</monospace></p>
<p><monospace>./fpwrite Archaea_MEF_CF/–f 10 –o 3</monospace></p>
<p specific-use="continuation">This command generated filtered proteomes, still divided into main set and reference set, for both bacteria and archaea. These filtered proteomes were moved to their own directories, Bacteria_MEF_CF_10_3 and Archaea_MEF_CF_10_3 for the case of <italic>o</italic> = 3 and so on for other values of <italic>o</italic>. Finally, each of these new directories, which contained an FAA and FAA_ref that had been reduced for both mobile elements and also less conserved proteins, was passed to the main SlopeTree script:</p>
<p><monospace>bash dSTm.sh Bacteria_MEF_CF_10_3/ 20 B../Taxonomy/</monospace></p>
<p><monospace>bash dSTm.sh Archaea_MEF_CF_10_3/ 20 A../Taxonomy/</monospace></p>
<p>Similar steps were followed to generate the filtered proteomes for our set of <italic>E.coli</italic>, using the same set of 30 bacteria in FAA_ref for the more aggressive filtering. In addition, <italic>E.coli</italic> was filtered against itself, i.e. no reference set. All that was required for this self-filtering was to not provide an FAA_ref directory when pFilt.sh was run.</p>
<p>Trees were then built with rapidNJ.</p>
</sec>
<sec id="sec048">
<title>Trees Filtered of Mobile Elements, Conservation, and Horizontal Gene Transfer</title>
<p>The correction for HGT was applied only to proteomes already filtered of mobile elements and filtered on <italic>o</italic> = 3, <italic>o</italic> = 5, and <italic>o</italic> = 7. For <italic>o</italic> = 3, the command was:</p>
<p><monospace>./fh Bacteria_MEF_CF_10_3/</monospace></p>
<p>For each data set, this command produced new distance matrix which was then passed to rapidNJ.</p>
</sec>
<sec id="sec049">
<title>Building Alternative Trees</title>
<p>Trees were built using several other, alignment-free methods: ACS, CVTree, D2, kmacs, Spaced Words, and ALFRED-G. Each method was run on the 495 bacteria and 73 archaea for: a) raw proteomes, b) proteomes filtered of mobile elements, and c) proteomes filtered of mobile elements and also filtered for conservation on <italic>o</italic> = 0, 1, 3, 5, and 7. The final pair-wise HGT-correction which was applied to the SlopeTree runs for <italic>o</italic> = 3, 5, and 7 was not applied to these alternative methods because unlike the mobile element filter and conservation filter, the pair-wise HGT correction currently cannot be run independently of SlopeTree. For the matrices produced by these alternative methods, we built trees using rapidNJ.</p>
</sec>
<sec id="sec050">
<title>Average Common Substring</title>
<p>Version 1.2 of the ACS code was used to build the ACS trees with the following command:</p>
<p><monospace>./ACS -a &lt;path to ACS directory&gt;/ACS_input_file—o distance_matrix.txt—A -A ACS_matrix.txt</monospace></p>
<p>Trees were built using rapidnj on the file written out by the -o option.</p>
</sec>
<sec id="sec051">
<title>Composition Vector Tree (CVTree)</title>
<p>Version 4.2 of CVTree was used. The commands to build the matrices were the following:</p>
<p><monospace>./cvtree—i -i cvtree_input_file.txt -d FAA/ -k 6 -t aa -c out/</monospace></p>
<p><monospace>./batch_dist.pl 1.5 cvtree_input_file.txt out/ out_matrix_k6.txt</monospace></p>
</sec>
<sec id="sec052">
<title>D2 Method</title>
<p>Version 1.0 of D2 was used. The command to build the matrices was the following:</p>
<p><monospace>java -Xmx126g -jar jD2Stat_1.0.jar -a aa -i input.faa -o matrix</monospace></p>
</sec>
<sec id="sec053">
<title>kmacs</title>
<p>We ran kmacs with k = 14:</p>
<p><monospace>./kmacs input.faa 14</monospace></p>
</sec>
<sec id="sec054">
<title>Spaced Words</title>
<p>We ran Spaced Words with k = 12 and Euclidean distances. Evolutionary distances were not available for amino acid sequences:</p>
<p><monospace>./spaced—k -k 12 –d EU input_file.faa</monospace></p>
</sec>
<sec id="sec055">
<title>ALFRED-G</title>
<p>We ran ALFRED-G with k = 6 and x = 1.</p>
<p><monospace>build/alfred.x -f input.fas -o output.txt -k 6 -x 1</monospace></p>
</sec>
<sec id="sec056">
<title>Comparing Trees</title>
<p>All trees were compared to the Eisen-trees using the treedist tool from PHYLIP [<xref ref-type="bibr" rid="pcbi.1004985.ref087">87</xref>] for the symmetric difference distance. Using a keys file generated for the purpose of finding matches between the original FASTA archive and the Eisen-trees, we renamed the nodes of the Eisen-trees and alignment-free trees so that they were identical and renamed the two tree files intree and intree2 for treedist.</p>
</sec>
</sec>
<sec id="sec057">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1004985.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004985.s001" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Phylogeny reconstruction flowchart for SlopeTree.</title>
<p>SlopeTree has 3 main parts: The mobile-element filtering (Algorithm 1) and the conservation/stability filtering (Algorithm 2); the SlopeTree main method (Algorithm 3) which produces a distance matrix and tree; and the pair-wise HGT correction (Algorithm 4) which reprocesses pairs that were flagged as showing signs of HGT. When not using mobile-element filtering or conservation filtering, Start #2 is the original starting point. Three pairs are shown for the pair-wise HGT correction code; this number can be in the 100s or 1000s depending on the input set. All proteomes are in FASTA format.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004985.s002" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004985.s002" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Eisen-trees used as a reference.</title>
<p>A) Eisen-73 tree. B) Eisen-71 tree (pruned Eisen-73). C) Eisen-495 tree. D) Eisen-445 tree (pruned Eisen-495).</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004985.s003" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004985.s003" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Paralogy score histograms over different values of conservation/stability filtering parameter <italic>o</italic>.</title>
<p>A) Histogram for all proteins with ‘ribosomal’ in their annotation, i.e. an example of paralogy scores for a highly conserved protein. B) Histogram for all proteins with ‘chemotaxis’ in their annotation, i.e. an example of paralogy scores for a non-conserved, frequently transferred protein.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004985.s004" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004985.s004" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>SlopeTree (ST) applied at the strain level.</title>
<p>Full set used consisted of 72 <italic>Escherichia coli</italic>, 10 <italic>Shigella</italic> (4 <italic>S</italic>. <italic>flexneri</italic>, 2 <italic>S</italic>. <italic>boydii</italic>, and 2 <italic>S</italic>. <italic>sonnei</italic>), <italic>Escherichia fergusonii</italic>, and <italic>Escherichia blattae</italic>. All trees used 20-mers unless otherwise specified. Due to the closeness of some organisms, some distances in the final Newick trees were negative; these were changed to 0 to avoid ‘backwards’ branches. This had no effect on the topology. A) ST on 72 <italic>E</italic>. <italic>coli</italic>, 10 <italic>Shigella</italic>, <italic>E</italic>. <italic>fergusonii</italic> and E. <italic>blattae</italic>. B) ST on 72 <italic>E</italic>. <italic>coli</italic> and 10 <italic>Shigella</italic>. C) ST using 40-mers on 72 <italic>E</italic>.<italic>coli</italic> and <italic>10 Shigella</italic>. D) ST on 72 <italic>E</italic>. <italic>coli</italic> and 10 <italic>Shigella</italic>, filtered for mobile elements. E) ST on 72 <italic>E</italic>. <italic>coli</italic> and 10 <italic>Shigella</italic>, filtered for mobile elements and self-filtered on <italic>o</italic> = 0. F) ST on 72 <italic>E</italic>. <italic>coli</italic> and 10 <italic>Shigella</italic>, filtered for mobile elements and self-filtered on <italic>o</italic> = 5. G) ST on 72 <italic>E</italic>. <italic>coli</italic> and 10 <italic>Shigella</italic>, filtered for mobile elements and self-filtered on <italic>o</italic> = 10. H) ST on 72 <italic>E</italic>. <italic>coli</italic> and 10 <italic>Shigella</italic>, filtered for mobile elements and filtered against a reference set of 30 diverse bacteria on <italic>o</italic> = 3. I) ST on 72 <italic>E</italic>. <italic>coli</italic> and 10 <italic>Shigella</italic>, built from mobile elements and proteins discarded when self-filtering on <italic>o</italic> = 0.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004985.s005" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004985.s005" xlink:type="simple">
<label>S5 Fig</label>
<caption>
<title>SlopeTree (ST) trees for archaea.</title>
<p>A) Raw ST-tree for 73 archaea. Unfiltered and unpruned. B) Raw ST-tree for 71 archaea. Unfiltered and pruned. C) ST- tree for 71 archaea. Filtered of mobile elements and pruned. D) ST-tree for 71 archaea. Filtered of mobile elements, pruned, and filtered by stability and conservation on <italic>o</italic> = 0. E) ST-tree for 71 archaea. Filtered of mobile elements, pruned, and filtered by stability and conservation on <italic>o</italic> = 1. F) ST-tree for 71 archaea. Filtered of mobile elements, pruned, and filtered by stability and conservation on <italic>o</italic> = 3. G) ST-tree for 71 archaea. Filtered of mobile elements, pruned, filtered by stability and conservation on <italic>o</italic> = 3, and final pair-wise HGT correction applied. H) ST-tree for 71 archaea. Filtered of mobile elements, pruned, and filtered by stability and conservation on <italic>o</italic> = 5. I) ST-tree for 71 archaea. Filtered of mobile elements, pruned, filtered by stability and conservation on <italic>o</italic> = 5, and final pair-wise HGT correction applied. J) ST-tree for 71 archaea. Filtered of mobile elements, pruned, and filtered by stability and conservation on <italic>o</italic> = 7. K) ST-tree for 71 archaea. Filtered of mobile elements, pruned, filtered by stability and conservation on <italic>o</italic> = 7, and final pair-wise HGT correction applied.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004985.s006" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004985.s006" xlink:type="simple">
<label>S6 Fig</label>
<caption>
<title>Average Common Substring (ACS) trees for archaea.</title>
<p>A) Raw ACS-tree for 73 archaea. Unfiltered and unpruned. B) Raw ACS-tree for 71 archaea. Unfiltered and pruned. C) ACS- tree for 71 archaea. Filtered of mobile elements and pruned. D) ACS-tree for 71 archaea. Filtered of mobile elements, pruned, and filtered by stability and conservation on <italic>o</italic> = 0. E) ACS-tree for 71 archaea. Filtered of mobile elements, pruned, and filtered by stability and conservation on <italic>o</italic> = 1. F) ACS-tree for 71 archaea. Filtered of mobile elements, pruned, and filtered by stability and conservation on <italic>o</italic> = 3. G) ACS-tree for 71 archaea. Filtered of mobile elements, pruned, and filtered by stability and conservation on <italic>o</italic> = 5. H) ACS-tree for 71 archaea. Filtered of mobile elements, pruned, and filtered by stability and conservation on <italic>o</italic> = 7.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004985.s007" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004985.s007" xlink:type="simple">
<label>S7 Fig</label>
<caption>
<title>CVTree trees for archaea.</title>
<p>A) Raw CVTree on raw 73 archaea. Unfiltered and unpruned. B) Raw CVTree on 71 archaea. Unfiltered and pruned. C) CVTree on 71 archaea. Filtered of mobile elements and pruned. D) CVTree on 71 archaea. Filtered of mobile elements, pruned, and filtered by stability and conservation on <italic>o</italic> = 0. E) CVTree on 71 archaea. Filtered of mobile elements, pruned, and filtered by stability and conservation on <italic>o</italic> = 1. F) CVTree on 71 archaea. Filtered of mobile elements, pruned, and filtered by stability and conservation on <italic>o</italic> = 3. G) CVTree on 71 archaea. Filtered of mobile elements, pruned, and filtered by stability and conservation on <italic>o</italic> = 5. H) CVTree on 71 archaea. Filtered of mobile elements, pruned, and filtered by stability and conservation on <italic>o</italic> = 7.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004985.s008" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004985.s008" xlink:type="simple">
<label>S8 Fig</label>
<caption>
<title>D2 trees for archaea.</title>
<p>A) D2 on raw 73 archaea. Unfiltered and unpruned. B) D2 on raw 71 archaea. Unfiltered and pruned. C) D2 on 71 archaea. Filtered of mobile elements and pruned. D) D2 on 71 archaea. Filtered of mobile elements, pruned, and filtered by stability and conservation on <italic>o</italic> = 0. E) D2 on 71 archaea. Filtered of mobile elements, pruned, and filtered by stability and conservation on <italic>o</italic> = 1. F) D2 on 71 archaea. Filtered of mobile elements, pruned, and filtered by stability and conservation on <italic>o</italic> = 3. G) D2 on 71 archaea. Filtered of mobile elements, pruned, and filtered by stability and conservation on <italic>o</italic> = 5. H) D2 on 71 archaea. Filtered of mobile elements, pruned, and filtered by stability and conservation on <italic>o</italic> = 7.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004985.s009" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004985.s009" xlink:type="simple">
<label>S9 Fig</label>
<caption>
<title>kmacs trees for archaea.</title>
<p>A) kmacs on raw 73 archaea. Unfiltered and unpruned. B) kmacs on raw 71 archaea. Unfiltered and pruned. C) kmacs on 71 archaea. Filtered of mobile elements and pruned. D) kmacs on 71 archaea. Filtered of mobile elements, pruned, and filtered by stability and conservation on <italic>o</italic> = 0. E) kmacs on 71 archaea. Filtered of mobile elements, pruned, and filtered by stability and conservation on <italic>o</italic> = 1. F) kmacs on 71 archaea. Filtered of mobile elements, pruned, and filtered by stability and conservation on <italic>o</italic> = 3. G) kmacs on 71 archaea. Filtered of mobile elements, pruned, and filtered by stability and conservation on <italic>o</italic> = 5. H) kmacs on 71 archaea. Filtered of mobile elements, pruned, and filtered by stability and conservation on <italic>o</italic> = 7.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004985.s010" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004985.s010" xlink:type="simple">
<label>S10 Fig</label>
<caption>
<title>Spaced Words (SW) trees for archaea.</title>
<p>A) SW tree for raw 73 archaea. Unfiltered and unpruned. B) SW tree for raw 71 archaea. Unfiltered and pruned. C) SW tree for 71 archaea. Filtered of mobile elements and pruned. D) SW tree for 71 archaea. Filtered of mobile elements, pruned, and filtered by stability and conservation on <italic>o</italic> = 0. E) SW tree for on 71 archaea. Filtered of mobile elements, pruned, and filtered by stability and conservation on <italic>o</italic> = 1. F) SW tree for 71 archaea. Filtered of mobile elements, pruned, and filtered by stability and conservation on <italic>o</italic> = 3. G) SW tree for 71 archaea. Filtered of mobile elements, pruned, and filtered by stability and conservation on <italic>o</italic> = 5. H) SW tree for 71 archaea. Filtered of mobile elements, pruned, and filtered by stability and conservation on <italic>o</italic> = 7.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004985.s011" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004985.s011" xlink:type="simple">
<label>S11 Fig</label>
<caption>
<title>ALFRED-G (ALF) trees for archaea.</title>
<p>A) ALF tree for raw 73 archaea. Unfiltered and unpruned. B) ALF tree for raw 71 archaea. Unfiltered and pruned. C) ALF tree for 71 archaea. Filtered of mobile elements and pruned. D) ALF tree for 71 archaea. Filtered of mobile elements, pruned, and filtered by stability and conservation on <italic>o</italic> = 0. E) ALF tree for 71 archaea. Filtered of mobile elements, pruned, and filtered by stability and conservation on <italic>o</italic> = 7.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004985.s012" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004985.s012" xlink:type="simple">
<label>S12 Fig</label>
<caption>
<title>SlopeTree (ST) trees for bacteria.</title>
<p>A) Raw ST-tree for 495 bacteria. Unfiltered and unpruned. B) Raw ST-tree for 445 bacteria. Unfiltered and pruned. C) ST- tree for 445 bacteria. Filtered of mobile elements and pruned. D) ST-tree for 445 bacteria. Filtered of mobile elements, pruned, and filtered by stability and conservation on <italic>o</italic> = 0. E) ST-tree for 445 bacteria. Filtered of mobile elements, pruned, and filtered by stability and conservation on <italic>o</italic> = 1. F) ST-tree for 445 bacteria. Filtered of mobile elements, pruned, and filtered by stability and conservation on <italic>o</italic> = 3. G) ST-tree for 445 bacteria. Filtered of mobile elements, pruned, filtered by stability and conservation on <italic>o</italic> = 3, and final pair-wise HGT correction applied. H) ST-tree for 445 bacteria. Filtered of mobile elements, pruned, and filtered by stability and conservation on <italic>o</italic> = 5. I) ST-tree for 445 bacteria. Filtered of mobile elements, pruned, filtered by stability and conservation on <italic>o</italic> = 5, and final pair-wise HGT correction applied. J) ST-tree for 445 bacteria. Filtered of mobile elements, pruned, and filtered by stability and conservation on <italic>o</italic> = 7. K) ST-tree for 445 bacteria. Filtered of mobile elements, pruned, filtered by stability and conservation on <italic>o</italic> = 7, and final pair-wise HGT correction applied.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004985.s013" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004985.s013" xlink:type="simple">
<label>S13 Fig</label>
<caption>
<title>Average Common Substring (ACS) trees for bacteria.</title>
<p>Trees rooted using ‘Root mid-point’ option in ITOL server. A) Raw ACS-tree for 495 bacteria. Unfiltered and unpruned. B) Raw ACS-tree for 445 bacteria. Unfiltered and pruned. C) ACS- tree for 445 bacteria. Filtered of mobile elements and pruned. D) ACS-tree for 445 bacteria. Filtered of mobile elements, pruned, and filtered by stability and conservation on <italic>o</italic> = 0. E) ACS-tree for 445 bacteria. Filtered of mobile elements, pruned, and filtered by stability and conservation on <italic>o</italic> = 1. F) ACS-tree for 445 bacteria. Filtered of mobile elements, pruned, and filtered by stability and conservation on <italic>o</italic> = 3. G) ACS-tree for 445 bacteria. Filtered of mobile elements, pruned, and filtered by stability and conservation on <italic>o</italic> = 5. H) ACS-tree for 445 bacteria. Filtered of mobile elements, pruned, and filtered by stability and conservation on <italic>o</italic> = 7.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004985.s014" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004985.s014" xlink:type="simple">
<label>S14 Fig</label>
<caption>
<title>CVTree applied to bacteria.</title>
<p>Trees rooted using ‘Root mid-point’ option in ITOL server. A) CVTree on raw 495 bacteria. Unfiltered and unpruned. B) CVTree on raw 445 bacteria. Unfiltered and pruned. C) CVTree on 445 bacteria. Filtered of mobile elements and pruned. D) CVTree on 445 bacteria. Filtered of mobile elements, pruned, and filtered by stability and conservation on <italic>o</italic> = 0. E) CVTree on 445 bacteria. Filtered of mobile elements, pruned, and filtered by stability and conservation on <italic>o</italic> = 1. F) CVTree on 445 bacteria. Filtered of mobile elements, pruned, and filtered by stability and conservation on <italic>o</italic> = 3. G) CVTree on 445 bacteria. Filtered of mobile elements, pruned, and filtered by stability and conservation on <italic>o</italic> = 5. H) CVTree on 445 bacteria. Filtered of mobile elements, pruned, and filtered by stability and conservation on <italic>o</italic> = 7.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004985.s015" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004985.s015" xlink:type="simple">
<label>S15 Fig</label>
<caption>
<title>D2 applied to bacteria.</title>
<p>Trees rooted using ‘Root mid-point’ option in ITOL server. A) D2 on raw 495 bacteria. Unfiltered and unpruned. B) D2 on raw 445 bacteria. Unfiltered and pruned. C) D2 on 445 bacteria. Filtered of mobile elements and pruned. D) D2 on 445 bacteria. Filtered of mobile elements, pruned, and filtered by stability and conservation on <italic>o</italic> = 0. E) D2 on 445 bacteria. Filtered of mobile elements, pruned, and filtered by stability and conservation on <italic>o</italic> = 1. F) D2 on 445 bacteria. Filtered of mobile elements, pruned, and filtered by stability and conservation on <italic>o</italic> = 3. G) D2 on 445 bacteria. Filtered of mobile elements, pruned, and filtered by stability and conservation on <italic>o</italic> = 5. H) D2 on 445 bacteria. Filtered of mobile elements, pruned, and filtered by stability and conservation on <italic>o</italic> = 7.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004985.s016" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004985.s016" xlink:type="simple">
<label>S16 Fig</label>
<caption>
<title>kmacs applied to bacteria.</title>
<p>Trees rooted using ‘Root mid-point’ option in ITOL server. A) kmacs on raw 495 bacteria. Unfiltered and unpruned. B) kmacs on raw 445 bacteria. Unfiltered and pruned. C) kmacs on 445 bacteria. Filtered of mobile elements and pruned. D) kmacs on 445 bacteria. Filtered of mobile elements, pruned, and filtered by stability and conservation on <italic>o</italic> = 0. E) kmacs on 445 bacteria. Filtered of mobile elements, pruned, and filtered by stability and conservation on <italic>o</italic> = 1. F) kmacs on 445 bacteria. Filtered of mobile elements, pruned, and filtered by stability and conservation on <italic>o</italic> = 3. G) kmacs on 445 bacteria. Filtered of mobile elements, pruned, and filtered by stability and conservation on <italic>o</italic> = 5. H) kmacs on 445 bacteria. Filtered of mobile elements, pruned, and filtered by stability and conservation on <italic>o</italic> = 7.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004985.s017" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004985.s017" xlink:type="simple">
<label>S17 Fig</label>
<caption>
<title>Spaced Words (SW) applied to bacteria.</title>
<p>Trees rooted using ‘Root mid-point’ option in ITOL server. A) SW on raw 495 bacteria. Unfiltered and unpruned. B) SW on raw 445 bacteria. Unfiltered and pruned. C) SW on 445 bacteria. Filtered of mobile elements and pruned. D) SW on 445 bacteria. Filtered of mobile elements, pruned, and filtered by stability and conservation on <italic>o</italic> = 0. E) SW on 445 bacteria. Filtered of mobile elements, pruned, and filtered by stability and conservation on <italic>o</italic> = 1. F) SW on 445 bacteria. Filtered of mobile elements, pruned, and filtered by stability and conservation on <italic>o</italic> = 3. G) SW on 445 bacteria. Filtered of mobile elements, pruned, and filtered by stability and conservation on <italic>o</italic> = 5. H) SW on 445 bacteria. Filtered of mobile elements, pruned, and filtered by stability and conservation on <italic>o</italic> = 7.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004985.s018" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004985.s018" xlink:type="simple">
<label>S18 Fig</label>
<caption>
<title>ALFRED-G (ALF) applied to bacteria.</title>
<p>Trees rooted using ‘Root mid-point’ option in ITOL server. Only a partial set of trees was calculated due to the long run-time of the program. A) ALF on 445 bacteria. Filtered of mobile elements, pruned, and filtered by stability and conservation on <italic>o</italic> = 5. B) ALF on 445 bacteria. Filtered of mobile elements, pruned, and filtered by stability and conservation on <italic>o</italic> = 7.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004985.s019" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004985.s019" xlink:type="simple">
<label>S19 Fig</label>
<caption>
<title>Examples of 2 main classes of large-scale HGT and their corrections.</title>
<p>A) A pair sharing a single copy phage. B) A pair sharing large-scale transfer of proteins associated with adaptation to environment. C) For pair sharing phage, effect on plots that mobile-element filtering combined with conservation filtering have, compared to the pair-wise HGT correction. D) For a pair sharing adaptive proteins, effect on plots that mobile element filtering and conservation filtering have compared to the pair-wise HGT correction.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004985.s020" mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004985.s020" xlink:type="simple">
<label>S1 Table</label>
<caption>
<title>Distance to Eisen trees for SlopeTree and for six other whole-genome methods, over different levels of mobile-element and conservation filtering.</title>
<p>(XLSX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004985.s021" mimetype="application/msword" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004985.s021" xlink:type="simple">
<label>S1 Text</label>
<caption>
<title>Bacteria pruned from the trees due to having reduced genomes, candidate status, missing conserved genes, copy number of conserved genes significantly different from average, an excessive number of FASTA files, or a discrepancy identified by the mobile element filter (i.e. unusual copy number pattern for majority of proteins).</title>
<p>A) Pruned for archaea. B) Pruned for bacteria.</p>
<p>(DOC)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004985.s022" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004985.s022" xlink:type="simple">
<label>S2 Text</label>
<caption>
<title>The manually selected reference organisms for the SlopeTree runs that required a reference (NCBI classification information included).</title>
<p>A) Archaea. B) Bacteria.</p>
<p>(DOCX)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We thank Dr. Dominika Borek for her insight during the entire course of the work. We thank Dr. Keith Henderson for the many discussions and for his reading of the manuscript. We thank Dr. Bhadrachalam Chitturi for his assistance in the formal description of the algorithms. We thank Dr. David Trudgian and BioHPC at UTSW for their assistance in making the source code available and their refinements of the SlopeTree code.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1004985.ref001"><label>1</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sanger</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Air</surname> <given-names>GM</given-names></name>, <name name-style="western"><surname>Barrell</surname> <given-names>BG</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>NL</given-names></name>, <name name-style="western"><surname>Coulson</surname> <given-names>AR</given-names></name>, <name name-style="western"><surname>Fiddes</surname> <given-names>CA</given-names></name>, <etal>et al</etal>. <article-title>Nucleotide sequence of bacteriophage phi X174 DNA</article-title>. <source>Nature</source>. <year>1977</year> <month>Feb</month> <day>24</day>;<volume>265</volume>(<issue>5596</issue>):<fpage>687</fpage>–<lpage>95</lpage>. <object-id pub-id-type="pmid">870828</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref002"><label>2</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Metzker</surname> <given-names>ML</given-names></name>. <article-title>Sequencing technologies—the next generation</article-title>. <source>Nat Rev Genet</source>. <year>2010</year> <month>Jan</month>;<volume>11</volume>(<issue>1</issue>):<fpage>31</fpage>–<lpage>46</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nrg2626" xlink:type="simple">10.1038/nrg2626</ext-link></comment> <object-id pub-id-type="pmid">19997069</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref003"><label>3</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Chan</surname> <given-names>EY</given-names></name>. <article-title>Advances in sequencing technology</article-title>. <source>Mutat Res-Fund Mol M</source>. <year>2005</year> <month>Jun</month> <day>3</day>;<volume>573</volume>(<issue>1–2</issue>):<fpage>13</fpage>–<lpage>40</lpage>. English.</mixed-citation></ref>
<ref id="pcbi.1004985.ref004"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>van Dijk</surname> <given-names>EL</given-names></name>, <name name-style="western"><surname>Auger</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Jaszczyszyn</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Thermes</surname> <given-names>C</given-names></name>. <article-title>Ten years of next-generation sequencing technology</article-title>. <source>Trends Genet</source>. <year>2014</year> <month>Sep</month>;<volume>30</volume>(<issue>9</issue>):<fpage>418</fpage>–<lpage>26</lpage>. English. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.tig.2014.07.001" xlink:type="simple">10.1016/j.tig.2014.07.001</ext-link></comment> <object-id pub-id-type="pmid">25108476</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref005"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Blair</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Murphy</surname> <given-names>RW</given-names></name>. <article-title>Recent trends in molecular phylogenetic analysis: where to next?</article-title> <source>The Journal of heredity</source>. <year>2011</year> <month>Jan-Feb</month>;<volume>102</volume>(<issue>1</issue>):<fpage>130</fpage>–<lpage>8</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/jhered/esq092" xlink:type="simple">10.1093/jhered/esq092</ext-link></comment> <object-id pub-id-type="pmid">20696667</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref006"><label>6</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kemena</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Notredame</surname> <given-names>C</given-names></name>. <article-title>Upcoming challenges for multiple sequence alignment methods in the high-throughput era</article-title>. <source>Bioinformatics</source>. <year>2009</year> <month>Oct</month> <day>1</day>;<volume>25</volume>(<issue>19</issue>):<fpage>2455</fpage>–<lpage>65</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btp452" xlink:type="simple">10.1093/bioinformatics/btp452</ext-link></comment> <object-id pub-id-type="pmid">19648142</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref007"><label>7</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Liu</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Linder</surname> <given-names>CR</given-names></name>, <name name-style="western"><surname>Warnow</surname> <given-names>T</given-names></name>. <article-title>Multiple sequence alignment: a major challenge to large-scale phylogenetics</article-title>. <source>PLoS currents</source>. <year>2010</year>;<volume>2</volume>:<fpage>RRN1198</fpage>. <object-id pub-id-type="pmid">21113338</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref008"><label>8</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Stamatakis</surname> <given-names>A</given-names></name>. <article-title>RAxML version 8: a tool for phylogenetic analysis and post-analysis of large phylogenies</article-title>. <source>Bioinformatics</source>. <year>2014</year> <month>May</month> <day>1</day>;<volume>30</volume>(<issue>9</issue>):<fpage>1312</fpage>–<lpage>3</lpage>. English. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btu033" xlink:type="simple">10.1093/bioinformatics/btu033</ext-link></comment> <object-id pub-id-type="pmid">24451623</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref009"><label>9</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Edgar</surname> <given-names>RC</given-names></name>, <name name-style="western"><surname>Batzoglou</surname> <given-names>S</given-names></name>. <article-title>Multiple sequence alignment</article-title>. <source>Current opinion in structural biology</source>. <year>2006</year> <month>Jun</month>;<volume>16</volume>(<issue>3</issue>):<fpage>368</fpage>–<lpage>73</lpage>. <object-id pub-id-type="pmid">16679011</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref010"><label>10</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Land</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Hauser</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Jun</surname> <given-names>SR</given-names></name>, <name name-style="western"><surname>Nookaew</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Leuze</surname> <given-names>MR</given-names></name>, <name name-style="western"><surname>Ahn</surname> <given-names>TH</given-names></name>, <etal>et al</etal>. <article-title>Insights from 20 years of bacterial genome sequencing</article-title>. <source>Functional &amp; integrative genomics</source>. <year>2015</year> <month>Mar</month>;<volume>15</volume>(<issue>2</issue>):<fpage>141</fpage>–<lpage>61</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004985.ref011"><label>11</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Woese</surname> <given-names>CR</given-names></name>, <name name-style="western"><surname>Fox</surname> <given-names>GE</given-names></name>. <article-title>Phylogenetic structure of the prokaryotic domain: the primary kingdoms</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source>. <year>1977</year> <month>Nov</month>;<volume>74</volume>(<issue>11</issue>):<fpage>5088</fpage>–<lpage>90</lpage>. <object-id pub-id-type="pmid">270744</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref012"><label>12</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pace</surname> <given-names>NR</given-names></name>, <name name-style="western"><surname>Olsen</surname> <given-names>GJ</given-names></name>, <name name-style="western"><surname>Woese</surname> <given-names>CR</given-names></name>. <article-title>Ribosomal RNA phylogeny and the primary lines of evolutionary descent</article-title>. <source>Cell</source>. <year>1986</year> <month>May</month> <day>9</day>;<volume>45</volume>(<issue>3</issue>):<fpage>325</fpage>–<lpage>6</lpage>. <object-id pub-id-type="pmid">3084106</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref013"><label>13</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Olsen</surname> <given-names>GJ</given-names></name>, <name name-style="western"><surname>Woese</surname> <given-names>CR</given-names></name>. <article-title>Ribosomal RNA: a key to phylogeny</article-title>. <source>Faseb J</source>. <year>1993</year> <month>Jan</month>;<volume>7</volume>(<issue>1</issue>):<fpage>113</fpage>–<lpage>23</lpage>. <object-id pub-id-type="pmid">8422957</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref014"><label>14</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Olsen</surname> <given-names>GJ</given-names></name>, <name name-style="western"><surname>Overbeek</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Larsen</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Marsh</surname> <given-names>TL</given-names></name>, <name name-style="western"><surname>McCaughey</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Maciukenas</surname> <given-names>MA</given-names></name>, <etal>et al</etal>. <article-title>The Ribosomal Database Project</article-title>. <source>Nucleic Acids Res</source>. <year>1992</year> <month>May</month> <day>11</day>;<volume>20</volume> <issue>Suppl</issue>:<fpage>2199</fpage>–<lpage>200</lpage>. <object-id pub-id-type="pmid">1598241</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref015"><label>15</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kamla</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Henrich</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Hadding</surname> <given-names>U</given-names></name>. <article-title>Phylogeny based on elongation factor Tu reflects the phenotypic features of mycoplasmas better than that based on 16S rRNA</article-title>. <source>Gene</source>. <year>1996</year> <month>May</month> <day>24</day>;<volume>171</volume>(<issue>1</issue>):<fpage>83</fpage>–<lpage>7</lpage>. <object-id pub-id-type="pmid">8675036</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref016"><label>16</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Iwabe</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Kuma</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Hasegawa</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Osawa</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Miyata</surname> <given-names>T</given-names></name>. <article-title>Evolutionary relationship of archaebacteria, eubacteria, and eukaryotes inferred from phylogenetic trees of duplicated genes</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source>. <year>1989</year> <month>Dec</month>;<volume>86</volume>(<issue>23</issue>):<fpage>9355</fpage>–<lpage>9</lpage>. <object-id pub-id-type="pmid">2531898</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref017"><label>17</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hashimoto</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Hasegawa</surname> <given-names>M</given-names></name>. <article-title>Origin and early evolution of eukaryotes inferred from the amino acid sequences of translation elongation factors 1alpha/Tu and 2/G</article-title>. <source>Advances in biophysics</source>. <year>1996</year>;<volume>32</volume>:<fpage>73</fpage>–<lpage>120</lpage>. <object-id pub-id-type="pmid">8781286</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref018"><label>18</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kwok</surname> <given-names>AY</given-names></name>, <name name-style="western"><surname>Su</surname> <given-names>SC</given-names></name>, <name name-style="western"><surname>Reynolds</surname> <given-names>RP</given-names></name>, <name name-style="western"><surname>Bay</surname> <given-names>SJ</given-names></name>, <name name-style="western"><surname>Av-Gay</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Dovichi</surname> <given-names>NJ</given-names></name>, <etal>et al</etal>. <article-title>Species identification and phylogenetic relationships based on partial HSP60 gene sequences within the genus Staphylococcus</article-title>. <source>Int J Syst Bacteriol</source>. <year>1999</year> <month>Jul</month>;<volume>49</volume> <issue>Pt 3</issue>:<fpage>1181</fpage>–<lpage>92</lpage>. <object-id pub-id-type="pmid">10425778</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref019"><label>19</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bui</surname> <given-names>ET</given-names></name>, <name name-style="western"><surname>Bradley</surname> <given-names>PJ</given-names></name>, <name name-style="western"><surname>Johnson</surname> <given-names>PJ</given-names></name>. <article-title>A common evolutionary origin for mitochondria and hydrogenosomes</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source>. <year>1996</year> <month>Sep</month> <day>3</day>;<volume>93</volume>(<issue>18</issue>):<fpage>9651</fpage>–<lpage>6</lpage>. <object-id pub-id-type="pmid">8790385</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref020"><label>20</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hirt</surname> <given-names>RP</given-names></name>, <name name-style="western"><surname>Logsdon</surname> <given-names>JM</given-names> <suffix>Jr.</suffix></name>, <name name-style="western"><surname>Healy</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Dorey</surname> <given-names>MW</given-names></name>, <name name-style="western"><surname>Doolittle</surname> <given-names>WF</given-names></name>, <name name-style="western"><surname>Embley</surname> <given-names>TM</given-names></name>. <article-title>Microsporidia are related to Fungi: evidence from the largest subunit of RNA polymerase II and other proteins</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source>. <year>1999</year> <month>Jan</month> <day>19</day>;<volume>96</volume>(<issue>2</issue>):<fpage>580</fpage>–<lpage>5</lpage>. <object-id pub-id-type="pmid">9892676</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref021"><label>21</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kim</surname> <given-names>BJ</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>SH</given-names></name>, <name name-style="western"><surname>Lyu</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>SJ</given-names></name>, <name name-style="western"><surname>Bai</surname> <given-names>GH</given-names></name>, <name name-style="western"><surname>Chae</surname> <given-names>GT</given-names></name>, <etal>et al</etal>. <article-title>Identification of mycobacterial species by comparative sequence analysis of the RNA polymerase gene (rpoB)</article-title>. <source>J Clin Microbiol</source>. <year>1999</year> <month>Jun</month>;<volume>37</volume>(<issue>6</issue>):<fpage>1714</fpage>–<lpage>20</lpage>. <object-id pub-id-type="pmid">10325313</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref022"><label>22</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lloyd</surname> <given-names>AT</given-names></name>, <name name-style="western"><surname>Sharp</surname> <given-names>PM</given-names></name>. <article-title>Evolution of the recA gene and the molecular phylogeny of bacteria</article-title>. <source>Journal of molecular evolution</source>. <year>1993</year> <month>Oct</month>;<volume>37</volume>(<issue>4</issue>):<fpage>399</fpage>–<lpage>407</lpage>. <object-id pub-id-type="pmid">8308907</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref023"><label>23</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Woese</surname> <given-names>CR</given-names></name>, <name name-style="western"><surname>Olsen</surname> <given-names>GJ</given-names></name>, <name name-style="western"><surname>Ibba</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Soll</surname> <given-names>D</given-names></name>. <article-title>Aminoacyl-tRNA synthetases, the genetic code, and the evolutionary process</article-title>. <source>Microbiology and molecular biology reviews: MMBR</source>. <year>2000</year> <month>Mar</month>;<volume>64</volume>(<issue>1</issue>):<fpage>202</fpage>–<lpage>36</lpage>. <object-id pub-id-type="pmid">10704480</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref024"><label>24</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ludwig</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Strunk</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Klugbauer</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Klugbauer</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Weizenegger</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Neumaier</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Bacterial phylogeny based on comparative sequence analysis</article-title>. <source>Electrophoresis</source>. <year>1998</year> <month>Apr</month>;<volume>19</volume>(<issue>4</issue>):<fpage>554</fpage>–<lpage>68</lpage>. English. <object-id pub-id-type="pmid">9588802</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref025"><label>25</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lang</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Darling</surname> <given-names>AE</given-names></name>, <name name-style="western"><surname>Eisen</surname> <given-names>JA</given-names></name>. <article-title>Phylogeny of Bacterial and Archaeal Genomes Using Conserved Genes: Supertrees and Supermatrices</article-title>. <source>PloS one</source>. <year>2013</year> <month>Apr</month> <day>25</day>;<volume>8</volume>(<issue>4</issue>). English.</mixed-citation></ref>
<ref id="pcbi.1004985.ref026"><label>26</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Erdos</surname> <given-names>PL</given-names></name>, <name name-style="western"><surname>Steel</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Szekely</surname> <given-names>LA</given-names></name>, <name name-style="western"><surname>Warnow</surname> <given-names>TJ</given-names></name>. <article-title>A few logs suffice to build (almost) all trees (I)</article-title>. <source>Random Struct Algor</source>. <year>1999</year> <month>Mar</month>;<volume>14</volume>(<issue>2</issue>):<fpage>153</fpage>–<lpage>84</lpage>. English.</mixed-citation></ref>
<ref id="pcbi.1004985.ref027"><label>27</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bapteste</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Brinkmann</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Moore</surname> <given-names>DV</given-names></name>, <name name-style="western"><surname>Sensen</surname> <given-names>CW</given-names></name>, <name name-style="western"><surname>Gordon</surname> <given-names>P</given-names></name>, <etal>et al</etal>. <article-title>The analysis of 100 genes supports the grouping of three highly divergent amoebae: Dictyostelium, Entamoeba, and Mastigamoeba</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source>. <year>2002</year> <month>Feb</month> <day>5</day>;<volume>99</volume>(<issue>3</issue>):<fpage>1414</fpage>–<lpage>9</lpage>. English. <object-id pub-id-type="pmid">11830664</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref028"><label>28</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Brown</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>Douady</surname> <given-names>CJ</given-names></name>, <name name-style="western"><surname>Italia</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Marshall</surname> <given-names>WE</given-names></name>, <name name-style="western"><surname>Stanhope</surname> <given-names>MJ</given-names></name>. <article-title>Universal trees based on large combined protein sequence data sets</article-title>. <source>Nat Genet</source>. <year>2001</year> <month>Jul</month>;<volume>28</volume>(<issue>3</issue>):<fpage>281</fpage>–<lpage>5</lpage>. English. <object-id pub-id-type="pmid">11431701</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref029"><label>29</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wang</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Wu</surname> <given-names>M</given-names></name>. <article-title>A phylum-level bacterial phylogenetic marker database</article-title>. <source>Molecular biology and evolution</source>. <year>2013</year> <month>Jun</month>;<volume>30</volume>(<issue>6</issue>):<fpage>1258</fpage>–<lpage>62</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/molbev/mst059" xlink:type="simple">10.1093/molbev/mst059</ext-link></comment> <object-id pub-id-type="pmid">23519313</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref030"><label>30</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ciccarelli</surname> <given-names>FD</given-names></name>, <name name-style="western"><surname>Doerks</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>von Mering</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Creevey</surname> <given-names>CJ</given-names></name>, <name name-style="western"><surname>Snel</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Bork</surname> <given-names>P</given-names></name>. <article-title>Toward automatic reconstruction of a highly resolved tree of life</article-title>. <source>Science</source>. <year>2006</year> <month>Mar</month> <day>3</day>;<volume>311</volume>(<issue>5765</issue>):<fpage>1283</fpage>–<lpage>7</lpage>. English. <object-id pub-id-type="pmid">16513982</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref031"><label>31</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bapteste</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>O'Malley</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Beiko</surname> <given-names>RG</given-names></name>, <name name-style="western"><surname>Ereshefsky</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Gogarten</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Franklin-Hall</surname> <given-names>L</given-names></name>, <etal>et al</etal>. <article-title>Prokaryotic evolution and the tree of life are two different things</article-title>. <source>Biology direct</source>. <year>2009</year>;<volume>4</volume>:<fpage>34</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1745-6150-4-34" xlink:type="simple">10.1186/1745-6150-4-34</ext-link></comment> <object-id pub-id-type="pmid">19788731</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref032"><label>32</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Beiko</surname> <given-names>RG</given-names></name>, <name name-style="western"><surname>Doolittle</surname> <given-names>WF</given-names></name>, <name name-style="western"><surname>Charlebois</surname> <given-names>RL</given-names></name>. <article-title>The impact of reticulate evolution on genome phylogeny</article-title>. <source>Systematic biology</source>. <year>2008</year> <month>Dec</month>;<volume>57</volume>(<issue>6</issue>):<fpage>844</fpage>–<lpage>56</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1080/10635150802559265" xlink:type="simple">10.1080/10635150802559265</ext-link></comment> <object-id pub-id-type="pmid">19085328</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref033"><label>33</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hilario</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Gogarten</surname> <given-names>JP</given-names></name>. <article-title>Horizontal transfer of ATPase genes—the tree of life becomes a net of life</article-title>. <source>Bio Systems</source>. <year>1993</year>;<volume>31</volume>(<issue>2–3</issue>):<fpage>111</fpage>–<lpage>9</lpage>. <object-id pub-id-type="pmid">8155843</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref034"><label>34</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Puigbo</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Wolf</surname> <given-names>YI</given-names></name>, <name name-style="western"><surname>Koonin</surname> <given-names>EV</given-names></name>. <article-title>The tree and net components of prokaryote evolution</article-title>. <source>Genome biology and evolution</source>. <year>2010</year>;<volume>2</volume>:<fpage>745</fpage>–<lpage>56</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/gbe/evq062" xlink:type="simple">10.1093/gbe/evq062</ext-link></comment> <object-id pub-id-type="pmid">20889655</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref035"><label>35</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Vinga</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Almeida</surname> <given-names>J</given-names></name>. <article-title>Alignment-free sequence comparison-a review</article-title>. <source>Bioinformatics</source>. <year>2003</year> <month>Mar</month> <day>1</day>;<volume>19</volume>(<issue>4</issue>):<fpage>513</fpage>–<lpage>23</lpage>. <object-id pub-id-type="pmid">12611807</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref036"><label>36</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Song</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Ren</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Reinert</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Deng</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Waterman</surname> <given-names>MS</given-names></name>, <name name-style="western"><surname>Sun</surname> <given-names>F</given-names></name>. <article-title>New developments of alignment-free sequence comparison: measures, statistics and next-generation sequencing</article-title>. <source>Briefings in bioinformatics</source>. <year>2014</year> <month>May</month>;<volume>15</volume>(<issue>3</issue>):<fpage>343</fpage>–<lpage>53</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bib/bbt067" xlink:type="simple">10.1093/bib/bbt067</ext-link></comment> <object-id pub-id-type="pmid">24064230</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref037"><label>37</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bonham-Carter</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Steele</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Bastola</surname> <given-names>D</given-names></name>. <article-title>Alignment-free genetic sequence comparisons: a review of recent approaches by word analysis</article-title>. <source>Briefings in bioinformatics</source>. <year>2014</year> <month>Nov</month>;<volume>15</volume>(<issue>6</issue>):<fpage>890</fpage>–<lpage>905</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bib/bbt052" xlink:type="simple">10.1093/bib/bbt052</ext-link></comment> <object-id pub-id-type="pmid">23904502</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref038"><label>38</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Haubold</surname> <given-names>B</given-names></name>. <article-title>Alignment-free phylogenetics and population genetics</article-title>. <source>Briefings in bioinformatics</source>. <year>2014</year> <month>May</month>;<volume>15</volume>(<issue>3</issue>):<fpage>407</fpage>–<lpage>18</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bib/bbt083" xlink:type="simple">10.1093/bib/bbt083</ext-link></comment> <object-id pub-id-type="pmid">24291823</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref039"><label>39</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ragan</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Bernard</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Chan</surname> <given-names>CX</given-names></name>. <article-title>Molecular phylogenetics before sequences: oligonucleotide catalogs as k-mer spectra</article-title>. <source>RNA biology</source>. <year>2014</year>;<volume>11</volume>(<issue>3</issue>):<fpage>176</fpage>–<lpage>85</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.4161/rna.27505" xlink:type="simple">10.4161/rna.27505</ext-link></comment> <object-id pub-id-type="pmid">24572375</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref040"><label>40</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Konstantinidis</surname> <given-names>KT</given-names></name>, <name name-style="western"><surname>Tiedje</surname> <given-names>JM</given-names></name>. <article-title>Prokaryotic taxonomy and phylogeny in the genomic era: advancements and challenges ahead</article-title>. <source>Current opinion in microbiology</source>. <year>2007</year> <month>Oct</month>;<volume>10</volume>(<issue>5</issue>):<fpage>504</fpage>–<lpage>9</lpage>. <object-id pub-id-type="pmid">17923431</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref041"><label>41</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Qi</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Luo</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Hao</surname> <given-names>BL</given-names></name>. <article-title>CVTree: a phylogenetic tree reconstruction tool based on whole genomes</article-title>. <source>Nucleic Acids Res</source>. <year>2004</year> <month>Jul</month> <day>1</day>;<volume>32</volume>:<fpage>W45</fpage>–<lpage>W7</lpage>. English. <object-id pub-id-type="pmid">15215347</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref042"><label>42</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zuo</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Xu</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Hao</surname> <given-names>B</given-names></name>. <article-title>Phylogeny and Taxonomy of Archaea: A Comparison of the Whole-Genome-Based CVTree Approach with 16S rRNA Sequence Analysis</article-title>. <source>Life</source>. <year>2015</year>;<volume>5</volume>(<issue>1</issue>):<fpage>949</fpage>–<lpage>68</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.3390/life5010949" xlink:type="simple">10.3390/life5010949</ext-link></comment> <object-id pub-id-type="pmid">25789552</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref043"><label>43</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sims</surname> <given-names>GE</given-names></name>, <name name-style="western"><surname>Jun</surname> <given-names>SR</given-names></name>, <name name-style="western"><surname>Wua</surname> <given-names>GA</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>SH</given-names></name>. <article-title>Alignment-free genome comparison with feature frequency profiles (FFP) and optimal resolutions</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source>. <year>2009</year> <month>Feb</month> <day>24</day>;<volume>106</volume>(<issue>8</issue>):<fpage>2677</fpage>–<lpage>82</lpage>. English. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.0813249106" xlink:type="simple">10.1073/pnas.0813249106</ext-link></comment> <object-id pub-id-type="pmid">19188606</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref044"><label>44</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Chan</surname> <given-names>CX</given-names></name>, <name name-style="western"><surname>Bernard</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Poirion</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Hogan</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Ragan</surname> <given-names>MA</given-names></name>. <article-title>Inferring phylogenies of evolving sequences without multiple sequence alignment</article-title>. <source>Scientific reports</source>. <year>2014</year>;<volume>4</volume>:<fpage>6504</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/srep06504" xlink:type="simple">10.1038/srep06504</ext-link></comment> <object-id pub-id-type="pmid">25266120</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref045"><label>45</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Torney</surname> <given-names>DC</given-names></name>, <name name-style="western"><surname>Burks</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Davison</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Sirotkin</surname> <given-names>KM</given-names></name>. <article-title>Computation of D2—a Measure of Sequence Dissimilarity</article-title>. <source>Sfi S Sci C</source>. <year>1990</year>;<volume>7</volume>:<fpage>109</fpage>–<lpage>25</lpage>. English.</mixed-citation></ref>
<ref id="pcbi.1004985.ref046"><label>46</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Blaisdell</surname> <given-names>BE</given-names></name>. <article-title>A measure of the similarity of sets of sequences not requiring sequence alignment</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source>. <year>1986</year> <month>Jul</month>;<volume>83</volume>(<issue>14</issue>):<fpage>5155</fpage>–<lpage>9</lpage>. <object-id pub-id-type="pmid">3460087</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref047"><label>47</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lin</surname> <given-names>JH</given-names></name>. <article-title>Divergence Measures Based on the Shannon Entropy</article-title>. <source>Ieee T Inform Theory</source>. <year>1991</year> <month>Jan</month>;<volume>37</volume>(<issue>1</issue>):<fpage>145</fpage>–<lpage>51</lpage>. English.</mixed-citation></ref>
<ref id="pcbi.1004985.ref048"><label>48</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yi</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Jin</surname> <given-names>L</given-names></name>. <article-title>Co-phylog: an assembly-free phylogenomic approach for closely related organisms</article-title>. <source>Nucleic Acids Res</source>. <year>2013</year> <month>Apr</month>;<volume>41</volume>(<issue>7</issue>):<fpage>e75</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkt003" xlink:type="simple">10.1093/nar/gkt003</ext-link></comment> <object-id pub-id-type="pmid">23335788</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref049"><label>49</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Horwege</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Lindner</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Boden</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Hatje</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Kollmar</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Leimeister</surname> <given-names>CA</given-names></name>, <etal>et al</etal>. <article-title>Spaced words and kmacs: fast alignment-free sequence comparison based on inexact word matches</article-title>. <source>Nucleic Acids Res</source>. <year>2014</year> <month>Jul</month> <day>1</day>;<volume>42</volume>(<issue>W1</issue>):<fpage>W7</fpage>–<lpage>W11</lpage>. English.</mixed-citation></ref>
<ref id="pcbi.1004985.ref050"><label>50</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Leimeister</surname> <given-names>CA</given-names></name>, <name name-style="western"><surname>Boden</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Horwege</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Lindner</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Morgenstern</surname> <given-names>B</given-names></name>. <article-title>Fast alignment-free sequence comparison using spaced-word frequencies</article-title>. <source>Bioinformatics</source>. <year>2014</year> <month>Jul</month> <day>15</day>;<volume>30</volume>(<issue>14</issue>):<fpage>1991</fpage>–<lpage>9</lpage>. English. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btu177" xlink:type="simple">10.1093/bioinformatics/btu177</ext-link></comment> <object-id pub-id-type="pmid">24700317</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref051"><label>51</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ulitsky</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Burstein</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Tuller</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Chor</surname> <given-names>B</given-names></name>. <article-title>The average common substring approach to phylogenomic reconstruction</article-title>. <source>J Comput Biol</source>. <year>2006</year> <month>Mar</month>;<volume>13</volume>(<issue>2</issue>):<fpage>336</fpage>–<lpage>50</lpage>. English. <object-id pub-id-type="pmid">16597244</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref052"><label>52</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Haubold</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Pfaffelhuber</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Domazet-Loso</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Wiehe</surname> <given-names>T</given-names></name>. <article-title>Estimating mutation distances from unaligned genomes</article-title>. <source>J Comput Biol</source>. <year>2009</year> <month>Oct</month>;<volume>16</volume>(<issue>10</issue>):<fpage>1487</fpage>–<lpage>500</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1089/cmb.2009.0106" xlink:type="simple">10.1089/cmb.2009.0106</ext-link></comment> <object-id pub-id-type="pmid">19803738</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref053"><label>53</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Comin</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Verzotto</surname> <given-names>D</given-names></name>. <article-title>Alignment-free phylogeny of whole genomes using underlying subwords</article-title>. <source>Algorithm Mol Biol</source>. <year>2012</year> <month>Dec</month> <day>6</day>;<volume>7</volume>. English.</mixed-citation></ref>
<ref id="pcbi.1004985.ref054"><label>54</label><mixed-citation publication-type="other" xlink:type="simple">Sharma V Thankachan SPC, Yongchao Liu, Ambujam Krishnan, Srinivas Aluru. A greey alignment-free distance estimator for phylogenetic inference. Computational Advances in Bio and Medical Sciences (ICCABS), 2015 IEEE 5th International Conference. 2015.</mixed-citation></ref>
<ref id="pcbi.1004985.ref055"><label>55</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Thankachan</surname> <given-names>SV</given-names></name>, <name name-style="western"><surname>A</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Aluru</surname> <given-names>S</given-names></name>. <article-title>A Provably Efficient Algorithm for the k-Mismatch Averaeg Common Substring Problem</article-title>. <source>J Comput Biol</source>. <year>2016</year>.</mixed-citation></ref>
<ref id="pcbi.1004985.ref056"><label>56</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ochman</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Lawrence</surname> <given-names>JG</given-names></name>, <name name-style="western"><surname>Groisman</surname> <given-names>EA</given-names></name>. <article-title>Lateral gene transfer and the nature of bacterial innovation</article-title>. <source>Nature</source>. <year>2000</year> <month>May</month> <day>18</day>;<volume>405</volume>(<issue>6784</issue>):<fpage>299</fpage>–<lpage>304</lpage>. <object-id pub-id-type="pmid">10830951</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref057"><label>57</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Syvanen</surname> <given-names>M</given-names></name>. <article-title>Evolutionary implications of horizontal gene transfer</article-title>. <source>Annual review of genetics</source>. <year>2012</year>;<volume>46</volume>:<fpage>341</fpage>–<lpage>58</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1146/annurev-genet-110711-155529" xlink:type="simple">10.1146/annurev-genet-110711-155529</ext-link></comment> <object-id pub-id-type="pmid">22934638</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref058"><label>58</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Li</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Xing</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Yu</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Lan</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Liu</surname> <given-names>J</given-names></name>. <article-title>Phylogenetic analysis reveals the coexistence of interfamily and interspecies horizontal gene transfer in Streptococcus thermophilus strains isolated from the same yoghurt</article-title>. <source>Molecular phylogenetics and evolution</source>. <year>2013</year> <month>Oct</month>;<volume>69</volume>(<issue>1</issue>):<fpage>286</fpage>–<lpage>92</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.ympev.2013.06.002" xlink:type="simple">10.1016/j.ympev.2013.06.002</ext-link></comment> <object-id pub-id-type="pmid">23769954</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref059"><label>59</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Medigue</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Rouxel</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Vigier</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Henaut</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Danchin</surname> <given-names>A</given-names></name>. <article-title>Evidence for horizontal gene transfer in Escherichia coli speciation</article-title>. <source>Journal of molecular biology</source>. <year>1991</year> <month>Dec</month> <day>20</day>;<volume>222</volume>(<issue>4</issue>):<fpage>851</fpage>–<lpage>6</lpage>. <object-id pub-id-type="pmid">1762151</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref060"><label>60</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Koonin</surname> <given-names>EV</given-names></name>, <name name-style="western"><surname>Makarova</surname> <given-names>KS</given-names></name>, <name name-style="western"><surname>Aravind</surname> <given-names>L</given-names></name>. <article-title>Horizontal gene transfer in prokaryotes: quantification and classification</article-title>. <source>Annual review of microbiology</source>. <year>2001</year>;<volume>55</volume>:<fpage>709</fpage>–<lpage>42</lpage>. <object-id pub-id-type="pmid">11544372</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref061"><label>61</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Robinson</surname> <given-names>DF</given-names></name>, <name name-style="western"><surname>Foulds</surname> <given-names>LR</given-names></name>. <article-title>Comparison of Phylogenetic Trees</article-title>. <source>Mathematical biosciences</source>. <year>1981</year>;<volume>53</volume>(<issue>1–2</issue>):<fpage>131</fpage>–<lpage>47</lpage>. English.</mixed-citation></ref>
<ref id="pcbi.1004985.ref062"><label>62</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nelson</surname> <given-names>KE</given-names></name>, <name name-style="western"><surname>Clayton</surname> <given-names>RA</given-names></name>, <name name-style="western"><surname>Gill</surname> <given-names>SR</given-names></name>, <name name-style="western"><surname>Gwinn</surname> <given-names>ML</given-names></name>, <name name-style="western"><surname>Dodson</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Haft</surname> <given-names>DH</given-names></name>, <etal>et al</etal>. <article-title>Evidence for lateral gene transfer between Archaea and bacteria from genome sequence of Thermotoga maritima</article-title>. <source>Nature</source>. <year>1999</year> <month>May</month> <day>27</day>;<volume>399</volume>(<issue>6734</issue>):<fpage>323</fpage>–<lpage>9</lpage>. <object-id pub-id-type="pmid">10360571</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref063"><label>63</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Garcia-Vallve</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Romeu</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Palau</surname> <given-names>J</given-names></name>. <article-title>Horizontal gene transfer in bacterial and archaeal complete genomes</article-title>. <source>Genome Res</source>. <year>2000</year> <month>Nov</month>;<volume>10</volume>(<issue>11</issue>):<fpage>1719</fpage>–<lpage>25</lpage>. <object-id pub-id-type="pmid">11076857</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref064"><label>64</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Metcalf</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Funkhouser-Jones</surname> <given-names>LJ</given-names></name>, <name name-style="western"><surname>Brileya</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Reysenbach</surname> <given-names>AL</given-names></name>, <name name-style="western"><surname>Bordenstein</surname> <given-names>SR</given-names></name>. <article-title>Antibacterial gene transfer across the tree of life</article-title>. <source>eLife</source>. <year>2014</year>;<volume>3</volume>.</mixed-citation></ref>
<ref id="pcbi.1004985.ref065"><label>65</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Touchon</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Hoede</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Tenaillon</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Barbe</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Baeriswyl</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Bidet</surname> <given-names>P</given-names></name>, <etal>et al</etal>. <article-title>Organised Genome Dynamics in the Escherichia coli Species Results in Highly Diverse Adaptive Paths</article-title>. <source>Plos Genet</source>. <year>2009</year> <month>Jan</month>;<volume>5</volume>(<issue>1</issue>). English.</mixed-citation></ref>
<ref id="pcbi.1004985.ref066"><label>66</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sims</surname> <given-names>GE</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>SH</given-names></name>. <article-title>Whole-genome phylogeny of Escherichia coli/Shigella group by feature frequency profiles (FFPs)</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source>. <year>2011</year> <month>May</month> <day>17</day>;<volume>108</volume>(<issue>20</issue>):<fpage>8329</fpage>–<lpage>34</lpage>. English. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1105168108" xlink:type="simple">10.1073/pnas.1105168108</ext-link></comment> <object-id pub-id-type="pmid">21536867</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref067"><label>67</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Clermont</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Gordon</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Denamur</surname> <given-names>E</given-names></name>. <article-title>Guide to the various phylogenetic classification schemes for Escherichia coli and the correspondence among schemes</article-title>. <source>Microbiology</source>. <year>2015</year> <month>May</month>;<volume>161</volume>(<issue>Pt 5</issue>):<fpage>980</fpage>–<lpage>8</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1099/mic.0.000063" xlink:type="simple">10.1099/mic.0.000063</ext-link></comment> <object-id pub-id-type="pmid">25714816</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref068"><label>68</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Turrientes</surname> <given-names>MC</given-names></name>, <name name-style="western"><surname>Gonzalez-Alba</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>del Campo</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Baquero</surname> <given-names>MR</given-names></name>, <name name-style="western"><surname>Canton</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Baquero</surname> <given-names>F</given-names></name>, <etal>et al</etal>. <article-title>Recombination blurs phylogenetic groups routine assignment in Escherichia coli: setting the record straight</article-title>. <source>PloS one</source>. <year>2014</year>;<volume>9</volume>(<issue>8</issue>):<fpage>e105395</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0105395" xlink:type="simple">10.1371/journal.pone.0105395</ext-link></comment> <object-id pub-id-type="pmid">25137251</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref069"><label>69</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sahl</surname> <given-names>JW</given-names></name>, <name name-style="western"><surname>Morris</surname> <given-names>CR</given-names></name>, <name name-style="western"><surname>Emberger</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Fraser</surname> <given-names>CM</given-names></name>, <name name-style="western"><surname>Ochieng</surname> <given-names>JB</given-names></name>, <name name-style="western"><surname>Juma</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Defining the Phylogenomics of Shigella Species: a Pathway to Diagnostics</article-title>. <source>J Clin Microbiol</source>. <year>2015</year> <month>Mar</month>;<volume>53</volume>(<issue>3</issue>):<fpage>951</fpage>–<lpage>60</lpage>. English. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1128/JCM.03527-14" xlink:type="simple">10.1128/JCM.03527-14</ext-link></comment> <object-id pub-id-type="pmid">25588655</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref070"><label>70</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Paulsen</surname> <given-names>IT</given-names></name>, <name name-style="western"><surname>Banerjei</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Myers</surname> <given-names>GS</given-names></name>, <name name-style="western"><surname>Nelson</surname> <given-names>KE</given-names></name>, <name name-style="western"><surname>Seshadri</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Read</surname> <given-names>TD</given-names></name>, <etal>et al</etal>. <article-title>Role of mobile DNA in the evolution of vancomycin-resistant Enterococcus faecalis</article-title>. <source>Science</source>. <year>2003</year> <month>Mar</month> <day>28</day>;<volume>299</volume>(<issue>5615</issue>):<fpage>2071</fpage>–<lpage>4</lpage>. <object-id pub-id-type="pmid">12663927</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref071"><label>71</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Li</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Du</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Villaruz</surname> <given-names>AE</given-names></name>, <name name-style="western"><surname>Diep</surname> <given-names>BA</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Song</surname> <given-names>Y</given-names></name>, <etal>et al</etal>. <article-title>MRSA epidemic linked to a quickly spreading colonization and virulence determinant</article-title>. <source>Nature medicine</source>. <year>2012</year> <month>May</month>;<volume>18</volume>(<issue>5</issue>):<fpage>816</fpage>–<lpage>9</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nm.2692" xlink:type="simple">10.1038/nm.2692</ext-link></comment> <object-id pub-id-type="pmid">22522561</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref072"><label>72</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gupta</surname> <given-names>RS</given-names></name>, <name name-style="western"><surname>Bhandari</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Naushad</surname> <given-names>HS</given-names></name>. <article-title>Molecular Signatures for the PVC Clade (Planctomycetes, Verrucomicrobia, Chlamydiae, and Lentisphaerae) of Bacteria Provide Insights into Their Evolutionary Relationships</article-title>. <source>Frontiers in microbiology</source>. <year>2012</year>;<volume>3</volume>:<fpage>327</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.3389/fmicb.2012.00327" xlink:type="simple">10.3389/fmicb.2012.00327</ext-link></comment> <object-id pub-id-type="pmid">23060863</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref073"><label>73</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fuerst</surname> <given-names>JA</given-names></name>. <article-title>The PVC superphylum: exceptions to the bacterial definition?</article-title> <source>Antonie van Leeuwenhoek</source>. <year>2013</year> <month>Oct</month>;<volume>104</volume>(<issue>4</issue>):<fpage>451</fpage>–<lpage>66</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s10482-013-9986-1" xlink:type="simple">10.1007/s10482-013-9986-1</ext-link></comment> <object-id pub-id-type="pmid">23912444</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref074"><label>74</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zhang</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Lu</surname> <given-names>Z</given-names></name>. <article-title>Phylogenomic evaluation of members above the species level within the phylum Firmicutes based on conserved proteins</article-title>. <source>Environ Microbiol Rep</source>. <year>2015</year> <month>Apr</month>;<volume>7</volume>(<issue>2</issue>):<fpage>273</fpage>–<lpage>81</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/1758-2229.12241" xlink:type="simple">10.1111/1758-2229.12241</ext-link></comment> <object-id pub-id-type="pmid">25403554</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref075"><label>75</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zhaxybayeva</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Swithers</surname> <given-names>KS</given-names></name>, <name name-style="western"><surname>Lapierre</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Fournier</surname> <given-names>GP</given-names></name>, <name name-style="western"><surname>Bickhart</surname> <given-names>DM</given-names></name>, <name name-style="western"><surname>DeBoy</surname> <given-names>RT</given-names></name>, <etal>et al</etal>. <article-title>On the chimeric nature, thermophilic origin, and phylogenetic placement of the Thermotogales</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source>. <year>2009</year> <month>Apr</month> <day>7</day>;<volume>106</volume>(<issue>14</issue>):<fpage>5865</fpage>–<lpage>70</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.0901260106" xlink:type="simple">10.1073/pnas.0901260106</ext-link></comment> <object-id pub-id-type="pmid">19307556</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref076"><label>76</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wolf</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Muller</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Dandekar</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Pollack</surname> <given-names>JD</given-names></name>. <article-title>Phylogeny of Firmicutes with special reference to Mycoplasma (Mollicutes) as inferred from phosphoglycerate kinase amino acid sequence data</article-title>. <source>International journal of systematic and evolutionary microbiology</source>. <year>2004</year> <month>May</month>;<volume>54</volume>(<issue>Pt 3</issue>):<fpage>871</fpage>–<lpage>5</lpage>. <object-id pub-id-type="pmid">15143038</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref077"><label>77</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mira</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Pushker</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Legault</surname> <given-names>BA</given-names></name>, <name name-style="western"><surname>Moreira</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Rodriguez-Valera</surname> <given-names>F</given-names></name>. <article-title>Evolutionary relationships of Fusobacterium nucleatum based on phylogenetic analysis and comparative genomics</article-title>. <source>Bmc Evol Biol</source>. <year>2004</year> <month>Nov</month> <day>26</day>;<volume>4</volume>. English.</mixed-citation></ref>
<ref id="pcbi.1004985.ref078"><label>78</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sutcliffe</surname> <given-names>IC</given-names></name>. <article-title>A phylum level perspective on bacterial cell envelope architecture</article-title>. <source>Trends Microbiol</source>. <year>2010</year> <month>Oct</month>;<volume>18</volume>(<issue>10</issue>):<fpage>464</fpage>–<lpage>70</lpage>. English. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.tim.2010.06.005" xlink:type="simple">10.1016/j.tim.2010.06.005</ext-link></comment> <object-id pub-id-type="pmid">20637628</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref079"><label>79</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rainey</surname> <given-names>FA</given-names></name>, <name name-style="western"><surname>Stackebrandt</surname> <given-names>E</given-names></name>. <article-title>Transfer of the Type Species of the Genus Thermobacteroides to the Genus Thermoanaerobacter as Thermoanaerobacter-Acetoethylicus (Ben-Bassat and Zeikus 1981) Comb-Nov, Description of Coprothermobacter Gen-Nov, and Reclassification of Thermobacteroides-Proteolyticus as Coprothermobacter-Proteolyticus (Ollivier Et-Al 1985) Comb-Nov</article-title>. <source>Int J Syst Bacteriol</source>. <year>1993</year> <month>Oct</month>;<volume>43</volume>(<issue>4</issue>):<fpage>857</fpage>–<lpage>9</lpage>. English.</mixed-citation></ref>
<ref id="pcbi.1004985.ref080"><label>80</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zhang</surname> <given-names>WW</given-names></name>, <name name-style="western"><surname>Lu</surname> <given-names>ZT</given-names></name>. <article-title>Phylogenomic evaluation of members above the species level within the phylum Firmicutes based on conserved proteins</article-title>. <source>Env Microbiol Rep</source>. <year>2015</year> <month>Apr</month>;<volume>7</volume>(<issue>2</issue>):<fpage>273</fpage>–<lpage>81</lpage>. English.</mixed-citation></ref>
<ref id="pcbi.1004985.ref081"><label>81</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nishida</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Beppu</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Ueda</surname> <given-names>K</given-names></name>. <article-title>Whole-genome comparison clarifies close phylogenetic relationships between the phyla Dictyoglomi and Thermotogae</article-title>. <source>Genomics</source>. <year>2011</year> <month>Nov</month>;<volume>98</volume>(<issue>5</issue>):<fpage>370</fpage>–<lpage>5</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.ygeno.2011.08.001" xlink:type="simple">10.1016/j.ygeno.2011.08.001</ext-link></comment> <object-id pub-id-type="pmid">21851855</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref082"><label>82</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Huntemann</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Lu</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Nolan</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Lapidus</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Lucas</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Hammon</surname> <given-names>N</given-names></name>, <etal>et al</etal>. <article-title>Complete genome sequence of the thermophilic sulfur-reducer Hippea maritima type strain (MH(2))</article-title>. <source>Standards in genomic sciences</source>. <year>2011</year> <month>Jul</month> <day>1</day>;<volume>4</volume>(<issue>3</issue>):<fpage>303</fpage>–<lpage>11</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.4056/sigs.1814460" xlink:type="simple">10.4056/sigs.1814460</ext-link></comment> <object-id pub-id-type="pmid">21886857</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref083"><label>83</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Williams</surname> <given-names>KP</given-names></name>, <name name-style="western"><surname>Kelly</surname> <given-names>DP</given-names></name>. <article-title>Proposal for a new class within the phylum Proteobacteria, Acidithiobacillia classis nov., with the type order Acidithiobacillales, and emended description of the class Gammaproteobacteria (vol 63, pg 2901, 2013)</article-title>. <source>International journal of systematic and evolutionary microbiology</source>. <year>2013</year> <month>Sep</month>;<volume>63</volume>:<fpage>3547</fpage>–<lpage>8</lpage>. English.</mixed-citation></ref>
<ref id="pcbi.1004985.ref084"><label>84</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Williams</surname> <given-names>KP</given-names></name>, <name name-style="western"><surname>Gillespie</surname> <given-names>JJ</given-names></name>, <name name-style="western"><surname>Sobral</surname> <given-names>BW</given-names></name>, <name name-style="western"><surname>Nordberg</surname> <given-names>EK</given-names></name>, <name name-style="western"><surname>Snyder</surname> <given-names>EE</given-names></name>, <name name-style="western"><surname>Shallom</surname> <given-names>JM</given-names></name>, <etal>et al</etal>. <article-title>Phylogeny of gammaproteobacteria</article-title>. <source>J Bacteriol</source>. <year>2010</year> <month>May</month>;<volume>192</volume>(<issue>9</issue>):<fpage>2305</fpage>–<lpage>14</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1128/JB.01480-09" xlink:type="simple">10.1128/JB.01480-09</ext-link></comment> <object-id pub-id-type="pmid">20207755</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref085"><label>85</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Moe</surname> <given-names>WM</given-names></name>, <name name-style="western"><surname>Yan</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Nobre</surname> <given-names>MF</given-names></name>, <name name-style="western"><surname>da Costa</surname> <given-names>MS</given-names></name>, <name name-style="western"><surname>Rainey</surname> <given-names>FA</given-names></name>. <article-title>Dehalogenimonas lykanthroporepellens gen. nov., sp. nov., a reductively dehalogenating bacterium isolated from chlorinated solvent-contaminated groundwater</article-title>. <source>International journal of systematic and evolutionary microbiology</source>. <year>2009</year> <month>Nov</month>;<volume>59</volume>(<issue>Pt 11</issue>):<fpage>2692</fpage>–<lpage>7</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1099/ijs.0.011502-0" xlink:type="simple">10.1099/ijs.0.011502-0</ext-link></comment> <object-id pub-id-type="pmid">19625421</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref086"><label>86</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Loffler</surname> <given-names>FE</given-names></name>, <name name-style="western"><surname>Yan</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Ritalahti</surname> <given-names>KM</given-names></name>, <name name-style="western"><surname>Adrian</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Edwards</surname> <given-names>EA</given-names></name>, <name name-style="western"><surname>Konstantinidis</surname> <given-names>KT</given-names></name>, <etal>et al</etal>. <article-title>Dehalococcoides mccartyi gen. nov., sp. nov., obligately organohalide-respiring anaerobic bacteria relevant to halogen cycling and bioremediation, belong to a novel bacterial class, Dehalococcoidia classis nov., order Dehalococcoidales ord. nov. and family Dehalococcoidaceae fam. nov., within the phylum Chloroflexi</article-title>. <source>International journal of systematic and evolutionary microbiology</source>. <year>2013</year> <month>Feb</month>;<volume>63</volume>(<issue>Pt 2</issue>):<fpage>625</fpage>–<lpage>35</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1099/ijs.0.034926-0" xlink:type="simple">10.1099/ijs.0.034926-0</ext-link></comment> <object-id pub-id-type="pmid">22544797</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref087"><label>87</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Felsenstein</surname> <given-names>J</given-names></name>. <source>PHYLIP (Phylogeny Inference Package)</source>. <edition>3.6 ed</edition>. <publisher-name>Department of Genome Sciences, University of Washington</publisher-name>, <publisher-loc>Seattle</publisher-loc><year>2005</year>.</mixed-citation></ref>
<ref id="pcbi.1004985.ref088"><label>88</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bachvaroff</surname> <given-names>TR</given-names></name>, <name name-style="western"><surname>Handy</surname> <given-names>SM</given-names></name>, <name name-style="western"><surname>Place</surname> <given-names>AR</given-names></name>, <name name-style="western"><surname>Delwiche</surname> <given-names>CF</given-names></name>. <article-title>Alveolate phylogeny inferred using concatenated ribosomal proteins</article-title>. <source>The Journal of eukaryotic microbiology</source>. <year>2011</year> <month>May-Jun</month>;<volume>58</volume>(<issue>3</issue>):<fpage>223</fpage>–<lpage>33</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/j.1550-7408.2011.00555.x" xlink:type="simple">10.1111/j.1550-7408.2011.00555.x</ext-link></comment> <object-id pub-id-type="pmid">21518081</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref089"><label>89</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Matte-Tailliez</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Brochier</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Forterre</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Philippe</surname> <given-names>H</given-names></name>. <article-title>Archaeal phylogeny based on ribosomal proteins</article-title>. <source>Molecular biology and evolution</source>. <year>2002</year> <month>May</month>;<volume>19</volume>(<issue>5</issue>):<fpage>631</fpage>–<lpage>9</lpage>. <object-id pub-id-type="pmid">11961097</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref090"><label>90</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Junier</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Zdobnov</surname> <given-names>EM</given-names></name>. <article-title>The Newick utilities: high-throughput phylogenetic tree processing in the UNIX shell</article-title>. <source>Bioinformatics</source>. <year>2010</year> <month>Jul</month> <day>1</day>;<volume>26</volume>(<issue>13</issue>):<fpage>1669</fpage>–<lpage>70</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btq243" xlink:type="simple">10.1093/bioinformatics/btq243</ext-link></comment> <object-id pub-id-type="pmid">20472542</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref091"><label>91</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Simonsen</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Mailund</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Pedersen</surname> <given-names>CNS</given-names></name>. <article-title>Inference of Large Phylogenies Using Neighbour-Joining</article-title>. <source>Biomedical Engineering Systems and Technologies</source>. <year>2011</year>;<volume>127</volume>:<fpage>334</fpage>–<lpage>44</lpage>. English.</mixed-citation></ref>
<ref id="pcbi.1004985.ref092"><label>92</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Letunic</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Bork</surname> <given-names>P</given-names></name>. <article-title>Interactive Tree Of Life (iTOL): an online tool for phylogenetic tree display and annotation</article-title>. <source>Bioinformatics</source>. <year>2007</year> <month>Jan</month> <day>1</day>;<volume>23</volume>(<issue>1</issue>):<fpage>127</fpage>–<lpage>8</lpage>. <object-id pub-id-type="pmid">17050570</object-id></mixed-citation></ref>
<ref id="pcbi.1004985.ref093"><label>93</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Letunic</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Bork</surname> <given-names>P</given-names></name>. <article-title>Interactive Tree Of Life v2: online annotation and display of phylogenetic trees made easy</article-title>. <source>Nucleic Acids Res</source>. <year>2011</year> <month>Jul</month>;<volume>39</volume>(<issue>Web Server issue</issue>):<fpage>W475</fpage>–<lpage>8</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkr201" xlink:type="simple">10.1093/nar/gkr201</ext-link></comment> <object-id pub-id-type="pmid">21470960</object-id></mixed-citation></ref>
</ref-list>
</back>
</article>