<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research-article">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-15-00214</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1004396</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Manifold Based Optimization for Single-Cell 3D Genome Reconstruction</article-title>
<alt-title alt-title-type="running-head">3D Genome Reconstruction Using MBO</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" equal-contrib="yes" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Paulsen</surname> <given-names>Jonas</given-names></name>
<xref ref-type="aff" rid="aff001"/>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" equal-contrib="yes" xlink:type="simple">
<name name-style="western">
<surname>Gramstad</surname> <given-names>Odin</given-names></name>
<xref ref-type="aff" rid="aff001"/>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Collas</surname> <given-names>Philippe</given-names></name>
<xref ref-type="aff" rid="aff001"/>
</contrib>
</contrib-group>
<aff id="aff001">
<addr-line>Department of Molecular Medicine, Institute of Basic Medical Sciences, Faculty of Medicine, and Norwegian Center for Stem Cell Research, University of Oslo, 0317 Oslo, Norway</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Tanay</surname> <given-names>Amos</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Weizmann Institute of Science, ISRAEL</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con" id="contrib001">
<p>Conceived and designed the experiments: JP OG PC. Performed the experiments: OG. Analyzed the data: JP. Contributed reagents/materials/analysis tools: JP OG. Wrote the paper: JP OG PC.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">jonaspau@medisin.uio.no</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>8</month>
<year>2015</year>
</pub-date>
<pub-date pub-type="epub">
<day>11</day>
<month>8</month>
<year>2015</year>
</pub-date>
<volume>11</volume>
<issue>8</issue>
<elocation-id>e1004396</elocation-id>
<history>
<date date-type="received">
<day>9</day>
<month>2</month>
<year>2015</year>
</date>
<date date-type="accepted">
<day>8</day>
<month>6</month>
<year>2015</year>
</date>
</history>
<permissions>
<copyright-year>2015</copyright-year>
<copyright-holder>Paulsen et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1004396" xlink:type="simple"/>
<abstract>
<p>The three-dimensional (3D) structure of the genome is important for orchestration of gene expression and cell differentiation. While mapping genomes in 3D has for a long time been elusive, recent adaptations of high-throughput sequencing to chromosome conformation capture (3C) techniques, allows for genome-wide structural characterization for the first time. However, reconstruction of "consensus" 3D genomes from 3C-based data is a challenging problem, since the data are aggregated over millions of cells. Recent single-cell adaptations to the 3C-technique, however, allow for non-aggregated structural assessment of genome structure, but data suffer from sparse and noisy interaction sampling. We present a manifold based optimization (MBO) approach for the reconstruction of 3D genome structure from chromosomal contact data. We show that MBO is able to reconstruct 3D structures based on the chromosomal contacts, imposing fewer structural violations than comparable methods. Additionally, MBO is suitable for efficient high-throughput reconstruction of large systems, such as entire genomes, allowing for comparative studies of genomic structure across cell-lines and different species.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>Understanding how the genome is folded in three-dimensional (3D) space is crucial for unravelling the complex regulatory mechanisms underlying the differentiation and proliferation of cells. With recent high-throughput adaptations of chromosome conformation capture in techniques such as single-cell Hi-C, it is now possible to probe 3D information of chromosomes genome-wide. Such experiments, however, only provide sparse information about contacts between regions in the genome. We have developed a tool, based on manifold based optimization (MBO), that reconstructs 3D structures from such contact information. We show that MBO allows for reconstruction of 3D genomes more consistent with the original contact map, and with fewer structural violations compared to other, related methods. Since MBO is also computationally fast, it can be used for high-throughput and large-scale 3D reconstruction of entire genomes.</p>
</abstract>
<funding-group>
<funding-statement>This work was supported by the Research Council of Norway (JP) and the Molecular Life Science Program of the University of Oslo (OG). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="7"/>
<table-count count="0"/>
<page-count count="19"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability" xlink:type="simple">
<meta-name>Data Availability</meta-name>
<meta-value>Data are from Nagano et al. [<xref ref-type="bibr" rid="pcbi.1004396.ref018">18</xref>], and are accessible through GEO Series accession number GSE48262.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Understanding genomes in three dimensions (3D) is a fundamental problem in biology. Recently, the combination of chromosome conformation capture (3C) methods with next-generation sequencing, such as 5C [<xref ref-type="bibr" rid="pcbi.1004396.ref001">1</xref>], Hi-C [<xref ref-type="bibr" rid="pcbi.1004396.ref002">2</xref>], TCC [<xref ref-type="bibr" rid="pcbi.1004396.ref003">3</xref>], and GCC [<xref ref-type="bibr" rid="pcbi.1004396.ref004">4</xref>], has enabled the study of contact frequencies across large genomic regions or entire genomes. These methods consist in crosslinking a large sample of cells followed by restriction enzyme digestion and ligation. Ligated DNA molecules are isolated, and sequenced using massively parallel paired-end sequencing. The end-result is typically a large matrix containing interaction (ligation) frequencies between all regions of the genome under study in the cell population. While such matrices can be visualized and analyzed directly [<xref ref-type="bibr" rid="pcbi.1004396.ref002">2</xref>], determining the 3D structure corresponding to the interaction frequency matrix has been of steady increasing interest in the fields of computational biology and genomics. However, such 3D genome reconstruction is challenging due to the sparse and noisy nature of the data, the fact that the matrices typically contain aggregated interaction frequencies across millions of cells [<xref ref-type="bibr" rid="pcbi.1004396.ref005">5</xref>], and the dynamic nature of chromatin [<xref ref-type="bibr" rid="pcbi.1004396.ref006">6</xref>]. These limitations constitute an obvious problem with respect to reconstructing a “consensus” 3D structure.</p>
<p>Several approaches have been proposed to take into account the dynamic nature of chromatin and the aggregated nature of the data. Baù et al. [<xref ref-type="bibr" rid="pcbi.1004396.ref007">7</xref>] used the Integrative Modelling Platform (IMP) [<xref ref-type="bibr" rid="pcbi.1004396.ref008">8</xref>, <xref ref-type="bibr" rid="pcbi.1004396.ref009">9</xref>] and a Markov Chain Monte Carlo (MCMC) method to simulate a large set of 50,000 independent structural models from 5C data. A subset of the resulting structural ensemble consisting of the 10,000 structures with the best scores was then clustered, such that the different clusters arguably represent the variability of chromatin conformation in the population-averaged data. An MCMC approach for structural ensemble determination from 5C data was also utilized in a study by Rousseau et al. [<xref ref-type="bibr" rid="pcbi.1004396.ref010">10</xref>], leading to a probabilistic model of the interaction frequency data. This allows for sampling from the posterior distribution of structures after a sufficient number of Monte Carlo steps. IMP has also been used to simulate an ensemble of 10,000 structures, that simultaneously encounter the restraints, assuming that the ensemble represents the dynamic nature of chromatin [<xref ref-type="bibr" rid="pcbi.1004396.ref003">3</xref>].</p>
<p>Another class of methods for identifying 3D chromatin structure from chromosomal contact data relies on reconstructing a “consensus” 3D structure from a (possibly incomplete and noisy) Euclidean distance matrix (EDM) consisting of pairwise distances (in 3D) between different regions in the genome. In general, this EDM is not known, but is typically estimated from the interaction frequency matrix. Given an EDM various optimization approaches that fall under the general topic of multidimensional scaling (MDS) (see e.g. [<xref ref-type="bibr" rid="pcbi.1004396.ref011">11</xref>] for an overview) can be used to find an optimal 3D structure. Methods based on MDS are often simpler and can handle larger problems, such as multiple chromosomes or single chromosomes on finer scales, than many of the more complex probability based methods. On the other hand, such methods often ignore the dynamic nature of chromatin and the aggregated nature of the Hi-C data.</p>
<p>The most basic form of MDS is the so-called classical (or metric) MDS, where the optimal coordinate reconstruction from a given EDM is found directly by eigen decomposition of the so-called Gram matrix (see <xref ref-type="sec" rid="sec008">Methods</xref> for details). An early application of classical MDS to determine 3D structure from chromosome contact data was presented by Dekker et al. [<xref ref-type="bibr" rid="pcbi.1004396.ref012">12</xref>]. In general, however, when the EDM has been inferred from interaction frequencies, the MDS approaches consider the reconstruction as a nonlinear and non-convex optimization problem using some iterative optimization method. For example, the EDM has been inferred by assuming simple transformations of genomic distances to Euclidean distances, and an iterative optimization method has been applied to reconstruct the coordinates best corresponding to the EDM [<xref ref-type="bibr" rid="pcbi.1004396.ref013">13</xref>, <xref ref-type="bibr" rid="pcbi.1004396.ref014">14</xref>].</p>
<p>Other optimization methods applied on MDS problems to find coordinates from incomplete distances exploit the rank constraints on the EDM (or corresponding Gram matrix) to find an optimal EDM for the relevant spatial dimension. One successful method in this respect is based on convex semidefinite programming [<xref ref-type="bibr" rid="pcbi.1004396.ref015">15</xref>, <xref ref-type="bibr" rid="pcbi.1004396.ref016">16</xref>], which relaxes the problem to a convex optimization problem. These approaches are applicable to model 3D chromosome configurations [<xref ref-type="bibr" rid="pcbi.1004396.ref017">17</xref>]; however they cannot handle large problems, due to computational limitations.</p>
<p>Technological improvements have also facilitated the reconstruction of 3D genome structures. In particular, adjustments to the Hi-C protocol have been introduced to enable identification of interactions between chromosome regions in single cells [<xref ref-type="bibr" rid="pcbi.1004396.ref018">18</xref>]. Single-cell Hi-C, however, inevitably suffers from sparse sampling of chromosomal interactions and a general lack of information on non-local distances between genomic regions with no mutual contacts. Nonetheless, mapped interactions are found in individual cells, potentially enabling a more robust determination of the underlying 3D structure [<xref ref-type="bibr" rid="pcbi.1004396.ref018">18</xref>].</p>
<p>One way to handle these limitations is to replace missing distances with their ‘shortest-path’ equivalence; that is, considering the existing (observed) entries in the EDM as weighted edges in a graph, and replacing each missing edge weight with the smallest possible sum of weights traversing the graph along the observed edges [<xref ref-type="bibr" rid="pcbi.1004396.ref019">19</xref>]. One drawback of completing the EDM with the shortest-path distances, however, may be that the imputed distances introduce noise which dominates over the more accurate local distances.</p>
<p>An application of single-cell like contact maps coupled with missing-value imputation using the shortest-path method and classical MDS to find 3D coordinates, was recently proposed [<xref ref-type="bibr" rid="pcbi.1004396.ref020">20</xref>]. This approach offers an efficient way of establishing 3D genome structures. However, accuracy may be limited both by the noise introduced by the shortest-path procedure as well as from the limitations of the classical MDS approach.</p>
<p>Another approach proven to be effective on many optimization problems relies on optimization on manifolds. The problem of finding optimal coordinates from an EDM can be formulated as an optimization problem on the manifold of the set of positive semidefinite matrices of fixed rank [<xref ref-type="bibr" rid="pcbi.1004396.ref021">21</xref>, <xref ref-type="bibr" rid="pcbi.1004396.ref022">22</xref>]. The Riemannian quotient geometry of the manifold can be exploited to yield efficient algorithms for the optimization problem [<xref ref-type="bibr" rid="pcbi.1004396.ref023">23</xref>]. However, this strategy has, to our knowledge, not been applied to 3D genome reconstruction in previous studies.</p>
<p>In this paper, we show that the manifold based optimization (MBO) approach can be successfully applied to 3D genome reconstruction. MBO significantly outperforms the simpler methods based on classical MDS in terms of consistency with the original contact map and structural violations, while remaining sufficiently efficient to handle large-scale problems.</p>
<p>Using both simulated and real single-cell Hi-C data, we show that, by combining the shortest-path derived distances with appropriate weights to reduce the influence of noise, MBO can efficiently reconstruct 3D structures consistent with the chromosome contact maps, despite the noisy and sparse nature of the data. Our implementation of the manifold optimization method is based on the Manopt software [<xref ref-type="bibr" rid="pcbi.1004396.ref024">24</xref>] that provides a Matlab interface for optimization on manifolds.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<p>In the following sections, we apply MBO to reconstruct the 3D structure of genomes in two types of settings, and compare to two other popular approaches. First, to evaluate the method’s ability to reconstruct a known 3D structure, we consider a given <italic>a priori</italic> 3D structure, and sample contact frequencies from this structure. Then, we apply the methods to recently published single-cell Hi-C data [<xref ref-type="bibr" rid="pcbi.1004396.ref018">18</xref>], and evaluate the ability of the resulting structural models to reconstruct the original contact maps.</p>
<sec id="sec003">
<title>Manifold based optimization for 3D genome reconstruction</title>
<p>Given a matrix of interaction frequencies, typically from a Hi-C or single-cell Hi-C data set, we seek to reconstruct the corresponding 3D coordinates of the genome structure. In classical MDS (CMDS), this reconstruction is performed by converting the contact frequencies into an EDM (<xref ref-type="fig" rid="pcbi.1004396.g001">Fig 1B</xref>), and uses singular value decomposition for direct coordinate reconstruction. Crucially, such approaches assume that all Euclidean distances in the EDM are of equal importance and equally accurate. This is problematic, since it is known that short genomic distances are sampled much more frequently than long genomic distances. Also, in single-cell Hi-C, contacts are restricted to only two interactions per restriction fragment, for autosomal chromosome pairs, resulting in a large number of missing values.</p>
<fig id="pcbi.1004396.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004396.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Example of generation of distance and weight matrices for the optimization procedure.</title>
<p>A: Original chromosomal contact map (<italic>C</italic><sub><italic>ij</italic></sub>) based on chromosome X from cell 1. A blue dot indicates the presence of an observed interaction in the single-cell Hi-C data set. B: Distance matrix (<italic>D</italic><sub><italic>ij</italic></sub>) consisting of Euclidean distances (in <italic>μ</italic>m) corresponding to the contact map to the left after running the shortest-path algorithm. C: Corresponding weight matrix (<italic>H</italic><sub><italic>ij</italic></sub>), containing numbers between 0 and 1 giving the weight for each of the distances in the Euclidean distance matrix to the left. See the <xref ref-type="sec" rid="sec008">Methods</xref> section for details.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004396.g001"/>
</fig>
<p>In our method, which relies on manifold based optimization (MBO) [<xref ref-type="bibr" rid="pcbi.1004396.ref022">22</xref>], the low-rank property of the EDM, and the resulting redundancy in the distances, are exploited to infer the missing distances. We consider the completion of the EDM while simultaneously allowing for missing distances. We do this by combining the shortest-path completed distances with weights, such that imputed (and typically long) distances are weighted less in the subsequent optimization procedure (<xref ref-type="fig" rid="pcbi.1004396.g001">Fig 1C</xref>). This allows for flexibility in the reconstruction of uncertain regions of the final 3D structure, while enforcing distances in more reliable sections of the structure. The Methods section provides an in-depth description of the full algorithm.</p>
</sec>
<sec id="sec004">
<title>Reconstruction with sparse and noisy distance information</title>
<p>As a first validation of the method, we have considered an <italic>in silico</italic> test case where a known chromosome structure was employed to test the ability of different methods to reconstruct the original structure from incomplete and noisy distance information. Here, MBO is compared to the classical MDS (CMDS) approach recently presented in Lesne et al. [<xref ref-type="bibr" rid="pcbi.1004396.ref020">20</xref>], where the graph shortest-path method is utilized to replace missing distances. This method is generally known as Isomap [<xref ref-type="bibr" rid="pcbi.1004396.ref019">19</xref>], while the adaptation to 3D genome reconstruction was named ShRec3D in Lesne et al. [<xref ref-type="bibr" rid="pcbi.1004396.ref020">20</xref>]. In the following we will refer to this method simply as CMDS. In addition, we present comparison with the ChromSDE method of Zhang et al. [<xref ref-type="bibr" rid="pcbi.1004396.ref017">17</xref>], which is based on semidefinite programming and is significantly more computationally demanding than both the CMDS method and MBO.</p>
<p>The structure considered in this validation is a 3D model of mouse haploid chromosome X generated from single-cell Hi-C data by Nagano et al. [<xref ref-type="bibr" rid="pcbi.1004396.ref018">18</xref>]. The 3D model represents chromosome X using a 50 kilo base pair (kbp) resolution. However, for the current test, the structure was re-sampled at 600 kbp, by taking the average spatial position of groups of bins, this due to the computational limitation of the ChromSDE method. Additionally, we evaluate different levels of noise (<italic>σ</italic>), added to the final contact matrix, as well as different levels of contact scarcity (see <xref ref-type="sec" rid="sec008">Methods</xref> section). The results from these tests are shown in <xref ref-type="fig" rid="pcbi.1004396.g002">Fig 2</xref>. The data shows the structural similarity between original distances and reconstructed distances for the different methods, for different noise levels (<italic>σ</italic>) and ratios of missing distances.</p>
<fig id="pcbi.1004396.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004396.g002</object-id>
<label>Fig 2</label>
<caption>
<title>3D genome reconstruction comparisons for the different algorithms.</title>
<p>(1–Spearman rank correlation) between the original and reconstructed distances in a single structure of chromosome X from [<xref ref-type="bibr" rid="pcbi.1004396.ref018">18</xref>], for the different models (CMDS, ChromSDE and MBO) using different noise levels (<italic>σ</italic>) and ratios of missing distances. <italic>σ</italic> = 0 corresponds to the case where no noise was added to the distance matrix, whereas <italic>σ</italic> = 0.1, 0.5 and 1.0, corresponds to cases where increasing levels of Gaussian noise has been added. On the horizontal axis, different levels of missing distances are shown, spanning from 0 (no missing distances) to 0.95 (95% of distances have been removed).</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004396.g002"/>
</fig>
<p>For the weakly noisy case (<xref ref-type="fig" rid="pcbi.1004396.g002">Fig 2</xref>; <italic>σ</italic> = 0.1) MBO and ChromSDE still reconstruct structures more consistent with the orignal structure than CMDS. For the two cases with higher noise levels, however, MBO performs markedly better, and produces structures more similar to the original, compared to the two other methods (<xref ref-type="fig" rid="pcbi.1004396.g002">Fig 2</xref>; <italic>σ</italic> = 0.5 and 1.0).</p>
<p>In the noiseless case (<italic>σ</italic> = 0) both MBO and ChromSDE are able to reconstruct the original structure exactly as long as a sufficient number of the pair-wise distances are known. This would be expected for ChromSDE, since the semidefinite programming approach is convex in this case. That MBO also recovers the original coordinates exactly is not <italic>a priori</italic> obvious. Naturally, the ratio of distances needed for an exact reconstruction will vary with the size <italic>n</italic> of the problem. In fact, it has been shown that knowledge of <italic>m</italic> ≥ <italic>Cn</italic><sup>6/5</sup> <italic>r</italic> log <italic>n</italic> (for some positive contant <italic>C</italic>) random entries of an <italic>n</italic> × <italic>n</italic> matrix of rank <italic>r</italic> is sufficient for an exact completion of the matrix in most cases [<xref ref-type="bibr" rid="pcbi.1004396.ref025">25</xref>].</p>
<p>We inspected the ability of MBO to reconstruct the considered orignal structure when the missing distances approach this limit. The original structure can be exactly reconstructed with up to ∼ 90% missing data (<xref ref-type="fig" rid="pcbi.1004396.g003">Fig 3A–3C</xref>). With 95% missing data, the structure is still similar to the original structure, with an RMSD of ∼ 610 nm. At levels of missing data above 98%, however, the structure collapses into a compact globule, due to missing interactions between distal bins (<xref ref-type="fig" rid="pcbi.1004396.g003">Fig 3E–3F</xref>).</p>
<fig id="pcbi.1004396.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004396.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Reconstruction of chromosome X at different levels of observed information.</title>
<p>A: Original chromosome X structure from [<xref ref-type="bibr" rid="pcbi.1004396.ref018">18</xref>], resampled at 600 kbp. B-F: Reconstructed 3D structures of chromosome X, with different ratios of observed distance information (20%, 10%, 5%, 2% and 1%, respectively). Information about the RMSD (in nm) and 1 − <italic>ρ</italic>, compared to the original structure (A) is given below each of the structures in A-F. G: Ratio of observed values as a function of the number of bins <italic>n</italic>, i.e. the size of the structure being reconstructed. The structures in B-F are highlighted (orange dots), and compared to an estimated curve showing the minimum ratio of observed values for complete reconstruction ([1-<italic>ρ</italic>]&lt;1e-10; blue curve) or partial reconstruction ([1-<italic>ρ</italic>]&lt;0.1; black curve). All data from [<xref ref-type="bibr" rid="pcbi.1004396.ref018">18</xref>] are shown as gray circles, and the X chromosome data sets from cell 1 and cell 2 are highlighted in green.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004396.g003"/>
</fig>
<p>To inspect this dependency further, we calculated the minimum ratio of observed distance values needed for complete reconstruction ([1-<italic>ρ</italic>]&lt;1e-10) and partial reconstruction ([1-<italic>ρ</italic>]&lt;0.1)), for a range of different sampled structures with varying number of bins (<italic>n</italic>) (see <xref ref-type="fig" rid="pcbi.1004396.g003">Fig 3G</xref>). The required percentage of observed interactions is dependent on the total number of bins in the system considered. We compared the structures from <xref ref-type="fig" rid="pcbi.1004396.g003">Fig 3B–3F</xref> with these estimated curves, and indeed found that the compact globular structures correspond to a ratio of observed values crossing the boundary of partial reconstruction. Furthermore, we compared these curves to the sets of all chromosomes from the single-cell Hi-C data from [<xref ref-type="bibr" rid="pcbi.1004396.ref018">18</xref>]. As can be seen in <xref ref-type="fig" rid="pcbi.1004396.g003">Fig 3G</xref>, the datasets are distributed around the curve of partial reconstruction ([1-<italic>ρ</italic>]&lt;0.1)). This could indicate that the current single cell Hi-C data sets are generally too sparse for high confidence structure reconstruction. Note, however, that the single-cell Hi-C data for chromosome X (cell 1 and cell 2) are between the partial and complete reconstruction curves, and are therefore likely to be among the more reliable data sets for structural reconstruction and method comparisons.</p>
</sec>
<sec id="sec005">
<title>Computation time</title>
<p>Typical computation times for the methods considered in the validation performed above are shown in <xref ref-type="fig" rid="pcbi.1004396.g004">Fig 4</xref>, as a function of the problem size <italic>n</italic> (i.e. <italic>n</italic> is the number of bins in the reconstructed structure). As expected, CMDS (excluding the shortest-path algorithm) is fastest, while ChromSDE is slowest. Note, however, that MBO has the same asymptotic behavior as CMDS for large <italic>n</italic>. Further, when the input EDM has missing values, the shortest-path distances must be calculated before application of CMDS. Hence, for <italic>n</italic> larger than about 500, MBO is actually the fastest of the three methods. In practice, using stringent settings, reconstruction of e.g. chromosome X using MBO at 50kbp resolution takes less than 5 minutes.</p>
<fig id="pcbi.1004396.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004396.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Computational time evaluations for the different algorithms.</title>
<p>Computational time (in seconds) for reconstructing a single chromosome structure using three different algorithms CMDS (dark blue), ChromSDE (green), and the MBO algorithm (red) presented here. For comparison, the shortest path algorithm (light blue) is also shown. The computational time is shown as a function of structure size <italic>n</italic>, i.e. the number of bins in the structure.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004396.g004"/>
</fig>
</sec>
<sec id="sec006">
<title>Full genome reconstruction reveals a dynamic structure of homologous chromosome pairs</title>
<p>Next, we examined the ability of MBO and CMDS to reconstruct contact maps for the full set of chromosomes, based on single-cell Hi-C data [<xref ref-type="bibr" rid="pcbi.1004396.ref018">18</xref>]. We therefore applied MBO and CMDS to all mouse chromosomes individually, for two different single cells (named “cell 1” and “cell 2” in [<xref ref-type="bibr" rid="pcbi.1004396.ref018">18</xref>]), and evaluated the resulting structures. We evaluated and compared the ability of the methods to reconstruct structures with resulting contact maps consistent with the input data, by inspecting the percentage of contacts established in the reconstructed structure that were also present in the original contact map (% correct contacts). Additionally, we evaluated the occurrence of structural inconsistencies in the inferred structures, <italic>i.e</italic>. the percentage of bins being too close to each other (% min distance violation), and the percentage of consecutive bins that are too far away from each other (% connectivity violation). See the <xref ref-type="sec" rid="sec008">Methods</xref> section for details.</p>
<p>We started by considering chromosome X, where only one copy is present in the data. For chromosome X, we found that MBO was able to reconstruct the original contact map of the haploid X nearly completely (both cases &gt; 95% reconstructed). CMDS, on the other hand, was not able to reconstruct the contact matrix of chromosome X at more than ∼50–60% correct contacts (Figs <xref ref-type="fig" rid="pcbi.1004396.g005">5C</xref> and <xref ref-type="fig" rid="pcbi.1004396.g006">6A</xref>). Similar results were found for all 10 individual cells from [<xref ref-type="bibr" rid="pcbi.1004396.ref018">18</xref>] (see <xref ref-type="supplementary-material" rid="pcbi.1004396.s001">S1 Fig</xref>), even though the percentage of correct contacts was closer to 80% for some of the cells with the fewest number of input contacts (cells 9 and 10).</p>
<fig id="pcbi.1004396.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004396.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Contact map reconstruction comparison between MBO and CMDS.</title>
<p>A: Original contact map. Blue dot indicates the presence of a contact in the single-cell Hi-C data set for chromosome X (cell 1). B: Contact map obtained after 3D reconstruction using MBO, based on the contact map (in A) and then re-calculating the contacts. C: Reconstructed contact map, as in B, but using CMDS. D: Reconstructed 3D structure using MBO, corresponding to the contact map in B. E: Reconstructed 3D structure using CMDS, corresponding to the contact map in C. Each bead in D and E has a diameter of 150 nm. Lines represent connected beads with missing bead position information.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004396.g005"/>
</fig>
<fig id="pcbi.1004396.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004396.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Consistency comparison of reconstructed 3D genome models based on MBO and CMDS.</title>
<p>Consistency of the structures obtained from reconstructing all chromosomes for cell 1 (left) and 2 (right) using MBO (blue) and CMDS (red). A: Reconstruction accuracy, given as the percent correct contacts when comparing original and reconstructed contacts maps for different chromosomes. B: Distance violation, given as the occurrence (in percent) of regions in the structures that are below the minimum distance (at 30 nm). C: Connectivity violation, given as the occurrence (in percent) of consecutive regions in the structures that are further away than the maximum distance (200 nm). Blue bars indicate the performance of MBO, while red bars indicate the performance of CMDS.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004396.g006"/>
</fig>
<p>Interestingly, for homologous chromosome pairs, where two chromosome copies are present, reconstruction was not as consistent with the input contact maps as for chromosome X, as only ∼20% of the contacts in the original maps could be reconstructed (<xref ref-type="fig" rid="pcbi.1004396.g006">Fig 6A</xref>). In other words, the presence of two chromosomal copies affects the ability to reconstruct structures that reflect the original contact matrix. This indicates that the structures of the two homologous copies may contain mutually exclusive contacts, making full reconstruction of the contact maps difficult.</p>
<p>We were interested in investigating the effect of having possibly mutually exclusive contact information from two separate chromosome X structures from cell 1 and cell 2. We therefore randomly sampled 50 new datasets consisting of an equal number of contacts from the matrices from these two cells and inspected the ability of MBO to reconstruct structures corresponding to the resulting contact maps. As <xref ref-type="supplementary-material" rid="pcbi.1004396.s002">S2 Fig</xref> shows, the mixed datasets produce structures with a significantly lower percentage of correct contacts, and structures with higher connectivity violations. It should be noted that 3D reconstruction from mixed populations of contact data has no guarantee of reliably estimating a correct structure.</p>
<p>For homologous chromosome pairs, MBO and CMDS performed similarly in terms of percentage of successfully established interactions (<xref ref-type="fig" rid="pcbi.1004396.g006">Fig 6A</xref>). However, when looking at minimum distance violations (chromosomal bins closer than 30 nm, <xref ref-type="fig" rid="pcbi.1004396.g006">Fig 6B</xref>, or violations of the connectivity of consecutive regions (consecutive bins further away than 200 nm, <xref ref-type="fig" rid="pcbi.1004396.g006">Fig 6C</xref>), it is clear that MBO is more successful in positioning the regions in 3D, without imposing obvious violations.</p>
<p>Since MBO, like most optimization strategies for structural reconstruction, is non-convex, optimized structures might depend on the random starting configuration of the optimization. We wanted to study this effect by running 100 independent optimizations of chromosome X using different random initialization of the starting configurations. We then calculated the root-mean-square deviation (RMSD) between the resulting superimposed structures, and found a high degree of similarity between all the 100 chromosome X structures, with an average RMSD of ∼ 322 nm, similar to what was reported in [<xref ref-type="bibr" rid="pcbi.1004396.ref018">18</xref>]. Furthermore, we clustered the RMSD values using hierarchical clustering, and the resulting clusters are visualized in <xref ref-type="fig" rid="pcbi.1004396.g007">Fig 7</xref>. As the figure shows, 4–5 large clusters are found, where the structural similarity within the clusters is clearly higher than between clusters, probably reflecting different local optima in the cost function. By inspecting example structures within each of the clusters, overall the similarity between the structures is high. This indicates that the MBO method gives robust results, with similar structures regardless of starting configuration. Nevertheless, it is advisable to run several independent optimizations, to inspect whether the different local optima in the cost function represents disparate structures.</p>
<fig id="pcbi.1004396.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004396.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Clustering of chromosome X structural models.</title>
<p>The heatmap shows clustered RMSD values between 100 independent optimizations with random initial configurations prior to using MBO on chromosome X. The dendrogram above shows the result of the hierarchical clustering based on the RMSD values. At the bottom, 5 example structures from each cluster are shown.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004396.g007"/>
</fig>
<p>In <xref ref-type="supplementary-material" rid="pcbi.1004396.s003">S3 Fig</xref>, the reconstructed 3D structure from chromosome 1 based on MBO is displayed. We note that, despite the presence of two copies, the reconstructed structure shows few structural violations, with minimum distance violation &lt; 0.01% and connectivity violations below 10%. By performing 100 independent reconstructions, as for chromosome X, (see <xref ref-type="supplementary-material" rid="pcbi.1004396.s004">S4 Fig</xref>), the average RMSD was found to be ∼ 262 nm. However, for chromosome 1, the resulting clusters were not as clear as for chromosome X, possibly due to the two separate copies of chromosome 1.</p>
<p>For comparison reasons, we applied MBO using a weighting scheme where the shortest-path completed matrix was used directly without accompanying weights. In <xref ref-type="supplementary-material" rid="pcbi.1004396.s005">S5 Fig</xref>, the results from this analysis is shown. As the figure shows, using no weights results in a reduced fraction of correct contacts, and additionally, a higher fraction of connectivity violations. The latter point can be explained by considering that all genomic distances are weighted equally when no weights are used. However, when weights are used, as in the MBO method that we present here, short genomic distances will be weighted more, since these will typically contain more contact information. And as a result, connectivity violations will be reduced.</p>
<p>All in all, we have shown that MBO reconstructs 3D structures consistent with the input chromosomal contact data, at the same computational speed as the popular CMDS approach. Additionally, MBO imposes fewer violations relating to the connectivity of the chain, as well as fewer violations from placing regions too close to each other. We have shown that MBO can be used for routine reconstruction of 3D structures from sparsely sampled data, such as single-cell Hi-C.</p>
</sec>
</sec>
<sec id="sec007" sec-type="conclusions">
<title>Discussion</title>
<p>In contrast to methods such as MCMC and molecular dynamics, methods aiming at reconstructing a single consensus 3D structure can be utilized quickly and in a high-throughput fashion. One challenge with such approaches, however, has been the lack of possibilities for handling the sparse and noisy interaction frequency matrices in a flexible and robust way. In this paper, we have shown that combining weights with manifold based optimization (MBO) allows for reconstructing 3D structures of genomes, even when data are sparse and noisy, such as for single-cell Hi-C. We have shown that the weights allow for prioritization of interactions where information about spatial positioning is found, while allowing the remaining regions to be positioned in a consistent fashion. Specifically, by comparing the reconstructed and original contact maps, we have shown that the single copy of chromosome X in male mouse cells can be reconstructed in a fashion consistent with the input data. For homologous chromosome pairs, however, reconstruction was not complete, most likely due to considerable structural difference between the two chromosome copies.</p>
<p>We note that it is also possible to run MBO on ensemble Hi-C datasets, since the weighing scheme is equally applicable in this case. However, the assumption of a consensus structure would in this case probably be less justifiable, due to the known inherent variability in chromosome interactions across cells in a large population.</p>
<p>As chromosome conformation capture data are becoming increasingly available [<xref ref-type="bibr" rid="pcbi.1004396.ref026">26</xref>], quick and robust methods for reconstructing chromosomal 3D structure from chromosomal interaction data, are needed. Additionally, for a complete understanding of the mechanisms involved in gene regulation, cell differentiation, DNA replication and repair, genome organization needs to be studied in its correct dimensions. Efficient and robust 3D genome reconstruction tools such as MBO, are likely to play an increasingly important role for such studies in the future.</p>
</sec>
<sec id="sec008" sec-type="materials|methods">
<title>Methods</title>
<sec id="sec009">
<title>Theoretical background</title>
<p>A fundamental problem relevant for many applications in various disciplines is to find some coordinates, <bold>x</bold><sub><italic>i</italic></sub> ∈ ℝ<sup><italic>r</italic></sup>, <italic>i</italic> = 1, ⋯, <italic>n</italic> in an <italic>r</italic>-dimensional Euclidean space, given some information about the pair-wise distances between the points. The pairwise distances can be represented by the Euclidean distance matrix (EDM), <bold><italic>D</italic></bold> ∈ ℝ<sup><italic>n</italic>×<italic>n</italic></sup>, q
<disp-formula id="pcbi.1004396.e001"><alternatives><graphic id="pcbi.1004396.e001g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004396.e001"/><mml:math id="M1" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mi>D</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>|</mml:mo> <mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:msup><mml:mrow><mml:mo>|</mml:mo> <mml:mo>|</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(1)</label></disp-formula>
which is an <italic>n</italic> × <italic>n</italic> matrix containing the squared distances between the <italic>n</italic> points. By construction the EDM is a symmetric matrix with zero diagonal and non-negative entries satisfying the triangle inequality <inline-formula id="pcbi.1004396.e002"><alternatives><graphic id="pcbi.1004396.e002g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004396.e002"/><mml:math id="M2" display="inline" overflow="scroll"><mml:mrow><mml:msqrt><mml:msub><mml:mi>D</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:msqrt> <mml:mo>≤</mml:mo> <mml:msqrt><mml:msub><mml:mi>D</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:msqrt> <mml:mo>+</mml:mo> <mml:msqrt><mml:msub><mml:mi>D</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:msqrt></mml:mrow></mml:math></alternatives></inline-formula>. Note also that <bold><italic>D</italic></bold> is invariant to arbitrary rotations and translations of the set of coordinates <bold>x</bold><sub><italic>i</italic></sub>.</p>
<p>If the EDM is known exactly (without noise or missing entries), the coordinates <bold>x</bold><sub><italic>i</italic></sub> can be uniquely determined up to arbitrary rotations and translations by introducing the matrix <bold><italic>B</italic></bold> ∈ ℝ<sup><italic>n</italic>×<italic>n</italic></sup>,
<disp-formula id="pcbi.1004396.e003"><alternatives><graphic id="pcbi.1004396.e003g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004396.e003"/><mml:math id="M3" display="block" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">I</mml:mi> <mml:mo>-</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>n</mml:mi></mml:mfrac> <mml:mi mathvariant="bold-italic">e</mml:mi> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">e</mml:mi></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mi mathvariant="bold-italic">D</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">I</mml:mi> <mml:mo>-</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>n</mml:mi></mml:mfrac> <mml:mi mathvariant="bold-italic">e</mml:mi> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">e</mml:mi></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(2)</label></disp-formula>
where <bold><italic>I</italic></bold> ∈ ℝ<sup><italic>n</italic>×<italic>n</italic></sup> is the identity matrix and <bold><italic>e</italic></bold> ∈ ℝ<sup><italic>n</italic></sup> is a vector of all ones. If <bold><italic>D</italic></bold> is a true EDM in an <italic>r</italic> dimensional space, <bold><italic>B</italic></bold> is a symmetric positive semidefinite matrix of rank <italic>r</italic>. That is, <bold><italic>B</italic></bold> has maximum <italic>r</italic> nonzero eigenvalues, and <bold><italic>B</italic></bold> = <bold><italic>V</italic></bold> <bold>Λ</bold> <bold><italic>V</italic></bold><sup><italic>T</italic></sup>, where <bold>Λ</bold> ∈ ℝ<sup><italic>r</italic>×<italic>r</italic></sup> is the diagonal matrix with the <italic>r</italic> nonzero eigenvalues of <bold><italic>B</italic></bold> on the diagonal, and <bold><italic>V</italic></bold> ∈ ℝ<sup><italic>n</italic>×<italic>r</italic></sup> is the matrix with the <italic>r</italic> eigenvectors of <bold><italic>B</italic></bold> as its columns. It can then be shown that <inline-formula id="pcbi.1004396.e004"><alternatives><graphic id="pcbi.1004396.e004g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004396.e004"/><mml:math id="M4" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi> <mml:mo>=</mml:mo> <mml:mi mathvariant="bold-italic">V</mml:mi> <mml:msqrt><mml:mo mathvariant="bold">Λ</mml:mo></mml:msqrt></mml:mrow></mml:math></alternatives></inline-formula> is an <italic>n</italic> × <italic>r</italic> matrix with the coordinates <bold>x</bold><sub><italic>i</italic></sub> as its rows. It is easy to see that <bold><italic>B</italic></bold> = <bold><italic>XX</italic></bold><sup><italic>T</italic></sup>, thus <bold><italic>B</italic></bold> contains the inner product of the coordinates and is often called the Gram matrix for the set of coordinate vectors.</p>
<p>In many practical applications, however, the EDM may contain noisy and missing values. In this case, finding optimal coordinates <bold>x</bold><sub><italic>i</italic></sub> must be treated as an optimization problem of finding coordinates that minimize some cost function based the known distances. If all pair-wise distances between points are known, but not necessarily accurately, one solution to the optimization problem is given in terms of classical multidimensional scaling (CMDS). CMDS basically solves the optimization problem of finding a matrix <inline-formula id="pcbi.1004396.e005"><alternatives><graphic id="pcbi.1004396.e005g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004396.e005"/><mml:math id="M5" display="inline" overflow="scroll"><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">B</mml:mi> <mml:mo accent="true">^</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula> that solves
<disp-formula id="pcbi.1004396.e006"><alternatives><graphic id="pcbi.1004396.e006g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004396.e006"/><mml:math id="M6" display="block" overflow="scroll"><mml:mrow><mml:munder><mml:mo movablelimits="true" form="prefix">min</mml:mo> <mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">B</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>∈</mml:mo> <mml:msubsup><mml:mo>𝓢</mml:mo> <mml:mo>+</mml:mo> <mml:mi>n</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>r</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:munder> <mml:mrow><mml:mo>|</mml:mo> <mml:mo>|</mml:mo></mml:mrow> <mml:mover accent="true"><mml:mi mathvariant="bold-italic">B</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>-</mml:mo> <mml:mi mathvariant="bold-italic">B</mml:mi> <mml:msup><mml:mrow><mml:mo>|</mml:mo> <mml:mo>|</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(3)</label></disp-formula>
where <inline-formula id="pcbi.1004396.e007"><alternatives><graphic id="pcbi.1004396.e007g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004396.e007"/><mml:math id="M7" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mo>𝓢</mml:mo> <mml:mo>+</mml:mo> <mml:mi>n</mml:mi></mml:msubsup> <mml:mo stretchy="false">(</mml:mo> <mml:mi>r</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is the set of positive semidefinite <italic>n</italic> × <italic>n</italic> matrices of rank <italic>r</italic> or less, and <bold><italic>B</italic></bold> is the matrix derived from the EDM by using <xref ref-type="disp-formula" rid="pcbi.1004396.e003">Eq (2)</xref>. This problem has a closed-form solution in terms of the <italic>r</italic> largest eigenvalues and corresponding eigenvectors of <bold><italic>B</italic></bold>, namely <inline-formula id="pcbi.1004396.e008"><alternatives><graphic id="pcbi.1004396.e008g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004396.e008"/><mml:math id="M8" display="inline" overflow="scroll"><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">B</mml:mi> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mi mathvariant="bold-italic">V</mml:mi> <mml:mo mathvariant="bold">Λ</mml:mo> <mml:msup><mml:mi mathvariant="bold-italic">V</mml:mi> <mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, where <bold>Λ</bold> is now the diagonal matrix with the <italic>r</italic> largest eigenvalues of <bold><italic>B</italic></bold> on the diagonal, and <bold><italic>V</italic></bold> is the matrix with the corresponding eigenvectors of <bold><italic>B</italic></bold> as its columns. Consequently, the corresponding coordinates are given by <inline-formula id="pcbi.1004396.e009"><alternatives><graphic id="pcbi.1004396.e009g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004396.e009"/><mml:math id="M9" display="inline" overflow="scroll"><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">X</mml:mi> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mi mathvariant="bold-italic">V</mml:mi> <mml:msqrt><mml:mo mathvariant="bold">Λ</mml:mo></mml:msqrt></mml:mrow></mml:math></alternatives></inline-formula>. Obviously, if <bold><italic>D</italic></bold> is a true EDM for the relevant dimension <italic>r</italic>, there will be exactly <italic>r</italic> nonzero eigenvalues and the procedure reduces to the one described in the previous paragraph, and the coordinates are recovered exactly up to arbitrary rotations and translations. However, if <bold><italic>D</italic></bold> is not close to a true EDM, CMDS is often not robust since the nearest distances are measured through <bold><italic>B</italic></bold> rather than on <bold><italic>D</italic></bold> directly.</p>
</sec>
<sec id="sec010">
<title>Formulation of the manifold based optimization (MBO) approach</title>
<p>A manifold based optimization approach for the completion of Euclidean distance matrices was recently presented in Mishra et al. [<xref ref-type="bibr" rid="pcbi.1004396.ref022">22</xref>]. They solved a minimization problem in the form
<disp-formula id="pcbi.1004396.e010"><alternatives><graphic id="pcbi.1004396.e010g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004396.e010"/><mml:math id="M10" display="block" overflow="scroll"><mml:mrow><mml:munder><mml:mo movablelimits="true" form="prefix">min</mml:mo> <mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">D</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>∈</mml:mo> <mml:msup><mml:mo>𝓔</mml:mo> <mml:mi>n</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>r</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:munder> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:mrow><mml:mo>|</mml:mo> <mml:mo>|</mml:mo> <mml:mi mathvariant="bold-italic">H</mml:mi></mml:mrow> <mml:mo>⊙</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi mathvariant="bold-italic">D</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>-</mml:mo> <mml:mi mathvariant="bold-italic">D</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mrow><mml:mo>|</mml:mo> <mml:mo>|</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(4)</label></disp-formula>
where 𝓔<sup><italic>n</italic></sup>(<italic>r</italic>) is the set of EDMs with embedding dimension <italic>r</italic> or less, <bold><italic>H</italic></bold> is a symmetric weight matrix with binary entries (i.e. a matrix whose elements are either 0 or 1) and where ⊙ denotes the element-wise (Hadamard) product between matrices.</p>
<p>For the application of this approach to the case of the 3D genome reconstruction we have applied a slightly more general framework where the weights are allowed to take any non-negative values (not restricted to 0 and 1). In addition, we choose to minimize the differences between the ordinary Euclidean distances rather than the squared distances used in <xref ref-type="disp-formula" rid="pcbi.1004396.e010">Eq (4)</xref>. This choice is motivated by the fact that the longer genomic distances will be weighted less in the final optimization, and results in improved performance compared to using squared distances (see <xref ref-type="supplementary-material" rid="pcbi.1004396.s006">S6</xref> and <xref ref-type="supplementary-material" rid="pcbi.1004396.s007">S7</xref> Figs). Thus, we consider the minimization problem
<disp-formula id="pcbi.1004396.e011"><alternatives><graphic id="pcbi.1004396.e011g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004396.e011"/><mml:math id="M11" display="block" overflow="scroll"><mml:mrow><mml:munder><mml:mo movablelimits="true" form="prefix">min</mml:mo> <mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">D</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>∈</mml:mo> <mml:msup><mml:mo>𝓔</mml:mo> <mml:mi>n</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>r</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:munder> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:mrow><mml:mo>|</mml:mo> <mml:mo>|</mml:mo> <mml:mi mathvariant="bold-italic">H</mml:mi></mml:mrow> <mml:mo>⊙</mml:mo> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:msqrt><mml:mover accent="true"><mml:mi mathvariant="bold-italic">D</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:msqrt> <mml:mo>-</mml:mo> <mml:msqrt><mml:mi mathvariant="bold-italic">D</mml:mi></mml:msqrt> <mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:msup><mml:mrow><mml:mo>|</mml:mo> <mml:mo>|</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(5)</label></disp-formula>
where square roots here and in the following denote the element-wise square root of the matrix. Following Mishra et al. [<xref ref-type="bibr" rid="pcbi.1004396.ref022">22</xref>], <xref ref-type="disp-formula" rid="pcbi.1004396.e011">Eq (5)</xref> can alternatively be formulated as an optimization problem on the set of positive semidefinite matrices with fixed rank, denoted <inline-formula id="pcbi.1004396.e012"><alternatives><graphic id="pcbi.1004396.e012g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004396.e012"/><mml:math id="M12" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mo>𝓢</mml:mo> <mml:mo>+</mml:mo><mml:mi>n</mml:mi></mml:msubsup> <mml:mo stretchy="false">(</mml:mo> <mml:mi>r</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, by using the mapping from the set <inline-formula id="pcbi.1004396.e013"><alternatives><graphic id="pcbi.1004396.e013g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004396.e013"/><mml:math id="M13" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mo>𝓢</mml:mo> <mml:mo>+</mml:mo><mml:mi>n</mml:mi></mml:msubsup> <mml:mo stretchy="false">(</mml:mo> <mml:mi>r</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> to the set of EDMs 𝓔<sup><italic>n</italic></sup>(<italic>r</italic>) given by
<disp-formula id="pcbi.1004396.e014"><alternatives><graphic id="pcbi.1004396.e014g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004396.e014"/><mml:math id="M14" display="block" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold-italic">D</mml:mi> <mml:mo>=</mml:mo> <mml:mi>κ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">B</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi mathvariant="bold-italic">b</mml:mi> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">e</mml:mi></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:mo>+</mml:mo> <mml:mi mathvariant="bold-italic">e</mml:mi> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:mo>-</mml:mo> <mml:mn>2</mml:mn> <mml:mi mathvariant="bold-italic">B</mml:mi> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(6)</label></disp-formula>
where <bold><italic>b</italic></bold> is the vector with the diagonal entries of <bold><italic>B</italic></bold>, i.e <bold><italic>b</italic></bold> = diag(<bold><italic>B</italic></bold>) = (<bold><italic>B</italic></bold> ⊙ <bold><italic>I</italic></bold>)<bold><italic>e</italic></bold>. As discussed above a positive semidefinite matrix of rank <italic>r</italic> admits the factorization <bold><italic>B</italic></bold> = <bold><italic>XX</italic></bold><sup><italic>T</italic></sup>, where <bold><italic>X</italic></bold> ∈ ℝ<sup><italic>n</italic>×<italic>r</italic></sup> and <italic>rank</italic>(<bold><italic>X</italic></bold>) = <italic>r</italic>. Thus, the cost function that we wish to minimize may be written
<disp-formula id="pcbi.1004396.e015"><alternatives><graphic id="pcbi.1004396.e015g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004396.e015"/><mml:math id="M15" display="block" overflow="scroll"><mml:mrow><mml:mi>f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">X</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:mrow><mml:mo>|</mml:mo> <mml:mo>|</mml:mo> <mml:mi mathvariant="bold-italic">H</mml:mi></mml:mrow> <mml:mo>⊙</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msqrt><mml:mrow><mml:mi>κ</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mi mathvariant="bold-italic">X</mml:mi> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:msqrt> <mml:mo>-</mml:mo> <mml:msqrt><mml:mi mathvariant="bold-italic">D</mml:mi></mml:msqrt> <mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:msup><mml:mrow><mml:mo>|</mml:mo> <mml:mo>|</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(7)</label></disp-formula>
Note that the <bold><italic>X</italic></bold> that minimizes <xref ref-type="disp-formula" rid="pcbi.1004396.e015">Eq (7)</xref> is in fact the coordinates that we wish to find.</p>
<p>To minimize <xref ref-type="disp-formula" rid="pcbi.1004396.e015">Eq (7)</xref> we have implemented a solver for the optimization problem in Matlab using the Manopt toolbox [<xref ref-type="bibr" rid="pcbi.1004396.ref024">24</xref>] using the <monospace>symfixedrankYYfactory(n, r)</monospace> manifold, which provides the geometry for the manifold of <italic>n</italic> × <italic>n</italic> positive semidefinite matrices with rank <italic>r</italic>.</p>
<p>Manopt includes a number of different solvers for the optimization problem. Here we will employ a trust-region solver which, unlike steepest descent, utilizes information about both the gradient and the Hessian of the cost function, and has been shown to have good convergence rates. The gradient of <italic>f</italic>(<bold><italic>X</italic></bold>) can be written
<disp-formula id="pcbi.1004396.e016"><alternatives><graphic id="pcbi.1004396.e016g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004396.e016"/><mml:math id="M16" display="block" overflow="scroll"><mml:mrow><mml:mo form="prefix">grad</mml:mo> <mml:mi>f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">X</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msup><mml:mi>κ</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">H</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>⊙</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">e</mml:mi> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">e</mml:mi></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:mo>-</mml:mo> <mml:mi mathvariant="bold-italic">K</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mi mathvariant="bold-italic">X</mml:mi> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(8)</label></disp-formula>
where <bold><italic>H</italic></bold><sup>(2)</sup> = <bold><italic>H</italic></bold> ⊙ <bold><italic>H</italic></bold> is the matrix with the squared weights and the matrix <bold><italic>K</italic></bold> is the symmetric matrix with zero diagonal and off-diagonal entries given by
<disp-formula id="pcbi.1004396.e017"><alternatives><graphic id="pcbi.1004396.e017g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004396.e017"/><mml:math id="M17" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mi>K</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msqrt><mml:mfrac><mml:msub><mml:mi>D</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mi>κ</mml:mi> <mml:msub><mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">X</mml:mi> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:msqrt> <mml:mo>,</mml:mo> <mml:mspace width="1.em"/><mml:mi>i</mml:mi> <mml:mo>≠</mml:mo> <mml:mi>j</mml:mi> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(9)</label></disp-formula>
<italic>κ</italic>*(<bold><italic>B</italic></bold>) is the adjoint operator of <italic>κ</italic> defined by
<disp-formula id="pcbi.1004396.e018"><alternatives><graphic id="pcbi.1004396.e018g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004396.e018"/><mml:math id="M18" display="block" overflow="scroll"><mml:mrow><mml:msup><mml:mi>κ</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">B</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mn>2</mml:mn> <mml:mrow><mml:mo>(</mml:mo> <mml:mo form="prefix">Diag</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">B</mml:mi> <mml:mi mathvariant="bold-italic">e</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mi mathvariant="bold-italic">B</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(10)</label></disp-formula>
where <italic>Diag</italic>(<bold><italic>v</italic></bold>) = (<bold><italic>vee</italic></bold><sup><italic>T</italic></sup>) ⊙ <bold><italic>I</italic></bold> is the function that returns the <italic>n</italic> × <italic>n</italic> matrix with the <italic>n</italic> × 1 vector <bold><italic>v</italic></bold> on the diagonal and zeros elsewhere.</p>
<p>In addition to the gradient the trust-region algorithm also requires the Hessian in a given direction <bold><italic>U</italic></bold>, Hess <italic>f</italic>(<bold><italic>X</italic></bold>)[<bold><italic>U</italic></bold>]. One can show that the Euclidean Hessian of <italic>f</italic>(<bold><italic>X</italic></bold>) takes the form
<disp-formula id="pcbi.1004396.e019"><alternatives><graphic id="pcbi.1004396.e019g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004396.e019"/><mml:math id="M19" display="block" overflow="scroll"><mml:mrow><mml:mo form="prefix">Hess</mml:mo> <mml:mi>f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">X</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>[</mml:mo> <mml:mi mathvariant="bold-italic">U</mml:mi> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msup><mml:mi>κ</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">H</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>⊙</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">e</mml:mi> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">e</mml:mi></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:mo>-</mml:mo> <mml:mi mathvariant="bold-italic">K</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mi mathvariant="bold-italic">U</mml:mi> <mml:mo>+</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:msup><mml:mi>κ</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">H</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>⊙</mml:mo> <mml:mi mathvariant="bold-italic">G</mml:mi> <mml:mo>⊙</mml:mo> <mml:mi>κ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">X</mml:mi> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">U</mml:mi></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:mo>+</mml:mo> <mml:mi mathvariant="bold-italic">U</mml:mi> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mi mathvariant="bold-italic">X</mml:mi> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(11)</label></disp-formula>
where <bold><italic>G</italic></bold> is the symmetric matrix with zero diagonal and off-diagonal entries
<disp-formula id="pcbi.1004396.e020"><alternatives><graphic id="pcbi.1004396.e020g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004396.e020"/><mml:math id="M20" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mi>G</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msqrt><mml:mfrac><mml:msub><mml:mi>D</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>κ</mml:mi> <mml:msub><mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">X</mml:mi> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>3</mml:mn></mml:msup></mml:mfrac></mml:msqrt> <mml:mo>,</mml:mo> <mml:mspace width="1.em"/><mml:mi>i</mml:mi> <mml:mo>≠</mml:mo> <mml:mi>j</mml:mi> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(12)</label></disp-formula>
The conversion from the Euclidean to the Riemannian Hessian, needed for the optimization algorithm, is performed internally in Manopt. For additional details about the manifold based algorithm, see [<xref ref-type="bibr" rid="pcbi.1004396.ref022">22</xref>, <xref ref-type="bibr" rid="pcbi.1004396.ref024">24</xref>].</p>
</sec>
<sec id="sec011">
<title>Reconstructing a known 3D structure</title>
<p>From the known 3D structure. a true EDM was constructed containing the pair-wise squared distances between all the 600 kbp sized bins. To model the uncertainty and possible sparsity of distance information inferred from chromosomal contact data such as Hi-C, the original distance matrix was contaminated by adding random noise as well as randomly removing a given percentage of the distances. That is, from the original Euclidean distance matrix <bold><italic>D</italic></bold> (containing the squared pair-wise distances), a noisy and incomplete set of distances <italic>δ</italic><sub><italic>ij</italic></sub> is generated as
<disp-formula id="pcbi.1004396.e021"><alternatives><graphic id="pcbi.1004396.e021g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004396.e021"/><mml:math id="M21" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mi>δ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>δ</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msqrt><mml:msub><mml:mi>D</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:msqrt> <mml:mrow><mml:mo>|</mml:mo> <mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:mi>σ</mml:mi> <mml:msub><mml:mi>ϵ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>|</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mspace width="0.277778em"/><mml:mtext>for</mml:mtext> <mml:mspace width="4.pt"/><mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi> <mml:mo>)</mml:mo> <mml:mo>∈</mml:mo> <mml:mo>𝓝</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(13)</label></disp-formula>
where <italic>ϵ</italic><sub><italic>ij</italic></sub> are sampled randomly from a standard normal distribution and where 𝓝 is the set of entries (<italic>i</italic>, <italic>j</italic>) for which the distances are available.</p>
<p>Tests were run for different values for the noise level <italic>σ</italic> and ratio of missing distances (size of 𝓝).</p>
</sec>
<sec id="sec012">
<title>Inferring 3D structure from single cell Hi-C data</title>
<p>The raw results from a single-cell Hi-C experiment typically lists a number of observed contacts between specific genome positions. From the raw results, the contacts were aggregated into equally spaced bins along the chromosomes. For the results presented here a bin size of 50 kbp was used. Then all observed contacts were assigned to their corresponding bins. In the case that multiple contacts fell into the same bin, the duplicate entries were ignored so that a binary contact matrix <italic>C</italic><sub><italic>ij</italic></sub> was obtained for each chromosome. Hence, <italic>C</italic><sub><italic>ij</italic></sub> = 1 represents a Hi-C contact between bins <italic>i</italic> and <italic>j</italic>, while <italic>C</italic><sub><italic>ij</italic></sub> = 0 represents the absence of a contact.</p>
<p>To use the MBO approach, the binary contact map must be converted into a distance matrix <italic>D</italic><sub><italic>ij</italic></sub>. First a target distance <italic>d</italic><sub><italic>c</italic></sub> is assigned to all bins with an observed Hi-C contact. Secondly, the connectivity along the chromosome is taken into account by assigning a distance <italic>d</italic><sub><italic>n</italic></sub> to neighboring bins. Hence, as a first step the following matrix is constructed
<disp-formula id="pcbi.1004396.e022"><alternatives><graphic id="pcbi.1004396.e022g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004396.e022"/><mml:math id="M22" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mi>D</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mo>{</mml:mo> <mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>d</mml:mi> <mml:mi>c</mml:mi></mml:msub></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mspace width="4.pt"/><mml:mtext>if</mml:mtext> <mml:mspace width="4.pt"/><mml:msub><mml:mi>C</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:msub><mml:mi>d</mml:mi> <mml:mi>n</mml:mi></mml:msub></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mspace width="4.pt"/><mml:mtext>if</mml:mtext> <mml:mspace width="4.pt"/><mml:msub><mml:mi>C</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mspace width="4.pt"/><mml:mtext>and</mml:mtext> <mml:mspace width="4.pt"/><mml:mrow><mml:mo>|</mml:mo> <mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mi>j</mml:mi> <mml:mo>|</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mspace width="4.pt"/><mml:mtext>elsewhere</mml:mtext> <mml:mspace width="4.pt"/><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable> <mml:mo/></mml:mrow></mml:math></alternatives> <label>(14)</label></disp-formula></p>
<p>Since the MBO method works also for incomplete distance matrices, the optimization could in principle be run directly on <xref ref-type="disp-formula" rid="pcbi.1004396.e022">Eq (14)</xref>, letting the weights <italic>H</italic><sub><italic>ij</italic></sub> be nonzero only for the nonzero entries of <italic>D</italic><sub><italic>ij</italic></sub>. However, since only the local distances (contacts and neighboring bins) are known, a direct optimization of <xref ref-type="disp-formula" rid="pcbi.1004396.e022">Eq (14)</xref> would lead to a very compact structure where all bins are located close together. Hence, for a consistent 3D structure some information about the large distances must be included. One possible method is to assign large distances and small weights to the non-interacting bins (see e.g. [<xref ref-type="bibr" rid="pcbi.1004396.ref027">27</xref>, <xref ref-type="bibr" rid="pcbi.1004396.ref028">28</xref>]). The large distances will then act as a repulsive force and counteract the formation of a compact state. Another possibility is to apply the shortest-path method to fill the missing entries of the distance matrix. In this way the missing distances may take more realistic values since they are deduced directly from the known distances. However, these shortest path-distances still introduce noise that may seriously influence the result. Motivated by the fact that the shortest-path derived distances are more noisy than the ‘original’ contact-distances that we wish to satisfy, we have adopted a slightly more flexible approach where we combine the shortest-path completed matrix with weights so that the shortest-path inferred distances are weighted less in the optimization procedure.</p>
<p>Thus, we first replace the zero entries in <italic>D</italic><sub><italic>ij</italic></sub> with the shortest-path derived distances. We then introduce the weight matrix <italic>H</italic><sub><italic>ij</italic></sub> whose elements are chosen to be inverse proportional to the number of edges traversed in the shortest path, i.e <inline-formula id="pcbi.1004396.e023"><alternatives><graphic id="pcbi.1004396.e023g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004396.e023"/><mml:math id="M23" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>H</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>n</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mrow><mml:mo>−</mml:mo> <mml:mi>q</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> where <italic>n</italic><sub><italic>ij</italic></sub> is the number of edges that is needed to connect node <italic>i</italic> and <italic>j</italic>. That is, the original distances will have weights equal to one, while the shortest-path derived distances will have smaller weights. The value <italic>q</italic> is a factor that specifies the relative magnitude of the weights for the non-observed edges compared to the observed ones, and was found by maximizing the percent correct contacts and minimizing distances violations (see <xref ref-type="supplementary-material" rid="pcbi.1004396.s008">S8A Fig</xref> for an example). In our case this value was always found to be between 1 and 3 (see <xref ref-type="supplementary-material" rid="pcbi.1004396.s009">S1 File</xref>), but in theory, for other data, the optimal value may be outside this range. Here, we have used a simple optimization scheme by trying out a range of values for <italic>q</italic>. This is likely sufficient in most cases, since the effect of using different values for <italic>q</italic> on the final structures is not very large. For example, on chromosome X for cell 1, using a range of values of q between 0 and 3, the structures all had RMSD&lt;300nm compared to the structure with optimized <italic>q</italic> (see <xref ref-type="supplementary-material" rid="pcbi.1004396.s008">S8B Fig</xref>).</p>
<p>MBO is initialized by starting with a random initial configuration (a random point on the manifold), and convergence is considered obtained if the cost function or the norm of the gradient drops below a small value (1e-20 and 1e-08, respectively). After a successful convergence of the optimization algorithm the resulting coordinates <italic>x</italic><sub><italic>i</italic></sub> are scaled to best agree with the original contact map. That is, we search for a scaling constant <italic>c</italic><sub><italic>l</italic></sub> so that <inline-formula id="pcbi.1004396.e024"><alternatives><graphic id="pcbi.1004396.e024g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004396.e024"/><mml:math id="M24" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover><mml:mi>D</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mo stretchy="false">∣</mml:mo> <mml:mo stretchy="false">∣</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:msub><mml:mi>x</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>−</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:msub><mml:mi>x</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo stretchy="false">∣</mml:mo> <mml:mo stretchy="false">∣</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> contains exactly <italic>n</italic><sub><italic>c</italic></sub> pair-wise distances smaller than the contact distance <italic>d</italic><sub><italic>c</italic></sub>, where <italic>n</italic><sub><italic>c</italic></sub> is the number of contacts in the original contact matrix. Note that in the case of perfect agreement, the contact matrix derived from the coordinates <italic>c</italic><sub><italic>l</italic></sub> <italic>x</italic><sub><italic>i</italic></sub> will be identical to the original contact matrix, since the number of entries are the same. The optimal value for <italic>c</italic><sub><italic>l</italic></sub> is found by a simple binary search method.</p>
<p>The percent correct contacts was calculated by direct comparisons of original and reconstructed contact matrices. Minimum distance violations were defined as the percent fraction of pairwise distance below 30 nanometers. Connectivity violations were defined as the percent fraction of neighboring (connected) bins with a distance above 200 nanometers. In <xref ref-type="disp-formula" rid="pcbi.1004396.e022">Eq 14</xref>, <italic>d</italic><sub><italic>c</italic></sub> = 60nm, <italic>d</italic><sub><italic>n</italic></sub> = 120nm.</p>
</sec>
<sec id="sec013">
<title>Implementation</title>
<p>MBO is implemented in Matlab, and is based on the Manopt software [<xref ref-type="bibr" rid="pcbi.1004396.ref024">24</xref>]. Code is freely available at <ext-link ext-link-type="uri" xlink:type="simple" xlink:href="http://folk.uio.no/jonaspau/mbo/">http://folk.uio.no/jonaspau/mbo/</ext-link>.</p>
</sec>
</sec>
<sec id="sec014">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1004396.s001" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004396.s001" mimetype="application/pdf" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Consistency comparison of reconstructed 3D genome models based on MBO and CMDS for ten single cells.</title>
<p>Consistency of the structures obtained from reconstructing all chromosomes for cell 1–10 using MBO (blue) and CMDS (red). Top panel: Reconstruction accuracy, given as the percent correct contacts when comparing original and reconstructed contacts maps for different chromosomes. Middle panel: Distance violation, given as the occurrence (in percent) of regions in the structures that are below the minimum distance (at 30 nm). Bottom panel: Connectivity violation, given as the occurrence (in percent) of consecutive regions in the structures that are further away than the maximum distance (200 nm). Blue bars indicate the performance of MBO, while red bars indicate the performance of CMDS.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004396.s002" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004396.s002" mimetype="application/pdf" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Consistency of reconstructed chromosome X 3D models, based on MBO, using data from a mixed population of cell 1 and cell 2.</title>
<p>Left panel: Reconstruction accuracy, given as the percent correct contacts when comparing original and reconstructed contacts maps. Right panel: Connectivity violation, given as the occurrence (in percent) of consecutive regions in the structures that are further away than the maximum distance (200 nm). Red dots corresponds to a 3D reconstruction of chromosome X from cell 1, and blue dots corresponds to a 3D reconstruction of chromosome X from cell 2. The purple circles correspond to optimizations from 50 independent randomly sampled data sets with equal amounts of contacts from cell 1 and cell 2. The thick purple line indicates the median, while the thin purple lines indicates the 25th and 75th percentiles.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004396.s003" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004396.s003" mimetype="application/pdf" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Structural model of chromosome 1.</title>
<p>A: Reconstructed 3D structure using MBO, where each bin is represented as a bead with a diameter of 150 nm. B: Same reconstructed 3D structure as in A, but where each bin is connected by a line to show the trace of the chromosomal structure. C: Original contact map. Blue dot indicates the presence of a contact in the single-cell Hi-C data set for chromosome 1 (cell 1). D: Contact map obtained after 3D reconstruction using MBO and then re-calculating the contacts.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004396.s004" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004396.s004" mimetype="application/pdf" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>Clustering of chromosome 1 structural models.</title>
<p>The heatmap shows clustered RMSD values between 100 independent optimizations with random initial configurations prior to using MBO on chromosome 1. The dendrogram above shows the result of the hierarchical clustering based on the RMSD values. At the bottom, 5 example structures are shown.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004396.s005" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004396.s005" mimetype="application/pdf" xlink:type="simple">
<label>S5 Fig</label>
<caption>
<title>Consistency comparison of reconstructed 3D genome models based on MBO and CMDS, when no weights are used during the optimization.</title>
<p>Consistency of the structures obtained from reconstructing all chromosomes for cell 1 (left) and 2 (right) using MBO without weights (blue) and CMDS (red). Top panels: Reconstruction accuracy, given as the percent correct contacts when comparing original and reconstructed contact maps for different chromosomes. Middel panels: Distance violation, given as the occurrence (in percent) of regions in the structures that are below the minimum distance (at 30 nm). Bottom panels: Connectivity violation, given as the occurrence (in percent) of consecutive regions in the structures that are further away than the maximum distance (200 nm).</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004396.s006" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004396.s006" mimetype="application/pdf" xlink:type="simple">
<label>S6 Fig</label>
<caption>
<title>Consistency comparison of reconstructed 3D genome models based on MBO and MBO-squared.</title>
<p>Consistency of the structures obtained from reconstructing all chromosomes for cell 1 using MBO (blue) and MBO with squared distances in <xref ref-type="disp-formula" rid="pcbi.1004396.e010">Eq (4)</xref> (MBO-squared; red). A: Reconstruction accuracy, given as the percent correct contacts when comparing original and reconstructed contact maps for different chromosomes. B: Distance violation, given as the occurrence (in percent) of regions in the structures that are below the minimum distance (at 30 nm). C: Connectivity violation, given as the occurrence (in percent) of consecutive regions in the structures that are further away than the maximum distance (200 nm). Blue bars indicate the performance of MBO, while red bars indicate the performance of CMDS. Panels D-F show the same statistics as for A-C, respectively, but when no weights are used during the optimization (essentially setting <italic>q</italic> = 0 in the weight matrix).</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004396.s007" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004396.s007" mimetype="application/pdf" xlink:type="simple">
<label>S7 Fig</label>
<caption>
<title>3D genome reconstruction comparisons for MBO with squared distance terms.</title>
<p>Same as <xref ref-type="fig" rid="pcbi.1004396.g002">Fig 2</xref>, but also showing the performance of MBO using squared distances in <xref ref-type="disp-formula" rid="pcbi.1004396.e010">Eq (4)</xref> (MBO-squared, in cyan).</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004396.s008" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004396.s008" mimetype="application/pdf" xlink:type="simple">
<label>S8 Fig</label>
<caption>
<title>Example of procedure to find the optimal value for <italic>q</italic>.</title>
<p>A: To find the optimal <italic>q</italic> for a given reconstruction with MBO, we try out a range of values (<italic>e.g</italic>. 0–3). The optimal <italic>q</italic> is given by the maximum value of the (% correct contacts)-(% min distance violation) (red circle). B: RMSD values (nm) for the same structures as in A, compared to the optimal structure (red circle).</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004396.s009" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004396.s009" mimetype="text/plain" xlink:type="simple">
<label>S1 File</label>
<caption>
<title>Tab-delimited file containing optimized values of <italic>q</italic> used for final 3D reconstruction of chromosomes from cell 1.</title>
<p>Column 1: chromosome, column 2: optimized <italic>q</italic> for the MBO method, column 3: optimized <italic>q</italic> for the MBO method using squared distances in <xref ref-type="disp-formula" rid="pcbi.1004396.e010">Eq (4)</xref> (MBO-squared).</p>
<p>(TXT)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="pcbi.1004396.ref001">
<label>1</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Dostie</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Richmond</surname> <given-names>TA</given-names></name>, <name name-style="western"><surname>Arnaout</surname> <given-names>RA</given-names></name>, <name name-style="western"><surname>Selzer</surname> <given-names>RR</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>WL</given-names></name>, <name name-style="western"><surname>Honan</surname> <given-names>TA</given-names></name>, <etal>et al</etal>. <article-title>Chromosome Conformation Capture Carbon Copy (5C): a massively parallel solution for mapping interactions between genomic elements</article-title>. <source>Genome Res</source>. <year>2006</year>;<volume>16</volume>(<issue>10</issue>):<fpage>1299</fpage>–<lpage>1309</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/gr.5571506" xlink:type="simple">10.1101/gr.5571506</ext-link></comment> <object-id pub-id-type="pmid">16954542</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004396.ref002">
<label>2</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Lieberman-Aiden</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>van Berkum</surname> <given-names>NL</given-names></name>, <name name-style="western"><surname>Williams</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Imakaev</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Ragoczy</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Telling</surname> <given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Comprehensive mapping of long-range interactions reveals folding principles of the human genome</article-title>. <source>Science</source>. <year>2009</year>;<volume>326</volume>(<issue>5950</issue>):<fpage>289</fpage>–<lpage>293</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1181369" xlink:type="simple">10.1126/science.1181369</ext-link></comment> <object-id pub-id-type="pmid">19815776</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004396.ref003">
<label>3</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Kalhor</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Tjong</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Jayathilaka</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Alber</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>L</given-names></name>. <article-title>Genome architectures revealed by tethered chromosome conformation capture and population-based modeling</article-title>. <source>Nat Biotechnol</source>. <year>2012</year>;<volume>30</volume>(<issue>1</issue>):<fpage>90</fpage>–<lpage>98</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004396.ref004">
<label>4</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Rodley</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Bertels</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Jones</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>O’sullivan</surname> <given-names>J</given-names></name>. <article-title>Global identification of yeast chromosome interactions using Genome conformation capture</article-title>. <source>Fungal Genet Biol</source>. <year>2009</year>;<volume>46</volume>(<issue>11</issue>):<fpage>879</fpage>–<lpage>886</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.fgb.2009.07.006" xlink:type="simple">10.1016/j.fgb.2009.07.006</ext-link></comment> <object-id pub-id-type="pmid">19628047</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004396.ref005">
<label>5</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>O’Sullivan</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Hendy</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Pichugina</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Wake</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Langowski</surname> <given-names>J</given-names></name>. <article-title>The statistical-mechanics of chromosome conformation capture</article-title>. <source>Nucleus</source>. <year>2013</year>;<volume>4</volume>(<issue>5</issue>):<fpage>390</fpage>–<lpage>398</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.4161/nucl.26513" xlink:type="simple">10.4161/nucl.26513</ext-link></comment> <object-id pub-id-type="pmid">24051548</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004396.ref006">
<label>6</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Woodcock</surname> <given-names>CL</given-names></name>, <name name-style="western"><surname>Ghosh</surname> <given-names>RP</given-names></name>. <article-title>Chromatin higher-order structure and dynamics</article-title>. <source>Cold Spring Harb Perspect Biol</source>. <year>2010</year>;<volume>2</volume>(<issue>5</issue>):<fpage>a000596</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/cshperspect.a000596" xlink:type="simple">10.1101/cshperspect.a000596</ext-link></comment> <object-id pub-id-type="pmid">20452954</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004396.ref007">
<label>7</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Baù</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Sanyal</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Lajoie</surname> <given-names>BR</given-names></name>, <name name-style="western"><surname>Capriotti</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Byron</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Lawrence</surname> <given-names>JB</given-names></name>, <etal>et al</etal>. <article-title>The three-dimensional folding of the <italic>α</italic>-globin gene domain reveals formation of chromatin globules</article-title>. <source>Nat Struct Mol Biol</source>. <year>2011</year>;<volume>18</volume>(<issue>1</issue>):<fpage>107</fpage>–<lpage>114</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nsmb.1936" xlink:type="simple">10.1038/nsmb.1936</ext-link></comment> <object-id pub-id-type="pmid">21131981</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004396.ref008">
<label>8</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Russel</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Lasker</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Webb</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Velázquez-Muriel</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Tjioe</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Schneidman-Duhovny</surname> <given-names>D</given-names></name>, <etal>et al</etal>. <article-title>Putting the pieces together: integrative modeling platform software for structure determination of macromolecular assemblies</article-title>. <source>PLoS Biol</source>. <year>2012</year>;<volume>10</volume>(<issue>1</issue>):<fpage>e1001244</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pbio.1001244" xlink:type="simple">10.1371/journal.pbio.1001244</ext-link></comment> <object-id pub-id-type="pmid">22272186</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004396.ref009">
<label>9</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Baù</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Marti-Renom</surname> <given-names>MA</given-names></name>. <article-title>Genome structure determination via 3C-based data integration by the Integrative Modeling Platform</article-title>. <source>Methods</source>. <year>2012</year>;<volume>58</volume>(<issue>3</issue>):<fpage>300</fpage>–<lpage>306</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.ymeth.2012.04.004" xlink:type="simple">10.1016/j.ymeth.2012.04.004</ext-link></comment> <object-id pub-id-type="pmid">22522224</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004396.ref010">
<label>10</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Rousseau</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Fraser</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Ferraiuolo</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Dostie</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Blanchette</surname> <given-names>M</given-names></name>. <article-title>Three-dimensional modeling of chromatin structure from interaction frequency data using Markov chain Monte Carlo sampling</article-title>. <source>BMC Bioinformatics</source>. <year>2011</year>;<volume>12</volume>(<issue>1</issue>):<fpage>414</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2105-12-414" xlink:type="simple">10.1186/1471-2105-12-414</ext-link></comment> <object-id pub-id-type="pmid">22026390</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004396.ref011">
<label>11</label>
<mixed-citation xlink:type="simple" publication-type="book">
<name name-style="western"><surname>Borg</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Groenen</surname> <given-names>P</given-names></name>. <source>Modern Multidimensional Scaling: Theory and Applications</source>. <publisher-loc>New York, NY</publisher-loc>: <publisher-name>Springer</publisher-name>; <year>2005</year>.</mixed-citation>
</ref>
<ref id="pcbi.1004396.ref012">
<label>12</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Dekker</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Rippe</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Dekker</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Kleckner</surname> <given-names>N</given-names></name>. <article-title>Capturing chromosome conformation</article-title>. <source>Science</source>. <year>2002</year>;<volume>295</volume>(<issue>5558</issue>):<fpage>1306</fpage>–<lpage>1311</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1067799" xlink:type="simple">10.1126/science.1067799</ext-link></comment> <object-id pub-id-type="pmid">11847345</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004396.ref013">
<label>13</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Duan</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Andronescu</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Schutz</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>McIlwain</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>YJ</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>C</given-names></name>, <etal>et al</etal>. <article-title>A three-dimensional model of the yeast genome</article-title>. <source>Nature</source>. <year>2010</year>;<volume>465</volume>(<issue>7296</issue>):<fpage>363</fpage>–<lpage>367</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature08973" xlink:type="simple">10.1038/nature08973</ext-link></comment> <object-id pub-id-type="pmid">20436457</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004396.ref014">
<label>14</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Ay</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Bunnik</surname> <given-names>EM</given-names></name>, <name name-style="western"><surname>Varoquaux</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Bol</surname> <given-names>SM</given-names></name>, <name name-style="western"><surname>Prudhomme</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Vert</surname> <given-names>JP</given-names></name>, <etal>et al</etal>. <article-title>Three-dimensional modeling of the P. falciparum genome during the erythrocytic cycle reveals a strong connection between genome architecture and gene expression</article-title>. <source>Genome Res</source>. <year>2014</year>;<volume>24</volume>(<issue>6</issue>):<fpage>974</fpage>–<lpage>988</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/gr.169417.113" xlink:type="simple">10.1101/gr.169417.113</ext-link></comment> <object-id pub-id-type="pmid">24671853</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004396.ref015">
<label>15</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Alfakih</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Khandani</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Wolkowicz</surname> <given-names>H</given-names></name>. <article-title>Solving Euclidean Distance Matrix Completion Problems Via Semidefinite Programming</article-title>. <source>Comput Optim Appl</source>. <year>1999</year>; <volume>12</volume>(<issue>1–3</issue>):<fpage>13</fpage>–<lpage>30</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/978-1-4615-5197-3_2" xlink:type="simple">10.1007/978-1-4615-5197-3_2</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004396.ref016">
<label>16</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Biswas</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Lian</surname> <given-names>TC</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>TC</given-names></name>, <name name-style="western"><surname>Ye</surname> <given-names>Y</given-names></name>. <article-title>Semidefinite programming based algorithms for sensor network localization</article-title>. <source>IEEE Trans Autom Sci Eng</source>. <year>2006</year>;<volume>3</volume>(<issue>4</issue>):<fpage>360</fpage>–<lpage>371</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/TASE.2006.877401" xlink:type="simple">10.1109/TASE.2006.877401</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004396.ref017">
<label>17</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Zhang</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Toh</surname> <given-names>KC</given-names></name>, <name name-style="western"><surname>Sung</surname> <given-names>WK</given-names></name>. <article-title>3D Chromosome Modeling with Semi-Definite Programming and Hi-C Data</article-title>. <source>J Comput Biol</source>. <year>2013</year>;<volume>20</volume>(<issue>11</issue>):<fpage>831</fpage>–<lpage>846</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1089/cmb.2013.0076" xlink:type="simple">10.1089/cmb.2013.0076</ext-link></comment> <object-id pub-id-type="pmid">24195706</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004396.ref018">
<label>18</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Nagano</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Lubling</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Stevens</surname> <given-names>TJ</given-names></name>, <name name-style="western"><surname>Schoenfelder</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Yaffe</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Dean</surname> <given-names>W</given-names></name>, <etal>et al</etal>. <article-title>Single-cell Hi-C reveals cell-to-cell variability in chromosome structure</article-title>. <source>Nature</source>. <year>2013</year>;<volume>502</volume>(<issue>7469</issue>):<fpage>59</fpage>–<lpage>64</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature12593" xlink:type="simple">10.1038/nature12593</ext-link></comment> <object-id pub-id-type="pmid">24067610</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004396.ref019">
<label>19</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Tenenbaum</surname> <given-names>JB</given-names></name>, <name name-style="western"><surname>Silva</surname> <given-names>Vd</given-names></name>, <name name-style="western"><surname>Langford</surname> <given-names>JC</given-names></name>. <article-title>A Global Geometric Framework for Nonlinear Dimensionality Reduction</article-title>. <source>Science</source>. <year>2000</year>;<volume>290</volume>(<issue>5500</issue>):<fpage>2319</fpage>–<lpage>2323</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.290.5500.2319" xlink:type="simple">10.1126/science.290.5500.2319</ext-link></comment> <object-id pub-id-type="pmid">11125149</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004396.ref020">
<label>20</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Lesne</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Riposo</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Roger</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Cournac</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Mozziconacci</surname> <given-names>J</given-names></name>. <article-title>3D genome reconstruction from chromosomal contacts</article-title>. <source>Nat Meth</source>. <year>2014</year>;<volume>11</volume>:<fpage>1141</fpage>–<lpage>1143</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.3104" xlink:type="simple">10.1038/nmeth.3104</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004396.ref021">
<label>21</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Journée</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Bach</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Absil</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Sepulchre</surname> <given-names>R</given-names></name>. <article-title>Low-Rank Optimization on the Cone of Positive Semidefinite Matrices</article-title>. <source>SIAM J Optim</source>. <year>2010</year>;<volume>20</volume>(<issue>5</issue>):<fpage>2327</fpage>–<lpage>2351</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1137/080731359" xlink:type="simple">10.1137/080731359</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004396.ref022">
<label>22</label>
<mixed-citation xlink:type="simple" publication-type="other">Mishra B, Meyer G, Sepulchre R. Low-rank optimization for distance matrix completion. In: Proceedings of the 50th IEEE Conference on Decision and Control; 2011. p. 4455–4460.</mixed-citation>
</ref>
<ref id="pcbi.1004396.ref023">
<label>23</label>
<mixed-citation xlink:type="simple" publication-type="book">
<name name-style="western"><surname>Absil</surname> <given-names>PA</given-names></name>, <name name-style="western"><surname>Mahony</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Sepulchre</surname> <given-names>R</given-names></name>. <source>Optimization Algorithms on Matrix Manifolds</source>. <publisher-loc>Princeton, NJ</publisher-loc>: <publisher-name>Princeton University Press</publisher-name>; <year>2008</year>.</mixed-citation>
</ref>
<ref id="pcbi.1004396.ref024">
<label>24</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Boumal</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Mishra</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Absil</surname> <given-names>PA</given-names></name>, <name name-style="western"><surname>Sepulchre</surname> <given-names>R</given-names></name>. <article-title>Manopt, a Matlab Toolbox for Optimization on Manifolds</article-title>. <source>J Mach Learn Res</source>. <year>2014</year>;<volume>15</volume>:<fpage>1455</fpage>–<lpage>1459</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004396.ref025">
<label>25</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Candès</surname> <given-names>EJ</given-names></name>, <name name-style="western"><surname>Recht</surname> <given-names>B</given-names></name>. <article-title>Exact Matrix Completion via Convex Optimization</article-title>. <source>Found Comut Math</source>. <year>2009</year>;<volume>9</volume>(<issue>6</issue>):<fpage>717</fpage>–<lpage>772</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s10208-009-9045-5" xlink:type="simple">10.1007/s10208-009-9045-5</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004396.ref026">
<label>26</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Rao</surname> <given-names>SS</given-names></name>, <name name-style="western"><surname>Huntley</surname> <given-names>MH</given-names></name>, <name name-style="western"><surname>Durand</surname> <given-names>NC</given-names></name>, <name name-style="western"><surname>Stamenova</surname> <given-names>EK</given-names></name>, <name name-style="western"><surname>Bochkov</surname> <given-names>ID</given-names></name>, <name name-style="western"><surname>Robinson</surname> <given-names>JT</given-names></name>, <etal>et al</etal>. <article-title>A 3D Map of the Human Genome at Kilobase Resolution Reveals Principles of Chromatin Looping</article-title>. <source>Cell</source>. <year>2014</year>;<volume>159</volume>(<issue>7</issue>):<fpage>1665</fpage>–<lpage>1680</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.cell.2014.11.021" xlink:type="simple">10.1016/j.cell.2014.11.021</ext-link></comment> <object-id pub-id-type="pmid">25497547</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004396.ref027">
<label>27</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Chen</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Buja</surname> <given-names>A</given-names></name>. <article-title>Local Multidimensional Scaling for Nonlinear Dimension Reduction, Graph Drawing, and Proximity Analysis</article-title>. <source>J Am Stat Assoc</source>. <year>2009</year>;<volume>104</volume>(<issue>485</issue>):<fpage>209</fpage>–<lpage>219</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1198/jasa.2009.0111" xlink:type="simple">10.1198/jasa.2009.0111</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004396.ref028">
<label>28</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Shavit</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Hamey</surname> <given-names>FK</given-names></name>, <name name-style="western"><surname>Lio</surname> <given-names>P</given-names></name>. <article-title>FisHiCal: an R package for iterative FISH-based calibration of Hi-C data</article-title>. <source>Bioinformatics</source>. <year>2014</year>;<volume>30</volume>(<issue>21</issue>):<fpage>3120</fpage>–<lpage>3122</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btu491" xlink:type="simple">10.1093/bioinformatics/btu491</ext-link></comment> <object-id pub-id-type="pmid">25061071</object-id></mixed-citation>
</ref>
</ref-list>
</back>
</article>