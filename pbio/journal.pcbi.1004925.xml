<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article article-type="research-article" dtd-version="1.1d3" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1004925</article-id>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-15-02084</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Agriculture</subject><subj-group><subject>Crop science</subject><subj-group><subject>Crops</subject><subj-group><subject>Cereal crops</subject><subj-group><subject>Rice</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Organisms</subject><subj-group><subject>Plants</subject><subj-group><subject>Grasses</subject><subj-group><subject>Rice</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Model organisms</subject><subj-group><subject>Plant and algal models</subject><subj-group><subject>Rice</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Genome analysis</subject><subj-group><subject>Genome-wide association studies</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Genomics</subject><subj-group><subject>Genome analysis</subject><subj-group><subject>Genome-wide association studies</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Human genetics</subject><subj-group><subject>Genome-wide association studies</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Genome analysis</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Genomics</subject><subj-group><subject>Genome analysis</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Heredity</subject><subj-group><subject>Quantitative traits</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Phenotypes</subject><subj-group><subject>Quantitative traits</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Genetic loci</subject><subj-group><subject>Quantitative trait loci</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Optimization</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Heredity</subject><subj-group><subject>Epistasis</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Genome analysis</subject><subj-group><subject>Genomic libraries</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Genomics</subject><subj-group><subject>Genome analysis</subject><subj-group><subject>Genomic libraries</subject></subj-group></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>PEPIS: A Pipeline for Estimating Epistatic Effects in Quantitative Trait Locus Mapping and Genome-Wide Association Studies</article-title>
<alt-title alt-title-type="running-head">PEPIS: Pipeline for Epistatic QTL Mapping and GWASs</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-8106-3553</contrib-id>
<name name-style="western">
<surname>Zhang</surname>
<given-names>Wenchao</given-names>
</name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Dai</surname>
<given-names>Xinbin</given-names>
</name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Wang</surname>
<given-names>Qishan</given-names>
</name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Xu</surname>
<given-names>Shizhong</given-names>
</name>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Zhao</surname>
<given-names>Patrick X.</given-names>
</name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001"><label>1</label> <addr-line>Plant Biology Division, Samuel Roberts Noble Foundation, Ardmore, Oklahoma, United States of America</addr-line></aff>
<aff id="aff002"><label>2</label> <addr-line>School of Agriculture and Biology, Shanghai Jiao Tong University, Shanghai, People’s Republic of China</addr-line></aff>
<aff id="aff003"><label>3</label> <addr-line>Department of Botany and Plant Sciences, University of California, Riverside, Riverside, California, United States of America</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Gardner</surname>
<given-names>Paul P</given-names>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1"><addr-line>University of Canterbury, NEW ZEALAND</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con" id="contrib001">
<p>Conceived and designed the experiments: SX PXZ. Performed the experiments: WZ XD QW. Analyzed the data: WZ XD SX PXZ. Contributed reagents/materials/analysis tools: WZ XD SX PXZ. Wrote the paper: WZ XD QW SX PXZ.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">shizhong.xu@ucr.edu</email> (SX); <email xlink:type="simple">pzhao@noble.org</email> (PXZ)</corresp>
</author-notes>
<pub-date pub-type="epub">
<day>25</day>
<month>5</month>
<year>2016</year>
</pub-date>
<pub-date pub-type="collection">
<month>5</month>
<year>2016</year>
</pub-date>
<volume>12</volume>
<issue>5</issue>
<elocation-id>e1004925</elocation-id>
<history>
<date date-type="received">
<day>14</day>
<month>12</month>
<year>2015</year>
</date>
<date date-type="accepted">
<day>18</day>
<month>4</month>
<year>2016</year>
</date>
</history>
<permissions>
<copyright-year>2016</copyright-year>
<copyright-holder>Zhang et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1004925"/>
<abstract>
<p>The term epistasis refers to interactions between multiple genetic loci. Genetic epistasis is important in regulating biological function and is considered to explain part of the ‘missing heritability,’ which involves marginal genetic effects that cannot be accounted for in genome-wide association studies. Thus, the study of epistasis is of great interest to geneticists. However, estimating epistatic effects for quantitative traits is challenging due to the large number of interaction effects that must be estimated, thus significantly increasing computing demands. Here, we present a new web server-based tool, the Pipeline for estimating EPIStatic genetic effects (PEPIS), for analyzing polygenic epistatic effects. The PEPIS software package is based on a new linear mixed model that has been used to predict the performance of hybrid rice. The PEPIS includes two main sub-pipelines: the first for kinship matrix calculation, and the second for polygenic component analyses and genome scanning for main and epistatic effects. To accommodate the demand for high-performance computation, the PEPIS utilizes C/C++ for mathematical matrix computing. In addition, the modules for kinship matrix calculations and main and epistatic-effect genome scanning employ parallel computing technology that effectively utilizes multiple computer nodes across our networked cluster, thus significantly improving the computational speed. For example, when analyzing the same immortalized F2 rice population genotypic data examined in a previous study, the PEPIS returned identical results at each analysis step with the original prototype R code, but the computational time was reduced from more than one month to about five minutes. These advances will help overcome the bottleneck frequently encountered in genome wide epistatic genetic effect analysis and enable accommodation of the high computational demand. The PEPIS is publically available at <ext-link ext-link-type="uri" xlink:href="http://bioinfo.noble.org/PolyGenic_QTL/" xlink:type="simple">http://bioinfo.noble.org/PolyGenic_QTL/</ext-link>.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>A new mixed-model was recently developed for mapping DNA regions that are associated with variations in observable traits, known as quantitative trait loci. This model incorporates multiple polygenic covariance genetic structures and has been used to successfully predict yield in hybrid rice. However, quantitatively examining interactions between multiple genetic elements, i.e. epistatic effects, across the entire genome is computationally demanding, which greatly hinders real-world applications of the model, especially in evaluating large populations and multiple genetic markers. In order to overcome these computational challenges, we developed a tool known as the PEPIS—Pipeline for estimating EPIStatic genetic effects in genome wide. We implemented the PEPIS in efficient C/C++ programming language and successfully incorporated several highly efficient open-source mathematical operation and optimization libraries to perform the computational demanding mathematical matrix operations required for these types of analyses. Furthermore, the computational demand is distributed across multiple nodes on our networked Linux computing cluster in order to increase the speed of analyses. Our PEPIS tool will thus help overcome the bottleneck in genetic epistasis analysis.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000153</institution-id>
<institution>Division of Biological Infrastructure</institution>
</institution-wrap>
</funding-source>
<award-id>1458597</award-id>
</award-group>
<award-group id="award002">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000153</institution-id>
<institution>Division of Biological Infrastructure</institution>
</institution-wrap>
</funding-source>
<award-id>1458515</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Xu</surname>
<given-names>Shizhong</given-names>
</name>
</principal-award-recipient>
</award-group>
<funding-statement>This work was supported by the Samuel Roberts Noble Foundation (<ext-link ext-link-type="uri" xlink:href="http://www.noble.org/" xlink:type="simple">http://www.noble.org/</ext-link>) and the National Science Foundation (<ext-link ext-link-type="uri" xlink:href="http://www.nsf.gov/" xlink:type="simple">http://www.nsf.gov/</ext-link>) collaborative research grant awards (DBI-1458597 and DBI-1458515). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="5"/>
<table-count count="1"/>
<page-count count="16"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>The PEPIS pipeline, the source code and the test data are freely available at <ext-link ext-link-type="uri" xlink:href="http://bioinfo.noble.org/PolyGenic_QTL/" xlink:type="simple">http://bioinfo.noble.org/PolyGenic_QTL/</ext-link>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<disp-quote>
<p>This is a <italic>PLOS Computational Biology</italic> Software Article.</p>
</disp-quote>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Epistasis, the interaction among multiple genetic loci, contributes significantly to phenotypic variation associated with the expression of polygenic complex traits. Epistatic effects have emerged as a possible explanation for ‘missing heritability,’ that is, marginal genetic effects that cannot be accounted for in a genome-wide association study (GWAS). Examinations of epistatic effects may also enhance understanding of the hierarchical architecture of gene interactions and genetic pathways [<xref ref-type="bibr" rid="pcbi.1004925.ref001">1</xref>].</p>
<p>Depending on the characteristics of a given study population, variations in the epistatic effects associated with a quantitative trait can be classified based on a number of different variance components, such as additive by additive, additive by dominance, dominance by additive, and dominance by dominance, for example [<xref ref-type="bibr" rid="pcbi.1004925.ref002">2</xref>]. The relative importance of each variance component usually varies across different traits.</p>
<p>GWAS has played important roles in the identification of possible connections between single-nucleotide polymorphisms (SNPs) and various diseases [<xref ref-type="bibr" rid="pcbi.1004925.ref003">3</xref>]. However, a number of studies that have identified genetic susceptibility factors failed to account for the effects of interactions between multiple genetic loci [<xref ref-type="bibr" rid="pcbi.1004925.ref004">4</xref>,<xref ref-type="bibr" rid="pcbi.1004925.ref005">5</xref>], which may help explain why the genetic variability of individual genes by GWAS can only explain ~40% variation of psychiatric disorders [<xref ref-type="bibr" rid="pcbi.1004925.ref004">4</xref>]. This inability to provide complete genetic explanations gives support to the concept of missing heritability. Careful analyses of epistatic effects may help close the gap in our understanding of missing heritability [<xref ref-type="bibr" rid="pcbi.1004925.ref004">4</xref>,<xref ref-type="bibr" rid="pcbi.1004925.ref006">6</xref>].</p>
<p>Obtaining a thorough understanding of the genetic architecture of a quantitative trait is particularly important in plant and animal breeding in order to develop optimal breeding strategies and obtain maximum genetic gains [<xref ref-type="bibr" rid="pcbi.1004925.ref007">7</xref>]. To date, however, most applications of quantitative genetics in plant and animal breeding have involved additive models based on the assumption that non-additive genetic effects are not important [<xref ref-type="bibr" rid="pcbi.1004925.ref002">2</xref>,<xref ref-type="bibr" rid="pcbi.1004925.ref008">8</xref>]. Unfortunately, breeding populations rarely exhibit such ideal conditions, leading to confounding of genetic values associated with additive and non-additive effects. Under the non-ideal conditions of real-world practice, a large proportion of the variance resulting from interactions between alleles (i.e., dominance and epistasis) may appear as additive variance [<xref ref-type="bibr" rid="pcbi.1004925.ref009">9</xref>].</p>
<p>A considerable amount of attention has been given to mapping of quantitative trait loci (QTL) to examine epistatic effects [<xref ref-type="bibr" rid="pcbi.1004925.ref010">10</xref>–<xref ref-type="bibr" rid="pcbi.1004925.ref015">15</xref>]. Xu et al. recently proposed a new mixed-model method for QTL mapping that incorporates multiple polygenic covariance structures [<xref ref-type="bibr" rid="pcbi.1004925.ref016">16</xref>]. In this model, genome-wide markers are used to initially estimate six different kinship matrices. Then, the total genetic variance was partitioned into six variance components. Each kinship matrix corresponds to one of the variance components: additive, dominance, additive by additive, dominance by dominance, additive by dominance, and dominance by additive. The six different kinship matrices, along with the six estimated polygenic variances, are then examined by polygenic QTL mapping. This model has been used to successfully predict the performance of hybrid rice [<xref ref-type="bibr" rid="pcbi.1004925.ref017">17</xref>] using released rice SNP data [<xref ref-type="bibr" rid="pcbi.1004925.ref018">18</xref>,<xref ref-type="bibr" rid="pcbi.1004925.ref019">19</xref>]. However, the large number of interaction effects to be estimated poses a significant obstacle in epistatic-effect QTL mapping. Although the ~270,000 original SNPs in the study by Xu et al. [<xref ref-type="bibr" rid="pcbi.1004925.ref016">16</xref>] were eventually converted into 1,619 synthetic markers (bins) [<xref ref-type="bibr" rid="pcbi.1004925.ref018">18</xref>], complete analysis of all 278 immortalized F2 (IMF2) individuals using their prototype R (<ext-link ext-link-type="uri" xlink:href="http://www.r-project.org/" xlink:type="simple">www.r-project.org</ext-link>) scripts would take more than one month.</p>
<p>Motivated by the challenge presented by the tremendous computational demand associated with epistatic QTL mapping, we conducted a thorough investigation of the model developed by Xu et al. and re-implemented the model algorithm using C/C++, resulting in the development of a web server-based tool named PEPIS (Pipeline for estimating EPIStatic genetic effects). The PEPIS employs parallelized kinship matrix calculations and main- and epistatic-effect genome scanning. Large computational analyses are divided and allocated to computational nodes on our networked Linux clusters. Furthermore, an open-source C++ linear algebra library, Armadillo [<xref ref-type="bibr" rid="pcbi.1004925.ref020">20</xref>], was utilized for mathematical matrix operations. The benefit of these strategies is a substantial reduction in computational time. Using the released IMF2 population rice SNP data, PEPIS reported the same result at each step when compared with the original prototype script developed by Xu., but reduced the whole analysis time from more than one month to about five minutes. Herein, we believe that this is a remarkable achievement that has overcome the bottleneck in epistatic analysis and thus empowers the high computational demanding of epistatic QTL mapping.</p>
<sec id="sec002">
<title>Genetic Model and Statistical Analysis Method</title>
<p>As the genetic model and statistical method proposed by Xu et al. [<xref ref-type="bibr" rid="pcbi.1004925.ref016">16</xref>,<xref ref-type="bibr" rid="pcbi.1004925.ref017">17</xref>] served as the basis for the development of the PEPIS, a brief review of their work is in order. First, the genotype of individual <italic>j</italic> in bin <italic>k</italic> is numerically coded into two variables, as follows:
<disp-formula id="pcbi.1004925.e001">
<alternatives>
<graphic id="pcbi.1004925.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004925.e001" xlink:type="simple"/>
<mml:math display="block" id="M1">
<mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>f</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mi>A</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd><mml:mtd><mml:mrow/></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>f</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mi>H</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>f</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mi>B</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd><mml:mtd><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow><mml:mspace width="0.15em"/><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>f</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mi>A</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd><mml:mtd><mml:mrow/></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>f</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mi>H</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd><mml:mtd><mml:mrow/></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>f</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mi>B</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd><mml:mtd><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(1)</label>
</disp-formula>
where <italic>Z</italic><sub><italic>jk</italic></sub> and <italic>W</italic><sub><italic>jk</italic></sub> represent additive and dominance indicators, respectively, and <italic>A</italic> (the first homozygote), <italic>H</italic> (heterozygote), and <italic>B</italic> (the second homozygote) indicate the three genotypes.</p>
<p>Let <italic>y</italic> be an <italic>n</italic>×1 vector for the quantitative trait values of all <italic>n</italic> individuals. It can be expressed by the following complete epistatic model for <italic>m</italic> bins,
<disp-formula id="pcbi.1004925.e002">
<alternatives>
<graphic id="pcbi.1004925.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004925.e002" xlink:type="simple"/>
<mml:math display="block" id="M2">
<mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mi>X</mml:mi><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mi>a</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>+</mml:mo></mml:mrow></mml:mstyle><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mi>d</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>+</mml:mo></mml:mrow></mml:mstyle><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mo>'</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>#</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mo>'</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:msup><mml:mi>k</mml:mi><mml:mo>'</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:mstyle><mml:mo>+</mml:mo></mml:mrow></mml:mstyle><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mo>'</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>#</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mo>'</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:msup><mml:mi>k</mml:mi><mml:mo>'</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:mstyle><mml:mo>+</mml:mo></mml:mrow></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mo>'</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>#</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mo>'</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:msup><mml:mi>k</mml:mi><mml:mo>'</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:mstyle><mml:mo>+</mml:mo></mml:mrow></mml:mstyle><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mo>'</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>#</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mo>'</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:msup><mml:mi>k</mml:mi><mml:mo>'</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle><mml:mo>+</mml:mo><mml:mi>ε</mml:mi></mml:mtd></mml:mtr></mml:mtable>
</mml:math>
</alternatives>
<label>(2)</label>
</disp-formula></p>
<p>where <italic>Xβ</italic> represents non-genetic effects and <italic>a</italic><sub><italic>k</italic></sub> and <italic>d</italic><sub><italic>k</italic></sub> represent additive and dominance effects, respectively, for bin <italic>k</italic>. The terms (<italic>aa</italic>)<sub><italic>kk</italic>'</sub>, (<italic>ad</italic>)<sub><italic>kk</italic>'</sub>, (<italic>da</italic>)<sub><italic>kk</italic>'</sub>, and (<italic>dd</italic>)<sub><italic>kk</italic>'</sub> represent additive by additive, additive by dominance, dominance by additive, and dominance by dominance effects, respectively, for bins <italic>k</italic> and <italic>k</italic>'.</p>
<p>In this model, the terms <inline-formula id="pcbi.1004925.e003"><alternatives><graphic id="pcbi.1004925.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004925.e003" xlink:type="simple"/>
<mml:math display="inline" id="M3"><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mi>a</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:math>
</alternatives></inline-formula> and <inline-formula id="pcbi.1004925.e004"><alternatives><graphic id="pcbi.1004925.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004925.e004" xlink:type="simple"/>
<mml:math display="inline" id="M4"><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mi>d</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:math>
</alternatives></inline-formula> describe polygenic main effects; whereas <inline-formula id="pcbi.1004925.e005"><alternatives><graphic id="pcbi.1004925.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004925.e005" xlink:type="simple"/>
<mml:math display="inline" id="M5"><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mo>'</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>#</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mo>'</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:msup><mml:mi>k</mml:mi><mml:mo>'</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:mrow></mml:math>
</alternatives></inline-formula>, <inline-formula id="pcbi.1004925.e006"><alternatives><graphic id="pcbi.1004925.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004925.e006" xlink:type="simple"/>
<mml:math display="inline" id="M6"><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mo>'</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>#</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mo>'</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:msup><mml:mi>k</mml:mi><mml:mo>'</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:mrow></mml:math>
</alternatives></inline-formula>, <inline-formula id="pcbi.1004925.e007"><alternatives><graphic id="pcbi.1004925.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004925.e007" xlink:type="simple"/>
<mml:math display="inline" id="M7"><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mo>'</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>#</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mo>'</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:msup><mml:mi>k</mml:mi><mml:mo>'</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:mrow></mml:math>
</alternatives></inline-formula>, and <inline-formula id="pcbi.1004925.e008"><alternatives><graphic id="pcbi.1004925.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004925.e008" xlink:type="simple"/>
<mml:math display="inline" id="M8"><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mo>'</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>#</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mo>'</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:msup><mml:mi>k</mml:mi><mml:mo>'</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:mrow></mml:math>
</alternatives></inline-formula> describe polygenic epistatic effects.</p>
<p>When the genetic effects are treated as normally distributed random variables with a mean of zero and a common variance across all markers or marker pairs, we have a mixed-model results. Let <inline-formula id="pcbi.1004925.e009"><alternatives><graphic id="pcbi.1004925.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004925.e009" xlink:type="simple"/>
<mml:math display="inline" id="M9"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math>
</alternatives></inline-formula>, <inline-formula id="pcbi.1004925.e010"><alternatives><graphic id="pcbi.1004925.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004925.e010" xlink:type="simple"/>
<mml:math display="inline" id="M10"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math>
</alternatives></inline-formula>, <inline-formula id="pcbi.1004925.e011"><alternatives><graphic id="pcbi.1004925.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004925.e011" xlink:type="simple"/>
<mml:math display="inline" id="M11"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>a</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math>
</alternatives></inline-formula>, <inline-formula id="pcbi.1004925.e012"><alternatives><graphic id="pcbi.1004925.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004925.e012" xlink:type="simple"/>
<mml:math display="inline" id="M12"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>d</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math>
</alternatives></inline-formula>, <inline-formula id="pcbi.1004925.e013"><alternatives><graphic id="pcbi.1004925.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004925.e013" xlink:type="simple"/>
<mml:math display="inline" id="M13"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>a</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math>
</alternatives></inline-formula>, and <inline-formula id="pcbi.1004925.e014"><alternatives><graphic id="pcbi.1004925.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004925.e014" xlink:type="simple"/>
<mml:math display="inline" id="M14"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>d</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math>
</alternatives></inline-formula> be the variance components associated with each of the six types of genetic effects. The expectation of <italic>y</italic> is <italic>E</italic>(<italic>y</italic>) = <italic>Xβ</italic>, and the variance matrix of <italic>y</italic> is
<disp-formula id="pcbi.1004925.e015">
<alternatives>
<graphic id="pcbi.1004925.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004925.e015" xlink:type="simple"/>
<mml:math display="block" id="M15">
<mml:mrow><mml:mi>V</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>a</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>d</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>a</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>d</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mi>I</mml:mi><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow>
</mml:math>
</alternatives>
<label>(3)</label>
</disp-formula>
where <italic>σ</italic><sup>2</sup> represents the residual error variance.</p>
<p>Each <italic>K</italic> matrix corresponds to a marker-generated kinship matrix, and its value can be calculated utilizing the formulas reported by Xu et al. [<xref ref-type="bibr" rid="pcbi.1004925.ref016">16</xref>]. Genetic similarities between all of the individuals in the sample can be assessed using the corresponding matrices. The variance components can be estimated using standard mixed-model procedures in conjunction with the marker-generated kinship matrices using the restricted maximum likelihood method (REML).</p>
<p>Two likelihood values are needed, one associated with the alternative hypothesis, <italic>H</italic><sub><italic>1</italic></sub>, and the other with the null hypothesis, <italic>H</italic><sub><italic>0</italic></sub>. The likelihood ratio test (LRT) can be used as an indicator of the degree of deviation of <italic>H</italic><sub><italic>1</italic></sub> from <italic>H</italic><sub><italic>0</italic></sub>. In the original prototype script code developed by Xu et al., the restricted maximum-likelihood estimation (REML) method was employed to estimate the variance components and the vector <inline-formula id="pcbi.1004925.e016"><alternatives><graphic id="pcbi.1004925.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004925.e016" xlink:type="simple"/>
<mml:math display="inline" id="M16"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>a</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>d</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>a</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>d</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math>
</alternatives></inline-formula>. The REML log-likelihood function is defined below
<disp-formula id="pcbi.1004925.e017">
<alternatives>
<graphic id="pcbi.1004925.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004925.e017" xlink:type="simple"/>
<mml:math display="block" id="M17">
<mml:mrow><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mi mathvariant="normal">ln</mml:mi><mml:mrow><mml:mo>|</mml:mo><mml:mi>V</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mi>y</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:msub><mml:mi>P</mml:mi><mml:mi>X</mml:mi></mml:msub><mml:mi>y</mml:mi><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mi mathvariant="normal">ln</mml:mi><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msup><mml:mi>X</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>X</mml:mi></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(4)</label>
</disp-formula>
where <italic>P</italic><sub><italic>X</italic></sub> = <italic>V</italic><sup>−1</sup>−<italic>V</italic><sup>−1</sup><italic>X</italic>(<italic>X</italic><sup><italic>T</italic></sup><italic>V</italic><sup>−1</sup><italic>X</italic>)<sup>−1</sup><italic>X</italic><sup><italic>T</italic></sup><italic>V</italic><sup>−1</sup>.</p>
<p>The variance matrix shown in Eq (<xref ref-type="disp-formula" rid="pcbi.1004925.e015">3</xref>) can thus be rewritten as
<disp-formula id="pcbi.1004925.e018">
<alternatives>
<graphic id="pcbi.1004925.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004925.e018" xlink:type="simple"/>
<mml:math display="block" id="M18">
<mml:mrow><mml:mi>V</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:msub><mml:mi>λ</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:msub><mml:mi>λ</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>I</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow>
</mml:math>
</alternatives>
<label>(5)</label>
</disp-formula>
where <inline-formula id="pcbi.1004925.e019"><alternatives><graphic id="pcbi.1004925.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004925.e019" xlink:type="simple"/>
<mml:math display="inline" id="M19"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>/</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math>
</alternatives></inline-formula>, <inline-formula id="pcbi.1004925.e020"><alternatives><graphic id="pcbi.1004925.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004925.e020" xlink:type="simple"/>
<mml:math display="inline" id="M20"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>/</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math>
</alternatives></inline-formula>, <inline-formula id="pcbi.1004925.e021"><alternatives><graphic id="pcbi.1004925.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004925.e021" xlink:type="simple"/>
<mml:math display="inline" id="M21"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>a</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>/</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math>
</alternatives></inline-formula>, <inline-formula id="pcbi.1004925.e022"><alternatives><graphic id="pcbi.1004925.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004925.e022" xlink:type="simple"/>
<mml:math display="inline" id="M22"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>d</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>/</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math>
</alternatives></inline-formula>, <inline-formula id="pcbi.1004925.e023"><alternatives><graphic id="pcbi.1004925.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004925.e023" xlink:type="simple"/>
<mml:math display="inline" id="M23"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>a</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>/</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math>
</alternatives></inline-formula>, and <inline-formula id="pcbi.1004925.e024"><alternatives><graphic id="pcbi.1004925.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004925.e024" xlink:type="simple"/>
<mml:math display="inline" id="M24"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>d</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>/</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math>
</alternatives></inline-formula> are variance ratios. The six polygenic variance ratios are then collected in a vector <bold>λ</bold> = [<italic>λ</italic><sub><italic>a</italic></sub>,<italic>λ</italic><sub><italic>d</italic></sub>,<italic>λ</italic><sub><italic>aa</italic></sub>,<italic>λ</italic><sub><italic>aa</italic></sub>,<italic>λ</italic><sub><italic>da</italic></sub>,<italic>λ</italic><sub><italic>dd</italic></sub>]. Let <bold>K</bold> = [<italic>K</italic><sub><italic>a</italic></sub>,<italic>K</italic><sub><italic>d</italic></sub>,<italic>K</italic><sub><italic>aa</italic></sub>,<italic>K</italic><sub><italic>ad</italic></sub>,<italic>K</italic><sub><italic>da</italic></sub>,<italic>K</italic><sub><italic>dd</italic></sub>]<sup><italic>T</italic></sup>, then we have <italic>Var</italic>(<italic>y</italic>) = <italic>V</italic> = (<bold>Kλ</bold> + <italic>I</italic>)<italic>σ</italic><sup>2</sup>.</p>
<p>Given the six variance ratios, a complete polygenic structure for a target quantitative trait can be examined in detail. One-dimensional (1D) genome scanning for main effects and two-dimensional (2D) genome scanning for epistatic effects can be employed to estimate individual marker/bin (main) effects and marker/bin pair interaction (epistatic) effects. Here, the individual main and epistatic effects correspond to two and four degrees of freedom LRT test, respectively. In theory, the four degrees of freedom LRT test needs four distinguishable genotypic forms. However, it is rare but possible that only three or less distinguishable genotypic forms occur for a marker/bin pair. This will lead to less than four degrees of freedom for the LRT test for epistatic effects. If we adopt a random model approach, there will be no problem for parameter estimation even if less than four genotypic forms exist. In other words, the random model does not depend on full rank of the design matrix.</p>
</sec>
</sec>
<sec id="sec003" sec-type="materials|methods">
<title>Design and Implementation</title>
<sec id="sec004">
<title>Design Overview</title>
<p>We developed the PEPIS for rapid epistatic QTL mapping analyses. The PEPIS is composed of two primary sub-pipelines. Sub-pipeline 1 is used for kinship matrix calculations, and sub-pipeline 2 is used for polygenic QTL mapping and integrates three related analysis modules: one for polygenic variance component analysis, another for genome scanning for main effects, and the third module for genome scanning for epistatic effects. The four modules (sub-pipeline 1 and the three modules of sub-pipeline 2) are designated ‘km_cal’, ‘pc_anal’, ‘gs_main’, and ‘gs_epis’, respectively. All the modules were coded in C/C++ and compiled into four separate executable command line programs. Several perl and cshell script files were then developed to function as a wrapper to streamline the complete pipeline.</p>
<p>When coded genotype data are provided, module km_cal calculates and delivers the corresponding kinship matrices. When phenotypic quantitative trait data are provided, module pc_anal estimates and delivers the six polygenic variances utilizing both the quantitative trait data and the available kinship matrices. Following the performance of various information aggregation procedures, including kinship matrix weighing and matrix eigen decomposition, modules gs_main and gs_epis calculate and return 1D LRT values for all markers (bins) and 2D LRT values for all marker (bin) pairs, respectively. <bold><xref ref-type="fig" rid="pcbi.1004925.g001">Fig 1</xref></bold> illustrates the overall flow of polygenic QTL mapping analyses in the PEPIS.</p>
<fig id="pcbi.1004925.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004925.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Flowchart illustrating polygenic QTL mapping using the PEPIS.</title>
<p>The PEPIS is divided into two parts: sub-pipeline 1, used for the six polygenic kinship matrix calculations, and sub-pipeline 2, used for the six polygenic component ratio estimations and further genome scanning for main and epistatic genetic effects.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004925.g001" xlink:type="simple"/>
</fig>
<p>To increase the flexibility of analyses, the PEPIS allows users to run only a portion of the pipeline according to the input data and user-configured parameters (e.g., users can perform only kinship matrix calculations and polygenic variance component analyses, or they can perform only kinship matrix calculations or even only calculate some of the kinship matrices). Such configuration flexibility allows users to utilize specific PEPIS-generated information with their own statistical genetics models.</p>
</sec>
<sec id="sec005">
<title>Computational Implementation of Mathematical Matrix Operations and LRT Optimization</title>
<p>A complete analysis requires processing of a large volume of genotypic matrix data and necessarily involves complex mathematical matrix operations, such as transposition, inversion, determinant calculation, and eigen decomposition, which can be easily prototyped in R or MATLAB (<ext-link ext-link-type="uri" xlink:href="http://www.mathworks.com/" xlink:type="simple">www.mathworks.com</ext-link>) without considering speed. However, as our goal in developing the PEPIS was to speed up the analysis of genotypic data to identify epistatic effects, we utilized C/C++ and a C++ linear algebra package, thus enabling highly efficient processing.</p>
<p>Because C++ is the programming language used in this project, we chose the C++-based linear algebra library Armadillo [<xref ref-type="bibr" rid="pcbi.1004925.ref020">20</xref>], which is an open-source program that provides a good balance between speed and ease of use. Furthermore, Armadillo’s API syntax was deliberately designed to be similar to MATLAB. A comparison of performance indicated that Armadillo is substantially faster than both MATLAB and previously developed C++ libraries such as IT++ and Newmat (<ext-link ext-link-type="uri" xlink:href="http://www.robertnz.net/nm_intro.htm" xlink:type="simple">http://www.robertnz.net/nm_intro.htm</ext-link>) [<xref ref-type="bibr" rid="pcbi.1004925.ref020">20</xref>]. Based on these advantages, we incorporated Armadillo source codes (<ext-link ext-link-type="uri" xlink:href="http://arma.sourceforge.net/" xlink:type="simple">http://arma.sourceforge.net/</ext-link>) for performing the mathematical matrix operations in the PEPIS.</p>
<p>Armadillo utilizes the BLAS (Basic Linear Algebra Subprograms, <ext-link ext-link-type="uri" xlink:href="http://www.netlib.org/blas/" xlink:type="simple">http://www.netlib.org/blas/</ext-link>) and LAPACK (Linear Algebra Package, <ext-link ext-link-type="uri" xlink:href="http://www.netlib.org/lapack" xlink:type="simple">http://www.netlib.org/lapack</ext-link>) for low-level computations such as basic vector and matrix and linear algebra operations. As such, it was necessary to incorporate both of these packages in the PEPIS.</p>
<p>LRT analysis requires two maximum-likelihood estimations, one of the alternative hypothesis <italic>H</italic><sub><italic>1</italic></sub>, and one of the null hypothesis, <italic>H</italic><sub><italic>0</italic></sub>. Furthermore, the maximum-likelihood estimation is even more computationally demanding, as it is essentially a bound constrained optimization procedure. The R environment provides the ‘optim()’ function and the ‘L-BFGS-B’ algorithm [<xref ref-type="bibr" rid="pcbi.1004925.ref021">21</xref>,<xref ref-type="bibr" rid="pcbi.1004925.ref022">22</xref>] options for users to perform specific optimizations. To develop the PEPIS in C/C++, we therefore adopted and incorporated the L-BFGS-B open-source codes in C (<ext-link ext-link-type="uri" xlink:href="http://users.iems.northwestern.edu/~nocedal/lbfgsb.html" xlink:type="simple">http://users.iems.northwestern.edu/~nocedal/lbfgsb.html</ext-link>) for the optimization sub-routine, which is also utilized as an optimization tool in the R environment.</p>
</sec>
<sec id="sec006">
<title>Parallel Strategy for Distributed High-Performance Computing</title>
<p>As our goal was to facilitate rapid epistatic QTL mapping, we first needed to analyze the computational complexity of the model and resolve the fundamental problems associated with the computationally demanding nature of these analyses. If we suppose that the number of individuals is represented by <italic>n</italic> and the number of markers/bins by <italic>m</italic>, then the number of total genetic effects is 2<italic>m</italic>+4<italic>C</italic>(<italic>m</italic>,2) = 2<italic>m</italic><sup>2</sup>. In the formulas for calculating the six kinship matrices [<xref ref-type="bibr" rid="pcbi.1004925.ref016">16</xref>], each kinship matrix is a square matrix of size <italic>n</italic>×<italic>n</italic> and matrix cell value <italic>K</italic>[<italic>i</italic>,<italic>j</italic>] = <italic>K</italic>[<italic>j</italic>,<italic>i</italic>]. Considering this symmetric feature, the multiplication time for <italic>K</italic><sub><italic>a</italic></sub> and <italic>K</italic><sub><italic>d</italic></sub> is <inline-formula id="pcbi.1004925.e025"><alternatives><graphic id="pcbi.1004925.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004925.e025" xlink:type="simple"/>
<mml:math display="inline" id="M25"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>m</mml:mi><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:math>
</alternatives></inline-formula>, which is on the order of <italic>O</italic>(<italic>mn</italic><sup>2</sup>). The multiplication time for <italic>K</italic><sub><italic>aa</italic></sub>, <italic>K</italic><sub><italic>ad</italic></sub>, <italic>K</italic><sub><italic>da</italic></sub>, and <italic>K</italic><sub><italic>dd</italic></sub> is <inline-formula id="pcbi.1004925.e026"><alternatives><graphic id="pcbi.1004925.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004925.e026" xlink:type="simple"/>
<mml:math display="inline" id="M26"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>m</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>4</mml:mn></mml:mfrac></mml:mrow></mml:math>
</alternatives></inline-formula>, which is on the order of <italic>O</italic>(<italic>m</italic><sup>2</sup><italic>n</italic><sup>2</sup>). These estimations clearly demonstrate the enormity of the multiplication demand associated with kinship matrix calculations, especially when both the individual and marker/bin numbers are large. However, the procedure used to calculate each matrix cell value is the same; thus, all <inline-formula id="pcbi.1004925.e027"><alternatives><graphic id="pcbi.1004925.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004925.e027" xlink:type="simple"/>
<mml:math display="inline" id="M27"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:math>
</alternatives></inline-formula> loops for matrix cell calculation can be parallelized.</p>
<p>The polygenic variance component analysis module needs essentially only one optimization for a seven-parameter log-likelihood estimation. The main-effects genome scanning module requires <italic>m</italic> times two degrees of freedom LRT estimation, and the epistatic-effects genome scanning module requires <inline-formula id="pcbi.1004925.e028"><alternatives><graphic id="pcbi.1004925.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004925.e028" xlink:type="simple"/>
<mml:math display="inline" id="M28"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>m</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:math>
</alternatives></inline-formula> times four degrees of freedom LRT estimation. Similarly, the procedure to estimate the LRT is the same, so the <italic>m</italic> times two degrees of freedom LRT estimation and <inline-formula id="pcbi.1004925.e029"><alternatives><graphic id="pcbi.1004925.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004925.e029" xlink:type="simple"/>
<mml:math display="inline" id="M29"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>m</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:math>
</alternatives></inline-formula> times four degrees of freedom LRT estimation can also be parallelized.</p>
<p>As demonstrated above, the computationally intensive modules for kinship matrix calculations and genome scanning for main and epistatic effects can be parallelized to increase the speed and efficiency of the analyses. The strategy utilized in the PEPIS for parallel high-performance distributed computing is summarized in <bold><xref ref-type="table" rid="pcbi.1004925.t001">Table 1</xref></bold>. Currently, the PEPIS is configured to efficiently utilize ~500 central processing unit (CPU) nodes in our Linux clusters for parallel computations.</p>
<table-wrap id="pcbi.1004925.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004925.t001</object-id>
<label>Table 1</label> <caption><title>Summary of parallel strategy in the PEPIS for increasing analysis speed.</title></caption>
<alternatives>
<graphic id="pcbi.1004925.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004925.t001" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left" rowspan="2">Processing Model</th>
<th align="center" rowspan="2">Computation complexity description</th>
<th align="center">Repetitive parallelizable</th>
<th align="center" rowspan="2">Allocated job for each CPU node with p parallelizable CPUs</th>
</tr>
<tr>
<th align="center">calculation unit</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Kinship matrix calculation</td>
<td align="center"><bold>n(n+1)</bold>/<bold>2</bold> loops for 6 kinship matrix cell calculations. <bold>m(m−1)n(n+1)</bold>+<bold>mn(n+1)</bold> times multiplication</td>
<td align="center">6 kinship matrix cell calculations</td>
<td align="center"><bold>n(n+1)</bold>/<bold>2p</bold> loops for 6 matrix cell calculations</td>
</tr>
<tr>
<td align="left">Genome scanning for main effects</td>
<td align="center"><bold>m</bold> times 2 degrees of freedom LRT estimation</td>
<td align="center">2 degrees of freedom LRT estimation</td>
<td align="center"><bold>m/p</bold> times 2 degrees of freedom LRT estimation</td>
</tr>
<tr>
<td align="left">Genome scanning for epistatic effects</td>
<td align="center"><bold>m(m−1)/2</bold> times 4 degrees of freedom LRT estimation</td>
<td align="center">4 degrees of freedom LRT estimation</td>
<td align="center"><bold>m(m−1)/2p</bold> times 4 degrees of freedom LRT estimation</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
</sec>
</sec>
<sec id="sec007" sec-type="results">
<title>Results</title>
<p>The PEPIS is a web-based program developed in C/C++ to facilitate efficient and rapid epistatic QTL mapping. We verified that the PEPIS could meet our performance expectations by analyzing the same IMF2 rice population genotypic and field phenotypic trait data sets examined by Xu et al. [<xref ref-type="bibr" rid="pcbi.1004925.ref016">16</xref>].</p>
<sec id="sec008">
<title>Field Data and IMF2 Population</title>
<p>The IMF2 population described by Hua et al. [<xref ref-type="bibr" rid="pcbi.1004925.ref023">23</xref>,<xref ref-type="bibr" rid="pcbi.1004925.ref024">24</xref>] consisted of 360 crosses made by random matches of 240 recombinant inbred lines (RILs) derived by single-seed descent from a cross between the Zhenshan 97 and Minghui 63 rice hybrids. Field data pertaining to yield (YIELD), number of tillers per plant (TILLER), number of grains per panicle (GRAIN), and thousand-grain weight (KGW) were collected during the 1998 and 1999 rice growing seasons from replicated field trials on the Huazhong Agricultural University Experimental Farm in Wuhan, China. Over 270,000 high-density SNP markers were used to infer recombination breakpoints (crossovers), which were then used to construct a total of 1,619 bins [<xref ref-type="bibr" rid="pcbi.1004925.ref018">18</xref>]. The bins were treated as “new markers” for association studies. The bin map was constructed by genotyping the RIL population sequences [<xref ref-type="bibr" rid="pcbi.1004925.ref018">18</xref>,<xref ref-type="bibr" rid="pcbi.1004925.ref019">19</xref>]. Of the 360 crosses, only 278 were available in both phenotypes and bin genotypes. Therefore, the bin genotype data were stored in an <italic>n</italic>×<italic>m</italic> = 278×1,619 matrix. The Zhenshan 97 genotype was coded as ‘A,’ the Minghui 63 genotype as ‘B,’ and the heterozygote as ‘H.’ We downloaded the genotype and phenotype data from the website specified by Zhou et al. [<xref ref-type="bibr" rid="pcbi.1004925.ref025">25</xref>].</p>
</sec>
<sec id="sec009">
<title>Submission of Representative Case Analysis Data to the PEPIS and Results Returned</title>
<p>The coded additive and dominance genotypic data were stored as two <italic>n</italic>×<italic>m</italic> = 278×1,619 matrices and then submitted to the PEPIS. Simultaneously, the YIELD, KGW, GRAIN, and TILLER quantitative phenotypic data were stored as a <italic>n</italic>×1 = 278×1 column vector for each trait and submitted to the PEPIS. Upon clicking the submit icon, the PEPIS allocates the entire processing job to the available computer nodes distributed across our networked Linux clusters. Once all of the distributed computing jobs are completed, the results are returned as a pop-up page, and users are given the option to download the results from each analysis step. Using the same IMF2 population rice data, the PEPIS returns the same result at each step when compared with the original prototype script developed by Xu et al. [<xref ref-type="bibr" rid="pcbi.1004925.ref016">16</xref>], but reduced the whole analysis time from more than one month to about five minutes. The significant difference in analysis time demonstrates that the PEPIS is capable of performing large-scale epistatic QTL mapping based on data from large numbers of individuals and markers/bins.</p>
<p>The user interface for data submission and return of results is shown in <bold><xref ref-type="fig" rid="pcbi.1004925.g002">Fig 2</xref></bold>. The results returned include the six ‘gzip’ files corresponding to the six polygenic kinship matrices, as well as three '.txt' files corresponding to the results of polygenic variance component analysis and genome scanning for main and epistatic effects. The analysis results are explained in detail below.</p>
<fig id="pcbi.1004925.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004925.g002</object-id>
<label>Fig 2</label>
<caption>
<title>PEPIS user interfaces.</title>
<p>(A) Data submission and (B) Results return.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004925.g002" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec010">
<title>PEPIS Results and Biological Implications</title>
<p>Based on the results of polygenic variance component analyses, the polygenic structure of a target quantitative trait can be dissected. Pie charts illustrating the polygenic variance component ratios for the traits YIELD, KGW, GRAIN, and TILLER are shown in <bold><xref ref-type="fig" rid="pcbi.1004925.g003">Fig 3</xref></bold>. Substantial differences between the polygenic structures were observed for the different traits. For example, additive genetic variance accounted for 73% of trait variance for KGW, whereas epistatic genetic variance was the major contributor to variance for YIELD.</p>
<fig id="pcbi.1004925.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004925.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Pie charts illustrating the polygenic structure of the quantitative traits of rice.</title>
<p>(A) YIELD, (B) KGW, (C) GRAIN, and (D) TILLER.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004925.g003" xlink:type="simple"/>
</fig>
<p>The 1D LRT distributions across all markers/bins were plotted based on the results of genome scanning for main-effect QTL mapping. Plots of the main-effect LRTs for traits YIELD, KGW, GRAIN, and TILLER across the complete rice genome are shown in <bold><xref ref-type="fig" rid="pcbi.1004925.g004">Fig 4</xref></bold>. The LRT statistic can be used to declare the statistical significance for each marker/bin, herein, if we set a statistic threshold which also called p value, the marker/bin above the threshold suggest an association with the trait, further, the marker/bin under a narrower peak means a higher resolution and indicates a more specific association to the trait.</p>
<fig id="pcbi.1004925.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004925.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Plot of main-effect LRT results for quantitative traits with the markers/bins distributed across the complete rice genome.</title>
<p>(A) YIELD, (B) KGW, (C) GRAIN, and (D) TILLER. Dashed lines distinguish the 12 chromosomes and corresponding marker/bin numbers for the complete rice genome.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004925.g004" xlink:type="simple"/>
</fig>
<p>The 2D LRT distributions across all marker/bin pairs were also calculated based on the results of genome scanning for epistatic-effect QTL mapping. <bold><xref ref-type="fig" rid="pcbi.1004925.g005">Fig 5</xref></bold> shows the 2D epistatic-effect LRTs for the traits YIELD, KGW, GRAIN, and TILLER across the complete rice genome. Due to the symmetrical nature of the data, only a lower triangular matrix is shown for each trait instead of the entire square matrix for all of the <inline-formula id="pcbi.1004925.e030"><alternatives><graphic id="pcbi.1004925.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004925.e030" xlink:type="simple"/>
<mml:math display="inline" id="M30"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>m</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:math>
</alternatives></inline-formula> possible combinational marker/bin pairs. The 2D LRT statistic can be used to declare the statistical significance of each marker/bin pair, herein, a statistic threshold can be set, the marker/bin pair above the threshold suggests an association with the trait.</p>
<fig id="pcbi.1004925.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004925.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Two-dimensional illustration of epistatic-effect LRTs for quantitative traits with marker/bin pairs distributed across the complete rice genome.</title>
<p>(A)YIELD, (B) KGW, (C) GRAIN, and (D) TILLER.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004925.g005" xlink:type="simple"/>
</fig>
<p>In summary, although the overall polygenic structure of several hybrid rice target traits can be obtained based on the data illustrated in <bold><xref ref-type="fig" rid="pcbi.1004925.g003">Fig 3</xref></bold>, greater detail regarding the genetic composition of these traits can be obtained from the 1D main-effect LRT data illustrated in <bold><xref ref-type="fig" rid="pcbi.1004925.g004">Fig 4</xref></bold> and the 2D epistatic-effect LRT data illustrated in <bold><xref ref-type="fig" rid="pcbi.1004925.g005">Fig 5</xref></bold>. The high-intensity profile peaks in <bold><xref ref-type="fig" rid="pcbi.1004925.g004">Fig 4</xref></bold> suggest that genetic loci are associated with the target traits examined in this study, for example, in <bold><xref ref-type="fig" rid="pcbi.1004925.g004">Fig 4(B)</xref></bold>, two high-intensity profile peaks located in chromosome 3 and chromosome 5 are two predominant genetic loci for trait KGW. Similarly, the high-intensity pixel points in <bold><xref ref-type="fig" rid="pcbi.1004925.g005">Fig 5</xref></bold> suggest that a marker/bin pair is associated with each of the target traits, for example, the vertical scale bars in in <bold><xref ref-type="fig" rid="pcbi.1004925.g005">Fig 5(A)</xref></bold> represented by a number of pixel points with comparatively high intensities and vertically scattered between marker/bin 1000-marker/bin 1600, suggest that there are numerous genetic marker interaction pairs. These pairs could be used to construct a more complex marker-marker interaction/regulation network for the trait of YIELD.</p>
</sec>
</sec>
<sec id="sec011">
<title>Performance Analysis and Discussion</title>
<p>PEPIS was dedicatedly developed for epistatic genetic estimation. In generally, it has four independent modules including kinship matrix calculation, polygenic component analysis, genome scanning/mapping for main and epistatic effects. Currently, several software tools, such as TASSEL [<xref ref-type="bibr" rid="pcbi.1004925.ref026">26</xref>], GCTA [<xref ref-type="bibr" rid="pcbi.1004925.ref027">27</xref>,<xref ref-type="bibr" rid="pcbi.1004925.ref028">28</xref>], PLINK [<xref ref-type="bibr" rid="pcbi.1004925.ref028">28</xref>], etc. have been successfully developed for genome wide association mapping and complex trait analysis. These tools also need to calculate the kinship [<xref ref-type="bibr" rid="pcbi.1004925.ref026">26</xref>] / genetic relationship [<xref ref-type="bibr" rid="pcbi.1004925.ref027">27</xref>,<xref ref-type="bibr" rid="pcbi.1004925.ref028">28</xref>] matrix at first, and then estimate the genetic variances that can explain the phenotypic variances. In this regard, they have some similar functionalities as the PEPIS. However, all these tools are based on an additive linear model and ignore the epistatic effect. They calculated only one additive kinship matrix, and produced only a 1D likelihood-based association mapping. Comparatively, PEPIS is based on a full polygenic linear model. Therefore, PEPIS needs to calculate six polygenic kinship matrices, and produces both 1D and 2D likelihood based association mapping. The incorporation of epistatic effects results in a huge number of genetic epistatic effects to be estimated and presents a significant increase in computational burden.</p>
<p>Although PEPIS is equipped with a parallel strategy in a distributed Linux computing cluster, it is useful to perform a benchmark evaluation on the computation performance of PEPIS at different data scale. To accomplish this, we specifically generated a series of simulated data sets by varying bin/marker numbers and sample size. These simulated data sets are available in <bold><xref ref-type="supplementary-material" rid="pcbi.1004925.s001">S1 File</xref></bold>, which include 11 sub directories and each contains three '.txt' files, corresponding to the genotypic additive Z Matrix, dominance W Matrix, and vector of phenotypic values. The additive Z Matrix and dominance W Matrix are randomly generated but constrained by formula 1. We submitted each of the 11 data sets to PEPIS and recorded the running time for kinship matrix only and the whole running time for epistatic effect estimation and association mapping. Two scenarios of the simulation experiment were considered, and one was to fix the number of bins but vary the sample size (the number of individuals), the other was the opposite. The running times for kinship matrix calculations are shown in <bold><xref ref-type="supplementary-material" rid="pcbi.1004925.s002">S1 Table</xref></bold> and the overall running times for epistatic effect estimation and association mapping are shown in <bold><xref ref-type="supplementary-material" rid="pcbi.1004925.s003">S2 Table</xref></bold>.</p>
<p>From <bold><xref ref-type="supplementary-material" rid="pcbi.1004925.s002">S1 Table</xref></bold>, we can see that 1) the running time for calculating the main effect kinship matrix increases moderately with the increase of the number of bins; and 2) the running time for calculating the entire set of polygenic kinship matrices increases intensely with the increase of sample size and number of markers/bins. Such observations are consistent with our previous complexity analysis for kinship matrix calculation. The computational burden for main effect kinship matrix calculation is on the order of <italic>O</italic>(<italic>mn</italic><sup>2</sup>), while the computational burden for epistatic effect kinship matrix calculation is on the order of <italic>O</italic>(<italic>m</italic><sup>2</sup><italic>n</italic><sup>2</sup>).where <italic>m</italic> and <italic>n</italic> are the number of markers/bins and the sample size, respectively.</p>
<p>From <bold><xref ref-type="supplementary-material" rid="pcbi.1004925.s003">S2 Table</xref></bold>, we observe the followings: 1) the running time for epistatic effect estimation and association mapping increases intensely with the increase of the sample size and the number of markers/bins; and 2) the running time increases faster with the increase of sample size compared with the increase of bin number. Our in-depth investigation revealed that the module for polygenic variance component analysis takes significant amount of time when the sample size is very large, because the module is essentially an optimization procedure for a seven-parameter log-likelihood estimation, which takes the six polygenic kinship matrices as a whole input and cannot be parallelized.</p>
<p>It is well known that increasing the marker density and the sample size can further increase the resolution of QTL mapping and reduce the uncertainty of inferred genotypes. However, the high density markers can result in a huge number of marker pairs for epistasis detection. In PEPIS, the module for polygenic variant component analysis is still a bottleneck if the sample size is more than 5,000.</p>
<p>In summary, with the efficient algorithm implementation in C/C++ and deployment of parallel strategy, PEPIS has a powerful computational capability and is able to carry out epistatic effect analysis and association mapping when the sample size in the scale of several thousands and the number of markers/bins in the scale of twenty thousand. At these scales, it would require several years to be completed using the original prototype R programs [<xref ref-type="bibr" rid="pcbi.1004925.ref016">16</xref>].</p>
</sec>
<sec id="sec012">
<title>Availability and Future Directions</title>
<p>The PEPIS pipeline, the source code and the test data are freely available at <ext-link ext-link-type="uri" xlink:href="http://bioinfo.noble.org/PolyGenic_QTL/" xlink:type="simple">http://bioinfo.noble.org/PolyGenic_QTL/</ext-link>. We are committed to maintaining and improving the specific function modules per user comments and suggestions.</p>
<p>The current version of the PEPIS can be configured to perform kinship matrix calculations, polygenic component analyses, the 1D LRT estimations for main-effect QTL mapping, and the 2D LRT estimations for epistatic-effect QTL mapping upon submission of the coded genotypic and phenotypic data. However, a more user-friendly and efficient visualization of the input genotypic data and the analysis results returned at each step would be very useful. We are therefore planning to develop a visualization engine that will allow for more efficient display of the input genotypic data and the polygenic QTL mapping results returned at each analysis step. Furthermore, the high intensities for a number of the pixel points shown in <bold><xref ref-type="fig" rid="pcbi.1004925.g005">Fig 5</xref></bold> are suggestive of the presence of marker interaction pairs that correspond to a biologically meaningful gene regulatory network. Therefore, we are also planning to develop an LRT (p value)-based genetic statistical network analysis module that will be incorporated into our publically available high-performance expression-based gene regulatory network analysis web-server (<ext-link ext-link-type="uri" xlink:href="http://plantgrn.noble.org/GPLEXUS/" xlink:type="simple">http://plantgrn.noble.org/GPLEXUS/</ext-link>) following validation [<xref ref-type="bibr" rid="pcbi.1004925.ref029">29</xref>].</p>
<p>Difficulties associated with handling high dimensional SNP data and the inability to estimate epistatic effects constitute a significant challenge in GWAS. Reducing the dimensions of SNP data based on biological information is critical and as such should be the first fundamental step in estimating epistatic effects. Xu pioneered a groundbreaking methodology for inferring breakpoints using high density SNP marker data from bi-parental populations and constructed a bin-based genetic marker data [<xref ref-type="bibr" rid="pcbi.1004925.ref030">30</xref>]. The segregation patterns are identical for all original SNP markers within a bin, and each bin in turn is considered to be a synthetic marker.</p>
<p>Binning markers in bi-parental populations is straightforward [<xref ref-type="bibr" rid="pcbi.1004925.ref030">30</xref>]. If the number of bins is still very large due to large sample sizes, one can combine several consecutive bins into a larger bin. As long as the number of these artificially created larger bins is small enough to be handed by the epistatic model, they can be used as “synthetic markers” for epistatic mapping. Wei and Xu[<xref ref-type="bibr" rid="pcbi.1004925.ref031">31</xref>] binned markers for multi-parent advanced generation inter-cross (MAGIC) populations for QTL mapping. They used the R software “Happy” to infer the parental origin of each marker for each individual and eventually binning consecutive markers with the same parental origins. For random populations, binning markers may be very difficult. However, we may use linkage disequilibrium (LD) value to define “bins”. Consecutive markers with LD larger than a threshold can be combined together and analyzed as a single bin. Such bins are better called LD blocks. Our PEPIS can take any numerical genotypic values as input files, regardless whether the genotypic values are defined as bins or original markers. One of our long term goals of the project is to incorporate a binning function into the pipeline so that the program can directly handle the original SNP data, leading to more practical applications of the PEPIS for epistatic analyses.</p>
</sec>
<sec id="sec013">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1004925.s001" mimetype="application/zip" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004925.s001" xlink:type="simple">
<label>S1 File</label>
<caption>
<title>The simulated data at various dimensions with different sample sizes and different numbers of bins.</title>
<p>Eleven sub directories are included, and each contains three '.txt' files corresponding to the additive genotypic Z Matrix, the dominance W matrix, and the phenotypic vector.</p>
<p>(ZIP)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004925.s002" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004925.s002" xlink:type="simple">
<label>S1 Table</label>
<caption>
<title>The PEPIS running time for kinship matrix calculation using the simulated data at various dimensions.</title>
<p>Two scenarios are tested corresponding to A) Fixing sample size at 1000 while varying the number of bins from 1,000 to 40,000; and B) Fixing the number of bins at 1,000 while varying the sample size from 1,000 to 40,000.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004925.s003" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004925.s003" xlink:type="simple">
<label>S2 Table</label>
<caption>
<title>The PEPIS running time for estimating the epistatic effect in PEPIS using the simulated data at various dimensions.</title>
<p>Two scenarios are tested corresponding to A) Fixing the sample size at 1,000 while varying the number of bins from 1000 to 20,000; and B) Fixing the number of bins at 1,000 while varying the sample size from 1,000 to 10,000.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>The authors thank Dr. Qifa Zhang of Huazhong Agricultural University for sharing valuable genotypic and field data for the IMF2 rice population.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1004925.ref001"><label>1</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kang</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Chun</surname> <given-names>H-W</given-names></name>, <name name-style="western"><surname>Ding</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Liu</surname> <given-names>C</given-names></name>, <etal>et al</etal>. (<year>2015</year>) <article-title>eQTL epistasis: detecting epistatic effects and inferring hierarchical relationships of genes in biological pathways</article-title>. <source>Bioinformatics</source> <volume>31</volume>: <fpage>656</fpage>–<lpage>664</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btu727" xlink:type="simple">10.1093/bioinformatics/btu727</ext-link></comment> <object-id pub-id-type="pmid">25359893</object-id></mixed-citation></ref>
<ref id="pcbi.1004925.ref002"><label>2</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cockerham</surname> <given-names>CC</given-names></name> (<year>1954</year>) <article-title>AN EXTENSION OF THE CONCEPT OF PARTITIONING HEREDITARY VARIANCE FOR ANALYSIS OF COVARIANCES AMONG RELATIVES WHEN EPISTASIS IS PRESENT</article-title>. <source>Genetics</source> <volume>39</volume>: <fpage>859</fpage>–<lpage>882</lpage>. <object-id pub-id-type="pmid">17247525</object-id></mixed-citation></ref>
<ref id="pcbi.1004925.ref003"><label>3</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Norrgard</surname> <given-names>K</given-names></name> (<year>2008</year>) <article-title>Genetic variation and disease: GWAS</article-title>. <source>Nature Education</source> <volume>1</volume>.</mixed-citation></ref>
<ref id="pcbi.1004925.ref004"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pandey</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Davis</surname> <given-names>NA</given-names></name>, <name name-style="western"><surname>White</surname> <given-names>BC</given-names></name>, <name name-style="western"><surname>Pajewski</surname> <given-names>NM</given-names></name>, <name name-style="western"><surname>Savitz</surname> <given-names>J</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Epistasis network centrality analysis yields pathway replication across two GWAS cohorts for bipolar disorder</article-title>. <source>Transl Psychiatry</source> <volume>2</volume>: <fpage>e154</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/tp.2012.80" xlink:type="simple">10.1038/tp.2012.80</ext-link></comment> <object-id pub-id-type="pmid">22892719</object-id></mixed-citation></ref>
<ref id="pcbi.1004925.ref005"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Carlborg</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Haley</surname> <given-names>CS</given-names></name> (<year>2004</year>) <article-title>Epistasis: too often neglected in complex trait studies?</article-title> <source>Nat Rev Genet</source> <volume>5</volume>: <fpage>618</fpage>–<lpage>625</lpage>. <object-id pub-id-type="pmid">15266344</object-id></mixed-citation></ref>
<ref id="pcbi.1004925.ref006"><label>6</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Eichler</surname> <given-names>EE</given-names></name>, <name name-style="western"><surname>Flint</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Gibson</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Kong</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Leal</surname> <given-names>SM</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Missing heritability and strategies for finding the underlying causes of complex disease</article-title>. <source>Nat Rev Genet</source> <volume>11</volume>: <fpage>446</fpage>–<lpage>450</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nrg2809" xlink:type="simple">10.1038/nrg2809</ext-link></comment> <object-id pub-id-type="pmid">20479774</object-id></mixed-citation></ref>
<ref id="pcbi.1004925.ref007"><label>7</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Muñoz</surname> <given-names>PR</given-names></name>, <name name-style="western"><surname>Resende</surname> <given-names>MFR</given-names></name>, <name name-style="western"><surname>Gezan</surname> <given-names>SA</given-names></name>, <name name-style="western"><surname>Resende</surname> <given-names>MDV</given-names></name>, <name name-style="western"><surname>de los Campos</surname> <given-names>G</given-names></name>, <etal>et al</etal>. (<year>2014</year>) <article-title>Unraveling Additive from Non-Additive Effects Using Genomic Relationship Matrices</article-title>. <source>Genetics</source>.</mixed-citation></ref>
<ref id="pcbi.1004925.ref008"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">Kempthorne O (1954) The Correlation between Relatives in a Random Mating Population. 103–113 p.</mixed-citation></ref>
<ref id="pcbi.1004925.ref009"><label>9</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hill</surname> <given-names>WG</given-names></name>, <name name-style="western"><surname>Goddard</surname> <given-names>ME</given-names></name>, <name name-style="western"><surname>Visscher</surname> <given-names>PM</given-names></name> (<year>2008</year>) <article-title>Data and Theory Point to Mainly Additive Genetic Variance for Complex Traits</article-title>. <source>PLoS Genet</source> <volume>4</volume>: <fpage>e1000008</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pgen.1000008" xlink:type="simple">10.1371/journal.pgen.1000008</ext-link></comment> <object-id pub-id-type="pmid">18454194</object-id></mixed-citation></ref>
<ref id="pcbi.1004925.ref010"><label>10</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cockerham</surname> <given-names>CC</given-names></name>, <name name-style="western"><surname>Zeng</surname> <given-names>Z-B</given-names></name> (<year>1996</year>) <article-title>Design III With Marker Loci</article-title>. <source>Genetics</source> <volume>143</volume>: <fpage>1437</fpage>–<lpage>1456</lpage>. <object-id pub-id-type="pmid">8807314</object-id></mixed-citation></ref>
<ref id="pcbi.1004925.ref011"><label>11</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kao</surname> <given-names>C-H</given-names></name>, <name name-style="western"><surname>Zeng</surname> <given-names>Z-B</given-names></name> (<year>2002</year>) <article-title>Modeling Epistasis of Quantitative Trait Loci Using Cockerham's Model</article-title>. <source>Genetics</source> <volume>160</volume>: <fpage>1243</fpage>–<lpage>1261</lpage>. <object-id pub-id-type="pmid">11901137</object-id></mixed-citation></ref>
<ref id="pcbi.1004925.ref012"><label>12</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>YI</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>XU</surname> <given-names>S</given-names></name> (<year>2002</year>) <article-title>Mapping quantitative trait loci with epistatic effects</article-title>. <source>Genetics Research</source> <volume>79</volume>: <fpage>185</fpage>–<lpage>198</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004925.ref013"><label>13</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Xu</surname> <given-names>S</given-names></name> (<year>2007</year>) <article-title>An Empirical Bayes Method for Estimating Epistatic Effects of Quantitative Trait Loci</article-title>. <source>Biometrics</source> <volume>63</volume>: <fpage>9</fpage>.</mixed-citation></ref>
<ref id="pcbi.1004925.ref014"><label>14</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Xu</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Jia</surname> <given-names>Z</given-names></name> (<year>2007</year>) <article-title>Genomewide Analysis of Epistatic Effects for Quantitative Traits in Barley</article-title>. <source>Genetics</source> <volume>175</volume>: <fpage>1955</fpage>–<lpage>1963</lpage>. <object-id pub-id-type="pmid">17277367</object-id></mixed-citation></ref>
<ref id="pcbi.1004925.ref015"><label>15</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Garcia</surname> <given-names>AAF</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Melchinger</surname> <given-names>AE</given-names></name>, <name name-style="western"><surname>Zeng</surname> <given-names>Z-B</given-names></name> (<year>2008</year>) <article-title>Quantitative Trait Loci Mapping and The Genetic Basis of Heterosis in Maize and Rice</article-title>. <source>Genetics</source> <volume>180</volume>: <fpage>1707</fpage>–<lpage>1724</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1534/genetics.107.082867" xlink:type="simple">10.1534/genetics.107.082867</ext-link></comment> <object-id pub-id-type="pmid">18791260</object-id></mixed-citation></ref>
<ref id="pcbi.1004925.ref016"><label>16</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Xu</surname> <given-names>S</given-names></name> (<year>2013</year>) <article-title>Mapping Quantitative Trait Loci by Controlling Polygenic Background Effects</article-title>. <source>Genetics</source>.</mixed-citation></ref>
<ref id="pcbi.1004925.ref017"><label>17</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Xu</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Zhu</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>Q</given-names></name> (<year>2014</year>) <article-title>Predicting hybrid performance in rice using genomic best linear unbiased prediction</article-title>. <source>Proceedings of the National Academy of Sciences</source> <volume>111</volume>: <fpage>12456</fpage>–<lpage>12461</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004925.ref018"><label>18</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Xie</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Feng</surname> <given-names>Q</given-names></name>, <name name-style="western"><surname>Yu</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Huang</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Zhao</surname> <given-names>Q</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Parent-independent genotyping for constructing an ultrahigh-density linkage map based on population sequencing</article-title>. <source>Proceedings of the National Academy of Sciences</source> <volume>107</volume>: <fpage>10578</fpage>–<lpage>10583</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004925.ref019"><label>19</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yu</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Xie</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Xing</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Xu</surname> <given-names>C</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Gains in QTL Detection Using an Ultra-High Density SNP Map Based on Population Sequencing Relative to Traditional RFLP/SSR Markers</article-title>. <source>PLoS ONE</source> <volume>6</volume>: <fpage>e17595</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0017595" xlink:type="simple">10.1371/journal.pone.0017595</ext-link></comment> <object-id pub-id-type="pmid">21390234</object-id></mixed-citation></ref>
<ref id="pcbi.1004925.ref020"><label>20</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Sanderson</surname> <given-names>C</given-names></name> (<year>2010</year>) <chapter-title>Armadillo: An Open Source C++ Linear Algebra Library for Fast Prototyping and Computationally Intensive Experiments</chapter-title>. <publisher-name>NICTA</publisher-name>.</mixed-citation></ref>
<ref id="pcbi.1004925.ref021"><label>21</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Byrd</surname> <given-names>RH</given-names></name>, <name name-style="western"><surname>Lu</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Nocedal</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Zhu</surname> <given-names>C</given-names></name> (<year>1995</year>) <article-title>A Limited Memory Algorithm for Bound Constrained Optimization</article-title>. <source>SIAM Journal on Scientific Computing</source> <volume>16</volume>: <fpage>1190</fpage>–<lpage>1208</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004925.ref022"><label>22</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ciyou</surname> <given-names>Zhu RHB</given-names></name>, <name name-style="western"><surname>Peihuang</surname> <given-names>Lu</given-names></name>, <name name-style="western"><surname>Nocedal</surname> <given-names>Jorge</given-names></name> (<year>1997</year>) <article-title>Algorithm 778: L-BFGS-B: Fortran subroutines for large-scale bound-constrained optimization</article-title>. <source>ACM Transactions on Mathematical Software</source> <volume>23</volume>: <fpage>550</fpage>–<lpage>560</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004925.ref023"><label>23</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hua</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Xing</surname> <given-names>YZ</given-names></name>, <name name-style="western"><surname>Xu</surname> <given-names>CG</given-names></name>, <name name-style="western"><surname>Sun</surname> <given-names>XL</given-names></name>, <name name-style="western"><surname>Yu</surname> <given-names>SB</given-names></name>, <etal>et al</etal>. (<year>2002</year>) <article-title>Genetic Dissection of an Elite Rice Hybrid Revealed That Heterozygotes Are Not Always Advantageous for Performance</article-title>. <source>Genetics</source> <volume>162</volume>: <fpage>1885</fpage>–<lpage>1895</lpage>. <object-id pub-id-type="pmid">12524357</object-id></mixed-citation></ref>
<ref id="pcbi.1004925.ref024"><label>24</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hua</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Xing</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Wu</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Xu</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Sun</surname> <given-names>X</given-names></name>, <etal>et al</etal>. (<year>2003</year>) <article-title>Single-locus heterotic effects and dominance by dominance interactions can adequately explain the genetic basis of heterosis in an elite rice hybrid</article-title>. <source>Proceedings of the National Academy of Sciences</source> <volume>100</volume>: <fpage>2574</fpage>–<lpage>2579</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004925.ref025"><label>25</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zhou</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Yao</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Xie</surname> <given-names>W</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Genetic composition of yield heterosis in an elite rice hybrid</article-title>. <source>Proceedings of the National Academy of Sciences</source> <volume>109</volume>: <fpage>15847</fpage>–<lpage>15852</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004925.ref026"><label>26</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bradbury</surname> <given-names>PJ</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Kroon</surname> <given-names>DE</given-names></name>, <name name-style="western"><surname>Casstevens</surname> <given-names>TM</given-names></name>, <name name-style="western"><surname>Ramdoss</surname> <given-names>Y</given-names></name>, <etal>et al</etal>. (<year>2007</year>) <article-title>TASSEL: software for association mapping of complex traits in diverse samples</article-title>. <source>Bioinformatics</source> <volume>23</volume>: <fpage>2633</fpage>–<lpage>2635</lpage>. <object-id pub-id-type="pmid">17586829</object-id></mixed-citation></ref>
<ref id="pcbi.1004925.ref027"><label>27</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yang</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>SH</given-names></name>, <name name-style="western"><surname>Goddard</surname> <given-names>ME</given-names></name>, <name name-style="western"><surname>Visscher</surname> <given-names>PM</given-names></name> <article-title>GCTA: A Tool for Genome-wide Complex Trait Analysis</article-title>. <source>The American Journal of Human Genetics</source> <volume>88</volume>: <fpage>76</fpage>–<lpage>82</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.ajhg.2010.11.011" xlink:type="simple">10.1016/j.ajhg.2010.11.011</ext-link></comment> <object-id pub-id-type="pmid">21167468</object-id></mixed-citation></ref>
<ref id="pcbi.1004925.ref028"><label>28</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Chang</surname> <given-names>CCC</given-names></name>, <name name-style="western"><surname>Carson</surname> <given-names>C</given-names></name>.; <name name-style="western"><surname>Tellier</surname> <given-names>Laurent C.</given-names></name> <name name-style="western"><surname>A. M.</surname></name>; <name name-style="western"><surname>Vattikuti</surname> <given-names>Shashaank</given-names></name>; <name name-style="western"><surname>Purcell</surname> <given-names>Shaun M.</given-names></name>; <name name-style="western"><surname>Lee</surname> <given-names>James</given-names></name> (<year>2015</year>) <article-title>Second-generation PLINK: rising to the challenge of larger and richer datasets</article-title>. <source>GigaScience</source> <volume>4</volume>.</mixed-citation></ref>
<ref id="pcbi.1004925.ref029"><label>29</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Li</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Wei</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Liu</surname> <given-names>T</given-names></name>, <article-title>Zhao PX GPLEXUS: Enabling Genome-scale Gene Association Network Reconstruction and Analysis for Very Large-scale Expression Data</article-title>. <source>Nucleic Acids Research Under review</source>.</mixed-citation></ref>
<ref id="pcbi.1004925.ref030"><label>30</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Xu</surname> <given-names>S</given-names></name> (<year>2013</year>) <article-title>Genetic Mapping and Genomic Selection Using Recombination Breakpoint Data</article-title>. <source>Genetics</source> <volume>195</volume>: <fpage>1103</fpage>–<lpage>1115</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1534/genetics.113.155309" xlink:type="simple">10.1534/genetics.113.155309</ext-link></comment> <object-id pub-id-type="pmid">23979575</object-id></mixed-citation></ref>
<ref id="pcbi.1004925.ref031"><label>31</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wei</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Xu</surname> <given-names>S</given-names></name> (<year>2016</year>) <article-title>A Random-Model Approach to QTL Mapping in Multiparent Advanced Generation Intercross (MAGIC) Populations</article-title>. <source>Genetics</source> <volume>202</volume>: <fpage>471</fpage>–<lpage>486</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1534/genetics.115.179945" xlink:type="simple">10.1534/genetics.115.179945</ext-link></comment> <object-id pub-id-type="pmid">26715662</object-id></mixed-citation></ref>
</ref-list>
</back>
</article>