<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN">
  <front>
    <journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="publisher">pcbi</journal-id><journal-id journal-id-type="allenpress-id">plcb</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher>
        <publisher-name>Public Library of Science</publisher-name>
        <publisher-loc>San Francisco, USA</publisher-loc>
      </publisher></journal-meta>
    <article-meta><article-id pub-id-type="doi">10.1371/journal.pcbi.0030193</article-id><article-id pub-id-type="publisher-id">07-PLCB-RA-0207R3</article-id><article-id pub-id-type="sici">plcb-03-10-05</article-id><article-categories>
        <subj-group subj-group-type="heading">
          <subject>Research Article</subject>
        </subj-group>
        <subj-group subj-group-type="Discipline">
          <subject>Computational Biology</subject>
          <subject>Genetics and Genomics</subject>
          <subject>Molecular Biology</subject>
        </subj-group>
        <subj-group subj-group-type="System Taxonomy">
          <subject>None</subject>
        </subj-group>
      </article-categories><title-group><article-title>Fast Pairwise Structural RNA Alignments by Pruning of the Dynamical Programming Matrix</article-title><alt-title alt-title-type="running-head">Fast Structural RNA Alignments </alt-title></title-group><contrib-group>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Havgaard</surname>
            <given-names>Jakob H</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Torarinsson</surname>
            <given-names>Elfar</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
          <xref ref-type="aff" rid="aff2">
            <sup>2</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Gorodkin</surname>
            <given-names>Jan</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
          <xref ref-type="corresp" rid="cor1">
            <sup>*</sup>
          </xref>
        </contrib>
      </contrib-group><aff id="aff1">
				<label>1</label><addr-line> Division of Genetics and Bioinformatics, University of Copenhagen, Frederiksberg, Denmark
			</addr-line></aff><aff id="aff2">
				<label>2</label><addr-line> Department of Natural Sciences, University of Copenhagen, Frederiksberg, Denmark
			</addr-line></aff><contrib-group>
        <contrib contrib-type="editor" xlink:type="simple">
          <name name-style="western">
            <surname>Mathews</surname>
            <given-names>David</given-names>
          </name>
          <role>Editor</role>
          <xref ref-type="aff" rid="edit1"/>
        </contrib>
      </contrib-group><aff id="edit1">Center for Human Genetics and Molecular Pediatric Disease, United States of America</aff><author-notes>
        <fn fn-type="con" id="ack1">
          <p>JHH and JG conceived and designed the experiments and wrote the paper. JHH and ET performed the experiments. All authors analyzed the data. JHH contributed reagents/materials/analysis tools.</p>
        </fn>
        <corresp id="cor1">* To whom correspondence should be addressed. E-mail: <email xlink:type="simple">gorodkin@genome.ku.dk</email></corresp>
      <fn fn-type="conflict" id="ack3">
        <p> The authors have declared that no competing interests exist.</p>
      </fn></author-notes><pub-date pub-type="ppub">
        <month>10</month>
        <year>2007</year>
      </pub-date><pub-date pub-type="epub">
        <day>12</day>
        <month>10</month>
        <year>2007</year>
      </pub-date><pub-date pub-type="epreprint">
        <day>20</day>
        <month>8</month>
        <year>2007</year>
      </pub-date><volume>3</volume><issue>10</issue><elocation-id>e193</elocation-id><history>
        <date date-type="received">
          <day>17</day>
          <month>4</month>
          <year>2007</year>
        </date>
        <date date-type="accepted">
          <day>20</day>
          <month>8</month>
          <year>2007</year>
        </date>
      </history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2007</copyright-year><copyright-holder>Havgaard et al</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract>
        <p>It has become clear that noncoding RNAs (ncRNA) play important roles in cells, and emerging studies indicate that there might be a large number of unknown ncRNAs in mammalian genomes. There exist computational methods that can be used to search for ncRNAs by comparing sequences from different genomes. One main problem with these methods is their computational complexity, and heuristics are therefore employed. Two heuristics are currently very popular: pre-folding and pre-aligning. However, these heuristics are not ideal, as pre-aligning is dependent on sequence similarity that may not be present and pre-folding ignores the comparative information. Here, pruning of the dynamical programming matrix is presented as an alternative novel heuristic constraint. All subalignments that do not exceed a length-dependent minimum score are discarded as the matrix is filled out, thus giving the advantage of providing the constraints dynamically. This has been included in a new implementation of the FOLDALIGN algorithm for pairwise local or global structural alignment of RNA sequences. It is shown that time and memory requirements are dramatically lowered while overall performance is maintained. Furthermore, a new divide and conquer method is introduced to limit the memory requirement during global alignment and backtrack of local alignment. All branch points in the computed RNA structure are found and used to divide the structure into smaller unbranched segments. Each segment is then realigned and backtracked in a normal fashion. Finally, the FOLDALIGN algorithm has also been updated with a better memory implementation and an improved energy model. With these improvements in the algorithm, the FOLDALIGN software package provides the molecular biologist with an efficient and user-friendly tool for searching for new ncRNAs. The software package is available for download at <ext-link ext-link-type="uri" xlink:href="http://foldalign.ku.dk" xlink:type="simple">http://foldalign.ku.dk</ext-link>.</p>
      </abstract><abstract abstract-type="summary">
        <title>Author Summary</title>
        <sec id="st1">
          <title/>
          <p>FOLDALIGN is an algorithm for making pairwise structural alignments of RNA sequences. It uses a lightweight energy model and sequence similarity to simultaneously fold and align the sequences. The algorithm can make local and global alignments. The power of structural alignment methods is that they can align sequences where the primary sequences have diverged too much for normal alignment methods to be useful. The structures predicted by structural alignment methods are usually better than the structures predicted by single-sequence folding methods since they can take comparative information into account. The main problem for most structural alignment methods is that they are too computationally expensive. In this paper we introduce the dynamical pruning heuristic that makes the FOLDALIGN method significantly faster without lowering the predictive performance. The memory requirements are also significantly lowered, allowing for the analysis of longer sequences. A user-friendly (still command-line based, though) implementation of the algorithm is available at the Web site: <ext-link ext-link-type="uri" xlink:href="http://foldalign.ku.dk" xlink:type="simple">http://foldalign.ku.dk</ext-link></p>
        </sec>
      </abstract><funding-group><funding-statement>This work was supported by Danish Research Councils (FTP) and the Danish Center for Scientific Computation.</funding-statement></funding-group><counts>
        <page-count count="13"/>
      </counts><!--===== Restructure custom-meta-wrap to custom-meta-group =====--><custom-meta-group>
        <custom-meta>
          <meta-name>citation</meta-name>
          <meta-value>Havgaard JH, Torarinsson E, Gorodkin J (2007) Fast pairwise structural RNA alignments by pruning of the dynamical programming matrix. PLoS Comput Biol 3(10): e193. doi:<ext-link ext-link-type="doi" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.0030193" xlink:type="simple">10.1371/journal.pcbi.0030193</ext-link></meta-value>
        </custom-meta>
      </custom-meta-group></article-meta>
  </front>
  <body>
    <sec id="s1">
      <title>Introduction</title>
      <p>Noncoding RNA (ncRNA) genes and regulatory structures have been shown to be both highly abundant and highly diverse parts of the genome [<xref ref-type="bibr" rid="pcbi-0030193-b001">1</xref>,<xref ref-type="bibr" rid="pcbi-0030193-b002">2</xref>]. One theory is that many of these ncRNAs are part of RNA-based regulatory systems [<xref ref-type="bibr" rid="pcbi-0030193-b003">3</xref>]. Recently, several papers about large-scale searches for vertebrate RNA genes or motifs using comparative genomics have been published [<xref ref-type="bibr" rid="pcbi-0030193-b004">4</xref>–<xref ref-type="bibr" rid="pcbi-0030193-b006">6</xref>]. These large-scale searches indicate that there are potentially many unknown structures still hidden in the genomes.</p>
      <p>It has been shown that alignment of ncRNAs requires information about secondary structure when the sequence similarity is below 60% [<xref ref-type="bibr" rid="pcbi-0030193-b007">7</xref>]. The reason for this is that compensating mutations change the primary sequence without changing the structure of the molecule. The Sankoff algorithm for simultaneously folding and aligning of RNA sequences can in principle be applied to cope with this [<xref ref-type="bibr" rid="pcbi-0030193-b008">8</xref>]. However, the resource requirements of the algorithm are too high even for a few short sequences. For two sequences of length <italic>L</italic>, the time complexity is <italic>O</italic>(<italic>L</italic><sup>6</sup>) and the memory complexity is <italic>O</italic>(<italic>L</italic><sup>4</sup>). Heuristics are therefore needed before the algorithms for folding and aligning RNA sequences become fast enough to be useful.</p>
      <p>FOLDALIGN 1.0 was the first simplified implementation of the Sankoff algorithm [<xref ref-type="bibr" rid="pcbi-0030193-b009">9</xref>]. It contained a simple scoring scheme with separate substitution matrices for base-paired and single-stranded nucleotides. It had three constraints: (i) the length of the final alignment could not be longer than λ nucleotides; (ii) the maximum length difference between two subsequences being aligned was limited to δ nucleotides, and (iii) it could only align stem-loop structures. The second version of the algorithm uses a combination of substitutions (similar to the RIBOSUM matrices [<xref ref-type="bibr" rid="pcbi-0030193-b010">10</xref>]) and a lightweight energy model to align two sequences [<xref ref-type="bibr" rid="pcbi-0030193-b011">11</xref>]. FOLDALIGN 2.0 also uses the λ and δ constraints, but it can align branched structures. This algorithm was used in one of the large-scale searches for vertebrate ncRNAs [<xref ref-type="bibr" rid="pcbi-0030193-b006">6</xref>].</p>
      <p>Variants of two types of heuristics are currently very popular, namely pre-aligning and pre-folding. The pre-aligning methods use sequence similarity to limit the search space by requiring that the final alignment must contain the pre-aligned nucleotides. The length of the pre-aligned subsequences varies from short stretches called anchors [<xref ref-type="bibr" rid="pcbi-0030193-b012">12</xref>] to full sequences [<xref ref-type="bibr" rid="pcbi-0030193-b013">13</xref>–<xref ref-type="bibr" rid="pcbi-0030193-b016">16</xref>]. Methods that require the sequences to be fully aligned before the structure is predicted are not strictly Sankoff-based methods, as they separate the alignment and folding steps completely. Pre-folding uses single-sequence folding to limit the structures that can be found by the comparative algorithms. A popular method of pre-folding is to use base-pairing probabilities found by the single-sequence folding to limit which base pairs can be included in the conserved structure [<xref ref-type="bibr" rid="pcbi-0030193-b017">17</xref>,<xref ref-type="bibr" rid="pcbi-0030193-b018">18</xref>]. As for align-then-fold methods, methods using pre-folding can be taken to the extreme where the folding and alignment steps are completely separated. One example of this is the combination of the RNAcast and the RNAforester methods [<xref ref-type="bibr" rid="pcbi-0030193-b019">19</xref>,<xref ref-type="bibr" rid="pcbi-0030193-b020">20</xref>]. Some methods can use both pre-aligning and pre-folding heuristics [<xref ref-type="bibr" rid="pcbi-0030193-b021">21</xref>–<xref ref-type="bibr" rid="pcbi-0030193-b023">23</xref>].</p>
      <p>The currently implemented Sankoff-based methods, for pairwise alignment and secondary-structure prediction of RNA sequences, can be split into two groups: the energy-based methods and the probabilistic methods. The energy-based methods, FOLDALIGN, Dynalign [<xref ref-type="bibr" rid="pcbi-0030193-b024">24</xref>], locaRNA [<xref ref-type="bibr" rid="pcbi-0030193-b017">17</xref>], and SCARNA [<xref ref-type="bibr" rid="pcbi-0030193-b023">23</xref>], are based on minimization of the free energy [<xref ref-type="bibr" rid="pcbi-0030193-b025">25</xref>]. Free-energy minimization is based on a physical model of how the different elements of an RNA structure contribute to the free energy. The parameters are partly found experimentally and partly estimated from multiple alignments. The probabilistic models are usually based on Stochastic Context Free Grammars (SCFGs); see [<xref ref-type="bibr" rid="pcbi-0030193-b026">26</xref>] for an introduction. These methods include Consan [<xref ref-type="bibr" rid="pcbi-0030193-b012">12</xref>] and Stemloc [<xref ref-type="bibr" rid="pcbi-0030193-b022">22</xref>]. The Stochastic Context Free Grammars parameters are estimated from multiple alignments. Each of these methods uses different kinds of heuristics. The previous version of FOLDALIGN [<xref ref-type="bibr" rid="pcbi-0030193-b011">11</xref>] uses banding (δ, see below), limits the alignment length for local alignments (λ, see below), and limits the number of ways a bifurcation can be calculated (described below). Dynalign [<xref ref-type="bibr" rid="pcbi-0030193-b024">24</xref>] uses banding based on pre-alignment using a hidden Markov model. LocaRNA [<xref ref-type="bibr" rid="pcbi-0030193-b017">17</xref>] limits the number of potential base pairs by only using base pairs with a single-sequence base-pair probability above a given cutoff. SCARNA [<xref ref-type="bibr" rid="pcbi-0030193-b023">23</xref>] uses a similar strategy, but further decouples the left and right sides of the base pairs. Consan [<xref ref-type="bibr" rid="pcbi-0030193-b012">12</xref>] uses short stretches of normal sequence alignments to constrain the folding. Stemloc [<xref ref-type="bibr" rid="pcbi-0030193-b022">22</xref>] uses the <italic>N</italic><sub>1</sub> best single-sequence–predicted structures and the <italic>N</italic><sub>2</sub> best normal-sequence alignments to limit the final combined alignment and structure prediction.</p>
      <p>In this paper, dynamical pruning of the dynamic programming matrix is introduced as a new heuristic in the FOLDALIGN algorithm [<xref ref-type="bibr" rid="pcbi-0030193-b011">11</xref>]. In all its simplicity, the dynamic pruning discards any subalignment that does not have a score above a length-dependent threshold. This is similar to one of the heuristics used in BLAST [<xref ref-type="bibr" rid="pcbi-0030193-b027">27</xref>]. The advantage of the pruning method compared with the pre-aligning methods is that it can be used when there is not enough sequence similarity to make the necessary alignments. The advantage compared with the pre-folding methods is that none of the comparative information is lost in a single-sequence folding step. It is shown empirically that the pruning leads to a huge speed increase while the algorithm retains its good performance. The speed increase makes studies like [<xref ref-type="bibr" rid="pcbi-0030193-b006">6</xref>] much more feasible. The method of dynamical pruning is simple and general. It should therefore be possible to use it in many of the other methods available for folding and aligning RNA sequences. As pruning is a feature of the dynamic programming method, it may be used in any algorithm using dynamic programming.</p>
      <p>In addition to the dynamical pruning, the FOLDALIGN software package has been significantly updated. The constraint, which speeds up the algorithm by limiting the calculation of branch points, is now also used to lower the memory requirement during the local-alignment stage. During the backtrack stage of the algorithm, more information is needed. To try to limit the memory consumption during this stage, an extra pre-backtrack step is used. The pre-backtrack step locates all branch points in the conserved structure, and these are then used to divide the structure into unbranched segments. The unbranched structures are then realigned and backtracked separately. As the unbranched structures usually are shorter than the full branched structure, the memory consumption is reduced. The use of the divide and conquer method increases the run time of the algorithm, but not by much since the realignments of the segments are unbranched.</p>
      <p>In addition to the algorithmic improvements, the energy model has been improved as well. External single-strand nucleotides are scored in a consistent way. Also, more insert base pairs are allowed. These improvements lead to better structure predictions.</p>
    </sec>
    <sec id="s2">
      <title>Results</title>
      <p>FOLDALIGN is a tool for making local or global structural alignments of RNAs [<xref ref-type="bibr" rid="pcbi-0030193-b009">9</xref>,<xref ref-type="bibr" rid="pcbi-0030193-b011">11</xref>,<xref ref-type="bibr" rid="pcbi-0030193-b028">28</xref>–<xref ref-type="bibr" rid="pcbi-0030193-b031">31</xref>]. It uses a combination of sequence similarity and structure to make the alignment. The present article shows how the two main inconveniences, the time and memory requirements, can be drastically lowered without losing the ability to make good alignments.</p>
      <p>The main improvement of the algorithm is the dynamical pruning. The pruning eliminates subalignments that are so poor that they can be assumed to never be a part of a biologically relevant alignment [<xref ref-type="bibr" rid="pcbi-0030193-b027">27</xref>]. The pruning works by eliminating all subalignments with a score below a length-dependent threshold. This not only removes the subalignment itself but also all the longer alignments that the subalignment would have become a part of. Elimination of subalignments also improves the memory performance since it is not necessary to store the eliminated alignments. The dynamical pruning method is general to the dynamic programming method, and it should therefore be trivial to use it in other applications where dynamic programming is used. Note however, that when pruning is used there is no guarantee that the solution is the optimal solution, and in some cases a solution is not found at all. In these rare cases pruning is not feasible, but FOLDALIGN can provide an alignment by realigning without pruning.</p>
      <p>The memory requirement of the algorithm is further lowered by exploiting the branch point constraint. In [<xref ref-type="bibr" rid="pcbi-0030193-b011">11</xref>] the calculation of branch points was limited to one calculation for equivalent alignments/structures. This speeds up the algorithm significantly. Here, it is also used to lower the memory requirement; see below and the Memory implementation section of <xref ref-type="supplementary-material" rid="pcbi-0030193-sd001">Protocol S1</xref>.</p>
      <p>Much effort has been put into trying, during backtrack, to keep the memory requirement below what is needed during the initial local-alignment scan. This is done by using a divide and conquer scheme that first locates all branch points in the structure, and then uses them to divide the structure into hopefully shorter unbranched segments. These segments are then backtracked normally. While this strategy usually works, there is no guarantee that it will always keep the memory usage low during backtrack. One clear example where it does not work is in the case of an unbranched alignment. A cubic space model similar to the linear space models [<xref ref-type="bibr" rid="pcbi-0030193-b032">32</xref>,<xref ref-type="bibr" rid="pcbi-0030193-b033">33</xref>] used in sequence alignment could be used to keep the memory requirement below a given cutoff. A method similar to the Treeterbi method [<xref ref-type="bibr" rid="pcbi-0030193-b034">34</xref>], of locating and removing memory cells that are not part of final alignment during the alignment step, could also be used to limit the memory consumption during the realignment of stem segments.</p>
      <sec id="s2a">
        <title>Algorithms and Heuristics</title>
        <p>The algorithm uses a lightweight energy model based on energy minimization [<xref ref-type="bibr" rid="pcbi-0030193-b011">11</xref>,<xref ref-type="bibr" rid="pcbi-0030193-b025">25</xref>] and sequence similarity to simultaneously fold and align two sequences. The energy model has five different contexts: stem, hairpin-loop, bulge-loop, internal-loop, and external/bifurcated-loop. In the stem context, two pairs of nucleotides are allowed to base-pair if both pairs can form an <italic>A</italic> ⇔ <italic>U</italic>, <italic>C</italic> ⇔ <italic>G</italic>, or <italic>G</italic> ⇔ <italic>U</italic> base pair. A stem must always start with such a conserved base pair, but if the stem is already at least one base-pair long, then a base pair in one of the sequences can be aligned to two gaps in the other sequence. A stem must contain at least two conserved base pairs. The four other contexts are used to align unpaired nucleotides; see <xref ref-type="supplementary-material" rid="pcbi-0030193-sd001">Protocol S1</xref> and [<xref ref-type="bibr" rid="pcbi-0030193-b011">11</xref>] for details. The parameters of the energy model have all been multiplied by −10 mol/kcal to allow the maximization of the alignment score [<xref ref-type="bibr" rid="pcbi-0030193-b011">11</xref>]. Different sequence similarity substitution scores are used for base-paired nucleotides and single-stranded nucleotides [<xref ref-type="bibr" rid="pcbi-0030193-b010">10</xref>,<xref ref-type="bibr" rid="pcbi-0030193-b011">11</xref>]. Affine gap penalties are also used.</p>
        <p>The alignment of two sequences <italic>I</italic> and <italic>K</italic> is initiated by aligning one nucleotide from each sequence to another. These are then expanded into longer alignments using dynamic programming. The central part of the recursion can be seen below. A more complete recursion can be seen in the recursion section of <xref ref-type="supplementary-material" rid="pcbi-0030193-sd001">Protocol S1</xref>.
					<disp-formula id="pcbi-0030193-e001"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030193.e001" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>&equals;</mml:mo><mml:mi>max</mml:mi><mml:mrow><mml:mo stretchy='true'>&lcub;</mml:mo><mml:mrow><mml:mtable columnalign='left'><mml:mtr columnalign='left'><mml:mtd columnalign='left'><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>&plus;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&plus;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&plus;</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo stretchy='false'>(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>&sigma;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>&plus;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&plus;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy='false'>)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign='left'><mml:mrow><mml:mo stretchy='false'>(</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy='false'>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign='left'><mml:mtd columnalign='left'><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>&plus;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>&plus;</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mo stretchy='false'>(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo>&minus;</mml:mo><mml:mo>,</mml:mo><mml:mo>&minus;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>&sigma;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>&plus;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo stretchy='false'>)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign='left'><mml:mrow><mml:mo stretchy='false'>(</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy='false'>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign='left'><mml:mtd columnalign='left'><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&plus;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&plus;</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mo stretchy='false'>(</mml:mo><mml:mo>&minus;</mml:mo><mml:mo>,</mml:mo><mml:mo>&minus;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>&sigma;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&plus;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy='false'>)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign='left'><mml:mrow><mml:mo stretchy='false'>(</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy='false'>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign='left'><mml:mtd columnalign='left'><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>&plus;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&plus;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>&plus;</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo stretchy='false'>(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>&sigma;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>&plus;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&plus;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo stretchy='false'>)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign='left'><mml:mrow><mml:mo stretchy='false'>(</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy='false'>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign='left'><mml:mtd columnalign='left'><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&plus;</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy='false'>(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>&sigma;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy='false'>)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign='left'><mml:mrow><mml:mo stretchy='false'>(</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy='false'>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign='left'><mml:mtd columnalign='left'><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>&plus;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>&plus;</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mi>l</mml:mi><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mo stretchy='false'>(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo>&minus;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>&sigma;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>&plus;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo stretchy='false'>)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign='left'><mml:mrow><mml:mo stretchy='false'>(</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy='false'>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign='left'><mml:mtd columnalign='left'><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>&plus;</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mi>r</mml:mi><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mo stretchy='false'>(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo>&minus;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>&sigma;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo stretchy='false'>)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign='left'><mml:mrow><mml:mo stretchy='false'>(</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy='false'>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign='left'><mml:mtd columnalign='left'><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&plus;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>&plus;</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mi>l</mml:mi><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mo stretchy='false'>(</mml:mo><mml:mo>&minus;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>&sigma;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&plus;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo stretchy='false'>)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign='left'><mml:mrow><mml:mo stretchy='false'>(</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy='false'>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign='left'><mml:mtd columnalign='left'><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&plus;</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mi>r</mml:mi><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mo stretchy='false'>(</mml:mo><mml:mo>&minus;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>&sigma;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy='false'>)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign='left'><mml:mrow><mml:mo stretchy='false'>(</mml:mo><mml:mi>I</mml:mi><mml:mo stretchy='false'>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign='left'><mml:mtd columnalign='left'><mml:mrow><mml:munder><mml:mrow><mml:mi>max</mml:mi></mml:mrow><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>m</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>k</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>n</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:munder><mml:mo>&lcub;</mml:mo><mml:msubsup><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:msub><mml:mo>&prime;</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:msubsup><mml:mo>&plus;</mml:mo><mml:msubsup><mml:mi>D</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>&prime;</mml:mo><mml:msub><mml:mspace width='2pt'/><mml:mo>&plus;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>&plus;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:msubsup><mml:mo>&plus;</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>b</mml:mi><mml:mi>l</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>&rcub;</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign='left'><mml:mrow><mml:mo stretchy='false'>(</mml:mo><mml:mspace width='2pt'/><mml:mi>J</mml:mi><mml:mo stretchy='false'>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:math> --></disp-formula>
				</p>
        <p><italic>D<sub>i,j,k,l</sub></italic> is the score of an alignment of subsequence (<italic>i</italic>,<italic>j</italic>) from sequence <italic>I</italic> to subsequence (<italic>k</italic>,<italic>l</italic>) from sequence <italic>K</italic>. <italic>S<sub>bp</sub></italic> through <italic>S<sub>grK</sub></italic> are the costs of adding one or more nucleotides to the alignment. σ is the structure context. <italic>i</italic> &amp; <italic>j</italic>, <italic>k</italic> &amp; <italic>l</italic>, are the start and end coordinates of a subalignment in sequence <italic>I</italic> and <italic>K</italic>, respectively. <italic>n<sub>i</sub></italic> is the nucleotide at position <italic>i</italic> (in sequence <italic>I</italic>). Likewise for <italic>n<sub>j</sub>, n<sub>k</sub>,</italic> and <italic>n<sub>l</sub></italic><sub>.</sub> Here, unpaired nucleotides in branched loops are scored like unpaired nucleotides in external loops. Therefore, the alignment score <italic>D</italic> must be corrected if the context is not the external loop context. The score including this correction is called <italic>D</italic>′, and it is not necessary to store it in memory since it is easily calculated from <italic>D</italic>; see <xref ref-type="supplementary-material" rid="pcbi-0030193-sd001">Protocol S1</xref>. <italic>C<sub>mblhelix</sub></italic> is a cost for adding extra stems.</p>
        <p><xref ref-type="disp-formula" rid="pcbi-0030193-e001">Equation 1</xref>A adds a base pair in both structures. <xref ref-type="disp-formula" rid="pcbi-0030193-e001">Equations 1</xref>B–<xref ref-type="disp-formula" rid="pcbi-0030193-e001">1</xref>C add base-pair inserts in either of the structures. <xref ref-type="disp-formula" rid="pcbi-0030193-e001">Equations 1</xref>D–<xref ref-type="disp-formula" rid="pcbi-0030193-e001">1</xref>E add aligned unpaired nucleotides in either end of the alignment. <xref ref-type="disp-formula" rid="pcbi-0030193-e001">Equations 1</xref>F–<xref ref-type="disp-formula" rid="pcbi-0030193-e001">1</xref>I add an unpaired nucleotide aligned to a gap to the alignment. <xref ref-type="disp-formula" rid="pcbi-0030193-e001">Equation 1</xref>J is the bifurcation case which joins two substructures into one in each of the structures. <xref ref-type="fig" rid="pcbi-0030193-g001">Figure 1</xref> gives an overview of the different Equation 1 cases.</p>
        <fig id="pcbi-0030193-g001" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.0030193.g001</object-id>
          <label>Figure 1</label>
          <caption>
            <title>The Cases of <xref ref-type="disp-formula" rid="pcbi-0030193-e001">Equation 1</xref></title>
            <p>(A) Adds a conserved basepair. In the structure, a conserved basepair is indicated using ( and ).</p>
            <p>(B) Adds aligned unpaired nucleotides. An insert basepair is indicated using &lt; and &gt;.</p>
            <p>(D) Adds aligned unpaired nucleotides. An unpaired nucleotide is indicated with a “.”.</p>
            <p>(F) Adds unpaired insert nucleotides.</p>
            <p>(J) <xref ref-type="disp-formula" rid="pcbi-0030193-e001">Equation 1</xref>J (shown) joins substructures into one structure. Due to the bifurcation constraint, the nucleotide at position <italic>i</italic> must be basepaired to a nucleotide in the subsequence from <italic>I</italic> + 1,...,<italic>m</italic>, and the nucleotides at position <italic>m</italic> + 1 and <italic>j</italic> must also basepair. The same constraints are placed on the corresponding nucleotides in the other sequence. See <xref ref-type="fig" rid="pcbi-0030193-g002">Figure 2</xref> for extra details.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030193.g001" xlink:type="simple"/>
        </fig>
        <fig id="pcbi-0030193-g002" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.0030193.g002</object-id>
          <label>Figure 2</label>
          <caption>
            <title>The Bifurcation Constraint</title>
            <p>(A) The allowed case. The first nucleotides of the left substructures in both sequence 1 and sequence 2 are basepaired, and the first and last nucleotides in the right substructures are basepaired to each other.</p>
            <p>(B) A disallowed case. The score of the joined alignment will not be calculated using the bifurcation-loop calculation (the resulting alignment will, however, be calculated by expanding the alignment result from (A). There are two reasons: the first nucleotide of the left substructure in sequence 2 is not basepaired, and the first and the last nucleotides of the right substructures are not basepaired in both sequences.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030193.g002" xlink:type="simple"/>
        </fig>
        <p>In addition to the new pruning constraint (see below), the algorithm employs three old constraints. 1) The maximum motif length constraint λ limits the maximum length of the subsequences in the resulting alignment (the final alignment can only be longer than λ due to gaps). The use of λ allows the program to split the shortest of the sequences into smaller chunks and scan a λ nucleotide–long window along the other. For details see [<xref ref-type="bibr" rid="pcbi-0030193-b011">11</xref>]. 2) The maximum length difference between any two subsequences is constrained to δ nucleotides. These two constraints reduce the time complexity to a maximum of <italic>O</italic>(<italic>L<sub>I</sub>L<sub>K</sub>λ</italic><sup>2</sup><italic>δ</italic><sup>2</sup>) and the memory complexity to a maximum of <italic>O</italic>(<italic>λ</italic><sup>3</sup><italic>δ)</italic>. L<sub>I</sub> and L<sub>K</sub> are the lengths of the sequences. 3) The bifurcation constraint limits the types of substructures that can be joined together in the case of <xref ref-type="disp-formula" rid="pcbi-0030193-e001">Equation 1</xref>J. The constraint requires that the first nucleotide of each of the two (one from each sequence) upstream substructures, <italic>D<sub>i</sub></italic><sub>,<italic>m</italic>,<italic>k</italic>,<italic>n</italic></sub>, are base-paired. Furthermore, the end nucleotides of the downstream structures, <italic>D<sub>m</sub></italic><sub>+1,<italic>j</italic>,<italic>n</italic>+1,l</sub>, must form a base pair with each other, see <xref ref-type="fig" rid="pcbi-0030193-g002">Figure 2</xref>. In [<xref ref-type="bibr" rid="pcbi-0030193-b011">11</xref>], the bifurcation constraint was used to save time, but here it is also used to save memory. Inspection of <xref ref-type="disp-formula" rid="pcbi-0030193-e001">Equation 1</xref> shows that the cases A–I only depend on the scores of alignments with either coordinate <italic>i</italic> or coordinate <italic>i</italic> + 1. Case J depends on subalignments with start coordinates <italic>i</italic> and coordinates <italic>i</italic> &lt; <italic>m + 1</italic> &lt; <italic>j</italic>. Due to the bifurcation constraint, all alignments with start coordinate <italic>m + 1</italic> must have the stem context. It is therefore not necessary to keep information about alignments in any other context for coordinates <italic>i</italic> + 2,...,<italic>i</italic> + λ. This saves a large amount of memory, but leads to trouble during backtrack, see below. Further details can be found in the Memory implementation section of <xref ref-type="supplementary-material" rid="pcbi-0030193-sd001">Protocol S1</xref>.</p>
        <p>The new implementation of the FOLDALIGN algorithm has a lower time and memory complexity than the old implementation during global alignment. Since a global alignment must include both ends of both sequences, the δ parameter can be used to also limit the start coordinate of a subalignment in the second sequence. In this way the δ parameter becomes similar to the <italic>M</italic> parameter as used in [<xref ref-type="bibr" rid="pcbi-0030193-b035">35</xref>]. The new time complexity is <inline-formula id="pcbi-0030193-ex001"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0030193.ex001" xlink:type="simple"/></inline-formula>
					 and the memory complexity is <inline-formula id="pcbi-0030193-ex002"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0030193.ex002" xlink:type="simple"/></inline-formula>
					, where <italic>L<sub>min</sub> = min</italic>{<italic>L<sub>I</sub>, L<sub>K</sub></italic>}. The old implementation has a time complexity of <inline-formula id="pcbi-0030193-ex003"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0030193.ex003" xlink:type="simple"/></inline-formula>
					 and a memory complexity of <inline-formula id="pcbi-0030193-ex004"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0030193.ex004" xlink:type="simple"/></inline-formula>
					 since it used the local-alignment algorithm with λ equal to the sequence lengths.
				</p>
        <sec id="s2a1">
          <title>Changes in the energy model.</title>
          <p>There are three changes in the energy model compared with [<xref ref-type="bibr" rid="pcbi-0030193-b011">11</xref>]. Single-stranded nucleotides, external to all base pairs, are now always scored in the same way, namely as single-stranded nucleotides in multibranched loops; see for example the “Development and References” document at the mfold Web site <ext-link ext-link-type="uri" xlink:href="http://frontend.bioinfo.rpi.edu/zukerm/rna/energy/node2.html#SECTION20" xlink:type="simple">http://frontend.bioinfo.rpi.edu/zukerm/rna/energy/node2.html#SECTION20</ext-link> [<xref ref-type="bibr" rid="pcbi-0030193-b025">25</xref>,<xref ref-type="bibr" rid="pcbi-0030193-b036">36</xref>]. This includes the affine energy cost which is usually not used in the calculation of the energy of external nucleotides. The inclusion of this cost helps keep multibranched and external loops from growing unchecked. See also the release file of the software package. Inserted base pairs are now allowed at all positions in a stem except for the first base pair. The stem must still have at least two conserved base pairs. Single-strand nucleotides in multibranched loops that are next to base-paired nucleotides are no longer stacked, i.e., dangling ends are no longer used. The performance gained by using dangling ends does not justify the complexity that they add to the algorithm.</p>
        </sec>
        <sec id="s2a2">
          <title>Pruning.</title>
          <p>The dynamical programming matrix, <italic>D</italic>, is pruned as it is being filled out by comparing the FOLDALIGN score <italic>D<sub>i,j,k,l</sub></italic> of a subalignment to a threshold, Θ<italic><sub>local</sub></italic>. Thus, for local alignments, if
						<disp-formula id="pcbi-0030193-e002"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030193.e002" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>&Thetas;</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mi>I</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width='3pt'/><mml:mtext>or </mml:mtext><mml:mspace width='3pt'/><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>&Thetas;</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mi>K</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math> --></disp-formula><italic>D<sub>i,j,k,l</sub></italic> is not stored in the memory. An alignment that has been pruned away cannot be part of any longer alignments, and it is therefore not necessary to take it into account when the longer alignments are calculated. This saves a lot of time. Note that the alignment score is maximized not minimized. For additional details, see the Memory implementation section in <xref ref-type="supplementary-material" rid="pcbi-0030193-sd001">Protocol S1</xref>. Note that Θ<italic><sub>local</sub></italic> depends on the lengths <italic>l<sub>I</sub></italic> and <italic>l<sub>K</sub></italic> of the subsequences being aligned. To find the exact length dependency, several schemes were tested, and we found that a simple linear form with Θ<italic><sub>local</sub> = a * min</italic>{<italic>l<sub>I</sub>,l<sub>K</sub></italic>} <italic>+ b</italic> worked well. The parameters <italic>a</italic> and <italic>b</italic> were found using the dataset containing 99 sequence pairs described in the data section of <xref ref-type="sec" rid="s4">Materials and Methods</xref>. The default values can be seen in <xref ref-type="table" rid="pcbi-0030193-t001">Table 1</xref>. The linear dependency is not surprising as the alignment score is expected to grow linearly with the alignment length [<xref ref-type="bibr" rid="pcbi-0030193-b037">37</xref>].
					</p>
          <table-wrap content-type="1col" id="pcbi-0030193-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030193.t001</object-id><label>Table 1</label><caption>
              <p>The Parameters of the Default Score Matrices for Local and Global Alignment</p>
            </caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030193.t001" xlink:type="simple"/><!-- <table frame="hsides" rules="none"><colgroup><col id="tb1col1" align="left" charoff="0" char=""/><col id="tb1col2" align="left" charoff="0" char=""/><col id="tb1col3" align="left" charoff="0" char=""/><col id="tb1col4" align="char" charoff="0" char="."/><col id="tb1col5" align="left" charoff="0" char=""/><col id="tb1col6" align="left" charoff="0" char=""/><col id="tb1col7" align="left" charoff="0" char=""/></colgroup><thead><tr><td align="left"><hr/>Alignment</td><td><hr/>Cluster</td><td><hr/>Weight</td><td><hr/>Gap Open</td><td><hr/>Elongation (G<sub>E</sub>)</td><td><hr/>Pruning Start (<italic>b</italic>)</td><td><hr/>Coefficient (<italic>a</italic>)</td></tr></thead><tbody><tr><td>Local</td><td>None</td><td>0.1</td><td>&minus;110</td><td>&minus;55</td><td>&minus;400</td><td>1</td></tr><tr><td>Global</td><td>None</td><td>0.05</td><td>&minus;50</td><td>&minus;25</td><td>&minus;200</td><td>1</td></tr></tbody></table> --><!-- <table-wrap-foot><fn id="nt101"><p>The Cluster is the Ribosum clustering value. In both cases, each sequence was put into its own cluster.</p></fn><fn id="nt102"><p>Weight is applied to the values of the substitution matrices.</p></fn><fn id="nt103"><p>Gap open values are the cost of opening new gaps.</p></fn><fn id="nt104"><p>Elongation value is the cost of elongating an already opened gap.</p></fn><fn id="nt105"><p>Pruning start is the pruning threshold for alignments with subsequences of length one. The pruning threshold grows linearly with the length of the aligned subsequences.</p></fn><fn id="nt106"><p>Coefficient is the linear growth coefficient.</p></fn></table-wrap-foot> --></table-wrap>
          <p>Since a global alignment extends over the entire sequence length, it is necessary to insert a minimum number of gaps, equal to the length difference between the sequences. The simple pruning scheme used during local alignment was found to be too strict, pruning away all subalignments in many cases. The following pruning scheme is therefore used during global alignment:
						<disp-formula id="pcbi-0030193-e003"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030193.e003" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>&Thetas;</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>b</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>&equals;</mml:mo><mml:msub><mml:mi>&Thetas;</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mi>I</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mi>K</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&plus;</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>E</mml:mi></mml:msub><mml:mo>&times;</mml:mo><mml:mi>min</mml:mi><mml:mspace width='2pt'/><mml:mrow><mml:mo>&lcub;</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi><mml:mi>s</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mi>I</mml:mi></mml:msub><mml:mo>&minus;</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mi>K</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mi>b</mml:mi><mml:mi>s</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>I</mml:mi></mml:msub><mml:mo>&minus;</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>K</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>&rcub;</mml:mo></mml:mrow></mml:mrow></mml:math> --></disp-formula>
					</p>
          <p>Θ<italic><sub>global</sub></italic> is the pruning score used during global alignment. Θ<italic><sub>local</sub></italic> is the local-alignment pruning score (<xref ref-type="disp-formula" rid="pcbi-0030193-e002">Equation 2</xref>). <italic>G<sub>E</sub></italic> is the gap-elongation cost. It should be noted that a new set of <italic>a</italic> and <italic>b</italic> is used. These were found using the tRNA and 5S rRNA datasets described in <xref ref-type="sec" rid="s4">Materials and Methods</xref>. The default values can be seen in <xref ref-type="table" rid="pcbi-0030193-t001">Table 1</xref>. See further discussion in the Global-Alignment Results section.</p>
        </sec>
        <sec id="s2a3">
          <title>Backtrack.</title>
          <p>When the coordinates of the best-scoring local alignment have been found, the dynamic programming matrix may no longer cover the sequence region of the best hit. The subsequences must therefore be realigned. This realignment is a global alignment of the two subsequences, and the time and memory complexities are therefore the same as for global alignment. While the theoretical memory complexity is lower during backtrack than during local alignment, the actual memory requirement is usually larger. This is because during backtrack it is necessary to trace back through all the cells in the four-dimensional matrix that were passed during the alignment. It is therefore necessary to store information for all subalignments regardless of the basepairing, i.e., the bifurcation constraint cannot be used to save memory. Subalignments that have been pruned can still be pruned since the backtrack cannot pass through a pruned subalignment.</p>
          <p>A strategy somewhat similar to the divide and conquer strategy in [<xref ref-type="bibr" rid="pcbi-0030193-b038">38</xref>] is used to try to circumvent this problem. The strategy is shown in <xref ref-type="fig" rid="pcbi-0030193-g003">Figure 3</xref>. After the region of interest has been found using a local alignment, the next step is to realign the subsequences. During this realignment, a list of all bifurcation points is saved. For each subalignment, a reference to the last bifurcation point in that given alignment is kept. In addition to all the subalignments with stem context, subalignments with bifurcation context are also stored for <italic>i</italic> + 2,...<italic>i</italic> + λ. This is used to do a pre-backtrack which locates all bifurcation points in the alignment. With all the bifurcation points located, the alignment is divided into a series of hopefully shorter unbranched subalignments. These are then realigned, saving all subalignments for all <italic>i</italic>'s, and backtracked in a normal fashion. The realignment of the unbranched subalignments is fast since it is not necessary to evaluate the bifurcation part of the algorithm. The time complexity of each of these realignments is therefore <inline-formula id="pcbi-0030193-ex005"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0030193.ex005" xlink:type="simple"/></inline-formula>
						, where <italic>λ<sub>u</sub></italic> is the length of the unbranched subalignment.
					</p>
          <fig id="pcbi-0030193-g003" position="float">
            <object-id pub-id-type="doi">10.1371/journal.pcbi.0030193.g003</object-id>
            <label>Figure 3</label>
            <caption>
              <title>The Divide and Conquer Algorithm</title>
              <p>(1) In the first step, the region of interest is found using the local-alignment algorithm. During the local alignment, the bifurcation constraint is used to save a lot of memory.</p>
              <p>(2) In the second step (first step of a global alignment), the region of interest is realigned. The bifurcation constraint is still used, but an additional list of branch points is made. The list stores the six coordinates of the branch point and pointers to the next branch points (one for each of the two substructures). For each subalignment, a pointer to the last branch point is kept.</p>
              <p>(3) Using the branch point pointers and coordinates, the alignment is split into shorter unbranched segments. Here A is an initial unbranched segment. MBP 1 (Multi Branch Point) splits the alignment into two segments: EDC and B. C is a new initial unbranched segment. MBP 2 splits the ED segment into the E and D segments.</p>
              <p>(4) The five segments are realigned and backtrack without using the bifurcation constraint to save memory. These realignments are fast, as it is not necessary to evaluate the bifurcation part of the algorithm. Finally, the segments are joined together into the final alignment.</p>
            </caption>
            <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030193.g003" xlink:type="simple"/>
          </fig>
        </sec>
      </sec>
      <sec id="s2b">
        <title>Local-Alignment Results</title>
        <p><xref ref-type="fig" rid="pcbi-0030193-g004">Figures 4</xref> and <xref ref-type="fig" rid="pcbi-0030193-g005">5</xref> show the average time and memory needed to locally align two 1,000 nucleotides–long sequences with different values of λ using different versions of FOLDALIGN. The “real data” curves are for sequence pairs that contain a ∼300 nucleotides–long SRP gene in its genomic context. The “shuffled data” curve is for the same sequence pairs shuffled while conserving the dinucleotide distribution [<xref ref-type="bibr" rid="pcbi-0030193-b039">39</xref>]; for details about the dataset see [<xref ref-type="bibr" rid="pcbi-0030193-b011">11</xref>]. The curve marked “2.0” is for the previous version of FOLDALIGN. The “No pruning” curve is for the current version using the option -no_pruning which turns off the pruning. The “Pruning” curves are for the current version using the default pruning.</p>
        <fig id="pcbi-0030193-g004" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.0030193.g004</object-id>
          <label>Figure 4</label>
          <caption>
            <title>The Average Run Time</title>
            <p>(A) Time requirements as a function of λ. The “real data” curves were made using a SRP dataset. It contains eight pairs of 1,000 nucleotide-long sequences. Each sequence contains one SRP gene with a length of approximately 300 nucleotides. The “shuffled data” curve was made using shuffled versions of the same dataset. The “2.0” curves were made using the previous version of the program. “No pruning” curves were made using the current version, but without pruning (option -no_pruning). “Pruning” curves were made using the current version and default values of pruning. It is clear that the time needed to make the alignments explodes when pruning is not used, whereas the run time remains much lower when pruning is used.</p>
            <p>(B) The pruning curves with a smaller time scale. The curve for the sequences containing a motif grows much faster than the curves for the shuffled sequences until the point where λ is as long as the motif. After this, the curves appear to grow at the same rate.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030193.g004" xlink:type="simple"/>
        </fig>
        <fig id="pcbi-0030193-g005" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.0030193.g005</object-id>
          <label>Figure 5</label>
          <caption>
            <title>The Average Memory Requirements</title>
            <p>Memory requirements as a function of λ. See <xref ref-type="fig" rid="pcbi-0030193-g004">Figure 4</xref> for details.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030193.g005" xlink:type="simple"/>
        </fig>
        <p><xref ref-type="fig" rid="pcbi-0030193-g004">Figure 4</xref> shows that the dynamical pruning has a dramatical impact on the run time of the algorithm. Especially in the case of shuffled sequences where there are no conserved motifs. This is very important during large-scale searches for ncRNAs where a large amount of sequences, many of which do not contain a motif, are aligned [<xref ref-type="bibr" rid="pcbi-0030193-b006">6</xref>]. When there is a conserved motif, the speedup is slightly less pronounced, but it is still very drastic. Comparing the “2.0” and the “No pruning” curves, it is also clear that the new implementation is a lot faster even without pruning. The time needed to run the 99 sequence pair dataset used for finding the parameters (pairs of 500 nucleotide–long sequences, see <xref ref-type="sec" rid="s4">Materials and Methods</xref>; λ = 200, δ = 15) dropped from ∼397 CPU hours to ∼9 CPU hours.</p>
        <p><xref ref-type="fig" rid="pcbi-0030193-g005">Figure 5</xref> shows that pruning also has a significant impact on the required memory. It also shows that it is now possible to align sequences using much larger λ. It is clear from <xref ref-type="fig" rid="pcbi-0030193-g005">Figure 5</xref> that more memory is required for aligning sequences that contain a conserved structure than for aligning sequences without conserved structures.</p>
        <p>The parameters of the algorithm can be split into three groups: Energy, Substitution, and Free. The energy parameters are taken from energy minimization (multiplied by −10 mol/kcal, since we are maximizing a score) [<xref ref-type="bibr" rid="pcbi-0030193-b025">25</xref>]; see also the release notes of the software package. The substitution scores are the Ribosum-like log odds scores with one set of scores for single-stranded nucleotides and one for base-paired nucleotides. There are four free parameters: the Ribosum clustering percentage, the gap open, the gap-elongation penalties, and the energy-substitution weight. To simplify the search for the best set of parameters, the gap-elongation parameter was fixed at half the value of the gap-open parameter. The best values for the parameters were found by aligning the 99 sequence dataset using a range of values for each of the free parameters and choosing the values yielding the best performance. The parameters can be seen in <xref ref-type="table" rid="pcbi-0030193-t001">Table 1</xref>. See <xref ref-type="sec" rid="s4">Materials and Methods</xref> and [<xref ref-type="bibr" rid="pcbi-0030193-b011">11</xref>] for details about the data.</p>
        <p>To get the background distribution, each sequence was shuffled 20 times conserving the dinucleotide distribution [<xref ref-type="bibr" rid="pcbi-0030193-b039">39</xref>] (see <xref ref-type="sec" rid="s4">Materials and Methods</xref>). The extreme value distribution parameters were averaged independently for each of the sequences. The parameters found from the alignment of shuffled sequences were then used to estimate the significance of the alignments from the real sequences pairs. A <italic>p</italic>-value (see <xref ref-type="sec" rid="s4">Materials and Methods</xref>) cutoff of 0.2 was found to be optimal for selecting the significant alignments. The performances (see <xref ref-type="sec" rid="s4">Materials and Methods</xref>) on the 99 sequence dataset can be seen in <xref ref-type="table" rid="pcbi-0030193-t002">Table 2</xref>. While this method for determining the parameters of the extreme value distribution is biased in several ways, most notably by the use of short sequences compared with the expected length of a random alignment and the finite length effects, the method does seem to yield reasonable results. Fewer than 20 shufflings can be used with little effect on the performance (unpublished data).</p>
        <table-wrap content-type="1col" id="pcbi-0030193-t002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030193.t002</object-id><label>Table 2</label><caption>
            <p>The Localization Performance</p>
          </caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030193.t002" xlink:type="simple"/><!-- <table frame="hsides" rules="none"><colgroup><col id="tb2col1" align="left" charoff="0" char=""/><col id="tb2col2" align="char" charoff="0" char="."/><col id="tb2col3" align="char" charoff="0" char="."/><col id="tb2col4" align="char" charoff="0" char="."/><col id="tb2col5" align="left" charoff="0" char=""/><col id="tb2col6" align="left" charoff="0" char=""/><col id="tb2col7" align="char" charoff="0" char="."/><col id="tb2col8" align="char" charoff="0" char="."/><col id="tb2col9" align="char" charoff="0" char="."/><col id="tb2col10" align="left" charoff="0" char=""/><col id="tb2col11" align="left" charoff="0" char=""/></colgroup><thead><tr><td align="left">Family</td><td colspan="5"><hr/>No Pruning</td><td colspan="5"><hr/>Pruning</td></tr><tr><td><hr/></td><td><hr/><italic>P<sub>t</sub></italic></td><td><hr/><italic>P<sub>f</sub></italic></td><td><hr/><italic>N<sub>f</sub></italic></td><td><hr/>PPV</td><td><hr/>Sens</td><td><hr/><italic>P<sub>t</sub></italic></td><td><hr/><italic>P<sub>f</sub></italic></td><td><hr/><italic>N<sub>f</sub></italic></td><td><hr/>PPV</td><td><hr/>Sens</td></tr></thead><tbody><tr><td>5S rRNA</td><td>2</td><td>0</td><td>0</td><td>1.00</td><td>1.00</td><td>2</td><td>0</td><td>0</td><td>1.00</td><td>1.00</td></tr><tr><td>Purine</td><td>3</td><td>2</td><td>2</td><td>0.60</td><td>0.60</td><td>3</td><td>2</td><td>2</td><td>0.60</td><td>0.60</td></tr><tr><td>THI</td><td>12</td><td>11</td><td>9</td><td>0.52</td><td>0.57</td><td>13</td><td>11</td><td>8</td><td>0.54</td><td>0.62</td></tr><tr><td>U1</td><td>6</td><td>1</td><td>0</td><td>0.86</td><td>1.00</td><td>6</td><td>1</td><td>0</td><td>0.86</td><td>1.00</td></tr><tr><td>tRNA</td><td>171</td><td>75</td><td>72</td><td>0.70</td><td>0.70</td><td>165</td><td>72</td><td>78</td><td>0.70</td><td>0.68</td></tr><tr><td>Unknown</td><td>12</td><td>13</td></tr><tr><td>Average</td><td>0.74</td><td>0.77</td><td>0.74</td><td>0.78</td></tr></tbody></table> --><!-- <table-wrap-foot><fn id="nt201"><p>The localization performance for the datasets used to select the local-alignment parameters.</p></fn><fn id="nt202"><p>No Pruning shows the performance when pruning is not used.</p></fn><fn id="nt203"><p>Pruning shows the performance when pruning is used.</p></fn><fn id="nt204"><p><italic>P<sub>t</sub></italic> is the number of true positive genes or UTR elements predicted.</p></fn><fn id="nt205"><p><italic>P<sub>f</sub></italic> is the number of false positive genes predicted. Most of these can be assigned a Type, but those that cannot are counted as Unknown.</p></fn><fn id="nt206"><p><italic>N<sub>f</sub></italic> is the number of missed genes or UTR elements.</p></fn><fn id="nt207"><p><italic>PPV &equals; P<sub>t</sub> /</italic> (<italic>P<sub>t</sub> &plus; P<sub>f</sub></italic>) is the positive predictive value.</p></fn><fn id="nt208"><p><italic>Sens &equals; P<sub>f</sub></italic> / ( <italic>P<sub>t</sub> &plus; N<sub>f</sub></italic>) is the sensitivity.</p></fn></table-wrap-foot> --></table-wrap>
        <p>The SRP dataset was used as an independent test set. The extreme value distribution parameters were estimated from the alignment of 20 shufflings of each sequence pair and a <italic>p</italic>-value cutoff of 0.2 was used. This yielded eight out of eight SRP genes, and three false positive alignments. The estimated <italic>p</italic>-value of the eight true hits is &lt;0.0005. The <italic>p</italic>-values of the three false positives are &lt;0.0005, 0.069, and 0.134. The positive predictive value, <italic>PPV</italic>, is 0.73, and the sensitivity is 1.00. This shows that the algorithm can be used as a general tool for finding new RNA structures.</p>
      </sec>
      <sec id="s2c">
        <title>Global-Alignment Results</title>
        <p>Initial tests of FOLDALIGN's global-alignment performance while using pruning showed that the simple pruning used during local alignment removes too much during global alignment. Many sequence pairs simply did not produce an alignment. The “problem” is that the global alignment must insert a minimum number of gaps equal to the length difference between the two sequences. When the length difference is large, the cost of inserting the minimum number of gaps is enough to make the algorithm prune away all alignments. To circumvent this problem, a special global-alignment pruning scheme is used; see the previous section called Pruning.</p>
        <p>Using the global pruning scheme, most global alignments between related sequences produce an alignment. Unfortunately, this also lowers the efficiency of the pruning significantly. <xref ref-type="fig" rid="pcbi-0030193-g006">Figure 6</xref> shows the time needed to do an alignment without pruning divided by the time needed to do the same alignment using pruning as a function of the length difference between the two sequences. When the length difference is small, it is significantly faster to use pruning. When the length difference is large, there is only a small speed advantage. At a length difference of 25, the use of pruning is only ∼20% faster than not using pruning.</p>
        <fig id="pcbi-0030193-g006" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.0030193.g006</object-id>
          <label>Figure 6</label>
          <caption>
            <title>The Time Gained by Using Pruning</title>
            <p>The global-alignment time without pruning divided by the alignment time with pruning as a function of the length difference between the input sequences. The SRP dataset and δ = 25 was used. The curve shows the average gain. The points are the individual measurements.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030193.g006" xlink:type="simple"/>
        </fig>
        <p>The global 5S rRNA and tRNA datasets (see <xref ref-type="sec" rid="s4">Material and Methods</xref>) were used to select the parameters of the global score matrix, see <xref ref-type="table" rid="pcbi-0030193-t001">Table 1</xref> (gap penalties, substitution versus energy weight, and Ribosum clustering percentage). The global SRP and RNaseP datasets were used as validation datasets. As a performance measure, the Matthews correlation coefficient (MCC) of the base-pair prediction was used [<xref ref-type="bibr" rid="pcbi-0030193-b040">40</xref>]. Correctly predicted base pairs are counted as true positives, predicted base pairs that are not found in the annotation are counted as false positives. Annotated base pairs not found in the prediction are counted as a false negative. Positions not predicted to base-pair that are not annotated to base-pair, are counted as true negatives. The average MMCs are: 5S rRNA 0.81, tRNA 0.86, RNaseP 0.50, and SRP 0.49. The results for the RNaseP and SRP datasets indicate that the good performance reported for 5S rRNA and tRNA may be due to overfitting. If this were the case, then it should also be possible to overfit on the RNaseP and SRP datasets. These datasets were therefore used to find alternative sets of parameters. The best MCCs found for both datasets were 0.56. The poor performance therefore does not seem to be due to overfitting. Some of the performance difference is likely to be due to structural inserts in the structures. Some of the sequence pairs in both the RNaseP and the SRP datasets contain stem inserts which FOLDALIGN currently cannot handle. The 5S rRNA and tRNA datasets contain fewer large stem inserts.</p>
        <p>Recently Dowell and Eddy published results [<xref ref-type="bibr" rid="pcbi-0030193-b012">12</xref>] which showed that while FOLDALIGN makes good alignments, its base-pair prediction sensitivity is slightly lower than that of other methods for folding and aligning RNA sequences. Since the dataset used in [<xref ref-type="bibr" rid="pcbi-0030193-b012">12</xref>] also contains more sequence pairs than the Bralibase dataset [<xref ref-type="bibr" rid="pcbi-0030193-b007">7</xref>], the dataset [<xref ref-type="bibr" rid="pcbi-0030193-b012">12</xref>] is used to test the global-structure prediction performance of the algorithm. <xref ref-type="fig" rid="pcbi-0030193-g007">Figure 7</xref> shows the performance of the old and new versions of FOLDALIGN and some of the other methods which can make pairwise structural alignments of RNA using the dataset from [<xref ref-type="bibr" rid="pcbi-0030193-b012">12</xref>]; see <xref ref-type="table" rid="pcbi-0030193-t003">Table 3</xref> for details about the methods. In addition to the methods shown in <xref ref-type="fig" rid="pcbi-0030193-g007">Figure 7</xref> and <xref ref-type="table" rid="pcbi-0030193-t003">Table 3</xref>, the combination of RNAcast and RNAforester as described in the main page of the RNAshapes package was also tested. The combined method only produced an alignment for less than 60% of the sequence pairs and the results are therefore not reported. In cases where the combined method did produce an alignment, the alignment usually looked good. The data used is the dataset from <xref ref-type="fig" rid="pcbi-0030193-g007">Figure 7</xref> in [<xref ref-type="bibr" rid="pcbi-0030193-b012">12</xref>]. The performance measure is the MCC (see <xref ref-type="sec" rid="s4">Materials and Methods</xref>). <xref ref-type="fig" rid="pcbi-0030193-g007">Figure 7</xref> shows that the performance has improved from the old to the new version of FOLDALIGN. It also shows that the pruning constraint does not affect the performance in most ranges of sequence identity. Only in the identity range from 0.1 to 0.2 is there a significant difference. This is due to three sequence pairs (less than 1% of the dataset) for which no alignments are found. In these cases, pruning is not feasible; however, an alignment can still be obtained by running FOLDALIGN without pruning. <xref ref-type="table" rid="pcbi-0030193-t003">Table 3</xref> shows how long a time it takes to align the full dataset [<xref ref-type="bibr" rid="pcbi-0030193-b012">12</xref>]. The memory requirements are also shown in <xref ref-type="table" rid="pcbi-0030193-t003">Table 3</xref>. Two types of memory consumption are shown. The first (Max) is the maximum amount of memory (Resident Set Size, RSS) used during the alignment of the entire dataset. The second (Ave) is the average amount of memory needed to align each of the pairs. For “FOLDALIGN 2.1” and “FOLDALIGN 2.1 -no pruning”, the Max number (68 Mb and 323 Mb, respectively) are due to a pair of tRNAs which are predicted to a have a stemloop structure. The divide and conquer algorithm can therefore not be used to split the backtrack into smaller sections, and the memory requirement becomes high. Solutions to the stemloop problem can be to use a cubic space models [<xref ref-type="bibr" rid="pcbi-0030193-b032">32</xref>,<xref ref-type="bibr" rid="pcbi-0030193-b033">33</xref>] or a method similar to the Treeterbi algorithm [<xref ref-type="bibr" rid="pcbi-0030193-b034">34</xref>]. If this one alignment is ignored, the Max memory consumptions are 21 Mb and 77 Mb, respectively. Locarna [<xref ref-type="bibr" rid="pcbi-0030193-b017">17</xref>] is the fastest and requires the least amount of memory, but it is also the least accurate. FOLDALIGN is slower and uses more memory, but it is also one of the most accurate. Dynalign [<xref ref-type="bibr" rid="pcbi-0030193-b024">24</xref>] also makes accurate alignments but is slower than FOLDALIGN. Consan [<xref ref-type="bibr" rid="pcbi-0030193-b012">12</xref>] and Stemloc [<xref ref-type="bibr" rid="pcbi-0030193-b022">22</xref>] are slow and use large amounts of memory without being more accurate than Dynalign and FOLDALIGN. The computer used to make these tests runs Linux (kernel 2.6) on two 2.4-GHz 32-bit Intel Xeon CPUs, and it has 4 Gb of memory.</p>
        <fig id="pcbi-0030193-g007" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.0030193.g007</object-id>
          <label>Figure 7</label>
          <caption>
            <title>Structure Correlation Coefficient</title>
            <p>The structure correlation coefficient as a function of sequence identity. The dataset consists of tRNAs and 5S rRNAs; for details see [<xref ref-type="bibr" rid="pcbi-0030193-b012">12</xref>]. The difference in correlation coefficient for “FOLDALIGN” and “FOLDALIGN without pruning” at identities 0.1 and 0.15 is due to three sequence pairs for which no alignment and structure are produced. Rerunning FOLDALIGN for those three pairs without pruning should be trivial. “Stemloc” did not produce an alignment for two pairs. For both FOLDALIGN and Stemloc, the pairs which did not produce an alignment are counted as zero.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030193.g007" xlink:type="simple"/>
        </fig>
        <table-wrap content-type="1col" id="pcbi-0030193-t003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030193.t003</object-id><label>Table 3</label><caption>
            <p>Pairwise Methods for Predicting Structures and Alignments of RNAs</p>
          </caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030193.t003" xlink:type="simple"/><!-- <table frame="hsides" rules="none"><colgroup><col id="tb3col1" align="left" charoff="0" char=""/><col id="tb3col2" align="left" charoff="0" char=""/><col id="tb3col3" align="char" charoff="0" char="."/><col id="tb3col4" align="char" charoff="0" char="."/><col id="tb3col5" align="char" charoff="0" char="."/><col id="tb3col6" align="left" charoff="0" char=""/></colgroup><thead><tr><td align="left"><hr/>Method</td><td><hr/>Options</td><td><hr/>Time (s)</td><td><hr/>Max (Mb)</td><td><hr/>Ave (Mb)</td><td><hr/>Reference</td></tr></thead><tbody><tr><td>Foldalign 2.1</td><td>-global</td><td>1,752</td><td>68</td><td>7</td><td>This paper</td></tr><tr><td>Foldalign 2.1 -no_pruning</td><td>-global -no_pruning</td><td>8,663</td><td>323</td><td>21</td><td>This paper</td></tr><tr><td>Foldalign 2.0</td><td>-global -max_diff 25</td><td>18,482</td><td>316</td><td>167</td><td>&lsqb;<xref ref-type="bibr" rid="pcbi-0030193-b011">11</xref>&rsqb;</td></tr><tr><td>-score_matrix global.fmat</td></tr><tr><td>Dynalign</td><td>maxtrace &equals; 1,</td><td>7,080</td><td>17</td><td>9</td><td>&lsqb;<xref ref-type="bibr" rid="pcbi-0030193-b024">24</xref>&rsqb;</td></tr><tr><td>optimal_only &equals; 1</td></tr><tr><td>Locarna.pl</td><td>170</td><td>2</td><td>2</td><td>&lsqb;<xref ref-type="bibr" rid="pcbi-0030193-b017">17</xref>&rsqb;</td></tr><tr><td>Consan</td><td>-m mixed80.mod</td><td>208,146</td><td>1581</td><td>199</td><td>&lsqb;<xref ref-type="bibr" rid="pcbi-0030193-b012">12</xref>&rsqb;</td></tr><tr><td>Stemloc</td><td>-na 100 -nf 1000</td><td>150,608<sup>a</sup></td><td>2641</td><td>333</td><td>&lsqb;<xref ref-type="bibr" rid="pcbi-0030193-b022">22</xref>&rsqb;</td></tr></tbody></table> --><!-- <table-wrap-foot><fn id="nt301"><p>These are the methods and options used to make <xref ref-type="fig" rid="pcbi-0030193-g007">Figure 7</xref>.</p></fn><fn id="nt302"><p>Time is the total run time for the entire dataset.</p></fn><fn id="nt303"><p>Max (Mb) is the maximum amount of memory (RSS) used at any time while aligning the dataset.</p></fn><fn id="nt304"><p>Ave (Mb) is the average amount of memory needed to align a sequence pair from the dataset.</p></fn><fn id="nt305"><p>Note that for FOLDALIGN 2.1, the score matrix optimal for global alignment is used by default when the option -global is used. The local-alignment default matrix can be selected by the use of the -score_matrix option. For FOLDALIGN 2.1 and FOLDALIGN 2.1 -no_pruning, the Max values are due to one extreme case. If this sequence pair is ignored, the numbers are 21 and 77, respectively.</p></fn><fn id="nt306"><p><sup>a</sup>Stemloc could not align two sequence pairs.</p></fn></table-wrap-foot> --></table-wrap>
      </sec>
    </sec>
    <sec id="s3">
      <title>Discussion</title>
      <p>FOLDALIGN is a fast and efficient tool for making pairwise local or global alignments of RNA sequences. Whereas there exist a number of methods able to make global alignments, FOLDALIGN seems still to be one of the very few tools that can do pairwise local structural alignment of RNA sequences. Thus the main motivation was in particular to improve on this aspect of FOLDALIGN. In accordance, this paper described a new way of improving the run time and memory efficiency of dynamical programming methods. Furthermore, there are several improvements to the software package. The main changes are: pruning of the dynamical programming matrix, a better implementation of memory usage, and a better energy model.</p>
      <p>The pruning of the dynamical pruning matrix works by requiring that a subalignment must have a score above a length-dependent cutoff. Otherwise, the subalignment is removed from the dynamical programming matrix and cannot be part of any longer subalignment. Pruning efficiently slashes run time and memory requirements without degrading the predictive performance. Using pruning to speed up other dynamical programming applications should be straightforward.</p>
      <p>The memory usage of the implementation is further improved in two ways: in the branch point calculation and during backtrack. In the calculation of branch points, two substructures are only added together if the nucleotides at the start and end positions of the downstream substructure are base-paired. Therefore, no downstream subalignment is saved unless its start and end positions base-pair. A similar method was used to speed up the algorithm in [<xref ref-type="bibr" rid="pcbi-0030193-b011">11</xref>], but now it is used to both speed up the calculation and to lower the memory consumption. During backtrack, information is needed for every cell in the dynamic programming matrix that will be passed by the traceback algorithm (pruned alignments will not be passed and pruned cells will therefore not be needed). A divide and conquer approach has been implemented which first locates the branch points in the common structure, and then uses them to divide the structure into hopefully smaller unbranched segments. These can then be backtracked separately. While the improvement to the branch point calculation and the divide and conquer approach are more specialized than the pruning heuristic, they are likely to be of use for other RNA alignment methods.</p>
      <p>The improvements in speed and memory requirements are important as they make studies like [<xref ref-type="bibr" rid="pcbi-0030193-b006">6</xref>] more feasible, and thereby help to elucidate ncRNA genes' and structures' role in molecular biology.</p>
      <p>The energy model has been improved in two ways. The first is that insert basepairs are now allowed at any position in a stem except for the first one. The second improvement is that external single-stranded nucleotides are now always scored in a consistent way—namely, as single-stranded nucleotides in a multibranched loop.</p>
      <p>Even though the main focus for the FOLDALIGN algorithm is local alignment, the global-alignment test shows that the algorithm is the most accurate method for making global alignments of low-similarity sequences. There are several directions where the resource requirements can be improved upon. Firstly, one could introduce an align-then-fold step, to the aid of finding a lower bound for the pruning threshold. Secondly, a pre-scan for all dinucleotides could be made to initiate all stems. Thirdly, restricting the fold envelope (as introduced by Holmes [<xref ref-type="bibr" rid="pcbi-0030193-b022">22</xref>]) by compiling a list of different shapes [<xref ref-type="bibr" rid="pcbi-0030193-b019">19</xref>,<xref ref-type="bibr" rid="pcbi-0030193-b020">20</xref>] might be used as a further constraint. Finally, adding a Markov model, as in Harmanci et al. [<xref ref-type="bibr" rid="pcbi-0030193-b024">24</xref>], for initial restriction of the align envelope might aid in further resource improvements.</p>
      <p>The FOLDALIGN software package is released under the GNU public license. It has been tested on Linux operating systems, but should run on any system that can compile standard ANSI C++. Invoking the FOLDALIGN program with the option <italic>-help</italic> will print a short description of all available options. The package can be downloaded from <ext-link ext-link-type="uri" xlink:href="http://foldalign.ku.dk" xlink:type="simple">http://foldalign.ku.dk</ext-link>.</p>
      <p>In conclusion, FOLDALIGN constitutes an efficient tool for pairwise local and global structural alignment of RNA sequences. With the introduction of pruning, the time of the genomic screen (ten chromosomes between human and mouse) in [<xref ref-type="bibr" rid="pcbi-0030193-b006">6</xref>] was reduced from five months (on 70 CPUs) to only one week.</p>
    </sec>
    <sec id="s4">
      <title>Materials and Methods</title>
      <sec id="s4a">
        <title>Data.</title>
        <p>Two datasets are used to optimize the local-alignment parameters and evaluate the performance. Each sequence pair in the datasets contains at least one conserved RNA structure and the surrounding context. The sequences of the region with this conserved structure are at most 40% identical. The single-strand minimum folding energy of the conserved structure is indistinguishable from the folding energy of the surrounding sequence. The genomic contexts were found in GenBank [<xref ref-type="bibr" rid="pcbi-0030193-b041">41</xref>]. The first dataset (used for optimizing the parameters) consists of 99 sequence pairs. The sequence plus context sequence is 500 nucleotides long. The conserved structures are 5S rRNA (two pairs) [<xref ref-type="bibr" rid="pcbi-0030193-b042">42</xref>], Purine riboswitches (five pairs) [<xref ref-type="bibr" rid="pcbi-0030193-b043">43</xref>–<xref ref-type="bibr" rid="pcbi-0030193-b045">45</xref>], THI riboswitches (21 pairs) [<xref ref-type="bibr" rid="pcbi-0030193-b045">45</xref>–<xref ref-type="bibr" rid="pcbi-0030193-b050">50</xref>], tRNA (65 pairs) [<xref ref-type="bibr" rid="pcbi-0030193-b051">51</xref>], or U1 (six pairs) [<xref ref-type="bibr" rid="pcbi-0030193-b052">52</xref>]. For some of the sequences, there are other RNAs annotated within the context region (mainly tRNAs). These extra RNAs are annotated in the dataset if the entire RNA sequence is part of the context. Partial RNAs are annotated as intergenic sequence. The total number of the tRNA pairs in the dataset is therefore 277. The second dataset (used to evaluate the performance) consists of eight SRP pairs [<xref ref-type="bibr" rid="pcbi-0030193-b053">53</xref>]. For details about the datasets, see [<xref ref-type="bibr" rid="pcbi-0030193-b011">11</xref>].</p>
        <p>To train and test FOLDALIGN's global-alignment performance, a new dataset has been made. The sequence pairs of the dataset were selected from the 5S rRNA, RNaseP, SRP, and tRNA databases [<xref ref-type="bibr" rid="pcbi-0030193-b042">42</xref>,<xref ref-type="bibr" rid="pcbi-0030193-b053">53</xref>–<xref ref-type="bibr" rid="pcbi-0030193-b055">55</xref>]. Any sequences containing nucleotides other than <italic>A</italic>, <italic>C</italic>, <italic>G</italic>, or <italic>U</italic> were removed from the databases. A few sequences which obviously did not fit into the databases were removed. Then the sequences in each database were redundancy-reduced to 90% similarity using the Hobohm 2 algorithm [<xref ref-type="bibr" rid="pcbi-0030193-b056">56</xref>]. Sequence pairs were selected from the remaining sequences by sorting the pairs by their identity and selecting the pairs with the lowest identity. Each sequence can only be part of one sequence pair. The structures were cleaned by annotating any non <italic>A - U, G - C,</italic> or <italic>G - U</italic> base pair as single-stranded. Nucleotides annotated to base pairs with gaps were also reannotated to be single-stranded.</p>
        <p>The 5S rRNA database has three separate sections (Eubacteria, Eukaryota, and Archaea). Each section was treated separately before the final datasets were joined. This part of the data contains 215 sequence pairs. From the RNaseP database, only the sequences in the bacterial type A alignment [<xref ref-type="bibr" rid="pcbi-0030193-b057">57</xref>] were used, as this alignment seems to have the most sequences and the best annotation. This dataset has 101 sequence pairs. The SRP dataset contains 121 sequence pairs. The pseudo-knot base pairs were removed from the structures. The tRNA dataset contains 1,810 sequence pairs.</p>
        <p>The global-alignment dataset made by [<xref ref-type="bibr" rid="pcbi-0030193-b012">12</xref>] contains 324 sequence pairs from the tRNA (184 pairs) and 5S rRNA (140 pairs) families of RFAM [<xref ref-type="bibr" rid="pcbi-0030193-b045">45</xref>].</p>
      </sec>
      <sec id="s4b">
        <title>Significance of local alignments.</title>
        <p>By default, FOLDALIGN returns the structure, alignment, and positions of the best-scoring local alignment of a pair of sequences. However, it can also output the score and coordinates of the alignment with the highest score compared with the log of its length for each pair of positions (<italic>i</italic>,<italic>k</italic>) in the two sequences [<xref ref-type="bibr" rid="pcbi-0030193-b058">58</xref>]. The list of scores and coordinates are turned into a ranked list of non-overlapping alignments. As described in [<xref ref-type="bibr" rid="pcbi-0030193-b011">11</xref>], this is done by the following. 1) Find the alignment with the highest score compared with the logarithm of the sequence lengths. 2) Remove all alignments that overlap the alignment found in step 1. 3. If more alignments are available and desired, go back to step 1.</p>
        <p>Ideally, the significance of an alignment is found by comparing its score to a large number of scores from shuffled alignments using the extreme value distribution [<xref ref-type="bibr" rid="pcbi-0030193-b059">59</xref>,<xref ref-type="bibr" rid="pcbi-0030193-b060">60</xref>]. With a method like FOLDALIGN, alignment of thousands of random sequences is not feasible. In [<xref ref-type="bibr" rid="pcbi-0030193-b061">61</xref>,<xref ref-type="bibr" rid="pcbi-0030193-b062">62</xref>], it is suggested that from each alignment it is possible to use more than just the score of best alignment to find the parameters of the extreme value distribution.</p>
        <p>The parameters <italic>κ</italic> and <italic>Λ</italic> (<italic>Λ</italic> is called <italic>λ</italic> in other texts) of the distribution are found using the method described in [<xref ref-type="bibr" rid="pcbi-0030193-b037">37</xref>]:
					<disp-formula id="pcbi-0030193-e004"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030193.e004" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>&Lambda;</mml:mi><mml:mo>&equals;</mml:mo><mml:mi>log</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>&plus;</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>A</mml:mi><mml:mo>&minus;</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi>&kappa;</mml:mi><mml:mo>&equals;</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>&gt;</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mi>exp</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>&Lambda;</mml:mi><mml:mi>C</mml:mi><mml:mo stretchy='false'>)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>I</mml:mi></mml:msub><mml:msub><mml:mi>L</mml:mi><mml:mi>K</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math> --></disp-formula>where <italic>A</italic> is the mean of all alignments scoring above a cutoff <italic>C</italic>, and <italic>n<sub>A&gt;C</sub></italic> is the number of alignments scoring above the cutoff. In [<xref ref-type="bibr" rid="pcbi-0030193-b011">11</xref>], several values of <italic>C</italic> were tested, and one assumed to be optimal was chosen. This sometimes led to problems with the distribution being estimated from only one alignment score. We have therefore changed the script to use a fixed value of <italic>C</italic> = 0, which usually yields good results. The probability of getting a random alignment with a score larger than or equal to the score <italic>D</italic> is [<xref ref-type="bibr" rid="pcbi-0030193-b037">37</xref>]:
					<disp-formula id="pcbi-0030193-e005"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030193.e005" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mo>Pr</mml:mo><mml:mi>o</mml:mi><mml:mi>b</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>S</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mo>&ge;</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>&ap;</mml:mo><mml:mn>1</mml:mn><mml:mo>&minus;</mml:mo><mml:mo>exp</mml:mo><mml:mo stretchy='false'>(</mml:mo><mml:mo>&minus;</mml:mo><mml:mi>&kappa;</mml:mi><mml:msub><mml:mi>L</mml:mi><mml:mi>I</mml:mi></mml:msub><mml:msub><mml:mi>L</mml:mi><mml:mi>K</mml:mi></mml:msub><mml:mspace width='2pt'/><mml:mo>exp</mml:mo><mml:mo stretchy='false'>(</mml:mo><mml:mo>&minus;</mml:mo><mml:mi>&Lambda;</mml:mi><mml:mi>D</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo stretchy='false'>)</mml:mo></mml:mrow></mml:math> --></disp-formula>
				</p>
        <p>The extreme value distribution parameters are estimated for each sequence pair using alignments of 20 shufflings of that pair. The dinucleotide distribution is conserved during the shuffling [<xref ref-type="bibr" rid="pcbi-0030193-b039">39</xref>].</p>
      </sec>
      <sec id="s4c">
        <title>Local-alignment performance evaluation.</title>
        <p>The localization performance is measured by counting the number of structure pairs found (<italic>P<sub>t</sub></italic>), structure pairs missed (<italic>N<sub>f)</sub></italic>, and the number of false positive predictions (<italic>P<sub>f</sub></italic>) made by the method.</p>
        <p>The annotated structure pairs overlapped by a prediction are counted as found (<italic>P<sub>t</sub></italic>) if at least half the nucleotides covered by the prediction in both separate sequences are annotated as RNA structures. If there is more than one <italic>P<sub>t</sub></italic> prediction which covers the same pair of structures, then the structure pair is only counted once. Predictions in which at least half of the nucleotides are not annotated as RNA in both sequences are counted as false positives (<italic>P<sub>f</sub></italic>). If a false positive prediction overlaps a structure from one RNA family and only one family in a sequence, then the prediction gets this family, otherwise it gets the “Unknown” family. If a false positive prediction gets an RNA family for one of the sequences and the “Unknown” family for the other, then the false positive is counted as belonging to the known RNA family. A missed structure pair (<italic>N<sub>f</sub></italic>) is a pair of annotated structures which is not overlapped by any significant positive predictions. Mixed RNA families, like a tRNA versus a 5S rRNA, are ignored. From the <italic>P<sub>t</sub></italic>, <italic>P<sub>f</sub></italic>, and <italic>N<sub>f</sub></italic> numbers, the positive predictive value <italic>PPV = P<sub>t</sub></italic> / (<italic>P<sub>t</sub> + P<sub>f</sub></italic>) and the sensitivity <italic>Sens = P<sub>t</sub></italic> / (<italic>P<sub>t</sub> + N<sub>f</sub></italic>) are calculated.</p>
      </sec>
      <sec id="s4d">
        <title>Global structure prediction-performance evaluation.</title>
        <p>To compare the predicted structures and the annotated structures, the MCC [<xref ref-type="bibr" rid="pcbi-0030193-b040">40</xref>] for structures are used:
					<disp-formula id="pcbi-0030193-e006"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030193.e006" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mi>C</mml:mi><mml:mi>C</mml:mi><mml:mo>&equals;</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>&minus;</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:mo stretchy='false'>(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>&plus;</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo stretchy='false'>)</mml:mo><mml:mo stretchy='false'>(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>&plus;</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo stretchy='false'>)</mml:mo><mml:mo stretchy='false'>(</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>&plus;</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo stretchy='false'>)</mml:mo><mml:mo stretchy='false'>(</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>&plus;</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo stretchy='false'>)</mml:mo></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:mrow></mml:math> --></disp-formula>
				</p>
        <p><italic>P<sub>t</sub></italic> is the number of predicted base pairs which are also annotated. <italic>P<sub>f</sub></italic> is the number of predicted basepairs which are not annotated. <italic>N<sub>f</sub></italic> is the number of base pairs that are annotated but not predicted. <italic>N<sub>t</sub></italic> is the number of positions that are both predicted and annotated not to base pair. As <italic>N<sub>f</sub></italic> is always very large, the approximation described in [<xref ref-type="bibr" rid="pcbi-0030193-b030">30</xref>] could have been used. No correction for sliding base pairs is used [<xref ref-type="bibr" rid="pcbi-0030193-b035">35</xref>].</p>
      </sec>
    </sec>
    <sec id="s5">
      <title>Supporting Information</title>
      <supplementary-material id="pcbi-0030193-sg001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030193.sg001" xlink:type="simple">
        <label>Figure S1</label>
        <caption>
          <title>State Chart</title>
          <p>A simplified state chart of the FOLDALIGN energy model. The alignment always starts in the “Start” state which is a hairpin-loop state. The alignment ends in the “End” state. The “External” state recalculates the scores of the “Hairpin-”, “Bulge-”, and “Internal-” loop states to an “External” state score when needed. Unpaired nucleotides in the bifurcation states are scored in the same way as external states. The “Hairpin-loop” state aligns unpaired nucleotides in the hairpin context. The “Stem” state aligns basepairs in both sequences. The “Stem insert” state aligns a basepair in one of the sequences with two gaps in the other. “Bulge right” aligns bulges on the right side of a stem. “Bulge left” aligns bulges on the left side of a stem. The “Internal-loop” state aligns two internal-loops nucleotides. The “Bifurcation” state joins two substructures. The right structure must be in the “Stem” or “Stem insert” state. The state of the left structure must be: “Stem”, “Stem insert”, “Bifurcation”, “Bulge right”, or Bifurcation unpaired right (“Bf. right”). Bifurcation unpaired right aligns unpaired nucleotides on the right side of a branch point. Bifurcation unpaired left &amp; both (“Bf. left &amp; both”) aligns unpaired nucleotides on the left, right, and both sides of a branch point.</p>
          <p>(11 KB PDF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi-0030193-sg002" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030193.sg002" xlink:type="simple">
        <label>Figure S2</label>
        <caption>
          <title>μ</title>
          <p><italic>μ</italic> is the number of unpaired nucleotides external to the last basepair. <italic>μ</italic><sub>1</sub> is the number of unpaired nucleotides upstream of the last basepair in the first sequence. <italic>μ</italic><sub>2</sub> counts the unpaired nucleotides downstream of the last basepair in the first sequence. <italic>μ</italic><sub>3</sub> and <italic>μ</italic><sub>4</sub> are defined in the same way but for sequence 2. In this example <italic>μ</italic><sub>1</sub> <italic>=</italic> 1<italic>, μ</italic><sub>2</sub> <italic>=</italic> 2<italic>, μ</italic><sub>3</sub> <italic>=</italic> 3<italic>,</italic> and <italic>μ</italic><sub>4</sub> <italic>=</italic> 4<italic>.</italic></p>
          <p>(7 KB PDF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi-0030193-sg003" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030193.sg003" xlink:type="simple">
        <label>Figure S3</label>
        <caption>
          <title>Normal versus Expanding Dynamic Programming</title>
          <p>A 2-D folding example of standard versus expanding dynamical programming matrices. <italic>i</italic> &gt; <italic>j</italic> are the sequence coordinates.</p>
          <p>(A) Is the standard case. The blue cell is filled using the green cells (adding a basepair, or a single stranded nucleotide), and by joining two of the red cells (a bifurcation). Arrows have only been drawn for one of the bifurcations. The grey cells are those which have already been filled.</p>
          <p>(B) Is the expanding case. The blue cell is used to partially calculate the score of the green cells (adding a basepair or a single-stranded nucleotide). The yellow cells are the results of joining the blue cell and the red cells in bifurcations. The dark grey cells are those which have already been completely filled. The light grey cells are those where the calculation is not completely finished.</p>
          <p>(13 KB PDF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi-0030193-sgc001" mimetype="application/x-tar" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030193.sd001" xlink:type="simple">
        <label>File Collection S1</label>
        <caption>
          <title>FOLDALIGN Software Package</title>
          <p>(808 KB TAR)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi-0030193-st001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030193.st001" xlink:type="simple">
        <label>Table S1</label>
        <caption>
          <title>Notation</title>
          <p>(26 KB PDF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi-0030193-sd001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030193.sd002" xlink:type="simple">
        <label>Protocol S1</label>
        <caption>
          <title>Supplementary Material</title>
          <p>(97 KB PDF)</p>
        </caption>
      </supplementary-material>
    </sec>
  </body>
  <back>
    <ack>
      <p>We would like to thank Robin Dowell for sequence data, data points, and assistance with the making of <xref ref-type="fig" rid="pcbi-0030193-g007">Figure 7</xref>. We would also like to thank Rune Lyngsø for useful comments. We would also like to thank the anonymous reviewers who contributed with useful ideas. JG would like to thank Elena Rivas and Eric Westhof for organising the Banasque meetings, which have had an impact on the development of FOLDALIGN.</p>
    </ack>
    
    <glossary>
      <title>Abbreviations</title>
      <def-list>
        <def-item>
          <term>MCC</term>
          <def>
            <p>Matthews correlation coefficient</p>
          </def>
        </def-item>
        <def-item>
          <term>ncRNA</term>
          <def>
            <p>noncoding RNA</p>
          </def>
        </def-item>
      </def-list>
    </glossary>
    <ref-list>
      <title>References</title>
      <ref id="pcbi-0030193-b001">
        <label>1</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Numata</surname><given-names>K</given-names></name><name name-style="western"><surname>Kanai</surname><given-names>A</given-names></name><name name-style="western"><surname>Saito</surname><given-names>R</given-names></name><name name-style="western"><surname>Kondo</surname><given-names>S</given-names></name><name name-style="western"><surname>Adachi</surname><given-names>J</given-names></name><etal/></person-group>
					<year>2003</year>
					<article-title>Identification of putative noncoding RNAs among the RIKEN mouse full-length cDNA collection.</article-title>
					<source>Genome Res</source>
					<volume>13</volume>
					<fpage>1301</fpage>
					<lpage>1306</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030193-b002">
        <label>2</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Huttenhofer</surname><given-names>A</given-names></name><name name-style="western"><surname>Brosius</surname><given-names>J</given-names></name><name name-style="western"><surname>Bachellerie</surname><given-names>J</given-names></name></person-group>
					<year>2002</year>
					<article-title>RNomics: Identification and function of small, non-messenger RNAs.</article-title>
					<source>Curr Opin Chem Biol</source>
					<volume>6</volume>
					<fpage>835</fpage>
					<lpage>843</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030193-b003">
        <label>3</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Mattick</surname><given-names>J</given-names></name></person-group>
					<year>2004</year>
					<article-title>RNA regulation: A new genetics?</article-title>
					<source>Nat Rev Genet</source>
					<volume>5</volume>
					<fpage>316</fpage>
					<lpage>323</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030193-b004">
        <label>4</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Washietl</surname><given-names>S</given-names></name><name name-style="western"><surname>Hofacker</surname><given-names>I</given-names></name><name name-style="western"><surname>Lukasser</surname><given-names>M</given-names></name><name name-style="western"><surname>Huttenhofer</surname><given-names>A</given-names></name><name name-style="western"><surname>Stadler</surname><given-names>P</given-names></name></person-group>
					<year>2005</year>
					<article-title>Mapping of conserved RNA secondary structures predicts thousands of functional noncoding RNAs in the human genome.</article-title>
					<source>Nat Biotechnol</source>
					<volume>23</volume>
					<fpage>1383</fpage>
					<lpage>1390</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030193-b005">
        <label>5</label>
        <element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Pedersen</surname><given-names>JS</given-names></name><name name-style="western"><surname>Bejerano</surname><given-names>G</given-names></name><name name-style="western"><surname>Siepel</surname><given-names>A</given-names></name><name name-style="western"><surname>Rosenbloom</surname><given-names>K</given-names></name><name name-style="western"><surname>Lindblad-Toh</surname><given-names>K</given-names></name><etal/></person-group>
					<year>2006</year>
					<article-title>Identification and classification of conserved RNA secondary structures in the human genome.</article-title>
					<source>PLOS Comput Biol</source>
					<volume>2</volume>
					<elocation-id>e33.</elocation-id>
					<comment>doi:<ext-link ext-link-type="doi" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.0020033" xlink:type="simple">10.1371/journal.pcbi.0020033</ext-link></comment>
				</element-citation>
      </ref>
      <ref id="pcbi-0030193-b006">
        <label>6</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Torarinsson</surname><given-names>E</given-names></name><name name-style="western"><surname>Sawera</surname><given-names>M</given-names></name><name name-style="western"><surname>Havgaard</surname><given-names>J</given-names></name><name name-style="western"><surname>Fredholm</surname><given-names>M</given-names></name><name name-style="western"><surname>Gorodkin</surname><given-names>J</given-names></name></person-group>
					<year>2006</year>
					<article-title>Thousands of corresponding human and mouse genomic regions unalignable in primary sequence contain common RNA structure.</article-title>
					<source>Genome Res</source>
					<volume>16</volume>
					<fpage>885</fpage>
					<lpage>889</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030193-b007">
        <label>7</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Gardner</surname><given-names>P</given-names></name><name name-style="western"><surname>Wilm</surname><given-names>A</given-names></name><name name-style="western"><surname>Washietl</surname><given-names>S</given-names></name></person-group>
					<year>2005</year>
					<article-title>A benchmark of multiple sequence alignment programs upon structural RNAs.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>33</volume>
					<fpage>2433</fpage>
					<lpage>2439</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030193-b008">
        <label>8</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Sankoff</surname><given-names>D</given-names></name></person-group>
					<year>1985</year>
					<article-title>Simultaneous solution of the RNA folding, alignment and protosequence problems.</article-title>
					<source>SIAM J Appl Math</source>
					<volume>45</volume>
					<fpage>810</fpage>
					<lpage>825</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030193-b009">
        <label>9</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Gorodkin</surname><given-names>J</given-names></name><name name-style="western"><surname>Heyer</surname><given-names>L</given-names></name><name name-style="western"><surname>Stormo</surname><given-names>G</given-names></name></person-group>
					<year>1997</year>
					<article-title>Finding common sequence and structure motifs in a set of RNA sequences.</article-title>
					<source>Proc Int Conf Intell Syst Mol Biol</source>
					<volume>5</volume>
					<fpage>120</fpage>
					<lpage>123</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030193-b010">
        <label>10</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Klein</surname><given-names>R</given-names></name><name name-style="western"><surname>Eddy</surname><given-names>S</given-names></name></person-group>
					<year>2003</year>
					<article-title>RSEARCH: Finding homologs of single structured RNA sequences.</article-title>
					<source>BMC Bioinformatics</source>
					<volume>4</volume>
					<fpage>44</fpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030193-b011">
        <label>11</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Havgaard</surname><given-names>J</given-names></name><name name-style="western"><surname>Lyngsø</surname><given-names>R</given-names></name><name name-style="western"><surname>Stormo</surname><given-names>G</given-names></name><name name-style="western"><surname>Gorodkin</surname><given-names>J</given-names></name></person-group>
					<year>2005</year>
					<article-title>Pairwise local structural alignment of RNA sequences with sequence similarity less than 40%.</article-title>
					<source>Bioinformatics</source>
					<volume>21</volume>
					<fpage>1815</fpage>
					<lpage>1824</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030193-b012">
        <label>12</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Dowell</surname><given-names>R</given-names></name><name name-style="western"><surname>Eddy</surname><given-names>S</given-names></name></person-group>
					<year>2006</year>
					<article-title>Efficient pairwise RNA structure prediction and alignment using sequence alignment constraints.</article-title>
					<source>BMC Bioinformatics</source>
					<volume>7</volume>
					<fpage>400</fpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030193-b013">
        <label>13</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Rivas</surname><given-names>E</given-names></name><name name-style="western"><surname>Eddy</surname><given-names>S</given-names></name></person-group>
					<year>2001</year>
					<article-title>Noncoding RNA gene detection using comparative sequence analysis.</article-title>
					<source>BMC Bioinformatics</source>
					<volume>2</volume>
					<fpage>8</fpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030193-b014">
        <label>14</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Hofacker</surname><given-names>I</given-names></name><name name-style="western"><surname>Fekete</surname><given-names>M</given-names></name><name name-style="western"><surname>Stadler</surname><given-names>P</given-names></name></person-group>
					<year>2002</year>
					<article-title>Secondary structure prediction for aligned RNA sequences.</article-title>
					<source>J Mol Biol</source>
					<volume>319</volume>
					<fpage>1059</fpage>
					<lpage>1066</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030193-b015">
        <label>15</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Knudsen</surname><given-names>B</given-names></name><name name-style="western"><surname>Hein</surname><given-names>J</given-names></name></person-group>
					<year>2003</year>
					<article-title>Pfold: RNA secondary structure prediction using stochastic context-free grammars.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>31</volume>
					<fpage>3423</fpage>
					<lpage>3428</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030193-b016">
        <label>16</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>di Bernardo</surname><given-names>D</given-names></name><name name-style="western"><surname>Down</surname><given-names>T</given-names></name><name name-style="western"><surname>Hubbard</surname><given-names>T</given-names></name></person-group>
					<year>2003</year>
					<article-title>ddbRNA: Detection of conserved secondary structures in multiple alignments.</article-title>
					<source>Bioinformatics</source>
					<volume>19</volume>
					<fpage>1606</fpage>
					<lpage>1611</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030193-b017">
        <label>17</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Will</surname><given-names>S</given-names></name><name name-style="western"><surname>Reiche</surname><given-names>K</given-names></name><name name-style="western"><surname>Hofacker</surname><given-names>I</given-names></name><name name-style="western"><surname>Stadler</surname><given-names>P</given-names></name><name name-style="western"><surname>Backofen</surname><given-names>R</given-names></name></person-group>
					<year>2007</year>
					<article-title>Inferring noncoding RNA families and classes by means of genome-scale structure-based clustering.</article-title>
					<source>PLoS Comput Biol</source>
					<volume>3</volume>
					<elocation-id>e65.</elocation-id>
					<comment>doi:<ext-link ext-link-type="doi" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.0030065" xlink:type="simple">10.1371/journal.pcbi.0030065</ext-link></comment>
				</element-citation>
      </ref>
      <ref id="pcbi-0030193-b018">
        <label>18</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Hofacker</surname><given-names>I</given-names></name><name name-style="western"><surname>Bernhart</surname><given-names>S</given-names></name><name name-style="western"><surname>Stadler</surname><given-names>P</given-names></name></person-group>
					<year>2004</year>
					<article-title>Alignment of RNA base pairing probability matrices.</article-title>
					<source>Bioinformatics</source>
					<volume>20</volume>
					<fpage>2222</fpage>
					<lpage>2227</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030193-b019">
        <label>19</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Reeder</surname><given-names>J</given-names></name><name name-style="western"><surname>Giegerich</surname><given-names>R</given-names></name></person-group>
					<year>2005</year>
					<article-title>Consensus shapes: An alternative to the Sankoff algorithm for RNA consensus structure prediction.</article-title>
					<source>Bioinformatics</source>
					<volume>21</volume>
					<fpage>3516</fpage>
					<lpage>3523</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030193-b020">
        <label>20</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Höchsmann</surname><given-names>M</given-names></name><name name-style="western"><surname>Voss</surname><given-names>B</given-names></name><name name-style="western"><surname>Giegerich</surname><given-names>R</given-names></name></person-group>
					<year>2004</year>
					<article-title>Pure multiple RNA secondary structure alignments: A progressive profile approach.</article-title>
					<source>IEEE/ACM Trans Comput Biol Bioinform</source>
					<volume>1</volume>
					<fpage>53</fpage>
					<lpage>62</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030193-b021">
        <label>21</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Touzet</surname><given-names>H</given-names></name><name name-style="western"><surname>Perriquet</surname><given-names>O</given-names></name></person-group>
					<year>2004</year>
					<article-title>CARNAC: Folding families of related RNAs.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>32</volume>
					<fpage>W142</fpage>
					<lpage>W145</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030193-b022">
        <label>22</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Holmes</surname><given-names>I</given-names></name></person-group>
					<year>2005</year>
					<article-title>Accelerated probabilistic inference of RNA structure evolution.</article-title>
					<source>BMC Bioinformatics</source>
					<volume>6</volume>
					<fpage>73</fpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030193-b023">
        <label>23</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Tabei</surname><given-names>Y</given-names></name><name name-style="western"><surname>Tsuda</surname><given-names>K</given-names></name><name name-style="western"><surname>Kin</surname><given-names>T</given-names></name><name name-style="western"><surname>Asai</surname><given-names>K</given-names></name></person-group>
					<year>2006</year>
					<article-title>SCARNA: Fast and accurate structural alignment of RNA sequences by matching fixed-length stem fragments.</article-title>
					<source>Bioinformatics</source>
					<volume>22</volume>
					<fpage>1723</fpage>
					<lpage>1729</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030193-b024">
        <label>24</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Harmanci</surname><given-names>A</given-names></name><name name-style="western"><surname>Sharma</surname><given-names>G</given-names></name><name name-style="western"><surname>Mathews</surname><given-names>D</given-names></name></person-group>
					<year>2007</year>
					<article-title>Efficient pairwise RNA structure prediction using probabilistic alignment constraints in Dynalign.</article-title>
					<source>BMC Bioinformatics</source>
					<volume>8</volume>
					<fpage>130</fpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030193-b025">
        <label>25</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Mathews</surname><given-names>D</given-names></name><name name-style="western"><surname>Sabina</surname><given-names>J</given-names></name><name name-style="western"><surname>Zuker</surname><given-names>M</given-names></name><name name-style="western"><surname>Turner</surname><given-names>D</given-names></name></person-group>
					<year>1999</year>
					<article-title>Expanded sequence dependence of thermodynamic parameters improves prediction of RNA secondary structure.</article-title>
					<source>J Mol Biol</source>
					<volume>288</volume>
					<fpage>911</fpage>
					<lpage>940</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030193-b026">
        <label>26</label>
        <element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Durbin</surname><given-names>R</given-names></name><name name-style="western"><surname>Eddy</surname><given-names>S</given-names></name><name name-style="western"><surname>Krogh</surname><given-names>A</given-names></name><name name-style="western"><surname>Mitchison</surname><given-names>G</given-names></name></person-group>
					<year>1998</year>
					<source>Biological sequence analysis</source>
					<publisher-loc>Cambridge (United Kingdom)</publisher-loc>
					<publisher-name>Cambridge University Press</publisher-name>
				</element-citation>
      </ref>
      <ref id="pcbi-0030193-b027">
        <label>27</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Altschul</surname><given-names>S</given-names></name><name name-style="western"><surname>Madden</surname><given-names>T</given-names></name><name name-style="western"><surname>Schaffer</surname><given-names>A</given-names></name><name name-style="western"><surname>Zhang</surname><given-names>J</given-names></name><name name-style="western"><surname>Zhang</surname><given-names>Z</given-names></name><etal/></person-group>
					<year>1997</year>
					<article-title>Gapped BLAST and PSI-BLAST: A new generation of protein database search programs.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>25</volume>
					<fpage>3389</fpage>
					<lpage>3402</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030193-b028">
        <label>28</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Gorodkin</surname><given-names>J</given-names></name><name name-style="western"><surname>Heyer</surname><given-names>L</given-names></name><name name-style="western"><surname>Stormo</surname><given-names>G</given-names></name></person-group>
					<year>1997</year>
					<article-title>Finding the most significant common sequence and structure motifs in a set of RNA sequences.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>25</volume>
					<fpage>3724</fpage>
					<lpage>3732</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030193-b029">
        <label>29</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Havgaard</surname><given-names>J</given-names></name><name name-style="western"><surname>Lyngsø</surname><given-names>R</given-names></name><name name-style="western"><surname>Gorodkin</surname><given-names>J</given-names></name></person-group>
					<year>2005</year>
					<article-title>The FOLDALIGN web server for pairwise structural RNA alignment and mutual motif search.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>33</volume>
					<fpage>W650</fpage>
					<lpage>W653</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030193-b030">
        <label>30</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Gorodkin</surname><given-names>J</given-names></name><name name-style="western"><surname>Stricklin</surname><given-names>S</given-names></name><name name-style="western"><surname>Stormo</surname><given-names>G</given-names></name></person-group>
					<year>2001</year>
					<article-title>Discovering common stem-loop motifs in unaligned RNA sequences.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>29</volume>
					<fpage>2135</fpage>
					<lpage>2144</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030193-b031">
        <label>31</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Gorodkin</surname><given-names>J</given-names></name><name name-style="western"><surname>Lyngsø</surname><given-names>R</given-names></name><name name-style="western"><surname>Stormo</surname><given-names>G</given-names></name></person-group>
					<year>2001</year>
					<article-title>A mini-greedy algorithm for faster structural RNA stem-loop search.</article-title>
					<source>Genome Inform Ser Workshop Genome Inform</source>
					<volume>12</volume>
					<fpage>184</fpage>
					<lpage>193</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030193-b032">
        <label>32</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Myers</surname><given-names>E</given-names></name><name name-style="western"><surname>Miller</surname><given-names>W</given-names></name></person-group>
					<year>1988</year>
					<article-title>Optimal alignments in linear space.</article-title>
					<source>Comput Appl Biosci</source>
					<volume>4</volume>
					<fpage>11</fpage>
					<lpage>17</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030193-b033">
        <label>33</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Hirschberg</surname><given-names>D</given-names></name></person-group>
					<year>1975</year>
					<article-title>A linear space algorithm for computing maximal common subsequences.</article-title>
					<source>Communications ACM</source>
					<volume>18</volume>
					<fpage>341</fpage>
					<lpage>343</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030193-b034">
        <label>34</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Keibler</surname><given-names>E</given-names></name><name name-style="western"><surname>Arumugam</surname><given-names>M</given-names></name><name name-style="western"><surname>Brent</surname><given-names>M</given-names></name></person-group>
					<year>2007</year>
					<article-title>The Treeterbi and Parallel Treeterbi algorithms: Efficient, optimal decoding for ordinary, generalized and pair HMMs.</article-title>
					<source>Bioinformatics</source>
					<volume>23</volume>
					<fpage>545</fpage>
					<lpage>554</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030193-b035">
        <label>35</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Mathews</surname><given-names>D</given-names></name><name name-style="western"><surname>Turner</surname><given-names>D</given-names></name></person-group>
					<year>2002</year>
					<article-title>Dynalign: An algorithm for finding the secondary structure common to two RNA sequences.</article-title>
					<source>J Mol Biol</source>
					<volume>317</volume>
					<fpage>191</fpage>
					<lpage>203</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030193-b036">
        <label>36</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Zuker</surname><given-names>M</given-names></name></person-group>
					<year>2003</year>
					<article-title>Mfold web server for nucleic acid folding and hybridization prediction.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>31</volume>
					<fpage>3406</fpage>
					<lpage>3415</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030193-b037">
        <label>37</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Altschul</surname><given-names>S</given-names></name><name name-style="western"><surname>Bundschuh</surname><given-names>R</given-names></name><name name-style="western"><surname>Olsen</surname><given-names>R</given-names></name><name name-style="western"><surname>Hwa</surname><given-names>T</given-names></name></person-group>
					<year>2001</year>
					<article-title>The estimation of statistical parameters for local alignment score distributions.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>29</volume>
					<fpage>351</fpage>
					<lpage>361</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030193-b038">
        <label>38</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Eddy</surname><given-names>S</given-names></name></person-group>
					<year>2002</year>
					<article-title>A memory-efficient dynamic programming algorithm for optimal alignment of a sequence to an RNA secondary structure.</article-title>
					<source>BMC Bioinformatics</source>
					<volume>3</volume>
					<fpage>18</fpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030193-b039">
        <label>39</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Workman</surname><given-names>C</given-names></name><name name-style="western"><surname>Krogh</surname><given-names>A</given-names></name></person-group>
					<year>1999</year>
					<article-title>No evidence that mRNAs have lower folding free energies than random sequences with the same dinucleotide distribution.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>27</volume>
					<fpage>4816</fpage>
					<lpage>4822</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030193-b040">
        <label>40</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Matthews</surname><given-names>B</given-names></name></person-group>
					<year>1975</year>
					<article-title>Comparison of the predicted and observed secondary structure of T4 phage lysozyme.</article-title>
					<source>Biochim Biophys Acta</source>
					<volume>405</volume>
					<fpage>442</fpage>
					<lpage>451</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030193-b041">
        <label>41</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Benson</surname><given-names>DA</given-names></name><name name-style="western"><surname>Karsch-Mizrachi</surname><given-names>I</given-names></name><name name-style="western"><surname>Lipman</surname><given-names>DJ</given-names></name><name name-style="western"><surname>Ostell</surname><given-names>J</given-names></name><name name-style="western"><surname>Wheeler</surname><given-names>DL</given-names></name></person-group>
					<year>2007</year>
					<article-title>GenBank.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>35</volume>
					<fpage>D21</fpage>
					<lpage>D25</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030193-b042">
        <label>42</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Szymanski</surname><given-names>M</given-names></name><name name-style="western"><surname>Barciszewska</surname><given-names>M</given-names></name><name name-style="western"><surname>Erdmann</surname><given-names>V</given-names></name><name name-style="western"><surname>Barciszewski</surname><given-names>J</given-names></name></person-group>
					<year>2002</year>
					<article-title>5S Ribosomal RNA Database.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>30</volume>
					<fpage>176</fpage>
					<lpage>178</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030193-b043">
        <label>43</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Mandal</surname><given-names>M</given-names></name><name name-style="western"><surname>Boese</surname><given-names>B</given-names></name><name name-style="western"><surname>Barrick</surname><given-names>J</given-names></name><name name-style="western"><surname>Winkler</surname><given-names>W</given-names></name><name name-style="western"><surname>Breaker</surname><given-names>R</given-names></name></person-group>
					<year>2003</year>
					<article-title>Riboswitches control fundamental biochemical pathways in Bacillus subtilis and other bacteria.</article-title>
					<source>Cell</source>
					<volume>113</volume>
					<fpage>577</fpage>
					<lpage>586</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030193-b044">
        <label>44</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Mandal</surname><given-names>M</given-names></name><name name-style="western"><surname>Breaker</surname><given-names>R</given-names></name></person-group>
					<year>2004</year>
					<article-title>Adenine riboswitches and gene activation by disruption of a transcription terminator.</article-title>
					<source>Nat Struct Mol Biol</source>
					<volume>11</volume>
					<fpage>29</fpage>
					<lpage>35</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030193-b045">
        <label>45</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Griffiths-Jones</surname><given-names>S</given-names></name><name name-style="western"><surname>Moxon</surname><given-names>S</given-names></name><name name-style="western"><surname>Marshall</surname><given-names>M</given-names></name><name name-style="western"><surname>Khanna</surname><given-names>A</given-names></name><name name-style="western"><surname>Eddy</surname><given-names>S</given-names></name><etal/></person-group>
					<year>2005</year>
					<article-title>Rfam: Annotating non-coding RNAs in complete genomes.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>33</volume>
					<fpage>D121</fpage>
					<lpage>D124</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030193-b046">
        <label>46</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Rodionov</surname><given-names>D</given-names></name><name name-style="western"><surname>Vitreschak</surname><given-names>A</given-names></name><name name-style="western"><surname>Mironov</surname><given-names>A</given-names></name><name name-style="western"><surname>Gelfand</surname><given-names>M</given-names></name></person-group>
					<year>2002</year>
					<article-title>Comparative genomics of thiamin biosynthesis in procaryotes. New genes and regulatory mechanisms.</article-title>
					<source>J Biol Chem</source>
					<volume>277</volume>
					<fpage>48949</fpage>
					<lpage>48959</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030193-b047">
        <label>47</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Miranda Rios</surname><given-names>J</given-names></name><name name-style="western"><surname>Navarro</surname><given-names>M</given-names></name><name name-style="western"><surname>Soberon</surname><given-names>M</given-names></name></person-group>
					<year>2001</year>
					<article-title>A conserved RNA structure (thi box) is involved in regulation of thiamin biosynthetic gene expression in bacteria.</article-title>
					<source>Proc Natl Acad Sci U S A</source>
					<volume>98</volume>
					<fpage>9736</fpage>
					<lpage>9741</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030193-b048">
        <label>48</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Sudarsan</surname><given-names>N</given-names></name><name name-style="western"><surname>Wickiser</surname><given-names>J</given-names></name><name name-style="western"><surname>Nakamura</surname><given-names>S</given-names></name><name name-style="western"><surname>Ebert</surname><given-names>M</given-names></name><name name-style="western"><surname>Breaker</surname><given-names>R</given-names></name></person-group>
					<year>2003</year>
					<article-title>An mRNA structure in bacteria that controls gene expression by binding lysine.</article-title>
					<source>Genes Dev</source>
					<volume>17</volume>
					<fpage>2688</fpage>
					<lpage>26897</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030193-b049">
        <label>49</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Winkler</surname><given-names>W</given-names></name><name name-style="western"><surname>Cohen Chalamish</surname><given-names>S</given-names></name><name name-style="western"><surname>Breaker</surname><given-names>R</given-names></name></person-group>
					<year>2002</year>
					<article-title>An mRNA structure that controls gene expression by binding FMN.</article-title>
					<source>Proc Natl Acad Sci U S A</source>
					<volume>99</volume>
					<fpage>15908</fpage>
					<lpage>15913</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030193-b050">
        <label>50</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Kubodera</surname><given-names>T</given-names></name><name name-style="western"><surname>Watanabe</surname><given-names>M</given-names></name><name name-style="western"><surname>Yoshiuchi</surname><given-names>K</given-names></name><name name-style="western"><surname>Yamashita</surname><given-names>N</given-names></name><name name-style="western"><surname>Nishimura</surname><given-names>A</given-names></name><etal/></person-group>
					<year>2003</year>
					<article-title>Thiamine-regulated gene expression of Aspergillus oryzae thiA requires splicing of the intron containing a riboswitch-like domain in the 5′-UTR.</article-title>
					<source>FEBS Lett</source>
					<volume>555</volume>
					<fpage>516</fpage>
					<lpage>520</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030193-b051">
        <label>51</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Sprinzl</surname><given-names>M</given-names></name><name name-style="western"><surname>Horn</surname><given-names>C</given-names></name><name name-style="western"><surname>Brown</surname><given-names>M</given-names></name><name name-style="western"><surname>Ioudovitch</surname><given-names>A</given-names></name><name name-style="western"><surname>Steinberg</surname><given-names>S</given-names></name></person-group>
					<year>1998</year>
					<article-title>Compilation of tRNA sequences and sequences of tRNA genes.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>26</volume>
					<fpage>148</fpage>
					<lpage>153</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030193-b052">
        <label>52</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Zwieb</surname><given-names>C</given-names></name></person-group>
					<year>1996</year>
					<article-title>The uRNA database.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>24</volume>
					<fpage>76</fpage>
					<lpage>79</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030193-b053">
        <label>53</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Rosenblad</surname><given-names>M</given-names></name><name name-style="western"><surname>Gorodkin</surname><given-names>J</given-names></name><name name-style="western"><surname>Knudsen</surname><given-names>B</given-names></name><name name-style="western"><surname>Zwieb</surname><given-names>C</given-names></name><name name-style="western"><surname>Samuelsson</surname><given-names>T</given-names></name></person-group>
					<year>2003</year>
					<article-title>SRPDB: Signal Recognition Particle Database.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>31</volume>
					<fpage>363</fpage>
					<lpage>364</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030193-b054">
        <label>54</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Brown</surname><given-names>J</given-names></name></person-group>
					<year>1999</year>
					<article-title>The Ribonuclease P Database.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>27</volume>
					<fpage>314</fpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030193-b055">
        <label>55</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Sprinzl</surname><given-names>M</given-names></name><name name-style="western"><surname>Vassilenko</surname><given-names>K</given-names></name></person-group>
					<year>2005</year>
					<article-title>Compilation of tRNA sequences and sequences of tRNA genes.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>33</volume>
					<fpage>D139</fpage>
					<lpage>D140</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030193-b056">
        <label>56</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Hobohm</surname><given-names>U</given-names></name><name name-style="western"><surname>Scharf</surname><given-names>M</given-names></name><name name-style="western"><surname>Schneider</surname><given-names>R</given-names></name><name name-style="western"><surname>Sander</surname><given-names>C</given-names></name></person-group>
					<year>1992</year>
					<article-title>Selection of representative protein data sets.</article-title>
					<source>Protein Sci</source>
					<volume>1</volume>
					<fpage>409</fpage>
					<lpage>417</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030193-b057">
        <label>57</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Harris</surname><given-names>J</given-names></name><name name-style="western"><surname>Haas</surname><given-names>E</given-names></name><name name-style="western"><surname>Williams</surname><given-names>D</given-names></name><name name-style="western"><surname>Frank</surname><given-names>D</given-names></name><name name-style="western"><surname>Brown</surname><given-names>J</given-names></name></person-group>
					<year>2001</year>
					<article-title>New insight into RNase P RNA structure from comparative analysis of the archaeal RNA.</article-title>
					<source>RNA</source>
					<volume>7</volume>
					<fpage>220</fpage>
					<lpage>232</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030193-b058">
        <label>58</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Chvátal</surname><given-names>V</given-names></name><name name-style="western"><surname>Sankoff</surname><given-names>D</given-names></name></person-group>
					<year>1975</year>
					<article-title>Longest common subsequences of two random sequences.</article-title>
					<source>J Applied Probabillity</source>
					<volume>12</volume>
					<fpage>306</fpage>
					<lpage>315</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030193-b059">
        <label>59</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Karlin</surname><given-names>S</given-names></name><name name-style="western"><surname>Altschul</surname><given-names>S</given-names></name></person-group>
					<year>1990</year>
					<article-title>Methods for assessing the statistical significance of molecular sequence features by using general scoring schemes.</article-title>
					<source>Proc Natl Acad Sci U S A</source>
					<volume>87</volume>
					<fpage>2264</fpage>
					<lpage>2268</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030193-b060">
        <label>60</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Heyer</surname><given-names>LJ</given-names></name></person-group>
					<year>2000</year>
					<article-title>A generalized Erdös-rényi law for sequence analysis problems.</article-title>
					<source>Methodol Comput Appl Proby</source>
					<volume>2</volume>
					<fpage>309</fpage>
					<lpage>329</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030193-b061">
        <label>61</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Waterman</surname><given-names>MS</given-names></name><name name-style="western"><surname>Vingron</surname><given-names>M</given-names></name></person-group>
					<year>1994</year>
					<article-title>Sequence comparison significance and Poisson approximation.</article-title>
					<source>Stat Sci</source>
					<volume>9</volume>
					<fpage>367</fpage>
					<lpage>381</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030193-b062">
        <label>62</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Olsen</surname><given-names>R</given-names></name><name name-style="western"><surname>Bundschuh</surname><given-names>R</given-names></name><name name-style="western"><surname>Hwa</surname><given-names>T</given-names></name></person-group>
					<year>1999</year>
					<article-title>Rapid assessment of extremal statistics for gapped local alignment.</article-title>
					<source>Proc Int Conf Intell Syst Mol Biol</source>
					<volume>1999</volume>
					<fpage>211</fpage>
					<lpage>222</lpage>
				</element-citation>
      </ref>
    </ref-list>
  </back>
</article>