<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN"><front><journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="publisher">pcbi</journal-id><journal-id journal-id-type="allenpress-id">plcb</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher><publisher-name>Public Library of Science</publisher-name><publisher-loc>San Francisco, USA</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.1371/journal.pcbi.0030056</article-id><article-id pub-id-type="publisher-id">06-PLCB-RA-0503R2</article-id><article-id pub-id-type="sici">plcb-03-03-24</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline"><subject>Computational Biology</subject></subj-group><subj-group subj-group-type="System Taxonomy"><subject>None</subject></subj-group></article-categories><title-group><article-title>Query-Dependent Banding (QDB) for Faster RNA Similarity Searches</article-title><alt-title alt-title-type="running-head">Faster RNA Similarity Searches</alt-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Nawrocki</surname><given-names>Eric P</given-names></name><xref ref-type="aff" rid="aff1"/></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Eddy</surname><given-names>Sean R</given-names></name><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref><xref ref-type="aff" rid="aff1"/></contrib></contrib-group><aff id="aff1"><label>1</label><addr-line>Howard Hughes Medical Institute, Janelia Farm Research Campus, Ashburn, Virginia, United States of America</addr-line></aff><contrib-group><contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Stormo</surname><given-names>Gary</given-names></name><role>Editor</role><xref ref-type="aff" rid="edit1"/></contrib></contrib-group><aff id="edit1">Washington University, United States of America</aff><author-notes><fn fn-type="con" id="ack1"><p>Both authors contributed to all aspects of this work.</p></fn><corresp id="cor1">* To whom correspondence should be addressed. E-mail: <email xlink:type="simple">eddys@janelia.hhmi.org</email></corresp><fn fn-type="conflict" id="ack3"><p> The authors have declared that no competing interests exist.</p></fn></author-notes><pub-date pub-type="ppub"><month>3</month><year>2007</year></pub-date><pub-date pub-type="epub"><day>30</day><month>3</month><year>2007</year></pub-date><pub-date pub-type="epreprint"><day>7</day><month>2</month><year>2007</year></pub-date><volume>3</volume><issue>3</issue><elocation-id>e56</elocation-id><history><date date-type="received"><day>1</day><month>12</month><year>2006</year></date><date date-type="accepted"><day>6</day><month>2</month><year>2007</year></date></history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2007</copyright-year><copyright-holder>Nawrocki and Eddy</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract><p>When searching sequence databases for RNAs, it is desirable to score both primary sequence and RNA secondary structure similarity. Covariance models (CMs) are probabilistic models well-suited for RNA similarity search applications. However, the computational complexity of CM dynamic programming alignment algorithms has limited their practical application. Here we describe an acceleration method called query-dependent banding (QDB), which uses the probabilistic query CM to precalculate regions of the dynamic programming lattice that have negligible probability, independently of the target database. We have implemented QDB in the freely available Infernal software package. QDB reduces the average case time complexity of CM alignment from <italic>LN</italic><sup>2.4</sup> to <italic>LN</italic><sup>1.3</sup> for a query RNA of <italic>N</italic> residues and a target database of <italic>L</italic> residues, resulting in a 4-fold speedup for typical RNA queries. Combined with other improvements to Infernal, including informative mixture Dirichlet priors on model parameters, benchmarks also show increased sensitivity and specificity resulting from improved parameterization.</p></abstract><abstract abstract-type="summary"><title>Author Summary</title><sec id="st1"><title/><p>Database similarity searching is the sine qua non of computational molecular biology. Well-known and powerful methods exist for primary sequence searches, such as Blast and profile hidden Markov models. However, for RNA analysis, biologists rely not only on primary sequence but also on conserved RNA secondary structure to manually align and compare RNAs, and most computational tools for identifying RNA structural homologs remain too slow for large-scale use. We describe a new algorithm for accelerating one of the most general and powerful classes of methods for RNA sequence and structure analysis, so-called profile SCFG (stochastic context-free grammar) RNA similarity search methods. We describe this approach, called query-dependent banding, in the context of this and other improvements in a practical implementation, the freely available Infernal software package, the basis of the Rfam RNA family database for genome annotation. Infernal is now a faster, more sensitive, and more specific software tool for identifying homologs of structural RNAs.</p></sec></abstract><funding-group><funding-statement>EPN gratefully acknowledges financial support from a US National Institutes of Health (NIH) NHGRI Institutional Training Grant in Genomic Science, T32-HG000045. Work in SRE's lab in Washington University in St. Louis, where this work was initiated, was supported by NIH NHGRI grant R01-HG01363, Howard Hughes Medical Institute, and Alvin Goldfarb.</funding-statement></funding-group><counts><page-count count="15"/></counts><!--===== Restructure custom-meta-wrap to custom-meta-group =====--><custom-meta-group><custom-meta><meta-name>citation</meta-name><meta-value>Nawrocki EP, Eddy SR (2007) Query-dependent banding (QDB) for faster RNA similarity searches. PLoS Comput Biol 3(3): e56. doi:<ext-link ext-link-type="doi" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.0030056" xlink:type="simple">10.1371/journal.pcbi.0030056</ext-link></meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1"><title>Introduction</title><p>Many functional RNAs conserve a base-paired secondary structure. Conserved RNA secondary structure induces long-distance pairwise correlations in homologous RNA sequences. When performing database searches to identify homologous structural RNAs, it is desirable for RNA similarity search programs to score a combination of secondary structure and primary sequence conservation.</p><p>A variety of approaches for RNA similarity searching have been described. There are specialized programs for identifying one particular RNA family or motif, such as programs that identify transfer RNAs [<xref ref-type="bibr" rid="pcbi-0030056-b001">1</xref>,<xref ref-type="bibr" rid="pcbi-0030056-b002">2</xref>], small nucleolar RNAs [<xref ref-type="bibr" rid="pcbi-0030056-b003">3</xref>,<xref ref-type="bibr" rid="pcbi-0030056-b004">4</xref>], microRNAs [<xref ref-type="bibr" rid="pcbi-0030056-b005">5</xref>,<xref ref-type="bibr" rid="pcbi-0030056-b006">6</xref>], signal recognition particle (SRP) RNAs [<xref ref-type="bibr" rid="pcbi-0030056-b007">7</xref>], and rho-independent transcription terminators [<xref ref-type="bibr" rid="pcbi-0030056-b008">8</xref>]. There are also pattern-matching algorithms that rely on expertly designed query patterns [<xref ref-type="bibr" rid="pcbi-0030056-b009">9</xref>]. However, the most generally useful approaches are those that take any RNA (or any multiple RNA alignment) as a query and use an appropriate scoring system to search a sequence database and rank high-scoring similarities [<xref ref-type="bibr" rid="pcbi-0030056-b010">10</xref>,<xref ref-type="bibr" rid="pcbi-0030056-b011">11</xref>], just as programs like Blast (<ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/BLAST/" xlink:type="simple">http://www.ncbi.nlm.nih.gov/BLAST/</ext-link>) do for linear sequence comparison [<xref ref-type="bibr" rid="pcbi-0030056-b012">12</xref>].</p><p>In a general search program, one wants to score a combination of RNA sequence and structural conservation in a principled rather than an ad hoc manner. A satisfactory solution to this problem is known, using probabilistic models called stochastic context-free grammars (SCFGs). SCFGs readily capture both primary sequence and (non–pseudo-knotted) RNA secondary structure conservation [<xref ref-type="bibr" rid="pcbi-0030056-b013">13</xref>,<xref ref-type="bibr" rid="pcbi-0030056-b014">14</xref>]. Just as hidden Markov models (HMMs) are useful for many different linear sequence modeling applications, including gene finding, multiple alignment, motif finding, and similarity search [<xref ref-type="bibr" rid="pcbi-0030056-b014">14</xref>], SCFGs are a generally useful paradigm for probabilistic RNA sequence/structure analysis, with applications including secondary structure prediction and gene finding. A particular SCFG architecture called covariance models (CMs) was developed specifically for the RNA similarity search problem [<xref ref-type="bibr" rid="pcbi-0030056-b015">15</xref>]. CMs are profile SCFGs, analogous to the use of profile HMMs in sequence analysis [<xref ref-type="bibr" rid="pcbi-0030056-b015">15</xref>,<xref ref-type="bibr" rid="pcbi-0030056-b016">16</xref>]. The Rfam database of RNA families [<xref ref-type="bibr" rid="pcbi-0030056-b017">17</xref>] is based on CM software (Infernal [inference of RNA alignment]; <ext-link ext-link-type="uri" xlink:href="http://infernal.janelia.org" xlink:type="simple">http://infernal.janelia.org</ext-link>) in much the same way that the Pfam database of protein families is based on profile HMM software (HMMER; <ext-link ext-link-type="uri" xlink:href="http://hmmer.janelia.org" xlink:type="simple">http://hmmer.janelia.org</ext-link>) [<xref ref-type="bibr" rid="pcbi-0030056-b018">18</xref>,<xref ref-type="bibr" rid="pcbi-0030056-b019">19</xref>].</p><p>The most serious problem with using CMs has been their computational complexity. Applying standard SCFG dynamic programming (DP) alignment algorithms to the particular case of CMs results in algorithms that require <italic>O</italic>(<italic>N</italic><sup>3</sup>) memory and <italic>O</italic>(<italic>LN</italic><sup>3</sup>) time for a query of length <italic>N</italic> residues (or consensus alignment columns) and a target database sequence of length <italic>L</italic>. The memory complexity problem has essentially been solved, by extending divide-and-conquer DP methods (the Hirshberg or Myers/Miller algorithm) to the case of CMs [<xref ref-type="bibr" rid="pcbi-0030056-b016">16</xref>], but the time complexity problem still stands.</p><p>Weinberg and Ruzzo [<xref ref-type="bibr" rid="pcbi-0030056-b020">20</xref>–<xref ref-type="bibr" rid="pcbi-0030056-b022">22</xref>] have described several filtering methods for accelerating CM searches. The original idea (“rigorous filters”) was to score a target sequence first by a linear sequence comparison method, using a profile HMM specially constructed from the query CM such that the profile score was provably an upper bound on the CM score; the subset of hits above threshold would then be passed for rescoring with the more expensive CM alignment algorithm [<xref ref-type="bibr" rid="pcbi-0030056-b021">21</xref>]. Subsequently a “maximum likelihood heuristic” filter profile was developed that gives up the guarantee of recovering the same hits as the unfiltered search but offers greater speedups [<xref ref-type="bibr" rid="pcbi-0030056-b022">22</xref>]. For most current Rfam models, Weinberg–Ruzzo filters give about a 100-fold speedup relative to a full CM-based search at little or no cost to sensitivity and specificity. However, because these filters depend on primary sequence conservation alone, they can be relatively ineffective for RNA families that exhibit poor sequence conservation—unfortunately, precisely the RNAs that benefit the most from SCFG-based search methods. Indeed, in this respect, we are concerned that the overall performance of rigorous filters on the current Rfam database may be somewhat misleading. Rfam currently uses a crude Blast-based filtering method to accelerate the CM searches used in curating the database. This step introduces a bias toward high primary sequence similarity in current Rfam alignments. As Rfam improves and incorporates more diverse structural homologs, the effectiveness of sequence-based filters will decrease. To address this worry, Weinberg and Ruzzo [<xref ref-type="bibr" rid="pcbi-0030056-b020">20</xref>] have also described additional heuristics (“sub-CMs” and the “store-pair” technique) that should capture more secondary structure information in the filtering process. Bafna and coworkers [<xref ref-type="bibr" rid="pcbi-0030056-b023">23</xref>] have described further improvements to sequence filtering methods. Currently, the Infernal codebase includes Weinberg's C++ implementation of rigorous filters but not, as yet, the ML heuristic, sub-CM, or store-pair methods. All these methods are important, but it also remains important to us to identify yet more methods for accelerating CMs.</p><p>Here, we describe a method for accelerating CM searches using a banded DP strategy. In banded DP, one uses a fast method to identify a band through the DP matrix where the optimal alignment is likely to lie and then calculates computationally expensive DP recursions only within that band. In most cases, including our approach, banded DP is a heuristic that sacrifices guaranteed alignment optimality. Banding is a standard approach in many areas of sequence analysis. Gapped Blast uses banded DP to convert ungapped high-scoring pairs (HSPs) to full gapped alignments [<xref ref-type="bibr" rid="pcbi-0030056-b012">12</xref>]. LAGAN and Multi-LAGAN (<ext-link ext-link-type="uri" xlink:href="http://lagan.stanford.edu" xlink:type="simple">http://lagan.stanford.edu</ext-link>) use banded DP (referred to as limited-area DP) to stitch together alignments between anchored sequences when aligning long genomic sequences [<xref ref-type="bibr" rid="pcbi-0030056-b024">24</xref>]. Banding has also been applied to profile SCFGs by Michael Brown in his RNACAD program by using information from a profile HMM alignment to define bands for the expensive SCFG alignment [<xref ref-type="bibr" rid="pcbi-0030056-b025">25</xref>]. The key to developing a banded DP strategy is in deciding how the bands are identified. Usually, including all the examples just mentioned, banded DP involves performing some sort of rapid approximate sequence alignment between the query and the target.</p><p>In contrast, the method we describe here, called query-dependent banding (QDB), takes advantage of specific properties of CMs in order to predefine bands that are independent of any target sequence. QDB depends on the consensus secondary structure of the query, so it is complementary to acceleration methods such as the Weinberg–Ruzzo filters that rely on sequence but not structure.</p></sec><sec id="s2"><title>Results</title><p>Briefly, the key idea is the following. Each base pair and each single-stranded residue in the query RNA is represented in a CM by a <italic>state</italic>. States are arranged in a treelike structure that mirrors the secondary structure of the RNA, along with additional states to model insertions and deletions. The standard CM DP alignment algorithm works by calculating the probability that a substructure of the query rooted at state <italic>v</italic> aligns to a subsequence <italic>i</italic>… <italic>j</italic> in the target sequence. The calculation is recursive, starting at the leaves of the CM (ends of hairpin loops) and subsequences of length 0, and working upward in larger substructures of the CM, and outward in longer and longer subsequences.</p><p>To guarantee optimality, at each <italic>v,</italic> the DP algorithm must score all possible <italic>i</italic>… <italic>j</italic> subsequences in the target sequence. However, most of these subsequences are obviously too long or short, when one considers the size of the query substructure under state <italic>v</italic>. For example, when state <italic>v</italic> models the closing base pair of a consensus four-base loop, only <italic>i</italic>… <italic>j</italic> subsequences of length six are likely to occur in any optimal alignment to state <italic>v</italic>; that is, (<italic>j</italic> − 5,<italic>j</italic>) being the base pair and (<italic>j</italic> − 4… <italic>j</italic> − 1) being the four bases of the hairpin loop. Likewise, the optimal subsequence aligned to the next consensus base pair in that stem is almost certainly of length eight.</p><p>Because insertions and deletions may occur in the target sequence, no subsequence length is known with certainty, but because the CM is a probabilistic model, a probability distribution for subsequence lengths under each state (including the probability of insertions and deletions) can be analytically derived from the query CM. These distributions can be used to determine a band of subsequence lengths that captures all but a negligible amount of the probability mass. A CM DP algorithm can then look not at all subsequences <italic>i</italic>,<italic>j</italic> for each state <italic>v</italic> but only those <italic>i</italic> within a band of minimum and maximum distance relative to each <italic>j</italic>.</p><p>To formalize this idea, we start with a description of CMs, followed by the QDB algorithms for calculating the subsequence length distributions, using these length distributions to determine bands, and using the bands in a banded CM DP alignment algorithm. Calculation of the bands is sensitive to transition parameter estimation, so we describe Infernal's new implementation of informative Dirichlet priors for CM parameter estimation. Finally, we present results from a benchmark that suggest the sensitivity and specificity of a QDB-accelerated search are negligibly different from those of a nonbanded search.</p><sec id="s2a"><title>Covariance Models</title><p>CMs are a convention for mapping an RNA secondary structure into a treelike, directed graph of SCFG states and state transitions (or, equivalently, SCFG nonterminals and production rules). The CM is organized by a binary tree of nodes representing base pairs and single-stranded residues in the query's structure. Each node contains a number of states, where one state represents the consensus alignment to the query, and the others represent insertions and deletions relative to the query. <xref ref-type="fig" rid="pcbi-0030056-g001">Figure 1</xref> shows an example of converting a consensus structure to the guide tree of nodes and part of the expansion of those guide tree nodes into the CM's state graph. Here, we will only concentrate on the aspects of CMs necessary to understand QDB, and a subset of our usual notation. For full details on CM construction, see [<xref ref-type="bibr" rid="pcbi-0030056-b016">16</xref>,<xref ref-type="bibr" rid="pcbi-0030056-b026">26</xref>].</p><fig id="pcbi-0030056-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030056.g001</object-id><label>Figure 1</label><caption><title>An Example RNA Family and Corresponding CM</title><p>(A) A toy multiple alignment of three RNA sequences, with 28 total columns, 24 of which will be modeled as consensus positions. The [structure] line annotates the consensus secondary structure: angle brackets mark base pairs, colons mark consensus single-stranded positions, and periods mark “insert” columns that will not be considered part of the consensus model because more than half the sequences in these columns contain gaps.</p><p>(B) The structure of one sequence from (A), the same structure with positions numbered according to alignment columns, and the guide tree of nodes corresponding to that structure, with alignment column indices assigned to nodes (for example, node 5, a MATP match-pair node, will model the consensus base pair between columns 4 and 14).</p><p>(C) The state topology of three selected nodes of the CM, for two MATP nodes and one consensus “leftwise” single residue bulge node (MATL, “match-left”). The consensus pair and singlet states (two MPs and one ML) are white, and the insertion/deletion states are gray. State transitions are indicated by arrows.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030056.g001" xlink:type="simple"/></fig><p>A guide tree consists of eight types of nodes. MATP nodes represent consensus base pairs. MATL and MATR nodes represent consensus single-stranded residues (emitted to the left or right with respect to a stem). BIF nodes represent bifurcations in the secondary structure of the family, to deal with multiple stem-loops. A ROOT node represents the start of the model. BEGL and BEGR nodes represent the beginnings of a branch on the left and right side of a bifurcation, respectively. END nodes end each branch.</p><p>The CM is composed of seven different types of states, each with a corresponding form of production rule, with notation defined as follows:
					<disp-formula id="pcbi-0030056-eq001"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030056.eq001" xlink:type="simple"/><!-- <bold>State</bold><bold>Description</bold><bold>Production</bold> --><!-- <mml:math display='inline'><mml:mrow><mml:msubsup><mml:mi>&Delta;</mml:mi><mml:mi>v</mml:mi><mml:mi>L</mml:mi></mml:msubsup></mml:mrow></mml:math><mml:math display='inline'><mml:mrow><mml:msubsup><mml:mi>&Delta;</mml:mi><mml:mi>v</mml:mi><mml:mi>R</mml:mi></mml:msubsup></mml:mrow></mml:math> --><!-- <bold>Emission</bold><bold>Transition</bold> --><!-- PPair emitting<italic>P</italic> &rarr; <italic>aYb</italic>11<italic>e<sub>v</sub></italic>(<italic>a,b</italic>)<italic>t<sub>v</sub></italic>(<italic>Y</italic>) --><!-- LLeft emitting<italic>L</italic> &rarr; <italic>aY</italic>10<italic>e<sub>v</sub></italic>(<italic>a</italic>)<italic>t<sub>v</sub></italic>(<italic>Y</italic>) --><!-- RRight emitting<italic>R</italic> &rarr; <italic>Ya</italic>01<italic>e<sub>v</sub></italic>(<italic>a</italic>)<italic>t<sub>v</sub></italic>(<italic>Y)</italic> --><!-- BBifurcation<italic>B</italic> &rarr; <italic>SS</italic>0011 --><!-- DDelete<italic>D</italic> &rarr; <italic>Y</italic>001<italic>t<sub>v</sub></italic>(<italic>Y)</italic> --><!-- SStart<italic>S</italic> &rarr; <italic>Y</italic>001<italic>t<sub>v</sub></italic>(<italic>Y)</italic> --><!-- EEnd <italic>E</italic> &rarr; &epsiv;0011 --></disp-formula>
				</p><p>That is, for instance, if state <italic>v</italic> is a pair state, it produces (aligns to and scores) two correlated residues, <italic>a</italic> and <italic>b,</italic> and moves to some new state, <italic>Y</italic>. The probability that it produces a residue pair <italic>a</italic>,<italic>b</italic> is given by an emission probability <italic>e<sub>v</sub>(a,b</italic>). The probability that it moves to a particular state <italic>Y</italic> is given by a transition probability <italic>t<sub>v</sub></italic>(<italic>Y)</italic>. The set of possible states <italic>Y</italic> that <italic>v</italic> may transit to is limited to the states in the next (lower) node in the guide tree (and insert states in the current node); the set of possible children states <italic>Y</italic> is called <italic>C<sub>v</sub>,</italic> for “children of <italic>v</italic>.” The indicators <inline-formula id="pcbi-0030056-ex003"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0030056.ex003" xlink:type="simple"/></inline-formula>
					 and <inline-formula id="pcbi-0030056-ex004"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0030056.ex004" xlink:type="simple"/></inline-formula>
					 are used to simplify notation in CM DP algorithms. They are the number of residues emitted to the left and right of state <italic>v,</italic> respectively. Bifurcation rules are special, in that they always transition to two particular start (S) states, at the root of subtrees in the guide tree, with probability 1.0.
				</p><p>These state types essentially define a “normal form” for SCFG models of RNA, akin to SCFGs in Chomsky normal form where all productions are in one of two forms, <italic>Y</italic> → <italic>a</italic> or <italic>Y</italic> → <italic>YY</italic>. We describe CM algorithms (including QDB) in terms of this normal form. CMs define a specific way that nodes in the guide tree are expanded into states and how those states are connected within each node and to states in the next node in the guide tree. For example, a MATP node that deals with a consensus base pair contains six states called MATP_MP (a P state for matching the base pair), MATP_ML and MATP_MR (an L and an R state for matching only the leftmost or rightmost base and deleting the right or left one, respectively), MATP_D (a D state for deleting the base pair), and MATP_IL and MATP_IR (L and R states with self-transitions, for inserting one or more residues to the left and/or right, respectively, before going to the next node).</p><p>Thus, a CM is a generative probabilistic model of homologous RNAs. A sequence is emitted starting at the root, moving downward from state to state according to state transition probabilities, emitting residues and residue pairs according to emission probabilities, and bifurcating into substructures at bifurcation states. An important property of a CM is the states can be numbered from 0 . . . <italic>M</italic> − 1 (from root to leaves) such that for any state <italic>v,</italic> the states <italic>y</italic> that it can transit to must have indices <italic>y</italic> ≥ <italic>v</italic>. There are no cycles in a CM, other than self-transitions on insert states. This is the property that enables the recursive calculations that both CM DP alignment algorithms and QDB rely on.</p><p>Without any change in the above description, CMs apply to either global or local alignment, and to either pairwise alignment to single RNA queries or profile alignment to a consensus query structure of a multiple RNA sequence alignment. CMs for single RNA queries are derived identically to profiles of a consensus structure, differing only in the parameterization method [<xref ref-type="bibr" rid="pcbi-0030056-b027">27</xref>]. Local structural alignment to substructures and truncated structures (as opposed to requiring a global alignment to the whole RNA structural model) is achieved by adding state transitions from the ROOT that permit entering the model at any internal consensus state with some probability, and state transitions from any internal consensus state to an END with some probability [<xref ref-type="bibr" rid="pcbi-0030056-b026">26</xref>,<xref ref-type="bibr" rid="pcbi-0030056-b027">27</xref>].</p></sec><sec id="s2b"><title>QDB Algorithm</title><p>Observe that for any state <italic>v,</italic> we could enumerate all possible paths down the model from <italic>v</italic> to the END(s). Each path has a certain probability (the product of the transition probabilities used by the path), and it will emit a certain number <italic>d</italic> of residues (two per P state, one per L or R state in the path). The sum of these path probabilities for each <italic>d</italic> defines a probability distribution γ<italic><sub>v</sub></italic>(<italic>d</italic>), the probability that the CM subgraph rooted at <italic>v</italic> will generate a subsequence of length <italic>d</italic>. Given a finite limit <italic>Z</italic> on maximum subsequence length (defined later), we can calculate γ<italic><sub>v</sub></italic>(<italic>d</italic>) by an efficient recursive algorithm, working from the leaves of the CM toward the root and from smallest subsequences to largest:</p><p>for <italic>v</italic> = <italic>M</italic> − 1 down to 0:</p><p><italic>v</italic> = end state (<italic>E</italic>):
					<disp-formula id="pcbi-0030056-eq002"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030056.eq002" xlink:type="simple"/><!-- <italic>&gamma;<sub>v</sub></italic>(0) &equals; 1 <italic>&gamma;<sub>v</sub></italic>(<italic>d</italic>) &equals; 0 for <italic>d</italic> &equals; 1 to <italic>Z</italic> --></disp-formula><italic>v</italic> = bifurcation (<italic>B</italic>):
					<disp-formula id="pcbi-0030056-eq003"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030056.eq003" xlink:type="simple"/><!-- <mml:math display='inline'><mml:mrow><mml:msub><mml:mi>&gamma;</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>d</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>&equals;</mml:mo><mml:mstyle displaystyle='false'><mml:msubsup><mml:mo>&sum;</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>&equals;</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>d</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mi>&gamma;</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>*</mml:mo><mml:msub><mml:mi>&gamma;</mml:mi><mml:mi>z</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mo>&minus;</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:math> for <italic>d</italic> &equals; 0 to <italic>Z</italic> --></disp-formula>else (<italic>v = S,P,L,R</italic>):
					<disp-formula id="pcbi-0030056-eq004"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030056.eq004" xlink:type="simple"/><!-- <mml:math display='inline'><mml:mrow><mml:msub><mml:mi>&gamma;</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>d</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>&equals;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math> for <italic>d</italic> &equals; 0 to
						<mml:math display='inline'><mml:mrow><mml:mo stretchy='false'>(</mml:mo><mml:msubsup><mml:mi>&Delta;</mml:mi><mml:mi>v</mml:mi><mml:mi>L</mml:mi></mml:msubsup><mml:mo>&plus;</mml:mo><mml:msubsup><mml:mi>&Delta;</mml:mi><mml:mi>v</mml:mi><mml:mi>R</mml:mi></mml:msubsup><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy='false'>)</mml:mo></mml:mrow></mml:math> --><!-- <mml:math display='inline'><mml:mrow><mml:msub><mml:mi>&gamma;</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>d</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>&equals;</mml:mo><mml:mstyle displaystyle='false'><mml:msub><mml:mo>&sum;</mml:mo><mml:mrow><mml:mi>y</mml:mi><mml:mo>&isin;</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mi>&gamma;</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:mstyle><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mo>&minus;</mml:mo><mml:mo stretchy='false'>(</mml:mo><mml:msubsup><mml:mi>&Delta;</mml:mi><mml:mi>v</mml:mi><mml:mi>L</mml:mi></mml:msubsup><mml:mo>&plus;</mml:mo><mml:msubsup><mml:mi>&Delta;</mml:mi><mml:mi>v</mml:mi><mml:mi>R</mml:mi></mml:msubsup><mml:mo stretchy='false'>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>*</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math> for
						<mml:math display='inline'><mml:mrow><mml:mi>d</mml:mi><mml:mo>&equals;</mml:mo><mml:mo stretchy='false'>(</mml:mo><mml:msubsup><mml:mi>&Delta;</mml:mi><mml:mi>v</mml:mi><mml:mi>L</mml:mi></mml:msubsup><mml:mo>&plus;</mml:mo><mml:msubsup><mml:mi>&Delta;</mml:mi><mml:mi>v</mml:mi><mml:mi>R</mml:mi></mml:msubsup><mml:mo stretchy='false'>)</mml:mo></mml:mrow></mml:math> to <italic>Z</italic> --></disp-formula>
				</p><p>For example, if we are calculating γ<italic><sub>v</sub></italic>(<italic>d</italic>) where <italic>v</italic> is a pair state, we know that <italic>v</italic> must emit a pair of residues and then transit to a new state <italic>y</italic> (one of its possible transitions <italic>C<sub>v</sub></italic>), and then a subgraph rooted at <italic>y</italic> will have to account for the rest of the subsequence of length <italic>d</italic> − 2. Therefore, γ<italic><sub>v</sub></italic>(<italic>d</italic>) must be the sum, over all possible states <italic>y</italic> in <italic>C<sub>v</sub></italic>, of the transition probability <italic>t<sub>v</sub></italic>(<italic>y</italic>) times the probability that the subtree rooted at <italic>y</italic> generates a subsequence of length <italic>d</italic> − 2, which is γ<italic><sub>v</sub></italic>(<italic>d</italic> − 2), guaranteed to have already been calculated by the recursion. For the B state (bifurcation) calculation, indices <italic>y</italic> and <italic>z</italic> indicate the left and right S (start) state that bifurcation state <italic>v</italic> must connect to.</p><p>A band dmin(<italic>v</italic>)…dmax(<italic>v</italic>) of subsequence lengths that will be allowed for each state <italic>v</italic> is then defined as follows. A parameter β defines the threshold for the negligible probability mass that we are willing to allow outside the band. (The default value of β is set to 10<sup>−7</sup>, as described later.) We define dmin(<italic>v</italic>) and dmax(<italic>v</italic>) such that the cumulative left and right tails of γ<italic><sub>v</sub></italic>(<italic>d</italic>) contain less than a probability <inline-formula id="pcbi-0030056-ex010"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0030056.ex010" xlink:type="simple"/></inline-formula>
					:
					<disp-formula id="pcbi-0030056-e001"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030056.e001" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mstyle displaystyle='true'><mml:munderover><mml:mo>&sum;</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mo>&equals;</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mtext>dmin</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mi>&gamma;</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>d</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>&lt;</mml:mo><mml:mfrac><mml:mi>&beta;</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:mstyle></mml:mrow><mml:mo>,</mml:mo></mml:math> --><!-- <mml:math display='block'><mml:mrow><mml:mstyle displaystyle='true'><mml:munderover><mml:mo>&sum;</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mo>&equals;</mml:mo><mml:mtext>dmax</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>&plus;</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>Z</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>&gamma;</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>d</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>&lt;</mml:mo><mml:mfrac><mml:mi>&beta;</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:mstyle></mml:mrow><mml:mo>.</mml:mo></mml:math> --></disp-formula>
				</p><p>Larger values of β produce tighter bands and faster alignments, but at a cost of increased risk of missing the optimal alignment. β is the only free parameter that must be specified to QDB.</p><p>Because CMs have emitting self-loops (i.e., insert states), there is no finite limit on subsequence lengths. However, we must impose a finite limit <italic>Z</italic> to obtain a finite calculation. <italic>Z</italic> can be chosen to be sufficiently large that it does not affect dmax(<italic>v</italic>) for any state <italic>v</italic>. On a digital computer with floating point precision ɛ (the largest value for which 1 + ɛ = 1), it suffices to guarantee that, for all <italic>v:</italic>
					<disp-formula id="pcbi-0030056-e002"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030056.e002" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mfrac><mml:mrow><mml:mstyle displaystyle='true'><mml:munderover><mml:mo>&sum;</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mo>&equals;</mml:mo><mml:mi>Z</mml:mi><mml:mo>&plus;</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>&infin;</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>&gamma;</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>d</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow><mml:mrow><mml:mstyle displaystyle='true'><mml:munderover><mml:mo>&sum;</mml:mo><mml:mrow><mml:msup><mml:mi>d</mml:mi><mml:mo>&prime;</mml:mo></mml:msup><mml:mo>&equals;</mml:mo><mml:mtext>dmax</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>&plus;</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>Z</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>&gamma;</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>d</mml:mi><mml:mo>&prime;</mml:mo></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:mfrac><mml:mo>&le;</mml:mo><mml:mi>&epsiv;</mml:mi></mml:mrow></mml:math> --></disp-formula>
				</p><p>Empirically, we observe that the tails of the γ<italic><sub>v</sub>(d)</italic> densities decrease approximately geometrically. We can estimate the mass remaining in the unseen tail by fitting a geometric tail to the observed density γ<italic><sub>v</sub>(d)</italic>. Our implementation starts with a reasonable guess at <italic>Z</italic> and verifies that the above condition is true for each <italic>v,</italic> assuming these geometrically decreasing tails; if it is not, <italic>Z</italic> is increased and bands are recalculated until it is.</p><p>A QDB calculation needs to be performed only once per query CM to set the bands. Overall, a QDB calculation requires Θ(<italic>MZ</italic>) in time and space, or, equivalently, because both <italic>M</italic> and <italic>Z</italic> scale roughly linearly with the length <italic>L</italic> in residues of the query RNA, Θ(<italic>L</italic><sup>2</sup>)<italic>.</italic> The time and space requirement is negligible compared with the requirements of a typical CM search.</p></sec><sec id="s2c"><title>Banded Cocke–Younger–Kasami Database Search Algorithm for CMs</title><p>A standard algorithm for obtaining the maximum likelihood alignment (parse tree) of an SCFG to a target sequence is the Cocke–Younger–Kasami (CYK) DP algorithm [<xref ref-type="bibr" rid="pcbi-0030056-b028">28</xref>−<xref ref-type="bibr" rid="pcbi-0030056-b030">30</xref>]. Formally, CYK applies to SCFGs reduced to Chomsky normal form, and it aligns to the complete sequence. The CM database search algorithm is a CYK variant, specialized for the “normal form” of our seven types of RNA production rules and for scanning long genomic sequences for high-scoring subsequences (hits) [<xref ref-type="bibr" rid="pcbi-0030056-b014">14</xref>].</p><p>The CM search algorithm recursively calculates α<italic><sub>v</sub></italic>(<italic>j,d</italic>)<italic>,</italic> the log probability of the most likely CM parse subtree rooted at state <italic>v</italic> that generates (aligns to) the length <italic>d</italic> subsequence <italic>x<sub>j−d</sub></italic><sub>+1</sub>… <italic>x<sub>j</sub></italic> that ends at position <italic>j</italic> of target sequence <italic>x</italic> [<xref ref-type="bibr" rid="pcbi-0030056-b014">14</xref>,<xref ref-type="bibr" rid="pcbi-0030056-b015">15</xref>]. This calculation initializes at the smallest subgraphs (<italic>E</italic> states) and shortest subsequences (<italic>d</italic> = 0) and iterates upward and outward to progressively larger subtrees and longer subsequences up to a preset window size <italic>W</italic>. The outermost loop iterates over the end position <italic>j</italic> on the target sequence, enabling an efficient scan across a long target like a chromosome sequence. Banding is achieved simply by limiting all loops over possible subsequence lengths <italic>d</italic> to the bounds dmin(<italic>v</italic>)<italic>…</italic>dmax(<italic>v</italic>) derived in the band calculation algorithm, rather than all possible lengths 0…<italic>W</italic>. The banded version of the algorithm is as follows:
					<disp-formula id="pcbi-0030056-eq005"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030056.eq005" xlink:type="simple"/><!-- Initialization (impose bands): for <italic>j</italic> &equals; 0 to <italic>L</italic>, <italic>v</italic> &equals; <italic>M</italic> &minus; 1 down to 0: --><!-- for <italic>d</italic> &equals; 0 to (dmin(<italic>v</italic>) &minus; 1),&emsp;&alpha;<italic><sub>v</sub></italic>(<italic>j,d</italic>) <italic>&equals;</italic> &minus;&infin;; --><!-- for <italic>d</italic> &equals; min((dmax(<italic>v</italic>) &plus; 1), (j &plus; 1)) to <italic>W</italic>&ensp;&thinsp;&alpha;<italic><sub>v</sub></italic>(<italic>j,d</italic>) <italic>&equals;</italic> &minus;&infin;; --><!-- Initialization at <italic>d</italic> &equals; 0: for <italic>j</italic> &equals; 0 to <italic>L</italic>, <italic>v</italic> &equals; <italic>M</italic> &minus; 1 down to 0: --><!-- <italic>v</italic> &equals; end state (<italic>E</italic>):&alpha;<italic><sub>v</sub></italic>(<italic>j,</italic>0) <italic>&equals;</italic> 0 --><!-- <italic>v</italic> &equals; bifurcation (<italic>B</italic>):&alpha;<italic><sub>v</sub></italic>(<italic>j,</italic>0) &equals; &alpha;<italic><sub>y</sub></italic>(<italic>j,</italic>0) &plus; &alpha;<italic><sub>z</sub></italic>(<italic>j,</italic>0); --><!-- <italic>v</italic> &equals; delete or start (<italic>D</italic>,<italic>S</italic>):&thinsp;<mml:math display='inline'><mml:mrow><mml:msub><mml:mi>&alpha;</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&equals;</mml:mo><mml:msub><mml:mrow><mml:mi>max</mml:mi><mml:mo></mml:mo></mml:mrow><mml:mrow><mml:mi>y</mml:mi><mml:mo>&isin;</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>&lsqb;</mml:mo><mml:mrow><mml:msub><mml:mi>&alpha;</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&plus;</mml:mo><mml:mi>log</mml:mi><mml:mo></mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>&rsqb;</mml:mo></mml:mrow></mml:mrow></mml:math> --><!-- else (<italic>v</italic> &equals; <italic>P</italic>, <italic>L</italic>, <italic>R):</italic>&alpha;<italic><sub>v</sub></italic>(<italic>j,</italic>0) &equals; &minus;&infin;. --><!-- Recursion: for <italic>j</italic> &equals; 1 to <italic>L</italic>, <italic>d</italic> &equals; max(1,dmin(<italic>v</italic>)) to min(dmax(<italic>v</italic>),<italic>j</italic>),<italic>v</italic> &equals; <italic>M</italic> &minus;1 down to 0 --><!-- <italic>v</italic> &equals; end state (<italic>E</italic>):&alpha;<italic><sub>v</sub></italic>(<italic>j,d</italic>) &equals; &minus;&infin;; --><!-- <italic>v</italic> &equals; bifurcation (<italic>B</italic>):kmin &equals; max(dmin(<italic>z</italic>)<italic>,</italic>(<italic>d</italic> &minus; dmax(<italic>y</italic>))), --><!-- kmax &equals; min(dmax(<italic>z</italic>)<italic>,</italic>(<italic>d</italic> &minus; dmin(<italic>y</italic>))), --><!-- <italic>&alpha;<sub>v</sub></italic>(<italic>j,d</italic>) &equals; max<sub>kmin &le; <italic>k</italic> &le; kmax</sub> &lsqb;&alpha;<italic><sub>y</sub></italic>(<italic>j &minus; k,d &minus; k</italic>) &plus; &alpha;<italic><sub>z</sub></italic>(<italic>j,k</italic>)&rsqb;; --><!-- <italic>v</italic> &equals; delete or start (<italic>D</italic>,<italic>S</italic>): <italic>&alpha;<sub>v</sub>(j,d)</italic> &equals; max<italic><sub>y&isin;C<sub>v</sub> </sub></italic>&lsqb;<italic>&alpha;<sub>y</sub>(j,d)</italic> &plus; log <italic>t</italic><sub><italic>v</italic></sub>(y)&rsqb;<sub>;</sub> --><!-- else (<italic>v</italic> &equals; <italic>P</italic>,<italic>L</italic>,<italic>R</italic>): <italic>&alpha;<sub>v</sub>(j,d)</italic> &equals; max<italic><sub>y&isin;C<sub>v</sub></sub></italic> &lsqb;&alpha;<italic><sub>y</sub></italic>(j &minus; <mml:math display="inline"><mml:msubsup><mml:mi>&Delta;</mml:mi><mml:mi>v</mml:mi><mml:mi>R</mml:mi></mml:msubsup></mml:math> <mml:math display="inline"><mml:msubsup><mml:mi>&Delta;</mml:mi><mml:mi>v</mml:mi><mml:mi>L</mml:mi></mml:msubsup></mml:math> &plus; <mml:math display="inline"><mml:msubsup><mml:mi>&Delta;</mml:mi><mml:mi>v</mml:mi><mml:mi>R</mml:mi></mml:msubsup></mml:math>)) &plus; log <italic>t</italic><italic><sub>v</sub></italic>(<italic>y</italic>)&rsqb; &plus; log <italic>e</italic><sub><italic>v</italic></sub>(<italic>x</italic><italic><sub>i</sub></italic>,<italic>x</italic><italic><sub>j</sub></italic>). --></disp-formula>
				</p><p>For example, if we are calculating α<sub><italic>v</italic></sub>(<italic>j,d</italic>) and <italic>v</italic> is a pair state (<italic>P</italic>)<italic>, v</italic> will generate the base pair <italic>x<sub>j−d</sub></italic><sub>+1</sub>,<italic>x<sub>j</sub></italic> and transit to a new state <italic>y</italic> (one of its possible transitions <italic>C<sub>v</sub></italic>), which then will have to account for the smaller subsequence <italic>x<sub>j−d</sub></italic><sub>+2</sub>… <italic>x<sub>j</sub></italic><sub>−1</sub>. The log probability for a particular choice of next state <italic>y</italic> is the sum of three terms: an emission term log <italic>e<sub>v</sub></italic> (<italic>x<sub>j−d</sub></italic><sub>+1</sub>,<italic>x<sub>j</sub></italic>), a transition term log <italic>t<sub>v</sub></italic>(<italic>y</italic>), and an already calculated solution for the smaller optimal parse tree rooted at <italic>y</italic>, <italic>α</italic><sub><italic>y</italic></sub>(<italic>j</italic> – 1,<italic>d</italic> – 2). The value assigned to α<sub><italic>v</italic></sub>(<italic>j,d</italic>) is the maximum over all possible choices of child states <italic>y</italic> that <italic>v</italic> can transit to.</p><p>The <italic>W</italic> parameter defines the maximum size of a potential hit to a model. Previous Infernal implementations required an ad hoc guess at a reasonable <italic>W</italic>. The band calculation algorithm delivers a probabilistically derived <italic>W</italic> for database search in dmax(0), the upper bound on the length of the entire sequence (the sequence generated from the root state of the CM).</p><p>In our implementation, this algorithim is encoded in a more memory-efficient form that allocates space for only two sequence positions in <italic>j</italic> (current and previous) for most states rather than for all <italic>j</italic> = 0…<italic>L</italic>, using essentially the same techniques described for CYK search in [<xref ref-type="bibr" rid="pcbi-0030056-b014">14</xref>]. We have omitted the necessary details here for clarity. QDB does not reduce the asymptotic computational complexity of the CM search algorithm. Both the banded algorithm and the original algorithm are <italic>O</italic>(<italic>MW + BW<sup>2</sup></italic>) memory and <italic>O</italic>(<italic>L</italic>(<italic>MW + BW<sup>2</sup></italic>)) time, for a model of <italic>M</italic> states containing <italic>B</italic> bifurcation states, window size <italic>W</italic> of residues, and target database length <italic>L. M</italic>, <italic>B</italic>, and <italic>W</italic> all scale with the query RNA length <italic>N</italic>, so roughly speaking, worst-case asymptotic time complexity is <italic>O</italic>(<italic>LN</italic><sup>3</sup>)<italic>.</italic></p></sec><sec id="s2d"><title>Informative Dirichlet Priors</title><p>The subsequence length distributions calculated by QDB depend on the CM's transition probabilities. Transition probability parameter estimation is therefore crucial for obtaining predicted subsequence length bands that reflect real subsequence lengths in homologous RNA targets. Transition parameters in Infernal are mean posterior estimates, combining (ad hoc weighted) observed counts from an input RNA alignment with a Dirichlet prior [<xref ref-type="bibr" rid="pcbi-0030056-b026">26</xref>]. Previous to this work, Infernal used an uninformative uniform Dirichlet transition prior, equivalent to the use of Laplace “plus-1” pseudo-counts. However, we found that transition parameters derived under a uniform prior inaccurately predict target subsequence lengths, as shown in an example in <xref ref-type="fig" rid="pcbi-0030056-g002">Figure 2</xref>. The problem is exacerbated when there are few sequences in the query alignment, when the choice of prior has more impact on mean posterior estimation. To alleviate this problem, we estimated informative single component Dirichlet prior densities for CM transition parameters, as follows.</p><fig id="pcbi-0030056-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030056.g002</object-id><label>Figure 2</label><caption><title>Effect of Transition Priors on Band Calculation</title><p>Predicted and actual target lengths are shown for three CMs built from alignments of five transfer RNA, 5S rRNA, and RNaseP sequences, which are about 75, 120, and 380 residues long, respectively. Solid vertical lines are histogram bars of the actual lengths of the query sequences in each alignment, corresponding with the right vertical axis labels. Dashed and dotted curves show QDB calculations for γ<sub>0</sub>(<italic>d</italic>) for the root state of each model, for uninformative versus informative Dirichlet priors, respectively. Dashed and dotted vertical lines show the band bounds [dmin(0) (left) and dmax(0) (right)] derived from the γ<sub>0</sub>(<italic>d</italic>) distributions using β = 10<sup>−7</sup>. The uninformative plus-1 prior results in consistent underprediction of target sequence lengths, with a broad distribution. The new informative priors produce tighter distributions that are centered on the actual subsequence lengths. We observe the same result for all other states (unpublished data).</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030056.g002" xlink:type="simple"/></fig><p>The training data for transition priors consisted of the 381 seed alignments in the Rfam database, version 6.1 [<xref ref-type="bibr" rid="pcbi-0030056-b017">17</xref>]. For each alignment, we built CM structures by Infernal's default procedure and collected weighted counts of observed transitions in the implied parse trees of the training sequences. Considering all possible combinations of pairs of adjacent node types, there are 73 possible distinct types of transition probability distributions in CMs. To reduce this parameter space, we tied these 73 distributions into 36 groups by assuming that certain distributions were effectively equivalent. Thirty-six Dirichlet densities were then estimated from these pooled counts by maximum likelihood as described in [<xref ref-type="bibr" rid="pcbi-0030056-b031">31</xref>], with the exception that we optimize by conjugate gradient descent [<xref ref-type="bibr" rid="pcbi-0030056-b032">32</xref>] rather than by expectation–maximization (EM). The results, including the Dirichlet parameters, are given in <xref ref-type="table" rid="pcbi-0030056-t001">Table 1</xref>. Using these priors for transition probability parameter estimation results in an improvement in the utility of QDB calculations, often yielding tighter, yet accurate subsequence length distributions, as illustrated by anecdotal example in <xref ref-type="fig" rid="pcbi-0030056-g002">Figure 2</xref>.</p><table-wrap content-type="1col" id="pcbi-0030056-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030056.t001</object-id><label>Table 1</label><caption><p>Dirichlet Priors for Transitions</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030056.t001" xlink:type="simple"/><!-- <table frame="hsides" rules="none"><colgroup><col id="tb1col1" align="char" charoff="0" char="a"/><col id="tb1col2" align="char" charoff="0" char="."/><col id="tb1col3" align="char" charoff="0" char="."/><col id="tb1col4" align="char" charoff="0" char="."/><col id="tb1col5" align="left" charoff="0" char=""/><col id="tb1col6" align="left" charoff="0" char=""/><col id="tb1col7" align="left" charoff="0" char=""/><col id="tb1col8" align="left" charoff="0" char=""/><col id="tb1col9" align="left" charoff="0" char=""/><col id="tb1col10" align="left" charoff="0" char=""/><col id="tb1col11" align="left" charoff="0" char=""/><col id="tb1col12" align="left" charoff="0" char=""/><col id="tb1col13" align="left" charoff="0" char=""/><col id="tb1col14" align="left" charoff="0" char=""/><col id="tb1col15" align="left" charoff="0" char=""/><col id="tb1col16" align="left" charoff="0" char=""/><col id="tb1col17" align="left" charoff="0" char=""/><col id="tb1col18" align="left" charoff="0" char=""/><col id="tb1col19" align="left" charoff="0" char=""/></colgroup><thead><tr><td align="left">Distri- bution Number</td><td>Tied to</td><td>Distri- bution Counts</td><td>Group Counts</td><td>Node State</td><td>Next Node</td><td colspan="13"><hr/>Dirichlet &alpha; Parameters</td></tr><tr><td><hr/></td><td><hr/></td><td><hr/></td><td><hr/></td><td><hr/></td><td><hr/></td><td><hr/>|&alpha;|</td><td><hr/><italic>t</italic></td><td><hr/><mml:math display='inline'><mml:mrow><mml:mstyle mathvariant='bold'><mml:mfrac><mml:mrow><mml:msub><mml:mi>&alpha;</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>&alpha;</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></td><td><hr/><italic>t</italic></td><td><hr/><mml:math display='inline'><mml:mrow><mml:mstyle mathvariant='bold'><mml:mfrac><mml:mrow><mml:msub><mml:mi>&alpha;</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>&alpha;</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></td><td><hr/><italic>t</italic></td><td><hr/><mml:math display='inline'><mml:mrow><mml:mstyle mathvariant='bold'><mml:mfrac><mml:mrow><mml:msub><mml:mi>&alpha;</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>&alpha;</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></td><td><hr/><italic>t</italic></td><td><hr/><mml:math display='inline'><mml:mrow><mml:mstyle mathvariant='bold'><mml:mfrac><mml:mrow><mml:msub><mml:mi>&alpha;</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>&alpha;</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></td><td><hr/><italic>t</italic></td><td><hr/><mml:math display='inline'><mml:mrow><mml:mstyle mathvariant='bold'><mml:mfrac><mml:mrow><mml:msub><mml:mi>&alpha;</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>&alpha;</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></td><td><hr/><italic>t</italic></td><td><hr/><mml:math display='inline'><mml:mrow><mml:mstyle mathvariant='bold'><mml:mfrac><mml:mrow><mml:msub><mml:mi>&alpha;</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>&alpha;</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></td></tr></thead><tbody><tr><td>&thinsp;&hairsp;1</td><td></td><td>6</td><td>11</td><td>MATP_MP</td><td>BIF</td><td>0.5509</td><td>IL</td><td>0.1229</td><td>IR</td><td>0.0001</td><td>B</td><td>0.8770</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td></tr><tr><td>&thinsp;&hairsp;2</td><td></td><td>7,023</td><td>7,119</td><td>MATP_MP</td><td>MATP</td><td>7.2986</td><td>IL</td><td>0.0023</td><td>IR</td><td>0.0024</td><td>MP</td><td>0.9816</td><td>ML</td><td>0.0056</td><td>MR</td><td>0.0046</td><td>D</td><td>0.0035</td></tr><tr><td>&thinsp;&hairsp;3</td><td></td><td>1,600</td><td>1,830</td><td>MATP_MP</td><td>MATL</td><td>1.5914</td><td>IL</td><td>0.0179</td><td>IR</td><td>0.0155</td><td>ML</td><td>0.9200</td><td>D</td><td>0.0466</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td></tr><tr><td>&thinsp;&hairsp;4</td><td></td><td>145</td><td>195</td><td>MATP_MP</td><td>MATR</td><td>1.9038</td><td>IL</td><td>0.0173</td><td>IR</td><td>0.0073</td><td>MR</td><td>0.8903</td><td>D</td><td>0.0852</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td></tr><tr><td>&thinsp;&hairsp;5</td><td>1</td><td>2</td><td>11</td><td>MATP_MP</td><td>END</td><td>0.5509</td><td>IL</td><td>0.1229</td><td>IR</td><td>0.0001</td><td>E</td><td>0.8770</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td></tr><tr><td>&thinsp;&hairsp;6<sup>a</sup></td><td></td><td>1</td><td>2</td><td>MATP_ML</td><td>BIF</td><td>3.0000</td><td>IL</td><td>0.3333</td><td>IR</td><td>0.3333</td><td>B</td><td>0.3333</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td></tr><tr><td>&thinsp;&hairsp;7</td><td></td><td>577</td><td>577</td><td>MATP_ML</td><td>MATP</td><td>0.6941</td><td>IL</td><td>0.0131</td><td>IR</td><td>0.0103</td><td>MP</td><td>0.4032</td><td>ML</td><td>0.4983</td><td>MR</td><td>0.0115</td><td>D</td><td>0.0636</td></tr><tr><td>&thinsp;&hairsp;8</td><td></td><td>133</td><td>133</td><td>MATP_ML</td><td>MATL</td><td>0.9316</td><td>IL</td><td>0.0739</td><td>IR</td><td>0.0651</td><td>ML</td><td>0.7038</td><td>D</td><td>0.1571</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td></tr><tr><td>&thinsp;&hairsp;9</td><td></td><td>15</td><td>15</td><td>MATP_ML</td><td>MATR</td><td>0.3272</td><td>IL</td><td>0.1884</td><td>IR</td><td>0.0432</td><td>MR</td><td>0.4082</td><td>D</td><td>0.3602</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td></tr><tr><td>10<sup>a</sup></td><td>6</td><td>1</td><td>2</td><td>MATP_ML</td><td>END</td><td>3.0000</td><td>IL</td><td>0.3333</td><td>IR</td><td>0.3333</td><td>E</td><td>0.3333</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td></tr><tr><td>11<sup>a</sup></td><td></td><td>1</td><td>2</td><td>MATP_MR</td><td>BIF</td><td>3.0000</td><td>IL</td><td>0.3333</td><td>IR</td><td>0.3333</td><td>B</td><td>0.3333</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td></tr><tr><td>12</td><td></td><td>531</td><td>531</td><td>MATP_MR</td><td>MATP</td><td>0.7987</td><td>IL</td><td>0.0079</td><td>IR</td><td>0.0190</td><td>MP</td><td>0.3241</td><td>ML</td><td>0.0193</td><td>MR</td><td>0.5631</td><td>D</td><td>0.0666</td></tr><tr><td>13</td><td></td><td>151</td><td>151</td><td>MATP_MR</td><td>MATL</td><td>0.6933</td><td>IL</td><td>0.0357</td><td>IR</td><td>0.0699</td><td>ML</td><td>0.3066</td><td>D</td><td>0.5879</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td></tr><tr><td>14</td><td></td><td>15</td><td>15</td><td>MATP_MR</td><td>MATR</td><td>0.3574</td><td>IL</td><td>0.0582</td><td>IR</td><td>0.0002</td><td>MR</td><td>0.7629</td><td>D</td><td>0.1787</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td></tr><tr><td>15<sup>a</sup></td><td>11</td><td>1</td><td>2</td><td>MATP_MR</td><td>END</td><td>3.0000</td><td>IL</td><td>0.3333</td><td>IR</td><td>0.3333</td><td>E</td><td>0.3333</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td></tr><tr><td>16<sup>a</sup></td><td></td><td>0</td><td>2</td><td>MATP_D</td><td>BIF</td><td>3.0000</td><td>IL</td><td>0.3333</td><td>IR</td><td>0.3333</td><td>B</td><td>0.3333</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td></tr><tr><td>17</td><td></td><td>575</td><td>575</td><td>MATP_D</td><td>MATP</td><td>0.5450</td><td>IL</td><td>0.0019</td><td>IR</td><td>0.0047</td><td>MP</td><td>0.0857</td><td>ML</td><td>0.0534</td><td>MR</td><td>0.0528</td><td>D</td><td>0.8015</td></tr><tr><td>18</td><td></td><td>149</td><td>149</td><td>MATP_D</td><td>MATL</td><td>0.5831</td><td>IL</td><td>0.0421</td><td>IR</td><td>0.0526</td><td>ML</td><td>0.2080</td><td>D</td><td>0.6973</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td></tr><tr><td>19</td><td></td><td>14</td><td>14</td><td>MATP_D</td><td>MATR</td><td>0.1164</td><td>IL</td><td>0.0001</td><td>IR</td><td>0.0001</td><td>MR</td><td>0.2439</td><td>D</td><td>0.7559</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td></tr><tr><td>20<sup>a</sup></td><td>16</td><td>2</td><td>2</td><td>MATP_D</td><td>END</td><td>3.0000</td><td>IL</td><td>0.3333</td><td>IR</td><td>0.3333</td><td>E</td><td>0.3333</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td></tr><tr><td>21</td><td></td><td>2</td><td>4</td><td>MATP_IL</td><td>BIF</td><td>1.4397</td><td>IL</td><td>0.6553</td><td>IR</td><td>0.0445</td><td>B</td><td>0.3002</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td></tr><tr><td>22</td><td></td><td>121</td><td>126</td><td>MATP_IL</td><td>MATP</td><td>0.9402</td><td>IL</td><td>0.1673</td><td>IR</td><td>0.1394</td><td>MP</td><td>0.5904</td><td>ML</td><td>0.0443</td><td>MR</td><td>0.0259</td><td>D</td><td>0.0327</td></tr><tr><td>23</td><td></td><td>114</td><td>119</td><td>MATP_IL</td><td>MATL</td><td>0.8046</td><td>IL</td><td>0.3108</td><td>IR</td><td>0.1936</td><td>ML</td><td>0.4610</td><td>D</td><td>0.0346</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td></tr><tr><td>24</td><td></td><td>14</td><td>15</td><td>MATP_IL</td><td>MATR</td><td>1.0926</td><td>IL</td><td>0.1419</td><td>IR</td><td>0.0501</td><td>MR</td><td>0.6538</td><td>D</td><td>0.1541</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td></tr><tr><td>25</td><td>21</td><td>2</td><td>4</td><td>MATP_IL</td><td>END</td><td>1.4397</td><td>IL</td><td>0.6553</td><td>IR</td><td>0.0445</td><td>E</td><td>0.3002</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td></tr><tr><td>26</td><td></td><td>1</td><td>31</td><td>MATP_IR</td><td>BIF</td><td>0.9361</td><td>IR</td><td>0.2827</td><td>B</td><td>0.7173</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td></tr><tr><td>27</td><td></td><td>145</td><td>227</td><td>MATP_IR</td><td>MATP</td><td>1.5494</td><td>IR</td><td>0.1884</td><td>MP</td><td>0.7090</td><td>ML</td><td>0.0165</td><td>MR</td><td>0.0588</td><td>D</td><td>0.0273</td><td>&mdash;</td><td>&mdash;</td></tr><tr><td>28</td><td></td><td>129</td><td>701</td><td>MATP_IR</td><td>MATL</td><td>1.6332</td><td>IR</td><td>0.3681</td><td>ML</td><td>0.5752</td><td>D</td><td>0.0566</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td></tr><tr><td>29</td><td></td><td>8</td><td>160</td><td>MATP_IR</td><td>MATR</td><td>1.2428</td><td>IR</td><td>0.2633</td><td>MR</td><td>0.6809</td><td>D</td><td>0.0558</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td></tr><tr><td>30</td><td>26</td><td>0</td><td>31</td><td>MATP_IR</td><td>END</td><td>0.9361</td><td>IR</td><td>0.2827</td><td>E</td><td>0.7173</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td></tr><tr><td>31</td><td></td><td>108</td><td>1,130</td><td>MATL_ML</td><td>BIF</td><td>1.2298</td><td>IL</td><td>0.0078</td><td>B</td><td>0.9922</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td></tr><tr><td>32</td><td></td><td>420</td><td>1,319</td><td>MATL_ML</td><td>MATP</td><td>2.4162</td><td>IL</td><td>0.0132</td><td>MP</td><td>0.9520</td><td>ML</td><td>0.0150</td><td>MR</td><td>0.0129</td><td>D</td><td>0.0070</td><td>&mdash;</td><td>&mdash;</td></tr><tr><td>33</td><td></td><td>19,013</td><td>19,371</td><td>MATL_ML</td><td>MATL</td><td>1.8632</td><td>IL</td><td>0.0082</td><td>ML</td><td>0.9711</td><td>D</td><td>0.0207</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td></tr><tr><td>34</td><td></td><td>859</td><td>6,692</td><td>MATL_ML</td><td>MATR</td><td>72.1283</td><td>IL</td><td>0.0058</td><td>MR</td><td>0.9755</td><td>D</td><td>0.0187</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td></tr><tr><td>35</td><td>31</td><td>801</td><td>1,130</td><td>MATL_ML</td><td>END</td><td>1.2298</td><td>IL</td><td>0.0078</td><td>E</td><td>0.9922</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td></tr><tr><td>36</td><td></td><td>28</td><td>172</td><td>MATL_D</td><td>BIF</td><td>6.8008</td><td>IL</td><td>0.0029</td><td>B</td><td>0.9971</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td></tr><tr><td>37</td><td></td><td>103</td><td>103</td><td>MATL_D</td><td>MATP</td><td>0.7288</td><td>IL</td><td>0.0321</td><td>MP</td><td>0.5730</td><td>ML</td><td>0.0536</td><td>MR</td><td>0.1654</td><td>D</td><td>0.1758</td><td>&mdash;</td><td>&mdash;</td></tr><tr><td>38</td><td></td><td>3,152</td><td>3,152</td><td>MATL_D</td><td>MATL</td><td>0.4101</td><td>IL</td><td>0.0138</td><td>ML</td><td>0.3105</td><td>D</td><td>0.6756</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td></tr><tr><td>39</td><td></td><td>154</td><td>154</td><td>MATL_D</td><td>MATR</td><td>0.6736</td><td>IL</td><td>0.0203</td><td>MR</td><td>0.6014</td><td>D</td><td>0.3782</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td></tr><tr><td>40</td><td>36</td><td>144</td><td>172</td><td>MATL_D</td><td>END</td><td>6.8008</td><td>IL</td><td>0.0029</td><td>E</td><td>0.9971</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td></tr><tr><td>41</td><td>26</td><td>13</td><td>31</td><td>MATL_IL</td><td>BIF</td><td>0.9361</td><td>IL</td><td>0.2827</td><td>B</td><td>0.7173</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td></tr><tr><td>42</td><td>27</td><td>35</td><td>227</td><td>MATL_IL</td><td>MATP</td><td>1.5494</td><td>IL</td><td>0.1884</td><td>MP</td><td>0.7090</td><td>ML</td><td>0.0588</td><td>MR</td><td>0.0165</td><td>D</td><td>0.0273</td><td>&mdash;</td><td>&mdash;</td></tr><tr><td>43</td><td>28</td><td>549</td><td>701</td><td>MATL_IL</td><td>MATL</td><td>1.6332</td><td>IL</td><td>0.3681</td><td>ML</td><td>0.5752</td><td>D</td><td>0.0566</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td></tr><tr><td>44</td><td>29</td><td>45</td><td>160</td><td>MATL_IL</td><td>MATR</td><td>1.2428</td><td>IL</td><td>0.2633</td><td>MR</td><td>0.6809</td><td>D</td><td>0.0558</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td></tr><tr><td>45</td><td>26</td><td>0</td><td>31</td><td>MATL_IL</td><td>END</td><td>0.9361</td><td>IL</td><td>0.2827</td><td>E</td><td>0.7173</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td></tr><tr><td>46</td><td>31</td><td>206</td><td>1,130</td><td>MATR_MR</td><td>BIF</td><td>1.2298</td><td>IR</td><td>0.0078</td><td>B</td><td>0.9922</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td></tr><tr><td>47</td><td>32</td><td>848</td><td>1,319</td><td>MATR_MR</td><td>MATP</td><td>2.4162</td><td>IR</td><td>0.0132</td><td>MP</td><td>0.9520</td><td>ML</td><td>0.0150</td><td>MR</td><td>0.0129</td><td>D</td><td>0.0070</td><td>&mdash;</td><td>&mdash;</td></tr><tr><td>48</td><td>34</td><td>5,833</td><td>6,692</td><td>MATR_MR</td><td>MATR</td><td>2.1283</td><td>IR</td><td>0.0058</td><td>MR</td><td>0.9755</td><td>D</td><td>0.0187</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td></tr><tr><td>49</td><td></td><td>39</td><td>39</td><td>MATR_D</td><td>BIF</td><td>0.4664</td><td>IR</td><td>0.0463</td><td>B</td><td>0.9537</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td></tr><tr><td>50</td><td></td><td>176</td><td>176</td><td>MATR_D</td><td>MATP</td><td>0.8689</td><td>IR</td><td>0.0245</td><td>MP</td><td>0.6126</td><td>ML</td><td>0.1269</td><td>MR</td><td>0.0471</td><td>D</td><td>0.1890</td><td>&mdash;</td><td>&mdash;</td></tr><tr><td>51</td><td></td><td>771</td><td>771</td><td>MATR_D</td><td>MATR</td><td>0.4869</td><td>IR</td><td>0.0119</td><td>MR</td><td>0.3373</td><td>D</td><td>0.6507</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td></tr><tr><td>52</td><td>26</td><td>15</td><td>31</td><td>MATR_IR</td><td>BIF</td><td>0.9361</td><td>IR</td><td>0.2827</td><td>B</td><td>0.7173</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td></tr><tr><td>53</td><td>27</td><td>39</td><td>227</td><td>MATR_IR</td><td>MATP</td><td>1.5494</td><td>IR</td><td>0.1884</td><td>MP</td><td>0.7090</td><td>ML</td><td>0.0165</td><td>MR</td><td>0.0588</td><td>D</td><td>0.0273</td><td>&mdash;</td><td>&mdash;</td></tr><tr><td>54</td><td>29</td><td>107</td><td>160</td><td>MATR_IR</td><td>MATR</td><td>1.2428</td><td>IR</td><td>0.2633</td><td>MR</td><td>0.6809</td><td>D</td><td>0.0558</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td></tr><tr><td>55</td><td></td><td>338</td><td>338</td><td>BEGL_S</td><td>MATP</td><td>5.0422</td><td>MP</td><td>0.9579</td><td>ML</td><td>0.0121</td><td>MR</td><td>0.0183</td><td>D</td><td>0.0117</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td></tr><tr><td>56</td><td>31</td><td>15</td><td>1,130</td><td>BEGR_S</td><td>BIF</td><td>1.2298</td><td>IL</td><td>0.0078</td><td>B</td><td>0.9922</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td></tr><tr><td>57</td><td>32</td><td>51</td><td>1,319</td><td>BEGR_S</td><td>MATP</td><td>2.4162</td><td>IL</td><td>0.0132</td><td>MP</td><td>0.9520</td><td>ML</td><td>0.0150</td><td>MR</td><td>0.0129</td><td>D</td><td>0.0070</td><td>&mdash;</td><td>&mdash;</td></tr><tr><td>58</td><td>33</td><td>358</td><td>19,371</td><td>BEGR_S</td><td>MATL</td><td>1.8632</td><td>IL</td><td>0.0082</td><td>ML</td><td>0.9711</td><td>D</td><td>0.0207</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td></tr><tr><td>59</td><td>26</td><td>2</td><td>31</td><td>BEGR_IL</td><td>BIF</td><td>0.9361</td><td>IL</td><td>0.2827</td><td>B</td><td>0.7173</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td></tr><tr><td>60</td><td>27</td><td>3</td><td>227</td><td>BEGR_IL</td><td>MATP</td><td>1.5494</td><td>IL</td><td>0.1884</td><td>MP</td><td>0.7090</td><td>ML</td><td>0.0588</td><td>MR</td><td>0.0165</td><td>D</td><td>0.0273</td><td>&mdash;</td><td>&mdash;</td></tr><tr><td>61</td><td>28</td><td>19</td><td>701</td><td>BEGR_IL</td><td>MATL</td><td>1.6332</td><td>IL</td><td>0.3681</td><td>ML</td><td>0.5752</td><td>D</td><td>0.0566</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td></tr><tr><td>62</td><td>1</td><td>3</td><td>11</td><td>ROOT_S</td><td>BIF</td><td>0.5509</td><td>IL</td><td>0.1229</td><td>IR</td><td>0.0001</td><td>B</td><td>0.8770</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td></tr><tr><td>63</td><td>2</td><td>96</td><td>7,119</td><td>ROOT_S</td><td>MATP</td><td>7.2986</td><td>IL</td><td>0.0023</td><td>IR</td><td>0.0024</td><td>MP</td><td>0.9816</td><td>ML</td><td>0.0056</td><td>MR</td><td>0.0046</td><td>D</td><td>0.0035</td></tr><tr><td>64</td><td>3</td><td>230</td><td>1,830</td><td>ROOT_S</td><td>MATL</td><td>1.5914</td><td>IL</td><td>0.0179</td><td>IR</td><td>0.0155</td><td>ML</td><td>0.9200</td><td>D</td><td>0.0466</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td></tr><tr><td>65</td><td>4</td><td>50</td><td>195</td><td>ROOT_S</td><td>MATR</td><td>1.9038</td><td>IL</td><td>0.0173</td><td>IR</td><td>0.0073</td><td>MR</td><td>0.8903</td><td>D</td><td>0.0852</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td></tr><tr><td>66</td><td>21</td><td>0</td><td>4</td><td>ROOT_IL</td><td>BIF</td><td>1.4397</td><td>IL</td><td>0.6553</td><td>IR</td><td>0.0445</td><td>B</td><td>0.3002</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td></tr><tr><td>67</td><td>22</td><td>5</td><td>126</td><td>ROOT_IL</td><td>MATP</td><td>0.9402</td><td>IL</td><td>0.1673</td><td>IR</td><td>0.1394</td><td>MP</td><td>0.5904</td><td>ML</td><td>0.0443</td><td>MR</td><td>0.0259</td><td>D</td><td>0.0327</td></tr><tr><td>68</td><td>23</td><td>5</td><td>119</td><td>ROOT_IL</td><td>MATL</td><td>0.8046</td><td>IL</td><td>0.3108</td><td>IR</td><td>0.1936</td><td>ML</td><td>0.4610</td><td>D</td><td>0.0346</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td></tr><tr><td>69</td><td>24</td><td>1</td><td>15</td><td>ROOT_IL</td><td>MATR</td><td>1.0926</td><td>IL</td><td>0.1419</td><td>IR</td><td>0.0501</td><td>MR</td><td>0.6538</td><td>D</td><td>0.1541</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td></tr><tr><td>70</td><td>26</td><td>0</td><td>31</td><td>ROOT_IR</td><td>BIF</td><td>0.9361</td><td>IR</td><td>0.2827</td><td>B</td><td>0.7173</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td></tr><tr><td>71</td><td>27</td><td>5</td><td>227</td><td>ROOT_IR</td><td>MATP</td><td>1.5494</td><td>IR</td><td>0.1884</td><td>MP</td><td>0.7090</td><td>ML</td><td>0.0165</td><td>MR</td><td>0.0588</td><td>D</td><td>0.0273</td><td>&mdash;</td><td>&mdash;</td></tr><tr><td>72</td><td>28</td><td>4</td><td>701</td><td>ROOT_IR</td><td>MATL</td><td>1.6332</td><td>IR</td><td>0.3681</td><td>ML</td><td>0.5752</td><td>D</td><td>0.0566</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td></tr><tr><td>73</td><td>29</td><td>0</td><td>160</td><td>ROOT_IR</td><td>MATR</td><td>1.2428</td><td>IR</td><td>0.2633</td><td>MR</td><td>0.6809</td><td>D</td><td>0.0558</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td></tr></tbody></table> --><!-- <table-wrap-foot><fn id="nt101"><p>Distribution Number, index for the 73 different types of transition distributions in CMs.</p></fn><fn id="nt102"><p>Tied to, if an index is shown in this column, this distribution was estimated in a group (pooling observed counts) with the indicated distribution.</p></fn><fn id="nt103"><p>Distribution Counts, total counts observed for this distribution in the training data, before pooling into groups.</p></fn><fn id="nt104"><p>Group Counts, total counts for a group of one or more pooled distributions; this is the size of the training data sets for 36 different single-component Dirichlet priors.</p></fn><fn id="nt105"><p>Node State, unique CM state type the transition is from. </p></fn><fn id="nt106"><p>Next Node, the node type that the transitions are going to. The codes for node types and state types in a CM are more fully explained in &lsqb;<xref ref-type="bibr" rid="pcbi-0030056-b016">16</xref>&rsqb;.</p></fn><fn id="nt107"><p><sup>a</sup>Six distributions that had very few observed counts even after tying into groups, and for which we assigned a uniform plus-1 Laplace prior.</p></fn></table-wrap-foot> --></table-wrap><p>We also estimated informative mixture Dirichlet density priors for emission probabilities. Emission probabilities have no effect on QDB, but informative emission priors should improve sensitivity and specificity of CM searches, as they do for profile HMMs [<xref ref-type="bibr" rid="pcbi-0030056-b031">31</xref>,<xref ref-type="bibr" rid="pcbi-0030056-b033">33</xref>]. We collected filtered counts of aligned single-stranded residues and base pairs from annotated ribosomal RNA alignments from four alignments in the 2002 version of the European Ribosomal RNA Database [<xref ref-type="bibr" rid="pcbi-0030056-b034">34</xref>,<xref ref-type="bibr" rid="pcbi-0030056-b035">35</xref>]: large subunit rRNA (LSU), bacterial/archaeal/plastid small subunit rRNA (SSU-bap), eukaryotic SSU rRNA (SSU-euk), and mitochondrial SSU rRNA (SSU-mito). These alignments were filtered, removing sequences in which either less than 40% of the base-paired positions are present or more than 5% of the nucleotides are ambiguous, and removing selected sequences based on single-linkage clustering such that no two sequences in a filtered alignment were greater than 80% identical (in order to remove closely related sequences). Summary statistics for the filtered alignments and collected counts in the training data set are given in <xref ref-type="table" rid="pcbi-0030056-t002">Table 2</xref>. These data were used to estimate a nine-component Dirichlet mixture prior for base pairs and an eight-component Dirichlet mixture prior for single-stranded residues. The base pair prior is given in <xref ref-type="table" rid="pcbi-0030056-t003">Table 3</xref>, and the singlet residue prior is given in <xref ref-type="table" rid="pcbi-0030056-t004">Table 4</xref>.</p><table-wrap content-type="1col" id="pcbi-0030056-t002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030056.t002</object-id><label>Table 2</label><caption><p>Summary Statistics for the Data Set Used for Emission Prior Estimation</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030056.t002" xlink:type="simple"/><!-- <table frame="hsides" rules="none"><colgroup><col id="tb2col1" align="left" charoff="0" char=""/><col id="tb2col2" align="char" charoff="0" char="."/><col id="tb2col3" align="left" charoff="0" char=""/><col id="tb2col4" align="left" charoff="0" char=""/><col id="tb2col5" align="char" charoff="0" char="."/><col id="tb2col6" align="char" charoff="0" char="."/><col id="tb2col7" align="left" charoff="0" char=""/><col id="tb2col8" align="char" charoff="0" char="."/></colgroup><thead><tr><td align="left"><hr/>Alignment</td><td><hr/>Number of Sequences</td><td><hr/>Number of Filtered Sequences</td><td><hr/>Number of Alignment Columns</td><td><hr/>Number of Consensus Base Pairs</td><td><hr/>Number of Consensus SS Columns</td><td><hr/>Base Pair Counts</td><td><hr/>SS Counts</td></tr></thead><tbody><tr><td>LSU</td><td>1,551</td><td>139</td><td>7,270</td><td>601</td><td>1,532</td><td>65,229</td><td>180,558</td></tr><tr><td>SSU bap</td><td>12,773</td><td>254</td><td>2,653</td><td>421</td><td>680</td><td>97,834</td><td>153,565</td></tr><tr><td>SSU euk</td><td>7,151</td><td>207</td><td>4,558</td><td>407</td><td>959</td><td>72,521</td><td>174,260</td></tr><tr><td>SSU mito</td><td>1,039</td><td>107</td><td>3,791</td><td>216</td><td>524</td><td>19,803</td><td>56,510</td></tr></tbody></table> --><!-- <table-wrap-foot><fn id="nt201"><p>SS, single-stranded.</p></fn></table-wrap-foot> --></table-wrap><table-wrap content-type="1col" id="pcbi-0030056-t003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030056.t003</object-id><label>Table 3</label><caption><p>Parameters of the Nine-Component Dirichlet Mixture Emission Prior for Base Pairs</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030056.t003" xlink:type="simple"/><!-- <table frame="hsides" rules="none"><colgroup><col id="tb3col1" align="left" charoff="0" char=""/><col id="tb3col2" align="left" charoff="0" char=""/><col id="tb3col3" align="left" charoff="0" char=""/><col id="tb3col4" align="left" charoff="0" char=""/><col id="tb3col5" align="left" charoff="0" char=""/><col id="tb3col6" align="left" charoff="0" char=""/><col id="tb3col7" align="left" charoff="0" char=""/><col id="tb3col8" align="left" charoff="0" char=""/><col id="tb3col9" align="left" charoff="0" char=""/><col id="tb3col10" align="left" charoff="0" char=""/><col id="tb3col11" align="left" charoff="0" char=""/></colgroup><thead><tr><td align="left" colspan="2"><hr/>Component <italic>i</italic></td><td><hr/>1</td><td><hr/>2</td><td><hr/>3</td><td><hr/>4</td><td><hr/>5</td><td><hr/>6</td><td><hr/>7</td><td><hr/>8</td><td><hr/>9</td></tr><tr><td colspan="2"><hr/><italic>q<sub>i</sub></italic></td><td><hr/>0.0305</td><td><hr/>0.0703</td><td><hr/>0.1185</td><td><hr/>0.1810</td><td><hr/>0.1888</td><td><hr/>0.1576</td><td><hr/>0.0417</td><td><hr/>0.0959</td><td><hr/>0.1156</td></tr><tr><td colspan="2"><hr/>|&alpha;|</td><td><hr/>14.3744</td><td><hr/>2.9920</td><td><hr/>26.2757</td><td><hr/>0.5342</td><td><hr/>4.2716</td><td><hr/>13.3232</td><td><hr/>33.8619</td><td><hr/>22.2258</td><td><hr/>33.1991</td></tr><tr><td><hr/><italic>ab</italic></td><td><hr/>Mean &alpha;</td><td colspan="9"><hr/><mml:math display='inline'><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>&alpha;</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>&alpha;</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></td></tr></thead><tbody><tr><td>AA</td><td>0.0063</td><td>0.0398</td><td>0.0390</td><td>0.0011</td><td>0.0017</td><td>0.0005</td><td>0.0062</td><td>0.0064</td><td>0.0058</td><td>0.0002</td></tr><tr><td>AC</td><td>0.0092</td><td>0.0421</td><td>0.0176</td><td>0.0009</td><td>0.0152</td><td>0.0018</td><td>0.0125</td><td>0.0115</td><td>0.0051</td><td>0.0046</td></tr><tr><td>AG</td><td>0.0052</td><td>0.0381</td><td>0.0226</td><td>0.0046</td><td>0.0034</td><td>0.0008</td><td>0.0032</td><td>0.0040</td><td>0.0053</td><td>0.0001</td></tr><tr><td>AU</td><td><bold>0.1663</bold></td><td><bold>0.1092</bold></td><td>0.0864</td><td>0.0194</td><td><bold>0.2138</bold></td><td><bold>0.1464</bold></td><td><bold>0.2563</bold></td><td><bold>0.7360</bold></td><td><bold>0.1295</bold></td><td>0.0404</td></tr><tr><td>CA</td><td>0.0086</td><td>0.0412</td><td>0.0510</td><td>0.0054</td><td>0.0027</td><td>0.0044</td><td>0.0018</td><td>0.0030</td><td>0.0138</td><td>0.0002</td></tr><tr><td>CC</td><td>0.0038</td><td>0.0327</td><td>0.0115</td><td>0.0030</td><td>0.0001</td><td>0.0003</td><td>0.0036</td><td>0.0039</td><td>0.0035</td><td>0.0041</td></tr><tr><td>CG</td><td><bold>0.2412</bold></td><td><bold>0.1007</bold></td><td><bold>0.1392</bold></td><td><bold>0.8310</bold></td><td><bold>0.1359</bold></td><td><bold>0.3211</bold></td><td>0.0889</td><td>0.0340</td><td><bold>0.2870</bold></td><td>0.0147</td></tr><tr><td>CU</td><td>0.0066</td><td>0.0418</td><td>0.0172</td><td>0.0027</td><td>0.0104</td><td>0.0019</td><td>0.0045</td><td>0.0076</td><td>0.0052</td><td>0.0003</td></tr><tr><td>GA</td><td>0.0061</td><td>0.0362</td><td>0.0266</td><td>0.0002</td><td>0.0074</td><td>0.0002</td><td>0.0058</td><td>0.0045</td><td>0.0042</td><td>0.0021</td></tr><tr><td>GC</td><td><bold>0.2547</bold></td><td><bold>0.1299</bold></td><td>0.0544</td><td>0.0206</td><td><bold>0.1786</bold></td><td><bold>0.1613</bold></td><td><bold>0.4079</bold></td><td>0.0945</td><td><bold>0.1155</bold></td><td><bold>0.8858</bold></td></tr><tr><td>GG</td><td>0.0063</td><td>0.0327</td><td>0.0142</td><td>0.0045</td><td>0.0091</td><td>0.0005</td><td>0.0072</td><td>0.0023</td><td>0.0044</td><td>0.0030</td></tr><tr><td>GU</td><td>0.0567</td><td>0.0811</td><td>0.0412</td><td>0.0049</td><td><bold>0.1355</bold></td><td>0.0451</td><td>0.0668</td><td>0.0303</td><td>0.0356</td><td>0.0218</td></tr><tr><td>UA</td><td><bold>0.1571</bold></td><td><bold>0.1063</bold></td><td><bold>0.3085</bold></td><td>0.0672</td><td><bold>0.1856</bold></td><td><bold>0.2293</bold></td><td>0.0902</td><td>0.0363</td><td><bold>0.3108</bold></td><td>0.0151</td></tr><tr><td>UC</td><td>0.0063</td><td>0.0477</td><td>0.0263</td><td>0.0006</td><td>0.0048</td><td>0.0002</td><td>0.0056</td><td>0.0042</td><td>0.0060</td><td>0.0038</td></tr><tr><td>UG</td><td>0.0543</td><td>0.0746</td><td><bold>0.1054</bold></td><td>0.0317</td><td>0.0807</td><td>0.0814</td><td>0.0299</td><td>0.0120</td><td>0.0551</td><td>0.0032</td></tr><tr><td>UU</td><td>0.0114</td><td>0.0459</td><td>0.0389</td><td>0.0022</td><td>0.0151</td><td>0.0048</td><td>0.0098</td><td>0.0095</td><td>0.0133</td><td>0.0008</td></tr></tbody></table> --><!-- <table-wrap-foot><fn id="nt301"><p><italic>q<sub>i</sub>,</italic> mixture coefficient for component <italic>i</italic>.</p></fn><fn id="nt302"><p>Normalized &alpha; values &gt;0.10 are in boldfaced type (0.10 was arbitrarily chosen to highlight higher values).</p></fn></table-wrap-foot> --></table-wrap><table-wrap content-type="1col" id="pcbi-0030056-t004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030056.t004</object-id><label>Table 4</label><caption><p>Parameters of the Eight-Component Dirichlet Mixture Emission Prior for Singlets</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030056.t004" xlink:type="simple"/><!-- <table frame="hsides" rules="none"><colgroup><col id="tb4col1" align="left" charoff="0" char=""/><col id="tb4col2" align="left" charoff="0" char=""/><col id="tb4col3" align="left" charoff="0" char=""/><col id="tb4col4" align="left" charoff="0" char=""/><col id="tb4col5" align="left" charoff="0" char=""/><col id="tb4col6" align="left" charoff="0" char=""/><col id="tb4col7" align="left" charoff="0" char=""/><col id="tb4col8" align="left" charoff="0" char=""/><col id="tb4col9" align="left" charoff="0" char=""/><col id="tb4col10" align="left" charoff="0" char=""/></colgroup><thead><tr><td align="left" colspan="2"><hr/>Component <italic>i</italic></td><td><hr/>1</td><td><hr/>2</td><td><hr/>3</td><td><hr/>4</td><td><hr/>5</td><td><hr/>6</td><td><hr/>7</td><td><hr/>8</td></tr><tr><td colspan="2"><hr/><italic>q<sub>i</sub></italic></td><td><hr/>0.0851</td><td><hr/>0.0159</td><td><hr/>0.1020</td><td><hr/>0.4160</td><td><hr/>0.0745</td><td><hr/>0.0554</td><td><hr/>0.1184</td><td><hr/>0.1327</td></tr><tr><td colspan="2"><hr/>|&alpha;|</td><td><hr/>15.4467</td><td><hr/>154.464</td><td><hr/>180.286</td><td><hr/>5.4562</td><td><hr/>0.2199</td><td><hr/>16.4089</td><td><hr/>13.4592</td><td><hr/>19.9059</td></tr><tr><td><hr/><italic>a</italic></td><td><hr/>Mean &alpha;</td><td colspan="8"><hr/><mml:math display='inline'><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>&alpha;</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>&alpha;</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></td></tr></thead><tbody><tr><td>A</td><td><bold>0.3951</bold></td><td>0.0373</td><td><bold>0.9961</bold></td><td><bold>0.9787</bold></td><td><bold>0.3109</bold></td><td><bold>0.3383</bold></td><td>0.0375</td><td>0.0864</td><td><bold>0.8247</bold></td></tr><tr><td>C</td><td><bold>0.1635</bold></td><td>0.0490</td><td>0.0015</td><td>0.0052</td><td><bold>0.2067</bold></td><td><bold>0.1782</bold></td><td><bold>0.8916</bold></td><td>0.0303</td><td>0.0493</td></tr><tr><td>G</td><td><bold>0.2041</bold></td><td>0.0220</td><td>0.0023</td><td>0.0072</td><td><bold>0.1751</bold></td><td><bold>0.2905</bold></td><td>0.0182</td><td><bold>0.8313</bold></td><td>0.0569</td></tr><tr><td>U</td><td><bold>0.2372</bold></td><td><bold>0.8917</bold></td><td>0.0000</td><td>0.0090</td><td><bold>0.3073</bold></td><td><bold>0.1930</bold></td><td>0.0527</td><td>0.0519</td><td>0.0691</td></tr></tbody></table> --><!-- <table-wrap-foot><fn id="nt401"><p><italic>q<sub>i</sub>,</italic> mixture coefficient for component <italic>i</italic>.</p></fn><fn id="nt402"><p>Normalized &alpha; values &gt;0.10 are in boldfaced type (0.10 was arbitrarily chosen to highlight higher values).</p></fn></table-wrap-foot> --></table-wrap><p>The reason to use two different data sets to estimate transition versus emission priors is the following. Rfam provides many different structural RNA alignments but of uneven quality and varying depth (number of sequences). The European rRNA database provides a small number of different RNA alignments but of high quality and great depth. A transition prior training set should be maximally diverse, so as not to bias any transition types toward any particular RNA structure, so we used the 381 different Rfam alignments for transitions. Emission prior estimation, in contrast, improves with alignment depth and accuracy but does not require broad structural diversity per se, so we used rRNA data for emissions.</p><p>Inspection of the Dirichlet α parameters shows sensible trends. In the transition priors, transitions between main (consensus) states are now favored (higher α values) relative to insertions and deletions. In the base pair emission mixture prior, all components favor Watson–Crick and G-U pairs, with different components preferring different proportions of pairs in a particular covarying aligned column (for instance, component 1 likes all four Watson–Crick pairs, component 2 describes covarying conservation of CG,UA,UG pairs, and component 3 specifically likes conserved CG pairs), and the mean α parameters prefer GC/CG pairs over AU/UA pairs. In the singlet emission mixture prior, some components are capturing strongly conserved residues (component 1 favors conserved U's, for example) while other components favor more variation (components 4 and 5, for example), and the marginal α parameters show a strong A bias, reflecting the known bias for adenine in single-stranded positions of structural RNAs (especially ribosomal RNAs).</p><p>There is redundancy between some components (notably 5 and 8 in the base pair mixture and 2, 3 and 8 in the singlet mixture). This is typical for statistical mixture estimation, which (unlike, say, principal components analysis) does not guarantee independence between components. The decision to use nine pair and eight singlet components was empirical, as these priors performed better than priors with fewer components on the benchmark we describe below (unpublished data).</p><p>Note that all singlet positions are modeled with one singlet mixture prior distribution, and all base pairs are modeled with one base pair mixture prior. These priors do not distinguish between singlet residues in different types of loops, for example, or between a stem-closing base pair versus other base pairs. In the future, it may prove advantageous to adopt more complex priors to capture effects of structural context on base pair and singlet residue preference.</p><p>In another step to increase sensitivity and specificity of the program, we adopted the “entropy weighting” technique described for profile HMMs [<xref ref-type="bibr" rid="pcbi-0030056-b036">36</xref>] for estimating the total effective sequence number for an input query alignment. This is an ad hoc method for reducing the information content per position of a model, which helps a model that has been trained on closely related sequences to recognize distantly related homologs [<xref ref-type="bibr" rid="pcbi-0030056-b037">37</xref>]. In entropy weighting, one reduces the total effective sequence number (which would normally be the actual number of sequences in the input alignment), thereby increasing the influence of the Dirichlet priors, flattening the transition and emission distributions, and reducing the overall information content. We approximate a model's entropy as the mean entropy per consensus residue, as follows. Let <italic>C</italic> be the set of all MATP_MP states emitting consensus base pairs (<italic>a,b</italic>)<italic>,</italic> and let <italic>D</italic> be the set of all MATL_ML and MATR_MR states emitting consensus singlets (<italic>a</italic>); the entropy is then calculated as:
					<disp-formula id="pcbi-0030056-e004"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030056.e004" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mfrac><mml:mrow><mml:mo>&minus;</mml:mo><mml:mstyle displaystyle='true'><mml:munder><mml:mo>&sum;</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mo>&isin;</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mstyle displaystyle='true'><mml:munder><mml:mo>&sum;</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>log</mml:mi><mml:mo></mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&minus;</mml:mo><mml:mstyle displaystyle='true'><mml:munder><mml:mo>&sum;</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mo>&isin;</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mstyle displaystyle='true'><mml:munder><mml:mo>&sum;</mml:mo><mml:mi>a</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>a</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>log</mml:mi><mml:mo></mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>a</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mo>|</mml:mo><mml:mi>C</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mo>&plus;</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mi>D</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math> --></disp-formula>
				</p><p>For each input multiple alignment, the effective sequence number is set (by bracketing and binary search) so as to obtain a specified target entropy. The target entropy for Infernal is a free parameter, which we optimized on the benchmark described below to identify our default value of 1.46 bits.</p></sec><sec id="s2e"><title>Benchmarking</title><p>To assess the effect of QDB, informative priors, and entropy weighting on the speed, sensitivity, and specificity of RNA similarity searches, we designed a benchmark based on the Rfam database [<xref ref-type="bibr" rid="pcbi-0030056-b017">17</xref>]. The benchmark was designed so that we would test many RNA query/target pairs, with each query consisting of a given RNA sequence alignment, and each target consisting of a distantly related RNA homolog buried in a context of a random genome-like background sequence.</p><p>We started with seed alignments from Rfam version 7.0. In each alignment, sequences shorter than 70% of the median length were removed. We clustered the sequences in each family by single-linkage clustering by percent identity (as calculated from the given Rfam alignment) and then split the clusters such that the training set and test sequences satisfied three conditions: (1) no training/test sequence pair is more than 60% identical; (2) no test sequence pair is greater than 70% identical; and (3) at least five sequences are in the training set. Fifty-one families satisfy these criteria (listed in <xref ref-type="table" rid="pcbi-0030056-t005">Table 5</xref>), giving us 51 different query alignments (containing 5 to 1,080 sequences each) and 450 total test sequences (from 1 to 66 per query). We embedded the test sequences in a 1-Mb “pseudo-genome” consisting of twenty 50-kb “chromosomes,” generated as independent, identically distributed (iid) random sequences with uniform base frequencies. The 450 test sequences were embedded into this sequence by replacement, by randomly choosing a chromosome, orientation, and start position, and disallowing overlaps between test sequences. The total length of the 450 test sequences is 101,855 nucleotides, leaving 898,145 nucleotides of random background sequence.</p><table-wrap content-type="2col" id="pcbi-0030056-t005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030056.t005</object-id><label>Table 5</label><caption><p>Rfam Benchmark Families with Timing and MER Statistics</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030056.t005" xlink:type="simple"/><!-- <table frame="hsides" rules="none"><colgroup><col id="tb5col1" align="left" charoff="0" char=""/><col id="tb5col2" align="left" charoff="0" char=""/><col id="tb5col3" align="char" charoff="0" char="."/><col id="tb5col4" align="char" charoff="0" char="."/><col id="tb5col5" align="char" charoff="0" char="."/><col id="tb5col6" align="char" charoff="0" char="."/><col id="tb5col7" align="char" charoff="0" char="."/><col id="tb5col8" align="char" charoff="0" char="."/><col id="tb5col9" align="char" charoff="0" char="."/><col id="tb5col10" align="char" charoff="0" char="."/><col id="tb5col11" align="char" charoff="0" char="."/><col id="tb5col12" align="char" charoff="0" char="."/><col id="tb5col13" align="char" charoff="0" char="."/><col id="tb5col14" align="char" charoff="0" char="."/><col id="tb5col15" align="char" charoff="0" char="."/></colgroup><thead><tr><td align="left">Rfam 7.0 ID</td><td>Family Name</td><td>Number of Query Sequences</td><td>Number of Test Sequences</td><td>Average Length of Query</td><td>W</td><td colspan="2"><hr/>Nonbanded</td><td colspan="3"><hr/>QDB (&beta; &equals; 10<sup>&minus;7</sup>)</td><td colspan="4"><hr/>QDB (&beta; &equals; 10<sup>&minus;7</sup>)</td></tr><tr><td><hr/></td><td><hr/></td><td><hr/></td><td><hr/></td><td><hr/></td><td><hr/></td><td colspan="2"><hr/>Time</td><td colspan="2"><hr/>Time</td><td><hr/>Speeded Up</td><td><hr/>MER</td><td><hr/>FP</td><td><hr/>FN</td><td><hr/>MER Threshold</td></tr></thead><tbody><tr><td>RF00177</td><td>SSU_rRNA_5</td><td>145</td><td>21</td><td>593</td><td>690</td><td colspan="2">96.97</td><td colspan="2">7.61</td><td>12.74</td><td>0</td><td>0</td><td>0</td><td>9.90</td></tr><tr><td>RF00024</td><td>Telomerase-vert</td><td>20</td><td>11</td><td>436</td><td>505</td><td colspan="2">52.99</td><td colspan="2">4.44</td><td>11.94</td><td>0</td><td>0</td><td>0</td><td>11.30</td></tr><tr><td>RF00011</td><td>RNaseP_bact_b</td><td>30</td><td>1</td><td>366</td><td>441</td><td colspan="2">33.44</td><td colspan="2">3.72</td><td>8.98</td><td>0</td><td>0</td><td>0</td><td>11.31</td></tr><tr><td>RF00018</td><td>CsrB</td><td>8</td><td>1</td><td>351</td><td>403</td><td colspan="2">28.76</td><td colspan="2">2.27</td><td>12.68</td><td>0</td><td>0</td><td>0</td><td>12.98</td></tr><tr><td>RF00040</td><td>rne5</td><td>6</td><td>1</td><td>338</td><td>368</td><td colspan="2">19.69</td><td colspan="2">2.60</td><td>7.57</td><td>0</td><td>0</td><td>0</td><td>11.79</td></tr><tr><td>RF00023</td><td>tmRNA</td><td>19</td><td>40</td><td>334</td><td>463</td><td colspan="2">24.58</td><td colspan="2">2.47</td><td>9.95</td><td>11</td><td>0</td><td>11</td><td>11.20</td></tr><tr><td>RF00010</td><td>RNaseP_bact_a</td><td>233</td><td>1</td><td>332</td><td>514</td><td colspan="2">33.82</td><td colspan="2">3.29</td><td>10.27</td><td>0</td><td>0</td><td>0</td><td>12.61</td></tr><tr><td>RF00009</td><td>RNaseP_nuc</td><td>26</td><td>21</td><td>320</td><td>530</td><td colspan="2">27.89</td><td colspan="2">7.11</td><td>3.93</td><td>19</td><td>0</td><td>19</td><td>11.67</td></tr><tr><td>RF00017</td><td>SRP_euk_arch</td><td>28</td><td>21</td><td>303</td><td>328</td><td colspan="2">14.78</td><td colspan="2">2.70</td><td>5.48</td><td>6</td><td>0</td><td>6</td><td>10.40</td></tr><tr><td>RF00028</td><td>Intron_gpI</td><td>5</td><td>24</td><td>300</td><td>381</td><td colspan="2">17.55</td><td colspan="2">3.59</td><td>4.88</td><td>19</td><td>2</td><td>17</td><td>10.70</td></tr><tr><td>RF00373</td><td>RNaseP_arch</td><td>20</td><td>13</td><td>290</td><td>337</td><td colspan="2">15.06</td><td colspan="2">3.12</td><td>4.82</td><td>0</td><td>0</td><td>0</td><td>12.23</td></tr><tr><td>RF00030</td><td>RNase_MRP</td><td>18</td><td>3</td><td>284</td><td>394</td><td colspan="2">19.75</td><td colspan="2">3.12</td><td>6.34</td><td>3</td><td>0</td><td>3</td><td>12.46</td></tr><tr><td>RF00101</td><td>SraC_RyeA</td><td>6</td><td>1</td><td>250</td><td>278</td><td colspan="2">9.50</td><td colspan="2">1.54</td><td>6.19</td><td>0</td><td>0</td><td>0</td><td>11.88</td></tr><tr><td>RF00230</td><td>T-box</td><td>10</td><td>35</td><td>244</td><td>298</td><td colspan="2">8.23</td><td colspan="2">1.80</td><td>4.58</td><td>1</td><td>0</td><td>1</td><td>12.34</td></tr><tr><td>RF00448</td><td>IRES_EBNA</td><td>7</td><td>1</td><td>213</td><td>238</td><td colspan="2">7.25</td><td colspan="2">1.26</td><td>5.76</td><td>1</td><td>0</td><td>1</td><td>11.99</td></tr><tr><td>RF00012</td><td>U3</td><td>6</td><td>5</td><td>212</td><td>240</td><td colspan="2">7.17</td><td colspan="2">1.61</td><td>4.46</td><td>2</td><td>0</td><td>2</td><td>13.02</td></tr><tr><td>RF00174</td><td>Cobalamin</td><td>87</td><td>66</td><td>203</td><td>326</td><td colspan="2">9.49</td><td colspan="2">2.85</td><td>3.32</td><td>0</td><td>0</td><td>0</td><td>11.28</td></tr><tr><td>RF00004</td><td>U2</td><td>76</td><td>1</td><td>184</td><td>215</td><td>5.95</td><td></td><td>1.12</td><td></td><td>5.29</td><td>0</td><td>0</td><td>0</td><td>10.01</td></tr><tr><td>RF00234</td><td>glmS</td><td>8</td><td>3</td><td>181</td><td>303</td><td colspan="2">7.98</td><td colspan="2">1.83</td><td>4.36</td><td>0</td><td>0</td><td>0</td><td>11.22</td></tr><tr><td>RF00168</td><td>Lysine</td><td>33</td><td>17</td><td>180</td><td>223</td><td colspan="2">5.71</td><td colspan="2">1.45</td><td>3.94</td><td>0</td><td>0</td><td>0</td><td>15.98</td></tr><tr><td>RF00380</td><td>ykoK</td><td>35</td><td>3</td><td>168</td><td>192</td><td colspan="2">4.33</td><td colspan="2">1.23</td><td>3.52</td><td>0</td><td>0</td><td>0</td><td>13.10</td></tr><tr><td>RF00003</td><td>U1</td><td>46</td><td>6</td><td>159</td><td>184</td><td colspan="2">4.14</td><td colspan="2">0.89</td><td>4.63</td><td>0</td><td>0</td><td>0</td><td>11.24</td></tr><tr><td>RF00025</td><td>Telomerase-cil</td><td>10</td><td>2</td><td>157</td><td>188</td><td colspan="2">3.89</td><td colspan="2">1.00</td><td>3.88</td><td>2</td><td>0</td><td>2</td><td>13.97</td></tr><tr><td>RF00002</td><td>5_8S_rRNA</td><td>62</td><td>1</td><td>151</td><td>183</td><td colspan="2">3.44</td><td colspan="2">0.97</td><td>3.55</td><td>0</td><td>0</td><td>0</td><td>11.28</td></tr><tr><td>RF00379</td><td>ydaO-yuaA</td><td>31</td><td>4</td><td>147</td><td>227</td><td colspan="2">4.38</td><td colspan="2">1.63</td><td>2.69</td><td>0</td><td>0</td><td>0</td><td>12.25</td></tr><tr><td>RF00067</td><td>U15</td><td>9</td><td>3</td><td>146</td><td>178</td><td colspan="2">2.71</td><td colspan="2">0.98</td><td>2.76</td><td>0</td><td>0</td><td>0</td><td>11.11</td></tr><tr><td>RF00029</td><td>Intron_gpII</td><td>7</td><td>11</td><td>141</td><td>276</td><td colspan="2">4.75</td><td colspan="2">1.32</td><td>3.59</td><td>1</td><td>0</td><td>1</td><td>11.08</td></tr><tr><td>RF00015</td><td>U4</td><td>25</td><td>1</td><td>141</td><td>187</td><td colspan="2">3.66</td><td colspan="2">1.04</td><td>3.53</td><td>1</td><td>0</td><td>1</td><td>13.46</td></tr><tr><td>RF00096</td><td>U8</td><td>5</td><td>1</td><td>135</td><td>177</td><td colspan="2">2.98</td><td colspan="2">0.93</td><td>3.20</td><td>0</td><td>0</td><td>0</td><td>11.56</td></tr><tr><td>RF00080</td><td>yybP-ykoY</td><td>20</td><td>33</td><td>129</td><td>173</td><td colspan="2">3.05</td><td colspan="2">1.13</td><td>2.69</td><td>1</td><td>0</td><td>1</td><td>10.78</td></tr><tr><td>RF00114</td><td>S15</td><td>10</td><td>1</td><td>117</td><td>138</td><td colspan="2">1.78</td><td colspan="2">0.60</td><td>2.99</td><td>0</td><td>0</td><td>0</td><td>13.12</td></tr><tr><td>RF00020</td><td>U5</td><td>29</td><td>3</td><td>115</td><td>139</td><td colspan="2">2.06</td><td colspan="2">0.74</td><td>2.80</td><td>0</td><td>0</td><td>0</td><td>13.64</td></tr><tr><td>RF00059</td><td>THI</td><td>228</td><td>8</td><td>109</td><td>222</td><td colspan="2">3.34</td><td colspan="2">1.46</td><td>2.29</td><td>0</td><td>0</td><td>0</td><td>13.66</td></tr><tr><td>RF00504</td><td>gcvT</td><td>109</td><td>5</td><td>102</td><td>199</td><td colspan="2">2.37</td><td colspan="2">1.40</td><td>1.70</td><td>0</td><td>0</td><td>0</td><td>13.40</td></tr><tr><td>RF00167</td><td>Purine</td><td>33</td><td>4</td><td>99</td><td>119</td><td colspan="2">1.49</td><td colspan="2">0.57</td><td>2.62</td><td>0</td><td>0</td><td>0</td><td>13.02</td></tr><tr><td>RF00169</td><td>SRP_bact</td><td>46</td><td>15</td><td>96</td><td>120</td><td colspan="2">1.47</td><td colspan="2">0.65</td><td>2.26</td><td>0</td><td>0</td><td>0</td><td>11.58</td></tr><tr><td>RF00055</td><td>snoZ37</td><td>5</td><td>1</td><td>94</td><td>117</td><td colspan="2">1.14</td><td colspan="2">0.53</td><td>2.16</td><td>1</td><td>0</td><td>1</td><td>13.96</td></tr><tr><td>RF00019</td><td>Y</td><td>15</td><td>1</td><td>94</td><td>128</td><td colspan="2">1.42</td><td colspan="2">0.73</td><td>1.94</td><td>1</td><td>0</td><td>1</td><td>14.25</td></tr><tr><td>RF00033</td><td>MicF</td><td>8</td><td>1</td><td>93</td><td>114</td><td colspan="2">1.28</td><td colspan="2">0.51</td><td>2.50</td><td>0</td><td>0</td><td>0</td><td>13.18</td></tr><tr><td>RF00213</td><td>snoR38</td><td>7</td><td>3</td><td>88</td><td>147</td><td colspan="2">1.36</td><td colspan="2">0.70</td><td>1.94</td><td>0</td><td>0</td><td>0</td><td>16.07</td></tr><tr><td>RF00054</td><td>U25</td><td>5</td><td>1</td><td>87</td><td>107</td><td colspan="2">0.96</td><td colspan="2">0.46</td><td>2.09</td><td>1</td><td>0</td><td>1</td><td>16.66</td></tr><tr><td>RF00206</td><td>U54</td><td>12</td><td>1</td><td>81</td><td>115</td><td colspan="2">0.94</td><td colspan="2">0.53</td><td>1.76</td><td>1</td><td>0</td><td>1</td><td>15.80</td></tr><tr><td>RF00104</td><td>mir-10</td><td>9</td><td>2</td><td>73</td><td>94</td><td colspan="2">0.85</td><td colspan="2">0.52</td><td>1.64</td><td>2</td><td>0</td><td>2</td><td>16.13</td></tr><tr><td>RF00005</td><td>tRNA</td><td>1080</td><td>19</td><td>73</td><td>127</td><td colspan="2">1.35</td><td colspan="2">0.48</td><td>2.81</td><td>5</td><td>1</td><td>4</td><td>12.62</td></tr><tr><td>RF00170</td><td>msr</td><td>5</td><td>3</td><td>70</td><td>112</td><td colspan="2">0.86</td><td colspan="2">0.45</td><td>1.92</td><td>3</td><td>0</td><td>3</td><td>13.49</td></tr><tr><td>RF00163</td><td>Hammerhead_1</td><td>65</td><td>1</td><td>68</td><td>233</td><td colspan="2">1.60</td><td colspan="2">0.90</td><td>1.77</td><td>0</td><td>0</td><td>0</td><td>15.82</td></tr><tr><td>RF00031</td><td>SECIS</td><td>11</td><td>24</td><td>64</td><td>87</td><td colspan="2">0.69</td><td colspan="2">0.42</td><td>1.63</td><td>13</td><td>2</td><td>11</td><td>14.58</td></tr><tr><td>RF00165</td><td>Corona_pk3</td><td>10</td><td>1</td><td>63</td><td>80</td><td colspan="2">0.55</td><td colspan="2">0.31</td><td>1.78</td><td>1</td><td>0</td><td>1</td><td>14.72</td></tr><tr><td>RF00066</td><td>U7</td><td>28</td><td>2</td><td>62</td><td>85</td><td colspan="2">0.59</td><td colspan="2">0.34</td><td>1.73</td><td>0</td><td>0</td><td>0</td><td>14.23</td></tr><tr><td>RF00008</td><td>Hammerhead_3</td><td>82</td><td>1</td><td>55</td><td>101</td><td colspan="2">0.71</td><td colspan="2">0.44</td><td>1.61</td><td>0</td><td>0</td><td>0</td><td>14.71</td></tr><tr><td>RF00037</td><td>IRE</td><td>36</td><td>1</td><td>28</td><td>45</td><td colspan="2">0.17</td><td colspan="2">0.12</td><td>1.39</td><td>1</td><td>0</td><td>1</td><td>17.64</td></tr><tr><td colspan="6">MER statistics summed across all families</td><td colspan="5"></td><td>96</td><td>5</td><td>91</td><td>N/A</td></tr><tr><td colspan="6">Summary MER statistics (using one threshold for all families)</td><td colspan="5"></td><td>114</td><td>3</td><td>111</td><td>16.38</td></tr><tr><td colspan="6">Average timing statistics</td><td>10.02</td><td colspan="2"> 1.64</td><td colspan="2"> 4.21</td><td colspan="4"></td></tr><tr><td colspan="6">Total timing statistics</td><td>510.86</td><td colspan="2">83.48</td><td colspan="2"> 6.12</td><td colspan="4"></td></tr></tbody></table> --><!-- <table-wrap-foot><fn id="nt501"><p>W, window length, maximum size of a hit per family, calculated as dmax(0). Running times for standard (nonbanded) and QDB (&beta; &equals; 10<sup>&minus;7</sup>) searches are given for each family, in CPU-hours per Mb. FP, false positive, FN, false negative. MER, minimum error rate FP &plus; FN at threshold. MER threshold, bit score for a given family at which the sum of FP and FN is minimized. Summary MER statistics, derived from a single score threshold in a ranked list of all hits across all families.</p></fn><fn id="nt502"><p>All statistics are for Infernal version 0.72 in local alignment mode.</p></fn></table-wrap-foot> --></table-wrap><p>The benchmark proceeds by first building a CM for each query alignment and then searching the pseudo-genome with each CM in local alignment mode. All hits above a threshold of 8.0 in raw bit score for each of the 51 queries were sorted by score into 51 ranked family-specific lists, as well as one ranked master list of all 51 sets of scores. Each hit is classified into one of three categories: “positive,” “ignore,” or “negative.” A “positive” is a hit that significantly overlaps with a true test sequence from the same family as the query. An “ignore” is a hit that significantly overlaps with a test sequence from a different family, where “significantly overlap” means that the length of overlap between two sequences (either two hits, or one hit and one test sequence embedded in the pseudo-genome) is more than 50% of the length of the shorter sequence. (Although it would be desirable to measure the false-positive rate on nonhomologous structural RNAs, we cannot be sure that any given pair of Rfam families is truly nonhomologous. Like most sequence family databases, Rfam is clustered computationally, and more sensitive methods will reveal previously unsuspected relationships that should not be benchmarked as “false positives.”) A “negative” is a hit that is not a positive or an ignore. For any two negatives that significantly overlap, only the one with the better score is counted.</p><p>The minimum error rate (MER) (“equivalence score”) [<xref ref-type="bibr" rid="pcbi-0030056-b038">38</xref>] was used as a measure of benchmark performance. The MER score is defined as the minimum sum of the false positives (negative hits above the threshold) and false negatives (true test sequences that have no positive hit above the threshold), at all possible choices of score threshold. The MER score is a combined measure of sensitivity and specificity, where a lower MER score is better. We calculate two kinds of MER scores. For a <italic>family-specific</italic> MER score, we choose a different optimal threshold in each of the 51 ranked lists, and for a <italic>summary</italic> MER score, we choose a single optimal threshold in the master list of all hits. The summary MER score is the more relevant measure of our current performance, because it demands a single query-independent bit score threshold for significance. A family-specific MER score reflects the performance that could be achieved if Infernal provided E-values (currently, it reports only raw bit scores).</p><p>For comparison, BlastN was also benchmarked on these data using a family-pairwise search (FPS) procedure [<xref ref-type="bibr" rid="pcbi-0030056-b039">39</xref>]. For each query alignment, each training sequence is used as a query sequence to search the pseudo-genome, all hits with an E-value of less than 1.0 were sorted by increasing E-value, and the lowest E-value positive hit to a given test sequence is counted.</p><p>Using this benchmark, we addressed several questions about QDB's performance.</p><p>What is the best setting of the single QDB free parameter, β, which specifies how much probability mass to sacrifice? <xref ref-type="fig" rid="pcbi-0030056-g003">Figure 3</xref> shows the average speedup per family and summary MER score as a function of varying β. There is no clear choice. The choice of β is a tradeoff of accuracy for speed. We chose a default of β = 10<sup>−7</sup> as a reasonable value that obtains a modest speedup with minimal loss of accuracy.</p><fig id="pcbi-0030056-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030056.g003</object-id><label>Figure 3</label><caption><title>Effect of Varying the β Parameter on Sensitivity, Specificity, and Speedup</title></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030056.g003" xlink:type="simple"/></fig><p>How well does QDB accelerate CM searches? <xref ref-type="fig" rid="pcbi-0030056-g004">Figure 4</xref> shows the time required for searching the 1-Mb benchmark target sequence with each of the 51 models, as a function of the average query RNA length. QDB reduces the average-case running time complexity of the CM search algorithm from <italic>LN</italic><sup>2.36</sup> to <italic>LN</italic><sup>1.32</sup>. Observed accelerations relative to the standard algorithm range from 1.4-fold (for the IRE, iron response element) to 12.7-fold (for the 5′ domain of SSU rRNA), with an average speedup per family of 4.2-fold. In total search time for the benchmark (sum of all 51 searches), the acceleration is 6-fold, because large queries have disproportionate effect on the total time.</p><fig id="pcbi-0030056-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030056.g004</object-id><label>Figure 4</label><caption><title>CPU Time Required by CM Searches with and without QDB</title><p>The time required for searching the 1-Mb target pseudo-genome with each of the 51 benchmark models is shown as a point, plotted on a log–log graph as a function of the average length of the RNA sequences in the query alignment; open circles are without QDB, and filled circles are with QDB (with the default β = 10<sup>−7</sup>). Lines represent fits to a power law (<italic>aN<sup>b</sup></italic>)<italic>,</italic> showing that for a fixed <italic>L</italic> = 1-Mb target database size, the standard CYK algorithm empirically scales as <italic>N</italic><sup>2.36</sup>, and the QDB algorithm scales as <italic>N</italic><sup>1.32</sup>. The apparent intersection of the linear fitted lines is deceptive. At small query lengths, run time is dominated by factors other than the CM alignment computation, such as i/o. QDB searches are always faster than nonbanded searches even for synthetic tiny queries of fewer than ten nucleotides (unpublished data).</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030056.g004" xlink:type="simple"/></fig><p>How much does QDB impact sensitivity and specificity? Optimal alignments are not guaranteed to lie within QDB's high-probability bands. This is expected to compromise sensitivity. The hope is that QDB's bands are sufficiently wide and accurate that the loss is negligible. <xref ref-type="fig" rid="pcbi-0030056-g005">Figure 5</xref> shows ROC plots (sensitivity versus false-positive rate) on the benchmark for the new version of Infernal (version 0.72) in standard versus QDB mode. These plots are nearly superposed, showing that the loss in accuracy is small at the default QDB setting of β = 10<sup>−7</sup>.</p><fig id="pcbi-0030056-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030056.g005</object-id><label>Figure 5</label><caption><title>ROC Curves for the Benchmark</title><p>Plots are shown for the new Infernal 0.72 with and without QDB, for the old Infernal 0.55, and for family-pairwise searches (FPS) with BlastN.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030056.g005" xlink:type="simple"/></fig><p>How much do our changes in parameterization (the addition of informative Dirichlet priors and entropy weighting) improve sensitivity and specificity? <xref ref-type="fig" rid="pcbi-0030056-g005">Figure 5</xref> shows that the new Infernal 0.72 is a large improvement over the previous Infernal version 0.55, independent of QDB. (On average, in this benchmark, Infernal 0.55 is no better than a family-pairwise search with BlastN.) <xref ref-type="table" rid="pcbi-0030056-t006">Table 6</xref> breaks this result down in more detail, showing summary and family-specific MER scores for a variety of combinations of prior, entropy weighting, and QDB. These results show that both informative priors and entropy weighting individually contributed large improvements in sensitivity and specificity.</p><table-wrap content-type="1col" id="pcbi-0030056-t006" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030056.t006</object-id><label>Table 6</label><caption><p>Rfam Benchmark MER Summary Statistics</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030056.t006" xlink:type="simple"/><!-- <table frame="hsides" rules="none"><colgroup><col id="tb6col1" align="left" charoff="0" char=""/><col id="tb6col2" align="left" charoff="0" char=""/><col id="tb6col3" align="left" charoff="0" char=""/><col id="tb6col4" align="left" charoff="0" char=""/><col id="tb6col5" align="left" charoff="0" char=""/><col id="tb6col6" align="char" charoff="0" char="."/></colgroup><thead><tr><td align="left"><hr/>Program</td><td><hr/>Prior</td><td><hr/>Entropy (Bits)</td><td><hr/>&beta;</td><td><hr/>Summary MER</td><td><hr/>Family-Specific MER</td></tr></thead><tbody><tr><td>BlastN</td><td>&mdash;</td><td>&mdash;</td><td>&mdash;</td><td>216</td><td>188</td></tr><tr><td>Infernal 0.55</td><td>Plus-1</td><td>&mdash;</td><td>&mdash;</td><td>232</td><td>180</td></tr><tr><td>Infernal 0.72</td><td>Plus-1</td><td>&mdash;</td><td>&mdash;</td><td>215</td><td>187</td></tr><tr><td>Infernal 0.72</td><td>Plus-1</td><td>1.46</td><td>&mdash;</td><td>208</td><td>191</td></tr><tr><td>Infernal 0.72</td><td>Informative</td><td>&mdash;</td><td>&mdash;</td><td>177</td><td>158</td></tr><tr><td>Infernal 0.72</td><td>Informative</td><td>1.46</td><td>&mdash;</td><td>105</td><td>90</td></tr><tr><td>Infernal 0.72</td><td>Informative</td><td>1.46</td><td>10<sup>&minus;7</sup></td><td>114</td><td>96</td></tr></tbody></table> --><!-- <table-wrap-foot><fn id="nt601"><p>Programs, BlastN: WU-BLASTN-2.0MP -kap -W&thinsp;&equals;&thinsp;7; for Infernal version 0.55, window length values (<italic>W</italic>) were preset as calculated in version 0.72 with plus-1 priors.</p></fn><fn id="nt602"><p>Prior, Plus-1 if uninformative Laplace plus-1 priors were used; Informative if new Dirichlet priors were used.</p></fn><fn id="nt603"><p>Entropy, target model entropy in bits for entropy weighting; &mdash; if entropy weighting was not used.</p></fn><fn id="nt604"><p>&beta;, tail probability loss for banded calculation used; &mdash; if search was nonbanded.</p></fn><fn id="nt605"><p>Summary MER, MER across 51 benchmark families.</p></fn><fn id="nt606"><p>Family-Specific MER, MER for each family, summed over all 51 families.</p></fn></table-wrap-foot> --></table-wrap></sec></sec><sec id="s3"><title>Discussion</title><p>CM searches take a long time, and this is the most limiting factor in using the Infernal software to identify RNA similarities. Prior to this work, Infernal 0.55 required 508 CPU-hours to search 51 models against just 1 Mb of sequence in our benchmarks (<xref ref-type="table" rid="pcbi-0030056-t005">Table 5</xref>). Using QDB with β banding cutoffs that do not appreciably compromise sensitivity and specificity, Infernal 0.72 offers a 6-fold speedup, performing the benchmark in 85 hours. Our eventual goal is to enable routine genome annotation of structural RNAs: to be able to search thousands of RNA models against complete genome sequences. A search of all 503 Rfam 7.0 models against the 3-GB human genome with Infernal 0.72 in QDB mode would take on the order of 300 CPU-years (down from 1,800 CPU years with Infernal 0.55). We need to be able to do it in, at the most, a few days, so we still need to increase CM search speed by five orders of magnitude. Thus, the QDB algorithm is a partial but certainly not complete solution to the problem. However, QDB combines synergistically with other acceleration techniques. Parallelization, on large clusters (although prohibitively expensive for all but a few centers), could give us further acceleration of three orders of magnitude. Software improvement (code optimization) will also contribute but probably only about 2-fold. Hardware improvements will contribute about 2-fold per year or so as long as Moore's law continues. Finally, QDB is complementary to the filtering methods recently described by Weinberg and Ruzzo [<xref ref-type="bibr" rid="pcbi-0030056-b020">20</xref>−<xref ref-type="bibr" rid="pcbi-0030056-b022">22</xref>]. We view QDB as part of a growing suite of approaches that we can combine to accelerate Infernal.</p><p>Is it really worth burning all this CPU time in the first place? Do CM searches identify structural RNA homologies that other methods miss? Obviously we think so, but one would like to see convincing results. For large, diverse RNA families like transfer RNA, where a CM can be trained on more than 1,000 well-aligned sequences with a well-conserved consensus secondary structure, CM approaches have been quite powerful. The state of the art in large-scale transfer RNA gene identification remains the CM-based program tRNAscan-SE [<xref ref-type="bibr" rid="pcbi-0030056-b001">1</xref>], and CMs were also used, for example, to discover the divergent tRNA for pyrrolysine, the “22nd amino acid” [<xref ref-type="bibr" rid="pcbi-0030056-b040">40</xref>]. But <xref ref-type="fig" rid="pcbi-0030056-g005">Figure 5</xref> shows that on average, in more than 51 more or less “typical” RNA families of various sizes and alignment quality, Infernal 0.55 was actually no better than doing a family-pairwise search with BlastN. Until recently, we have spent relatively little effort on how Infernal parameterizes its models and relatively more on reducing its computational requirements [<xref ref-type="bibr" rid="pcbi-0030056-b016">16</xref>], so previous versions of Infernal have performed best where naive parameterization works best: on very large, high-quality alignments of hundreds of sequences, which are atypical of many interesting homology search problems.</p><p>In this work, partly because the level of acceleration achieved by QDB is sensitive to transition parameterization, we have brought Infernal parameterization close to the state of the art in profile HMMs, by introducing mixture Dirichlet priors [<xref ref-type="bibr" rid="pcbi-0030056-b031">31</xref>] and entropy weighting [<xref ref-type="bibr" rid="pcbi-0030056-b036">36</xref>]. This resulted in a large improvement in the sensitivity and specificity of searches, as judged by our benchmark (<xref ref-type="fig" rid="pcbi-0030056-g005">Figure 5</xref>). The difference between Infernal and family-pairwise BlastN now appears pronounced for average-case behavior, not just best-case behavior. However, while we trust our benchmarking to tell us we have greatly improved Infernal relative to previous versions of itself, our benchmarking does not allow us to draw firm conclusions about our performance relative to other software. For that, we prefer to see independent benchmarks. Benchmarks by tool developers are notoriously biased, and however honest we may try to be, some biases are essentially unavoidable. For one thing, establishing an internal benchmark for ongoing code development creates an insidious form of training on the test set, because we accept code changes that improve benchmark performance. In particular, we set the entropy weighting target of 1.46 bits and the numbers of mixture prior components by optimizing against our benchmark. Further, our benchmark does not use a realistic model for the background sequence of the “pseudo-genome,” because we construct the background as a homogeneous independent, identically distributed (iid) sequence, and this poorly reflects the heterogeneous and repetitive nature of genomic sequence. This benchmark should be sufficient for an internal comparison of versions 0.55 and 0.72 of Infernal, because we have not altered how Infernal deals with heterogeneous compositional bias. But we cannot safely draw conclusions from our simple benchmark about the relative performance of Infernal and Blast on real searches, for example, because Blast may (and in fact does) treat sequence heterogeneity better than Infernal does. In this regard, currently we are aware of only one independent benchmark BRaliBase III [<xref ref-type="bibr" rid="pcbi-0030056-b041">41</xref>]. BRaliBase III consists of many different query alignments of five or 20 RNA sequences, drawn from three different RNA families (U5, 5S rRNA, and transfer RNA). These authors' results broadly confirm our internal observations: while Infernal 0.55 showed mediocre performance compared with BlastN and several other tools, a recent version of Infernal stood out as a superior method for RNA similarity search.</p><p>Nonetheless, although Infernal 0.72 shows large improvements in speed, sensitivity, and specificity over previous versions, there are numerous areas where we need to improve further.</p><p>A significant gap in our current implementation is that Infernal reports only raw bit scores and does not yet report expectation values (E-values). CM local alignment scores empirically follow a Gumbel (extreme value) distribution [<xref ref-type="bibr" rid="pcbi-0030056-b027">27</xref>], just as local sequence alignment scores do [<xref ref-type="bibr" rid="pcbi-0030056-b042">42</xref>], so there are no technical hurdles in implementing E-values. This will be an immediate focus for the next version of Infernal. E-value calculations not only have the effect of reporting statistical significance (more meaningful to a user than a raw bit score) but also normalize each family's score distribution into a more consistent overall rank order, because different query models exhibit different null distributions (particularly in the location parameter of the Gumbel distribution). We therefore expect E-values to contribute a large increase in performance whenever a single family-independent threshold is set. <xref ref-type="table" rid="pcbi-0030056-t006">Table 6</xref> roughly illustrates the expected gain, by showing the large difference between summary MER scores and family-specific MER scores.</p><p>Parameterization of both CMs and profile HMMs remains problematic, because these methods continue to assume that training sequences are statistically independent, when in fact they are related (often strongly so) by phylogeny. Methods like sequence weighting and entropy weighting do help, but they are ad hoc hacks: unsatisfying and unlikely to be optimal. Even mixture Dirichlet priors, although they appear to be mathematically sophisticated, fundamentally assume that observed counts are drawn as independent multinomial samples, and therefore the use of Dirichlet priors is fundamentally flawed. Probabilistic phylogenetic inference methodology needs to be integrated with profile search methods. This is an area of active research [<xref ref-type="bibr" rid="pcbi-0030056-b043">43</xref>−<xref ref-type="bibr" rid="pcbi-0030056-b045">45</xref>] in which important challenges remain, particularly in the treatment of insertions and deletions.</p><p>Finally, QDB is not the only algorithmic acceleration method we can envision. Michael Brown described a complementary banding method to accelerate his SCFG-based RNACAD ribosomal RNA alignment software [<xref ref-type="bibr" rid="pcbi-0030056-b025">25</xref>], in which he uses profile HMM-based sequence alignment to the target to determine bands where the more rigorous SCFG-based alignment should fall (because some regions of the alignment are well-determined based solely on sequence alignment). The gapped Blast algorithm (seed word hits, ungapped hit extension, and banded DP) can conceivably be extended from two-dimensional sequence alignment to three-dimensional CM DP lattices. Developing such algorithms, and incorporating them into a widely useful, freely available codebase, are priorities for us.</p></sec><sec id="s4"><title>Materials and Methods</title><p>The version and options used for Blast in our benchmark are WU-BLASTN-2.0MP -kap -W = 7. For Infernal, versions 0.55 and 0.72 were used as indicated. The complete Infernal software package, including documentation and the Rfam-based benchmark described here, may be downloaded from <ext-link ext-link-type="uri" xlink:href="http://infernal.janelia.org" xlink:type="simple">http://infernal.janelia.org</ext-link>. It is developed on GNU/Linux operating systems but should be portable to any POSIX-compliant operating system, including Mac OS/X. It is freely licensed under the GNU General Public License.</p><p>The ANSI C code we used for estimating maximum likelihood mixture Dirichlet priors depends on a copyrighted and nonredistributable implementation of the conjugate gradient descent algorithm from Numerical Recipes in C [<xref ref-type="bibr" rid="pcbi-0030056-b032">32</xref>]. Our code, less the Numerical Recipes routine, is freely available upon request.</p></sec></body><back><ack><p>We thank Elena Rivas for critical comments on the manuscript.</p></ack><glossary><title>Abbreviations</title><def-list><def-item><term>CM</term><def><p>covariance model</p></def></def-item><def-item><term>CYK</term><def><p>Cocke–Younger–Kasami</p></def></def-item><def-item><term>DP</term><def><p>dynamic programming</p></def></def-item><def-item><term>HMM</term><def><p>hidden Markov model</p></def></def-item><def-item><term>HSP</term><def><p>high-scoring pair</p></def></def-item><def-item><term>MER</term><def><p>minimum error rate</p></def></def-item><def-item><term>QDB</term><def><p>query-dependent banding</p></def></def-item><def-item><term>SCFG</term><def><p>stochastic context-free grammar</p></def></def-item></def-list></glossary><ref-list><title>References</title><ref id="pcbi-0030056-b001"><label>1</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Lowe</surname><given-names>TM</given-names></name><name name-style="western"><surname>Eddy</surname><given-names>SR</given-names></name></person-group>
					<year>1997</year>
					<article-title>tRNAscan-SE: A program for improved detection of transfer RNA genes in genomic sequence.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>25</volume>
					<fpage>955</fpage>
					<lpage>964</lpage>
				</element-citation></ref><ref id="pcbi-0030056-b002"><label>2</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Laslett</surname><given-names>D</given-names></name><name name-style="western"><surname>Canback</surname><given-names>B</given-names></name></person-group>
					<year>2004</year>
					<article-title>ARAGORN, a program to detect tRNA genes and tmRNA genes in nucleotide sequences.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>32</volume>
					<fpage>11</fpage>
					<lpage>16</lpage>
				</element-citation></ref><ref id="pcbi-0030056-b003"><label>3</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Lowe</surname><given-names>TM</given-names></name><name name-style="western"><surname>Eddy</surname><given-names>SR</given-names></name></person-group>
					<year>1999</year>
					<article-title>A computational screen for methylation guide snoRNAs in yeast.</article-title>
					<source>Science</source>
					<volume>283</volume>
					<fpage>1168</fpage>
					<lpage>1171</lpage>
				</element-citation></ref><ref id="pcbi-0030056-b004"><label>4</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Schattner</surname><given-names>P</given-names></name><name name-style="western"><surname>Barberan-Soler</surname><given-names>S</given-names></name><name name-style="western"><surname>Lowe</surname><given-names>TM</given-names></name></person-group>
					<year>2006</year>
					<article-title>A computational screen for mammalian pseudouridylation guide H/ACA RNAs.</article-title>
					<source>RNA</source>
					<volume>12</volume>
					<fpage>15</fpage>
					<lpage>25</lpage>
				</element-citation></ref><ref id="pcbi-0030056-b005"><label>5</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Lai</surname><given-names>EC</given-names></name><name name-style="western"><surname>Tomancak</surname><given-names>P</given-names></name><name name-style="western"><surname>Williams</surname><given-names>RW</given-names></name><name name-style="western"><surname>Rubin</surname><given-names>GM</given-names></name></person-group>
					<year>2003</year>
					<article-title>Computational identification of <italic>Drosophila</italic> microRNA genes.</article-title>
					<source>Genome Biol</source>
					<volume>4</volume>
					<fpage>R42</fpage>
				</element-citation></ref><ref id="pcbi-0030056-b006"><label>6</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Lim</surname><given-names>LP</given-names></name><name name-style="western"><surname>Glasner</surname><given-names>ME</given-names></name><name name-style="western"><surname>Yekta</surname><given-names>S</given-names></name><name name-style="western"><surname>Burge</surname><given-names>CB</given-names></name><name name-style="western"><surname>Bartel</surname><given-names>DP</given-names></name></person-group>
					<year>2003</year>
					<article-title>Vertebrate microRNA genes.</article-title>
					<source>Science</source>
					<volume>299</volume>
					<fpage>1540</fpage>
				</element-citation></ref><ref id="pcbi-0030056-b007"><label>7</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Regalia</surname><given-names>M</given-names></name><name name-style="western"><surname>Rosenblad</surname><given-names>MA</given-names></name><name name-style="western"><surname>Samuelsson</surname><given-names>T</given-names></name></person-group>
					<year>2002</year>
					<article-title>Prediction of signal recognition particle RNA genes.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>30</volume>
					<fpage>3368</fpage>
					<lpage>3377</lpage>
				</element-citation></ref><ref id="pcbi-0030056-b008"><label>8</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Ermolaeva</surname><given-names>MD</given-names></name><name name-style="western"><surname>Khalak</surname><given-names>HG</given-names></name><name name-style="western"><surname>White</surname><given-names>O</given-names></name><name name-style="western"><surname>Smith</surname><given-names>HO</given-names></name><name name-style="western"><surname>Salzberg</surname><given-names>SL</given-names></name></person-group>
					<year>2000</year>
					<article-title>Prediction of transcription terminators in bacterial genomes.</article-title>
					<source>J Mol Biol</source>
					<volume>301</volume>
					<fpage>27</fpage>
					<lpage>33</lpage>
				</element-citation></ref><ref id="pcbi-0030056-b009"><label>9</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Macke</surname><given-names>TJ</given-names></name><name name-style="western"><surname>Ecker</surname><given-names>DJ</given-names></name><name name-style="western"><surname>Gutell</surname><given-names>RR</given-names></name><name name-style="western"><surname>Gautheret</surname><given-names>D</given-names></name><name name-style="western"><surname>Case</surname><given-names>DA</given-names></name><etal/></person-group>
					<year>2001</year>
					<article-title>RNAMotif, an RNA secondary structure definition and search algorithm.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>29</volume>
					<fpage>4724</fpage>
					<lpage>4735</lpage>
				</element-citation></ref><ref id="pcbi-0030056-b010"><label>10</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Gautheret</surname><given-names>D</given-names></name><name name-style="western"><surname>Lambert</surname><given-names>A</given-names></name></person-group>
					<year>2001</year>
					<article-title>Direct RNA motif definition and identification from multiple sequence alignments using secondary structure profiles.</article-title>
					<source>J Mol Biol</source>
					<volume>313</volume>
					<fpage>1003</fpage>
					<lpage>1011</lpage>
				</element-citation></ref><ref id="pcbi-0030056-b011"><label>11</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Zhang</surname><given-names>S</given-names></name><name name-style="western"><surname>Haas</surname><given-names>B</given-names></name><name name-style="western"><surname>Eskin</surname><given-names>E</given-names></name><name name-style="western"><surname>Bafna</surname><given-names>V</given-names></name></person-group>
					<year>2005</year>
					<article-title>Searching genomes for noncoding RNA using FastR.</article-title>
					<source>IEEE/ACM Trans Comput Biol Bioinform</source>
					<volume>2</volume>
					<fpage>366</fpage>
					<lpage>379</lpage>
				</element-citation></ref><ref id="pcbi-0030056-b012"><label>12</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Altschul</surname><given-names>SF</given-names></name><name name-style="western"><surname>Madden</surname><given-names>TL</given-names></name><name name-style="western"><surname>Schaffer</surname><given-names>AA</given-names></name><name name-style="western"><surname>Zhang</surname><given-names>J</given-names></name><name name-style="western"><surname>Zhang</surname><given-names>Z</given-names></name><etal/></person-group>
					<year>1997</year>
					<article-title>Gapped BLAST and PSI-BLAST: A new generation of protein database search programs.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>25</volume>
					<fpage>3389</fpage>
					<lpage>3402</lpage>
				</element-citation></ref><ref id="pcbi-0030056-b013"><label>13</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Sakakibara</surname><given-names>Y</given-names></name><name name-style="western"><surname>Brown</surname><given-names>M</given-names></name><name name-style="western"><surname>Hughey</surname><given-names>R</given-names></name><name name-style="western"><surname>Mian</surname><given-names>IS</given-names></name><name name-style="western"><surname>Sjolander</surname><given-names>K</given-names></name><etal/></person-group>
					<year>1994</year>
					<article-title>Stochastic context-free grammars for tRNA modeling.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>22</volume>
					<fpage>5112</fpage>
					<lpage>5120</lpage>
				</element-citation></ref><ref id="pcbi-0030056-b014"><label>14</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Durbin</surname><given-names>R</given-names></name><name name-style="western"><surname>Eddy</surname><given-names>SR</given-names></name><name name-style="western"><surname>Krogh</surname><given-names>A</given-names></name><name name-style="western"><surname>Mitchison</surname><given-names>GJ</given-names></name></person-group>
					<year>1998</year>
					<source>Biological sequence analysis: Probabilistic models of proteins and nucleic acids</source>
					<publisher-loc>Cambridge (United Kingdom)</publisher-loc>
					<publisher-name>Cambridge University Press</publisher-name>
					<!--===== Restructure page-count as size[@units="page"] =====--><size units="page">350</size>
				</element-citation></ref><ref id="pcbi-0030056-b015"><label>15</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Eddy</surname><given-names>SR</given-names></name><name name-style="western"><surname>Durbin</surname><given-names>R</given-names></name></person-group>
					<year>1994</year>
					<article-title>RNA sequence analysis using covariance models.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>22</volume>
					<fpage>2079</fpage>
					<lpage>2088</lpage>
				</element-citation></ref><ref id="pcbi-0030056-b016"><label>16</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Eddy</surname><given-names>SR</given-names></name></person-group>
					<year>2002</year>
					<article-title>A memory-efficient dynamic programming algorithm for optimal alignment of a sequence to an RNA secondary structure.</article-title>
					<source>BMC Bioinformatics</source>
					<volume>3</volume>
					<fpage>18</fpage>
				</element-citation></ref><ref id="pcbi-0030056-b017"><label>17</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Griffiths-Jones</surname><given-names>S</given-names></name><name name-style="western"><surname>Moxon</surname><given-names>S</given-names></name><name name-style="western"><surname>Marshall</surname><given-names>M</given-names></name><name name-style="western"><surname>Khanna</surname><given-names>A</given-names></name><name name-style="western"><surname>Eddy</surname><given-names>SR</given-names></name><etal/></person-group>
					<year>2005</year>
					<article-title>Rfam: Annotating non-coding RNAs in complete genomes.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>33</volume>
					<fpage>D121</fpage>
					<lpage>D141</lpage>
				</element-citation></ref><ref id="pcbi-0030056-b018"><label>18</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Sonnhammer</surname><given-names>ELL</given-names></name><name name-style="western"><surname>Eddy</surname><given-names>SR</given-names></name><name name-style="western"><surname>Birney</surname><given-names>E</given-names></name><name name-style="western"><surname>Bateman</surname><given-names>A</given-names></name><name name-style="western"><surname>Durbin</surname><given-names>R</given-names></name></person-group>
					<year>1998</year>
					<article-title>Pfam: Multiple sequence alignments and HMM-profiles of protein domains.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>26</volume>
					<fpage>320</fpage>
					<lpage>322</lpage>
				</element-citation></ref><ref id="pcbi-0030056-b019"><label>19</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Finn</surname><given-names>RD</given-names></name><name name-style="western"><surname>Mistry</surname><given-names>J</given-names></name><name name-style="western"><surname>Schuster-Bockler</surname><given-names>B</given-names></name><name name-style="western"><surname>Griffiths-Jones</surname><given-names>S</given-names></name><name name-style="western"><surname>Hollich</surname><given-names>V</given-names></name><etal/></person-group>
					<year>2006</year>
					<article-title>Pfam: Clans, web tools and services.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>34</volume>
					<fpage>D247</fpage>
					<lpage>D251</lpage>
				</element-citation></ref><ref id="pcbi-0030056-b020"><label>20</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Weinberg</surname><given-names>Z</given-names></name><name name-style="western"><surname>Ruzzo</surname><given-names>WL</given-names></name></person-group>
					<year>2004</year>
					<article-title>Exploiting conserved structure for faster annotation of non-coding RNAs without loss of accuracy.</article-title>
					<source>Bioinformatics</source>
					<volume>20</volume>
					<issue>Supplement 1</issue>
					<fpage>I334</fpage>
					<lpage>I341</lpage>
				</element-citation></ref><ref id="pcbi-0030056-b021"><label>21</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Weinberg</surname><given-names>Z</given-names></name><name name-style="western"><surname>Ruzzo</surname><given-names>WL</given-names></name></person-group>
					<year>2004</year>
					<article-title>Faster genome annotation of non-coding RNA families without loss of accuracy.</article-title>
					<comment>In</comment>
					<source>Proceedings of the Eighth Annual International Conference on Research in Computational Molecular Biology</source>
					<conf-date> 27–31 March 2004;</conf-date>
					<conf-loc> San Diego, California, United States.</conf-loc>
					<comment>RECOMB '04. pp.</comment>
					<fpage>243</fpage>
					<lpage>251</lpage>
				</element-citation></ref><ref id="pcbi-0030056-b022"><label>22</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Weinberg</surname><given-names>Z</given-names></name><name name-style="western"><surname>Ruzzo</surname><given-names>WL</given-names></name></person-group>
					<year>2006</year>
					<article-title>Sequence-based heuristics for faster annotation of non-coding RNA families.</article-title>
					<source>Bioinformatics</source>
					<volume>22</volume>
					<fpage>35</fpage>
					<lpage>39</lpage>
				</element-citation></ref><ref id="pcbi-0030056-b023"><label>23</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Zhang</surname><given-names>S</given-names></name><name name-style="western"><surname>Borovok</surname><given-names>I</given-names></name><name name-style="western"><surname>Aharonowitz</surname><given-names>Y</given-names></name><name name-style="western"><surname>Sharan</surname><given-names>R</given-names></name><name name-style="western"><surname>Bafna</surname><given-names>V</given-names></name></person-group>
					<year>2006</year>
					<article-title>A sequence-based filtering method for ncRNA identification and its application to searching for riboswitch elements.</article-title>
					<source>Bioinformatics</source>
					<volume>22</volume>
					<fpage>e557</fpage>
					<lpage>e565</lpage>
				</element-citation></ref><ref id="pcbi-0030056-b024"><label>24</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Brudno</surname><given-names>M</given-names></name><name name-style="western"><surname>Do</surname><given-names>CB</given-names></name><name name-style="western"><surname>Cooper</surname><given-names>GM</given-names></name><name name-style="western"><surname>Kim</surname><given-names>MF</given-names></name><name name-style="western"><surname>Green</surname><given-names>E</given-names></name><collab xlink:type="simple">NISC Comparative Sequencing Program, </collab><name name-style="western"><surname>Sidow</surname><given-names>A</given-names></name><name name-style="western"><surname>Batzoglou</surname><given-names>S</given-names></name></person-group>
					<year>2003</year>
					<article-title>LAGAN and multi-LAGAN: Efficient tools for large-scale multiple alignment of genomic DNA.</article-title>
					<source>Genome Res</source>
					<volume>13</volume>
					<fpage>721</fpage>
					<lpage>731</lpage>
				</element-citation></ref><ref id="pcbi-0030056-b025"><label>25</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Brown</surname><given-names>MP</given-names></name></person-group>
					<year>2000</year>
					<article-title>Small subunit ribosomal RNA modeling using stochastic context-free grammars.</article-title>
					<source>Proceedings of the Eighth International Conference on Intelligent Systems in Molecular Biology</source>
					<conf-date> 19–23 August 2000;</conf-date>
					<conf-loc> San Diego, California, United States.</conf-loc>
					<fpage>57</fpage>
					<lpage>66</lpage>
				</element-citation></ref><ref id="pcbi-0030056-b026"><label>26</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Eddy</surname><given-names>SR</given-names></name></person-group>
					<year>2003</year>
					<source>The Infernal user's guide</source>
					<comment><ext-link ext-link-type="uri" xlink:href="http://infernal.janelia.org" xlink:type="simple">http://infernal.janelia.org</ext-link>.</comment>
				</element-citation></ref><ref id="pcbi-0030056-b027"><label>27</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Klein</surname><given-names>RJ</given-names></name><name name-style="western"><surname>Eddy</surname><given-names>SR</given-names></name></person-group>
					<year>2003</year>
					<article-title>RSEARCH: Finding homologs of single structured RNA sequences.</article-title>
					<source>BMC Bioinformatics</source>
					<volume>4</volume>
					<fpage>44</fpage>
				</element-citation></ref><ref id="pcbi-0030056-b028"><label>28</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Kasami</surname><given-names>T</given-names></name></person-group>
					<year>1965</year>
					<source>An efficient recognition and syntax algorithm for context-free algorithms</source>
					<publisher-loc>Bedford (Massachusetts)</publisher-loc>
					<publisher-name>Air Force Cambridge Research Lab, Technical Report AFCRL-65–758</publisher-name>
				</element-citation></ref><ref id="pcbi-0030056-b029"><label>29</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Younger</surname><given-names>DH</given-names></name></person-group>
					<year>1967</year>
					<article-title>Recognition and parsing of context-free languages in time <italic>n</italic><sup>3</sup>.</article-title>
					<source>Inform Control</source>
					<volume>10</volume>
					<fpage>189</fpage>
					<lpage>208</lpage>
				</element-citation></ref><ref id="pcbi-0030056-b030"><label>30</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Hopcroft</surname><given-names>JE</given-names></name><name name-style="western"><surname>Ullman</surname><given-names>JD</given-names></name></person-group>
					<year>1979</year>
					<source>Introduction to automata theory, languages, and computation</source>
					<publisher-loc>Reading (Massachusetts)</publisher-loc>
					<publisher-name>Addison-Wesley</publisher-name>
					<!--===== Restructure page-count as size[@units="page"] =====--><size units="page">418</size>
				</element-citation></ref><ref id="pcbi-0030056-b031"><label>31</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Sjölander</surname><given-names>K</given-names></name><name name-style="western"><surname>Karplus</surname><given-names>K</given-names></name><name name-style="western"><surname>Brown</surname><given-names>M</given-names></name><name name-style="western"><surname>Hughey</surname><given-names>R</given-names></name><name name-style="western"><surname>Krogh</surname><given-names>A</given-names></name><etal/></person-group>
					<year>1996</year>
					<article-title>Dirichlet mixtures: A method for improving detection of weak but significant protein sequence homology.</article-title>
					<source>Comput Appl Biosci</source>
					<volume>12</volume>
					<fpage>327</fpage>
					<lpage>345</lpage>
				</element-citation></ref><ref id="pcbi-0030056-b032"><label>32</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Press</surname><given-names>WH</given-names></name><name name-style="western"><surname>Teukolsky</surname><given-names>SA</given-names></name><name name-style="western"><surname>Vetterling</surname><given-names>WT</given-names></name><name name-style="western"><surname>Flannery</surname><given-names>BP</given-names></name></person-group>
					<year>1993</year>
					<source>Numerical recipes in C: The art of scientific computing</source>
					<publisher-loc>Cambridge</publisher-loc>
					<publisher-name>Cambridge University Press</publisher-name>
					<!--===== Restructure page-count as size[@units="page"] =====--><size units="page">735</size>
				</element-citation></ref><ref id="pcbi-0030056-b033"><label>33</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Brown</surname><given-names>M</given-names></name><name name-style="western"><surname>Hughey</surname><given-names>R</given-names></name><name name-style="western"><surname>Krogh</surname><given-names>A</given-names></name><name name-style="western"><surname>Mian</surname><given-names>IS</given-names></name><name name-style="western"><surname>Sjolander</surname><given-names>K</given-names></name><etal/></person-group>
					<year>1993</year>
					<article-title>Using dirichlet mixture priors to derive hidden Markov models for protein families.</article-title>
					<comment>In:</comment>
					<person-group person-group-type="editor"><name name-style="western"><surname>Hunter</surname><given-names>L</given-names></name><name name-style="western"><surname>Searls</surname><given-names>D</given-names></name><name name-style="western"><surname>Shavlik</surname><given-names>J</given-names></name></person-group>
					<source>Proceedings of the First International Conference on Intelligent Systems for Molecular Biology; </source>
					<conf-date>6–9 July 1993;</conf-date>
					<conf-loc> Bethesda, Maryland, United States.</conf-loc>
					<publisher-name>AAAI Press</publisher-name>
					<fpage>47</fpage>
					<lpage>55</lpage>
				</element-citation></ref><ref id="pcbi-0030056-b034"><label>34</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Wuyts</surname><given-names>J</given-names></name><name name-style="western"><surname>Rijk</surname><given-names>PD</given-names></name><name name-style="western"><surname>de Peer</surname><given-names>YV</given-names></name><name name-style="western"><surname>Winkelmans</surname><given-names>T</given-names></name><name name-style="western"><surname>Wachter</surname><given-names>RD</given-names></name></person-group>
					<year>2001</year>
					<article-title>The European large subunit ribosomal RNA database.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>29</volume>
					<fpage>175</fpage>
					<lpage>177</lpage>
				</element-citation></ref><ref id="pcbi-0030056-b035"><label>35</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Wuyts</surname><given-names>J</given-names></name><name name-style="western"><surname>de Peer</surname><given-names>YV</given-names></name><name name-style="western"><surname>Winkelmans</surname><given-names>T</given-names></name><name name-style="western"><surname>Wachter</surname><given-names>RD</given-names></name></person-group>
					<year>2002</year>
					<article-title>The European database on small subunit ribosomal RNA.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>30</volume>
					<fpage>183</fpage>
					<lpage>185</lpage>
				</element-citation></ref><ref id="pcbi-0030056-b036"><label>36</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Karplus</surname><given-names>K</given-names></name><name name-style="western"><surname>Barrett</surname><given-names>C</given-names></name><name name-style="western"><surname>Hughey</surname><given-names>R</given-names></name></person-group>
					<year>1998</year>
					<article-title>Hidden Markov models for detecting remote protein homologies.</article-title>
					<source>Bioinformatics</source>
					<volume>14</volume>
					<fpage>846</fpage>
					<lpage>856</lpage>
				</element-citation></ref><ref id="pcbi-0030056-b037"><label>37</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Altschul</surname><given-names>SF</given-names></name></person-group>
					<year>1991</year>
					<article-title>Amino acid substitution matrices from an information theoretic perspective.</article-title>
					<source>J Mol Biol</source>
					<volume>219</volume>
					<fpage>555</fpage>
					<lpage>565</lpage>
				</element-citation></ref><ref id="pcbi-0030056-b038"><label>38</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Pearson</surname><given-names>WR</given-names></name></person-group>
					<year>1995</year>
					<article-title>Comparison of methods for searching protein sequence databases.</article-title>
					<source>Protein Sci</source>
					<volume>4</volume>
					<fpage>1145</fpage>
					<lpage>1160</lpage>
				</element-citation></ref><ref id="pcbi-0030056-b039"><label>39</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Grundy</surname><given-names>WN</given-names></name></person-group>
					<year>1998</year>
					<article-title>Homology detection via family pairwise search.</article-title>
					<source>J Comput Biol</source>
					<volume>5</volume>
					<fpage>479</fpage>
					<lpage>491</lpage>
				</element-citation></ref><ref id="pcbi-0030056-b040"><label>40</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Srinivasan</surname><given-names>G</given-names></name><name name-style="western"><surname>James</surname><given-names>CM</given-names></name><name name-style="western"><surname>Krzycki</surname><given-names>JA</given-names></name></person-group>
					<year>2002</year>
					<article-title>Pyrrolysine encoded by UAG in archaea: Charging of a UAG-decoding specialized tRNA.</article-title>
					<source>Science</source>
					<volume>296</volume>
					<fpage>1459</fpage>
					<lpage>1462</lpage>
				</element-citation></ref><ref id="pcbi-0030056-b041"><label>41</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Freyhult</surname><given-names>EK</given-names></name><name name-style="western"><surname>Bollback</surname><given-names>JP</given-names></name><name name-style="western"><surname>Gardner</surname><given-names>PP</given-names></name></person-group>
					<year>2007</year>
					<article-title>Exploring genomic dark matter: A critical assessment of the performance of homology search methods on noncoding RNA.</article-title>
					<source>Genome Res</source>
					<volume>17</volume>
					<fpage>117</fpage>
					<lpage>125</lpage>
				</element-citation></ref><ref id="pcbi-0030056-b042"><label>42</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Karlin</surname><given-names>S</given-names></name><name name-style="western"><surname>Altschul</surname><given-names>SF</given-names></name></person-group>
					<year>1993</year>
					<article-title>Applications and statistics for multiple high-scoring segments in molecular sequences.</article-title>
					<source>Proc Natl Acad Sci U S A</source>
					<volume>90</volume>
					<fpage>5873</fpage>
					<lpage>5877</lpage>
				</element-citation></ref><ref id="pcbi-0030056-b043"><label>43</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Holmes</surname><given-names>I</given-names></name></person-group>
					<year>2004</year>
					<article-title>A probabilistic model for the evolution of RNA structure.</article-title>
					<source>BMC Bioinformatics</source>
					<volume>5</volume>
					<fpage>166</fpage>
				</element-citation></ref><ref id="pcbi-0030056-b044"><label>44</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Holmes</surname><given-names>I</given-names></name></person-group>
					<year>2005</year>
					<article-title>Using evolutionary expectation maximization to estimate indel rates.</article-title>
					<source>Bioinformatics</source>
					<volume>21</volume>
					<fpage>2294</fpage>
					<lpage>2300</lpage>
				</element-citation></ref><ref id="pcbi-0030056-b045"><label>45</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Rivas</surname><given-names>E</given-names></name></person-group>
					<year>2005</year>
					<article-title>Evolutionary models for insertions and deletions in a probabilistic modeling framework.</article-title>
					<source>BMC Bioinformatics</source>
					<volume>6</volume>
					<fpage>63</fpage>
				</element-citation></ref></ref-list></back></article>