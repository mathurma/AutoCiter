<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-16-01601</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1005727</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Database and informatics methods</subject><subj-group><subject>Bioinformatics</subject><subj-group><subject>Sequence analysis</subject><subj-group><subject>Sequence alignment</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Molecular biology</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Sequencing techniques</subject><subj-group><subject>Genome sequencing</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Sequencing techniques</subject><subj-group><subject>Genome sequencing</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Molecular biology</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Sequencing techniques</subject><subj-group><subject>DNA sequencing</subject><subj-group><subject>Gene sequencing</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Sequencing techniques</subject><subj-group><subject>DNA sequencing</subject><subj-group><subject>Gene sequencing</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Evolutionary biology</subject><subj-group><subject>Population genetics</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Population genetics</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Population biology</subject><subj-group><subject>Population genetics</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Genome analysis</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Genomics</subject><subj-group><subject>Genome analysis</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Organisms</subject><subj-group><subject>Plants</subject><subj-group><subject>Grasses</subject><subj-group><subject>Rice</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Experimental organism systems</subject><subj-group><subject>Plant and algal models</subject><subj-group><subject>Rice</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Genomics</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Comparative genomics</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Genomics</subject><subj-group><subject>Comparative genomics</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>kWIP: The <italic>k</italic>-mer weighted inner product, a <italic>de novo</italic> estimator of genetic similarity</article-title>
<alt-title alt-title-type="running-head">The <italic>k</italic>-mer weighted inner product</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-2466-1917</contrib-id>
<name name-style="western">
<surname>Murray</surname> <given-names>Kevin D.</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Webers</surname> <given-names>Christfried</given-names></name>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-2302-9733</contrib-id>
<name name-style="western">
<surname>Ong</surname> <given-names>Cheng Soon</given-names></name>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Borevitz</surname> <given-names>Justin</given-names></name>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Warthmann</surname> <given-names>Norman</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Research School of Biology, The Australian National University, Canberra, Australia</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Data61, CSIRO, Canberra, Australia</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>Research School of Computer Science, The Australian National University, Canberra, Australia</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Prlic</surname> <given-names>Andreas</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>UCSD, UNITED STATES</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">kdmpapers@gmail.com</email> (KDM); <email xlink:type="simple">norman@warthmann.com</email> (NW)</corresp>
</author-notes>
<pub-date pub-type="collection">
<month>9</month>
<year>2017</year>
</pub-date>
<pub-date pub-type="epub">
<day>5</day>
<month>9</month>
<year>2017</year>
</pub-date>
<volume>13</volume>
<issue>9</issue>
<elocation-id>e1005727</elocation-id>
<history>
<date date-type="received">
<day>4</day>
<month>10</month>
<year>2016</year>
</date>
<date date-type="accepted">
<day>21</day>
<month>8</month>
<year>2017</year>
</date>
</history>
<permissions>
<copyright-year>2017</copyright-year>
<copyright-holder>Murray et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1005727"/>
<abstract>
<p>Modern genomics techniques generate overwhelming quantities of data. Extracting population genetic variation demands computationally efficient methods to determine genetic relatedness between individuals (or “samples”) in an unbiased manner, preferably <italic>de novo</italic>. Rapid estimation of genetic relatedness directly from sequencing data has the potential to overcome reference genome bias, and to verify that individuals belong to the correct genetic lineage before conclusions are drawn using mislabelled, or misidentified samples. We present the <italic>k</italic>-mer Weighted Inner Product (<monospace>kWIP</monospace>), an assembly-, and alignment-free estimator of genetic similarity. <monospace>kWIP</monospace> combines a probabilistic data structure with a novel metric, the weighted inner product (WIP), to efficiently calculate pairwise similarity between sequencing runs from their <italic>k</italic>-mer counts. It produces a distance matrix, which can then be further analysed and visualised. Our method does not require prior knowledge of the underlying genomes and applications include establishing sample identity and detecting mix-up, non-obvious genomic variation, and population structure. We show that <monospace>kWIP</monospace> can reconstruct the true relatedness between samples from simulated populations. By re-analysing several published datasets we show that our results are consistent with marker-based analyses. <monospace>kWIP</monospace> is written in C++, licensed under the GNU GPL, and is available from <ext-link ext-link-type="uri" xlink:href="https://github.com/kdmurray91/kwip" xlink:type="simple">https://github.com/kdmurray91/kwip</ext-link>.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution>Centre of Excellence in Plant Energy Biology, Australian Research Council (AU)</institution>
</funding-source>
<award-id>CE140100008</award-id>
</award-group>
<funding-statement>This project was supported by the Australian Research Council Centre of Excellence in Plant Energy Biology (CE140100008) and by NICTA which was funded by the Australian Government through the Department of Communications and the Australian Research Council through the ICT Centre of Excellence Program. The research was undertaken with the assistance of resources from the National Computational Infrastructure (NCI), which is supported by the Australian Government. KDM is supported by an Australian Government Research Training Program (RTP) Scholarship. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="6"/>
<table-count count="1"/>
<page-count count="17"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2017-09-15</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>The software, kWIP, is publicly available at <ext-link ext-link-type="uri" xlink:href="https://github.com/kdmurray91/kWIP" xlink:type="simple">https://github.com/kdmurray91/kWIP</ext-link>. All simulation data was created by supplied reproducible workflows. All other analysis is based on published data that is publicly available and referenced.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<disp-quote><p>This is a <italic>PLOS Computational Biology</italic> Software paper.</p></disp-quote>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>A major application of DNA sequencing is comparing the genetic make-up of samples with one another to either identify commonalities, and thus detect relatedness, or to leverage the differences to elucidate function. Initially, one seeks to confirm assumed genetic lineages and replicates or to group samples into families, populations, and species. Estimating the genetic relatedness between a broad collection of samples must avoid bias and have minimal per sample cost.</p>
<p>Nowadays, the vast majority of studies in population genomics are performed using next generation sequencing (NGS) [<xref ref-type="bibr" rid="pcbi.1005727.ref001">1</xref>]. The methods commonly employed to analyse whole genome DNA sequencing data rely on two complementary concepts: the assembly of reference genomes and comparing samples to this reference by re-sequencing, read mapping, and variant calling. This approach, while functional in model organisms, is not ideal. Selecting the reference individual is mostly random, generating a reference genome assembly is time consuming and costly [<xref ref-type="bibr" rid="pcbi.1005727.ref002">2</xref>, <xref ref-type="bibr" rid="pcbi.1005727.ref003">3</xref>], and analyses based on read alignment to a possibly inappropriate reference genome sequence are highly susceptible to bias [<xref ref-type="bibr" rid="pcbi.1005727.ref004">4</xref>, <xref ref-type="bibr" rid="pcbi.1005727.ref005">5</xref>], to the point where large parts of the genomes are missed when sufficiently different or absent from the reference. Alignment-free methods for measuring genetic relatedness would help overcome this reference genome bias.</p>
<p>Another issue of concern is sample identification. A recent review [<xref ref-type="bibr" rid="pcbi.1005727.ref006">6</xref>] found that sample misidentification occurs at an alarming rate. With ever increasing sample numbers in (population) genetic projects, the issue of correct and consistent metadata arises on several levels: technical (mix-up) and biological (misidentification). Large field, and entire gene bank collections are being DNA-sequenced. With sample handling from the field through the laboratory to the sequence read files and eventual upload to data repositories, there is ample opportunity for mix-up and mislabelling of samples and files. This problem is exacerbated by the often highly collaborative nature of such undertakings. Some misidentifications, however, might be virtually undetectable without molecular genetic analysis, such as varying levels of ploidy, cryptic species, or sub-genomes in (compilo)species complexes [<xref ref-type="bibr" rid="pcbi.1005727.ref007">7</xref>]. Unfortunately, much of this hidden variation is easily overlooked by following aforementioned current best practices to calculate genome-wide genetic relatedness from short read sequencing data. Erroneous sample identification and/or underestimating the level of divergence has implications for downstream analysis choices, such as which samples and populations to use for a Genome Wide Association Study (GWAS); the missing heritability might then in fact be in the metadata.</p>
<p>The field of alignment-free sequence comparison aims to combat these difficulties by avoiding the process of sequence alignment. Approaches include decomposition into words, i.e., substrings of length k, commonly referred to as <italic>k</italic>-mers [<xref ref-type="bibr" rid="pcbi.1005727.ref008">8</xref>–<xref ref-type="bibr" rid="pcbi.1005727.ref011">11</xref>], sub-string or text processing algorithms [<xref ref-type="bibr" rid="pcbi.1005727.ref012">12</xref>–<xref ref-type="bibr" rid="pcbi.1005727.ref014">14</xref>], and information theoretic measures of sequence similarity or complexity [<xref ref-type="bibr" rid="pcbi.1005727.ref015">15</xref>]. While avoiding sequence alignment, some alignment-free sequence comparison tools still require prior knowledge of the underlying genome sequences, which precludes their use as a <italic>de novo</italic> tool. Recently, several algorithms enabling <italic>de novo</italic> comparisons have been published. These extensions all attempt to reconstruct phylogenetic relationships from sequencing reads. <monospace>Spaced</monospace> [<xref ref-type="bibr" rid="pcbi.1005727.ref013">13</xref>, <xref ref-type="bibr" rid="pcbi.1005727.ref016">16</xref>] uses the Jensen-Shannon distance on spaced seeds (small <italic>k</italic>-mers a short distance from one another or with interspersed disregarded bases) to improve performance of phylogenetic reconstruction. <monospace>Cnidaria</monospace> [<xref ref-type="bibr" rid="pcbi.1005727.ref017">17</xref>] and <monospace>AAF</monospace> [<xref ref-type="bibr" rid="pcbi.1005727.ref018">18</xref>] use the Jaccard distance to reconstruct phylogenies, while <monospace>mash</monospace> [<xref ref-type="bibr" rid="pcbi.1005727.ref019">19</xref>] uses a MinHash approximation of Jaccard distance to the same effect.</p>
<p>One of the most established and studied alignment-free sequence comparison metrics is the <italic>D</italic><sub>2</sub> statistic [<xref ref-type="bibr" rid="pcbi.1005727.ref008">8</xref>, <xref ref-type="bibr" rid="pcbi.1005727.ref010">10</xref>]. It measures the difference between two sequences by the number of <italic>k</italic>-mer matches. First, all <italic>k</italic>-mers are counted in each sequence and recorded in a count vector. Then the difference between those vectors is measured. In the case of the original <italic>D</italic><sub>2</sub> statistic, this is achieved by simply building the vector product. Several derivatives of the <italic>D</italic><sub>2</sub> statistics, e.g., <inline-formula id="pcbi.1005727.e001"><alternatives><graphic id="pcbi.1005727.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005727.e001" xlink:type="simple"/><mml:math display="inline" id="M1"><mml:msubsup><mml:mi>D</mml:mi> <mml:mn>2</mml:mn> <mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1005727.e002"><alternatives><graphic id="pcbi.1005727.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005727.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:msubsup><mml:mi>D</mml:mi> <mml:mn>2</mml:mn> <mml:mi>S</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>, have been developed over the years [<xref ref-type="bibr" rid="pcbi.1005727.ref008">8</xref>, <xref ref-type="bibr" rid="pcbi.1005727.ref020">20</xref>–<xref ref-type="bibr" rid="pcbi.1005727.ref023">23</xref>], which aim to improve accuracy by modelling and correlating observed versus expected <italic>k</italic>-mer frequencies. While these statistics have been extended to Next Generation Sequence data [<xref ref-type="bibr" rid="pcbi.1005727.ref024">24</xref>] and successfully applied to metagenome comparisons [<xref ref-type="bibr" rid="pcbi.1005727.ref025">25</xref>], these <italic>D</italic><sub>2</sub> statistic derivatives, such as <inline-formula id="pcbi.1005727.e003"><alternatives><graphic id="pcbi.1005727.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005727.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:msubsup><mml:mi>D</mml:mi> <mml:mn>2</mml:mn> <mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005727.e004"><alternatives><graphic id="pcbi.1005727.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005727.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:msubsup><mml:mi>D</mml:mi> <mml:mn>2</mml:mn> <mml:mi>S</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>, have the significant drawbacks of slow computational speed and the difficulties of defining the background models.</p>
<p>Here we present the <italic>k</italic>-mer Weighted Inner Product, a new metric to estimate genetic relatedness that introduces and combines two concepts to <italic>k</italic>-mer-based sequence comparison. Similar to the <italic>D</italic><sub>2</sub> statistic(s), the similarity measure is an inner product of <italic>k</italic>-mer counts, but firstly, we no longer compare every <italic>k</italic>-mer, but rather hash all <italic>k</italic>-mers of a sample into a probabilistic data structure: a sketch [<xref ref-type="bibr" rid="pcbi.1005727.ref026">26</xref>]. The resulting sketches are, in effect, vectors of <italic>k</italic>-mer counts; importantly, the sketches for all samples have a constant size. Secondly, we introduce an information-theoretic weighting to elevate the relevant genetic signal above the noise. Pairwise similarity is then calculated by the inner product between <italic>k</italic>-mer counts, weighted by the information content derived from their frequencies across the population. Our procedure is implemented in a software tool (<monospace>kWIP</monospace>) that calculates our metric, the <italic>k</italic>-mer Weighted Inner Product, directly from sequencing reads. We show by simulations and by re-analysing published datasets, that <monospace>kWIP</monospace> can quickly, and accurately detect genetic relatedness between samples.</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Design and implementation</title>
<p>
<monospace>kWIP</monospace> operates on files containing sequencing reads generated by common modern sequencing platforms (e.g., Illumina). First, <monospace>kWIP</monospace> utilises <monospace>khmer</monospace> [<xref ref-type="bibr" rid="pcbi.1005727.ref027">27</xref>, <xref ref-type="bibr" rid="pcbi.1005727.ref028">28</xref>] to count overlapping words of length <italic>k</italic> (<italic>k</italic>-mers) into a probabilistic data structure, a sketch, for each sample. In order to establish the weights <monospace>kWIP</monospace> then counts presence/absence of each <italic>k</italic>-mer across all sample sketches and records this population occurrence frequency in a frequency sketch (<italic>F</italic>). We calculate similarity (<italic>K</italic>) as the inner product between each pair of sample sketches, weighted by the Shannon entropy (<italic>H</italic>) of the respective frequency (<italic>F</italic>). The concept is illustrated in <xref ref-type="fig" rid="pcbi.1005727.g001">Fig 1</xref>.</p>
<fig id="pcbi.1005727.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005727.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Overview of the weighted inner product metric as implemented in <monospace>kWIP</monospace>.</title>
<p>(A) <italic>k</italic>-mers are counted into sketches (using <monospace>khmer</monospace> [<xref ref-type="bibr" rid="pcbi.1005727.ref028">28</xref>]). Columns represent the “bins” in each sketch. The frequencies of non-zero counts across a set of sketches is computed, forming the population frequency sketch (denoted <italic>F</italic>). We calculate Shannon entropy of this frequency sketch as the weight vector for the WIP metric (denoted <italic>H</italic>, see <xref ref-type="disp-formula" rid="pcbi.1005727.e009">Eq 2</xref>). (B) Illustration of Shannon Entropy as used in <monospace>kWIP</monospace>: the relationship between the population frequency (<italic>F</italic>) and the weight (<italic>H</italic>).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005727.g001" xlink:type="simple"/>
</fig>
<sec id="sec003">
<title><italic>k</italic>-mer counting</title>
<p>For each sample, <monospace>kWIP</monospace> uses <monospace>khmer</monospace> to decompose sequencing reads into overlapping words of some fixed length k, e.g., 20. The value of a reversible hash function is computed for each <italic>k</italic>-mer. <italic>k</italic>-mers are canonicalised by using the lexicographically smaller of a <italic>k</italic>-mer and its reverse complement. <italic>k</italic>-mers are counted using one sketch per sample. These sketches are vectors with prime number length, typically several billion elements in size (denoted <italic>S</italic><sub><italic>i</italic></sub> for sample <italic>i</italic>). The elements of these sketches are referred to as bins (indexed by <italic>b</italic>, e.g. <inline-formula id="pcbi.1005727.e005"><alternatives><graphic id="pcbi.1005727.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005727.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:msub><mml:mi>S</mml:mi> <mml:msub><mml:mi>i</mml:mi> <mml:mi>b</mml:mi></mml:msub></mml:msub></mml:math></alternatives></inline-formula>), and can store values between 0 and 255 (integer overflow is prevented). To count a <italic>k</italic>-mer, the <italic>b</italic>-th bin of the sketch (<inline-formula id="pcbi.1005727.e006"><alternatives><graphic id="pcbi.1005727.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005727.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:msub><mml:mi>S</mml:mi> <mml:msub><mml:mi>i</mml:mi> <mml:mi>b</mml:mi></mml:msub></mml:msub></mml:math></alternatives></inline-formula>) is incremented, where <italic>b</italic> is the hash value of the <italic>k</italic>-mer modulo the (prime) length of the sketch. For most use cases, <italic>k</italic>-mers between 19 and 21 bases long should achieve a good balance between specificity and sensitivity across genomes and genomic regions [<xref ref-type="bibr" rid="pcbi.1005727.ref029">29</xref>]. Note that the possible number of <italic>k</italic>-mers (4<sup>k</sup>) is much larger than the length of a sketch. Therefore, aliasing (or “collisions”) between <italic>k</italic>-mers can occur, but in practice can be avoided with appropriate parameter selection [<xref ref-type="bibr" rid="pcbi.1005727.ref027">27</xref>]. It is worth noting that aliasing can only increase similarity between any two samples and should occur uniformly across all sample pairs.</p>
</sec>
<sec id="sec004">
<title>Weighting and similarity estimation</title>
<p>Genetic similarity is estimated by calculating the inner product between each pair of sample sketches (<italic>S</italic><sub><italic>i</italic></sub>, <italic>S</italic><sub><italic>j</italic></sub>), weighted by the informational content of each bin. The population frequency sketch (<italic>F</italic>) contains the frequency of occurrence for each bin, calculated as the proportion of samples with a non-zero count for each bin. We calculate a weight vector (<italic>H</italic>) of these occurrence frequencies using Shannon entropy as per <xref ref-type="disp-formula" rid="pcbi.1005727.e008">Eq (1)</xref>. In the Weighted Inner Product (WIP) metric (or kernel), pairwise similarities are then calculated as the inner product over every pair of sample sketches, weighted by <italic>H</italic> as per <xref ref-type="disp-formula" rid="pcbi.1005727.e009">Eq (2)</xref>. The unweighted Inner Product (IP) metric is simply the inner product between the two sketch vectors, <inline-formula id="pcbi.1005727.e007"><alternatives><graphic id="pcbi.1005727.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005727.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:mrow><mml:msubsup><mml:mi>S</mml:mi> <mml:mi>i</mml:mi> <mml:mi>T</mml:mi></mml:msubsup> <mml:msub><mml:mi>S</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, without weighting. This produces a matrix of pairwise inner products <italic>K</italic>, commonly referred to as a kernel matrix. The kernel matrix is then normalised using the Euclidean norm <xref ref-type="disp-formula" rid="pcbi.1005727.e010">Eq (3)</xref>, and converted to distances using the “kernel trick” [<xref ref-type="bibr" rid="pcbi.1005727.ref030">30</xref>] as per <xref ref-type="disp-formula" rid="pcbi.1005727.e011">Eq (4)</xref>. To ensure distance matrices are Euclidean, <monospace>kWIP</monospace> confirms that the resulting kernel matrix is positive semi-definite by checking that all eigenvalues are non-negative using the Eigen3 library [<xref ref-type="bibr" rid="pcbi.1005727.ref031">31</xref>].</p>
<p>The distances kWIP produces are relative within the set of samples being compared. This is because the weight vector (<italic>H</italic>) is specific to the set of samples and the similarity estimates are normalised to account for varying sequencing coverage. In other words, the kWIP distance for a given pair of samples will depend on the set of samples within which they are analysed.
<disp-formula id="pcbi.1005727.e008"><alternatives><graphic id="pcbi.1005727.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005727.e008" xlink:type="simple"/><mml:math display="block" id="M8"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>H</mml:mi> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mo>(</mml:mo> <mml:mi>F</mml:mi> <mml:msub><mml:mo form="prefix">log</mml:mo> <mml:mn>2</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>F</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mi>F</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mo form="prefix">log</mml:mo> <mml:mn>2</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mi>F</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula> <disp-formula id="pcbi.1005727.e009"><alternatives><graphic id="pcbi.1005727.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005727.e009" xlink:type="simple"/><mml:math display="block" id="M9"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>K</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>b</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:munderover> <mml:msub><mml:mi>S</mml:mi> <mml:msub><mml:mi>i</mml:mi> <mml:mi>b</mml:mi></mml:msub></mml:msub> <mml:msub><mml:mi>S</mml:mi> <mml:msub><mml:mi>j</mml:mi> <mml:mi>b</mml:mi></mml:msub></mml:msub> <mml:msub><mml:mi>H</mml:mi> <mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2)</label></disp-formula> <disp-formula id="pcbi.1005727.e010"><alternatives><graphic id="pcbi.1005727.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005727.e010" xlink:type="simple"/><mml:math display="block" id="M10"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>K</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup> <mml:mo>=</mml:mo> <mml:mfrac><mml:msub><mml:mi>K</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:msqrt><mml:mrow><mml:msub><mml:mi>K</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>K</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msqrt></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(3)</label></disp-formula> <disp-formula id="pcbi.1005727.e011"><alternatives><graphic id="pcbi.1005727.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005727.e011" xlink:type="simple"/><mml:math display="block" id="M11"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>D</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msqrt><mml:mrow><mml:msubsup><mml:mi>K</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>i</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi>K</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup> <mml:mo>-</mml:mo> <mml:mn>2</mml:mn> <mml:msubsup><mml:mi>K</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:msqrt></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(4)</label></disp-formula></p>
</sec>
<sec id="sec005">
<title>Implementation</title>
<p>Pairwise calculation of genetic distances from <italic>k</italic>-mer count files with both the WIP and IP metrics is implemented in C++ as <monospace>kWIP</monospace>. <monospace>kWIP</monospace> is licensed under the GNU GPL, and source code and pre-compiled executables are available from <ext-link ext-link-type="uri" xlink:href="https://github.com/kdmurray91/kwip" xlink:type="simple">https://github.com/kdmurray91/kwip</ext-link>. Documentation and tutorials are available from <ext-link ext-link-type="uri" xlink:href="https://kwip.readthedocs.io" xlink:type="simple">https://kwip.readthedocs.io</ext-link>. To use <monospace>kWIP</monospace>, one first counts <italic>k</italic>-mers present in each sample using <monospace>khmer</monospace>’s <monospace>load-into-counting.py</monospace> script [<xref ref-type="bibr" rid="pcbi.1005727.ref028">28</xref>]. <monospace>kWIP</monospace> will then estimate similarity from these counts, producing a normalised Euclidean distance matrix and, optionally, the corresponding similarity matrix (kernel matrix). <monospace>kWIP</monospace> parallelises pairwise similarity calculations across cores of a multi-threaded computer to ensure fast operation.</p>
</sec>
</sec>
<sec id="sec006" sec-type="results">
<title>Results</title>
<p>We show that <monospace>kWIP</monospace> is able to accurately determine genetic relatedness in many scenarios. Using a simulated population re-sequencing experiment, we quantify how the population frequency-based weighting applied by <monospace>kWIP</monospace> improves accuracy, that is the correlation with the known truth, when compared to existing approaches, <monospace>mash</monospace> [<xref ref-type="bibr" rid="pcbi.1005727.ref019">19</xref>], and the unweighted metric, IP. We recover known technical and biological relationships between sequencing runs of the 3000 Rice Genomes project [<xref ref-type="bibr" rid="pcbi.1005727.ref032">32</xref>, <xref ref-type="bibr" rid="pcbi.1005727.ref033">33</xref>]. We show that <monospace>kWIP</monospace>’s estimate of genetic relationships between <italic>Chlamydomonas</italic> samples is nearly identical to results obtained by a more traditional, SNP-based analysis employing read mapping and variant calling against a reference genome with the same sequencing data [<xref ref-type="bibr" rid="pcbi.1005727.ref034">34</xref>]. By analysing a dataset on root-associated microbiomes [<xref ref-type="bibr" rid="pcbi.1005727.ref035">35</xref>], we show that our approach of sample clustering by <monospace>kWIP</monospace> can be extended to clustering of metagenome samples.</p>
<sec id="sec007">
<title>Quantification of <monospace>kWIP</monospace> performance</title>
<p>We quantified the performance of <monospace>kWIP</monospace> with simulated population sequencing data. We compare our novel metric, the weighted inner product (WIP), to the unweighted inner product (IP), which we consider equivalent to the <italic>D</italic><sub>2</sub> statistic, and to <monospace>mash</monospace> [<xref ref-type="bibr" rid="pcbi.1005727.ref019">19</xref>]. We simulated 20 populations of 12 individuals with 1 MBp genomes and analysed each with <monospace>kWIP</monospace> and <monospace>mash</monospace> for <italic>k</italic>-mers of k = 20. A summary of the results of these 20 replicate analyses with each of the metrics is shown in <xref ref-type="fig" rid="pcbi.1005727.g002">Fig 2</xref>.</p>
<fig id="pcbi.1005727.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005727.g002</object-id>
<label>Fig 2</label>
<caption>
<title>The effect of (A) mean sequencing depth (genome coverage) and (B) average number of nucleotide differences per site (<italic>π</italic>) on accuracy of genetic similarity estimates in simulations.</title>
<p>We plot mean ± standard deviation of Spearman’s <italic>ρ</italic> comparing each metric to known truth across 20 replicate runs. (A) Mean sequencing depth varies while average number of nucleotide differences per site (<italic>π</italic>) is constant at 0.005. <monospace>kWIP</monospace>: At low to moderate mean sequencing depth (&lt;30x) weighting increases accuracy. The weighted metric (“WIP”) obtains near-optimal accuracy already at 10x and hence much earlier than the unweighted metric “IP”). There is no noticeable decrease in accuracy with increasing coverage. <monospace>mash</monospace>: regardless of error correction, <monospace>mash</monospace> performs less well than WIP. <monospace>mash</monospace> shows accuracy maxima at 4x coverage without (“Mash”) and at 16x coverage with abundance filter (“Mash (AF)”), at which point Mash (AF) performs almost as well as WIP. The accuracy of <monospace>mash</monospace> decreases dramatically when coverage is further increased. (B) Genome coverage is kept constant at 8x and average number of nucleotide differences per site (<italic>π</italic>) varies. While all metrics perform equally at a (<italic>π</italic>) of 1 in 100 (0.01), the performance of IP, Mash and Mash (AF) decreases rapidly as (<italic>π</italic>) between samples decreases. This does not occur for the weighted metric (WIP).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005727.g002" xlink:type="simple"/>
</fig>
<p>Unsurprisingly, for all metrics the accuracy, that is the rank correlation (Spearman’s <italic>ρ</italic>) to known truth, decreases with decreasing genome coverage, i.e., average sample sequencing depth (<xref ref-type="fig" rid="pcbi.1005727.g002">Fig 2A</xref>), as well as with decreasing average number of nucleotide differences per site, <italic>π</italic> (<xref ref-type="fig" rid="pcbi.1005727.g002">Fig 2B</xref>).</p>
<p>Importantly, at low coverages, the weighted metric (“WIP”) performs better than the unweighted (“IP”) (<xref ref-type="fig" rid="pcbi.1005727.g002">Fig 2A</xref>). Above a certain coverage, in the case of our simulations above about 30-fold, the performances of the WIP and IP metrics converge. At a constant genome coverage, the improvement in accuracy of the WIP metric relative to the IP metric increases as mean pairwise genetic variation decreases (<xref ref-type="fig" rid="pcbi.1005727.g002">Fig 2B</xref>). While the accuracy of the IP metric decreases markedly below an average number of nucleotide differences per site (<italic>π</italic>) of approximately 0.01, the WIP metric does not show such decrease.</p>
<p>In order to compare the performance of <monospace>kWIP</monospace> relative to Mash [<xref ref-type="bibr" rid="pcbi.1005727.ref019">19</xref>] we conducted two analyses with <monospace>mash</monospace>: one with abundance filtering enabled to remove singleton <italic>k</italic>-mers (“Mash AF”) and one without (“Mash“). Within the scope of our simulations <monospace>kWIP</monospace> yields more accurate results than <monospace>mash</monospace> when sequencing coverage and/or sequence divergence is low; a typical scenario in large-scale, population genetic analyses within species. Through the entire range of simulation parameters, <monospace>kWIP</monospace> never yields results less accurate than <monospace>mash</monospace>, irrespective of abundance filtering (<xref ref-type="fig" rid="pcbi.1005727.g002">Fig 2</xref>). It is interesting to note that <monospace>mash</monospace> appears to exhibit characteristic accuracy maxima, and accuracy decreases dramatically when mean sequencing depth is further increased. In addition, abundance filtering seems to have a strong, genome coverage-dependent effect on the accuracy of <monospace>mash</monospace> (<xref ref-type="fig" rid="pcbi.1005727.g002">Fig 2A</xref>). With the chosen parameter settings, <monospace>mash</monospace> runs much faster than <monospace>kWIP</monospace> (about 10-fold faster; see performance comparisons in <xref ref-type="table" rid="pcbi.1005727.t001">Table 1</xref>).</p>
<table-wrap id="pcbi.1005727.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005727.t001</object-id>
<label>Table 1</label>
<caption>
<title>Computational performance of <monospace>kWIP</monospace>.</title>
</caption>
<alternatives>
<graphic id="pcbi.1005727.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005727.t001" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left" rowspan="2">Dataset</th>
<th align="center" colspan="3">Dataset Size</th>
<th align="center" colspan="3">Distance Calculation Time (s)</th>
</tr>
<tr>
<th align="center">Samples</th>
<th align="center">Reads</th>
<th align="center"><italic>k</italic>-mers</th>
<th align="center">Mash</th>
<th align="center">WIP</th>
<th align="center">IP</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Simulation (8x)</td>
<td align="center">36</td>
<td align="center">7.9e4 ± 2.4e3</td>
<td align="center">1.3e6 ± 1.3e5</td>
<td align="center">6 ± 1</td>
<td align="center">45 ± 3</td>
<td align="center">40 ± 4</td>
</tr>
<tr>
<td align="left">Simulation (32x)</td>
<td align="center">36</td>
<td align="center">3.2e5 ± 1.0e4</td>
<td align="center">2.3e6 ± 3.8e5</td>
<td align="center">5 ± 1</td>
<td align="center">53 ± 3</td>
<td align="center">46 ± 5</td>
</tr>
<tr>
<td align="left">Rice Replicates</td>
<td align="center">96</td>
<td align="center">9.7e6 ± 1.5e6</td>
<td align="center">1.8e8 ± 1.5e7</td>
<td align="center">-</td>
<td align="center">2241 ± 139</td>
<td align="center">1892 ± 286</td>
</tr>
<tr>
<td align="left">Chlamydomonas</td>
<td align="center">20</td>
<td align="center">2.0e8 ± 2.4e7</td>
<td align="center">1.4e8 ± 1.4e7</td>
<td align="center">-</td>
<td align="center">127</td>
<td align="center">194</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t001fn001">
<p>Measurements of calculation time are in wall-clock seconds on a 16-core, 64GB GNU/Linux server. Figures are means ± standard deviations. For simulations, these are over the 20 replicate runs performed. For rice replicate clustering, these are over 10 of the 100 independent sets of 96 rice samples. For Chlamydomonas, times are for the full dataset. The sketch sizes used were 10<sup>9</sup> bins for <monospace>kWIP</monospace>/khmer, and 10<sup>4</sup> for Mash. Note that <italic>k</italic>-mers refers to the number of distinct <italic>k</italic>-mers as estimated by khmer.</p>
</fn>
</table-wrap-foot>
</table-wrap>
<p>In analyses with <monospace>kWIP</monospace> we find that the coefficient of variation between the number of sequencing reads per sample matters. For samples with much lower mean sequencing depth than the average, <monospace>kWIP</monospace> has difficulty to accurately determine its relatedness to other samples. We therefore advise to exclude such samples from <monospace>kWIP</monospace> analyses or sub-sample reads from the remainder, if the dataset allows. <monospace>khmer</monospace> provides procedures for “digital normalisation”, which can be used upstream of <monospace>kWIP</monospace> to that effect [<xref ref-type="bibr" rid="pcbi.1005727.ref036">36</xref>]. Our simulations suggest that variations in genome coverage between samples will also affect the results obtained with <monospace>mash</monospace>.</p>
</sec>
<sec id="sec008">
<title>Replicate clustering</title>
<p>
<monospace>kWIP</monospace> can efficiently verify replicates. <xref ref-type="fig" rid="pcbi.1005727.g003">Fig 3A and 3B</xref> show a representative example of replicate clustering. The weighted metric (WIP) is able to accurately cluster replicates (<xref ref-type="fig" rid="pcbi.1005727.g003">Fig 3A</xref>), whereas the unweighted metric (IP) makes mistakes, as highlighted in red in <xref ref-type="fig" rid="pcbi.1005727.g003">Fig 3B</xref>. We quantified this difference in performance and <xref ref-type="fig" rid="pcbi.1005727.g003">Fig 3C</xref> shows the distribution of rank correlation coefficients between distances obtained with the WIP and IP metrics and the expected clustering patterns for 100 sets of 96 sequencing runs. The WIP metric outperforms the IP metric, having a significant higher mean correlation (paired Student’s T test, <italic>n</italic> = 84, <italic>t</italic> = 9.63, <italic>df</italic> = 83, <italic>p</italic> = 3.6 × 10<sup>−15</sup>).</p>
<fig id="pcbi.1005727.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005727.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Weighting improves the accuracy of replicate clustering.</title>
<p>(A) and (B) show a representative example, demonstrating that (A) the weighted metric (WIP) correctly clusters all sets of 6 replicate runs into their respective samples (indicated by blue and green bars) while (B) the unweighted metric (IP) fails to cluster several replicates correctly (indicated by red highlighting). (C) rank correlation coefficients to expected relationships over 100 sets of 96 rice runs for the WIP and IP metrics. The Weighted metric tends to cluster the replicates better.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005727.g003" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec009">
<title>Population structure</title>
<p>Flowers, et al. [<xref ref-type="bibr" rid="pcbi.1005727.ref034">34</xref>] sequenced 20 strains of <italic>Chlamydomonas reinhardtii</italic>; laboratory strains and wild accessions sourced from across the continental USA. By alignment- and SNP-based analysis, they find significant population structure that is mostly explained by geography [<xref ref-type="bibr" rid="pcbi.1005727.ref034">34</xref>]. In <xref ref-type="fig" rid="pcbi.1005727.g004">Fig 4B</xref> we display the published genetic relationships as a principal component analysis (PCA) of SNP genotypes calculated with SNPRelate [<xref ref-type="bibr" rid="pcbi.1005727.ref037">37</xref>] exactly as presented by the authors [<xref ref-type="bibr" rid="pcbi.1005727.ref034">34</xref>]. PC1 separates the laboratory strains (and one western sample) from both eastern and western samples with further structure among wild <italic>Chlamydomonas</italic> accession collected in western, southeastern and northeastern USA. In <xref ref-type="fig" rid="pcbi.1005727.g004">Fig 4A</xref> we plot the relatedness between the strains as revealed directly from the raw sequencing reads with <monospace>kWIP</monospace>. We note that the results are highly similar; the rank correlation between <monospace>kWIP</monospace> distances and genome average identity-by-state (calculated with SNPRelate [<xref ref-type="bibr" rid="pcbi.1005727.ref037">37</xref>]) is 0.95.</p>
<fig id="pcbi.1005727.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005727.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Genetic relatedness between <italic>Chlamydomonas reinhardtii</italic> strains based on sequencing data from [<xref ref-type="bibr" rid="pcbi.1005727.ref034">34</xref>].</title>
<p>SNPrelate [<xref ref-type="bibr" rid="pcbi.1005727.ref037">37</xref>] was used to compute the PCA decomposition directly from SNP genotypes provided by the authors. This replicates the analysis of [<xref ref-type="bibr" rid="pcbi.1005727.ref034">34</xref>] and is displayed on the right. On the left, we show the results of MDS performed on the distance matrix obtained with <monospace>kWIP</monospace>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005727.g004" xlink:type="simple"/>
</fig>
<p>Each of the 20 strains had been sequenced to a depth of roughly 200-fold genome coverage [<xref ref-type="bibr" rid="pcbi.1005727.ref034">34</xref>]. By systematically sub-sampling this dataset we investigated the effect of coverage on the accuracy of <monospace>kWIP</monospace>’s similarity estimation. We find that with decreasing coverage the accuracy of the relationship estimations decreases (<xref ref-type="fig" rid="pcbi.1005727.g005">Fig 5A</xref>). We illustrate this decay by PCA plots of estimated genetic relatedness at varying coverages (<xref ref-type="fig" rid="pcbi.1005727.g005">Fig 5B</xref>). We note that the performance of <monospace>kWIP</monospace> to determine similarity is very good even at low coverages. A two-fold genome coverage is enough to detect the major splits in this dataset (Laboratory vs West vs East).</p>
<fig id="pcbi.1005727.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005727.g005</object-id>
<label>Fig 5</label>
<caption>
<title>The effect of mean sequencing depth (genome coverage) on <monospace>kWIP</monospace>’s estimate of genetic relatedness between samples of <italic>Chlamydomonas reinhardtii</italic> (data from [<xref ref-type="bibr" rid="pcbi.1005727.ref034">34</xref>]).</title>
<p>(A) Spearman’s rank correlation between sub-sampled datasets and the full dataset across a range of subset average genome coverages. (B) PCA plots of relatedness obtained using <monospace>kWIP</monospace> on selected sub-sampled datasets. “full” refers to the entire dataset (i.e., <xref ref-type="fig" rid="pcbi.1005727.g004">Fig 4</xref>), while “0.1x” refers to a sub-sampled dataset with average mean sequencing depth of 0.1 over the <italic>C. reinhardtii</italic> genome (likewise for 1x, 2x, and so on).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005727.g005" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec010">
<title>Metagenome relatedness</title>
<p>Edwards, <italic>et al.</italic> [<xref ref-type="bibr" rid="pcbi.1005727.ref035">35</xref>] sequenced 16S rDNA amplicons from rice root-associated microbiomes and find stratification of samples by rhizo-compartment, cultivation site, and cultivation practice. Analysing their raw sequencing data with <monospace>kWIP</monospace>, we detect highly similar stratification between microbial communities. An example is shown in <xref ref-type="fig" rid="pcbi.1005727.g006">Fig 6</xref>. We observe a gradient of samples from within the root, through the root-soil interface into soil, and separation by cultivation site. This replicates the separation of samples by rhizo-compartment and cultivation site published by Edwards, et al. [<xref ref-type="bibr" rid="pcbi.1005727.ref035">35</xref>], shown in <xref ref-type="fig" rid="pcbi.1005727.g006">Fig 6</xref>.</p>
<fig id="pcbi.1005727.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005727.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Estimation of similarity between metagenome samples.</title>
<p>We used <monospace>kWIP</monospace> to examine 16S rDNA amplicon sequencing data of Edwards, <italic>et al.</italic> [<xref ref-type="bibr" rid="pcbi.1005727.ref035">35</xref>] and compare our <monospace>kWIP</monospace> result (“kWIP”) with the results as presented by Edwards, <italic>et al.</italic> (“Weighted UniFrac” and “UniFrac”). We find that <monospace>kWIP</monospace> replicates their observations of stratification of root-associated microbiomes by rhizo-compartment (PC1) and experiment site (PC2).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005727.g006" xlink:type="simple"/>
</fig>
</sec>
</sec>
<sec id="sec011" sec-type="conclusions">
<title>Discussion</title>
<p>The <italic>k</italic>-mer Weighted Inner Product (<monospace>kWIP</monospace>) estimates genetic distances between samples within a population of samples directly from next generation sequencing data. <monospace>kWIP</monospace> does not require a reference genome sequence and is able to estimate the genetic distances between samples with less data than is typically used to call SNPs against a reference. As a <italic>k</italic>-mer-based method, <monospace>kWIP</monospace> is sequencing protocol and platform agnostic, allowing use into the future.</p>
<p>
<monospace>kWIP</monospace> uses a new metric, the weighted inner product (WIP), which aims to reduce the effect of technical and biological noise and elevate the relevant genetic signal by weighting <italic>k</italic>-mer counts by their informational entropy across the analysis set. This weighting has the effect of down-weighting <italic>k</italic>-mers that are either highly abundant or present in very few samples. Those <italic>k</italic>-mers are typically uninformative, because they are either common, fixed, repetitive, invariable, or rare, or erroneous. By using Shannon entropy, the weights of common and infrequent <italic>k</italic>-mers are assigned lower, but non-zero weights, allowing them to contribute to the signal.</p>
<p>Euclidean distances are then calculated from these weighted inner products and <monospace>kWIP</monospace> outputs a matrix of pairwise distances between samples, which are easily visualised and may be used for sample classification and to cluster samples into groups. These distance matrices are amenable to quantitative comparison of genetic distance to geographic or environmental distances, for example using mantel tests or generalised dissimilarity modelling. We show high concordance between PCAs obtained using SNP data and those using <monospace>kWIP</monospace>. It is possible that population genetic statistics, including <italic>F</italic><sub><italic>ST</italic></sub>, could be recovered using <monospace>kWIP</monospace> via a genealogical interpretation of PCA, as is proposed and shown possible for SNP datasets [<xref ref-type="bibr" rid="pcbi.1005727.ref038">38</xref>].</p>
<p>We have demonstrated the applicability and effectiveness of <monospace>kWIP</monospace> using simulations and several published datasets. Through simulations, we quantify how the novel weighting improves accuracy over both the unweighted inner product and Mash, specifically in cases where genetic differentiation or sequencing depth is low (<xref ref-type="fig" rid="pcbi.1005727.g002">Fig 2</xref>). With data from the 3000 rice genome dataset [<xref ref-type="bibr" rid="pcbi.1005727.ref033">33</xref>], we reconstruct known relationships between samples and sequencing runs, such as membership of samples to major genetic groups of <italic>Oryza sativa</italic>, and the correct clustering of replicates (<xref ref-type="fig" rid="pcbi.1005727.g003">Fig 3</xref>).</p>
<p>From sequencing reads of a population re-sequencing experiment in <italic>Chlamydomonas</italic> [<xref ref-type="bibr" rid="pcbi.1005727.ref034">34</xref>] we precisely recreate their visualisation of population relatedness (<xref ref-type="fig" rid="pcbi.1005727.g004">Fig 4</xref>). This dataset suited for comparison because Flowers, <italic>et al.</italic>, had based their analysis not only on variants recovered by read alignment to the reference genome, but attempted to recover and use additional variation by assembling leftover reads that did not match the reference into contigs and calling additional variants between these contigs. This approach, while reducing reference-genome bias, required extensive sequencing depth to enable de-novo assembly; the authors chose around 200-fold coverage, which in turn enabled us to assess <monospace>kWIP</monospace>’s performance at various sequencing depths (<xref ref-type="fig" rid="pcbi.1005727.g005">Fig 5</xref>).</p>
<p>Efficient characterisation of complex metagenome samples has traditionally relied on methods of reduced representation. We show that <monospace>kWIP</monospace> is able to detect structure between microbial communities based on 16S rDNA amplicon sequencing data, at least as well as current practice (<xref ref-type="fig" rid="pcbi.1005727.g006">Fig 6</xref>). It should be possible to apply <monospace>kWIP</monospace> to random shotgun sequencing data from such samples. Also, estimates of complexity and diversity within and between metagenomes are currently mostly gene based, but could also be made efficiently at the <italic>k</italic>-mer-level leveraging sketched data structures.</p>
<p>The key innovation of <monospace>kWIP</monospace> is the combination of a fixed-sized, probabilistic data structure (sketch) for counting <italic>k</italic>-mers with an entropy-weighted inner product as a measure of similarity between samples. By virtue of their fixed size, sketches enable rapid arithmetic operations on <italic>k</italic>-mer counts. Sketches enable <monospace>kWIP</monospace> to rapidly aggregate across a populations to derive weights, and to efficiently compute the inner products. These benefits outweigh the possibility of collisions between <italic>k</italic>-mers, which in any case have been observed to be rare [<xref ref-type="bibr" rid="pcbi.1005727.ref027">27</xref>] given appropriate sketch size. Sketching data structures are commonly used for <italic>k</italic>-mer counting (for example Count-Min Sketches [<xref ref-type="bibr" rid="pcbi.1005727.ref027">27</xref>, <xref ref-type="bibr" rid="pcbi.1005727.ref028">28</xref>], and Bloom Filters [<xref ref-type="bibr" rid="pcbi.1005727.ref039">39</xref>]), but have not been widely adopted in alignment-free sequence comparison.</p>
<p>Weighting of inner products between sketches allows us to account for non-uniform information content of each <italic>k</italic>-mer. <monospace>kWIP</monospace> weights by Shannon entropy of presence/absence frequency across a population. This provides an assumption-free estimate of the information content of each <italic>k</italic>-mer. By down-weighting both rare <italic>k</italic>-mers introduced by rare variants or sequencing errors, as well as <italic>k</italic>-mers present in most or all samples, we are reducing the contribution of <italic>k</italic>-mers that carry less information. It is possible that other weighting functions that assume various population parameters could provide a more faithful estimate of the information content of each <italic>k</italic>-mer. The application of word-specific weighting has precedence in text processing, where it has been used to account for varying importance of words in a document [<xref ref-type="bibr" rid="pcbi.1005727.ref040">40</xref>]. However, because we intend <monospace>kWIP</monospace> to be used in situations where such parameters are either unavailable or potentially inaccurate, we prefer that our weighting is free of assumptions.</p>
<p>An inner product between <italic>k</italic>-mer counts has long been used to detect and measure sequence similarity, and is referred to as the <italic>D</italic><sub>2</sub> statistic. There have been many derivatives of the <italic>D</italic><sub>2</sub> statistic that seek to enhance its accuracy in recreating evolutionary histories (e.g., <inline-formula id="pcbi.1005727.e012"><alternatives><graphic id="pcbi.1005727.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005727.e012" xlink:type="simple"/><mml:math display="inline" id="M12"><mml:msubsup><mml:mi>D</mml:mi> <mml:mn>2</mml:mn> <mml:mi>S</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>, and <inline-formula id="pcbi.1005727.e013"><alternatives><graphic id="pcbi.1005727.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005727.e013" xlink:type="simple"/><mml:math display="inline" id="M13"><mml:msubsup><mml:mi>D</mml:mi> <mml:mn>2</mml:mn> <mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> [<xref ref-type="bibr" rid="pcbi.1005727.ref020">20</xref>–<xref ref-type="bibr" rid="pcbi.1005727.ref022">22</xref>]). <monospace>kWIP</monospace> does not attempt to re-create evolutionary histories, but rather estimates the similarity of genetic material as it exists today. This is sufficient and even desirable for many of <monospace>kWIP</monospace>’s intended uses. When validating experimental metadata, one seeks to establish whether similarity between sequencing runs matches expectations. Particularly for metagenome samples, where variation can be in both abundance and type of organisms, estimating present variation between sample genome sequences is of importance, separate to how this variation came to be.</p>
<p>
<monospace>kWIP</monospace> estimates genetic similarity between sequencing runs. Because <monospace>kWIP</monospace> operates reference- and alignment-free, all genetic material present in the sample, the “hologenome”, will contribute to the analysis. However, we note that <italic>k</italic>-mers that are considered undesirable and chosen to be excluded from the analysis could easily be masked, for example by setting their weight in the weight vector to zero.</p>
<p>Because <monospace>kWIP</monospace> weights <italic>k</italic>-mers, and hence genome content, based on their frequency in the population being analysed, these weights change when the population changes. This allows for iterative workflows: in a first, all inclusive step the large groupings and outliers are detected; subsequently, subgroups can be analysed with increased resolution.</p>
<p>
<monospace>kWIP</monospace> is purposefully designed to operate free of assumptions or prior knowledge. It is comparing data as presented in the sequencing reads without attempting to reconstruct or approximate the underlying genomes. One could think of several ways of incorporating additional knowledge, which may improve <monospace>kWIP</monospace>’s power to determine relatedness between underlying genomes. One could, for example, apply smoothing to the <italic>k</italic>-mer counts, with the goal of differentiating between <italic>k</italic>-mers that are genuinely not in the genomes of a sample and those that were not observed due to low coverage and/or stochastic sampling; smoothing is used in natural language modelling [<xref ref-type="bibr" rid="pcbi.1005727.ref041">41</xref>].</p>
<p>It is possible that alternative distance functions (e.g., Manhattan distance) over weighted sketches could improve the performance of <monospace>kWIP</monospace>, which currently uses Euclidean distance. Distance measures defined on presence/absence of items, such as the Jaccard index or the Jaccard index-based measures used by AAF [<xref ref-type="bibr" rid="pcbi.1005727.ref018">18</xref>] and <monospace>mash</monospace> [<xref ref-type="bibr" rid="pcbi.1005727.ref019">19</xref>], could also be calculated from our sketches. It may further prove valuable to explore spaced seeds [<xref ref-type="bibr" rid="pcbi.1005727.ref013">13</xref>, <xref ref-type="bibr" rid="pcbi.1005727.ref016">16</xref>], or alternative metrics including those considering inexact matches [<xref ref-type="bibr" rid="pcbi.1005727.ref042">42</xref>, <xref ref-type="bibr" rid="pcbi.1005727.ref043">43</xref>].</p>
<p>Methods that enable rapid verification of genetic resources, such as stock centre accessions or cell lines, prevent expensive and possibly catastrophic mis-identifications. Such classification tasks only require comparison with a set of reference samples rather than computing distances between all samples. Inner product kernels have been used to classify protein sequences [<xref ref-type="bibr" rid="pcbi.1005727.ref043">43</xref>, <xref ref-type="bibr" rid="pcbi.1005727.ref044">44</xref>] and <monospace>kWIP</monospace> could be adapted to sample classification with tree-like structures of kernels [<xref ref-type="bibr" rid="pcbi.1005727.ref042">42</xref>] or sketches [<xref ref-type="bibr" rid="pcbi.1005727.ref045">45</xref>, <xref ref-type="bibr" rid="pcbi.1005727.ref046">46</xref>].</p>
<p>Estimating the genetic relatedness between a broad collection of natural accessions provides a basis for ecological or functional studies and should be a first step towards solutions in breeding and conservation. In most population level experiments, technical sources of error are dwarfed by the error from insufficient sampling [<xref ref-type="bibr" rid="pcbi.1005727.ref047">47</xref>]. This is especially true when rare or cryptic lineages are present, and in conditions of non-random mating where population structure is substantial. Such population level noise can only be overcome by broad studies with large numbers of samples, ideally by also merging experiments [<xref ref-type="bibr" rid="pcbi.1005727.ref048">48</xref>]. When individuals from real-world populations are collected, or collated, there is normally non-uniform genetic relatedness. Initially, one seeks to group samples into more closely related families or more distantly related populations, to then develop sets for further detailed studies. Genetic outliers can represent mis-identifications and cryptic species and should be detected and excluded. <italic>De novo</italic> sample groupings based on whole genome relatedness also inform the selection of suitable reference individuals and/or building the necessary reference genome sequences. The initial characterisation process must avoid biases and have minimal per sample cost. The use of <monospace>kWIP</monospace> allows one to base the analysis of diversity among samples on low coverage, whole-genome sequence data and thus facilitates large, balanced study designs. More broadly, experiments are condemned to be inconclusive and irreproducible if samples are somehow mislabelled or misidentified. An initial step in all analyses of genetic or functional variation must involve the verification of sample identity [<xref ref-type="bibr" rid="pcbi.1005727.ref006">6</xref>]. This preliminary analysis should preferably use whole-genome sequence data, be <italic>de novo</italic>, unbiased, and agnostic to sequencing protocol and technology. <monospace>kWIP</monospace> is an efficient implementation of such a tool.</p>
<sec id="sec012">
<title>Availability and future directions</title>
<p>
<monospace>kWIP</monospace> is implemented in C++ and licensed under the GNU GPL. Source code and pre-compiled executables are available from <ext-link ext-link-type="uri" xlink:href="https://github.com/kdmurray91/kwip" xlink:type="simple">https://github.com/kdmurray91/kwip</ext-link>. Documentation and tutorials are available from <ext-link ext-link-type="uri" xlink:href="https://kwip.readthedocs.io" xlink:type="simple">https://kwip.readthedocs.io</ext-link>. Docker images, Snakemake workflows and Jupyter notebooks used to perform all analyses presented here are available online at <ext-link ext-link-type="uri" xlink:href="https://github.com/kdmurray91/kwip-experiments" xlink:type="simple">https://github.com/kdmurray91/kwip-experiments</ext-link>; the respective software versions are noted within the repository. When given a population of samples, <monospace>kWIP</monospace> performs all pairwise comparisons, which scales quadratically with regards to the number of samples (<inline-formula id="pcbi.1005727.e014"><alternatives><graphic id="pcbi.1005727.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005727.e014" xlink:type="simple"/><mml:math display="inline" id="M14"><mml:mrow><mml:mi mathvariant="script">O</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mi>n</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>), but parallelises pairwise similarity calculations across cores of a multi-threaded computer to ensure fast operation. Analyses of very large data sets, i.e., beyond 10,000s of samples, will benefit from further optimisation to the implementation of <monospace>kWIP</monospace>, including parallelisation across distributed memory systems with MPI. For each pairwise comparison, the two sketches and the weight vector must fit in main memory. This limits the size of the sketches and the number of pairwise comparisons that will run efficiently in parallel on a given node.</p>
</sec>
</sec>
<sec id="sec013" sec-type="materials|methods">
<title>Materials and methods</title>
<p>We demonstrate <monospace>kWIP</monospace>’s performance with both real and simulated datasets. With simulations we quantify the performance of <monospace>kWIP</monospace>. To demonstrate the utility of <monospace>kWIP</monospace> in real-world, low-coverage, large-scale population genomics datasets, we analyse data from the 3000 Rice Genomes Project [<xref ref-type="bibr" rid="pcbi.1005727.ref032">32</xref>, <xref ref-type="bibr" rid="pcbi.1005727.ref033">33</xref>]. To show that <monospace>kWIP</monospace> estimates genetic similarity as well as current best practice SNP-based methods, we re-analysed a population genomics study on 20 strains of <italic>Chlamydomonas reinhardtii</italic> [<xref ref-type="bibr" rid="pcbi.1005727.ref034">34</xref>] with <monospace>kWIP</monospace> and compare our result to the published results. Lastly, using data from a study on root-associated microbiomes of rice [<xref ref-type="bibr" rid="pcbi.1005727.ref035">35</xref>], we show that <monospace>kWIP</monospace> is able to separate microbial communities from 16S rDNA amplicon data at least as well as current best-practice methods in metagenomics.</p>
<p>We provide all information necessary to reproduce our work: the <monospace>kWIP</monospace> analyses performed here are implemented in Snakemake workflows [<xref ref-type="bibr" rid="pcbi.1005727.ref049">49</xref>], which describe all steps and software parameters; random seeds have been fixed where necessary. All downstream analyses are available as Jupyter notebooks [<xref ref-type="bibr" rid="pcbi.1005727.ref050">50</xref>, <xref ref-type="bibr" rid="pcbi.1005727.ref051">51</xref>]. Both the Snakemake workflows and Jupyter notebooks are available online at <ext-link ext-link-type="uri" xlink:href="https://github.com/kdmurray91/kwip-experiments" xlink:type="simple">https://github.com/kdmurray91/kwip-experiments</ext-link>; the respective software versions are noted within this repository.</p>
<sec id="sec014">
<title>Simulations</title>
<p>We simulated several datasets to empirically quantify the performance of <monospace>kWIP</monospace>. Twenty populations with 12 individuals each were simulated using <monospace>scrm</monospace> [<xref ref-type="bibr" rid="pcbi.1005727.ref052">52</xref>]. Branch lengths within each population were normalised such that the mean pairwise genetic distance (<italic>π</italic>) was equal. Branch lengths were then scaled over a range of <italic>π</italic> (between 0.001 and 0.2) to test the effect of mean pairwise genetic distance on accuracy. Genome sequences of 1 Mbp genomes were simulated with DAWG2 [<xref ref-type="bibr" rid="pcbi.1005727.ref053">53</xref>] and from those short read data for three replicate sequencing runs per individual were generated at various mean coverages (between 1- and 128-fold) using Mason2 [<xref ref-type="bibr" rid="pcbi.1005727.ref054">54</xref>]. We attempted to emulate the reality of sequencing experiments by introducing random variation in read numbers between replicate runs (coefficient of variation of 0.3). These simulated sequencing runs were then used to estimate genetic similarity with <monospace>kWIP</monospace> and <monospace>mash</monospace> [<xref ref-type="bibr" rid="pcbi.1005727.ref019">19</xref>]. For analysis with <monospace>kWIP</monospace> we used <monospace>khmer</monospace> to hash <italic>k</italic>-mers of length 20 into sketches with 10<sup>7</sup> bins. We estimated genetic similarity with <monospace>kWIP</monospace>, using the weighted (“WIP”) and unweighted (“IP”) metrics. On the same data we performed two analyses with Mash, counting 20-mers into sketches of size 10<sup>4</sup>. For one analysis, we invoked the abundance filter within <monospace>mash sketch</monospace> such that only <italic>k</italic>-mers observed at least twice were considered (“Mash (AF)”), whereas the other analysis considered all <italic>k</italic>-mers regardless of abundance (“Mash”).</p>
<p>The performance of our metrics was measured relative to the true pairwise distances between the simulated samples. The true distance matrix between samples was calculated from the simulated, aligned sample genomes (which DAWG2 produces) with <monospace>scikit-bio</monospace>. Sample-wise distances were replicated three times to allow comparison to the distances obtained from the three simulated sequencing runs. Performance was calculated as Spearman’s rank correlation (<italic>ρ</italic>) between all pairwise distances using <monospace>scipy</monospace> [<xref ref-type="bibr" rid="pcbi.1005727.ref055">55</xref>].</p>
</sec>
<sec id="sec015">
<title>Datasets</title>
<p>With several published datasets we demonstrate the performance and utility of <monospace>kWIP</monospace> in real-world scenarios. In all cases, sequence data files for sequencing runs were obtained from the NCBI Short Read Archive using <monospace>sra-py</monospace> [<xref ref-type="bibr" rid="pcbi.1005727.ref056">56</xref>]. Reads were extracted using the SRA toolkit to FASTQ files. Low base quality regions were removed using sickle [<xref ref-type="bibr" rid="pcbi.1005727.ref057">57</xref>] in single-end mode. Counting of <italic>k</italic>-mers into count files (sketches) was performed using the <monospace>load-into-counting.py</monospace> script of <monospace>khmer</monospace>. Genetic similarity was estimated using <monospace>kWIP</monospace>, with the WIP and IP metrics.</p>
<p>To assess how well <monospace>kWIP</monospace> recovers replicate samples and known sample hierarchies at low sequencing coverage, we turned to publicly available sequence data from the 3000 Rice Genomes project [<xref ref-type="bibr" rid="pcbi.1005727.ref032">32</xref>, <xref ref-type="bibr" rid="pcbi.1005727.ref033">33</xref>]. Samples of the 3000 Rice Genomes project had been sequenced on the Illumina HiSeq2000 platform with technical replicates of individual sequencing libraries split between 6 or more sequencing lanes [<xref ref-type="bibr" rid="pcbi.1005727.ref032">32</xref>, <xref ref-type="bibr" rid="pcbi.1005727.ref033">33</xref>]. Furthermore, there is a rather strong subdivision of rice (<italic>Oryza sativa</italic>) into subgroups. We compiled 100 sets of 96 runs, i.e., for each set we chose 16 samples with 6 replicate runs. We ensured that 8 samples each were described by [<xref ref-type="bibr" rid="pcbi.1005727.ref032">32</xref>] as belonging to the Indica and Japonica subgroups of <italic>O. sativa</italic>. We estimated the genetic similarity between runs in each of these 100 sets with <monospace>kWIP</monospace>. The true distances between the different runs in the 3000 rice datasets are not known, but a topology and sample hierarchy can be inferred from the metadata. We hence assessed the performance of <monospace>kWIP</monospace> in accurately clustering replicates and recovering population structure against a mock distance matrix that reflects the expected topology. We created a distance matrix in which each run had a distance of zero to itself, a distance of 1 to each of its technical replicates (i.e., the other sequencing runs belonging to the same sample), a distance of 2 to each run from other samples in the same rice group (Indica or Japonica), and a distance of 4 to each run from a sample belonging to the respective other rice group. We then used <monospace>scipy</monospace> to calculate Spearman’s rank correlation between this mock matrix and each distance matrix obtained from real data using <monospace>kWIP</monospace>. A paired Student’s t-test was performed between the estimates of relatedness from the WIP and IP metrics with the <monospace>t.test</monospace> function in R. We used hierarchical clustering to visualise these relationships, performed in R with the <monospace>hclust</monospace> function.</p>
<p>We use whole genome sequencing data on 20 strains of <italic>Chlamydomonas reinhardtii</italic> [<xref ref-type="bibr" rid="pcbi.1005727.ref034">34</xref>] to demonstrate that <monospace>kWIP</monospace> is able to detect population structure in a real-world dataset and to examine the effect of sample sequencing depth (coverage) on accuracy of <monospace>kWIP</monospace>. Genetic relatedness between the 20 <italic>Chlamydomonas reinhardtii</italic> samples from this study was estimated with <monospace>kWIP</monospace> using the WIP metric. Classic Multi-dimensional Scaling (MDS) of the <monospace>kWIP</monospace> distance matrix was performed using the <monospace>cmdscale</monospace> function in R. For Euclidean distance matrices, MDS is equivalent to PCA [<xref ref-type="bibr" rid="pcbi.1005727.ref058">58</xref>]. We compare our MDS results with the principal component analysis (PCA) decomposition of SNP genotypes calculated with function <monospace>snpgdsPCA</monospace> in SNPrelate [<xref ref-type="bibr" rid="pcbi.1005727.ref037">37</xref>], working from a VCF file provided by Flowers <italic>et al.</italic> [<xref ref-type="bibr" rid="pcbi.1005727.ref034">34</xref>]. From the aforementioned SNP data we calculated genome-wide average identity-by-state (IBS) with the <monospace>snpgdsIBS</monospace> function in SNPrelate [<xref ref-type="bibr" rid="pcbi.1005727.ref037">37</xref>]. Rank correlation between <monospace>kWIP</monospace> distances and 1-IBS was calculated with function <monospace>cor</monospace> in R [<xref ref-type="bibr" rid="pcbi.1005727.ref059">59</xref>].</p>
<p>We examined the effect of mean sequencing depth (coverage) on the accuracy of <monospace>kWIP</monospace> by random sub-sampling from the sequencing data of each sample. We sub-sampled to coverages of between 0.01- and 200-fold average genome coverage (0.01, 0.1, 0.5, 1, 2, 4, 8, 12, 15, 25, 50, 75, 100, 150, 200x) across samples using the <monospace>sample</monospace> command of <monospace>seqtk</monospace> [<xref ref-type="bibr" rid="pcbi.1005727.ref060">60</xref>]. We attempted to preserve the coefficient of variation in read numbers that existed in the original dataset (0.12) by sampling a random number of reads from the appropriate normal distribution. Spearman’s rank correlation (<italic>ρ</italic>) was used to compare pairwise distances calculated at each sub-sampled coverage to those from the original dataset with function <monospace>cor</monospace> in R [<xref ref-type="bibr" rid="pcbi.1005727.ref059">59</xref>].</p>
<p>To demonstrate that <monospace>kWIP</monospace> can determine the relatedness of samples in a typical metagenomic dataset, we used next generation sequencing data from a study on rice root associated microbiomes [<xref ref-type="bibr" rid="pcbi.1005727.ref035">35</xref>] representing 16S rDNA amplicons from soil and root samples. Relatedness between samples was estimated using <monospace>kWIP</monospace> with the WIP metric, and MDS was performed as above.</p>
</sec>
</sec>
</body>
<back>
<ack>
<p>We thank Sylvain Forêt, Teresa Neeman, Conrad Burden, Gavin Huttley, Ben Kaehler, Cameron Jack and Fengzhu Sun for comments and advice on the metrics, algorithms, and experiments reported here. We thank Luisa Teasdale for comments on earlier versions of this manuscript. We thank Joseph Edwards and Johnathan Flowers for providing additional advice on and results from their datasets.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1005727.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Metzker</surname> <given-names>ML</given-names></name>. <article-title>Sequencing Technologies—the next Generation</article-title>. <source>Nature Reviews Genetics</source>. <year>2010</year>;<volume>11</volume>(<issue>1</issue>):<fpage>31</fpage>–<lpage>46</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nrg2626" xlink:type="simple">10.1038/nrg2626</ext-link></comment> <object-id pub-id-type="pmid">19997069</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005727.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<collab>The Arabidopsis Genome Iniative</collab>. <article-title>Analysis of the Genome Sequence of the Flowering Plant Arabidopsis Thaliana</article-title>. <source>Nature</source>. <year>2000</year>;<volume>408</volume>(<issue>6814</issue>):<fpage>796</fpage>–<lpage>815</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/35048692" xlink:type="simple">10.1038/35048692</ext-link></comment> <object-id pub-id-type="pmid">11130711</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005727.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Nystedt</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Street</surname> <given-names>NR</given-names></name>, <name name-style="western"><surname>Wetterbom</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Zuccolo</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Lin</surname> <given-names>YC</given-names></name>, <name name-style="western"><surname>Scofield</surname> <given-names>DG</given-names></name>, <etal>et al</etal>. <article-title>The Norway Spruce Genome Sequence and Conifer Genome Evolution</article-title>. <source>Nature</source>. <year>2013</year>;<volume>497</volume>(<issue>7451</issue>):<fpage>579</fpage>–<lpage>584</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature12211" xlink:type="simple">10.1038/nature12211</ext-link></comment> <object-id pub-id-type="pmid">23698360</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005727.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Brandt</surname> <given-names>DYC</given-names></name>, <name name-style="western"><surname>Aguiar</surname> <given-names>VRC</given-names></name>, <name name-style="western"><surname>Bitarello</surname> <given-names>BD</given-names></name>, <name name-style="western"><surname>Nunes</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Goudet</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Meyer</surname> <given-names>D</given-names></name>. <article-title>Mapping Bias Overestimates Reference Allele Frequencies at the HLA Genes in the 1000 Project Phase I Data</article-title>. <source>G3: Genes|Genomes|Genetics</source>. <year>2015</year>;<volume>5</volume>(<issue>5</issue>):<fpage>931</fpage>–<lpage>941</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1534/g3.114.015784" xlink:type="simple">10.1534/g3.114.015784</ext-link></comment> <object-id pub-id-type="pmid">25787242</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005727.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Iqbal</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Caccamo</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Turner</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Flicek</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>McVean</surname> <given-names>G</given-names></name>. <article-title>De Novo Assembly and Genotyping of Variants Using Colored de Bruijn Graphs</article-title>. <source>Nature Genetics</source>. <year>2012</year>;<volume>44</volume>(<issue>2</issue>):<fpage>226</fpage>–<lpage>232</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/ng.1028" xlink:type="simple">10.1038/ng.1028</ext-link></comment> <object-id pub-id-type="pmid">22231483</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005727.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bergelson</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Buckler</surname> <given-names>ES</given-names></name>, <name name-style="western"><surname>Ecker</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>Nordborg</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Weigel</surname> <given-names>D</given-names></name>. <article-title>A Proposal Regarding Best Practices for Validating the Identity of Genetic Stocks and the Effects of Genetic Variants</article-title>. <source>The Plant Cell</source>. <year>2016</year>;<volume>28</volume>(<issue>3</issue>):<fpage>606</fpage>–<lpage>609</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1105/tpc.15.00502" xlink:type="simple">10.1105/tpc.15.00502</ext-link></comment> <object-id pub-id-type="pmid">26956491</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005727.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Harlan</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>de Wet</surname> <given-names>JMJ</given-names></name>. <article-title>The Compilospecies Concept</article-title>. <source>Evolution</source>. <year>1963</year>;<volume>17</volume>(<issue>4</issue>):<fpage>497</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/j.1558-5646.1963.tb03307.x" xlink:type="simple">10.1111/j.1558-5646.1963.tb03307.x</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005727.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Song</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Ren</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Reinert</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Deng</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Waterman</surname> <given-names>MS</given-names></name>, <name name-style="western"><surname>Sun</surname> <given-names>F</given-names></name>. <article-title>New Developments of Alignment-Free Sequence Comparison: Measures, Statistics and next-Generation Sequencing</article-title>. <source>Briefings in Bioinformatics</source>. <year>2014</year>;<volume>15</volume>(<issue>3</issue>):<fpage>343</fpage>–<lpage>353</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bib/bbt067" xlink:type="simple">10.1093/bib/bbt067</ext-link></comment> <object-id pub-id-type="pmid">24064230</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005727.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tang</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Hua</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Xie</surname> <given-names>X</given-names></name>. <article-title>A Novel k-Word Relative Measure for Sequence Comparison</article-title>. <source>Computational Biology and Chemistry</source>. <year>2014</year>;<volume>53</volume>, <issue>Part B</issue>:<fpage>331</fpage>–<lpage>338</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.compbiolchem.2014.10.007" xlink:type="simple">10.1016/j.compbiolchem.2014.10.007</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005727.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Forêt</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Wilson</surname> <given-names>SR</given-names></name>, <name name-style="western"><surname>Burden</surname> <given-names>CJ</given-names></name>. <article-title>Characterizing the D2 Statistic: Word Matches in Biological Sequences</article-title>. <source>Statistical Applications in Genetics and Molecular Biology</source>. <year>2009</year>;<volume>8</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>21</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.2202/1544-6115.1447" xlink:type="simple">10.2202/1544-6115.1447</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005727.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sims</surname> <given-names>GE</given-names></name>, <name name-style="western"><surname>Jun</surname> <given-names>SR</given-names></name>, <name name-style="western"><surname>Wu</surname> <given-names>GA</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>SH</given-names></name>. <article-title>Alignment-Free Genome Comparison with Feature Frequency Profiles (FFP) and Optimal Resolutions</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source>. <year>2009</year>;<volume>106</volume>(<issue>8</issue>):<fpage>2677</fpage>–<lpage>2682</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.0813249106" xlink:type="simple">10.1073/pnas.0813249106</ext-link></comment> <object-id pub-id-type="pmid">19188606</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005727.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Leimeister</surname> <given-names>CA</given-names></name>, <name name-style="western"><surname>Morgenstern</surname> <given-names>B</given-names></name>. <article-title>Kmacs: The k-Mismatch Average Common Substring Approach to Alignment-Free Sequence Comparison</article-title>. <source>Bioinformatics</source>. <year>2014</year>; p. btu331. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btu331" xlink:type="simple">10.1093/bioinformatics/btu331</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005727.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Leimeister</surname> <given-names>CA</given-names></name>, <name name-style="western"><surname>Boden</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Horwege</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Lindner</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Morgenstern</surname> <given-names>B</given-names></name>. <article-title>Fast Alignment-Free Sequence Comparison Using Spaced-Word Frequencies</article-title>. <source>Bioinformatics</source>. <year>2014</year>; p. btu177. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btu177" xlink:type="simple">10.1093/bioinformatics/btu177</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005727.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yi</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Jin</surname> <given-names>L</given-names></name>. <article-title>Co-phylog: an assembly-free phylogenomic approach for closely related organisms</article-title>. <source>Nucleic acids research</source>. <year>2013</year>;<volume>41</volume>(<issue>7</issue>):<fpage>e75</fpage>–<lpage>e75</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkt003" xlink:type="simple">10.1093/nar/gkt003</ext-link></comment> <object-id pub-id-type="pmid">23335788</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005727.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Vinga</surname> <given-names>S</given-names></name>. <article-title>Information Theory Applications for Biological Sequence Analysis</article-title>. <source>Briefings in Bioinformatics</source>. <year>2014</year>;<volume>15</volume>(<issue>3</issue>):<fpage>376</fpage>–<lpage>389</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bib/bbt068" xlink:type="simple">10.1093/bib/bbt068</ext-link></comment> <object-id pub-id-type="pmid">24058049</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005727.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Morgenstern</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Zhu</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Horwege</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Leimeister</surname> <given-names>CA</given-names></name>. <article-title>Estimating Evolutionary Distances between Genomic Sequences from Spaced-Word Matches</article-title>. <source>Algorithms for Molecular Biology</source>. <year>2015</year>;<volume>10</volume>(<issue>1</issue>):<fpage>5</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/s13015-015-0032-x" xlink:type="simple">10.1186/s13015-015-0032-x</ext-link></comment> <object-id pub-id-type="pmid">25685176</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005727.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Aflitos</surname> <given-names>SA</given-names></name>, <name name-style="western"><surname>Severing</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Sanchez-Perez</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Peters</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>de Jong</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>de Ridder</surname> <given-names>D</given-names></name>. <article-title>Cnidaria: Fast, Reference-Free Clustering of Raw and Assembled Genome and Transcriptome NGS Data</article-title>. <source>BMC Bioinformatics</source>. <year>2015</year>;<volume>16</volume>:<fpage>352</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/s12859-015-0806-7" xlink:type="simple">10.1186/s12859-015-0806-7</ext-link></comment> <object-id pub-id-type="pmid">26525298</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005727.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Fan</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Ives</surname> <given-names>AR</given-names></name>, <name name-style="western"><surname>Surget-Groba</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Cannon</surname> <given-names>CH</given-names></name>. <article-title>An Assembly and Alignment-Free Method of Phylogeny Reconstruction from next-Generation Sequencing Data</article-title>. <source>BMC Genomics</source>. <year>2015</year>;<volume>16</volume>(<issue>1</issue>):<fpage>522</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/s12864-015-1647-5" xlink:type="simple">10.1186/s12864-015-1647-5</ext-link></comment> <object-id pub-id-type="pmid">26169061</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005727.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ondov</surname> <given-names>BD</given-names></name>, <name name-style="western"><surname>Treangen</surname> <given-names>TJ</given-names></name>, <name name-style="western"><surname>Melsted</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Mallonee</surname> <given-names>AB</given-names></name>, <name name-style="western"><surname>Bergman</surname> <given-names>NH</given-names></name>, <name name-style="western"><surname>Koren</surname> <given-names>S</given-names></name>, <etal>et al</etal>. <article-title>Mash: Fast Genome and Metagenome Distance Estimation Using MinHash</article-title>. <source>Genome Biology</source>. <year>2016</year>;<volume>17</volume>:<fpage>132</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/s13059-016-0997-x" xlink:type="simple">10.1186/s13059-016-0997-x</ext-link></comment> <object-id pub-id-type="pmid">27323842</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005727.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Reinert</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Chew</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Sun</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Waterman</surname> <given-names>MS</given-names></name>. <article-title>Alignment-Free Sequence Comparison (I): Statistics and Power</article-title>. <source>Journal of Computational Biology: A Journal of Computational Molecular Cell Biology</source>. <year>2009</year>;<volume>16</volume>(<issue>12</issue>):<fpage>1615</fpage>–<lpage>1634</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1089/cmb.2009.0198" xlink:type="simple">10.1089/cmb.2009.0198</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005727.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wan</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Reinert</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Sun</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Waterman</surname> <given-names>MS</given-names></name>. <article-title>Alignment-Free Sequence Comparison (II): Theoretical Power of Comparison Statistics</article-title>. <source>Journal of Computational Biology</source>. <year>2010</year>;<volume>17</volume>(<issue>11</issue>):<fpage>1467</fpage>–<lpage>1490</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1089/cmb.2010.0056" xlink:type="simple">10.1089/cmb.2010.0056</ext-link></comment> <object-id pub-id-type="pmid">20973742</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005727.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Allman</surname> <given-names>ES</given-names></name>, <name name-style="western"><surname>Rhodes</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Sullivant</surname> <given-names>S</given-names></name>. <source>Statistically-Consistent k-Mer Methods for Phylogenetic Tree Reconstruction</source>. arXiv:151101956 [q-bio]. <year>2015</year>;</mixed-citation>
</ref>
<ref id="pcbi.1005727.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ren</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Song</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Deng</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Reinert</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Cannon</surname> <given-names>CH</given-names></name>, <name name-style="western"><surname>Sun</surname> <given-names>F</given-names></name>. <article-title>Inference of Markovian Properties of Molecular Sequences from NGS Data and Applications to Comparative Genomics</article-title>. <source>Bioinformatics</source>. <year>2016</year>;<volume>32</volume>(<issue>7</issue>):<fpage>993</fpage>–<lpage>1000</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btv395" xlink:type="simple">10.1093/bioinformatics/btv395</ext-link></comment> <object-id pub-id-type="pmid">26130573</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005727.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Song</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Ren</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Zhai</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Liu</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Deng</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Sun</surname> <given-names>F</given-names></name>. <article-title>Alignment-Free Sequence Comparison Based on Next-Generation Sequencing Reads</article-title>. <source>Journal of Computational Biology</source>. <year>2013</year>;<volume>20</volume>(<issue>2</issue>):<fpage>64</fpage>–<lpage>79</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1089/cmb.2012.0228" xlink:type="simple">10.1089/cmb.2012.0228</ext-link></comment> <object-id pub-id-type="pmid">23383994</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005727.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Jiang</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Song</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Ren</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Deng</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Sun</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>X</given-names></name>. <article-title>Comparison of Metagenomic Samples Using Sequence Signatures</article-title>. <source>BMC Genomics</source>. <year>2012</year>;<volume>13</volume>:<fpage>730</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2164-13-730" xlink:type="simple">10.1186/1471-2164-13-730</ext-link></comment> <object-id pub-id-type="pmid">23268604</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005727.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cormode</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Muthukrishnan</surname> <given-names>S</given-names></name>. <article-title>An improved data stream summary: the count-min sketch and its applications</article-title>. <source>Journal of Algorithms</source>. <year>2004</year>;<volume>55</volume>(<issue>1</issue>):<fpage>58</fpage>–<lpage>75</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jalgor.2003.12.001" xlink:type="simple">10.1016/j.jalgor.2003.12.001</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005727.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zhang</surname> <given-names>Q</given-names></name>, <name name-style="western"><surname>Pell</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Canino-Koning</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Howe</surname> <given-names>AC</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>CT</given-names></name>. <article-title>These Are Not the K-Mers You Are Looking For: Efficient Online K-Mer Counting Using a Probabilistic Data Structure</article-title>. <source>PLoS ONE</source>. <year>2014</year>;<volume>9</volume>(<issue>7</issue>):<fpage>e101271</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0101271" xlink:type="simple">10.1371/journal.pone.0101271</ext-link></comment> <object-id pub-id-type="pmid">25062443</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005727.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Crusoe</surname> <given-names>MR</given-names></name>, <name name-style="western"><surname>Alameldin</surname> <given-names>HF</given-names></name>, <name name-style="western"><surname>Awad</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Boucher</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Caldwell</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Cartwright</surname> <given-names>R</given-names></name>, <etal>et al</etal>. <article-title>The Khmer Software Package: Enabling Efficient Nucleotide Sequence Analysis</article-title>. <source>F1000Research</source>. <year>2015</year> <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.12688/f1000research.6924.1" xlink:type="simple">10.12688/f1000research.6924.1</ext-link></comment> <object-id pub-id-type="pmid">26535114</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005727.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sims</surname> <given-names>GE</given-names></name>, <name name-style="western"><surname>Jun</surname> <given-names>SR</given-names></name>, <name name-style="western"><surname>Wu</surname> <given-names>GA</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>SH</given-names></name>. <article-title>Whole-genome phylogeny of mammals: evolutionary information in genic and nongenic regions</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2009</year>;<volume>106</volume>(<issue>40</issue>):<fpage>17077</fpage>–<lpage>17082</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.0909377106" xlink:type="simple">10.1073/pnas.0909377106</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005727.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hofmann</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Schölkopf</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Smola</surname> <given-names>AJ</given-names></name>. <article-title>Kernel Methods in Machine Learning</article-title>. <source>The Annals of Statistics</source>. <year>2008</year>;<volume>36</volume>(<issue>3</issue>):<fpage>1171</fpage>–<lpage>1220</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1214/009053607000000677" xlink:type="simple">10.1214/009053607000000677</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005727.ref031">
<label>31</label>
<mixed-citation publication-type="other" xlink:type="simple">Guennebaud G, Jacob B, others. Eigen V3; 2010.</mixed-citation>
</ref>
<ref id="pcbi.1005727.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Li</surname> <given-names>JY</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Zeigler</surname> <given-names>RS</given-names></name>. <article-title>The 3,000 Rice Genomes Project: New Opportunities and Challenges for Future Rice Research</article-title>. <source>GigaScience</source>. <year>2014</year>;<volume>3</volume>(<issue>1</issue>):<fpage>8</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/2047-217X-3-8" xlink:type="simple">10.1186/2047-217X-3-8</ext-link></comment> <object-id pub-id-type="pmid">24872878</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005727.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<collab>The 3,000 rice genomes project</collab>. <article-title>The 3,000 Rice Genomes Project</article-title>. <source>GigaScience</source>. <year>2014</year>;<volume>3</volume>(<issue>1</issue>):<fpage>7</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/2047-217X-3-7" xlink:type="simple">10.1186/2047-217X-3-7</ext-link></comment> <object-id pub-id-type="pmid">24872877</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005727.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Flowers</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Hazzouri</surname> <given-names>KM</given-names></name>, <name name-style="western"><surname>Pham</surname> <given-names>GM</given-names></name>, <name name-style="western"><surname>Rosas</surname> <given-names>U</given-names></name>, <name name-style="western"><surname>Bahmani</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Khraiwesh</surname> <given-names>B</given-names></name>, <etal>et al</etal>. <article-title>Whole-Genome Resequencing Reveals Extensive Natural Variation in the Model Green Alga Chlamydomonas Reinhardtii</article-title>. <source>The Plant Cell</source>. <year>2015</year>;<volume>27</volume>(<issue>9</issue>):<fpage>2353</fpage>–<lpage>2369</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1105/tpc.15.00492" xlink:type="simple">10.1105/tpc.15.00492</ext-link></comment> <object-id pub-id-type="pmid">26392080</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005727.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Edwards</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Johnson</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Santos-Medellín</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Lurie</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Podishetty</surname> <given-names>NK</given-names></name>, <name name-style="western"><surname>Bhatnagar</surname> <given-names>S</given-names></name>, <etal>et al</etal>. <article-title>Structure, Variation, and Assembly of the Root-Associated Microbiomes of Rice</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2015</year>;<volume>112</volume>(<issue>8</issue>):<fpage>E911</fpage>–<lpage>E920</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1414592112" xlink:type="simple">10.1073/pnas.1414592112</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005727.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Brown</surname> <given-names>CT</given-names></name>, <name name-style="western"><surname>Howe</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>Q</given-names></name>, <name name-style="western"><surname>Pyrkosz</surname> <given-names>AB</given-names></name>, <name name-style="western"><surname>Brom</surname> <given-names>TH</given-names></name>. <article-title>A Reference-Free Algorithm for Computational Normalization of Shotgun Sequencing Data</article-title>. arXiv:12034802 [q-bio]. <year>2012</year></mixed-citation>
</ref>
<ref id="pcbi.1005727.ref037">
<label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zheng</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Levine</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Shen</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Gogarten</surname> <given-names>SM</given-names></name>, <name name-style="western"><surname>Laurie</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Weir</surname> <given-names>BS</given-names></name>. <article-title>A High-Performance Computing Toolset for Relatedness and Principal Component Analysis of SNP Data</article-title>. <source>Bioinformatics</source>. <year>2012</year>;<volume>28</volume>(<issue>24</issue>):<fpage>3326</fpage>–<lpage>3328</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/bts606" xlink:type="simple">10.1093/bioinformatics/bts606</ext-link></comment> <object-id pub-id-type="pmid">23060615</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005727.ref038">
<label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>McVean</surname> <given-names>G</given-names></name>. <article-title>A Genealogical Interpretation of Principal Components Analysis</article-title>. <source>PLOS Genet</source>. <year>2009</year>;<volume>5</volume>(<issue>10</issue>):<fpage>e1000686</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pgen.1000686" xlink:type="simple">10.1371/journal.pgen.1000686</ext-link></comment> <object-id pub-id-type="pmid">19834557</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005727.ref039">
<label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Melsted</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Pritchard</surname> <given-names>JK</given-names></name>. <article-title>Efficient Counting of k-Mers in DNA Sequences Using a Bloom Filter</article-title>. <source>BMC bioinformatics</source>. <year>2011</year>;<volume>12</volume>:<fpage>333</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2105-12-333" xlink:type="simple">10.1186/1471-2105-12-333</ext-link></comment> <object-id pub-id-type="pmid">21831268</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005727.ref040">
<label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Salton</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Buckley</surname> <given-names>C</given-names></name>. <article-title>Term-Weighting Approaches in Automatic Text Retrieval</article-title>. <source>Information Processing &amp; Management</source>. <year>1988</year>;<volume>24</volume>(<issue>5</issue>):<fpage>513</fpage>–<lpage>523</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/0306-4573(88)90021-0" xlink:type="simple">10.1016/0306-4573(88)90021-0</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005727.ref041">
<label>41</label>
<mixed-citation publication-type="other" xlink:type="simple">Chen S, Goodman J. An Empirical Study of Smoothing Techniques for Language Modeling. In: Proceedings of the 34th Annual Meeting of the ACL; 1996. p. 310–318.</mixed-citation>
</ref>
<ref id="pcbi.1005727.ref042">
<label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Leslie</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Kuang</surname> <given-names>R</given-names></name>. <article-title>Fast String Kernels Using Inexact Matching for Protein Sequences</article-title>. <source>J Mach Learn Res</source>. <year>2004</year>;<volume>5</volume>:<fpage>1435</fpage>–<lpage>1455</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005727.ref043">
<label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Leslie</surname> <given-names>CS</given-names></name>, <name name-style="western"><surname>Eskin</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Cohen</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Weston</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Noble</surname> <given-names>WS</given-names></name>. <article-title>Mismatch String Kernels for Discriminative Protein Classification</article-title>. <source>Bioinformatics (Oxford, England)</source>. <year>2004</year>;<volume>20</volume>(<issue>4</issue>):<fpage>467</fpage>–<lpage>476</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btg431" xlink:type="simple">10.1093/bioinformatics/btg431</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005727.ref044">
<label>44</label>
<mixed-citation publication-type="other" xlink:type="simple">Leslie C, Eskin E, Noble WS. The Spectrum Kernel: A String Kernel for SVM Protein Classification. Pacific Symposium on Biocomputing Pacific Symposium on Biocomputing. 2002; p. 564–575.</mixed-citation>
</ref>
<ref id="pcbi.1005727.ref045">
<label>45</label>
<mixed-citation publication-type="other" xlink:type="simple">Gog S, Beller T, Moffat A, Petri M. From Theory to Practice: Plug and Play with Succinct Data Structures. In: Gudmundsson J, Katajainen J, editors. Experimental Algorithms: 13th International Symposium, SEA 2014, Copenhagen, Denmark, June 29—July 1, 2014. Proceedings. Cham: Springer International Publishing; 2014. p. 326–337.</mixed-citation>
</ref>
<ref id="pcbi.1005727.ref046">
<label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Solomon</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Kingsford</surname> <given-names>C</given-names></name>. <article-title>Fast Search of Thousands of Short-Read Sequencing Experiments</article-title>. <source>Nature Biotechnology</source>. <year>2016</year>;<volume>34</volume>(<issue>3</issue>):<fpage>300</fpage>–<lpage>302</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nbt.3442" xlink:type="simple">10.1038/nbt.3442</ext-link></comment> <object-id pub-id-type="pmid">26854477</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005727.ref047">
<label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Brachi</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Morris</surname> <given-names>GP</given-names></name>, <name name-style="western"><surname>Borevitz</surname> <given-names>JO</given-names></name>. <article-title>Genome-Wide Association Studies in Plants: The Missing Heritability Is in the Field</article-title>. <source>Genome biology</source>. <year>2011</year>;<volume>12</volume>(<issue>10</issue>):<fpage>232</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/gb-2011-12-10-232" xlink:type="simple">10.1186/gb-2011-12-10-232</ext-link></comment> <object-id pub-id-type="pmid">22035733</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005727.ref048">
<label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Spindel</surname> <given-names>JE</given-names></name>, <name name-style="western"><surname>McCouch</surname> <given-names>SR</given-names></name>. <article-title>When More Is Better: How Data Sharing Would Accelerate Genomic Selection of Crop Plants</article-title>. <source>New Phytologist</source>. <year>2016</year>; p. <fpage>n/a</fpage>–<lpage>n/a</lpage></mixed-citation>
</ref>
<ref id="pcbi.1005727.ref049">
<label>49</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Köster</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Rahmann</surname> <given-names>S</given-names></name>. <article-title>Snakemake—a Scalable Bioinformatics Workflow Engine</article-title>. <source>Bioinformatics</source>. <year>2012</year>;<volume>28</volume>(<issue>19</issue>):<fpage>2520</fpage>–<lpage>2522</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/bts480" xlink:type="simple">10.1093/bioinformatics/bts480</ext-link></comment> <object-id pub-id-type="pmid">22908215</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005727.ref050">
<label>50</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Perez</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Granger</surname> <given-names>BE</given-names></name>. <article-title>IPython: A System for Interactive Scientific Computing</article-title>. <source>Computing in Science &amp; Engineering</source>. <year>2007</year>;<volume>9</volume>(<issue>3</issue>):<fpage>21</fpage>–<lpage>29</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/MCSE.2007.53" xlink:type="simple">10.1109/MCSE.2007.53</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005727.ref051">
<label>51</label>
<mixed-citation publication-type="other" xlink:type="simple">Kluyver T, Ragan-Kelley B, Pérez F, Granger B, Bussonnier M, Frederic J, et al. Jupyter Notebooks—a Publishing Format for Reproducible Computational Workflows. In: Positioning and Power in Academic Publishing: Players, Agents and Agendas: Proceedings of the 20th International Conference on Electronic Publishing. IOS Press; 2016. p. 87.</mixed-citation>
</ref>
<ref id="pcbi.1005727.ref052">
<label>52</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Staab</surname> <given-names>PR</given-names></name>, <name name-style="western"><surname>Zhu</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Metzler</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Lunter</surname> <given-names>G</given-names></name>. <article-title>Scrm: Efficiently Simulating Long Sequences Using the Approximated Coalescent with Recombination</article-title>. <source>Bioinformatics</source>. <year>2015</year>;<volume>31</volume>(<issue>10</issue>):<fpage>1680</fpage>–<lpage>1682</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btu861" xlink:type="simple">10.1093/bioinformatics/btu861</ext-link></comment> <object-id pub-id-type="pmid">25596205</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005727.ref053">
<label>53</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cartwright</surname> <given-names>RA</given-names></name>. <article-title>DNA Assembly with Gaps (Dawg): Simulating Sequence Evolution</article-title>. <source>Bioinformatics</source>. <year>2005</year>;<volume>21</volume>(<issue>Suppl 3</issue>):<fpage>iii31</fpage>–<lpage>iii38</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/bti1200" xlink:type="simple">10.1093/bioinformatics/bti1200</ext-link></comment> <object-id pub-id-type="pmid">16306390</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005727.ref054">
<label>54</label>
<mixed-citation publication-type="other" xlink:type="simple">Holtgrewe M. Mason—A Read Simulator for Second Generation Sequencing Data. Technical Report FU Berlin. 2010;.</mixed-citation>
</ref>
<ref id="pcbi.1005727.ref055">
<label>55</label>
<mixed-citation publication-type="other" xlink:type="simple">Jones E, Oliphant T, Peterson P. SciPy: Open Source Scientific Tools for Python; 2001–.</mixed-citation>
</ref>
<ref id="pcbi.1005727.ref056">
<label>56</label>
<mixed-citation publication-type="other" xlink:type="simple">Murray K. SRApy: Pythonic Tools for Accessing the Short Read Archive. Zenodo. 2016;</mixed-citation>
</ref>
<ref id="pcbi.1005727.ref057">
<label>57</label>
<mixed-citation publication-type="other" xlink:type="simple">Joshi NA, Fass JN. Sickle: A Sliding-Window, Adaptive, Quality-Based Trimming Tool for FastQ Files; 2011.</mixed-citation>
</ref>
<ref id="pcbi.1005727.ref058">
<label>58</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Hastie</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Tibshirani</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Friedman</surname> <given-names>J</given-names></name>. <chapter-title>The Elements of Statistical Learning</chapter-title>. <source>Springer Series in Statistics</source>. <publisher-loc>New York, NY</publisher-loc>: <publisher-name>Springer New York</publisher-name>; <year>2009</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005727.ref059">
<label>59</label>
<mixed-citation publication-type="book" xlink:type="simple">
<collab>R Core Team</collab>. <source>R: A Language and Environment for Statistical Computing</source>; <year>2016</year>. Available from: <ext-link ext-link-type="uri" xlink:href="https://www.R-project.org/" xlink:type="simple">https://www.R-project.org/</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1005727.ref060">
<label>60</label>
<mixed-citation publication-type="other" xlink:type="simple">Li H. Seqtk—Toolkit for Processing Sequences in FASTA/Q Formats; 2008. <ext-link ext-link-type="uri" xlink:href="https://github.com/lh3/seqtk" xlink:type="simple">https://github.com/lh3/seqtk</ext-link>.</mixed-citation>
</ref>
</ref-list>
</back>
</article>