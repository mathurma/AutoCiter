<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id><journal-title-group>
<journal-title>PLoS Computational Biology</journal-title></journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-14-00196</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1003968</article-id>
<article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Statistics (mathematics)</subject><subj-group><subject>Statistical methods</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Bayesian History Matching of Complex Infectious Disease Models Using Emulation: A Tutorial and a Case Study on HIV in Uganda</article-title>
<alt-title alt-title-type="running-head">History Matching of Complex Infectious Disease Models</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Andrianakis</surname><given-names>Ioannis</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Vernon</surname><given-names>Ian R.</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>McCreesh</surname><given-names>Nicky</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>McKinley</surname><given-names>Trevelyan J.</given-names></name><xref ref-type="aff" rid="aff4"><sup>4</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Oakley</surname><given-names>Jeremy E.</given-names></name><xref ref-type="aff" rid="aff5"><sup>5</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Nsubuga</surname><given-names>Rebecca N.</given-names></name><xref ref-type="aff" rid="aff6"><sup>6</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Goldstein</surname><given-names>Michael</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>White</surname><given-names>Richard G.</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib>
</contrib-group>
<aff id="aff1"><label>1</label><addr-line>Dept. of Infectious Disease Epidemiology, London School of Hygiene &amp; Tropical Medicine, London, United Kingdom</addr-line></aff>
<aff id="aff2"><label>2</label><addr-line>Dept. of Mathematical Sciences, Durham University, Durham, United Kingdom</addr-line></aff>
<aff id="aff3"><label>3</label><addr-line>School of Medicine, Pharmacy and Health, Durham University, Durham, United Kingdom</addr-line></aff>
<aff id="aff4"><label>4</label><addr-line>Dept. of Veterinary Medicine, University of Cambridge, Cambridge, United Kingdom</addr-line></aff>
<aff id="aff5"><label>5</label><addr-line>School of Mathematics and Statistics, University of Sheffield, Sheffield, United Kingdom</addr-line></aff>
<aff id="aff6"><label>6</label><addr-line>Medical Research Council/Uganda Virus Research Institute, Uganda Research Unit on AIDS, Entebbe, Uganda</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Wu</surname><given-names>Hulin</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group>
<aff id="edit1"><addr-line>University of Rochester, United States of America</addr-line></aff>
<author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">ioannis.andrianakis@lshtm.ac.uk</email></corresp>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn>
<fn fn-type="con"><p>Conceived and designed the experiments: IA IRV JEO MG. Performed the experiments: IA. Analyzed the data: IA IRV JEO. Contributed reagents/materials/analysis tools: NM RNN. Wrote the paper: IA IRV NM TJM JEO RGW. Provided the epidemiological data on HIV in Uganda: RNN.</p></fn>
</author-notes>
<pub-date pub-type="collection"><month>1</month><year>2015</year></pub-date>
<pub-date pub-type="epub"><day>8</day><month>1</month><year>2015</year></pub-date>
<volume>11</volume>
<issue>1</issue>
<elocation-id>e1003968</elocation-id>
<history>
<date date-type="received"><day>7</day><month>2</month><year>2014</year></date>
<date date-type="accepted"><day>8</day><month>10</month><year>2014</year></date>
</history>
<permissions>
<copyright-year>2015</copyright-year>
<copyright-holder>Andrianakis et al</copyright-holder><license xlink:type="simple"><license-p>This is an open-access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions>
<abstract>
<p>Advances in scientific computing have allowed the development of complex models that are being routinely applied to problems in disease epidemiology, public health and decision making. The utility of these models depends in part on how well they can reproduce empirical data. However, fitting such models to real world data is greatly hindered both by large numbers of input and output parameters, and by long run times, such that many modelling studies lack a formal calibration methodology. We present a novel method that has the potential to improve the calibration of complex infectious disease models (hereafter called <italic>simulators</italic>). We present this in the form of a tutorial and a case study where we history match a dynamic, event-driven, individual-based stochastic HIV simulator, using extensive demographic, behavioural and epidemiological data available from Uganda. The tutorial describes history matching and emulation. History matching is an iterative procedure that reduces the simulator's input space by identifying and discarding areas that are unlikely to provide a good match to the empirical data. History matching relies on the computational efficiency of a Bayesian representation of the simulator, known as an <italic>emulator</italic>. Emulators mimic the simulator's behaviour, but are often several orders of magnitude faster to evaluate. In the case study, we use a 22 input simulator, fitting its 18 outputs simultaneously. After 9 iterations of history matching, a non-implausible region of the simulator input space was identified that was <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e001" xlink:type="simple"/></inline-formula> times smaller than the original input space. Simulator evaluations made within this region were found to have a 65% probability of fitting all 18 outputs. History matching and emulation are useful additions to the toolbox of infectious disease modellers. Further research is required to explicitly address the stochastic nature of the simulator as well as to account for correlations between outputs.</p>
</abstract>
<abstract abstract-type="summary"><title>Author Summary</title>
<p>An increasing number of scientific disciplines, and biology in particular, rely on complex computational models. The utility of these models depends on how well they are fitted to empirical data. Fitting is achieved by searching for suitable values for the models' input parameters, in a process known as calibration. Modern computer models typically have a large number of input and output parameters, and long running times, a consequence of their increasing computational complexity. The above two things hinder the calibration process. In this work, we propose a method that can help the calibration of models with long running times and several inputs and outputs. We apply this method on an individual based, dynamic and stochastic HIV model, using HIV data from Uganda. The final system has a 65% probability of selecting an input parameter set that fits all 18 model outputs.</p>
</abstract>
<funding-group><funding-statement>This work was supported by a Medical Research Council (UK) grant on Model Calibration (MR/J005088/1) (<ext-link ext-link-type="uri" xlink:href="http://www.mrc.ac.uk/" xlink:type="simple">http://www.mrc.ac.uk/</ext-link>). RGW is additionally funded by the Medical Research Council (UK) (G0802414), the Bill and Melinda Gates Foundation (TB Modelling and Analysis Consortium: Grants 21675/OPP1084276 and Consortium to Respond Effectively to the AIDS/TB Epidemic 19790.01), and CDC/PEPFAR via the Aurum Institute (U2GPS0008111). TJM is supported by Biotechnology and Biological Sciences Research Council grant number BB/I012192/1. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="18"/></counts></article-meta>
</front>
<body><sec id="s1">
<title>Introduction</title>
<p>Complex computer models (hereafter called simulators) are now being used in many scientific disciplines and are becoming increasingly common in basic science, climate modelling, communicable and non-communicable disease epidemiology and public health <xref ref-type="bibr" rid="pcbi.1003968-Law1">[1]</xref>–<xref ref-type="bibr" rid="pcbi.1003968-Dewilde1">[6]</xref>. The simulators' utility for prediction and planning relies on how well they are calibrated to empirical data and how well they can be analysed to assess the validity of their predictions <xref ref-type="bibr" rid="pcbi.1003968-Grimm2">[7]</xref>, <xref ref-type="bibr" rid="pcbi.1003968-May1">[8]</xref>.</p>
<p>Simulators can be calibrated using a multitude of approaches. Simple ‘goodness of fit’ methodologies, such as least squares, are often used, however these approaches are difficult to apply to high-dimensional and computationally expensive individual-level simulators. More rigorous statistical techniques have been developed, usually based around the concept of a likelihood function. These techniques are very flexible, and can be used to fit a wide variety of simulators, ranging in complexity. Nonetheless, implementing likelihood-based inference techniques for complex simulators is challenging, particularly when considering large-scale, missing or partially observed data. Recent advances that have been usefully applied in the field of dynamic epidemic modelling include maximum likelihood via iterated filtering <xref ref-type="bibr" rid="pcbi.1003968-Ionides1">[9]</xref>; data augmented and/or reversible-jump Markov chain Monte Carlo (MCMC; <xref ref-type="bibr" rid="pcbi.1003968-Gibson1">[10]</xref>–<xref ref-type="bibr" rid="pcbi.1003968-Jewell1">[13]</xref>) and stochastic differential equations <xref ref-type="bibr" rid="pcbi.1003968-Keeling1">[14]</xref>. However, these systems can sometimes become mathematically or computationally intractable, leading to the development of various approximation techniques <xref ref-type="bibr" rid="pcbi.1003968-Cauchemez1">[15]</xref>, <xref ref-type="bibr" rid="pcbi.1003968-ONeill2">[16]</xref>.</p>
<p>A common theme in approximation methods for dynamic simulators is to replace dependence on the likelihood with outputs from simulator runs, since although a model's likelihood may be intractable, running the simulator is straightforward. These approaches can be implemented in various ways, for example: embedded in a particle filter <xref ref-type="bibr" rid="pcbi.1003968-Cauchemez2">[17]</xref>; using Approximate Bayesian Computation <xref ref-type="bibr" rid="pcbi.1003968-Toni1">[18]</xref>–<xref ref-type="bibr" rid="pcbi.1003968-Conlan1">[20]</xref>; or using pseudo-marginal methods <xref ref-type="bibr" rid="pcbi.1003968-McKinley2">[21]</xref>. Another technique that could be applied in this field is particle MCMC <xref ref-type="bibr" rid="pcbi.1003968-Andrieu1">[22]</xref>.</p>
<p>Despite the variety of calibration methods, their application to the analysis of complex simulators is lacking. A systematic review of cancer simulators found that of 131 studies only two thirds (87) provided any information on what methods were employed. Of these only about a third (27) used a formal goodness of fit measure (two used likelihood-based methods and 25 distance-based metrics, such as least squares or chi-square) <xref ref-type="bibr" rid="pcbi.1003968-Stout1">[23]</xref>. The remainder did not state how the simulators were calibrated or used visual inspection to assess how well the simulator described the data. Similarly, a systematic review of simulators of HIV transmission in men who have sex with men found only 18% of the 115 simulators had been formally calibrated to data and remarkably that calibration had become less common over time <xref ref-type="bibr" rid="pcbi.1003968-Punyacharoensin1">[24]</xref>.</p>
<p>One of the key reasons that complex simulator calibration is uncommon is that most formal methods (including distance-based and likelihood-based measures) require that simulators are run many times <xref ref-type="bibr" rid="pcbi.1003968-Kennedy1">[25]</xref>. This poses a considerable problem for complex simulators that require several minutes or even hours for the evaluation of a single scenario, making most of the above calibration methods utterly impractical. The problem is compounded for stochastic simulators because hundreds or thousands of realisations are required for each scenario. Current standard methods for formal sensitivity and uncertainty analysis <xref ref-type="bibr" rid="pcbi.1003968-Saltelli1">[26]</xref> are also impractical for complex simulators because of the heavy computational burden <xref ref-type="bibr" rid="pcbi.1003968-Oakley1">[27]</xref>. Simulator simplification, although desirable, is not appropriate if a complex simulator is required to satisfactorily address the research question and it increases the probability of simulator inadequacy <xref ref-type="bibr" rid="pcbi.1003968-Kennedy1">[25]</xref>. As the number of simulator parameters increases, the number of runs required for an adequate exploration of the parameter space increases rapidly. Robust fitting and uncertainty analysis of complex simulators with dozens of parameters is often impossible, even with increasing computer power and advances in parallelisation. Another important aspect of the calibration of complex models that remains unaddressed in the epidemiology literature is that of model discrepancy <xref ref-type="bibr" rid="pcbi.1003968-Kennedy1">[25]</xref>, <xref ref-type="bibr" rid="pcbi.1003968-Craig1">[28]</xref>–<xref ref-type="bibr" rid="pcbi.1003968-Goldstein2">[30]</xref>. This represents an upfront acknowledgement of the limitations of the complex model and helps tailor the search for acceptable input parameters by providing a more rigorous and realistic definition of match quality between the model outputs and observed data (see section ‘History matching’).</p>
<p>In this work we present a novel method based on Bayesian history matching, emulation and model discrepancy, that is designed to address all of the above issues while simultaneously avoiding unnecessary complexity. This method has the potential to greatly improve the calibration of complex infectious disease simulators. We present this in the form of a tutorial (section ‘Methods’) and a case study where we history match a dynamic, event-driven, individual-based stochastic HIV simulator, using extensive demographic, behavioural and epidemiological data from Uganda (section ‘<xref ref-type="sec" rid="s3">Results</xref>’). The online supplementary material includes the details required for building an emulator and a simulation study that demonstrates the performance of history matching on synthetic data.</p>
</sec><sec id="s2" sec-type="methods">
<title>Methods</title>
<sec id="s2a">
<title>Motivation</title>
<p>A major issue that affects the calibration algorithms discussed so far arises from simulators that are slow to evaluate. Although computers are becoming increasingly powerful, running times of hours or days are not uncommon (as modellers tend to develop more complex simulators to exploit increased computing power). This can render any calibration algorithm that relies on a large number of simulator evaluations utterly impractical. Another issue is that modern simulators tend to have a large number of inputs and outputs and the task of matching several outputs while varying a large number of inputs simultaneously can be very intensive computationally. Both of these conditions can be addressed with history matching and emulation.</p>
<p>History matching <xref ref-type="bibr" rid="pcbi.1003968-Craig1">[28]</xref> is designed to identify the set of inputs that would give rise to acceptable matches between the model outputs and the observed data. It has three characteristics that distinguish it from most calibration methods. Firstly, many calibration algorithms (for example Bayesian MCMC) attempt to make full probabilistic statements about the input values that are most likely to match the simulator's output to the empirical data. This represents a challenging and computationally intensive task, involving complex and frequently intractable calculations. Critically, often such detailed calculations are unwarranted as the complex model is not thought to be an accurate enough representation of reality to justify them. History matching instead provides a more tractable calculation involving expectations and variances, that is often of primary interest to modellers. Secondly, history matching works by excluding parts of the input space that are unlikely to provide a good match. These parts of the space are known as <italic>implausible</italic>. The third characteristic is that the implausible space is not excluded all at once, but in iterations of the process, known as <italic>waves</italic>. As a result, the <italic>non-implausible</italic> space (i.e. the complement of the implausible space), shrinks at each iteration of the process.</p>
<p>The above characteristics give some desirable properties to history matching. First, the calculations involved are far more efficient and straightforward to implement. Second, the exclusion of implausible space is possible without considering the full set of inputs and outputs simultaneously, thus reducing the burden of high dimensionality. For example, if the simulator fails to match one output for a particular input value, then this value is implausible regardless of the other outputs' behaviour. This should be compared to fully probabilistic approaches (for example full Bayesian MCMC or maximum likelihood methods) which attempt to model how likely an input is, usually using a likelihood function, thus representing a far more complex calculation that must use all outputs and all observed data and information simultaneously. Third, as the volume of non-implausible space shrinks with consecutive waves, often to a tiny fraction of the original, the simulator's behaviour typically becomes more predictable and smooth, as the range of the inputs is significantly smaller. Once this point is reached, handling the full set of inputs and outputs is normally more manageable: at this point more detailed probabilistic calibration methods can be employed if necessary (see section ‘Posterior sampling’). Finally, it is possible that a simulator is incapable of matching the observation data, due to either incorrect modelling assumptions, poor error specification, or coding errors. History matching can identify this condition by characterising all the input parameter space as implausible, whereas alternative methods will always attempt to return a posterior distribution, regardless of how well, if at all, the simulator fits the data.</p>
<p>A long established method for handling computationally expensive simulators is to first construct an <italic>emulator</italic>: a statistical model of the simulator that can be used as a surrogate <xref ref-type="bibr" rid="pcbi.1003968-Sacks1">[31]</xref>. The simulator is first run at a manageable number of input values, to provide training data to build the emulator. The emulator will give a joint probability distribution of the simulator outputs for any set of input values, and the distribution can be used both to provide estimates of the outputs, and quantify uncertainty in the estimates. Building an emulator will involve some computational effort in obtaining the training data (the simulator runs) and fitting the emulator to the data. However, once built, the emulator can provide estimates (with a quantification of uncertainty) of the simulator output near instantaneously, even for very large numbers of inputs. Emulators enable rapid exploration of high dimensional input spaces, and have been used within fully probabilistic calibration <xref ref-type="bibr" rid="pcbi.1003968-Kennedy1">[25]</xref>, <xref ref-type="bibr" rid="pcbi.1003968-Bayarri1">[32]</xref>, <xref ref-type="bibr" rid="pcbi.1003968-Henderson1">[33]</xref>, including simulators with high dimensional output <xref ref-type="bibr" rid="pcbi.1003968-Higdon1">[34]</xref>.</p>
<p>Emulators can be used within history matching if the simulator is computationally expensive, as is the case in this work. History matching together with emulation has been successfully applied across a range of scientific disciplines including galaxy formation simulations (<xref ref-type="bibr" rid="pcbi.1003968-Vernon1">[35]</xref>, <xref ref-type="bibr" rid="pcbi.1003968-Bower1">[36]</xref> or for an overview see <xref ref-type="bibr" rid="pcbi.1003968-Vernon2">[37]</xref>), oil reservoir models <xref ref-type="bibr" rid="pcbi.1003968-Craig1">[28]</xref>, <xref ref-type="bibr" rid="pcbi.1003968-Cumming1">[38]</xref>, systems biology models <xref ref-type="bibr" rid="pcbi.1003968-Vernon3">[39]</xref>, <xref ref-type="bibr" rid="pcbi.1003968-Vernon4">[40]</xref>, climate models <xref ref-type="bibr" rid="pcbi.1003968-Williamson1">[41]</xref> and rainfall runoff models <xref ref-type="bibr" rid="pcbi.1003968-Goldstein2">[30]</xref>.</p>
<p>History matching is a method designed for reducing the simulator's input space but is not designed to make probabilistic statements about the inputs, such as producing posterior distributions. Thus, it can be seen as a pre-calibration method or as a calibration method but in the broader sense. We would assert that for many situations involving model development and assessment, the results of a history match are all that are required by the modeller. When specifying the initial input ranges, we may have substantial uncertainty about what the acceptable input values are, so that the acceptable region of the input space (that would contain say the posterior distribution) is a tiny proportion of the initially specified input space, and thus hard to discover. The iterative nature of history matching and the fact that it discards the implausible space instead of looking for input values that are close to the empirical data simplify significantly this task. It is also important to bear in mind that alternative ‘probabilistic’ calibration methods would most likely struggle with a model of the complexity and input-output dimensionality such as the one studied here. Therefore, should one wish to probabilistically calibrate a well tested and accurate simulator, it is still advantageous to greatly reduce the input space under consideration first, using history matching as a precursor.</p>
<p>We continue this tutorial by describing how history matching is set up (section ‘History matching’), and we then present the procedure of history matching (section ‘Procedure’) along with a toy example that illustrates the fundamental concepts. The tutorial then proceeds with two more technical sections, one containing details on how an emulator is built (section ‘Emulation’), and another describing an essential component of history matching, the implausibility measure (section ‘Implausibility measure’). Finally, we present an approximate method for drawing samples from the simulator's posterior distribution (section ‘Posterior sampling’).</p>
</sec><sec id="s2b">
<title>History matching</title>
<p>History matching assumes the existence of a physical process <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e002" xlink:type="simple"/></inline-formula> that is measured through observations <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e003" xlink:type="simple"/></inline-formula> (<xref ref-type="fig" rid="pcbi-1003968-g001">Fig. 1</xref>). The acquisition of observations <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e004" xlink:type="simple"/></inline-formula> takes place with finite accuracy and introduces some uncertainty, which we term observation uncertainty (OU). History matching also assumes the existence of a simulator (computer model) that attempts to describe the process <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e005" xlink:type="simple"/></inline-formula>. The simulator has <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e006" xlink:type="simple"/></inline-formula> inputs (parameters) <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e007" xlink:type="simple"/></inline-formula>, assumed to be continuous <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e008" xlink:type="simple"/></inline-formula>. We consider a stochastic simulator: a simulator which when run twice at the same value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e009" xlink:type="simple"/></inline-formula> can produce different outputs.</p>
<fig id="pcbi-1003968-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003968.g001</object-id><label>Figure 1</label><caption>
<title>History matching.</title>
<p>The physical process <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e010" xlink:type="simple"/></inline-formula> is observed via <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e011" xlink:type="simple"/></inline-formula> and described by the simulator output <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e012" xlink:type="simple"/></inline-formula>. The simulator is substituted by the emulator for computational efficiency. The question marks indicate the various sources of uncertainty present in the system.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003968.g001" position="float" xlink:type="simple"/></fig>
<p>We suppose that the simulator output consists of a vector of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e013" xlink:type="simple"/></inline-formula> quantities, which we denote with the vector <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e014" xlink:type="simple"/></inline-formula>. To represent the stochastic nature of the simulator, if we keep the input vector <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e015" xlink:type="simple"/></inline-formula> fixed and run the simulator <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e016" xlink:type="simple"/></inline-formula> times, we would observe, for the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e017" xlink:type="simple"/></inline-formula> run, with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e018" xlink:type="simple"/></inline-formula>: <disp-formula id="pcbi.1003968.e019"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003968.e019" xlink:type="simple"/><label>(1)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e020" xlink:type="simple"/></inline-formula> is the mean value of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e021" xlink:type="simple"/></inline-formula> output (if the simulator were to be run repeatedly at the same input value <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e022" xlink:type="simple"/></inline-formula>), and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e023" xlink:type="simple"/></inline-formula> is a random variable with expectation 0.</p>
<p>We suppose that the physical process <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e024" xlink:type="simple"/></inline-formula> corresponds, to some level of accuracy or tolerance, to a realisation of the simulator output <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e025" xlink:type="simple"/></inline-formula>, at some particular input, rather than the mean output <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e026" xlink:type="simple"/></inline-formula>. In our search for non-implausible inputs, we need to take into account the variability of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e027" xlink:type="simple"/></inline-formula> around <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e028" xlink:type="simple"/></inline-formula>. We refer to this term as Ensemble Variability (EV).</p>
<p>As mentioned earlier, the calibration of complex simulators can be infeasible if the calibration method depends on a large number of simulator evaluations that take considerable time to complete. For this reason, we rely on a statistical model of the simulator, known as an emulator, which is trained using a relatively small number of simulator runs and which we use to provide an estimate of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e029" xlink:type="simple"/></inline-formula> in a fraction of the time required for a simulator run. The emulator represents our beliefs about the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e030" xlink:type="simple"/></inline-formula> at all, yet to be evaluated inputs <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e031" xlink:type="simple"/></inline-formula>, and our uncertainty about such values. The fact that the simulator (code) is not evaluated for every possible value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e032" xlink:type="simple"/></inline-formula>, creates another source of uncertainty, which we term Code Uncertainty (CU) and is quantified via the emulator.</p>
<p>There is one final source of uncertainty, which is important though perhaps the most difficult to consider. Due to our incomplete understanding of the process <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e033" xlink:type="simple"/></inline-formula> and our inability to model all of its aspects, we do not believe the simulator to be a perfect representation of reality <xref ref-type="bibr" rid="pcbi.1003968-Craig1">[28]</xref>. This has three implications for calibration. Firstly, an input that gives a good match to historical data will not necessarily give a good prediction of future data; the simulator may be overfitted. Secondly, an input that does <italic>not</italic> give a good match to one physical output quantity may <italic>still</italic> give a good prediction of another physical output quantity, if the simulator models some quantities more accurately than others. Thirdly, if the inputs are physically observable quantities (that could, in principle, be learnt independently of the simulator), failing to account for an imperfect simulator can lead to overconfident posterior distributions that are centred on the wrong values <xref ref-type="bibr" rid="pcbi.1003968-Brynjarsdottir1">[42]</xref>.</p>
<p>We refer to this final source of uncertainty as Model Discrepancy (MD) <xref ref-type="bibr" rid="pcbi.1003968-Kennedy1">[25]</xref>. Incorporating model discrepancy protects against overfitting, ensures that we do not exclude possible values of future observations, when the exclusion would be unwarranted, is necessary for inferring the true values of simulator inputs, when the notion of a true input value is clearly understood, and is required for making realistic forecasts (<xref ref-type="bibr" rid="pcbi.1003968-Vernon1">[35]</xref>, <xref ref-type="bibr" rid="pcbi.1003968-Goldstein3">[43]</xref>).</p>
<p>In summary, we link the observation of the physical process to the best simulator input, which we denote by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e034" xlink:type="simple"/></inline-formula> via <disp-formula id="pcbi.1003968.e035"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003968.e035" xlink:type="simple"/><label>(2)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e036" xlink:type="simple"/></inline-formula> is a vector of errors representing observation uncertainty, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e037" xlink:type="simple"/></inline-formula> is a vector of errors representing ensemble variability, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e038" xlink:type="simple"/></inline-formula> is a vector of errors representing model discrepancy, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e039" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e040" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e041" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e042" xlink:type="simple"/></inline-formula> are judged to be independent <xref ref-type="bibr" rid="pcbi.1003968-Kennedy1">[25]</xref>.</p>
</sec><sec id="s2c">
<title>Procedure</title>
<p><xref ref-type="fig" rid="pcbi-1003968-g002">Fig. 2</xref> shows a typical history matching workflow. The first step is the selection of a number of input values (design points) at which the simulator is run. The initial inputs are chosen using a maximin Latin hypercube design <xref ref-type="bibr" rid="pcbi.1003968-McKay1">[44]</xref>, which generates uniformly distributed points, but also aims to fill the entire input space, by maximising the minimum distance between the points generated. The number of points <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e043" xlink:type="simple"/></inline-formula> in this initial design depends on the available computational resources. A very approximate rule of thumb is to use at least <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e044" xlink:type="simple"/></inline-formula> for training the emulator and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e045" xlink:type="simple"/></inline-formula> points for validation <xref ref-type="bibr" rid="pcbi.1003968-Loeppky1">[45]</xref>.</p>
<fig id="pcbi-1003968-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003968.g002</object-id><label>Figure 2</label><caption>
<title>History matching workflow.</title>
<p>The simulator is evaluated at carefully selected design points. Its output is used to train the emulator, which, with the help of the implausibility measure, determines the parts of the input space which are non-implausible (NI). The simulator is then evaluated at set of design points from the non-implausible space and the procedure is repeated until one or more stopping criteria are met.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003968.g002" position="float" xlink:type="simple"/></fig>
<p>Once the initial design space, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e046" xlink:type="simple"/></inline-formula>, is specified, the simulator is run at the selected points <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e047" xlink:type="simple"/></inline-formula>. Following the notation set out in <xref ref-type="disp-formula" rid="pcbi.1003968.e019">equation 1</xref>, we construct <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e048" xlink:type="simple"/></inline-formula> separate emulators: one for the mean of each output <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e049" xlink:type="simple"/></inline-formula>, with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e050" xlink:type="simple"/></inline-formula>. For the <italic>j</italic>-th output, the training data takes the following form. We choose the training inputs <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e051" xlink:type="simple"/></inline-formula> and for each input value <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e052" xlink:type="simple"/></inline-formula>, we run the simulator <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e053" xlink:type="simple"/></inline-formula> times, to generate observations <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e054" xlink:type="simple"/></inline-formula>. We then calculate the sample mean and variance of the simulator runs at input <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e055" xlink:type="simple"/></inline-formula>:<disp-formula id="pcbi.1003968.e056"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003968.e056" xlink:type="simple"/><label>(3)</label></disp-formula></p>
<p><disp-formula id="pcbi.1003968.e057"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003968.e057" xlink:type="simple"/><label>(4)</label></disp-formula></p>
<p>The training data point for input <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e058" xlink:type="simple"/></inline-formula> is then <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e059" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e060" xlink:type="simple"/></inline-formula> is an estimate of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e061" xlink:type="simple"/></inline-formula>. The number of runs (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e062" xlink:type="simple"/></inline-formula>) per input point are determined by the simulator's complexity and the available computational power. A relatively large number of repetitions (e.g. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e063" xlink:type="simple"/></inline-formula>) will ensure that the error in the estimate is approximately normally distributed with expectation 0 and variance <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e064" xlink:type="simple"/></inline-formula> even if the individual <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e065" xlink:type="simple"/></inline-formula> terms are not normally distributed. Once we have built the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e066" xlink:type="simple"/></inline-formula>th emulator, we can efficiently obtain an expected value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e067" xlink:type="simple"/></inline-formula> and variance for any <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e068" xlink:type="simple"/></inline-formula>, in particular for input values where we have <italic>not</italic> run the simulator. We denote this expectation and variance by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e069" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e070" xlink:type="simple"/></inline-formula>, where the superscript <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e071" xlink:type="simple"/></inline-formula> indicates that the expectation and variance refer to code uncertainty: the fact that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e072" xlink:type="simple"/></inline-formula> is an uncertain quantity. Other approaches of emulating separately the simulator's mean and variance are also possible <xref ref-type="bibr" rid="pcbi.1003968-Henderson1">[33]</xref>, <xref ref-type="bibr" rid="pcbi.1003968-Vernon3">[39]</xref>, <xref ref-type="bibr" rid="pcbi.1003968-Vernon4">[40]</xref>. It should be noted that often some of the outputs are difficult to emulate in the first few waves, in which case we would emulate a subset of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e073" xlink:type="simple"/></inline-formula> outputs initially, emulating the remaining outputs in later waves, when the process becomes easier due to the reduced size of the input space. More detail on emulation is given in section ‘Emulation’.</p>
<p><xref ref-type="fig" rid="pcbi-1003968-g003">Fig. 3(a)</xref> shows a simple example of a one dimensional emulator. The (toy) simulator used is the deterministic function <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e074" xlink:type="simple"/></inline-formula>. Because the simulator is deterministic, it holds that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e075" xlink:type="simple"/></inline-formula>. The value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e076" xlink:type="simple"/></inline-formula> is considered unknown apart from the six points <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e077" xlink:type="simple"/></inline-formula> where the simulator is run and are represented by the black dots in the figure. The blue line is the emulator's posterior mean, and the red lines represent its posterior uncertainty (95% CI). The 3 horizontal lines represent the empirical data (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e078" xlink:type="simple"/></inline-formula>) and the 95% CI (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e079" xlink:type="simple"/></inline-formula>) that we use to history match the simulator.</p>
<fig id="pcbi-1003968-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003968.g003</object-id><label>Figure 3</label><caption>
<title>Example emulator and implausibility for toy simulator [<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e080" xlink:type="simple"/></inline-formula>].</title>
<p>Panel (a) shows an emulator of the toy simulator <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e081" xlink:type="simple"/></inline-formula> (black dashed line). The value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e082" xlink:type="simple"/></inline-formula> is considered unknown apart from six points where the simulator is run and are represented by the black dots in the figure. The blue line is the emulator's posterior mean, and the red lines represent its posterior uncertainty (95% CI). The 3 horizontal lines represent the empirical data (mean value and 95% CI) that we use to history match the simulator. Panel (b) shows the implausibility for the emulator and the empirical data shown in panel (a). The implausibility is large when the emulator's posterior mean is far from the empirical data, relatively to the uncertainties present in the system (observation and code uncertainty in this case). The horizontal green line is an implausibility cut-off, which determines whether an input <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e083" xlink:type="simple"/></inline-formula> is implausible or not.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003968.g003" position="float" xlink:type="simple"/></fig>
<p>The next step involves choosing an implausibility measure and defining its various components. The implausibility is an essential element of history matching and is a measure that estimates whether the input <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e084" xlink:type="simple"/></inline-formula> is likely to result in an output that will match the observations. It essentially weighs the difference between <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e085" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e086" xlink:type="simple"/></inline-formula> with all the uncertainties that are present in the system. The implausibility is large when the emulator's posterior mean is far from the empirical data, relative to the uncertainties present in the system (observation and code uncertainty in this case). An analytical description of how the implausibility can be formulated is provided in section ‘Implausibility measure’.</p>
<p><xref ref-type="fig" rid="pcbi-1003968-g003">Fig. 3(b)</xref> shows the implausibility for the emulator and empirical data from <xref ref-type="fig" rid="pcbi-1003968-g003">Fig. 3(a)</xref>. The horizontal green line is an implausibility cut-off, which determines whether an input <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e087" xlink:type="simple"/></inline-formula> is implausible or not. The implausibility plot shows that a match between the simulator's output and the empirical data is unlikely to be found for values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e088" xlink:type="simple"/></inline-formula> smaller than 30 and larger than 45.</p>
<p>With the emulators and the implausibility measure at our disposal we can then carry out two key functions of history matching: the first is to sample the non-implausible space and study its distribution. This can reveal input combinations that can lead to acceptable matches, correlations between inputs and detailed insight into the model's structure. The second function is the creation of a design that is space filling over the current non-implausible space, which will be used to run the simulator in the next wave (iteration) of history matching.</p>
<p>The simplest method for sampling the non-implausible space, is to draw samples uniformly from the entire input space and reject those that fail the implausibility criteria. This method is computationally straightforward, but it can become inefficient when the non-implausible space is a tiny fraction of the original space, which is often true, especially in later waves. A method for solving this problem using an evolutionary Monte Carlo algorithm was proposed in <xref ref-type="bibr" rid="pcbi.1003968-Williamson2">[46]</xref>. In this paper, we propose a simpler but also effective method. Suppose that in wave <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e089" xlink:type="simple"/></inline-formula> we have a number of non-implausible points <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e090" xlink:type="simple"/></inline-formula>. For each of these, we draw <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e091" xlink:type="simple"/></inline-formula> samples from a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e092" xlink:type="simple"/></inline-formula>variate normal distribution that is centered on the value of the generating point. The <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e093" xlink:type="simple"/></inline-formula> wave implausibility is then evaluated on the new samples and the variance of the normal distribution is selected so that a small percentage of them (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e094" xlink:type="simple"/></inline-formula>) are non-implausible. The low acceptance rates should ensure that the new samples are sufficiently different from the old ones. This method can efficiently generate an adequate number of data points that can be used in subsequent waves.</p>
<p>A subset of the non-implausible samples drawn are then used to run the simulator and repeat another wave of history matching. The code or emulator uncertainty decreases with each iteration for the following reasons. At each wave, the emulators are only constructed over a smaller region of input space compared to the previous wave, and therefore the mean of the simulator outputs are usually smoother functions of the input parameters and hence easier to emulate accurately. Also there is a higher density of simulator runs in the new reduced input space, which again leads to improvements due to the Gaussian process part of the emulator as described in section ‘What is an emulator?’. There may be additional benefits due to active variable selection as discussed in <xref ref-type="bibr" rid="pcbi.1003968-Vernon1">[35]</xref>, <xref ref-type="bibr" rid="pcbi.1003968-Vernon2">[37]</xref>, and new outputs that were previously difficult to emulate may now become available. A major reason for the power of the history matching approach described here, is due to the above improvements to the emulation process at each wave, allowing the iterative exploration of complex input spaces.</p>
<p><xref ref-type="fig" rid="pcbi-1003968-g004">Fig. 4</xref> shows the second wave of history matching for the running example of this section. The simulator was run for the non-implausible value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e095" xlink:type="simple"/></inline-formula> and this point was included in the training data. Note how the emulator's posterior variance has decreased in the region of interest. Consequently, the non-implausible region has shrunk dramatically, indicating that a match can only be found for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e096" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e097" xlink:type="simple"/></inline-formula>, where indeed the function <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e098" xlink:type="simple"/></inline-formula> takes values between −0.8 and −0.63.</p>
<fig id="pcbi-1003968-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003968.g004</object-id><label>Figure 4</label><caption>
<title>Second history matching wave for the toy simulator <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e099" xlink:type="simple"/></inline-formula>.</title>
<p>Panel (a) shows an emulator of the toy simulator <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e100" xlink:type="simple"/></inline-formula> (black dashed line). The value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e101" xlink:type="simple"/></inline-formula> is considered unknown apart from seven points where the simulator is run and are represented by the black dots in the figure. The blue line is the emulator's posterior mean, and the red lines represent its posterior uncertainty (95% CI). The 3 horizontal lines represent the empirical data (mean value and 95% CI) that we use to history match the simulator. Panel (b) shows the implausibility for the emulator and the empirical data shown in panel (a). The implausibility is large when the emulator's posterior mean is far from the empirical data, relatively to the uncertainties present in the system (observation and code uncertainty in this case). The horizontal green line is an implausibility cut-off, which determines whether an input <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e102" xlink:type="simple"/></inline-formula> is implausible or not.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003968.g004" position="float" xlink:type="simple"/></fig>
<p>The procedure can continue with more waves until one or more stopping criteria are met. One such criterion is when all the input space is deemed non-implausible, meaning that the simulator cannot match the observations given the current error specifications. In this case one would then vary the size of the model discrepancy to determine how large it would have to be to obtain a match: a very large model discrepancy would suggest that the simulator is inadequate as a model for the physical process in question, and that further model development is required.</p>
<p>Another stopping criterion occurs when the emulators have a posterior variance smaller than the remaining uncertainties in the system (the observation uncertainty, model discrepancy and the ensemble variability), as this condition implies that the non-implausible space contains acceptable matches and is unlikely to decrease in size in the next iteration, unless the remaining uncertainties in the system can be revised and decreased as well. Here we would check the acceptable matches against any other outputs that were not used in the emulation process. A final condition for stopping could be the fact that the simulator runs obtained in the current wave are close enough to the empirical data and we do not wish to continue any further. In these two cases, we would investigate the sensitivity and robustness of the non-implausible region obtained from the history match, to alterations in the observation uncertainties and model discrepancy <xref ref-type="bibr" rid="pcbi.1003968-Vernon5">[47]</xref>.</p>
</sec><sec id="s2d">
<title>Emulation</title>
<sec id="s2d1">
<title>What is an emulator?</title>
<p>An emulator represents our beliefs about the behaviour of an unknown function. In this application, where the simulator is stochastic, the unknown function is taken to be the mean of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e103" xlink:type="simple"/></inline-formula> output of the simulator denoted as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e104" xlink:type="simple"/></inline-formula>. This function is observed (with error in the stochastic case) only at a limited number of points, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e105" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e106" xlink:type="simple"/></inline-formula>, known as design points. An emulator also has a number of parameters <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e107" xlink:type="simple"/></inline-formula> that determine its characteristics, (e.g. smoothness), the estimation of which is referred to as <italic>training</italic>. The emulator provides a probability distribution for the mean of the simulator's output at an untested input point <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e108" xlink:type="simple"/></inline-formula>, conditional on the simulator runs <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e109" xlink:type="simple"/></inline-formula> and an estimate of the parameters <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e110" xlink:type="simple"/></inline-formula>, i.e. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e111" xlink:type="simple"/></inline-formula>.</p>
<p>The emulators we consider in this paper have the form: <disp-formula id="pcbi.1003968.e112"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003968.e112" xlink:type="simple"/><label>(5)</label></disp-formula></p>
<p>The first part is a regression term, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e113" xlink:type="simple"/></inline-formula> are known deterministic functions of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e114" xlink:type="simple"/></inline-formula> and the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e115" xlink:type="simple"/></inline-formula> are the regression coefficients. The second part of the emulator is a stochastic process, known as a Gaussian process, which is stationary, with zero mean and constant variance <xref ref-type="bibr" rid="pcbi.1003968-Kennedy1">[25]</xref>, <xref ref-type="bibr" rid="pcbi.1003968-Rasmussen1">[48]</xref>.</p>
<p>For a number of discrete points <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e116" xlink:type="simple"/></inline-formula>, the model of <xref ref-type="disp-formula" rid="pcbi.1003968.e112">equation 5</xref> implies that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e117" xlink:type="simple"/></inline-formula> will follow the joint normal distribution <disp-formula id="pcbi.1003968.e118"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003968.e118" xlink:type="simple"/><label>(6)</label></disp-formula></p>
<p>The summation term represents the emulator's mean, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e119" xlink:type="simple"/></inline-formula> is the variance parameter and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e120" xlink:type="simple"/></inline-formula> is the correlation function of the Gaussian process. The emulator's parameters are the triplet <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e121" xlink:type="simple"/></inline-formula>, with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e122" xlink:type="simple"/></inline-formula> being some parameters specific to the correlation function <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e123" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pcbi.1003968-Andrianakis1">[49]</xref>. Details about the correlation function and the specifics of building an emulator including the choices of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e124" xlink:type="simple"/></inline-formula> are provided in section ‘Extensions’ and in <xref ref-type="supplementary-material" rid="pcbi.1003968.s001">S1 Text</xref>.</p>
<p><italic>Training.</italic> One way of training the emulator is by maximising the likelihood <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e125" xlink:type="simple"/></inline-formula> to obtain point estimates <disp-formula id="pcbi.1003968.e126"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003968.e126" xlink:type="simple"/><label>(7)</label></disp-formula></p>
<p>An alternative method is to define a prior distribution for the parameters <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e127" xlink:type="simple"/></inline-formula> and marginalise them in the Bayesian sense, either analytically or numerically. In this work, we marginalise analytically the parameters <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e128" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e129" xlink:type="simple"/></inline-formula>. Since the marginalisation of the parameters <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e130" xlink:type="simple"/></inline-formula> is not analytically tractable, we use point estimates, as the computational simplicity of this approach was found to outweigh the benefits of numerical marginalisation. Such use of point estimates has been successfully applied in <xref ref-type="bibr" rid="pcbi.1003968-Kennedy1">[25]</xref>, <xref ref-type="bibr" rid="pcbi.1003968-Vernon1">[35]</xref> and for a discussion see <xref ref-type="bibr" rid="pcbi.1003968-Bayarri1">[32]</xref>. Another successful approach is not to view the correlation lengths <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e131" xlink:type="simple"/></inline-formula> as parameters to be estimated or marginalised over, but instead to view them as direct prior quantities, the values of which can be asserted a priori using a variety of heuristic arguments, as described in <xref ref-type="bibr" rid="pcbi.1003968-Vernon1">[35]</xref>.</p>
<p><italic>Validation</italic>. After training the emulator it is necessary to perform some diagnostics that ensure that the emulator is sufficiently accurate. <xref ref-type="bibr" rid="pcbi.1003968-Bastos1">[50]</xref> provide a number of such diagnostics, such as the Mahalanobis distance, the analysis of prediction errors, the pivoted Cholesky decomposition etc., that can diagnose most failings of an emulator and suggest possible remedies. In the present case study we reserved approximately 20 model runs at each wave which were used to check the emulators' predictive performance.</p>
</sec><sec id="s2d2">
<title>Extensions</title>
<p>What we described above is a basic procedure for building an emulator. Some useful extensions to the basic methodology are given below.</p>
<p><italic>Mean and correlation function.</italic> The regression functions <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e132" xlink:type="simple"/></inline-formula> can have a very simple form, such as a constant <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e133" xlink:type="simple"/></inline-formula> or a simple polynomial <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e134" xlink:type="simple"/></inline-formula>, with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e135" xlink:type="simple"/></inline-formula> denoting vector transpose. However, they can be arbitrarily complicated or have a form that explains the data best. Examples of more complex polynomials and relevant selection procedures can be found in <xref ref-type="bibr" rid="pcbi.1003968-Vernon1">[35]</xref>. Similarly, there is a wide variety of correlation functions that can be used, depending on beliefs about the simulator's smoothness and differentiability <xref ref-type="bibr" rid="pcbi.1003968-Rasmussen1">[48]</xref>.</p>
<p><italic>Transformations.</italic> In many cases, the Gaussian process model of <xref ref-type="disp-formula" rid="pcbi.1003968.e112">equation 5</xref> might be better suited to a transformed version of the simulator's output. Applying a transformation that makes the output more Gaussian can benefit the emulation process. Mapping all the input ranges to the [0,1] range is another common practice that helps fitting and interpreting the Gaussian process part of the emulator.</p>
<p><italic>Multiple outputs.</italic> The simplest way of emulating a multi-output simulator is via an array of independent univariate emulators. This is the approach we take in this paper. However, if one is interested in correlations between outputs, multi-output emulators can take these into account <xref ref-type="bibr" rid="pcbi.1003968-Higdon1">[34]</xref>, <xref ref-type="bibr" rid="pcbi.1003968-Conti1">[51]</xref>–<xref ref-type="bibr" rid="pcbi.1003968-Fricker1">[53]</xref>.</p>
</sec></sec><sec id="s2e">
<title>Implausibility measure</title>
<sec id="s2e1">
<title>One dimensional implausibility</title>
<p>The implausibility measure is a function of the input <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e136" xlink:type="simple"/></inline-formula>, and returns a large value if it is unlikely that evaluation of the simulator at input <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e137" xlink:type="simple"/></inline-formula> would result in an acceptable match between the simulator's output and the empirical data, given all current uncertainties. For one output of the simulator it can be written as<disp-formula id="pcbi.1003968.e138"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003968.e138" xlink:type="simple"/><label>(8)</label></disp-formula></p>
<p>The term <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e139" xlink:type="simple"/></inline-formula> represents the variance associated with the observation uncertainty. The <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e140" xlink:type="simple"/></inline-formula> term represents the code uncertainty as given by the emulator and is hence set to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e141" xlink:type="simple"/></inline-formula>. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e142" xlink:type="simple"/></inline-formula> is the ensemble variability representing the stochastic nature of the simulator. For simplicity, it can be assumed to be constant over the input space and set equal to the mean of the sample variances obtained in the current wave: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e143" xlink:type="simple"/></inline-formula>. In the case study described in section ‘<xref ref-type="sec" rid="s3">Results</xref>’ we make the more conservative choice of setting <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e144" xlink:type="simple"/></inline-formula> equal to the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e145" xlink:type="simple"/></inline-formula> percentile of the sample variances. A more advanced but also more complex method is described in <xref ref-type="bibr" rid="pcbi.1003968-Vernon3">[39]</xref>, <xref ref-type="bibr" rid="pcbi.1003968-Vernon4">[40]</xref>, whereby the variance of the simulator is also emulated allowing <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e146" xlink:type="simple"/></inline-formula> to be made an explicit function of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e147" xlink:type="simple"/></inline-formula>. Finally, the model discrepancy term is represented by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e148" xlink:type="simple"/></inline-formula>. Ideally, its exact form is elicited from model experts, who are asked to quantitatively assess the simulator inaccuracy for different outputs, due for example to known defects, missing components or insufficient modelling detail <xref ref-type="bibr" rid="pcbi.1003968-Vernon1">[35]</xref>. An alternative approach is to incorporate discrepancy parameters within the simulator, with the effect that the elicitation task is broken down into considering individual sources of discrepancy within the model (<xref ref-type="bibr" rid="pcbi.1003968-Goldstein2">[30]</xref>, <xref ref-type="bibr" rid="pcbi.1003968-Strong1">[54]</xref>).</p>
<p>In this work, we take the much simpler approach of considering it equal to 10% of the variance of the simulator output training data <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e149" xlink:type="simple"/></inline-formula> obtained at each wave. This conservative choice is made for illustrative purposes, so that all of the different sources of uncertainty will contribute to the final answer. A full analysis would involve a combination of elicitation and sensitivity analysis regarding the specific judgements made <xref ref-type="bibr" rid="pcbi.1003968-Vernon5">[47]</xref>. It should be noted that the effect of incorporating any amount of discrepancy is simply to expand the set of inputs that are classified as non-implausible. Typically, at the final wave, we will still have a reasonable proportion of inputs classified in both the implausible and non-implausible sets, and the simulator user can investigate the effects of changing the simulator discrepancy variance (or even setting it to 0) without difficulty <xref ref-type="bibr" rid="pcbi.1003968-Vernon5">[47]</xref>. (If, however, all inputs are classified as non-implausible at the final wave, inflating the discrepancy variance at this stage would not change the classification.)</p>
<p>A large value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e150" xlink:type="simple"/></inline-formula> would indicate that despite the uncertainties present in the system, our prediction about the simulator's output for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e151" xlink:type="simple"/></inline-formula> is so far from the observed value <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e152" xlink:type="simple"/></inline-formula>, that the simulator is very unlikely to match the data at that particular point. However, we still need to find a value <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e153" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e154" xlink:type="simple"/></inline-formula> that will act as a cut off, such that all <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e155" xlink:type="simple"/></inline-formula> for which <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e156" xlink:type="simple"/></inline-formula> will be deemed implausible. Such a cut off can be provided by Pukelsheim's <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e157" xlink:type="simple"/></inline-formula> rule <xref ref-type="bibr" rid="pcbi.1003968-Pukelsheim1">[55]</xref>. This rule states that <italic>any</italic> continuous unimodal distribution contains at least <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e158" xlink:type="simple"/></inline-formula> of its probability mass within a distance of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e159" xlink:type="simple"/></inline-formula> from its mean, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e160" xlink:type="simple"/></inline-formula> is its standard deviation: an extremely powerful and general result. If we consider that for a fixed <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e161" xlink:type="simple"/></inline-formula> the random quantity <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e162" xlink:type="simple"/></inline-formula> has a unimodal distribution, and suppose that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e163" xlink:type="simple"/></inline-formula> is an input that matches the simulator's output to the empirical data, then according to Pukelsheim's rule we would have <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e164" xlink:type="simple"/></inline-formula> for at least <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e165" xlink:type="simple"/></inline-formula> of the time. The above argument provides a way of assessing the magnitude of the one dimensional implausibility, without being forced into making full distributional assumptions for all quantities involved in <xref ref-type="disp-formula" rid="pcbi.1003968.e138">equation 8</xref>.</p>
</sec><sec id="s2e2">
<title>Multi-dimensional implausibility</title>
<p>In the case of a multi-output simulator, the simplest approach is to construct one implausibility per output, i.e. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e166" xlink:type="simple"/></inline-formula>, for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e167" xlink:type="simple"/></inline-formula> and consider the maximum implausibility at <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e168" xlink:type="simple"/></inline-formula> <disp-formula id="pcbi.1003968.e169"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003968.e169" xlink:type="simple"/><label>(9)</label></disp-formula></p>
<p>Considering the second (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e170" xlink:type="simple"/></inline-formula>) or third (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e171" xlink:type="simple"/></inline-formula>) highest implausibility for each <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e172" xlink:type="simple"/></inline-formula> and applying appropriate cut-off values to each measure is another option, as is implemented in <xref ref-type="bibr" rid="pcbi.1003968-Vernon1">[35]</xref>.</p>
<p>The implausibility also comes in a multivariate form which is given by <disp-formula id="pcbi.1003968.e173"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003968.e173" xlink:type="simple"/><label>(10)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e174" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e175" xlink:type="simple"/></inline-formula> are vectors of length <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e176" xlink:type="simple"/></inline-formula>, and the quantities <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e177" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e178" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e179" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e180" xlink:type="simple"/></inline-formula> are all now covariance matrices of dimension <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e181" xlink:type="simple"/></inline-formula>. Often it can be difficult both to specify the full covariance structure for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e182" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e183" xlink:type="simple"/></inline-formula>, and to calculate it for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e184" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e185" xlink:type="simple"/></inline-formula> (which would require more advanced multivariate emulators). A common approach is to assume the outputs are uncorrelated and hence that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e186" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e187" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e188" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e189" xlink:type="simple"/></inline-formula> are all diagonal matrices, with the univariate variance that corresponds to the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e190" xlink:type="simple"/></inline-formula> simulator output (given in the denominator of <xref ref-type="disp-formula" rid="pcbi.1003968.e138">equation 8</xref>) being placed in the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e191" xlink:type="simple"/></inline-formula> position in the diagonal. Cut-off values for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e192" xlink:type="simple"/></inline-formula> can be found for example from a suitably high percentile (e.g. 95%, 99%) of the chi-squared distribution with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e193" xlink:type="simple"/></inline-formula> degrees of freedom, as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e194" xlink:type="simple"/></inline-formula> can be seen as a squared sum of variance normalised random variables (see <xref ref-type="bibr" rid="pcbi.1003968-Vernon1">[35]</xref>).</p>
<p>Let us finally note that the above forms of implausibility (e.g. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e195" xlink:type="simple"/></inline-formula>) along with their appropriately chosen cutoffs, can be used simultaneously, and require a point <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e196" xlink:type="simple"/></inline-formula> to have a low score in all the above measures so as to be considered non-implausible.</p>
</sec></sec><sec id="s2f">
<title>Posterior sampling</title>
<p>By design, history matching excludes parts of the input space that produce poor fits to the empirical data and leads to, where possible, the generation of a large number of runs that give acceptable fits to the observed data. Often this is sufficient for model analysis, e.g. to help understand the biological or epidemiological mechanisms underlying the physical system, and model development to determine the next improvement to the mathematical model and hence the next extension to the computer code. However, history matching does not provide full Bayesian posterior distributions for the uncertain quantities of interest (for example, the input parameters). Were it the case that full posterior distributions are required, for say a highly accurate, well tested and well understood epidemiology model, we now show how the results of history matching, specifically the identification of the final non-implausible region of input space (which should enclose the posterior distribution), can be used to obtain samples from the posterior. Such information from the posterior can be used for many tasks such as comparing competing models, and also when making forecasts into the future (a typical use of epidemic models).</p>
<p>Let <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e197" xlink:type="simple"/></inline-formula> be the non-implausible samples from the last wave of history matching. We formulate the following proposal distribution <disp-formula id="pcbi.1003968.e198"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003968.e198" xlink:type="simple"/><label>(11)</label></disp-formula>which is a multivariate normal distribution, with mean chosen to be the sample mean <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e199" xlink:type="simple"/></inline-formula> of the non-implausible samples <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e200" xlink:type="simple"/></inline-formula> and with variance chosen to be <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e201" xlink:type="simple"/></inline-formula> multiplied by the sample variance-covariance matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e202" xlink:type="simple"/></inline-formula> of the non-implausible samples. The constant <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e203" xlink:type="simple"/></inline-formula> is used to inflate the variance of the non-implausible samples, so that the method explores a larger part of the input space, as this was found to improve the sampling process. We define the approximate likelihood of the input parameters <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e204" xlink:type="simple"/></inline-formula> with observed data <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e205" xlink:type="simple"/></inline-formula> as<disp-formula id="pcbi.1003968.e206"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003968.e206" xlink:type="simple"/><label>(12)</label></disp-formula>with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e207" xlink:type="simple"/></inline-formula>. This follows from <xref ref-type="disp-formula" rid="pcbi.1003968.e035">equation 2</xref> combined with the additional assumptions that the observation error <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e208" xlink:type="simple"/></inline-formula>, model discrepancy <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e209" xlink:type="simple"/></inline-formula>, ensemble variability <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e210" xlink:type="simple"/></inline-formula> and the emulator representation of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e211" xlink:type="simple"/></inline-formula> are all normally distributed. Such normality assumptions for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e212" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e213" xlink:type="simple"/></inline-formula> are very common (see for example <xref ref-type="bibr" rid="pcbi.1003968-Kennedy1">[25]</xref>), and for the emulator this is simply equivalent to having sufficient runs to ensure the emulator's t-distribution can be viewed as approximately normal, as is described in <xref ref-type="supplementary-material" rid="pcbi.1003968.s001">S1 Text</xref>. The assumption of normality of the ensemble variability (which is directly analogous to the assumptions made in standard regression) may not be justified in some cases, however the above approximations can still be accurate when <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e214" xlink:type="simple"/></inline-formula> is smaller that the other variance components so that their total <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e215" xlink:type="simple"/></inline-formula> can still be considered approximately normal. More detailed modelling of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e216" xlink:type="simple"/></inline-formula> is of course possible <xref ref-type="bibr" rid="pcbi.1003968-Vernon3">[39]</xref>, <xref ref-type="bibr" rid="pcbi.1003968-Vernon4">[40]</xref>, and more complex distributions can be specified, however this would only be warranted if the epidemiology model was judged to be a sufficiently accurate mimic of reality that the details of the distribution of its ensemble variability were physically meaningful. In the case study described in section ‘<xref ref-type="sec" rid="s3">Results</xref>’, this was definitely not thought to be the case.</p>
<p>We assume that the prior <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e217" xlink:type="simple"/></inline-formula> is constant over the final non-implausible region found from the history match. This is in many cases reasonable as the volume of this region is often many orders of magnitude smaller that the original input space, and hence any prior that was not strongly informative would likely be approximately constant over such a small space. Note however, that the algorithm below can be easily adapted for any prior, by a suitable scaling of the weights.</p>
<p>The algorithm proceeds as follows: we first use the proposal distribution <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e218" xlink:type="simple"/></inline-formula> to generate a number of samples <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e219" xlink:type="simple"/></inline-formula>. We then calculate a weight for each sample as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e220" xlink:type="simple"/></inline-formula>. Finally, we draw the desired number of posterior samples <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e221" xlink:type="simple"/></inline-formula> from the set of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e222" xlink:type="simple"/></inline-formula>, with a probability defined by the weights <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e223" xlink:type="simple"/></inline-formula>. Provided the weights are reasonably well behaved, this will generate direct draws from the approximate posterior <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e224" xlink:type="simple"/></inline-formula>.</p>
</sec></sec><sec id="s3">
<title>Results</title>
<sec id="s3a">
<title>Simulator and empirical data</title>
<p>This case study was based on a research project that explored the effects of partnership concurrency (overlapping sexual partnerships) on HIV transmission in Uganda <xref ref-type="bibr" rid="pcbi.1003968-McCreesh1">[56]</xref>. The simulator used in the research study, named Mukwano, was a dynamic, stochastic, individual based computer model that simulates heterosexual sexual partnerships and HIV transmission. In an individual based micro simulation model, the life histories of hypothetical individuals are simulated over time in a computer program. Each individual is represented by a number of characteristics, of which some remain constant during simulated life (e.g. gender and date of birth), whereas others change (e.g. HIV status). Changes in personal characteristics result from events such as the start and the end of sexual relationships. These events are stochastic: if and when an event occurs is determined by Monte-Carlo sampling from probability distributions. To generate model outcomes for a simulated population, the characteristics of the simulated individuals are aggregated. The simulator had been fitted to empirical data in a number of scenarios by eye and by changing the values of inputs, which control various demographic, behavioural and epidemiologic characteristics of the simulated population <xref ref-type="bibr" rid="pcbi.1003968-McCreesh1">[56]</xref>.</p>
<p>Births, deaths, partnership formation and dissolution and HIV transmission were modelled using time-dependent rates. At birth, simulated individuals were assigned to one of two sexual activity groups (‘high activity’ and ‘low activity’) and to one of two concurrency groups (‘high concurrency’ and ‘low concurrency’). Each sexual activity group had associated male and female sexual contact rates, which determined the rate at which individuals formed new partnerships, which were of two types (‘short duration’ and ‘long duration’).</p>
<p>For the present case study, we apply our history matching and emulation methodology to the primary baseline scenario from <xref ref-type="bibr" rid="pcbi.1003968-McCreesh1">[56]</xref>, rather than fitting ‘by-eye’. Twenty behavioural and two epidemiologic inputs were varied, including a mixing parameter, which determines the tendency for individuals to preferentially form partnerships with people in their own activity group, and an input which determines the duration of the long and short duration partnerships. The behavioural inputs are permitted to take different values in each of three calendar time periods. This enables sexual behaviour to vary over time. The full list of the 22 simulator inputs and their original plausible ranges is shown in <xref ref-type="table" rid="pcbi-1003968-t001">Table 1</xref>.</p>
<table-wrap id="pcbi-1003968-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003968.t001</object-id><label>Table 1</label><caption>
<title>Simulator input parameter description and ranges.</title>
</caption><alternatives><graphic id="pcbi-1003968-t001-1" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003968.t001" xlink:type="simple"/>
<table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" rowspan="1" colspan="1">Number</td>
<td align="left" rowspan="1" colspan="1">Input description</td>
<td align="left" rowspan="1" colspan="1">Abbr.</td>
<td align="left" rowspan="1" colspan="1">Min.</td>
<td align="left" rowspan="1" colspan="1">Max.</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1">1</td>
<td align="left" rowspan="1" colspan="1">Proportion of men in the high sexual activity group</td>
<td align="left" rowspan="1" colspan="1"><italic>mhag</italic></td>
<td align="left" rowspan="1" colspan="1">0.01</td>
<td align="left" rowspan="1" colspan="1">0.5</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">2</td>
<td align="left" rowspan="1" colspan="1">Proportion of women in the high sexual activity group</td>
<td align="left" rowspan="1" colspan="1"><italic>whag</italic></td>
<td align="left" rowspan="1" colspan="1">0.01</td>
<td align="left" rowspan="1" colspan="1">0.5</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">3</td>
<td align="left" rowspan="1" colspan="1">Mixing by activity group [<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e225" xlink:type="simple"/></inline-formula>]</td>
<td align="left" rowspan="1" colspan="1"><italic>mag</italic></td>
<td align="left" rowspan="1" colspan="1">0</td>
<td align="left" rowspan="1" colspan="1">1</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">4</td>
<td align="left" rowspan="1" colspan="1">High activity contact rate (risk behaviour 1) [partners/yr]<xref ref-type="table-fn" rid="nt102">*</xref></td>
<td align="left" rowspan="1" colspan="1"><italic>hacr1</italic></td>
<td align="left" rowspan="1" colspan="1">0</td>
<td align="left" rowspan="1" colspan="1">10</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">5</td>
<td align="left" rowspan="1" colspan="1">Low activity contact rate (risk behaviour 1) [partners/yr]<xref ref-type="table-fn" rid="nt102">*</xref></td>
<td align="left" rowspan="1" colspan="1"><italic>lacr1</italic></td>
<td align="left" rowspan="1" colspan="1">0</td>
<td align="left" rowspan="1" colspan="1">2</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">6</td>
<td align="left" rowspan="1" colspan="1">Start year for risk behaviour 2</td>
<td align="left" rowspan="1" colspan="1"><italic>sy2</italic></td>
<td align="left" rowspan="1" colspan="1">1986</td>
<td align="left" rowspan="1" colspan="1">1992</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">7</td>
<td align="left" rowspan="1" colspan="1">High activity contact rate (risk behaviour 2) [partners/yr]<xref ref-type="table-fn" rid="nt102">*</xref></td>
<td align="left" rowspan="1" colspan="1"><italic>hacr2</italic></td>
<td align="left" rowspan="1" colspan="1">0</td>
<td align="left" rowspan="1" colspan="1">10</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">8</td>
<td align="left" rowspan="1" colspan="1">Low activity contact rate (risk behaviour 2) [partners/yr]<xref ref-type="table-fn" rid="nt102">*</xref></td>
<td align="left" rowspan="1" colspan="1"><italic>lacr2</italic></td>
<td align="left" rowspan="1" colspan="1">0</td>
<td align="left" rowspan="1" colspan="1">2</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">9</td>
<td align="left" rowspan="1" colspan="1">Start year for risk behaviour 3</td>
<td align="left" rowspan="1" colspan="1"><italic>sy3</italic></td>
<td align="left" rowspan="1" colspan="1">1998</td>
<td align="left" rowspan="1" colspan="1">2002</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">10</td>
<td align="left" rowspan="1" colspan="1">High activity contact rate (risk behaviour 3) [partners/yr]<xref ref-type="table-fn" rid="nt102">*</xref></td>
<td align="left" rowspan="1" colspan="1"><italic>hacr3</italic></td>
<td align="left" rowspan="1" colspan="1">0</td>
<td align="left" rowspan="1" colspan="1">10</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">11</td>
<td align="left" rowspan="1" colspan="1">Low activity contact rate (risk behaviour 3) [partners/yr]<xref ref-type="table-fn" rid="nt102">*</xref></td>
<td align="left" rowspan="1" colspan="1"><italic>lacr3</italic></td>
<td align="left" rowspan="1" colspan="1">0</td>
<td align="left" rowspan="1" colspan="1">2</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">12</td>
<td align="left" rowspan="1" colspan="1">Mean HIV transmission probability per sex act during primary stage of infection (mean of male to female and female to male transmission probabilities)</td>
<td align="left" rowspan="1" colspan="1"><italic>atp</italic></td>
<td align="left" rowspan="1" colspan="1">0</td>
<td align="left" rowspan="1" colspan="1">1</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">13</td>
<td align="left" rowspan="1" colspan="1">Ratio of male to female/female to male transmission probabilities</td>
<td align="left" rowspan="1" colspan="1"><italic>rtp</italic></td>
<td align="left" rowspan="1" colspan="1">1</td>
<td align="left" rowspan="1" colspan="1">3</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">14</td>
<td align="left" rowspan="1" colspan="1">Proportion of low activity men in high concurrency group</td>
<td align="left" rowspan="1" colspan="1"><italic>lmhc</italic></td>
<td align="left" rowspan="1" colspan="1">0</td>
<td align="left" rowspan="1" colspan="1">1</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">15</td>
<td align="left" rowspan="1" colspan="1">Proportion of low activity women in high concurrency group</td>
<td align="left" rowspan="1" colspan="1"><italic>lwhc</italic></td>
<td align="left" rowspan="1" colspan="1">0</td>
<td align="left" rowspan="1" colspan="1">1</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">16</td>
<td align="left" rowspan="1" colspan="1">Male concurrency parameter in high concurrency group (risk behaviour 1)</td>
<td align="left" rowspan="1" colspan="1"><italic>mchc1</italic></td>
<td align="left" rowspan="1" colspan="1">0</td>
<td align="left" rowspan="1" colspan="1">1</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">17</td>
<td align="left" rowspan="1" colspan="1">Female concurrency parameter in high concurrency group (risk behaviour 1)</td>
<td align="left" rowspan="1" colspan="1"><italic>fchc1</italic></td>
<td align="left" rowspan="1" colspan="1">0</td>
<td align="left" rowspan="1" colspan="1">1</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">18</td>
<td align="left" rowspan="1" colspan="1">Male concurrency parameter in high concurrency group (risk behaviour 2)</td>
<td align="left" rowspan="1" colspan="1"><italic>mchc2</italic></td>
<td align="left" rowspan="1" colspan="1">0</td>
<td align="left" rowspan="1" colspan="1">1</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">19</td>
<td align="left" rowspan="1" colspan="1">Female concurrency parameter in high concurrency group (risk behaviour 2)</td>
<td align="left" rowspan="1" colspan="1"><italic>fchc2</italic></td>
<td align="left" rowspan="1" colspan="1">0</td>
<td align="left" rowspan="1" colspan="1">1</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">20</td>
<td align="left" rowspan="1" colspan="1">Male concurrency parameter in high concurrency group (risk behaviour 3)</td>
<td align="left" rowspan="1" colspan="1"><italic>mchc3</italic></td>
<td align="left" rowspan="1" colspan="1">0</td>
<td align="left" rowspan="1" colspan="1">1</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">21</td>
<td align="left" rowspan="1" colspan="1">Female concurrency parameter in high concurrency group (risk behaviour 3)</td>
<td align="left" rowspan="1" colspan="1"><italic>fchc3</italic></td>
<td align="left" rowspan="1" colspan="1">0</td>
<td align="left" rowspan="1" colspan="1">1</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">22</td>
<td align="left" rowspan="1" colspan="1">Duration of long-duration partnerships [years]</td>
<td align="left" rowspan="1" colspan="1"><italic>dlp</italic></td>
<td align="left" rowspan="1" colspan="1">5</td>
<td align="left" rowspan="1" colspan="1">20</td>
</tr>
</tbody>
</table>
</alternatives><table-wrap-foot><fn id="nt101"><label/><p>These define the input parameter space over which the history match search is performed.</p></fn><fn id="nt102"><label/><p>*The simulator input parameters that codetermine partnership formation. The actual rate of partnership formation in the simulator will vary from this due to adjustment for concurrency and partnership balancing.</p></fn></table-wrap-foot></table-wrap>
<p>The simulator was history matched using 18 demographic, behavioural and epidemiologic outputs that include male and female population sizes, and male and female HIV prevalences at three time points. They also include a number of outputs that ensure that the prevalence and incidence of monogamous and concurrent sexual partnerships in the simulator closely matched the data from the empirical population. The empirical data were collected from a rural general population cohort in South-West Uganda. The cohort was established in 1989 and currently consists of the residents of 25 villages <xref ref-type="bibr" rid="pcbi.1003968-Mulder1">[57]</xref>–<xref ref-type="bibr" rid="pcbi.1003968-Seeley1">[59]</xref>. Every year, demographic information on the cohort is updated, the population was tested for HIV, and a behavioural questionnaire was conducted. In 2008, this included questions that allowed the prevalence of monogamous and concurrent short duration and long duration partnerships to be calculated. All 18 simulator outputs and their calibration targets are shown in <xref ref-type="table" rid="pcbi-1003968-t002">table 2</xref>. The intervals given for each of the outputs represent the limits for an acceptable match, and we consider them as 95% confidence intervals. Therefore, their mean value is used to define the value of the observed data <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e226" xlink:type="simple"/></inline-formula>, and their difference is chosen to represent 4 times the square root of the observation error <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e227" xlink:type="simple"/></inline-formula>.</p>
<table-wrap id="pcbi-1003968-t002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003968.t002</object-id><label>Table 2</label><caption>
<title>Description of simulator outputs and limits defined as an acceptable match.</title>
</caption><alternatives><graphic id="pcbi-1003968-t002-2" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003968.t002" xlink:type="simple"/>
<table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" rowspan="1" colspan="1">Number</td>
<td align="left" rowspan="1" colspan="1">Output description</td>
<td align="left" rowspan="1" colspan="1">Abbr.</td>
<td align="left" rowspan="1" colspan="1">Min.</td>
<td align="left" rowspan="1" colspan="1">Max.</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1">1</td>
<td align="left" rowspan="1" colspan="1">Population size in 2008 (male)</td>
<td align="left" rowspan="1" colspan="1"><italic>psm</italic></td>
<td align="left" rowspan="1" colspan="1">2986</td>
<td align="left" rowspan="1" colspan="1">3650</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">2</td>
<td align="left" rowspan="1" colspan="1">Population size in 2008 (female)</td>
<td align="left" rowspan="1" colspan="1"><italic>psf</italic></td>
<td align="left" rowspan="1" colspan="1">3374</td>
<td align="left" rowspan="1" colspan="1">4124</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">3</td>
<td align="left" rowspan="1" colspan="1">Average male partnership incidence in 2008 (partners/year)</td>
<td align="left" rowspan="1" colspan="1"><italic>ampi</italic></td>
<td align="left" rowspan="1" colspan="1">0.4</td>
<td align="left" rowspan="1" colspan="1">0.489</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">4</td>
<td align="left" rowspan="1" colspan="1">HIV prevalence in 1992 (male)</td>
<td align="left" rowspan="1" colspan="1"><italic>p92m</italic></td>
<td align="left" rowspan="1" colspan="1">0.084</td>
<td align="left" rowspan="1" colspan="1">0.112</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">5</td>
<td align="left" rowspan="1" colspan="1">HIV prevalence in 1992 (female)</td>
<td align="left" rowspan="1" colspan="1"><italic>p92f</italic></td>
<td align="left" rowspan="1" colspan="1">0.096</td>
<td align="left" rowspan="1" colspan="1">0.124</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">6</td>
<td align="left" rowspan="1" colspan="1">HIV prevalence in 2001 (male)</td>
<td align="left" rowspan="1" colspan="1"><italic>p01m</italic></td>
<td align="left" rowspan="1" colspan="1">0.07</td>
<td align="left" rowspan="1" colspan="1">0.09</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">7</td>
<td align="left" rowspan="1" colspan="1">HIV prevalence in 2001 (female)</td>
<td align="left" rowspan="1" colspan="1"><italic>p01f</italic></td>
<td align="left" rowspan="1" colspan="1">0.083</td>
<td align="left" rowspan="1" colspan="1">0.107</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">8</td>
<td align="left" rowspan="1" colspan="1">HIV prevalence in 2007 (male)</td>
<td align="left" rowspan="1" colspan="1"><italic>p07m</italic></td>
<td align="left" rowspan="1" colspan="1">0.06</td>
<td align="left" rowspan="1" colspan="1">0.084</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">9</td>
<td align="left" rowspan="1" colspan="1">HIV prevalence in 2007 (female)</td>
<td align="left" rowspan="1" colspan="1"><italic>p07f</italic></td>
<td align="left" rowspan="1" colspan="1">0.093</td>
<td align="left" rowspan="1" colspan="1">0.119</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">10</td>
<td align="left" rowspan="1" colspan="1">Point prevalence of men with 1 long duration partnership in 2008 (%)</td>
<td align="left" rowspan="1" colspan="1"><italic>m1l</italic></td>
<td align="left" rowspan="1" colspan="1">34.62</td>
<td align="left" rowspan="1" colspan="1">42.31</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">11</td>
<td align="left" rowspan="1" colspan="1">Point prevalence of men with 1 short duration partnership in 2008 (%)</td>
<td align="left" rowspan="1" colspan="1"><italic>m1s</italic></td>
<td align="left" rowspan="1" colspan="1">10.86</td>
<td align="left" rowspan="1" colspan="1">13.27</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">12</td>
<td align="left" rowspan="1" colspan="1">Point prevalence of men with 1 partnership (either type) in 2008 (%)</td>
<td align="left" rowspan="1" colspan="1"><italic>m1</italic></td>
<td align="left" rowspan="1" colspan="1">37.83</td>
<td align="left" rowspan="1" colspan="1">46.24</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">13</td>
<td align="left" rowspan="1" colspan="1">Point prevalence of men with 2+ long duration partnerships in 2008 (%)</td>
<td align="left" rowspan="1" colspan="1"><italic>m2l</italic></td>
<td align="left" rowspan="1" colspan="1">3.38</td>
<td align="left" rowspan="1" colspan="1">4.13</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">14</td>
<td align="left" rowspan="1" colspan="1">Point prevalence of men with 2+ short duration partnerships in 2008 (%)</td>
<td align="left" rowspan="1" colspan="1"><italic>m2s</italic></td>
<td align="left" rowspan="1" colspan="1">1.69</td>
<td align="left" rowspan="1" colspan="1">2.07</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">15</td>
<td align="left" rowspan="1" colspan="1">Point prevalence of men with 2+ partnerships (any combination) in 2008 (%)</td>
<td align="left" rowspan="1" colspan="1"><italic>m2</italic></td>
<td align="left" rowspan="1" colspan="1">8.66</td>
<td align="left" rowspan="1" colspan="1">10.59</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">16</td>
<td align="left" rowspan="1" colspan="1">Point prevalence of women with 2+ long duration partnerships in 2008 (%)</td>
<td align="left" rowspan="1" colspan="1"><italic>w2l</italic></td>
<td align="left" rowspan="1" colspan="1">0.85</td>
<td align="left" rowspan="1" colspan="1">1.03</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">17</td>
<td align="left" rowspan="1" colspan="1">Point prevalence of women with 2+ short duration partnerships in 2008 (%)</td>
<td align="left" rowspan="1" colspan="1"><italic>w2s</italic></td>
<td align="left" rowspan="1" colspan="1">0.42</td>
<td align="left" rowspan="1" colspan="1">0.52</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">18</td>
<td align="left" rowspan="1" colspan="1">Point prevalence of women with 2+ partnerships (any combination) in 2008 (%)</td>
<td align="left" rowspan="1" colspan="1"><italic>w2</italic></td>
<td align="left" rowspan="1" colspan="1">2.17</td>
<td align="left" rowspan="1" colspan="1">2.65</td>
</tr>
</tbody>
</table>
</alternatives></table-wrap>
<p>The simulator was run on a high performance cluster with 240 nodes. The run time for a single simulation varied between 10 minutes and 3 hours. One emulator evaluation on a standard laptop took approximately <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e228" xlink:type="simple"/></inline-formula> seconds, a speed ratio in the order of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e229" xlink:type="simple"/></inline-formula>. A simulation study with synthetic data and a smaller version of Mukwano, which demonstrates the validity of history matching is included in the online supplementary material.</p>
</sec><sec id="s3b">
<title>Wave 1</title>
<p>The first wave of emulators was trained using a 220 point maximin Latin hypercube design <xref ref-type="bibr" rid="pcbi.1003968-Santner1">[60]</xref>. A separate 20 point Latin hypercube was used for generating the validation data. The simulator was run <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e230" xlink:type="simple"/></inline-formula> times at each design point, to allow the estimation of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e231" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e232" xlink:type="simple"/></inline-formula> with sufficient accuracy, for subsequent use as plug-in estimates.</p>
<p>Univariate emulators were built and successfully passed the validation tests mentioned in section ‘What is an emulator?’ for 16 out of the 18 outputs. The emulators used a third order polynomial mean function (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e233" xlink:type="simple"/></inline-formula>) and the Matérn correlation function. If a more complex set of polynomials <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e234" xlink:type="simple"/></inline-formula> was used, various linear model selection methods can be employed as in <xref ref-type="bibr" rid="pcbi.1003968-Vernon1">[35]</xref>, <xref ref-type="bibr" rid="pcbi.1003968-Cumming1">[38]</xref>. The logit transformation was used for the outputs that by definition lay in the [0,1] interval. Similarly, all inputs were mapped to the [0,1] (unit interval) to facilitate the interpretation of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e235" xlink:type="simple"/></inline-formula> parameters. Emulators for outputs 8, 9 did not validate in the first attempt and rectifying this would have involved further efforts such as generating more design points, or using more detailed mean functions. These two outputs were left out of the first wave analysis, but this poses no problem to history matching, because the exclusion of non-implausible space does not require considering all outputs at once (unlike a likelihood based approach). All we require is a subset of outputs that will sufficiently reduce the non-implausible space at the current wave. In subsequent waves, the behaviour of these two outputs became more regular, and they were included in the analysis.</p>
<p>Drawing a large ensemble of non-implausible points for studying their distribution and for proposing the design for wave 2 was the next step in the analysis. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e236" xlink:type="simple"/></inline-formula> points were drawn from a 22 dimensional uniform distribution in [0,1] and the implausibility was evaluated for each one of them. The implausibility used in the first wave was the maximum implausibility (<xref ref-type="disp-formula" rid="pcbi.1003968.e169">equation 9</xref>) with the uncertainties specified as described in section ‘One dimensional implausibility’. On a regular laptop, the evaluation would have taken approximately 5 hours. However, since the whole process was very easy to parallelise, the evaluation was done on a 240 node cluster, and was completed in less than 5 minutes. Without the use of emulators and considering that the simulator was around <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e237" xlink:type="simple"/></inline-formula> times slower, and it was evaluated 100 times for each scenario, this procedure would have taken around 1000 years! From the proposed samples only 21644 passed the implausibility test, implying that the volume of non-implausible space at this wave is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e238" xlink:type="simple"/></inline-formula> of the original input space.</p>
<p>Visualising the distribution of the non-implausible points is conveniently done via minimum implausibility and optical depth plots <xref ref-type="bibr" rid="pcbi.1003968-Vernon1">[35]</xref>, such as the ones shown in <xref ref-type="fig" rid="pcbi-1003968-g005">Fig. 5</xref>. To construct the minimum implausibility points, two inputs <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e239" xlink:type="simple"/></inline-formula> are first selected and a rectangular grid covering their range is formed. The non-implausible points are placed in the respective bin of this grid, according to the value of their <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e240" xlink:type="simple"/></inline-formula> element. The plot shows the minimum implausibility value among all points in a given bin. Assuming a sufficiently large number of non-implausible samples, this kind of plot provides an empirical estimate of the minimum implausibility that can be expected if we were to fix inputs <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e241" xlink:type="simple"/></inline-formula> to a particular value, and hence shows locations in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e242" xlink:type="simple"/></inline-formula> space that can be ruled out as implausible, irrespective of the choices of all the 20 other inputs. The optical depth plots are constructed in the same fashion, but instead of displaying the minimum implausibility per grid point, they display an empirical estimate of the probability of encountering a non-implausible point for a given set of values for inputs <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e243" xlink:type="simple"/></inline-formula>. This estimate can be obtained from the ratio of non-implausible to total drawn points per bin. They therefore provide an estimate of the (higher-dimensional) depth of the non-implausible region, conditioned on the inputs <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e244" xlink:type="simple"/></inline-formula>.</p>
<fig id="pcbi-1003968-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003968.g005</object-id><label>Figure 5</label><caption>
<title>Minimum implausibility (a) and optical depth (b) plots for inputs 1 and 4 in wave 1.</title>
<p>Minimum implausibility plots show an estimate of the minimum implausibility for different values of pairs of inputs. Optical depth plots show an estimate of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e245" xlink:type="simple"/></inline-formula> probability of encountering a non-implausible point for different values of pairs of inputs.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003968.g005" position="float" xlink:type="simple"/></fig>
<p><xref ref-type="fig" rid="pcbi-1003968-g005">Fig. 5</xref> shows the minimum implausibility and depth plots for the percentage of men in high sexual activity group (<italic>mhag</italic>) and the contact rate for high activity group in the first period (<italic>hacr1</italic>). This figure shows that a match was unlikely to be found if both inputs take a large value. <xref ref-type="fig" rid="pcbi-1003968-g006">Fig. 6(a)</xref> shows the implausibility and depth plots for 8 of the most active inputs in wave 1. It is noticeable that the contact rates for the low activity groups in the first two periods (<italic>lacr1, lacr2</italic>), only lead to matches when they take a relatively small value (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e246" xlink:type="simple"/></inline-formula>). Finally, correlation patterns appear to emerge between a few input pairs, such as between inputs <italic>mhag</italic> and <italic>hacr1</italic>, and <italic>mhag</italic> and <italic>hacr3</italic>.</p>
<fig id="pcbi-1003968-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003968.g006</object-id><label>Figure 6</label><caption>
<title>Minimum implausibility (below and left of diagonal) and optical depth plots (above and right of diagonal) for 10 key inputs for waves 1,4,7,9.</title>
<p>Minimum implausibility plots show an estimate of the minimum implausibility for different values of pairs of inputs. Optical depth plots show an estimate of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e247" xlink:type="simple"/></inline-formula> probability of encountering a non-implausible point for different values of pairs of inputs.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003968.g006" position="float" xlink:type="simple"/></fig></sec><sec id="s3c">
<title>Waves 2–10</title>
<p>The design for wave 2 can be obtained by uniformly drawing <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e248" xlink:type="simple"/></inline-formula> points from the non-implausible space of wave 1. To ensure that these points are sufficiently separated from each other, several <italic>n</italic>-point designs were drawn and we then chose the one with the maximum minimum (maximin) distance between its points. The simulator was run at the selected design points and the whole process was repeated up to the end of wave 9, where it was decided to stop as 50% of the wave 9 simulator runs were non-implausible (see section ‘Implausibility of the simulator runs’). A further 500 wave 10 runs were carried out to provide us with an estimate of the probability that a wave 9 non-implausible point would actually result in an non-implausible simulator run. This estimate was 65% (see section ‘Implausibility of the simulator runs’).</p>
<p>During the course of the 9 waves, some modifications were made to the history matching apparatus, which are described below: for the first three waves only the maximum implausibility was used, with a cut-off value of 3. Due to reduced rejection rates, from wave 4 onwards an input <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e249" xlink:type="simple"/></inline-formula> was deemed non-implausible if it passed all 3 tests: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e250" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e251" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e252" xlink:type="simple"/></inline-formula>. The latter cut off was chosen as it approximately represents the 95% critical value of a chi squared distribution with 18 degrees of freedom. For the first 2 waves, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e253" xlink:type="simple"/></inline-formula> was set to a tenth of the simulator output variability as described in section ‘One dimensional implausibility’. The minimum between this value and 3 times the observation uncertainty was chosen for waves <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e254" xlink:type="simple"/></inline-formula>, an illustrative choice, thought to be conservative with respect to the opinion of the expert, which resulted in further increases in the rejection rates at each wave. Finally, as the emulator uncertainty was fairly large in the first 3 waves, it was decided from wave 4 onwards, to have 500 simulator runs per wave and also include in the training of the emulators any simulator runs from previous waves that were deemed as non-implausible.</p>
<p><xref ref-type="table" rid="pcbi-1003968-t003">Table 3</xref> shows the acceptance rates for all 9 waves. The acceptance rate for wave <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e255" xlink:type="simple"/></inline-formula> is defined as the proportion of non-implausible samples in wave <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e256" xlink:type="simple"/></inline-formula> that remain non-implausible in wave <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e257" xlink:type="simple"/></inline-formula>, multiplied by the acceptance rate of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e258" xlink:type="simple"/></inline-formula> wave. Thus, the acceptance rates are a measure of the original input space shrinkage, since they represent the proportion of points drawn at random from the original input space that will be non-implausible after <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e259" xlink:type="simple"/></inline-formula> waves.</p>
<table-wrap id="pcbi-1003968-t003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003968.t003</object-id><label>Table 3</label><caption>
<title>Acceptance rates for the 9 waves, expressing the probability that an input <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e260" xlink:type="simple"/></inline-formula> drawn at random from the original input space passes the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e261" xlink:type="simple"/></inline-formula> wave's implausibility test.</title>
</caption><alternatives><graphic id="pcbi-1003968-t003-3" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003968.t003" xlink:type="simple"/>
<table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/></colgroup>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1">Wave 1</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e262" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Wave 2</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e263" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Wave 3</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e264" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Wave 4</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e265" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Wave 5</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e266" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Wave 6</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e267" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Wave 7</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e268" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Wave 8</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e269" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Wave 9</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e270" xlink:type="simple"/></inline-formula></td>
</tr>
</tbody>
</table>
</alternatives><table-wrap-foot><fn id="nt103"><label/><p>At wave 9, the non-implausible region is a tiny fraction (10<sup>−11</sup>) of the original input space, implying that we have learnt a large amount from the history matching process.</p></fn></table-wrap-foot></table-wrap>
<p>At wave 9, the non-implausible region is a tiny fraction (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e271" xlink:type="simple"/></inline-formula>) of the original input space, implying that we have learnt a large amount from the history matching process.</p>
<p>For the first 5 waves, direct sampling from the input space and evaluation of the various implausibilities could generate sufficient numbers of non-implausible samples at a reasonable computational cost. The exclusion of large portions of inputs <italic>lacr1, lacr2, hacr3, lacr3</italic> from as early as the first few waves (e.g. see <xref ref-type="fig" rid="pcbi-1003968-g006">Fig. 6(b)</xref>) helped speed up the sampling process. From wave 6 onwards however, this direct sampling method was proving inadequate. To overcome this problem and as discussed in section ‘Procedure’, 10000 non-implausible samples from wave 5 were perturbed to generate 20 samples each using a zero mean multivariate normal distribution. The distribution's variance was chosen such that the rejection rate of the new samples using the wave 5 implausibility was around 80%. These samples were then subjected to the wave 6 implausibility, which resulted in approximately 10000 wave 6 non-implausible samples. The same procedure was followed for the subsequent waves. The implausibility plots for waves 4, 7, 9 are shown in <xref ref-type="fig" rid="pcbi-1003968-g006">Figs. 6(b–d)</xref>, which visualise the reduction of the non-implausible space in successive waves.</p>
<p>Apart from visualising the non-implausible space, implausibility plots can also reveal correlations that can exist between inputs: <xref ref-type="fig" rid="pcbi-1003968-g006">Fig. 6(d)</xref> shows that for the proportion of men in the high activity group (<italic>mhag</italic>) and for the high activity group contact rate in the third period (<italic>hacr3</italic>), non-implausible runs are unlikely to be found outside a narrow range of values. This is because if both are high (or low), the average male partnership incidence in 2008 will be unacceptably high (or low). It is only when one takes a high value and the other a low one, or both take intermediate values, that the partnership incidence output will fall within the acceptable limits.</p>
<p>A similar, although less correlated, relationship can be seen between the proportion of men in the high activity group (<italic>mhag</italic>) and the high activity group contact rates in the first and second periods (<italic>hacr1</italic>, <italic>hacr2</italic>). In these cases, when either both inputs are high or both are low, then the sexual behaviour outputs and the trend in HIV prevalence outputs cannot be fitted simultaneously. This is because if both are high then the very high levels of sexual activity during earlier years necessitate a very low HIV transmission probability in order to fit the earlier HIV prevalence output(s), which results in either the later HIV prevalence output(s) being too low, and/or the partnership incidence in 2008 being too high. A similar argument applies if both are inputs are low. It should be stressed that such insight into the model's structure and the required trade-offs between sets of inputs, can be readily obtained from a history match analysis, without the need for a more detailed study.</p>
</sec><sec id="s3d">
<title>Sensitivity of the implausibility measure</title>
<p>At the end of a history match, it is possible to experiment by reducing the uncertainty terms in the implausibility measure and re-evaluate the non-implausible space. This exercise can indicate which terms are most dominant. It is important to note however, that increasing the uncertainty terms at a latter wave is not possible, as the space that would have been retained at earlier waves had we used larger values for them cannot be recovered and the results will be inaccurate: one would have to start all over again. For this reason it is important to start history matching using our largest estimates for the uncertainties we believe are present in the system, as these can be reduced later but they cannot be increased.</p>
<p><xref ref-type="table" rid="pcbi-1003968-t004">Table 4</xref> shows what percentage of the input space calculated as non-implausible would be found as implausible if the respective uncertainties were to be decreased by the percentages shown in the first column. Improving the EV estimates could increase the rejection rates, as it is shown in the 4th column of the table. We should note however, that, unlike the other terms, EV cannot become arbitrarily small, as it represents the stochastic variability in the simulator's output. Revising the observation errors could also help rejecting more space, followed by building more precise emulators (i.e. less CU) and revising the model discrepancy term.</p>
<table-wrap id="pcbi-1003968-t004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003968.t004</object-id><label>Table 4</label><caption>
<title>Percentage of the non-implausible space at wave 9 that would be calculated as implausible if the uncertainty shown in the first row was reduced by the amount shown in the first column.</title>
</caption><alternatives><graphic id="pcbi-1003968-t004-4" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003968.t004" xlink:type="simple"/>
<table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">OE</td>
<td align="left" rowspan="1" colspan="1">CU</td>
<td align="left" rowspan="1" colspan="1">MD</td>
<td align="left" rowspan="1" colspan="1">EV</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1">%</td>
<td align="left" rowspan="1" colspan="1">19.8</td>
<td align="left" rowspan="1" colspan="1">11.8</td>
<td align="left" rowspan="1" colspan="1">10.7</td>
<td align="left" rowspan="1" colspan="1">54.8</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">%</td>
<td align="left" rowspan="1" colspan="1">45.4</td>
<td align="left" rowspan="1" colspan="1">24.9</td>
<td align="left" rowspan="1" colspan="1">21.9</td>
<td align="left" rowspan="1" colspan="1">91.4</td>
</tr>
</tbody>
</table>
</alternatives></table-wrap></sec><sec id="s3e">
<title>Implausibility of the simulator runs</title>
<p>In this section we examine the fit of the simulator output to the empirical data in successive waves. We first define the implausibility for one output of the actual simulator runs as <disp-formula id="pcbi.1003968.e272"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003968.e272" xlink:type="simple"/><label>(13)</label></disp-formula>with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e273" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e274" xlink:type="simple"/></inline-formula> the run sample mean and variance as defined in <xref ref-type="disp-formula" rid="pcbi.1003968.e056">equations 3</xref> and <xref ref-type="disp-formula" rid="pcbi.1003968.e057">4</xref>. We also define the maximum implausibility of a run at input <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e275" xlink:type="simple"/></inline-formula> as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e276" xlink:type="simple"/></inline-formula>. Note that this version of the implausibility does not include code uncertainty, as the simulator has been evaluated at <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e277" xlink:type="simple"/></inline-formula> and that the ensemble variability is estimated directly from the simulator run (and so we may now describe runs as ‘acceptable’ if their implausibility is low). <xref ref-type="fig" rid="pcbi-1003968-g007">Fig. 7</xref> shows the implausibility of the simulator runs in successive waves. In wave 9, 50% of the runs were non-implausible while in wave 10, the non-implausible (or acceptable) runs were 65% of the total number of runs, all coming from a region that is a tiny fraction (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e278" xlink:type="simple"/></inline-formula>) of the original input space. As we were then in a position to generate large numbers of acceptable runs from the non-implausible region with a 65% acceptance rate, the history match was concluded.</p>
<fig id="pcbi-1003968-g007" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003968.g007</object-id><label>Figure 7</label><caption>
<title>Cumulative distribution function of simulator run implausibility <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e279" xlink:type="simple"/></inline-formula> by waves.</title>
<p>Each line represents the percentage of each wave's simulator runs with an <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e280" xlink:type="simple"/></inline-formula> less than the value indicated by the x-axis.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003968.g007" position="float" xlink:type="simple"/></fig>
<p><xref ref-type="fig" rid="pcbi-1003968-g008">Fig. 8</xref> shows the time evolution of male and female HIV prevalence from simulator runs from four different waves. The empirical data are the male and female HIV prevalences in 1992, 2001 and 2007. The crosses represent the average observed values for each year and the credible ranges (error bars) represent 2 standard deviations calculated from the sum of the observation uncertainty and the model discrepancy for wave 9. Since we assume that the physical process <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e281" xlink:type="simple"/></inline-formula> is one realisation of the simulator (barring the model discrepancy) and not its mean output, <xref ref-type="fig" rid="pcbi-1003968-g008">Fig. 8</xref> shows the run of each scenario <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e282" xlink:type="simple"/></inline-formula> that best matched the empirical data. Note the wave 1 runs entirely miss the targets and that the majority of the wave 10 runs pass through them. Finally, <xref ref-type="fig" rid="pcbi-1003968-g009">Fig. 9</xref> shows all 18 simulator outputs in waves 1, 4, 7 and 10 and their convergence to the empirical data.</p>
<fig id="pcbi-1003968-g008" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003968.g008</object-id><label>Figure 8</label><caption>
<title>Simulator output (male and female HIV prevalence) in waves 1, 4, 7 and 10.</title>
<p>The black lines show the average observed HIV prevalence with 95% credible ranges.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003968.g008" position="float" xlink:type="simple"/></fig><fig id="pcbi-1003968-g009" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003968.g009</object-id><label>Figure 9</label><caption>
<title>Convergence of the simulator's output to the empirical data with successive waves of history matching.</title>
<p>Each of the 18 panels shows the range of the target data (horizontal region) and the simulator's output in waves 1 (red), 4 (yellow), 7 (blue) and 10 (green) (left to right along the x-axis).</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003968.g009" position="float" xlink:type="simple"/></fig></sec><sec id="s3f">
<title>Posterior samples</title>
<p>In this section we present the results of the method described in section ‘Posterior sampling’ for drawing approximate posterior samples from the model. The non-implausible samples at the end of wave 9 were fitted with a multivariate normal distribution. Its covariance matrix was then inflated by a factor of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e283" xlink:type="simple"/></inline-formula> and this formed the proposal distribution <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e284" xlink:type="simple"/></inline-formula>. The model likelihood <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e285" xlink:type="simple"/></inline-formula> was defined as described in section ‘Posterior sampling’. Using <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e286" xlink:type="simple"/></inline-formula>, 200000 samples were proposed and their weights were calculated from the ratio <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e287" xlink:type="simple"/></inline-formula>. From this set of 200000 samples, 10000 samples were chosen with probability defined by their respective weights. The results are shown in <xref ref-type="fig" rid="pcbi-1003968-g010">Fig. 10</xref>, where the shrinkage of the input space and the particular shape the approximate posterior distribution takes for different simulator inputs is evident.</p>
<fig id="pcbi-1003968-g010" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003968.g010</object-id><label>Figure 10</label><caption>
<title>Posterior samples drawn with the importance sampling method described in section ‘Posterior Sampling’.</title>
<p>Each panel shows the samples drawn for one of the 22 simulator inputs. Their full names and descriptions can be found in <xref ref-type="table" rid="pcbi-1003968-t001">Table 1</xref>.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003968.g010" position="float" xlink:type="simple"/></fig>
<p><xref ref-type="fig" rid="pcbi-1003968-g010">Fig. 10</xref> also shows that the model is over-parameterised with flat posteriors over the permissible input ranges for 9 of the inputs, implying that the available empirical data were not informative for all the input parameters. Complex mechanistic simulators, such as the one studied in this paper are not designed to help us analyse a particular data set, but rather to help us understand a real world system. As such, they can include processes that we consider important for the understanding the physical system, which however, may not be identifiable from the available data. History matching helps with identifiability problems, rather than covering them up: it allows us to quantify how much information is in the data regarding the simulator's parameters and gives guidance as to what fresh data might be needed to improve our system understanding. Furthermore, it is unaffected by multiple modes or correlation ridges in the posterior, which are typical manifestations of identifiability issues and plague other calibration methods, such as those based on MCMC.</p>
<p>In models of the complexity and the dimensionality such as the one studied here, we would argue against reporting a single best estimate of the parameters, as there is always likely to be some uncertainty, that will be missed out by a single best estimate. Additionally, lack of identifiability does not imply that a history matched model is not useful. When using the history matched model to make a prediction, we would run it at a range of inputs over the non-implausible space, to get a range of output values. This range may still be informative (e.g. lead to the same decision). Finally, if the non-implausible set leads to an unhelpfully wide range of output values, we might then consider whether there are other calibration data available, and whether these data could be informative. The last point can be verified by looking at the related model outputs over the corresponding set of non-implausible inputs: the more the output values vary, the more informative new calibration data will be.</p>
</sec></sec><sec id="s4">
<title>Discussion</title>
<p>In this paper we presented a tutorial on history matching and emulation. History matching is an iterative procedure that reduces the simulator's input space by identifying areas that are unlikely to provide a good match to the empirical data. History matching relies on the efficiency of emulators, which are a Bayesian representation of the complex simulator and are parameterised iteratively during history matching.</p>
<p>We presented a case study where we history matched a 22 input simulator known as Mukwano, simultaneously fitting its 18 outputs. After 9 iterations of history matching, the non-implausible input space was reduced by a factor of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003968.e288" xlink:type="simple"/></inline-formula>. While evaluating the entire input space, the final system had a 65% probability of selecting a parameter set that fitted all 18 outputs, a percentage that could have been improved further had we continued with more iterations. This approach therefore, provides a method to generate large numbers of runs that give acceptable matches to the calibration targets, while at the same time dramatically shrinks the non-implausible input space. The Mukwano model was found to be in agreement with the observed data, various features of its structure were discussed and the region of input space corresponding to all acceptable matches was identified. A simulation study, which used a smaller version of Mukwano for validating the performance of history matching, is included in the online supplementary material.</p>
<p>When employing this method, Bayesian emulator construction has to be carefully implemented as otherwise the implausible space rejection rate can be small, especially if the simulator's output is not a relatively smooth function of its inputs. This condition can cause the code uncertainty (emulator's posterior variance) to be large and make it harder for the implausibility measure to reject particular input values. A more careful emulator construction, e.g. by using more detailed mean functions and more training points should increase the input space rejection rate.</p>
<p>History matching is thematically linked to calibration methods such as ABC or Bayesian model calibration, but has the important conceptual difference of discarding implausible areas of the input space as opposed to attempting to make probabilistic statements about the most likely input values given the empirical data. The latter methods could fail if they were applied to a large input space of a multi-input multi-output simulator. However, their application on the reduced space that is the output of history matching, could produce hybrid methods that combine the strengths of both approaches.</p>
<p>The method we proposed in this paper, deals with stochastic simulators assuming that the uncertainty introduced by the stochasticity of the outputs is constant at each wave with respect to the value of the inputs. This may not be the case, and knowledge of how the stochastic output variability changes with the inputs can increase the space reduction rate <xref ref-type="bibr" rid="pcbi.1003968-Vernon3">[39]</xref>, <xref ref-type="bibr" rid="pcbi.1003968-Vernon4">[40]</xref>. Additionally, multi-output simulators very often exhibit correlation between their outputs, which was ignored in this work. Taking output correlation into account would improve the emulation process and subsequently the performance of history matching, but would require far more sophisticated emulators, as well as more detailed observation uncertainty and model discrepancy specifications, and hence we leave this to future work.</p>
<p>We conclude that history matching and emulation are useful additions to the toolbox of infectious disease modellers. Further research is required to explicitly address the stochastic nature of the simulator as well as to account for correlations between outputs.</p>
</sec><sec id="s5">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1003968.s001" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003968.s001" position="float" xlink:type="simple"><label>S1 Text</label><caption>
<p><bold>Building a single output emulator.</bold></p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003968.s002" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003968.s002" position="float" xlink:type="simple"><label>S2 Text</label><caption>
<p><bold>Simulation study.</bold></p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003968.s003" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003968.s003" position="float" xlink:type="simple"><label>S3 Text</label><caption>
<p><bold>Terminology.</bold></p>
<p>(PDF)</p>
</caption></supplementary-material></sec></body>
<back><ref-list>
<title>References</title>
<ref id="pcbi.1003968-Law1"><label>1</label>
<mixed-citation publication-type="other" xlink:type="simple">Law A (2007) Simulation modeling and analysis. McGraw Hill.</mixed-citation>
</ref>
<ref id="pcbi.1003968-Spear1"><label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Spear</surname><given-names>RC</given-names></name>, <name name-style="western"><surname>Hubbard</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Liang</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Seto</surname><given-names>E</given-names></name> (<year>2002</year>) <article-title>Disease transmission models for public health decision making: toward an approach for designing intervention strategies for Schistosomiasis Japonica</article-title>. <source>Environ Health Perspect</source> <volume>110</volume>: <fpage>907</fpage>–<lpage>915</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003968-Bauer1"><label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bauer</surname><given-names>AL</given-names></name>, <name name-style="western"><surname>Beauchemin</surname><given-names>CAA</given-names></name>, <name name-style="western"><surname>Perelson</surname><given-names>AS</given-names></name> (<year>2009</year>) <article-title>Agent-based modeling of host-pathogen systems: The successes and challenges</article-title>. <source>Information Sciences</source> <volume>179</volume>: <fpage>1379</fpage>–<lpage>1389</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003968-Grimm1"><label>4</label>
<mixed-citation publication-type="other" xlink:type="simple">Grimm V, Railsback SF (2005) Individual-based Modeling and Ecology. Princeton University Press.</mixed-citation>
</ref>
<ref id="pcbi.1003968-White1"><label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>White</surname><given-names>RG</given-names></name>, <name name-style="western"><surname>Glynn</surname><given-names>JR</given-names></name>, <name name-style="western"><surname>Orroth</surname><given-names>KK</given-names></name>, <name name-style="western"><surname>Freeman</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Bakker</surname><given-names>R</given-names></name> (<year>2008</year>) <article-title>Male circumcision for HIV prevention in sub-saharan Africa: who, what and when?</article-title> <source>AIDS</source> <volume>22</volume>: <fpage>1841</fpage>–<lpage>1850</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003968-Dewilde1"><label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dewilde</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Anderson</surname><given-names>R</given-names></name> (<year>2004</year>) <article-title>The cost-effectiveness of screening programs using single and multiple birth cohort simulations: a comparison using a model of cervical cancer</article-title>. <source>Medical Decision Making</source> <volume>24</volume>: <fpage>486</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003968-Grimm2"><label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Grimm</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Berger</surname><given-names>U</given-names></name>, <name name-style="western"><surname>Bastiansen</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Eliassen</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Ginot</surname><given-names>V</given-names></name> (<year>2006</year>) <article-title>A standard protocol for describing individual-based and agent-based models</article-title>. <source>Ecological Modelling</source> <volume>198</volume>: <fpage>115</fpage>–<lpage>126</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003968-May1"><label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>May</surname><given-names>RM</given-names></name> (<year>2004</year>) <article-title>Uses and abuses of mathematics in biology</article-title>. <source>Science</source> <volume>303</volume>: <fpage>790</fpage>–<lpage>793</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003968-Ionides1"><label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ionides</surname><given-names>EL</given-names></name>, <name name-style="western"><surname>Bretó</surname><given-names>C</given-names></name>, <name name-style="western"><surname>King</surname><given-names>AA</given-names></name> (<year>2006</year>) <article-title>Inference for nonlinear dynamical systems</article-title>. <source>Proceedings of the National Academy of Sciences USA</source> <volume>103</volume>: <fpage>18438</fpage>–<lpage>18443</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003968-Gibson1"><label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gibson</surname><given-names>GJ</given-names></name>, <name name-style="western"><surname>Renshaw</surname><given-names>E</given-names></name> (<year>1998</year>) <article-title>Estimating parameters in stochastic compartmental models using Markov chain methods</article-title>. <source>IMA Journal of Mathematics Applied in Medicine and Biology</source> <volume>15</volume>: <fpage>19</fpage>–<lpage>40</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003968-ONeill1"><label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>O'Neill</surname><given-names>PD</given-names></name>, <name name-style="western"><surname>Roberts</surname><given-names>GO</given-names></name> (<year>1999</year>) <article-title>Bayesian inference for partially observed stochastic epidemics</article-title>. <source>Journal of the Royal Statistical Society Series A (General)</source> <volume>162</volume>: <fpage>121</fpage>–<lpage>129</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003968-Cook1"><label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cook</surname><given-names>AR</given-names></name>, <name name-style="western"><surname>Otten</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Marion</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Gibson</surname><given-names>GJ</given-names></name>, <name name-style="western"><surname>Gilligan</surname><given-names>CA</given-names></name> (<year>2007</year>) <article-title>Estimation of multiple transmission rates for epidemics in heterogeneous populations</article-title>. <source>Proceedings of the National Academy of Sciences USA</source> <volume>104</volume>: <fpage>20392</fpage>–<lpage>20397</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003968-Jewell1"><label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jewell</surname><given-names>CP</given-names></name>, <name name-style="western"><surname>Kypraios</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Neal</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Roberts</surname><given-names>GO</given-names></name> (<year>2009</year>) <article-title>Bayesian analysis for emerging infectious diseases</article-title>. <source>Bayesian Analysis</source> <volume>4</volume>: <fpage>465</fpage>–<lpage>496</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003968-Keeling1"><label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Keeling</surname><given-names>MJ</given-names></name>, <name name-style="western"><surname>Ross</surname><given-names>JV</given-names></name> (<year>2008</year>) <article-title>On methods for studying stochastic disease dynamics</article-title>. <source>Journal of the Royal Society Interface</source> <volume>5</volume>: <fpage>171</fpage>–<lpage>181</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003968-Cauchemez1"><label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cauchemez</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Ferguson</surname><given-names>NM</given-names></name> (<year>2008</year>) <article-title>Likelihood-based estimation of continuous-time epidemic models from time-series data: Application to measles transmission in London</article-title>. <source>Journal of the Royal Society Interface</source> <volume>5</volume>: <fpage>885</fpage>–<lpage>897</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003968-ONeill2"><label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>O'Neill</surname><given-names>PD</given-names></name>, <name name-style="western"><surname>Balding</surname><given-names>DJ</given-names></name>, <name name-style="western"><surname>Becker</surname><given-names>NG</given-names></name>, <name name-style="western"><surname>Eerola</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Mollison</surname><given-names>D</given-names></name> (<year>2000</year>) <article-title>Analyses of infectious disease data from household outbreaks by Markov chain Monte Carlo methods</article-title>. <source>Applied Statistics</source> <volume>49</volume>: <fpage>517</fpage>–<lpage>542</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003968-Cauchemez2"><label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cauchemez</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Valleron</surname><given-names>AJ</given-names></name>, <name name-style="western"><surname>Boëlle</surname><given-names>PY</given-names></name>, <name name-style="western"><surname>Flahault</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Ferguson</surname><given-names>NM</given-names></name> (<year>2008</year>) <article-title>Estimating the impact of school closure on influenza transmission from Sentinel data</article-title>. <source>Nature</source> <volume>452</volume>: <fpage>750</fpage>–<lpage>755</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003968-Toni1"><label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Toni</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Welch</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Strelkowa</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Ipsen</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Strumpf</surname><given-names>MPH</given-names></name> (<year>2009</year>) <article-title>Approximate Bayesian computation scheme for parameter inference and model selection in dynamical systems</article-title>. <source>Journal of the Royal Society Interface</source> <volume>6</volume>: <fpage>187</fpage>–<lpage>202</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003968-McKinley1"><label>19</label>
<mixed-citation publication-type="other" xlink:type="simple">McKinley TJ, Cook AR, Deardon R (2009) Inference in epidemic models without likelihoods. The International Journal of Biostatistics <volume>5</volume>..</mixed-citation>
</ref>
<ref id="pcbi.1003968-Conlan1"><label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Conlan</surname><given-names>AJK</given-names></name>, <name name-style="western"><surname>McKinley</surname><given-names>TJ</given-names></name>, <name name-style="western"><surname>Karolemeas</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Brooks Pollock</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Goodchild</surname><given-names>AV</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Estimating the hidden burden of bovine tuberculosis in Great Britain</article-title>. <source>PLoS Computational Biology</source> <volume>8</volume>: <fpage>e1002730</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003968-McKinley2"><label>21</label>
<mixed-citation publication-type="other" xlink:type="simple">McKinley TJ, Ross JV, Deardon R, Cook AR (2013) Simulation-based Bayesian inference for epidemic models. Computational Statistics and Data Analysis: in press.</mixed-citation>
</ref>
<ref id="pcbi.1003968-Andrieu1"><label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Andrieu</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Doucet</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Holenstein</surname><given-names>R</given-names></name> (<year>2010</year>) <article-title>Particle Markov chain Monte Carlo methods</article-title>. <source>Journal of the Royal Statistical Society, Series B (Methodological)</source> <volume>72</volume>: <fpage>269</fpage>–<lpage>342</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003968-Stout1"><label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Stout</surname><given-names>NK</given-names></name>, <name name-style="western"><surname>Knudsen</surname><given-names>AB</given-names></name>, <name name-style="western"><surname>Kong</surname><given-names>CY</given-names></name>, <name name-style="western"><surname>McMahon</surname><given-names>PM</given-names></name>, <name name-style="western"><surname>Gazelle</surname><given-names>GS</given-names></name> (<year>2009</year>) <article-title>Calibration methods used in cancer simulation models and suggested reporting guidelines</article-title>. <source>Pharmacoeconomics</source> <volume>27</volume>: <fpage>533</fpage>–<lpage>545</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003968-Punyacharoensin1"><label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Punyacharoensin</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Edmunds</surname><given-names>WJ</given-names></name>, <name name-style="western"><surname>De Angelis</surname><given-names>D</given-names></name>, <name name-style="western"><surname>White</surname><given-names>RG</given-names></name> (<year>2011</year>) <article-title>Mathematical models for the study of HIV spread and control amongst men who have sex with men</article-title>. <source>European Journal of Epidemiology</source> <volume>26</volume>: <fpage>695</fpage>–<lpage>709</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003968-Kennedy1"><label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kennedy</surname><given-names>MC</given-names></name>, <name name-style="western"><surname>O'Hagan</surname><given-names>A</given-names></name> (<year>2001</year>) <article-title>Bayesian calibration of computer models</article-title>. <source>Journal of the Royal Statistical Society Series B</source> <volume>63</volume>: <fpage>425</fpage>–<lpage>464</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003968-Saltelli1"><label>26</label>
<mixed-citation publication-type="other" xlink:type="simple">Saltelli A, Chan K, Scott EM (2000) Sensitivity analysis. Wiley Chichester.</mixed-citation>
</ref>
<ref id="pcbi.1003968-Oakley1"><label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Oakley</surname><given-names>JE</given-names></name>, <name name-style="western"><surname>O'Hagan</surname><given-names>A</given-names></name> (<year>2004</year>) <article-title>Probabilistic sensitivity analysis of complex models: a Bayesian approach</article-title>. <source>J R Statist Soc B</source> <volume>66</volume>: <fpage>751</fpage>–<lpage>769</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003968-Craig1"><label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Craig</surname><given-names>PS</given-names></name>, <name name-style="western"><surname>Goldstein</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Seheult</surname><given-names>AH</given-names></name>, <name name-style="western"><surname>Smith</surname><given-names>JA</given-names></name> (<year>1997</year>) <article-title>Pressure matching for hydrocarbon reservoirs: a case study in the use of Bayes linear strategies for large computer experiments. (with discussion)</article-title>. <source>in Case Studies in Bayesian Statistics, eds C Gastonis, et al Springer-Verlag</source> <volume>III</volume>: <fpage>37</fpage>–<lpage>93</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003968-Goldstein1"><label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Goldstein</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Rougier</surname><given-names>J</given-names></name> (<year>2009</year>) <article-title>Reified Bayesian modelling and inference for physical systems</article-title>. <source>Journal of Statistical Planning and Inference</source> <volume>139</volume>: <fpage>1221</fpage>–<lpage>1239</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003968-Goldstein2"><label>30</label>
<mixed-citation publication-type="other" xlink:type="simple">Goldstein M, Seheult A, Vernon I (2013) Assessing model adequacy. In: Wainwright J, Mulligan M, editors, Environmental Modelling: Finding Simplicity in Complexity, Second Edition, John Wiley &amp; Sons, Ltd, Chichester, UK: Wiley-Blackwell.</mixed-citation>
</ref>
<ref id="pcbi.1003968-Sacks1"><label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sacks</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Welch</surname><given-names>WJ</given-names></name>, <name name-style="western"><surname>Mitchell</surname><given-names>TJ</given-names></name>, <name name-style="western"><surname>Wynn</surname><given-names>HP</given-names></name> (<year>1989</year>) <article-title>Design and analysis of computer experiments</article-title>. <source>Statistical Science</source> <volume>4</volume>: <fpage>409</fpage>–<lpage>435</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003968-Bayarri1"><label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bayarri</surname><given-names>MJ</given-names></name>, <name name-style="western"><surname>Berger</surname><given-names>JO</given-names></name>, <name name-style="western"><surname>Paulo</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Sacks</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Cafeo</surname><given-names>JA</given-names></name>, <etal>et al</etal>. (<year>2007</year>) <article-title>A framework for the validation of computer models</article-title>. <source>Technometrics</source> <volume>49</volume>: <fpage>138</fpage>–<lpage>154</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003968-Henderson1"><label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Henderson</surname><given-names>DA</given-names></name>, <name name-style="western"><surname>Boys</surname><given-names>RJ</given-names></name>, <name name-style="western"><surname>Krishnan</surname><given-names>KJ</given-names></name>, <name name-style="western"><surname>Lawless</surname><given-names>C</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>Bayesian emulation and calibration of a stochastic computer model of mitochondrial DNA deletions in substantia nigra neurons</article-title>. <source>Journal of the American Statistical Association</source> <volume>104</volume>: <fpage>76</fpage>–<lpage>87</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003968-Higdon1"><label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Higdon</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Gattiker</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Williams</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Rightley</surname><given-names>M</given-names></name> (<year>2008</year>) <article-title>Computer model calibration using high-dimensional output</article-title>. <source>Journal of the American Statistical Association</source> <volume>103</volume>: <fpage>570</fpage>–<lpage>583</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003968-Vernon1"><label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Vernon</surname><given-names>IR</given-names></name>, <name name-style="western"><surname>Goldstein</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Bower</surname><given-names>RG</given-names></name> (<year>2010</year>) <article-title>Galaxy formation: a Bayesian uncertainty analysis</article-title>. <source>Bayesian Analysis</source> <volume>5</volume>: <fpage>619</fpage>–<lpage>670</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003968-Bower1"><label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bower</surname><given-names>RG</given-names></name>, <name name-style="western"><surname>Vernon</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Goldstein</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Benson</surname><given-names>AJ</given-names></name>, <name name-style="western"><surname>Lacey</surname><given-names>CG</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>The parameter space of galaxy formation</article-title>. <source>MonAst</source> <volume>407</volume>: <fpage>2017</fpage>–<lpage>2045</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003968-Vernon2"><label>37</label>
<mixed-citation publication-type="other" xlink:type="simple">Vernon I, Goldstein M, Bower RG (2014) Galaxy formation: Bayesian history matching for the observable universe. Statistical Science (to appear).</mixed-citation>
</ref>
<ref id="pcbi.1003968-Cumming1"><label>38</label>
<mixed-citation publication-type="other" xlink:type="simple">Cumming JA, Goldstein M (2009) Bayes linear uncertainty analysis for oil reservoirs based on multiscale computer experiments. In: O'Hagan A, West M, editors, Handbook of Bayesian Analysis, Oxford, UK: Oxford University Press.</mixed-citation>
</ref>
<ref id="pcbi.1003968-Vernon3"><label>39</label>
<mixed-citation publication-type="other" xlink:type="simple">Vernon IR, Goldstein M (2010) A Bayes linear approach to systems biology. Technical report, MUCM Technical Report.</mixed-citation>
</ref>
<ref id="pcbi.1003968-Vernon4"><label>40</label>
<mixed-citation publication-type="other" xlink:type="simple">Vernon I, Goldstein M (2014) Bayes linear emulation and history matching of stochastic systems biology models, in preparation.</mixed-citation>
</ref>
<ref id="pcbi.1003968-Williamson1"><label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Williamson</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Goldstein</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Allison</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Blaker</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Challenor</surname><given-names>P</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>History matching for exploring and reducing climate model parameter space using observations and a large perturbed physics ensemble</article-title>. <source>Climate Dynamics</source> <volume>41</volume>: <fpage>1703</fpage>–<lpage>1729</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003968-Brynjarsdottir1"><label>42</label>
<mixed-citation publication-type="other" xlink:type="simple">Brynjarsdottir J, O'Hagan A (2010) Learning about physical parameters: The importance of model discrepancy. Technical report, <ext-link ext-link-type="uri" xlink:href="http://www.tonyogahan.co.uk/academic/pub.html" xlink:type="simple">http://www.tonyogahan.co.uk/academic/pub.html</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1003968-Goldstein3"><label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Goldstein</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Rougier</surname><given-names>JC</given-names></name> (<year>2006</year>) <article-title>Bayes linear calibrated prediction for complex systems</article-title>. <source>JASA</source> <volume>101</volume>: <fpage>1132</fpage>–<lpage>1143</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003968-McKay1"><label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>McKay</surname><given-names>MD</given-names></name>, <name name-style="western"><surname>Beckman</surname><given-names>RJ</given-names></name>, <name name-style="western"><surname>Conover</surname><given-names>WJ</given-names></name> (<year>1979</year>) <article-title>A comparison of three methods for selecting values of input variables in the analysis of output from a computer code</article-title>. <source>Technometrics</source> <volume>21</volume>: <fpage>239</fpage>–<lpage>245</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003968-Loeppky1"><label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Loeppky</surname><given-names>JL</given-names></name>, <name name-style="western"><surname>Sacks</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Welch</surname><given-names>WJ</given-names></name> (<year>2009</year>) <article-title>Choosing the sample size of a computer experiment: a practical guide</article-title>. <source>Technometrics</source> <volume>51</volume>: <fpage>366</fpage>–<lpage>376</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003968-Williamson2"><label>46</label>
<mixed-citation publication-type="other" xlink:type="simple">Williamson D, Vernon IR (2013) Efficient uniform designs for multi-wave computer experiments.</mixed-citation>
</ref>
<ref id="pcbi.1003968-Vernon5"><label>47</label>
<mixed-citation publication-type="other" xlink:type="simple">Vernon I, Goldstein M (2009) Bayes linear analysis of imprecision in computer models, with application to understanding galaxy formation. In: Augustin T, Coolen FPA, editors, ISIPTA'09: Proceedings of the Sixth International Symposium on Imprecise Probability: Theories and Applications. Durham, UK: SIPTA, pp.441–450.</mixed-citation>
</ref>
<ref id="pcbi.1003968-Rasmussen1"><label>48</label>
<mixed-citation publication-type="other" xlink:type="simple">Rasmussen CE, Williams CKI (2006) Gaussian Processes for Machine Learning. The MIT press.</mixed-citation>
</ref>
<ref id="pcbi.1003968-Andrianakis1"><label>49</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Andrianakis</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Challenor</surname><given-names>P</given-names></name> (<year>2012</year>) <article-title>The effect of the nugget on Gaussian process emulators of computer models</article-title>. <source>Computational Statistics &amp; Data Analysis</source> <volume>56</volume>: <fpage>4215</fpage>–<lpage>4228</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003968-Bastos1"><label>50</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bastos</surname><given-names>LS</given-names></name>, <name name-style="western"><surname>O'Hagan</surname><given-names>A</given-names></name> (<year>2009</year>) <article-title>Diagnostics for Gaussian process emulators</article-title>. <source>Technometrics</source> <volume>51</volume>: <fpage>425</fpage>–<lpage>438</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003968-Conti1"><label>51</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Conti</surname><given-names>S</given-names></name>, <name name-style="western"><surname>O'Hagan</surname><given-names>A</given-names></name> (<year>2010</year>) <article-title>Bayesian emulation of complex multi-output and dynamic computer models</article-title>. <source>Journal of Statistical Planning and Inference</source> <volume>140</volume>: <fpage>640</fpage>–<lpage>651</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003968-Rougier1"><label>52</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rougier</surname><given-names>J</given-names></name> (<year>2008</year>) <article-title>Efficient emulators for multivariate deterministic functions</article-title>. <source>Journal of Computational and Graphical Statistics</source> <volume>17</volume>: <fpage>827</fpage>–<lpage>843</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003968-Fricker1"><label>53</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fricker</surname><given-names>TE</given-names></name>, <name name-style="western"><surname>Oakley</surname><given-names>JE</given-names></name>, <name name-style="western"><surname>Urban</surname><given-names>NM</given-names></name> (<year>2013</year>) <article-title>Multivariate Gaussian process emulators with nonseparable covariance structures</article-title>. <source>Technometrics</source> <volume>55</volume>: <fpage>47</fpage>–<lpage>56</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003968-Strong1"><label>54</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Strong</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Oakley</surname><given-names>JE</given-names></name>, <name name-style="western"><surname>Chilcott</surname><given-names>J</given-names></name> (<year>2012</year>) <article-title>Managing structural uncertainty in health economic decision models: a discrepancy approach</article-title>. <source>Journal of the Royal Statistical Society, Series C</source> <volume>61</volume>: <fpage>25</fpage>–<lpage>45</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003968-Pukelsheim1"><label>55</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pukelsheim</surname><given-names>F</given-names></name> (<year>1994</year>) <article-title>The three sigma rule</article-title>. <source>The American Statistician</source> <volume>48</volume>: <fpage>88</fpage>–<lpage>91</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003968-McCreesh1"><label>56</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>McCreesh</surname><given-names>N</given-names></name>, <name name-style="western"><surname>O'Brien</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Nsubuga</surname><given-names>RN</given-names></name>, <name name-style="western"><surname>Shafer</surname><given-names>LA</given-names></name>, <name name-style="western"><surname>Bakker</surname><given-names>R</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Exploring the potential impact of a reduction in partnership concurrency on HIV incidence in rural Uganda: a modeling study</article-title>. <source>Sexually Transmitted diseases</source> <volume>39</volume>: <fpage>407</fpage>–<lpage>413</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003968-Mulder1"><label>57</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mulder</surname><given-names>DW</given-names></name>, <name name-style="western"><surname>Nunn</surname><given-names>AJ</given-names></name>, <name name-style="western"><surname>Kamali</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Nakiyingi</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Wagner</surname><given-names>HU</given-names></name>, <etal>et al</etal>. (<year>1994</year>) <article-title>Two-year HIV-1-associated mortality in a Ugandan rural population</article-title>. <source>Lancet</source> <volume>343</volume>: <fpage>1021</fpage>–<lpage>1023</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003968-Mulder2"><label>58</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mulder</surname><given-names>DW</given-names></name>, <name name-style="western"><surname>Nunn</surname><given-names>AJ</given-names></name>, <name name-style="western"><surname>Kamali</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Wagner</surname><given-names>HU</given-names></name>, <name name-style="western"><surname>Kengeya-Kayondo</surname><given-names>JF</given-names></name> (<year>1994</year>) <article-title>HIV-1 incidence and HIV-1-associated mortality in a rural Ugandan population cohort</article-title>. <source>AIDS</source> <volume>8</volume>: <fpage>87</fpage>–<lpage>92</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003968-Seeley1"><label>59</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Seeley</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Wagner</surname><given-names>U</given-names></name>, <name name-style="western"><surname>Mulemwa</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Kengeya-Kayondo</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Mulder</surname><given-names>D</given-names></name> (<year>1991</year>) <article-title>The development of a community-based HIV/AIDS counselling service in a rural area in Uganda</article-title>. <source>AIDS Care</source> <volume>3</volume>: <fpage>207</fpage>–<lpage>217</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003968-Santner1"><label>60</label>
<mixed-citation publication-type="other" xlink:type="simple">Santner TJ, Williams BJ, Notz WI (2003) The Design and Analysis of Computer Experiments. New York: SV.</mixed-citation>
</ref>
</ref-list></back>
</article>