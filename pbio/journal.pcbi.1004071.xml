<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research-article">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-13-01745</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1004071</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Accurate Computation of Survival Statistics in Genome-Wide Studies</article-title>
<alt-title alt-title-type="running-head">Survival Statistics in Genome-Wide Studies</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Vandin</surname> <given-names>Fabio</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Papoutsaki</surname> <given-names>Alexandra</given-names></name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Raphael</surname> <given-names>Benjamin J.</given-names></name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Upfal</surname> <given-names>Eli</given-names></name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Department of Mathematics and Computer Science, University of Southern Denmark, Funen, Denmark</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Department of Computer Science, Brown University, Providence, Rhode Island, United States of America</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>Center for Computational Molecular Biology, Brown University, Providence, Rhode Island, United States of America</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Boutros</surname> <given-names>Paul Christopher</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Ontario Institute for Cancer Research, CANADA</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>I have read the journal’s policy and have the following conflicts: EU is a member of the scientific board and a consultant at Nabsys Inc.</p>
</fn>
<fn fn-type="con" id="contrib001">
<p>Conceived and designed the experiments: FV BJR EU. Performed the experiments: FV AP. Analyzed the data: FV AP. Contributed reagents/materials/analysis tools: FV BJR EU. Wrote the paper: FV BJR EU.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">braphael@cs.brown.edu</email> (BJR); <email xlink:type="simple">eli@cs.brown.edu</email> (EU)</corresp>
</author-notes>
<pub-date pub-type="collection">
<month>5</month>
<year>2015</year>
</pub-date>
<pub-date pub-type="epub">
<day>7</day>
<month>5</month>
<year>2015</year>
</pub-date>
<volume>11</volume>
<issue>5</issue>
<elocation-id>e1004071</elocation-id>
<history>
<date date-type="received">
<day>4</day>
<month>10</month>
<year>2013</year>
</date>
<date date-type="accepted">
<day>3</day>
<month>12</month>
<year>2014</year>
</date>
</history>
<permissions>
<?A3B2 copyright ="suppress"?>
<copyright-year>2015</copyright-year>
<copyright-holder>Vandin et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1004071" xlink:type="simple"/>
<abstract>
<p>A key challenge in genomics is to identify genetic variants that distinguish patients with different <italic>survival time</italic> following diagnosis or treatment. While the log-rank test is widely used for this purpose, nearly all implementations of the log-rank test rely on an asymptotic approximation that is not appropriate in many genomics applications. This is because: the two populations determined by a genetic variant may have very different sizes; and the evaluation of many possible variants demands highly accurate computation of very small <italic>p</italic>-values. We demonstrate this problem for cancer genomics data where the standard log-rank test leads to many false positive associations between somatic mutations and survival time. We develop and analyze a novel algorithm, Exact Log-rank Test (ExaLT), that accurately computes the <italic>p</italic>-value of the log-rank statistic under an exact distribution that is appropriate for any size populations. We demonstrate the advantages of ExaLT on data from published cancer genomics studies, finding significant differences from the reported <italic>p</italic>-values. We analyze somatic mutations in six cancer types from The Cancer Genome Atlas (TCGA), finding mutations with known association to survival as well as several novel associations. In contrast, standard implementations of the log-rank test report dozens-hundreds of likely false positive associations as more significant than these known associations.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>The identification of genetic variants associated with survival time is crucial in genomic studies. To this end, a number of methods have been proposed to computing a <italic>p</italic>-value that summarized the difference in survival time of two or more population. The most widely used method among these is the log-rank test. Widely used implementations of the log-rank test present a systematic error that emerges in most genome-wide applications, where the two populations have very different sizes, and the accurate computation of very small <italic>p</italic>-values is required due to the evaluation of a number of candidate variants. Considering cancer genomic applications, we show that the systematic error leads to many false positive associations of somatic variants and survival time. We present and analyze a new algorithm, ExaLT that accurately computes the <italic>p</italic>-value for the log-rank test under a distribution that is appropriate for the parameters found in genomics. Unlike previous approaches, ExaLT allows to control the accuracy of the computation. We use ExaLT to analyze cancer genomics data from The Cancer Genome Atlas (TCGA), identifying several novel associations in addition to well known associations. In contrast, the standard implementations of the log-rank test report a huge number of presumably false positive associations.</p>
</abstract>
<funding-group>
<funding-statement>This work is supported by NSF grants IIS-1016648 and IIS-1247581, and by NIH grant R01HG007069. BJR is supported by a Career Award at the Scientific Interface from the Burroughs Wellcome Fund, an Alfred P. Sloan Research Fellowship, and an NSF CAREER Award (CCF-1053753). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="3"/>
<table-count count="0"/>
<page-count count="18"/>
</counts>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Next-generation DNA sequencing technologies are now enabling the measurement of exomes, genomes, and mRNA expression in many samples. The next challenge is to interpret these large quantities of DNA and RNA sequence data. In many human and cancer genomics studies, a major goal is to find associations between an observed phenotype and a particular variable (e.g., a single nucleotide polymorphism (SNP), somatic mutation, or gene expression) from genome-wide measurements of many such variables. For example, many cancer sequencing studies aim to find somatic mutations that distinguish patients with fast-growing tumors that require aggressive treatment from patients with better prognosis. Similarly, many human disease studies aim to find genetic alleles that distinguish patients who respond to particular treatments, i.e. live longer. In both of these examples one tests the association between a DNA sequence variant and the <italic>survival time</italic>, or length of time that patients live following diagnosis or treatment.</p>
<p>The most widely approach to determine the statistical significance of an observed difference in survival time between two groups is the log-rank test [<xref ref-type="bibr" rid="pcbi.1004071.ref001">1</xref>, <xref ref-type="bibr" rid="pcbi.1004071.ref002">2</xref>]. An important feature of this test, and related tests in survival analysis [<xref ref-type="bibr" rid="pcbi.1004071.ref003">3</xref>], is their handling of <italic>censored</italic> data: in clinical studies, patients may leave the study prematurely or the study may end before the deaths of all patients. Thus, a lower bound on the survival time of these patients is known. Importantly, many studies are designed to test survival differences between two pre-selected populations that differ by one characteristic; e.g. a clinical trial of the effectiveness of a drug. These populations are selected to be approximately equal in size with a suitable number of patients to achieve appropriate statistical power (<xref ref-type="fig" rid="pcbi.1004071.g001">Fig 1A</xref>). In this setting, the null distribution of the (normalized) log-rank statistic is asymptotically (standard) normal; i.e. follows the (standard) normal distribution in the limit of infinite sample size. Thus, nearly every available implementation (e.g., the <monospace>LIFETEST</monospace> procedure in <monospace>SAS</monospace>, and the <monospace>survdiff</monospace> <monospace>R</monospace> function, and <monospace>coin</monospace> and <monospace>exactRankTests</monospace> packages in <monospace>R</monospace> and <monospace>SPlus</monospace>) of the log-rank test computes <italic>p</italic>-values from the normal distribution, an approximation that is accurate asymptotically (see <xref ref-type="supplementary-material" rid="pcbi.1004071.s001">S1 Text</xref>).</p>
<fig id="pcbi.1004071.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004071.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Difference between survival analysis in a clinical setting with balanced populations and genomics setting, with unbalanced populations.</title>
<p>(A) In a typical clinical study, two pre-selected groups of similar size are compared. Because the groups are balanced and each has a suitable number of patients, the asymptotic approximation (normal distribution) used in common implementations of the log-rank test gives an accurate approximation of the exact distribution, resulting in accurate <italic>p</italic>-values. (B) In a genomics study, the two groups are defined by a genetic variant. In many cases, the sizes of the groups are unbalanced, with one group being much larger than the other. In this situation, the asymptotic distribution does not accurately approximate the exact distribution of the log-rank statistic, and the resulting <italic>p</italic>-values computed from the tail of the distribution (see inset) are inaccurate.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004071.g001"/>
</fig>
<p>The design of a genomics study is typically very different from the traditional clinical trials setting. In a genomics study, high-throughput measurement of many genomics features (e.g. whole-genome sequence or gene expression) in a cohort of patients is performed, and the goal is to <italic>discover</italic> those features that distinguish survival time. Thus, the measured individuals are repeatedly partitioned into two populations determined by a genomic variable (e.g. a SNP) and the log-rank test, or related survival test, is performed (<xref ref-type="fig" rid="pcbi.1004071.g001">Fig 1B</xref>). Depending on the variable the sizes of the two populations may be very different: e.g. most somatic mutations identified in cancer sequencing studies, including those in driver genes, are present in &lt; 20% of patients [<xref ref-type="bibr" rid="pcbi.1004071.ref004">4</xref>–<xref ref-type="bibr" rid="pcbi.1004071.ref009">9</xref>]. Unfortunately, in the setting of unbalanced populations, the normal approximation of the log-rank statistic might give poor results.</p>
<p>While this fact has been noted in the statistics literature [<xref ref-type="bibr" rid="pcbi.1004071.ref010">10</xref>–<xref ref-type="bibr" rid="pcbi.1004071.ref012">12</xref>], it is not widely known, and indeed the normal approximation to the log-rank test is routinely used to test the association of somatic mutations and survival time (e.g. [<xref ref-type="bibr" rid="pcbi.1004071.ref013">13</xref>, <xref ref-type="bibr" rid="pcbi.1004071.ref014">14</xref>] and numerous other publications). A second issue in genomics setting is that the repeated application of the log-rank test demands the accurate calculation of very small <italic>p</italic>-values, as the computed <italic>p</italic>-value for a single test must be corrected for the large number of tests; e.g. through a Bonferroni or other multiple-hypothesis correction. An inaccurate approximation of <italic>p</italic>-values will result in an unacceptable number of false positives/negative associations of genomic features with survival. These defining characteristics of genomics applications, unbalanced populations and necessity of highly-accurate <italic>p</italic>-values for multiple-hypothesis correction, indicate that standard implementations of the log-rank test are inadequate.</p>
<p>We propose to compute the <italic>p</italic>-value for the log-rank test using an exact distribution determined by the observed number of individuals in each population. Perhaps the most famous use of an exact distribution is Fisher’s exact test for testing the independence of two categorical variables arranged in a 2×2 contingency table. When the counts in the cells of the table are small, the exact test is preferred to the asymptotic approximation given by the <italic>χ</italic><sup>2</sup> test [<xref ref-type="bibr" rid="pcbi.1004071.ref015">15</xref>]. Exact tests for comparing two survival distributions have received scant attention in the literature. There are three major difficulties in developing such a test. First, there are multiple observed features that determine the exact distribution including the number of patients in each population and the observed censoring times. With so many combinations of parameters it is infeasible to pre-compute distribution tables for the test. Thus, we need an efficient algorithm that computes the <italic>p</italic>-value for any given combination of observed parameters. Second, we cannot apply a standard Monte-Carlo permutation test to this problem since we are interested in very small <italic>p</italic>-values that are expensive to accurately estimate with such an approach. (By the accurate estimation of a <italic>p</italic>-value using Monte-Carlo permutation test, we mean the calculation of a <italic>p</italic>-value and a confidence interval of the same order of magnitude of the <italic>p</italic>-value.) Third, there are two possible null distributions for the log-rank test, the conditional and the permutational [<xref ref-type="bibr" rid="pcbi.1004071.ref002">2</xref>, <xref ref-type="bibr" rid="pcbi.1004071.ref016">16</xref>–<xref ref-type="bibr" rid="pcbi.1004071.ref018">18</xref>]. While both of these distributions are asymptotically normal, the permutational distribution is more appropriate for genomics settings [<xref ref-type="bibr" rid="pcbi.1004071.ref002">2</xref>, <xref ref-type="bibr" rid="pcbi.1004071.ref019">19</xref>], as we detail below. Yet no efficient algorithm is known to compute the <italic>p</italic>-value of the log-rank test under the exact permutational distribution.</p>
<p>We introduce an efficient and mathematically sound algorithm, called ExaLT (for <underline>Exa</underline>ct <underline>L</underline>og-rank <underline>T</underline>est), for computing the <italic>p</italic>-value under the exact permutational distribution. (ExaLT computes an estimate of the <italic>p</italic>-value under the <italic>exact</italic> permutational distribution; for this reason we denote the <italic>p</italic>-value obtained from ExaLT as an <italic>exact <italic>p</italic>-value</italic>, in contrast to the <italic>approximate <italic>p</italic>-value</italic> obtained from asymptotic distributions.) The run-time of ExaLT is not function of the <italic>p</italic>-value, enabling the accurate calculation of small <italic>p</italic>-values. For example, obtaining an accurate estimate of <italic>p</italic> ≈ 10<sup>−9</sup> is required if one wants to test the association of 1% of the human genome (e.g., the exome) with survival, and using a standard MC approach requires (with the Clopper-Pearson confidence interval estimate) the evaluation of ≥ 10<sup>11</sup> samples, that for a population of 200 patients requires &gt; 8 days; in contrast ExaLT is capable of estimating <italic>p</italic> ≈ 10<sup>−13</sup> on 200 patients in &lt; 2 hours. In contrast to heuristic approaches (see <xref ref-type="sec" rid="sec008">Materials and Methods</xref>) ExaLT provides rigorous guarantees on the relation between the estimated <italic>p</italic>-value and the correct <italic>p</italic>-value; moreover, it returns a conservative estimate of the <italic>p</italic>-value, thus guaranteeing rigorous control on the number of false discoveries. We test ExaLT on data from two published cancer studies [<xref ref-type="bibr" rid="pcbi.1004071.ref020">20</xref>, <xref ref-type="bibr" rid="pcbi.1004071.ref021">21</xref>], finding substantial differences between the <italic>p</italic>-values obtained by our exact test and the approximate <italic>p</italic>-values obtained by standard tools in survival analysis. In addition, we run ExaLT on somatic mutation and survival data from The Cancer Genome Atlas (TCGA) and find a number of mutations with significant association with survival time. Some of these such as <italic>IDH1</italic> mutations in glioblastoma are widely known; for others such as <italic>BRCA2</italic> and <italic>NCOA3</italic> mutations in ovarian cancer there is some evidence in the literature; while the remaining are genuinely novel. Most of these are identified only using the exact permutational test of ExaLT. In contrast, the genes reported as highly significant using standard implementations of the log-rank test are not supported by biological evidence; moreover, these methods report dozens-hundreds of such likely false positive associations as more significant than known genes associated with survival. These results show that our algorithm is practical, efficient, and avoids a number of false positives, while allowing the identification of genes known to be associated with survival and the discovery of novel, potentially prognostic biomarkers.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<sec id="sec003">
<title>Accuracy of Asymptotic Approximations</title>
<p>We first assessed the accuracy of the asymptotic approximation for the log-rank test on simulated data from a cohort of 500 patients with a gene <italic>g</italic> mutated in 5% of these patients, a frequency that is not unusual for cancer genes in large-scale sequencing studies [<xref ref-type="bibr" rid="pcbi.1004071.ref004">4</xref>–<xref ref-type="bibr" rid="pcbi.1004071.ref007">7</xref>]. We compared the survival times of the population 𝓟(<italic>g</italic>) of patients with a mutation in <italic>g</italic> to the survival of the population <inline-formula id="pcbi.1004071.e001"><mml:math id="M1" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mo>𝓟</mml:mo> <mml:mo>‾</mml:mo></mml:mover> <mml:mo stretchy="false">(</mml:mo> <mml:mi>g</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> of patients with no mutation in <italic>g</italic>. We computed <italic>p</italic>-values using <monospace>R</monospace> <monospace>survdiff</monospace> on multiple random instances (in order to obtain a distribution for the <italic>p</italic>-value of <italic>g</italic>) in which 𝓟(<italic>g</italic>) and <inline-formula id="pcbi.1004071.e002"><mml:math id="M2" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mo>𝓟</mml:mo> <mml:mo>‾</mml:mo></mml:mover> <mml:mo stretchy="false">(</mml:mo> <mml:mi>g</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> have the same survival distribution. <xref ref-type="supplementary-material" rid="pcbi.1004071.s007">S1 Fig</xref> shows that the <italic>p</italic>-values computed by the asymptotic approximation are much smaller than expected under the null hypothesis, with the smallest <italic>p</italic>-values showing the largest deviation from the expected uniform distribution.</p>
<p>The inaccuracy of the asymptotic log-rank test results in a large number of false discoveries: for example, considering a randomized version of a cancer mutation dataset (<xref ref-type="supplementary-material" rid="pcbi.1004071.s002">S1 Table</xref>) in which no mutation is associated with survival (i.e. no true positives), the asymptotic log-rank test reports 110 false discoveries (Bonferroni correction) or 291 false discoveries (False Discovery Rate (FDR) correction), with significance level <italic>α</italic> = 0.05 (<xref ref-type="fig" rid="pcbi.1004071.g002">Fig 2</xref>). We found that for the number of patients of interest to current genomic studies, the inaccuracy of the asymptotic log-rank test results mostly from the imbalance in the sizes of the two populations, rather than the total number of patients or the number of patients in the smaller population (see <xref ref-type="supplementary-material" rid="pcbi.1004071.s007">S1a Fig</xref>, <xref ref-type="supplementary-material" rid="pcbi.1004071.s007">S1b Fig</xref>, <xref ref-type="supplementary-material" rid="pcbi.1004071.s007">S1c Fig</xref>, <xref ref-type="supplementary-material" rid="pcbi.1004071.s007">S1d Fig</xref>, and <xref ref-type="supplementary-material" rid="pcbi.1004071.s001">S1 Text</xref>).</p>
<fig id="pcbi.1004071.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004071.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Differences between observed and expected <italic>p</italic>-values from different forms of the log-rank test on a randomized cancer dataset consisting of somatic mutations in 6184 genes.</title>
<p>The <italic>p</italic>-values for the genes should be distributed uniformly (green line), since there is no association between mutations and survival in this random data. Asymptotic approximations of the log-rank statistic (purple and blue) yield <italic>p</italic>-values that deviate significantly from the uniform distribution, incorrectly reporting many genes whose mutations are significantly associated with survival. In particular, the asymptotic log-rank test in <monospace>R</monospace> reports 110 genes with significant association, using a Bonferroni corrected <italic>p</italic>-value &lt; 0.05 (black line), or 291 genes with significant association using a less conservative FDR = 0.05. In contrast, the exact test makes no false discoveries.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004071.g002"/>
</fig>
</sec>
<sec id="sec004">
<title>An Efficient Algorithm for the Exact Log-Rank Test</title>
<p>As noted above, there are two exact distributions for the log-rank test in the literature: the permutational distribution [<xref ref-type="bibr" rid="pcbi.1004071.ref002">2</xref>] and the conditional distribution [<xref ref-type="bibr" rid="pcbi.1004071.ref016">16</xref>]. We developed an algorithm, <underline>Exa</underline>ct <underline>L</underline>og-rank <underline>T</underline>est (ExaLT), to compute the <italic>p</italic>-value of the log-rank statistic under the exact permutational distribution. On simulations of cancer data, we found that the <italic>p</italic>-values from the permutational exact test are significantly closer to the empirical <italic>p</italic>-values than the <italic>p</italic>-values obtained from the conditional exact test (<xref ref-type="supplementary-material" rid="pcbi.1004071.s008">S2 Fig</xref> and <xref ref-type="supplementary-material" rid="pcbi.1004071.s001">S1 Text</xref>). Thus, we derived a fully polynomial time approximation scheme (FPTAS) for computing the <italic>p</italic>-value under the permutational distribution. In contrast to heuristic methods that do not provide any rigorous guarantee on the quality of the approximation of the <italic>p</italic>-value, our algorithm provides an approximation that is guaranteed to be within a user defined distance from the <italic>p</italic>-value, for any given sample size, in polynomial time. Furthermore, the output of our scheme is always a conservative or valid <italic>p</italic>-value estimate. The <monospace>C++</monospace> implementation of ExaLT (that can be called from <monospace>R</monospace>) is available at <ext-link ext-link-type="uri" xlink:type="simple" xlink:href="https://github.com/fvandin/ExaLT">https://github.com/fvandin/ExaLT</ext-link>.</p>
</sec>
<sec id="sec005">
<title>Published Cancer Studies</title>
<p>To demonstrate the applicability of ExaLT we compared the <italic>p</italic>-values from the exact distribution to <italic>p</italic>-values from the asymptotic approximation reported in two recently published cancer genomics studies [<xref ref-type="bibr" rid="pcbi.1004071.ref020">20</xref>, <xref ref-type="bibr" rid="pcbi.1004071.ref021">21</xref>]. Huang et al. [<xref ref-type="bibr" rid="pcbi.1004071.ref020">20</xref>] divides patients into groups defined by the number of risk alleles of five single nucleotide polymorphisms (SNPs), and compares the survival distribution of the resulting populations. In one comparison, the survival distribution of 2 patients (13% of total) with at most 2 risk alleles was compared with the survival distribution of 14 patients with more than 2 risk alleles, and a <italic>p</italic>-value of 0.012 is reported. Thus, this association is significant at the traditional significance level of <italic>α</italic> = 0.05. However, ExaLT computes an exact <italic>p</italic>-value of 0.17, raising doubts about this association. In another comparison patients at a different disease stage were considered, and the division of the patients into groups as above resulted in comparing the survival distribution of 8 patients (17% of total) with the survival distribution of 40 patients, and a <italic>p</italic>-value of 6×10<sup>−6</sup> is reported. In contrast, ExaLT computes an exact <italic>p</italic>-value of 2×10<sup>−3</sup>, a reduction of three orders of magnitude in the significance level. Additional comparisons are shown in the <xref ref-type="supplementary-material" rid="pcbi.1004071.s001">S1 Text</xref>. Therefore in these cases the asymptotic approximation underestimates the exact permutational <italic>p</italic>-values resulting in associations deemed more significant than what is supported by the data.</p>
<p>In [<xref ref-type="bibr" rid="pcbi.1004071.ref021">21</xref>], the survival distribution of 14 glioblastoma patients (11% of total) with somatic <italic>IDH1</italic> or <italic>IDH2</italic> mutations was compared to the survival distribution of 115 patients with wild-type <italic>IDH1</italic> and <italic>IDH2</italic>. The reported <italic>p</italic>-value from the asymptotic approximation is 2×10<sup>−3</sup>, while the exact permutational <italic>p</italic>-value is 5×10<sup>−4</sup>, indicating a <italic>stronger</italic> association between somatic mutations in <italic>IDH1</italic> or <italic>IDH2</italic> and (longer) survival than reported. Notably, this same association has been reported in three other glioblastoma studies [<xref ref-type="bibr" rid="pcbi.1004071.ref022">22</xref>–<xref ref-type="bibr" rid="pcbi.1004071.ref024">24</xref>].</p>
</sec>
<sec id="sec006">
<title>TCGA Cancer Data</title>
<p>We analyzed somatic mutation and survival data from studies of six different cancer types (<xref ref-type="supplementary-material" rid="pcbi.1004071.s002">S1 Table</xref>) from The Cancer Genome Atlas (TCGA). For the range of parameters of these datasets our simulations show that the asymptotic approximation is not accurate for genes with mutation frequency ≤ 10%; we then did not considered genes with mutation frequency &gt; 10%. We also discarded genes mutated with frequency &lt; 1%. For each mutated gene, we first obtained an estimate <inline-formula id="pcbi.1004071.e003"><mml:math id="M3" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> of the <italic>p</italic>-value using an MC approach, and if <inline-formula id="pcbi.1004071.e004"><mml:math id="M4" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>≤</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>01</mml:mn></mml:mrow></mml:math></inline-formula> we used ExaLT to compute a controlled approximation of the <italic>p</italic>-value. We compared the <italic>p</italic>-value obtained in this way with the one obtained by using the asymptotic approximation as computed by the <monospace>R</monospace> package <monospace>survdiff</monospace> (<xref ref-type="supplementary-material" rid="pcbi.1004071.s003">S2 Table</xref>, <xref ref-type="supplementary-material" rid="pcbi.1004071.s004">S3 Table</xref>, <xref ref-type="supplementary-material" rid="pcbi.1004071.s005">S4 Table</xref>, <xref ref-type="supplementary-material" rid="pcbi.1004071.s006">S5 Table</xref>). <xref ref-type="fig" rid="pcbi.1004071.g003">Fig 3</xref> shows the exact <italic>p</italic>-values and the <monospace>R</monospace> <monospace>survdiff</monospace> <italic>p</italic>-values for the glioblastoma multiforme (GBM) dataset and ovarian serous adenocarcinoma (OV) dataset. The <italic>p</italic>-values for the other datasets are shown in <xref ref-type="supplementary-material" rid="pcbi.1004071.s009">S3 Fig</xref>.</p>
<fig id="pcbi.1004071.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004071.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Comparison of the <italic>p</italic>-values of association between somatic mutations and survival time for TCGA glioblastoma (GBM) and ovarian (OV) datasets.</title>
<p>Each data point represents a gene. (A) Comparison of the <monospace>R</monospace> <monospace>survdiff</monospace> <italic>p</italic>-values and the exact permutational <italic>p</italic>-values for the GBM dataset. (B) Comparison of the <monospace>R</monospace> <monospace>survdiff</monospace> <italic>p</italic>-values and the exact permutational <italic>p</italic>-values for the OV dataset.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004071.g003"/>
</fig>
<p>For most datasets the asymptotic <italic>p</italic>-values obtained from <monospace>R</monospace> <monospace>survdiff</monospace> are very different from the ones obtained with the exact <italic>p</italic>-values obtained by ExaLT, and the ranking of the genes by <italic>p</italic>-value is very different as well (see <xref ref-type="supplementary-material" rid="pcbi.1004071.s001">S1 Text</xref>). For example, in GBM <italic>none</italic> of the top 26 genes reported by <monospace>R</monospace> are in the list of the top 26 genes reported by the exact permutational test. Since genomics studies are typically focused on the <italic>discovery</italic> of novel hypotheses that will be further validated, this striking difference in the ranking of genes by the two algorithms is important: a poor ranking of genes by their association with survival will lead to many false discoveries undergoing additional experimental validation. While some of genes ranked in the top 10 by ExaLT are known to have mutations associated with survival (e.g., <italic>IDH1</italic> in GBM and <italic>BRCA2</italic> in OV), <italic>none</italic> of the top 10 genes reported by <monospace>R</monospace> <monospace>survdiff</monospace> (<xref ref-type="supplementary-material" rid="pcbi.1004071.s006">S5 Table</xref>) have mutations known to be associated with survival. <monospace>R</monospace> <monospace>survdiff</monospace> ranks dozens-hundreds of presumably false positives associations as more significant than these known genes. Moreover, <monospace>R</monospace> <monospace>survdiff</monospace> reports extremely strong association with survival for many of these higher ranked, but likely false positive, genes; e.g., in uterine corpus endometrial carcinoma (UCEC), 13 genes have <italic>p</italic> &lt; 10<sup>−8</sup> and an additional 19 genes have <italic>p</italic> &lt; 10<sup>−5</sup>, but none of these have a known association with survival.</p>
<p>The top 10 genes reported by ExaLT contain several novel associations that are supported by the literature and are not reported using <monospace>R</monospace> <monospace>survdiff</monospace>. In GBM, ExaLT identifies <italic>IDH1</italic> (<italic>p</italic> ≤ 3×10<sup>−4</sup>), <italic>VARS2</italic> (<italic>p</italic> ≤ 5×10<sup>−3</sup>) and <italic>GALR1</italic> (<italic>p</italic> ≤ 6×10<sup>−3</sup>), among others. As noted above, the association between mutations in <italic>IDH1</italic> and survival has been previously reported in GBM [<xref ref-type="bibr" rid="pcbi.1004071.ref021">21</xref>–<xref ref-type="bibr" rid="pcbi.1004071.ref024">24</xref>]. A germline variant in <italic>VARS2</italic> has been reported to be a prognostic marker, associated with survival, in early breast cancer patients [<xref ref-type="bibr" rid="pcbi.1004071.ref025">25</xref>]. The expression of <italic>GALR1</italic> has been reported to be associated with survival in colorectal cancer [<xref ref-type="bibr" rid="pcbi.1004071.ref026">26</xref>], and its inactivation by methylation has been associated with survival in head and neck cancer [<xref ref-type="bibr" rid="pcbi.1004071.ref027">27</xref>, <xref ref-type="bibr" rid="pcbi.1004071.ref028">28</xref>]. In OV, ExaLT identifies <italic>BRCA2</italic> (<italic>p</italic> ≤ 4×10<sup>−3</sup>) and <italic>NCOA3</italic> (<italic>p</italic> ≤ 10<sup>−3</sup>), and others. Germline and somatic mutations in <italic>BRCA2</italic> (and <italic>BRCA1</italic>) have been associated with survival in two ovarian cancer studies [<xref ref-type="bibr" rid="pcbi.1004071.ref004">4</xref>, <xref ref-type="bibr" rid="pcbi.1004071.ref029">29</xref>]. A polymorphism in <italic>NCOA3</italic> has been associated with breast cancer [<xref ref-type="bibr" rid="pcbi.1004071.ref030">30</xref>], and its amplification has been associated with survival in ER-positive tumors [<xref ref-type="bibr" rid="pcbi.1004071.ref031">31</xref>].</p>
<p>Thus, the exact test implemented by ExaLT appears to have higher sensitivity and specificity in detecting mutations associated with survival on the sizes of cohorts analyzed in TCGA. Finally, we note that the exact conditional test obtains results similar to <monospace>R</monospace> <monospace>survdiff</monospace>, confirming that the the exact permutational test implemented by ExaLT is a more appropriate exact test for genomics studies. (See <xref ref-type="supplementary-material" rid="pcbi.1004071.s001">S1 Text</xref>.) We have also assessed the difference between the result obtained using ExaLT and the results obtained using the asymptotic permutational test (<xref ref-type="supplementary-material" rid="pcbi.1004071.s003">S2 Table</xref>, <xref ref-type="supplementary-material" rid="pcbi.1004071.s004">S3 Table</xref>, <xref ref-type="supplementary-material" rid="pcbi.1004071.s005">S4 Table</xref>, <xref ref-type="supplementary-material" rid="pcbi.1004071.s006">S5 Table</xref>). In this case the difference in the ranking of genes is reduced but still present; in particular, in COADREAD 4 of the top 10 genes identified by ExaLT are not among the top 10 genes found using the asymptotic permutational test. Moreover, there are some genes for which there is a large difference in the <italic>p</italic>-value computed by ExaLT and the <italic>p</italic>-value from the asymptotic permutational test; for example, in UCEC data <italic>CTGF</italic> is ranked first by both ExaLT and the asymptotic permutational test, but it has <italic>p</italic> = 9.6×10<sup>−5</sup> by ExaLT and <italic>p</italic> = 8.3×10<sup>−10</sup> by the asymptotic permutational test.</p>
</sec>
</sec>
<sec id="sec007" sec-type="conclusions">
<title>Discussion</title>
<p>In this work we focus on the problem of performing survival analysis in a genomics setting, where the populations being compared are not defined in advance, but rather are determined by a genomic measurement. The two distinguishing features of such studies are that the populations are typically unbalanced and that many survival tests are performed for different measurements, requiring highly accurate <italic>p</italic>-values for multiple hypothesis testing corrections. We show empirically that the asymptotic approximations used in available implementations of the log-rank test produce anti-conservative estimates of the true <italic>p</italic>-values when applied to unbalanced populations, resulting in a large number of false discoveries. This is not purely a phenomenon of small population size: the approximation remains inaccurate even for a large number of samples (e.g., 100) in the small population. This inaccuracy makes asymptotic approximations unsuitable for cancer genomic studies, where the vast majority of the genes are mutated in a small proportion of all samples [<xref ref-type="bibr" rid="pcbi.1004071.ref004">4</xref>–<xref ref-type="bibr" rid="pcbi.1004071.ref006">6</xref>] and also for genome-wide association studies (GWAS) where rare variants may be responsible for a difference in drug response or other phenotype, even if it is possible that for extremely large genomic studies (e.g., with 100000 patients) the asymptotic approximations would provide results accurate enough even for imbalanced populations (e.g., when the small population is 1%).</p>
<p>The problem with the log-rank test for unbalanced populations has previously been reported [<xref ref-type="bibr" rid="pcbi.1004071.ref010">10</xref>, <xref ref-type="bibr" rid="pcbi.1004071.ref011">11</xref>], but the implications for genomics studies have not received attention. Note that the issue of unbalanced populations is further exacerbated by any further subdivision of the data: e.g. by considering mutations in specific locations or protein domains; by considering the impact of mutations on a specific therapeutic regimen; by testing the association of mutations with survival in a particular subtype of cancer; by grouping into more than two populations; or by correcting for additional covariates such as age, stage, grade, etc. All of these situations occur in genomics studies.</p>
<p>We considered the two versions of the log-rank test, the conditional [<xref ref-type="bibr" rid="pcbi.1004071.ref016">16</xref>] and the permutational [<xref ref-type="bibr" rid="pcbi.1004071.ref002">2</xref>], and we found that the exact permutational distribution is more accurate in genomics settings. We introduce ExaLT, the first efficient algorithm to compute highly accurate <italic>p</italic>-values for the exact permutational distribution. We implemented and tested our algorithm on data from two published cancer studies, showing that the exact permutational <italic>p</italic>-values are significantly different from the <italic>p</italic>-values obtained using the asymptotic approximations. We also ran ExaLT on somatic mutation and survival data from six cancer types from The Cancer Genome Atlas (TCGA), showing that our algorithm is practical, efficient, and allows the identification of genes known to be associated with survival in these cancer types as well as novel associations. We note that ExaLT can be employed as part of permutation tests that require the computation of <italic>p</italic>-values for a large number of genomic features measured on the same set of patients [<xref ref-type="bibr" rid="pcbi.1004071.ref012">12</xref>]. While the current implementation of ExaLT handles ties in survival times by breaking them arbitrarily, its extension to different tie breaking strategies and their impact is an important future direction.</p>
<p>The method we propose can be generalized to assess the difference in survival between more than two groups, by considering the exact permutational distribution for the appropriate test statistic. For this reason, our method can be adapted to test the difference in survival between groups of patients that have homozygous or heterozygous mutations, or to test whether the presence of a group of genomic features has a different effect on survival compared to the presence of the single genomic features. For the same reason, our method can incorporate categorical covariates, while it is unclear how methods based on the log-rank test, as ours, can incorporate continuous covariates or how they can be used to assess specific (e.g., additive) models of interactions between genomic features and survival.</p>
<p>While our focus here was the log-rank test, our results are relevant to more general survival statistics. First, in some survival analysis applications, samples are given different weights; our algorithm can be easily adapted to a number of these different weighting schemes. Second, an alternative approach in survival analysis is to use the Cox Proportional-Hazards model [<xref ref-type="bibr" rid="pcbi.1004071.ref003">3</xref>]. While in the Cox regression model one can easily adjust for categorical and continuous covariates, it is not clear how to incorporate continuos potential confounders in the log-rank test that we consider. While this constitutes a limitation of our method, the Cox regression models is often used to compare two populations even when no adjustment for confounders is performed. In this case, the significance of the resulting coefficients in the regression is typically done using a test that is equivalent to the log-rank test, and thus our results are relevant for this approach as well. See <xref ref-type="supplementary-material" rid="pcbi.1004071.s001">S1 Text</xref> and <xref ref-type="supplementary-material" rid="pcbi.1004071.s010">S4 Fig</xref>.</p>
<p>The challenges of extending multivariate regression models to the multiple-hypothesis setting of genome-wide measurements is not straightforward. Direct application of such a multivariate Cox regression will often not give reasonable results as: there are a limited number of samples and a large number of genomic variants; and many variants are rare and not associated with survival. Witten and Tibshirani (2010) [<xref ref-type="bibr" rid="pcbi.1004071.ref032">32</xref>] recently noted these difficulties for gene expression data stating that: “<italic>While there are a great number of methods in the literature for identification of significant genes in a microarray experiment with a two-class outcome … the topic of identification of significant genes with a survival outcome is still relatively unexplored.</italic>” We propose that exact tests such as the one provided here will be useful building blocks for more advanced models of survival analysis in the genomics setting.</p>
</sec>
<sec id="sec008" sec-type="materials|methods">
<title>Materials and Methods</title>
<sec id="sec009">
<title>Background: The Log-Rank Test</title>
<p>We focus here on the two-sample log-rank test of comparing the survival distribution of two groups, <italic>P</italic><sub>0</sub> and <italic>P</italic><sub>1</sub>. Let <italic>t</italic><sub>1</sub> &lt; <italic>t</italic><sub>2</sub> &lt; … &lt; <italic>t</italic><sub><italic>k</italic></sub> be the times of observed, uncensored events; in case of ties, we assume that they are broken arbitrarily. Let <italic>R</italic><sub><italic>j</italic></sub> be the number of patients <italic>at risk</italic> at time <italic>t</italic><sub><italic>j</italic></sub>, i.e. the number of patients that survived (and were not censored) up to this time, and let <italic>R</italic><sub><italic>j</italic>,1</sub> be the number of <italic>P</italic><sub>1</sub> patients at risk at that time. Let <italic>O</italic><sub><italic>j</italic></sub> be the number of observed uncensored events in the interval (<italic>t</italic><sub><italic>j</italic>−1</sub>, <italic>t</italic><sub><italic>j</italic></sub>], and let <italic>O</italic><sub><italic>j</italic>,1</sub> be the number of these events in group <italic>P</italic><sub>1</sub>. If the survival distributions of <italic>P</italic><sub>0</sub> and <italic>P</italic><sub>1</sub> are the same, then the expected value <inline-formula id="pcbi.1004071.e005"><mml:math id="M5" display="inline" overflow="scroll"><mml:mrow><mml:mi>E</mml:mi> <mml:mo stretchy="false">[</mml:mo> <mml:msub><mml:mi>O</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo stretchy="false">]</mml:mo> <mml:mo>=</mml:mo> <mml:msub><mml:mi>O</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mfrac><mml:msub><mml:mi>R</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:msub><mml:mi>R</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:mfrac></mml:mrow></mml:math></inline-formula>. The log-rank statistic [<xref ref-type="bibr" rid="pcbi.1004071.ref001">1</xref>, <xref ref-type="bibr" rid="pcbi.1004071.ref002">2</xref>] measures the sum of the deviations of <italic>O</italic><sub><italic>j</italic>,1</sub> from the expectation, <inline-formula id="pcbi.1004071.e006"><mml:math id="M6" display="inline" overflow="scroll"><mml:mrow><mml:mi>V</mml:mi> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>k</mml:mi></mml:msubsup> <mml:mrow><mml:mo stretchy="true">(</mml:mo> <mml:msub><mml:mi>O</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>−</mml:mo> <mml:msub><mml:mi>O</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mfrac><mml:msub><mml:mi>R</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:msub><mml:mi>R</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:mfrac> <mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p>
<p>(In some clinical applications one is more interested in either earlier or later events. In that case the statistic is a weighted sum of the deviations. Our results easily translate to the weighted version of the test.) Under the null hypothesis of no difference in the survival distributions of the two groups, <italic>E</italic>[<italic>V</italic>] = 0, and <italic>Pr</italic>(∣<italic>V</italic>∣ ≥ ∣<italic>v</italic>∣) is the <italic>p</italic>-value of an observed value <italic>v</italic>. Two possible null distributions are considered in the literature, the permutational distribution and the conditional distribution (see <xref ref-type="supplementary-material" rid="pcbi.1004071.s011">S5 Fig</xref>).</p>
</sec>
<sec id="sec010">
<title>Permutational Log-Rank Test</title>
<p>In the <italic>permutational</italic> log-rank test [<xref ref-type="bibr" rid="pcbi.1004071.ref002">2</xref>], the null distribution is obtained by assigning each patient to population <italic>P</italic><sub>0</sub> or <italic>P</italic><sub>1</sub> independently of the survival time. Let <italic>n</italic> be the total number of patients, and <italic>n</italic><sub>1</sub> the number of patients in group <italic>P</italic><sub>1</sub>. We consider the sample space of all <inline-formula id="pcbi.1004071.e007"><mml:math id="M7" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo> <mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:mi>n</mml:mi></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mi>n</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mtd></mml:mtr></mml:mtable> <mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> possible selections of survival times and censoring information from the observed data for the <italic>n</italic><sub>1</sub> patients of group <italic>P</italic><sub>1</sub>. Each such selection is assigned equal probability <inline-formula id="pcbi.1004071.e008"><mml:math id="M8" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="true">(</mml:mo> <mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:mi>n</mml:mi></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mi>n</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mtd></mml:mtr></mml:mtable> <mml:mo stretchy="true">)</mml:mo></mml:mrow> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>.</p>
</sec>
<sec id="sec011">
<title>Conditional Log-Rank Test</title>
<p>In the conditional log-rank test [<xref ref-type="bibr" rid="pcbi.1004071.ref016">16</xref>], the null distribution is defined by conditioning on <italic>O</italic><sub><italic>j</italic></sub>, <italic>R</italic><sub><italic>j</italic></sub>, and <italic>R</italic><sub><italic>j</italic>,1</sub> for <italic>j</italic> = 1,…, <italic>k</italic>. If at time <italic>t</italic><sub><italic>j</italic></sub> there are a total of <italic>R</italic><sub><italic>j</italic></sub> patients at risk, including <italic>R</italic><sub><italic>j</italic>,1</sub> patients in <italic>P</italic><sub>1</sub>, then under the assumption of no difference in the survival of <italic>P</italic><sub>0</sub> and <italic>P</italic><sub>1</sub> the <italic>O</italic><sub><italic>j</italic></sub> events at time <italic>t</italic><sub><italic>j</italic></sub> are split between <italic>P</italic><sub>0</sub> and <italic>P</italic><sub>1</sub> according to a hypergeometric distribution with parameters <italic>R</italic><sub><italic>j</italic></sub>, <italic>R</italic><sub><italic>j</italic>,1</sub>, and <italic>O</italic><sub><italic>j</italic></sub>.</p>
</sec>
<sec id="sec012">
<title>Choice of Null Distribution and Estimation of <italic>p</italic>-values</title>
<p>We considered the two versions of the log-rank test, the conditional [<xref ref-type="bibr" rid="pcbi.1004071.ref016">16</xref>] and the permutational [<xref ref-type="bibr" rid="pcbi.1004071.ref002">2</xref>], that differ in the null distribution they consider. The conditional log-rank test is preferred in clinical trials because it does not assume equal distribution of censoring in the two populations. This is important in clinical trials when patients in the two groups are subject to different treatments that may affect their probability of leaving the trial. However, unequal censoring is not a concern in genomic studies, since we do not expect a DNA sequence variant to have an impact of the censoring in the population. Moreover, in the genomic studies of interest to this work, the patients are not assigned to the two populations at the beginning of the study, and the measured individuals are instead repeatedly partitioned into two populations determined by a genomic variable. Therefore under the null hypothesis of no association between a genomic variable and survival time the two populations can be assumed to have the same distribution of potential follow-up times, and the correction for unequal follow-up, that is a concern in clinical trials [<xref ref-type="bibr" rid="pcbi.1004071.ref033">33</xref>], is not required in our scenario. In both versions of the test, under the null distribution the prefix sums of the log-rank statistic define a martingale, and by the martingale central limit theorem [<xref ref-type="bibr" rid="pcbi.1004071.ref003">3</xref>], the normalized log-rank statistic has an asymptotic 𝓝(0,1) distribution. (Sometimes the log-rank test is described using an asymptotic <italic>χ</italic><sup>2</sup> distribution; the two version of the tests are related, and our results hold for the version of the log-rank test based <italic>χ</italic><sup>2</sup> distribution as well (<xref ref-type="supplementary-material" rid="pcbi.1004071.s007">S1 Fig</xref>).) The normalizing variance is different in the two null distributions and this may be reflected in differences between the <italic>p</italic>-values obtained from the two null distributions, but asymptotically the two variances are the same [<xref ref-type="bibr" rid="pcbi.1004071.ref017">17</xref>], leading to the same <italic>p</italic>-values in the two versions of the test for large balanced populations. Therefore, the distinction between the two versions of the test is largely ignored in practice, where most papers that use the log-rank test or software packages that implement the test do not document the specific version test they consider. This can be explained, in part, by the widespread use of the log-rank in other scenarios, like clinical trials, where the issues specific to genomic settings (e.g., the imbalance between populations) do not arise. The differences between the tests are also rarely discussed in the literature, although there is some discussion [<xref ref-type="bibr" rid="pcbi.1004071.ref017">17</xref>, <xref ref-type="bibr" rid="pcbi.1004071.ref019">19</xref>] on which variance is the appropriate one to use to compute <italic>p</italic>-values from the asymptotic approximation.</p>
<p>In the case of small and unbalanced populations, the two null distributions yield different <italic>p</italic>-values, and the normal approximation gives poor estimates of both (<xref ref-type="supplementary-material" rid="pcbi.1004071.s007">S1 Fig</xref>). On simulations of cancer data, we found that the <italic>p</italic>-values from the permutational exact test are closer to the empirical <italic>p</italic>-values than the <italic>p</italic>-values obtained from the conditional exact test (<xref ref-type="supplementary-material" rid="pcbi.1004071.s008">S2 Fig</xref> and <xref ref-type="supplementary-material" rid="pcbi.1004071.s001">S1 Text</xref>). Moreover, we prefer the permutational null distribution because it better models the null hypothesis for mutation data.</p>
<p>While the exact computation of <italic>p</italic>-values in the conditional null distribution can be computed in polynomial time using a dynamic programming algorithm [<xref ref-type="bibr" rid="pcbi.1004071.ref033">33</xref>], no polynomial time algorithm is known for the exact computation of the <italic>p</italic>-value in the permutational null distribution: current implementations are based on a complete enumeration algorithm, making its use impractical for large number of patients (e.g., the <monospace>StatXact</monospace> manual recommends using the enumeration algorithm only when the number of samples is at most 20). Several heuristics have been developed for related computations including: saddlepoint methods to approximate the mid-<italic>p</italic>-values [<xref ref-type="bibr" rid="pcbi.1004071.ref034">34</xref>], methods based on the Fast Fourier Transform (FFT) [<xref ref-type="bibr" rid="pcbi.1004071.ref035">35</xref>–<xref ref-type="bibr" rid="pcbi.1004071.ref037">37</xref>], and branch and bound methods [<xref ref-type="bibr" rid="pcbi.1004071.ref038">38</xref>]. Such heuristics are shown to be <italic>asymptotically</italic> correct, converging to the correct <italic>p</italic>-value as the number of samples and computation time grows to infinity. However, no explicit bounds are known for the accuracy of the computed <italic>p</italic>-value when these heuristics are applied to a fixed sample size and under a bounded computation time. Therefore, when run on a specific input, these heuristics do not provide guarantees on the relation between the <italic>p</italic>-value and the approximation they report. Given the systematic error we report below for the standard asymptotic implementation of the log-rank test, we argue that such guarantees are essential in this and many similar settings.</p>
</sec>
<sec id="sec013">
<title>ExaLT</title>
<p>We developed an algorithm, <underline>Exa</underline>ct <underline>L</underline>og-rank <underline>T</underline>est (ExaLT), to compute the <italic>p</italic>-value of the log-rank statistic under the exact permutational distribution. In particular, we designed a fully polynomial time approximation scheme (FPTAS) for computing the <italic>p</italic>-value under the permutational distribution. Our algorithm gives an explicit bound on the error in approximating the true <italic>p</italic>-value, for any given sample size, in polynomial time. Furthermore, the output of our scheme is always a conservative or valid <italic>p</italic>-value estimate. Conceptually, our algorithm is similar to the one presented in [<xref ref-type="bibr" rid="pcbi.1004071.ref039">39</xref>].</p>
<p>Since the log-rank statistic depends only on the <italic>order</italic> of the events and not on their actual times, we can without loss of generality treat the survival data (including the censored times) as an ordered sequence of events, with no two patients having identical survival times. Let <italic>n</italic><sub><italic>j</italic></sub> = ∣<italic>P</italic><sub><italic>j</italic></sub>∣, for <italic>j</italic> = 0,1, be the number of patients in each population and let <italic>n</italic> = <italic>n</italic><sub>0</sub>+<italic>n</italic><sub>1</sub> be the total number of patients. We represent the data by two binary vectors <bold>x</bold> ∈ {0,1}<sup><italic>n</italic></sup> and <bold>c</bold> ∈ {0,1}<sup><italic>n</italic></sup>, where <italic>x</italic><sub><italic>i</italic></sub> = 1 if the <italic>i</italic>th event was in <italic>P</italic><sub>1</sub> and <italic>x</italic><sub><italic>i</italic></sub> = 0 otherwise; <italic>c</italic><sub><italic>i</italic></sub> = 0 if the <italic>i</italic>th event was censored and <italic>c</italic><sub><italic>i</italic></sub> = 1 otherwise. Note that <inline-formula id="pcbi.1004071.e009"><mml:math id="M9" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:msubsup> <mml:msub><mml:mi>x</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. In this notation the log-rank statistic is
<disp-formula id="pcbi.1004071.e010"><alternatives><graphic id="pcbi.1004071.e010g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004071.e010"/><mml:math id="M10" mode="display" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>V</mml:mi> <mml:mo>=</mml:mo> <mml:mi>V</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mi mathvariant="bold">x</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">c</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:munderover> <mml:msub><mml:mi>c</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>-</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:msub><mml:mi>x</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>-</mml:mo> <mml:mi>j</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mfrac> <mml:mo>)</mml:mo> <mml:mo>⋅</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula></p>
<p>Let <inline-formula id="pcbi.1004071.e011"><mml:math id="M11" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>V</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:mtext mathvariant="bold">x</mml:mtext> <mml:mo stretchy="false">)</mml:mo> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup> <mml:msub><mml:mi>c</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>−</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>−</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:msub><mml:mi>x</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>−</mml:mo> <mml:mi>j</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mfrac> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> be the test statistic <italic>V</italic>(<bold>x</bold>) at time <italic>t</italic>. Note that since <italic>n</italic>, <italic>n</italic><sub>1</sub>, and <bold>c</bold> are fixed, the statistic depends only on the value of <bold>x</bold>. Assume the observed log-rank statistic has value <italic>v</italic>. The <italic>p</italic>-value of the observation <italic>v</italic> is the probability <italic>Pr</italic>(∣<italic>V</italic>(<bold>x</bold>)∣ ≥ ∣<italic>v</italic>∣) computed in the probability space in which the <italic>n</italic><sub>1</sub> events of <italic>P</italic><sub>1</sub> are uniformly distributed among the <italic>n</italic> events.</p>
<p>For any 0 ≤ <italic>t</italic> ≤ <italic>n</italic> and 0 ≤ <italic>r</italic> ≤ <italic>n</italic><sub>1</sub>, let <inline-formula id="pcbi.1004071.e012"><mml:math id="M12" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>r</mml:mi> <mml:mo>,</mml:mo> <mml:mi>v</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo>=</mml:mo> <mml:mi>P</mml:mi> <mml:mi>r</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mi>V</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:mtext mathvariant="bold">x</mml:mtext> <mml:mo stretchy="false">)</mml:mo> <mml:mo>≤</mml:mo> <mml:mi>v</mml:mi> <mml:mrow><mml:mtext mathvariant="normal">and</mml:mtext> <mml:mspace width="0.333em"/></mml:mrow> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup> <mml:msub><mml:mi>x</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi>r</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> denote the joint probability of <italic>V</italic><sub><italic>t</italic></sub>(<bold>x</bold>) ≤ <italic>v</italic> and exactly <italic>r</italic> events from <italic>P</italic><sub>1</sub> occur in the first <italic>t</italic> events. Let <inline-formula id="pcbi.1004071.e013"><mml:math id="M13" display="inline" overflow="scroll"><mml:mrow><mml:mi>Q</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>r</mml:mi> <mml:mo>,</mml:mo> <mml:mi>v</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo>=</mml:mo> <mml:mi>P</mml:mi> <mml:mi>r</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mi>V</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:mtext mathvariant="bold">x</mml:mtext> <mml:mo stretchy="false">)</mml:mo> <mml:mo>≥</mml:mo> <mml:mi>v</mml:mi> <mml:mrow><mml:mtext mathvariant="normal">and</mml:mtext> <mml:mspace width="0.333em"/></mml:mrow> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup> <mml:msub><mml:mi>x</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi>r</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo>⋅</mml:mo></mml:mrow></mml:math></inline-formula> denote the joint probability of <italic>V</italic><sub><italic>t</italic></sub>(<bold>x</bold>) ≥ <italic>v</italic> and exactly <italic>r</italic> events from <italic>P</italic><sub>1</sub> occur in the first <italic>t</italic> events.</p>
<p>At time 0: <italic>P</italic>(0,<italic>r</italic>,<italic>v</italic>) = 1 if <italic>r</italic> = 0 and <italic>v</italic> ≥ 0, otherwise <italic>P</italic>(0,<italic>r</italic>,<italic>v</italic>) = 0. Similarly <italic>Q</italic>(0,<italic>r</italic>,<italic>v</italic>) = 1 if <italic>r</italic> = 0 and <italic>v</italic> ≤ 0, otherwise <italic>Q</italic>(0,<italic>r</italic>,<italic>v</italic>) = 0.</p>
<p>Given the values of <italic>P</italic>(<italic>t</italic>,<italic>r</italic>,<italic>v</italic>) for all <italic>v</italic> and <italic>r</italic>, we can compute the values of <italic>P</italic>(<italic>t</italic>+1,<italic>r</italic>,<italic>v</italic>) using the following relations: If <italic>c</italic><sub><italic>t</italic>+1</sub> = 1 then
<disp-formula id="pcbi.1004071.e014"><alternatives><graphic id="pcbi.1004071.e014g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004071.e014"/><mml:math id="M14" mode="display" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mi>r</mml:mi> <mml:mo>,</mml:mo> <mml:mi>v</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>-</mml:mo> <mml:mi>r</mml:mi></mml:mrow> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>-</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>r</mml:mi> <mml:mo>,</mml:mo> <mml:mi>v</mml:mi> <mml:mo>+</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>-</mml:mo> <mml:mi>r</mml:mi></mml:mrow> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>-</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>-</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>r</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>-</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>r</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mi>v</mml:mi> <mml:mo>-</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>-</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>r</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>-</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>⋅</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
If <italic>c</italic><sub><italic>t</italic>+1</sub> = 0 then
<disp-formula id="pcbi.1004071.e015"><alternatives><graphic id="pcbi.1004071.e015g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004071.e015"/><mml:math id="M15" mode="display" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mi>r</mml:mi> <mml:mo>,</mml:mo> <mml:mi>v</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>-</mml:mo> <mml:mi>r</mml:mi></mml:mrow> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>-</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>r</mml:mi> <mml:mo>,</mml:mo> <mml:mi>v</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>-</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>r</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>-</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>r</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mi>v</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>⋅</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
Analogous equations hold for <italic>Q</italic>(<italic>t</italic>,<italic>r</italic>,<italic>v</italic>).</p>
<p>The process defined by these equations guarantees that the <italic>n</italic> events always include <italic>n</italic><sub>1</sub> events of <italic>P</italic><sub>1</sub>. Thus, the <italic>p</italic>-value of the observation <italic>v</italic> is given by <italic>Pr</italic>(∣<italic>V</italic>(<bold>x</bold>)∣ ≥ ∣<italic>v</italic>∣) = <italic>P</italic>(<italic>n</italic>,<italic>n</italic><sub>1</sub>,−∣<italic>v</italic>∣)+<italic>Q</italic>(<italic>n</italic>,<italic>n</italic><sub>1</sub>,∣<italic>v</italic>∣).</p>
<p>For fixed <italic>t</italic> and <italic>r</italic>, <italic>P</italic>(<italic>t</italic>+1,<italic>r</italic>,<italic>v</italic>) and <italic>Q</italic>(<italic>t</italic>+1,<italic>r</italic>,<italic>v</italic>) are step functions. For example, if <italic>c</italic><sub><italic>t</italic>+1</sub> = 1, then as we vary <italic>v</italic>, <italic>P</italic>(<italic>t</italic>+1,<italic>r</italic>,<italic>v</italic>) changes only at the points in which <inline-formula id="pcbi.1004071.e016"><mml:math id="M16" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo stretchy="true">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>r</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mi>v</mml:mi> <mml:mo>−</mml:mo> <mml:mrow><mml:mo stretchy="true">(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>−</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>−</mml:mo> <mml:mo stretchy="false">(</mml:mo> <mml:mi>r</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>−</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mo stretchy="true">)</mml:mo></mml:mrow> <mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> or <inline-formula id="pcbi.1004071.e017"><mml:math id="M17" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo stretchy="true">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>r</mml:mi> <mml:mo>,</mml:mo> <mml:mi>v</mml:mi> <mml:mo>+</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>−</mml:mo> <mml:mi>r</mml:mi></mml:mrow> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>−</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> change values. Thus, we only need to compute the function <italic>P</italic>(<italic>t</italic>+1,<italic>r</italic>,<italic>v</italic>) at these points. At <italic>t</italic> = 0 the function <italic>P</italic>(0,<italic>r</italic>,<italic>v</italic>) assumes up to 2 values. If <italic>P</italic>(<italic>t</italic>,<italic>r</italic>,<italic>v</italic>) assumes <italic>m</italic>(<italic>t</italic>,<italic>r</italic>) values and <italic>P</italic>(<italic>t</italic>,<italic>r</italic>−1,<italic>v</italic>) assumes <italic>m</italic>(<italic>t</italic>,<italic>r</italic>−1) values, then <italic>P</italic>(<italic>t</italic>+1,<italic>r</italic>,<italic>v</italic>) assumes up to <italic>m</italic>(<italic>t</italic>,<italic>r</italic>)+<italic>m</italic>(<italic>t</italic>,<italic>r</italic>−1) values.</p>
<p>Similar relations hold for <italic>P</italic>(<italic>t</italic>+1,<italic>r</italic>,<italic>v</italic>) when <italic>c</italic><sub><italic>t</italic>+1</sub> = 0, and for computing <italic>Q</italic>(<italic>t</italic>,<italic>r</italic>,<italic>v</italic>) in the two cases. Thus, in <italic>n</italic> iterations the process computes the exact probabilities <italic>P</italic>(<italic>n</italic>,<italic>r</italic>,<italic>v</italic>) and <italic>Q</italic>(<italic>n</italic>,<italic>r</italic>,<italic>v</italic>), but it may have to compute probabilities for an exponential number of different values of <italic>v</italic> in some iterations.</p>
<p>We construct a polynomial time algorithm by modifying the above procedure to compute the probabilities of only a polynomial number of values in each iteration. We first observe that since the probability space consists of <inline-formula id="pcbi.1004071.e018"><mml:math id="M18" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo> <mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:mi>n</mml:mi></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mi>n</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mtd></mml:mtr></mml:mtable> <mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> equal probability events, all non-zero probabilities in our analysis are <inline-formula id="pcbi.1004071.e019"><mml:math id="M19" display="inline" overflow="scroll"><mml:mrow><mml:mo>≥</mml:mo> <mml:msup><mml:mi>n</mml:mi> <mml:mrow><mml:mo>−</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. For <italic>ɛ</italic> &gt; 0, fix <italic>ɛ</italic><sub>1</sub> such that (1−<italic>ɛ</italic><sub>1</sub>)<sup>−<italic>n</italic></sup> = 1+<italic>ɛ</italic>. Note that <italic>ε</italic><sub>1</sub> = <italic>O</italic>(<italic>ε</italic>/<italic>n</italic>). We discretize the interval of possible non-zero probabilities <inline-formula id="pcbi.1004071.e020"><mml:math id="M20" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">[</mml:mo> <mml:msup><mml:mi>n</mml:mi> <mml:mrow><mml:mo>−</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msup> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>, using the values (1−<italic>ɛ</italic><sub>1</sub>)<sup><italic>k</italic></sup>, for <italic>k</italic> = 0,…,ℓ, where <inline-formula id="pcbi.1004071.e021"><mml:math id="M21" display="inline" overflow="scroll"><mml:mrow><mml:mo>ℓ</mml:mo> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mo>−</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mi>log</mml:mi> <mml:mi>n</mml:mi></mml:mrow> <mml:mrow><mml:mi>log</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>−</mml:mo> <mml:msub><mml:mi>ɛ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo> <mml:mi>O</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:msup><mml:mi>ɛ</mml:mi> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mi>n</mml:mi> <mml:msub><mml:mi>n</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mi>log</mml:mi> <mml:mi>n</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. The approximation algorithm estimates <italic>P</italic>(<italic>t</italic>,<italic>r</italic>,<italic>v</italic>) with a step function <inline-formula id="pcbi.1004071.e022"><mml:math id="M22" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>P</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>r</mml:mi> <mml:mo>,</mml:mo> <mml:mi>v</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> defined by a sequence of ℓ points <inline-formula id="pcbi.1004071.e023"><mml:math id="M23" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>v</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>,</mml:mo> <mml:mi>r</mml:mi></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula>, <italic>k</italic> = 0,…,ℓ, such that <inline-formula id="pcbi.1004071.e024"><mml:math id="M24" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>v</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>,</mml:mo> <mml:mi>r</mml:mi></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> is an estimate for the largest <italic>v</italic> such that <italic>P</italic>(<italic>t</italic>,<italic>r</italic>,<italic>v</italic>) ≤ (1−<italic>ɛ</italic><sub>1</sub>)<sup><italic>k</italic></sup>. We prove that if iteration <italic>t</italic> computes a function <inline-formula id="pcbi.1004071.e025"><mml:math id="M25" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>P</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>r</mml:mi> <mml:mo>,</mml:mo> <mml:mi>v</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>−</mml:mo> <mml:msub><mml:mi>ε</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mi>t</mml:mi></mml:msup> <mml:mo>≤</mml:mo> <mml:mi>P</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>r</mml:mi> <mml:mo>,</mml:mo> <mml:mi>v</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo>≤</mml:mo> <mml:mover accent="true"><mml:mi>P</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>r</mml:mi> <mml:mo>,</mml:mo> <mml:mi>v</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, then starting from <inline-formula id="pcbi.1004071.e026"><mml:math id="M26" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>P</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>r</mml:mi> <mml:mo>,</mml:mo> <mml:mi>v</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> the <italic>t</italic>+1 iteration computes an estimate <inline-formula id="pcbi.1004071.e027"><mml:math id="M27" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>P</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mi>r</mml:mi> <mml:mo>,</mml:mo> <mml:mi>v</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>−</mml:mo> <mml:msub><mml:mi>ε</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>≤</mml:mo> <mml:mi>P</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mi>r</mml:mi> <mml:mo>,</mml:mo> <mml:mi>v</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo>≤</mml:mo> <mml:mover accent="true"><mml:mi>P</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mi>r</mml:mi> <mml:mo>,</mml:mo> <mml:mi>v</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. (<xref ref-type="supplementary-material" rid="pcbi.1004071.s012">S6 Fig</xref> provides the intuition for how the approximation at time <italic>t</italic>+1 is computed from the approximation at time <italic>t</italic>.) Thus, after <italic>n</italic> iterations we have an <italic>ε</italic>-approximations for <italic>P</italic>(<italic>n</italic>,<italic>n</italic><sub>1</sub>,<italic>v</italic>). Similar computations obtain an <italic>ε</italic>-approximation for <italic>Q</italic>(<italic>n</italic>,<italic>n</italic><sub>1</sub>,<italic>v</italic>). The details of the algorithm and analysis are given in the <xref ref-type="supplementary-material" rid="pcbi.1004071.s001">S1 Text</xref>.</p>
<p>We implemented the FPTAS in our software ExaLT and evaluated its performance as <italic>n</italic> and <italic>ɛ</italic> varies, and by comparing its running time with the running time of the exhaustive enumeration algorithm for the permutational test (<xref ref-type="supplementary-material" rid="pcbi.1004071.s013">S7 Fig</xref>). Our implementation of the FPTAS is very efficient, with significant speed-up compared to the exhaustive algorithm.</p>
<p>We note that, given parameters <italic>n</italic>,<italic>n</italic><sub>1</sub>,<italic>ɛ</italic>, and given the censoring vector <bold>c</bold>, ExaLT computes the <italic>entire distribution</italic> of the test statistic under the null hypothesis. Once this distribution is computed, it can be used for <italic>any</italic> vector <bold>x</bold> ∈ {0,1}<sup><italic>n</italic></sup> with <inline-formula id="pcbi.1004071.e028"><mml:math id="M28" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:msubsup> <mml:msub><mml:mi>x</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and the same censoring vector <bold>c</bold>. We therefore implemented a variant of ExaLT that given multiple vectors <bold>x</bold>’s for the same set of patients (e.g., mutation data from multiple genes on the same set of patients) as input stores the distributions already computed and uses these distributions for quick lookup whenever possible. (This feature cannot be used when the vectors <bold>x</bold>’s are defined for different sets of patients, for example when there are missing gene measurements or genotypes.)</p>
</sec>
<sec id="sec014">
<title>Synthetic Data</title>
<p>We used synthetic data to assess the accuracy of the asymptotic approximations. We generated data as follow: when no censoring was included, we generated the survival times for the patients from an exponential distribution, and the group labeling (mutated or not) were assigned to patients independently of their survival time; when censoring in <italic>c</italic>% of the patients was included, the survival times come from the exponential distribution with expectation equal to 30, and censoring variable from an exponential distribution resulting in <italic>c</italic>% of censoring (in expectation).</p>
<p>We used synthetic data to compare the empirical <italic>p</italic>-value and the <italic>p</italic>-values from the exact tests as well. In this case we generated synthetic data using two related but different procedures. In the first procedure, we mutate a gene <italic>g</italic> in exactly a fraction <italic>f</italic> of all patients. In the second procedure, we mutated a gene <italic>g</italic> in each patient independently with probability <italic>f</italic>. The second procedure models the fact that mutations in a gene <italic>g</italic> are found in each patient independently with a certain probability. In both cases the survival information is generated from the same distribution for all patients, as described above.</p>
</sec>
<sec id="sec015">
<title>Mutation and Clinical TCGA Data</title>
<p>We analyzed somatic mutation and clinical data, including survival information, from the public TCGA data portal (<ext-link ext-link-type="uri" xlink:href="https://tcga-data.nci.nih.gov/tcga/" xlink:type="simple">https://tcga-data.nci.nih.gov/tcga/</ext-link>). In particular we considered single nucleotide variants and small indels for colorectal carcinoma (COADREAD), glioblastoma multiforme (GBM), kidney renal clear cell carcinoma (KIRC), lung squamous cell carcinoma (LUSC), ovarian serous adenocarcinoma (OV), and uterine corpus endometrial carcinoma (UCEC). We restricted our analysis to patients for which somatic mutation and survival data were both available. We only considered genes mutated in &gt; 1% of patients. We also removed genes with mutation frequency &gt; 10%. Since genes mutated in the same set of patients would have the same association to survival, they are all equivalent for an automated analysis of association between mutations and survival; we then collapsed them into <italic>metagenes</italic>, recording the genes that appear in a metagene. For the remaining genes we first obtained an estimate <inline-formula id="pcbi.1004071.e029"><mml:math id="M29" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> of the <italic>p</italic>-value using a MC approach, and we then used ExaLT (with <italic>ɛ</italic> = 1.5) to compute the exact permutational <italic>p</italic>-value whenever <inline-formula id="pcbi.1004071.e030"><mml:math id="M30" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> was ≤ 0.01. For any given TCGA dataset we used the variant of ExaLT that stores previously computed distribution and uses them for quick lookup whenever possible. The runtime was reasonable for the dataset we analysed (e.g., 310 minutes for the COADREAD dataset).</p>
<p>The results published here are in whole or part based upon data generated by The Cancer Genome Atlas pilot project established by the NCI and NHGRI. Information about TCGA and the investigators and institutions who constitute the TCGA research network can be found at <ext-link ext-link-type="uri" xlink:href="http://cancergenome.nih.gov/" xlink:type="simple">http://cancergenome.nih.gov/</ext-link>.</p>
</sec>
</sec>
<sec id="sec016">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1004071.s001" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004071.s001" mimetype="application/pdf" xlink:type="simple">
<label>S1 Text</label>
<caption>
<title>Supporting Text.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004071.s002" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004071.s002" mimetype="application/pdf" xlink:type="simple">
<label>S1 Table</label>
<caption>
<title>Parameters of the cancer datasets analyzed.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004071.s003" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004071.s003" mimetype="application/pdf" xlink:type="simple">
<label>S2 Table</label>
<caption>
<title>The 10 genes with smallest <italic>p</italic>-values identified using the exact permutational test in cancer data.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004071.s004" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004071.s004" mimetype="application/pdf" xlink:type="simple">
<label>S3 Table</label>
<caption>
<title>The 10 genes with smallest <italic>p</italic>-values identified using the asymptotic permutational test in cancer data.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004071.s005" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004071.s005" mimetype="application/pdf" xlink:type="simple">
<label>S4 Table</label>
<caption>
<title>The 10 genes with smallest <italic>p</italic>-values identified using the exact conditional test in cancer data.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004071.s006" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004071.s006" mimetype="application/pdf" xlink:type="simple">
<label>S5 Table</label>
<caption>
<title>The 10 genes with smallest <italic>p</italic>-values identified using the asymptotic conditional test in cancer data.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004071.s007" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004071.s007" mimetype="application/pdf" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Comparison of the <italic>p</italic>-values from asymptotic approximations and the uniform distribution.</title>
<p>(a) Distribution of <italic>p</italic>-values obtained using the conditional approximation, and distribution of <italic>p</italic>-values for the uniform distribution. Generated considering 10<sup>5</sup> instances with <italic>n</italic><sub>1</sub> = 100 samples in the small population, different number <italic>n</italic> of samples in total, and same survival distribution for all patients (≈ 40% censoring). (b) Distribution of <italic>p</italic>-values obtained using the permutational approximation, and distribution of <italic>p</italic>-values for the uniform distribution. Generated considering 10<sup>5</sup> data points with <italic>n</italic><sub>1</sub> = 5%<italic>n</italic> samples in the small population, <italic>n</italic> total samples, and no censoring. (c) Distribution of <italic>p</italic>-values obtained using the permutational approximation, and distribution of <italic>p</italic>-values for the uniform distribution. Generated considering 10<sup>5</sup> data points with <italic>n</italic> = 100 total samples, different values of <italic>n</italic><sub>1</sub>, and no censoring. (d) Distribution of <italic>p</italic>-values obtained using different approximations, and distribution of <italic>p</italic>-values for the uniform distribution. Generated considering 10<sup>5</sup> instances with <italic>n</italic> = 500 total samples, <italic>n</italic><sub>1</sub> = 5%<italic>n</italic> samples with a mutations in the gene, and same survival distribution for all patients (≈ 40% censoring). (e) Distribution of <italic>p</italic>-values obtained using <monospace>surv_test</monospace> method in <monospace>coin</monospace> <monospace>R</monospace> package, and distribution of <italic>p</italic>-values for the uniform distribution. Generated considering 10<sup>5</sup> instances with <italic>n</italic> = 500 total samples, <italic>n</italic><sub>1</sub> = 5%<italic>n</italic> samples with a mutations in the gene, and same survival distribution for all patients, with 0% or 40% censoring. (f) Distribution of <italic>p</italic>-values obtained using different approximations, and distribution of <italic>p</italic>-values for the uniform distribution. Generated considering 10<sup>5</sup> instances with <italic>n</italic> = 500 total samples, <italic>n</italic><sub>1</sub> = 5%<italic>n</italic> samples with a mutations in the gene, and same survival distribution for all patients ( ≈ 60% censoring).</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004071.s008" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004071.s008" mimetype="application/pdf" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Comparison of the <italic>p</italic>-values from the exact tests and the empirical <italic>p</italic>-values for two different null distributions.</title>
<p>The R coefficients comparing the −<italic>log</italic><sub>10</sub> exact <italic>p</italic>-values to the −<italic>log</italic><sub>10</sub> empirical <italic>p</italic>-values are the following: in Fig. (a), permutational = 0.96, conditional = 0.88; in Fig (b), permutational = 0.72, conditional = 0.43. (a) Comparison of exact conditional <italic>p</italic>-values, exact permutational <italic>p</italic>-values, and empirical <italic>p</italic>-values for <italic>n</italic> = 100,<italic>n</italic><sub>1</sub> = 5%<italic>n</italic>, and 30% censoring. Each point represents an instance of survival data. (b) Comparison of exact conditional <italic>p</italic>-values, exact permutational <italic>p</italic>-values, and empirical <italic>p</italic>-values for <italic>n</italic> = 100, expectation <italic>n</italic><sub>1</sub> = 5%<italic>n</italic>, and 30% censoring. Each point represents an instance of survival data.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004071.s009" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004071.s009" mimetype="application/pdf" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Comparison of log-rank <italic>p</italic>-values on cancer data.</title>
<p>Comparison of the <italic>p</italic>-values from the exact permutational test, the exact conditional test, the asymptotic conditional approximation (as implemented in the <monospace>survdiff</monospace> function in <monospace>R</monospace>), and the asymptotic permutational approximation for cancer datasets COADREAD, GBM, KIRC, LUSC, OV, UCEC. (a,b,c,d,e,f): Each data point represents a gene, and the <italic>p</italic>-values computed using the exact permutational test and the <italic>p</italic>-values from <monospace>R</monospace> <monospace>survdiff</monospace> for the gene are shown. (g,h,i,j,k,l): Each data point represents a gene, and the <italic>p</italic>-values computed using the exact permutational test and the exact conditional test for the gene are shown. (m,n,o,p,q,r): Each data point represents a gene, and the <italic>p</italic>-values computed using the exact permutational test and the asymptotic permutational test for the gene are shown.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004071.s010" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004071.s010" mimetype="application/pdf" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>Cox Proportional-Hazard <italic>p</italic>-values.</title>
<p>Comparison of the <italic>p</italic>-values from asymptotic approximations for the Cox Proportional-Hazard model and the uniform distribution, and comparison of the <italic>p</italic>-values from exact permutational tests and the Cox likelihood ratio test with the empirical <italic>p</italic>-values for two different null distributions. (a) Distribution of <italic>p</italic>-values obtained using the asymptotic approximation for the Cox Proportional-Hazard model and the distribution of <italic>p</italic>-values for the uniform distribution. Generated considering 9×10<sup>5</sup> instances with <italic>n</italic> = 200 total samples, <italic>n</italic><sub>1</sub> = 5 samples in the small population and same survival distribution for all patients (no censoring). (b) Comparison of Cox likelihood ratio <italic>p</italic>-values, exact permutational <italic>p</italic>-values, and empirical <italic>p</italic>-values for <italic>n</italic> = 100,<italic>n</italic><sub>1</sub> = 5%<italic>n</italic>, and 30% censoring. Each point represents an instance of survival data. (c) Comparison of Cox likelihood ratio <italic>p</italic>-values, exact permutational <italic>p</italic>-values, and empirical <italic>p</italic>-values for <italic>n</italic> = 100, expectation(<italic>n</italic><sub>1</sub>) = 5%<italic>n</italic>, and 30% censoring. Each point represents an instance of mutations and survival data. The R coefficients comparing the −<italic>log</italic><sub>10</sub> exact <italic>p</italic>-values to the −<italic>log</italic><sub>10</sub> empirical <italic>p</italic>-values are the following: in Fig. (b), permutational = 0.96, Cox likelihood ratio = 0.70; in Fig (c), permutational = 0.72, Cox likelihood ratio = 0.46.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004071.s011" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004071.s011" mimetype="application/pdf" xlink:type="simple">
<label>S5 Fig</label>
<caption>
<title>Survival data, and log-rank test.</title>
<p>(Top) The log-rank test compares the Kaplan-Meier curves of the two groups. (Middle) Survival data is represented by sorting patients by increasing survival. <bold>x</bold> represents group labels for patients, and <bold>c</bold> represents censoring information (<italic>c</italic><sub><italic>i</italic></sub> = 0 if event at time <italic>t</italic><sub><italic>i</italic></sub> is censored, <italic>c</italic><sub><italic>i</italic></sub> = 1 otherwise). (Bottom) The conditional test is defined by a series of independent contingency tables with marginals corresponding to the number of patients at risk in each group and the number of events in each group, conditioning on the patients at risk at each non-censored time; <italic>O</italic><sub><italic>i</italic></sub> denotes the number of events at time <italic>t</italic><sub><italic>i</italic></sub>, <italic>R</italic><sub><italic>i</italic>,<italic>j</italic></sub> denotes the number of patients at risk in group <italic>j</italic> at time <italic>i</italic>. The permutational test considers all <inline-formula id="pcbi.1004071.e031"><mml:math id="M31" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo> <mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:mi>n</mml:mi></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mi>n</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mtd></mml:mtr></mml:mtable> <mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> possible locations of the <italic>n</italic><sub>1</sub> patients with label 1 in the vector <bold>x</bold>.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004071.s012" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004071.s012" mimetype="application/pdf" xlink:type="simple">
<label>S6 Fig</label>
<caption>
<title>Summary of FPTAS.</title>
<p>Starting from the approximation <inline-formula id="pcbi.1004071.e032"><mml:math id="M32" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>P</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>r</mml:mi> <mml:mo>,</mml:mo> <mml:mi>v</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> at time <italic>t</italic> that uses ℓ values of <italic>v</italic> to approximate <italic>P</italic>(<italic>t</italic>,<italic>r</italic>,<italic>v</italic>), in the <italic>t</italic>+1 iteration the FPTAS computes an approximation <inline-formula id="pcbi.1004071.e033"><mml:math id="M33" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>P</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mi>r</mml:mi> <mml:mo>,</mml:mo> <mml:mi>v</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> for <italic>P</italic>(<italic>t</italic>+1,<italic>r</italic>,<italic>v</italic>) that uses up to 2ℓ values of <italic>v</italic>; then the approximation <inline-formula id="pcbi.1004071.e034"><mml:math id="M34" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>P</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mi>r</mml:mi> <mml:mo>,</mml:mo> <mml:mi>v</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is built starting from <inline-formula id="pcbi.1004071.e035"><mml:math id="M35" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>P</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mi>r</mml:mi> <mml:mo>,</mml:mo> <mml:mi>v</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> by appropriately reducing the number of values of <italic>v</italic> considered, while maintaining guarantees on the approximation.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004071.s013" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004071.s013" mimetype="application/pdf" xlink:type="simple">
<label>S7 Fig</label>
<caption>
<title>Running time of the FPTAS, and comparison with the running time of the exhaustive enumeration algorithm.</title>
<p>(a) Runtime of FPTAS and of the exhaustive enumeration for different values of <italic>n</italic>, and for <italic>n</italic><sub>1</sub> = 10,<italic>ɛ</italic> = 5, no censoring. (b) Runtime of FPTAS and of the exhaustive enumeration for <italic>n</italic> = 100,<italic>ɛ</italic> = 5, no censoring, and different values of <italic>n</italic><sub>1</sub>. (c) Runtime of the FPTAS for different values of <italic>ɛ</italic>, and for <italic>n</italic> = 100,<italic>n</italic><sub>1</sub> = 10, no censoring. (d) Comparison of the FPTAS <italic>p</italic>-values and the exact <italic>p</italic>-values (obtained with the complete enumeration algorithm) for <italic>n</italic> = 60,<italic>n</italic><sub>1</sub> = 4, no censoring, and <italic>ɛ</italic> = 1.5.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="pcbi.1004071.ref001">
<label>1</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Mantel</surname> <given-names>N</given-names></name>. <article-title>Evaluation of survival data and two new rank order statistics arising in its consideration</article-title>. <source>Cancer Chemother Rep</source>, <year>1966</year>, <volume>50</volume>:<fpage>163</fpage>–<lpage>170</lpage>. <object-id pub-id-type="pmid">5910392</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004071.ref002">
<label>2</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Peto</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Peto</surname> <given-names>J</given-names></name>. <article-title>Asymptotically efficient rank invariant test procedures</article-title>. <source>J Roy Stat Soc Ser A</source>, <year>1972</year>, <volume>135</volume>:<fpage>185+</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004071.ref003">
<label>3</label>
<mixed-citation xlink:type="simple" publication-type="book">
<name name-style="western"><surname>Kalbfleisch</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Prentice</surname> <given-names>R</given-names></name>. <source>The Statistical Analysis of Failure Time Data (Wiley Series in Probability and Statistics)</source>. <publisher-name>Wiley-Interscience</publisher-name>, <edition>2nd edition</edition>, <year>2002</year>.</mixed-citation>
</ref>
<ref id="pcbi.1004071.ref004">
<label>4</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<collab xlink:type="simple">The Cancer Genome Atlas Research Network</collab>. <article-title>Integrated genomic analyses of ovarian carcinoma</article-title>. <source>Nature</source>, <year>2011</year>, <volume>474</volume>(<issue>7353</issue>):<fpage>609</fpage>–<lpage>15</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature10166" xlink:type="simple">10.1038/nature10166</ext-link></comment> <object-id pub-id-type="pmid">21720365</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004071.ref005">
<label>5</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<collab xlink:type="simple">The Cancer Genome Atlas Network</collab>. <article-title>Comprehensive molecular characterization of human colon and rectal cancer</article-title>. <source>Nature</source>, <year>2012</year>, <volume>487</volume>(<issue>7407</issue>):<fpage>330</fpage>–<lpage>7</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature11252" xlink:type="simple">10.1038/nature11252</ext-link></comment> <object-id pub-id-type="pmid">22810696</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004071.ref006">
<label>6</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<collab xlink:type="simple">The Cancer Genome Atlas Network</collab>. <article-title>Comprehensive molecular portraits of human breast tumours</article-title>. <source>Nature</source>, <year>2012</year>, <volume>490</volume>(<issue>7418</issue>):<fpage>61</fpage>–<lpage>70</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature11412" xlink:type="simple">10.1038/nature11412</ext-link></comment> <object-id pub-id-type="pmid">23000897</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004071.ref007">
<label>7</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<collab xlink:type="simple">The Cancer Genome Atlas Research Network</collab>. <article-title>Comprehensive molecular characterization of clear cell renal cell carcinoma</article-title>. <source>Nature</source>, <year>2013</year>, <volume>499</volume>(<issue>7456</issue>):<fpage>43</fpage>–<lpage>9</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature12222" xlink:type="simple">10.1038/nature12222</ext-link></comment> <object-id pub-id-type="pmid">23792563</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004071.ref008">
<label>8</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Garraway</surname> <given-names>LA</given-names></name>, <name name-style="western"><surname>Lander</surname> <given-names>ES</given-names></name>. <article-title>Lessons from the cancer genome</article-title> <source>Cell</source>, <year>2013</year>, <volume>153</volume>(<issue>1</issue>):<fpage>17</fpage>–<lpage>37</lpage>. <object-id pub-id-type="pmid">23540688</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004071.ref009">
<label>9</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Vogelstein</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Papadopoulos</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Velculescu</surname> <given-names>VE</given-names></name>, <name name-style="western"><surname>Zhou</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Diaz</surname> <given-names>LA</given-names> <suffix>Jr</suffix></name>, <name name-style="western"><surname>Kinzler</surname> <given-names>KW</given-names></name>. <article-title>Cancer genome landscapes</article-title>. <source>Science</source>, <year>2013</year>, <volume>339</volume>(<issue>6127</issue>):<fpage>1546</fpage>–<lpage>58</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1235122" xlink:type="simple">10.1126/science.1235122</ext-link></comment> <object-id pub-id-type="pmid">23539594</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004071.ref010">
<label>10</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Latta</surname> <given-names>RB</given-names></name>. <article-title>A monte carlo study of some two-sample rank tests with censored data</article-title>. <source>Journal of the American Statistical Association</source>, <year>1981</year>, <volume>76</volume>(<issue>375</issue>):pp. <fpage>713</fpage>–<lpage>719</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004071.ref011">
<label>11</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Kellerer</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Chmelevsky</surname> <given-names>D</given-names></name>. <article-title>Small-sample properties of censored-data rank tests</article-title>. <source>Biometrics</source>, <year>1983</year>, <volume>39</volume>(<issue>3</issue>):pp. <fpage>675</fpage>–<lpage>682</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004071.ref012">
<label>12</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Mendolia</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Klein</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Petersdorf</surname> <given-names>EW</given-names></name>, <name name-style="western"><surname>Malkki</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>T</given-names></name>. <article-title>Comparison of statistics in association tests of genetic markers for survival outcomes</article-title>. <source>Stat Med</source>, <year>2014</year>, <volume>33</volume>, <issue>5</issue>:<fpage>828</fpage>–<lpage>44</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/sim.5982" xlink:type="simple">10.1002/sim.5982</ext-link></comment> <object-id pub-id-type="pmid">24105914</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004071.ref013">
<label>13</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Jiao</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Shi</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Edil</surname> <given-names>BH</given-names></name>, <name name-style="western"><surname>de Wilde</surname> <given-names>RF</given-names></name>, <name name-style="western"><surname>Klimstra</surname> <given-names>DS</given-names></name>, <name name-style="western"><surname>Maitra</surname> <given-names>A</given-names></name>, <etal>et al</etal>. <article-title>DAXX/ATRX, MEN1, and mTOR pathway genes are frequently altered in pancreatic neuroendocrine tumors</article-title>. <source>Science</source>, <year>2011</year>, <volume>331</volume>(<issue>6021</issue>):<fpage>1199</fpage>–<lpage>1203</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1200609" xlink:type="simple">10.1126/science.1200609</ext-link></comment> <object-id pub-id-type="pmid">21252315</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004071.ref014">
<label>14</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Gaidzik</surname> <given-names>VI</given-names></name>, <name name-style="western"><surname>Bullinger</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Schlenk</surname> <given-names>RF</given-names></name>, <name name-style="western"><surname>Zimmermann</surname> <given-names>AS</given-names></name>, <name name-style="western"><surname>Röck</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Paschka</surname> <given-names>P</given-names></name>, <etal>et al</etal>. <article-title>Runx1 mutations in acute myeloid leukemia: results from a comprehensive genetic and clinical analysis from the aml study group</article-title>. <source>J Clin Oncol</source>, <year>2011</year>, <volume>29</volume>(<issue>10</issue>):<fpage>1364</fpage>–<lpage>72</lpage>. <object-id pub-id-type="pmid">21343560</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004071.ref015">
<label>15</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Fisher</surname> <given-names>RA</given-names></name>. <article-title>On the interpretation of χ<sup>2</sup> from contingency tables, and the calculation of p</article-title>. <source>Journal of the Royal Statistical Society</source>, <year>1922</year>, <volume>85</volume>(<issue>1</issue>):pp. <fpage>87</fpage>–<lpage>94</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004071.ref016">
<label>16</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Mantel</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Haenszel</surname> <given-names>W</given-names></name>. <article-title>Statistical aspects of the analysis of data from retrospective studies of disease</article-title>. <source>Journal of the NCI</source>, <year>1959</year>, <volume>22</volume>(<issue>4</issue>):<fpage>719</fpage>–<lpage>748</lpage>. <object-id pub-id-type="pmid">13655060</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004071.ref017">
<label>17</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Mantel</surname> <given-names>N</given-names></name>. <article-title>Propriety of the Mantel-Haenszel variance for the log rank test</article-title>. <source>Biometrika</source>, <year>1985</year>, <volume>72</volume>(<issue>2</issue>):<fpage>471</fpage>–<lpage>2</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004071.ref018">
<label>18</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Heimann</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Neuhaus</surname> <given-names>G</given-names></name>. <article-title>Permutational distribution of the log-rank statistic under random censorship with applications to carcinogenicity assays</article-title>. <source>Biometrics</source>, <year>1998</year>, <volume>54</volume>(<issue>1</issue>):pp. <fpage>168</fpage>–<lpage>184</lpage>. <object-id pub-id-type="pmid">9544515</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004071.ref019">
<label>19</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Brown</surname> <given-names>M</given-names></name>. <article-title>On the choice of variance for the log rank test</article-title>. <source>Biometrika</source>, <year>1984</year>, <volume>71</volume>(<issue>1</issue>):<fpage>65</fpage>–<lpage>74</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004071.ref020">
<label>20</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Huang</surname> <given-names>YT</given-names></name>, <name name-style="western"><surname>Heist</surname> <given-names>RS</given-names></name>, <name name-style="western"><surname>Chirieac</surname> <given-names>LR</given-names></name>, <name name-style="western"><surname>Lin</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Skaug</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Zienolddiny</surname> <given-names>S</given-names></name>, <etal>et al</etal>. <article-title>Genome-wide analysis of survival in early-stage non-small-cell lung cancer</article-title>. <source>J Clin Oncol</source>, <year>2009</year>, <volume>27</volume>(<issue>16</issue>):<fpage>2660</fpage>–<lpage>7</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1200/JCO.2008.18.7906" xlink:type="simple">10.1200/JCO.2008.18.7906</ext-link></comment> <object-id pub-id-type="pmid">19414679</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004071.ref021">
<label>21</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Yan</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Parsons</surname> <given-names>DW</given-names></name>, <name name-style="western"><surname>Jin</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>McLendon</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Rasheed</surname> <given-names>BA</given-names></name>, <name name-style="western"><surname>Yuan</surname> <given-names>W</given-names></name>., <etal>et al</etal>. <article-title>IDH1 and IDH2 mutations in gliomas</article-title>. <source>N Engl J Med</source>, <year>2009</year>, <volume>360</volume>(<issue>8</issue>):<fpage>765</fpage>–<lpage>73</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1056/NEJMoa0808710" xlink:type="simple">10.1056/NEJMoa0808710</ext-link></comment> <object-id pub-id-type="pmid">19228619</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004071.ref022">
<label>22</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Nobusawa</surname> <given-names>S</given-names></name>,<name name-style="western"><surname>Watanabe</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Kleihues</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Ohgaki</surname> <given-names>H</given-names></name>. <article-title>Idh1 mutations as molecular signature and predictive factor of secondary glioblastomas</article-title>. <source>Clin Cancer Res</source>, <year>2009</year>, <volume>15</volume>(<issue>19</issue>):<fpage>6002</fpage>–<lpage>7</lpage>. <object-id pub-id-type="pmid">19755387</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004071.ref023">
<label>23</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Myung</surname> <given-names>JK</given-names></name>, <name name-style="western"><surname>Cho</surname> <given-names>HJ</given-names></name>, <name name-style="western"><surname>Park</surname> <given-names>CK</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>SK</given-names></name>, <name name-style="western"><surname>Phi</surname> <given-names>JH</given-names></name>, <name name-style="western"><surname>Park</surname> <given-names>SH</given-names></name>. <article-title>Idh1 mutation of gliomas with long-term survival analysis</article-title>. <source>Oncol Rep</source>, <year>2012</year>, <volume>28</volume>(<issue>5</issue>):<fpage>1639</fpage>–<lpage>44</lpage>. <object-id pub-id-type="pmid">22922798</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004071.ref024">
<label>24</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Houillier</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Kaloshi</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Mokhtari</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Guillevin</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Laffaire</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Idh1 or idh2 mutations predict longer survival and response to temozolomide in low-grade gliomas</article-title>. <source>Neurology</source>, <year>2010</year>, <volume>75</volume>(<issue>17</issue>):<fpage>1560</fpage>–<lpage>6</lpage>. <object-id pub-id-type="pmid">20975057</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004071.ref025">
<label>25</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Chae</surname> <given-names>YS</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>SJ</given-names></name>, <name name-style="western"><surname>Moon</surname> <given-names>JH</given-names></name>, <name name-style="western"><surname>Kang</surname> <given-names>BW</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>JG</given-names></name>, <name name-style="western"><surname>Sohn</surname> <given-names>SK</given-names></name>, <etal>et al</etal>. <article-title>VARS2 V552V variant as prognostic marker in patients with early breast cancer</article-title>. <source>Med Oncol</source>, <year>2011</year>, <volume>28</volume>(<issue>4</issue>):<fpage>1273</fpage>–<lpage>80</lpage>. <object-id pub-id-type="pmid">20503108</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004071.ref026">
<label>26</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Stevenson</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Allen</surname> <given-names>WL</given-names></name>, <name name-style="western"><surname>Turkington</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Jithesh</surname> <given-names>PV</given-names></name>, <name name-style="western"><surname>Proutski</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Stewart</surname> <given-names>G</given-names></name>, <etal>et al</etal>. <article-title>Identification of galanin and its receptor GalR1 as novel determinants of resistance to chemotherapy and potential biomarkers in colorectal cancer</article-title>. <source>Clin Cancer Res</source>, <year>2012</year>, <volume>18</volume>(<issue>19</issue>):<fpage>5412</fpage>–<lpage>26</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1158/1078-0432.CCR-12-1780" xlink:type="simple">10.1158/1078-0432.CCR-12-1780</ext-link></comment> <object-id pub-id-type="pmid">22859720</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004071.ref027">
<label>27</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Misawa</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Ueda</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Kanazawa</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Misawa</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Jang</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Brenner</surname> <given-names>JC</given-names></name>, <etal>et al</etal>. <article-title>Epigenetic inactivation of galanin receptor 1 in head and neck cancer</article-title>. <source>Clin Cancer Res</source>, <year>2008</year>, <volume>14</volume>(<issue>23</issue>): <fpage>76047613</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004071.ref028">
<label>28</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Misawa</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Kanazawa</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Misawa</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Uehara</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Imai</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Takahashi</surname> <given-names>G</given-names></name>, <etal>et al</etal>. <article-title>Galanin has tumor suppressor activity and is frequently inactivated by aberrant promoter methylation in head and neck cancer</article-title>. <source>Transl Oncol</source>, <year>2013</year>, <volume>6</volume>(<issue>3</issue>):<fpage>338</fpage>–<lpage>46</lpage>. <object-id pub-id-type="pmid">23730414</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004071.ref029">
<label>29</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Bolton</surname> <given-names>KL</given-names></name>, <name name-style="western"><surname>Chenevix-Trench</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Goh</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Sadetzki</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Ramus</surname> <given-names>SJ</given-names></name>, <name name-style="western"><surname>Karlan</surname> <given-names>BY</given-names></name>, <etal>et al</etal>. <article-title>Association between brca1 and brca2 mutations and survival in women with invasive epithelial ovarian cancer</article-title>. <source>JAMA</source>, <year>2012</year>, <volume>307</volume>(<issue>4</issue>):<fpage>382</fpage>–<lpage>90</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1001/jama.2012.20" xlink:type="simple">10.1001/jama.2012.20</ext-link></comment> <object-id pub-id-type="pmid">22274685</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004071.ref030">
<label>30</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Burwinkel</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Wirtenberger</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Klaes</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Schmutzler</surname> <given-names>RK</given-names></name>, <name name-style="western"><surname>Grzybowska</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Försti</surname> <given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Association of NCOA3 polymorphisms with breast cancer risk</article-title>. <source>Clin Cancer Res</source>, <year>2005</year>, <volume>11</volume>(<issue>6</issue>):<fpage>2169</fpage>–<lpage>74</lpage>. <object-id pub-id-type="pmid">15788663</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004071.ref031">
<label>31</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Burandt</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Jens</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Holst</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Jänicke</surname> <given-names>F</given-names></name>,<name name-style="western"><surname>Müller</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Quaas</surname> <given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Prognostic relevance of AIB1 (NCoA3) amplification and overexpression in breast cancer</article-title>. <source>Breast Cancer Res Treat</source>, <year>2013</year>, <volume>137</volume>(<issue>3</issue>):<fpage>745</fpage>–<lpage>53</lpage>. <object-id pub-id-type="pmid">23322234</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004071.ref032">
<label>32</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Witten</surname> <given-names>DM</given-names></name>, <name name-style="western"><surname>Tibshirani</surname> <given-names>R</given-names></name>. <article-title>Survival analysis with high-dimensional covariates</article-title>. <source>Stat Methods Med Res</source>, <year>2010</year>, <volume>19</volume>:<fpage>29</fpage>–<lpage>51</lpage>. <object-id pub-id-type="pmid">19654171</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004071.ref033">
<label>33</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Heinze</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Gnant</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Schemper</surname> <given-names>M</given-names></name>. <article-title>Exact log-rank tests for unequal follow-up</article-title>. <source>Biometrics</source>, <year>2003</year>, <volume>59</volume>(<issue>4</issue>):<fpage>1151</fpage>–<lpage>1157</lpage>. <object-id pub-id-type="pmid">14969496</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004071.ref034">
<label>34</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Abd-Elfattah</surname> <given-names>EF</given-names></name>, <name name-style="western"><surname>Butler</surname> <given-names>RW</given-names></name>. <article-title>Log-rank permutation tests for trend: saddlepoint p-values and survival rate confidence intervals</article-title>. <source>Canadian Journal of Statistics</source>, <year>2009</year>, <volume>37</volume>(<issue>1</issue>):<fpage>5</fpage>–<lpage>16</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004071.ref035">
<label>35</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Keich</surname> <given-names>U</given-names></name>. <article-title>sFFT: a faster accurate computation of the p-value of the entropy score</article-title>. <source>J Comput Biol</source>, <year>2005</year>, <volume>12</volume>(<issue>4</issue>):<fpage>416</fpage>–<lpage>30</lpage>. <object-id pub-id-type="pmid">15882140</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004071.ref036">
<label>36</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Nagarajan</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Jones</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Keich</surname> <given-names>U</given-names></name>. <article-title>Computing the p-value of the information content from an alignment of multiple sequences</article-title>. <source>Bioinformatics</source>, <year>2005</year>, <volume>21</volume> <issue>Suppl 1</issue>:<fpage>i311</fpage>–<lpage>8</lpage>. <object-id pub-id-type="pmid">15961473</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004071.ref037">
<label>37</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Pagano</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Tritchler</surname> <given-names>D</given-names></name>. <article-title>On obtaining permutation distributions in polynomial time</article-title>. <source>Journal of the American Statistical Association</source>, <year>1983</year>, <volume>78</volume>(<issue>382</issue>):pp. <fpage>435</fpage>–<lpage>440</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004071.ref038">
<label>38</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Bejerano</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Friedman</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Tishby</surname> <given-names>N</given-names></name>. <article-title>Efficient exact p-value computation for small sample, sparse, and surprising categorical data</article-title>. <source>J Comput Biol</source>, <year>2004</year>, <volume>11</volume>(<issue>5</issue>):<fpage>867</fpage>–<lpage>886</lpage>. <object-id pub-id-type="pmid">15700407</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004071.ref039">
<label>39</label>
<mixed-citation xlink:type="simple" publication-type="other">Gopalan P, Klivans A, Meka R, Stefankovic D, Vempala S, Vigoda E. An FPTAS for #Knapsack and Related Counting Problems. Proc. FOCS, 2011, 817–826.</mixed-citation>
</ref>
</ref-list>
</back>
</article>